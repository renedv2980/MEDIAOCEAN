*          DATA SET TAREP2BAP  AT LEVEL 106 AS OF 02/05/14                      
*CATALP TA2BAP                                                                  
         TITLE 'TA2BAP - AGENCY PROFITABILITY FOR TAREP2B'                      
TA2BAP   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 0,TA2BAP,R7,R8                                                   
         L     RC,0(R1)            P1=A(GEND)                                   
         USING GEND,RC                                                          
         L     RA,4(R1)            P2=A(MYD)                                    
         USING MYD,RA                                                           
         L     R9,ASUBSYSD                                                      
         USING SUBSYSD,R9                                                       
         CLI   0(R1),1             P1, BYTE 1 1=POST                            
         BE    APPOST                                                           
         CLI   0(R1),2                        2=REPORTS                         
         BE    APREPS                                                           
         CLI   0(R1),3                        3=POST BILLS                      
         BE    APBILL                                                           
         DC    H'0'                                                             
         SPACE 1                                                                
APPOST   BAS   RE,POSTDETS                                                      
         B     XIT                                                              
         SPACE 1                                                                
APBILL   BAS   RE,POSTBILL                                                      
         B     XIT                                                              
         SPACE 1                                                                
APREPS   CLC   SVSRTCNT,=PL6'0'    EXIT IF NOTHING IN SORTER                    
         BE    XIT                                                              
         OC    SVSRTCNT,SVSRTCNT   EXIT IF NOTHING IN SORTER                    
         BZ    XIT                                                              
         BAS   RE,SORTRECS                                                      
         CLI   ACTEQU,ACTDOWN      DOWNLOADING?                                 
         BNE   XIT                 NO                                           
         BAS   RE,PREPD            YES, PRINT DOWNLOADABLE REPORT               
         B     XIT                                                              
         EJECT                                                                  
*              PUT SORT RECORD FOR BILL                                         
         SPACE 3                                                                
POSTBILL NTR1                                                                   
         LA    R2,SORTIO                                                        
         USING APRD,R2                                                          
         MVC   APREMP,TIEMP                                                     
         MVC   APROFF,TIOFF                                                     
         MVC   APRAGY,TIAGY                                                     
         L     R6,ABILL                                                         
         MVI   ELCODE,TAPDELQ                                                   
         BAS   RE,GETEL                                                         
         BNE   XIT                                                              
         USING TAPDD,R6                                                         
         TM    TAPDOPT3,TAPDOGRY   NO GREY BILLS                                
         BO    XIT                                                              
         L     R6,ABILL                                                         
         BAS   RE,FIXAGY                                                        
         MVI   ELCODE,TAINELQ                                                   
         BAS   RE,GETEL                                                         
         BNE   XIT                                                              
         USING TAIND,R6                                                         
         TM    TAINSTAT,TAINSBIL   MUST BE BILLED                               
         BNO   XIT                                                              
         GOTO1 DATCON,DMCB,(1,TICKDATE),(3,WORK)                                
         MVC   APRMON,WORK+1                                                    
         ZIC   R1,APRMON                                                        
         BCTR  R1,0                                                             
         SR    R0,R0                                                            
         D     R0,=F'3'                                                         
         LA    R1,1(R1)                                                         
         STC   R1,APRQRT                                                        
         MVC   APRREXP(96),PZEROS                                               
         L     R6,ABILL                                                         
         MVI   ELCODE,TABDELQ                                                   
         BAS   RE,GETEL                                                         
         USING TABDD,R6                                                         
         BNE   XIT                                                              
         L     R1,TABDTAX          TAX & HANDLING                               
         A     R1,TABDHND                                                       
         A     R1,TABDHNDC                                                      
         A     R1,TABDFICR                                                      
         A     R1,TABDGST                                                       
         A     R1,TABDPST                                                       
         CVD   R1,DUB                                                           
         ZAP   APRFEES,DUB                                                      
         MVC   RECTYPE,=CL16'SORTING BILL'                                      
         BAS   RE,SORTPUT                                                       
         B     XIT                                                              
         SPACE 1                                                                
FIXAGY   NTR1                                                                   
         OC    TIFAGY,TIFAGY       IF AGENCY IS REQUESTED                       
         BZ    XIT                                                              
         MVI   ELCODE,TAPDELQ                                                   
         BAS   RE,GETEL                                                         
         USING TAPDD,R6                                                         
         GOTO1 TINVCON,DMCB,TAPDINV,APRAGY                                      
         B     XIT                                                              
         EJECT                                                                  
*              PUT SORT RECORD FOR CHECK                                        
         SPACE 3                                                                
POSTDETS NTR1                                                                   
         LA    R2,SORTIO                                                        
         USING APRD,R2                                                          
         MVC   APREMP,EXTEMP                                                    
         MVC   APROFF,EXTOFF                                                    
         MVC   APRAGY,EXTAGY                                                    
         L     R6,ACHECK                                                        
         BAS   RE,FIXAGY                                                        
         MVC   APRMON,EXTMONTH                                                  
         MVC   APRQRT,EXTQUART                                                  
         MVC   APRREXP(96),PZEROS                                               
         LA    R3,THISNTAX                                                      
         LA    R4,APRREXP                                                       
         BAS   RE,CVD                                                           
         CLI   EXTW4TY,TAW4TYCO                                                 
         BE    PDET4                                                            
         CLI   EXTW4TY,TAW4TYCA                                                 
         BE    PDET4                                                            
         CLI   EXTW4TY,TAW4TYTR                                                 
         BE    PDET4                                                            
         LA    R3,THISEARN                                                      
         LA    R4,APRGROS                                                       
         BAS   RE,CVD                                                           
         LA    R3,FCAWAGES                                                      
         LA    R4,APRFCAW                                                       
         BAS   RE,CVD                                                           
         LA    R3,MEDWAGES                                                      
         LA    R4,APRMEDW                                                       
         BAS   RE,CVD                                                           
         LA    R3,SUIWAGES                                                      
         LA    R4,APRNYUW                                                       
         CLC   EXTSTATE(2),=C'NY'                                               
         BE    PDET2                                                            
         LA    R4,APRILUW                                                       
         CLC   EXTSTATE(2),=C'IL'                                               
         BE    PDET2                                                            
         LA    R4,APRCAUW                                                       
         CLC   EXTSTATE(2),=C'CA'                                               
         BE    PDET2                                                            
         LA    R4,APROTUW                                                       
         SPACE 1                                                                
PDET2    BAS   RE,CVD                                                           
         LA    R3,FUIWAGES                                                      
         LA    R4,APRFDUW                                                       
         BAS   RE,CVD                                                           
         L     R1,FCAWAGES                                                      
         S     R1,SUIWAGES                                                      
         CVD   R1,DUB                                                           
         AP    APRBRKW,DUB                                                      
         L     R1,FUI                                                           
         A     R1,SUI                                                           
         A     R1,FICA                                                          
         A     R1,MEDICARE                                                      
         CVD   R1,DUB                                                           
         AP    APRTAX,DUB                                                       
         SPACE 1                                                                
PDET4    MVC   RECTYPE,=CL16'SORTING CHECK'                                     
         BAS   RE,SORTPUT                                                       
         B     XIT                                                              
         SPACE 1                                                                
CVD      L     R1,0(R3)                                                         
         CVD   R1,DUB                                                           
         AP    0(8,R4),DUB                                                      
         BR    RE                                                               
         EJECT                                                                  
*              CONTROL AP REPORTS                                               
         SPACE 3                                                                
SORTRECS NTR1                                                                   
         CLI   ACTEQU,ACTDOWN      DOWNLOADING?                                 
         BNE   SORT1                                                            
         L     R2,=A(TADOWN)       YES, OPEN TEMPORARY DATASET                  
         OPEN  ((2),OUTPUT)                                                     
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'00'                                                            
SORT1    MVC   MYTITLE,MYSPACES                                                 
         MVC   MYTITLE(32),=CL32'MONTHLY AGENCY PROFITABILITY'                  
         L     R1,=A(APH6)                                                      
         MVC   MYH6,0(R1)                                                       
         L     R1,=A(APH7)                                                      
         MVC   MYH7,0(R1)                                                       
         L     R1,=A(APCOL)                                                     
         MVC   MYCOLS,0(R1)                                                     
         ZAP   SRTCOUNT,=P'0'                                                   
         ZAP   SVSRTCNT,=P'0'                                                   
         SPACE 1                                                                
         BAS   RE,SETSKIP                                                       
         XC    THISAGY,THISAGY                                                  
         SPACE 1                                                                
SORT2    GOTO1 MYSORTER,DMCB,=C'GET'                                            
         LA    R2,SORTIO                                                        
         USING APRD,R2                                                          
         L     R3,DMCB+4                                                        
         LTR   R3,R3                                                            
         BNZ   SORT4                                                            
         BAS   RE,AGYTOTS                                                       
         BAS   RE,OFFTOTS                                                       
         BAS   RE,EMPTOTS                                                       
         CLI   ACTEQU,ACTDOWN      DOWNLOADING?                                 
         BNE   XIT                                                              
         L     R2,=A(TADOWN)       YES, CLOSE DATASET                           
         CLOSE ((2))                                                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'00'                                                            
         B     XIT                                                              
         SPACE 1                                                                
SORT4    MVC   APRREC,0(R3)                                                     
         AP    SRTCOUNT,=P'1'                                                   
         MVC   RECTYPE,=CL16'SORT INPUT'                                        
         BAS   RE,SORTRACE                                                      
         OC    THISAGY,THISAGY                                                  
         BZ    SORT20                                                           
         CLC   APREMP,THISEMP                                                   
         BE    SORT6                                                            
         BAS   RE,AGYTOTS                                                       
         BAS   RE,OFFTOTS                                                       
         BAS   RE,EMPTOTS                                                       
         B     SORT20                                                           
         SPACE 1                                                                
SORT6    CLC   APROFF,THISOFF                                                   
         BE    SORT8                                                            
         BAS   RE,AGYTOTS                                                       
         BAS   RE,OFFTOTS                                                       
         B     SORT20                                                           
         SPACE 1                                                                
SORT8    CLC   APRAGY,THISAGY                                                   
         BE    SORT20                                                           
         BAS   RE,AGYTOTS                                                       
         SPACE 1                                                                
SORT20   MVC   THISAGY,APRAGY                                                   
         MVC   THISOFF,APROFF                                                   
         MVC   THISEMP,APREMP                                                   
         BAS   RE,POSTSORT                                                      
         B     SORT2                                                            
         DROP  R2                                                               
         EJECT                                                                  
*              POST DETAILS FOR THIS SORT RECORD                                
         SPACE 3                                                                
POSTSORT NTR1                                                                   
         LA    R4,SORTIO                                                        
         USING APRD,R4                                                          
         LA    R2,APRREXP                                                       
         LA    R3,AYMACS                                                        
         CLC   APRMON,QMONTH       IF FOR MONTH,                                
         BNE   *+8                                                              
         BAS   RE,ADDLINE             ADD                                       
         LA    R3,AYQACS                                                        
         CLC   APRQRT,QQUART       IF FOR QUARTER,                              
         BNE   *+8                                                              
         BAS   RE,ADDLINE             ADD                                       
         LA    R3,AYYACS                                                        
         BAS   RE,ADDLINE          ADD IN TO YTD                                
         B     XIT                                                              
         DROP  R4                                                               
         SPACE 1                                                                
ADDLINE  NTR1                                                                   
         LA    R0,12                                                            
         SPACE 1                                                                
ADDL2    AP    0(8,R3),0(8,R2)                                                  
         LA    R2,8(R2)                                                         
         LA    R3,8(R3)                                                         
         BCT   R0,ADDL2                                                         
         B     XIT                                                              
         SPACE 1                                                                
SUBLINE  NTR1                                                                   
         LA    R0,12                                                            
         SPACE 1                                                                
SUBL2    SP    0(8,R3),0(8,R2)                                                  
         LA    R2,8(R2)                                                         
         LA    R3,8(R3)                                                         
         BCT   R0,SUBL2                                                         
         B     XIT                                                              
         EJECT                                                                  
*              PRINT AGENCY TOTALS                                              
         SPACE 3                                                                
AGYTOTS  NTR1                                                                   
         LA    R3,MYP                                                           
         USING APPD,R3                                                          
         MVC   APPAGY(15),MYSPACES                                              
         MVC   APPAGY(6),THISAGY                                                
         MVC   MYNAME(9),=C'(INVOICE)'                                          
         OC    TIFAGY,TIFAGY                                                    
         BNZ   AGYTOTS2                                                         
         XC    KEY,KEY                                                          
         LA    R4,KEY                                                           
         USING TLAYD,R4                                                         
         MVI   TLAYCD,TLAYCDQ                                                   
         MVC   TLAYAGY,THISAGY                                                  
         DROP  R4                                                               
         BAS   RE,GETNAME                                                       
         CLI   MYNAME,C'A'                                                      
         BL    AGYTOTS2                                                         
         L     R6,AIO              BILLING TYPE HERE                            
         MVI   ELCODE,TABRELQ                                                   
         BAS   RE,GETEL                                                         
         BNE   AGYTOTS2                                                         
         USING TABRD,R6                                                         
         MVC   APPAGY+7(5),=C'TYPE='                                            
         LA    R2,APPAGY+12                                                     
         EDIT  (1,TABRTYPE),(2,(R2)),ALIGN=LEFT                                 
         MVC   THISBRTY,TABRTYPE                                                
         BAS   RE,BTPOST                                                        
         SPACE 1                                                                
AGYTOTS2 LA    R2,AYYACS                                                        
         BAS   RE,TOPPOST                                                       
         CLI   ACTEQU,ACTDOWN      DOWNLOADING?                                 
         BNE   AGYTOTS8                                                         
         BAS   RE,TOTLINE          YES, CALCULATE TOTALS                        
         BAS   RE,PUTIT                                                         
*                                                                               
         USING APRREXP,R2                                                       
AGYTOTS8 CP    APRGROS,MINVALUE    IS AGENCY BELOW MIN VALUE                    
         DROP  R2                                                               
         BNL   AGYTOTS9                                                         
         LA    R2,AYMACS                                                        
         LA    R3,SMMACS           YES - DON'T PRINT TOTALS                     
         BAS   RE,CLEARADD         JUST CLEAR AND ADD TO SMALL ACCS             
         AP    SMALLCNT,=P'1'      KEEP COUNT OF SMALL AGENCIES                 
         B     XIT                                                              
         SPACE 1                                                                
AGYTOTS9 LA    R2,AYMACS                                                        
         GOTO1 CHOPPER,DMCB,(36,MYNAME),(15,MYP2+1),(C'P',2),0                  
         BAS   RE,ALLTOTS                                                       
         LA    R3,OFMACS           CLEAR AND ADD TO OFFICE                      
         BAS   RE,CLEARADD                                                      
         B     XIT                                                              
         EJECT                                                                  
*              PRINT OFFICE TOTALS                                              
         SPACE 3                                                                
OFFTOTS  NTR1                                                                   
         LA    R3,MYP                                                           
         USING APPD,R3                                                          
         CP    SMALLCNT,=P'0'      ANY SMALL AGENCIES TO PROCESS?               
         BE    OFFTOTS2                                                         
         MVC   APPAGY(15),MYSPACES                                              
         MVC   APPAGY(9),=C'TOTAL OF '                                          
         EDIT  (P6,SMALLCNT),(4,APPAGY+9),ALIGN=LEFT                            
         LA    R3,MYP2                                                          
         MVC   APPAGY(15),=C'SMALL AGENCIES '                                   
         ZAP   SMALLCNT,=P'0'                                                   
         LA    R2,SMMACS                                                        
         BAS   RE,ALLTOTS                                                       
         LA    R3,OFMACS           CLEAR AND ADD TO OFFICE                      
         BAS   RE,CLEARADD                                                      
         SPACE 1                                                                
OFFTOTS2 LA    R3,MYP                                                           
         MVC   APPAGY(15),=C'OFFICE X TOTALS'                                   
         MVC   APPAGY+7(1),THISOFF                                              
         GOTO1 CHOPPER,DMCB,(30,THISOFNM),(15,MYP2+1),(C'P',2),0                
         LA    R2,OFMACS                                                        
         MVI   MEMOSW,C'Y'         (SAVE THESE FOR A SUMMARY)                   
         BAS   RE,ALLTOTS                                                       
         LA    R3,EMMACS           CLEAR AND ADD TO EMPLOYER                    
         BAS   RE,CLEARADD                                                      
         BAS   RE,SETSKIP                                                       
         B     XIT                                                              
         EJECT                                                                  
*              PRINT EMPLOYER TOTALS                                            
         SPACE 3                                                                
EMPTOTS  NTR1                                                                   
         BAS   RE,SETSKIP                                                       
         MVI   THISOFF,X'FE'                                                    
         LA    R3,MYP                                                           
         USING APPD,R3                                                          
         LA    R1,TYTABLE          FIRST SUMMARIZE BY BILL TYPE                 
         SPACE 1                                                                
EMPT2    L     R2,8(R1)                                                         
         CLC   PZEROS(96),192(R2)  ANY ACTIVITY?                                
         BE    EMPT4                                                            
         MVC   APPAGY(7),1(R1)                                                  
         BAS   RE,ALLTOTS                                                       
         BAS   RE,JUSTCLER                                                      
         SPACE 1                                                                
EMPT4    CLI   0(R1),X'FF'         DONE WITH BILL TYPES?                        
         BE    EMPT6                                                            
         LA    R1,12(R1)                                                        
         B     EMPT2                                                            
         SPACE 1                                                                
EMPT6    MVC   APPAGY(15),=C'EMPLOYER TOTALS'                                   
         LA    R2,EMMACS                                                        
         MVI   MEMOSW,C'Y'         (SAVE THESE FOR A SUMMARY)                   
         BAS   RE,ALLTOTS                                                       
         BAS   RE,JUSTCLER                                                      
         SPACE 1                                                                
         BAS   RE,SETSKIP          NOW DO OFFICE SUMMARY                        
         MVI   THISOFF,X'FD'                                                    
         L     R2,=V(MYBUFF)                                                    
         SPACE 1                                                                
EMPT8    MVC   MYP,0(R2)                                                        
         MVC   MYP2,132(R2)                                                     
         MVC   MYP3,264(R2)                                                     
         BAS   RE,SPLAT                                                         
         BAS   RE,SPLAT                                                         
         MVI   0(R2),0                                                          
         LA    R2,396(R2)                                                       
         CLI   0(R2),0                                                          
         BNE   EMPT8                                                            
         SPACE 1                                                                
         BAS   RE,SETSKIP          NOW DO TOP 100 SUMMARY                       
         MVI   THISOFF,X'FF'                                                    
         L     R2,=A(TOPAGYS)                                                   
         LA    R3,MYP                                                           
         USING APPD,R3                                                          
         SPACE 1                                                                
EMPT10   CLC   0(6,R2),=C'TOTAL EM'                                             
         BNE   *+8                                                              
         BAS   RE,SPLAT                                                         
         CLC   20(96,R2),PZEROS                                                 
         BE    EMPT12                                                           
         MVC   APPAGY,0(R2)                                                     
         LA    R2,20(R2)                                                        
         BAS   RE,TOTLINE                                                       
         BAS   RE,SPLAT                                                         
         SH    R2,=H'20'                                                        
         MVC   20(96,R2),PZEROS                                                 
         SPACE 1                                                                
EMPT12   CLC   0(8,R2),=C'TOTAL EM'                                             
         BE    EMPT14                                                           
         LA    R2,20+96(R2)                                                     
         B     EMPT10                                                           
         SPACE 1                                                                
EMPT14   BAS   RE,SETSKIP                                                       
         B     XIT                                                              
         EJECT                                                                  
*              POSTING FOR BILLING TYPES AND TOP 100                            
         SPACE 3                                                                
TOPPOST  NTR1                                                                   
         LA    R2,AYYACS           ADD INTO ALL AGENCY LINE                     
         L     R3,=A(ALLAGYS)                                                   
         LA    R3,20(R3)                                                        
         BAS   RE,ADDLINE                                                       
         SPACE 1                                                                
         L     R3,=A(N100AGY)                                                   
         LA    R3,20(R3)                                                        
         CP    AYYACS+8(8),8(8,R3) IS THIS BETTER THAN NUMBER 100               
         BL    TOPP2                                                            
         L     R2,=A(N100AGY)                                                   
         LA    R2,20(R2)                                                        
         L     R3,=A(OTHAGYS)                                                   
         LA    R3,20(R3)           YES - SO ADD NO 100 TO OTHERS                
         BAS   RE,ADDLINE                                                       
         SPACE 1                                                                
         L     R3,=A(TOP100)         AND REMOVE FROM TOP 100                    
         LA    R3,20(R3)                                                        
         BAS   RE,SUBLINE                                                       
         SPACE 1                                                                
         LA    R2,AYYACS           ADD THIS ONE TO TOP 100                      
         L     R3,=A(TOP100)                                                    
         LA    R3,20(R3)                                                        
         BAS   RE,ADDLINE                                                       
         SPACE 1                                                                
         L     R2,=A(N100AGY)      THEN MOVE THIS INTO NO. 100                  
         MVC   0(20,R2),MYNAME                                                  
         MVC   20(96,R2),AYYACS                                                 
         L     R2,=A(TOPAGYS)      AND SORT TOP 100 DESCENDING                  
         GOTO1 XSORT,DMCB,(1,(R2)),100,116,8,28                                 
         B     XIT                                                              
         SPACE 1                                                                
TOPP2    LA    R2,AYYACS           NOT IN TOP 100                               
         L     R3,=A(OTHAGYS)                                                   
         LA    R3,20(R3)           SO ADD AGENCY TO OTHERS                      
         BAS   RE,ADDLINE                                                       
         B     XIT                                                              
         SPACE 3                                                                
BTPOST   NTR1                                                                   
         LA    R1,TYTABLE                                                       
         SPACE 1                                                                
BTPOST2  CLC   THISBRTY,0(R1)      LOOK FOR MATCH ON BILL TYPE                  
         BE    BTPOST4                                                          
         CLI   0(R1),X'FF'         OR OTHERS                                    
         BE    BTPOST4                                                          
         LA    R1,12(R1)                                                        
         B     BTPOST2                                                          
         SPACE 1                                                                
BTPOST4  LA    R2,AYMACS           ADD AGENCY TOTS INTO THIS TYPE               
         L     R3,8(R1)                                                         
         BAS   RE,JUSTADD                                                       
         B     XIT                                                              
         SPACE 1                                                                
         EJECT                                                                  
*              UTILITIES FOR TOTALS AND POSTING                                 
         SPACE 3                                                                
CLEARADD NTR1                                                                   
         LA    R0,36                                                            
         SPACE 1                                                                
CADD2    AP    0(8,R3),0(8,R2)                                                  
         ZAP   0(8,R2),=P'0'                                                    
         LA    R2,8(R2)                                                         
         LA    R3,8(R3)                                                         
         BCT   R0,CADD2                                                         
         B     XIT                                                              
         SPACE 1                                                                
JUSTCLER NTR1                                                                   
         LA    R0,36                                                            
         SPACE 1                                                                
JCLE2    ZAP   0(8,R2),=P'0'                                                    
         LA    R2,8(R2)                                                         
         BCT   R0,JCLE2                                                         
         B     XIT                                                              
         SPACE 1                                                                
JUSTADD  NTR1                                                                   
         LA    R0,36                                                            
         SPACE 1                                                                
JADD2    AP    0(8,R3),0(8,R2)                                                  
         LA    R2,8(R2)                                                         
         LA    R3,8(R3)                                                         
         BCT   R0,JADD2                                                         
         B     XIT                                                              
         EJECT                                                                  
*              ALL TOTAL EDIT CONTROL                                           
         SPACE 3                                                                
ALLTOTS  NTR1                                                                   
         LA    R3,MYP                                                           
         USING APPD,R3                                                          
         MVC   APPAGY+17(3),=C'MON'                                             
         BAS   RE,TOTLINE                                                       
         LA    R3,MYP2                                                          
         LA    R2,96(R2)                                                        
         MVC   APPAGY+17(3),=C'QTD'                                             
         BAS   RE,TOTLINE                                                       
         LA    R3,MYP3                                                          
         LA    R2,96(R2)                                                        
         MVC   APPAGY+17(3),=C'YTD'                                             
         BAS   RE,TOTLINE                                                       
         CLI   MEMOSW,C'Y'         IF MEMO SWITCH IS ON                         
         BNE   ALLTOTS6                                                         
         MVI   MEMOSW,C'N'                                                      
         L     R2,=V(MYBUFF)                                                    
         SPACE 1                                                                
ALLTOTS2 CLI   0(R2),0             LOOK FOR A SPOT IN THE BUFFER                
         BE    ALLTOTS4                                                         
         LA    R2,396(R2)                                                       
         B     ALLTOTS2                                                         
         SPACE 1                                                                
ALLTOTS4 MVC   000(132,R2),MYP                                                  
         MVC   132(132,R2),MYP2                                                 
         MVC   264(132,R2),MYP3                                                 
         SPACE 1                                                                
ALLTOTS6 BAS   RE,SPLAT                                                         
         BAS   RE,SPLAT                                                         
         B     XIT                                                              
         SPACE 1                                                                
TOTLINE  NTR1                                                                   
         USING APRREXP,R2                                                       
         LA    R4,APRREXP                                                       
         LA    R5,APPREXP                                                       
         LA    R1,MYTOTS           SAVE DECIMAL TOTALS HERE                     
         ST    R1,MYADDR           SAVE THIS ADDRESS FOR DOWNLOAD               
         LA    R0,11                                                            
         SPACE 1                                                                
TOTLINE2 BAS   RE,EDNUM                                                         
         LA    R4,8(R4)                                                         
         LA    R5,7(R5)                                                         
         LA    R1,7(R1)                                                         
         ST    R1,MYADDR           SAVE THIS ADDRESS FOR DOWNLOAD               
         BCT   R0,TOTLINE2                                                      
         SPACE 1                                                                
         ZAP   MYDUB,APRFEES       SHOW FEES AS % OF GROSS+REXP                 
         ZAP   MYDUB2,APRGROS                                                   
         AP    MYDUB2,APRREXP                                                   
         LA    R5,APPFEESP                                                      
         BAS   RE,PERCENT                                                       
         SPACE 1                                                                
         LA    R4,APRTAX           TAXES                                        
         LA    R5,APPTAX                                                        
         LA    R1,MYTAX            FOR DOWNLOAD                                 
         ST    R1,MYADDR                                                        
         BAS   RE,EDNUM                                                         
         SPACE 1                                                                
         ZAP   MYDUB,APRTAX        SHOW TAXES AS % OF GROSS                     
         ZAP   MYDUB2,APRGROS                                                   
         LA    R5,APPTAXP                                                       
         BAS   RE,PERCENT                                                       
         SPACE 1                                                                
         ZAP   MYDUB,APRFEES                                                    
         SP    MYDUB,APRTAX                                                     
         LA    R4,MYDUB                                                         
         LA    R5,APPNET                                                        
         LA    R1,MYNET            FOR DOWNLOAD                                 
         ST    R1,MYADDR                                                        
         BAS   RE,EDNUM                                                         
         SPACE 1                                                                
         ZAP   MYDUB,APRFEES       SHOW NET AS % OF GROSS+REXP                  
         SP    MYDUB,APRTAX                                                     
         ZAP   MYDUB2,APRGROS                                                   
         AP    MYDUB2,APRREXP                                                   
         LA    R5,APPNETP                                                       
         BAS   RE,PERCENT                                                       
         CLI   ACTEQU,ACTDOWN      DOWNLOADING?                                 
         BNE   XIT                                                              
         MVC   DOWNTOTS,APPREXP    YES,SAVE THIS FOR THE DOWNLOAD               
         B     XIT                                                              
         SPACE 1                                                                
EDNUM    NTR1                                                                   
         CP    0(8,R4),=P'0'       R4=A(PL8) R5=A(CL6)                          
         BE    XIT                                                              
         CP    0(8,R4),=P'99999'   IF UNDER $1000                               
         BH    EDNUM6                                                           
         CP    0(8,R4),=P'-99999'                                               
         BL    EDNUM6                                                           
         CLI   DOLLOPT,C'Y'                                                     
         BE    EDNUM1                                                           
         CLI   ACTEQU,ACTDOWN      DOWNLOADING? DON'T USE ASTERISK              
         BNE   EDNUMA              FOR DOWNLOAD, JUST REPORT                    
         EDIT  (P8,0(R4)),(15,MYAREA),5,FLOAT=-,ALIGN=LEFT                      
         L     R1,MYADDR           R1 GETS CLOBBERED BY EDIT                    
         MVC   0(4,R1),MYAREA      DECIMAL + 3 DEC PLACES                       
         CLI   MYAREA,C'-'         IF NEGATIVE, NEED TO MOVE AN                 
         BNE   *+10                EXTRA BYTE                                   
         MVC   4(1,R1),MYAREA+4                                                 
EDNUMA   MVI   5(R5),C'*'          SHOW AN ASTERISK                             
         B     XIT                                                              
         SPACE 1                                                                
EDNUM1   EDIT  (P8,0(R4)),(15,MYAREA),FLOAT=-                                   
         CLC   MYAREA(9),MYSPACES                                               
         BNE   EDNUM6                                                           
         MVC   1(4,R5),MYAREA+9    NUMBER IS UNDER $1000                        
         MVI   5(R5),C')'          DISPLAY AS (999)                             
         LA    R5,3(R5)                                                         
         SPACE 1                                                                
EDNUM2   CLI   0(R5),C' '                                                       
         BE    *+8                                                              
         BCT   R5,EDNUM2                                                        
         MVI   0(R5),C'('                                                       
         B     XIT                                                              
         SPACE 1                                                                
EDNUM6   ZAP   WKDUB,0(8,R4)       NUMBER IS OVER $1000                         
         AP    WKDUB,=P'50000'     ROUND TO NEAREST $1000                       
         BP    *+10                                                             
         SP    WKDUB,=P'100000'    (MAY BE NEGATIVE)                            
         EDIT  (P8,WKDUB),(15,MYAREA),FLOAT=-                                   
         MVC   0(6,R5),MYAREA+4                                                 
         B     XIT                                                              
         EJECT                                                                  
PERCENT  NTR1                                                                   
         MVI   WKDUB,0             MYDUB HAS AMOUNT, MYDUB2 HAS DIVISOR         
         MVC   WKDUB+1(7),MYDUB                                                 
         NI    WKDUB+7,X'F0'                                                    
         OI    WKDUB+7,X'0C'                                                    
         CP    MYDUB,=P'0'                                                      
         BP    *+8                                                              
         OI    WKDUB+7,X'01'                                                    
         CVB   R1,WKDUB                                                         
         LTR   R1,R1                                                            
         BZ    XIT                                                              
         SPACE 1                                                                
         MVI   WKDUB,0                                                          
         MVC   WKDUB+1(7),MYDUB2                                                
         NI    WKDUB+7,X'F0'                                                    
         OI    WKDUB+7,X'0C'                                                    
         CP    MYDUB2,=P'0'                                                     
         BP    *+8                                                              
         OI    WKDUB+7,X'01'                                                    
         CVB   RF,WKDUB                                                         
         LTR   RF,RF                                                            
         BZ    XIT                                                              
         SPACE 1                                                                
         M     R0,=F'2000'                                                      
         DR    R0,RF                                                            
         LTR   R1,R1                                                            
         BM    *+8                                                              
         AH    R1,=H'1'                                                         
         SRA   R1,1                                                             
         EDIT  (R1),(5,0(R5)),1,FLOAT=-                                         
         MVI   5(R5),C'%'                                                       
         CLI   0(R5),C'0'                                                       
         BL    XIT                                                              
         MVC   0(5,R5),=C' HIGH'                                                
         B     XIT                                                              
         SPACE 3                                                                
WKDUB    DS    D                                                                
MYDUB    DS    D                                                                
MYDUB2   DS    D                                                                
MYAREA   DS    CL15                                                             
         EJECT                                                                  
*              ROUTINE TO PUT A RECORD TO THE DATASET FOR DOWNLOADS             
         SPACE 1                                                                
PUTIT    NTR1                                                                   
         USING DISKRECD,R3                                                      
         LA    R3,DISKREC                                                       
         MVC   DISKREC(DISKREXP-DISKKEY),MYSPACES                               
         MVC   DISKAGYN,MYNAME     AGENCY NAME                                  
         MVC   DISKAGY,THISAGY     AGENCY CODE                                  
         MVC   DISKOFF,THISOFF     OFFICE CODE                                  
         EDIT  (1,THISBRTY),(2,DISKBTYP),ALIGN=LEFT  BILLING TYPE               
*                                                                               
         OC    MYTOTS,MYSPACES                                                  
         OC    MYNET,MYSPACES                                                   
         OC    MYTAX,MYSPACES                                                   
*                                                                               
         LA    R5,DISKREXP         STORE TOTALS HERE                            
         LA    R4,DOWNTOTS         ALL PRINTABLE TOTALS INCLUDING *'S           
         LA    R2,MYTOTS           DECIMALS STORED INSTEAD OF *'S               
         LA    R0,11                                                            
PUTIT20  CLI   5(R4),C'*'          IF THERE IS A * REPLACE WITH DECIMAL         
         BNE   PUTIT30                                                          
         MVC   0(6,R5),0(R2)                                                    
         B     *+10                                                             
PUTIT30  MVC   0(6,R5),0(R4)                                                    
         LA    R5,6(R5)                                                         
         LA    R4,7(R4)                                                         
         LA    R2,7(R2)                                                         
         BCT   R0,PUTIT20                                                       
*                                                                               
         LA    R4,DOWNTOTS         STORE TAX AND NET TOTALS                     
         USING APPREXP,R4                                                       
         CLI   APPTAX+5,C'*'       REPLACE * WITH CORRESPONDING DECIMAL         
         BNE   PUTIT40                                                          
         MVC   DISKTAX,MYTAX                                                    
         B     *+10                                                             
PUTIT40  MVC   DISKTAX,APPTAX                                                   
         CLI   APPNET+5,C'*'                                                    
         BNE   PUTIT50                                                          
         MVC   DISKNET,MYNET                                                    
         B     *+10                                                             
PUTIT50  MVC   DISKNET,APPNET                                                   
*                                                                               
         MVC   DISKFEEP,APPFEESP   STORE PERCENTAGES                            
         MVC   DISKTAXP,APPTAXP                                                 
         MVC   DISKNETP,APPNETP                                                 
         DROP  R3,R4                                                            
*                                                                               
         L     R2,=A(TADOWN)       PUT EVERYTHING IN THE DATASET                
         PUT   (R2),(R3)                                                        
         XC    MYTOTS,MYTOTS                                                    
         BAS   RE,MYCLEAR          CLEAR P                                      
         B     XIT                                                              
*              ROUTINE TO GET FROM DATASET AND PRINT SECOND REPORT              
         SPACE 1                                                                
PREPD    NTR1                                                                   
         L     R8,ASPOOLD                                                       
         USING SPOOLD,R8                                                        
         BAS   RE,NEWPRTQ           SET NEW PRINT QUEUE REPORT                  
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
         MVI   FORCEHED,C'Y'                                                    
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD            DO NOT PRINT LOGOS                          
         USING MASTD,R2                                                         
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
         DROP  R2                                                               
*                                                                               
         L     R2,=A(TADOWN)                                                    
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK                                                       
         USING DLCBD,R3                                                         
         BAS   RE,INITDWN                                                       
*                                                                               
PREPD2   GET   (R2),DISKREC        GET FROM TEMP DATASET                        
         LA    R5,DISKREC                                                       
         USING DISKRECD,R5                                                      
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVI   DLCBLEN,L'DISKAGY                                                
         MVC   DLCBFLD(L'DISKAGY),DISKAGY    PASS AGENCY                        
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVI   DLCBLEN,L'DISKAGYN                                               
         MVC   DLCBFLD(L'DISKAGYN),DISKAGYN   PASS AGENCY NAME                  
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVI   DLCBLEN,L'DISKOFF                                                
         MVC   DLCBFLD(L'DISKOFF),DISKOFF   PASS OFFICE CODE                    
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVI   DLCBLEN,L'DISKBTYP                                               
         MVC   DLCBFLD(L'DISKBTYP),DISKBTYP   PASS BILLING TYPE                 
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R5,DISKREXP         R5 --> AMOUNTS                               
         DROP  R5                                                               
*                                                                               
         LA    R0,16               16 AMOUNTS -  6 CHARS EACH                   
PREPD3   MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBNUM     DATA TYPE IS NUMERIC                         
*                                                                               
         LA    R1,6                NUMBER COUNTER                               
         LR    R4,R5                                                            
PREPD10  CLI   0(R4),C' '          LOOK FOR NON SPACES                          
         BH    PREPD20                                                          
         LA    R4,1(R4)                                                         
         BCT   R1,PREPD10                                                       
         LR    R4,R5               IF ALL SPACES, JUST SEND 1ST SPACE           
         LA    R1,1                                                             
PREPD20  STC   R1,DLCBLEN          LENGTH OF NUMBER STRIPPED OF SPACES          
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    SEND NUMBER WITHOUT SPACES IN FRONT          
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R5,6(R5)                                                         
         BCT   R0,PREPD3                                                        
*                                                                               
         MVI   DLCBACT,DLCBEOL     END OF LINE                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         B     PREPD2                                                           
*                                                                               
NOMORE   CLOSE ((2))               CLOSE THE DATASET                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
         CLI   ACTNUM,ACTDOWN                                                   
         BE    NOMORE2                                                          
         L     R1,ALOGO            NO-OP SO DON'T END AGAIN                     
         MVC   0(2,R1),=X'07FE'                                                 
         B     XIT                                                              
NOMORE2  MVI   DLCBACT,DLCBEOR                                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         B     XIT                                                              
         EJECT                                                                  
*              ROUTINE TO SET UP SECOND REPORT ON QUEUE                         
*                                                                               
NEWPRTQ  NTR1                                                                   
         XC    SPECS,SPECS         CLEAR SPECS                                  
         XC    HEADHOOK,HEADHOOK   AND HEADLINE HOOK                            
         MVI   FORCEHED,C'Y'                                                    
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,ALOGOC                                                        
         USING LOGOD,R2                                                         
         MVI   LOGOTYPE,C'E'                                                    
         GOTO1 ALOGO,DMCB,(R2)     END REPORT LOGOS                             
*                                                                               
         TM    WHEN,X'20'          SOON?                                        
         BO    NPRT10                                                           
         GOTO1 VPRINT,DMCB,=C'CLOSE'                                            
*                                                                               
NPRT10   L     R2,ABOX                                                          
         USING BOXD,R2                                                          
         LA    RE,132                                                           
         ST    RE,BOXWIDTH         SET LENGTH OF PRINT LINE                     
*                                                                               
         L     RF,AMASTD                                                        
         USING MASTD,RF                                                         
         L     R2,AREMOT                                                        
         USING REMOTED,R2                                                       
         TM    WHEN,X'20'                                                       
         BZ    NPRT20                                                           
         XC    MCREMPQK,MCREMPQK                                                
         B     NPRT30                                                           
*                                                                               
NPRT20   MVC   REMOTABF,MCVPQBUF                                                
         MVC   REMOTADM,MCVDMGR                                                 
         MVC   REMOTAOP,MCVPQOPN                                                
         MVC   REMOTDST,MCDESTID                                                
         XC    MCALTREF,MCALTREF                                                
         MVI   REMOTCPY,C'1'                                                    
         MVI   REMOTCLS,C'Q'                                                    
         MVC   REMOTJID,=C'TGP'                                                 
NPRT30   MVC   REMOTKEY(11),SPACES                                              
         MVC   REMOTSYS(5),=C'APROF'                                            
         MVC   REMOTFRM(4),=C'DATA'                                             
         B     XIT                                                              
         DROP  R2                                                               
         EJECT                                                                  
*              ROUTINE TO SET UP SECOND REPORT ON QUEUE                         
*                                                                               
INITDWN  NTR1                                                                   
         XC    DLCBD(DLCBXLX),DLCBD                                             
         MVI   DLCBACT,DLCBINIT    INITIALIZE FOR DOWNLOAD                      
         LA    R1,SPLATDWN         A(HOOK ROUTINE FOR PRINTING)                 
         ST    R1,DLCBAPR                                                       
         LA    R1,P                A(PRINT LINE)                                
         ST    R1,DLCBAPL                                                       
         MVC   DLCBAED,EDITOR                                                   
         MVC   DLCXMAXL,=Y(L'P)    MAXIMUM LENGTH OF PRINT LINE                 
         MVI   DLCXDELC,C' '       DELIMITER                                    
         MVI   DLCXEOTC,C'"'       TEXT DELIMITER                               
         MVI   DLCXEOTA,C''''      TEXT DELIMITER ALTERNATE                     
         MVI   DLCXEOLC,X'5E'      SEMI-COLON FOR END OF LINE                   
         MVI   DLCXEORC,C':'       END OF REPORT                                
         GOTO1 =V(DLFLD),DLCBD                                                  
         B     XIT                                                              
         EJECT                                                                  
*              USER SUPPLIED PRINT ROUTINE - DOWNLOAD                           
         SPACE 1                                                                
SPLATDWN NTR1                                                                   
         GOTO1 SPOOL,DMCB,(R8)                                                  
         MVI   LINE,1              PREVENT PAGE BREAK                           
         B     XIT                                                              
         SPACE 2                                                                
         DROP  R8                                                               
RECDLEN  DS    CL1                                                              
DLBLOCK  DS    CL(DLCBXLX)                                                      
DISKREC  DS    CL142                                                            
DOWNTOTS DS    CL110                                                            
MYTOTS   DS    CL77                                                             
MYTAX    DS    CL6                                                              
MYNET    DS    CL6                                                              
MYADDR   DS    A                                                                
         EJECT                                                                  
*              ODD ROUTINES                                                     
         SPACE 3                                                                
YES      SR    R1,R1                                                            
         B     *+8                                                              
         SPACE 1                                                                
NO       LA    R1,1                                                             
         LTR   R1,R1                                                            
         B     XIT                                                              
         SPACE 1                                                                
GETNAME  NTR1                                                                   
         MVC   MYNAME,MYSPACES                                                  
         GOTO1 HIGH                                                             
         CLC   KEY(32),KEYSAVE                                                  
         BNE   XIT                                                              
         GOTO1 GETREC                                                           
         L     R6,AIO                                                           
         MVI   ELCODE,TANAELQ                                                   
         BAS   RE,GETEL                                                         
         BNE   XIT                                                              
         USING TANAD,R6                                                         
         ZIC   R1,TANALEN                                                       
         SH    R1,=H'3'                                                         
         EX    R1,*+8                                                           
         B     XIT                                                              
         MVC   MYNAME(0),TANANAME                                               
         DROP  R6                                                               
         SPACE 1                                                                
SETSKIP  NTR1                                                                   
         L     R5,ASPOOLD                                                       
         USING SPOOLD,R5                                                        
         MVI   FORCEHED,C'Y'                                                    
         DROP  R5                                                               
         B     XIT                                                              
         SPACE 1                                                                
SETPAGE  NTR1                                                                   
         L     R5,ASPOOLD                                                       
         USING SPOOLD,R5                                                        
         MVC   PAGE,=H'1'                                                       
         DROP  R5                                                               
         B     XIT                                                              
         SPACE 1                                                                
TRACEL   NTR1                                                                   
*                                  R2=LENGTH, R6=ADDRESS                        
         MVC   MYP,MYSPACES                                                     
         LR    R1,R2                                                            
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   MYP(0),0(R6)                                                     
         OC    MYP,MYSPACES                                                     
         GOTO1 HEXOUT,DMCB,(R6),MYP3,132,=C'SEP'                                
         LR    R1,R2                                                            
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   MYP2(0),MYP3                                                     
         MVC   MYP3,MYSPACES                                                    
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   MYP3(0),MYP4                                                     
         MVC   MYP4,MYSPACES                                                    
         BAS   RE,SPLAT                                                         
         BAS   RE,SPLAT                                                         
         B     XIT                                                              
         SPACE 1                                                                
SPLAT    NTR1                                                                   
         L     R5,ASPOOLD                                                       
         USING SPOOLD,R5                                                        
         MVC   P,MYP                                                            
         MVC   P2,MYP2                                                          
         MVC   P3,MYP3                                                          
         MVC   P4,MYP4                                                          
         GOTO1 SPOOL,DMCB,(R5)                                                  
         DROP  R5                                                               
         BAS   RE,MYCLEAR                                                       
         B     XIT                                                              
         SPACE 1                                                                
MYCLEAR  NTR1                                                                   
         MVI   MYP,C' '                                                         
         MVC   MYP+1(131),MYP                                                   
         MVC   MYP2,MYP                                                         
         MVC   MYP3,MYP                                                         
         MVC   MYP4,MYP                                                         
         MVC   MYSPACES,MYP                                                     
         B     XIT                                                              
         SPACE 1                                                                
         GETEL R6,DATADISP,ELCODE                                               
         SPACE 1                                                                
XIT      XIT1                                                                   
         EJECT                                                                  
*              SORT UTILITIES                                                   
         SPACE 3                                                                
SORTPUT  NTR1                                                                   
         AP    SRTCOUNT,=P'1'                                                   
         BAS   RE,SORTRACE                                                      
         CLI   SORTFRST,C'Y'                                                    
         BNE   SORTPUT2                                                         
         GOTO1 MYSORTER,DMCB,SORTCARD,RECCARD                                   
         MVI   SORTFRST,C'N'                                                    
         SPACE 1                                                                
SORTPUT2 GOTO1 MYSORTER,DMCB,=C'PUT',SORTIO                                     
         MVC   SVSRTCNT,SRTCOUNT                                                
         B     XIT                                                              
         SPACE 1                                                                
SORTRACE NTR1                                                                   
         CP    SRTCOUNT,TRALIMIT                                                
         BH    XIT                                                              
         MVI   MYP,X'BF'                                                        
         MVC   MYP+1(131),MYP                                                   
         MVC   MYP+60(16),RECTYPE                                               
         BAS   RE,SPLAT                                                         
         LA    R2,108              L'SORT                                       
         LA    R6,SORTIO                                                        
         BAS   RE,TRACEL                                                        
         B     XIT                                                              
         SPACE 1                                                                
         DS    0F                                                               
SORTFRST DC    C'Y'                                                             
SORTCARD DC    CL80'SORT FIELDS=(1,10,A),FORMAT=BI,WORK=1'                      
RECCARD  DC    CL80'RECORD TYPE=F,LENGTH=(108)'                                 
*                                                                               
TADOWN   DCB   DDNAME=TADOWN,DSORG=PS,RECFM=FB,MACRF=(GM,PM),          X        
               LRECL=125,BLKSIZE=1250,EODAD=NOMORE                              
         EJECT                                                                  
*              LTORG ETC                                                        
         SPACE 3                                                                
         LTORG                                                                  
SVSRTCNT DS    PL6                                                              
PZEROS   DC    12PL8'0'                                                         
MYNAME   DS    CL36                                                             
SMALLCNT DC    PL6'0'                                                           
THISBRTY DS    XL1                                                              
MEMOSW   DS    XL1                                                              
         SPACE 1                                                                
AYMACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
AYQACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
AYYACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
         SPACE 1                                                                
OFMACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
OFQACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
OFYACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
         SPACE 1                                                                
SMMACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
SMQACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
SMYACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
         SPACE 1                                                                
EMMACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
EMQACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
EMYACS   DS    0CL96                                                            
         DC    12PL8'0'                                                         
         SPACE 1                                                                
TYTABLE  DS    0F                                                               
         DC    AL1(01),CL7'TYPE 1 ',AL4(T01ACS)                                 
         DC    AL1(02),CL7'TYPE 2 ',AL4(T02ACS)                                 
         DC    AL1(06),CL7'TYPE 6 ',AL4(T06ACS)                                 
         DC    AL1(07),CL7'TYPE 7 ',AL4(T07ACS)                                 
         DC    AL1(08),CL7'TYPE 8 ',AL4(T08ACS)                                 
         DC    AL1(09),CL7'TYPE 9 ',AL4(T09ACS)                                 
         DC    AL1(10),CL7'TYPE 10',AL4(T10ACS)                                 
         DC    AL1(11),CL7'TYPE 11',AL4(T11ACS)                                 
         DC    AL1(12),CL7'TYPE 12',AL4(T12ACS)                                 
         DC    AL1(13),CL7'TYPE 13',AL4(T13ACS)                                 
         DC    AL1(18),CL7'TYPE 18',AL4(T18ACS)                                 
         DC    AL1(99),CL7'TYPE 99',AL4(T99ACS)                                 
         DC    X'FF',CL7'OTHERS ',AL4(TOTACS)                                   
T01ACS   DC    36PL8'0'                                                         
T02ACS   DC    36PL8'0'                                                         
T06ACS   DC    36PL8'0'                                                         
T07ACS   DC    36PL8'0'                                                         
T08ACS   DC    36PL8'0'                                                         
T09ACS   DC    36PL8'0'                                                         
T10ACS   DC    36PL8'0'                                                         
T11ACS   DC    36PL8'0'                                                         
T12ACS   DC    36PL8'0'                                                         
T13ACS   DC    36PL8'0'                                                         
T18ACS   DC    36PL8'0'                                                         
T99ACS   DC    36PL8'0'                                                         
TOTACS   DC    36PL8'0'                                                         
         SPACE 1                                                                
TOPAGYS  DS    0D                                                               
         DC    CL20' ',12PL8'0'    THERE ARE 100 OF THESE                       
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
         DC    CL20' ',12PL8'0'                                                 
N100AGY  DC    CL20' ',12PL8'0'                                                 
TOP100   DC    CL20'TOTAL TOP 100  ',12PL8'0'                                   
OTHAGYS  DC    CL20'OTHER AGENCIES ',12PL8'0'                                   
ALLAGYS  DC    CL20'TOTAL EMPLOYER ',12PL8'0'                                   
         EJECT                                                                  
*               AREAS NOT DIRECTLY ADDRESSABLE                                  
         SPACE 3                                                                
APH6     DS     0H                                                              
         DC    CL01' '                                                          
         DC    CL20'       AGENCY'                                              
         DC    CL01' '                                                          
         DC    CL06'REIMB.'                                                     
         DC    CL01' '                                                          
         DC    CL06' GROSS'                                                     
         DC    CL01' '                                                          
         DC    CL06'FICA'                                                       
         DC    CL01' '                                                          
         DC    CL06'MDCARE'                                                     
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL01' '                                                          
         DC    CL06' U.C. '                                                     
         DC    CL01'W'                                                          
         DC    CL06'AGES'                                                       
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL01' '                                                          
         DC    CL06'FED UC'                                                     
         DC    CL01' '                                                          
         DC    CL06' BREAK'                                                     
         DC    CL01' '                                                          
         DC    CL06' GROSS'                                                     
         DC    CL06' FEES '                                                     
         DC    CL01' '                                                          
         DC    CL06'  EMPL'                                                     
         DC    CL06'OYER  '                                                     
         DC    CL01' '                                                          
         DC    CL06' NET R'                                                     
         DC    CL07'EVENUE'                                                     
         DC    CL01' '                                                          
         SPACE 1                                                                
APH7     DS     0H                                                              
         DC    CL01' '                                                          
         DC    CL20' '                                                          
         DC    CL01' '                                                          
         DC    CL06'EXPNSE'                                                     
         DC    CL01' '                                                          
         DC    CL06' WAGES'                                                     
         DC    CL01' '                                                          
         DC    CL06'    WA'                                                     
         DC    CL01'G'                                                          
         DC    CL06'ES'                                                         
         DC    CL01' '                                                          
         DC    CL06'  N.Y.'                                                     
         DC    CL01' '                                                          
         DC    CL06'  ILL.'                                                     
         DC    CL01' '                                                          
         DC    CL06' CALIF'                                                     
         DC    CL01' '                                                          
         DC    CL06'OTHERS'                                                     
         DC    CL01' '                                                          
         DC    CL06' WAGES'                                                     
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL06' '                                                          
         DC    CL01' '                                                          
         DC    CL06'   TAX'                                                     
         DC    CL06'ES'                                                         
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL07' '                                                          
         DC    CL01' '                                                          
         SPACE 1                                                                
APCOL    DS     0H                                                              
         DC    CL01'L'                                                          
         DC    CL20' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL01' '                                                          
         DC    CL06' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL06' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL06' '                                                          
         DC    CL01'C'                                                          
         DC    CL06' '                                                          
         DC    CL07' '                                                          
         DC    CL01'R'                                                          
         EJECT                                                                  
       ++INCLUDE DDDLCB                                                         
       ++INCLUDE TAREP2BMY                                                      
*              DSECT TO COVER AP SORT RECORD                                    
         SPACE 3                                                                
APRD     DSECT                                                                  
APRREC   DS    0CL(APRRECX-APRKEY)                                              
APRKEY   DS    0C                                                               
APREMP   DS    CL3                 EMPLOYER                                     
APROFF   DS    CL1                 OFFICE                                       
APRAGY   DS    CL6                 AGENCY                                       
APRMON   DS    XL1                                                              
APRQRT   DS    XL1                                                              
APRREXP  DS    PL8                                                              
APRGROS  DS    PL8                                                              
APRFCAW  DS    PL8                                                              
APRMEDW  DS    PL8                                                              
APRNYUW  DS    PL8                                                              
APRILUW  DS    PL8                                                              
APRCAUW  DS    PL8                                                              
APROTUW  DS    PL8                                                              
APRFDUW  DS    PL8                                                              
APRBRKW  DS    PL8                                                              
APRFEES  DS    PL8                                                              
APRTAX   DS    PL8                                                              
APRRECX  EQU   *                                                                
         EJECT                                                                  
*              DSECT TO COVER DISKREC (FOR DOWNLOAD)                            
         SPACE 1                                                                
DISKRECD DSECT                                                                  
DISKKEY  DS    0C                                                               
DISKAGY  DS    CL06                                                             
DISKAGYN DS    CL20                                                             
DISKOFF  DS    CL01                                                             
DISKBTYP DS    CL02                                                             
DISKREXP DS    CL06                                                             
DISKGROS DS    CL06                                                             
DISKFCAW DS    CL06                                                             
DISKMEDW DS    CL06                                                             
DISKNYUW DS    CL06                                                             
DISKILUW DS    CL06                                                             
DISKCAUW DS    CL06                                                             
DISKOTUW DS    CL06                                                             
DISKFDUW DS    CL06                                                             
DISKBRKW DS    CL06                                                             
DISKFEES DS    CL06                                                             
DISKFEEP DS    CL06                                                             
DISKTAX  DS    CL06                                                             
DISKTAXP DS    CL06                                                             
DISKNET  DS    CL06                                                             
DISKNETP DS    CL06                                                             
DISKRECX EQU   *                                                                
         EJECT                                                                  
         SPACE 3                                                                
         EJECT                                                                  
*              DSECT TO COVER PRINT LINE                                        
         SPACE 1                                                                
APPD     DS    0H                                                               
         DS    CL01                                                             
APPAGY   DS    CL20                                                             
         DS    CL01                                                             
APPREXP  DS    CL06                                                             
         DS    CL01                                                             
APPGROS  DS    CL06                                                             
         DS    CL01                                                             
APPFCAW  DS    CL06                                                             
         DS    CL01                                                             
APPMEDW  DS    CL06                                                             
         DS    CL01                                                             
APPNYUW  DS    CL06                                                             
         DS    CL01                                                             
APPILUW  DS    CL06                                                             
         DS    CL01                                                             
APPCAUW  DS    CL06                                                             
         DS    CL01                                                             
APPOTUW  DS    CL06                                                             
         DS    CL01                                                             
APPFDUW  DS    CL06                                                             
         DS    CL01                                                             
APPBRKW  DS    CL06                                                             
         DS    CL01                                                             
APPFEES  DS    CL06                                                             
APPFEESP DS    CL06                                                             
         DS    CL01                                                             
APPTAX   DS    CL06                                                             
APPTAXP  DS    CL06                                                             
         DS    CL01                                                             
APPNET   DS    CL06                                                             
         DS    CL01                                                             
APPNETP  DS    CL06                                                             
         DS    CL01                                                             
         EJECT                                                                  
*              OTHER DSECTS ARE HIDDEN IN HERE                                  
         SPACE 3                                                                
*TAREPWORKD                                                                     
*DDSPOOLD                                                                       
*DDSPLWORKD                                                                     
*TAGENFILE                                                                      
*TALIMD                                                                         
         PRINT OFF                                                              
       ++INCLUDE TAREPWORKD                                                     
         PRINT OFF                                                              
       ++INCLUDE DDSPOOLD                                                       
         PRINT OFF                                                              
       ++INCLUDE DDSPLWORKD                                                     
       ++INCLUDE DDREMOTED                                                      
       ++INCLUDE DDMASTD                                                        
       ++INCLUDE DDLOGOD                                                        
       ++INCLUDE DDBIGBOX                                                       
       ++INCLUDE TAGENFILE                                                      
       ++INCLUDE TALIMD                                                         
       ++INCLUDE TAREPFFD                                                       
       ++INCLUDE DDGENTWA                                                       
         PRINT ON                                                               
         SPACE 1                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'106TAREP2BAP 02/05/14'                                      
         END                                                                    
