*          DATA SET GELDDCNT   AT LEVEL 008 AS OF 06/23/20                      
*CATALP GELDDCNT                                                                
         TITLE 'LDCOUNT - GENFIL/GENDIR - DIR REC TYPE COUNT/PRINT'             
***********************************************************************         
*  XL1   ACTION  X'01'=COUNT,X'81'=COUNT DELETED PASSIVE,X'FF'=PRINT  *         
*  AL3   A(RECORD)                                                    *         
*  XL1   FILE NUMBER                                                  *         
*  AL3   A(FILE NAME)                                                 *         
***********************************************************************         
         PRINT NOGEN                                                            
LDCOUNT  CSECT                                                                  
         NMOD1 WRKX-WRKD,GELDDCNT,R7                                            
         USING WRKD,RC                                                          
*                                                                               
         MVC   BYTE,0(R1)                                                       
         CLI   BYTE,X'FF'          TEST PRINT ACTION                            
         BE    LDPRNT                                                           
         CLI   BYTE,X'81'                                                       
         BE    LDCOUNTX                                                         
*                                                                               
         CLI   4(R1),X'A1'         TEST CTFILE (CALL FROM DMRCVDMP)             
         BE    LDCOUNT9                                                         
         CLI   4(R1),X'AE'         TEST GENDIR                                  
         BE    *+12                                                             
         CLI   4(R1),X'AF'         TEST GENFILE                                 
         BNE   LDCOUNTX                                                         
*                                                                               
         L     R2,0(R1)            R2=A(RECORD)                                 
         LA    R3,KEYTAB                                                        
                                                                                
LDCOUNT1 XR    R1,R1                                                            
         XR    RE,RE                                                            
         IC    RE,0(R3)            GET INDEX FOR COUNT TABLE                    
         ICM   R1,1,1(R3)          GET LEN FOR COMPARE                          
         BZ    LDCOUNT3            ZERO LEN IS END OF TABLE                     
         BCTR  R1,0                                                             
         EX    R1,*+8              TEST KEY                                     
         B     *+10                                                             
         CLC   0(0,R2),2(R3)                                                    
         BE    LDCOUNT2                                                         
         LA    R3,3(R1,R3)         NOT MATCHED SO TRY NEXT KEY                  
         B     LDCOUNT1                                                         
*                                                                               
LDCOUNT2 CLI   2(R2),GMKRECQ       IF MESSAGE RECORD                            
         BNE   LDCOUNT5                                                         
         CLI   GMKTYP-GMSGD(R2),GMKTGDIC SEPARATE NEW STYLE DATA                
         BNE   LDCOUNT5                  DICTIONARY FROM OTHERS                 
         LA    RE,19               INDEX FOR COUNT TABLE                        
         B     LDCOUNT6                                                         
*                                                                               
LDCOUNT3 TM    32(R2),X'80'        TEST RECORD MARKED FOR DELETION              
         BNZ   LDCOUNT5            YES-DON'T PRINT IT                           
         LA    RF,XXX                                                           
         ICM   RF,15,0(RF)                                                      
         CHI   RF,100              MORE THAN 100 UNKNOWN RECORDS?               
         BL    LDCOUNT4                                                         
         BH    LDCOUNT5                                                         
         LR    R4,RE                                                            
         L     RA,=V(CPRINT)       PRINT HEADING                                
         USING DPRINT,RA                                                        
         ZAP   LINE,=P'1'                                                       
         MVC   P,SPACES                                                         
         MVC   P(39),=C'DCNT-UNKNOWN KEY MAXIMUM PRINT EXCEEDED'                
         GOTO1 =V(PRINTER)                                                      
         LR    RE,R4                                                            
         B     LDCOUNT5                                                         
         DROP  RA                                                               
                                                                                
LDCOUNT4 L     RA,=V(CPRINT)       PRINT HEADING                                
         USING DPRINT,RA                                                        
         ZAP   LINE,=P'1'                                                       
         MVC   P,SPACES                                                         
         MVC   P(16),=C'DCNT-UNKNOWN KEY'                                       
         LR    R4,RE                                                            
         GOTO1 =V(HEXOUT),DMCB,0(R2),P+17,32,0                                  
         GOTO1 =V(PRINTER)                                                      
         LR    RE,R4                                                            
         DROP  RA                                                               
*                                                                               
LDCOUNT5 DS    0H                                                               
*&&UK*&& B     LDCOUNT6                                                         
         CHI   RE,30               TEST DEMOSTA KEY                             
         BNE   LDCOUNT6                                                         
         TM    32(R2),X'40'        TEST PASSIVE KEY                             
         BZ    LDCOUNT6                                                         
         LHI   RE,31               YES-SET CORRECT INDEX IN TABLE               
*                                                                               
LDCOUNT6 MHI   RE,4                LOCATE REAL ADDRESS IN COUNT TABLE           
         L     RE,ADRTAB(RE)                                                    
*                                                                               
LDCOUNT8 TM    32(R2),X'80'        TEST RECORD MARKED FOR DELETION              
         BZ    *+8                                                              
         LA    RE,4(RE)                                                         
         ICM   RF,15,0(RE)                                                      
         LA    RF,1(RF)                                                         
         STCM  RF,15,0(RE)                                                      
         LA    RE,FTS                                                           
         TM    32(R2),X'80'                                                     
         BZ    *+8                                                              
         LA    RE,4(RE)                                                         
         ICM   RF,15,0(RE)                                                      
         LA    RF,1(RF)                                                         
         STCM  RF,15,0(RE)                                                      
         B     LDCOUNTX                                                         
*                                                                               
LDCOUNT9 L     R2,0(R1)            R2=A(CTFILE RECORD) FROM DMRCVDMP            
         LA    RE,CTF              RE=A(CTFILE RECORD TABLE ENTRY)              
         TM    27(R2),X'80'                                                     
         BZ    *+8                                                              
         LA    RE,4(RE)            POINT TO DELETED COUNT                       
         ICM   RF,15,0(RE)                                                      
         LA    RF,1(RF)                                                         
         STCM  RF,15,0(RE)                                                      
         LA    RE,FTS                                                           
         TM    27(R2),X'80'                                                     
         BZ    *+8                                                              
         LA    RE,4(RE)                                                         
         ICM   RF,15,0(RE)                                                      
         LA    RF,1(RF)                                                         
         STCM  RF,15,0(RE)                                                      
         B     LDCOUNTX                                                         
*                                                                               
LDPRNT   L     RA,=V(CPRINT)       PRINT HEADING                                
         USING DPRINT,RA                                                        
         ZAP   LINE,=P'99'                                                      
         L     RE,4(R1)                                                         
         MVC   HEADL+8(8),0(RE)    FILE NAME=GENDIR FROM DMLDMOD                
         OC    CTF(8),CTF          TEST IF CTFILE ENTRIES FROM DMRCVDMP         
         BZ    *+10                                                             
         MVC   HEADL+8(8),=C'GEN/CTF '                                          
         MVC   P,SPACES                                                         
         MVC   P(HEADLQ),HEADL                                                  
         GOTO1 =V(PRINTER)                                                      
         MVC   P(UNDRLQ),UNDRL                                                  
         GOTO1 =V(PRINTER)                                                      
*                                                                               
         LA    R2,COUNTS                                                        
         USING RDESD,R2                                                         
         USING PLINED,P                                                         
LDPRNT1  CLI   0(R2),X'FF'                                                      
         BE    LDCOUNTX                                                         
         OC    0(8,R2),0(R2)                                                    
         BZ    LDPRNT5                                                          
         MVC   PLNAME,RDNAME       RECORD TYPE NAME                             
         MVC   PLREC,RDREC         RECORD DSECT                                 
         MVC   PLPAN,RDPAN         PANVALET MEMBER                              
*                                                                               
LDPRNT2  ICM   R0,15,RDCOUNT       ACTIVE COUNT                                 
         BNZ   *+14                                                             
         MVC   PLCOUNT,=9C'.'                                                   
         B     LDPRNT3                                                          
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  PLCOUNT,DUB                                                      
*                                                                               
LDPRNT3  ICM   R1,15,RDDELS        DELETED COUNT                                
         BNZ   *+14                                                             
         MVC   PLDELS,=9C'.'                                                    
         B     LDPRNT4                                                          
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  PLDELS,DUB                                                       
*                                                                               
LDPRNT4  AR    R1,R0               TOTAL COUNT                                  
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  PLTOT,DUB                                                        
         GOTO1 =V(PRINTER)                                                      
*                                                                               
LDPRNT5  LA    R2,RDESLQ(R2)                                                    
         B     LDPRNT1                                                          
         DROP  R2                                                               
*                                                                               
LDCOUNTX XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
HEADL    DC    CL50'REC TYP XXXXXXX  ACTIVE     DELETED    TOTAL      '         
         DC    CL50'  DSECT NAME  PAN MEMBER                          '         
HEADLQ   EQU   *-HEADL                                                          
UNDRL    DC    CL50'---------------  ---------  ---------  ---------  '         
         DC    CL50'  ----------  ----------                          '         
UNDRLQ   EQU   *-UNDRL                                                          
                                                                                
*&&UK                                                                           
***********************************************************************         
* TABLE OF KNOWN GENDIR/GENFIL KEY FORMATS FOR UK                     *         
* AL1(INDEX FOR ADRTAB)                                               *         
* X'LL' LENGTH OF KEY TO COMPARE                                      *         
* KEY DATA FOR LENGTH OF LL                                           *         
***********************************************************************         
KEYTAB   DS    0F                          UK KEY TABLE                         
         DC    AL1(00),X'1F',31X'00'       HEADER                               
         DC    AL1(01),X'03',X'00000A'     ACCESS                               
         DC    AL1(02),X'03',X'00000B'     DEPARTMENT                           
         DC    AL1(03),X'03',X'00000F'     PUBLIC IDS                           
         DC    AL1(04),X'03',X'0000',C'C'  CURRENCY                             
         DC    AL1(05),X'03',X'0000',C'E'  EXCHANGE                             
         DC    AL1(06),X'03',X'0000',C'M'  MESSAGE                              
         DC    AL1(07),X'03',X'0000',C'N'  NARRATIVE                            
         DC    AL1(08),X'02',X'0002'       HELP                                 
         DC    AL1(09),X'02',X'0003'       DRIVER DICTIONARY                    
         DC    AL1(10),X'02',X'0009'       BROADCAST                            
         DC    AL1(11),X'03',X'00',C'FC'   CHANNEL CONFIG   (FEES)              
         DC    AL1(12),X'03',X'00',C'FN'   NAT INSURANCE    (FEES)              
         DC    AL1(13),X'03',X'00',C'FP'   PAYMENT PARMS    (FEES)              
         DC    AL1(14),X'03',X'00',C'FR'   ROLE DESCRIPTION (FEES)              
         DC    AL1(15),X'03',X'000010'     EXTRACT AGENCY                       
         DC    AL1(16),X'03',X'000020'     EXTRACT TRANSFER CONTROL             
         DC    AL1(17),X'03',X'000030'     EXTRACT FILE                         
         DC    AL1(18),X'03',X'000040'     EXTRACT SYSTEM LOG                   
         DC    AL1(20),X'03',X'000094'     EQUATE NAME (PASSIVE)                
         DC    AL1(21),X'03',X'000099'     RFP RULE #  (PASSIVE)                
         DC    AL1(22),X'03',X'0000',C'P'  PCPAK DATA RECORDS                   
         DC    AL1(23),X'03',X'000097'     PCPAK DATA (PASSIVE)                 
         DC    AL1(24),X'03',X'00',C'AB'   BLZ RECORD                           
         DC    AL1(25),X'03',X'00',C'XA'   NFILE ACTION RECORDS                 
         DC    AL1(26),X'03',X'00',C'XD'   NFILE DOWNLOAD RECORDS               
         DC    AL1(27),X'03',X'00',C'XF'   NFILE FIELD RECORDS                  
         DC    AL1(28),X'03',X'00',C'XP'   NFILE PFKEY RECORDS                  
         DC    AL1(29),X'03',X'00',C'XR'   NFILE RECORD RECORDS                 
         DC    AL1(30),X'03',X'00',C'XS'   NFILE SCREEN RECORDS                 
         DC    AL1(31),X'03',X'00',C'XX'   NFILE DEFAULT COLUMN RECORDS         
         DC    AL1(32),X'03',X'00',C'BS'   BOOK SCRIPT RECORDS                  
         DC    AL1(33),X'01',X'FF'         FOOTER RECORD                        
         DC    AL1(34),X'03',X'00',C'AD'   FB DATA SOURCE RECORDS               
         DC    AL1(35),X'03',X'00',C'AK'   FB KEYWORD LIST RECORDS              
         DC    AL1(36),X'03',X'00',C'AR'   FB REPORT RECORD                     
         DC    AL1(37),X'03',X'000060'     TRANSFORMATION CONTROL               
         DC    AL1(38),X'03',X'000080'     EXTERNAL LOGIN INFORMATION           
         DC    AL1(39),X'03',X'000021'     ESS SERVER PASSIVES                  
         DC    AL1(40),X'03',X'000032'     ESS SERVER FILE PASSIVE              
         DC    AL1(41),X'03',X'000050'     ESS ID RECORD GEGENESS               
         DC    AL1(42),X'03',X'000700'     BROADCAST RECORDS                    
         DC    AL1(43),X'03',X'000031'     ESS AGENCY FILE PASSIVE              
         DC    AL1(44),X'03',X'000800'     TVDATA RECORD (CTGENBRD)             
         DC    AL1(45),X'02',X'0012'       XFILE GROUP POINTER                  
         DC    AL1(46),X'03',X'002FC1'     RLP ACC RECORDS                      
         DC    AL1(47),X'03',X'002FC3'     RLP CON RECORDS                      
         DC    AL1(48),X'03',X'002FD4'     RLP MED RECORDS                      
         DC    AL1(49),X'03',X'003200'     UNDEFINED RECORD (1)                 
         DC    AL1(50),X'03',X'005400'     OLD SFM STAFF RECORD                 
         DC    AL1(51),X'03',X'00',C'AA'   FLEXIBILL HEADER RECORD              
         DC    AL1(52),X'03',X'00C603'     OLD NEWS CH. CONFIGS                 
         DC    AL1(53),X'03',X'00',C'FT'   TVR BAND RECORDS (FEE)               
         DC    AL1(54),X'00'               UNKNOWN RECORD (OTHERS)              
*                                                                               
ADRTAB   DC    A(FHD),A(ACS),A(DPT),A(PID) 00-03 UK ADDRESS TABLE               
         DC    A(CUR),A(EXC),A(MSG),A(NRT) 04-07                                
         DC    A(HLP),A(DIC),A(BRD),A(CHN) 08-11                                
         DC    A(NAT),A(PAY),A(ROL),A(XAG) 12-15                                
         DC    A(XTR),A(XFI),A(XLO),A(DDC) 16-19                                
         DC    A(EQN),A(RFP),A(PAK),A(PAV) 20-23                                
         DC    A(BLZ),A(NAR),A(NDR),A(NFR) 24-27                                
         DC    A(NPR),A(NRR),A(NSR),A(NXR) 28-31                                
         DC    A(BSR),A(FTR),A(FBD),A(FBK) 32-35                                
         DC    A(FBR),A(TCR),A(XLI),A(ESP) 36-39                                
         DC    A(EFP),A(EIR),A(BCR),A(EAF) 40-43                                
         DC    A(TVD),A(XGP),A(RRA),A(RRC) 44-47                                
         DC    A(RRM),A(UD1),A(OSR),A(FHR) 48-51                                
         DC    A(ONC),A(TVR)               52-53                                
         DC    A(XXX)                                                           
*                                                                               
         DS    0D                                                               
COUNTS   DS    0XL44      KEEP THIS UK COUNT TABLE IN ALPHA ORDER               
*                                                                               
ACS      DC    2F'0',CL16'ACCESS          ',C'ACCSD     ',C'GEGENACS  '         
BLZ      DC    2F'0',CL16'BANK SORT CODE  ',C'          ',C'          '         
BSR      DC    2F'0',CL16'BOOK SCRIPT     ',C'          ',C'          '         
BCR      DC    2F'0',CL16'BROADCAST (07)  ',C'          ',C'          '         
BRD      DC    2F'0',CL16'BROADCAST       ',C'          ',C'          '         
CHN      DC    2F'0',CL16'CHANNEL CONFIG  ',C'          ',C'          '         
CUR      DC    2F'0',CL16'CURRENCY        ',C'          ',C'          '         
DDC      DC    2F'0',CL16'DATA DICT       ',C'          ',C'          '         
DPT      DC    2F'0',CL16'DEPARTMENT      ',C'          ',C'          '         
DIC      DC    2F'0',CL16'DICTIONARY      ',C'          ',C'          '         
EQN      DC    2F'0',CL16'EQUATE NAME    P',C'          ',C'          '         
EAF      DC    2F'0',CL16'ESS AGY FILE   P',C'          ',C'          '         
EIR      DC    2F'0',CL16'ESS ID          ',C'          ',C'          '         
EFP      DC    2F'0',CL16'ESS SERVER FIL P',C'          ',C'          '         
ESP      DC    2F'0',CL16'ESS SERVER     P',C'          ',C'          '         
EXC      DC    2F'0',CL16'EXCHANGE        ',C'          ',C'          '         
XLI      DC    2F'0',CL16'EXTERNAL LOGIN  ',C'          ',C'          '         
XAG      DC    2F'0',CL16'EXTRACT AGENCY  ',C'          ',C'          '         
XFI      DC    2F'0',CL16'EXTRACT FILE    ',C'          ',C'          '         
XLO      DC    2F'0',CL16'EXTRACT SYS LOG ',C'          ',C'          '         
XTR      DC    2F'0',CL16'EXTRACT TRANS   ',C'          ',C'          '         
FBD      DC    2F'0',CL16'FB DATA SOURCE  ',C'          ',C'          '         
FHR      DC    2F'0',CL16'FB HEADER       ',C'          ',C'          '         
FBK      DC    2F'0',CL16'FB KEYWORD LIST ',C'          ',C'          '         
FBR      DC    2F'0',CL16'FB REPORT       ',C'          ',C'          '         
FHD      DC    2F'0',CL16'FILE HEADER     ',C'          ',C'          '         
FTR      DC    2F'0',CL16'FILE TRAILER    ',C'          ',C'          '         
HLP      DC    2F'0',CL16'HELP            ',C'          ',C'          '         
MSG      DC    2F'0',CL16'MESSAGE         ',C'          ',C'          '         
NRT      DC    2F'0',CL16'NARRATIVE       ',C'          ',C'          '         
NAT      DC    2F'0',CL16'NAT INSURANCE   ',C'          ',C'          '         
NAR      DC    2F'0',CL16'NFILE ACTION    ',C'          ',C'          '         
NXR      DC    2F'0',CL16'NFILE DEF COL   ',C'          ',C'          '         
NDR      DC    2F'0',CL16'NFILE DOWNLOAD  ',C'          ',C'          '         
NFR      DC    2F'0',CL16'NFILE FIELD     ',C'          ',C'          '         
NPR      DC    2F'0',CL16'NFILE PFKEY     ',C'          ',C'          '         
NRR      DC    2F'0',CL16'NFILE RECORD    ',C'          ',C'          '         
NSR      DC    2F'0',CL16'NFILE SCREEN    ',C'          ',C'          '         
ONC      DC    2F'0',CL16'OLD NEWS CONF   ',C'          ',C'          '         
OSR      DC    2F'0',CL16'OLD SFM STAFF   ',C'          ',C'          '         
PAY      DC    2F'0',CL16'PAYMENT PARMS   ',C'          ',C'          '         
PAK      DC    2F'0',CL16'PCPAK DATA FILE ',C'          ',C'          '         
PAV      DC    2F'0',CL16'PCPAK VERSION  P',C'          ',C'          '         
PID      DC    2F'0',CL16'PUBLIC-ID       ',C'          ',C'          '         
RFP      DC    2F'0',CL16'RFP RULE NUM   P',C'          ',C'          '         
RRA      DC    2F'0',CL16'RLP ACCOUNTING  ',C'          ',C'          '         
RRC      DC    2F'0',CL16'RLP CONTROL     ',C'          ',C'          '         
RRM      DC    2F'0',CL16'RLP MEDIA       ',C'          ',C'          '         
ROL      DC    2F'0',CL16'ROLE DESCRIPTN  ',C'          ',C'          '         
TCR      DC    2F'0',CL16'TRANS CONTROL   ',C'          ',C'          '         
TVD      DC    2F'0',CL16'TV DATA         ',C'BRDKEYD   ',C'CTGENBRD  '         
TVR      DC    2F'0',CL16'TVR BAND        ',C'          ',C'          '         
UD1      DC    2F'0',CL16'UNDEF 003200    ',C'          ',C'          '         
XGP      DC    2F'0',CL16'XFILE GROUP PTR ',C'          ',C'          '         
*                                                                               
CTF      DC    2F'0',CL16'CTFILE RECORDS  ',CL10' ',CL10' '                     
XXX      DC    2F'0',CL16'UNKNOWN         ',CL10' ',CL10' '                     
FTS      DC    2F'0',CL16'FILE TOTALS     ',CL10'-',CL10'-'                     
         DC    X'FF'                                                            
*&&                                                                             
         EJECT                                                                  
*&&US                                                                           
***********************************************************************         
* TABLE OF KNOWN GENDIR/GENFIL KEY FORMATS FOR US                               
* AL1(INDEX FOR ADRTAB)                                                         
* X'LL' LENGTH OF KEY TO COMPARE                                                
* KEY DATA FOR LENGTH OF LL                                                     
***********************************************************************         
KEYTAB   DS    0F                  * KEEP THIS TABLE IN NUMERIC ORDER *         
         DC    AL1(01),X'1F',X'000000',XL28'00' HEADER                          
         DC    AL1(19),X'03',X'0000',X'0A'      ACCESS                          
         DC    AL1(02),X'03',X'0000',X'0B'      DEPARTMENT                      
         DC    AL1(03),X'03',X'0000',X'0F'      PUBLIC IDS                      
         DC    AL1(15),X'03',X'0000',X'10'      EXTRACT AGENCY                  
         DC    AL1(16),X'03',X'0000',X'20'      EXTRACT XFER CONTROL            
         DC    AL1(39),X'03',X'0000',X'21'      XTRANS PASSIVE                  
         DC   AL1(106),X'03',X'0000',X'22'      ESS SERVER ID PASSIVE           
         DC    AL1(17),X'03',X'0000',X'30'      EXTRACT FILE                    
         DC    AL1(73),X'03',X'0000',X'31'      XFILE AGY PASSVE                
         DC    AL1(74),X'03',X'0000',X'32'      XFILE ESSID PASSVE              
         DC    AL1(18),X'03',X'0000',X'40'      EXTRACT SYSTEM LOG              
         DC    AL1(34),X'03',X'0000',X'50'      ESS ID                          
         DC    AL1(38),X'03',X'0000',X'60'      ESS REFORM                      
         DC    AL1(36),X'03',X'0000',X'70'      ESS BDE CONTROL                 
         DC    AL1(40),X'03',X'0000',X'71'      S/P-P/P SUBSIDIARY              
         DC   AL1(105),X'03',X'0000',X'80'      EXTERNAL LOGIN INFO             
         DC    AL1(20),X'03',X'0000',X'94'      EQUATE NAME                     
         DC    AL1(76),X'03',X'0000',X'97'      PCPAK DATA                      
         DC    AL1(21),X'03',X'0000',X'99'      RFP RULE NUM                    
         DC    AL1(77),X'03',X'0000',C'A'       ARCHIVE BSAM FILE PNTR          
         DC    AL1(41),X'03',X'0000',C'B'       ACC BANK                        
         DC    AL1(04),X'03',X'0000',C'C'       CURRENCY                        
         DC    AL1(42),X'03',X'0000',C'D'       DARE ASSIST                     
         DC    AL1(05),X'03',X'0000',C'E'       EXCHANGE                        
         DC    AL1(90),X'03',X'0000',C'G'       MEDIA MAPPING                   
         DC    AL1(06),X'03',X'0000',C'M'       MESSAGE                         
         DC    AL1(07),X'03',X'0000',C'N'       NARRATIVE                       
         DC    AL1(28),X'04',X'0000',C'O',X'01' MEDIA OFFICE                    
         DC    AL1(29),X'04',X'0000',C'O',X'02' MEDIA OFFICE PASSIVE            
         DC    AL1(75),X'03',X'0000',C'P'       PCPAK DATA RECORDS              
         DC    AL1(88),X'03',X'0000',C'Y'       MONEYFLOW COMPANY               
         DC    AL1(72),X'03',X'0000',C'1'       S/P-P/P PASSIVE                 
         DC    AL1(08),X'02',X'00',X'02'        HELP                            
         DC    AL1(09),X'02',X'00',X'03'        DRIVER DICTIONARY               
         DC    AL1(37),X'03',X'00',X'0508'      DARE EOF POINTER                
         DC   AL1(108),X'02',X'00',X'08'        BROADCAST TVDATA PANELS         
         DC    AL1(10),X'02',X'00',X'09'        BROADCAST                       
         DC    AL1(43),X'02',X'00',X'0A'        SPANEL                          
         DC    AL1(44),X'02',X'00',X'0D'        SCROLLER DATATYPE               
         DC    AL1(45),X'02',X'00',X'12'        RLP XFILE GROUP                 
         DC    AL1(46),X'02',X'00',X'1D'        SCROLLER TEST RECORDS           
         DC    AL1(47),X'02',X'00',X'2F'        RLP GROUP (MINIO)               
         DC    AL1(48),X'02',X'00',X'32'        TEAM RECORDS (RICHARD)          
         DC    AL1(49),X'02',X'00',X'37'        DSTATION ADDRESS ABS            
         DC    AL1(81),X'02',X'00',X'38'        EDI VENDOR                      
         DC    AL1(82),X'02',X'00',X'39'        EDI PARTNER                     
         DC    AL1(83),X'02',X'00',X'3A'        EDI PARTNER PASSIVE             
         DC    AL1(84),X'02',X'00',X'3B'        EDI FEATURE                     
         DC    AL1(86),X'02',X'00',X'3C'        STATION RATING SOURCE           
         DC    AL1(50),X'02',X'00',X'41'        DEPT SHORTHAND (TRNG)           
         DC    AL1(51),X'02',X'00',X'54'        DDS STAFF IN CTL/SFM            
         DC    AL1(52),X'02',X'00',X'57'        PROG ASSIGNMENT                 
         DC    AL1(53),X'02',X'00',X'5A'        DSTA REP                        
         DC    AL1(54),X'02',X'00',X'5B'        AGENCY ROUTING DETAILS          
         DC    AL1(55),X'02',X'00',X'5C'        DARE REP CODE                   
         DC    AL1(87),X'02',X'00',X'5D'        SELF DEFINING RECORD            
         DC    AL1(56),X'02',X'00',X'60'        PRINT BUYER NAME                
         DC    AL1(57),X'02',X'00',X'70'       ?JUNK                            
         DC    AL1(23),X'02',X'00',X'80'        SRDS PUB RECORDS                
         DC   AL1(109),X'03',X'00',X'81',C'B'   SRDS PUB NME BUSINESS           
         DC    AL1(58),X'03',X'00',X'81',C'C'   SRDS PUB NME CONSUMER           
         DC    AL1(59),X'03',X'00',X'82',X'00'  MQ ID                           
         DC    AL1(62),X'03',X'00',X'82',C'B'   SRDS PUB CLS BUSINESS           
         DC    AL1(64),X'03',X'00',X'82',C'C'   SRDS PUB CLS CONSUMER           
         DC   AL1(103),X'02',X'00',X'DA'        DSTA RADIO PASSIVE              
         DC    AL1(60),X'03',X'00',C'AD'        DATA SOURCE                     
         DC    AL1(61),X'03',X'00',C'AK'        KEYWORD LIST                    
         DC    AL1(89),X'03',X'00',C'D',X'00'   DOMAIN RECORD                   
         DC    AL1(94),X'03',X'00',C'DC'        DEMO CUSTOM CATEGORY            
         DC    AL1(93),X'03',X'00',C'DD'        DEMO LICENSE CATEGORY           
         DC    AL1(30),X'03',X'00',C'DS'        DEMO STATION CALL CHNGE         
         DC    AL1(92),X'03',X'00',C'DL'        DEMO COMSCORE LICENSE           
         DC    AL1(11),X'03',X'00',C'FC'        FEES CHANNEL CONFIG             
         DC    AL1(12),X'03',X'00',C'FN'        FEES NAT INSURANCE              
         DC    AL1(13),X'03',X'00',C'FP'        FEES PAYMENT PARMS              
         DC    AL1(14),X'03',X'00',C'FR'        FEES ROLE DESCRIPTION           
         DC   AL1(104),X'03',X'00',C'FT'        FEES TVR BANDS                  
         DC    AL1(91),X'02',X'00',C'K'         TOKEN AUTHORIZATION             
         DC    AL1(32),X'03',X'00',C'P',X'01'   STANDARD COLUMN                 
         DC    AL1(33),X'03',X'00',C'P',X'02'   STANDARD COLUMN PASSIVE         
         DC    AL1(95),X'03',X'00',C'TB'        TRAFFIC BUYING AGENCY           
         DC    AL1(99),X'03',X'00',C'XA'        NEW FILE ACTION                 
         DC   AL1(102),X'03',X'00',C'XD'        NEW FILE DOWNLOAD               
         DC    AL1(63),X'03',X'00',C'XF'        NEW FILE FIELD                  
         DC    AL1(96),X'03',X'00',C'XL'        NEW FILE LIST                   
         DC   AL1(100),X'03',X'00',C'XP'        NEW FILE PFKEY                  
         DC    AL1(98),X'03',X'00',C'XR'        NEW FILE RECORD                 
         DC    AL1(97),X'03',X'00',C'XS'        NEW FILE SCREEN                 
         DC   AL1(101),X'03',X'00',C'XX'        NEW FILE COLUMN                 
         DC    AL1(24),X'01',X'01'              CFM ACTIVE MODE                 
         DC    AL1(25),X'01',X'02'              CFM CONTEXT PASSIVE             
         DC    AL1(26),X'01',X'03'              CFM CLIENT PASSIVE              
         DC    AL1(27),X'01',X'04'              CFM BRAND PASSIVE               
         DC    AL1(35),X'01',C'B'               EMAIL RECORD                    
         DC    AL1(78),X'03',C'LSL'             LIST SECURITY LIST              
         DC    AL1(79),X'03',C'LSN'             LIST NUMBER PASSIVE             
         DC    AL1(80),X'03',C'LSD'             LIST DATA                       
         DC    AL1(85),X'03',C'PAC'             POSTAL ADDRESS CODE             
         DC    AL1(65),X'02',C'ZA'              AGY/OFFICE NAME                 
         DC    AL1(66),X'02',C'ZB'              EASI BILLING                    
         DC    AL1(67),X'02',C'ZC'              EASI CLIENT NAME                
         DC    AL1(68),X'02',C'ZD'              EASI ADVNAME                    
         DC    AL1(69),X'02',C'ZM'              EASI MOVE                       
         DC    AL1(70),X'02',C'ZP'              EASI PRODUCT NAME               
         DC    AL1(71),X'02',C'ZS'              EASI STATION EQUIV              
         DC    AL1(22),X'01',X'FF'              FOOTER RECORD                   
         DC    AL1(00),X'00'                    UNKNOWN RECORD                  
*                                                                               
ADRTAB   DC    A(XXX),A(R01),A(R02),A(R03)      00-03 US ADDRESS TABLE          
         DC    A(R04),A(R05),A(R06),A(R07)      04-07                           
         DC    A(R08),A(R09),A(R10),A(R11)      08-11                           
         DC    A(R12),A(R13),A(R14),A(R15)      12-15                           
         DC    A(R16),A(R17),A(R18),A(R19)      16-19                           
         DC    A(R20),A(R21),A(R22),A(R23)      20-23                           
         DC    A(R24),A(R25),A(R26),A(R27)      24-27                           
         DC    A(R28),A(R29),A(R30),A(R31)      28-31                           
         DC    A(R32),A(R33),A(R34),A(R35)      32-35                           
         DC    A(R36),A(R37),A(R38),A(R39)      36-39                           
         DC    A(R40),A(R41),A(R42),A(R43)      40-43                           
         DC    A(R44),A(R45),A(R46),A(R47)      44-47                           
         DC    A(R48),A(R49),A(R50),A(R51)      48-51                           
         DC    A(R52),A(R53),A(R54),A(R55)      52-55                           
         DC    A(R56),A(JNK),A(R58),A(R59)      56-59                           
         DC    A(R60),A(R61),A(R62),A(R63)      60-63                           
         DC    A(R64),A(R65),A(R66),A(R67)      64-67                           
         DC    A(R68),A(R69),A(R70),A(R71)      68-71                           
         DC    A(R72),A(R73),A(R74),A(R75)      72-75                           
         DC    A(R76),A(R77),A(R78),A(R79)      76-79                           
         DC    A(R80),A(R81),A(R82),A(R83)      80-83                           
         DC    A(R84),A(R85),A(R86),A(R87)      84-87                           
         DC    A(R88),A(R89),A(R90),A(R91)      88-91                           
         DC    A(R92),A(R93),A(R94),A(R95)      92-95                           
         DC    A(R96),A(R97),A(R98),A(R99)      96-99                           
         DC    A(H00),A(H01),A(H02),A(H03)      100-103                         
         DC    A(H04),A(H05),A(H06),A(JNK)      104-107                         
         DC    A(H08),A(H09)                    108,109                         
*                                                                               
         DS    0D                                                               
COUNTS   DS    0XL44      KEEP THIS US COUNT TABLE IN ALPHA ORDER               
*                                                                               
R01      DC    2F'0',CL16'FILE HEADER     ',C'----------',C'----------'         
R41      DC    2F'0',CL16'ACC BANK        ',C'BANKRECD  ',C'GEGENBNK  '         
R19      DC    2F'0',CL16'ACCESS          ',C'ACCSD     ',C'GEGENACS  '         
R54      DC    2F'0',CL16'AGENCY ROUT DET ',C'AGRKEY    ',C'CTGENAGRD '         
R77      DC    2F'0',CL16'ARCHIVE BSAM    ',C'GARCD     ',C'GEGENARC  '         
R10      DC    2F'0',CL16'BROADCAST       ',C'BRDKEYD   ',C'CTGENBRD  '         
H08      DC    2F'0',CL16'BROADCAST TVDAT ',C'BRDKEYD   ',C'CTGENBRD  '         
R95      DC    2F'0',CL16'BUYING AGENCY   ',C'BAGRECD   ',C'GEGENBAG  '         
R24      DC    2F'0',CL16'CFM ACTIVE NODE ',C'CFMRECD   ',C'GEGENCFM  '         
R27      DC    2F'0',CL16'CFM BRAND      P',C'CFMRECD   ',C'GEGENCFM  '         
R26      DC    2F'0',CL16'CFM CLIENT     P',C'CFMRECD   ',C'GEGENCFM  '         
R25      DC    2F'0',CL16'CFM CONTEXT    P',C'CFMRECD   ',C'GEGENCFM  '         
R11      DC    2F'0',CL16'CHANNEL CONFIG  ',C'GFEED     ',C'GEGENFEE  '         
R04      DC    2F'0',CL16'CURRENCY        ',C'GCURD     ',C'GEGENCUR  '         
R42      DC    2F'0',CL16'DARE ASSIST     ',C'DASRECD   ',C'GEGENASS  '         
R37      DC    2F'0',CL16'DARE EOF PTR    ',C'GEDARREC  ',C'GEGENDARE '         
R55      DC    2F'0',CL16'DARE REP CODE   ',C'REPKEYD   ',C'CTGENREPD '         
R60      DC    2F'0',CL16'DATA SOURCE     ',C'DSRECD    ',C'GEGENPCB  '         
R51      DC    2F'0',CL16'DDS STAFF       ',C'MSTFKEYD  ',C'CTMSTAFFD '         
R92      DC    2F'0',CL16'DEMO LICENSE    ',C'CSLRECD   ',C'GEGENCDC  '         
R93      DC    2F'0',CL16'DEMO LICNSE CAT ',C'LDCRECD   ',C'GEGENCDC  '         
R94      DC    2F'0',CL16'DEMO CUSTOM CAT ',C'CDCRECD   ',C'GEGENCDC  '         
R30      DC    2F'0',CL16'DEMOSTA CHNG    ',C'DSTKEYD   ',C'CTGENDSTA '         
R31      DC    2F'0',CL16'DEMOSTA CHNG   P',C'DSTKEYD   ',C'CTGENDSTA '         
R50      DC    2F'0',CL16'DEPT SHORTHAND  ',C'DPTKEYD   ',C'CTGENDEPT '         
R02      DC    2F'0',CL16'DEPARTMENT      ',C'ACCSD     ',C'GEGENACS  '         
R09      DC    2F'0',CL16'DICTIONARY      ',C'DICKEYD   ',C'CTGENDIC  '         
R89      DC    2F'0',CL16'DOMAIN          ',C'DOMRECD   ',C'GEGENDOM  '         
R53      DC    2F'0',CL16'DSTATION REP    ',C'STAKEYD   ',C'CTGENSTAD '         
R49      DC    2F'0',CL16'DSTATION ABS    ',C'ABSKEYD   ',C'CTGENABSD '         
H03      DC    2F'0',CL16'DSTATION RADIO P',C'STAKEYD   ',C'CTGENSTAD '         
R68      DC    2F'0',CL16'EASI ADV NAME   ',C'EZDNMD    ',C'SPGENEZ   '         
R65      DC    2F'0',CL16'EASI AGY/OFF    ',C'EZANMD    ',C'SPGENEZ   '         
R66      DC    2F'0',CL16'EASI BILLING    ',C'EZBILLD   ',C'SPEZBILL  '         
R67      DC    2F'0',CL16'EASI CLI NAME   ',C'EZCNMD    ',C'SPGENEZ   '         
R69      DC    2F'0',CL16'EASI MOVE       ',C'EZMOVED   ',C'SPEZMOV   '         
R70      DC    2F'0',CL16'EASI PRO NAME   ',C'EZPNMD    ',C'SPGENEZ   '         
R71      DC    2F'0',CL16'EASI STAT EQUIV ',C'EZSTAD    ',C'SPGENEZ   '         
R84      DC    2F'0',CL16'EDI FEATURE     ',C'CTEFRECD  ',C'GEGENEDI  '         
R82      DC    2F'0',CL16'EDI PARTNER     ',C'CTEPRECD  ',C'GEGENEDI  '         
R83      DC    2F'0',CL16'EDI PARTNER    P',C'CTEQRECD  ',C'GEGENEDI  '         
R81      DC    2F'0',CL16'EDI VENDOR      ',C'CTEVRECD  ',C'GEGENEDI  '         
R35      DC    2F'0',CL16'EMAIL BDE/DUMP  ',C'GBDED     ',C'GEGENBDE  '         
R20      DC    2F'0',CL16'EQUATE NAME    P',C'GMSGD     ',C'GEGENMSG  '         
R36      DC    2F'0',CL16'ESS BDE CONTROL ',C'GBDRD     ',C'GEGENBDR  '         
R34      DC    2F'0',CL16'ESS ID          ',C'GESSD     ',C'GEGENESS  '         
R38      DC    2F'0',CL16'ESS REFORM      ',C'GREFD     ',C'GEGENREF  '         
R05      DC    2F'0',CL16'EXCHANGE        ',C'GEXCD     ',C'GEGENEXC  '         
H05      DC    2F'0',CL16'EXTERNAL LOGIN  ',C'GXLID     ',C'GEGENXLI  '         
R08      DC    2F'0',CL16'HELP            ',C'HV1KEYD   ',C'CTGENHV1  '         
R61      DC    2F'0',CL16'KEYWORD LIST    ',C'KWRECD    ',C'GEGENPCB  '         
R80      DC    2F'0',CL16'LIST DATA       ',C'LDTAD     ',C'GEGENLST  '         
R79      DC    2F'0',CL16'LIST NUMBER    P',C'LNUMD     ',C'GEGENLST  '         
R90      DC    2F'0',CL16'MEDIA MAPPING   ',C'MMPRECD   ',C'GEGENMMP  '         
R28      DC    2F'0',CL16'MEDIA OFFICE    ',C'MOFRECD   ',C'GEGENOFF  '         
R29      DC    2F'0',CL16'MEDIA OFFICE   P',C'MOFRECD   ',C'GEGENOFF  '         
R06      DC    2F'0',CL16'MESSAGE         ',C'GMSGD     ',C'GEGENMSG  '         
R88      DC    2F'0',CL16'MONEYFLOW CMPY  ',C'MCYRECD   ',C'GEGENCPY  '         
R59      DC    2F'0',CL16'MQ ID           ',C'MQDEFD    ',C'CTGENMQDEF'         
R07      DC    2F'0',CL16'NARRATIVE       ',C'GNARD     ',C'GEGENNAR  '         
R12      DC    2F'0',CL16'NAT INSURANCE   ',C'GFEED     ',C'GEGENFEE  '         
R99      DC    2F'0',CL16'NFI ACTION      ',C'FRARECD   ',C'GEGENSCR  '         
H01      DC    2F'0',CL16'NFI COLUMN      ',C'FCRRECD   ',C'GEGENSCR  '         
H02      DC    2F'0',CL16'NFI DOWNLOAD    ',C'FDLRECD   ',C'GEGENSCR  '         
R63      DC    2F'0',CL16'NFI FIELD       ',C'FDRRECD   ',C'GEGENSCR  '         
R96      DC    2F'0',CL16'NFI LIST        ',C'FLRRECD   ',C'GEGENSCR  '         
H00      DC    2F'0',CL16'NFI PFKEY       ',C'FRPRECD   ',C'GEGENSCR  '         
R98      DC    2F'0',CL16'NFI RECORD      ',C'FRRRECD   ',C'GEGENSCR  '         
R97      DC    2F'0',CL16'NFI SCREEN      ',C'FSRRECD   ',C'GEGENSCR  '         
R13      DC    2F'0',CL16'PAYMENT PARMS   ',C'GFEED     ',C'GEGENFEE  '         
R75      DC    2F'0',CL16'PCPAK DATA FILE ',C'GPAKD     ',C'GEGENPAK  '         
R76      DC    2F'0',CL16'PCPAK VERSION  P',C'GPVRD     ',C'GEGENPAK  '         
R85      DC    2F'0',CL16'POSTAL CODE     ',C'PPOSD     ',C'GEGENPOS  '         
R56      DC    2F'0',CL16'PRINT BUYER NA  ',C'AORKEYD   ',C'CTGENADVD '         
R03      DC    2F'0',CL16'PUBLIC-ID       ',C'ACCSD     ',C'GEGENACS  '         
R21      DC    2F'0',CL16'RFP RULE NUM   P',C'GMSGD     ',C'GEGENMSG  '         
R47      DC    2F'0',CL16'RLP GROUP MINIO ',C'GRPKEYD   ',C'CTGENRFP  '         
R45      DC    2F'0',CL16'RLP XFILE GROUP ',C'XFILED    ',C'CTGENRFP  '         
R14      DC    2F'0',CL16'ROLE DESCRIPTN  ',C'GFEED     ',C'GEGENFEE  '         
R44      DC    2F'0',CL16'SCROLLER DTYPE  ',C'DTYPKEYD  ',C'CTGENDTYPE'         
R46      DC    2F'0',CL16'SCROLLER TEST   ',C'SDEKEYD   ',C'CTGENDAVID'         
R78      DC    2F'0',CL16'SECURITY LIST   ',C'LLSTD     ',C'GEGENLST  '         
R87      DC    2F'0',CL16'SELF DEFINED    ',C'SDRRECD   ',C'GEGENSDR  '         
R43      DC    2F'0',CL16'SPANEL          ',C'PNLKEYD   ',C'CTGENPNL  '         
R23      DC    2F'0',CL16'SRDS PUB        ',C'GPUBKEYD  ',C'CTGENPUBS '         
H09      DC    2F'0',CL16'SRDS PUB NME B P',C'GPUBNKYD  ',C'CTGENPUBS '         
R58      DC    2F'0',CL16'SRDS PUB NME C P',C'GPUBNKYD  ',C'CTGENPUBS '         
R62      DC    2F'0',CL16'SRDS PUB CLS B P',C'GPUBCKYD  ',C'CTGENPUBS '         
R64      DC    2F'0',CL16'SRDS PUB CLS C P',C'GPUBCKYD  ',C'CTGENPUBS '         
R86      DC    2F'0',CL16'STATION SOURCE  ',C'SRSRECD   ',C'GEGENSTSRC'         
R32      DC    2F'0',CL16'STD COLUMN      ',C'GCOLRECD  ',C'PCOLREC   '         
R33      DC    2F'0',CL16'STD COLUMN     P',C'GCOLRECD  ',C'PCOLREC   '         
R52      DC    2F'0',CL16'SYS/PROG NAME   ',C'PAKEYD    ',C'CTPRGASSD '         
R72      DC    2F'0',CL16'S/P-P/P PASSV  P',C'GSPLRECD  ',C'GEGENSPSAS'         
R40      DC    2F'0',CL16'S/P-P/P SUBSID  ',C'GSPLRECD  ',C'GEGENSPSAL'         
R48      DC    2F'0',CL16'TEAM RECORDS    ',C'TMDKEYD   ',C'CTGENRLIAD'         
R91      DC    2F'0',CL16'TOKEN LICENSE   ',C'TOKRECD   ',C'GEGENTOK  '         
H04      DC    2F'0',CL16'TVR BANDS       ',C'GFEED     ',C'GEGENFEE  '         
R15      DC    2F'0',CL16'XAGENCY         ',C'GXTRD     ',C'GEGENXTR  '         
R17      DC    2F'0',CL16'XFILE           ',C'GXTRD     ',C'GEGENXTR  '         
R73      DC    2F'0',CL16'XFILE AGY      P',C'GXTRD     ',C'GEGENXTR  '         
R74      DC    2F'0',CL16'XFILE ESSID    P',C'GXTRD     ',C'GEGENXTR  '         
H06      DC    2F'0',CL16'XFILE SERV ID  P',C'GXTRD     ',C'GEGENXTR  '         
R18      DC    2F'0',CL16'XLOG            ',C'GXTRD     ',C'GEGENXTR  '         
R16      DC    2F'0',CL16'XTRANS          ',C'GXTRD     ',C'GEGENXTR  '         
R39      DC    2F'0',CL16'XTRANS         P',C'GXTRD     ',C'GEGENXTR  '         
R22      DC    2F'0',CL16'FILE TRAILER    ',C'----------',C'----------'         
*                                                                               
JNK      DC    2F'0',CL16'JUNK            ',CL10' ',CL10' '                     
CTF      DC    2F'0',CL16'CTFILE RECORDS  ',CL10' ',CL10' '                     
XXX      DC    2F'0',CL16'UNKNOWN         ',CL10' ',CL10' '                     
FTS      DC    2F'0',CL16'FILE TOTALS     ',CL10' ',CL10' '                     
         DC    X'FF'                                                            
*                                                                               
*        DC    2F'0',CL16'REPORT HEADERS ?',C'?         ',C'?         '         
*        DC    2F'0',CL16'STUDIO RECORDS  ',C'STUDKEYD  ',C'CTSUDIOD  '         
*&&                                                                             
                                                                                
***********************************************************************         
* WORKING STORAGE                                                               
***********************************************************************         
WRKD     DSECT                                                                  
DUB      DS    D                                                                
DMCB     DS    6F                                                               
FULL     DS    F                                                                
HALF     DS    H                                                                
BYTE     DS    X                                                                
BYTE1    DS    X                                                                
WRKX     EQU   *                                                                
                                                                                
***********************************************************************         
* RECORD DESCRIPTION DSECT                                                      
***********************************************************************         
RDESD    DSECT                                                                  
RDCOUNT  DS    F       ACTIVE RECORD COUNT                                      
RDDELS   DS    F       DELETE COUNT                                             
RDNAME   DS    CL16    RECORD NAME                                              
RDREC    DS    CL10    RECORD DSECT NAME                                        
RDPAN    DS    CL10    PANVALET MEMBER                                          
RDESLQ   EQU   *-RDESD                                                          
                                                                                
***********************************************************************         
* COUNT PRINT LINE                                                              
***********************************************************************         
PLINED   DSECT                                                                  
PLNAME   DS    CL16    RECORD NAME                                              
         DS    CL1                                                              
PLCOUNT  DS    CL9     ACTIVE RECORD COUNT                                      
         DS    CL2                                                              
PLDELS   DS    CL9     DELETED RECORD COUNT                                     
         DS    CL2                                                              
PLTOT    DS    CL9     TOTAL RECORD COUNT                                       
         DS    CL4                                                              
PLREC    DS    CL10    RECORD DSECT                                             
         DS    CL2                                                              
PLPAN    DS    CL10    PANVALET MEMBER                                          
                                                                                
***********************************************************************         
* OTHER DSECTS                                                                  
***********************************************************************         
*DDDPRINT                                                                       
       ++INCLUDE DDDPRINT                                                       
*GEGENMSG                                                                       
       ++INCLUDE GEGENMSG                                                       
                                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'008GELDDCNT  06/23/20'                                      
         END                                                                    
