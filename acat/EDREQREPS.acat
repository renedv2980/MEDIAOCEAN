*          DATA SET EDREQREPS  AT LEVEL 009 AS OF 05/18/17                      
*CATALP REQREPS                                                                 
         TITLE 'REQREPS - EOD REPORTS'                                          
         PRINT NOGEN                                                            
REQREPS  CSECT                                                                  
         ENTRY SSB                                                              
         ENTRY UTL                                                              
         NBASE 000,*REQREPS,R8,R9,R6,WORK=A(REQWRK)                             
         L     RA,=V(CPRINT)                                                    
         USING DPRINT,RA                                                        
         LA    R7,HEADIO                                                        
         USING EODREQD,R7                                                       
         MVC   TITLE+16(21),=C'REQREPS CONTROL CARDS'                           
*                                                                               
SRTINIT  LA    R4,SRTCRD1          INITIALISE FOR SORTER                        
         LA    R5,SRTCRD2                                                       
         LA    R0,40                                                            
         L     RF,=A(SORTAREA)                                                  
         GOTO1 =V(SORTER),PARA,(R4),(R5),((R0),(RF))                            
*                                                                               
         L     RF,=A(EODREQS)                                                   
         USING DTFPHD,RF                                                        
         OI    DTFOPEN,DTF_RO      OPEN AS READ-ONLY                            
         L     RF,=A(EODJOBS)                                                   
         OI    DTFOPEN,DTF_RO      OPEN AS READ-ONLY                            
         DROP  RF                                                               
*                                                                               
         L     RF,=A(SELCLEAR)     CLEAR SELECTION POOL                         
         BASR  RE,RF                                                            
         L     R2,=A(RUNLIST)      LIST OF ACTUAL SYSTEMS (USES SE NUM)         
         L     R3,=A(RUNLISTI)     LIST OF INPUT SYSTEMS                        
         EJECT                                                                  
***********************************************************************         
*READ AND VALIDATE PARAMETER CARDS                                    *         
***********************************************************************         
CARD     GOTO1 =V(CARDS),PARA,C,=C'RE00'                                        
         CLC   C(2),=C'/*'                                                      
         BE    INIT                                                             
         CLC   C(9),=C'NOCONTROL'                                               
         BE    *+14                                                             
         CLC   C(9),=C'CONTROL=NO'                                              
         BNE   CARD0B                                                           
         OI    PRTIND,PRTICN       SET NO CONTROL CARDS PRINTING                
         B     CARD                                                             
*                                                                               
CARD0B   MVC   P(80),C             PRINT CONTROL CARD                           
         TM    PRTIND,PRTICN                                                    
         BO    CARD1                                                            
         GOTO1 =V(PRINTER)                                                      
         BASR  RE,RF                                                            
*                                                                               
CARD1    CLC   C(6),=C'DDSIO='     DDSIO=XXXXXXXX TO REDEFINE DATAMGR           
         BNE   CARD2                                                            
         L     RE,=V(DDSIO)                                                     
         MVC   0(8,RE),C+6                                                      
         B     CARD                                                             
*                                                                               
CARD2    CLC   C(7),=C'DSPACE='    DSPACE=X TO REDEFINE DATASPACE               
         BNE   CARD3                                                            
         L     RE,=V(SSB)                                                       
         MVC   SSODSPAC-SSOOFF(1,RE),C+7                                        
         B     CARD                                                             
*                                                                               
CARD3    CLC   C(7),=C'SYSTEM='    CONTROL CARDS - SYSTEM SELECTION             
         BNE   CARD4                                                            
         MVC   0(3,R3),C+7                                                      
*&&US                                                                           
CARD3A   CLI   0(R3),C'N'          TEST NETPAK                                  
         BNE   CARD3F                                                           
         MVC   DUB(2),=C'S='       SET UP S=NXX TO FIND NET SYSTEM              
         MVC   DUB+2(3),0(R3)                                                   
         GOTO1 =V(DMDDNAME),DMCB,=C'DDNAME',DUB                                 
         L     RF,DMCB+8                                                        
         CLI   DMCB+8,0                                                         
         BNE   CARD3F                                                           
         MVC   0(3,R3),DDNASEN3-DDNAD(RF) SWITCH TO EQUIV SPOT SYSTEM           
*&&                                                                             
CARD3F   MVC   DUB(2),=C'S='       SET UP S=SXX TO SEARCH FOR SYSTEM            
         MVC   DUB+2(3),0(R3)                                                   
         GOTO1 =V(DMDDNAME),DMCB,=C'DDNAME',DUB                                 
         L     RF,DMCB+8                                                        
         CLI   DMCB+8,0            SET INVALID SENUM IF NOT FOUND               
         BE    CARD3G                                                           
         MVI   DDNASENO-DDNAD(RF),X'FF'                                         
CARD3G   MVC   0(1,R2),0(R3)       SYSTEM LETTER                                
         MVC   1(1,R2),DDNASENO-DDNAD(RF) SYSTEM SE NUMBER                      
         LA    R3,3(R3)            BUMP INPUT SYSTEM LIST                       
         LA    R2,2(R2)            BUMP ACTUAL SYSTEM LIST ENTRY                
         B     CARD                                                             
*                                                                               
CARD4    CLC   C(13),=C'OUTPUT=REMOTE'                                          
         BNE   CARD6                                                            
         MVI   DIROPT,C'Y'                                                      
         B     CARD                                                             
*                                                                               
CARD6    CLC   C(13),=C'OUTPUT=DIRECT'                                          
         BNE   CARD8                                                            
         MVI   DIROPT,C'Y'                                                      
         B     CARD                                                             
*                                                                               
CARD8    CLC   C(4),=C'OPS='                                                    
         BNE   CARD10                                                           
         MVC   OPSW,C+4                                                         
         B     CARD                                                             
*                                                                               
CARD10   CLC   C(8),=C'INCLUDE '                                                
         BE    *+14                                                             
         CLC   C(8),=C'EXCLUDE '                                                
         BNE   CARD14                                                           
CARD10A  CLC   C+8(6),=C'DIRECT'                                                
         BNE   CARD10B                                                          
         MVC   DIRSW,C             I/E=INCLUDE/EXCLUDE DIRECT OUTPUT            
         B     CARD                                                             
CARD10B  CLC   C+8(7),=C'ARCHIVE'                                               
         BNE   CARD10C                                                          
         MVC   ARCSW,C             I/E=INCLUDE/EXCLUDE ARCHIVE OUTPUT           
         B     CARD                                                             
*                                                                               
CARD10C  CLC   C+8(10),=C'PROGTYPE=Z'                                           
         BNE   CARD12                                                           
         MVC   PROGTYZ,C           I/E=INCLUDE/EXCLUDE PROGTYPE=Z               
         B     CARD                                                             
*                                                                               
CARD12   L     RF,=A(SELADD)                                                    
         BASR  RE,RF                                                            
         BNE   CARDX                                                            
         B     CARD                                                             
*                                                                               
CARD14   CLC   C(8),=C'PACKAGE='                                                
         BNE   CARD16                                                           
         MVC   PACKSW,C+8                                                       
         B     CARD                                                             
*                                                                               
CARD16   CLC   C(12),=C'OUTPUT=PRINT'                                           
         BNE   CARD18                                                           
         L     R4,=V(REMOTEC)                                                   
         USING REMOTED,R4                                                       
         MVI   REMOTPRT,1                                                       
         B     CARD                                                             
*                                                                               
CARD18   CLC   C(5),=C'SHIP='                                                   
         BNE   CARD20                                                           
         MVC   SHIPSW,C+5                                                       
         CLC   C+6(2),=C',D'       SORT BY DESTINATION ID OPTION                
         BNE   CARD                                                             
         MVI   SHIPSWO,C'D'                                                     
         B     CARD                                                             
*                                                                               
CARD20   CLC   C(7),=C'REPORT='                                                 
         BNE   CARD22                                                           
         MVC   REPID,C+7                                                        
         CLC   C+10(7),=C',LOGO=YES'                                            
         BNE   CARD                                                             
         MVI   LOGOPT,C'Y'                                                      
         B     CARD                                                             
*                                                                               
CARD22   CLC   C(06),=C'STRIPE=YES'                                             
         BNE   CARD24                                                           
         L     R4,=V(BOXAREA)                                                   
         USING BOXD,R4                                                          
         MVI   BOXSHADE,4                                                       
         MVI   BOXSHCH1,X'42'                                                   
         B     CARD                                                             
*                                                                               
CARD24   CLC   C(4),=C'MID='                                                    
         BE    CARD27                                                           
*                                                                               
CARD26   CLC   C(4),=C'BIG='                                                    
         BNE   CARD28                                                           
*                                                                               
CARD27   L     R4,=V(BOXAREA)                                                   
         USING BOXD,R4                                                          
         MVI   BOXWIDTH+3,110                                                   
         GOTO1 =V(BLOWUP),PARA,C                                                
         B     CARD                                                             
*                                                                               
CARD28   CLC   C(10),=C'DIRECTCHR='                                             
         BNE   CARD29                                                           
         MVC   DIRCHR,C+10                                                      
         B     CARD                                                             
*                                                                               
CARD29   CLC   C(11),=C'ARCHIVECHR='                                            
         BNE   CARD30                                                           
         MVC   ARCCHR,C+11                                                      
         B     CARD                                                             
*                                                                               
CARD30   CLC   C(5),=C'ARCE='      FILTER ELIGIBLE ARCHIVED REPORTS             
         BNE   CARD31                                                           
         MVC   ARCE,C+5            O/N=ONLY/EXCLUDE ELIGIBLE.DEFAULT=Y          
         B     CARD                                                             
*                                                                               
CARD31   CLC   C(4),=C'OPR='       OPERATIONS PROCESSING REPORT SWITCH          
         BNE   CARD32                                                           
         MVC   OPRSW,C+4                                                        
         B     CARD                                                             
*                                                                               
CARD32   CLC   C(4),=C'OTS='       OPERATIONS TAPE SUMMARY SWITCH               
         BNE   CARD34                                                           
         MVC   OTSSW,C+4                                                        
         B     CARD                                                             
*                                                                               
CARD34   CLC   C(4),=C'OOR='       OPERATIONS OUTPUT REPORT SWITCH              
         BNE   CARD36                                                           
         MVC   OORSW,C+4                                                        
         B     CARD                                                             
*                                                                               
CARD36   CLC   C(4),=C'CDC='       CHECK DOCUMENT CONTROL SWITCH                
         BNE   CARD38                                                           
         MVC   CDCSW,C+4                                                        
         B     CARD                                                             
*                                                                               
CARD38   CLC   C(4),=C'BDL='       BILLING DOCUMENT LIST SWITCH                 
         BNE   CARD40                                                           
         MVC   BDLSW,C+4                                                        
         B     CARD                                                             
*                                                                               
CARD40   CLC   C(5),=C'PPMC='      POST PROCESSING MASTER CONTROL SWTCH         
         BNE   CARD42                                                           
         MVC   PPMCSW,C+5                                                       
         B     CARD                                                             
*                                                                               
CARD42   CLC   C(4),=C'SUR='       SHIPPING UNIT REPORT SWITCH                  
         BNE   CARD44                                                           
         MVC   SURSW,C+4                                                        
         B     CARD                                                             
*                                                                               
CARD44   CLC   C(5),=C'PQID='      REPORT TO PRINTQ OPTION                      
         BNE   CARD45                                                           
         MVC   PQID,C+5                                                         
         BAS   RE,GETPQNUM         GET PQ DESTINATION USER ID NUMBER            
         BNE   CARDX                                                            
         B     CARD                                                             
*                                                                               
CARD45   CLC   C(8),=C'PQCLASS='   PRINTQ CLASS OPTION                          
         BNE   CARD46                                                           
         MVC   PQIDCLS,C+8                                                      
         B     CARD                                                             
*                                                                               
CARD46   CLC   C(9),=C'PACKSORT='  REORDER PACKAGE SUMMARY/DETAIL               
         BNE   CARD47              SHIPPING UNIT? (QJOBLOG2 IN UK)              
         MVC   PSORTSW,C+9                                                      
         B     CARD                                                             
*                                                                               
CARD47   CLC   C(6),=C'CDROM='     CDROM ONLY ON TAPE DETAIL                    
         BNE   CARD48                                                           
         MVC   CDOPT,C+6                                                        
         B     CARD                                                             
*                                                                               
CARD48   CLC   C(9),=C'STXITER=N'  STXITER=N TO NOP STXIT                       
         BE    *+14                                                             
         CLC   C(7),=C'DUMP=OS'    DUMP=OS DOES THE SAME                        
         BNE   CARD49                                                           
         L     RF,=V(STXITER)      NOP ROUTINE                                  
         MVC   0(2,RF),=X'07FE'                                                 
         B     CARD                                                             
*                                                                               
CARD49   CLC   C(7),=C'NPDATE='                                                 
         BNE   CARD50                                                           
         L     RF,=V(DATVAL)       ROUTINE FOR NPDATE=                          
         LTR   RF,RF                                                            
         BZ    CARDX                                                            
         GOTO1 (RF),PARA,(0,C+7),DUB                                            
         OC    0(4,R1),0(R1)                                                    
         BZ    CARDX                                                            
         MVC   NPDATE,C+7          OVERRIDE NO PRINT DATE                       
         B     CARD                                                             
*                                                                               
CARD50   CLC   C(7),=C'ACCUND='    UNDERLINE ACC NEGATIVE FILTERS               
         BNE   CARD51                                                           
         MVC   ACCUND,C+7                                                       
         B     CARD                                                             
*                                                                               
CARD51   EQU   *                                                                
*                                                                               
CARDX    MVC   C+40(15),=C'*** INVALID ***'                                     
         MVC   P(15),C+40                                                       
         GOTO1 =V(PRINTER)                                                      
         GOTO1 =V(LOGIO),PARA,1,(55,C)                                          
         B     EOJ                                                              
         EJECT                                                                  
***********************************************************************         
*INITIALISATION ROUTINES                                              *         
***********************************************************************         
INIT     GOTO1 =V(DATCON),PARA,(5,0),(10,TODAY)                                 
         GOTO1 (RF),(R1),(4,TODAY),(3,TODYMD)                                   
         GOTO1 (RF),(R1),(4,NPDATE),(3,NPDYMD)                                  
*                                                                               
         GOTO1 =V(STXITER),PARA,DUMPLIST                                        
         OC    PQIDNUM,PQIDNUM     IF REMOTE PQID SPECIFIED                     
         BZ    *+8                 THEN SET UP REMOTEC                          
         BAS   RE,SETPQID                                                       
         ZAP   PAGE,=P'1'          INIT FOR OPS PROCESSING REPORT               
         ZAP   LINE,=P'75'                                                      
         CLI   OPRSW,C'N'          TEST EXCLUDE OPR SWITCH                      
         BE    INIT1                                                            
         L     RF,=A(OPRTXT)       OPERATIONS PROCESSING REPORT                 
         MVC   TITLE+13(28),0(RF)                          '                    
         LA    RF,L'OPRTXT(RF)                                                  
         MVC   SUB1(42),0(RF)                                                   
         LA    RF,L'OPRTXT(RF)                                                  
         MVC   SUB2(42),0(RF)                                                   
         LA    RF,L'OPRTXT(RF)                                                  
         MVC   SUB3(42),0(RF)                                                   
         LA    RF,L'OPRTXT(RF)                                                  
         MVC   SUB1+70(39),0(RF)                                                
         LA    RF,L'OPRTXT(RF)                                                  
         MVC   SUB2+70(39),0(RF)                                                
         LA    RF,L'OPRTXT(RF)                                                  
         MVC   SUB3+70(39),0(RF)                                                
         MVI   SUB1+69,C'-'                                                     
         MVC   SUB2+69(6),=C'TAPE  '                                            
         MVC   SUB3+69(6),=C'DETAIL'                                            
*                                                                               
INIT1    L     R2,=A(RUNLIST)      POINT TO START OF SYSTEM LIST                
         ST    R2,ANEXTRUN                                                      
         MVI   ANYREQS,C'N'        SET IF NEED TO READ EODREQS FILE             
         CLI   PACKSW,C'Y'                                                      
         BNE   *+8                                                              
         MVI   ANYREQS,C'Y'                                                     
         B     NXTSYS                                                           
         EJECT                                                                  
***********************************************************************         
*FIND NEXT SYSTEM TO PROCESS AND POSITION EODJOBS/EODREQS             *         
***********************************************************************         
NXTSYS   L     RE,=A(RUNLIST)      ANY SYSTEM=CARDS INPUT                       
         OC    0(2,RE),0(RE)                                                    
         BZ    NXTSYS1                                                          
         L     R2,ANEXTRUN         YES-LOCATE NEXT SYSTEM                       
         OC    0(2,R2),0(R2)                                                    
         BZ    NXTSYS2                                                          
         MVC   JD,SPACES           SET JOB KEY                                  
         MVC   JD(7),=C'JOBS SS'                                                
         MVC   JD+5(2),0(R2)                                                    
         MVC   ID,SPACES           SET REQ KEY                                  
         MVC   ID(7),=C'REQS SS'                                                
         MVC   ID+5(2),0(R2)                                                    
         LA    R2,2(R2)                                                         
         ST    R2,ANEXTRUN                                                      
*                                                                               
NXTSYS1  GOTO1 =V(WORKER),PARA,=C'INDEX',EODJOBS,JD                             
         CLI   ANYREQS,C'Y'                                                     
         BNE   NXTSYS1A                                                         
         GOTO1 =V(WORKER),PARA,=C'INDEX',EODREQS,ID                             
NXTSYS1A CLI   PARA+8,0                                                         
         BE    NXTJOB                                                           
         L     RE,=A(RUNLIST)      ANY SYSTEM=CARDS INPUT                       
         OC    0(2,RE),0(RE)                                                    
         BNZ   NXTSYS                                                           
*                                                                               
NXTSYS2  CLI   OPRSW,C'N'          TEST EXCLUDE OPR SWITCH                      
         BE    OUTPUT                                                           
         BAS   RE,SYSTOTS          PRINT SYSTEM TOTALS                          
         BAS   RE,RUNTOTS                                                       
         B     OUTPUT                                                           
         EJECT                                                                  
***********************************************************************         
*GET NEXT JOB REQCORD FROM EODJOBS                                    *         
***********************************************************************         
NXTJOB   LA    R7,HEADIO                                                        
         GOTO1 =V(WORKER),PARA,=C'READ',EODJOBS,JD,HEADIO-4                     
         CLI   PARA+8,0                                                         
         BNE   NXTSYS              NO MORE JOBS FOR THIS SYSTEM                 
*                                                                               
         L     RE,=A(SVJOBREC)     SAVE THIS JOB RECORD                         
         LA    RF,HEADIOL                                                       
         LR    R0,R7                                                            
         LR    R1,RF                                                            
         MVCL  RE,R0                                                            
*                                                                               
         AP    JOBCOUNT,=P'1'                                                   
         ZAP   JOBREQS,QJOBREQS    SAVE NUMBER OF REQUESTS IN THIS JOB          
         MVI   THISJOB,C'Y'        SET JOB IS TO BE INCLUDED                    
         MVC   WJOBJES,QJOBJES     SET JOB NAME AS OUTPUT BY WRAP               
         MVC   WCLASS,QCLASS       SET OUTPUT CLASS AS OUTPUT BY WRAP           
         CLI   QJOBDUPS,C' '                                                    
         BNH   *+10                                                             
         MVC   WJOBJES+4(1),QJOBDUPS                                            
*                                                                               
         OC    QDEST,QDEST         IF WE GET JOBS WITH QDEST=ZERO ....          
         BNZ   NXTJOB1                                                          
         OC    QORIGIN,QORIGIN                                                  
         BNZ   NXTJOB1                                                          
         MVI   THISJOB,C'N'        IGNORE THEM ELSE THIS PROG CAN DIE           
         B     NXTREQ                                                           
*                                                                               
NXTJOB1  CLI   QPRIPT,C'Z'         PROGTYPE=Z                                   
         BNE   NXTJOB1A                                                         
         CLI   PROGTYZ,C'I'        ARE WE INCLUDING THEM                        
         BE    NXTJOB1A                                                         
         MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*                                                                               
NXTJOB1A CLI   QSYSTEM,C'A'        TEST A56 CHECK REGISTER                      
         BNE   NXTJOB1C                                                         
         CLC   QPROGRAM,=C'56'                                                  
         BNE   NXTJOB1C                                                         
         CLI   QJOBPTYP,C'Q'       WRAPPER SETS REMOTES TO CLASS Q              
         BNE   *+8                                                              
         MVI   WCLASS,C'Q'                                                      
         CLC   QJOBPROC(20),=CL20'PRINTING DIRECT'                              
         BNE   *+8                                                              
         MVI   WCLASS,C'Q'                                                      
*                                                                               
NXTJOB1C L     RF,=A(SELFILT)      APPLY INCLUDE/EXCLUDE FILTERS                
         BASR  RE,RF                                                            
         BE    NXTJOB2                                                          
         MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*                                                                               
NXTJOB2  MVI   QDIRECT,0           SET NOT DIRECT/ARCHIVE OUTPUT                
         L     RF,=A(TSTDIR)                                                    
         BASR  RE,RF                                                            
         BE    *+8                                                              
         OI    QDIRECT,X'01'       SET GOING DIRECT                             
         CLI   TSTDIRF,2                                                        
         BNE   *+8                                                              
         OI    QDIRECT,X'80'       SET GOING BOTH                               
         L     RF,=A(TSTARC)                                                    
         BASR  RE,RF                                                            
         BE    *+8                                                              
         OI    QDIRECT,X'02'       SET GOING ARCHIVE                            
*                                                                               
NXTJOB2A CLI   DIRSW,C'I'          WANT DIRECT OUTPUT ONLY                      
         BNE   NXTJOB2B                                                         
         TM    QDIRECT,X'01'                                                    
         BO    NXTJOB2C                                                         
         MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*                                                                               
NXTJOB2B CLI   DIRSW,C'E'          WANT LOCAL OUTPUT ONLY                       
         BNE   NXTJOB2C                                                         
         TM    QDIRECT,X'80'       AND THOSE THAT GO BOTH PLACES                
         BO    NXTJOB2C                                                         
         TM    QDIRECT,X'01'                                                    
         BZ    NXTJOB2C                                                         
         MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*                                                                               
NXTJOB2C CLI   ARCSW,C'I'          WANT ARCHIVE OUTPUT ONLY                     
         BNE   NXTJOB2E                                                         
         TM    QDIRECT,X'02'       TEST ARCHIVED                                
         BO    NXTJOB2D                                                         
         MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*                                                                               
NXTJOB2D OC    QJOBTPDT,QJOBTPDT   ARCHIVE NEEDS SOMETHING IN QJOBTPDT          
         BZ    *+14                                                             
         CLC   QJOBTPDT,SPACES                                                  
         BNE   NXTJOB2F                                                         
         MVC   QJOBTPDT(6),=C'ZZZZZZ'                                           
         B     NXTJOB2F                                                         
*                                                                               
NXTJOB2E CLI   ARCSW,C'E'                                                       
         BNE   NXTJOB2F                                                         
         TM    QDIRECT,X'02'       TEST ARCHIVED                                
         BZ    *+12                                                             
         MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*                                                                               
NXTJOB2F TM    QDIRECT,X'02'       TEST ARCHIVED                                
         BZ    NXTJOB3                                                          
         CLI   QJOBARCS,C'E'       TEST ELIGIBLE                                
         BNE   NXTJOB2G                                                         
         CLI   ARCE,C'N'           TEST INCLUDE ELIGIBLE                        
         BNE   NXTJOB3                                                          
         MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*                                                                               
NXTJOB2G CLI   ARCE,C'O'           TEST ONLY ELIGBLE                            
         BNE   NXTJOB3                                                          
         MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*                                                                               
NXTJOB3  CLI   OPSW,C'Y'           OPERATIONS REPORT                            
         BNE   NXTJOB7                                                          
         CLI   OPRSW,C'N'          TEST EXCLUDE OPR SWITCH                      
         BE    NXTJOB3A                                                         
         BAS   RE,OPS                                                           
*                                                                               
NXTJOB3A CLI   OTSSW,C'N'          TEST EXCLUDE OTS SWITCH                      
         BE    NXTJOB4                                                          
         OC    QJOBTPDT,QJOBTPDT                                                
         BZ    NXTJOB4                                                          
         CLC   QJOBTPDT,SPACES                                                  
         BE    NXTJOB4                                                          
*&&US                                                                           
NXTJOB3B CLI   CDOPT,C' '          TEST CDOPT=CARD INPUT                        
         BE    NXTJOB3F                                                         
NXTJOB3C CLC   QJOBTPDT(2),=C'C$'  TEST CDROM                                   
         BNE   NXTJOB3D                                                         
         CLI   CDOPT,C'Y'                                                       
         BE    NXTJOB3F                                                         
         B     NXTJOB3E                                                         
*                                                                               
NXTJOB3D CLI   CDOPT,C'N'                                                       
         BE    NXTJOB3F                                                         
NXTJOB3E MVI   THISJOB,C'N'                                                     
         B     NXTREQ                                                           
*&&                                                                             
NXTJOB3F XC    KEY,KEY                                                          
         MVI   KEY,1               TAPE DETAIL                                  
         MVC   KEY+1(6),QJOBTPDT                                                
         MVC   KEY+7(8),WJOBJES                                                 
         BAS   RE,PUTSORT                                                       
*                                                                               
NXTJOB4  CLI   OORSW,C'N'          TEST EXCLUDE OOR SWITCH                      
         BE    NXTJOB4A                                                         
         XC    KEY,KEY             OPERATIONS OUTPUT SUMMARY RECORD             
         MVI   KEY,2                                                            
         MVC   KEY+1(1),QCLASS                                                  
         MVC   KEY+12(4),JOBCOUNT                                               
         BAS   RE,PUTSORT                                                       
*                                                                               
NXTJOB4A CLI   CDCSW,C'N'          TEST EXCLUDE CDC SWITCH                      
         BE    NXTJOB5                                                          
         CLI   QJOBPOWO+3,C'$'     CHECK REPORT                                 
         BNE   NXTJOB5                                                          
         TM    QDIRECT,X'01'       TEST IF DIRECT OUTPUT                        
         BZ    *+12                                                             
         TM    QDIRECT,X'80'                                                    
         BZ    NXTJOB5             IGNORE IF DIRECT AND NO COPY                 
         XC    KEY,KEY                                                          
         MVI   KEY,5                                                            
         MVC   KEY+1(4),QJOBPOWO                                                
         BAS   RE,PUTSORT                                                       
         CLI   CHEKFRST,C'Y'                                                    
         BNE   NXTJOB5                                                          
         MVI   KEY+1,0                                                          
         BAS   RE,PUTSORT                                                       
         MVI   KEY+1,X'FF'                                                      
         BAS   RE,PUTSORT                                                       
         MVI   CHEKFRST,C'N'                                                    
*                                                                               
NXTJOB5  CLI   BDLSW,C'N'          TEST EXCLUDE BDL SWITCH                      
         BE    NXTJOB7                                                          
         CLI   QJOBPOWO+3,C'+'     BILLING REPORT                               
         BE    NXTJOB6                                                          
         CLI   QJOBPOWO+3,C'&&'                                                 
         BNE   NXTJOB7                                                          
*                                                                               
NXTJOB6  XC    KEY,KEY                                                          
         MVI   KEY,6                                                            
         MVC   KEY+1(4),QJOBPOWO                                                
         BAS   RE,PUTSORT                                                       
         CLI   BILLFRST,C'Y'                                                    
         BNE   NXTJOB7                                                          
         MVI   KEY+1,0                                                          
         BAS   RE,PUTSORT                                                       
         MVI   BILLFRST,C'N'                                                    
*                                                                               
NXTJOB7  CLI   SHIPSW,C'Y'                                                      
         BNE   NXTJOBC                                                          
         XC    KEY,KEY             POST-PROCESSING MASTER CONTROL               
         TM    QDIRECT,X'01'       TEST IF DIRECT OUTPUT                        
         BZ    *+12                                                             
         TM    QDIRECT,X'80'                                                    
         BZ    NXTJOBC             IGNORE IF DIRECT AND NO INHOUSE COPY         
         CLI   QOUTSPEC,C'P'       COM-HAS TAPE AND PRINT                       
         BE    NXTJOB8                                                          
         CLI   QJOBDISP,C'L'                                                    
         BE    NXTJOBA                                                          
         CLI   QJOBDISP,C'H'                                                    
         BE    NXTJOBA                                                          
*                                                                               
NXTJOB8  CLI   QSYSTEM,C'R'                                                     
         BNE   NXTJOB9                                                          
         CLI   QSUBUSER,X'FF'                                                   
         BE    NXTJOBA                                                          
*                                                                               
NXTJOB9  CLI   PPMCSW,C'N'         TEST EXCLUDE PPMC SWITCH                     
         BE    NXTJOBA                                                          
         MVI   KEY,3                                                            
         MVC   KEY+1(3),QJOBJES+4  SORT DESTINATION WITHIN PROGRAM              
         MVC   KEY+4(4),QJOBJES                                                 
         BAS   RE,PUTSORT                                                       
*                                                                               
NXTJOBA  XC    KEY,KEY             SHIPPING UNIT REPORT RECORD                  
         CLI   QOUTSPEC,C'P'       COM-HAS TAPE AND PRINT                       
         BE    NXTJOBB                                                          
         CLI   QJOBDISP,C'L'                                                    
         BE    NXTJOBC                                                          
         CLI   QJOBDISP,C'H'                                                    
         BE    NXTJOBC                                                          
*                                                                               
NXTJOBB  CLI   SURSW,C'N'          TEST EXCLUDE SUR SWITCH                      
         BE    NXTJOBC                                                          
         MVI   KEY,4                                                            
*&&US                                                                           
         MVC   KEY+1(2),QSHIPUNT                                                
         CLC   QSHIPUNT,SPACES                                                  
         BH    NXTJOBB1                                                         
         CLC   QJOBSHIP(2),SPACES                                               
         BNH   NXTJOBB1                                                         
         MVC   KEY+1(2),QJOBSHIP                                                
NXTJOBB1 MVC   KEY+3(8),WJOBJES                                                 
         CLI   SHIPSWO,C'D'        TEST SORT BY DESTINATION OPTION              
         BNE   *+16                                                             
         XC    KEY+3(8),KEY+3                                                   
         MVC   KEY+3(2),QDEST                                                   
*&&                                                                             
*&&UK                                                                           
         MVC   KEY+1(7),QJOBLOG2                                                
         MVC   KEY+8(8),WJOBJES                                                 
*&&                                                                             
         BAS   RE,PUTSORT                                                       
*                                                                               
NXTJOBC  CLI   PACKSW,C'Y'                                                      
         BNE   NXTREQ                                                           
         XC    KEY,KEY             PACKAGE SUMMARY RECORD                       
         MVI   KEY,10                                                           
         L     RE,=A(SVJOBREC)                                                  
*                                                                               
         CLI   PSORTSW,C'Y'        TEST FOR REORDERED PACKAGE SORT              
         BNE   *+10                                                             
*&&UK*&& MVC   KEYEXT(7),QJOBLOG2-EODREQD(RE)                                   
*&&US*&& MVC   KEYEXT(2),QSHIPUNT-EODREQD(RE)                                   
*                                                                               
         MVC   KEY+1(4),QJOBJES-EODREQD(RE)                                     
         MVC   KEY+5(1),QDEST+1                                                 
         MVC   KEY+6(2),QSHIPUNT                                                
         MVI   KEY+8,1                                                          
         MVC   KEY+9(1),QSYSTEM                                                 
         MVC   KEY+10(2),QPROGRAM                                               
         MVC   KEY+12(4),JOBCOUNT                                               
         BAS   RE,PUTSORT                                                       
*                                                                               
NXTJOBD  XC    KEY,KEY             PACKAGE HEADER RECORD                        
         MVI   KEY,10                                                           
         L     RE,=A(SVJOBREC)                                                  
*                                                                               
         CLI   PSORTSW,C'Y'        TEST FOR REORDERED PACKAGE SORT              
         BNE   *+10                                                             
*&&UK*&& MVC   KEYEXT(7),QJOBLOG2-EODREQD(RE)                                   
*&&US*&& MVC   KEYEXT(2),QSHIPUNT-EODREQD(RE)                                   
*                                                                               
         MVC   KEY+1(4),QJOBJES-EODREQD(RE)                                     
         MVC   KEY+5(1),QDEST+1                                                 
         MVC   KEY+6(2),QSHIPUNT                                                
         MVI   KEY+8,2                                                          
         MVC   KEY+9(1),QSYSTEM                                                 
         MVC   KEY+10(2),QPROGRAM                                               
         MVC   KEY+12(4),JOBCOUNT                                               
         BAS   RE,PUTSORT                                                       
         B     NXTREQ                                                           
         EJECT                                                                  
***********************************************************************         
*READ NEXT SET OF REQUEST RECORDS IF REQUIRED                         *         
***********************************************************************         
NXTREQ   CLI   ANYREQS,C'Y'        TEST IF NEED REQUEST DATA                    
         BNE   NXTJOB              NO-BACK FOR NEXT JOB                         
         ZAP   NUMREQS,=P'0'                                                    
*                                                                               
NXTREQ1  CP    NUMREQS,JOBREQS     TEST IF PROCESSED ALL REQUESTS               
         BE    NXTJOB                                                           
         LA    R0,HEADIO           READ EODREQS FILE FOR REQUEST CARDS          
         LA    R1,HEADIOL          AFTER FILLING BUFFER WITH BLANKS             
         SR    RE,RE                                                            
         L     RF,=X'40000000'                                                  
         MVCL  R0,RE                                                            
         GOTO1 =V(WORKER),PARA,=C'READ',EODREQS,ID,HEADIO-4                     
         CLI   PARA+8,0                                                         
         BNE   NXTSYS                                                           
         CLC   HEADIO(6),=C'RFHDR='                                             
         BE    NXTREQ1                                                          
         CLC   HEADIO(4),=C'JOB='                                               
         BNE   NXTREQ3                                                          
         CLI   THISJOB,C'Y'        DO WE WANT REQS FOR THIS JOB                 
         BNE   NXTREQ1                                                          
*                                                                               
NXTREQ2  ZAP   REQCOUNT,=P'0'      JOB= REQUEST HEADER FOUND                    
         L     R7,=A(SVJOBREC)                                                  
         XC    KEY,KEY             BUILD KEY FOR REQUEST RECORD                 
         MVI   KEY,10                                                           
*                                                                               
         CLI   PSORTSW,C'Y'        TEST FOR REORDERED PACKAGE SORT              
         BNE   *+10                                                             
*&&UK*&& MVC   KEYEXT(7),QJOBLOG2                                               
*&&US*&& MVC   KEYEXT(2),QSHIPUNT                                               
*                                                                               
         MVC   KEY+1(4),QJOBJES                                                 
         MVC   KEY+5(1),QDEST+1                                                 
         MVC   KEY+6(2),QSHIPUNT                                                
         MVI   KEY+8,2                                                          
         MVC   KEY+9(1),QSYSTEM                                                 
         MVC   KEY+10(2),QPROGRAM                                               
         MVC   KEY+12(4),JOBCOUNT                                               
         B     NXTREQ1                                                          
*                                                                               
NXTREQ3  AP    NUMREQS,=P'1'       BUMP NUMBER OF REQS FOR THIS JOB             
         CLI   THISJOB,C'Y'                                                     
         BNE   NXTREQ1                                                          
*                                                                               
NXTREQ4  AP    REQCOUNT,=P'1'      BUMP TOTAL REQUEST COUNT                     
         LH    RF,HEADIO-4         GET LENGTH OF WORKER RECORD                  
         LA    RE,HEADIO-4-L'QREQINFO(RF)                                       
         MVC   REQINFO,0(RE)       RE=A(QREQINFO) AFTER LAST CARD               
         SH    RF,=Y(L'QREQINFO)                                                
         STH   RF,HEADIO-4                                                      
         MVC   0(80,RE),SPACES     OVERWRITE QREQINFO WITH A BLANK CARD         
         LA    RF,80(RF)           ADD LENGTH OF BLANK CARD                     
NXTREQ4C LA    RF,L'KEY(RF)        ADD LENGTH SORT KEY                          
*                                                                               
         XC    HEADIO-4(4),HEADIO-4 CLEAR WORKER FILE RECORD LENGTH             
*                                                                               
         MVC   KEY+16(4),REQCOUNT  MOVE REQUEST NUMBER TO SORT KEY              
         MVC   KEYEXT+12(8),SPACES                                              
         TM    REQINFO+(QQHFLAG1-QREQINFO),QQHFRFPG                             
         BZ    *+10                                                             
         MVC   KEYEXT+12(8),REQINFO+(QQHRFPG-QREQINFO)                          
         LA    R2,LSORTREC         POINT TO REQUEST SORT BUFFER                 
         STH   RF,0(R2)            PUT LSORTREC TO SORTER                       
         GOTO1 =V(SORTER),PARA,=C'PUT',(R2)                                     
         B     NXTREQ1                                                          
         EJECT                                                                  
***********************************************************************         
*PUT JOB OR REQUEST RECORD TO SORT FILE                               *         
***********************************************************************         
PUTSORT  NTR1                                                                   
         LA    R2,LSORTREC                                                      
         LA    R1,EODREQX-EODREQD+L'KEY+4                                       
         STH   R1,0(R2)                                                         
         GOTO1 =V(SORTER),PARA,=C'PUT',(R2)                                     
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*OUTPUT ROUTINES - CONTROL BREAKS FOR PACKAGE                         *         
***********************************************************************         
OUTPUT   GOTO1 =V(SORTER),PARA,=C'GET'                                          
         LA    R7,HEADIO                                                        
         ICM   R3,15,4(R1)                                                      
         BZ    FINAL                                                            
         LA    R2,KEY-4                                                         
         LR    RE,R2               MOVE SORTED RECORD TO HEADIO                 
         LA    RF,HEADIOL                                                       
         LR    R0,R3                                                            
         LR    R1,RF                                                            
         MVCL  RE,R0                                                            
*                                                                               
OUT1     MVC   WJOBJES,QJOBJES     SET JOB NAME AS OUTPUT BY WRAP               
         CLI   QJOBDUPS,C' '                                                    
         BNH   *+10                                                             
         MVC   WJOBJES+4(1),QJOBDUPS                                            
         MVC   WCLASS,QCLASS       SET OUTPUT CLASS AS OUTPUT BY WRAP           
         CLI   QSYSTEM,C'A'        TEST A56 CHECK REGISTER                      
         BNE   OUT1X                                                            
         CLC   QPROGRAM,=C'56'                                                  
         BNE   OUT1X                                                            
         CLI   QJOBPTYP,C'Q'       WRAPPER SETS REMOTES TO CLASS Q              
         BNE   *+8                                                              
         MVI   WCLASS,C'Q'                                                      
         CLC   QJOBPROC(20),=CL20'PRINTING DIRECT'                              
         BNE   *+8                                                              
         MVI   WCLASS,C'Q'                                                      
OUT1X    EQU   *                                                                
*                                                                               
         CLI   KEY,1                                                            
         BE    OUT14                                                            
         CLI   KEY,2                                                            
         BE    OUT20                                                            
         CLI   KEY,3                                                            
         BE    OUT26                                                            
         CLI   KEY,4                                                            
         BE    OUT30                                                            
         CLI   KEY,5                                                            
         BE    OUT36                                                            
         CLI   KEY,6                                                            
         BE    OUT44                                                            
         CLC   KEY(8),LASTKEY      CHANGE OF DESTINATION                        
         BE    OUT4                                                             
         CLI   LASTKEY,10                                                       
         BNE   OUT2                                                             
         BAS   RE,PACKTOTS         FINISH LAST                                  
         BAS   RE,LOGEND                                                        
*                                                                               
OUT2     BAS   RE,LOGSTART         START THIS ONE                               
         ZAP   PAKCOUNT,=P'0'                                                   
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
*                                                                               
OUT4     CLI   KEY+8,1             ARE WE ON PACKAGE SUMMARY                    
         BNE   OUT6                                                             
         AP    PAKCOUNT,=P'1'                                                   
         BAS   RE,SHIPDET                                                       
         B     OUTEX                                                            
*                                                                               
OUT6     CLI   LASTKEY+8,1         NO-IS IT  FIRST PACKAGE HEADER               
         BNE   OUT8                                                             
         BAS   RE,SHIPTOTS         YES-WRAP UP PACKAGE SUMMARY                  
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
         B     OUT10                                                            
*                                                                               
OUT8     OC    KEY+16(4),KEY+16    IS THIS A HEADER                             
         BNZ   OUT12                                                            
         BAS   RE,PACKTOTS                                                      
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
*                                                                               
OUT10    BAS   RE,HEADFILL         FILL HEADLINES                               
         ZAP   PACKNRQS,QJOBREQS                                                
         MVC   SAVESYS,QSYSTEM                                                  
         ZAP   REQCOUNT,=P'0'                                                   
         B     OUTEX                                                            
*                                                                               
OUT12    AP    REQCOUNT,=P'1'      NOW PROCESS A REQUEST                        
         CP    REQCOUNT,PACKNRQS                                                
         BH    OUTEX                                                            
         BAS   RE,REQDET                                                        
         B     OUTEX                                                            
         EJECT                                                                  
***********************************************************************         
*OUTPUT ROUTINES - CONTROL BREAKS FOR PACKING ETC.                    *         
***********************************************************************         
OUT14    CLI   LASTKEY,1           NEW PAGE IF FIRST TAPE DETAIL                
         BE    OUT16                                                            
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
         B     OUT18                                                            
*                                                                               
OUT16    CLC   KEY(7),LASTKEY      CHECK TAPE TYPE C/B                          
         BE    OUT19                                                            
         GOTO1 =V(PRINTER)                                                      
         BASR  RE,RF                                                            
*                                                                               
OUT18    MVC   P+20(6),QJOBTPDT    TAPE DETAIL HAS CHANGED                      
*                                                                               
OUT19    BAS   RE,TAPEDET                                                       
         B     OUTEX                                                            
*                                                                               
OUT20    CLI   LASTKEY,2           IS THIS THE FIRST RECORD                     
         BE    OUT22                                                            
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
         B     OUT24                                                            
*                                                                               
OUT22    CLC   KEY(2),LASTKEY      CHECK CLASS C/B                              
         BE    OUT24                                                            
         BAS   RE,CLASTOTS                                                      
         ZAP   LINE,=P'75'                                                      
*                                                                               
OUT24    BAS   RE,OUTDET                                                        
         B     OUTEX                                                            
*                                                                               
OUT26    CLI   LASTKEY,3                                                        
         BE    OUT28                                                            
         BAS   RE,CLASTOTS                                                      
         BAS   RE,OUTTOTS                                                       
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
*                                                                               
OUT28    BAS   RE,PACKDET          POST PROCESSING                              
         AP    PAKCOUNT,=P'1'                                                   
         B     OUTEX                                                            
*                                                                               
OUT30    CLI   LASTKEY,4           FIRST FOR SHIPPING UNIT                      
         BE    OUT32                                                            
         BAS   RE,PREPTOTS                                                      
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
         B     OUT34                                                            
*                                                                               
OUT32    DS    0H                                                               
*&&US*&& CLC   KEY(3),LASTKEY      CHECK UNIT C/B                               
*&&UK*&& CLC   KEY(8),LASTKEY      CHECK UNIT C/B                               
         BE    OUT33                                                            
         BAS   RE,UNITDTOT                                                      
         BAS   RE,UNITTOTS                                                      
         ZAP   LINE,=P'75'                                                      
         B     OUT34                                                            
*                                                                               
OUT33    DS    0H                                                               
*&&US*&& CLC   KEY(07),LASTKEY     CHECK DEST C/B - SU/DEST OR SU/POWR          
*&&UK*&& CLC   KEY(12),LASTKEY     CHECK DEST C/B - LOGO1/POWR                  
         BE    OUT34                                                            
         BAS   RE,UNITDTOT                                                      
         GOTO1 =V(PRINTER)                                                      
         BASR  RE,RF                                                            
*                                                                               
OUT34    BAS   RE,UNITDET                                                       
         B     OUTEX                                                            
*                                                                               
OUT36    CLI   KEY+1,0             FIRST CHECK                                  
         BNE   OUT38                                                            
         MVC   TITLE,SPACES                                                     
         MVC   TITLE+13(22),=C'CHECK DOCUMENT CONTROL'                          
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
         MVC   MID3,SPACES                                                      
         MVC   MID4,SPACES                                                      
         L     RF,=A(CHKSUB1)                                                   
         MVC   SUB1(110),0(RF)                                                  
         L     RF,=A(CHKSUB2)                                                   
         MVC   SUB2(110),0(RF)                                                  
         L     RF,=A(CHKSUB3)                                                   
         MVC   SUB3(110),0(RF)                                                  
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
         B     OUTEX                                                            
*                                                                               
OUT38    CLI   KEY+1,X'FF'                                                      
         BE    OUT40                                                            
         CP    LINE,=P'56'                                                      
         BL    *+10                                                             
         ZAP   LINE,=P'75'                                                      
         MVC   P(4),QJOBPOWO       MID CHECK                                    
         MVC   P+8(7),QJOBLOG1                                                  
         MVC   P+16(7),QJOBLOG2                                                 
         MVC   P+26(10),QJOBPROC+27                                             
         MVC   P+41(6),QJOBPROC+13                                              
         GOTO1 =V(PRINTER)                                                      
         MVC   P+56(3),=C'---'                                                  
         MVC   P+70(6),=C'------'                                               
         MVC   P+83(6),=C'------'                                               
         MVC   P+97(6),=C'------'                                               
         BASR  RE,RF                                                            
         BASR  RE,RF                                                            
         B     OUTEX                                                            
*                                                                               
OUT40    CP    LINE,=P'30'         LAST CHECK                                   
         BL    *+10                                                             
         ZAP   LINE,=P'75'                                                      
         L     R4,=A(ENDCHEK)                                                   
*                                                                               
OUT42    MVC   P(110),0(R4)                                                     
         GOTO1 =V(PRINTER)                                                      
         LA    R4,110(R4)                                                       
         CLI   0(R4),X'FF'                                                      
         BNE   OUT42                                                            
         B     OUTEX                                                            
*                                                                               
OUT44    CLI   KEY+1,0             FIRST BILL                                   
         BNE   OUT46                                                            
         MVC   TITLE,SPACES                                                     
         MVC   TITLE+13(21),=C'BILLING DOCUMENT LIST'                           
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
         MVC   MID3,SPACES                                                      
         MVC   MID4,SPACES                                                      
         MVC   SUB1,SPACES                                                      
         MVC   SUB2,SPACES                                                      
         MVC   SUB3,SPACES                                                      
         MVC   SUB1(14),=C'FORM    AGENCY'                                      
         MVC   SUB2(14),=C'CODE    ------'                                      
         MVC   SUB1+25(7),=C'JOB NO.'                                           
         MVC   SUB2+25(7),=C'-------'                                           
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
         B     OUTEX                                                            
*                                                                               
OUT46    MVC   P(4),QJOBPOWO       MIDDLE BILL                                  
         MVC   P+8(7),QJOBLOG1                                                  
         MVC   P+16(7),QJOBLOG2                                                 
         MVC   P+25(8),WJOBJES                                                  
         GOTO1 =V(PRINTER)                                                      
         BASR  RE,RF                                                            
         B     OUTEX                                                            
OUTEX    MVC   LASTKEY,KEY                                                      
         B     OUTPUT                                                           
*                                                                               
FINAL    CLI   LASTKEY,10                                                       
         BNE   FINAL2                                                           
         BAS   RE,PACKTOTS                                                      
         BAS   RE,LOGEND                                                        
         B     FINAL4                                                           
*                                                                               
FINAL2   CLI   LASTKEY,4                                                        
         BNE   FINAL4                                                           
         BAS   RE,UNITDTOT                                                      
         BAS   RE,UNITTOTS                                                      
*NOP*    BAS   RE,ALUNTOTS                                                      
*                                                                               
FINAL4   GOTO1 =V(PRINT),PARA,=C'CLOSE'                                         
*                                                                               
EOJ      XBASE                                                                  
*                                                                               
OK       SR    R2,R2                                                            
         B     XIT                                                              
*                                                                               
NOTOK    LA    R2,1                                                             
*                                                                               
XIT      LTR   R2,R2                                                            
         XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
*LOGO CONTROL                                                         *         
***********************************************************************         
LOGSTART NTR1                                                                   
         CLI   DIROPT,C'Y'                                                      
         BE    DIRSTART                                                         
*                                                                               
LOGST2   L     R4,=V(LOGOC)                                                     
         USING LOGOD,R4                                                         
         MVC   LOGO1,QJOBLOG1                                                   
         MVC   LOGO2,QJOBLOG2                                                   
         MVC   LOGONAME,QJOBDNAM                                                
         MVC   LOGOADD,QJOBDADD                                                 
         MVC   LOGOADD2,QJOBDAD2                                                
         MVC   LOGOADD3,SPACES                                                  
         MVC   LOGOINFO,SPACES                                                  
         GOTO1 =V(GETLOGO),PARA,QDEST,(R4),V(DATAMGR)                           
         MVI   LOGOTYPE,C'S'                                                    
         MVI   LOGOEND,C'S'                                                     
         GOTO1 =V(CHOPPER),PARA,(100,QJOBSHIP),(80,LOGOINFO),1                  
         GOTO1 =V(LOGO),PARA,(R4)                                               
         B     XIT                                                              
*                                                                               
LOGEND   NTR1                                                                   
         CLI   LOGOPT,C'Y'                                                      
         BE    LOGEND2                                                          
         CLI   DIROPT,C'Y'                                                      
         BE    XIT                                                              
*                                                                               
LOGEND2  L     R4,=V(LOGOC)                                                     
         MVI   LOGOTYPE,C'E'                                                    
         ZAP   LOGOREQS,PAKCOUNT                                                
         GOTO1 =V(LOGO),PARA,(R4)                                               
         B     XIT                                                              
*                                                                               
DIRSTART L     R4,=V(REMOTEC)                                                   
         USING REMOTED,R4                                                       
         GOTO1 =V(PRINT),PARA,=C'CLOSE'                                         
         XC    REMOTED(REMOTEDL),REMOTED                                        
         MVI   REMOTFLG,X'FA'                                                   
         MVC   REMOTSYS(3),=C'DPK'                                              
         MVC   REMOTJID(3),REPID                                                
         MVC   REMOTDST,QDEST                                                   
         MVC   REMOTFNO,=CL04'1S  '                                             
         MVC   REMOTDSC,=CL11'PACKAGE SUM'                                      
*&&US*&& MVI   REMOTRET,C'R'       OVERRIDE DEFAULT RETAIN=O                    
         MVC   REMOTABF,=A(REMBUF)                                              
         MVC   REMOTADM,=V(DATAMGR)                                             
         MVC   REMOTAOP,=V(PQOPEN)                                              
         CLI   LOGOPT,C'Y'                                                      
         BE    LOGST2                                                           
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*OPERATIONS REPORT                                                    *         
***********************************************************************         
OPS      NTR1                                                                   
         CLI   QSUBUSER,X'FF'                                                   
         BE    XIT                                                              
         CLC   QSYSTEM(2),LASTSYS                                               
         BE    OP2                                                              
         GOTO1 =V(DATAMGR),DMCB,DMREAD,SYSFLES,X'00000001'                      
         SR    RF,RF                                                            
         ICM   RF,7,13(R1)         RF=A(START OF SYSFLES)                       
         AHI   RF,-8                                                            
         L     RE,0(RF)            RE=A(SYSITAB) SENUM TO SYS NUM/LET           
         L     R1,4(RF)                                                         
         SR    R1,RE               GET LENGTH OF SYSITAB                        
         CHI   R1,256                                                           
         BH    OPS0B                                                            
OPS0A    LLC   R1,QSUBSYS          ONE BYTE SYSTEM LETTER/NUMBER                
         AR    RE,R1                                                            
         MVC   PRNTSYS(1),0(RE)                                                 
         MVI   PRNTSYS+1,C' '                                                   
         B     OP1                                                              
OPS0B    LLC   R1,QSUBSYS          TWO BYTE SYSTEM LETTER/NUMBER                
         SLL   R1,1                                                             
         AR    RE,R1                                                            
         MVC   PRNTSYS(2),0(RE)                                                 
*                                                                               
OP1      CLI   LASTSYS,0                                                        
         BE    OP2                                                              
         BAS   RE,SYSTOTS                                                       
         ZAP   LINE,=P'75'                                                      
*                                                                               
OP2      MVC   MID1(8),=C'SYSTEM -'                                             
         MVC   LASTSYS,QSYSTEM                                                  
         MVC   MID1+9(8),QJOBSYS                                                
         MVC   MID1+19(2),PRNTSYS                                               
         AP    SYSJOBS,=P'1'                                                    
         MVC   P,SPACES                                                         
         MVC   P+1(3),=C'( )'                                                   
         MVC   P+6(8),QJOBMVS                                                   
         ZAP   DUB,QJOBREQS        REQUEST                                      
         CVB   R2,DUB                                                           
         ST    R2,OPACCUMS                                                      
         MVC   DUB,QJOBTIME                                                     
         L     R3,DUB                                                           
         MR    R2,R2               TIME PER REQUEST                             
         ST    R3,OPACCUMS+4                                                    
         LA    R4,OPACCUMS         DOWNCAST                                     
         L     R2,0(R4)                                                         
         A     R2,8(R4)                                                         
         ST    R2,8(R4)                                                         
         L     R2,0(R4)                                                         
         A     R2,16(R4)                                                        
         ST    R2,16(R4)                                                        
         L     R2,4(R4)                                                         
         A     R2,12(R4)                                                        
         ST    R2,12(R4)                                                        
         L     R2,4(R4)                                                         
         A     R2,20(R4)                                                        
         ST    R2,20(R4)                                                        
         LA    R2,1                                                             
         BAS   RE,TIMED                                                         
         MVC   P+69(6),QJOBTPDT                                                 
         MVC   P+76(8),WJOBJES                                                  
         MVC   P+85(6),QOUTTYPE                                                 
         TM    QDIRECT,X'01'                                                    
         BZ    *+10                                                             
         MVC   P+84(1),DIRCHR      FLAG DIRECT WITH <                           
         TM    QDIRECT,X'81'                                                    
         BNO   *+10                                                             
         MVC   P+84(1),DIRCHRB     FLAG BOTH WITH %                             
         TM    QDIRECT,X'02'                                                    
         BZ    *+10                                                             
         MVC   P+91(1),ARCCHR      FLAG ARCHIVE WITH >                          
         MVC   P+92(4),QJOBPOWO                                                 
         MVC   P+97(1),QCLASS                                                   
         MVI   P+98,C'/'                                                        
         MVC   P+99(1),QJOBDISP                                                 
         MVC   P+101(4),QJOBCC                                                  
         MVC   P+107(1),QJOBCOPY                                                
         LA    R2,QJOBPROC                                                      
         LA    R3,P+30                                                          
         GOTO1 =V(CHOPPER),PARA,(40,QJOBNAME),(38,BLOCK),2                      
         MVC   P+30(38),BLOCK                                                   
         GOTO1 =V(PRINTER)                                                      
         MVC   P+30(38),BLOCK+38                                                
         CLC   P,SPACES                                                         
         BE    *+6                                                              
         BASR  RE,RF                                                            
         MVI   SPACING+3,C'1'                                                   
         GOTO1 =V(PRINTER)                                                      
         CLC   QJOBPROC(132),SPACES                                             
         BNE   OP4                                                              
         BASR  RE,RF                                                            
         B     XIT                                                              
*                                                                               
OP4      BAS   RE,PRINTEM                                                       
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*TOTALS FOR OPERATIONS REPORT                                         *         
***********************************************************************         
SYSTOTS  NTR1                                                                   
         MVC   P+32(27),=C'SYSTEM  TOTALS -NNNNNN JOBS'                         
         AP    SYSJOBS+4(4),SYSJOBS                                             
         LA    R2,2                                                             
         B     OPTOTS                                                           
*                                                                               
RUNTOTS  NTR1                                                                   
         MVC   P+32(27),=C'OVERALL TOTALS -NNNNNN JOBS'                         
         MVC   SYSJOBS,SYSJOBS+4                                                
         LA    R2,3                                                             
*                                                                               
OPTOTS   BAS   RE,TIMED                                                         
         EDIT  (P4,SYSJOBS),(6,P+48)                                            
         CLI   OPSW,C'N'                                                        
         BE    OPTOTS2                                                          
         GOTO1 =V(PRINTER)                                                      
         BASR  RE,RF                                                            
*                                                                               
OPTOTS2  MVC   P,SPACES                                                         
         ZAP   SYSJOBS,=P'0'                                                    
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO SHOW REQUESTS/TIME                                        *         
***********************************************************************         
TIMED    NTR1                                                                   
         BCTR  R2,0                                                             
         SLL   R2,3                                                             
         LA    R2,OPACCUMS(R2)                                                  
         EDIT  (4,0(R2)),(7,P+14)                                               
         L     R5,4(R2)                                                         
         SR    R4,R4                                                            
         D     R4,=F'100'          SECONDS                                      
         SR    R4,R4                                                            
         LTR   R5,R5                                                            
         BZ    TIMED2                                                           
         D     R4,=F'60'           MINS/SECS                                    
         EDIT  (R4),(2,P+28),FILL=0                                             
         MVI   P+27,C'.'                                                        
         LTR   R5,R5                                                            
         BZ    TIMED2                                                           
         SR    R4,R4                                                            
         D     R4,=F'60'           HOURS/MINS                                   
         EDIT  (R4),(2,P+25)                                                    
         LTR   R5,R5                                                            
         BZ    TIMED2                                                           
         OC    P+25(2),=2X'F0'                                                  
         MVI   P+24,C'.'                                                        
         EDIT  (R5),(2,P+22)                                                    
*                                                                               
TIMED2   MVC   WORK(6),P+21                                                     
         MVC   P+21(9),SPACES                                                   
         MVC   P+23(6),WORK                                                     
         XC    0(8,R2),0(R2)                                                    
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*PACKING AND SHIPPING SUMMARIES                                       *         
***********************************************************************         
PACKDET  NTR1                                                                   
         MVC   TITLE,SPACES                                                     
         MVC   TITLE+09(30),=C'POST-PROCESSING MASTER CONTROL'                  
         LA    R2,QJOBPACK                                                      
         B     ALLDET                                                           
*                                                                               
SHIPDET  NTR1                                                                   
         MVC   TITLE,SPACES                                                     
         MVC   TITLE+12(16),=C' PACKAGE SUMMARY'                                
*                                                                               
ALLDET   MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
         MVC   MID3,SPACES                                                      
         MVC   MID4,SPACES                                                      
         MVC   SUB1,SPACES                                                      
         MVC   SUB2,SPACES                                                      
         MVC   SUB3,SPACES                                                      
         MVC   MID1(11),=C'DESTINATION'                                         
         MVC   MID1+16(7),QJOBLOG1                                              
         MVC   MID1+24(7),QJOBLOG2                                              
         GOTO1 =V(SQUASHER),PARA,MID1+16,15                                     
         MVC   MID1+64(7),=C'ADDRESS'                                           
         MVC   MID1+72(33),QJOBDNAM                                             
         MVC   MID2+72(33),QJOBDADD                                             
         MVC   MID3+72(33),QJOBDAD2                                             
         MVC   SUB1(42),=C'CHECK JOB-NAME FORM NO SYSTEM AND PROGRAM '          
         MVC   SUB2(42),=C'HERE  --------  /SETS  --------------------'         
         MVC   SUB1+42(28),=C'NAME                  NUM.  '                     
         MVC   SUB2+42(28),=C'----                  REQS  '                     
*                                                                               
ALLDET2  MVC   P+1(3),=C'( )'                                                   
         MVC   P+6(8),WJOBJES                                                   
         MVC   P+15(4),QJOBPOWO                                                 
         MVI   P+19,C'/'                                                        
         MVC   P+20(1),QJOBCOPY                                                 
         MVC   P+23(8),QJOBSYS                                                  
         MVC   P+32(40),QJOBNAME                                                
         CLC   TITLE+12(4),=C' PAC'                                             
         BE    ALLDET4                                                          
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
         MVC   MID3,SPACES                                                      
         MVC   MID4,SPACES                                                      
         MVC   SUB1+72(22),=C'BREAKDOWN INSTRUCTIONS'                           
         MVC   SUB2+72(22),=22C'-'                                              
         GOTO1 =V(SQUASHER),PARA,P+23,49                                        
         EDIT  (P4,QJOBREQS),(5,P+62)                                           
         LA    R3,P+72                                                          
         BAS   RE,PRINTEM                                                       
         B     XIT                                                              
*                                                                               
ALLDET4  MVC   MID2(13),=C'SHIPPING UNIT'                                       
*&&UK*&& MVC   MID2+16(7),QJOBLOG2                                              
*&&US                                                                           
         CLC   QJOBSHIP(2),=C'  '                                               
         BE    ALLDET4A                                                         
         TM    QJOBSHIP,X'80'                                                   
         BZ    ALLDET4B                                                         
ALLDET4A MVC   MID2+16(2),QJOBSHIP                                              
         B     ALLDET4C                                                         
ALLDET4B EDIT  (2,QJOBSHIP),(4,MID2+16)                                         
*&&                                                                             
ALLDET4C MVC   MID3(14),=C'SHIPPING ROUTE'                                      
         GOTO1 =V(CHOPPER),PARA,(149,QJOBSHIP+3),(50,MID3+16),(C'P',2)          
         MVC   SUB1+61(37),=C'           NUM.   ORIGIN    ATTENTION'            
         MVC   SUB2+61(37),=C'           REQS   ------    ---------'            
         MVC   P+77(1),WCLASS                                                   
         MVC   P+79(6),QJOBOID                                                  
         MVC   P+85(2),QJOBOID1                                                 
         EDIT  (P4,QJOBREQS),(4,P+72)                                           
         GOTO1 =V(CHOPPER),PARA,(33,QJOBDAD3),(23,BLATT),2                      
         MVC   P+89(23),BLATT                                                   
         CLC   BLATT+23(23),SPACES                                              
         BE    PRINTEM4                                                         
         GOTO1 =V(PRINTER)                                                      
         MVC   P+89(23),BLATT+23                                                
         B     PRINTEM4                                                         
*                                                                               
BLATT    DC    CL46' '                                                          
         EJECT                                                                  
***********************************************************************         
*TOTALS FOR SHIPPING/PACKAGE                                          *         
***********************************************************************         
SHIPTOTS NTR1                                                                   
         MVC   P+23(37),=C'NUMBER OF PACKAGES FOR DESTINATION = '               
         EDIT  (P4,PAKCOUNT),(6,P+60),ALIGN=LEFT                                
         MVI   SPACING+3,C'2'                                                   
         GOTO1 =V(PRINTER)                                                      
         MVC   P+23(26),=C'COMPLETE ( )   PARTIAL ( )'                          
         B     ALLTOTS                                                          
*                                                                               
PACKTOTS NTR1                                                                   
         GOTO1 =V(PRINTER)                                                      
         MVC   P+13(32),=C'NUMBER OF REQUESTS IN PACKAGE = '                    
         EDIT  (P4,PACKNRQS),(6,P+45),ALIGN=LEFT                                
         B     ALLTOTS                                                          
*                                                                               
PREPTOTS NTR1                                                                   
         CP    PAKCOUNT,=P'0'                                                   
         BE    XIT                                                              
         MVC   P+23(27),=C'TOTAL NUMBER OF PACKAGES = '                         
         EDIT  (P4,PAKCOUNT),(6,P+50),ALIGN=LEFT                                
         B     ALLTOTS                                                          
*                                                                               
CLASTOTS NTR1                                                                   
         CP    CLSCOUNT,=P'0'                                                   
         BE    XIT                                                              
         MVC   P+15(27),=C'NUMBER OF JOBS FOR CLASS = '                         
         EDIT  (P4,CLSCOUNT),(6,P+42),ALIGN=LEFT                                
         ZAP   CLSCOUNT,=P'0'                                                   
         B     ALLTOTS                                                          
*                                                                               
OUTTOTS  NTR1                                                                   
         CP    OUTCOUNT,=P'0'                                                   
         BE    XIT                                                              
         MVC   P+15(30),=C'TOTAL NUMBER OF OUTPUT JOBS = '                      
         EDIT  (P4,OUTCOUNT),(6,P+45),ALIGN=LEFT                                
         B     ALLTOTS                                                          
*                                                                               
UNITTOTS NTR1                                                                   
         CP    UNTCOUNT,=P'0'                                                   
         BE    XIT                                                              
         MVC   P+8(29),=C'NUMBER OF REPORTS FOR UNIT = '                        
         EDIT  (P4,UNTCOUNT),(6,P+37),ALIGN=LEFT                                
         ZAP   UNTCOUNT,=P'0'                                                   
         MVI   SPACING+3,C'2'                                                   
         GOTO1 =V(PRINTER)                                                      
         MVC   P+08(26),=C'COMPLETE ( )   PARTIAL ( )'                          
         B     ALLTOTS                                                          
*                                                                               
UNITDTOT NTR1                                                                   
         CP    DUNCOUNT,=P'0'                                                   
         BE    XIT                                                              
         MVC   P+8(35),=C'NUMBER OF REPORTS FOR DESTINATION = '                 
         EDIT  (P4,DUNCOUNT),(6,P+44),ALIGN=LEFT                                
         ZAP   DUNCOUNT,=P'0'                                                   
         MVI   SPACING+3,C'2'                                                   
         GOTO1 =V(PRINTER)                                                      
         MVC   P+08(26),=C'COMPLETE ( )   PARTIAL ( )'                          
         B     ALLTOTS                                                          
*                                                                               
ALUNTOTS NTR1                                                                   
         CP    AUNCOUNT,=P'0'                                                   
         BE    XIT                                                              
         MVC   P+8(26),=C'TOTAL NUMBER OF REPORTS = '                           
         EDIT  (P4,AUNCOUNT),(6,P+34),ALIGN=LEFT                                
*                                                                               
ALLTOTS  MVI   SPACING+3,C'2'                                                   
         GOTO1 =V(PRINTER)                                                      
         MVI   SPACING+3,C'1'                                                   
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*PACKAGE DETAIL ROUTINES                                              *         
***********************************************************************         
HEADFILL NTR1                                                                   
         MVC   TITLE,SPACES                                                     
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
         MVC   MID3,SPACES                                                      
         MVC   MID4,SPACES                                                      
         MVC   SUB1,SPACES                                                      
         MVC   SUB2,SPACES                                                      
         MVC   SUB3,SPACES                                                      
         MVC   TITLE(7),QJOBLOG1                                                
         MVC   TITLE+8(7),QJOBLOG2                                              
         MVC   TITLE+16(8),WJOBJES                                              
         MVC   TITLE+27(15),=C'PACKAGE DETAILS'                                 
         GOTO1 =V(SQUASHER),PARA,TITLE,50                                       
         MVC   MID1(9),=C'ATTENTION'                                            
         MVC   MID1+13(33),QJOBDAD3                                             
         MVC   MID2(10),=C'ORIGIN ID '                                          
         MVC   MID2+13(6),QJOBOID                                               
         MVC   MID2+19(2),QJOBOID1                                              
*                                                                               
HFILL1   MVC   MID2+22(25),SPACES                                               
         CLC   QORIGIN,QDEST                                                    
         BE    HFILL2                                                           
         MVC   MID2+22(25),=C'ORIGIN=123456,DEST=123456'                        
         SR    RF,RF                                                            
         ICM   RF,3,QORIGIN                                                     
         CVD   RF,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  MID2+29(6),DUB                                                   
         SR    RF,RF                                                            
         ICM   RF,3,QDEST                                                       
         CVD   RF,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  MID2+41(6),DUB                                                   
*                                                                               
HFILL2   MVC   MID3(11),=C'ORIGIN NAME'                                         
         MVC   MID3+13(33),QJOBONAM                                             
         MVC   MID4(11),=C'ORIGIN ADDR'                                         
         MVC   MID4+13(33),QJOBOADD                                             
         MVC   MID1+60(8),=CL8'JOB-NAME'                                        
         MVC   MID2+60(8),=CL8'OUTPUT'                                          
         MVC   MID3+60(8),=CL8'SYSTEM'                                          
         MVC   MID4+60(8),=CL8'PROGRAM'                                         
         MVC   MID1+70(8),WJOBJES                                               
         MVC   MID2+70(6),QOUTTYPE                                              
         TM    QDIRECT,X'01'                                                    
         BZ    *+10                                                             
         MVC   MID2+69(1),DIRCHR   FLAG DIRECT WITH <                           
         TM    QDIRECT,X'81'                                                    
         BNO   *+10                                                             
         MVC   MID2+69(1),DIRCHRB  FLAG BOTH WITH %                             
         TM    QDIRECT,X'02'                                                    
         BZ    *+10                                                             
         MVC   MID2+76(1),ARCCHR                                                
         MVC   MID3+70(8),QJOBSYS                                               
         MVC   MID4+70(40),QJOBNAME                                             
         MVC   SUB1(11),=C'REQ DETAILS'                                         
         MVC   SUB2(11),=C'-----------'                                         
         MVC   SUB1+83(3),=C'REQ'                                               
         MVC   SUB2+83(3),=C'NUM'                                               
         MVC   SUB1+99(9),=C'RFP GROUP'                                         
         MVC   SUB2+99(9),=C'---------'                                         
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*PRINT REQUEST DETAILS                                                *         
***********************************************************************         
REQDET   NTR1                                                                   
*&&UK                                                                           
REQDET1A CLI   SAVESYS,C'M'        DONT PRINT MEDLINE TURNAROUNDS               
         BNE   REQDT1AX                                                         
         JIF   SORTREC(2),EQ,=C'12',OR,=C'20',OR,=C'22',OR,=C'09',     X        
               OR,=C'13',OR,=C'0C',XIT                                          
REQDT1AX EQU   *                                                                
*&&                                                                             
*&&UK                                                                           
REQDET1B CLI   SAVESYS,C'A'        DONT PRINT ACC JOB LABELS REQS               
         BNE   REQDT1BX                                                         
         CLC   SORTREC(2),=C'12'                                                
         BE    XIT                                                              
REQDT1BX EQU   *                                                                
*&&                                                                             
REQDET2  EDIT  (P4,REQCOUNT),(4,P+82)                                           
         OC    P+83(3),=C'000'                                                  
         TM    SORTREC+79,X'40'                                                 
         BO    *+10                                                             
         MVC   P+90(5),=C'(DDS)'                                                
         OI    SORTREC+79,X'40'                                                 
         MVC   P+99(8),KEYEXT+12                                                
*                                                                               
REQDET3  CLI   SAVESYS,C'A'        FOR ACCPAK                                   
         BNE   REQDET6                                                          
         MVC   P(79),SORTREC       RRSSSSSSSCUL...                              
         MVC   P+2(7),SPACES       REMOVE SORT KEY SSSSSSS                      
         CLI   ACCUND,C'Y'                                                      
         BNE   REQDET7                                                          
         OC    P(79),SPACES        CONVERT TO UPPER CASE                        
         BAS   RE,FIXDATES                                                      
         LA    R2,SORTREC+10       LOOK FOR NEGATIVE FILTERS IN ACCPAK          
         LHI   R0,10               START AT +10 (U=UNIT)                        
         LA    R4,69                                                            
         BAS   RE,UNDRLN           UNDERLINE THE NEGATIVE                       
         CLC   C,SPACES                                                         
         BE    REQDET4                                                          
         MVI   SPACING+3,C'0'      NEGATIVE FILTERS PRESENT                     
         GOTO1 =V(PRINTER)                                                      
         MVC   P(80),C                                                          
         MVI   SPACING+3,C'1'                                                   
REQDET4  GOTO1 =V(PRINTER)                                                      
         LA    R2,SORTREC2         PRINT REMAINDER OF REQUEST CARDS             
         LA    R5,SORTRECF                                                      
RDALOOP  CR    R2,R5                                                            
         BH    XIT                 UNTIL LAST ONE                               
         CLC   0(80,R2),SPACES                                                  
         BE    XIT                                                              
         MVC   P(80),0(R2)                                                      
         OC    P(80),SPACES                                                     
         BAS   RE,FIXDATES                                                      
         LA    R4,80                                                            
         LHI   R0,0                START AT +0                                  
         BAS   RE,UNDRLN           UNDERLINE THE NEGATIVE                       
         CLC   C,SPACES                                                         
         BE    RDALOOP1                                                         
         MVI   SPACING+3,C'0'      NEGATIVE FILTERS PRESENT                     
         GOTO1 =V(PRINTER)                                                      
         MVC   P(80),C                                                          
         MVI   SPACING+3,C'1'                                                   
RDALOOP1 GOTO1 =V(PRINTER)                                                      
         LA    R2,L'SORTREC(R2)    BUMP TO NEXT CARD                            
         B     RDALOOP                                                          
*                                                                               
REQDET6  MVC   P(79),SORTREC       ALL OTHERS                                   
REQDET7  BAS   RE,FIXDATES                                                      
         GOTO1 =V(PRINTER)                                                      
         LA    R2,SORTREC2         PRINT REMAINDER OF REQUEST CARDS             
         LA    R5,SORTRECF                                                      
RDOLOOP  CR    R2,R5                                                            
         BH    XIT                 UNTIL LAST ONE                               
         CLC   0(L'SORTREC,R2),SPACES                                           
         BE    XIT                                                              
         MVC   P(80),0(R2)                                                      
         BAS   RE,FIXDATES                                                      
         GOTO1 =V(PRINTER)                                                      
         LA    R2,L'SORTREC(R2)    BUMP TO NEXT CARD                            
         B     RDOLOOP                                                          
         EJECT                                                                  
***********************************************************************         
*UNDERLINE THE NEGATIVE ACCPAK FILTERS                                *         
***********************************************************************         
UNDRLN   NTR1                                                                   
         MVC   C,SPACES            R2=START ADDRESS IN REQUEST CARD             
         LA    R3,C                                                             
         AR    R3,R0               R0=INDEX INTO FIRST CHR TO SCAN              
*                                                                               
UNDRLN4  TM    0(R2),X'40'                                                      
         BO    UNDRLN6                                                          
         CLI   0(R2),0                                                          
         BE    UNDRLN6                                                          
         MVI   0(R3),C'_'          UNDERLINE LOWER CASE CHRS                    
*                                                                               
UNDRLN6  LA    R2,1(R2)                                                         
         LA    R3,1(R3)                                                         
         BCT   R4,UNDRLN4          R4=NUMBER OF CHRS TO SCAN                    
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*PRINT ALL REQUEST CARD CHARACTERS IN RANGE X'FA'-X'FF' AS C'0'-C'5'  *         
*IF WE THINK IT'S THE DECADE IN A YYMM FIELD                          *         
***********************************************************************         
FIXDATES NTR1                                                                   
         LHI   R0,80                                                            
         LA    R1,P                START OF PRINTED REQUEST CARD                
*                                                                               
FIXD10   CLI   0(R1),X'FA'         TEST IF 21ST-CENTURY YEAR                    
         BL    FIXD30                                                           
*                                                                               
         LA    RE,1(R1)            NEXT THREE CHARS. MUST BE NUMERIC            
         LHI   RF,3                                                             
FIXD20   CLI   0(RE),C'0'                                                       
         BL    FIXD30                                                           
         CLI   0(RE),C'9'                                                       
         BH    FIXD30                                                           
         LA    RE,1(RE)                                                         
         BCT   RF,FIXD20                                                        
*                                                                               
         IC    RF,0(R1)            IT'S A "FUNNY" DECADE DIGIT                  
         AHI   RF,-10                                                           
         STC   RF,0(R1)            MAKE PRINTABLE DECADE NOT "FUNNY"            
*                                                                               
FIXD30   LA    R1,1(R1)                                                         
         BCT   R0,FIXD10                                                        
*                                                                               
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*OPERATIONS OUTPUT REPORT                                             *         
***********************************************************************         
OUTDET   NTR1                                                                   
         MVC   TITLE,SPACES                                                     
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
         MVC   MID3,SPACES                                                      
         MVC   MID4,SPACES                                                      
         MVC   SUB1,SPACES                                                      
         MVC   SUB2,SPACES                                                      
         MVC   SUB3,SPACES                                                      
         MVC   TITLE+22(25),=C'OPERATIONS OUTPUT REPORT '                       
         L     RF,=A(OUTSUB1)                                                   
         MVC   SUB1(110),0(RF)                                                  
         L     RF,=A(OUTSUB2)                                                   
         MVC   SUB2(110),0(RF)                                                  
         AP    OUTCOUNT,=P'1'                                                   
         AP    CLSCOUNT,=P'1'                                                   
         MVC   P+01(3),=C'( )'                                                  
         MVC   P+10(1),QCLASS                                                   
         MVC   P+15(6),QOUTTYPE                                                 
         TM    QDIRECT,X'01'                                                    
         BZ    *+10                                                             
         MVC   P+14(1),DIRCHR      FLAG DIRECT WITH <                           
         TM    QDIRECT,X'81'                                                    
         BNO   *+10                                                             
         MVC   P+14(1),DIRCHRB     FLAG BOTH WITH %                             
         TM    QDIRECT,X'02'                                                    
         BZ    *+10                                                             
         MVC   P+21(1),ARCCHR                                                   
         MVC   P+23(8),WJOBJES                                                  
         MVC   P+33(4),QJOBPOWO                                                 
         MVC   P+41(1),QJOBDISP                                                 
         MVC   P+49(4),QJOBCC                                                   
         MVC   P+58(1),QJOBCOPY                                                 
         MVC   P+63(7),QJOBLOG1                                                 
         MVC   P+71(7),QJOBLOG2                                                 
*&&UK*&& MVC   P+82(2),QSHIPUNT                                                 
*&&UK*&& MVC   P+90(8),QJOBMVS                                                  
*&&US                                                                           
         CLC   QSHIPUNT(2),=C'  '                                               
         BE    OUTDET1                                                          
         TM    QSHIPUNT,X'80'                                                   
         BZ    OUTDET2                                                          
OUTDET1  MVC   P+82(2),QSHIPUNT                                                 
         B     OUTDET3                                                          
OUTDET2  EDIT  (2,QSHIPUNT),(4,P+81)                                            
OUTDET3  MVC   P+90(8),QJOBMVS                                                  
*&&                                                                             
         EDIT  (P4,QJOBREQS),(8,P+98)                                           
         B     PRINTEM4                                                         
         EJECT                                                                  
***********************************************************************         
*SHIPPING UNIT REPORT                                                 *         
***********************************************************************         
UNITDET  NTR1                                                                   
         MVC   TITLE,SPACES                                                     
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
         MVC   MID3,SPACES                                                      
         MVC   MID4,SPACES                                                      
         MVC   SUB1,SPACES                                                      
         MVC   SUB2,SPACES                                                      
         MVC   SUB3,SPACES                                                      
         MVC   TITLE+15(20),=C'SHIPPING UNIT REPORT'                            
         MVC   MID1(13),=C'SHIPPING UNIT'                                       
*&&UK*&& MVC   MID1+16(7),QJOBLOG2                                              
*&&US                                                                           
         CLC   QJOBSHIP(2),=C'  '                                               
         BE    UNITDET1                                                         
         TM    QJOBSHIP,X'80'                                                   
         BZ    UNITDET2                                                         
UNITDET1 MVC   MID1+16(2),QJOBSHIP                                              
         B     UNITDET3                                                         
UNITDET2 EDIT  (2,QJOBSHIP),(4,MID1+16)                                         
*&&                                                                             
UNITDET3 MVC   MID2(14),=C'SHIPPING ROUTE'                                      
         GOTO1 =V(CHOPPER),PARA,(149,QJOBSHIP+3),(50,MID2+16),(C'P',3)          
         L     RF,=A(OUTUNIT1)                                                  
         MVC   SUB1(110),0(RF)                                                  
         L     RF,=A(OUTUNIT2)                                                  
         MVC   SUB2(110),0(RF)                                                  
         AP    DUNCOUNT,=P'1'                                                   
         AP    UNTCOUNT,=P'1'                                                   
         AP    AUNCOUNT,=P'1'                                                   
         MVC   P+01(3),=C'( )'                                                  
         MVC   P+08(7),QJOBLOG1                                                 
         MVC   P+16(7),QJOBLOG2                                                 
         MVC   P+25(8),WJOBJES                                                  
         TM    QDIRECT,X'01'                                                    
         BZ    *+10                                                             
         MVC   P+34(1),DIRCHR      FLAG DIRECT WITH <                           
         TM    QDIRECT,X'81'                                                    
         BNO   *+10                                                             
         MVC   P+34(1),DIRCHRB     FLAG BOTH WITH %                             
         TM    QDIRECT,X'02'                                                    
         BZ    *+10                                                             
         MVC   P+41(1),ARCCHR      FLAG ARCHIVED WITH >                         
         MVC   P+36(4),QJOBPOWO                                                 
         MVC   P+43(1),QJOBCOPY                                                 
         MVC   P+49(8),QJOBSYS                                                  
         MVC   P+60(40),QJOBNAME                                                
         EDIT  (P4,QJOBREQS),(6,P+100)                                          
*&&UK                                                                           
         CLC   QJOBPROC+38(3),=C'LSR' TEST LASER CHEQUES                        
         BNE   UNITDET4                                                         
         GOTO1 =V(PRINTER)         PRINT CURRENT LINE                           
         LA    R2,QJOBPROC                                                      
         LA    R3,P+60                                                          
         BAS   RE,PRINTEM          NOW PRINT LASER DETAILS                      
*&&                                                                             
UNITDET4 CLC   QJOBPACK(132),SPACES                                             
         BE    PRINTEM4                                                         
         GOTO1 =V(PRINTER)                                                      
         LA    R2,QJOBPACK                                                      
         LA    R3,P+60                                                          
         BAS   RE,PRINTEM                                                       
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*TAPE SUMMARY                                                         *         
***********************************************************************         
TAPEDET  NTR1                                                                   
         MVC   TITLE,SPACES                                                     
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
         MVC   MID3,SPACES                                                      
         MVC   MID4,SPACES                                                      
         MVC   SUB1,SPACES                                                      
         MVC   SUB2,SPACES                                                      
         MVC   SUB3,SPACES                                                      
         MVC   TITLE+14(24),=C'OPERATIONS TAPE SUMMARY '                        
         CLI   CDOPT,C'Y'                                                       
         BNE   *+10                                                             
         MVC   TITLE+14(24),=C'OPERATIONS CDROM SUMMARY'                        
         CLI   ARCSW,C'I'                                                       
         BNE   *+10                                                             
         MVC   TITLE+14(24),=C'ARCHIVED MONARCH REPORTS'                        
         MVI   MID1,0                                                           
         L     RF,=A(OUTTAP1)                                                   
         MVC   SUB1+20(90),0(RF)                                                
         L     RF,=A(OUTTAP2)                                                   
         MVC   SUB2+20(90),0(RF)                                                
         MVC   P+29(8),WJOBJES                                                  
         MVC   P+40(40),QJOBNAME                                                
         MVC   P+83(8),=C'(      )'                                             
         MVC   P+106(4),QJOBPOWO                                                
         B     PRINTEM4                                                         
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO COMPLETE PRINT LINES                                      *         
***********************************************************************         
PRINTEM  NTR1                                                                   
         GOTO1 =V(CHOPPER),PARA,(152,(R2)),(38,BLOCK),4                         
         L     R4,PARA+8           N'LINES                                      
         LTR   R4,R4                                                            
         BZ    PRINTEM4                                                         
         ZAP   DUB,LINE            WILL THEY FIT                                
         CVB   R5,DUB                                                           
         ZAP   DUB,MAXLINE                                                      
         CVB   R0,DUB                                                           
         AR    R5,R4                                                            
         CR    R5,R0                                                            
         BL    *+10                                                             
         ZAP   LINE,=P'75'         NO-FORCE SKIP                                
         LA    R5,BLOCK                                                         
*                                                                               
PRINTEM2 MVC   0(38,R3),0(R5)                                                   
         GOTO1 =V(PRINTER)                                                      
         LA    R5,38(R5)                                                        
         BCT   R4,PRINTEM2                                                      
         BASR  RE,RF                                                            
         B     XIT                                                              
*                                                                               
PRINTEM4 MVI   SPACING+3,C'2'                                                   
         GOTO1 =V(PRINTER)                                                      
         MVI   SPACING+3,C'1'                                                   
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO SET UP REPORT REMOTE PRINTING TO PQIDNUM DESTINATION      *         
***********************************************************************         
SETPQID  NTR1                                                                   
         L     R4,=V(REMOTEC)                                                   
         USING REMOTED,R4                                                       
         GOTO1 =V(PRINT),PARA,=C'CLOSE'                                         
         XC    REMOTED(REMOTEDL),REMOTED                                        
         MVI   REMOTFLG,X'FA'                                                   
         MVC   REMOTSYS(3),=C'DPQ'                                              
         MVC   REMOTJID(3),REPID                                                
         MVC   REMOTDST,PQIDNUM                                                 
         MVC   REMOTCLS,PQIDCLS                                                 
         MVC   REMOTFNO,=CL04'1S  '                                             
         MVC   REMOTDSC,=CL11'EODREPS    '                                      
         MVC   REMOTABF,=A(REMBUF)                                              
         MVC   REMOTADM,=V(DATAMGR)                                             
         MVC   REMOTAOP,=V(PQOPEN)                                              
         XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO SET UP PRINTQ DESTINATION ID NUMBER IF OPTION SELECTED    *         
***********************************************************************         
GETPQNUM NTR1                                                                   
         GOTO1 =V(DATAMGR),DMCB,DMOPEN,CONTROL,FLISTCTF                         
         L     R2,=A(CONREC)       BUILD KEY OF ID RECORD                       
         USING CTIREC,R2                                                        
         XC    CTIKEY,CTIKEY                                                    
         MVI   CTIKTYP,CTIKTYPQ                                                 
         MVC   CTIKID,PQID                                                      
         BAS   RE,CONREAD          READ CONTROL FILE                            
         BNE   GPQNNO                                                           
         LA    R3,CTIDATA                                                       
         SR    RF,RF                                                            
GPQN010  CLI   0(R3),X'00'         GET ID NUMBER ELEMENT                        
         BE    GPQNNO                                                           
         CLI   0(R3),X'02'                                                      
         BE    GPQN020                                                          
         IC    RF,1(R3)                                                         
         AR    R3,RF                                                            
         B     GPQN010                                                          
GPQN020  MVC   PQIDNUM,2(R3)                                                    
         B     GPQNOK                                                           
GPQNOK   SR    RC,RC                                                            
GPQNNO   LTR   RC,RC                                                            
         XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO READ CONTROL FILE RECORDS                                 *         
***********************************************************************         
CONREAD  LA    RF,DMREAD                                                        
         B     CONALL                                                           
*                                                                               
CONSEQ   LA    RF,DMRSEQ                                                        
         B     CONALL                                                           
*                                                                               
CONRDHI  LA    RF,DMRDHI                                                        
         B     CONALL                                                           
*                                                                               
CONALL   NTR1                                                                   
         ST    RF,DMCB                                                          
         L     R2,=A(CONREC)                                                    
         MVC   CONKEY,0(R2)                                                     
         L     RF,=A(UTL)                                                       
         MVI   4(RF),X'0A'                                                      
         GOTO1 =V(DATAMGR),DMCB,,CONFILE,(R2),(R2),(0,DMWORK)                   
         CLI   DMCB+8,0                                                         
         BE    CALLOK                                                           
         MVC   P(31),=C'DISK ERROR READING CONTROL FILE'                        
         GOTO1 =V(PRINTER)                                                      
         MVC   P(8),=C'COMMAND='                                                
         L     R3,DMCB                                                          
         MVC   P+8(8),0(R3)                                                     
         GOTO1 =V(PRINTER)                                                      
         MVC   P(4),=C'KEY='                                                    
         MVC   P+4(25),CONKEY                                                   
         GOTO1 =V(HEXOUT),PARA,CONKEY,P+30,25,=C'TOG'                           
         GOTO1 =V(PRINTER)                                                      
         MVC   P(11),=C'ERROR=X''HH'''                                          
         GOTO1 =V(HEXOUT),PARA,DMCB+8,P+8,1,=C'TOG'                             
         GOTO1 =V(PRINTER)                                                      
         MVC   P(18),=C'RUN IS BATTLING ON'                                     
         GOTO1 =V(PRINTER)                                                      
         B     CALLNO                                                           
CALLOK   SR    RC,RC                                                            
CALLNO   LTR   RC,RC                                                            
         XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
*DTFS WORK SPACES ETC                                                 *         
***********************************************************************         
EODREQS  DMWK  BUFFER=WKRQBUF                                                   
*                                                                               
EODJOBS  DMWK  BUFFER=WKRJBUF                                                   
*                                                                               
         DS    0F                                                               
***********************************************************************         
*SORT KEY EXTENDED TO INCLUDED EXTRA 20 BYTES GROUP SORT ORDER        *         
*IN ADDITION TO ORIGINAL ORDER BASED ON 20 BYTE SORT KEY              *         
*HOWEVER MAINTAIN PRIORITY OF FIRST BYTE IN SORT KEY                  *         
***********************************************************************         
SRTCRD1  DC   CL80'SORT FIELDS=(5,1,A,25,12,A,6,19,A),FORMAT=BI,WORK=1'         
SRTCRD2  DC   CL80'RECORD TYPE=V,LENGTH=(1324,,,124,124)'                       
*                                                                               
DUMPLIST DS    0F                                                               
         DC    A(REQREPS)                                                       
         DC    A(REQREPSX)                                                      
*        DC    A(SORTAREA)                                                      
         ORG   *-4                                                              
         DC    X'80'                                                            
         ORG                                                                    
*&&UK                                                                           
NPDATE   DC    CL8'29/09/07'       NO PRINTING DATE FOR UK                      
NPDYMD   DC    XL3'00'                                                          
*&&                                                                             
*&&US                                                                           
NPDATE   DC    CL8'12/31/27'       NO PRINTING DATE FOR US                      
NPDYMD   DC    XL3'00' '                                                        
*&&                                                                             
TODAY    DC    CL8' '                                                           
TODYMD   DC    XL3'00'                                                          
TSTDIRF  DS    X                                                                
TSTARCF  DS    X                                                                
DUB      DS    D                                                                
WORK     DS    CL32                                                             
DMCB     DS    6F                                                               
PARA     DS    6F                                                               
C        DS    CL80                                                             
WJOBJES  DS    CL8                 WRAPPER JOB NAME QJOBJES+QJOBDUPS            
WCLASS   DS    CL1                 WRAPPER OUTPUT CLASS                         
OPSW     DC    C'Y'                                                             
PACKSW   DC    C'Y'                                                             
*                                                                               
SHIPSW   DC    C'Y'                SHIPPING UNIT REPORT SWITCH                  
SHIPSWO  DC    C' '                SHIPPING UNIT SORT OPTION                    
*                                                                               
OPRSW    DC    C'Y'                OPERATION PROCESSING REPORT SWITCH           
OTSSW    DC    C'Y'                OPERATIONS TAPE SUMMARY SWITCH               
OORSW    DC    C'Y'                OPERATIONS OUTPUT REPORT SWITCH              
CDCSW    DC    C'Y'                CHECK DOCUMENT CONTROL SWITCH                
BDLSW    DC    C'Y'                BILLING DOCUMENT LIST SWITCH                 
PPMCSW   DC    C'Y'                POST PROCESSING MASTER CONTROL SW.           
SURSW    DC    C'Y'                SHIPPING UNIT REPORT SWITCH                  
PSORTSW  DC    C'N'                PACKAGE SUMMARY SORT SWITCH                  
BILLFRST DC    C'Y'                                                             
CHEKFRST DC    C'Y'                                                             
DIRSW    DC    C'B'                                                             
ARCSW    DC    C'B'                                                             
ARCE     DC    C'Y'                ELIGIBLE ARC INCLUDE/EXCLUDE/ONLY            
PROGTYZ  DC    C'E'                DEFAULT IS EXCLUDE PROGTYPE=Z                
JOBIND   DC    C'I'                                                             
THISJOB  DC    C'N'                                                             
ANYREQS  DC    C'N'                                                             
ACCUND   DC    C'Y'                UNDERLINE ACC REQ NEGATIVE FILTERS           
PRTIND   DC    X'00'               PRINT CONTROL CARDS FLAGS                    
PRTICN   EQU   X'20'               FLAG FOR CONTROL=NO OR NOCONTROL             
SYSJOBS  DC    2PL4'0'                                                          
COUNT    DC    AL1(5)                                                           
LASTSYS  DC    AL2(0)                                                           
PRNTSYS  DC    CL2'  '                                                          
SAVESYS  DS    CL1                                                              
REQCOUNT DC    PL4'0'                                                           
JOBCOUNT DC    PL4'0'                                                           
PAKCOUNT DC    PL4'0'                                                           
CLSCOUNT DC    PL4'0'                                                           
OUTCOUNT DC    PL4'0'                                                           
UNTCOUNT DC    PL4'0'                                                           
DUNCOUNT DC    PL4'0'                                                           
AUNCOUNT DC    PL4'0'                                                           
JOBREQS  DC    PL4'0'                                                           
NUMREQS  DC    PL4'0'                                                           
OPACCUMS DC    6F'0'                                                            
SAVER1   DS    F                                                                
ANEXTRUN DS    F                                                                
DMWORK   DS    12D                                                              
CONKEY   DS    XL25                CONTROL FILE IO KEY                          
ID       DC    XL32'00'                                                         
JD       DC    XL32'00'                                                         
LASTKEY  DC    XL(L'KEY)'00'       SORT KEY SAVE                                
*                                                                               
LSORTREC DC    F'0'                                                             
*                                                                               
KEY      DS    0XL40               SORT KEY (EXTENDED BY 20 BYTES)              
KEYOLD   DC    XL20'00'            ORIGINAL KEY LENGTH                          
KEYEXT   DC    XL20'00'            EXTRA EXTENDED KEY                           
*                                                                               
SORTREC  DS    CL80                MAXIMUM 15 REQUEST DATA CARDS                
SORTREC2 DS    CL80                                                             
SORTREC3 DS    CL80                                                             
SORTREC4 DS    CL80                                                             
SORTREC5 DS    CL80                                                             
SORTREC6 DS    CL80                                                             
SORTREC7 DS    CL80                                                             
SORTREC8 DS    CL80                                                             
SORTREC9 DS    CL80                                                             
SORTRECA DS    CL80                                                             
SORTRECB DS    CL80                                                             
SORTRECC DS    CL80                                                             
SORTRECD DS    CL80                                                             
SORTRECE DS    CL80                                                             
SORTRECF DS    CL80                                                             
         DS    CL80                                                             
SORTRECL EQU   *-LSORTREC          MAX SORT REC = 4+40+16*80=1324               
*                                                                               
         ORG   SORTREC             REMAP SORTREC FOR READING REQUESTS           
HEADIO   DS    2000X               (QDATAMAX*80)+QREQINFO=15*80+66=1266         
HEADIOL  EQU   2000                                                             
*                                                                               
BLOCK    DC    CL152' '                                                         
AREA     DC    400C' '                                                          
PACKNRQS DC    PL4'0'                                                           
SHIPUNIT DS    CL2                                                              
DIROPT   DC    C'N'                                                             
DIRCHR   DC    C'<'                                                             
DIRCHRB  DC    C'%'                                                             
ARCCHR   DC    C'>'                                                             
REPID    DC    C'PAK'                                                           
PQID     DC    CL10'CHEK'                                                       
PQIDNUM  DC    XL2'00'                                                          
PQIDCLS  DC    C' '                                                             
LOGOPT   DC    C'N'                                                             
CDOPT    DC    C' '                                                             
SAVPRINT DC    F'0'                                                             
SCANCARD DC    CL80' '                                                          
DMOPEN   DC    CL8'DMOPEN  '                                                    
DMREAD   DC    CL8'DMREAD  '                                                    
DMRSEQ   DC    CL8'DMRSEQ  '                                                    
DMRDHI   DC    CL8'DMRDHI  '                                                    
CONTROL  DC    CL8'CONTROL '                                                    
SYSFLES  DC    CL8'SYSFLES '                                                    
CONFILE  DC    CL8'CTFILE  '                                                    
FLISTCTF DC    CL8'NCTFILE '                                                    
         DC    C'X'                                                             
         DS    0H                                                               
*                                                                               
REQINFO  DS    XL(L'QREQINFO)                                                   
         EJECT                                                                  
         LTORG                                                                  
*                                                                               
RUNLISTI DC    256XL3'00'          LIST OF SYSTEM/SUBSYSTEMS INPUT              
RUNLIST  DC    256XL2'00'          LIST OF SYSTEM/SUBSYSTEMS IN KEY             
*                                                                               
OPRTXT   DC    CL42'OPERATIONS PROCESSING REPORT'                               
         DC    CL42'------------PROCESSING DETAILS------------'                 
         DC    CL42'CHECK JOB-NAME   NUM.    EST. INSTRUCTIONS'                 
         DC    CL42' HERE  (ZOS)     REQS    TIME             '                 
         DC    CL42'------------OUTPUT DETAILS-------------'                    
         DC    CL42'CHECK JOB-NAME OUTPUT FNO CLASS CC SETS'                    
         DC    CL42' HERE  (JES3)   TYPE      /DISP         '                   
*                                                                               
OUTTAP1  DC    C' TAPE    JOB NAME   PROGRAM NAME'                              
         DC    32C' '                                                           
         DC    C' TAPE                 FORM'                                    
*                                                                               
OUTTAP2  DC    C'DETAIL   --------   ------------'                              
         DC    32C' '                                                           
         DC    C'NUMBER                CODE'                                    
*                                                                               
OUTSUB1  DC    C'CHECK  OUTPUT  OUTPUT    JES3    FORM  OUTPUT  '               
         DC    C'CARRIAGE  SETS  DESTINATION     SHIPPING     ZOS   '           
         DC    C'    NUM.    '                                                  
*                                                                               
OUTSUB2  DC    C' HERE   CLASS   TYPE   JOB-NAME  CODE   DISP.  '               
         DC    C'CONTROL   ----  -----------       UNIT     JOB NAME'           
         DC    C'    REQS    '                                                  
*                                                                               
OUTUNIT1 DC    C'CHECK   DESTINATION      JOB-NAME   FORM  SETS   '             
         DC    C'SYSTEM     PROGRAM AND BREAKDOWN INSTRUCTIONS    '             
         DC    C'    NUM.    '                                                  
*                                                                               
OUTUNIT2 DC    C' HERE   -----------      --------   CODE  ----   '             
         DC    C'------     ------- --------------------------    '             
         DC    C'    REQS    '                                                  
*                                                                               
CHKSUB1  DC    C'FORM    AGENCY            SYSTEM        STARTING     '         
         DC    C' TAKE-OUT      PRINT POOL     PUT BACK    '                    
         DC    C'   CASHPAK         '                                           
*                                                                               
CHKSUB2  DC    C'CODE    ------            ------         NUMBER      '         
         DC    C'  NUMBER      VERIFICATION     NUMBER     '                    
         DC    C'CONTROL AUDIT      '                                           
*                                                                               
CHKSUB3  DC    C'                                        SHOULD BE    '         
         DC    C'1ST IN BOX                   1ST IN BOX   '                    
         DC    C'                   '                                           
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO TEST IF OUTPUT GOING DIRECT                               *         
***********************************************************************         
TSTDIR   NMOD1 0,TSTDIR                                                         
         SR    R0,R0                                                            
*&&UK                                                                           
TSTDIRA  CLI   QSYSTEM,C'A'        SPECIALS FOR ACCOUNT SYSTEM                  
         BNE   TSTDIRAX                                                         
         CLC   QPROGRAM,=C'55'     TEST CHECKS                                  
         BNE   TSTDIRAX                                                         
TSTDIRA2 CLC   QJOBPROC+38(3),=C'LSR'                                           
         BE    TSTDIRX             WE WANT CHECKS TO APPEAR                     
TSTDIRAX EQU   *                                                                
*&&                                                                             
*&&US                                                                           
TSTDIRA  CLI   QSYSTEM,C'A'        TEST CHECKS GOING LASER OR SHUTTLE           
         BNE   TSTDIRAX                                                         
         CLC   QPROGRAM,=C'55'                                                  
         BNE   TSTDIRAX                                                         
TSTDIRA1 CLC   QJOBPROC+38(7),=C'SHUTTLE'                                       
         BNE   TSTDIRA2                                                         
         CLC   QDEST,=H'1200'      DESTINATION MUST BE CHEK=H'1200'             
         BE    TSTDIRY                                                          
         B     TSTDIRAX                                                         
TSTDIRA2 CLC   QJOBPROC+38(3),=C'LSR'                                           
         BNE   TSTDIRAX                                                         
         CLC   QDEST,=H'4000'      DESTINATION MUST BE LSR=H'4000'              
         BE    TSTDIRY                                                          
         B     TSTDIRX             WE WANT CHECKS TO APPEAR                     
TSTDIRAX EQU   *                                                                
*&&                                                                             
TSTDIR1  CLI   QCLASS,C'Q'         ALL THESE MEAN DIRECT                        
         BE    TSTDIRY                                                          
         CLI   QJOBPTYP,C'Q'                                                    
         BE    TSTDIRY                                                          
         CLI   QJOBPTYP,C'B'                                                    
         BNE   TSTDIR1C                                                         
         CLC   TODYMD,NPDYMD       TEST NO PRINTING AT DDS DATE                 
         BL    TSTDIRYB                                                         
         CLI   QJOBPDD,C'N'        TEST PRINT AT DDS                            
         BE    TSTDIRY             NO ONLY GOING DIRECT                         
         B     TSTDIRYB            STILL GOING TO BOTH                          
TSTDIR1C CLC   QJOBPROC(20),=CL20'PRINTING DIRECT'                              
         BE    TSTDIRY                                                          
         CLI   QOUTTYPE,C'@'                                                    
         BE    TSTDIRY                                                          
         CLI   QOUTTYPE,C'/'                                                    
         BE    TSTDIRY                                                          
*                                                                               
TSTDIR2  MVC   IDIOTOTY,QJOBORUT   TEST FOR IDI OUTPUT TYPE OVERRIDE            
         MVC   IDIOTSYS,QSYSTEM                                                 
         MVC   IDIOTPRG,QPROGRAM                                                
*                                                                               
IDIOT1   CLC   IDIOTOTY(2),=C'S1'  OUTPUT TYPE S1.... (MAX 4 SYS CHRS)          
         BNE   IDIOT2                                                           
         LA    RE,IDIOTOTY+2                                                    
         LA    RF,4                                                             
         B     IDIOT4                                                           
IDIOT2   CLI   IDIOTOTY,C'#'       OUTPUT TYPE #..... (MAX 5 SYS CHRS)          
         BNE   IDIOTX                                                           
         CLC   IDIOTOTY+1(5),SPACES                                             
         BE    IDIOT5                                                           
         LA    RE,IDIOTOTY+1                                                    
         LA    RF,5                                                             
IDIOT4   CLC   0(1,RE),IDIOTSYS    CHECK IF SYSTEM IN OUTPUT TYPE NAME          
         BE    IDIOT5                                                           
         LA    RE,1(RE)                                                         
         BCT   RF,IDIOT4                                                        
         B     IDIOTX                                                           
IDIOT5   LA    RF,IDIOTLST         CHECK FOR SYSTEM/PROGRAM EXCEPTIONS          
IDIOT5A  CLI   0(RF),C' '                                                       
         BE    IDIOT6                                                           
         CLC   0(3,RF),IDIOTSYS    IGNORE IF IN LIST                            
         BE    IDIOTX                                                           
         LA    RF,3(RF)                                                         
         B     IDIOT5A                                                          
*                                                                               
IDIOT6   EQU   *                                                                
*&&UK*&& CLI   QJOBDISP,C'T'       IGNORE IDI ORIDE IF SPOOL TO TAPE            
*&&UK*&& BE    IDIOTX                                                           
*&&US*&& CLI   QJOB@DDS,C'Y'       IGNORE IDI ORIDE IF PRINT@DDS SET            
*&&US*&& BE    IDIOTX                                                           
*                                                                               
IDIOTQ   B     TSTDIRY             GOING DIRECT VIA IDI OVERRIDE                
IDIOTX   B     TSTDIRX                                                          
*                                                                               
IDIOTRCD DS    C                                                                
IDIOTOTY DS    CL6                                                              
IDIOTSYS DS    CL1                                                              
IDIOTPRG DS    CL2                                                              
*                                                                               
IDIOTLST DS    0C                                                               
*&&UK                                                                           
         DC    C'A07',C'A55',C'A77'                                             
         DC    C'M05',C'M31',C'M74',C'M75'                                      
*&&                                                                             
*&&US                                                                           
         DC    C'A55',C'AT5',C'A56'                                             
*&&                                                                             
IDIOTLSX DC    C' '                                                             
*                                                                               
TSTDIRY  LA    R0,1                SET GOING DIRECT                             
         B     TSTDIRX                                                          
TSTDIRYB LA    R0,2                SET GOING DIRECT AND TO PRINT                
TSTDIRX  LTR   R0,R0               EXIT WITH CC NEQ IF GOING DIRECT             
         STC   R0,TSTDIRF                                                       
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO TEST IF OUTPUT GOING TO ARCHIVE                           *         
***********************************************************************         
TSTARC   NMOD1 0,TSTARC                                                         
         SR    R0,R0                                                            
TSTARC1  CLI   QJOBARC,C' '        ARCHIVE CLASS DEFINES THIS                   
         BH    TSTARCY                                                          
         B     TSTARCX                                                          
*                                                                               
TSTARCY  LA    R0,1                SET GOING ARCHIVE                            
TSTARCX  LTR   R0,R0               EXIT WITH CC NEQ IF GOING ARCHIVE            
         STC   R0,TSTARCF                                                       
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO CLEAR SELECTION POOL                                      *         
***********************************************************************         
SELCLEAR NMOD1 0,SELCLEAR                                                       
         L     R2,=A(SELPOOL)                                                   
         LM    R3,R4,0(R2)                                                      
         LA    R2,8(R2)                                                         
         BCTR  R4,0                                                             
*                                                                               
SELCL2   EX    R4,*+8                                                           
         B     *+10                                                             
         XC    0(0,R2),0(R2)                                                    
         LA    R2,1(R2,R4)                                                      
         BCT   R3,SELCL2                                                        
SELCLX   XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO ADD ENTRY TO SELECTION POOL                               *         
***********************************************************************         
SELADD   NMOD1 0,SELADD                                                         
         L     R2,=A(SELPOOL)                                                   
         LM    R3,R4,0(R2)                                                      
         LA    R2,8(R2)                                                         
         BCTR  R4,0                                                             
*                                                                               
         USING SELD,R2                                                          
SELAD2   EX    R4,*+8                                                           
         B     *+10                                                             
         OC    0(0,R2),0(R2)                                                    
         BZ    SELAD4                                                           
         LA    R2,1(R2,R4)                                                      
         BCT   R3,SELAD2                                                        
         LA    RF,=CL40'SELECTION POOL FILLED'                                  
         GOTO1 =V(LOGIO),PARA,1,(40,(RF))                                       
         B     SELAOK                                                           
*                                                                               
SELAD4   MVC   SCANCARD(72),C+8                                                 
         GOTO1 =V(SCANNER),PARA,(C'C',SCANCARD),(6,BLOCK)                       
         SR    R0,R0                                                            
         ICM   R0,1,4(R1)                                                       
         BZ    SELANOK                                                          
         LA    R1,BLOCK                                                         
*                                                                               
SELAD6   CLC   12(10,R1),=CL10'DEST'                                            
         BNE   *+14                                                             
         MVC   SELDEST,22(R1)                                                   
         B     SELAD8                                                           
         CLC   12(10,R1),=CL10'ORIGIN'                                          
         BNE   *+14                                                             
         MVC   SELORIG,22(R1)                                                   
         B     SELAD8                                                           
         CLC   12(10,R1),=CL10'DISP'                                            
         BNE   *+14                                                             
         MVC   SELDISP,22(R1)                                                   
         B     SELAD8                                                           
         CLC   12(10,R1),=CL10'SPECIAL'                                         
         BNE   *+14                                                             
         MVC   SELSPEC,22(R1)                                                   
         B     SELAD8                                                           
         CLC   12(10,R1),=CL10'OUTPUT'                                          
         BNE   *+14                                                             
         MVC   SELOUT,22(R1)                                                    
         B     SELAD8                                                           
         CLC   12(10,R1),=CL10'JOB'                                             
         BNE   *+14                                                             
         MVC   SELJOB,22(R1)                                                    
         B     SELAD8                                                           
         CLC   12(10,R1),=CL10'CLASS'                                           
         BNE   *+14                                                             
         MVC   SELCLASS,22(R1)                                                  
         B     SELAD8                                                           
         CLC   12(10,R1),=CL10'PROGRAM'                                         
         BNE   *+14                                                             
         MVC   SELPROG,22(R1)                                                   
         B     SELAD8                                                           
SELAD7   CLC   12(10,R1),=CL10'PROGTYPE'                                        
         BNE   SELAD7A                                                          
         MVC   SELPTYP,22(R1)                                                   
         CLI   22(R1),C'*'                                                      
         BNE   SELAD8                                                           
         MVC   SELPTYP,23(R1)                                                   
         NI    SELPTYP,X'03'                                                    
         B     SELAD8                                                           
SELAD7A  CLC   12(10,R1),=CL10'PROGOUTPUT'                                      
         BNE   SELAD7B                                                          
         MVC   SELPOUT,22(R1)                                                   
         CLI   22(R1),C'*'                                                      
         BNE   SELAD8                                                           
         MVC   SELPOUT,23(R1)                                                   
         NI    SELPOUT,X'03'                                                    
         B     SELAD8                                                           
SELAD7B  EX    R4,*+8                                                           
         B     *+10                                                             
         XC    0(0,R2),0(R2)                                                    
         B     SELANOK                                                          
*                                                                               
SELAD8   LA    R1,32(R1)                                                        
         BCT   R0,SELAD6                                                        
*                                                                               
         MVC   SELIND,C            (E OR I FROM EXCLUDE/INCLUDE)                
         B     SELAOK                                                           
*                                                                               
SELAOK   CR    RB,RB               OK EXIT SET CC EQL                           
         B     SELAXIT                                                          
SELANOK  LTR   RB,RB               NOT OK EXIT SET CC NEQ                       
SELAXIT  XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
*ROUTINE TO SEE IF A JOB QUALIFIES                                    *         
***********************************************************************         
SELFILT  NMOD1 0,SELFILT                                                        
         L     R2,=A(SELPOOL)                                                   
         LM    R3,R4,0(R2)                                                      
         LA    R2,8(R2)                                                         
         BCTR  R4,0                                                             
         MVI   JOBIND,C'I'                                                      
         CLI   0(R2),0                                                          
         BE    SELFOK              NO ENTRIES IS OK                             
         CLI   0(R2),C'E'          IF FIRST ENTRY IS AN EXCLUDE                 
         BE    SELFI1              THEN DEFAULT IS INCLUDE                      
         MVI   JOBIND,C'E'                                                      
*                                                                               
         USING SELD,R2                                                          
SELFI1   EX    R4,*+8                                                           
         B     *+10                                                             
         OC    0(0,R2),0(R2)                                                    
         BNZ   SELFI3                                                           
*                                                                               
SELFI2   CLI   JOBIND,C'I'                                                      
         BE    SELFOK                                                           
         B     SELFNOK                                                          
*                                                                               
SELFI3   OC    SELDEST,SELDEST                                                  
         BZ    *+14                                                             
         CLC   SELDEST,QJOBJES                                                  
         BNE   SELFNEXT                                                         
         OC    SELJOB,SELJOB                                                    
         BZ    *+14                                                             
         CLC   SELJOB,QJOBJES                                                   
         BNE   SELFNEXT                                                         
         OC    SELORIG,SELORIG                                                  
         BZ    SELFI4                                                           
         CLC   SELORIG(8),QJOBOID                                               
         BNE   SELFNEXT                                                         
         CLC   SELORIG+6(2),QJOBOID1                                            
         BNE   SELFNEXT                                                         
SELFI4   OC    SELOUT,SELOUT                                                    
         BZ    *+14                                                             
         CLC   SELOUT,QOUTTYPE                                                  
         BNE   SELFNEXT                                                         
         OC    SELCLASS,SELCLASS                                                
         BZ    *+14                                                             
         CLC   SELCLASS,WCLASS                                                  
         BNE   SELFNEXT                                                         
         OC    SELDISP,SELDISP                                                  
         BZ    *+14                                                             
         CLC   SELDISP,QJOBDISP                                                 
         BNE   SELFNEXT                                                         
         OC    SELSPEC,SELSPEC                                                  
         BZ    *+14                                                             
         CLC   SELSPEC,QOUTSPEC                                                 
         BNE   SELFNEXT                                                         
         OC    SELPROG,SELPROG                                                  
         BZ    *+14                                                             
         CLC   SELPROG,QPROGRAM                                                 
         BNE   SELFNEXT                                                         
*                                                                               
SELFI5   CLI   SELPTYP,0           PROGRAM TYPE FILTER                          
         BE    SELFI6                                                           
         CLI   SELPTYP,C'A'        TEST *1 THRU *4 INPUT                        
         BL    SELFI5A                                                          
         CLC   SELPTYP,QPRIPT                                                   
         BNE   SELFNEXT                                                         
         B     SELFI6                                                           
SELFI5A  CLI   SELPTYP,1           TYPE *1 IS A THRU I                          
         BNE   SELFI5B                                                          
         CLI   QPRIPT,C'A'                                                      
         BL    SELFNEXT                                                         
         CLI   QPRIPT,C'I'                                                      
         BH    SELFNEXT                                                         
         B     SELFI6                                                           
SELFI5B  CLI   SELPTYP,2           TYPE *2 IS J THRU R                          
         BNE   SELFI5C                                                          
         CLI   QPRIPT,C'J'                                                      
         BL    SELFNEXT                                                         
         CLI   QPRIPT,C'R'                                                      
         BH    SELFNEXT                                                         
         B     SELFI6                                                           
SELFI5C  CLI   SELPTYP,3           TYPE *3 IS S THRU Y                          
         BNE   SELFI5D                                                          
         CLI   QPRIPT,C'S'                                                      
         BL    SELFNEXT                                                         
         CLI   QPRIPT,C'Y'                                                      
         BH    SELFNEXT                                                         
         B     SELFI6                                                           
SELFI5D  CLI   SELPTYP,4           TYPE *4 IS 0 THRU 9                          
         BNE   SELFI6                                                           
         CLI   QPRIPT,C'0'                                                      
         BL    SELFNEXT                                                         
         CLI   QPRIPT,C'9'                                                      
         BH    SELFNEXT                                                         
*                                                                               
SELFI6   CLI   SELPOUT,0           PROGRAM OUTPUT FILTER                        
         BE    SELFI7                                                           
         CLI   SELPOUT,C'A'        TEST *1 THRU *4 INPUT                        
         BL    SELFI6A                                                          
         CLC   SELPOUT,QPRIPO                                                   
         BNE   SELFNEXT                                                         
         B     SELFI7                                                           
SELFI6A  CLI   SELPOUT,1           OUTPUT *1 IS A THRU I                        
         BNE   SELFI6B                                                          
         CLI   QPRIPO,C'A'                                                      
         BL    SELFNEXT                                                         
         CLI   QPRIPO,C'I'                                                      
         BH    SELFNEXT                                                         
         B     SELFI7                                                           
SELFI6B  CLI   SELPOUT,2           OUTPUT *2 IS J THRU R                        
         BNE   SELFI6C                                                          
         CLI   QPRIPO,C'J'                                                      
         BL    SELFNEXT                                                         
         CLI   QPRIPO,C'R'                                                      
         BH    SELFNEXT                                                         
         B     SELFI7                                                           
SELFI6C  CLI   SELPOUT,3           OUTPUT *3 IS S THRU Y                        
         BNE   SELFI6D                                                          
         CLI   QPRIPO,C'S'                                                      
         BL    SELFNEXT                                                         
         CLI   QPRIPO,C'Y'                                                      
         BH    SELFNEXT                                                         
         B     SELFI7                                                           
SELFI6D  CLI   SELPOUT,4           OUTPUT *4 IS 0 THRU 9                        
         BNE   SELFI7                                                           
         CLI   QPRIPO,C'0'                                                      
         BL    SELFNEXT                                                         
         CLI   QPRIPO,C'9'                                                      
         BH    SELFNEXT                                                         
*                                                                               
SELFI7   EQU   *                                                                
*                                                                               
SELFMTCH MVC   JOBIND,SELIND       MATCHED ON ALL ENTRIES                       
*                                                                               
SELFNEXT LA    R2,1(R2,R4)         BUMP TO NEXT SELECTION ENTRY                 
         BCT   R3,SELFI1                                                        
         B     SELFI2                                                           
*                                                                               
SELFOK   CR    RB,RB               OK EXIT SET CC EQL                           
         B     SELFXIT                                                          
SELFNOK  LTR   RB,RB               NOT OK EXIT SET CC NEQ                       
SELFXIT  XIT1                                                                   
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
         DC    0D'0'                                                            
         DC    CL8'SSB     '                                                    
SSB      DC    X'0000FF',X'02',4X'00',CL8' ',240X'00'                           
         DC    CL8'UTL     '                                                    
UTL      DC    F'0',X'0A',251X'00'                                              
*                                                                               
         DC    0D'0'                                                            
         DC    CL8'REMBUF  '                                                    
REMBUF   DS    14336C                                                           
*                                                                               
         DC    0D'0'                                                            
         DC    CL8'SVJOBREC'                                                    
SVJOBREC DC    2000X'00'                                                        
*                                                                               
         DC    0D'0'                                                            
         DC    CL8'SELPOOL '                                                    
SELPOOL  DC    F'1200'                                                          
         DC    AL4(SELLNQ)                                                      
         DS    (1200*SELLNQ)C                                                   
*                                                                               
         DC    0D'0'                                                            
         DC    CL8'WKRQBUF '                                                    
WKRQBUF  DS    60000C                                                           
*                                                                               
         DC    0D'0'                                                            
         DC    CL8'WKRJBUF '                                                    
WKRJBUF  DS    60000C                                                           
*                                                                               
         DC    0D'0'                                                            
         DC    CL8'REQWRK  '                                                    
REQWRK   DC    48000X'00'                                                       
*                                                                               
         DC    0D'0'                                                            
         DC    CL8'SORTAREA'                                                    
SORTAREA DS    48000C                                                           
*                                                                               
         DC    0D'0'                                                            
         DC    CL8'CONREC  '                                                    
CONREC   DS    1000C                                                            
REQREPSX DS    0D                                                               
         EJECT                                                                  
***********************************************************************         
*FINAL PAGE OF CHECK DOCUMENT REPORT                                  *         
***********************************************************************         
ENDCHEK  DS    0D                                                               
         DC    C'WE, THE UNDERSIGNED, CERTIFY THAT       '                      
         DC    C'WE, THE UNDERSIGNED, CERTIFY THAT    '                         
         DC    C'WE, THE UNDERSIGNED, CERTIFY THAT'                             
         DC    C'THE ABOVE STARTING CHECK NUMBER         '                      
         DC    C'THE ABOVE STARTING CHECK NUMBER      '  '                      
         DC    C'THE ABOVE STARTING CHECK NUMBER  '                             
         DC    C'IS THE ACTUAL CHECK NUMBER WITHDRAWN    '                      
         DC    C'IS THE ACTUAL NUMBER WE LOADED       '                         
         DC    C'IS THE ACTUAL NUMBER WE PUT BACK '                             
         DC    C'FROM THE CHECK STORAGE ROOM ON -        '                      
         DC    C'ONTO THE PRINTER ON -                '                         
         DC    C'INTO THE CHECK STORAGE ROOM ON - '                             
         DC    CL110' '                                                         
         DC    C'DATE            TIME                    '                      
         DC    C'DATE            TIME                 '                         
         DC    C'DATE            TIME             '                             
         DC    C'     ----------      ----------         '                      
         DC    C'     ----------      ----------      '                         
         DC    C'     ----------      ----------  '                             
         DC    CL220' '                                                         
         DC    C'OPERATOR                                '                      
         DC    C'OPERATOR                             '                         
         DC    C'OPERATOR                         '                             
         DC    C'         ----------------------         '                      
         DC    C'         ----------------------      '                         
         DC    C'         ----------------------  '                             
         DC    CL110' '                                                         
         DC    C'                                        '                      
         DC    C'                                     '                         
         DC    C'SHIFT                            '                             
         DC    C'                                        '                      
         DC    C'                                     '                         
         DC    C'SUPERVISOR                       '                             
         DC    C'                                        '                      
         DC    C'                                     '                         
         DC    C'           --------------------  '                             
         DC    220C' '                                                          
         DC    C'INCORRECT START NUMBERS                 '                      
         DC    C'------MISSING NUMBERS------          '                         
         DC    C'WE, THE UNDERSIGNED HAVE VERIFIED'                             
         DC    C'-----------------------                 '                      
         DC    C'FNO         FROM         TO          '                         
         DC    C'THE ABOVE LISTED INFORMATION AND '                             
         DC    C'                                        '                      
         DC    C'                                     '                         
         DC    C'HAVE ACCOUNTED FOR ANY INCORRECT '                             
         DC    C'-----------------------                 '                      
         DC    C'----       ------      ------        '                         
         DC    C'NUMBERS, MISSING NUMBERS OR      '                             
         DC    C'                                        '                      
         DC    C'                                     '                         
         DC    C'DISCREPANCIES.                   '                             
         DC    C'-----------------------                 '                      
         DC    C'----       ------      ------        '                         
         DC    C'                                 '                             
         DC    110C' '                                                          
         DC    C'-----------------------                 '                      
         DC    C'----       ------      ------        '                         
         DC    C'CASHPAK                          '                             
         DC    C'                                        '                      
         DC    C'                                     '                         
         DC    C'CONTROL                          '                             
         DC    C'-----------------------                 '                      
         DC    C'----       ------      ------        '                         
         DC    C'        -----------------------  '                             
         DC    110X'FF'                                                         
         EJECT                                                                  
***********************************************************************         
*DSECT TO COVER AN ITEM IN THE SELECTION POOL                         *         
***********************************************************************         
SELD     DSECT                                                                  
SELIND   DS    CL1                                                              
SELDEST  DS    CL4                                                              
SELJOB   DS    CL8                                                              
SELOUT   DS    CL6                                                              
SELCLASS DS    CL1                                                              
SELORIG  DS    CL8                                                              
SELDISP  DS    CL1                                                              
SELSPEC  DS    CL1                                                              
SELPROG  DS    CL2                                                              
SELPTYP  DS    CL1                                                              
SELPOUT  DS    CL1                                                              
SELLNQ   EQU   *-SELD                                                           
         EJECT                                                                  
***********************************************************************         
*INCLUDED SYSTEM DSECTS                                               *         
***********************************************************************         
*EDREQD                                                                         
       ++INCLUDE EDREQD                                                         
         EJECT                                                                  
*DDBIGBOX                                                                       
       ++INCLUDE DDBIGBOX                                                       
         EJECT                                                                  
*DDDPRINT                                                                       
       ++INCLUDE DDDPRINT                                                       
         EJECT                                                                  
*DDLOGOD                                                                        
       ++INCLUDE DDLOGOD                                                        
         EJECT                                                                  
*DDREMOTED                                                                      
       ++INCLUDE DDREMOTED                                                      
         EJECT                                                                  
*DMDDNAME                                                                       
DDNAD    DSECT                                                                  
       ++INCLUDE DMDDNAMED                                                      
         EJECT                                                                  
*DMDTFPH                                                                        
       ++INCLUDE DMDTFPH                                                        
         EJECT                                                                  
*FASSBOFF                                                                       
       ++INCLUDE FASSBOFF                                                       
         EJECT                                                                  
*CTGENFILE                                                                      
         PRINT OFF                                                              
       ++INCLUDE CTGENFILE                                                      
         PRINT OFF                                                              
*                                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'009EDREQREPS 05/18/17'                                      
         END                                                                    
