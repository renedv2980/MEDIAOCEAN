*          DATA SET REGETIUN   AT LEVEL 185 AS OF 08/06/18                      
*PROCESS USING(WARN(15))                                                        
*CATALP REGETIUN                                                                
REGETIUN TITLE '- CALCULATE IUN VALUES'                                         
***********************************************************************         
* THIS MODULE IS CALLED BY REDEMUP TO EXPLODE PAV, TIME PERIOD OR IUN *         
* RECORDS INTO IUN FORMAT.  IT OPTIMIZES THE IUN LOOKUP BY BYPASSING  *         
* DEMOUT AND EXTRACTING IUN VALUES USING HARD CODE.                   *         
*                                                                     *         
* ON ENTRY - P1 BYTE 0     1 = EXTRACT UNIVERSES, RATINGS, AND IMPS   *         
*                          2 = EXTRACT PUTS AND TOTS                  *         
*                          4 = EXTRACT UNIVERSES, RATINGS, IMPS, PUTS *         
*                              AND TOTS                               *         
*                          9   EXTRACT ENTIRE RECORD (IUN RECORD ONLY)*         
*                                                                     *         
*                    1-3     = A(DBLOCK USED FOR DEMAND CALL)         *         
*                                                                     *         
*            P2 BYTE 1-3     = A(DEMO VALUES)                         *         
*                                                                     *         
***********************************************************************         
         SPACE 1                                                                
*-------------------------------------------------------------------- *         
* REGISTER CONVENTIONS                                                *         
*                                                                     *         
* R2=A(DBLOCK)                                                        *         
* R3=A(OUTPUT AREA)                                                   *         
* R4=A(DEMO ELEMENT TABLE)                                            *         
* R5=A(ELEMENT DEMO LIST)                                             *         
* R6=RECORD DEMO ELEMENT POINTER                                      *         
*                                                                     *         
*-------------------------------------------------------------------- *         
         SPACE 2                                                                
REGETIUN RSECT                                                                  
BASE     EQU   *                                                                
         PRINT NOGEN                                                            
         NMOD1 WORKX-WORKD,**GETIUN,RA,CLEAR=YES,RR=R2                          
         USING WORKD,RC            RC=A(W/S)                                    
         MVC   PARMS,0(R1)         SAVE PARM LIST                               
         ST    R2,RELO                                                          
         LM    R2,R3,0(R1)                                                      
         USING DBLOCKD,R2          R2=A(DBLOCK)                                 
         LA    R3,0(R3)            CLEAR HOB R3=A(OUTPUT WORK AREA)             
         L     RE,=A(SUBR01)                                                    
         A     RE,RELO                                                          
         ST    RE,VSUBR01                                                       
*                                                                               
         MVI   DMAIMP,C'N'         SAVE DMA RTGS INSTEAD OF IMPS                
         CLI   DBTAPEP,C'Y'        SAVE DMA IMPS                                
         BNE   *+8                                                              
         MVI   DMAIMP,C'I'                                                      
         MVC   RTGTOIMP,DBTAPEP                                                 
         EJECT                                                                  
***********************************************************************         
* FIND BOOK ELEMENT ON DEMO RECORD AND LOCATE ORGTAB ENTRY ASSOCIATED *         
* WITH IT. THEN BRANCH TO DEMO EXTRACT ROUTINE FOR REQUESTED CALL.    *         
*                                                                     *         
* COULD HAVE NO BOOK ELEM IF NO MARKET TOTALS ARE FOUND (TYPE 2 CALL) *         
***********************************************************************         
         SPACE                                                                  
GET1     XC    BOOK,BOOK           RESET BOOK                                   
         XC    BOOKTYPE,BOOKTYPE   RESET THE BOOKTYPE                           
         L     R1,DBAREC           ATTEMPT TO SAVE FOR LATER TESTS              
         CLC   0(2,R1),=C'RT'      TPT                                          
         BNE   GET2                                                             
         MVC   BOOK,8(R1)                                                       
         XC    BOOK,=X'FFFF'                                                    
         MVC   BOOKTYPE,(DRBTYP-DRKEY)(R1)  SAVE BTYPE FOR LATER TESTS          
*                                                                               
GET2     CLC   0(2,R1),=C'PT'      PAV                                          
         BNE   GET3                                                             
         MVC   BOOK,10(R1)                                                      
         MVI   FILTYP,C'P'                                                      
         MVC   BOOKTYPE,(PRBTYP-PRKEY)(R1)  SAVE BTYPE FOR LATER TESTS          
*                                                                               
GET3     L     R1,DBAQUART         R1=A(QUARTER HOUR ELEMENT)                   
         SR    R0,R0               LOCATE BOOK ELEMENT                          
GET4     CLI   0(R1),0             TEST E-O-R                                   
         BE    GETX                EXIT IF NO BOOK EL FOUND                     
         CLI   0(R1),X'49'         TEST X'49' ELEM PRESENT                      
         BNE   *+12                                                             
         MVI   RTGPUT,C'Y'         FOR NSI-IUN RATINGS/PUTS ON RECORD           
         ST    R1,ARTGEL                                                        
         CLI   0(R1),X'51'         TEST FOR X'51' ELEM                          
         BNE   *+8                                                              
         ST    R1,APUTEL           WILL LOOK AT IN TTN EXPLODE                  
         CLI   0(R1),BKELQ         TEST BOOK ELEMENT                            
         BE    GET5                                                             
         IC    R0,1(R1)            NO BUMP TO NEXT ELEMENT                      
         AR    R1,R0                                                            
         B     GET4                                                             
*                                                                               
GET5     CLI   1(R1),4             TEST FOR COMPRESSED BOOK ELEMENT             
         BNE   GET6                                                             
         ICM   RE,3,2(R1)                                                       
         SLL   RE,17                                                            
         SRL   RE,17                                                            
         L     R1,DBAREC                                                        
         LA    R1,0(RE,R1)         YES - POINT TO UNCOMPRESSED ELEMENT          
*                                                                               
GET6     ST    R1,ABOOKEL          SAVE ADDR OF BOOK ELEM                       
*                                                                               
* THIS CODE IS DISASTER PROTECTION FOR LUNATICS THAT CHANGE                     
* PROFILES FROM IMP BASED TO RATINGS BASED FORMULAS                             
*                                                                               
         LTR   R1,R1               INSURE ADDRESS                               
         BZ    GET6A                                                            
         CLC   =C'IUN',2(R1)       ONLY FOR INVENTORY                           
         BNE   GET6A                                                            
         CLI   DBTAPEP,C'Y'        IMP BASED ALWAYS OK                          
         BE    GET6A                                                            
         CLC   5(2,R1),=X'5B06'    IMP BASED INPUT PUT UPG                      
         BE    *+10                                                             
         CLC   5(2,R1),=X'5A0C'    IMP BASED INPUT INDEX UPG                    
         BE    *+10                                                             
         CLC   5(2,R1),=X'5A0B'    IMP BASED INPUT REG                          
         BNE   GET6A                                                            
         MVI   DMAIMP,C'I'         FORCE IMP BASED OUTPUT                       
         MVI   RTGTOIMP,C'I'                                                    
         MVI   DBTAPEP,C'Y'                                                     
*                                                                               
GET6A    DS    0C                                                               
*                                                                               
         LA    RE,ORGTAB           RE=A(BOOKTAB)                                
         USING ORGTABD,RE                                                       
GET7     CLC   0(2,RE),=XL2'00'    TEST E-O-T                                   
         BE    GET10                                                            
         CLC   ORGFILE(ORGCOMPL),2(R1)  MATCH F/M/S/BOOK TO TABLE               
         BE    GET20                                                            
         LA    RE,ORGTABL(RE)       NO MATCH - BUMP TO NEXT                     
         B     GET7                                                             
*                                                                               
GET10    LA    RE,NETFILS          SEE IF THIS IS A NETWORK FILE                
GET11    CLC   0(2,RE),=XL2'00'     TEST EOT                                    
         BNE   *+6                                                              
         DC    H'0'                UNKNOWN SOURCE FILE                          
         CLC   0(3,RE),2(R1)       COMPARE 3-CHAR DEMDISP FILE LABEL            
         BE    *+12                                                             
         LA    RE,L'NETFILS(RE)                                                 
         B     GET11                                                            
         LH    RF,=Y(NETDEM-BASE)  ADDRESS OF CALLING ROUTINE                   
         B     GET25                                                            
*                                                                               
         EJECT                                                                  
***********************************************************************         
* NOW POINT TO ELEMENT TABLE FOR BOOK AND BRANCH TO PROCESSING        *         
* ROUTINE FOR CALL.                                                   *         
***********************************************************************         
*                                                                               
GET20    SR    R4,R4                                                            
         ICM   R4,7,ORGDELEM       GET DISP TO ELEMENT TABLE                    
         LA    R4,BASE(R4)         R4=A(ELEMENT TABLE)                          
         USING ELEMTABD,R4                                                      
         LH    RF,ORGDROUT         GET DISP TO ROUTINE                          
*                                                                               
GET25    LA    RF,BASE(RF)         RF=A(PROCESSING ROUTINE)                     
         L     R6,DBAQUART         R6=A(QUARTER HOUR ELEMENT)                   
         MVI   ELEMMASK,MASK1      SET ELEMENT DEMO TYPE MASK                   
         CLI   CALLTYPE,1          TEST RATINGS AND IMPS REQUESTED              
         BER   RF                                                               
         MVI   ELEMMASK,MASK2      TEST PUTS AND TOTS REQUIRED                  
         CLI   CALLTYPE,2                                                       
         BER   RF                                                               
         MVI   ELEMMASK,MASK5      TEST ONLY UNIVERSES REQUIRED                 
         CLI   CALLTYPE,5                                                       
         BER   RF                                                               
         MVI   ELEMMASK,MASK4                                                   
         CLI   CALLTYPE,4          TEST ALL DEMOS EXCEPT UNIVERSES              
         BER   RF                                                               
         CLI   CALLTYPE,9          TEST FOR EXPLODING IUN RECORD                
         BER   RF                                                               
         CLI   CALLTYPE,10         TEST FOR EXPLODING IUN RECORD                
         BER   RF                                                               
         DC    H'0'                                                             
*                                                                               
GETX     XIT1                                                                   
         EJECT                                                                  
*********************************************************************           
* NETWORK PROCESSING                                                            
* GET DEMOS FROM DEMOUT AND PUT THEM INTO IUN FORMAT                            
*********************************************************************           
*                                                                               
NETDEM   DS    0H                                                               
         GOTO1 VSUBR01,DMCB,('NETDEME',(RC))                                    
         XIT1                                                                   
         EJECT                                                                  
*********************************************************************           
* ARB TIME PERIOD PROCESSING ROUTINE                                            
* EXTRACT SELECTED IUN DEMOS BASED ON ELEMENT TABLES                            
*********************************************************************           
*                                                                               
TTADEM   DS    0H                                                               
         GOTO1 VSUBR01,DMCB,('TTADEME',(RC))                                    
         XIT1                                                                   
         EJECT                                                                  
*********************************************************************           
* TTM -  MEDIAFAX TIME PERIOD PROCESSING ROUTINE                                
* EXTRACT SELECTED IUN DEMOS BASED ON ELEMENT TABLES                            
*********************************************************************           
*                                                                               
TTMDEM   SR    R0,R0                                                            
TTMDEMA  CLI   0(R6),X'20'         TEST FOR CURRENT QUARTER HOUR                
         BE    TTMDEM1                                                          
         BH    TTMDEM1E                                                         
         IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO NEXT DEMO ELEMENT                    
         B     TTMDEMA                                                          
*                                                                               
TTMDEM1  IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO NEXT DEMO ELEMENT                    
         CLI   0(R6),X'00'         TEST FOR EOR                                 
         BE    TTMDEMX                                                          
         CLI   0(R6),X'20'         TEST FOR NEXT QUARTER HOUR                   
         BE    TTMDEMX                                                          
TTMDEM1E CLI   0(R6),X'30'         TEST START OF DEMO ELEMENTS FOR              
         BL    TTMDEM1             THIS QUARTER HOUR                            
*                                                                               
TTMDEM2  CLI   0(R6),0             TEST FOR EOR                                 
         BE    TTMDEM30                                                         
         CLI   ELEMNUM,EOT         TEST END OF ELEMENT TABLE                    
         BE    TTMDEM30                                                         
         CLC   0(1,R6),ELEMNUM     TEST ELEMENT CODE MATCHES TABLE              
         BNE   TTMDEM9             NO BUMP TO NEXT TABLE ENTRY                  
*                                                                               
TTMDEM3  MVC   DEMOTYPE,ELEMTYPE   EXTRACT ELEMENT DEMO TYPE                    
         NC    DEMOTYPE,ELEMMASK   'AND' DEMO TYPE MASK INTO IT                 
         BZ    TTMDEM8             NOT A DEMO TYPE WE WANT                      
         SR    R5,R5                                                            
         ICM   R5,7,ELEMDISP       GET DISP TO ELEMENT DEMO LIST                
         LA    R5,BASE(R5)         RELOCATE TABLE ADDRESS                       
*                                                                               
TTMDEM4  MVC   TABHEAD,0(R5)       SAVE TABLE HEADER                            
         LA    R5,HEADLEN(R5)      AND BUMP R5 PAST IT                          
         USING TTALISTD,R5                                                      
         LR    R1,R6               R1=A(DEMO ELEMENT)                           
         TM    2(R6),X'80'         TEST IF DUPLICATE DEMO ELEMENT               
         BZ    TTMDEM6             NO                                           
         ICM   RE,3,2(R6)          YES                                          
         SLL   RE,17               SHIFT OFF X'80' BIT                          
         SRL   RE,17               RE=DISP INTO DEMO RECORD                     
         L     R1,DBAREC                                                        
         LA    R1,0(RE,R1)                                                      
*                                                                               
*TMDEM6  BAS   RE,PROCEL           PROCESS DEMO ELEMENT                         
TTMDEM6  ST    R1,DMCB+4           NEED TO SAVE R1                              
         GOTO1 VSUBR01,DMCB,('PROCELE',(RC))                                    
*                                                                               
TTMDEM8  IC    R0,1(R6)                                                         
         AR    R6,R0                                                            
*                                                                               
TTMDEM9  LA    R4,ELEMTABL(R4)     NEXT ELEMENT TABLE ENTRY                     
         B     TTMDEM2                                                          
*                                                                               
TTMDEM30 DS    0H                  MOVE OUT IUN VALUES INTO WORK AREA           
* CONVERT PERCENTS TO IMPS IF MISMATCH ON FILE PRECISIONS                       
         CLI   DMAIMP,C'I'                                                      
         BNE   TTMDEM31                                                         
         LA    R8,IUNIVS           SET UP UNIVERSES                             
         LA    RE,IRATINGS         CONVERT THE RATINGS                          
         LA    R9,IUNDEMS                                                       
         LA    R7,0                                                             
RTOIM1   SR    R0,R0                                                            
         L     R1,0(R7,RE)                                                      
         L     R0,0(R7,R8)                                                      
         MR    R0,R0                                                            
         SR    R0,R0                                                            
         A     R1,=F'5'                                                         
         D     R0,=F'10'                                                        
         ST    R1,0(R7,RE)                                                      
         LA    R7,4(R7)                                                         
         BCT   R9,RTOIM1                                                        
*                                                                               
         LA    RE,IPUTS            CONVERT THE PUTS                             
         LA    R9,IUNDEMS                                                       
         LA    R7,0                                                             
RTOIM2   SR    R0,R0                                                            
         L     R1,0(R7,RE)                                                      
         L     R0,0(R7,R8)                                                      
         MR    R0,R0                                                            
         SR    R0,R0                                                            
         A     R1,=F'5'                                                         
         D     R0,=F'10'                                                        
         ST    R1,0(R7,RE)                                                      
         LA    R7,4(R7)                                                         
         BCT   R9,RTOIM2                                                        
*                                                                               
TTMDEM31 CLI   CALLTYPE,2          TEST PUTS/TOTS ONLY                          
         BE    TTMDEM32                                                         
         MVC   UNIVS(IUNDEMS*4,R3),IUNIVS                                       
         MVC   RATINGS(IUNDEMS*4,R3),IRATINGS                                   
         MVC   IMPS(IUNDEMS*4,R3),IIMPS                                         
         CLI   CALLTYPE,1          TEST RATINGS/IMPS ONLY                       
         BE    TTMDEMX             YES                                          
         MVC   PUTS(IUNDEMS*4,R3),IPUTS                                         
         MVC   TOTS(IUNDEMS*4,R3),ITOTS                                         
         B     TTMDEMX                                                          
*                                                                               
TTMDEM32 MVC   0(IUNDEMS*4,R3),IPUTS                                            
         MVC   IUNDEMS*4(IUNDEMS*4,R3),ITOTS                                    
*                                                                               
TTMDEMX  DS    0H                                                               
         XIT1                                                                   
         EJECT                                                                  
* NSI TIME PERIOD PROCESSING ROUTINE                                            
* FIRST EXTRACT DEMOS INTO WORKING STORAGE                                      
*                                                                               
TTNDEM   BAS   RE,TESTGET          TEST TO SEE IF DMA IMP/TOT NEEDED            
*--->    BNE   TTNDEM0             NO                                           
         TM    ELEMMASK,RATING                                                  
         BZ    *+8                                                              
         OI    ELEMMASK,DMA        NO-SO NEED DMA IMPS TO COMPUTE RTGS          
         TM    ELEMMASK,PUT        TEST PUTS REQUIRED                           
         BZ    TTNDEM0                                                          
         OI    ELEMMASK,TSA        YES-SO NEED TSA IMPRESSIONS TOO              
*                                                                               
TTNDEM0  SR    R0,R0                                                            
TTNDEM0A CLI   0(R6),X'20'         TEST FOR CURRENT QUARTER HOUR                
         BE    TTNDEM1                                                          
         BH    TTNDEM1E                                                         
         IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO NEXT DEMO ELEMENT                    
         B     TTNDEM0A                                                         
*                                                                               
TTNDEM1  IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO NEXT DEMO ELEMENT                    
         CLI   0(R6),X'00'         TEST FOR EOR                                 
         BE    TTNDEMX                                                          
         CLI   0(R6),X'20'         TEST FOR NEXT QUARTER HOUR                   
         BE    TTNDEMX                                                          
TTNDEM1E CLI   0(R6),X'30'         TEST START OF DEMO ELEMENTS FOR              
         BL    TTNDEM1             THIS QUARTER HOUR                            
*                                                                               
TTNDEM2  CLI   0(R6),0             TEST FOR EOR                                 
         BE    TTNDEM10                                                         
         CLI   ELEMNUM,EOT         TEST END OF ELEMENT TABLE                    
         BE    TTNDEM10                                                         
         CLC   0(1,R6),ELEMNUM     TEST ELEMENT CODE MATCHES TABLE              
         BNE   TTNDEM9             NO BUMP TO NEXT TABLE ENTRY                  
*                                                                               
         EJECT                                                                  
TTNDEM3  MVC   DEMOTYPE,ELEMTYPE   EXTRACT ELEMENT DEMO TYPE                    
         NC    DEMOTYPE,ELEMMASK   'AND' DEMO TYPE MASK INTO IT                 
         BZ    TTNDEM8             NOT A DEMO TYPE WE WANT                      
         SR    R5,R5                                                            
         ICM   R5,7,ELEMDISP       GET DISP TO ELEMENT DEMO LIST                
         LA    R5,BASE(R5)         RELOCATE TABLE ADDRESS                       
         USING TTNLISTD,R5                                                      
*                                                                               
TTNDEM4  LR    R1,R6               R1=A(DEMO ELEMENT)                           
         TM    2(R6),X'80'         TEST IF DUPLICATE DEMO ELEMENT               
         BZ    TTNDEM6             NO                                           
         ICM   RE,3,2(R6)          YES                                          
         SLL   RE,17               SHIFT OFF X'80' BIT                          
         SRL   RE,17               RE=DISP INTO DEMO RECORD                     
         L     R1,DBAREC                                                        
         LA    R1,0(RE,R1)                                                      
*                                                                               
TTNDEM6  BAS   RE,EXPEL            EXPLODE DEMO ELEMENT                         
*                                                                               
TTNDEM8  IC    R0,1(R6)                                                         
         AR    R6,R0                                                            
*                                                                               
TTNDEM9  LA    R4,ELEMTABL(R4)     NEXT ELEMENT TABLE ENTRY                     
         B     TTNDEM2                                                          
         SPACE 2                                                                
* CALCULATE THE IUN VALUES FROM THE NSI SUPPLIED CATEGORIES                     
*                                                                               
* FIRST COMPUTE THE UNIVERSES                                                   
*                                                                               
TTNDEM10 MVC   HOMES*4+IUNIVS(4),NUHOMES                                        
         MVC   WWORK*4+IUNIVS(4),NUWWORK                                        
         MVC   V611*4+IUNIVS(4),NUV611                                          
         MVC   METROA*4+IUNIVS(4),NUMETROA                                      
         MVC   METROB*4+IUNIVS(4),NUMETROB                                      
* FOR TYPICAL TIME PERIOD OVERNIGHTS FILE - MERGE CATEGORIES                    
* 1214+1517 = 1217 TO CONFORM TO TYPICAL TIME PERIOD                            
*                                                                               
         CLI   DBSELMED,C'O'       OVERNIGHT?                                   
         BNE   TTNDEM11                                                         
         L     RE,NTM1214                                                       
         L     RF,NTM1517                                                       
         AR    RE,RF                                                            
         ST    RE,NTM1217                                                       
                                                                                
         L     RE,NTW1214                                                       
         L     RF,NTW1517                                                       
         AR    RE,RF                                                            
         ST    RE,NTW1217                                                       
         L     RE,NDM1214                                                       
         L     RF,NDM1517                                                       
         AR    RE,RF                                                            
         ST    RE,NDM1217                                                       
                                                                                
         L     RE,NDW1214                                                       
         L     RF,NDW1517                                                       
         AR    RE,RF                                                            
         ST    RE,NDW1217                                                       
                                                                                
         L     RE,NWM1214                                                       
         L     RF,NWM1517                                                       
         AR    RE,RF                                                            
         ST    RE,NWM1217                                                       
                                                                                
         L     RE,NWW1214                                                       
         L     RF,NWW1517                                                       
         AR    RE,RF                                                            
         ST    RE,NWW1217                                                       
                                                                                
         L     RE,NUM1214                                                       
         L     RF,NUM1517                                                       
         AR    RE,RF                                                            
         ST    RE,NUM1217                                                       
                                                                                
         L     RE,NUW1214                                                       
         L     RF,NUW1517                                                       
         AR    RE,RF                                                            
         ST    RE,NUW1217                                                       
*                                                                               
TTNDEM11 OC    NUW1820,NUW1820     CHECK FOR EXISTANCE                          
         BZ    TTNDEM12                                                         
* UNIVERSES                                                                     
         LM    R4,R7,NUW1820       W1820,W2124,M1820,M2124                      
         AR    R4,R5                                                            
         ST    R4,NUW1824                                                       
         AR    R6,R7                                                            
         ST    R6,NUM1824                                                       
* DMA                                                                           
         LM    R4,R7,NDW1820       W1820,W2124,M1820,M2124                      
         AR    R4,R5                                                            
         ST    R4,NDW1824                                                       
         AR    R6,R7                                                            
         ST    R6,NDM1824                                                       
* TSA                                                                           
         LM    R4,R7,NTW1820       W1820,W2124,M1820,M2124                      
         AR    R4,R5                                                            
         ST    R4,NTW1824                                                       
         AR    R6,R7                                                            
         ST    R6,NTM1824                                                       
* TSA TOT                                                                       
         LM    R4,R7,NQW1820       W1820,W2124,M1820,M2124                      
         AR    R4,R5                                                            
         ST    R4,NQW1824                                                       
         AR    R6,R7                                                            
         ST    R6,NQM1824                                                       
* DMA TOT                                                                       
         LM    R4,R7,NWW1820       W1820,W2124,M1820,M2124                      
         AR    R4,R5                                                            
         ST    R4,NWW1824                                                       
         AR    R6,R7                                                            
         ST    R6,NWM1824                                                       
*                                                                               
TTNDEM12 LM    R4,R9,NUW1824       W1824,W2534,W3549,W5054,W5564,W65+           
         LR    RE,R4               UW1824                                       
         AR    RE,R5               UW1834=UW1824+UW2534                         
         ST    RE,W1834*4+IUNIVS                                                
         LR    R0,RE               SAVE UW1834 IN R0                            
*                                                                               
         LR    RF,R5               UW2534                                       
         AR    RF,R6               UW2549=UW2534+UW3549                         
         ST    RF,W2549*4+IUNIVS                                                
         AR    RE,R6               UW1849=UW1834+UW3549                         
         ST    RE,W1849*4+IUNIVS                                                
         LR    R1,RE               SAVE UW1849 IN R1                            
*                                                                               
         AR    RF,R7               UW2554=UW2549+UW5054                         
         ST    RF,W2554*4+IUNIVS                                                
         AR    RF,R8               UW2564=UW2554+UW5564                         
         ST    RF,W2564*4+IUNIVS                                                
         AR    RF,R4               UW1864=UW2564+UW1824                         
         AR    RF,R9               UW18+=UW1864+UW65+                           
         ST    RF,W1899*4+IUNIVS                                                
*                                                                               
TTNDEM14 LM    R4,R9,NUM1824       M1824,M2534,M3549,M5054,M5564,M65+           
         LR    RE,R4               UM1824                                       
         AR    RE,R5               UM1834=UM1824+UM2534                         
         ST    RE,M1834*4+IUNIVS                                                
         AR    R0,RE               UV1834=UW1834+UM1834                         
         ST    R0,V1834*4+IUNIVS                                                
*                                                                               
         LR    RF,R5               UM2534                                       
         AR    RF,R6               UM2549=UM1834+UM3549                         
         ST    RF,M2549*4+IUNIVS                                                
         AR    RE,R6               UM1849=UM1834+UM3549                         
         ST    RE,M1849*4+IUNIVS                                                
         AR    R1,RE               UV1849=UW1849+UM1849                         
         ST    R1,V1849*4+IUNIVS                                                
*                                                                               
         AR    RF,R7               UM2554=UM2549+UM5054                         
         ST    RF,M2554*4+IUNIVS                                                
         LR    R0,RF                                                            
         A     R0,W2554*4+IUNIVS   UV2554=WM2554+UW2554                         
         ST    R0,V2554*4+IUNIVS                                                
         AR    RF,R8               UM2564=UM2554+UM5564                         
         ST    RF,M2564*4+IUNIVS                                                
         AR    RF,R4               UM1864=UM2564+UM1824                         
         AR    RF,R9               UM18+=UM1864+UM65+                           
         ST    RF,M1899*4+IUNIVS                                                
*                                                                               
TTNDEM16 A     RF,W1899*4+IUNIVS   UV18+=UM18+ + UW18+                          
         ST    RF,V1899*4+IUNIVS                                                
         LM    R0,R1,NUV25         V2-5, V6-11                                  
         LM    R4,R6,NUW1217       W1217,W1824,W2534                            
         LM    R7,R9,NUM1217       M1217,M1824,M2534                            
*                                                                               
         AR    R0,R1               UV211=UV25+UV611                             
         ST    R0,V211*4+IUNIVS                                                 
         LR    RE,R4                                                            
         AR    RE,R7               UV1217=UW1217+UM1217                         
         ST    RE,V1217*4+IUNIVS                                                
         AR    R0,RE               UV2-17=UV2-11+UV12-17                        
         AR    R0,RF               UV2+=UV2-17+UV18+                            
         ST    R0,V299*4+IUNIVS                                                 
         LR    R1,R4                                                            
         AR    R1,R5               UW1224=UW1217+UW1824                         
         ST    R1,W1224*4+IUNIVS                                                
*                                                                               
         LR    RE,R7               UM1217                                       
         AR    RE,R8               UM1224=UMU217+UM1824                         
         AR    RE,R1               UV1224=UM1224+UW1224                         
         ST    RE,V1224*4+IUNIVS                                                
*                                                                               
         AR    R1,R6               UW1234=UW1224+UW2534                         
         ST    R1,W1234*4+IUNIVS                                                
         AR    RE,R6               UV1224+UW2534                                
         AR    RE,R9               +UM2534=UV1234                               
         ST    RE,V1234*4+IUNIVS                                                
*                                                                               
         OC    NUW1820,NUW1820                                                  
         BZ    TTNDEM20                                                         
         L     RE,W1849*4+IUNIVS                                                
         S     RE,NUW1820                                                       
         ST    RE,W2149*4+IUNIVS                                                
         L     RF,M1849*4+IUNIVS                                                
         S     RF,NUM1820                                                       
         ST    RF,M2149*4+IUNIVS                                                
         AR    RE,RF                                                            
         ST    RE,V2149*4+IUNIVS                                                
         SPACE 2                                                                
* NEXT COMPUTE THE IMPRESSIONS                                                  
*                                                                               
TTNDEM20 TM    ELEMMASK,IMP                                                     
         BZ    TTNDEM30                                                         
         MVC   HOMES*4+IIMPS(4),NTHOMES                                         
         MVC   WWORK*4+IIMPS(4),NTWWORK                                         
         MVC   V611*4+IIMPS(4),NTV611                                           
*                                                                               
TTNDEM22 LM    R4,R9,NTW1824       W1824,W2534,W3549,W5054,W5564,W65+           
         LR    RE,R4               TW1824                                       
         AR    RE,R5               TW1834=TW1824+TW2534                         
         ST    RE,W1834*4+IIMPS                                                 
         LR    R0,RE               SAVE TW1834 IN R0                            
*                                                                               
         LR    RF,R5               TW2534                                       
         AR    RF,R6               TW2549=TW2534+TW3549                         
         ST    RF,W2549*4+IIMPS                                                 
         AR    RE,R6               TW1849=TW1834+TW3549                         
         ST    RE,W1849*4+IIMPS                                                 
         LR    R1,RE               SAVE TW1849 IN R1                            
*                                                                               
         AR    RF,R7               TW2554=TW2549+TW5054                         
         ST    RF,W2554*4+IIMPS                                                 
         AR    RF,R8               TW2564=TW2554+TW5564                         
         ST    RF,W2564*4+IIMPS                                                 
         AR    RF,R4               TW1864=TW2564+TW1824                         
         AR    RF,R9               TW18+=TW1864+TW65+                           
         ST    RF,W1899*4+IIMPS                                                 
*                                                                               
TTNDEM23 LM    R4,R9,NTM1824       M1824,M2534,M3549,M5054,M5564,M65+           
         LR    RE,R4               TM1824                                       
         AR    RE,R5               TM1834=TM1824+TM2534                         
         ST    RE,M1834*4+IIMPS                                                 
         AR    R0,RE               TV1834=TW1834+TM1834                         
         ST    R0,V1834*4+IIMPS                                                 
*                                                                               
         LR    RF,R5               TM2534                                       
         AR    RF,R6               TM2549=TM1834+TM3549                         
         ST    RF,M2549*4+IIMPS                                                 
         AR    RE,R6               TM1849=TM1834+TM3549                         
         ST    RE,M1849*4+IIMPS                                                 
         AR    R1,RE               TV1849=TW1849+TM1849                         
         ST    R1,V1849*4+IIMPS                                                 
*                                                                               
         AR    RF,R7               TM2554=TM2549+TM5054                         
         ST    RF,M2554*4+IIMPS                                                 
         LR    R0,RF                                                            
         A     R0,W2554*4+IIMPS    TV2554=TM2554+TW2554                         
         ST    R0,V2554*4+IIMPS                                                 
         AR    RF,R8               TM2564=TM2554+TM5564                         
         ST    RF,M2564*4+IIMPS                                                 
         AR    RF,R4               TM1864=TM2564+TM1824                         
         AR    RF,R9               TM18+=TM1864+TM65+                           
         ST    RF,M1899*4+IIMPS                                                 
*                                                                               
TTNDEM24 A     RF,W1899*4+IIMPS    TV18+=TM18+ + TW18+                          
         ST    RF,V1899*4+IIMPS                                                 
         LM    R0,R1,NTV25         V2-5, V6-11                                  
         LM    R4,R6,NTW1217       W1217,W1824,W2534                            
         LM    R7,R9,NTM1217       M1217,M1824,M2534                            
*                                                                               
         AR    R0,R1               TV211=TV25+TV611                             
         ST    R0,V211*4+IIMPS                                                  
         LR    RE,R4                                                            
         AR    RE,R7               TV1217=TW1217+TM1217                         
         ST    RE,V1217*4+IIMPS                                                 
         AR    R0,RE               TV2-17=TV2-11+TV12-17                        
         AR    R0,RF               TV2+=TV2-17+TV18+                            
         ST    R0,V299*4+IIMPS                                                  
         LR    R1,R4                                                            
         AR    R1,R5               TW1224=TW1217+TW1824                         
         ST    R1,W1224*4+IIMPS                                                 
*                                                                               
         LR    RE,R7               TM1217                                       
         AR    RE,R8               TM1224=TM1217+TM1824                         
         AR    RE,R1               TV1224=TM1224+TW1224                         
         ST    RE,V1224*4+IIMPS                                                 
*                                                                               
         AR    R1,R6               TW1234=TW1224+TW2534                         
         ST    R1,W1234*4+IIMPS                                                 
         AR    RE,R6               TV1224+TW2534                                
         AR    RE,R9               +TM2534=TV1234                               
         ST    RE,V1234*4+IIMPS                                                 
* ADDITIONAL OCT/90 DEMOS                                                       
         OC    NUW1820,NUW1820     UNIV WILL BE THERE IF                        
         BZ    TTNDEM25            DATA IS AVAILABLE                            
         L     RE,W1849*4+IIMPS                                                 
         S     RE,NTW1820                                                       
         ST    RE,W2149*4+IIMPS                                                 
         L     RF,M1849*4+IIMPS                                                 
         S     RF,NTM1820                                                       
         ST    RF,M2149*4+IIMPS                                                 
         AR    RE,RF                                                            
         ST    RE,V2149*4+IIMPS                                                 
*                                                                               
* NOW ADJUST THE PRECISION OF IMPRESSIONS TO IUN (HUNDREDS)                     
*                                                                               
TTNDEM25 LA    R0,IUNDEMS          R0=COUNTER                                   
         LA    R1,10               R1=10                                        
         LA    RE,500              RE=500                                       
         LA    RF,1000             RF=1000                                      
         LA    R6,IIMPS            R6=A(VALUE)                                  
*                                                                               
TTNDEM26 SR    R4,R4                                                            
         L     R5,0(R6)            GET IMPRESSION                               
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         MR    R4,R1               *10                                          
         ST    R5,0(R6)                                                         
         LA    R6,4(R6)                                                         
         BCT   R0,TTNDEM26                                                      
*                                                                               
         EJECT                                                                  
* COMPUTE TMETROA AND TMETROB                                                   
*                                                                               
TTNDEM27 LA    R1,10               R1=10                                        
         LA    RE,500              RE=500                                       
         LA    RF,1000             RF=1000                                      
         L     R5,NRMETROA         R5=RMETROA                                   
         SR    R4,R4               SCALE IT TO 1 DECIMAL DINKED                 
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         MR    R4,R1               *10                                          
*                                                                               
         L     R7,NUMETROA         R7=UMETROA                                   
         SR    R6,R6               SCALE TO HUNDREDS                            
         AR    R7,RE               +500                                         
         DR    R6,RF               /1000                                        
         MR    R6,R1               *10                                          
*                                                                               
         MR    R4,R7               TMETROA=RMETROA*UMETROA                      
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         ST    R5,METROA*4+IIMPS                                                
*                                                                               
TTNDEM28 L     R5,NRMETROB         R5=RMETROB                                   
         SR    R4,R4               SCALE IT                                     
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         MR    R4,R1               *10                                          
*                                                                               
         L     R7,NUMETROB         R7=UMETROB                                   
         SR    R6,R6               SCALE TO HUNDREDS                            
         AR    R7,RE               +500                                         
         DR    R6,RF               /1000                                        
         MR    R6,R1               *10                                          
*                                                                               
         MR    R4,R7               TMETROB=RMETROB*UMETROB                      
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         ST    R5,METROB*4+IIMPS                                                
         EJECT                                                                  
* USE THE IUN RATINGS IF PRESENT, OTHERWISE CALCULATE THEM FROM THE             
* DMA IMPRESSIONS                                                               
*                                                                               
TTNDEM30 DS    0H                                                               
         TM    ELEMMASK,RATING                                                  
         BZ    TTNDEM40                                                         
         OC    NUW1820,NUW1820     OCT/90 AVAILABLE                             
         BZ    TTNDEM30A                                                        
         L     R4,NDW2124                                                       
         LM    R5,R6,NDW2534                                                    
         AR    R5,R4                                                            
         AR    R5,R6                                                            
         LR    R8,R5               W2149                                        
         M     R4,=F'1000'                                                      
         ICM   R0,15,W2149*4+IUNIVS  R0 = UW2149                                
         DR    R4,R0                                                            
         ST    R5,W2149*4+IRATINGS                                              
*                                                                               
         L     R4,NDM2124                                                       
         LM    R5,R6,NDM2534                                                    
         AR    R5,R4                                                            
         AR    R5,R6                                                            
         LR    R9,R5               M2149                                        
         M     R4,=F'1000'                                                      
         ICM   R0,15,M2149*4+IUNIVS  R0 = UM2149                                
         DR    R4,R0                                                            
         ST    R5,M2149*4+IRATINGS                                              
*                                                                               
         AR    R9,R8                                                            
         M     R8,=F'1000'                                                      
         ICM   R0,15,V2149*4+IUNIVS  R0 = UV2149                                
         DR    R8,R0                                                            
         ST    R9,V2149*4+IRATINGS                                              
*                                                                               
TTNDEM30A DS   0H                                                               
         CLI   DMAIMP,C'I'         SAVE IMPRESSIONS?                            
         BE    TTNDEM32            BUILD THEM                                   
         CLI   RTGPUT,C'Y'        TEST IF RATING ELEMENT PRESENT                
         BNE   TTNDEM32            NO                                           
         CLI   BOOKTYPE,X'05'      TEST IF NSI 2A-6A DATA                       
         BE    TTNDEM32             YES, MISSING SOME RTGS, BUILD IMPS          
*                                                                               
         LA    R0,IUNDEMS          YES-DINK THE ELEMENT VALUES                  
         LA    RE,5                RE=5                                         
         LA    RF,10               RF=10                                        
         LA    R6,IRATINGS         R6=A(UNROUNDED RATINGS)                      
*                                                                               
TTNDEM31 L     R5,0(R6)            GET UNROUNDED RATING                         
         SR    R4,R4                                                            
         CLI   FILTYP,C'P'                                                      
         BE    *+10                                                             
         AR    R5,RE               +5                                           
         DR    R4,RF               /10                                          
         MR    R4,RF               *10                                          
         ST    R5,0(R6)                                                         
         LA    R6,4(R6)                                                         
         BCT   R0,TTNDEM31                                                      
*                                                                               
         OC    V2554*4+IRATINGS(4),V2554*4+IRATINGS TEST RV2554 THERE           
         BNZ   TTNDEM38            YES                                          
*                                                                               
         LM    R4,R6,NDW2534       R4=DW2534,R5=DW3549,R6=DW5054                
         LM    R7,R9,NDM2534       R7=DM2534,R8=DM3549,R9=DM5054                
         AR    R5,R4                                                            
         AR    R5,R6                                                            
         AR    R5,R7                                                            
         AR    R5,R8                                                            
         AR    R5,R9               R5=DV2554                                    
*                                                                               
         M     R4,=F'1000'         SCALE THE DIVIDEND                           
         ICM   R0,15,V2554*4+IUNIVS R0=UV2554                                   
         BNZ   *+14                                                             
         SR    R5,R5                                                            
         ST    R5,V2554*4+IRATINGS                                              
         B     TTNDEM38                                                         
*                                                                               
         DR    R4,R0               DV2554*1000/UV2554                           
         SR    R4,R4                                                            
         CLI   FILTYP,C'P'                                                      
         BE    *+16                                                             
         AH    R5,=H'5'            +5                                           
         D     R4,=F'10'           /10                                          
         M     R4,=F'10'           *10                                          
         ST    R5,V2554*4+IRATINGS                                              
         B     TTNDEM38                                                         
*                                                                               
* RATINGS MISSING - COMPUTE THE DMA IMPRESSIONS                                 
*                                                                               
TTNDEM32 MVC   HOMES*4+IDMAS(4),NDHOMES                                         
         MVC   WWORK*4+IDMAS(4),NDWWORK                                         
         MVC   V611*4+IDMAS(4),NDV611                                           
         LM    R4,R9,NDW1824       W1824,W2534,W3549,W5054,W5564,W65+           
         LR    RE,R4               DW1824                                       
         AR    RE,R5               DW1834=DW1824+DW2534                         
         ST    RE,W1834*4+IDMAS                                                 
         LR    R0,RE               SAVE DW1834 IN R0                            
*                                                                               
         LR    RF,R5               DW2534                                       
         AR    RF,R6               DW2549=DW2534+DW3549                         
         ST    RF,W2549*4+IDMAS                                                 
         AR    RE,R6               DW1849=DW1834+DW3549                         
         ST    RE,W1849*4+IDMAS                                                 
         LR    R1,RE               SAVE DW1849 IN R1                            
*                                                                               
         AR    RF,R7               DW2554=DW2549+DW5054                         
         ST    RF,W2554*4+IDMAS                                                 
         AR    RF,R8               DW2564=DW2554+DW5564                         
         ST    RF,W2564*4+IDMAS                                                 
         AR    RF,R4               DW1864=DW2564+DW1824                         
         AR    RF,R9               DW18+=DW1864+DW65+                           
         ST    RF,W1899*4+IDMAS                                                 
*                                                                               
TTNDEM33 LM    R4,R9,NDM1824       M1824,M2534,M3549,M5054,M5564,M65+           
         LR    RE,R4               DM1824                                       
         AR    RE,R5               DM1834=DM1824+DM2534                         
         ST    RE,M1834*4+IDMAS                                                 
         AR    R0,RE               DV1834=DW1834+DM1834                         
         ST    R0,V1834*4+IDMAS                                                 
*                                                                               
         LR    RF,R5               DM2534                                       
         AR    RF,R6               DM2549=DM1834+DM3549                         
         ST    RF,M2549*4+IDMAS                                                 
         AR    RE,R6               DM1849=DM1834+DM3549                         
         ST    RE,M1849*4+IDMAS                                                 
         AR    R1,RE               DV1849=DW1849+DM1849                         
         ST    R1,V1849*4+IDMAS                                                 
*                                                                               
         AR    RF,R7               DM2554=DM2549+DM5054                         
         ST    RF,M2554*4+IDMAS                                                 
         LR    R0,RF                                                            
         A     R0,W2554*4+IDMAS    DV2554=DM2554+DW2554                         
         ST    R0,V2554*4+IDMAS                                                 
         AR    RF,R8               DM2564=DM2554+DM5564                         
         ST    RF,M2564*4+IDMAS                                                 
         AR    RF,R4               DM1864=DM2564+DM1824                         
         AR    RF,R9               DM18+=DM1864+DM65+                           
         ST    RF,M1899*4+IDMAS                                                 
*                                                                               
TTNDEM34 A     RF,W1899*4+IDMAS    DV18+=DM18+ + DW18+                          
         ST    RF,V1899*4+IDMAS                                                 
         LM    R0,R1,NDV25         V2-5, V6-11                                  
         LM    R4,R6,NDW1217       W1217,W1824,W2534                            
         LM    R7,R9,NDM1217       M1217,M1824,M2534                            
*                                                                               
         ST    R1,V611*4+IDMAS     DV611                                        
         AR    R0,R1               DV211=DV25+DV611                             
         ST    R0,V211*4+IDMAS                                                  
         LR    RE,R4                                                            
         AR    RE,R7               DV1217=DW1217+DM1217                         
         ST    RE,V1217*4+IDMAS                                                 
         AR    R0,RE               DV2-17=DV2-11+DV12-17                        
         AR    R0,RF               DV2+=DV2-17+DV18+                            
         ST    R0,V299*4+IDMAS                                                  
         LR    R1,R4                                                            
         AR    R1,R5               DW1224=DW1217+DW1824                         
         ST    R1,W1224*4+IDMAS                                                 
*                                                                               
         LR    RE,R7               DM1217                                       
         AR    RE,R8               DM1224=DMU217+DM1824                         
         AR    RE,R1               DV1224=DM1224+DW1224                         
         ST    RE,V1224*4+IDMAS                                                 
*                                                                               
         AR    R1,R6               DW1234=DW1224+DW2534                         
         ST    R1,W1234*4+IDMAS                                                 
         AR    RE,R6               DV1224+DW2534                                
         AR    RE,R9               +DM2534=DV1234                               
         ST    RE,V1234*4+IDMAS                                                 
*                                                                               
* ADDITIONAL OCT/90 DEMOS                                                       
         OC    NUW1820,NUW1820     UNIV WILL BE THERE IF                        
         BZ    TTNDEM35            DATA IS AVAILABLE                            
         L     RE,W1849*4+IDMAS                                                 
         S     RE,NDW1820                                                       
         ST    RE,W2149*4+IDMAS                                                 
         L     RF,M1849*4+IDMAS                                                 
         S     RF,NDM1820                                                       
         ST    RF,M2149*4+IDMAS                                                 
         AR    RE,RF                                                            
         ST    RE,V2149*4+IDMAS                                                 
         EJECT                                                                  
* NOW COMPUTE THE RATINGS FROM THE DMA IMPRESSIONS AND UNIVERSES                
*                                                                               
TTNDEM35 LA    R0,IUNDEMS          R0=LOOP COUNTER                              
         LA    R1,1000                                                          
         LA    RE,5                                                             
         LA    RF,10                                                            
         LA    R6,IDMAS            R6=A(DMA IMPRESSION)                         
         LA    R7,IUNIVS           R7=A(UNIVERSE)                               
         LA    R8,IRATINGS         R8=A(RATING)                                 
*                                                                               
TTNDEM36 L     R5,0(R6)            GET DMA IMPRESSION                           
         CLI   DMAIMP,C'I'         SAVE IMPS RATHER THAN RTGS                   
         BE    TTNDEM37                                                         
         MR    R4,R1               *1000                                        
         ICM   R9,15,0(R7)         GET UNIVERSE                                 
         BNZ   *+10                                                             
         SR    R5,R5                                                            
         B     TTNDEM37                                                         
*                                                                               
         DR    R4,R9               R5=UNROUNDED RATING                          
         SR    R4,R4                                                            
         CLI   FILTYP,C'P'                                                      
         BE    *+10                                                             
         AR    R5,RE               +5                                           
         DR    R4,RF               /10                                          
         MR    R4,RF               *10                                          
*                                                                               
TTNDEM37 ST    R5,0(R8)                                                         
         LA    R6,4(R6)            NEXT DMA IMPRESSION                          
         LA    R7,4(R7)            NEXT UNIVERSE                                
         LA    R8,4(R8)            NEXT RATING                                  
         BCT   R0,TTNDEM36                                                      
*                                                                               
* ADJUST RHOMES,RMETROA,RMETROB FROM NSI PRECISION TO IUN PRECISION             
*                                                                               
TTNDEM38 LA    R0,3                R0=LOOP COUNTER                              
         LA    R1,10                                                            
         LA    RE,500                                                           
         LA    RF,1000                                                          
         CLI   FILTYP,C'P'                                                      
         BNE   *+16                                                             
         LA    R1,1                                                             
         LA    RE,50                                                            
         LA    RF,100                                                           
         LA    R6,NRHOMES                                                       
         LA    R7,HOMES*4+IRATINGS                                              
                                                                                
         DS    0H                                                               
         CLI   BOOKTYPE,X'05'      IF NSI 2A-6A DATA,                           
         BNE   *+12                                                             
         CLI   DMAIMP,C'I'          AND IT'S RATINGS-BASED,                     
         BNE   TTNDM39G              ALREADY IN IUN PRECISION                   
         BCT   R0,*+4              LEAVE DMA HOMES ALONE                        
*                                                                               
         MVC   0(4,R7),NDHOMES                                                  
         LA    R6,4(R6)                                                         
         LA    R7,4(R7)                                                         
*                                                                               
TTNDEM39 L     R5,0(R6)            GET UNADJUSTED RATING                        
         SR    R4,R4                                                            
         CH    R1,=H'1'            TRUNCATE IF NO RESCALING                     
         BE    *+6                                                              
         AR    R5,RE               +50?                                         
         DR    R4,RF               /100?                                        
         MR    R4,R1               *1?                                          
         ST    R5,0(R7)                                                         
         LA    R6,4(R6)                                                         
         LA    R7,4(R7)                                                         
         BCT   R0,TTNDEM39                                                      
TTNDM39G EQU   *                                                                
         EJECT                                                                  
*                                                                               
* NEXT COMPUTE THE TOTS                                                         
*                                                                               
TTNDEM40 TM    ELEMMASK,TOT        TEST TOT REQUIRED                            
         BZ    TTNDEM50            NO                                           
*                                                                               
         MVC   HOMES*4+ITOTS(4),NQHOMES                                         
         MVC   WWORK*4+ITOTS(4),NQWWORK                                         
         MVC   V611*4+ITOTS(4),NQV611                                           
*                                                                               
TTNDEM41 LM    R4,R9,NQW1824       W1824,W2534,W3549,W5054,W5564,W65+           
         LR    RE,R4               QW1824                                       
         AR    RE,R5               QW1834=QW1824+QW2534                         
         ST    RE,W1834*4+ITOTS                                                 
         LR    R0,RE               SAVE QW1834 IN R0                            
*                                                                               
         LR    RF,R5               QW2534                                       
         AR    RF,R6               QW2549=QW2534+QW3549                         
         ST    RF,W2549*4+ITOTS                                                 
         AR    RE,R6               QW1849=QW1834+QW3549                         
         ST    RE,W1849*4+ITOTS                                                 
         LR    R1,RE               SAVE QW1849 IN R1                            
*                                                                               
         AR    RF,R7               QW2554=QW2549+QW5054                         
         ST    RF,W2554*4+ITOTS                                                 
         AR    RF,R8               QW2564=QW2554+QW5564                         
         ST    RF,W2564*4+ITOTS                                                 
         AR    RF,R4               QW1864=QW2564+QW1824                         
         AR    RF,R9               QW18+=QW1864+QW65+                           
         ST    RF,W1899*4+ITOTS                                                 
*                                                                               
TTNDEM42 LM    R4,R9,NQM1824       M1824,M2534,M3549,M5054,M5564,M65+           
         LR    RE,R4               QM1824                                       
         AR    RE,R5               QM1834=QM1824+QM2534                         
         ST    RE,M1834*4+ITOTS                                                 
         AR    R0,RE               QV1834=QW1834+QM1834                         
         ST    R0,V1834*4+ITOTS                                                 
*                                                                               
         LR    RF,R5               QM2534                                       
         AR    RF,R6               QM2549=QM1834+QM3549                         
         ST    RF,M2549*4+ITOTS                                                 
         AR    RE,R6               QM1849=QM1834+QM3549                         
         ST    RE,M1849*4+ITOTS                                                 
         AR    R1,RE               QV1849=QW1849+QM1849                         
         ST    R1,V1849*4+ITOTS                                                 
*                                                                               
         AR    RF,R7               QM2554=QM2549+QM5054                         
         ST    RF,M2554*4+ITOTS                                                 
         LR    R0,RF                                                            
         A     R0,W2554*4+ITOTS    QV2554=QM2554+QW2554                         
         ST    R0,V2554*4+ITOTS                                                 
         AR    RF,R8               QM2564=QM2554+QM5564                         
         ST    RF,M2564*4+ITOTS                                                 
         AR    RF,R4               QM1864=QM2564+QM1824                         
         AR    RF,R9               QM18+=QM1864+QM65+                           
         ST    RF,M1899*4+ITOTS                                                 
*                                                                               
TTNDEM44 A     RF,W1899*4+ITOTS    QV18+=QM18+ + QW18+                          
         ST    RF,V1899*4+ITOTS                                                 
         LM    R0,R1,NQV25         V2-5, V6-11                                  
         LM    R4,R6,NQW1217       W1217,W1824,W2534                            
         LM    R7,R9,NQM1217       M1217,M1824,M2534                            
*                                                                               
         AR    R0,R1               QV211=QV25+QV611                             
         ST    R0,V211*4+ITOTS                                                  
         LR    RE,R4                                                            
         AR    RE,R7               QV1217=QW1217+QM1217                         
         ST    RE,V1217*4+ITOTS                                                 
         AR    R0,RE               QV2-17=QV2-11+QV12-17                        
         AR    R0,RF               QV2+=QV2-17+QV18+                            
         ST    R0,V299*4+ITOTS                                                  
         LR    R1,R4                                                            
         AR    R1,R5               QW1224=QW1217+QW1824                         
         ST    R1,W1224*4+ITOTS                                                 
*                                                                               
         LR    RE,R7               QM1217                                       
         AR    RE,R8               QM1224=QM1217+QM1824                         
         AR    RE,R1               QV1224=QM1224+QW1224                         
         ST    RE,V1224*4+ITOTS                                                 
*                                                                               
         AR    R1,R6               QW1234=QW1224+QW2534                         
         ST    R1,W1234*4+ITOTS                                                 
         AR    RE,R6               QV1224+QW2534                                
         AR    RE,R9               +QM2534=QV1234                               
         ST    RE,V1234*4+ITOTS                                                 
* ADDITIONAL OCT/90 DEMOS                                                       
         OC    NUW1820,NUW1820     UNIV WILL BE THERE IF                        
         BZ    TTNDEM45            DATA IS AVAILABLE                            
         L     RE,W1849*4+ITOTS                                                 
         S     RE,NQW1820                                                       
         ST    RE,W2149*4+ITOTS                                                 
         L     RF,M1849*4+ITOTS                                                 
         S     RF,NQM1820                                                       
         ST    RF,M2149*4+ITOTS                                                 
         AR    RE,RF                                                            
         ST    RE,V2149*4+ITOTS                                                 
*                                                                               
* NOW ADJUST THE PRECISION OF TOTS TO IUN (HUNDREDS)                            
*                                                                               
TTNDEM45 LA    R0,IUNDEMS          R0=COUNTER                                   
         LA    R1,10               R1=10                                        
         LA    RE,500              RE=500                                       
         LA    RF,1000             RF=1000                                      
         LA    R6,ITOTS            R6=A(VALUE)                                  
*                                                                               
TTNDEM46 SR    R4,R4                                                            
         L     R5,0(R6)            GET TOT                                      
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         MR    R4,R1               *10                                          
         ST    R5,0(R6)                                                         
         LA    R6,4(R6)                                                         
         BCT   R0,TTNDEM46                                                      
*                                                                               
         EJECT                                                                  
* WIND UP BY COMPUTING QMETA AND QMETB                                          
*                                                                               
TTNDEM48 LA    RE,500                                                           
         LA    RF,1000                                                          
         LA    R1,10                                                            
         L     R5,NPMETROA         GET NSI PUT                                  
         SR    R4,R4               SCALE TO ONE DECIMAL PLACE                   
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         MR    R4,R1               *10  ROUNDED                                 
*                                                                               
         L     R7,METROA*4+IUNIVS  GET UMETA (INTEGER)                          
         SR    R6,R6               SCALE TO HUNDREDS                            
         AR    R7,RE               +500                                         
         DR    R6,RF               /1000                                        
         MR    R6,R1               *10                                          
*                                                                               
         MR    R4,R7               QMETA=PMETA*UMETA                            
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         ST    R5,METROA*4+ITOTS                                                
*                                                                               
         L     R5,NPMETROB         GET NSI PMETROB                              
         SR    R4,R4                                                            
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         MR    R4,R1               *10                                          
*                                                                               
         L     R7,METROB*4+IUNIVS  GET UMETB (INTEGER)                          
         SR    R6,R6               SCALE TO HUNDREDS                            
         AR    R7,RE               +500                                         
         DR    R6,RF               /1000                                        
         MR    R6,R1               *10                                          
*                                                                               
         MR    R4,R7               QMETB=PMETB * UMETB                          
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         ST    R5,METROB*4+ITOTS                                                
         EJECT                                                                  
* USE THE IUN PUTS IF PRESENT, OTHERWISE CALCULATE THEM FROM THE                
* TSA IMPRESSIONS                                                               
*                                                                               
TTNDEM50 TM    ELEMMASK,PUT        TEST IF PUT REQUIRED                         
         BZ    TTNDEM60                                                         
         CLI   DMAIMP,C'I'         TOTALS NOT %AGE                              
         BE    TTNDEM51                                                         
         CLI   RTGPUT,C'Y'         TEST IF PUT ELEMENT PRESENT                  
         BE    TTNDEM58                                                         
*                                                                               
* PUTS MISSING - COMPUTE THE DMA TOTAL IMPRESSIONS                              
*                                  (ITSAS USED AS A CONVENIENCE)                
TTNDEM51 MVC   HOMES*4+ITSAS(4),NWHOMES                                         
         MVC   WWORK*4+ITSAS(4),NWWWORK                                         
         MVC   V611*4+ITSAS(4),NWV611                                           
         LM    R4,R9,NWW1824       W1824,W2534,W3549,W5054,W5564,W65+           
         LR    RE,R4               WW1824                                       
         AR    RE,R5               WW1834=WW1824+WW2534                         
         ST    RE,W1834*4+ITSAS                                                 
         LR    R0,RE               SAVE WW1834 IN R0                            
*                                                                               
         LR    RF,R5               WW2534                                       
         AR    RF,R6               WW2549=WW2534+WW3549                         
         ST    RF,W2549*4+ITSAS                                                 
         AR    RE,R6               WW1849=WW1834+WW3549                         
         ST    RE,W1849*4+ITSAS                                                 
         LR    R1,RE               SAVE WW1849 IN R1                            
*                                                                               
         AR    RF,R7               WW2554=WW2549+WW5054                         
         ST    RF,W2554*4+ITSAS                                                 
         AR    RF,R8               WW2564=WW2554+WW5564                         
         ST    RF,W2564*4+ITSAS                                                 
         AR    RF,R4               WW1864=WW2564+WW1824                         
         AR    RF,R9               WW18+=WW1864+WW65+                           
         ST    RF,W1899*4+ITSAS                                                 
*                                                                               
TTNDEM52 LM    R4,R9,NWM1824       M1824,M2534,M3549,M5054,M5564,M65+           
         LR    RE,R4               WM1824                                       
         AR    RE,R5               WM1834=WM1824+WM2534                         
         ST    RE,M1834*4+ITSAS                                                 
         AR    R0,RE               WV1834=WW1834+WM1834                         
         ST    R0,V1834*4+ITSAS                                                 
*                                                                               
         LR    RF,R5               WM2534                                       
         AR    RF,R6               WM2549=WM1834+WM3549                         
         ST    RF,M2549*4+ITSAS                                                 
         AR    RE,R6               WM1849=WM1834+WM3549                         
         ST    RE,M1849*4+ITSAS                                                 
         AR    R1,RE               WV1849=WW1849+WM1849                         
         ST    R1,V1849*4+ITSAS                                                 
*                                                                               
         AR    RF,R7               WM2554=WM2549+WM5054                         
         ST    RF,M2554*4+ITSAS                                                 
         LR    R0,RF                                                            
         A     R0,W2554*4+ITSAS    WV2554=WM2554+WW2554                         
         ST    R0,V2554*4+ITSAS                                                 
         AR    RF,R8               WM2564=WM2554+WM5564                         
         ST    RF,M2564*4+ITSAS                                                 
         AR    RF,R4               WM1864=WM2564+WM1824                         
         AR    RF,R9               WM18+=WM1864+WM65+                           
         ST    RF,M1899*4+ITSAS                                                 
*                                                                               
TTNDEM54 A     RF,W1899*4+ITSAS    WV18+=WM18+ + WW18+                          
         ST    RF,V1899*4+ITSAS                                                 
         LM    R0,R1,NWV25         V2-5, V6-11                                  
         LM    R4,R6,NWW1217       W1217,W1824,W2534                            
         LM    R7,R9,NWM1217       M1217,M1824,M2534                            
*                                                                               
         AR    R0,R1               WV211=WV25+WV611                             
         ST    R0,V211*4+ITSAS                                                  
         LR    RE,R4                                                            
         AR    RE,R7               WV1217=WW1217+WM1217                         
         ST    RE,V1217*4+ITSAS                                                 
         AR    R0,RE               WV2-17=WV2-11+WV12-17                        
         AR    R0,RF               WV2+=WV2-17+WV18+                            
         ST    R0,V299*4+ITSAS                                                  
         LR    R1,R4                                                            
         AR    R1,R5               WW1224=WW1217+WW1824                         
         ST    R1,W1224*4+ITSAS                                                 
*                                                                               
         LR    RE,R7               WM1217                                       
         AR    RE,R8               WM1224=WMU217+WM1824                         
         AR    RE,R1               WV1224=WM1224+WW1224                         
         ST    RE,V1224*4+ITSAS                                                 
*                                                                               
         AR    R1,R6               WW1234=WW1224+WW2534                         
         ST    R1,W1234*4+ITSAS                                                 
         AR    RE,R6               WV1224+WW2534                                
         AR    RE,R9               +WM2534=WV1234                               
         ST    RE,V1234*4+ITSAS                                                 
* ADDITIONAL OCT/90 DEMOS                                                       
         OC    NUW1820,NUW1820     UNIV WILL BE THERE IF                        
         BZ    TTNDEM55            DATA IS AVAILABLE                            
         L     RE,W1849*4+ITSAS                                                 
         S     RE,NWW1820                                                       
         ST    RE,W2149*4+ITSAS                                                 
         L     RF,M1849*4+ITSAS                                                 
         S     RF,NWM1820                                                       
         ST    RF,M2149*4+ITSAS                                                 
         AR    RE,RF                                                            
         ST    RF,V2149*4+ITSAS                                                 
*                                                                               
* NOW COMPUTE THE PUTS FROM THE DMA TOTAL IMPRESSIONS AND UNIVERSES             
*                                  (ITSAS USED AS A CONVENIENCE)                
TTNDEM55 LA    R0,IUNDEMS          R0=LOOP COUNTER                              
         LA    R1,1000                                                          
         LA    RE,5                                                             
         LA    RF,10                                                            
         LA    R6,ITSAS            R6=A(TSA IMPRESSION)                         
         LA    R7,IUNIVS           R7=A(UNIVERSE)                               
         LA    R8,IPUTS            R8=A(PUT)                                    
*                                                                               
TTNDEM56 L     R5,0(R6)            GET TSA IMPRESSION                           
         CLI   DMAIMP,C'I'                                                      
         BE    TTNDEM57            JUST COMPUTE TOTAL                           
         MR    R4,R1               *1000                                        
         ICM   R9,15,0(R7)         GET UNIVERSE                                 
         BNZ   *+10                                                             
         SR    R5,R5                                                            
         B     TTNDEM57                                                         
*                                                                               
         DR    R4,R9               R5=UNROUNDED PUT                             
         SR    R4,R4                                                            
         CLI   FILTYP,C'P'                                                      
         BE    *+10                                                             
         AR    R5,RE               +5                                           
         DR    R4,RF               /10                                          
         MR    R4,RF               *10                                          
*                                                                               
TTNDEM57 ST    R5,0(R8)                                                         
         LA    R6,4(R6)            NEXT TSA IMPRESSION                          
         LA    R7,4(R7)            NEXT UNIVERSE                                
         LA    R8,4(R8)            NEXT PUT                                     
         BCT   R0,TTNDEM56                                                      
*                                                                               
* ADJUST PMETROA AND PMETROB FROM NSI PRECISION TO IUN PRECISION                
*                                                                               
TTNDEM58 L     R5,NPMETROA                                                      
         SR    R4,R4                                                            
         AH    R5,=H'500'                                                       
         D     R4,=F'1000'                                                      
         MH    R5,=H'10'                                                        
         ST    R5,METROA*4+IPUTS                                                
*                                                                               
         L     R5,NPMETROB                                                      
         SR    R4,R4                                                            
         AH    R5,=H'500'                                                       
         D     R4,=F'1000'                                                      
         MH    R5,=H'10'                                                        
         ST    R5,METROB*4+IPUTS                                                
*                                                                               
* WHEN PUT ELEMENT PRESENT, COMPUTE PHOMES FROM DMA TOT IMP & UNIVERSE          
*                                  (NWHOMES USED AS A CONVENIENCE)              
TTNDEM59 CLI   RTGPUT,C'Y'         TEST IF PUT ELEMENT PRESENT                  
         BNE   TTNDEM60            NO-HAVE CALCULATED PHOMES ALREADY            
         CLI   DMAIMP,C'I'         FORCE TOTALS NOT %AGE                        
         BE    TTNDEM60                                                         
         L     R5,NWHOMES          GET HOMES TSA IMP                            
         M     R4,=F'1000'         *1000 FOR SCALING                            
         D     R4,HOMES*4+IUNIVS   /HOMES UNIVERSE                              
         SR    R4,R4                                                            
         CLI   FILTYP,C'P'                                                      
         BE    *+16                                                             
         AH    R5,=H'5'            ROUND THE VALUE                              
         D     R4,=F'10'                                                        
         MH    R5,=H'10'                                                        
         ST    R5,HOMES*4+IPUTS                                                 
*                                                                               
         L     R5,V211*4+IPUTS     COMPENSATE FOR BUG IN FORMULA                
         SR    R4,R4               PRIOR TO FEB87 BY ROUNDING PV211             
         CLI   FILTYP,C'P'                                                      
         BE    *+16                                                             
         AH    R5,=H'5'                                                         
         D     R4,=F'10'                                                        
         M     R4,=F'10'                                                        
         ST    R5,V211*4+IPUTS                                                  
*                                                                               
         OC    NUW1820,NUW1820                                                  
         BZ    TTNDEM59A                                                        
         L     R4,NWW2124                                                       
         LM    R5,R6,NWW2534                                                    
         AR    R5,R4                                                            
         AR    R5,R6                                                            
         LR    R8,R5               W2149                                        
         M     R4,=F'1000'                                                      
         ICM   R0,15,W2149*4+IUNIVS  R0 = UW2149                                
         DR    R4,R0                                                            
         ST    R5,W2149*4+IPUTS                                                 
*                                                                               
         L     R4,NWM2124                                                       
         LM    R5,R6,NWM2534                                                    
         AR    R5,R4                                                            
         AR    R5,R6                                                            
         LR    R9,R5               M2149                                        
         M     R4,=F'1000'                                                      
         ICM   R0,15,M2149*4+IUNIVS  R0 = UM2149                                
         DR    R4,R0                                                            
         ST    R5,M2149*4+IPUTS                                                 
*                                                                               
         AR    R9,R8                                                            
         M     R8,=F'1000'                                                      
         ICM   R0,15,V2149*4+IUNIVS  R0 = UV2149                                
         DR    R8,R0                                                            
         ST    R9,V2149*4+IPUTS                                                 
*                                                                               
TTNDEM59A OC    V2554*4+IPUTS(4),V2554*4+IPUTS TEST IF PV2554 THERE             
         BNZ   TTNDEM60            YES                                          
*                                                                               
         LM    R4,R6,NWW2534       R4=WW2534,R5=WW3549,R6=WW5054                
         LM    R7,R9,NWM2534       R7=WM2534,R8=WM3549,R9=WM5054                
         AR    R5,R4                                                            
         AR    R5,R6                                                            
         AR    R5,R7                                                            
         AR    R5,R8                                                            
         AR    R5,R9               R5=WV2554                                    
*                                                                               
         M     R4,=F'1000'         SCALE THE DIVIDEND                           
         ICM   R0,15,V2554*4+IUNIVS R0=UV2554                                   
         BNZ   *+14                                                             
         SR    R5,R5                                                            
         ST    R5,V2554*4+IPUTS                                                 
         B     TTNDEM60                                                         
*                                                                               
         DR    R4,R0               WV2554*1000/UV2554                           
         SR    R4,R4                                                            
         CLI   FILTYP,C'P'                                                      
         BE    *+16                                                             
         AH    R5,=H'5'            +5                                           
         D     R4,=F'10'           /10                                          
         M     R4,=F'10'           *10                                          
         ST    R5,V2554*4+IPUTS                                                 
         EJECT                                                                  
* ADJUST UNIVERSES TO IUN PRECISION AFTER ALL CALCULATIONS ARE DONE             
* AND MOVE TO OUTPUT AREA                                                       
*                                                                               
TTNDEM60 LA    R0,IUNDEMS          R0=LOOP COUNTER                              
         LA    R1,10                                                            
         LA    RE,500                                                           
         LA    RF,1000                                                          
         LA    R6,IUNIVS           R6=A(UNIVERSE)                               
*                                                                               
         CLI   DMAIMP,C'I'         FULL PRECISION (UNIVERSE 100)                
         BNE   TTNDEM61                                                         
         LA    R1,1                                                             
         LA    RE,50                                                            
         LA    RF,100                                                           
*                                                                               
TTNDEM61 L     R5,0(R6)            GET UNADJUSTED UNIVERSE                      
         SR    R4,R4               SCALE TO THOUSANDS                           
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         MR    R4,R1               *10                                          
         ST    R5,0(R6)                                                         
         LA    R6,4(R6)                                                         
         BCT   R0,TTNDEM61                                                      
*                                                                               
TTNDEM62 MVC   UNIVS(IUNDEMS*4,R3),IUNIVS MOVE ADJUSTED UNIVS OUT               
         SPACE 2                                                                
* MOVE THE IUN VALUES TO USER WORK AREA                                         
*                                                                               
TTNDEM70 CLI   CALLTYPE,2          TEST PUTS/TOTS ONLY                          
         BE    TTNDEM82                                                         
         MVC   UNIVS(IUNDEMS*4,R3),IUNIVS                                       
         MVC   RATINGS(IUNDEMS*4,R3),IRATINGS                                   
         MVC   IMPS(IUNDEMS*4,R3),IIMPS                                         
*                                                                               
*  COPY DMA TOTS TO TSA TOTALS FOR NSI WIRED/ FUSION AND OVERNIGHTS             
*                                                                               
TTNDEM75 CLI   DBSELMED,C'T'                                                    
         BNE   *+8                                                              
         CLI   DBBTYPE,C'4'                                                     
         BE    *+8                                                              
         CLI   DBBTYPE,C'W'                                                     
         BE    *+8                                                              
         CLI   DBBTYPE,BOOKTYPE_L1                                              
         BE    *+8                                                              
         CLI   DBBTYPE,BOOKTYPE_Y1                                              
         BE    *+8                                                              
         CLI   DBSELMED,C'W'       WEEKLY METER                                 
         BE    *+8                                                              
         CLI   DBSELMED,C'O'                                                    
         BE    TTNDM75K                                                         
*                                                                               
         CLC   BOOK,=X'7307'       EFFECTIVE JUL15                              
         BL    TTNDM75B            SPECIAL VIP METRO AND TRADE BOOKS            
         CLI   BOOKTYPE,C'M'       ALSO SLOT TSA FROM DMA                       
         BE    TTNDM75K                                                         
         CLI   BOOKTYPE,C'T'                                                    
         BE    TTNDM75K                                                         
*                                                                               
TTNDM75B CLI   DBSELSRC,C'F'                                                    
         BNE   TTNDEM77                                                         
TTNDM75K LA    R0,IUNDEMS          R0=LOOP COUNTER                              
         LA    R6,RATINGS(R3)      R6=A(DMA IMPRESSION)                         
         LA    R8,IMPS(R3)        R8=A(TSA IMPRESSION)                          
TTNDEM76 L     R5,0(R6)            GET DMA IMPRESSION                           
         AHI   R5,50               +50                                          
         SR    R4,R4                                                            
         D     R4,=F'100'          /100                                         
         ST    R5,0(R8)                                                         
         LA    R6,4(R6)            NEXT DMA IMPRESSION                          
         LA    R8,4(R8)            NEXT TSA                                     
         BCT   R0,TTNDEM76                                                      
*                                                                               
TTNDEM77 CLI   CALLTYPE,1          TEST RATINGS/IMPS ONLY                       
         BE    TTNDEMX             YES                                          
         MVC   PUTS(IUNDEMS*4,R3),IPUTS                                         
         MVC   TOTS(IUNDEMS*4,R3),ITOTS                                         
*                                                                               
         CLI   DBSELMED,C'T'                                                    
         BNE   *+8                                                              
         CLI   DBBTYPE,C'W'                                                     
         BE    *+8                                                              
         CLI   DBSELMED,C'W'       WEEKLY METER                                 
         BE    *+8                                                              
         CLI   DBSELMED,C'O'                                                    
         BE    *+8                                                              
         CLI   DBSELSRC,C'F'                                                    
         BNE   TTNDEMX                                                          
*                                                                               
         CLI   DBSELMED,C'T'        WIRED CABLE BROADCAST STATIONS              
         BNE   TTNDEM79             ALREADY COME WITH TSA TOTALS                
         CLI   DBBTYPE,C'4'         WIRED ALREADY HAVE TSA TOTALS               
         BE    *+8                                                              
         CLI   DBBTYPE,C'W'                                                     
         BE    TTNDEM81                                                         
         OC    DBSELMK,DBSELMK                                                  
         BNZ   TTNDEM79                                                         
         OC    DBSELALF,DBSELALF                                                
         BZ    TTNDEM81                                                         
*                                                                               
TTNDEM79 LA    R0,IUNDEMS          R0=LOOP COUNTER                              
         LA    R6,PUTS(R3)         R6=A(PUTS)                                   
         LA    R8,TOTS(R3)        R8=A(TOT IMPRESSION)                          
TTNDEM80 L     R5,0(R6)            GET PUT                                      
         AHI   R5,50                                                            
         SR    R4,R4                                                            
         D     R4,=F'100'          /100                                         
         ST    R5,0(R8)                                                         
         LA    R6,4(R6)            NEXT PUT                                     
         LA    R8,4(R8)            NEXT TOT                                     
         BCT   R0,TTNDEM80                                                      
*                                                                               
*                                                                               
TTNDEM81 B     TTNDEMX                                                          
*                                                                               
TTNDEM82 MVC   0(IUNDEMS*4,R3),IPUTS                                            
         MVC   IUNDEMS*4(IUNDEMS*4,R3),ITOTS                                    
*                                                                               
TTNDEMX  XIT1                                                                   
         EJECT                                                                  
* SUB-ROUTINE TO DECIDE IF DMA IMPS AND TOTS SHOULD BE EXPLODED                 
*                                                                               
* ON EXIT, CC=EQ IF DMA VALUES SHOULD BE EXPLODED                               
*          CC=NEQ IF EXPLOSION NOT NEEDED                                       
*                                                                               
TESTGET  CLI   RTGPUT,C'Y'         TEST RATING/PUT ELEMENTS THERE               
         BNE   TESTGETY            NO-SO MUST EXPLODE                           
*                                                                               
         L     R1,APUTEL                                                        
         CLI   1(R1),4                                                          
         BNE   TESTGET4                                                         
         ICM   RF,3,2(R1)                                                       
         SLL   RF,17                                                            
         SRL   RF,17                                                            
         L     R1,DBAREC                                                        
         LA    R1,0(RF,R1)                                                      
*                                                                               
TESTGET4 IC    RF,2(R1)            ISOLATE ENTRY LENGTH                         
         SLL   RF,28                                                            
         SRL   RF,28                                                            
         MH    RF,=Y(DISV2554)     * DISPLACEMENT TO V2554 FIELD                
         LA    RF,3(RF)            ADD 3 TO GET ELEM LEN                        
         CLM   RF,1,1(R1)          TEST ELEM LEN G.T. REAL LENGTH               
         BH    TESTGETY            YES-FIELD MUST BE MISSING                    
*                                                                               
TESTGETN LTR   RB,RB                                                            
         B     TESTGETX                                                         
*                                                                               
TESTGETY CR    RB,RB                                                            
*                                                                               
TESTGETX BR    RE                                                               
         EJECT                                                                  
*********************************************************************           
* SUB-ROUTINE TO EXPLODE DEMO ELEMENT AGAINST LIST TABLE FOR ELEMENT*           
*                                                                   *           
* AT ENTRY, R5=A(DEMO ELEMENT LIST TABLE), R1=A(DEMO ELEMENT)       *           
*                                                                   *           
* REGISTER CONVENTIONS FOR SUB-ROUTINE                              *           
*                                                                   *           
* R0=WORK REGISTER                                                  *           
* R1=PARM VALUE-THEN WORK REGISTER                                  *           
* R2=A(DBLOCK)                                                      *           
* R3=A(OUTPUT AREA)                                                 *           
* R4=MULTIPLICATION FACTOR FOR EXTRACTED VALUE                      *           
* R5=A(DEMO LIST ENTRIES)                                           *           
* R6=DEMO ELEMENT POINTER                                           *           
* R7=DEMO VALUE FIELD POINTER - BXLE INDEX REGISTER                 *           
* R8=DEMO VALUE FIELD LENGTH  - BXLE INCREMENT REGISTER             *           
* R9=A(END OF DEMO ELEMENT)   - BXLE LIMIT REGISTER                 *           
* RE=WORK REGISTER FOR ARITHMETIC                                   *           
* RF=DEMO VALUE REGISTER                                            *           
*                                                                   *           
*********************************************************************           
*                                                                               
EXPEL    NTR1                                                                   
         LR    R6,R1               TRANSFER DEMO ELEMENT POINTER TO R6          
         ZIC   R9,1(R6)            GET ELEMENT LENGTH                           
         LA    R9,0(R6,R9)         POINT PAST ELEMENT                           
         BCTR  R9,0                BACK UP TO LAST BYTE-BXLE LIMIT              
         TM    0(R6),X'01'         TEST FOR ODD ELEMENT CODE                    
         BO    EXPEL1              YES                                          
*                                                                               
         LA    R8,1                EVEN CODE MEANS L'DEMO ENTRY=1               
         LA    R7,2(R6)            AND DO NOT HAVE CONTROL BYTE                 
         LA    R4,10               ALL VALUES MUST BE MULTPLD BY 10             
         B     EXPEL2                                                           
*                                                                               
EXPEL1   IC    R8,2(R6)                                                         
         SLL   R8,28                                                            
         SRL   R8,28               ISOLATE FIELD LENGTH-BXLE INCREMENT          
         LA    R7,3(R6)            R7=INDEX REGISTER FOR BXLE                   
         LA    R4,1                SET MULTIPLIER FOR ALL VALUES                
         TM    2(R6),X'40'         TEST FOR X 10 MULTIPLICATION                 
         BO    *+8                 NO                                           
         LA    R4,10               YES                                          
*                                                                               
EXPEL2   CLI   TTNDISPS,EOT        TEST END OF DEMO LIST FOR ELEM               
         BE    EXPELX              YES                                          
         MVC   DUB(1),TTNTYPE      GET DEMO TYPE                                
         CLI   DUB,X'FF'           TEST IF FIELD NOT RELEVANT                   
         BE    EXPEL8              YES-NEXT FIELD                               
         NC    DUB(1),ELEMMASK     TEST IF VALUE NEEDED                         
         BZ    EXPEL8              NO                                           
         SR    RF,RF               RF=VALUE                                     
         TM    0(R6),X'01'         TEST EVEN ELEMENT CODE                       
         BZ    EXPEL3              YES-VALUE IS ALWAYS POSITIVE                 
         TM    2(R6),X'20'         TEST NEGATIVE VALUES PRESENT                 
         BZ    *+14                                                             
         TM    0(R7),X'80'         TEST SIGN BIT ON IN FIELD                    
         BZ    *+6                                                              
         LCR   RF,RF               SET VALUE TO ALL EFFS                        
*                                                                               
EXPEL3   IC    R1,ICMMASK(R8)      USE FIELD LENGTH AS TABLE INDEX              
         EX    R1,*+8                                                           
         B     *+8                                                              
         ICM   RF,0,0(R7)          GET VALUE INTO RF                            
         MR    RE,R4               MULTIPLY BY EXPANSION FACTOR                 
*                                                                               
EXPEL6   LH    R1,TTNDISPS         DISP TO WORKING STORAGE SECTION              
         LA    R1,WORKD(R1)        R1=A(VALUE POSITION)                         
         ST    RF,0(R1)            REPLACE WORK AREA VALUE                      
*                                                                               
EXPEL8   LA    R5,TTNLISTL(R5)     NEXT DEMO LIST ENTRY                         
         BXLE  R7,R8,EXPEL2                                                     
*                                                                               
EXPELX   XIT1                                                                   
         EJECT                                                                  
* SRC TIME PERIOD PROCESSING ROUTINE                                            
* EXTRACT SELECTED IUN DEMOS BASED ON ELEMENT TABLES                            
*                                                                               
TTSDEM   SR    R0,R0                                                            
*                                                                               
TTSDEMA  CLI   0(R6),X'20'         TEST FOR CURRENT QUARTER HOUR                
         BE    TTSDEM1                                                          
         BH    TTSDEM1E                                                         
         IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO NEXT DEMO ELEMENT                    
         B     TTSDEMA                                                          
*                                                                               
TTSDEM1  IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO FIRST DEMO ELEMENT                   
         CLI   0(R6),0             TEST FOR EOR                                 
         BE    TTSDEMX                                                          
         CLI   0(R6),X'20'         TEST FOR NEXT QUARTER HOUR                   
         BE    TTSDEMX                                                          
TTSDEM1E CLI   0(R6),X'30'         TEST START OF DEMO ELEMENTS FOR              
         BL    TTSDEM1             THIS QUARTER HOUR                            
*                                                                               
TTSDEM2  CLI   0(R6),0             TEST FOR EOR                                 
         BE    TTSDEM10                                                         
         CLI   ELEMNUM,EOT         TEST END OF ELEMENT TABLE                    
         BE    TTSDEM10                                                         
         CLC   0(1,R6),ELEMNUM     TEST ELEMENT CODE MATCHES TABLE              
         BNE   TTSDEM9             NO BUMP TO NEXT TABLE ENTRY                  
*                                                                               
TTSDEM3  MVC   DEMOTYPE,ELEMTYPE   EXTRACT ELEMENT DEMO TYPE                    
         NC    DEMOTYPE,ELEMMASK   'AND' DEMO TYPE MASK INTO IT                 
         BZ    TTSDEM8             NOT A DEMO TYPE WE WANT                      
         SR    R5,R5                                                            
         ICM   R5,7,ELEMDISP       GET DISP TO ELEMENT DEMO LIST                
         LA    R5,BASE(R5)         RELOCATE TABLE ADDRESS                       
*                                                                               
TTSDEM4  MVC   TABHEAD,0(R5)       SAVE TABLE HEADER                            
         LA    R5,HEADLEN(R5)      AND BUMP R5 PAST IT                          
         USING TTSLISTD,R5                                                      
         LR    R1,R6               R1=A(DEMO ELEMENT)                           
         TM    2(R6),X'80'         TEST IF DUPLICATE DEMO ELEMENT               
         BZ    TTSDEM6             NO                                           
         ICM   RE,3,2(R6)          YES                                          
         SLL   RE,17               SHIFT OFF X'80' BIT                          
         SRL   RE,17               RE=DISP INTO DEMO RECORD                     
         L     R1,DBAREC                                                        
         LA    R1,0(RE,R1)                                                      
*                                                                               
TTSDEM6  BAS   RE,SPRCEL           PROCESS DEMO ELEMENT                         
*                                                                               
TTSDEM8  IC    R0,1(R6)                                                         
         AR    R6,R0                                                            
*                                                                               
TTSDEM9  LA    R4,ELEMTABL(R4)     NEXT ELEMENT TABLE ENTRY                     
         B     TTSDEM2                                                          
         EJECT                                                                  
* CALCULATE IUN BASIC CELLS MISSING FROM TIME PERIOD RECORD                     
*                                                                               
TTSDEM10 LM    R4,R9,SUW1824       W1824,W2534,W3549,W5054,W5564,W65+           
         LR    RE,R4               UW1824                                       
         AR    RE,R5               UW1834=UW1824+UW2534                         
         ST    RE,W1834*4+IUNIVS                                                
         LR    R0,RE               SAVE UW1834 IN R0                            
*                                                                               
         LR    RF,R5               UW2534                                       
         AR    RF,R6               UW2549=UW2534+UW3549                         
         ST    RF,W2549*4+IUNIVS                                                
         AR    RE,R6               UW1849=UW1834+UW3549                         
         ST    RE,W1849*4+IUNIVS                                                
         LR    R1,RE               SAVE UW1849 IN R1                            
*                                                                               
         AR    RF,R7               UW2554=UW2549+UW5054                         
         ST    RF,W2554*4+IUNIVS                                                
         AR    RF,R8               UW2564=UW2554+UW5564                         
         ST    RF,W2564*4+IUNIVS                                                
         AR    RF,R4               UW1864=UW2564+UW1824                         
         AR    RF,R9               UW18+=UW1864+UW65+                           
         ST    RF,W1899*4+IUNIVS                                                
*                                                                               
         LM    R4,R9,SUM1824       M1824,M2534,M3549,M5054,M5564,M65+           
         LR    RE,R4               UM1824                                       
         AR    RE,R5               UM1834=UM1824+UM2534                         
         ST    RE,M1834*4+IUNIVS                                                
         AR    R0,RE               UV1834=UW1834+UM1834                         
         ST    R0,V1834*4+IUNIVS                                                
*                                                                               
         LR    RF,R5               UM2534                                       
         AR    RF,R6               UM2549=UM1834+UM3549                         
         ST    RF,M2549*4+IUNIVS                                                
         AR    RE,R6               UM1849=UM1834+UM3549                         
         ST    RE,M1849*4+IUNIVS                                                
         AR    R1,RE               UV1849=UW1849+UM1849                         
         ST    R1,V1849*4+IUNIVS                                                
*                                                                               
         AR    RF,R7               UM2554=UM2549+UM5054                         
         ST    RF,M2554*4+IUNIVS                                                
         LR    R0,RF                                                            
         A     R0,W2554*4+IUNIVS UV2554=UM2554+UW2554                           
         ST    R0,V2554*4+IUNIVS                                                
         AR    RF,R8               UM2564=UM2554+UM5564                         
         ST    RF,M2564*4+IUNIVS                                                
         AR    RF,R4               UM1864=UM2564+UM1824                         
         AR    RF,R9               UM18+=UM1864+UM65+                           
         ST    RF,M1899*4+IUNIVS                                                
*                                                                               
         A     RF,W1899*4+IUNIVS UV18+=UM18+ + UW18+                            
         ST    RF,V1899*4+IUNIVS                                                
*                                                                               
         L     R0,V211*4+IUNIVS V2-11                                           
         LM    R4,R5,SUW1824       W1824,W2534                                  
         LM    R7,R8,SUM1824       M1824,M2534                                  
*                                                                               
         L     RE,V1217*4+IUNIVS                                                
         AR    R0,RE               UV2-17 = UV2-11 + UV12-17                    
         AR    R0,RF               UV2+ = UV2-17 + UV18+                        
         ST    R0,V299*4+IUNIVS                                                 
*                                                                               
         AR    RE,R4               X = UV12-17 + UW18-24                        
         AR    RE,R7               UV12-24 = X + UM18-24                        
         ST    RE,V1224*4+IUNIVS                                                
*                                                                               
         AR    RE,R5               X = UV12-24 + UW25-34                        
         AR    RE,R8               UV1234 = X + UM25-34                         
         ST    RE,V1234*4+IUNIVS                                                
*                                  DO 2149 CALCS                                
         L     RE,SUM1824                                                       
         S     RE,SUM2124                                                       
         LNR   RE,RE                                                            
         A     RE,M1849*4+IUNIVS                                                
         ST    RE,M2149*4+IUNIVS                                                
         LR    RF,RE               SAVE UM2149                                  
*                                                                               
         L     RE,SUW1824                                                       
         S     RE,SUW2124                                                       
         LNR   RE,RE                                                            
         A     RE,W1849*4+IUNIVS                                                
         ST    RE,W2149*4+IUNIVS                                                
*                                                                               
         AR    RE,RF                                                            
         ST    RE,V2149*4+IUNIVS                                                
*                                  DO 1224 CALCS                                
         L     RE,SUW1217                                                       
         A     RE,SUW1824                                                       
         ST    RE,W1224*4+IUNIVS                                                
*                                                                               
         A     RE,SUW2534                                                       
         ST    RE,W1234*4+IUNIVS                                                
*                                                                               
         EJECT                                                                  
*                                                                               
*                                                                               
TTSDEM16 TM    ELEMMASK,UNIVERSE                                                
         BZ    TTSDEM17                                                         
*                                                                               
*                                                                               
TTSDEM17 TM    ELEMMASK,UNIVERSE+RATING+PUT                                     
         BZ    TTSDEM18                                                         
*                                                                               
*                                                                               
TTSDEM18 TM    ELEMMASK,IMP                                                     
         BZ    TTSDEM20                                                         
         LH    R4,=H'1'                                                         
*                                                                               
         L     RF,SIM1899                                                       
         A     RF,SIW1899          V18+ = M18+ + W18+                           
         MR    RE,R4                                                            
         ST    RF,V1899*4+IIMPS                                                 
*                                                                               
         L     RF,SIV1217                                                       
         LR    R1,RF                                                            
         A     RF,SIV1834          V12-34 = V12-17 + V18-34                     
         MR    RE,R4                                                            
         ST    RF,V1234*4+IIMPS                                                 
*                                                                               
         L     RF,SIW1217                                                       
         A     RF,SIW1849          W12-24 = W12-17 + W18-24                     
         S     RF,SIW2549                                                       
         LTR   RF,RF               KILL THE NEGATIVES                           
         BNM   *+6                                                              
         SR    RF,RF                                                            
         MR    RE,R4                                                            
         ST    RF,W1224*4+IIMPS                                                 
*                                                                               
         L     RF,SIW1217                                                       
         A     RF,W1834*4+IIMPS    W12-34 = W12-17 + W18-34                     
         MR    RE,R4                                                            
         ST    RF,W1234*4+IIMPS                                                 
*                                                                               
*                                                                               
         L     RF,SIW2554                                                       
         A     RF,SIM2554          V25-54 = W25-54 + M25-54                     
         MR    RE,R4                                                            
         ST    RF,V2554*4+IIMPS                                                 
*                                                                               
         OC    SUM2124,SUM2124     DATA FROM TAPE                               
         BNZ   TTSDEM20                                                         
         L     RE,SIW1849                                                       
         S     RE,SIW2549          W18-24 = W18-49 - W25-49                     
*                                                                               
         L     RF,SIM1849                                                       
         S     RF,SIM2549          M18-24 = M18-49 - M25-49                     
         AR    R1,RE               V1224 = V12-17 + W18-24 + M18-24             
         AR    RF,R1                                                            
         MR    RE,R4                                                            
         ST    RF,V1224*4+IIMPS                                                 
*                                                                               
TTSDEM20 TM    ELEMMASK,TOT                                                     
         BZ    TTSDEM22                                                         
*                                                                               
         LH    R4,=H'1'                                                         
         L     RF,SQM1899                                                       
         A     RF,SQW1899          V18+ = M18+ + W18+                           
         MR    RE,R4                                                            
         ST    RF,V1899*4+ITOTS                                                 
*                                                                               
         L     RF,SQV1217                                                       
         LR    R1,RF                                                            
         A     RF,SQV1834          V12-34 = V12-17 + V18-34                     
         MR    RE,R4                                                            
         ST    RF,V1234*4+ITOTS                                                 
*                                                                               
         L     RF,SQW1217                                                       
         A     RF,SQW1849          W12-24 = W12-17 + W18-24                     
         S     RF,SQW2549                                                       
         LTR   RF,RF               KILL THE NEGATIVES                           
         BNM   *+6                                                              
         SR    RF,RF                                                            
         MR    RE,R4                                                            
         ST    RF,W1224*4+ITOTS                                                 
*                                                                               
         L     RF,SQW1217                                                       
         A     RF,W1834*4+ITOTS    W12-34 = W12-17 + W18-34                     
         MR    RE,R4                                                            
         ST    RF,W1234*4+ITOTS                                                 
*                                                                               
         L     RF,SQW2554                                                       
         A     RF,SQM2554          V25-54 = W25-54 + M25-54                     
         MR    RE,R4                                                            
         ST    RF,V2554*4+ITOTS                                                 
*                                                                               
         OC    SUM2124,SUM2124     DATA FROM TAPE                               
         BNZ   TTSDEM22                                                         
         L     RE,SQW1849                                                       
         S     RE,SQW2549          W18-24 = W18-49 - W25-49                     
*                                                                               
         L     RF,SQM1849                                                       
         S     RF,SQM2549          M18-24 = M18-49 - M25-49                     
         AR    R1,RE               V1224 = V12-17 + W18-24 + M18-24             
         AR    RF,R1                                                            
         MR    RE,R4                                                            
         ST    RF,V1224*4+ITOTS                                                 
*                                                                               
TTSDEM22 TM    ELEMMASK,RATING                                                  
         BZ    TTSDEM24                                                         
*                                                                               
         LH    R4,=H'1'                                                         
         L     RF,SRM1899                                                       
         M     RE,M1899*4+IUNIVS                                                
         LR    R0,RF                                                            
         L     RF,SRW1899                                                       
         M     RE,W1899*4+IUNIVS                                                
         AR    RF,R0               V18+ = M18+ + W18+                           
         SR    RE,RE                                                            
         D     RE,V1899*4+IUNIVS                                                
         MR    RE,R4                                                            
         ST    RF,V1899*4+IRATINGS                                              
*                                                                               
         L     RF,SRV1217          V12-34 = V12-17 + V18-34                     
         M     RE,V1217*4+IUNIVS                                                
         LR    R1,RF                                                            
         L     RF,SRV1834                                                       
         M     RE,V1834*4+IUNIVS                                                
         AR    RF,R1                                                            
         SR    RE,RE                                                            
         D     RE,V1234*4+IUNIVS                                                
         MR    RE,R4                                                            
         ST    RF,V1234*4+IRATINGS                                              
*                                                                               
         L     RF,SRW2554          V25-54 = W25-54 + M25-54                     
         M     RE,W2554*4+IUNIVS                                                
         LR    R0,RF                                                            
         L     RF,SRM2554                                                       
         M     RE,M2554*4+IUNIVS                                                
         AR    RF,R0                                                            
         SR    RE,RE                                                            
         D     RE,V2554*4+IUNIVS                                                
         MR    RE,R4                                                            
         ST    RF,V2554*4+IRATINGS                                              
*                                                                               
         OC    SUM2124,SUM2124     DATA FROM TAPE                               
         BNZ   TTSDEM23                                                         
         L     RF,SRW1849          W18-24 = W18-49 - M25-49                     
         M     RE,W1849*4+IUNIVS                                                
         LR    R0,RF                                                            
         L     RF,SRW2549                                                       
         M     RE,W2549*4+IUNIVS                                                
         SR    R0,RF                                                            
         LR    R5,R0                                                            
*                                                                               
         L     RF,SRM1849          M18-24 = M18-49 - M25-49                     
         M     RE,M1849*4+IUNIVS                                                
         LR    R0,RF                                                            
         L     RF,SRM2549                                                       
         M     RE,M2549*4+IUNIVS                                                
         SR    R0,RF                                                            
*                                                                               
         AR    R1,R5               V1224 = V12-17 + W18-24 + M18-24             
         AR    R1,R0                                                            
         BP    *+6                                                              
         SR    R1,R1                                                            
         SR    R0,R0                                                            
         D     R0,V1224*4+IUNIVS                                                
         MR    R0,R4                                                            
         ST    R1,V1224*4+IRATINGS                                              
         B     TTSDEM24                                                         
*                                                                               
TTSDEM23 L     R1,SIW1217          W1224                                        
         MH    R1,=H'1000'                                                      
         L     RF,SRW1849          W18-24 = W18-49 - M25-49                     
         M     RE,W1849*4+IUNIVS   USE RATINGS HERE TO KEEP EVERYTHING          
         LR    R0,RF               IN SYNC                                      
         L     RF,SRW2549                                                       
         M     RE,W2549*4+IUNIVS                                                
         SR    R0,RF                                                            
         LTR   R0,R0                                                            
         BNM   *+6                                                              
         SR    R0,R0                                                            
         AR    R1,R0                                                            
         AR    R1,R1                                                            
         SR    R0,R0                                                            
         D     R0,W1224*4+IUNIVS                                                
         AH    R1,=H'1'                                                         
         SRA   R1,1                                                             
         MR    R0,R4                                                            
         LTR   R1,R1               KILL THE NEGATIVES                           
         BNM   *+6                                                              
         SR    R1,R1                                                            
         ST    R1,W1224*4+IRATINGS                                              
*                                                                               
         L     R1,SIW1217                                                       
         A     R1,SIW1834                                                       
         MH    R1,=H'2000'                                                      
         SR    R0,R0                                                            
         D     R0,W1234*4+IUNIVS                                                
         AH    R1,=H'1'                                                         
         SRA   R1,1                                                             
         MR    R0,R4                                                            
         ST    R1,W1234*4+IRATINGS                                              
*                                                                               
*                                                                               
TTSDEM24 TM    ELEMMASK,PUT                                                     
         BZ    TTSDEM26                                                         
*                                                                               
         LH    R4,=H'1'                                                         
         L     RF,SPM1899                                                       
         M     RE,M1899*4+IUNIVS                                                
         LR    R0,RF                                                            
         L     RF,SPW1899                                                       
         M     RE,W1899*4+IUNIVS                                                
         AR    RF,R0               V18+ = M18+ + W18+                           
         SR    RE,RE                                                            
         D     RE,V1899*4+IUNIVS                                                
         MR    RE,R4                                                            
         ST    RF,V1899*4+IPUTS                                                 
*                                                                               
         L     RF,SPV1217          V12-34 = V12-17 + V18-34                     
         M     RE,V1217*4+IUNIVS                                                
         LR    R1,RF                                                            
         L     RF,SPV1834                                                       
         M     RE,V1834*4+IUNIVS                                                
         AR    RF,R1                                                            
         SR    RE,RE                                                            
         D     RE,V1234*4+IUNIVS                                                
         MR    RE,R4                                                            
         ST    RF,V1234*4+IPUTS                                                 
*                                                                               
         L     RF,SPW2554          V25-54 = W25-54 + M25-54                     
         M     RE,W2554*4+IUNIVS                                                
         LR    R0,RF                                                            
         L     RF,SPM2554                                                       
         M     RE,M2554*4+IUNIVS                                                
         AR    RF,R0                                                            
         SR    RE,RE                                                            
         D     RE,V2554*4+IUNIVS                                                
         MR    RE,R4                                                            
         ST    RF,V2554*4+IPUTS                                                 
*                                                                               
         OC    SUM2124,SUM2124     DATA FROM TAPE                               
         BNZ   TTSDEM25                                                         
         L     RF,SPW1849          W18-24 = W18-49 - M25-49                     
         M     RE,W1849*4+IUNIVS                                                
         LR    R0,RF                                                            
         L     RF,SPW2549                                                       
         M     RE,W2549*4+IUNIVS                                                
         SR    R0,RF                                                            
         LR    R5,R0                                                            
*                                                                               
         L     RF,SPM1849          M18-24 = M18-49 - M25-49                     
         M     RE,M1849*4+IUNIVS                                                
         LR    R0,RF                                                            
         L     RF,SPM2549                                                       
         M     RE,M2549*4+IUNIVS                                                
         SR    R0,RF                                                            
*                                                                               
         AR    R1,R5               V1224 = V12-17 + W18-24 + M18-24             
         AR    R1,R0                                                            
         BP    *+6                                                              
         SR    R1,R1                                                            
         SR    R0,R0                                                            
         D     R0,V1224*4+IUNIVS                                                
         MR    R0,R4                                                            
         ST    R1,V1224*4+IPUTS                                                 
         B     TTSDEM26                                                         
*                                                                               
TTSDEM25 L     R1,SQW1217          W1224                                        
         MH    R1,=H'1000'                                                      
         L     RF,SPW1849          W18-24 = W18-49 - M25-49                     
         M     RE,W1849*4+IUNIVS   USE PUTS TO KEEP EVERYTHING                  
         LR    R0,RF               IN SYNC                                      
         L     RF,SPW2549                                                       
         M     RE,W2549*4+IUNIVS                                                
         SR    R0,RF                                                            
         LTR   R0,R0                                                            
         BNM   *+6                                                              
         SR    R0,R0                                                            
         AR    R1,R0                                                            
         AR    R1,R1                                                            
         SR    R0,R0                                                            
         D     R0,W1224*4+IUNIVS                                                
         AH    R1,=H'1'                                                         
         SRA   R1,1                                                             
         MR    R0,R4                                                            
         LTR   R1,R1               KILL THE NEGATIVES                           
         BNM   *+6                                                              
         SR    R1,R1                                                            
         ST    R1,W1224*4+IPUTS                                                 
*                                                                               
         L     R1,SQW1217                                                       
         A     R1,SQW1834                                                       
         MH    R1,=H'2000'                                                      
         SR    R0,R0                                                            
         D     R0,W1234*4+IUNIVS                                                
         AH    R1,=H'1'                                                         
         SRA   R1,1                                                             
         MR    R0,R4                                                            
         ST    R1,W1234*4+IPUTS                                                 
*                                                                               
*                                                                               
TTSDEM26 DS    0C                                                               
*                                                                               
* CONVERT PERCENTS TO IMPS IF MISMATCH ON FILE PRECISIONS                       
         CLI   DMAIMP,C'I'                                                      
         BNE   TTSDEM30                                                         
         LA    R8,IUNIVS           SET UP UNIVERSES                             
         LA    RE,IRATINGS         CONVERT THE RATINGS                          
         LA    R9,IUNDEMS                                                       
         LA    R7,0                                                             
RTOIS1   SR    R0,R0                                                            
         L     R1,0(R7,RE)                                                      
         L     R0,0(R7,R8)                                                      
         MR    R0,R0                                                            
         SR    R0,R0                                                            
         A     R1,=F'5'                                                         
         D     R0,=F'10'                                                        
         ST    R1,0(R7,RE)                                                      
         LA    R7,4(R7)                                                         
         BCT   R9,RTOIS1                                                        
*                                                                               
         LA    RE,IPUTS            CONVERT THE PUTS                             
         LA    R9,IUNDEMS                                                       
         LA    R7,0                                                             
RTOIS2   SR    R0,R0                                                            
         L     R1,0(R7,RE)                                                      
         L     R0,0(R7,R8)                                                      
         MR    R0,R0                                                            
         SR    R0,R0                                                            
         A     R1,=F'5'                                                         
         D     R0,=F'10'                                                        
         ST    R1,0(R7,RE)                                                      
         LA    R7,4(R7)                                                         
         BCT   R9,RTOIS2                                                        
*                                                                               
* MOVE OUT IUN VALUES INTO WORK AREA                                            
*                                                                               
*                                                                               
TTSDEM30 CLI   CALLTYPE,2          TEST PUTS/TOTS ONLY                          
         BE    TTSDEM32                                                         
         MVC   UNIVS(IUNDEMS*4,R3),IUNIVS                                       
         MVC   RATINGS(IUNDEMS*4,R3),IRATINGS                                   
         MVC   IMPS(IUNDEMS*4,R3),IIMPS                                         
         CLI   CALLTYPE,1          TEST RATINGS/IMPS ONLY                       
         BE    TTSDEMX             YES                                          
         MVC   PUTS(IUNDEMS*4,R3),IPUTS                                         
         MVC   TOTS(IUNDEMS*4,R3),ITOTS                                         
         B     TTSDEMX                                                          
*                                                                               
TTSDEM32 MVC   0(IUNDEMS*4,R3),IPUTS                                            
         MVC   IUNDEMS*4(IUNDEMS*4,R3),ITOTS                                    
*                                                                               
TTSDEMX  XIT1                                                                   
         EJECT                                                                  
*********************************************************************           
* SUB-ROUTINE TO PROCESS DEMO ELEMENT AGAINST LIST TABLE FOR ELEMENT*           
*                                                                   *           
* AT ENTRY, R5=A(DEMO ELEMENT LIST TABLE), R1=A(DEMO ELEMENT)       *           
*                                                                   *           
* REGISTER CONVENTIONS FOR SUB-ROUTINE                              *           
*                                                                   *           
* R0=WORK REGISTER                                                  *           
* R1=PARM VALUE-THEN WORK REGISTER                                  *           
* R2=A(DBLOCK)                                                      *           
* R3=A(OUTPUT AREA)                                                 *           
* R4=WEIGHTING FACTOR                                               *           
* R5=A(DEMO LIST ENTRIES)                                           *           
* R6=DEMO ELEMENT POINTER                                           *           
* R7=DEMO VALUE FIELD POINTER - BXLE INDEX REGISTER                 *           
* R8=DEMO VALUE FIELD LENGTH  - BXLE INCREMENT REGISTER             *           
* R9=A(END OF DEMO ELEMENT)   - BXLE LIMIT REGISTER                 *           
* RE=WORK REGISTER FOR ARITHMETIC                                   *           
* RF=DEMO VALUE REGISTER                                            *           
*                                                                   *           
*********************************************************************           
*                                                                               
SPRCEL   NTR1                                                                   
         LR    R6,R1               TRANSFER DEMO ELEMENT POINTER TO R6          
         L     R4,ADJOP            R4=WEIGHTING FACTOR                          
         ZIC   R9,1(R6)            GET ELEMENT LENGTH                           
         LA    R9,0(R6,R9)         POINT PAST ELEMENT                           
         BCTR  R9,0                BACK UP TO LAST BYTE-BXLE LIMIT              
         TM    0(R6),X'01'         TEST FOR ODD ELEMENT CODE                    
         BO    SPRCEL1             YES                                          
*                                                                               
         LA    R8,1                EVEN CODE MEANS L'DEMO ENTRY=1               
         LA    R7,2(R6)            AND DO NOT HAVE CONTROL BYTE                 
         MVI   EXPAND+3,10         ALL VALUES MUST BE MULTPLD BY 10             
         B     SPRCEL2                                                          
*                                                                               
SPRCEL1  IC    R8,2(R6)                                                         
         SLL   R8,28                                                            
         SRL   R8,28               ISOLATE FIELD LENGTH-BXLE INCREMENT          
         LA    R7,3(R6)            R7=INDEX REGISTER FOR BXLE                   
         MVI   EXPAND+3,1          SET MULTIPLIER FOR ALL VALUES                
         TM    2(R6),X'40'         TEST FOR X 10 MULTIPLICATION                 
         BO    *+8                 NO                                           
         MVI   EXPAND+3,10         YES                                          
*                                                                               
SPRCEL2  CLI   TTSDISPS,EOT        TEST END OF DEMO LIST FOR ELEM               
         BE    SPRCELX             YES                                          
         CLI   TTSDISPV,X'FF'      TEST IF FIELD NOT RELEVANT                   
         BE    SPRCEL12            YES-NEXT FIELD                               
         SR    RF,RF               RF=VALUE                                     
         TM    0(R6),X'01'         TEST EVEN ELEMENT CODE                       
         BZ    SPRCEL3             YES-VALUE IS ALWAYS POSITIVE                 
         TM    2(R6),X'20'         TEST NEGATIVE VALUES PRESENT                 
         BZ    *+14                                                             
         TM    0(R7),X'80'         TEST SIGN BIT ON IN FIELD                    
         BZ    *+6                                                              
         LCR   RF,RF               SET VALUE TO ALL EFFS                        
*                                                                               
SPRCEL3  IC    R1,ICMMASK(R8)      USE FIELD LENGTH AS TABLE INDEX              
         EX    R1,*+8                                                           
         B     *+8                                                              
         ICM   RF,0,0(R7)          GET VALUE INTO RF                            
         M     RE,EXPAND                                                        
*                                                                               
SPRCEL4  CLI   ADJTYPE,DIV         TEST TO DIVIDE FOR PRECISION ADJ             
         BE    SPRCEL5             YES                                          
         MR    RE,R4               ELSE MULTIPLY BY WEIGHTING AND               
         B     SPRCEL6             SCALING OPERAND IF PRESENT                   
*                                                                               
SPRCEL5  SLDA  RE,1                X 2                                          
         DR    RE,R4               DIVIDE BY ADJUSTMENT OPERAND                 
         LTR   RF,RF                                                            
         BM    *+8                                                              
         AH    RF,=H'1'                                                         
         SRA   RF,1                                                             
*                                                                               
SPRCEL6  LA    R1,IUNVALS          R1=A(IUN VALUE AREA)                         
         AH    R1,TTSDISPS         DISP TO WORKING STORAGE SECTION              
         ZIC   R0,TTSDISPV         GET DISP IN FULLWORDS                        
         SLL   R0,2                X 4                                          
         AR    R1,R0               R1=A(VALUE POSITION)                         
*                                                                               
SPRCEL8  CLI   DEMOTYPE,UNIVERSE   TEST FOR UNIVERSES                           
         BNE   SPRCEL9             NO                                           
*                                                                               
         LH    RE,TTSSVDSP         GET DISP INTO WORK AREA                      
         LTR   RE,RE               TEST IF SAVING VALUE                         
         BZ    SPRCEL10            NO                                           
         LA    RE,WORKD(RE)                                                     
         ST    RF,0(RE)            SAVE UNIVERSE VALUE AND ONTO NEXT            
         B     SPRCEL10                                                         
*                                                                               
SPRCEL9  LH    RE,TTSSVDSP         GET DISP INTO WORKING STORAGE                
         LTR   RE,RE               TEST IF SAVING VALUE                         
         BZ    *+12                NO                                           
         LA    RE,WORKD(RE)        RE=A(SAVE POSITION)                          
         ST    RF,0(RE)                                                         
         CLI   TTSDISPV,X'FE'      ONLY SAVE IN WORKING STORAGE                 
         BE    SPRCEL12                                                         
*                                                                               
SPRCEL10 ST    RF,0(R1)            REPLACE WORK AREA VALUE                      
*                                                                               
SPRCEL12 LA    R5,TTSLISTL(R5)     NEXT DEMO LIST ENTRY                         
         BXLE  R7,R8,SPRCEL2                                                    
*                                                                               
SPRCELX  XIT1                                                                   
         EJECT                                                                  
* IUN PROCESSING ROUTINE                                                        
* EXTRACT SELECTED IUN DEMOS BASED ON ELEMENT TABLES                            
*                                                                               
IUNDEM   SR    R0,R0                                                            
         B     *+10                LOOK AT FIRST ELEMENT                        
IUNDEM1  IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO NEXT ELEMENT                         
         CLI   0(R6),X'00'         TEST FOR EOR                                 
         BE    IUNDEMX                                                          
*                                                                               
IUNDEM2  CLI   0(R6),X'00'         TEST FOR EOR                                 
         BE    IUNDEM20                                                         
         CLI   ELEMNUM,EOT         TEST END OF ELEMENT TABLE                    
         BE    IUNDEM20                                                         
         CLC   ELEMNUM,0(R6)       TEST ELEMENT CODE MATCHES TABLE              
         BH    IUNDEM1             NO BUMP TO NEXT ELEMENT                      
         BL    IUNDEM11            NO BUMP TO NEXT TABLE ENTRY                  
*                                                                               
IUNDEM3  SR    RF,RF                                                            
         ICM   RF,7,ELEMDISP       GET DISP TO ELEMENT DEMO LIST                
         LA    R5,IUNVALS(RF)      RELOCATE TABLE ADDRESS                       
*                                                                               
         ZIC   R9,1(R6)            GET ELEMENT LENGTH                           
         LA    R9,0(R6,R9)         POINT PAST ELEMENT                           
         BCTR  R9,0                BACK UP TO LAST BYTE-BXLE LIMIT              
         TM    0(R6),X'01'         TEST FOR ODD ELEMENT CODE                    
         BO    IUNDEM4             YES                                          
*                                                                               
         LA    R8,1                EVEN CODE MEANS L'DEMO ENTRY=1               
         LA    R7,2(R6)            AND DO NOT HAVE CONTROL BYTE                 
         B     IUNDEM5             ALL VALUES MUST BE MULTPLD BY 10             
*                                                                               
IUNDEM4  IC    R8,2(R6)                                                         
         SLL   R8,28                                                            
         SRL   R8,28               ISOLATE FIELD LENGTH-BXLE INCREMENT          
         LA    R7,3(R6)            R7=INDEX REGISTER FOR BXLE                   
         MVI   EXPAND+3,1          SET MULTIPLIER FOR ALL VALUES                
         TM    2(R6),X'40'         TEST FOR X 10 MULTIPLICATION                 
         BO    IUNDEM8             NO                                           
IUNDEM5  MVI   EXPAND+3,10         YES                                          
*                                                                               
         EJECT                                                                  
IUNDEM8  SR    RF,RF               RF=VALUE                                     
         TM    0(R6),X'01'         TEST EVEN ELEMENT CODE                       
         BZ    IUNDEM10            YES-VALUE IS ALWAYS POSITIVE                 
         TM    2(R6),X'20'         TEST NEGATIVE VALUES PRESENT                 
         BZ    IUNDEM10                                                         
         TM    0(R7),X'80'         TEST SIGN BIT ON IN FIELD                    
         BZ    IUNDEM10                                                         
         LCR   RF,RF               SET VALUE TO ALL EFFS                        
*                                                                               
IUNDEM10 IC    R1,ICMMASK(R8)      USE FIELD LENGTH AS TABLE INDEX              
         EX    R1,*+8                                                           
         B     *+8                                                              
         ICM   RF,0,0(R7)          GET VALUE INTO RF                            
         M     RE,EXPAND                                                        
*                                                                               
         ST    RF,0(R5)            SET IUNVAL ENTRY                             
*                                                                               
         LA    R5,4(R5)            NEXT IUNVAL ENTRY                            
         BXLE  R7,R8,IUNDEM8                                                    
*                                                                               
         IC    R0,1(R6)            NEXT ELEMENT                                 
         AR    R6,R0                                                            
*                                                                               
IUNDEM11 LA    R4,ELEMTABL(R4)     NEXT ELEMENT TABLE ENTRY                     
         B     IUNDEM2                                                          
         EJECT                                                                  
IUNDEM20 EQU   *                   HUT & INDEX ADJUSTMENTS                      
         SR    R0,R0               LOCATE BOOK ELEMENT                          
         L     R1,ABOOKEL          R1=A(BOOK ELEMENT)                           
         CLI   DMAIMP,C'I'         PROTECT AGAINST MULTI PASS                   
         BNE   *+8                                                              
         MVI   RTGTOIMP,C'Y'                                                    
         CLC   =X'5B06',5(R1)      ALREADY IN IMP BASE                          
         BE    *+10                                                             
         CLC   =X'5A0C',5(R1)      ALREADY IN IMP BASE                          
         BE    *+10                                                             
         CLC   =X'5A0B',5(R1)                                                   
         BNE   IUNDEM22                                                         
         MVI   RTGTOIMP,C'N'       RESET CONVERSION                             
*                                                                               
IUNDEM22 CLC   =X'5206',5(R1)      TEST PUT (JUN/82)                            
         BE    IUNDEM30                                                         
         CLC   =X'5406',5(R1)      TEST PUT (JUN/84)                            
         BE    IUNDEM30                                                         
         CLC   =X'5B06',5(R1)      TEST PUT (JUN/91)                            
         BE    IUNDEM30                                                         
         CLC   =X'530C',5(R1)      TEST INDEX (DEC/83)                          
         BE    *+10                                                             
         CLC   =X'5A0C',5(R1)      TEST INDEX (DEC/90)                          
         BE    *+10                                                             
         CLC   =X'5205',5(R1)      TEST INDEX (MAY/82)                          
         BE    *+10                                                             
         CLC   =X'5A0B',5(R1)      TEST INDEX (NOV/90)                          
         BE    *+10                                                             
         CLC   =X'530B',5(R1)      TEST INDEX (NOV/83)                          
         BNE   IUNDEM40                                                         
*                                                                               
         OC    V2554*4+IRATINGS(4),V2554*4+IRATINGS TEST OLD RTG=0              
         BZ    *+14                YES-FORCE CALCULATION                        
         OC    V2554*4+INEWRTGS(4),V2554*4+INEWRTGS  TEST NEW RTG=0             
         BNZ   *+8                                                              
         BAS   RE,CALV             YES-CALCULATE V2554 VALUES                   
*                                                                               
IUNDEM25 IC    R0,1(R1)            BUMP TO NEXT ELEMENT                         
         AR    R1,R0                                                            
         CLI   0(R1),X'00'         TEST E-O-R                                   
         BE    IUNDEM40                                                         
         CLI   0(R1),X'DE'         TEST INDEX UPGRADE ELEMENT                   
         BL    IUNDEM25                                                         
         BH    IUNDEM40                                                         
*                                                                               
         CLC   2(2,R1),NDXDEM2     '&&',X'FE'                                   
         BE    *+10                                                             
         CLC   2(2,R1),NDXDEM      '&&',X'FF'                                   
         BNE   IUNDEM25                                                         
*                                                                               
         SR    RF,RF               RF - INDEX                                   
         ICM   RF,3,4(R1)                                                       
         CLI   1(R1),6             TEST FOR 6 BYTE ELEMENT                      
         BE    *+8                 YES-INDEX VALUE IS HALFWORD                  
         ICM   RF,7,4(R1)          NO-INDEX VALUE IS 3 BYTES                    
         LTR   RF,RF                                                            
         BZ    IUNDEM40                                                         
         C     RF,=F'10000'        TEST FOR NO ADJUSTMENT (100.00)              
         BE    IUNDEM40                                                         
*                                                                               
         LA    R4,INEWRTGS         R4 - IUNVALS...NEW RTGS                      
*    THE NEXT INSTRUCTION CAUSES A DOUBLE INDEX                                 
*    THE SECOND ONE STOPS THAT. IF THIS WORKS THE CHANGES ARE                   
*    OBVIOUS. IF NOT WELL I TRIED                                               
*                                                                               
         LA    R5,IRATINGS         R5 - IUNVALS...ORG RTGS                      
         LR    R5,R4               STOP DOUBLE INDEX                            
*                                                                               
         LA    RE,IUNDEMS          RE - LOOP CONTROL                            
         L     R1,ABOOKEL                                                       
         CLC   =X'530B',5(R1)      TEST INDEX (NOV/83)                          
         BE    IUNDEM28                                                         
         CLC   =X'530C',5(R1)      TEST INDEX (DEC/83)                          
         BE    IUNDEM28                                                         
         CLC   =X'5A0B',5(R1)      TEST INDEX (NOV/90)                          
         BE    IUNDEM28                                                         
         CLC   =X'5A0C',5(R1)      TEST INDEX (DEC/90)                          
         BE    IUNDEM28                                                         
*                                                                               
IUNDEM27 L     R1,0(R5)                                                         
         MR    R0,RF                                                            
         A     R1,=F'50000'        ROUND                                        
         D     R0,=F'100000'                                                    
         M     R0,=F'10'                                                        
         ST    R1,0(R4)                                                         
         LA    R4,4(R4)            BUMP NEW RTGS                                
         LA    R5,4(R5)            BUMP ORG RTGS                                
         BCT   RE,IUNDEM27                                                      
         B     IUNDEM40                                                         
*                                                                               
IUNDEM28 L     R1,0(R5)            UNROUNDED                                    
         MR    R0,RF                                                            
         A     R1,=F'5000'        ROUND                                         
         D     R0,=F'10000'                                                     
         ST    R1,0(R4)                                                         
         LA    R4,4(R4)            BUMP NEW RTGS                                
         LA    R5,4(R5)            BUMP ORG RTGS                                
         BCT   RE,IUNDEM28                                                      
         B     IUNDEM40                                                         
*                                                                               
IUNDEM30 EQU   *                   PUT UPGRADE                                  
         LA    R4,INEWRTGS         R4 - IUNVALS...NEW RTGS (OR IMPS)            
         LA    R5,IRATINGS         R5 - IUNVALS...ORG RTGS (OR IMPS)            
         LA    R6,INEWPUTS         R6 - IUNVALS...NEW PUTS (OR TOTS)            
         LA    R7,IPUTS            R7 - IUNVALS...ORG PUTS (OR TOTS)            
         LA    RE,IUNDEMS*2        RE - LOOP CONTROL (RTGS & IMPS)              
IUNDEM32 L     R1,0(R5)            R1 - ORG RTG                                 
         LTR   R1,R1                                                            
         BZ    IUNDEM38            BYPASS ZERO RTG OR IMP                       
         M     R0,=F'1000'                                                      
         OC    0(4,R7),0(R7)       TEST FOR ZERO DIVISOR                        
         BNZ   *+10                                                             
         SR    R1,R1               FORCE ZERO RESULT                            
         B     IUNDEM38                                                         
*                                                                               
         D     R0,0(R7)            ORG RTG / ORG PUT                            
         SR    R0,R0                                                            
*                                                                               
         M     R0,0(R6)            SHARE X NEW PUT                              
         A     R1,=F'500'          ROUND                                        
         D     R0,=F'1000'         R1 - NEW RTG                                 
*                                                                               
IUNDEM38 ST    R1,0(R4)                                                         
         LA    R4,4(R4)            BUMP NEW RTGS (OR IMPS)                      
         LA    R5,4(R5)            BUMP ORG RTGS (OR IMPS)                      
         LA    R6,4(R6)            BUMP NEW PUTS (OR TOTS)                      
         LA    R7,4(R7)            BUMP ORG PUTS (OR TOTS)                      
         BCT   RE,IUNDEM32                                                      
*                                                                               
         OC    V2554*4+IRATINGS(4),V2554*4+IRATINGS TEST OLD RTG=0              
         BZ    *+14                YES-FORCE CALCULATION                        
         OC    V2554*4+INEWRTGS(4),V2554*4+INEWRTGS  TEST NEW RTG=0             
         BNZ   *+8                                                              
         BAS   RE,CALV             YES-CALCULATE V2554 VALUES                   
*                                                                               
         SPACE 2                                                                
IUNDEM40 L     R6,DBAQUART         RESTORE QUARTER HOUR ELEMENT ADDRESS         
         SR    R0,R0               APPLY OVERRIDES                              
IUNDEM41 IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO FIRST DEMO ELEMENT                   
*                                                                               
IUNDEM42 CLI   0(R6),X'00'         TEST FOR EOR                                 
         BE    IUNDEM80                                                         
         CLI   0(R6),X'DE'         TEST FOR OVERRIDE ELEMENT CODE               
         BL    IUNDEM41                                                         
         BH    IUNDEM80                                                         
*                                                                               
         LA    R4,CATTAB           R4 - CATEGORY TABLE                          
         LA    R5,MODTAB           R5 - MODIFIER TABLE                          
*                                                                               
IUNDEM43 CLI   0(R5),EOT           TEST FOR END OF MODTAB                       
         BE    IUNDEM41                                                         
         CLC   0(1,R5),2(R6)       TEST MODIFIER EQUALS TABLE                   
         BE    *+12                                                             
         LA    R5,3(R5)            BUMP MODTAB                                  
         B     IUNDEM43                                                         
         EJECT                                                                  
         CLI   2(R6),C'S'          TEST FOR SHARE                               
         BNE   IUNDEM44                                                         
         LA    R4,SHRTAB           USE SPECIAL TABLE FOR SHARES                 
*                                                                               
IUNDEM44 CLI   0(R4),EOT           TEST FOR END OF CATTAB                       
         BE    IUNDEM41                                                         
         CLC   0(1,R4),3(R6)       TEST CATEGORY EQUALS TABLE                   
         BE    IUNDEM45                                                         
         LA    R4,2(R4)            BUMP CATTAB                                  
         B     IUNDEM44                                                         
*                                                                               
IUNDEM45 LA    RE,IUNVALS          OBTAIN DISPLACEMENT INTO IUNVALS             
         MVC   DUB(2),1(R5)        EXTRACT DISPLACEMENT                         
         AH    RE,DUB              MODTAB DISPLACEMENT                          
         ZIC   RF,1(R4)            CATTAB DISPLACEMENT                          
         AR    RE,RF                                                            
*                                                                               
         SR    R1,R1                                                            
         ICM   R1,3,4(R6)          GET OVERRIDE VALUE                           
         CLI   0(R5),C'U'          TEST FOR UNIVERSE                            
         BE    IUNDEM46                                                         
         CLI   0(R5),C'Q'          TEST NEW TOTS                                
         BE    IUNDEM46                                                         
         CLI   0(R5),C'T'          TEST NEW IMPS                                
         BNE   IUNDEM47                                                         
IUNDEM46 LA    RF,10               MULTIPLY NEW TOTS + NEW IMPS BY 10           
         MR    R0,RF               ON RECORD IN (00), OUTPUT IS (000)           
IUNDEM47 ST    R1,0(RE)            SET OVERRIDE IN IUNVALS                      
         B     IUNDEM41                                                         
*                                                                               
         SPACE 2                                                                
* MOVE OUT IUN VALUES INTO WORK AREA                                            
*                                                                               
IUNDEM80 CLI   CALLTYPE,10         SEED OVR REQUEST?                            
         BNE   *+8                                                              
         BAS   RE,IUNOVR                                                        
         MVC   UNIVS(IUNDEMS*4,R3),IUNIVS                                       
         MVC   RATINGS(IUNDEMS*4,R3),IRATINGS                                   
         MVC   IMPS(IUNDEMS*4,R3),IIMPS                                         
         MVC   PUTS(IUNDEMS*4,R3),IPUTS                                         
         MVC   TOTS(IUNDEMS*4,R3),ITOTS                                         
         MVC   NEWRTGS(IUNDEMS*4,R3),INEWRTGS                                   
         MVC   NEWIMPS(IUNDEMS*4,R3),INEWIMPS                                   
         MVC   NEWPUTS(IUNDEMS*4,R3),INEWPUTS                                   
         MVC   NEWTOTS(IUNDEMS*4,R3),INEWTOTS                                   
         MVC   SHRS(3*4,R3),ISHRS                                               
*                                                                               
* CONVERT PERCENTS TO IMPS IF MISMATCH ON FILE PRECISIONS                       
         CLI   RTGTOIMP,C'Y'                                                    
         BNE   IUNDEMX                                                          
         LA    R8,UNIVS(R3)        SET UP UNIVERSES                             
         LA    RE,RATINGS(R3)      CONVERT THE RATINGS                          
         LA    R9,IUNDEMS                                                       
         LA    R7,0                                                             
RTOI1    SR    R0,R0                                                            
         L     R1,0(R7,RE)                                                      
         L     R0,0(R7,R8)                                                      
         MR    R0,R0                                                            
         SR    R0,R0                                                            
         A     R1,=F'5'                                                         
         D     R0,=F'10'                                                        
         ST    R1,0(R7,RE)                                                      
         LA    R7,4(R7)                                                         
         BCT   R9,RTOI1                                                         
*                                                                               
         LA    RE,PUTS(R3)         CONVERT THE PUTS                             
         LA    R9,IUNDEMS                                                       
         LA    R7,0                                                             
RTOI2    SR    R0,R0                                                            
         L     R1,0(R7,RE)                                                      
         L     R0,0(R7,R8)                                                      
         MR    R0,R0                                                            
         SR    R0,R0                                                            
         A     R1,=F'5'                                                         
         D     R0,=F'10'                                                        
         ST    R1,0(R7,RE)                                                      
         LA    R7,4(R7)                                                         
         BCT   R9,RTOI2                                                         
*                                                                               
         LA    RE,NEWRTGS(R3)      CONVERT THE NEW RATINGS                      
         LA    R9,IUNDEMS                                                       
         LA    R7,0                                                             
RTOI3    SR    R0,R0                                                            
         L     R1,0(R7,RE)                                                      
         L     R0,0(R7,R8)                                                      
         MR    R0,R0                                                            
         SR    R0,R0                                                            
         A     R1,=F'5'                                                         
         D     R0,=F'10'                                                        
         ST    R1,0(R7,RE)                                                      
         LA    R7,4(R7)                                                         
         BCT   R9,RTOI3                                                         
*                                                                               
         LA    RE,NEWPUTS(R3)      CONVERT THE NEW PUTS                         
         LA    R9,IUNDEMS                                                       
         LA    R7,0                                                             
RTOI4    SR    R0,R0                                                            
         L     R1,0(R7,RE)                                                      
         L     R0,0(R7,R8)                                                      
         MR    R0,R0                                                            
         SR    R0,R0                                                            
         A     R1,=F'5'                                                         
         D     R0,=F'10'                                                        
         ST    R1,0(R7,RE)                                                      
         LA    R7,4(R7)                                                         
         BCT   R9,RTOI4                                                         
*                                                                               
IUNDEMX  XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
*IUNOVR - PICK UP NEW OVR ELEMS (X'DE' LN=12) FROM RECD AND SLOT INTO           
*         WORK AREA CELLS                                                       
***********************************************************************         
IUNOVR   NTR1                                                                   
         L     R6,DBAQUART                                                      
IUNOVR5  CLI   0(R6),0             EOR                                          
         BE    IUNOVRX             NO (MORE) OVR ELEMS                          
         CLI   0(R6),X'DE'         R6 -> X'DE' ELEM                             
         BNE   IUNOVR8                                                          
         CLI   1(R6),12            ONLY DEAL W/NEW OVR ELEMS                    
         BNE   IUNOVR8                                                          
         CLI   4(R6),C'T'          HANDLE IMP & RTG OVR ONLY                    
         BE    IUNOVR10                                                         
         CLI   4(R6),C'R'                                                       
         BE    IUNOVR10                                                         
IUNOVR8  SR    R0,R0               LK FOR ANOTHER OVR ELEM                      
         IC    R0,1(R6)                                                         
         AR    R6,R0                                                            
         B     IUNOVR5                                                          
*                                                                               
IUNOVR10 SR    R5,R5                                                            
         CLI   4(R6),C'T'                                                       
         BNE   *+8                                                              
         LA    R5,INEWIMPS         R5 -> IMPS WORK AREA                         
         CLI   4(R6),C'R'                                                       
         BNE   *+8                                                              
         LA    R5,INEWRTGS         R5 -> RTGS WORK AREA                         
         LA    R7,CATTAB                                                        
         LA    R0,CATS                                                          
IUNOVR13 CLC   5(1,R6),0(R7)       MATCH DEMO# ON OVR W/TBL TO GET DSP          
         BE    *+16                                                             
         LA    R7,L'CATTAB(R7)                                                  
         BCT   R0,IUNOVR13                                                      
         B     IUNOVR8             OVR IS FOR CALC CELL, GET NXT OVR            
*                                                                               
         SR    RF,RF                                                            
         IC    RF,1(R7)            DISP TO DEMO CTGY                            
         AR    R5,RF               R5 -> OUTPUT BUCKET IN WORK                  
         ICM   R1,15,8(R6)         PICK UP OVR VALUE FROM RECD                  
*                                                                               
         CLI   4(R6),C'R'          FOR RTGS ONLY                                
         BNE   IUNOVR20                                                         
         CLI   DMAIMP,C'I'         IMP BASED, SAVE OVR RTG * UNIV               
         BNE   IUNOVR20                                                         
         CLI   RTGTOIMP,C'Y'                                                    
         BE    IUNOVR20                                                         
         XC    DUB,DUB                                                          
         MVI   DUB+1,C'U'          LOOK UP UNIV FOR THIS DEMO                   
         MVC   DUB+2(1),5(R6)      MOVE IN MODIFIER AND DEMO CTGY               
         MVI   DUB+3,X'FF'                                                      
         MVC   HALF,DBACTBK                                                     
         L     RF,DBCOMFCS                                                      
         USING COMFACSD,RF                                                      
         GOTO1 CDEMOUT,DMCB,(C'L',DUB),DBLOCKD,DUB+4                            
         MVC   DBACTBK,HALF                                                     
         SR    R1,R1                                                            
         CLI   DBERROR,0                                                        
         BNE   IUNOVRX             IF ERROR, BYPASS OVERRIDE                    
         ICM   R1,15,DUB+4         PICK UP UNIVERSE                             
         MVC   HALF,10(R6)         PICK UP OVERRIDE RTG VALUE                   
         MH    R1,HALF             RTG * UNV-> MAKE IMP BASED                   
*                                                                               
*       <<HANDLE PRECISION HERE>>                                               
                                                                                
IUNOVR20 STCM  R1,15,0(R5)         SEED OVR                                     
         B     IUNOVR8             GET NXT OVR                                  
*                                                                               
*                                                                               
IUNOVRX  XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
* SUB-ROUTINE TO CALCULATE MISSING BASIC CELL VALUES FROM IUN                   
* RECORD (V2554 VALUES)                                                         
***********************************************************************         
*                                                                               
CALV     NTR1                                                                   
*                                                                               
         L     R6,W2554*4+IUNIVS   UV2554=UW2554+UM2554                         
         A     R6,M2554*4+IUNIVS                                                
         ST    R6,V2554*4+IUNIVS                                                
*                                                                               
         L     R6,W2554*4+IIMPS    OLD IMP                                      
         A     R6,M2554*4+IIMPS                                                 
         ST    R6,V2554*4+IIMPS                                                 
*                                                                               
         L     R6,W2554*4+ITOTS    OLD TOT                                      
         A     R6,M2554*4+ITOTS                                                 
         ST    R6,V2554*4+ITOTS                                                 
*                                                                               
         L     R6,W2554*4+INEWIMPS TV2554=TW2554+TM2554                         
         A     R6,M2554*4+INEWIMPS                                              
         ST    R6,V2554*4+INEWIMPS                                              
*                                                                               
         L     R6,W2554*4+INEWTOTS QV2554=QW2554+QM2554                         
         A     R6,M2554*4+INEWTOTS                                              
         ST    R6,V2554*4+INEWTOTS                                              
*                                                                               
CALV2    L     R7,W2554*4+IRATINGS COMPUTE OLD RATING                           
         M     R6,W2554*4+IUNIVS   ADI IMP (W2554)                              
         L     R5,M2554*4+IRATINGS                                              
         M     R4,M2554*4+IUNIVS   ADI IMP (M2554)                              
         AR    R7,R5               ADI IMP V2554                                
         SR    R6,R6                                                            
         OC    V2554*4+IUNIVS(4),V2554*4+IUNIVS  TEST ZERO DIVISOR              
         BNZ   *+10                                                             
         SR    R7,R7               YES-FORCE QUOTIENT TO ZERO                   
         B     *+8                                                              
*                                                                               
         D     R6,V2554*4+IUNIVS                                                
*                                                                               
         ST    R7,V2554*4+IRATINGS                                              
*                                                                               
CALV4    L     R7,W2554*4+INEWRTGS COMPUTE NEW RATING                           
         M     R6,W2554*4+IUNIVS   ADI IMP (W2554)                              
         L     R5,M2554*4+INEWRTGS                                              
         M     R4,M2554*4+IUNIVS   ADI IMP (M2554)                              
         AR    R7,R5               ADI IMP V2554                                
         SR    R6,R6                                                            
         OC    V2554*4+IUNIVS(4),V2554*4+IUNIVS  TEST ZERO DIVISOR              
         BNZ   *+10                                                             
         SR    R7,R7               YES-FORCE QUOTIENT TO ZERO                   
         B     *+8                                                              
*                                                                               
         D     R6,V2554*4+IUNIVS                                                
*                                                                               
         ST    R7,V2554*4+INEWRTGS                                              
*                                                                               
CALV6    L     R7,W2554*4+IPUTS    COMPUTE OLD PUT                              
         M     R6,W2554*4+IUNIVS   MKT IMP (W2554)                              
         L     R5,M2554*4+IPUTS                                                 
         M     R4,M2554*4+IUNIVS   MKT IMP (M2554)                              
         AR    R7,R5               MKT IMP V2554                                
         SR    R6,R6                                                            
         OC    V2554*4+IUNIVS(4),V2554*4+IUNIVS  TEST ZERO DIVISOR              
         BNZ   *+10                                                             
         SR    R7,R7               YES-FORCE QUOTIENT TO ZERO                   
         B     *+8                                                              
*                                                                               
         D     R6,V2554*4+IUNIVS                                                
*                                                                               
         ST    R7,V2554*4+IPUTS                                                 
*                                                                               
CALV8    L     R7,W2554*4+INEWPUTS COMPUTE NEW PUTS                             
         M     R6,W2554*4+IUNIVS   MKT IMP (W2554)                              
         L     R5,M2554*4+INEWPUTS                                              
         M     R4,M2554*4+IUNIVS   MKT IMP (M2554)                              
         AR    R7,R5               MKT IMP V2554                                
         SR    R6,R6                                                            
         OC    V2554*4+IUNIVS(4),V2554*4+IUNIVS  TEST ZERO DIVISOR              
         BNZ   *+10                                                             
         SR    R7,R7               YES-FORCE QUOTIENT TO ZERO                   
         B     *+8                                                              
*                                                                               
         D     R6,V2554*4+IUNIVS                                                
*                                                                               
         ST    R7,V2554*4+INEWPUTS                                              
*                                                                               
CALX     XIT1                                                                   
         EJECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
         SPACE                                                                  
EOT      EQU   X'FF'                                                            
BKELQ    EQU   X'5E'                                                            
MULT     EQU   C'*'                                                             
DIV      EQU   C'/'                                                             
UNIVERSE EQU   X'80'                                                            
RATING   EQU   X'40'                                                            
IMP      EQU   X'20'                                                            
PUT      EQU   X'10'                                                            
TOT      EQU   X'08'                                                            
DMA      EQU   X'04'                                                            
TSA      EQU   X'02'                                                            
TSAHOMES EQU   X'01'                                                            
MASK1    EQU   UNIVERSE+RATING+IMP                                              
MASK2    EQU   UNIVERSE+PUT+TOT+TSAHOMES                                        
MASK4    EQU   UNIVERSE+RATING+IMP+PUT+TOT+TSAHOMES                             
MASK5    EQU   UNIVERSE                                                         
IUNDEMS  EQU   32                                                               
DISV2554 EQU   25                  FULLWORD DISPLACEMENT TO V2554               
HEADLEN  EQU   6                   L'DEMO LIST TABLE HEADER                     
         SPACE 2                                                                
         DS    0H                  ICMMASK MUST HALFWORD-ALIGNED                
ICMMASK  DC    X'00',X'0103070F'   ARRAY INDEX IS ***ZERO-BASED***              
NDXDEM   DC    C'&&',X'FF'                                                      
NDXDEM2  DC    C'&&',X'FE'                                                      
         EJECT                                                                  
         DS    0H                                                               
         SPACE 1                                                                
SHRTAB   DS    0CL2                                                             
         DC    AL1(001),AL1(0)                                                  
         DC    AL1(002),AL1(4)                                                  
         DC    AL1(003),AL1(8)                                                  
SHARES   EQU   (*-SHRTAB)/L'SHRTAB                                              
         DC    AL1(EOT)                                                         
         SPACE 1                                                                
* TABLE OF MODIFIERS FOUND IN OVERRIDE ELEMENTS FOR IUN RECORDS                 
*                                                                               
MODTAB   DS    0CL3                                                             
         DC    C'R',AL2(NEWRTGS)                                                
         DC    C'T',AL2(NEWIMPS)                                                
         DC    C'S',AL2(SHRS)                                                   
         DC    C'P',AL2(NEWPUTS)                                                
         DC    C'Q',AL2(NEWTOTS)                                                
         DC    C'U',AL2(UNIVS)                                                  
MODS     EQU   (*-MODTAB)/L'MODTAB                                              
         DC    AL1(EOT)                                                         
* TABLE OF IUN CATEGORIES AND DISPLACEMENTS                                     
*                                                                               
CATTAB   DS    0CL2                                                             
         DC    AL1(127),AL1(V299*4)                                             
         DC    AL1(145),AL1(V1899*4)                                            
         DC    AL1(129),AL1(V1234*4)                                            
         DC    AL1(128),AL1(V1224*4)                                            
         DC    AL1(125),AL1(V1217*4)                                            
         DC    AL1(123),AL1(V611*4)                                             
         DC    AL1(122),AL1(V211*4)                                             
         DC    AL1(045),AL1(W1899*4)                                            
         DC    AL1(041),AL1(W1834*4)                                            
         DC    AL1(042),AL1(W1849*4)                                            
         DC    AL1(047),AL1(W2549*4)                                            
         DC    AL1(048),AL1(W2554*4)                                            
         DC    AL1(028),AL1(W1224*4)                                            
         DC    AL1(049),AL1(W2564*4)                                            
         DC    AL1(029),AL1(W1234*4)                                            
         DC    AL1(095),AL1(M1899*4)                                            
         DC    AL1(091),AL1(M1834*4)                                            
         DC    AL1(092),AL1(M1849*4)                                            
         DC    AL1(098),AL1(M2554*4)                                            
         DC    AL1(099),AL1(M2564*4)                                            
         DC    AL1(001),AL1(HOMES*4)                                            
         DC    AL1(002),AL1(METROA*4)                                           
         DC    AL1(003),AL1(METROB*4)                                           
         DC    AL1(065),AL1(WWORK*4)                                            
         DC    AL1(097),AL1(M2549*4)                                            
         DC    AL1(142),AL1(V1849*4)                                            
         DC    AL1(141),AL1(V1834*4)                                            
         DC    AL1(148),AL1(V2554*4)                                            
         DC    AL1(191),AL1(V2149*4)  STARTS WITH FEB/87 ARB ONLY               
         DC    AL1(071),AL1(W2149*4)  *                                         
         DC    AL1(115),AL1(M2149*4)  *                                         
         DC    AL1(153),AL1(V3564*4)  STARTS WITH FEB/88 ARB ONLY               
CATS     EQU   (*-CATTAB)/L'CATTAB                                              
         DC    AL1(EOT)                                                         
         EJECT                                                                  
NETFILS  DS    0CL3                                                             
         DC    C'NHN'              NHTI FILE                                    
         DC    C'NNN'              NAD FILE                                     
         DC    C'PNN'              NTI FILE                                     
         DC    C'CNN'              CABLE FILE                                   
         DC    X'0000'                                                          
         EJECT                                                                  
         DS    0F                                                               
ORGTAB   DS    0CL(ORGTABL)                                                     
*                                                                               
         DC    C'TTA',X'520A'      ARB TP                                       
         DC    AL3(AOCT82-BASE)                                                 
         DC    Y(TTADEM-BASE)                                                   
*                                                                               
         DC    C'TTM',X'6002'      MDF TP                                       
         DC    AL3(MFEB96-BASE)                                                 
         DC    Y(TTMDEM-BASE)                                                   
*                                                                               
         DC    C'TTN',X'520A'      NSI TP                                       
         DC    AL3(NOCT82-BASE)                                                 
         DC    Y(TTNDEM-BASE)                                                   
*                                                                               
         DC    C'TTN',X'5A0A'      NSI TP                                       
         DC    AL3(NOCT90-BASE)                                                 
         DC    Y(TTNDEM-BASE)                                                   
*                                                                               
         DC    C'TTS',X'5701'                                                   
         DC    AL3(SJAN87-BASE)                                                 
         DC    Y(TTSDEM-BASE)                                                   
*                                                                               
         DC    C'PTA',X'520A'      ARB PAV                                      
         DC    AL3(APAV82-BASE)                                                 
         DC    Y(TTADEM-BASE)                                                   
*                                                                               
         DC    C'PTM',X'6002'      MDF PAV                                      
         DC    AL3(MPAV96-BASE)                                                 
         DC    Y(TTMDEM-BASE)                                                   
*                                                                               
         DC    C'PTN',X'520A'      NSI PAV                                      
         DC    AL3(NOCT82-BASE)    SAME ELEMENT LAYOUT AS TP                    
         DC    Y(TTNDEM-BASE)                                                   
*                                                                               
         DC    C'PTN',X'5A0A'      NSI PAV                                      
         DC    AL3(NOCT90-BASE)    SAME ELEMENT LAYOUT AS TP                    
         DC    Y(TTNDEM-BASE)                                                   
*                                                                               
         DC    C'IUN',X'5205'                                                   
         DC    AL3(IUN82-BASE)     INDEX UPGRADE (MAY/82)                       
         DC    Y(IUNDEM-BASE)                                                   
*                                                                               
         DC    C'IUN',X'5206'                                                   
         DC    AL3(IUN82-BASE)     PUT UPGRADE (JUN/82)                         
         DC    Y(IUNDEM-BASE)                                                   
*                                                                               
         DC    C'IUN',X'530B'      SPOT-REP                                     
         DC    AL3(IUN82-BASE)     INDEX UPGRADE (NOV/83)                       
         DC    Y(IUNDEM-BASE)                                                   
*                                                                               
         DC    C'IUN',X'530C'      SPOT-REP                                     
         DC    AL3(IUN82-BASE)     INDEX UPGRADE (DEC/83) NEW                   
         DC    Y(IUNDEM-BASE)                                                   
*                                                                               
         DC    C'IUN',X'5406'      SPOT-REP                                     
         DC    AL3(IUN82-BASE)     PUT UPGRADE (JUN/84)                         
         DC    Y(IUNDEM-BASE)                                                   
*                                                                               
         DC    C'IUN',X'5A0B'      SPOT-REP TAPE PREC                           
         DC    AL3(IUN82-BASE)     INDEX UPGRADE (NOV/90)                       
         DC    Y(IUNDEM-BASE)                                                   
*                                                                               
         DC    C'IUN',X'5A0C'      SPOT-REP TAPE PREC                           
         DC    AL3(IUN82-BASE)     INDEX UPGRADE (DEC/90)                       
         DC    Y(IUNDEM-BASE)                                                   
*                                                                               
         DC    C'IUN',X'5B06'      SPOT-REP                                     
         DC    AL3(IUN82-BASE)     PUT UPGRADE (JUN/91)                         
         DC    Y(IUNDEM-BASE)                                                   
*NET                                                                            
*        DC    C'NNN',X'5F05'      NAD - MONTHLY NAD BOOK                       
*        DC    AL3(NNN-BASE)                                                    
*        DC    Y(NETDEM-BASE)                                                   
*                                                                               
*        DC    C'NHN',X'5C01'      NHTI - MONTHLY HISPANIC SURVEY               
*        DC    AL3(NNN-BASE)                                                    
*        DC    Y(NETDEM-BASE)                                                   
*                                                                               
*        DC    C'PNN',X'5721'      NTI - POCKETPIECE                            
*        DC    AL3(NNN-BASE)                                                    
*        DC    Y(NETDEM-BASE)                                                   
*                                                                               
*        DC    C'CNN',X'5D26'      CNN - NETWORK CABLE                          
*        DC    AL3(NNN-BASE)                                                    
*        DC    Y(NETDEM-BASE)                                                   
*                                                                               
         DC    C'PON',X'6701'      OVERNIGHTS PAV                               
         DC    AL3(POOCT90-BASE)                                                
         DC    Y(TTNDEM-BASE)                                                   
*                                                                               
         DC    C'TON',X'6701'      OVERNIGHTS TP                                
         DC    AL3(TOOCT90-BASE)                                                
         DC    Y(TTNDEM-BASE)                                                   
*                                                                               
         DC    XL2'0000'                                                        
         EJECT                                                                  
*                                                                               
NNN      DC    X'FF'               DUMMY -> NO NET TABLES                       
*                                                                               
*----------------------------------------------------------------------         
* TABLE OF ARB TIME PERIOD (OCT82) ELEMENTS AND DISPLACEMENTS TO                
* DEMO LISTS.  PUTS ARE TAKEN FROM 'M' ELEMENTS WHICH ARE                       
* THE 4 WEEK PUTS CALCULATED IN CONVERSION PROGRAM.  PUTS IN 'P'                
* ELEMENTS ARE PUT VALUES DEPENDENT ON NUMBER OF WEEK PROGRAM RAN.              
*----------------------------------------------------------------------         
*                                                                               
AOCT82   DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(AOCT8231-BASE),AL1(RATING)                             
         DC    X'33',AL3(AOCT8233-BASE),AL1(RATING)                             
         DC    X'35',AL3(0),AL1(0)                                              
         DC    X'37',AL3(0),AL1(0)                                              
         DC    X'39',AL3(0),AL1(0)                                              
         DC    X'41',AL3(AOCT8241-BASE),AL1(IMP)                                
         DC    X'43',AL3(AOCT8243-BASE),AL1(IMP)                                
         DC    X'45',AL3(AOCT8245-BASE),AL1(UNIVERSE)                           
         DC    X'47',AL3(AOCT8247-BASE),AL1(UNIVERSE)                           
         DC    X'49',AL3(AOCT8249-BASE),AL1(TOT)                                
         DC    X'51',AL3(AOCT8251-BASE),AL1(TOT)                                
         DC    X'53',AL3(AOCT8253-BASE),AL1(PUT)                                
         DC    X'55',AL3(AOCT8255-BASE),AL1(PUT)                                
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
* TABLE OF NSI TIME PERIOD (OCT82) ELEMENTS AND DISPLACEMENTS TO                
* DEMO LISTS                                                                    
*                                                                               
NOCT82   DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(NOCT8231-BASE),AL1(RATING+PUT)                         
         DC    X'33',AL3(NOCT8233-BASE),AL1(IMP+DMA)                            
         DC    X'35',AL3(NOCT8235-BASE),AL1(IMP+DMA)                            
         DC    X'37',AL3(NOCT8237-BASE),AL1(UNIVERSE)                           
         DC    X'39',AL3(NOCT8239-BASE),AL1(UNIVERSE)                           
         DC    X'41',AL3(NOCT8241-BASE),AL1(DMA)                                
         DC    X'43',AL3(NOCT8243-BASE),AL1(TSA+TSAHOMES)                       
         DC    X'45',AL3(NOCT8245-BASE),AL1(TSA)                                
         DC    X'47',AL3(NOCT8247-BASE),AL1(TOT)                                
         DC    X'49',AL3(NOCT8249-BASE),AL1(RATING)                             
         DC    X'51',AL3(NOCT8251-BASE),AL1(PUT)                                
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT90   DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(NOCT8231-BASE),AL1(RATING+PUT)                         
         DC    X'33',AL3(NOCT8233-BASE),AL1(IMP+DMA)                            
         DC    X'35',AL3(NOCT9035-BASE),AL1(IMP+DMA)                            
         DC    X'37',AL3(NOCT8237-BASE),AL1(UNIVERSE)                           
         DC    X'39',AL3(NOCT9039-BASE),AL1(UNIVERSE)                           
         DC    X'41',AL3(NOCT9041-BASE),AL1(DMA)                                
         DC    X'43',AL3(NOCT8243-BASE),AL1(TSA+TSAHOMES)                       
         DC    X'45',AL3(NOCT9045-BASE),AL1(TSA)                                
         DC    X'47',AL3(NOCT9047-BASE),AL1(TOT)                                
         DC    X'49',AL3(NOCT8249-BASE),AL1(RATING)                             
         DC    X'51',AL3(NOCT8251-BASE),AL1(PUT)                                
*                                                                               
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
*  PAV OVERNIGHTS                                                               
POOCT90  DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(PON10431-BASE),AL1(UNIVERSE)                           
         DC    X'33',AL3(PON10433-BASE),AL1(TSA+TSAHOMES)                       
         DC    X'35',AL3(PON10435-BASE),AL1(TSA)                                
         DC    X'37',AL3(PON10437-BASE),AL1(DMA)                                
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
* TYPICAL TIME PERIOD OVERNIGHTS                                                
TOOCT90  DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(NOCT8231-BASE),AL1(RATING+PUT)                         
         DC    X'33',AL3(NOCT8233-BASE),AL1(IMP+DMA)                            
         DC    X'35',AL3(OOCT9035-BASE),AL1(IMP+DMA)                            
         DC    X'37',AL3(NOCT8237-BASE),AL1(UNIVERSE)                           
         DC    X'39',AL3(OOCT9039-BASE),AL1(UNIVERSE)                           
         DC    X'41',AL3(OOCT9041-BASE),AL1(DMA)                                
         DC    X'43',AL3(NOCT8243-BASE),AL1(TSA+TSAHOMES)                       
         DC    X'45',AL3(OOCT9045-BASE),AL1(TSA)                                
****     DC    X'47',AL3(OOCT9047-BASE),AL1(TOT)                                
         DC    AL1(EOT)                                                         
* TABLE OF SRC TIME PERIOD (JAN87) ELEMENTS AND DISPLACEMENTS TO                
* DEMO LISTS                                                                    
*                                                                               
SJAN87   DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(SJAN8731-BASE),AL1(RATING)                             
         DC    X'33',AL3(SJAN8733-BASE),AL1(PUT)                                
         DC    X'35',AL3(SJAN8735-BASE),AL1(IMP)                                
         DC    X'37',AL3(SJAN8737-BASE),AL1(UNIVERSE)                           
         DC    X'39',AL3(SJAN8739-BASE),AL1(TOT)                                
         DC    AL1(EOT)                                                         
         EJECT                                                                  
* TABLE OF ARB PAV (OCT82) ELEMENTS AND DISPLACEMENTS TO                        
* DEMO LISTS                                                                    
*                                                                               
APAV82   DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(APAV8231-BASE),AL1(RATING)                             
         DC    X'33',AL3(APAV8233-BASE),AL1(RATING)                             
         DC    X'35',AL3(APAV8235-BASE),AL1(RATING)                             
         DC    X'37',AL3(0),AL1(0)                                              
         DC    X'39',AL3(0),AL1(0)                                              
         DC    X'41',AL3(APAV8241-BASE),AL1(IMP)                                
         DC    X'43',AL3(APAV8243-BASE),AL1(IMP)                                
         DC    X'45',AL3(APAV8245-BASE),AL1(UNIVERSE)                           
         DC    X'47',AL3(APAV8247-BASE),AL1(UNIVERSE)                           
         DC    X'49',AL3(APAV8249-BASE),AL1(TOT)                                
         DC    X'51',AL3(APAV8251-BASE),AL1(TOT)                                
         DC    X'53',AL3(APAV8253-BASE),AL1(PUT)                                
         DC    X'55',AL3(APAV8255-BASE),AL1(PUT)                                
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
* TABLE OF IUN ELEMENTS AND THEIR DISPLACEMENTS INTO WORK AREA                  
*                                                                               
IUN82    DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(UNIVS),AL1(0)                                          
         DC    X'33',AL3(RATINGS),AL1(0)                                        
         DC    X'35',AL3(IMPS),AL1(0)                                           
         DC    X'37',AL3(PUTS),AL1(0)                                           
         DC    X'39',AL3(TOTS),AL1(0)                                           
         DC    X'41',AL3(NEWRTGS),AL1(0)                                        
         DC    X'43',AL3(NEWIMPS),AL1(0)                                        
         DC    X'45',AL3(NEWPUTS),AL1(0)                                        
         DC    X'47',AL3(NEWTOTS),AL1(0)                                        
         DC    X'49',AL3(SHRS),AL1(0)                                           
         DC    AL1(EOT)                                                         
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
* ARB TIME PERIOD DEMO LIST.  EACH TABLE CONSISTS OF A SIX BYTE HEADER*         
* CONTAINING A FULLWORD PRECISION ADJUSTMENT OPERAND, THE PRECISION   *         
* ADJUSTMENT OPERATION (DEFAULT IS MULTIPLY), AND A SPARE BYTE.  A    *         
* SET OF DEMO LIST ENTRIES DESCRIBING EACH DEMO VALUE FIELD IN THE    *         
* ELEMENT FOLLOWS THE HEADER.  THE 4 BYTE ENTRY GIVES THE DISPLACEMENT*         
* TO THE OUTPUT WORK AREA SECTION FOR THE TYPE OF DEMO, THE DISPLACE- *         
* MENT IN NUMBER OF FULLWORDS INTO THE SECTION, AND A SPARE BYTE.     *         
*                                                                     *         
***********************************************************************         
         SPACE                                                                  
         DS    0F                                                               
AOCT8231 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(RATINGS),AL1(HOMES),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V299),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(V1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(WWORK),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2564),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M2564),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2554),X'00',Y(ARW2554-WORKD)                     
         DC    Y(RATINGS),AL1(M2554),X'00',Y(ARM2554-WORKD)                     
         DC    Y(RATINGS),AL1(V1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1849),X'00',Y(ARW1849-WORKD)                     
         DC    Y(RATINGS),AL1(M1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2549),X'00',Y(ARW2549-WORKD)                     
         DC    Y(RATINGS),AL1(M2549),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1834),X'00',Y(ARW1834-WORKD)                     
         DC    Y(RATINGS),AL1(M1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1234),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(METROA),X'00',Y(ARMETROA-WORKD)                   
         DC    Y(RATINGS),AL1(METROB),X'00',Y(ARMETROB-WORKD)                   
         DC    Y(RATINGS),AL1(V2149),X'00',Y(0) FEB/87 START                    
         DC    Y(RATINGS),AL1(W2149),X'00',Y(0) *                               
         DC    Y(RATINGS),AL1(M2149),X'00',Y(0) *                               
*                                               FEB/88 START                    
         DC    Y(RATINGS),AL1(V2554),AL1(TTABYPAS),Y(ARV2554-WORKD)             
         DC    Y(RATINGS),AL1(V3564),X'00',Y(0)                                 
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8233 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(RATINGS),AL1(V1224),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1224),X'00',Y(ARW1224-WORKD)                     
         DC    Y(RATINGS),AL1(V1217),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V211),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(V611),X'00',Y(0)                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8235 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    3X'0000FF000000'                                                 
         DC    Y(PUTS),AL1(METROA),X'00',Y(APMETROA-WORKD)                      
         DC    2X'0000FF000000'                                                 
         DC    Y(PUTS),AL1(METROB),X'00',Y(APMETROB-WORKD)                      
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8237 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(PUTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2564),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2564),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2554),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2554),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1849),X'00',Y(APW1849-WORKD)                        
         DC    Y(PUTS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2549),X'00',Y(APW2549-WORKD)                        
         DC    Y(PUTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1834),X'00',Y(APW1834-WORKD)                        
         DC    Y(PUTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V2149),X'00',Y(0) FEB/87 START                       
         DC    Y(PUTS),AL1(W2149),X'00',Y(0) *                                  
         DC    Y(PUTS),AL1(M2149),X'00',Y(0) *                                  
         DC    Y(PUTS),AL1(V2554),X'00',Y(0) FEB/88 START                       
         DC    Y(PUTS),AL1(V3564),X'00',Y(0) FEB/88 START                       
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8239 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(PUTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1224),X'00',Y(APW1224-WORKD)                        
         DC    Y(PUTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8241 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(IMPS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V299),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(V1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W2564),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M2564),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W2554),X'00',Y(ATW2554-WORKD)                        
         DC    Y(IMPS),AL1(M2554),X'00',Y(ATM2554-WORKD)                        
         DC    Y(IMPS),AL1(V1849),X'00',Y(0)                                    
*                      START FEB/88                                             
         DC    X'0000FF000000'          TV35+                                   
         DC    X'0000FF000000'          TV50+                                   
         DC    Y(IMPS),AL1(V2149),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V3564),X'00',Y(0)                                    
         DC    X'0000FF000000'          TW35+                                   
         DC    Y(IMPS),AL1(W2149),X'00',Y(0)                                    
         DC    X'0000FF000000'          TM35+                                   
         DC    Y(IMPS),AL1(M2149),X'00',Y(0)                                    
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8243 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(IMPS),AL1(W1849),X'00',Y(ATW1849-WORKD)                        
         DC    Y(IMPS),AL1(M1849),X'00',Y(ATM1849-WORKD)                        
         DC    Y(IMPS),AL1(W2549),X'00',Y(ATW2549-WORKD)                        
         DC    Y(IMPS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1834),X'00',Y(ATW1834-WORKD)                        
         DC    Y(IMPS),AL1(M1834),X'00',Y(ATM1834-WORKD)                        
         DC    Y(IMPS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1224),X'00',Y(ATW1224-WORKD)                        
         DC    Y(IMPS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V211),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8245 DC    F'100'                                                           
         DC    AL1(DIV)                                                         
         DC    X'00'                                                            
*                                                                               
         DC    Y(UNIVS),AL1(V299),X'00',Y(0)                                    
         DC    3X'0000FF000000'                                                 
         DC    Y(UNIVS),AL1(HOMES),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2564),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M2564),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2554),X'00',Y(AUW2554-WORKD)                       
         DC    Y(UNIVS),AL1(M2554),X'00',Y(AUM2554-WORKD)                       
         DC    Y(UNIVS),AL1(M1849),X'00',Y(AUM1849-WORKD)                       
         DC    Y(UNIVS),AL1(W1849),X'00',Y(AUW1849-WORKD)                       
         DC    Y(UNIVS),AL1(WWORK),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(METROA),X'00',Y(AUMETROA-WORKD)                     
         DC    Y(UNIVS),AL1(METROB),X'00',Y(AUMETROB-WORKD)                     
         DC    6X'0000FF000000'                                                 
         DC    Y(UNIVS),AL1(V2149),X'00',Y(0) FEB/87 START                      
         DC    Y(UNIVS),AL1(W2149),X'00',Y(0) *                                 
         DC    Y(UNIVS),AL1(M2149),X'00',Y(0) *                                 
         DC    Y(UNIVS),AL1(V2554),X'00',Y(0) FEB/88 START                      
         DC    Y(UNIVS),AL1(V3564),X'00',Y(0) FEB/88 START                      
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8247 DC    F'100'                                                           
         DC    AL1(DIV)                                                         
         DC    X'00'                                                            
*                                                                               
         DC    Y(UNIVS),AL1(V1234),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2549),X'00',Y(AUW2549-WORKD)                       
         DC    Y(UNIVS),AL1(M2549),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1834),X'00',Y(AUW1834-WORKD)                       
         DC    Y(UNIVS),AL1(M1834),X'00',Y(AUM1834-WORKD)                       
         DC    Y(UNIVS),AL1(V1217),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1224),X'00',Y(AUW1224-WORKD)                       
         DC    Y(UNIVS),AL1(V1224),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V211),X'00',Y(0)                                    
         DC    Y(UNIVS),AL1(V611),X'00',Y(0)                                    
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8249 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(TOTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(V1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W2564),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M2564),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W2554),X'00',Y(AQW2554-WORKD)                        
         DC    Y(TOTS),AL1(M2554),X'00',Y(AQM2554-WORKD)                        
         DC    Y(TOTS),AL1(V1849),X'00',Y(0)                                    
*                      START FEB/88                                             
         DC    X'0000FF000000'          QV35+                                   
         DC    X'0000FF000000'          QV50+                                   
         DC    Y(TOTS),AL1(V2149),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V3564),X'00',Y(0)                                    
         DC    X'0000FF000000'          QW35+                                   
         DC    Y(TOTS),AL1(W2149),X'00',Y(0)                                    
         DC    X'0000FF000000'          QM35+                                   
         DC    Y(TOTS),AL1(M2149),X'00',Y(0)                                    
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8251 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(TOTS),AL1(W1849),X'00',Y(AQW1849-WORKD)                        
         DC    Y(TOTS),AL1(M1849),X'00',Y(AQM1849-WORKD)                        
         DC    Y(TOTS),AL1(W2549),X'00',Y(AQW2549-WORKD)                        
         DC    Y(TOTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1834),X'00',Y(AQW1834-WORKD)                        
         DC    Y(TOTS),AL1(M1834),X'00',Y(AQM1834-WORKD)                        
         DC    Y(TOTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1224),X'00',Y(AQW1224-WORKD)                        
         DC    Y(TOTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8253 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(PUTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2564),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2564),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2554),X'00',Y(APW2554-WORKD)                        
         DC    Y(PUTS),AL1(M2554),X'00',Y(APM2554-WORKD)                        
         DC    Y(PUTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1849),X'00',Y(APW1849-WORKD)                        
         DC    Y(PUTS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2549),X'00',Y(APW2549-WORKD)                        
         DC    Y(PUTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1834),X'00',Y(APW1834-WORKD)                        
         DC    Y(PUTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(METROA),X'00',Y(APMETROA-WORKD)                      
         DC    Y(PUTS),AL1(METROB),X'00',Y(APMETROB-WORKD)                      
         DC    Y(PUTS),AL1(V2149),X'00',Y(0) FEB/87 START                       
         DC    Y(PUTS),AL1(W2149),X'00',Y(0) *                                  
         DC    Y(PUTS),AL1(M2149),X'00',Y(0) *                                  
*                                            FEB/88 START                       
         DC    Y(PUTS),AL1(V2554),AL1(TTABYPAS),Y(APV2554-WORKD)                
         DC    Y(PUTS),AL1(V3564),X'00',Y(0) FEB/88 START                       
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
AOCT8255 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(PUTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1224),X'00',Y(APW1224-WORKD)                        
         DC    Y(PUTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
* NSI OCT82 TIME PERIOD DEMO LIST TABLES                              *         
*                                                                     *         
* EACH TABLE CONSISTS OF 6-BYTE DEMO ENTRIES CONTAINING THE           *         
* DISPLACEMENT INTO WORKING STORAGE FOR THE EXTRACTED VALUE,          *         
* THE DEMO TYPE, AND 3 SPARE BYTES.                                   *         
***********************************************************************         
         SPACE                                                                  
NOCT8231 DS    0F                                                               
*                                                                               
         DC    Y(NRHOMES-WORKD),AL1(RATING),3X'00'                              
         DC    5X'0000FF000000'                                                 
         DC    Y(NPMETROA-WORKD),AL1(PUT),3X'00'                                
         DC    X'0000FF000000'                                                  
         DC    Y(NRMETROA-WORKD),AL1(RATING),3X'00'                             
         DC    Y(NPMETROB-WORKD),AL1(PUT),3X'00'                                
         DC    X'0000FF000000'                                                  
         DC    Y(NRMETROB-WORKD),AL1(RATING),3X'00'                             
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT8233 DS    0F                                                               
*                                                                               
         DC    Y(NTHOMES-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NDHOMES-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NTWWORK-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NDWWORK-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NTW6599-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NDW6599-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NTM6599-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NDM6599-WORKD),AL1(DMA),3X'00'                                 
         DC    2X'0000FF000000'                                                 
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT8235 DS    0F                                                               
*                                                                               
         DC    Y(NTM1217-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW1217-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM1824-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW1824-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM2534-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW2534-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM3549-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW3549-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM5564-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW5564-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM5054-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW5054-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTV25-WORKD),AL1(IMP),3X'00'                                   
         DC    Y(NDV25-WORKD),AL1(DMA),3X'00'                                   
         DC    Y(NTV611-WORKD),AL1(IMP),3X'00'                                  
         DC    Y(NDV611-WORKD),AL1(DMA),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT9035 DS    0F                                                               
*                                                                               
         DC    Y(NTM1217-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW1217-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM1820-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW1820-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM2124-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW2124-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM2534-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW2534-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM3549-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW3549-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM5564-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW5564-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM5054-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW5054-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTV25-WORKD),AL1(IMP),3X'00'                                   
         DC    Y(NDV25-WORKD),AL1(DMA),3X'00'                                   
         DC    Y(NTV611-WORKD),AL1(IMP),3X'00'                                  
         DC    Y(NDV611-WORKD),AL1(DMA),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
* THIS FOLLWING "35" ELEMENT TABLE IS FOR OVERNIGHTS ONLY                       
OOCT9035 DS    0F                                                               
         DC    Y(NTM1214-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW1214-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM1517-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW1517-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM1820-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW1820-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM2124-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW2124-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM2534-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW2534-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM3549-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW3549-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM5564-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW5564-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTM5054-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTW5054-WORKD),AL1(IMP),3X'00'                                 
         DC    Y(NTV25-WORKD),AL1(IMP),3X'00'                                   
         DC    Y(NDV25-WORKD),AL1(DMA),3X'00'                                   
         DC    Y(NTV611-WORKD),AL1(IMP),3X'00'                                  
         DC    Y(NDV611-WORKD),AL1(DMA),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
                                                                                
                                                                                
                                                                                
NOCT8237 DS    0F                                                               
*                                                                               
         DC    Y(NUHOMES-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM6599-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW6599-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUWWORK-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    3X'0000FF000000'                                                 
         DC    Y(NUMETROA-WORKD),AL1(UNIVERSE),3X'00'                           
         DC    Y(NUMETROB-WORKD),AL1(UNIVERSE),3X'00'                           
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT8239 DS    0F                                                               
*                                                                               
         DC    Y(NUM1217-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1217-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM1824-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1824-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM2534-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW2534-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM3549-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW3549-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM5564-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW5564-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM5054-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW5054-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUV25-WORKD),AL1(UNIVERSE),3X'00'                              
         DC    Y(NUV611-WORKD),AL1(UNIVERSE),3X'00'                             
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT9039 DS    0F                                                               
*                                                                               
         DC    Y(NUM1217-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1217-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM1820-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1820-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM2124-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW2124-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM2534-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW2534-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM3549-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW3549-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM5564-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW5564-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM5054-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW5054-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUV25-WORKD),AL1(UNIVERSE),3X'00'                              
         DC    Y(NUV611-WORKD),AL1(UNIVERSE),3X'00'                             
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
* THE FOLLOWING ELEMENT "39" TABLE IS FOR OVERNIGHTS ONLY                       
*                                                                               
OOCT9039 DS    0F                                                               
*                                                                               
         DC    Y(NUM1214-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1214-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM1517-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1517-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM1820-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1820-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM2124-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW2124-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM2534-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW2534-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM3549-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW3549-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM5564-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW5564-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM5054-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW5054-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUV25-WORKD),AL1(UNIVERSE),3X'00'                              
         DC    Y(NUV611-WORKD),AL1(UNIVERSE),3X'00'                             
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
NOCT8241 DS    0F                                                               
*                                                                               
         DC    Y(NDM1217-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1217-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM1824-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1824-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM2534-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW2534-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM3549-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW3549-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM5564-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW5564-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM5054-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW5054-WORKD),AL1(DMA),3X'00'                                 
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT9041 DS    0F                                                               
*                                                                               
         DC    Y(NDM1217-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1217-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM1820-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1820-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM2124-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW2124-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM2534-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW2534-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM3549-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW3549-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM5564-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW5564-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM5054-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW5054-WORKD),AL1(DMA),3X'00'                                 
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
*                                                                               
* THIS FOLLOWING ELEMENT "41" TABLE IS FOR  OVERNIGHTS ONLY                     
*                                                                               
OOCT9041 DS    0F                                                               
*                                                                               
         DC    Y(NDM1214-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1214-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM1517-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1517-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM1820-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1820-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM2124-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW2124-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM2534-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW2534-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM3549-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW3549-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM5564-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW5564-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM5054-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW5054-WORKD),AL1(DMA),3X'00'                                 
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
NOCT8243 DS    0F                                                               
*                                                                               
         DC    Y(NWHOMES-WORKD),AL1(TSA+TSAHOMES),3X'00'                        
         DC    Y(NWWWORK-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW6599-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM6599-WORKD),AL1(TSA),3X'00'                                 
         DC    2X'0000FF000000'                                                 
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT8245 DS    0F                                                               
*                                                                               
         DC    Y(NWM1217-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1217-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM1824-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1824-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM2534-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW2534-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM3549-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW3549-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM5564-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW5564-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM5054-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW5054-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWV25-WORKD),AL1(TSA),3X'00'                                   
         DC    Y(NWV611-WORKD),AL1(TSA),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT9045 DS    0F                                                               
*                                                                               
         DC    Y(NWM1217-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1217-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM1820-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1820-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM2124-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW2124-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM2534-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW2534-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM3549-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW3549-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM5564-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW5564-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM5054-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW5054-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWV25-WORKD),AL1(TSA),3X'00'                                   
         DC    Y(NWV611-WORKD),AL1(TSA),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
*                                                                               
* THIS FOLLOWING ELEMENT "45" TABLE IS FOR OVERNIGHT ONLY                       
* IN THEORY THE 45 ELEMENT ON THE OVERNIGHT DEMO RECORDS                        
* ARE ACTUALLY THE MARKET TOTALS BUT THEY WILL GET MOVED INTO                   
* THE PUT BUFFER IN THE ROUTINE (TTNDEM) SINCE WE DONT HAVE TSA NUMBERS         
* ON THE OVERNIGHTS AND ONLY GET DMAS - THIS WORKS FINE                         
*                                                                               
OOCT9045 DS    0F                                                               
*                                                                               
         DC    Y(NWM1214-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1214-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM1517-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1517-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM1820-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1820-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM2124-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW2124-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM2534-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW2534-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM3549-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW3549-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM5564-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW5564-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM5054-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW5054-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWV25-WORKD),AL1(TSA),3X'00'                                   
         DC    Y(NWV611-WORKD),AL1(TSA),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
NOCT8247 DS    0F                                                               
*                                                                               
         DC    Y(NQHOMES-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQWWORK-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW6599-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM6599-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM1217-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW1217-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM1824-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW1824-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM2534-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW2534-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM3549-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW3549-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM5564-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW5564-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM5054-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW5054-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQV25-WORKD),AL1(TOT),3X'00'                                   
         DC    Y(NQV611-WORKD),AL1(TOT),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT9047 DS    0F                                                               
*                                                                               
         DC    Y(NQHOMES-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQWWORK-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW6599-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM6599-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM1217-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW1217-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM1820-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW1820-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM2124-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW2124-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM2534-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW2534-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM3549-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW3549-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM5564-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW5564-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM5054-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW5054-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQV25-WORKD),AL1(TOT),3X'00'                                   
         DC    Y(NQV611-WORKD),AL1(TOT),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
*                                                                               
* THE FOLLOWING ELEMENT "47" TABLE IS FOR  OVERNIGHTS ONLY                      
*                                                                               
OOCT9047 DS    0F                                                               
*                                                                               
         DC    Y(NQHOMES-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQWWORK-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW6599-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM6599-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM1214-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW1214-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM1517-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW1517-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM1820-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW1820-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM2124-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW2124-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM2534-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW2534-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM3549-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW3549-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM5564-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW5564-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQM5054-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQW5054-WORKD),AL1(TOT),3X'00'                                 
         DC    Y(NQV25-WORKD),AL1(TOT),3X'00'                                   
         DC    Y(NQV611-WORKD),AL1(TOT),3X'00'                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
NOCT8249 DS    0F                                                               
*                                                                               
         DC    Y(V299*4+IRATINGS-WORKD),AL1(RATING),3X'00'                      
         DC    Y(V1899*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(V1234*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(V1224*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(V1217*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(V611*4+IRATINGS-WORKD),AL1(RATING),3X'00'                      
         DC    Y(V211*4+IRATINGS-WORKD),AL1(RATING),3X'00'                      
         DC    Y(W1899*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(W1834*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(W1849*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(W2549*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(W2554*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(W1224*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(W2564*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(W1234*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(M1899*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(M1834*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(M1849*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(M2554*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(M2564*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(WWORK*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(M2549*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(V1849*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(V1834*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    Y(V2554*4+IRATINGS-WORKD),AL1(RATING),3X'00'                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
NOCT8251 DS    0F                                                               
*                                                                               
         DC    Y(V299*4+IPUTS-WORKD),AL1(PUT),3X'00'                            
         DC    Y(V1899*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(V1234*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(V1224*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(V1217*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(V611*4+IPUTS-WORKD),AL1(PUT),3X'00'                            
         DC    Y(V211*4+IPUTS-WORKD),AL1(PUT),3X'00'                            
         DC    Y(W1899*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(W1834*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(W1849*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(W2549*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(W2554*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(W1224*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(W2564*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(W1234*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(M1899*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(M1834*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(M1849*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(M2554*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(M2564*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(WWORK*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(M2549*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(V1849*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(V1834*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    Y(V2554*4+IPUTS-WORKD),AL1(PUT),3X'00'                           
         DC    AL1(EOT)                                                         
         EJECT                                                                  
********************************************************                        
* PAV OVERNIGHTS ELEMENT TABLES                                                 
********************************************************                        
PON10431 DS    0F                                                               
*  UNIVERSE                                                                     
         DC    Y(NUHOMES-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUV25-WORKD),AL1(UNIVERSE),3X'00'                              
         DC    Y(NUV611-WORKD),AL1(UNIVERSE),3X'00'                             
         DC    Y(NUM1214-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM1517-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM1820-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM2124-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM2534-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM3549-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM5054-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM5564-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUM6599-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1214-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1517-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW1820-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW2124-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW2534-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW3549-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW5054-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW5564-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUW6599-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    Y(NUWWORK-WORKD),AL1(UNIVERSE),3X'00'                            
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
PON10433 DS    0F                                                               
         DC    Y(NWHOMES-WORKD),AL1(TSA+TSAHOMES),3X'00'                        
         DC    Y(NDHOMES-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NRHOMES-WORKD),AL1(RATING),3X'00'                              
         DC    X'0000FF000000'                                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*                                                                               
* THE FOLLOWING ELEMENT "35" TABLE IS PAV OVERNIGHTS                            
* ELEMENT 35 ON THE PAV OVRNIGHTS DEMO RECORD CONTAIN THE DMA TOTALS            
* BUT SINCE DMAIMP=I WILL MOVE THE ITAS INTO PUTS BUFFER WE WILL CAN            
* MOVE THE TOTALS TO THE TSA BUFFER                                             
PON10435 DS    0F                                                               
         DC    Y(NWV25-WORKD),AL1(TSA),3X'00'                                   
         DC    Y(NWV611-WORKD),AL1(TSA),3X'00'                                  
         DC    Y(NWM1214-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM1517-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM1820-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM2124-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM2534-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM3549-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM5054-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM5564-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWM6599-WORKD),AL1(TSA),3X'00'                                 
*                                                                               
         DC    Y(NWW1214-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1517-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW1820-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW2124-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW2534-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW3549-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW5054-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW5564-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWW6599-WORKD),AL1(TSA),3X'00'                                 
         DC    Y(NWWWORK-WORKD),AL1(TSA),3X'00'                                 
         DC    AL1(EOT)                                                         
*                                                                               
* DMA  IMPRESSIONS                                                              
PON10437 DS    0F                                                               
         DC    Y(NDV25-WORKD),AL1(DMA),3X'00'                                   
         DC    Y(NDV611-WORKD),AL1(DMA),3X'00'                                  
         DC    Y(NDM1214-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM1517-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM1820-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM2124-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM2534-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM3549-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM5054-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM5564-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDM6599-WORKD),AL1(DMA),3X'00'                                 
*                                                                               
         DC    Y(NDW1214-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1517-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW1820-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW2124-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW2534-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW3549-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW5054-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW5564-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDW6599-WORKD),AL1(DMA),3X'00'                                 
         DC    Y(NDWWORK-WORKD),AL1(DMA),3X'00'                                 
         DC    AL1(EOT)                                                         
*                                                                               
***********************************************************************         
* SRC TIME PERIOD JAN 87 ELEMENT DEMO LIST TABLES                     *         
*                                                                     *         
*       EACH TABLE CONSISTS OF A SIX BYTE HEADER CONTAINING           *         
* FULLWORD PRECISION ADJUSTMENT OPERAND, THE PRECISION                *         
* ADJUSTMENT OPERATION (DEFAULT IS MULTIPLY), AND A SPARE BYTE.  A    *         
* SET OF DEMO LIST ENTRIES DESCRIBING EACH DEMO VALUE FIELD IN THE    *         
* ELEMENT FOLLOWS THE HEADER.  THE 4 BYTE ENTRY GIVES THE DISPLACEMENT*         
* TO THE OUTPUT WORK AREA SECTION FOR THE TYPE OF DEMO, THE DISPLACE- *         
* MENT IN NUMBER OF FULLWORDS INTO THE SECTION, AND A SPARE BYTE.     *         
*                                                                     *         
***********************************************************************         
         SPACE 1                                                                
         DS    0F                                                               
SJAN8731 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(RATINGS),AL1(HOMES),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V299),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(W1899),X'00',Y(SRW1899-WORKD)                     
         DC    Y(RATINGS),AL1(M1899),X'00',Y(SRM1899-WORKD)                     
         DC    Y(RATINGS),AL1(W2554),X'00',Y(SRW2554-WORKD)                     
         DC    Y(RATINGS),AL1(M2554),X'00',Y(SRM2554-WORKD)                     
         DC    Y(RATINGS),AL1(V1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1849),X'00',Y(SRW1849-WORKD)                     
         DC    Y(RATINGS),AL1(M1849),X'00',Y(SRM1849-WORKD)                     
         DC    Y(RATINGS),AL1(W2549),X'00',Y(SRW2549-WORKD)                     
         DC    Y(RATINGS),AL1(M2549),X'00',Y(SRM2549-WORKD)                     
         DC    Y(RATINGS),AL1(V1834),X'00',Y(SRV1834-WORKD)                     
         DC    Y(RATINGS),AL1(W1834),X'00',Y(SRW1834-WORKD)                     
         DC    Y(RATINGS),AL1(M1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1217),X'00',Y(SRV1217-WORKD)                     
         DC    Y(RATINGS),AL1(V211),X'00',Y(0)                                  
         DC    Y(0),X'FF',X'00',Y(0)        V25+                                
         DC    Y(0),X'FF',X'00',Y(0)        V21+                                
         DC    Y(RATINGS),AL1(V2149),X'00',Y(0)                                 
         DC    Y(0),X'FF',X'00',Y(0)        W50+                                
         DC    Y(0),X'FF',X'00',Y(0)        W25+                                
         DC    Y(0),X'FF',X'00',Y(0)        W21+                                
         DC    Y(RATINGS),AL1(W2149),X'00',Y(0)                                 
         DC    Y(0),X'FF',X'00',Y(0)        V12+                                
         DC    Y(RATINGS),AL1(V1224),X'00',Y(0)                                 
         DC    Y(0),X'FF',X'00',Y(0)        M50+                                
         DC    Y(0),X'FF',X'00',Y(0)        M25+                                
         DC    Y(0),X'FF',X'00',Y(0)        M21+                                
         DC    Y(RATINGS),AL1(M2149),X'00',Y(0)                                 
         DC    Y(0),X'FF',X'00',Y(0)        M2134                               
         DC    Y(RATINGS),AL1(254),X'00',Y(SRW1217-WORKD)                       
         DC    Y(RATINGS),AL1(V611),X'00',Y(0)                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
SJAN8733 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(PUTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(W1899),X'00',Y(SPW1899-WORKD)                        
         DC    Y(PUTS),AL1(M1899),X'00',Y(SPM1899-WORKD)                        
         DC    Y(PUTS),AL1(W2554),X'00',Y(SPW2554-WORKD)                        
         DC    Y(PUTS),AL1(M2554),X'00',Y(SPM2554-WORKD)                        
         DC    Y(PUTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1849),X'00',Y(SPW1849-WORKD)                        
         DC    Y(PUTS),AL1(M1849),X'00',Y(SPM1849-WORKD)                        
         DC    Y(PUTS),AL1(W2549),X'00',Y(SPW2549-WORKD)                        
         DC    Y(PUTS),AL1(M2549),X'00',Y(SPM2549-WORKD)                        
         DC    Y(PUTS),AL1(V1834),X'00',Y(SPV1834-WORKD)                        
         DC    Y(PUTS),AL1(W1834),X'00',Y(SPW1834-WORKD)                        
         DC    Y(PUTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1217),X'00',Y(SPV1217-WORKD)                        
         DC    Y(PUTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(0),X'FF',X'00',Y(0)        V25+                                
         DC    Y(0),X'FF',X'00',Y(0)        V21+                                
         DC    Y(PUTS),AL1(V2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        W50+                                
         DC    Y(0),X'FF',X'00',Y(0)        W25+                                
         DC    Y(0),X'FF',X'00',Y(0)        W21+                                
         DC    Y(PUTS),AL1(W2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        V12+                                
         DC    Y(PUTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        M50+                                
         DC    Y(0),X'FF',X'00',Y(0)        M25+                                
         DC    Y(0),X'FF',X'00',Y(0)        M21+                                
         DC    Y(PUTS),AL1(M2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        M2134                               
         DC    Y(PUTS),AL1(254),X'00',Y(SPW1217-WORKD)                          
         DC    Y(PUTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
SJAN8735 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(IMPS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V299),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(W1899),X'00',Y(SIW1899-WORKD)                        
         DC    Y(IMPS),AL1(M1899),X'00',Y(SIM1899-WORKD)                        
         DC    Y(IMPS),AL1(W2554),X'00',Y(SIW2554-WORKD)                        
         DC    Y(IMPS),AL1(M2554),X'00',Y(SIM2554-WORKD)                        
         DC    Y(IMPS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1849),X'00',Y(SIW1849-WORKD)                        
         DC    Y(IMPS),AL1(M1849),X'00',Y(SIM1849-WORKD)                        
         DC    Y(IMPS),AL1(W2549),X'00',Y(SIW2549-WORKD)                        
         DC    Y(IMPS),AL1(M2549),X'00',Y(SIM2549-WORKD)                        
         DC    Y(IMPS),AL1(V1834),X'00',Y(SIV1834-WORKD)                        
         DC    Y(IMPS),AL1(W1834),X'00',Y(SIW1834-WORKD)                        
         DC    Y(IMPS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1217),X'00',Y(SIV1217-WORKD)                        
         DC    Y(IMPS),AL1(V211),X'00',Y(0)                                     
         DC    Y(0),X'FF',X'00',Y(0)        V25+                                
         DC    Y(0),X'FF',X'00',Y(0)        V21+                                
         DC    Y(IMPS),AL1(V2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        W50+                                
         DC    Y(0),X'FF',X'00',Y(0)        W25+                                
         DC    Y(0),X'FF',X'00',Y(0)        W21+                                
         DC    Y(IMPS),AL1(W2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        V12+                                
         DC    Y(IMPS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        M50+                                
         DC    Y(0),X'FF',X'00',Y(0)        M25+                                
         DC    Y(0),X'FF',X'00',Y(0)        M21+                                
         DC    Y(IMPS),AL1(M2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        M2134                               
         DC    Y(IMPS),AL1(254),X'00',Y(SIW1217-WORKD)                          
         DC    Y(IMPS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
SJAN8737 DC    F'100'                                                           
         DC    AL1(DIV)                                                         
         DC    X'00'                                                            
*                                                                               
         DC    Y(UNIVS),AL1(0),X'00',Y(SUM1824-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUM2534-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUM3549-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUM5054-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUM5564-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUM6599-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUW1824-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUW2534-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUW3549-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUW5054-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUW5564-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUW6599-WORKD)                           
         DC    Y(UNIVS),AL1(V1217),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V211),X'00',Y(0)                                    
         DC    Y(UNIVS),AL1(HOMES),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(0),X'00',Y(SUM2124-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUW2124-WORKD)                           
         DC    Y(UNIVS),AL1(V611),X'00',Y(0)                                    
         DC    Y(UNIVS),AL1(0),X'00',Y(SUM1217-WORKD)                           
         DC    Y(UNIVS),AL1(0),X'00',Y(SUW1217-WORKD)                           
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
SJAN8739 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(TOTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(W1899),X'00',Y(SQW1899-WORKD)                        
         DC    Y(TOTS),AL1(M1899),X'00',Y(SQM1899-WORKD)                        
         DC    Y(TOTS),AL1(W2554),X'00',Y(SQW2554-WORKD)                        
         DC    Y(TOTS),AL1(M2554),X'00',Y(SQM2554-WORKD)                        
         DC    Y(TOTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1849),X'00',Y(SQW1849-WORKD)                        
         DC    Y(TOTS),AL1(M1849),X'00',Y(SQM1849-WORKD)                        
         DC    Y(TOTS),AL1(W2549),X'00',Y(SQW2549-WORKD)                        
         DC    Y(TOTS),AL1(M2549),X'00',Y(SQM2549-WORKD)                        
         DC    Y(TOTS),AL1(V1834),X'00',Y(SQV1834-WORKD)                        
         DC    Y(TOTS),AL1(W1834),X'00',Y(SQW1834-WORKD)                        
         DC    Y(TOTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1217),X'00',Y(SQV1217-WORKD)                        
         DC    Y(TOTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(0),X'FF',X'00',Y(0)        V25+                                
         DC    Y(0),X'FF',X'00',Y(0)        V21+                                
         DC    Y(TOTS),AL1(V2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        W50+                                
         DC    Y(0),X'FF',X'00',Y(0)        W25+                                
         DC    Y(0),X'FF',X'00',Y(0)        W21+                                
         DC    Y(TOTS),AL1(W2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        V12+                                
         DC    Y(TOTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        M50+                                
         DC    Y(0),X'FF',X'00',Y(0)        M25+                                
         DC    Y(0),X'FF',X'00',Y(0)        M21+                                
         DC    Y(TOTS),AL1(M2149),X'00',Y(0)                                    
         DC    Y(0),X'FF',X'00',Y(0)        M2134                               
         DC    Y(TOTS),AL1(254),X'00',Y(SQW1217-WORKD)                          
         DC    Y(TOTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
* ARB PAV FILE DEMO LIST.  EACH TABLE CONSISTS OF A SIX BYTE HEADER   *         
* CONTAINING A FULLWORD PRECISION ADJUSTMENT OPERAND, THE PRECISION   *         
* ADJUSTMENT OPERATION (DEFAULT IS MULTIPLY), AND A SPARE BYTE.  A    *         
* SET OF DEMO LIST ENTRIES DESCRIBING EACH DEMO VALUE FIELD IN THE    *         
* ELEMENT FOLLOWS THE HEADER.  THE 4 BYTE ENTRY GIVES THE DISPLACEMENT*         
* TO THE OUTPUT WORK AREA SECTION FOR THE TYPE OF DEMO, THE DISPLACE- *         
* MENT IN NUMBER OF FULLWORDS INTO THE SECTION, AND A SPARE BYTE.     *         
*                                                                     *         
***********************************************************************         
         SPACE                                                                  
         DS    0F                                                               
APAV8231 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(RATINGS),AL1(HOMES),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V299),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(V1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(WWORK),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2564),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M2564),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2554),X'00',Y(ARW2554-WORKD)                     
         DC    Y(RATINGS),AL1(M2554),X'00',Y(ARM2554-WORKD)                     
         DC    Y(RATINGS),AL1(V1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1849),X'00',Y(ARW1849-WORKD)                     
         DC    Y(RATINGS),AL1(M1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2549),X'00',Y(ARW2549-WORKD)                     
         DC    Y(RATINGS),AL1(M2549),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1834),X'00',Y(ARW1834-WORKD)                     
         DC    Y(RATINGS),AL1(M1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1234),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V2149),X'00',Y(0) FEB/87 START                    
         DC    Y(RATINGS),AL1(W2149),X'00',Y(0) *                               
         DC    Y(RATINGS),AL1(M2149),X'00',Y(0) *                               
*                         FEB/88 START                                          
         DC    X'0000FF000000'                  * RV35+                         
         DC    X'0000FF000000'                  * RV50+                         
         DC    Y(RATINGS),AL1(V2554),AL1(TTABYPAS),Y(ARV2554-WORKD)             
         DC    Y(RATINGS),AL1(V3564),X'00',Y(0) * RV3564                        
         DC    X'0000FF000000'                  * RW35+                         
         DC    X'0000FF000000'                  * RM35+                         
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8233 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(RATINGS),AL1(V1224),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1224),X'00',Y(ARW1224-WORKD)                     
         DC    Y(RATINGS),AL1(V1217),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V211),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(V611),X'00',Y(0)                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8235 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    X'0000FF000000'                                                  
         DC    Y(RATINGS),AL1(METROA),X'00',Y(ARMETROA-WORKD)                   
         DC    2X'0000FF000000'                                                 
         DC    Y(RATINGS),AL1(METROB),X'00',Y(ARMETROB-WORKD)                   
         DC    2X'0000FF000000'                                                 
*                         FEB/88 START                                          
         DC    4X'0000FF000000'     RHH-W1 RHH-W2 RHH-W3 RHH-W4                 
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8241 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(IMPS),AL1(HOMES),X'00',Y(0)                                    
         DC    X'0000FF000000'                                                  
         DC    Y(IMPS),AL1(V299),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(V1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W2564),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M2564),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W2554),X'00',Y(ATW2554-WORKD)                        
         DC    Y(IMPS),AL1(M2554),X'00',Y(ATM2554-WORKD)                        
         DC    Y(IMPS),AL1(V1849),X'00',Y(0)                                    
         DC    2X'0000FF000000'     DMETROA DMETROB                             
*                  START FEB/88                                                 
         DC    X'0000FF000000'      TV35+                                       
         DC    X'0000FF000000'      TV50+                                       
         DC    Y(IMPS),AL1(V2149),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V3564),X'00',Y(0)                                    
         DC    X'0000FF000000'      TW35+                                       
         DC    Y(IMPS),AL1(W2149),X'00',Y(0)                                    
         DC    X'0000FF000000'      TM35+                                       
         DC    Y(IMPS),AL1(M2149),X'00',Y(0)                                    
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8243 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(IMPS),AL1(W1849),X'00',Y(ATW1849-WORKD)                        
         DC    Y(IMPS),AL1(M1849),X'00',Y(ATM1849-WORKD)                        
         DC    Y(IMPS),AL1(W2549),X'00',Y(ATW2549-WORKD)                        
         DC    Y(IMPS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1834),X'00',Y(ATW1834-WORKD)                        
         DC    Y(IMPS),AL1(M1834),X'00',Y(ATM1834-WORKD)                        
         DC    Y(IMPS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1224),X'00',Y(ATW1224-WORKD)                        
         DC    Y(IMPS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V211),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8245 DC    F'100'                                                           
         DC    AL1(DIV)                                                         
         DC    X'00'                                                            
*                                                                               
         DC    Y(UNIVS),AL1(V299),X'00',Y(0)                                    
         DC    3X'0000FF000000'                                                 
         DC    Y(UNIVS),AL1(HOMES),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2564),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M2564),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2554),X'00',Y(AUW2554-WORKD)                       
         DC    Y(UNIVS),AL1(M2554),X'00',Y(AUM2554-WORKD)                       
         DC    Y(UNIVS),AL1(M1849),X'00',Y(AUM1849-WORKD)                       
         DC    Y(UNIVS),AL1(W1849),X'00',Y(AUW1849-WORKD)                       
         DC    Y(UNIVS),AL1(WWORK),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(METROA),X'00',Y(AUMETROA-WORKD)                     
         DC    Y(UNIVS),AL1(METROB),X'00',Y(AUMETROB-WORKD)                     
         DC    Y(UNIVS),AL1(V2149),X'00',Y(0) FEB/87 START                      
         DC    Y(UNIVS),AL1(W2149),X'00',Y(0) *                                 
         DC    Y(UNIVS),AL1(M2149),X'00',Y(0) *                                 
*                       FEB/88 START                                            
         DC    Y(UNIVS),AL1(V1834),X'00',Y(0) *                                 
         DC    Y(UNIVS),AL1(V1849),X'00',Y(0) *                                 
         DC    X'0000FF000000'                UV35+                             
         DC    X'0000FF000000'                UV50+                             
         DC    Y(UNIVS),AL1(V2554),X'00',Y(0) *                                 
         DC    Y(UNIVS),AL1(V3564),X'00',Y(0) *                                 
         DC    X'0000FF000000'                UW35+                             
         DC    X'0000FF000000'                UM35+                             
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8247 DC    F'100'                                                           
         DC    AL1(DIV)                                                         
         DC    X'00'                                                            
*                                                                               
         DC    Y(UNIVS),AL1(V1234),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2549),X'00',Y(AUW2549-WORKD)                       
         DC    Y(UNIVS),AL1(M2549),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1834),X'00',Y(AUW1834-WORKD)                       
         DC    Y(UNIVS),AL1(M1834),X'00',Y(AUM1834-WORKD)                       
         DC    Y(UNIVS),AL1(V1217),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1224),X'00',Y(AUW1224-WORKD)                       
         DC    Y(UNIVS),AL1(V1224),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V211),X'00',Y(0)                                    
         DC    Y(UNIVS),AL1(V611),X'00',Y(0)                                    
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8249 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(TOTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(V1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W2564),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M2564),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W2554),X'00',Y(AQW2554-WORKD)                        
         DC    Y(TOTS),AL1(M2554),X'00',Y(AQM2554-WORKD)                        
         DC    Y(TOTS),AL1(V1849),X'00',Y(0)                                    
*                       FEB/88 START                                            
         DC    X'0000FF000000'                QV35+                             
         DC    X'0000FF000000'                QV50+                             
         DC    Y(TOTS),AL1(V2149),X'00',Y(0) *                                  
         DC    Y(TOTS),AL1(V2554),X'00',Y(0) *                                  
         DC    Y(TOTS),AL1(V3564),X'00',Y(0) *                                  
         DC    X'0000FF000000'                QW35+                             
         DC    Y(TOTS),AL1(W2149),X'00',Y(0) *                                  
         DC    X'0000FF000000'                QM35+                             
         DC    Y(TOTS),AL1(M2149),X'00',Y(0) *                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8251 DC    F'10'                                                            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
*                                                                               
         DC    Y(TOTS),AL1(W1849),X'00',Y(AQW1849-WORKD)                        
         DC    Y(TOTS),AL1(M1849),X'00',Y(AQM1849-WORKD)                        
         DC    Y(TOTS),AL1(W2549),X'00',Y(AQW2549-WORKD)                        
         DC    Y(TOTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1834),X'00',Y(AQW1834-WORKD)                        
         DC    Y(TOTS),AL1(M1834),X'00',Y(AQM1834-WORKD)                        
         DC    Y(TOTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1224),X'00',Y(AQW1224-WORKD)                        
         DC    Y(TOTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8253 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(PUTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(METROA),X'00',Y(APMETROA-WORKD)                      
         DC    Y(PUTS),AL1(METROB),X'00',Y(APMETROB-WORKD)                      
         DC    Y(PUTS),AL1(V1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2564),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2564),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2554),X'00',Y(APW2554-WORKD)                        
         DC    Y(PUTS),AL1(M2554),X'00',Y(APW2554-WORKD)                        
         DC    Y(PUTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1849),X'00',Y(APW1849-WORKD)                        
         DC    Y(PUTS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2549),X'00',Y(APW2549-WORKD)                        
         DC    Y(PUTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1834),X'00',Y(APW1834-WORKD)                        
         DC    Y(PUTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V2149),X'00',Y(0)    START FEB/87                    
         DC    Y(PUTS),AL1(W2149),X'00',Y(0)    *                               
         DC    Y(PUTS),AL1(M2149),X'00',Y(0)    *                               
*                                               START FEB/88                    
         DC    Y(PUTS),AL1(V2554),AL1(TTABYPAS),Y(APV2554-WORKD)                
         DC    Y(PUTS),AL1(V3564),X'00',Y(0)                                    
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
APAV8255 DC    F'1'                                                             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
*                                                                               
         DC    Y(PUTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1224),X'00',Y(APW1224-WORKD)                        
         DC    Y(PUTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         EJECT                                                                  
***********************************************************************         
*                 MEDIAFAX                                                      
***********************************************************************         
                                                                                
*----------------------------------------------------------------------         
* MFEB96 - MDF TPT FEB96 ELEMS AND DISPS TO DEMO LIST                           
*       PUTS ARE TAKEN FROM 'M' ELEMENTS WHICH ARE 4-WK PUTS CALC               
*       IN CONVERSION PROGRAM.  PUTS IN 'P' ELEMS ARE PUT VALUES                
*       DEPENDENT ON NUMBER OF WEEKS PROGRAM RAN.                               
*----------------------------------------------------------------------         
*                                                                               
MFEB96   DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(MFEB9631-BASE),AL1(RATING)                             
         DC    X'35',AL3(0),AL1(0)                                              
         DC    X'37',AL3(0),AL1(0)                                              
         DC    X'41',AL3(MFEB9641-BASE),AL1(IMP)                                
         DC    X'45',AL3(MFEB9645-BASE),AL1(UNIVERSE)                           
         DC    X'49',AL3(MFEB9649-BASE),AL1(TOT)                                
         DC    X'53',AL3(MFEB9653-BASE),AL1(PUT)                                
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
*----------------------------------------------------------------------         
* TABLE OF MDF PAV (FEB96) ELEMS AND DISPS TO DEMO LIST                         
*----------------------------------------------------------------------         
*                                                                               
MPAV96   DS    0CL(ELEMTABL)                                                    
         DC    X'31',AL3(MPAV9631-BASE),AL1(RATING)                             
         DC    X'35',AL3(0),AL1(0)                                              
         DC    X'37',AL3(0),AL1(0)                                              
         DC    X'41',AL3(MPAV9641-BASE),AL1(IMP)                                
         DC    X'45',AL3(MPAV9645-BASE),AL1(UNIVERSE)                           
         DC    X'49',AL3(MPAV9649-BASE),AL1(TOT)                                
         DC    X'53',AL3(MPAV9653-BASE),AL1(PUT)                                
         DC    AL1(EOT)                                                         
         EJECT                                                                  
*---------------------------------------------------------------------*         
* MDF TPT DEMO LIST. 6-BYTE HDR ON EACH TABLE.                        *         
* HDR: FULL WORD PRECICION OPERAND, PREC ADJ OPERATION (DEFAULT=MULT) *         
*      SPACE BYTE.                                                    *         
* TBL: DEMO LIST W/DEMO TYPE, DEMO VALUE FOLLOWS HEADER.              *         
*      THE 4 BYTE ENTRY GIVES THE DISPLTO OUTPUT WORK SECTION - DISP  *         
*      IS NUMBER OF FULLWORDS INTO THE SECTION, AND A SPARE BYTE      *         
*---------------------------------------------------------------------*         
                                                                                
         DS    0F                                                               
MFEB9631 DC    F'1'                         X'31' ELEMENT = RATINGS             
         DC    AL1(0)                                                           
         DC    X'00'                                                            
         DC    Y(RATINGS),AL1(HOMES),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V299),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(V1224),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1234),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1899),X'00',Y(0)                                 
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(RATINGS),AL1(V3599),X'00',Y(0)                                 
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(RATINGS),AL1(V5099),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V2554),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1224),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2549),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2554),X'00',Y(0)                                 
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(RATINGS),AL1(W3599),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(WWORK),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M2549),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M2554),X'00',Y(0)                                 
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(RATINGS),AL1(M3599),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1217),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V211),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(V611),X'00',Y(0)                                  
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
MFEB9637 DC    F'1'                         X'37' ELEMENT = PUTS                
         DC    AL1(0)                                                           
         DC    X'00'                                                            
         DC    Y(PUTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1899),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(PUTS),AL1(V3599),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(PUTS),AL1(V5099),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(PUTS),AL1(W3599),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(PUTS),AL1(M3599),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
MFEB9641 DC    F'10'                         X'41' ELEMENT = TSA IMPS           
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
         DC    Y(IMPS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V299),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1899),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(IMPS),AL1(V3599),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(IMPS),AL1(V5099),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1224),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1849),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W2549),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(IMPS),AL1(W3599),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(IMPS),AL1(M3599),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V211),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         DS    0F                                                               
MFEB9645 DC    F'100'                         X'45' ELEMENT = UNIVERSES         
         DC    AL1(DIV)                                                         
         DC    X'00'                                                            
         DC    Y(UNIVS),AL1(HOMES),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V299),X'00',Y(0)                                    
         DC    Y(UNIVS),AL1(V1224),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1234),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1834),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1849),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1899),X'00',Y(0)                                   
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(UNIVS),AL1(V3599),X'00',Y(0)                                   
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(UNIVS),AL1(V5099),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V2554),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1224),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1834),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1849),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2549),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2554),X'00',Y(0)                                   
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(UNIVS),AL1(W3599),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(WWORK),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M1834),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M1849),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M2549),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M2554),X'00',Y(0)                                   
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(UNIVS),AL1(M3599),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1217),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V211),X'00',Y(0)                                    
         DC    Y(UNIVS),AL1(V611),X'00',Y(0)                                    
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
MFEB9649 DC    F'10'                           X'49' ELEMENT = TOTS             
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
         DC    Y(TOTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1899),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(TOTS),AL1(V3599),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(TOTS),AL1(V5099),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1224),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1849),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W2549),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(TOTS),AL1(W3599),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(TOTS),AL1(M3599),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
MFEB9653 DC    F'1'                          X'53' ELEMENT = PUTS               
         DC    AL1(0)                                                           
         DC    X'00'                                                            
         DC    Y(PUTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1899),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(PUTS),AL1(V3599),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(PUTS),AL1(V5099),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(PUTS),AL1(W3599),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(PUTS),AL1(M3599),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         EJECT                                                                  
*---------------------------------------------------------------------*         
* MDF PAV DEMO LISTS. 6-BYTE HDR ON EACH TABLE.                       *         
* HDR: FULL WORD PRECICION OPERAND, PREC ADJ OPERATION (DEFAULT=MULT) *         
*      SPACE BYTE.                                                    *         
* TBL: DEMO LIST W/DEMO TYPE, DEMO VALUE FOLLOWS HEADER.              *         
*      THE 4 BYTE ENTRY GIVES THE DISPLTO OUTPUT WORK SECTION - DISP  *         
*      IS NUMBER OF FULLWORDS INTO THE SECTION, AND A SPARE BYTE      *         
*---------------------------------------------------------------------*         
         SPACE                                                                  
         DS    0F                                                               
MPAV9631 DC    F'1'                             X'31' ELEMENT = RTGS            
         DC    AL1(0)                                                           
         DC    X'00'                                                            
         DC    Y(RATINGS),AL1(HOMES),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V299),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(V1224),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1234),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1899),X'00',Y(0)                                 
         DC    X'0000FF000000'                    V35+ IUN N/A                  
*        DC    Y(RATINGS),AL1(V3599),X'00',Y(0)                                 
         DC    X'0000FF000000'                    V50+ IUN N/A                  
*        DC    Y(RATINGS),AL1(V5099),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V2554),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1224),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2549),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(W2554),X'00',Y(0)                                 
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(RATINGS),AL1(W3599),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(WWORK),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M1834),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M1849),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M1899),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M2549),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(M2554),X'00',Y(0)                                 
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(RATINGS),AL1(M3599),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V1217),X'00',Y(0)                                 
         DC    Y(RATINGS),AL1(V211),X'00',Y(0)                                  
         DC    Y(RATINGS),AL1(V611),X'00',Y(0)                                  
         DC    AL1(EOT)                                                         
*                                                                               
         DS    0F                                                               
MPAV9641 DC    F'10'                            X'41' ELEMENT = IMPS            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
         DC    Y(IMPS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V299),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1899),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(IMPS),AL1(V3599),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(IMPS),AL1(V5099),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1224),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1849),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W2549),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(W2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(IMPS),AL1(W3599),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(M2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(IMPS),AL1(M3599),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(IMPS),AL1(V211),X'00',Y(0)                                     
         DC    Y(IMPS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
MPAV9645 DC    F'100'                           X'45' ELEMENT = UNIVS           
         DC    AL1(DIV)                                                         
         DC    X'00'                                                            
         DC    Y(UNIVS),AL1(HOMES),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V299),X'00',Y(0)                                    
         DC    Y(UNIVS),AL1(V1224),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1234),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1834),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1849),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1899),X'00',Y(0)                                   
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(UNIVS),AL1(V3599),X'00',Y(0)                                   
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(UNIVS),AL1(V5099),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V2554),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1224),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1834),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1849),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2549),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(W2554),X'00',Y(0)                                   
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(UNIVS),AL1(W3599),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(WWORK),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M1834),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M1849),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M1899),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M2549),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(M2554),X'00',Y(0)                                   
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(UNIVS),AL1(M3599),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V1217),X'00',Y(0)                                   
         DC    Y(UNIVS),AL1(V211),X'00',Y(0)                                    
         DC    Y(UNIVS),AL1(V611),X'00',Y(0)                                    
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
MPAV9649 DC    F'10'                            X'49' ELEMENT = TOTS            
         DC    AL1(MULT)                                                        
         DC    X'00'                                                            
         DC    Y(TOTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1899),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(TOTS),AL1(V3599),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(TOTS),AL1(V5099),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1224),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1849),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W2549),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(W2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(TOTS),AL1(W3599),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(M2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(TOTS),AL1(M3599),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(TOTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(TOTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         SPACE 2                                                                
         DS    0F                                                               
MPAV9653 DC    F'1'                             X'53' ELEMENT = PUTS            
         DC    AL1(0)                                                           
         DC    X'00'                                                            
         DC    Y(PUTS),AL1(HOMES),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V299),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1234),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1899),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V35+ IUN N/A                   
*        DC    Y(PUTS),AL1(V3599),X'00',Y(0)                                    
         DC    X'0000FF000000'                   V50+ IUN N/A                   
*        DC    Y(PUTS),AL1(V5099),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V2554),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1224),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(W2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   W35+ IUN N/A                   
*        DC    Y(PUTS),AL1(W3599),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(WWORK),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1834),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1849),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M1899),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2549),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(M2554),X'00',Y(0)                                    
         DC    X'0000FF000000'                   M35+ IUN N/A                   
*        DC    Y(PUTS),AL1(M3599),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V1217),X'00',Y(0)                                    
         DC    Y(PUTS),AL1(V211),X'00',Y(0)                                     
         DC    Y(PUTS),AL1(V611),X'00',Y(0)                                     
         DC    AL1(EOT)                                                         
         EJECT                                                                  
* EQUATES FOR DISPLACEMENTS OF DEMOS IN IUN WORK AREA                           
*                                                                               
UNIVS    EQU   0                                                                
RATINGS  EQU   IUNDEMS*4*1                                                      
IMPS     EQU   IUNDEMS*4*2                                                      
PUTS     EQU   IUNDEMS*4*3                                                      
TOTS     EQU   IUNDEMS*4*4                                                      
NEWRTGS  EQU   IUNDEMS*4*5                                                      
NEWIMPS  EQU   IUNDEMS*4*6                                                      
NEWPUTS  EQU   IUNDEMS*4*7                                                      
NEWTOTS  EQU   IUNDEMS*4*8                                                      
SHRS     EQU   IUNDEMS*4*9                                                      
         SPACE 2                                                                
* EQUATES FOR FULLWORD DISPLACEMENTS INTO SECTION OF WORK AREA                  
*                                                                               
V299     EQU   00                                                               
V1899    EQU   01                                                               
V1234    EQU   02                                                               
V1224    EQU   03                                                               
V1217    EQU   04                                                               
V611     EQU   05                                                               
V211     EQU   06                                                               
W1899    EQU   07                                                               
W1834    EQU   08                                                               
W1849    EQU   09                                                               
W2549    EQU   10                                                               
W2554    EQU   11                                                               
W1224    EQU   12                                                               
W2564    EQU   13                                                               
W1234    EQU   14                                                               
M1899    EQU   15                                                               
M1834    EQU   16                                                               
M1849    EQU   17                                                               
M2554    EQU   18                                                               
M2564    EQU   19                                                               
HOMES    EQU   20                                                               
METROA   EQU   21                                                               
METROB   EQU   22                                                               
WWORK    EQU   23                                                               
M2549    EQU   24                                                               
V1849    EQU   25                                                               
V1834    EQU   26                                                               
V2554    EQU   27                                                               
V2149    EQU   28                                                               
W2149    EQU   29                                                               
M2149    EQU   30                                                               
V3564    EQU   31                                                               
*                                                                               
         EJECT                                                                  
SUBR01   NMOD1 0,**SR01**,RA,RR=RE                                              
         L     RC,0(R1)                                                         
         USING WORKD,RC                                                         
         ST    RE,RELO1                                                         
         ST    RB,MYBASE01                                                      
         L     R1,0(R1)                                                         
         SRL   R1,24                                                            
         SLL   R1,2                                                             
         LA    RF,*+2(R1)                                                       
         BR    RF                                                               
PROCELE  EQU   (PROCEL#-*)/4+1                                                  
TTADEME  EQU   (TTADEM#-*)/4+1                                                  
NETDEME  EQU   (NETDEM#-*)/4+1                                                  
*                                                                               
PROCEL#  B     PROCEL              ARB/MFX PROCESS ELEMENTS                     
TTADEM#  B     TTADEMO             ARB DEMOS                                    
NETDEM#  B     NETWORK             NETWORK: NHTI FILE DEMOS                     
         SPACE 2                                                                
XITS1    XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
TTADEMO  SR    R0,R0                                                            
TTADEMA  CLI   0(R6),X'20'         TEST FOR CURRENT QUARTER HOUR                
         BE    TTADEM1                                                          
         BH    TTADEM1E                                                         
         IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO NEXT DEMO ELEMENT                    
         B     TTADEMA                                                          
*                                                                               
TTADEM1  IC    R0,1(R6)                                                         
         AR    R6,R0               BUMP TO NEXT DEMO ELEMENT                    
         CLI   0(R6),X'00'         TEST FOR EOR                                 
         BE    TTADEMX                                                          
         CLI   0(R6),X'20'         TEST FOR NEXT QUARTER HOUR                   
         BE    TTADEMX                                                          
TTADEM1E CLI   0(R6),X'30'         TEST START OF DEMO ELEMENTS FOR              
         BL    TTADEM1             THIS QUARTER HOUR                            
*                                                                               
TTADEM2  CLI   0(R6),0             TEST FOR EOR                                 
         BE    TTADEM10                                                         
         CLI   ELEMNUM,EOT         TEST END OF ELEMENT TABLE                    
         BE    TTADEM10                                                         
         CLC   0(1,R6),ELEMNUM     TEST ELEMENT CODE MATCHES TABLE              
         BNE   TTADEM9             NO BUMP TO NEXT TABLE ENTRY                  
*                                                                               
TTADEM3  MVC   DEMOTYPE,ELEMTYPE   EXTRACT ELEMENT DEMO TYPE                    
         NC    DEMOTYPE,ELEMMASK   'AND' DEMO TYPE MASK INTO IT                 
         BZ    TTADEM8             NOT A DEMO TYPE WE WANT                      
         SR    R5,R5                                                            
         ICM   R5,7,ELEMDISP       GET DISP TO ELEMENT DEMO LIST                
         A     R5,RELO             RELOCATE TABLE ADDRESS                       
*                                                                               
TTADEM4  MVC   TABHEAD,0(R5)       SAVE TABLE HEADER                            
         LA    R5,HEADLEN(R5)      AND BUMP R5 PAST IT                          
         USING TTALISTD,R5                                                      
         LR    R1,R6               R1=A(DEMO ELEMENT)                           
         TM    2(R6),X'80'         TEST IF DUPLICATE DEMO ELEMENT               
         BZ    TTADEM6             NO                                           
         ICM   RE,3,2(R6)          YES                                          
         SLL   RE,17               SHIFT OFF X'80' BIT                          
         SRL   RE,17               RE=DISP INTO DEMO RECORD                     
         L     R1,DBAREC                                                        
         LA    R1,0(RE,R1)                                                      
*                                                                               
*TADEM6  BAS   RE,PROCEL           PROCESS DEMO ELEMENT                         
TTADEM6  ST    R1,DMCB+4           NEED TO SAVE R1                              
         GOTO1 VSUBR01,DMCB,('PROCELE',(RC))                                    
*                                                                               
TTADEM8  IC    R0,1(R6)                                                         
         AR    R6,R0                                                            
*                                                                               
TTADEM9  LA    R4,ELEMTABL(R4)     NEXT ELEMENT TABLE ENTRY                     
         B     TTADEM2                                                          
         EJECT                                                                  
* CALCULATE IUN BASIC CELLS MISSING FROM TIME PERIOD RECORD                     
*                                                                               
TTADEM10 LA    R8,5                R8=5                                         
         LA    R9,10               R9=10                                        
         LA    RE,500              RE=500                                       
         LA    RF,1000             RF=1000                                      
         CLC   BOOK,=X'5802'       PRIOR TO FEB/88                              
         BNL   TTADEM12                                                         
         XC    ARV2554,ARV2554     CALCULATE V2554 RTG AND PUT                  
         XC    APV2554,APV2554     VALUES ARE NOT IN BOOK                       
*                                                                               
TTADEM12 LM    R5,R7,ARMETROA      R5=RMETA, R6=PMETA, R7=UMETA                 
         TM    ELEMMASK,IMP        TEST IMPRESSIONS REQUIRED                    
         BZ    TTADEM13            NO                                           
*                                                                               
         MR    R4,R7               TMETA=RMETA*UMETA+500/1000                   
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         ST    R5,METROA*4+IIMPS                                                
*                                                                               
TTADEM13 TM    ELEMMASK,TOT        TEST TSA TOTALS NEEDED                       
         BZ    TTADEM14            NO                                           
*                                                                               
         MR    R6,R6               QMETA=PMETA*UMETA+500/1000                   
         AR    R7,RE                                                            
         DR    R6,RF                                                            
         ST    R7,METROA*4+ITOTS                                                
*                                                                               
TTADEM14 LM    R5,R7,ARMETROB      R5=RMETB, R6=PMETB, R7=UMETB                 
         TM    ELEMMASK,IMP        TEST IMPRESSIONS NEEDED                      
         BZ    TTADEM15            NO                                           
*                                                                               
         MR    R4,R7               TMETB=RMETB*UMETB+500/1000                   
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         ST    R5,METROB*4+IIMPS                                                
*                                                                               
TTADEM15 TM    ELEMMASK,TOT        TEST TSA TOTALS REQUIRED                     
         BZ    TTADEM16            NO                                           
*                                                                               
         MR    R6,R6               QMETB=PMETB*UMETB+500/1000                   
         AR    R7,RE                                                            
         DR    R6,RF                                                            
         ST    R7,METROB*4+ITOTS                                                
*                                                                               
TTADEM16 TM    ELEMMASK,UNIVERSE                                                
         BZ    TTADEM17                                                         
*                                                                               
         LM    R6,R7,AUW1834       R6=UW1834, R7=UW1849                         
         LM    R4,R5,AUM1834       R4=UM1834, R5=UM1849                         
         AR    R6,R4               UV1834=UW1834+UM1834                         
         AR    R7,R5               UV1849=UW1849+UM1849                         
         LR    R5,R6               MOVE UV1834 TO R5                            
*                                                                               
         SR    R4,R4               PREPARE DIVIDEND                             
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
         ST    R5,V1834*4+IUNIVS                                                
*                                                                               
         SR    R6,R6                                                            
         AR    R7,R8               +5                                           
         DR    R6,R9               /10                                          
         MR    R6,R9               *10                                          
         ST    R7,V1849*4+IUNIVS                                                
*                                                                               
         LM    R4,R5,AUW2554                                                    
         AR    R5,R4               UV2554=UW2554+UM2554                         
         SR    R4,R4                                                            
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
         ST    R5,V2554*4+IUNIVS                                                
*                                                                               
TTADEM17 TM    ELEMMASK,UNIVERSE+RATING+PUT                                     
         BZ    TTADEM18                                                         
*                                                                               
         SR    R4,R4                                                            
         L     R5,AUW1224          R5=UW1224                                    
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
*                                                                               
         SR    R6,R6                                                            
         L     R7,AUW1834          R7=UW1834                                    
         AR    R7,R8               +5                                           
         DR    R6,R9               /10                                          
         MR    R6,R9               *10                                          
*                                                                               
         AR    R7,R5               UW1224+UW1834                                
*                                                                               
         SR    R4,R4                                                            
         L     R5,AUW2549          R5=UW2549                                    
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
*                                                                               
         AR    R7,R5               UW1224+UW1834+UW2549                         
*                                                                               
         SR    R4,R4                                                            
         L     R5,AUW1849          R5=UW1849                                    
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
*                                                                               
         SR    R7,R5               UW1234=UW1224+UW1834+UW2549-UW1849           
*                                                                               
         ST    R7,AUW1234                                                       
         ST    R7,W1234*4+IUNIVS                                                
*                                                                               
TTADEM18 TM    ELEMMASK,IMP                                                     
         BZ    TTADEM20                                                         
*                                                                               
         LM    R4,R7,ATW1224       COMPUTE TW1234                               
         AR    R4,R5               TW1224+TW1834                                
         AR    R4,R7               +TW2549                                      
         SR    R4,R6               -TW1849                                      
         BNM   *+6                                                              
         SR    R4,R4               FORCE NEGATIVE RESULT TO ZERO                
         ST    R4,W1234*4+IIMPS                                                 
*                                                                               
TTADEM20 TM    ELEMMASK,TOT                                                     
         BZ    TTADEM22                                                         
*                                                                               
         LM    R4,R7,AQW1224       COMPUTE QW1234                               
         AR    R4,R5               QW1224+QW1834                                
         AR    R4,R7               +QW2549                                      
         SR    R4,R6               -QW1849                                      
         BNM   *+6                                                              
         SR    R4,R4               FORCE NEGATIVE RESULT TO ZERO                
         ST    R4,W1234*4+ITOTS                                                 
*                                                                               
TTADEM22 TM    ELEMMASK,RATING                                                  
         BZ    TTADEM24                                                         
*                                                                               
         L     R5,ARW1224          AW1224=RW1224*UW1224+500/1000                
         M     R4,AUW1224                                                       
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         LR    R7,R5               COMPUTE AW1234 IN R7                         
*                                                                               
         L     R5,ARW1834                                                       
         M     R4,AUW1834                                                       
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         AR    R7,R5                                                            
*                                                                               
         L     R5,ARW2549                                                       
         M     R4,AUW2549                                                       
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         AR    R7,R5                                                            
*                                                                               
         L     R5,ARW1849                                                       
         M     R4,AUW1849                                                       
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         SR    R7,R5               R7=AW1234                                    
         BP    *+10                                                             
         SR    R7,R7               FORCE NEGATIVE RESULT TO ZERO                
         B     TTADEM23                                                         
*                                                                               
         MR    R6,RF               SCALE TO 3 DECIMAL PLACES (*1000)            
         ICM   R0,15,AUW1234       R0=DIVISOR                                   
         BNZ   *+10                                                             
         SR    R7,R7                                                            
         B     TTADEM23                                                         
*                                                                               
         DR    R6,R0               AW1234/UW1234                                
         SR    R6,R6                                                            
         CLI   FILTYP,C'P'                                                      
         BE    *+10                                                             
         AR    R7,R8               ROUND TO TWO DECIMAL PLACES BY +5            
         DR    R6,R9               /10                                          
         MR    R6,R9               *10                                          
*                                                                               
TTADEM23 ST    R7,W1234*4+IRATINGS                                              
*                                                                               
         L     R5,ARW2554                                                       
         M     R4,AUW2554          AW2554=RW2554*UW2554                         
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         L     R7,ARM2554                                                       
         M     R6,AUM2554                                                       
         AR    R7,RE               +500                                         
         DR    R6,RF               /1000                                        
         AR    R5,R7               AV2554=AW2554+AM2554                         
*                                                                               
         MR    R4,RF               *1000 FOR SCALING                            
         ICM   R6,15,V2554*4+IUNIVS                                             
         BNZ   *+14                                                             
         SR    R5,R5                                                            
         ST    R5,V2554*4+IRATINGS                                              
         B     TTADEM24                                                         
*                                                                               
         DR    R4,R6               AV2554/UV2554                                
         SR    R4,R4               ROUND TO TWO DECIMALS                        
         OC    ARV2554,ARV2554     USE TAPE DEMOS IF PRESENT                    
         BZ    *+8                                                              
         L     R5,ARV2554                                                       
         CLI   FILTYP,C'P'                                                      
         BE    *+10                                                             
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
         ST    R5,V2554*4+IRATINGS                                              
*                                                                               
TTADEM24 TM    ELEMMASK,PUT                                                     
         BZ    TTADEM26                                                         
*                                                                               
         L     R5,APW1224          WW1224=PW1224*UW1224+500/1000                
         M     R4,AUW1224                                                       
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         LR    R7,R5               COMPUTE WW1234 IN R7                         
*                                                                               
         L     R5,APW1834                                                       
         M     R4,AUW1834                                                       
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         AR    R7,R5                                                            
*                                                                               
         L     R5,APW2549                                                       
         M     R4,AUW2549                                                       
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         AR    R7,R5                                                            
*                                                                               
         L     R5,APW1849                                                       
         M     R4,AUW1849                                                       
         AR    R5,RE                                                            
         DR    R4,RF                                                            
         SR    R7,R5               R7=WW1234                                    
         BP    *+10                                                             
         SR    R7,R7               FORCE NEGATIVE RESULT TO ZERO                
         B     TTADEM25                                                         
*                                                                               
         MR    R6,RF               SCALE TO 3 DECIMAL PLACES (*1000)            
         ICM   R0,15,AUW1234       R0=DIVISOR                                   
         BNZ   *+10                                                             
         SR    R7,R7               ZERO DIVISOR-SET RESULT TO ZERO              
         B     TTADEM25                                                         
*                                                                               
         DR    R6,R0               WW1234/UW1234                                
         SR    R6,R6                                                            
         CLI   FILTYP,C'P'                                                      
         BE    *+10                                                             
         AR    R7,R8               ROUND TO TWO DECIMAL PLACES BY +5            
         DR    R6,R9               /10                                          
         MR    R6,R9               *10                                          
*                                                                               
TTADEM25 ST    R7,W1234*4+IPUTS                                                 
*                                                                               
         L     R5,APW2554                                                       
         M     R4,AUW2554          WW2554=PW2554*UW2554                         
         AR    R5,RE               +500                                         
         DR    R4,RF               /1000                                        
         L     R7,APM2554                                                       
         M     R6,AUM2554                                                       
         AR    R7,RE               +500                                         
         DR    R6,RF               /1000                                        
         AR    R5,R7               WV2554=WW2554+WM2554                         
*                                                                               
         MR    R4,RF               *1000 FOR SCALING                            
         ICM   R6,15,V2554*4+IUNIVS                                             
         BNZ   *+14                                                             
         SR    R5,R5                                                            
         ST    R5,V2554*4+IPUTS                                                 
         B     TTADEM26                                                         
*                                                                               
         DR    R4,R6               WV2554/UV2554                                
         SR    R4,R4               ROUND TO TWO DECIMALS                        
         OC    APV2554,APV2554     USE TAPE DEMOS IF PRESENT                    
         BZ    *+8                                                              
         L     R5,APV2554                                                       
         CLI   FILTYP,C'P'                                                      
         BE    *+10                                                             
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
         ST    R5,V2554*4+IPUTS                                                 
*                                                                               
TTADEM26 TM    ELEMMASK,IMP                                                     
         BZ    TTADEM28                                                         
*                                                                               
         LM    R6,R7,ATW1834       R6=TW1834, R7=TW1849                         
         LM    R4,R5,ATM1834       R4=TM1834, R5=TM1849                         
         AR    R6,R4               TV1834=TW1834+TM1834                         
         AR    R7,R5               TV1849=TW1849+TM1849                         
         LR    R5,R6               MOVE TV1834 TO R5                            
*                                                                               
         SR    R4,R4               PREPARE DIVIDEND                             
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
         ST    R5,V1834*4+IIMPS                                                 
*                                                                               
         SR    R6,R6                                                            
         AR    R7,R8               +5                                           
         DR    R6,R9               /10                                          
         MR    R6,R9               *10                                          
         ST    R7,V1849*4+IIMPS                                                 
*                                                                               
         LM    R4,R5,ATW2554       R4=TW2554,R5=TM2554                          
         AR    R5,R4               R5=TV2554                                    
         SR    R4,R4                                                            
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
         ST    R5,V2554*4+IIMPS                                                 
*                                                                               
TTADEM28 TM    ELEMMASK,TOT                                                     
         BZ    TTADEM30                                                         
*                                                                               
         LM    R6,R7,AQW1834       R6=QW1834, R7=QW1849                         
         LM    R4,R5,AQM1834       R4=QM1834, R5=QM1849                         
         AR    R6,R4               QV1834=QW1834+QM1834                         
         AR    R7,R5               QV1849=QW1849+QM1849                         
         LR    R5,R6               MOVE QV1834 TO R5                            
*                                                                               
         SR    R4,R4               PREPARE DIVIDEND                             
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
         ST    R5,V1834*4+ITOTS                                                 
*                                                                               
         SR    R6,R6                                                            
         AR    R7,R8               +5                                           
         DR    R6,R9               /10                                          
         MR    R6,R9               *10                                          
         ST    R7,V1849*4+ITOTS                                                 
*                                                                               
         LM    R4,R5,AQW2554       R4=QW2554,R5=QM2554                          
         AR    R5,R4               R5=QV2554                                    
         SR    R4,R4                                                            
         AR    R5,R8               +5                                           
         DR    R4,R9               /10                                          
         MR    R4,R9               *10                                          
         ST    R5,V2554*4+ITOTS                                                 
         SPACE 2                                                                
* MOVE OUT IUN VALUES INTO WORK AREA                                            
*                                                                               
*                                                                               
TTADEM30 CLI   CALLTYPE,2          TEST PUTS/TOTS ONLY                          
         BE    TTADEM32                                                         
         MVC   UNIVS(IUNDEMS*4,R3),IUNIVS                                       
         MVC   RATINGS(IUNDEMS*4,R3),IRATINGS                                   
         MVC   IMPS(IUNDEMS*4,R3),IIMPS                                         
         CLI   CALLTYPE,1          TEST RATINGS/IMPS ONLY                       
         BE    TTADEMX             YES                                          
         MVC   PUTS(IUNDEMS*4,R3),IPUTS                                         
         MVC   TOTS(IUNDEMS*4,R3),ITOTS                                         
         B     TTADEMX                                                          
*                                                                               
TTADEM32 MVC   0(IUNDEMS*4,R3),IPUTS                                            
         MVC   IUNDEMS*4(IUNDEMS*4,R3),ITOTS                                    
*                                                                               
TTADEMX  B     XITS1                                                            
         EJECT                                                                  
*********************************************************************           
* SUB-ROUTINE TO PROCESS DEMO ELEMENT AGAINST LIST TABLE FOR ELEMENT*           
*                                                                   *           
* AT ENTRY, R5=A(DEMO ELEMENT LIST TABLE), R1=A(DEMO ELEMENT)       *           
*                                                                   *           
* REGISTER CONVENTIONS FOR SUB-ROUTINE                              *           
*                                                                   *           
* R0=WORK REGISTER                                                  *           
* R1=PARM VALUE-THEN WORK REGISTER                                  *           
* R2=A(DBLOCK)                                                      *           
* R3=A(OUTPUT AREA)                                                 *           
* R4=PRECISION ADJUSTMENT OPERAND FOR ELEMENT                       *           
* R5=A(DEMO LIST ENTRIES)                                           *           
* R6=DEMO ELEMENT POINTER                                           *           
* R7=DEMO VALUE FIELD POINTER - BXLE INDEX REGISTER                 *           
* R8=DEMO VALUE FIELD LENGTH  - BXLE INCREMENT REGISTER             *           
* R9=A(END OF DEMO ELEMENT)   - BXLE LIMIT REGISTER                 *           
* RE=WORK REGISTER FOR ARITHMETIC                                   *           
* RF=DEMO VALUE REGISTER                                            *           
*                                                                   *           
*********************************************************************           
*                                                                               
         USING TTALISTD,R5                                                      
PROCEL   DS    0C                                                               
         L     R1,DMCB+4                                                        
         LR    R6,R1               TRANSFER DEMO ELEMENT POINTER TO R6          
         L     R4,ADJOP            R4=PRECISION ADJUSTMENT OPERAND              
         ZIC   R9,1(R6)            GET ELEMENT LENGTH                           
         LA    R9,0(R6,R9)         POINT PAST ELEMENT                           
         BCTR  R9,0                BACK UP TO LAST BYTE-BXLE LIMIT              
         TM    0(R6),X'01'         TEST FOR ODD ELEMENT CODE                    
         BO    PROCEL1             YES                                          
*                                                                               
         LA    R8,1                EVEN CODE MEANS L'DEMO ENTRY=1               
         LA    R7,2(R6)            AND DO NOT HAVE CONTROL BYTE                 
         MVI   EXPAND+3,10         ALL VALUES MUST BE MULTPLD BY 10             
         B     PROCEL2                                                          
*                                                                               
PROCEL1  IC    R8,2(R6)                                                         
         SLL   R8,28                                                            
         SRL   R8,28               ISOLATE FIELD LENGTH-BXLE INCREMENT          
         LA    R7,3(R6)            R7=INDEX REGISTER FOR BXLE                   
         MVI   EXPAND+3,1          SET MULTIPLIER FOR ALL VALUES                
         TM    2(R6),X'40'         TEST FOR X 10 MULTIPLICATION                 
         BO    *+8                 NO                                           
         MVI   EXPAND+3,10         YES                                          
*                                                                               
PROCEL2  CLI   TTADISPS,EOT        TEST END OF DEMO LIST FOR ELEM               
         BE    PROCELX             YES                                          
         CLI   TTADISPV,X'FF'      TEST IF FIELD NOT RELEVANT                   
         BE    PROCEL12            YES-NEXT FIELD                               
         SR    RF,RF               RF=VALUE                                     
         TM    0(R6),X'01'         TEST EVEN ELEMENT CODE                       
         BZ    PROCEL3             YES-VALUE IS ALWAYS POSITIVE                 
         TM    2(R6),X'20'         TEST NEGATIVE VALUES PRESENT                 
         BZ    *+14                                                             
         TM    0(R7),X'80'         TEST SIGN BIT ON IN FIELD                    
         BZ    *+6                                                              
         LCR   RF,RF               SET VALUE TO ALL EFFS                        
*                                                                               
PROCEL3  LARL  RE,ICMMASK                                                       
         IC    R1,0(R8,RE)         USE FIELD LENGTH AS TABLE INDEX              
         EX    R1,*+8                                                           
         B     *+8                                                              
         ICM   RF,0,0(R7)          GET VALUE INTO RF                            
         M     RE,EXPAND                                                        
*                                                                               
PROCEL4  CLI   ADJTYPE,DIV         TEST TO DIVIDE FOR PRECISION ADJ             
         BE    PROCEL5             YES                                          
         MR    RE,R4               ELSE MULTIPLY BY SCALING OPERAND             
         B     PROCEL6             IF PRESENT                                   
*                                                                               
PROCEL5  SLDA  RE,1                X 2                                          
         DR    RE,R4               DIVIDE BY ADJUSTMENT OPERAND                 
         LTR   RF,RF                                                            
         BM    *+8                                                              
         AH    RF,=H'1'                                                         
         SRA   RF,1                                                             
*                                                                               
PROCEL6  LA    R1,IUNVALS          R1=A(IUN VALUE AREA)                         
         AH    R1,TTADISPS         DISP TO WORKING STORAGE SECTION              
         ZIC   R0,TTADISPV         GET DISP IN FULLWORDS                        
         SLL   R0,2                X 4                                          
         AR    R1,R0               R1=A(VALUE POSITION)                         
*                                                                               
PROCEL8  CLI   DEMOTYPE,UNIVERSE   TEST FOR UNIVERSES                           
         BNE   PROCEL9             NO                                           
*                                                                               
         LH    RE,TTASVDSP         GET DISP INTO WORK AREA                      
         LTR   RE,RE               TEST IF SAVING VALUE                         
         BZ    PROCEL10            NO                                           
         LA    RE,WORKD(RE)                                                     
         ST    RF,0(RE)            SAVE UNIVERSE VALUE                          
         B     PROCEL10                                                         
*                                                                               
PROCEL9  TM    DEMOTYPE,RATING+PUT ROUND RATINGS AND PUTS                       
         BZ    PROCEL9A                                                         
         M     RE,=F'1'            PREPARE DIVIDEND                             
         CLI   FILTYP,C'P'                                                      
         BE    PROCEL9A                                                         
         AH    RF,=H'5'            ROUND THE VALUE                              
         D     RE,=F'10'                                                        
         M     RE,=F'10'                                                        
*                                                                               
PROCEL9A LH    RE,TTASVDSP         GET DISP INTO WORKING STORAGE                
         LTR   RE,RE               TEST IF SAVING VALUE                         
         BZ    *+12                NO                                           
         LA    RE,WORKD(RE)        RE=A(SAVE POSITION)                          
         ST    RF,0(RE)                                                         
*                                                                               
PROCEL10 TM    TTACNTRL,TTABYPAS   SKIP WORK AREA STORE FOR NOW                 
         BO    PROCEL12                                                         
         ST    RF,0(R1)            SET WORK AREA VALUE                          
*                                                                               
PROCEL12 LA    R5,TTALISTL(R5)     NEXT DEMO LIST ENTRY                         
         BXLE  R7,R8,PROCEL2                                                    
PROCELX  DS    0H                                                               
         B     XITS1                                                            
         DS    0H                                                               
*                                                                               
*********************************************************************           
*NETWORK  - CONVERT NETWORK FILES INTO IUN FORMAT                               
*********************************************************************           
*                                                                               
NETWORK  DS    0C                                                               
         OC    DBCOMFCS,DBCOMFCS                                                
         BZ    NET_NX              ERROR -> NEED A(COMFACS)                     
*                                                                               
NET15    MVC   DEMOLST(NETDEMSQ),NETDEMS     MOVE IN DEMO NUMBERS               
         LA    R5,NETMDF           MODIFIERS                                    
         CLC   DBSELSRC,0(R5)                                                   
         BE    NET20                                                            
         LA    R5,L'NETMDF(R5)                                                  
         CLI   0(R5),X'FF'                                                      
         BNE   *-18                                                             
         MVI   DBERROR,4           INVALID SOURCE                               
         B     NETX                                                             
*                                                                               
NET20    LA    R1,IUNDEMS          BUILD DEMOLIST                               
         LA    RE,DEMOLST                                                       
*                                                                               
NET22    DS    0H                                                               
         MVI   0(RE),0                                                          
         MVC   1(1,RE),1(R5)       SET MODIFIER                                 
         LA    RE,3(RE)                                                         
         BCT   R1,NET22                                                         
         CLC   0(2,R5),=C'KZ'                                                   
         BNE   *+12                                                             
         LA    RE,3*HOMES+DEMOLST  PT TO HOMES P1 BUCKET                        
         MVI   1(RE),C'P'          LK UP P1 NOT Z1                              
         LH    R6,2(R5)            GET A(WHERE TO SAVE DEMS)                    
         LA    R6,WORKD(R6)                                                     
*                                                                               
         MVC   DUB(5),DBACTSTA                                                  
         OC    DBACTSTA,DBACTSTA                                                
         BNZ   *+10                                                             
         MVC   DUB(5),DBSELSTA                                                  
         CLC   DUB(3),=C'HUT'      HUT-RECORD ONLY HAS PUT DATA                 
         BNE   NET24                                                            
         CLC   0(2,R5),=C'HZ'      NHT FILE/ PUT LOOK UP                        
         BE    NET27               BYPASS ALTOGETHER --> NOT THERE              
*                                                                               
NET24    MVC   HALF,DBACTBK                                                     
         L     RF,DBCOMFCS                                                      
         USING COMFACSD,RF                                                      
         GOTO1 CDEMOUT,DMCB,(C'L',DEMOLST),DBLOCKD,(R6)                         
         MVC   DBACTBK,HALF                                                     
         CLI   DBERROR,0                                                        
         BNE   NETX                                                             
NET27    LA    R5,L'NETMDF(R5)     PROCESS NEXT MODIFIERS DEMOS                 
         CLC   DBSELSRC,0(R5)                                                   
         BE    NET20                                                            
         DROP  RF                                                               
         MVC   DUB(5),DBACTSTA                                                  
         OC    DBACTSTA,DBACTSTA                                                
         BNZ   *+10                                                             
         MVC   DUB(5),DBSELSTA                                                  
         CLC   DUB(3),=C'HUT'                                                   
         BNE   *+10                                                             
         MVC   IPUTS(IUNDEMS*4),IIMPS                                           
*                                                                               
         MVC   IRATINGS(IUNDEMS*4),IIMPS                                        
         CLI   DMAIMP,C'I'         RTG BASED, CALC RTG                          
         BNE   NET28                                                            
         CLI   DBSELSRC,C'K'       NTI PKT PC FILE?                             
         BNE   NET40                                                            
         LA    R6,4*HOMES+IPUTS    P1 IS A PERCENT, ADJUST TO RAW VALUE         
         ICM   R1,15,0(R6)                                                      
         L     RF,4*HOMES+IUNIVS   HOMES UNIVERSE                               
         MH    RF,=H'10'           UNIVS * 10                                   
         SR    RE,RE                                                            
         MR    RE,R1               P1 * (UNIVS*10) = HOMES USAGE                
         STCM  RF,15,0(R6)                                                      
         B     NET40               LEAVE 'RTGS' IN IMPR BASE                    
*                                                                               
NET28    LA    R0,IUNDEMS          R0=LOOP COUNTER                              
         LA    R6,0                                                             
NET30    L     RF,IUNIVS(R6)       GET UNIVS                                    
         L     R5,IIMPS(R6)        GET IMPS                                     
         LTR   RF,RF                                                            
         BNZ   *+16                                                             
         ST    RF,IRATINGS(R6)                                                  
         ST    RF,IPUTS(R6)                                                     
         B     NET33               AVOID DIVIDE BY ZERO                         
         SR    R4,R4                                                            
         DR    R4,RF               IMPS/UNIVS                                   
         SR    R4,R4                                                            
         AH    R5,=H'5'            +5                                           
         D     R4,=F'10'           /10                                          
         ST    R5,IRATINGS(R6)                                                  
         L     R5,IPUTS(R6)        GET PUT IMPRESSIONS                          
         CLI   DBSELSRC,C'K'       NTI POCKETPC?                                
         BNE   *+12                                                             
         CH    R6,=Y(HOMES*4)                                                   
         BE    NET33               P1 IS ALREADY A PERCENT OF UNIV              
         SR    R4,R4                                                            
         DR    R4,RF               PUT= USAGE IMPS/UNIVS                        
         AH    R5,=H'5'            +5                                           
         SR    R4,R4                                                            
         D     R4,=F'10'           /10                                          
         ST    R5,IPUTS(R6)                                                     
NET33    LA    R6,4(R6)            NEXT IUN DEMO                                
         BCT   R0,NET30                                                         
*                                                                               
NET40    DS    0H                  IMPS =UNITS/100 ->> HUNDREDS ON IUN          
         LA    R6,0                COUNTER THRU IUN DEMOS                       
         LA    R0,IUNDEMS          R0=LOOP COUNTER                              
         LA    R1,100              <<--GET UNIVS AND IMPS IN HUNDREDS           
NET45    L     R5,IUNIVS(R6)        ADJUST UNIVERSE                             
         SR    R4,R4                                                            
         MR    R4,R1               *100 UNIVS -> HUNDREDS                       
         ST    R5,IUNIVS(R6)                                                    
         L     R5,IIMPS(R6)        ADJUST IMPS                                  
         AH    R5,=H'50'                                                        
         SR    R4,R4                                                            
         DR    R4,R1               /100 IMPS  -> HUNDREDS                       
         ST    R5,IIMPS(R6)                                                     
         LA    R6,4(R6)                                                         
         BCT   R0,NET45                                                         
*                                                                               
         CLI   CALLTYPE,2          TEST PUTS/TOTS ONLY                          
         BE    NET60                                                            
         MVC   UNIVS(IUNDEMS*4,R3),IUNIVS                                       
         MVC   RATINGS(IUNDEMS*4,R3),IRATINGS                                   
         MVC   IMPS(IUNDEMS*4,R3),IIMPS                                         
         CLI   CALLTYPE,1          TEST RATINGS/IMPS ONLY                       
         BE    NETX                YES                                          
         MVC   PUTS(IUNDEMS*4,R3),IPUTS                                         
         MVC   TOTS(IUNDEMS*4,R3),IPUTS                                         
         CLI   DMAIMP,C'I'         SAVE IMPS RATHER THAN RTGS?                  
         BNE   *+10                                                             
         MVC   TOTS(IUNDEMS*4,R3),IPUTS                                         
         B     NETX                                                             
*                                                                               
NET60    MVC   0(IUNDEMS*4,R3),IPUTS                                            
         MVC   IUNDEMS*4(IUNDEMS*4,R3),IPUTS                                    
         B     NETX                                                             
*                                                                               
NET_NX   MVI   DBERROR,1           <-- NO A(DBCOMFACS)                          
*                                                                               
NETX     B     XITS1                                                            
         EJECT                                                                  
*--------------------------------------------------------------------           
NETMDF   DS    0XL4             MODIFIERS  (DBSELSRC/MODF/STORAGE ADDR)         
         DC    C'H',C'U',AL2(IUNIVS-WORKD)  NHTI FILE--> DBSELSRC=H             
         DC    C'H',C'Y',AL2(IIMPS-WORKD)                                       
         DC    C'H',C'Z',AL2(IPUTS-WORKD)                                       
*                                                                               
         DC    C'D',C'U',AL2(IUNIVS-WORKD)  NAD FILE --> DBSELSRC=D             
         DC    C'D',C'Y',AL2(IIMPS-WORKD)    (NO PUTS FOR NAD)                  
*                                                                               
         DC    C'K',C'U',AL2(IUNIVS-WORKD)  NTI  FILE--> DBSELSRC=K             
         DC    C'K',C'Y',AL2(IIMPS-WORKD)                                       
         DC    C'K',C'Z',AL2(IPUTS-WORKD)                                       
*                                                                               
         DC    C'C',C'U',AL2(IUNIVS-WORKD)  NTI  FILE--> DBSELSRC=K             
         DC    C'C',C'Y',AL2(IIMPS-WORKD)                                       
         DC    C'C',C'Z',AL2(IPUTS-WORKD)                                       
*                                                                               
         DC    X'FFFFFF'                                                        
                                                                                
*                                                                               
NETDEMS  DS    0XL3            NETWORK DEMOS FOR DEMOLIST                       
         DC    AL3(127)              V299                                       
         DC    AL3(145)              V1899                                      
         DC    AL3(129)              V1234                                      
         DC    AL3(128)              V1224                                      
         DC    AL3(125)              V1217                                      
         DC    AL3(123)              V611                                       
         DC    AL3(122)              V211                                       
         DC    AL3(045)              W1899                                      
         DC    AL3(041)              W1834                                      
         DC    AL3(042)              W1849                                      
         DC    AL3(047)              W2549                                      
         DC    AL3(048)              W2554                                      
         DC    AL3(028)              W1224                                      
         DC    AL3(049)              W2564                                      
         DC    AL3(029)              W1234                                      
         DC    AL3(095)              M1899                                      
         DC    AL3(091)              M1834                                      
         DC    AL3(092)              M1849                                      
         DC    AL3(098)              M2554                                      
         DC    AL3(099)              M2564                                      
         DC    AL3(001)              HOMES                                      
         DC    AL3(000)              METROA  N/A FOR NET                        
         DC    AL3(000)              METROB  N/A FOR NET                        
         DC    AL3(065)              WWORK                                      
         DC    AL3(097)              M2549                                      
         DC    AL3(142)              V1849                                      
         DC    AL3(141)              V1834                                      
         DC    AL3(148)              V2554                                      
         DC    AL3(191)              V2149                                      
         DC    AL3(071)              W2149                                      
         DC    AL3(115)              M2149                                      
         DC    AL3(103)              V3564                                      
         DC    X'FFFFFF'             END OF LIST INDICATOR                      
NETDEMSQ EQU   *-NETDEMS                                                        
*                                                                               
*********************************************************************           
         LTORG                                                                  
         EJECT                                                                  
* DSECT TO COVER WORKING STORAGE                                                
*                                                                               
WORKD    DSECT                                                                  
PARMS    DS    3F                                                               
         ORG   PARMS                                                            
CALLTYPE DS    X                                                                
BOOK     DS    CL2                                                              
         ORG                                                                    
DUB      DS    D                                                                
DMCB     DS    6F                                                               
WORK     DS    XL64                                                             
HALF     DS    H                                                                
EXPAND   DS    F                   VALUE EXPANSION FACTOR                       
ABOOKEL  DS    A                   A(BOOK ELEMENT)                              
ARTGEL   DS    A                   A(RATING ELEMENT)                            
APUTEL   DS    A                   A(PUT ELEMENT)                               
VSUBR01  DS    A                   A(SUBR01)                                    
         DS    4F                  SPARE                                        
RELO     DS    F                                                                
RELO1    DS    F                                                                
MYBASE01 DS    F                                                                
*                                                                               
         DS    0F                                                               
TABHEAD  DS    0CL(HEADLEN)                                                     
ADJOP    DS    F                   ADJUSTMENT OPERAND                           
ADJTYPE  DS    C                   ADJUSTMENT OPERATION                         
RTGTOIMP DS    X                   CONVERT TO IMP BASE                          
*                                                                               
DMAIMP   DS    X                   'I'=SAVE DMA IMPS NOT RATINGS                
ELEMMASK DS    X                                                                
DEMOTYPE DS    X                                                                
RTGPUT   DS    C                   IUN RATING/PUT ELEMENTS FOUND (NSI)          
FILTYP   DS    C                   T/P/I/N                                      
BOOKTYPE DS    XL(L'DRBTYP)        BOOKTYPE EXTRACTED FROM DEMO RECORD          
         SPACE 2                                                                
* IUN RECORD WORK AREA VALUES                                                   
*                                                                               
IUNVALS  DS    0F                                                               
IUNIVS   DS    (IUNDEMS)F                                                       
IRATINGS DS    (IUNDEMS)F                                                       
IIMPS    DS    (IUNDEMS)F                                                       
IPUTS    DS    (IUNDEMS)F                                                       
ITOTS    DS    (IUNDEMS)F                                                       
IDMAS    EQU   *                   DMA IMPRESSIONS                              
INEWRTGS DS    (IUNDEMS)F                                                       
ITSAS    EQU   *                   TSA IMPRESSIONS                              
INEWIMPS DS    (IUNDEMS)F                                                       
INEWPUTS DS    (IUNDEMS)F                                                       
INEWTOTS DS    (IUNDEMS)F                                                       
ISHRS    DS    3F                  3 ORIGINAL SHRS                              
*                                                                               
         EJECT                                                                  
* ARB TIME PERIOD SAVED VALUES                                                  
*                                                                               
TTAVALS  DS    0F                                                               
*                                                                               
ARMETROA DS    F                                                                
APMETROA DS    F                                                                
AUMETROA DS    F                                                                
*                                                                               
ARMETROB DS    F                                                                
APMETROB DS    F                                                                
AUMETROB DS    F                                                                
*                                                                               
AUM1834  DS    F                                                                
AUM1849  DS    F                                                                
*                                                                               
ARW1224  DS    F                                                                
ARW1834  DS    F                                                                
ARW1849  DS    F                                                                
ARW2549  DS    F                                                                
*                                                                               
APW1224  DS    F                                                                
APW1834  DS    F                                                                
APW1849  DS    F                                                                
APW2549  DS    F                                                                
*                                                                               
ATW1224  DS    F                                                                
ATW1834  DS    F                                                                
ATW1849  DS    F                                                                
ATW2549  DS    F                                                                
*                                                                               
ATM1834  DS    F                                                                
ATM1849  DS    F                                                                
*                                                                               
AQW1224  DS    F                                                                
AQW1834  DS    F                                                                
AQW1849  DS    F                                                                
AQW2549  DS    F                                                                
*                                                                               
AQM1834  DS    F                                                                
AQM1849  DS    F                                                                
*                                                                               
AUW1224  DS    F                                                                
AUW1834  DS    F                                                                
AUW1849  DS    F                                                                
AUW2549  DS    F                                                                
*                                                                               
AUW1234  DS    F                                                                
*                                                                               
AUW2554  DS    F                                                                
AUM2554  DS    F                                                                
*                                                                               
ATW2554  DS    F                                                                
ATM2554  DS    F                                                                
*                                                                               
AQW2554  DS    F                                                                
AQM2554  DS    F                                                                
*                                                                               
ARW2554  DS    F                                                                
ARM2554  DS    F                                                                
ARV2554  DS    F                                                                
*                                                                               
APW2554  DS    F                                                                
APM2554  DS    F                                                                
APV2554  DS    F                                                                
         EJECT                                                                  
*                                                                               
* SRC TIME PERIOD VALUES                                                        
*                                                                               
         ORG   TTAVALS                                                          
TTSVALS  DS    0F                                                               
SRV1217  DS    F                                                                
SIV1217  DS    F                                                                
SPV1217  DS    F                                                                
SQV1217  DS    F                                                                
*                                                                               
SRW1217  DS    F                   AFTER NOV/90                                 
SIW1217  DS    F                   "                                            
SPW1217  DS    F                   "                                            
SQW1217  DS    F                   "                                            
*                                                                               
SRV1834  DS    F                                                                
SIV1834  DS    F                                                                
SPV1834  DS    F                                                                
SQV1834  DS    F                                                                
*                                                                               
SRM1899  DS    F                                                                
SIM1899  DS    F                                                                
SPM1899  DS    F                                                                
SQM1899  DS    F                                                                
*                                                                               
SRW1899  DS    F                                                                
SIW1899  DS    F                                                                
SPW1899  DS    F                                                                
SQW1899  DS    F                                                                
*                                                                               
SRM1849  DS    F                                                                
SIM1849  DS    F                                                                
SPM1849  DS    F                                                                
SQM1849  DS    F                                                                
*                                                                               
SRW1834  DS    F                                                                
SIW1834  DS    F                                                                
SPW1834  DS    F                                                                
SQW1834  DS    F                                                                
*                                                                               
SRW1849  DS    F                                                                
SIW1849  DS    F                                                                
SPW1849  DS    F                                                                
SQW1849  DS    F                                                                
*                                                                               
SRM2549  DS    F                                                                
SIM2549  DS    F                                                                
SPM2549  DS    F                                                                
SQM2549  DS    F                                                                
*                                                                               
SRW2549  DS    F                                                                
SIW2549  DS    F                                                                
SPW2549  DS    F                                                                
SQW2549  DS    F                                                                
*                                                                               
SRM2554  DS    F                                                                
SIM2554  DS    F                                                                
SPM2554  DS    F                                                                
SQM2554  DS    F                                                                
*                                                                               
SRW2554  DS    F                                                                
SIW2554  DS    F                                                                
SPW2554  DS    F                                                                
SQW2554  DS    F                                                                
*                                                                               
SUM1824  DS    F                                                                
SUM2534  DS    F                                                                
SUM3549  DS    F                                                                
SUM5054  DS    F                                                                
SUM5564  DS    F                                                                
SUM6599  DS    F                                                                
SUW1824  DS    F                                                                
SUW2534  DS    F                                                                
SUW3549  DS    F                                                                
SUW5054  DS    F                                                                
SUW5564  DS    F                                                                
SUW6599  DS    F                                                                
SUV1217  DS    F                                                                
SUV211   DS    F                                                                
SUM2124  DS    F                   AFTER NOV/90                                 
SUW2124  DS    F                   "                                            
SUV611   DS    F                   "                                            
SUM1217  DS    F                   "                                            
SUW1217  DS    F                   "                                            
         EJECT                                                                  
* NSI TIME PERIOD VALUES                                                        
*                                                                               
         ORG   TTAVALS                                                          
TTNVALS  DS    0F                                                               
*                                                                               
* RATINGS                                                                       
*                                                                               
NRHOMES  DS    F                                                                
NRMETROA DS    F                                                                
NRMETROB DS    F                                                                
*                                                                               
* IMPRESSIONS                                                                   
*                                                                               
NTHOMES  DS    F                                                                
NTWWORK  DS    F                                                                
*  PAV OVERNIGHTS FILE                                                          
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NTW1214  DS    F                                                                
NTW1517  DS    F                                                                
*                                                                               
*                                                                               
NTW1217  DS    F                                                                
NTW1824  DS    F                                                                
NTW2534  DS    F                                                                
NTW3549  DS    F                                                                
NTW5054  DS    F                                                                
NTW5564  DS    F                                                                
NTW6599  DS    F                                                                
*                                                                               
*  PAV OVERNIGHTS FILE                                                          
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NTM1214  DS    F                                                                
NTM1517  DS    F                                                                
                                                                                
NTM1217  DS    F                                                                
NTM1824  DS    F                                                                
NTM2534  DS    F                                                                
NTM3549  DS    F                                                                
NTM5054  DS    F                                                                
NTM5564  DS    F                                                                
NTM6599  DS    F                                                                
*                                                                               
NTV25    DS    F                                                                
NTV611   DS    F                                                                
NTW1820  DS    F                   AFTER OCT/90                                 
NTW2124  DS    F                   AFTER OCT/90                                 
NTM1820  DS    F                   AFTER OCT/90                                 
NTM2124  DS    F                   AFTER OCT/90                                 
*                                                                               
* UNIVERSES                                                                     
*                                                                               
NUHOMES  DS    F                                                                
NUWWORK  DS    F                                                                
*                                                                               
*  PAV OVERNIGHTS FILE                                                          
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NUW1214  DS    F                                                                
NUW1517  DS    F                                                                
*                                                                               
NUW1217  DS    F                                                                
NUW1824  DS    F                                                                
NUW2534  DS    F                                                                
NUW3549  DS    F                                                                
NUW5054  DS    F                                                                
NUW5564  DS    F                                                                
NUW6599  DS    F                                                                
*                                                                               
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NUM1214  DS    F                                                                
NUM1517  DS    F                                                                
*                                                                               
NUM1217  DS    F                                                                
NUM1824  DS    F                                                                
NUM2534  DS    F                                                                
NUM3549  DS    F                                                                
NUM5054  DS    F                                                                
NUM5564  DS    F                                                                
NUM6599  DS    F                                                                
*                                                                               
NUV25    DS    F                                                                
NUV611   DS    F                                                                
*                                                                               
NUMETROA DS    F                                                                
NUMETROB DS    F                                                                
NUW1820  DS    F                   AFTER OCT/90                                 
NUW2124  DS    F                   AFTER OCT/90                                 
NUM1820  DS    F                   AFTER OCT/90                                 
NUM2124  DS    F                   AFTER OCT/90                                 
*                                                                               
* DMA IMPRESSIONS                                                               
*                                                                               
NDHOMES  DS    F                                                                
NDWWORK  DS    F                                                                
*                                                                               
*  2 NEW CATEGORIES FOR OVERNIGHTS                                              
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NDW1214  DS    F                                                                
NDW1517  DS    F                                                                
*                                                                               
NDW1217  DS    F                                                                
NDW1824  DS    F                                                                
NDW2534  DS    F                                                                
NDW3549  DS    F                                                                
NDW5054  DS    F                                                                
NDW5564  DS    F                                                                
NDW6599  DS    F                                                                
*                                                                               
*  2 NEW CATEGORIES FOR OVERNIGHTS                                              
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NDM1214  DS    F                                                                
NDM1517  DS    F                                                                
*                                                                               
NDM1217  DS    F                                                                
NDM1824  DS    F                                                                
NDM2534  DS    F                                                                
NDM3549  DS    F                                                                
NDM5054  DS    F                                                                
NDM5564  DS    F                                                                
NDM6599  DS    F                                                                
*                                                                               
NDV25    DS    F                                                                
NDV611   DS    F                                                                
NDW1820  DS    F                   AFTER OCT/90                                 
NDW2124  DS    F                   AFTER OCT/90                                 
NDM1820  DS    F                   AFTER OCT/90                                 
NDM2124  DS    F                   AFTER OCT/90                                 
*                                                                               
* PUTS                                                                          
*                                                                               
NPMETROA DS    F                                                                
NPMETROB DS    F                                                                
*                                                                               
* TOTALS                                                                        
*                                                                               
NQHOMES  DS    F                                                                
NQWWORK  DS    F                                                                
*                                                                               
* OVERNIGHTS                                                                    
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NQW1214  DS    F                                                                
NQW1517  DS    F                                                                
*                                                                               
NQW1217  DS    F                                                                
NQW1824  DS    F                                                                
NQW2534  DS    F                                                                
NQW3549  DS    F                                                                
NQW5054  DS    F                                                                
NQW5564  DS    F                                                                
NQW6599  DS    F                                                                
*                                                                               
* OVERNIGHTS                                                                    
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NQM1214  DS    F                                                                
NQM1517  DS    F                                                                
*                                                                               
NQM1217  DS    F                                                                
NQM1824  DS    F                                                                
NQM2534  DS    F                                                                
NQM3549  DS    F                                                                
NQM5054  DS    F                                                                
NQM5564  DS    F                                                                
NQM6599  DS    F                                                                
*                                                                               
NQV25    DS    F                                                                
NQV611   DS    F                                                                
NQW1820  DS    F                   AFTER OCT/90                                 
NQW2124  DS    F                   AFTER OCT/90                                 
NQM1820  DS    F                   AFTER OCT/90                                 
NQM2124  DS    F                   AFTER OCT/90                                 
*                                                                               
* TSA IMPRESSIONS                                                               
*                                                                               
NWHOMES  DS    F                                                                
NWWWORK  DS    F                                                                
*                                                                               
* OVERNIGHTS                                                                    
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NWW1214  DS    F                                                                
NWW1517  DS    F                                                                
*                                                                               
NWW1217  DS    F                                                                
NWW1824  DS    F                                                                
NWW2534  DS    F                                                                
NWW3549  DS    F                                                                
NWW5054  DS    F                                                                
NWW5564  DS    F                                                                
NWW6599  DS    F                                                                
*                                                                               
*                                                                               
* OVERNIGHTS                                                                    
* ---- 2 NEW CATEGORIES (1214) AND (1517) INSTEAD OF 12-17                      
NWM1214  DS    F                                                                
NWM1517  DS    F                                                                
*                                                                               
NWM1217  DS    F                                                                
NWM1824  DS    F                                                                
NWM2534  DS    F                                                                
NWM3549  DS    F                                                                
NWM5054  DS    F                                                                
NWM5564  DS    F                                                                
NWM6599  DS    F                                                                
*                                                                               
NWV25    DS    F                                                                
NWV611   DS    F                                                                
NWW1820  DS    F                   AFTER OCT/90                                 
NWW2124  DS    F                   AFTER OCT/90                                 
NWM1820  DS    F                   AFTER OCT/90                                 
NWM2124  DS    F                   AFTER OCT/90                                 
*                                                                               
*NETWORK SAVE WORK AREA                                                         
DEMOLST  DS    XL100               32 IUN DEMS * 3 BYTES LK UP + 'FF'           
*                                                                               
WORKX    EQU   *                                                                
         EJECT                                                                  
* DSECT TO COVER ORIGIN TABLE                                                   
*                                                                               
ORGTABD  DSECT                                                                  
ORGFILE  DS    C                   FILE (T=TIME PERIOD)                         
ORGMED   DS    C                   MEDIA (T=USTV)                               
ORGSRC   DS    C                   SOURCE (A=ARB, N=NSI)                        
ORGBOOK  DS    XL2                 BOOK (YM)                                    
ORGCOMPL EQU   *-ORGTABD           TABLE COMPARE LENGTH                         
ORGDELEM DS    AL3                 DISP TO ELEMENT TABLE                        
ORGDROUT DS    Y                   DISP TO PROCESSING ROUTINE                   
ORGTABL  EQU   *-ORGTABD           TABLE ENTRY LENGTH                           
         SPACE                                                                  
* DSECT TO COVER BOOK ELEMENT TABLE                                             
*                                                                               
ELEMTABD DSECT                                                                  
ELEMNUM  DS    X                   ELEMENT NUMBER                               
ELEMDISP DS    AL3                 DISPLACEMENT TO ELEMENT DEMO LIST            
*                                  FOR IUN-DISPLACEMENT INTO WORK AREA          
ELEMTYPE DS    X                   DEMO TYPE (EQUATED, E.G. RATING)             
ELEMTABL EQU   *-ELEMTABD                                                       
         SPACE                                                                  
* DSECT TO COVER ARB TIME PERIOD DEMO LIST ENTRY                                
*                                                                               
TTALISTD DSECT                                                                  
TTADISPS DS    H                   DISPLACEMENT TO WORK AREA SECTION            
TTADISPV DS    X                   DISP INTO SECTION (N'FULLWORDS)              
TTACNTRL DS    X                   CONTROL BYTE                                 
TTASVDSP DS    Y                   DISP TO SAVE POSITION                        
TTALISTL EQU   *-TTALISTD          L'DEMO LIST ENTRY                            
*                                                                               
TTABYPAS EQU   1                                                                
         SPACE                                                                  
* DSECT TO COVER NSI TIME PERIOD DEMO LIST ENTRY                                
*                                                                               
TTNLISTD DSECT                                                                  
TTNDISPS DS    Y                   DISPLACEMENT TO VALUE POSITION               
TTNTYPE  DS    X                   DEMO TYPE (X'FF'=IGNORE VALUE)               
         DS    XL3                 SPARE                                        
TTNLISTL EQU   *-TTNLISTD          L'DEMO LIST ENTRY                            
         SPACE 2                                                                
* DSECT TO COVER SRC TIME PERIOD DEMO LIST ENTRY                                
*                                                                               
TTSLISTD DSECT                                                                  
TTSDISPS DS    Y                   DISPLACEMENT TO WORK AREA SECTION            
TTSDISPV DS    X                   DISP INTO SECTION (N'FULLWORDS)              
         DS    X                   SPARE                                        
TTSSVDSP DS    Y                   DISP TO SAVE POSITION                        
TTSLISTL EQU   *-TTSLISTD          L'DEMO LIST ENTRY                            
         SPACE 2                                                                
* DEDBLOCK                                                                      
         PRINT OFF                                                              
DBLOCKD  DSECT                                                                  
       ++INCLUDE DEDBLOCK                                                       
         PRINT ON                                                               
         SPACE                                                                  
* DEDEMTABD                                                                     
         PRINT OFF                                                              
       ++INCLUDE DEDEMTABD                                                      
         PRINT ON                                                               
         SPACE                                                                  
* DDCOMFACS                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDCOMFACS                                                      
         PRINT ON                                                               
         SPACE                                                                  
* DEDEMFILE                                                                     
         PRINT OFF                                                              
       ++INCLUDE DEDEMFILE                                                      
         PRINT ON                                                               
         SPACE 1                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'185REGETIUN  08/06/18'                                      
         END                                                                    
