*          DATA SET DDDRIVAL   AT LEVEL 022 AS OF 03/20/13                      
*PROCESS USING(WARN(15))                                                        
*CATALP DRIVAL                                                                  
*                                                                               
***********************************************************************         
*                                                                     *         
*  NUMBER:                                                            *         
*                                                                     *         
*  TITLE:        DRIVAL -- DRIVER FIELD VALIDATION ROUTINES           *         
*                T00A36 -- CORE-RESIDENT PHASE NUMBER                 *         
*                                                                     *         
*  COMMENTS:     CONTAINS COMMON DATA VALIDATION ROUTINES USED BY     *         
*                DRIVER SUBSYSTEMS.                                   *         
*                                                                     *         
*  CALLED FROM:  1) DICTIONARY ENTRY MAINTENANCE/LIST (TA0A03)        *         
*                2) DPG COMPILER                                      *         
*                3) DRONE (T00A39)                                    *         
*                4) USER RECORD MAINTENANCE/LIST (TA0A04)             *         
*                                                                     *         
*  CALLS TO:     DATAMGR                                              *         
*                                                                     *         
*  INPUTS:       0(R1)    A(DRIVAL BLOCK)         SEE DRIVALBLKD      *         
*                                                                     *         
*  OUTPUTS:      CREATES ELEMENTS AT LOCATION GIVEN IN BLOCK,         *         
*                AND RETURNS NEXT AVAILABLE ELEMENT ADDRESS.          *         
*                                                                     *         
*  REGISTERS:    R0 -- WORK                                           *         
*                R1 -- WORK                                           *         
*                R2 -- WORK                                           *         
*                R3 -- WORK                                           *         
*                R4 -- ADDRESS OF INPUT                               *         
*                R5 -- USED IN TABLE SEARCHES                         *         
*                R6 -- COMFACS                                        *         
*                R7 -- OUTPUT ELEMENT ADDRESS (TOUCH THIS = DEATH)    *         
*                R8 -- DRIVAL PARAMETER BLOCK                         *         
*                R9 -- THIRD BASE                                     *         
*                RA -- SECOND BASE                                    *         
*                RB -- FIRST BASE                                     *         
*                RC -- WORKING STORAGE                                *         
*                RD -- SYSTEM                                         *         
*                RE -- SYSTEM                                         *         
*                RF -- SYSTEM                                         *         
*                                                                     *         
***********************************************************************         
         TITLE 'DRIVAL -- DRIVER DATA VALIDATION ROUTINES'                      
DRIVAL   RSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 WORKX-WORKD,*DRIVAL*,RA,R9,RR=R3                                 
         USING WORKD,RC                                                         
         ST    R3,RELO                                                          
*                                                                               
         L     R8,0(R1)            A(DRIVAL BLOCK)                              
         USING DRVLBLKD,R8                                                      
         ST    RD,SAVERD           HANG ON TO REGISTER SAVE AREA                
         L     R6,DBCOMADR         A(COMFACS)                                   
         USING COMFACSD,R6                                                      
*                                                                               
         LA    R0,(TABLESX-TABLES)/4  ADD RELO TO ADCONS                        
         SR    R1,R1                                                            
M5       L     RE,TABLES(R1)                                                    
         A     RE,RELO                                                          
         ST    RE,MYADCONS(R1)                                                  
         LA    R1,4(R1)                                                         
         BCT   R0,M5                                                            
*                                                                               
         BAS   RE,VOPCODE          VERIFY OPCODE AND PROCESS                    
*                                                                               
XMOD     XMOD1                                                                  
         EJECT                                                                  
* MACRO AND ROUTINE TO APPEND ELEMENTS TO DRIVER BUFFER                         
*                                                                               
         MACRO                                                                  
*                                                                               
&NAME    BUILD &LEN,&FROM                                                       
 LCLC &RX                                                                       
*                                                                               
* &LEN  = NUMBER OF BYTES TO BE APPENDED                                        
* &FROM = SOURCE ADDRESS                                                        
*                                                                               
         AIF   ('&LEN'(1,1) EQ '(').LENR                                        
&NAME    LA    R0,&LEN                                                          
         AGO   .CONT                                                            
.LENR    ANOP                                                                   
&RX      SETC  '&LEN(1)'                                                        
&NAME    LR    R0,&RX                                                           
.CONT    LA    R1,&FROM                                                         
         BAS   RE,BUMPELEM                                                      
*                                                                               
         MEND                                                                   
         SPACE 3                                                                
BUMPELEM NTR1                                                                   
*                                                                               
         LR    R3,R0               LENGTH OF DATA                               
         BCTR  R3,0                                                             
         LA    R2,1(R7,R3)         POTENTIAL NEW END OF BUFFER                  
         C     R2,DBENDADR         TEST IF BUFFER COULD OVERFLOW                
         BL    *+6                 IT CAN'T                                     
         DC    H'0'                IT COULD -- SO DIE                           
*                                                                               
         EX    R3,*+8              APPEND THE BYTES                             
         B     *+10                                                             
         MVC   0(0,R7),0(R1)                                                    
         LR    R7,R2               UPDATE THE CURRENT ELEMENT POINTER           
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
* MACRO AND ROUTINE TO GENERATE TWA FIELD HEADER FOR DATA                       
*                                                                               
         MACRO                                                                  
*                                                                               
&NAME    FLDG  &IN,&OUT,&LEN                                                    
*                                                                               
* PARAMS --    A(INPUT FIELD),A(OUTPUT TWA HEADER),A(DATA LENGTH)               
*                                                                               
&NAME    LA    R0,&IN                                                           
         LA    R1,&OUT                                                          
         MVC   FLDGLEN,&LEN                                                     
         BAS   RE,FLDGEN                                                        
*                                                                               
         MEND                                                                   
         SPACE 3                                                                
FLDGEN   NTR1                                                                   
*                                                                               
         CLI   FLDGLEN,0           TEST LENGTH OF ZERO                          
         BE    FLDGENX             IF SO, DO NOTHING                            
*                                                                               
         XC    0(8,R1),0(R1)       CLEAR FIELD HEADER                           
         MVC   5(1,R1),FLDGLEN     STORE INPUT LENGTH                           
*                                                                               
         LR    R2,R0                                                            
         ZIC   R4,5(R1)                                                         
         BCTR  R4,0                                                             
         EX    R4,*+8                                                           
         B     *+10                                                             
         MVC   8(0,R1),0(R2)       PUT DATA INTO DATA FIELD                     
*                                                                               
         ZIC   R4,5(R1)            INPUT LENGTH                                 
         AH    R4,=H'8'            HEADER LENGTH                                
         STC   R4,0(R1)            TOTAL FIELD LENGTH                           
*                                                                               
         LA    R5,0(R4,R1)         JUST PAST END OF OUTPUT FIELD                
*                                                                               
BACKUP   BCTR  R5,0                MOVE BACKWARDS, LOOK AT EACH CHAR.           
         CLI   0(R5),C' '          IF BLANK OR NULL, KEEP BACKING UP            
         BE    *+12                                                             
         CLI   0(R5),0                                                          
         BNE   FLDGENX                                                          
*                                                                               
         ZIC   R4,0(R1)            ADJUST LENGTHS IN HEADER                     
         BCTR  R4,0                                                             
         STC   R4,0(R1)                                                         
         ZIC   R4,5(R1)                                                         
         BCTR  R4,0                                                             
         STC   R4,5(R1)                                                         
*                                                                               
         B     BACKUP                                                           
*                                                                               
FLDGENX  B     EXIT7                                                            
         EJECT                                                                  
* VERIFY OPCODE AND PROCESS STATEMENT                                           
*                                                                               
VOPCODE  NTR1                                                                   
*                                                                               
         L     R4,DBSRCADR         SOURCE ADDRESS                               
*                                                                               
         MVI   OPTNUM,0            RESET SCANNER ENTRY COUNTER                  
         MVI   WHERE,C' '          RESET IN/OUT/HEAD FLAG                       
         MVC   SAVEDICT,DBDICTNM   SAVE CURRENT DICTIONARY NAME                 
         MVI   DBERRNUM,DBOK       RESET ERROR FLAG                             
         L     R7,DBELOADR         LOCATION OF ELEMENT(S)                       
*                                                                               
         L     R5,AOPCODES         TABLE OF ACTION CODES                        
*                                                                               
VOPCODEA CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+6                                                              
         DC    H'0'                DIE IF OPCODE NOT FOUND                      
*                                                                               
         CLC   DBOPCODE,0(R5)      TEST FOR MATCH IN TABLE                      
         BE    *+12                                                             
         LA    R5,8(R5)            NEXT TABLE ENTRY                             
         B     VOPCODEA                                                         
*                                                                               
         MVC   INMODE,2(R5)        SAVE ORIGIN OF INPUT                         
         CLI   INMODE,C'F'         TEST SCREEN FIELD HEADER                     
         BNE   VOPCODEB                                                         
         BUILD 2,0(R5)             PUT OPCODE AND LENGTH IN ELEMENT             
*                                                                               
VOPCODEB CLI   INMODE,C'S'         TEST SCANNER TABLE INPUT                     
         BNE   VOPCODEC                                                         
         CLI   DBSCANLN,0          TEST NO OPTIONS ON CARD                      
         BE    EXIT7                                                            
*                                                                               
         LR    R3,R4               BEGINNING OF SCANNER TABLE                   
         ZIC   R0,DBSCANLN         NUMBER OF SCANNER TABLE ENTRIES              
         LA    R3,74(R3)           ADVANCE ONE ENTRY                            
         BCT   R0,*-4              BUMP R3 TO END OF TABLE                      
         ST    R3,ABLOCKX          SAVE END OF SCANNER TABLE ADDRESS            
*                                                                               
         CLI   3(R5),C'Y'          TEST STATEMENT TAKES OPTIONS                 
         BE    VOPCODEC                                                         
         MVI   DBERRNUM,DBEXTOP    NO OPTIONS ALLOWED ON THIS STATEMENT         
         B     ERR                                                              
*                                                                               
VOPCODEC L     RF,4(R5)            ADDRESS OF VALIDATION ROUTINE                
         A     RF,RELO                                                          
         BASR  RE,RF               PERFORM ARGUMENT VALIDATION                  
*                                                                               
         ST    R7,DBELNADR         NEXT AVAILABLE ELEMENT LOCATION              
*                                                                               
EXIT7    XIT1  REGS=(R7)           ALWAYS RETAIN ELEMENT POINTER                
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    INITIALIZE DRIVAL                             *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
DRSTART  NTR1                                                                   
*                                                                               
         MVI   DBCNTRL,1           WE'VE ONLY JUST BEGUN -- TO DRONE            
*                                                                               
         BUILD 2,=X'1002'          GENERATE A REC ELEMENT                       
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    VALIDATE DRONE BLOCK                          *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VDRONE   NTR1                                                                   
*                                                                               
         L     R4,DBSRCADR         A(DRONE BLOCK)                               
         USING DRONED,R4                                                        
*                                                                               
         CLI   DBOPCODE,DBDRCOL    TEST THIS IS A COLUMN                        
         BNE   VDRN100                                                          
         CLI   DBCNTRL,1           TEST FIRST COLUMN                            
         BNE   VDRN100                                                          
         MVI   DBCNTRL,2                                                        
         BUILD 2,=X'1202'          GENERATE DATA ELEMENT                        
         EJECT                                                                  
VDRN100  TM    DRFLAGI,X'80'       TEST IN STMT REQUESTED                       
         BZ    VDRN200                                                          
         BUILD 2,=X'200A'          GENERATE IN ELEMENT                          
         BUILD 1,DRLABELI          WITH LABEL, IF PRESENT                       
         BUILD 7,SPACES                                                         
*                                                                               
         OC    DRDICTI,DRDICTI     TEST DICTIONARY NAME GIVEN                   
         BZ    VDRN110                                                          
         BUILD 2,=X'800A'          GENERATE DICTIONARY ELEMENT                  
         BUILD 8,DRDICTI                                                        
*                                                                               
         OC    DRENTRYI,DRENTRYI   TEST ENTRY NAME GIVEN                        
         BNZ   *+6                                                              
         DC    H'0'                                                             
         BUILD 2,=X'810A'          GENERATE ENTRY ELEMENT                       
         BUILD 8,DRENTRYI                                                       
*                                                                               
VDRN110  OC    DRTYPEI,DRTYPEI     TEST INPUT TYPE GIVEN                        
         BZ    VDRN120                                                          
         BUILD 2,=X'2205'          GENERATE INPUT TYPE ELEMENT                  
         BUILD 3,DRTYPEI                                                        
*                                                                               
VDRN120  CLI   DRLENI,0            TEST INPUT LENGTH GIVEN                      
         BE    VDRN130                                                          
         BUILD 2,=X'2303'          GENERATE INPUT LENGTH ELEMENT                
         BUILD 1,DRLENI                                                         
*                                                                               
VDRN130  OC    DRRTNI,DRRTNI       TEST INPUT ROUTINE GIVEN                     
         BZ    VDRN140                                                          
         BUILD 2,=X'240A'          GENERATE INPUT ROUTINE ELEMENT               
         BUILD 8,DRRTNI                                                         
*                                                                               
VDRN140  CLI   DRNARGSI,0          TEST NO. OF ARGS                             
         BNE   *+16                                                             
         OC    DRARGSI,DRARGSI     TEST ANY INPUT ARGUMENTS GIVEN               
         BZ    VDRN150                                                          
         DC    H'0'                                                             
         BUILD 1,=X'25'            ELEMENT CODE                                 
         ZIC   R2,DRNARGSI                                                      
         LA    R2,2(R2)                                                         
         STC   R2,BYTE                                                          
         BUILD 1,BYTE                                                           
         ZIC   R2,DRNARGSI                                                      
         BUILD (R2),DRARGSI                                                     
*                                                                               
VDRN150  CLI   DRDECI,0            TEST DEC OPTION GIVEN                        
         BE    VDRN160                                                          
         BUILD 3,=X'260401'        GENERATE DEC OPTION                          
         BUILD 1,DRDECI                                                         
*                                                                               
VDRN160  CLI   DRSCALEI,0          TEST SCALE OPTION GIVEN                      
         BE    VDRN180                                                          
         BUILD 3,=X'260403'        GENERATE SCALE OPTION                        
         BUILD 1,DRSCALEI                                                       
*                                                                               
VDRN180  CLI   DRLITLNI,0          TEST LITERAL GIVEN                           
         BE    VDRN190                                                          
         BUILD 1,=X'87'            ELEMENT CODE FOR LITERALS                    
         ZIC   R5,DRLITLNI         LENGTH OF LITERAL                            
         LA    R2,3(R5)            PLUS 3 FOR OVERHEAD                          
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              GENERATE ELEMENT LENGTH                      
         BUILD 1,=AL1(0)           DUMMY BYTE                                   
         LA    R2,DRLITI           LITERAL                                      
         BUILD (R5),0(R2)                                                       
*                                                                               
VDRN190  DS    0H                                                               
*                                                                               
         EJECT                                                                  
VDRN200  TM    DRFLAGO,X'80'       TEST OUT STMT REQUESTED                      
         BZ    VDRN300                                                          
         BUILD 2,=X'3002'          GENERATE OUT ELEMENT                         
*                                                                               
         OC    DRDICTO,DRDICTO     TEST DICTIONARY NAME GIVEN                   
         BZ    VDRN205                                                          
         BUILD 2,=X'800A'          GENERATE DICTIONARY ELEMENT                  
         BUILD 8,DRDICTO                                                        
*                                                                               
         OC    DRENTRYO,DRENTRYO   TEST ENTRY NAME GIVEN                        
         BNZ   *+6                                                              
         DC    H'0'                                                             
         BUILD 2,=X'810A'          GENERATE ENTRY ELEMENT                       
         BUILD 8,DRENTRYO                                                       
*                                                                               
VDRN205  OC    DRTYPEO,DRTYPEO     TEST OUTPUT TYPE GIVEN                       
         BZ    VDRN210                                                          
         BUILD 2,=X'3204'          GENERATE OUTPUT TYPE ELEMENT                 
         BUILD 2,DRTYPEO                                                        
*                                                                               
VDRN210  CLI   DRLENO,0            TEST OUTPUT LENGTH GIVEN                     
         BE    VDRN220                                                          
         BUILD 2,=X'3303'          GENERATE OUTPUT LENGTH ELEMENT               
         BUILD 1,DRLENO                                                         
         MVC   BYTE,DRLENO         SAVE THE OUTPUT LENGTH                       
*                                                                               
VDRN220  OC    DRRTNO,DRRTNO       TEST OUTPUT ROUTINE GIVEN                    
         BZ    VDRN225                                                          
         BUILD 2,=X'340A'          GENERATE OUTPUT ROUTINE ELEMENT              
         BUILD 8,DRRTNO                                                         
*                                                                               
VDRN225  CLI   DRNARGSO,0          TEST NO. OF ARGS                             
         BNE   *+16                                                             
         OC    DRARGSO,DRARGSO     TEST ANY ARGUMENTS GIVEN                     
         BZ    VDRN230                                                          
         DC    H'0'                                                             
         BUILD 1,=X'35'            ELEMENT CODE                                 
         ZIC   R2,DRNARGSO                                                      
         LA    R2,2(R2)                                                         
         STC   R2,BYTE                                                          
         BUILD 1,BYTE                                                           
         ZIC   R2,DRNARGSO                                                      
         BUILD (R2),DRARGSO                                                     
*                                                                               
VDRN230  OC    DRPOSO,DRPOSO       TEST PRINT POSITION GIVEN                    
         BZ    VDRN235                                                          
         BUILD 2,=X'8605'          GENERATE PRINT POSITION ELEMENT              
         BUILD 3,DRPOSO                                                         
*                                                                               
VDRN235  CLI   DRDECO,0            TEST DEC OPTION GIVEN                        
         BE    VDRN240                                                          
         BUILD 3,=X'360401'        GENERATE DEC OPTION                          
         BUILD 1,DRDECO                                                         
*                                                                               
VDRN240  CLI   DRSCALEO,0          TEST SCALE OPTION GIVEN                      
         BE    VDRN245                                                          
         BUILD 3,=X'360427'        GENERATE SCALE OPTION                        
         BUILD 1,DRSCALEO                                                       
*                                                                               
VDRN245  CLI   DRFILLO,0           TEST FILL OPTION GIVEN                       
         BE    VDRN250                                                          
         BUILD 3,=X'360405'        GENERATE FILL OPTION                         
         BUILD 1,DRFILLO                                                        
*                                                                               
VDRN250  CLI   DRFLOATO,0          TEST FLOAT OPTION GIVEN                      
         BE    VDRN251                                                          
         BUILD 3,=X'360406'        GENERATE FLOAT OPTION                        
         BUILD 1,DRFLOATO                                                       
*                                                                               
VDRN251  OC    DRMINO,DRMINO       TEST MIN OPTION GIVEN                        
         BZ    VDRN252                                                          
         BUILD 4,=X'640C0100'      GENERATE MIN OPTION                          
         BUILD 8,DRMINO                                                         
*                                                                               
VDRN252  OC    DRMAXO,DRMAXO       TEST MAX OPTION GIVEN                        
         BZ    VDRN253                                                          
         BUILD 4,=X'640C0200'      GENERATE MAX OPTION                          
         BUILD 8,DRMAXO                                                         
*                                                                               
VDRN253  CLI   DRTRAILO,0          TEST TRAIL OPTION GIVEN                      
         BE    VDRN255                                                          
         BUILD 3,=X'360428'        GENERATE TRAIL OPTION                        
         BUILD 1,DRTRAILO                                                       
*                                                                               
VDRN255  CLI   DRDIVO,0            TEST DIV OPTION GIVEN                        
         BE    VDRN260                                                          
         BUILD 3,=X'360408'        GENERATE DIV OPTION                          
         BUILD 1,DRDIVO                                                         
*                                                                               
VDRN260  TM    DROPTSO,DRCOMMAO    TEST COMMAS=YES GIVEN                        
         BZ    VDRN265                                                          
         BUILD 4,=X'36040200'      GENERATE COMMAS=YES                          
*                                                                               
VDRN265  TM    DROPTSO,DRZEROO     TEST ZERO=NOBLANK GIVEN                      
         BZ    VDRN270                                                          
         BUILD 4,=X'36040400'      GENERATE ZERO=NOBLANK                        
*                                                                               
VDRN270  TM    DROPTSO,DRMINUSO    TEST MINUS=YES GIVEN                         
         BZ    VDRN275                                                          
         BUILD 4,=X'36040300'      GENERATE MINUS=YES                           
*                                                                               
VDRN275  TM    DROPTSO,DRBKALLO    TEST BRACKET GIVEN                           
         BZ    VDRN280                                                          
         BUILD 4,=X'36040700'      GENERATE BRACKET                             
*                                                                               
VDRN280  TM    DROPTSO,DRBKMINO    TEST BRACKET=MINUS GIVEN                     
         BZ    VDRN283                                                          
         BUILD 4,=X'360407D4'      GENERATE BRACKET=MINUS                       
*                                                                               
VDRN283  TM    DROPTSO,DRCHOPO     TEST CHOP GIVEN                              
         BZ    VDRN285                                                          
         BUILD 4,=X'36042400'      GENERATE CHOP                                
*                                                                               
VDRN285  TM    DROPTSO,DRALGNLO    TEST ALIGN=L GIVEN                           
         BZ    VDRN290                                                          
         BUILD 4,=X'360420D3'      GENERATE ALIGN=L                             
         TM    DROPTSO,DRALGNRO    TEST BOTH ALIGN=L AND ALIGN=R GIVEN          
         BZ    VDRN295                                                          
         DC    H'0'                ONLY ONE PERMITTED                           
*                                                                               
VDRN290  TM    DROPTSO,DRALGNRO    TEST ALIGN=R GIVEN                           
         BZ    VDRN291                                                          
         BUILD 4,=X'360420D9'      GENERATE ALIGN=R                             
*                                                                               
VDRN291  TM    DROPTSO+1,DRTRMDEC  TEST TRIM DECIMAL                            
         BZ    VDRN291A                                                         
         BUILD 4,=X'36040900'      GENERATE TRIM                                
*                                                                               
VDRN291A DS    0H                                                               
*                                                                               
         TM    DROPTSO+1,DROPABSO  TEST ABSOLUTE VALUE                          
         BNO   VDRN292                                                          
         BUILD 4,=X'36042D00'      GENERATE ABSOLUTE VALUE                      
*                                                                               
VDRN292  TM    DROPTSO+1,DRPBELOW  TEST PRINT BELOW                             
         BZ    VDRN293                                                          
         BUILD 4,=X'36040A00'      GENERATE PRINT BELOW                         
*                                                                               
VDRN293  TM    DROPTSO+1,DRNOLBOX  TEST NOBOX                                   
         BZ    VDRN294                                                          
         BUILD 4,=X'36042300'      GENERATE NOBOX                               
*                                                                               
VDRN294  TM    DROPTSO+1,DRCUME    TEST CUME                                    
         BZ    VDRN294B                                                         
         BUILD 4,=X'36042900'      GENERATE CUME                                
*                                                                               
VDRN294B TM    DROPTSO+1,DRDWNCMP  DOWNCAST COMPUTES                            
         BZ    VDRN294C                                                         
         BUILD 4,=X'36042A00'      GENERATE                                     
*                                                                               
VDRN294C TM    DROPTSO+1,DRNOTOT   NO TOTALING                                  
         BZ    VDRN294D                                                         
         BUILD 4,=X'36042B00'      GENERATE                                     
*                                                                               
VDRN294D TM    DROPTSO+1,DRNODET   NO DETAILS                                   
         BZ    VDRN295                                                          
         BUILD 4,=X'36042C00'      GENERATE                                     
*                                                                               
VDRN295  CLI   DRLITLNO,0          TEST LITERAL GIVEN                           
         BE    VDRN300                                                          
         BUILD 1,=X'87'            ELEMENT CODE FOR LITERALS                    
         ZIC   R5,DRLITLNO         LENGTH OF LITERAL                            
         LA    R2,3(R5)            PLUS 3 FOR OVERHEAD                          
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              GENERATE ELEMENT LENGTH                      
         BUILD 1,=AL1(0)           DUMMY BYTE                                   
         LA    R2,DRLITO           LITERAL                                      
         BUILD (R5),0(R2)                                                       
         EJECT                                                                  
VDRN300  LA    RF,DRHDLEN          BASE REGISTER FOR HEADLINE DSECT             
         USING DRHEADD,RF                                                       
         MVC   HALF,=H'1'          TALLY THE HEADLINES                          
*                                                                               
VDRN305  TM    DRHEAD,X'80'        TEST HEAD STMT REQUESTED                     
         BZ    VDRN350                                                          
         BUILD 2,=X'4003'          GENERATE HEAD ELEMENT                        
         BUILD 1,HALF+1            HEADLINE NUMBER                              
*                                                                               
         OC    DRHRTN,DRHRTN       TEST HEADS ROUTINE GIVEN                     
         BZ    VDRN310                                                          
         BUILD 2,=X'820A'          GENERATE HEADS ROUTINE ELEMENT               
         BUILD 8,DRHRTN                                                         
*                                                                               
VDRN310  CLI   DRHNARG,0           TEST NO. OF ARGS                             
         BNE   *+16                                                             
         OC    DRHARGS,DRHARGS     TEST ANY ARGUMENTS GIVEN                     
         BZ    VDRN320                                                          
         DC    H'0'                                                             
         BUILD 1,=X'83'            ELEMENT CODE                                 
         ZIC   R2,DRHNARG                                                       
         LA    R2,2(R2)                                                         
         STC   R2,BYTE                                                          
         BUILD 1,BYTE                                                           
         ZIC   R2,DRHNARG                                                       
         BUILD (R2),DRHARGS                                                     
*                                                                               
VDRN320  TM    DRHOPTS,DRHALGNL    TEST ALIGN=L GIVEN                           
         BZ    VDRN330                                                          
         BUILD 4,=X'360420D3'      GENERATE ALIGN=L                             
         TM    DRHOPTS,DRHALGNR    TEST BOTH ALIGN=L AND =R GIVEN               
         BZ    VDRN340                                                          
         DC    H'0'                ONLY ONE PERMITTED                           
*                                                                               
VDRN330  TM    DRHOPTS,DRHALGNR    TEST ALIGN=R GIVEN                           
         BZ    VDRN340                                                          
         BUILD 4,=X'360420D9'      GENERATE ALIGN=R                             
*                                                                               
VDRN340  CLI   DRHLITL,0           TEST LITERAL GIVEN                           
         BE    VDRN350                                                          
         BUILD 1,=X'87'            ELEMENT CODE FOR LITERALS                    
         ZIC   R5,DRHLITL          LENGTH OF LITERAL                            
         LA    R2,3(R5)            PLUS 3 FOR OVERHEAD                          
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              GENERATE ELEMENT LENGTH                      
         BUILD 1,=AL1(0)           DUMMY BYTE                                   
         LA    R2,DRHLIT           LITERAL                                      
         BUILD (R5),0(R2)                                                       
*                                                                               
VDRN350  LA    RF,L'DRHDLEND(RF)   INCREMENT BASE REGISTER                      
         LH    R5,HALF                                                          
         LA    R5,1(R5)            INCREMENT HEADLINE NUMBER                    
         STH   R5,HALF                                                          
         CH    R5,=H'4'            TEST ALL 4 HEADLINES PROCESSED               
         BNH   VDRN305                                                          
         EJECT                                                                  
         TM    DRFIRST,X'80'       TEST FIRST STMT REQUESTED                    
         BZ    VDRN500                                                          
         BUILD 3,=X'4403C6'        GENERATE FIRST ELEMENT                       
*                                                                               
         OC    DRFRTN,DRFRTN       TEST FIRST ROUTINE GIVEN                     
         BZ    VDRN410                                                          
         BUILD 2,=X'820A'          GENERATE FIRST ROUTINE ELEMENT               
         BUILD 8,DRFRTN                                                         
*                                                                               
VDRN410  CLI   DRFNARGS,0          TEST NO. OF ARGS                             
         BNE   *+16                                                             
         OC    DRFARGS,DRFARGS     TEST ANY ARGUMENTS GIVEN                     
         BZ    VDRN420                                                          
         DC    H'0'                                                             
         BUILD 1,=X'83'            ELEMENT CODE                                 
         ZIC   R2,DRFNARGS                                                      
         LA    R2,2(R2)                                                         
         STC   R2,BYTE                                                          
         BUILD 1,BYTE                                                           
         ZIC   R2,DRFNARGS                                                      
         BUILD (R2),DRFARGS                                                     
*                                                                               
VDRN420  CLI   DRFSPACE,0          TEST SPACE OPTION REQUESTED                  
         BE    VDRN430                                                          
         BUILD 3,=X'460402'        GENERATE SPACE OPTION                        
         BUILD 1,DRFSPACE                                                       
*                                                                               
VDRN430  TM    DRFOPTS,DRFSKIP     TEST SKIP GIVEN                              
         BZ    VDRN440                                                          
         BUILD 4,=X'46040100'      GENERATE SKIP                                
*                                                                               
VDRN440  TM    DRFOPTS,DRFPAGE     TEST PAGE GIVEN                              
         BZ    VDRN450                                                          
         BUILD 4,=X'46040300'      GENERATE PAGE                                
*                                                                               
VDRN450  TM    DRFOPTS,DRFSUBPG    TEST SUBPAGE GIVEN                           
         BZ    VDRN455                                                          
         BUILD 4,=X'46040400'      GENERATE SUBPAGE                             
*                                                                               
VDRN455  TM    DRFOPTS,DRFMIDHD    TEST MIDHEAD GIVEN                           
         BZ    VDRN460                                                          
         BUILD 4,=X'46040500'      GENERATE MIDHEAD                             
*                                                                               
VDRN460  CLI   DRFLITLN,0          TEST LITERAL GIVEN                           
         BE    VDRN500                                                          
         BUILD 1,=X'87'            ELEMENT CODE FOR LITERALS                    
         ZIC   R5,DRFLITLN         LENGTH OF LITERAL                            
         LA    R2,3(R5)            PLUS 3 FOR OVERHEAD                          
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              GENERATE ELEMENT LENGTH                      
         BUILD 1,=AL1(0)           DUMMY BYTE                                   
         LA    R2,DRFLIT           LITERAL                                      
         BUILD (R5),0(R2)                                                       
         EJECT                                                                  
VDRN500  TM    DRLAST,X'80'        TEST LAST STMT REQUESTED                     
         BZ    VDRN600                                                          
         BUILD 3,=X'4403D3'        GENERATE LAST ELEMENT                        
*                                                                               
         OC    DRLRTN,DRLRTN       TEST LAST ROUTINE GIVEN                      
         BZ    VDRN510                                                          
         BUILD 2,=X'820A'          GENERATE LAST ROUTINE ELEMENT                
         BUILD 8,DRLRTN                                                         
*                                                                               
VDRN510  CLI   DRLNARGS,0          TEST NO. OF ARGS                             
         BNE   *+16                                                             
         OC    DRLARGS,DRLARGS     TEST ANY ARGUMENTS GIVEN                     
         BZ    VDRN520                                                          
         DC    H'0'                                                             
         BUILD 1,=X'83'            ELEMENT CODE                                 
         ZIC   R2,DRLNARGS                                                      
         LA    R2,2(R2)                                                         
         STC   R2,BYTE                                                          
         BUILD 1,BYTE                                                           
         ZIC   R2,DRLNARGS                                                      
         BUILD (R2),DRLARGS                                                     
*                                                                               
VDRN520  CLI   DRLSPACE,0          TEST SPACE OPTION REQUESTED                  
         BE    VDRN530                                                          
         BUILD 3,=X'460402'        GENERATE SPACE OPTION                        
         BUILD 1,DRLSPACE                                                       
*                                                                               
VDRN530  TM    DRLOPTS,DRLSKIP     TEST SKIP GIVEN                              
         BZ    VDRN540                                                          
         BUILD 4,=X'46040100'      GENERATE SKIP                                
*                                                                               
VDRN540  TM    DRLOPTS,DRLPAGE     TEST PAGE GIVEN                              
         BZ    VDRN550                                                          
         BUILD 4,=X'46040300'      GENERATE PAGE                                
*                                                                               
VDRN550  TM    DRLOPTS,DRLSUBPG    TEST SUBPAGE GIVEN                           
         BZ    VDRN555                                                          
         BUILD 4,=X'46040400'      GENERATE SUBPAGE                             
*                                                                               
VDRN555  TM    DRLOPTS,DRLMIDHD    TEST MIDHEAD GIVEN                           
         BZ    VDRN557                                                          
         BUILD 4,=X'46040500'      GENERATE MIDHEAD                             
*                                                                               
VDRN557  TM    DRLOPTS,DRLHORIZ    TEST PRINT HORIZONTAL LINE                   
         BZ    VDRN560                                                          
         BUILD 4,=X'46040600'      GENERATE MIDHEAD                             
*                                                                               
VDRN560  CLI   DRLLITLN,0          TEST LITERAL GIVEN                           
         BE    VDRN600                                                          
         BUILD 1,=X'87'            ELEMENT CODE FOR LITERALS                    
         ZIC   R5,DRLLITLN         LENGTH OF LITERAL                            
         LA    R2,3(R5)            PLUS 3 FOR OVERHEAD                          
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              GENERATE ELEMENT LENGTH                      
         BUILD 1,=AL1(0)           DUMMY BYTE                                   
         LA    R2,DRLLIT           LITERAL                                      
         BUILD (R5),0(R2)                                                       
         EJECT                                                                  
VDRN600  TM    DRTOTAL,X'80'       TEST TOTAL STMT REQUESTED                    
         BZ    VDRONEX                                                          
         BUILD 2,=X'4802'          GENERATE TOTAL ELEMENT                       
*                                                                               
         OC    DRTRTN,DRTRTN       TEST TOTAL ROUTINE GIVEN                     
         BZ    VDRN610                                                          
         BUILD 2,=X'820A'          GENERATE TOTAL ROUTINE ELEMENT               
         BUILD 8,DRTRTN                                                         
*                                                                               
VDRN610  CLI   DRTNARGS,0          TEST NO. OF ARGS                             
         BNE   *+16                                                             
         OC    DRTARGS,DRTARGS     TEST ANY ARGUMENTS GIVEN                     
         BZ    VDRN620                                                          
         DC    H'0'                                                             
         BUILD 1,=X'83'            ELEMENT CODE                                 
         ZIC   R2,DRTNARGS                                                      
         LA    R2,2(R2)                                                         
         STC   R2,BYTE                                                          
         BUILD 1,BYTE                                                           
         ZIC   R2,DRTNARGS                                                      
         BUILD (R2),DRTARGS                                                     
*                                                                               
VDRN620  CLI   DRTSPACE,0          TEST SPACE OPTION REQUESTED                  
         BE    VDRN630                                                          
         BUILD 3,=X'460402'        GENERATE SPACE OPTION                        
         BUILD 1,DRTSPACE                                                       
*                                                                               
VDRN630  TM    DRTOPTS,DRTSKIP     TEST SKIP GIVEN                              
         BZ    VDRN640                                                          
         BUILD 4,=X'46040100'      GENERATE SKIP                                
*                                                                               
VDRN640  TM    DRTOPTS,DRTPAGE     TEST PAGE GIVEN                              
         BZ    VDRN650                                                          
         BUILD 4,=X'46040300'      GENERATE PAGE                                
*                                                                               
VDRN650  TM    DRTOPTS,DRTSUBPG    TEST SUBPAGE GIVEN                           
         BZ    VDRN655                                                          
         BUILD 4,=X'46040400'      GENERATE SUBPAGE                             
*                                                                               
VDRN655  TM    DRTOPTS,DRTMIDHD    TEST MIDHEAD GIVEN                           
         BZ    VDRN660                                                          
         BUILD 4,=X'46040500'      GENERATE MIDHEAD                             
*                                                                               
VDRN660  CLI   DRTLITLN,0          TEST LITERAL GIVEN                           
         BE    VDRN670                                                          
         BUILD 1,=X'87'            ELEMENT CODE FOR LITERALS                    
         ZIC   R5,DRTLITLN         LENGTH OF LITERAL                            
         LA    R2,3(R5)            PLUS 3 FOR OVERHEAD                          
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              GENERATE ELEMENT LENGTH                      
         BUILD 1,=AL1(0)           DUMMY BYTE                                   
         LA    R2,DRTLIT           LITERAL                                      
         BUILD (R5),0(R2)                                                       
*                                                                               
VDRN670  OC    DRTDET,DRTDET       TEST DETAIL OPTION REQUESTED                 
         BZ    VDRONEX             NO                                           
         BUILD 2,=X'4904'          GENERATE DETAIL OPTION                       
         BUILD 2,DRTDET                                                         
*                                                                               
VDRONEX  B     EXIT7                                                            
         DROP  R4                                                               
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                     CONCLUDE DRIVAL                              *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
DRCLOSE  NTR1                                                                   
*                                                                               
         MVI   DBCNTRL,0           RESET CONTROL BYTE                           
*                                                                               
         BUILD 2,=X'0000'          TERMINATION CHARACTERS                       
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                 VALIDATE STATEMENT (AND LABEL)                   *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VSTMT    NTR1                                                                   
*                                                                               
         L     R5,ASTMTS           TABLE OF STATEMENTS                          
*                                                                               
VSTMTA   CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBSTMT     INVALID STATEMENT                            
         B     ERR                                                              
*                                                                               
         CLC   0(5,R5),9(R4)       TEST FOR MATCH IN TABLE                      
         BE    *+12                                                             
         LA    R5,9(R5)            NEXT TABLE ENTRY                             
         B     VSTMTA                                                           
*                                                                               
         CLC   0(8,R4),SPACES      TEST LABEL ON STATEMENT                      
         BNE   *+20                THERE IS -- JUMP                             
         CLI   8(R5),C'Y'          TEST FOR MANDATORY LABEL                     
         BNE   *+12                                                             
         MVI   DBERRNUM,DBNOLBL    LABEL MUST BE THERE                          
         B     ERR                                                              
*                                                                               
         ZIC   R3,6(R5)            LENGTH OF ELEMENT                            
         BUILD (R3),5(R5)          STORE ELEMENT CODE AND LENGTH                
*                                                                               
         CLC   0(8,R4),SPACES      TEST LABEL ON STATEMENT                      
         BE    VSTMTX                                                           
         CLI   8(R5),C'N'          TEST LABEL NOT PERMITTED                     
         BNE   *+12                                                             
         MVI   DBERRNUM,DBEXTLBL                                                
         B     ERR                                                              
*                                                                               
         BCTR  R7,0                MOVE ELEMENT POINTER TO LENGTH               
         BUILD 1,=X'0A'            LENGTH OF ELEMENT WITH LABEL                 
         BUILD 8,0(R4)             BUILD LABEL                                  
*                                                                               
VSTMTX   B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    VALIDATE REC STATEMENT                        *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VREC     NTR1                                                                   
*                                                                               
VRECA    ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VRECC               TRY NEXT TABLE ENTRY                         
*                                                                               
         L     R5,ARECOPTS         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VRECB    CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(6,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,12(R5)           NEXT TABLE ENTRY                             
         B     VRECB                                                            
*                                                                               
         BUILD 2,6(R5)             PUT OPTION CODE IN ELEMENT                   
         L     RF,8(R5)            ADDRESS OF VALIDATION ROUTINE                
         A     RF,RELO                                                          
         BASR  RE,RF               PERFORM ARGUMENT VALIDATION                  
*                                                                               
VRECC    LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    VRECA               NO -- GET NEXT OPTION                        
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    VALIDATE SET STATEMENT                        *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VSET     NTR1                                                                   
*                                                                               
         ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         L     R5,ASETOPTS         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VSETA    CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(4,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,8(R5)            NEXT TABLE ENTRY                             
         B     VSETA                                                            
*                                                                               
         LA    R4,74(R4)           POINT TO FIRST PARAMETER IN BLOCK            
         L     RF,4(R5)            ADDRESS OF VALIDATION ROUTINE                
         A     RF,RELO                                                          
         BASR  RE,RF               PERFORM ARGUMENT VALIDATION                  
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                  VALIDATE IN/OUT STATEMENTS                      *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VIN      NTR1                                                                   
         MVI   WHERE,C'I'          INPUT PARAMETERS                             
         L     R3,AINARGS          TABLE OF INPUT OPTIONS                       
         B     VINOUTA                                                          
*                                                                               
VOUT     NTR1                                                                   
         MVI   WHERE,C'O'          OUTPUT PARAMETERS                            
         L     R3,AOUTARGS         TABLE OF OUTPUT OPTIONS                      
*                                                                               
VINOUTA  ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VINOUTC             TRY NEXT TABLE ENTRY                         
*                                                                               
         LR    R5,R3               TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VINOUTB  CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         BAS   RE,VOPT             MAYBE IT'S A SPECIAL OPTION                  
         B     VINOUTC                                                          
*                                                                               
         CLC   0(10,R5),12(R4)     FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,16(R5)           NEXT TABLE ENTRY                             
         B     VINOUTB                                                          
*                                                                               
         BUILD 2,10(R5)            PUT CODE AND LENGTH IN ELEMENT               
         L     RF,12(R5)           ADDRESS OF VALIDATION ROUTINE                
         A     RF,RELO                                                          
         BASR  RE,RF               PERFORM ARGUMENT VALIDATION                  
*                                                                               
VINOUTC  LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    VINOUTA             NO -- GET NEXT OPTION                        
*                                                                               
         CLI   DBOPCODE,X'14'      TEST CAME FROM SET STATEMENT                 
         BE    *+10                                                             
         MVC   DBDICTNM,SAVEDICT   RESTORE DICTIONARY NAME                      
*                                                                               
         MVI   WHERE,C' '          RESET IN/OUT FLAG                            
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    VALIDATE HEAD STATEMENT                       *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VHEAD    NTR1                                                                   
*                                                                               
         MVI   WHERE,C'H'          HEAD PARAMETERS                              
*                                                                               
VHEADA   ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VHEADC              TRY NEXT TABLE ENTRY                         
*                                                                               
         L     R5,AHEADARG         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VHEADB   CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         BAS   RE,VOPT             MAYBE IT'S A SPECIAL OPTION                  
         B     VHEADC                                                           
*                                                                               
         CLC   0(10,R5),12(R4)     FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,16(R5)           NEXT TABLE ENTRY                             
         B     VHEADB                                                           
*                                                                               
         BUILD 2,10(R5)            PUT CODE AND LENGTH IN ELEMENT               
         L     RF,12(R5)           ADDRESS OF VALIDATION ROUTINE                
         A     RF,RELO                                                          
         BASR  RE,RF               PERFORM ARGUMENT VALIDATION                  
*                                                                               
VHEADC   LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    VHEADA              NO -- GET NEXT OPTION                        
*                                                                               
         MVI   WHERE,C' '          RESET IN/OUT/HEAD FLAG                       
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    VALIDATE CHUNK STATEMENT                      *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VCHUNK   NTR1                                                                   
*                                                                               
VCHUNKA  ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VCHUNKC             TRY NEXT TABLE ENTRY                         
*                                                                               
         L     R5,ACHNKOPS         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VCHUNKB  CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(10,R5),12(R4)     FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,16(R5)           NEXT TABLE ENTRY                             
         B     VCHUNKB                                                          
*                                                                               
         BUILD 2,10(R5)            PUT CODE AND LENGTH IN ELEMENT               
         L     RF,12(R5)           ADDRESS OF VALIDATION ROUTINE                
         A     RF,RELO                                                          
         BASR  RE,RF               PERFORM ARGUMENT VALIDATION                  
*                                                                               
VCHUNKC  LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    VCHUNKA             NO -- GET NEXT OPTION                        
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                 VALIDATE FIRST/LAST STATEMENTS                   *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VFL      NTR1                                                                   
*                                                                               
VFLA     ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VFLD                TRY NEXT TABLE ENTRY                         
*                                                                               
         L     R5,AFLOPTS          TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VFLB     CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(9,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,16(R5)           NEXT TABLE ENTRY                             
         B     VFLB                                                             
*                                                                               
         BUILD 2,9(R5)             PUT CODE AND LENGTH IN ELEMENT               
         OC    13(3,R5),13(R5)     TEST VALIDATION ROUTINE IS NEEDED            
         BNZ   VFLC                                                             
*                                                                               
         BUILD 2,11(R5)            PUT CODE AND LENGTH IN ELEMENT               
         CLI   11(R5),2            TEST 'SPACE' OPTION                          
         BNE   VFLD                                                             
         TM    3(R4),X'80'         TEST ARGUMENT NUMERIC                        
         BO    *+12                NO -- ERROR                                  
         MVI   DBERRNUM,DBARG      INVALID ARGUMENT                             
         B     ERR                                                              
*                                                                               
         ICM   R2,15,8(R4)         NUMERIC VALUE                                
         C     R2,=F'1'            TEST VALUE WITHIN RANGE                      
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT                                                
         B     ERR                                                              
         C     R2,=F'255'                                                       
         BNH   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT                                                
         B     ERR                                                              
*                                                                               
         BCTR  R7,0                BACK UP ELEMENT POINTER                      
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              PUT NUMBER SPACES IN ELEMENT                 
         B     VFLD                                                             
*                                                                               
VFLC     L     RF,12(R5)           ADDRESS OF VALIDATION ROUTINE                
         A     RF,RELO                                                          
         BASR  RE,RF               PERFORM ARGUMENT VALIDATION                  
*                                                                               
VFLD     LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    VFLA                NO -- GET NEXT OPTION                        
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    VALIDATE TOTAL STATEMENT                      *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VTOT     NTR1                                                                   
*                                                                               
VTOTA    ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VTOTE               TRY NEXT TABLE ENTRY                         
*                                                                               
         L     R5,ATOTOPTS         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VTOTB    CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(8,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,16(R5)           NEXT TABLE ENTRY                             
         B     VTOTB                                                            
*                                                                               
         BUILD 2,9(R5)             PUT CODE AND LENGTH IN ELEMENT               
         OC    13(3,R5),13(R5)     TEST VALIDATION ROUTINE IS NEEDED            
         BNZ   VTOTD                                                            
         BUILD 2,11(R5)            BUILD REMAINDER OF ELEMENT                   
*                                                                               
         TM    8(R5),X'80'         TEST NUMERIC ARGUMENT MUST FOLLOW            
         BZ    VTOTE                                                            
*                                                                               
         TM    3(R4),X'80'         TEST ARGUMENT NUMERIC                        
         BO    *+12                NO -- ERROR                                  
         MVI   DBERRNUM,DBARG      INVALID ARGUMENT                             
         B     ERR                                                              
*                                                                               
         ICM   R2,15,8(R4)         NUMERIC VALUE                                
         C     R2,=F'1'            TEST VALUE WITHIN RANGE                      
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT                                                
         B     ERR                                                              
         C     R2,=F'255'                                                       
         BNH   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT                                                
         B     ERR                                                              
*                                                                               
         CLI   11(R5),2            TEST 'SPACE' OPTION                          
         BNE   VTOTC               NO                                           
         BCTR  R7,0                BACK UP ELEMENT POINTER                      
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              PUT NUMBER SPACES IN ELEMENT                 
         B     VTOTE                                                            
*                                                                               
VTOTC    SH    R7,=H'2'            MUST BE 'DETAIL' OPTION                      
         STC   R2,BYTE             BACK UP 2 BYTES                              
         BUILD 1,BYTE              PUT DETAIL LEVEL IN ELEMENT                  
         LA    R7,1(R7)            RESET ELEMENT POINTER                        
         B     VTOTE                                                            
*                                                                               
VTOTD    L     RF,12(R5)           ADDRESS OF VALIDATION ROUTINE                
         A     RF,RELO                                                          
         BASR  RE,RF               PERFORM ARGUMENT VALIDATION                  
*                                                                               
VTOTE    LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    VTOTA               NO -- GET NEXT OPTION                        
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    VALIDATE COMP STATEMENT                       *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VCOMP    NTR1                                                                   
*                                                                               
         BUILD 4,=X'520D7E00'      ELEMENT CODE, LENGTH, EQUALS SIGN            
         MVI   BYTE,C'Y'           WE MAY BEGIN WITH LITERAL                    
         B     VCOMPC              FIRST OPERATOR IS '=' BY DEFAULT             
*                                                                               
VCOMPA   ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VCOMPF              TRY NEXT TABLE ENTRY                         
*                                                                               
         BUILD 2,=X'520D'          ELEMENT CODE AND LENGTH                      
         L     R5,ACOMPOPS         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VCOMPB   CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(3,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,6(R5)            NEXT TABLE ENTRY                             
         B     VCOMPB                                                           
*                                                                               
         BUILD 2,4(R5)             OPERATOR AND 'V' NUMBER OR ZERO              
         MVC   BYTE,3(R5)          SAYS IF LITERAL MAY FOLLOW OPERATOR          
         LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
*                                                                               
VCOMPC   C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    *+12                NO -- GET NEXT OPTION                        
         MVI   DBERRNUM,DBNOOPT                                                 
         B     ERR                                                              
*                                                                               
         ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VCOMPF              TRY NEXT TABLE ENTRY                         
*                                                                               
         XC    WORK,WORK                                                        
         CLI   12(R4),C'-'         TEST MINUS SIGN IN INPUT                     
         BE    VCOMPD                                                           
*                                                                               
         MVC   WORK(17),=17X'F0'   VALID NUMERIC CHARACTERS                     
         ZIC   R2,0(R4)            INPUT LENGTH                                 
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVN   WORK(0),12(R4)                                                   
         EX    R2,*+8                                                           
         B     *+10                                                             
         CLC   WORK(0),12(R4)      TEST NUMERIC                                 
         BNE   VCOMPE              NO -- IT'S A LABEL                           
*                                                                               
         CLI   BYTE,C'Y'           TEST LITERAL IS ALLOWED HERE                 
         BE    *+12                YES                                          
         MVI   DBERRNUM,DBOPT      NO - INVALID OPTION                          
         B     ERR                                                              
*                                                                               
         BUILD 1,=AL1(1)           IT'S A LITERAL                               
         BUILD 4,4(R4)             PUT NUMERIC VALUE IN ELEMENT                 
         BUILD 4,=X'00000000'      CLEAR REMAINING 4 BYTES                      
         B     VCOMPF                                                           
*                                                                               
VCOMPD   CLI   0(R4),1             TEST ANY DIGITS FOLLOW MINUS SIGN            
         BNE   *+12                YES                                          
         MVI   DBERRNUM,DBOPT                                                   
         B     ERR                                                              
*                                                                               
         MVC   WORK(17),=17X'F0'   VALID NUMERIC CHARACTERS                     
         ZIC   R2,0(R4)            INPUT LENGTH                                 
         BCTR  R2,0                MINUS ONE FOR MINUS SIGN                     
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVN   WORK(0),13(R4)                                                   
         EX    R2,*+8                                                           
         B     *+10                                                             
         CLC   WORK(0),13(R4)      TEST NUMERIC                                 
         BNE   VCOMPE              NO -- IT'S A LABEL                           
*                                                                               
         CLI   BYTE,C'Y'           TEST LITERAL IS ALLOWED HERE                 
         BE    *+12                YES                                          
         MVI   DBERRNUM,DBOPT      NO - INVALID OPTION                          
         B     ERR                                                              
*                                                                               
         BUILD 1,=AL1(1)           IT'S A LITERAL                               
         LA    R3,WORK+0(R2)       POINT TO LAST BYTE OF NUMBER                 
         NI    0(R3),X'DF'         MINUS SIGN                                   
         EX    R2,*+8                                                           
         B     *+10                                                             
         PACK  DUB,WORK(0)                                                      
         CVB   R3,DUB                                                           
         STCM  R3,15,FULL                                                       
         BUILD 4,FULL              STORE NUMERIC VALUE                          
         BUILD 4,=X'00000000'      CLEAR REMAINING 4 BYTES                      
         B     VCOMPF                                                           
*                                                                               
VCOMPE   BUILD 1,=AL1(0)           IT'S A LABEL                                 
         BAS   RE,VLABEL1          VALIDATE THE LABEL                           
*                                                                               
VCOMPF   LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    VCOMPA              NO -- GET NEXT OPTION                        
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                    VALIDATE COND STATEMENT                       *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
VCOND    NTR1                                                                   
*                                                                               
VCOND1   ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    *+12                NO -- GET NEXT OPTION                        
         MVI   DBERRNUM,DBNOOPT                                                 
         B     ERR                                                              
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BNE   *+12                YES -- GO GET IT                             
         LA    R4,74(R4)           NO -- TRY AGAIN                              
         B     VCOND1                                                           
*                                                                               
         BUILD 2,=X'6209'          ELEMENT CODE AND LENGTH                      
         L     R5,ACNDCONJ         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VCONDA   CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(3,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,3(R5)            NEXT TABLE ENTRY                             
         B     VCONDA                                                           
*                                                                               
         BUILD 1,0(R5)             CONDITION CODE                               
VCOND2   LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    *+12                NO -- GET NEXT OPTION                        
         MVI   DBERRNUM,DBNOOPT                                                 
         B     ERR                                                              
*                                                                               
         ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VCOND2              TRY NEXT TABLE ENTRY                         
*                                                                               
         L     R5,ACNDFLDS         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VCONDB   CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(6,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,8(R5)            NEXT TABLE ENTRY                             
         B     VCONDB                                                           
*                                                                               
         BUILD 2,6(R5)             FIELD CODES                                  
VCOND3   LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    *+12                NO -- GET NEXT OPTION                        
         MVI   DBERRNUM,DBNOOPT                                                 
         B     ERR                                                              
*                                                                               
         ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VCOND3              TRY NEXT TABLE ENTRY                         
*                                                                               
         L     R5,ACONDOPS         TABLE OF ACCEPTABLE OPERATORS                
*                                                                               
VCONDC   CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(2,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,2(R5)            NEXT TABLE ENTRY                             
         B     VCONDC                                                           
*                                                                               
         BUILD 2,0(R5)             OPERATOR CODE                                
VCOND4   LA    R4,74(R4)           NEXT OPTION IN SCANNER BLOCK                 
         C     R4,ABLOCKX          TEST END OF TABLE                            
         BL    *+12                NO -- GET NEXT OPTION                        
         MVI   DBERRNUM,DBNOOPT                                                 
         B     ERR                                                              
*                                                                               
         ZIC   R1,OPTNUM           INCREMENT SCANNER ENTRY NUMBER               
         LA    R1,1(R1)                                                         
         STC   R1,OPTNUM                                                        
*                                                                               
         CLI   0(R4),0             TEST ANY OPTION IN THIS ENTRY                
         BE    VCOND4              TRY NEXT TABLE ENTRY                         
*                                                                               
         L     R5,ACNDFLDS         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VCONDD   CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BE    VCONDE                                                           
*                                                                               
         CLC   0(6,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,8(R5)            NEXT TABLE ENTRY                             
         B     VCONDD                                                           
*                                                                               
         BUILD 2,6(R5)             FIELD CODES                                  
         B     VCONDX                                                           
*                                                                               
VCONDE   TM    2(R4),X'80'         TEST ARGUMENT NUMERIC                        
         BZ    VCONDF              NO - MAYBE IT'S A CHARACTER ARGUMENT         
*                                                                               
         ICM   R2,15,4(R4)         NUMERIC VALUE                                
         C     R2,=F'0'            TEST VALUE WITHIN RANGE                      
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNUMOU1                                                
         B     ERR                                                              
         C     R2,=F'255'                                                       
         BNH   *+12                                                             
         MVI   DBERRNUM,DBNUMOU1                                                
         B     ERR                                                              
*                                                                               
         BUILD 1,=AL1(0)           PUT ARGUMENT IN ELEMENT                      
         STC   R2,BYTE                                                          
         BUILD 1,BYTE                                                           
         B     VCONDX                                                           
*                                                                               
VCONDF   CLI   12(R4),C'X'         TEST HEX ARGUMENT                            
         BE    VCONDH                                                           
*                                                                               
         CLI   0(R4),4             C' ' HAS LENGTH OF EXACTLY 4 OR 5            
         BE    *+20                                                             
         CLI   0(R4),5                                                          
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         CLC   12(2,R4),=C'C'''    LOOK FOR C' AS FIRST 2 CHARACTERS            
         BE    *+12                IT MAY BE A CHARACTER                        
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         CLI   0(R4),4                                                          
         BNE   VCONDG                                                           
         CLI   15(R4),C''''                                                     
         BE    *+12                IT IS A CHARACTER                            
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         BUILD 1,=AL1(0)           MOVE CHARACTER INTO ELEMENT                  
         BUILD 1,14(R4)                                                         
         B     VCONDX                                                           
*                                                                               
VCONDG   CLI   16(R4),C''''                                                     
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         BUILD 2,14(R4)            MOVE TWO CHARACTERS INTO ELEMENT             
         B     VCONDX                                                           
*                                                                               
VCONDH   CLI   0(R4),5             X'  ' HAS LENGTH OF EXACTLY FIVE             
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         CLC   12(2,R4),=C'X'''    LOOK FOR X'  ' ARGUMENT                      
         BE    *+12                IT MAY BE                                    
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         CLI   16(R4),C''''                                                     
         BE    *+12                IT STILL MAY BE HEX ARGUMENT                 
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         MVC   HALF,14(R4)         VERIFY AND CONVERT EBCDIC TO HEX             
         GOTO1 CHEXIN,DMCB,HALF,BYTE,2                                          
         CLI   15(R1),1            TEST VALID HEX                               
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         BUILD 1,=AL1(0)           PUT HEX ARGUMENT INTO ELEMENT                
         BUILD 1,BYTE                                                           
*                                                                               
VCONDX   B     EXIT7                                                            
         EJECT                                                                  
********************************************************************            
*                                                                  *            
*                   COMMON VALIDATION ROUTINES                     *            
*                                                                  *            
********************************************************************            
*                                                                               
*                                                                               
* VALIDATE DICTIONARY NAME                                                      
*                                                                               
VDNAME   NTR1                                                                   
*                                                                               
         MVC   FIELDLEN,1(R4)      LENGTH OF OPTION                             
*                                                                               
         ZIC   R2,FIELDLEN                                                      
         C     R2,=F'1'            TEST BETWEEN 1 AND 8 CHARACTERS              
         BNL   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         C     R2,=F'8'                                                         
         BNH   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         MVC   FIELD,SPACES        CLEAR FIELD                                  
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   FIELD(0),22(R4)     ACTUAL DATA                                  
         BUILD 8,FIELD             MOVE NAME INTO ELEMENT                       
*                                                                               
         CLI   DBOPCODE,X'14'      TEST CAME FROM SET STATEMENT                 
         BE    *+10                                                             
         MVC   SAVEDICT,DBDICTNM   SAVE CURRENT DICTIONARY NAME                 
         MVC   DBDICTNM,FIELD      SET NEW DICTIONARY NAME                      
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE ENTRY NAME                                                           
*                                                                               
VENAME   NTR1                                                                   
*                                                                               
         CLI   INMODE,C'S'         TEST FOUND IN SCANNER TABLE                  
         BNE   *+20                                                             
*                                                                               
         MVC   FIELDLEN,1(R4)      LENGTH OF OPTION -- SCANNER TABLE            
         MVC   FIELD(8),22(R4)     ACTUAL DATA                                  
         B     *+20                                                             
*                                                                               
         MVC   FIELDLEN,5(R4)      LENGTH OF OPTION -- SCREEN FIELD             
         MVC   FIELD(8),8(R4)      ACTUAL DATA                                  
         LA    R7,1(R7)            MOVE PAST SUB-ENTRY SEQUENCE NUMBER          
*                                                                               
         ZIC   R2,FIELDLEN                                                      
         C     R2,=F'1'            TEST BETWEEN 1 AND 8 CHARACTERS              
         BNL   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         C     R2,=F'8'                                                         
         BNH   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         USING DICKEYD,R3                                                       
         LA    R3,KEY                                                           
*                                                                               
         XC    KEY,KEY                                                          
         MVI   DICSYS,DICSYSQ      SYSTEM                                       
         MVI   DICKTYP,DICKTYPQ    RECORD TYPE                                  
         MVC   DICCODE,DBDICTNM    DICTIONARY NAME                              
         MVC   DICENTRY,FIELD      ENTRY NAME                                   
         OC    DICENTRY,SPACES     PAD WITH BLANKS                              
*                                                                               
         CLC   CDATAMGR,=F'0'      MAKE SURE WE HAVE V(DATAMGR)                 
         BE    VENAME20            WE DON'T: USE CURRENT DICTIONARY             
*                                                                               
         MVC   KEYSAVE,KEY                                                      
         GOTO1 CDATAMGR,DMCB,=C'DMRDHI',=C'GENDIR',KEYSAVE,KEY                  
         CLI   8(R1),0                                                          
         BE    *+6                                                              
         DC    H'0'                BAD DATAMGR RETURN CODE                      
*                                                                               
         CLC   KEY(28),KEYSAVE     TEST WAS RECORD FOUND                        
         BNE   VENAME30            NO                                           
*                                                                               
VENAME20 DS    0H                                                               
         LA    R3,KEY                                                           
         BUILD 8,DICENTRY          PUT ENTRY NAME IN ELEMENT                    
         B     VENAMEX                                                          
*                                                                               
VENAME30 XC    KEY,KEY             TRY ALTERNATE DICTIONARY                     
         MVI   DICSYS,DICSYSQ      SYSTEM                                       
         MVI   DICKTYP,DICKTYPQ    RECORD TYPE                                  
         MVC   DICCODE,DBALTDIC    ALTERNATE DICTIONARY NAME                    
         MVC   DICENTRY,FIELD      ENTRY NAME                                   
         OC    DICENTRY,SPACES     PAD WITH BLANKS                              
*                                                                               
         MVC   KEYSAVE,KEY                                                      
         GOTO1 CDATAMGR,DMCB,=C'DMRDHI',=C'GENDIR',KEYSAVE,KEY                  
         CLI   8(R1),0                                                          
         BE    *+6                                                              
         DC    H'0'                BAD DATAMGR RETURN CODE                      
*                                                                               
         CLC   KEY(28),KEYSAVE     TEST WAS RECORD FOUND                        
         BE    *+12                                                             
         MVI   DBERRNUM,DBNOENT    RECORD NOT FOUND                             
         B     ERR                                                              
*                                                                               
         LA    R3,KEY                                                           
         BUILD 8,DICENTRY          PUT ENTRY NAME IN ELEMENT                    
         BUILD 2,=X'800A'          BUILD DICTIONARY ELEMENT                     
         BUILD 8,DBALTDIC                                                       
*                                                                               
VENAMEX  B     EXIT7                                                            
         DROP  R3                                                               
         EJECT                                                                  
* VALIDATE ROUTINE NAME                                                         
*                                                                               
VRNAME   NTR1                                                                   
*                                                                               
         CLI   INMODE,C'S'         TEST FOUND IN SCANNER TABLE                  
         BNE   *+18                NO, ITS A SCREEN FIELD                       
         MVC   FIELDLEN,1(R4)      LENGTH OF OPTION                             
         LA    R4,22(R4)           A(DATA)                                      
         B     *+14                                                             
*                                                                               
         MVC   FIELDLEN,5(R4)      LENGTH OF OPTION                             
         LA    R4,8(R4)            A(DATA)                                      
*                                                                               
         ZIC   R2,FIELDLEN                                                      
         C     R2,=F'1'            TEST BETWEEN 1 AND 8 CHARACTERS              
         BNL   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         C     R2,=F'8'                                                         
         BNH   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         MVC   FIELD,SPACES        REPLACE NULLS WITH BLANKS                    
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   FIELD(0),0(R4)      ACTUAL DATA                                  
         BUILD 8,FIELD             MOVE NAME INTO ELEMENT                       
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE SYSTEM ROUTINE ARGUMENT LIST                                         
*                                                                               
VRARGS   NTR1                                                                   
*                                                                               
         XC    WORK,WORK                                                        
         XC    SCANBLK,SCANBLK                                                  
         XC    SCANOFLO,SCANOFLO                                                
*                                                                               
         CLI   INMODE,C'S'         TEST FOUND IN SCANNER TABLE                  
         BNE   VRARGSA             NO, ITS A SCREEN FIELD                       
*                                                                               
         FLDG  22(R4),WORK,1(R4)   PREPARE ARGUMENTS FOR SCANNER                
         B     VRARGS1                                                          
*                                                                               
VRARGSA  ZIC   R1,0(R4)            LENGTH OF ENTIRE FIELD WITH HEADER           
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK(0),0(R4)       ARGUMENT LIST                                
*                                                                               
VRARGS1  CLI   WORK+8,C'L'         TEST LONG HEX STRING                         
         BNE   VRARGSB                                                          
         CLI   WORK+9,C''''        THESE BEGIN WITH QUOTE                       
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         ZIC   R2,WORK+5           TOTAL LENGTH OF INPUT                        
         SH    R2,=H'3'            SUBTRACT SURROUNDING DELIMITERS              
         SRL   R2,1                GIVES NUMBER OF ARGUMENTS                    
         CH    R2,=H'16'           TEST TOO MANY ARGUMENTS                      
         BNH   *+12                                                             
         MVI   DBERRNUM,DBEXTARG                                                
         B     ERR                                                              
*                                                                               
         BCTR  R7,0                BACK UP ELEMENT POINTER TO LENGTH            
         LR    R3,R2                                                            
         LA    R3,2(R3)            TOTAL LENGTH OF ELEMENT                      
         STC   R3,BYTE                                                          
         BUILD 1,BYTE              STORE LENGTH OF ELEMENT                      
*                                                                               
         LA    R3,WORK+10                                                       
*                                                                               
VRARGS2  MVC   HALF,0(R3)          VERIFY AND CONVERT EBCDIC TO HEX             
         GOTO1 CHEXIN,DMCB,HALF,BYTE,2                                          
         CLI   15(R1),1            TEST VALID HEX                               
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         BUILD 1,BYTE                                                           
         LA    R3,2(R3)            NEXT EBCDIC PAIR                             
         BCT   R2,VRARGS2                                                       
*                                                                               
         CLI   0(R3),C''''         MUST END WITH QUOTE                          
         BE    VRARGSX                                                          
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
VRARGSB  LA    R4,SCANBLK                                                       
         GOTO1 CSCANNER,DMCB,(10,WORK),(9,(R4)),C',=/ '                         
*                                                                               
         CLI   4(R1),0             SHOULD BE AT LEAST ONE ARGUMENT              
         BNE   *+12                                                             
         MVI   DBERRNUM,DBNOARG                                                 
         B     ERR                                                              
*                                                                               
         XC    DMCB,DMCB                                                        
         CLI   4(R1),8             MAXIMUM OF EIGHT ARGUMENTS                   
         BNH   *+12                                                             
         MVI   DBERRNUM,DBEXTARG                                                
         B     ERR                                                              
*                                                                               
         ZIC   R2,4(R1)            NUMBER OF ARGUMENTS                          
         BCTR  R7,0                BACK UP ELEMENT POINTER TO LENGTH            
         LR    R3,R2                                                            
         LA    R3,2(R3)            TOTAL LENGTH OF ELEMENT                      
         STC   R3,BYTE                                                          
         BUILD 1,BYTE              STORE LENGTH OF ELEMENT                      
*                                                                               
VRARGSC  TM    2(R4),X'80'         TEST ARGUMENT NUMERIC                        
         BZ    VRARGSD             NO - MAYBE IT'S A CHARACTER ARGUMENT         
*                                                                               
         ICM   R3,15,4(R4)         NUMERIC VALUE                                
         C     R3,=F'1'            TEST VALUE WITHIN RANGE                      
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT                                                
         B     ERR                                                              
         C     R3,=F'255'                                                       
         BNH   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT                                                
         B     ERR                                                              
*                                                                               
         STC   R3,BYTE                                                          
         BUILD 1,BYTE              PUT ARGUMENT IN ELEMENT                      
         B     VRARGSF                                                          
*                                                                               
VRARGSD  CLI   0(R4),4             C' ' HAS LENGTH OF EXACTLY FOUR              
         BNE   VRARGSE             MAYBE IT'S A HEX ARGUMENT                    
*                                                                               
         CLC   12(2,R4),=C'C'''    LOOK FOR C' ' ARGUMENT                       
         BE    *+12                IT MAY BE A CHARACTER                        
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         CLI   15(R4),C''''                                                     
         BE    *+12                IT IS A CHARACTER                            
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         BUILD 1,14(R4)            MOVE ARGUMENT INTO ELEMENT                   
         B     VRARGSF                                                          
*                                                                               
VRARGSE  CLI   0(R4),5             X'  ' HAS LENGTH OF EXACTLY FIVE             
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         CLC   12(2,R4),=C'X'''    LOOK FOR X'  ' ARGUMENT                      
         BE    *+12                IT MAY BE                                    
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         CLI   16(R4),C''''                                                     
         BE    *+12                IT STILL MAY BE HEX ARGUMENT                 
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         MVC   HALF,14(R4)         VERIFY AND CONVERT EBCDIC TO HEX             
         GOTO1 CHEXIN,DMCB,HALF,BYTE,2                                          
         CLI   15(R1),1            TEST VALID HEX                               
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         BUILD 1,BYTE              PUT HEX ARGUMENT INTO ELEMENT                
*                                                                               
VRARGSF  LA    R4,32(R4)           NEXT ARGUMENT                                
         BCT   R2,VRARGSC                                                       
*                                                                               
VRARGSX  B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE ENTRY ATTRIBUTE LIST                                                 
*                                                                               
VATTRIB  NTR1                                                                   
*                                                                               
         XC    WORK,WORK                                                        
         XC    SCANBLK,SCANBLK                                                  
         XC    SCANOFLO,SCANOFLO                                                
*                                                                               
         ZIC   R1,0(R4)            LENGTH OF ENTIRE FIELD WITH HEADER           
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK(0),0(R4)       ARGUMENT LIST                                
*                                                                               
         LA    R4,SCANBLK                                                       
         GOTO1 CSCANNER,DMCB,(10,WORK),(9,(R4)),C',=/ '                         
*                                                                               
         CLI   4(R1),0             SHOULD BE AT LEAST ONE ARGUMENT              
         BNE   *+12                                                             
         MVI   DBERRNUM,DBNOARG                                                 
         B     ERR                                                              
*                                                                               
         XC    DMCB,DMCB                                                        
         CLI   4(R1),8             MAXIMUM OF EIGHT ARGUMENTS                   
         BNH   *+12                                                             
         MVI   DBERRNUM,DBEXTARG                                                
         B     ERR                                                              
*                                                                               
         ZIC   R2,4(R1)            NUMBER OF ARGUMENTS                          
*                                                                               
VATTRIBC TM    2(R4),X'80'         TEST ARGUMENT NUMERIC                        
         BZ    VATTRIBD            NO - MAYBE IT'S A CHARACTER ARGUMENT         
*                                                                               
         ICM   R3,15,4(R4)         NUMERIC VALUE                                
         C     R3,=F'1'            TEST VALUE WITHIN RANGE                      
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT                                                
         B     ERR                                                              
         C     R3,=F'255'                                                       
         BNH   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT                                                
         B     ERR                                                              
*                                                                               
         STC   R3,BYTE                                                          
         BUILD 1,BYTE              PUT ARGUMENT IN ELEMENT                      
         B     VATTRIBF                                                         
*                                                                               
VATTRIBD CLI   0(R4),4             C' ' HAS LENGTH OF EXACTLY FOUR              
         BNE   VATTRIBE            MAYBE IT'S A HEX ARGUMENT                    
*                                                                               
         CLC   12(2,R4),=C'C'''    LOOK FOR C' ' ARGUMENT                       
         BE    *+12                IT MAY BE A CHARACTER                        
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         CLI   15(R4),C''''                                                     
         BE    *+12                IT IS A CHARACTER                            
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         BUILD 1,14(R4)            MOVE ARGUMENT INTO ELEMENT                   
         B     VATTRIBF                                                         
*                                                                               
VATTRIBE CLI   0(R4),5             X'  ' HAS LENGTH OF EXACTLY FIVE             
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         CLC   12(2,R4),=C'X'''    LOOK FOR X'  ' ARGUMENT                      
         BE    *+12                IT MAY BE                                    
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         CLI   16(R4),C''''                                                     
         BE    *+12                IT STILL MAY BE HEX ARGUMENT                 
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         MVC   HALF,14(R4)         VERIFY AND CONVERT EBCDIC TO HEX             
         GOTO1 CHEXIN,DMCB,HALF,BYTE,2                                          
         CLI   15(R1),1            TEST VALID HEX                               
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         BUILD 1,BYTE              PUT HEX ARGUMENT INTO ELEMENT                
*                                                                               
VATTRIBF LA    R4,32(R4)           NEXT ARGUMENT                                
         BCT   R2,VATTRIBC                                                      
*                                                                               
VATTRIBX B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE INPUT TYPE                                                           
*                                                                               
VINTYPE  NTR1                                                                   
*                                                                               
         L     R5,AINTYPES         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
         XC    WORK,WORK                                                        
         XC    SCANBLK,SCANBLK                                                  
*                                                                               
         CLI   INMODE,C'S'         TEST FOUND IN SCANNER TABLE                  
         BNE   VINTYPEA            NO, ITS A SCREEN FIELD                       
*                                                                               
         FLDG  22(R4),WORK,1(R4)   PREPARE ARGUMENTS FOR SCANNER                
         B     VINTYPEB                                                         
*                                                                               
VINTYPEA ZIC   R1,0(R4)            LENGTH OF ENTIRE FIELD WITH HEADER           
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK(0),0(R4)       ARGUMENT LIST                                
*                                                                               
VINTYPEB LA    R4,SCANBLK                                                       
         GOTO1 CSCANNER,DMCB,(10,WORK),(2,(R4)),C',= *'                         
*                                                                               
         CLI   4(R1),1             SHOULD BE AT EXACTLY ONE ENTRY               
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         XC    DMCB,DMCB                                                        
         TM    2(R4),X'80'         TEST FOR REPETITION FACTOR                   
         BZ    VINTYPEC            IT ISN'T THERE                               
         CLI   7(R4),0             TEST REPETITION FACTOR OF ZERO               
         BNE   VINTYPED                                                         
         MVI   DBERRNUM,DBARG      ZERO REPETITION NOT ALLOWED                  
         B     ERR                                                              
*                                                                               
VINTYPEC CLI   1(R4),0             TEST ANY DATA IN SECOND HALF                 
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG      SHOULD NOT BE ANYTHING THERE                 
         B     ERR                                                              
*                                                                               
         MVC   1(1,R4),0(R4)       ADJUST LENGTH FIELD                          
         MVI   0(R4),1                                                          
         MVC   3(1,R4),2(R4)       ADJUST VALIDITY FIELD                        
         MVI   2(R4),X'80'                                                      
         MVC   8(4,R4),4(R4)       ADJUST NUMERIC FIELD                         
         MVC   4(4,R4),=F'1'                                                    
         MVC   22(10,R4),12(R4)    PRETEND SCANNER FOUND FACTOR OF 1            
         MVC   12(10,R4),SPACES                                                 
         MVI   12(R4),C'1'                                                      
*                                                                               
VINTYPED CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBARG      INVALID TYPE                                 
         B     ERR                                                              
*                                                                               
         CLC   0(4,R5),22(R4)      TEST MATCH OF TYPE                           
         BE    *+12                                                             
         LA    R5,7(R5)            NEXT TABLE ENTRY                             
         B     VINTYPED                                                         
*                                                                               
         CLI   7(R4),1             TEST REPETITION FACTOR OF ONE                
         BE    *+20                OK                                           
         CLI   6(R5),C'R'          TEST REPETITION FACTOR IS ALLOWED            
         BE    *+12                IT IS                                        
         MVI   DBERRNUM,DBARG      REPETITION FACTOR NOT ALLOWED                
         B     ERR                                                              
*                                                                               
         BUILD 2,4(R5)             PUT CODES IN ELEMENT                         
         BUILD 1,7(R4)             PUT REPETITION FACTOR IN ELEMENT             
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE OUTPUT TYPE                                                          
*                                                                               
VOUTYPE  NTR1                                                                   
*                                                                               
         L     R5,AOUTTYPS         TABLE OF ACCEPTABLE OPTIONS                  
         MVC   FIELD,SPACES        BLANK OUT FIELD                              
         CLI   INMODE,C'S'         TEST FOUND IN SCANNER TABLE                  
         BNE   VOUTYPEA            NO, ITS A SCREEN FIELD                       
*                                                                               
         MVC   FIELDLEN,1(R4)      LENGTH OF OPTION                             
         ZIC   R2,FIELDLEN                                                      
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   FIELD(0),22(R4)     ACTUAL DATA                                  
         B     VOUTYPEB                                                         
*                                                                               
VOUTYPEA MVC   FIELDLEN,5(R4)      LENGTH OF OPTION                             
         ZIC   R2,FIELDLEN                                                      
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   FIELD(0),8(R4)      ACTUAL DATA                                  
*                                                                               
VOUTYPEB CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBARG      INVALID TYPE                                 
         B     ERR                                                              
*                                                                               
         CLC   0(4,R5),FIELD       DATA HAS BEEN MOVED TO 'FIELD'               
         BE    *+12                                                             
         LA    R5,6(R5)            NEXT TABLE ENTRY                             
         B     VOUTYPEB                                                         
*                                                                               
         BUILD 2,4(R5)             PUT CODES IN ELEMENT                         
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE INPUT/OUTPUT OPTIONS                                                 
*                                                                               
VOPT     NTR1                                                                   
*                                                                               
         CLI   WHERE,C'I'          TEST FROM IN STATEMENT                       
         BE    *+12                                                             
         CLI   DBOPCODE,X'26'      TEST INPUT OPTIONS OPCODE                    
         BNE   VOPTA                                                            
         BUILD 2,=X'2604'          INPUT OPTION                                 
         L     R5,AINOPTS                                                       
         B     VOPTC                                                            
*                                                                               
VOPTA    CLI   WHERE,C'O'          TEST FROM OUT STATEMENT                      
         BE    *+12                                                             
         CLI   DBOPCODE,X'36'      TEST OUTPUT OPTIONS OPCODE                   
         BNE   VOPTB                                                            
         BUILD 2,=X'3604'          OUTPUT OPTION                                
         L     R5,AOUTOPTS                                                      
         B     VOPTC                                                            
*                                                                               
VOPTB    CLI   WHERE,C'H'          TEST FROM HEAD STATEMENT                     
         BE    *+6                                                              
         DC    H'0'                SOMETHING IS DREADFULLY WRONG                
         BUILD 2,=X'3604'          OUTPUT OPTION                                
         L     R5,AHEADOPS                                                      
*                                                                               
VOPTC    CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBOPT      INVALID OPTION                               
         B     ERR                                                              
*                                                                               
         CLC   0(9,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,18(R5)           NEXT TABLE ENTRY                             
         B     VOPTC                                                            
*                                                                               
         CLI   1(R4),0             TEST SECOND HALF IS PRESENT                  
         BNE   VOPTD               IT IS                                        
         CLI   9(R5),C' '          IS OPTION VALID WITHOUT SECOND HALF          
         BE    VOPTE               YES                                          
         LA    R5,18(R5)           NEXT TABLE ENTRY                             
         B     VOPTC                                                            
*                                                                               
VOPTD    CLC   9(7,R5),22(R4)      TEST FOR MATCH OF SECOND HALF                
         BE    VOPTE                                                            
         LA    R5,18(R5)           NEXT TABLE ENTRY                             
         B     VOPTC                                                            
*                                                                               
VOPTE    BUILD 2,16(R5)            PUT CODES IN ELEMENT                         
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE INPUT/OUTPUT LENGTH                                                  
*                                                                               
VLEN     NTR1                                                                   
*                                                                               
         CLI   INMODE,C'S'         TEST FOUND IN SCANNER TABLE                  
         BNE   VLEN10              NO, ITS A SCREEN FIELD                       
*                                                                               
         TM    3(R4),X'80'         TEST DATA NUMERIC                            
         BO    *+12                                                             
         MVI   DBERRNUM,DBARG      ARGUMENT MUST BE NUMERIC                     
         B     ERR                                                              
*                                                                               
         ICM   R2,15,8(R4)         LENGTH                                       
         B     VLEN20                                                           
*                                                                               
VLEN10   TM    4(R4),X'08'         TEST VALID NUMERIC                           
         BO    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         ZIC   R2,5(R4)            NUMBER OF DIGITS                             
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         PACK  DUB,8(0,R4)         ACTUAL DATA                                  
         CVB   R2,DUB              LENGTH                                       
*                                                                               
VLEN20   C     R2,=F'1'                                                         
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT   NUMBER IS TOO LOW                            
         B     ERR                                                              
         C     R2,=F'255'                                                       
         BNH   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT   NUMBER IS TOO HIGH                           
         B     ERR                                                              
*                                                                               
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              PUT LENGTH IN ELEMENT                        
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE LABEL OF CONDITIONAL STATEMENT                                       
*                                                                               
VLABEL   NTR1                      LABEL IN 2ND HALF OF SCANNER TABLE           
*                                                                               
         CLI   1(R4),1             LABEL MUST BE AT LEAST ONE CHARACTER         
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNOARG                                                 
         B     ERR                                                              
         CLI   1(R4),8             AND NO MORE THAN EIGHT CHARACTERS            
         BNH   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         MVC   FIELD,SPACES        PAD LABEL WITH SPACES                        
         ZIC   R3,1(R4)            LENGTH OF LABEL                              
         BCTR  R3,0                                                             
         EX    R3,*+8                                                           
         B     *+10                                                             
         MVC   FIELD(0),22(R4)                                                  
         BUILD 8,FIELD             MOVE LABEL INTO ELEMENT                      
*                                                                               
         B     EXIT7                                                            
         SPACE 5                                                                
VLABEL1  NTR1                      LABEL IN 1ST HALF OF SCANNER TABLE           
*                                                                               
         CLI   0(R4),1             LABEL MUST BE AT LEAST ONE CHARACTER         
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNOARG                                                 
         B     ERR                                                              
         CLI   0(R4),8             AND NO MORE THAN EIGHT CHARACTERS            
         BNH   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         MVC   FIELD,SPACES        PAD LABEL WITH SPACES                        
         ZIC   R3,0(R4)            LENGTH OF LABEL                              
         BCTR  R3,0                                                             
         EX    R3,*+8                                                           
         B     *+10                                                             
         MVC   FIELD(0),12(R4)                                                  
         BUILD 8,FIELD             MOVE LABEL INTO ELEMENT                      
*                                                                               
         B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE LITERALS (CHARACTERS AND HEX)                                        
*                                                                               
VLIT     NTR1                                                                   
*                                                                               
         CLI   INMODE,C'S'         TEST FOUND IN SCANNER TABLE                  
         BNE   VLIT10              NO, ITS A SCREEN FIELD                       
*                                                                               
         MVC   FIELDLEN,1(R4)      LENGTH OF LITERAL                            
         ZIC   R2,FIELDLEN                                                      
         BCTR  R2,0                                                             
         MVC   FIELD,22(R4)        LITERAL                                      
         B     VLIT20                                                           
*                                                                               
VLIT10   MVC   FIELDLEN,5(R4)      LENGTH OF LITERAL                            
         ZIC   R2,FIELDLEN                                                      
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   FIELD(0),8(R4)      LITERAL                                      
*                                                                               
VLIT20   CLI   FIELDLEN,0          TEST LITERAL IS PRESENT                      
         BNE   *+12                                                             
         MVI   DBERRNUM,DBNOARG    LITERAL IS MISSING                           
         B     ERR                                                              
*                                                                               
         CLC   FIELD(2),=C'X'''    TEST HEX LITERAL                             
         BNE   VLIT40              NO, CHARACTER LITERAL                        
         CLI   FIELD+2,C''''       TEST ANYTHING BETWEEN QUOTES                 
         BNE   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         LR    R3,R7                                                            
         BCTR  R3,0                BACK UP TO LENGTH                            
         BUILD 1,=AL1(0)           UNUSED BYTE                                  
*                                                                               
         LA    R2,FIELD+2                                                       
*                                                                               
VLIT30   MVC   HALF,0(R2)          VERIFY AND CONVERT EBCDIC TO HEX             
         GOTO1 CHEXIN,DMCB,HALF,BYTE,2                                          
         CLI   15(R1),1            TEST VALID HEX                               
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         BUILD 1,BYTE              PUT HEX ARGUMENT INTO ELEMENT                
*                                                                               
         ZIC   R1,0(R3)            CURRENT LENGTH OF LITERAL                    
         LA    R1,1(R1)            INCREMENT LENGTH BY 1                        
         STC   R1,0(R3)            SAVE                                         
         CLI   0(R3),27            TEST ELEMENT LENGTH AGAINST MAXIMUM          
         BNH   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         LA    R2,2(R2)            NEXT HEX PAIR OF CHARACTERS                  
         CLI   0(R2),C''''         TEST END OF LITERAL                          
         BNE   VLIT30                                                           
         B     VLITX                                                            
*                                                                               
VLIT40   BCTR  R7,0                BACK UP TO LENGTH                            
*                                                                               
         ZIC   R2,FIELDLEN         LENGTH OF LITERAL                            
         ZIC   R0,0(R7)            LENGTH OF ELEMENT WITHOUT LITERAL            
         AR    R0,R2                                                            
         STC   R0,BYTE                                                          
         CLI   BYTE,27             TEST ELEMENT LENGTH AGAINST MAXIMUM          
         BNH   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
         BUILD 1,BYTE              TOTAL LENGTH                                 
         BUILD 1,=AL1(0)           UNUSED BYTE                                  
*                                                                               
         LA    R3,FIELD                                                         
VLIT50   BUILD 1,0(R3)             PUT LITERAL IN ELEMENT                       
         LA    R3,1(R3)                                                         
         BCT   R2,VLIT50                                                        
*                                                                               
VLITX    B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE PRINT LOCATION                                                       
*                                                                               
VPRT     NTR1                                                                   
*                                                                               
         XC    WORK,WORK                                                        
         XC    SCANBLK,SCANBLK                                                  
*                                                                               
         FLDG  22(R4),WORK,1(R4)   PREPARE LIST FOR SCANNER                     
*                                                                               
         LA    R4,SCANBLK                                                       
         GOTO1 CSCANNER,DMCB,(10,WORK),(8,(R4)),C',= /'                         
*                                                                               
         CLI   4(R1),1             SHOULD BE EXACTLY ONE ARGUMENT               
         BE    *+12                                                             
         MVI   DBERRNUM,DBEXTARG                                                
         B     ERR                                                              
*                                                                               
         XC    DMCB,DMCB                                                        
         L     R5,APRTOPTS         TABLE OF ACCEPTABLE OPTIONS                  
*                                                                               
VPRTA    CLI   0(R5),X'FF'         TEST END OF TABLE                            
         BNE   *+12                                                             
         MVI   DBERRNUM,DBARG                                                   
         B     ERR                                                              
*                                                                               
         CLC   0(3,R5),12(R4)      FIRST HALF OF SCANNER TABLE ENTRY            
         BE    *+12                                                             
         LA    R5,4(R5)            NEXT TABLE ENTRY                             
         B     VPRTA                                                            
*                                                                               
         BUILD 1,0(R5)             PUT TYPE OF LINE IN ELEMENT                  
         BUILD 1,3(R5)             LINE NUMBER                                  
*                                                                               
         CLI   1(R4),0             TEST NO COLUMN NUMBER GIVEN                  
         BNE   VPRTB                                                            
         BUILD 1,=AL1(0)           STORE PRINT POSITION                         
         B     VPRTX                                                            
*                                                                               
VPRTB    TM    3(R4),X'80'         TEST DATA NUMERIC                            
         BO    *+12                                                             
         MVI   DBERRNUM,DBARG      ARGUMENT MUST BE NUMERIC                     
         B     ERR                                                              
*                                                                               
         ICM   R2,15,8(R4)         PRINT POSITION                               
         C     R2,=F'1'                                                         
         BNL   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT   NUMBER IS TOO LOW                            
         B     ERR                                                              
         C     R2,=F'255'                                                       
         BNH   *+12                                                             
         MVI   DBERRNUM,DBNUMOUT   NUMBER IS TOO HIGH                           
         B     ERR                                                              
*                                                                               
         STC   R2,BYTE                                                          
         BUILD 1,BYTE              STORE PRINT POSITION                         
*                                                                               
VPRTX    B     EXIT7                                                            
         EJECT                                                                  
* VALIDATE COMPARAND VALUES                                                     
*                                                                               
VVALUE   NTR1                                                                   
*                                                                               
         ZIC   R2,1(R4)            LENGTH OF OPERAND                            
         GOTO1 CCASHVAL,DMCB,(X'82',22(R4)),(R2)                                
         CLI   DMCB,0              DATA VALID?                                  
         BE    *+12                                                             
         MVI   DBERRNUM,DBARG      NO                                           
         B     ERR                                                              
*                                                                               
         CLC   =C'MIN',12(R4)      MIN= OPTION                                  
         BNE   VVALUE10                                                         
         BUILD 2,=X'0100'                                                       
         BUILD 8,DMCB+4                                                         
         B     VVALUE30                                                         
*                                                                               
VVALUE10 CLC   =C'MAX',12(R4)      MAX= OPTION                                  
         BNE   VVALUE20                                                         
         BUILD 2,=X'0200'                                                       
         BUILD 8,DMCB+4                                                         
         B     VVALUE30                                                         
*                                                                               
VVALUE20 CLC   =C'EQ',12(R4)       EQU= OPTION                                  
         BE    *+6                                                              
         DC    H'0'                                                             
         BUILD 2,=X'0100'          GENERATE MIN AND MAX ELEMENTS                
         BUILD 8,DMCB+4                                                         
         BUILD 4,=X'640C0200'                                                   
         BUILD 8,DMCB+4                                                         
*                                                                               
VVALUE30 B     EXIT7                                                            
         EJECT                                                                  
* ERROR HANDLING                                                                
*                                                                               
ERR      MVC   DBERRMSG,SPACES                                                  
*                                                                               
         LA    R2,ERRTABLE         TABLE OF ERROR MESSAGES                      
*                                                                               
ERR10    CLC   DBERRNUM,0(R2)      TEST MATCH ON ERROR CODE                     
         BE    ERR20                                                            
         ZIC   R3,1(R2)            LENGTH OF ERROR MESSAGE                      
         LA    R2,3(R3,R2)         NEXT ERROR MESSAGE                           
         CLI   0(R2),X'FF'         TEST END OF TABLE                            
         BNE   ERR10                                                            
         DC    H'0'                NO MESSAGE FOR THIS CODE                     
*                                                                               
ERR20    ZIC   R3,1(R2)            LENGTH OF ERROR MESSAGE                      
         BCTR  R3,0                                                             
         EX    R3,*+8                                                           
         B     *+10                                                             
         MVC   DBERRMSG(0),3(R2)   PUT MESSAGE IN PARAMETER BLOCK               
*                                                                               
         CLI   2(R2),0             TEST OPTION NUMBER MUST BE INSERTED          
         BE    ERREX                                                            
         ZIC   R3,2(R2)            DISPLACEMENT OF NUMBER INSERTION             
         LA    R2,DBERRMSG(R3)     ADDRESS OF INSERTION                         
         EDIT  OPTNUM,(1,(R2))     OPTION NUMBER                                
*                                                                               
ERREX    L     RD,SAVERD           RETURN DIRECTLY TO CALLING PROGRAM           
         B     XMOD                                                             
         EJECT                                                                  
* ERROR MESSAGES                                                                
*                                                                               
ERRTABLE DS    0D                                                               
*                                                                               
         DC    AL1(DBOPT,MSG1X-MSG1,MSG1A-MSG1)                                 
MSG1     DC    C'OPTION '                                                       
MSG1A    DC    C' '                                                             
         DC    C' INVALID '                                                     
MSG1X    EQU   *                                                                
*                                                                               
         DC    AL1(DBARG,MSG2X-MSG2,MSG2A-MSG2)                                 
MSG2     DC    C'INVALID ARGUMENT ON OPTION '                                   
MSG2A    DC    C' '                                                             
MSG2X    EQU   *                                                                
*                                                                               
         DC    AL1(DBSTMT,MSG3X-MSG3,0)                                         
MSG3     DC    C'INVALID STATEMENT '                                            
MSG3X    EQU   *                                                                
*                                                                               
         DC    AL1(DBNOLBL,MSG4X-MSG4,0)                                        
MSG4     DC    C'MISSING STATEMENT LABEL '                                      
MSG4X    EQU   *                                                                
*                                                                               
         DC    AL1(DBEXTLBL,MSG5X-MSG5,0)                                       
MSG5     DC    C'STATEMENT LABEL NOT PERMITTED '                                
MSG5X    EQU   *                                                                
*                                                                               
         DC    AL1(DBNUMOUT,MSG6X-MSG6,MSG6A-MSG6)                              
MSG6     DC    C'ARGUMENT RANGE IS 1 TO 255 ON OPTION '                         
MSG6A    DC    C' '                                                             
MSG6X    EQU   *                                                                
*                                                                               
         DC    AL1(DBEXTOP,MSG7X-MSG7,0)                                        
MSG7     DC    C'NO OPTIONS PERMITTED ON THIS STATEMENT '                       
MSG7X    EQU   *                                                                
*                                                                               
         DC    AL1(DBEXTARG,MSG8X-MSG8,MSG8A-MSG8)                              
MSG8     DC    C'TOO MANY ARGUMENTS ON OPTION '                                 
MSG8A    DC    C' '                                                             
MSG8X    EQU   *                                                                
*                                                                               
         DC    AL1(DBNOARG,MSG9X-MSG9,MSG9A-MSG9)                               
MSG9     DC    C'MISSING ARGUMENT ON OPTION '                                   
MSG9A    DC    C' '                                                             
MSG9X    EQU   *                                                                
*                                                                               
         DC    AL1(DBNOENT,MSG10X-MSG10,MSG10A-MSG10)                           
MSG10    DC    C'DICTIONARY ENTRY NOT FOUND ON OPTION '                         
MSG10A   DC    C' '                                                             
MSG10X   EQU   *                                                                
*                                                                               
         DC    AL1(DBNOOPT,MSG11X-MSG11,0)                                      
MSG11    DC    C'MISSING OPTION '                                               
MSG11X   EQU   *                                                                
*                                                                               
         DC    AL1(DBNUMOU1,MSG12X-MSG12,MSG12A-MSG12)                          
MSG12    DC    C'ARGUMENT RANGE IS 0 TO 255 ON OPTION '                         
MSG12A   DC    C' '                                                             
MSG12X   EQU   *                                                                
*                                                                               
         DC    X'FF'                                                            
         EJECT                                                                  
TABLES   DS    0D                  START OF TABLE ADDRESSES                     
         DC    A(OPCODES)                                                       
         DC    A(STMTS)                                                         
         DC    A(RECOPTS)                                                       
         DC    A(SETOPTS)                                                       
         DC    A(INARGS)                                                        
         DC    A(OUTARGS)                                                       
         DC    A(HEADARG)                                                       
         DC    A(CHNKOPS)                                                       
         DC    A(FLOPTS)                                                        
         DC    A(TOTOPTS)                                                       
         DC    A(COMPOPS)                                                       
         DC    A(CNDCONJ)                                                       
         DC    A(CONDOPS)                                                       
         DC    A(CNDFLDS)                                                       
         DC    A(INTYPES)                                                       
         DC    A(OUTTYPS)                                                       
         DC    A(INOPTS)                                                        
         DC    A(OUTOPTS)                                                       
         DC    A(HEADOPS)                                                       
         DC    A(PRTOPTS)                                                       
TABLESX  EQU   *                                                                
*                                                                               
SPACES   DC    CL132' '                                                         
         EJECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
OPCODES  DS    0D                                                               
         DC    X'0000',C'C ',A(VSTMT)     STATEMENT (AND LABEL)                 
         DC    X'060B',C'F ',A(VENAME)    SUB-ENTRIES                           
         DC    X'080A',C'F ',A(VATTRIB)   ATTRIBUTES                            
         DC    X'1000',C'SY',A(VREC)      REC STATEMENT                         
         DC    X'1200',C'SN',A(0)         DATA STATEMENT                        
         DC    X'1400',C'SY',A(VSET)      SET STATEMENT                         
         DC    X'2000',C'SY',A(VIN)       IN STATEMENT                          
         DC    X'2205',C'F ',A(VINTYPE)   IN STMT -- TYPE                       
         DC    X'2303',C'F ',A(VLEN)      IN STMT -- LENGTH                     
         DC    X'240A',C'F ',A(VRNAME)    IN STMT -- ROUTINE                    
         DC    X'2502',C'F ',A(VRARGS)    IN STMT -- ARGUMENTS                  
         DC    X'2600',C'SY',A(VOPT)      IN STMT -- OPTIONS                    
         DC    X'3000',C'SY',A(VOUT)      OUT STATEMENT                         
         DC    X'3204',C'F ',A(VOUTYPE)   OUT STMT -- TYPE                      
         DC    X'3303',C'F ',A(VLEN)      OUT STMT -- LENGTH                    
         DC    X'340A',C'F ',A(VRNAME)    OUT STMT -- ROUTINE                   
         DC    X'3502',C'F ',A(VRARGS)    OUT STMT -- ARGUMENTS                 
         DC    X'3600',C'SY',A(VOPT)      OUT STMT -- OPTIONS                   
         DC    X'4000',C'SY',A(VHEAD)     HEAD STATEMENT                        
         DC    X'4200',C'SY',A(VCHUNK)    CHUNK STATEMENT                       
         DC    X'4400',C'SY',A(VFL)       FIRST/LAST STATEMENTS                 
         DC    X'4800',C'SY',A(VTOT)      TOTAL STATEMENT                       
         DC    X'5000',C'SY',A(VCOMP)     COMP STATEMENT                        
         DC    X'6000',C'SY',A(VCOND)     COND STATEMENT                        
         DC    X'820A',C'F ',A(VRNAME)    HEAD STMT -- ROUTINE                  
         DC    X'8302',C'F ',A(VRARGS)    HEAD STMT -- ARGUMENTS                
         DC    X'8703',C'F ',A(VLIT)      HEAD STMT -- LINES                    
         DC    X'A100',C'T ',A(DRSTART)   INITIALIZE DRIVAL                     
         DC    X'A300',C'T ',A(VDRONE)    VALIDATE DRONE BLOCK - ROW            
         DC    X'A500',C'T ',A(VDRONE)    VALIDATE DRONE BLOCK - COLUMN         
         DC    X'A600',C'T ',A(DRCLOSE)   WRAP UP DRIVAL                        
         DC    X'FF'                                                            
         EJECT                                                                  
STMTS    DS    0D                                                               
         DC    C'REC  ',X'100200',C'O'    DEFINE INTERNAL RECORD                
         DC    C'DATA ',X'120200',C'N'    NON-SORT FIELDS                       
         DC    C'SET  ',X'140301',C'N'    SET I/O PARAMETERS                    
         DC    C'IN   ',X'200200',C'O'    DEFINE INPUT FIELD                    
         DC    C'OUT  ',X'300200',C'O'    DEFINE OUTPUT FIELD                   
         DC    C'HEAD ',X'400301',C'N'    DEFINE HEADLINE 1                     
         DC    C'HEAD1',X'400301',C'N'    DEFINE HEADLINE 1                     
         DC    C'HEAD2',X'400302',C'N'    DEFINE HEADLINE 2                     
         DC    C'HEAD3',X'400303',C'N'    DEFINE HEADLINE 3                     
         DC    C'HEAD4',X'400304',C'N'    DEFINE HEADLINE 4                     
         DC    C'CHUNK',X'420200',C'Y'    COMBINE OUTPUT COLUMNS                
         DC    C'FIRST',X'4403C6',C'N'    FIRST CONTROL BREAK ACTION            
         DC    C'LAST ',X'4403D3',C'N'    LAST CONTROL BREAK ACTION             
         DC    C'TOTAL',X'480200',C'N'    PRINT TOTAL                           
         DC    C'COMP ',X'500200',C'N'    COMPUTE OUTPUT FIELD                  
         DC    C'COND ',X'600200',C'Y'    DEFINE CONDITIONAL PARAMS             
         DC    X'FF'                                                            
         EJECT                                                                  
RECOPTS  DS    0D                                                               
         DC    C'IF    ',X'840A',A(VLABEL)   IF STATEMENT                       
         DC    C'NOT   ',X'850A',A(VLABEL)   NOT STATEMENT                      
         DC    X'FF'                                                            
         SPACE 5                                                                
SETOPTS  DS    0D                                                               
         DC    C'IN  ',A(VIN)                IN PARAMETERS                      
         DC    C'OUT ',A(VOUT)               OUT PARAMETERS                     
         DC    X'FF'                                                            
         EJECT                                                                  
INARGS   DS    0D                                                               
         DC    C'D         ',X'800A',A(VDNAME)    DICTIONARY NAME               
         DC    C'DICT      ',X'800A',A(VDNAME)                                  
         DC    C'E         ',X'810A',A(VENAME)    ENTRY NAME                    
         DC    C'ENTRY     ',X'810A',A(VENAME)                                  
         DC    C'O         ',X'210A',A(VLABEL)    OUTPUT FIELD LABEL            
         DC    C'OUT       ',X'210A',A(VLABEL)                                  
         DC    C'T         ',X'2205',A(VINTYPE)   TYPE                          
         DC    C'TYPE      ',X'2205',A(VINTYPE)                                 
         DC    C'L         ',X'2303',A(VLEN)      LENGTH                        
         DC    C'LEN       ',X'2303',A(VLEN)                                    
         DC    C'LENGTH    ',X'2303',A(VLEN)                                    
         DC    C'R         ',X'240A',A(VRNAME)    ROUTINE                       
         DC    C'ROUTINE   ',X'240A',A(VRNAME)                                  
         DC    C'ARG       ',X'2502',A(VRARGS)    ARGUMENTS                     
         DC    C'ARGS      ',X'2502',A(VRARGS)                                  
         DC    C'IF        ',X'840A',A(VLABEL)    IF STATEMENT                  
         DC    C'NOT       ',X'850A',A(VLABEL)    NOT STATEMENT                 
         DC    C'LIT       ',X'8703',A(VLIT)      LITERAL                       
         DC    C'LITERAL   ',X'8703',A(VLIT)                                    
         DC    C'COL       ',X'270A',A(VLABEL)    RANKED COLUMN (DROOL)         
         DC    C'COLUMN    ',X'270A',A(VLABEL)                                  
         DC    X'FF'                                                            
         SPACE 5                                                                
OUTARGS  DS    0D                                                               
         DC    C'D         ',X'800A',A(VDNAME)    DICTIONARY NAME               
         DC    C'DICT      ',X'800A',A(VDNAME)                                  
         DC    C'E         ',X'810A',A(VENAME)    ENTRY NAME                    
         DC    C'ENTRY     ',X'810A',A(VENAME)                                  
         DC    C'I         ',X'310A',A(VLABEL)    INPUT FIELD LABEL             
         DC    C'IN        ',X'310A',A(VLABEL)                                  
         DC    C'T         ',X'3204',A(VOUTYPE)   TYPE                          
         DC    C'TYPE      ',X'3204',A(VOUTYPE)                                 
         DC    C'L         ',X'3303',A(VLEN)      LENGTH                        
         DC    C'LEN       ',X'3303',A(VLEN)                                    
         DC    C'LENGTH    ',X'3303',A(VLEN)                                    
         DC    C'R         ',X'340A',A(VRNAME)    ROUTINE                       
         DC    C'ROUTINE   ',X'340A',A(VRNAME)                                  
         DC    C'ARG       ',X'3502',A(VRARGS)    ARGUMENTS                     
         DC    C'ARGS      ',X'3502',A(VRARGS)                                  
         DC    C'MIN       ',X'640C',A(VVALUE)    COMPARE VALUE                 
         DC    C'MAX       ',X'640C',A(VVALUE)                                  
         DC    C'EQ        ',X'640C',A(VVALUE)                                  
         DC    C'EQU       ',X'640C',A(VVALUE)                                  
         DC    C'IF        ',X'840A',A(VLABEL)    IF STATEMENT                  
         DC    C'NOT       ',X'850A',A(VLABEL)    NOT STATEMENT                 
         DC    C'P         ',X'8605',A(VPRT)      PRINT LOCATION                
         DC    C'LIT       ',X'8703',A(VLIT)      LITERAL                       
         DC    C'LITERAL   ',X'8703',A(VLIT)                                    
         DC    X'FF'                                                            
         EJECT                                                                  
HEADARG  DS    0D                                                               
         DC    C'R         ',X'820A',A(VRNAME)   ROUTINE                        
         DC    C'ROUTINE   ',X'820A',A(VRNAME)                                  
         DC    C'ARG       ',X'8302',A(VRARGS)   ARGUMENTS                      
         DC    C'ARGS      ',X'8302',A(VRARGS)                                  
         DC    C'IF        ',X'840A',A(VLABEL)   IF STATEMENT                   
         DC    C'NOT       ',X'850A',A(VLABEL)   NOT STATEMENT                  
         DC    C'LIT       ',X'8703',A(VLIT)     LITERAL                        
         DC    C'LITERAL   ',X'8703',A(VLIT)                                    
         DC    X'FF'                                                            
         SPACE 5                                                                
CHNKOPS  DS    0D                                                               
         DC    C'R         ',X'820A',A(VRNAME)   ROUTINE                        
         DC    C'ROUTINE   ',X'820A',A(VRNAME)                                  
         DC    C'ARG       ',X'8302',A(VRARGS)   ARGUMENTS                      
         DC    C'ARGS      ',X'8302',A(VRARGS)                                  
         DC    C'IF        ',X'840A',A(VLABEL)   IF STATEMENT                   
         DC    C'NOT       ',X'850A',A(VLABEL)   NOT STATEMENT                  
         DC    C'LIT       ',X'8703',A(VLIT)     LITERAL                        
         DC    C'LITERAL   ',X'8703',A(VLIT)                                    
         DC    X'FF'                                                            
         SPACE 5                                                                
COMPOPS  DS    0D                                                               
         DC    C'+  ',C'Y+',AL1(0)                                              
         DC    C'-  ',C'Y-',AL1(0)                                              
         DC    C'X  ',C'YX',AL1(0)                                              
         DC    C'*  ',C'YX',AL1(0)                                              
         DC    C'/  ',C'Y/',AL1(0)                                              
         DC    C'I  ',C'NI',AL1(0)                                              
         DC    C'%  ',C'N%',AL1(0)                                              
         DC    C'V1 ',C'NV',AL1(1)                                              
         DC    C'V2 ',C'NV',AL1(2)                                              
         DC    C'V3 ',C'NV',AL1(3)                                              
         DC    C'V4 ',C'NV',AL1(4)                                              
         DC    C'V5 ',C'NV',AL1(5)                                              
         DC    C'V6 ',C'NV',AL1(6)                                              
         DC    C'V7 ',C'NV',AL1(7)                                              
         DC    C'V8 ',C'NV',AL1(8)                                              
         DC    C'V9 ',C'NV',AL1(9)                                              
         DC    C'V10',C'NV',AL1(10)                                             
         DC    C'V11',C'NV',AL1(11)                                             
         DC    C'V12',C'NV',AL1(12)                                             
         DC    X'FF'                                                            
         EJECT                                                                  
FLOPTS   DS    0D                                                               
         DC    C'R        ',X'820A00',A(VRNAME)  ROUTINE                        
         DC    C'ROUTINE  ',X'820A00',A(VRNAME)                                 
         DC    C'ARG      ',X'830200',A(VRARGS)  ARGUMENTS                      
         DC    C'ARGS     ',X'830200',A(VRARGS)                                 
         DC    C'IF       ',X'840A00',A(VLABEL)  IF STATEMENT                   
         DC    C'NOT      ',X'850A00',A(VLABEL)  NOT STATEMENT                  
         DC    C'P        ',X'860500',A(VPRT)    PRINT LOCATION                 
         DC    C'LIT      ',X'870300',A(VLIT)    LITERAL                        
         DC    C'LITERAL  ',X'870300',A(VLIT)                                   
         DC    C'SKIP     ',X'460401',F'0'       EJECT PAGE                     
         DC    C'SPACE    ',X'460402',F'0'       SKIP N LINES                   
         DC    C'PAGE     ',X'460403',F'0'       RESET PAGE NO.                 
         DC    C'SUBPAGE  ',X'460404',F'0'       RESET SUBPAGE NO.              
         DC    C'MIDHEAD  ',X'460405',F'0'       RESET MIDHEAD                  
         DC    C'MIDHEAD  ',X'460406',F'0'       PRINT HORIZONTAL LINE          
         DC    X'FF'                                                            
         SPACE 5                                                                
TOTOPTS  DS    0D                                                               
         DC    C'R       ',X'00820A00',A(VRNAME)  ROUTINE                       
         DC    C'ROUTINE ',X'00820A00',A(VRNAME)                                
         DC    C'ARG     ',X'00830200',A(VRARGS)  ARGUMENTS                     
         DC    C'ARGS    ',X'00830200',A(VRARGS)                                
         DC    C'IF      ',X'00840A00',A(VLABEL)  IF STATEMENT                  
         DC    C'NOT     ',X'00850A00',A(VLABEL)  NOT STATEMENT                 
         DC    C'P       ',X'00860500',A(VPRT)    PRINT LOCATION                
         DC    C'LIT     ',X'00870300',A(VLIT)    LITERAL                       
         DC    C'LITERAL ',X'00870300',A(VLIT)                                  
         DC    C'SKIP    ',X'00460401',F'0'       EJECT PAGE                    
         DC    C'SPACE   ',X'80460402',F'0'       SKIP N LINES                  
         DC    C'PAGE    ',X'00460403',F'0'       RESET PAGE NO.                
         DC    C'SUBPAGE ',X'00460404',F'0'       RESET SUBPAGE NO.             
         DC    C'MIDHEAD ',X'00460405',F'0'       RESET MIDHEAD                 
         DC    C'D       ',X'80490404',F'0'       DETAIL LEVEL NO.              
         DC    C'DETAIL  ',X'80490404',F'0'                                     
         DC    X'FF'                                                            
         EJECT                                                                  
CNDCONJ  DS    0D                                                               
         DC    C'IF '              STANDARD CONDITION                           
         DC    C'OR '              'OR' CONDITION                               
         DC    C'AND'              'AND' CONDITION                              
         DC    X'FF'                                                            
         SPACE 5                                                                
CONDOPS  DS    0D                                                               
         DC    C'EQ'               EQUAL                                        
         DC    C'GT'               GREATER THAN                                 
         DC    C'LT'               LESS THAN                                    
         DC    C'NE'               NOT EQUAL                                    
         DC    C'NL'               NOT LESS THAN                                
         DC    C'NG'               NOT GREATER THAN                             
         DC    X'FF'                                                            
         SPACE 5                                                                
CNDFLDS  DS    0D                                                               
         DC    C'OPT1  ',X'01',AL1(1)   OPTION IN GLOBAL STORAGE (1-20)         
         DC    C'OPT2  ',X'01',AL1(2)                                           
         DC    C'OPT3  ',X'01',AL1(3)                                           
         DC    C'OPT4  ',X'01',AL1(4)                                           
         DC    C'OPT5  ',X'01',AL1(5)                                           
         DC    C'OPT6  ',X'01',AL1(6)                                           
         DC    C'OPT7  ',X'01',AL1(7)                                           
         DC    C'OPT8  ',X'01',AL1(8)                                           
         DC    C'OPT9  ',X'01',AL1(9)                                           
         DC    C'OPT10 ',X'01',AL1(10)                                          
         DC    C'OPT11 ',X'01',AL1(11)                                          
         DC    C'OPT12 ',X'01',AL1(12)                                          
         DC    C'OPT13 ',X'01',AL1(13)                                          
         DC    C'OPT14 ',X'01',AL1(14)                                          
         DC    C'OPT15 ',X'01',AL1(15)                                          
         DC    C'OPT16 ',X'01',AL1(16)                                          
         DC    C'OPT17 ',X'01',AL1(17)                                          
         DC    C'OPT18 ',X'01',AL1(18)                                          
         DC    C'OPT19 ',X'01',AL1(19)                                          
         DC    C'OPT20 ',X'01',AL1(20)                                          
         DC    C'Q1    ',X'02',AL1(1)   COLUMN IN REQUEST CARD (1-80)           
         DC    C'Q2    ',X'02',AL1(2)                                           
         DC    C'Q3    ',X'02',AL1(3)                                           
         DC    C'Q4    ',X'02',AL1(4)                                           
         DC    C'Q5    ',X'02',AL1(5)                                           
         DC    C'Q6    ',X'02',AL1(6)                                           
         DC    C'Q7    ',X'02',AL1(7)                                           
         DC    C'Q8    ',X'02',AL1(8)                                           
         DC    C'Q9    ',X'02',AL1(9)                                           
         DC    C'Q10   ',X'02',AL1(10)                                          
         DC    C'Q11   ',X'02',AL1(11)                                          
         DC    C'Q12   ',X'02',AL1(12)                                          
         DC    C'Q13   ',X'02',AL1(13)                                          
         DC    C'Q14   ',X'02',AL1(14)                                          
         DC    C'Q15   ',X'02',AL1(15)                                          
         DC    C'Q16   ',X'02',AL1(16)                                          
         DC    C'Q17   ',X'02',AL1(17)                                          
         DC    C'Q18   ',X'02',AL1(18)                                          
         DC    C'Q19   ',X'02',AL1(19)                                          
         DC    C'Q20   ',X'02',AL1(20)                                          
         DC    C'Q21   ',X'02',AL1(21)                                          
         DC    C'Q22   ',X'02',AL1(22)                                          
         DC    C'Q23   ',X'02',AL1(23)                                          
         DC    C'Q24   ',X'02',AL1(24)                                          
         DC    C'Q25   ',X'02',AL1(25)                                          
         DC    C'Q26   ',X'02',AL1(26)                                          
         DC    C'Q27   ',X'02',AL1(27)                                          
         DC    C'Q28   ',X'02',AL1(28)                                          
         DC    C'Q29   ',X'02',AL1(29)                                          
         DC    C'Q30   ',X'02',AL1(30)                                          
         DC    C'Q31   ',X'02',AL1(31)                                          
         DC    C'Q32   ',X'02',AL1(32)                                          
         DC    C'Q33   ',X'02',AL1(33)                                          
         DC    C'Q34   ',X'02',AL1(34)                                          
         DC    C'Q35   ',X'02',AL1(35)                                          
         DC    C'Q36   ',X'02',AL1(36)                                          
         DC    C'Q37   ',X'02',AL1(37)                                          
         DC    C'Q38   ',X'02',AL1(38)                                          
         DC    C'Q39   ',X'02',AL1(39)                                          
         DC    C'Q40   ',X'02',AL1(40)                                          
         DC    C'Q41   ',X'02',AL1(41)                                          
         DC    C'Q42   ',X'02',AL1(42)                                          
         DC    C'Q43   ',X'02',AL1(43)                                          
         DC    C'Q44   ',X'02',AL1(44)                                          
         DC    C'Q45   ',X'02',AL1(45)                                          
         DC    C'Q46   ',X'02',AL1(46)                                          
         DC    C'Q47   ',X'02',AL1(47)                                          
         DC    C'Q48   ',X'02',AL1(48)                                          
         DC    C'Q49   ',X'02',AL1(49)                                          
         DC    C'Q50   ',X'02',AL1(50)                                          
         DC    C'Q51   ',X'02',AL1(51)                                          
         DC    C'Q52   ',X'02',AL1(52)                                          
         DC    C'Q53   ',X'02',AL1(53)                                          
         DC    C'Q54   ',X'02',AL1(54)                                          
         DC    C'Q55   ',X'02',AL1(55)                                          
         DC    C'Q56   ',X'02',AL1(56)                                          
         DC    C'Q57   ',X'02',AL1(57)                                          
         DC    C'Q58   ',X'02',AL1(58)                                          
         DC    C'Q59   ',X'02',AL1(59)                                          
         DC    C'Q60   ',X'02',AL1(60)                                          
         DC    C'Q61   ',X'02',AL1(61)                                          
         DC    C'Q62   ',X'02',AL1(62)                                          
         DC    C'Q63   ',X'02',AL1(63)                                          
         DC    C'Q64   ',X'02',AL1(64)                                          
         DC    C'Q65   ',X'02',AL1(65)                                          
         DC    C'Q66   ',X'02',AL1(66)                                          
         DC    C'Q67   ',X'02',AL1(67)                                          
         DC    C'Q68   ',X'02',AL1(68)                                          
         DC    C'Q69   ',X'02',AL1(69)                                          
         DC    C'Q70   ',X'02',AL1(70)                                          
         DC    C'Q71   ',X'02',AL1(71)                                          
         DC    C'Q72   ',X'02',AL1(72)                                          
         DC    C'Q73   ',X'02',AL1(73)                                          
         DC    C'Q74   ',X'02',AL1(74)                                          
         DC    C'Q75   ',X'02',AL1(75)                                          
         DC    C'Q76   ',X'02',AL1(76)                                          
         DC    C'Q77   ',X'02',AL1(77)                                          
         DC    C'Q78   ',X'02',AL1(78)                                          
         DC    C'Q79   ',X'02',AL1(79)                                          
         DC    C'Q80   ',X'02',AL1(80)                                          
         DC    C'DATE  ',X'03',AL1(0)   DATE NUMBER IN GLOBAL STORAGE           
         DC    C'LEVEL ',X'04',AL1(0)   LEVEL NUMBER                            
         DC    C'REC   ',X'05',AL1(0)   RECORD NUMBER                           
         DC    C'AGENCY',X'06',AL1(0)   AGENCY CODE (2 BYTES)                   
         DC    C'SYS1  ',X'07',AL1(1)   SYSTEM PROFILE (1-16)                   
         DC    C'SYS2  ',X'07',AL1(2)                                           
         DC    C'SYS3  ',X'07',AL1(3)                                           
         DC    C'SYS4  ',X'07',AL1(4)                                           
         DC    C'SYS5  ',X'07',AL1(5)                                           
         DC    C'SYS6  ',X'07',AL1(6)                                           
         DC    C'SYS7  ',X'07',AL1(7)                                           
         DC    C'SYS8  ',X'07',AL1(8)                                           
         DC    C'SYS9  ',X'07',AL1(9)                                           
         DC    C'SYS10 ',X'07',AL1(10)                                          
         DC    C'SYS11 ',X'07',AL1(11)                                          
         DC    C'SYS12 ',X'07',AL1(12)                                          
         DC    C'SYS13 ',X'07',AL1(13)                                          
         DC    C'SYS14 ',X'07',AL1(14)                                          
         DC    C'SYS15 ',X'07',AL1(15)                                          
         DC    C'SYS16 ',X'07',AL1(16)                                          
         DC    C'PROF1 ',X'08',AL1(1)   PROGRAM PROFILE (1-16)                  
         DC    C'PROF2 ',X'08',AL1(2)                                           
         DC    C'PROF3 ',X'08',AL1(3)                                           
         DC    C'PROF4 ',X'08',AL1(4)                                           
         DC    C'PROF5 ',X'08',AL1(5)                                           
         DC    C'PROF6 ',X'08',AL1(6)                                           
         DC    C'PROF7 ',X'08',AL1(7)                                           
         DC    C'PROF8 ',X'08',AL1(8)                                           
         DC    C'PROF9 ',X'08',AL1(9)                                           
         DC    C'PROF10',X'08',AL1(10)                                          
         DC    C'PROF11',X'08',AL1(11)                                          
         DC    C'PROF12',X'08',AL1(12)                                          
         DC    C'PROF13',X'08',AL1(13)                                          
         DC    C'PROF14',X'08',AL1(14)                                          
         DC    C'PROF15',X'08',AL1(15)                                          
         DC    C'PROF16',X'08',AL1(16)                                          
         DC    X'FF'                                                            
         EJECT                                                                  
INTYPES  DS    0D                                                               
         DC    C'S   ',C'S',C'+',C'R'    SCALED FIELD -- ADDED                  
         DC    C'S+  ',C'S',C'+',C'R'                                           
         DC    C'C   ',C'C',X'00',C' '   CHARACTER STRING -- EBCDIC             
         DC    C'C+  ',C'C',C'+',C' '    CHARACTER STRING -- MERGE              
         DC    C'X   ',C'X',X'00',C' '   CHARACTER STRING -- HEX                
         DC    C'X+  ',C'X',C'+',C' '    CHARACTER STRING -- HEX/MERGE          
         DC    C'PWOS',C'P',X'00',C' '   CHARACTER STRING -- PWOS               
         DC    C'W+  ',C'W',C'+',C' '    CHARACTER STRING -- PWOS/MERGE         
         DC    C'B   ',C'B',C'+',C'R'    BINARY FIELD -- ADDED                  
         DC    C'B+  ',C'B',C'+',C'R'                                           
         DC    C'B-  ',C'B',C'-',C' '    BINARY FIELD                           
         DC    C'U   ',C'U',C'+',C'R'    UNSIGNED FIELD -- ADDED                
         DC    C'U+  ',C'U',C'+',C'R'                                           
         DC    C'U-  ',C'U',C'-',C' '    UNSIGNED FIELD                         
         DC    C'P   ',C'P',C'+',C'R'    PACKED FIELD -- ADDED                  
         DC    C'P+  ',C'P',C'+',C'R'                                           
         DC    C'P-  ',C'P',C'-',C' '    PACKED FIELD                           
         DC    C'M   ',C'M',C'+',C'R'    PACKED (WITH EDIT MASK)                
         DC    C'M+  ',C'M',C'+',C'R'    PACKED (WITH EDIT MASK)                
         DC    C'M-  ',C'M',C'-',C' '    PACKED (WITH EDIT MASK)                
         DC    C'E   ',C'E',C'+',C'R'    EBCDIC NUMERIC -- ADDED                
         DC    C'E+  ',C'E',C'+',C'R'                                           
         DC    C'E-  ',C'E',C'-',C' '    EBCDIC NUMERIC                         
         DC    C'D   ',C'D',X'00',C' '   DATE -- EBCDIC                         
         DC    C'D0  ',C'D',X'00',C' '                                          
         DC    C'D1  ',C'D',X'01',C' '   DATE -- PWOS                           
         DC    C'D2  ',C'D',X'02',C' '   DATE -- COMPRESSED                     
         DC    C'D3  ',C'D',X'03',C' '   DATE -- BINARY                         
         DC    C'D4  ',C'D',X'04',C' '   DATE -- MM/DD/YY                       
         DC    X'FF'                                                            
         SPACE 5                                                                
OUTTYPS  DS    0D                                                               
         DC    C'C   ',C'C',X'00'        CHARACTER STRING -- EBCDIC             
         DC    C'X   ',C'X',X'00'        CHARACTER STRING -- HEX                
         DC    C'PWOS',C'P',X'00'        CHARACTER STRING -- PWOS               
         DC    C'N   ',C'N',X'00'        NUMERIC -- EDITED                      
         DC    C'B   ',C'B',X'00'        BINARY FIELD                           
         DC    C'P   ',C'P',X'00'        PACKED FIELD                           
         DC    C'D   ',C'D',X'00'        DATE -- EBCDIC                         
         DC    C'D0  ',C'D',X'00'                                               
         DC    C'D1  ',C'D',X'01'        DATE -- PWOS                           
         DC    C'D2  ',C'D',X'02'        DATE -- COMPRESSED                     
         DC    C'D3  ',C'D',X'03'        DATE -- BINARY                         
         DC    C'D4  ',C'D',X'04'        DATE -- MMMDD                          
         DC    C'D5  ',C'D',X'05'        DATE -- MMMDD/YY                       
         DC    C'D6  ',C'D',X'06'        DATE -- MMM/YY OR MMMYY (L=5)          
         DC    X'FF'                                                            
         EJECT                                                                  
INOPTS   DS    0D                                                               
         DC    C'DEC      ',C'1      ',X'01',X'01'  1 DECIMAL PLACE             
         DC    C'DEC      ',C'2      ',X'01',X'02'  2 DECIMAL PLACE             
         DC    C'DEC      ',C'3      ',X'01',X'03'  3 DECIMAL PLACE             
         DC    C'DEC      ',C'4      ',X'01',X'04'  4 DECIMAL PLACE             
         DC    C'DEC      ',C'5      ',X'01',X'05'  5 DECIMAL PLACE             
         DC    C'DEC      ',C'6      ',X'01',X'06'  6 DECIMAL PLACE             
         DC    C'COMP     ',C'       ',X'02',X'00'  COMPLEMENT FIELD            
         DC    C'SCALE    ',C'-9     ',X'03',X'89'  SCALE -9                    
         DC    C'SCALE    ',C'-8     ',X'03',X'88'  SCALE -8                    
         DC    C'SCALE    ',C'-7     ',X'03',X'87'  SCALE -7                    
         DC    C'SCALE    ',C'-6     ',X'03',X'86'  SCALE -6                    
         DC    C'SCALE    ',C'-5     ',X'03',X'85'  SCALE -5                    
         DC    C'SCALE    ',C'-4     ',X'03',X'84'  SCALE -4                    
         DC    C'SCALE    ',C'-3     ',X'03',X'83'  SCALE -3                    
         DC    C'SCALE    ',C'-2     ',X'03',X'82'  SCALE -2                    
         DC    C'SCALE    ',C'-1     ',X'03',X'81'  SCALE -1                    
         DC    C'SCALE    ',C'1      ',X'03',X'01'  SCALE 1                     
         DC    C'SCALE    ',C'2      ',X'03',X'02'  SCALE 2                     
         DC    C'SCALE    ',C'3      ',X'03',X'03'  SCALE 3                     
         DC    C'SCALE    ',C'4      ',X'03',X'04'  SCALE 4                     
         DC    C'SCALE    ',C'5      ',X'03',X'05'  SCALE 5                     
         DC    C'SCALE    ',C'6      ',X'03',X'06'  SCALE 6                     
         DC    C'SCALE    ',C'7      ',X'03',X'07'  SCALE 7                     
         DC    C'SCALE    ',C'8      ',X'03',X'08'  SCALE 8                     
         DC    C'SCALE    ',C'9      ',X'03',X'09'  SCALE 9                     
         DC    X'FF'                                                            
         EJECT                                                                  
OUTOPTS  DS    0D                                                               
         DC    C'DEC      ',C'0      ',X'01',X'00'  0 DECIMAL PLACES            
         DC    C'DEC      ',C'1      ',X'01',X'01'  1 DECIMAL PLACE             
         DC    C'DEC      ',C'2      ',X'01',X'02'  2 DECIMAL PLACES            
         DC    C'DEC      ',C'3      ',X'01',X'03'  3 DECIMAL PLACES            
         DC    C'DEC      ',C'4      ',X'01',X'04'  4 DECIMAL PLACES            
         DC    C'DEC      ',C'5      ',X'01',X'05'  5 DECIMAL PLACES            
         DC    C'DEC      ',C'6      ',X'01',X'06'  6 DECIMAL PLACES            
         DC    C'COMMAS   ',C'YES    ',X'02',X'00'  EDIT IN COMMAS              
         DC    C'MINUS    ',C'YES    ',X'03',X'00'  EDIT IN MINUS SIGN          
         DC    C'ZERO     ',C'NOBLANK',X'04',X'00'  SHOW ZERO AS '0'            
         DC    C'FILL     ',C'0      ',X'05',C'0'   FILL WITH '0'               
         DC    C'FILL     ',C'$      ',X'05',C'$'   FILL WITH '$'               
         DC    C'FILL     ',C'*      ',X'05',C'*'   FILL WITH '*'               
         DC    C'FLOAT    ',C'-      ',X'06',C'-'   FLOAT WITH '-'              
         DC    C'FLOAT    ',C'$      ',X'06',C'$'   FLOAT WITH '$'              
         DC    C'FLOAT    ',C'*      ',X'06',C'*'   FLOAT WITH '*'              
         DC    C'BRACK    ',C'       ',X'07',X'00'  BRACKET                     
         DC    C'BRACKET  ',C'       ',X'07',X'00'                              
         DC    C'BRACK    ',C'M      ',X'07',C'M'   BRACKET IF MINUS            
         DC    C'BRACKET  ',C'M      ',X'07',C'M'                               
         DC    C'DIV      ',C'10     ',X'08',X'01'  / 10       ROUNDED          
         DC    C'DIV      ',C'100    ',X'08',X'02'  / 100      ROUNDED          
         DC    C'DIV      ',C'1000   ',X'08',X'03'  / 1000     ROUNDED          
         DC    C'DIV      ',C'10000  ',X'08',X'04'  / 10000    ROUNDED          
         DC    C'DIV      ',C'100000 ',X'08',X'05'  / 100000   ROUNDED          
         DC    C'DIV      ',C'1000000',X'08',X'06'  / 1000000  ROUNDED          
         DC    C'TRIM     ',C'       ',X'09',X'00'  TRIM DECMLS IF NEC.         
         DC    C'BIG      ',C'BELOW  ',X'0A',X'00'  PRINT BIG NOS BELOW         
         DC    C'ALIGN    ',C'L      ',X'20',C'L'   LEFT ALIGN                  
         DC    C'ALIGN    ',C'R      ',X'20',C'R'   RIGHT ALIGN                 
         DC    C'CENT     ',C'       ',X'21',X'00'  CENTER FIELD                
         DC    C'CENTER   ',C'       ',X'21',X'00'                              
         DC    C'UND      ',C'       ',X'22',X'00'  UNDERLINE                   
         DC    C'UNDER    ',C'       ',X'22',X'00'                              
         DC    C'UNDERLINE',C'       ',X'22',X'00'                              
         DC    C'UND      ',C'-      ',X'22',C'-'   UNDERLINE WITH '-'          
         DC    C'UNDER    ',C'-      ',X'22',C'-'                               
         DC    C'UNDERLINE',C'-      ',X'22',C'-'                               
         DC    C'NOBOX    ',C'       ',X'23',X'00'  NO BOX TO LEFT              
         DC    C'CHOP     ',C'       ',X'24',X'00'  CHOP BIG FLDS BELOW         
         DC    C'MARK     ',C'       ',X'25',X'00'  NOTE COLUMN SETTING         
         DC    C'FOLD     ',C'       ',X'26',X'00'  OUTPUT ON NEXT LINE         
         DC    C'SCALE    ',C'-9     ',X'27',X'89'  SCALE -9                    
         DC    C'SCALE    ',C'-8     ',X'27',X'88'  SCALE -8                    
         DC    C'SCALE    ',C'-7     ',X'27',X'87'  SCALE -7                    
         DC    C'SCALE    ',C'-6     ',X'27',X'86'  SCALE -6                    
         DC    C'SCALE    ',C'-5     ',X'27',X'85'  SCALE -5                    
         DC    C'SCALE    ',C'-4     ',X'27',X'84'  SCALE -4                    
         DC    C'SCALE    ',C'-3     ',X'27',X'83'  SCALE -3                    
         DC    C'SCALE    ',C'-2     ',X'27',X'82'  SCALE -2                    
         DC    C'SCALE    ',C'-1     ',X'27',X'81'  SCALE -1                    
         DC    C'SCALE    ',C'1      ',X'27',X'01'  SCALE 1                     
         DC    C'SCALE    ',C'2      ',X'27',X'02'  SCALE 2                     
         DC    C'SCALE    ',C'3      ',X'27',X'03'  SCALE 3                     
         DC    C'SCALE    ',C'4      ',X'27',X'04'  SCALE 4                     
         DC    C'SCALE    ',C'5      ',X'27',X'05'  SCALE 5                     
         DC    C'SCALE    ',C'6      ',X'27',X'06'  SCALE 6                     
         DC    C'SCALE    ',C'7      ',X'27',X'07'  SCALE 7                     
         DC    C'SCALE    ',C'8      ',X'27',X'08'  SCALE 8                     
         DC    C'SCALE    ',C'9      ',X'27',X'09'  SCALE 9                     
         DC    C'TRAIL    ',C'%      ',X'28',C'%'   TRAIL WITH '%'              
         DC    C'TRAIL    ',C'*      ',X'28',C'*'   TRAIL WITH '*'              
         DC    C'CUME     ',C'       ',X'29',X'00'  CUME                        
         DC    C'DOWNCAST ',C'       ',X'2A',X'00'  DOWNCAST COMPS.             
         DC    C'NT       ',C'       ',X'2B',X'00'  NO TOTALING                 
         DC    C'ND       ',C'       ',X'2C',X'00'  NO DETAILS                  
         DC    C'ABS      ',C'       ',X'2D',X'00'  ABSOLUTE VALUE              
         DC    X'FF'                                                            
         EJECT                                                                  
HEADOPS  DS    0D                                                               
         DC    C'ALIGN    ',C'L      ',X'20',C'L'   LEFT ALIGN                  
         DC    C'ALIGN    ',C'R      ',X'20',C'R'   RIGHT ALIGN                 
         DC    X'FF'                                                            
         SPACE 5                                                                
PRTOPTS  DS    0D                                                               
         DC    C'NO ',X'00'        PRINT NOTHING -- DO OUTPUT ROUTINE           
         DC    C'P  ',X'01'        PRINTLINES                                   
         DC    C'P1 ',X'01'                                                     
         DC    C'P2 ',X'02'                                                     
         DC    C'P3 ',X'03'                                                     
         DC    C'P4 ',X'04'                                                     
         DC    C'P* ',X'00'                                                     
         DC    C'P+ ',X'4E'                                                     
         DC    C'M  ',X'01'        MIDLINES                                     
         DC    C'M1 ',X'01'                                                     
         DC    C'M2 ',X'02'                                                     
         DC    C'F  ',X'01'        FOOTLINES                                    
         DC    C'F1 ',X'01'                                                     
         DC    C'F2 ',X'02'                                                     
         DC    C'H  ',X'01'        HEADLINES                                    
         DC    C'H1 ',X'01'                                                     
         DC    C'H2 ',X'02'                                                     
         DC    C'H3 ',X'03'                                                     
         DC    C'H4 ',X'04'                                                     
         DC    C'H5 ',X'05'                                                     
         DC    C'H6 ',X'06'                                                     
         DC    C'H7 ',X'07'                                                     
         DC    C'H8 ',X'08'                                                     
         DC    C'H9 ',X'09'                                                     
         DC    C'H10',X'0A'                                                     
         DC    C'H11',X'0B'                                                     
         DC    C'H12',X'0C'                                                     
         DC    C'H13',X'0D'                                                     
         DC    C'H14',X'0E'                                                     
         DC    X'FF'                                                            
         EJECT                                                                  
* WORKING STORAGE DSECT                                                         
*                                                                               
WORKD    DSECT                                                                  
RELO     DS    F                   RELOCATION FACTOR                            
SAVERD   DS    F                                                                
DMCB     DS    6F                                                               
SCANBLK  DS    XL256               ENOUGH SPACE FOR 8 SCANNER LINES             
SCANOFLO DS    XL32                EXTRA SCANNER LINE                           
KEY      DS    XL40                                                             
KEYSAVE  DS    XL40                                                             
WORK     DS    XL52                                                             
DUB      DS    D                                                                
FULL     DS    F                                                                
HALF     DS    H                                                                
BYTE     DS    XL1                                                              
FLDGLEN  DS    XL1                 USED BY FLDG MACRO                           
INMODE   DS    CL1                 C IF INPUT IS ON CARDS                       
*                                  S IF INPUT IS SCANNER TABLE                  
*                                  F IF INPUT IS SCREEN FIELD HEADER            
WHERE    DS    CL1                 I IF DOING IN PARAMETERS                     
*                                  O IF DOING OUT PARAMETERS                    
*                                  H IF DOING HEAD PARAMETERS                   
FIELDLEN DS    XL1                 LENGTH OF FIELD                              
FIELD    DS    CL52                ACTUAL INPUT DATA                            
OPTNUM   DS    XL1                 SCANNER TABLE ENTRY NUMBER                   
SAVEDICT DS    CL8                 SAVE AREA FOR DICTIONARY NAME                
ABLOCKX  DS    A                   ADDRESS OF SCANNER TABLE END                 
*                                                                               
MYADCONS DS    0A                  DATA TABLE ADDRESSES                         
AOPCODES DS    A                                                                
ASTMTS   DS    A                                                                
ARECOPTS DS    A                                                                
ASETOPTS DS    A                                                                
AINARGS  DS    A                                                                
AOUTARGS DS    A                                                                
AHEADARG DS    A                                                                
ACHNKOPS DS    A                                                                
AFLOPTS  DS    A                                                                
ATOTOPTS DS    A                                                                
ACOMPOPS DS    A                                                                
ACNDCONJ DS    A                                                                
ACONDOPS DS    A                                                                
ACNDFLDS DS    A                                                                
AINTYPES DS    A                                                                
AOUTTYPS DS    A                                                                
AINOPTS  DS    A                                                                
AOUTOPTS DS    A                                                                
AHEADOPS DS    A                                                                
APRTOPTS DS    A                                                                
*                                                                               
WORKX    EQU   *                                                                
         EJECT                                                                  
DRVLBLKD DSECT                                                                  
*                                                                               
       ++INCLUDE DRIVALBLKD                                                     
         EJECT                                                                  
DRONED   DSECT                                                                  
       ++INCLUDE DRONEBLKD                                                      
         SPACE 3                                                                
       ++INCLUDE DRONEBLKHD                                                     
         EJECT                                                                  
       ++INCLUDE CTGENDIC                                                       
         PRINT OFF                                                              
       ++INCLUDE DDCOMFACS                                                      
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'022DDDRIVAL  03/20/13'                                      
         END                                                                    
