*          DATA SET ACPRINT    AT LEVEL 049 AS OF 01/13/21                      
*CATALP ACPRINT                                                                 
ACPRINT  TITLE '- MODULE EXECUTES SPECS AND CONTROLS PRINTING'                  
*---------------------------------------------------------------------*         
* GHOA 049 13JAN21 SPEC-51025 1099 NEW REQUIREMENTS FOR 2020          *         
*---------------------------------------------------------------------*         
ACPRINT  CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 REPORTX-REPORTD,**REPT**,R9,R8,CLEAR=YES                         
         USING REPORTD,RC                                                       
         MVC   REPRD,4(RD)         SAVE CALLER'S RD VALUE                       
         L     RA,VACWORKC                                                      
         USING ACWORKD,RA          RA=A(GLOBAL W/S)                             
         L     R6,AMONACC                                                       
         USING ACMD,R6             R6=A(MONACC CSECT)                           
*                                                                               
         L     RE,ADBXAREA                                                      
         USING BOXD,RE                                                          
         MVI   REPINDS,0           CLEAR INDICATOR BYTE                         
         MVC   REPBOXO,BOXOFF      SAVE BOXOFF VALUE                            
         L     R1,VEXTRAS                                                       
         LA    R1,UPPER1-RUNXTRAD(R1)                                           
         ST    R1,AFU              SET ADDRESS OF FIRST UPPER LINE              
         ICM   RF,15,BOXWIDTH                                                   
         DROP  RE                                                               
         C     RF,=A(L'P)                                                       
         BH    *+12                                                             
         L     RF,=A(L'P)                                                       
         B     *+8                                                              
         L     RF,=A(L'XP)                                                      
         C     RF,WIDTHOFP         TEST CHANGE OF PRINT WIDTH                   
         BE    ACR4                                                             
*                                                                               
         ST    RF,WIDTHOFP         INITIALISE FOR NEW PRINT WIDTH               
         BCTR  RF,0                                                             
         ST    RF,WIDTHEXC                                                      
         LA    RE,AFH                                                           
         L     R1,VBIGPRNT                                                      
         LA    RF,BIGTAB                                                        
         CLC   WIDTHOFP,=A(L'P)                                                 
         BH    ACR2                                                             
         LA    R1,ACWORKD                                                       
         LA    RF,REGTAB                                                        
*                                                                               
ACR2     CLI   0(RF),EOT           TEST E-O-T                                   
         BE    ACR4                                                             
         LH    R0,0(RF)            DISPLACEMENT TO FIRST LINE                   
         AR    R0,R1                                                            
         ST    R0,0(RE)            ADDRESS OF FIRST LINE                        
         LH    R0,2(RF)            DISPLACEMENT TO LAST LINE                    
         AR    R0,R1                                                            
         ST    R0,4(RE)            ADDRESS OF LAST LINE                         
         MVC   10(2,RE),4(RF)      NUMBER OF LINES                              
         L     R0,WIDTHOFP                                                      
         MH    R0,10(RE)                                                        
         ST    R0,12(RE)           LENGTH OF BLOCK                              
         LA    RF,6(RF)                                                         
         LA    RE,16(RE)                                                        
         B     ACR2                                                             
*                                                                               
ACR4     CLI   RCFLONLY,YES        TEST PROCESSING FILE SPECS ONLY              
         BE    GO                                                               
         CLI   SKIPSPEC,C'I'       TEST INITIALISE ONLY                         
         BE    ACRX                                                             
         NOP   ACR6                NO-OP FIRST TIME THROUGH                     
         OI    *-3,X'F0'                                                        
         MVI   CLEARHED,YES        SET TO CLEAR LINES AFTER PRINTING            
         MVI   CLEARMID,YES                                                     
         MVI   CLEARFUT,YES                                                     
         MVI   PRINTFUT,0          SET DEFAULT FOOTLINE LINE NUMBER             
*                                                                               
ACR6     CLC   REPLANG,RCLANG      TEST CHANGE OF LANGUAGE                      
         BE    ACR10                                                            
         MVC   REPLANG,RCLANG                                                   
         GOTOR SETLNG              TRANSLATE LITERAL SPECS                      
         LA    R1,REPPARA          GET REPORT LITERALS                          
         USING DICTATED,R1                                                      
         XC    REPPARA(REPPARAL),REPPARA                                        
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,0                                                         
         TM    RCFLAG1,RCFREPLC+RCFREQLC                                        
         BZ    *+8                                                              
         MVI   DDRETN,DDCASEL                                                   
         MVI   DDSYS,6                                                          
         MVC   DDLANG,RCLANG                                                    
         L     R0,AREPDICI                                                      
         STCM  R0,7,DDIADR                                                      
         LA    R0,REPDICO                                                       
         STCM  R0,7,DDOADR                                                      
         GOTO1 ADDICTAT                                                         
*                                                                               
         ICM   R0,15,ACMALCDI      TRANSLATE APPLICATION LC DICTIONARY          
         BZ    ACR8                                                             
         ICM   RF,15,ACMALCDO                                                   
         BZ    ACR8                                                             
         XC    REPPARA(REPPARAL),REPPARA                                        
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,0                                                         
         MVI   DDRETN,DDCASEL                                                   
         MVI   DDSYS,6                                                          
         MVC   DDLANG,RCLANG                                                    
         STCM  R0,7,DDIADR                                                      
         STCM  RF,7,DDOADR                                                      
         GOTO1 ADDICTAT                                                         
*                                                                               
ACR8     ICM   R0,15,ACMAUCDI      TRANSLATE APPLICATION UC DICTIONARY          
         BZ    ACR10                                                            
         ICM   RF,15,ACMAUCDO                                                   
         BZ    ACR10                                                            
         XC    REPPARA(REPPARAL),REPPARA                                        
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,0                                                         
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,6                                                          
         MVC   DDLANG,RCLANG                                                    
         STCM  R0,7,DDIADR                                                      
         STCM  RF,7,DDOADR                                                      
         GOTO1 ADDICTAT                                                         
         DROP  R1                                                               
*                                                                               
ACR10    CLC   REPDATES,RCDATE     TEST DATE HAS CHANGED                        
         BE    ACR12                                                            
         MVC   REPDATES,RCDATE     YES - SAVE AND TRANSLATE                     
         GOTO1 DATCON,REPPARA,(4,REPDATES),(5,REPDATE)                          
*                                                                               
ACR12    CLI   SKIPSPEC,C'R'       TEST PRINT REQUEST REPORT                    
         BE    ACRQ                                                             
         CLI   SKIPSPEC,C'E'       TEST PRINT REQUEST IN ERROR REPORT           
         BE    ACRQ                                                             
         B     CLEAR                                                            
*                                                                               
ACRX     MVI   SKIPSPEC,NO         RESET SKIP SPEC                              
         B     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* OPTIONS TO CLEAR PRINT LINES                                        *         
***********************************************************************         
         SPACE 1                                                                
CLEAR    CLI   FORCECLR,NO         TEST CLEAR ALL PRINT LINES                   
         MVI   FORCECLR,NO                                                      
         BE    GO                                                               
         LM    R0,R1,ASTR          CLEAR WHOLE PRINT BLOCK                      
         SR    R1,R0                                                            
         SR    RE,RE                                                            
         LA    RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
         B     CLEAR10                                                          
*                                                                               
CLEAR2   SR    RE,RE                                                            
         LA    RF,C' '                                                          
         SLL   RF,32-8                                                          
*                                                                               
         CLI   CLEARHED,NO         TEST CLEAR HEADS AFTER PRINTING              
         BE    CLEAR4                                                           
         L     R0,AFH              CLEAR HEADLINES                              
         L     R1,LHL                                                           
         MVCL  R0,RE                                                            
*                                                                               
CLEAR4   CLI   CLEARMID,NO         TEST CLEAR MIDS AFTER PRINTING               
         BE    CLEAR6                                                           
         L     R0,AFM              CLEAR MIDLINES                               
         L     R1,LML                                                           
         MVCL  R0,RE                                                            
*                                                                               
CLEAR6   L     R0,AFP              CLEAR PRINTLINES                             
         L     R1,LPL                                                           
         MVCL  R0,RE                                                            
*                                                                               
CLEAR8   CLI   CLEARFUT,NO         TEST CLEAR FEET AFTER PRINTING               
         BE    CLEAR10                                                          
         L     R0,AFF              CLEAR FOOTLINES                              
         L     R1,LFL                                                           
         MVCL  R0,RE                                                            
*                                                                               
CLEAR10  L     RF,AFU                                                           
         MVC   0(L'UPPER1,RF),WIDESPAC                                          
         MVC   L'UPPER1(L'UPPER2,RF),WIDESPAC                                   
         B     ACRX                                                             
         EJECT                                                                  
***********************************************************************         
* CONTROL SPEC PROCESSING                                             *         
***********************************************************************         
         SPACE 1                                                                
GO       CLI   SKIPSPEC,YES                                                     
         BE    PRINTH                                                           
         CLI   SKIPSPEC,C'F'                                                    
         BE    GO4                                                              
         CLI   RCFLONLY,YES                                                     
         BE    GO4                                                              
         CLI   FORCEHED,YES                                                     
         BE    GO4                                                              
         CLI   FORCEMID,YES                                                     
         BE    GO4                                                              
         CLI   FORCEFUT,YES                                                     
         BE    GO4                                                              
*                                                                               
         LM    RE,RF,ALP           RE=A(LAST PRINT LINE), RF=N'LINES            
         L     R1,WIDTHEXC         R1=LINE WIDTH-1                              
GO2      EX    R1,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RE),WIDESPAC                                                 
         BNE   *+16                                                             
         S     RE,WIDTHOFP                                                      
         BCT   RF,GO2                                                           
         LA    RF,1                                                             
*                                                                               
         SR    R0,R0                                                            
         IC    R0,SPACING          ADD IN SPACING MINUS ONE                     
         BCTR  R0,0                                                             
         AR    RF,R0                                                            
         IC    R0,LINE             AND PRESENT LINE COUNT                       
         AR    RF,R0                                                            
         L     RE,ADBXAREA                                                      
         USING BOXD,RE                                                          
         CLI   BOXREQ,C'B'         TEST BOXLINE REQUESTED TOO                   
         BNE   *+8                                                              
         LA    RF,1(RF)                                                         
         CLM   RF,1,MAXLINES       DO PRINT LINES FIT ON PAGE                   
         BNH   PRINTP                                                           
         MVI   FORCEHED,YES                                                     
         MVI   BOXREQ,C' '                                                      
         DROP  RE                                                               
*                                                                               
GO4      GOTOR PROCSPC             PROCESS SPEC POOL                            
         CLI   RCFLONLY,YES                                                     
         MVI   RCFLONLY,NO                                                      
         BE    ACRX                                                             
*                                                                               
         CLI   SKIPSPEC,C'F'       TEST FOOTLINE PRINTING ONLY                  
         BNE   PRINTH                                                           
         GOTOR FEET                PRINT FOOTLINES                              
         MVI   FORCEFUT,NO                                                      
         MVI   FORCEHED,YES                                                     
         B     CLEAR2                                                           
         EJECT                                                                  
***********************************************************************         
* CONTROL OF HEADLINE PRINTING                                        *         
***********************************************************************         
         SPACE 1                                                                
PRINTH   CLI   FORCEHED,NO                                                      
         MVI   FORCEHED,NO                                                      
         BNE   PRINTH1                                                          
         CLC   LINE,MAXLINES                                                    
         BL    PRINTM                                                           
*                                                                               
PRINTH1  MVI   FORCEMID,YES                                                     
         L     RE,AFF                                                           
         L     RF,WIDTHEXC                                                      
         L     R0,NFL                                                           
PRINTH2  EX    RF,*+8                                                           
         BNE   PRINTH3                                                          
         CLC   0(0,RE),WIDESPAC                                                 
         LA    RE,1(RE,RF)                                                      
         BCT   R0,PRINTH2                                                       
         B     PRINTH4                                                          
*                                                                               
PRINTH3  CLI   FIRSTFUT,YES                                                     
         BE    PRINTH4                                                          
         GOTOR FEET                                                             
         MVI   FIRSTFUT,NO                                                      
*                                                                               
PRINTH4  MVI   FIRSTFUT,NO                                                      
         GOTO1 PRINT,REPPARA,WIDESPAC,BC01                                      
         ORG   *-2                                                              
         CLI   NEWPAGE,NO          TEST DON'T ISSUE SKIP TO CHANNEL 1           
         BE    *+6                                                              
         BASR  RE,RF                                                            
         MVI   NEWPAGE,YES         RESET CHANNEL 1 FLAG                         
*&&UK*&& MVI   LINE,0                                                           
*&&US*&& MVI   LINE,1                                                           
         L     RE,ADMASTC          SKIP 10 LINES IF FORMDEF=Y                   
         TM    MCPRTIND-MASTD(RE),MCPRTIFD                                      
         BZ    PRINTH6                                                          
         GOTO1 (RF),(R1),,BL08                                                  
*&&UK*&& MVI   LINE,10                                                          
*&&US*&& MVI   LINE,11                                                          
*                                                                               
PRINTH6  OC    HEADHOOK,HEADHOOK   TEST HEADLINE HOOK PRESENT                   
         BZ    *+8                                                              
         GOTOR HOOK                                                             
*                                                                               
         L     R1,AFU              TEST UPPERS TO BE PRINTED                    
*&&US                                                                           
         CLI   RCLINEUP,YES        PRINT UPPERS ON LINEUP                       
         BE    PRINTH8                                                          
*&&                                                                             
         CLC   0(L'UPPER1,R1),WIDESPAC                                          
         BNE   *+14                                                             
         CLC   L'UPPER1(L'UPPER2,R1),WIDESPAC                                   
         BE    PRINTH10                                                         
*                                                                               
PRINTH8  LA    R0,2                PRINT UPPER LINES                            
         MVI   REPFLAG,REPFSLA                                                  
         GOTOR PRINTL                                                           
*                                                                               
PRINTH10 L     R1,AFH              PRINT HEADLINES                              
         L     R0,NHL                                                           
         MVI   REPFLAG,0           SET SUPPRESS SPACE AFTER HEADS               
         CLI   XHEADN,0            TEST ANY EXTRA HEADS TO PRINT                
         JNE   PRINTH12            YES                                          
         MVI   REPFLAG,REPFSLA                                                  
         TM    REPTINDS,REPTISSH   TEST SUPPRESS SPACE AFTER HEADS              
         BZ    *+8                 NO                                           
         MVI   REPFLAG,0                                                        
         NI    REPTINDS,FF-REPTISSH                                             
                                                                                
PRINTH12 GOTOR PRINTL              PRINT HEADS (HEAD1-12/XHEAD1-12)             
                                                                                
         CLI   XHEADN,0            TEST ANY EXTRA HEADS TO PRINT                
         BE    PRINTH14                                                         
         MVI   REPFLAG,REPFSLA                                                  
         TM    REPTINDS,REPTISSH   SUPPRESS SPACE LINE AFTER HEADLINES          
         BZ    *+8                                                              
         MVI   REPFLAG,0                                                        
         NI    REPTINDS,FF-REPTISSH                                             
         ICM   R1,7,XHEADA         PRINT EXTRA HEADLINES                        
         LLC   R0,XHEADN                                                        
         GOTOR PRINTL              PRINT EXTRA HEADLINES                        
*                                                                               
PRINTH14 SR    R1,R1               UPDATE PAGE AND SUB-PAGE                     
         ICM   R1,3,PAGE                                                        
         LA    R1,1(R1)                                                         
         STCM  R1,3,PAGE                                                        
         ICM   R1,3,SUBPAGE                                                     
         LA    R1,1(R1)                                                         
         STCM  R1,3,SUBPAGE                                                     
         B     PRINTM                                                           
         EJECT                                                                  
***********************************************************************         
* CONTROL OF MIDLINE PRINTING                                         *         
***********************************************************************         
         SPACE 1                                                                
PRINTM   CLI   FORCEMID,NO                                                      
         MVI   FORCEMID,NO                                                      
         BE    PRINTP                                                           
         L     R1,AFM              PRINT MIDLINES                               
         L     R0,NML                                                           
         MVI   REPFLAG,REPFSLA                                                  
         TM    REPTINDS,REPTISSM   SUPPRESS SPACE LINE AFTER HEADLINES          
         BZ    *+8                                                              
         MVI   REPFLAG,0                                                        
         NI    REPTINDS,FF-REPTISSM                                             
         GOTOR PRINTL                                                           
         CLC   LINE,MAXLINES                                                    
         BNL   PRINTH1                                                          
         SPACE 2                                                                
***********************************************************************         
* CONTROL OF PRINT LINE PRINTING                                      *         
***********************************************************************         
         SPACE 1                                                                
PRINTP   TM    REPTINDS,REPTINOP   TEST SUPPRESS PRINT LINE PRINTING            
         BZ    *+12                                                             
         NI    REPTINDS,FF-(REPTINOP)                                           
         B     CLEAR2                                                           
         L     R1,AFP              PRINT PRINTLINES                             
         L     R0,NPL                                                           
         MVI   REPFLAG,REPFSPA+REPFPRT+REPFBOX                                  
         GOTOR PRINTL                                                           
         MVI   SPACING,1                                                        
         SPACE 2                                                                
***********************************************************************         
* CONTROL OF FOOTLINE PRINTING                                        *         
***********************************************************************         
         SPACE 1                                                                
PRINTF   CLI   FORCEFUT,NO                                                      
         MVI   FORCEFUT,NO                                                      
         BE    *+12                                                             
         GOTOR FEET                PRINT FOOTLINES                              
         MVI   FORCEHED,YES                                                     
         B     CLEAR2                                                           
         EJECT                                                                  
***********************************************************************         
* CONTROL OF PRINTING FOOTLINES                                       *         
***********************************************************************         
         SPACE 1                                                                
FEET     NTR1  ,                                                                
         L     R3,ADBXAREA                                                      
         USING BOXD,R3                                                          
         CLI   SKIPSPEC,YES        NO FEET IF SKIPPING SPECS                    
         BE    FEETX                                                            
         SR    R0,R0                                                            
         IC    R0,LINE                                                          
         SR    R1,R1                                                            
         ICM   R1,1,PRINTFUT       TEST FOOTLINE LINE NUMBER OVERRIDE           
         BNZ   *+8                                                              
*&&UK*&& LA    R1,60               NO - DEFAULT IS RELATIVE LINE NN             
*&&US*&& LA    R1,58                                                            
         SR    R1,R0                                                            
         BNP   FEETX                                                            
         MVC   REPAREA(L'BOXREQ),BOXREQ                                         
         CLI   BOXSTAT,C'I'        TEST INSIDE A BOX                            
         BNE   FEET2                                                            
         MVI   BOXREQ,C'C'         FORCE CLOSE OF BOX                           
         LR    R0,R1                                                            
         GOTO1 PRINT,REPPARA,WIDESPAC,BL01                                      
         LR    R1,R0                                                            
         SH    R1,=H'1'                                                         
         BNP   FEET4                                                            
*                                                                               
FEET2    MVI   BOXOFF,C'X'         TURN BOXES OFF TO ADVANCE TO FEET            
         CVD   R1,REPDUB           ADVANCE TO FOOTLINE                          
         OI    REPDUB+7,X'0F'                                                   
         MVC   REPWORK(2),BL01                                                  
         UNPK  REPWORK+2(2),REPDUB                                              
         GOTO1 PRINT,REPPARA,WIDESPAC,REPWORK                                   
*                                                                               
FEET4    MVC   BOXREQ,REPAREA      RESTORE BOXREQ VALUE                         
         L     R1,AFF              PRINT FOOTLINES                              
         L     R0,NFL                                                           
         MVI   REPFLAG,0                                                        
         GOTOR PRINTL                                                           
FEETX    MVC   BOXOFF,REPBOXO      RESTORE BOXOFF VALUE                         
         MVI   LINE,250            SET LINE TO HIGH VALUE                       
         B     EXIT                                                             
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* CONTROL OF PRINTING A BLOCK OF LINES                                *         
***********************************************************************         
         SPACE 1                                                                
PRINTL   NTR1  ,                                                                
         TM    REPFLAG,REPFBOX                                                  
         BZ    PRINTL1                                                          
         L     RE,ADBXAREA                                                      
         CLI   BOXREQ-BOXD(RE),C'B'                                             
         BNE   PRINTL1                                                          
         STM   R0,R1,REPDUB                                                     
         GOTO1 PRINT,REPPARA,WIDESPAC,BL01                                      
         SR    R1,R1                                                            
         IC    R1,LINE                                                          
         LA    R1,1(R1)                                                         
         STC   R1,LINE                                                          
         LM    R0,R1,REPDUB                                                     
*                                                                               
PRINTL1  L     R7,WIDTHEXC         R7=WIDTH OF LINE-1                           
         LA    RE,1(R7)                                                         
         LR    RF,R0                                                            
         BCTR  RF,0                RF=NUMBER OF LINES-1                         
         MR    RE,RE                                                            
         LA    RF,0(RF,R1)         R2=A(LAST LINE IN BLOCK)                     
PRINTL2  EX    R7,*+8              LOCATE LAST NON-SPACE LINE                   
         B     *+10                                                             
         CLC   0(0,RF),WIDESPAC                                                 
         BNE   PRINTL4                                                          
         S     RF,WIDTHOFP         BACK UP TO PREVIOUS                          
         BCT   R0,PRINTL2          DO FOR NUMBER OF LINES IN BLOCK              
         LA    R0,1                ALL EMPTY - SET TO ONE                       
         TM    REPFLAG,REPFPRT     EXIT IF PRINTING HEADS/MIDS ETC.             
         BZ    PRINTLX                                                          
*                                                                               
PRINTL4  LR    R2,R1               R2=A(FIRST PRINT LINE)                       
         SR    R3,R3               R3=NUMBER OF SPACE LINES                     
PRINTL6  A     R2,WIDTHOFP         BUMP TO NEXT LINE                            
         LA    R3,1(R3)                                                         
         BCT   R0,PRINTL8                                                       
*                                                                               
         TM    REPFLAG,REPFSLA     TEST SPACE LINE AFTER LAST                   
         BZ    *+12                                                             
         LA    R3,1(R3)            YES - ADD ONE TO COUNT                       
         B     PRINTL10                                                         
         TM    REPFLAG,REPFSPA     TEST IF USING SPACING                        
         BZ    PRINTL10                                                         
         SR    RE,RE                                                            
         IC    RE,SPACING                                                       
         BCTR  RE,0                                                             
         AR    R3,RE               ADD SPACING TO COUNT                         
         B     PRINTL10                                                         
*                                                                               
PRINTL8  EX    R7,*+8              TEST THIS LINE IS SPACES                     
         B     *+10                                                             
         CLC   0(0,R2),WIDESPAC                                                 
         BE    PRINTL6                                                          
*                                                                               
PRINTL10 DS    0H                                                               
*&&UK                                                                           
         L     RE,ADMASTC                                                       
         CLI   MCACFCHE-MASTD(RE),C'C'                                          
         BE    *+12                                                             
         CLI   MCACFCHE-MASTD(RE),C'B'                                          
         BNE   PRINTL12                                                         
         ST    R1,REPDUB                                                        
         LR    RF,R1                                                            
         GOTO1 VPRINT,REPPARA,(RF),TL01                                         
         L     R1,REPDUB                                                        
*&&                                                                             
PRINTL12 CVD   R3,REPDUB           BUILD PRINT CONTROL WORD & EXECUTE           
         OI    REPDUB+7,X'0F'                                                   
         MVC   REPWORK+0(2),BL01                                                
         UNPK  REPWORK+2(2),REPDUB                                              
         MVC   REPAREA,0(R1)                                                    
         TM    RCFLAG1,RCFSHIFT    TEST SHIFT RIGHT                             
         BZ    *+14                                                             
         MVI   REPAREA,C' '                                                     
         MVC   REPAREA+1(L'REPAREA-1),0(R1)                                     
         GOTO1 PRINT,REPPARA,REPAREA,REPWORK                                    
         SR    R1,R1                                                            
         IC    R1,LINE             INCREMENT LINES PRINTED                      
         AR    R1,R3                                                            
         STC   R1,LINE                                                          
         LR    R1,R2                                                            
         LTR   R0,R0               TEST ALL LINES PRINTED                       
         BNZ   PRINTL4                                                          
PRINTLX  B     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* EXECUTE THE SPEC POOL                                               *         
***********************************************************************         
         SPACE 1                                                                
PROCSPC  NTR1  ,                                                                
         CLI   RCFLONLY,YES        PRESET I/O VALUES TO N                       
         BNE   PROC1                                                            
         MVI   FCSPEC1,NO          SET ALL SPECS TO NO                          
         MVC   FCSPEC1+1(FCSPEC1L-1),FCSPEC1                                    
         MVI   FCSPEC2,NO                                                       
         MVC   FCSPEC2+1(FCSPEC2L-1),FCSPEC2                                    
*                                                                               
PROC1    OI    REPSW,REPALL        SET ALL SWITCHES TRUE                        
         CLI   RCSUBPRG,0          TEST SUB-PROGRAM SET                         
         BE    *+8                                                              
         NI    REPSW,255-REPPGQ    YES - SET PROGRAM SWITCH NOT TRUE            
*                                                                               
         L     R2,ACSPECS          POINT TO SPEC POOL                           
PROC2    SR    RF,RF                                                            
         ICM   RF,1,0(R2)          RF=SPEC CODE                                 
         BZ    EXIT                                                             
         SLL   RF,2                                                             
         LA    RE,PROC4            SET RETURN ADDRESS                           
         B     *(RF)               GO TO ROUTINE DEPENDENT ON ELEMENT           
*                                                                               
         B     EX08                01 PROGRAM RESET                             
         B     EX10                02 PROGRAM FILTER                            
         B     EX11                03 JOBCOL SPEC                               
         B     EX12                04 GETOPT SPEC                               
         B     EX13                05 JOBBER SPEC                               
         B     EX11                06 FJOBCOL SPEC                              
         B     EX04                07 COUNTRY FILTER                            
         B     EX06                08 LANGUAGE FILTER                           
         B     EX20                09 SPECIAL FILE CONTROL SPECS                
         B     EX20                10 FILE CONTROL SPEC                         
         B     EX20                11 RUN CONTROL SPEC                          
         B     EX24                12 PRINT KEYWORD SPEC                        
         B     EX24                13 PRINT LITERAL SPEC                        
         B     EX24                14 TRANSLATED LITERAL SPEC                   
         B     EX26                15 PRORATA SPEC                              
         B     EX28                16 PTACNV SPEC                               
         B     EX30                17 SELECT SPEC                               
*                                                                               
PROC4    SR    R0,R0               BUMP TO NEXT SPEC                            
         IC    R0,1(R2)                                                         
         AR    R2,R0                                                            
         B     PROC2                                                            
         EJECT                                                                  
***********************************************************************         
* FILTERING SPECS                                                     *         
***********************************************************************         
         SPACE 1                                                                
EX04     NI    REPSW,255-REPCTQ    COUNTRY FILTER                               
         CLI   2(R2),255           COUNTRY 255 MEANS ANY                        
         BE    *+12                                                             
         CLC   RCCTRY,2(R2)        ELSE MATCH ON COUNTRY                        
         BNER  RE                                                               
         OI    REPSW,REPCTQ        SET COUNTRY TRUE                             
         BR    RE                                                               
*                                                                               
EX06     NI    REPSW,255-REPLNQ    LANGUAGE FILTER                              
         CLI   2(R2),255           LANGUAGE 255 MEANS ANY                       
         BE    *+12                                                             
         CLC   RCLANG,2(R2)        ELSE MATCH ON LANGUAGE                       
         BNER  RE                                                               
         OI    REPSW,REPLNQ        SET LANGUAGE TRUE                            
         BR    RE                                                               
*                                                                               
EX08     NI    REPSW,255-REPPGQ    SET PROGRAM FALSE                            
         BR    RE                                                               
*                                                                               
EX10     CLC   RCSUBPRG,2(R2)      CHECK MATCH OF SUB-PROGRAM                   
         BNER  RE                                                               
         OI    REPSW,REPPGQ        SET PROGRAM TRUE                             
         BR    RE                                                               
*                                                                               
EX11     CLI   RCFLONLY,YES        ONLY EXECUTE WHEN DOING FILE SPECS           
         BNER  RE                                                               
         LA    R0,2(R2)            R0=A(JOBCOL COLUMN SPECS)                    
         ST    R0,ACMAJCSP                                                      
         CLI   0(R2),6             TEST FOR FJOBCOL SPEC                        
         BNER  RE                                                               
         OI    ACMINDS2,ACMIFJC    YES-SET FIELD BASED JOBCOL FLAG              
         BR    RE                                                               
*                                                                               
EX12     CLI   RCFLONLY,YES        ONLY EXECUTE WHEN DOING FILE SPECS           
         BNER  RE                                                               
         MVC   FCGETOPT,2(R2)      SET GETOPT CONTROL FLAG                      
         BR    RE                                                               
*                                                                               
EX13     CLI   RCFLONLY,YES        ONLY EXECUTE WHEN DOING FILE SPECS           
         BNER  RE                                                               
         MVC   FCJOBBER,2(R2)      SET JOBBER MODE                              
         BR    RE                                                               
*                                                                               
EX26     CLI   RCFLONLY,YES        ONLY EXECUTE WHEN DOING FILE SPECS           
         BNER  RE                                                               
         MVC   FCPRORAT,2(R2)      SET PRORATA OPTION                           
         BR    RE                                                               
*                                                                               
EX28     CLI   RCFLONLY,YES        ONLY EXECUTE WHEN DOING FILE SPECS           
         BNER  RE                                                               
         MVC   FCPTACNV,2(R2)      SET PTACNV OPTION                            
         BR    RE                                                               
*                                                                               
EX30     CLI   RCFLONLY,YES        ONLY EXECUTE WHEN DOING FILE SPECS           
         BNER  RE                                                               
         OI    ACMINDS5,ACMIJMSE   YES-SET 'SELECTED' MODE FOR JOBBER           
         BR    RE                                                               
         EJECT                                                                  
***********************************************************************         
* FILE AND RUN CONTROL SPECS                                          *         
***********************************************************************         
         SPACE 1                                                                
EX20     CLI   RCFLONLY,YES        APPLY SPEC FILTER                            
         BNER  RE                                                               
         TM    REPSW,REPALL        ALL SWITCHES MUST BE TRUE                    
         BNOR  RE                                                               
*                                                                               
         CLI   0(R2),9             TEST SPECIAL FILE CONTROL SPEC               
         BNE   EX21                                                             
         MVC   FCPERSEC,2(R2)                                                   
         BR    RE                                                               
*                                                                               
EX21     CLI   0(R2),10            TEST FILE CONTROL SPEC                       
         BNE   EX22                                                             
         SR    R1,R1               SET READ COMMAND                             
         IC    R1,2(R2)                                                         
         LA    RF,FCSPEC1-1                                                     
         CH    R1,=Y(FCSPEC1L)     TEST IN SECOND FILE CONTROL AREA             
         BNH   *+12                                                             
         LA    RF,FCSPEC2-1                                                     
         SH    R1,=Y(FCSPEC1L)                                                  
         AR    R1,RF                                                            
         MVI   0(R1),YES                                                        
         CLI   1(R2),4             TEST 4 BYTE ELEMENT                          
         BNER  RE                                                               
         MVC   0(1,R1),3(R2)       YES - SET SPEC VALUE FROM ELEMENT            
         BR    RE                                                               
*                                                                               
EX22     CLI   2(R2),3             TEST SPACING COMMAND                         
         BH    *+12                                                             
         MVC   SPACING,2(R2)                                                    
         BR    RE                                                               
*                                                                               
         CLI   2(R2),4             TEST LINEUP COMMAND                          
         BH    *+10                                                             
         MVI   RCLINEUP,YES                                                     
         BR    RE                                                               
*                                                                               
         CLI   2(R2),6             TEST REQDETS COMMAND                         
         BH    EX222                                                            
         MVI   RCREQREP,NO                                                      
         BER   RE                                                               
         MVI   RCREQREP,YES                                                     
         BR    RE                                                               
*                                                                               
EX222    CLI   2(R2),8             TEST REQSUM COMMAND                          
         BH    EX224                                                            
         MVI   RCREQSUM,NO                                                      
         BER   RE                                                               
         MVI   RCREQSUM,YES                                                     
         BR    RE                                                               
*                                                                               
EX224    CLI   2(R2),9             TEST PROGRAM COMMAND                         
         BH    EX226                                                            
         SR    R0,R0                                                            
         IC    R0,3(R2)                                                         
         CVD   R0,REPDUB                                                        
         OI    REPDUB+7,X'0F'                                                   
         UNPK  RCPROG,REPDUB                                                    
         BR    RE                                                               
*                                                                               
EX226    CLI   2(R2),10            TEST FILTER COMMAND                          
         BH    *+10                                                             
         MVI   RCFILTER,NO                                                      
         BR    RE                                                               
*                                                                               
EX228    MVC   MAXLINES,2(R2)                                                   
         BR    RE                                                               
         EJECT                                                                  
***********************************************************************         
* PRINT SPEC CONTROL AND LITERALS                                     *         
***********************************************************************         
         SPACE 1                                                                
EX24     CLI   RCFLONLY,YES                                                     
         BER   RE                                                               
         TM    REPSW,REPALL        ALL SWITCHES MUST BE TRUE                    
         BNOR  RE                                                               
         SR    R5,R5                                                            
         ICM   R5,3,2(R2)                                                       
         A     R5,AFH                                                           
         CLC   WIDTHOFP,=A(L'P)    NO UPPERS FOR WIDE PRINT                     
         BH    EX242                                                            
         CLC   2(2,R2),=AL2(L'P*21) SPECIAL CODE FOR UPPER1/2                   
         BL    EX242                                                            
         LH    R5,2(R2)            THEY LOOK LIKE LINES 22/23                   
         SH    R5,=AL2(L'P*21)     SO SUBTRACT 21 LINES                         
         A     R5,AFU              AND DISPLACE INTO SPECIAL LINES              
*                                                                               
EX242    CLI   0(R2),13            TEST LITERAL VALUE                           
         BE    KMOVE                                                            
         CLI   0(R2),14            TEST TRANSLATED LITERAL                      
         BE    KMOVEL                                                           
         SR    RF,RF               WORK OUT BRANCH BY INSTRUCTION NUM           
         IC    RF,4(R2)                                                         
         SLL   RF,2                                                             
         B     *+4(RF)                                                          
*                                                                               
         B     KSPACES             0  SPACES                                    
         B     KRUN                1  RUN                                       
         B     KREPORT             2  REPORT                                    
         B     KPAGE               3  PAGE                                      
         B     KPERIOD             4  PERIOD                                    
         B     KREQSTOR            5  REQUESTOR                                 
         B     KCOMPANY            6  COMPANY                                   
         B     KCOMPADD            7  COMPADD                                   
         B     KUNIT               8  UNIT                                      
         B     KUNITADD            9  UNITADD                                   
         B     KLEDGER             10 LEDGER                                    
         B     KACCOUNT            11 ACCOUNT                                   
         B     KACCADD             12 ACCADD                                    
         B     KCOMPNAM            13 COMPNAME                                  
         B     KMOSFLT             14 MOSFILT                                   
         B     0(RE)               15 N/D                                       
         B     0(RE)               16 N/D                                       
         B     0(RE)               17 N/D                                       
         B     0(RE)               18 N/D                                       
         B     0(RE)               19 N/D                                       
         B     0(RE)               20 N/D                                       
         B     KRQDET              21 REQDETS                                   
         B     0(RE)               22 N/D                                       
         B     0(RE)               23 N/D                                       
         B     0(RE)               24 N/D                                       
         B     KORGNAME            25 ORIGIN NAME                               
         B     KORGADD             26 ORIGIN ADDRESS                            
*&&UK*&& B     KFLTNAME            27 FILTER NAME                               
*&&US*&& DC    AL4(0)              27 N/D                                       
*&&UK*&& B     KCURR               28 CURRENCY                                  
*&&US*&& DC    AL4(0)              28 N/D                                       
         EJECT                                                                  
***********************************************************************         
* MOVE LITERALS FROM SPEC AND TRANSLATE IF NECESSARY                  *         
***********************************************************************         
         SPACE 1                                                                
KMOVE    CLI   4(R2),LITTELOQ      TEST LITERAL NEEDS DICTIONARY LOOKUP         
         BL    KMOVE2                                                           
         CLI   4(R2),LITTEHIQ                                                   
         BH    KMOVE2                                                           
*                                                                               
         LR    R0,RE                                                            
         LA    R1,REPPARA          BUILD DICTATE PARAMETER LIST                 
         XC    REPPARA(REPPARAL),REPPARA                                        
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNS      RESOLVE SINGLE EXPRESSION INTO SPEC          
         MVI   DDRETN,0                                                         
         TM    RCFLAG1,RCFREPLC    TEST LOWER CASE REQUESTED                    
         BZ    *+8                                                              
         MVI   DDRETN,DDCASEL                                                   
         MVI   DDSYS,6                                                          
         MVC   DDLANG,RCLANG                                                    
         MVC   REPWORK(4),4(R2)                                                 
         LA    RF,REPWORK                                                       
         STCM  RF,7,DDIADR                                                      
         GOTO1 ADDICTAT                                                         
         LR    RE,R0                                                            
*                                                                               
         SR    R1,R1               EXTRACT ACTUAL LENGTH                        
         IC    R1,1(R2)                                                         
         SH    R1,=H'5'            LENGTH IS L'ELEMENT - 4                      
         EX    R1,*+6                                                           
         BR    RE                                                               
         MVC   0(0,R5),REPWORK     MOVE LITERAL TO OUTPUT LINE                  
         DROP  R1                                                               
*                                                                               
KMOVE2   SR    R1,R1               EXTRACT ACTUAL LENGTH                        
         IC    R1,1(R2)                                                         
         SH    R1,=H'5'            LENGTH IS L'ELEMENT - 4                      
         EX    R1,*+6                                                           
         BR    RE                                                               
         MVC   0(0,R5),4(R2)       MOVE LITERAL TO OUTPUT LINE                  
*                                                                               
KMOVEL   SR    RF,RF               EXTRACT LITERAL FROM LITERAL POOL            
         ICM   RF,7,4(R2)                                                       
         USING LITTABD,RF                                                       
         MVC   REPDUB(1),LITTELEN                                               
         NI    REPDUB,X'7F'                                                     
         SR    R1,R1                                                            
         IC    R1,REPDUB                                                        
         BCTR  R1,0                                                             
         EX    R1,*+6                                                           
         BR    RE                                                               
         MVC   0(0,R5),LITTDATA                                                 
         DROP  RF                                                               
         EJECT                                                                  
***********************************************************************         
* ROUTINES FOR PRINT SPECS                                            *         
***********************************************************************         
         SPACE 1                                                                
KSPACES  MVC   0(110,R5),WIDESPAC                                               
         CLI   SKIPSPEC,C'T'                                                    
         BER   RE                                                               
         L     R1,WIDTHEXC                                                      
         EX    R1,*+6                                                           
         BR    RE                                                               
         MVC   0(0,R5),WIDESPAC                                                 
*                                                                               
KRUN     MVC   0(L'ACRUNON@,R5),ACRUNON@                                        
         LA    R5,L'ACRUNON@-1(R5)                                              
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVC   2(L'REPDATE,R5),REPDATE                                          
         LA    R5,2+L'REPDATE-1(R5)                                             
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVC   3(L'ACAT@,R5),ACAT@                                              
         LA    R5,3+L'ACAT@-1(R5)                                               
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         GOTO1 TIME,2(R5)                                                       
         B     PROC4                                                            
*                                                                               
KREPORT  MVC   0(L'ACRPT@,R5),ACRPT@                                            
         MVC   8(2,R5),=C'AC'                                                   
         MVC   10(2,R5),RCPROG                                                  
         B     PROC4                                                            
*                                                                               
KPAGE    MVC   0(L'ACPAGE@,R5),ACPAGE@                                          
         LA    R5,L'ACPAGE@-1(R5)                                               
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         EDIT  PAGE,(5,2(R5)),ALIGN=LEFT,DUB=REPDUB,WRK=REPWORK                 
         B     PROC4                                                            
*                                                                               
KPERIOD  CLC   QSTART,WIDESPAC                                                  
         BE    KPERIOD4                                                         
         CLC   QEND,WIDESPAC                                                    
         BNE   *+14                                                             
         MVC   0(L'ACFROM@,R5),ACFROM@                                          
         LA    R5,L'ACFROM@(R5)                                                 
*                                                                               
         CLC   QSTART+4(2),WIDESPAC                                             
         BNE   KPERIOD2                                                         
         MVC   QSTART+4(2),=C'01'                                               
         GOTO1 DATCON,REPWORK,(0,QSTART),(6,0(R5))                              
         MVC   QSTART+4(2),WIDESPAC                                             
         CLC   QEND,WIDESPAC                                                    
         BE    PROC4                                                            
         LA    R5,7(R5)                                                         
         B     KPERIOD4                                                         
*                                                                               
KPERIOD2 GOTO1 DATCON,REPWORK,(0,QSTART),(5,0(R5))                              
         CLC   QEND,WIDESPAC                                                    
         BE    PROC4                                                            
         LA    R5,10(R5)                                                        
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         LA    R5,2(R5)                                                         
*                                                                               
KPERIOD4 CLC   QEND,WIDESPAC                                                    
         BE    PROC4                                                            
         MVC   0(L'ACTO@,R5),ACTO@                                              
         CLC   QEND+4(2),WIDESPAC                                               
         BNE   KPERIOD6                                                         
         MVC   QEND+4(2),=C'01'                                                 
         GOTO1 DATCON,REPWORK,(0,QEND),(6,4(R5))                                
         MVC   QEND+4(2),WIDESPAC                                               
         B     PROC4                                                            
*                                                                               
KPERIOD6 GOTO1 DATCON,REPWORK,(0,QEND),(5,4(R5))                                
         B     PROC4                                                            
*                                                                               
KREQSTOR MVC   0(L'ACREQR@,R5),ACREQR@                                          
         MVC   11(12,R5),QUESTOR                                                
         B     PROC4                                                            
*                                                                               
KCOMPANY MVC   0(L'ACCPY@,R5),ACCPY@                                            
         L     R1,ADCOMP                                                        
         LA    R5,11(R5)                                                        
         B     FINDNAME                                                         
*                                                                               
KCOMPNAM L     R1,ADCOMP                                                        
         B     FINDNAME                                                         
*                                                                               
KCOMPADD L     R1,ADCOMP                                                        
         B     FINDADD                                                          
*                                                                               
KMOSFLT  CLI   ACMMEND,FF                                                       
         BE    PROC4                                                            
         MVC   0(L'ACPSTGS@,R5),ACPSTGS@                                        
         LA    R5,L'ACPSTGS@-1(R5)                                              
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         CLC   ACMCMSTR,WIDESPAC                                                
         BNE   KMOSFLT2                                                         
         MVC   2(L'ACTHRU@,R5),ACTHRU@                                          
         LA    R5,2+L'ACTHRU@-1(R5)                                             
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVC   2(L'ACMCMEND,R5),ACMCMEND                                        
         B     PROC4                                                            
*                                                                               
KMOSFLT2 MVC   2(L'ACFOR@,R5),ACFOR@                                            
         LA    R5,2+L'ACFOR@-1(R5)                                              
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVC   2(L'ACMCMSTR,R5),ACMCMSTR                                        
         LA    R5,2+L'ACMCMSTR-1(R5)                                            
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         CLC   ACMMSTR,ACMMEND                                                  
         BNE   KMOSFLT4                                                         
         MVC   2(L'ACONLY@,R5),ACONLY@                                          
         B     PROC4                                                            
*                                                                               
KMOSFLT4 MVC   2(L'ACTHRU@,R5),ACTHRU@                                          
         LA    R5,2+L'ACTHRU@-1(R5)                                             
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVC   2(L'ACMCMEND,R5),ACMCMEND                                        
         B     PROC4                                                            
*                                                                               
KUNIT    MVC   0(L'ACUNIT@,R5),ACUNIT@                                          
         L     R1,ADUNIT                                                        
         MVC   9(1,R5),1(R1)                                                    
         LA    R5,11(R5)                                                        
         B     FINDNAME                                                         
*                                                                               
KUNITADD L     R1,ADUNIT                                                        
         B     FINDADD                                                          
*                                                                               
KLEDGER  MVC   0(L'ACLGR@,R5),ACLGR@                                            
         L     R1,ADLEDGER                                                      
         MVC   9(1,R5),2(R1)                                                    
*                                                                               
KLEDGER2 LA    R5,11(R5)                                                        
         B     FINDNAME                                                         
*                                                                               
KACCOUNT L     R1,ADACC                                                         
         B     FINDNAME                                                         
*                                                                               
KACCADD  L     R1,ADACC                                                         
         B     FINDADD                                                          
*                                                                               
KORGNAME L     R1,VEXTRAS                                                       
         MVC   0(L'ORIGINAM,R5),ORIGINAM-RUNXTRAD(R1)                           
         B     PROC4                                                            
*                                                                               
KORGADD  L     R1,VEXTRAS                                                       
         MVC   0(L'ORIGINAD,R5),ORIGINAD-RUNXTRAD(R1)                           
         B     PROC4                                                            
*&&UK                                                                           
KCURR    L     RF,ADQSTACK         TEST CURRENCY REQUEST                        
         LA    RF,ACQCURR-ACQD(,RF)                                             
         SR    RE,RE                                                            
         CLC   RCPROG(2),=C'DB'    NO CURR INFO FOR THOSE REPORTS               
         BE    PROC4                                                            
         CLC   RCPROG(2),=C'EB'                                                 
         BE    PROC4                                                            
         CLC   RCPROG(2),=C'DD'                                                 
         BE    PROC4                                                            
         CLC   RCPROG(2),=C'ED'                                                 
         BE    PROC4                                                            
         CLI   0(RF),C' '          YES                                          
         BNE   KCURR02                                                          
         L     RF,ADCMPEL                                                       
         CLI   CPYLN-CPYELD(RF),CPYLN2Q                                         
         BL    PROC4                                                            
         TM    CPYSTAT7-CPYELD(RF),CPYSSCNV                                     
         BZ    PROC4                                                            
         LA    RE,CPYCURR-CPYELD(,RF)                                           
*                                                                               
KCURR02  MVC   0(L'ACRCURR@,R5),ACRCURR@                                        
         LA    R5,L'ACRCURR@-1(,R5)                                             
         CLI   0(R5),C' '                                                       
         BNE   *+8                                                              
         BCT   R5,*-8                                                           
         LTR   RE,RE                                                            
         BNZ   KCURR04                                                          
         LA    RE,CPYCURR-CPYELD                                                
         CLI   0(RF),ACQC2ND                                                    
         BNE   *+8                                                              
         LA    RE,CPYCURRS-CPYELD                                               
         A     RE,ADCMPEL                                                       
*                                                                               
KCURR04  MVC   2(L'CPYCURR,R5),0(RE)                                            
         B     PROC4                                                            
*&&                                                                             
KFLTNAME L     RF,ADCMPEL                                                       
         TM    CPYSTAT8-CPYELD(RF),CPYSFNAM                                     
         BZ    KFLTNM10                                                         
*                                                                               
         MVC   GFLTCOM,ADCOMFAC    A(COMFACS)                                   
         MVI   GFLTCMD,GFLTCNAM    GET FILTER NAME                              
         MVC   GFLTBLD,=V(ACGFBUFF) A(TABLE BUILD AREA)                         
*                                                                               
         MVC   GFLTCPY,RCSVCOMP    COMPANY HEXCOMP                              
         MVC   GFLTUL,RCSVUNIT     UNIT/LEDGER                                  
         MVC   GFLTACT,SPACES      ACCOUNT                                      
         XR    RF,RF                                                            
         IC    RF,5(,R2)           B4B4 : FILTER NUMBER : TYPE REQ             
         SRL   RF,4                                                             
         STC   RF,GFLTRFLT                                                      
         GOTO1 =V(ACGETFLT),GFLTCMD                                             
         BNE   KFLTNM10            NO NAME FOR THIS FILTER                      
*                                                                               
         USING GFLNAMD,R1                                                       
         ICM   R1,15,GFLTADR                                                    
         BNZ   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         XR    RF,RF                                                            
         IC    RF,5(,R2)                                                        
         SLL   RF,32-4                                                          
         SRL   RF,32-4             PRESERVE LOW ORDER NIBBLE                    
         BCTR  RF,0                                                             
         SLL   RF,2                                                             
         L     RF,KFTYP(RF)                                                     
         BR    RF                                                               
*                                                                               
KFLTNM02 CLC   GFLNLNM,SPACES      LONG NAME SET?                               
         BNH   KFLTNM04            NO - USE SHORT NAME THEN                     
*                                                                               
         LA    RF,L'GFLNLNM-1                                                   
         LA    RE,GFLNLNM                                                       
         B     KFLTNM08                                                         
*                                                                               
KFLTNM04 CLC   GFLNSNM,SPACES      SHORT NAME SET?                              
         BNH   KFLTNM06            NO - USE CODE THEN                           
*                                                                               
         LA    RF,L'GFLNSNM-1                                                   
         LA    RE,GFLNSNM                                                       
         B     KFLTNM08                                                         
*                                                                               
KFLTNM06 CLC   GFLNCDE,SPACES      CODE SET?                                    
         BNH   KFLTNM10            NO - USE 'FILTER X' THEN                     
*                                                                               
         LA    RF,L'GFLNCDE-1                                                   
         LA    RE,GFLNCDE                                                       
*                                                                               
KFLTNM08 EX    RF,*+8              MOVE IN CORRECT NAME VALUE                   
         B     *+10                                                             
         MVC   0(0,R5),0(RE)                                                    
         CLM   RF,1,=AL1(L'GFLNSNM-1)                                           
         BH    *+8                                                              
         ICM   RF,1,=AL1(L'GFLNSNM-1)                                           
         LA    R5,2(R5,RF)         POINT TO 1 PAST THE END                      
         B     KFLTNM12                                                         
         DROP  R1                                                               
*                              *** FILL IN 'FILTER 1' INSTEAD OF NAME           
KFLTNM10 XR    RE,RE                                                            
         IC    RE,5(R2)            B4B4 : FILTER NUMBER : TYPE REQ             
         SRDL  RE,4                RE = FILTER NUMBER                           
         BCTR  RE,0                                                             
         SLL   RE,2                RE = DISP INTO TYPE BLOCK                    
         SRL   RF,32-4             RF = TYPE REQUIRED                           
         BCTR  RF,0                                                             
         MH    RF,=Y(KFNFLQ)       RF = DISP INTO TABLE TO TYPE BLOCK           
         LA    RF,KFNDCDD(RF)                                                   
         LA    RF,0(RE,RF)         RF POINTS TO THE DCDDL TO USE                
*                                                                               
         MVI   3(RF),12        *** PUT OUT SHORT LENGTH NAME ONLY               
*                                                                               
         XR    R0,R0                                                            
         IC    R0,3(RF)                                                         
         MVC   0(4,R5),0(RF)                                                    
         GOTO1 ADDICTAT,REPPARA,C'SL  ',(R5)                                    
*                                                                               
         CLM   R0,1,=AL1(L'GFLNSNM)                                             
         BH    *+8                                                              
         ICM   R0,1,=AL1(L'GFLNSNM)                                             
         AR    R5,R0                                                            
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         LA    R5,2(R5)                                                         
         B     KFLTNM12                                                         
*                                                                               
KFLTNM12 L     RE,ADCMPEL                                                       
         TM    CPYSTAT8-CPYELD(RE),CPYSFNAM                                     
         BZ    KFLTNM22                                                         
*                                                                               
         XR    RF,RF                                                            
         IC    RF,5(R2)            B4B4 : FILTER NUMBER : TYPE REQ             
         SRL   RF,4                RF = FILTER NUMBER                           
         BCTR  RF,0                                                             
         SLL   RF,1                                                             
         LA    RF,KFVDSP(RF)                                                    
         LH    RF,0(RF)            RF = DISPLACEMENT TO FILTER                  
         A     RF,AMONACC          RF = A(THIS FILTER VALUE)                    
         XR    RE,RE                                                            
         IC    RE,0(RF)                                                         
         STC   RE,GFLTRVAL         VALUE                                        
*                                                                               
         MVC   GFLTCOM,ADCOMFAC    A(COMFACS)                                   
         MVI   GFLTCMD,GFLTCVAL    GET FILTER VALUE                             
         MVC   GFLTBLD,=V(ACGFBUFF) A(TABLE BUILD AREA)                         
*                                                                               
         MVC   GFLTCPY,RCSVCOMP    COMPANY HEXCOMP                              
         MVC   GFLTUL,RCSVUNIT     UNIT/LEDGER                                  
         MVC   GFLTACT,SPACES      ACCOUNT                                      
*                                                                               
         XR    RF,RF                                                            
         IC    RF,5(R2)            B4B4 : FILTER NUMBER : TYPE REQ             
         SRL   RF,4                                                             
         STC   RF,GFLTRFLT                                                      
         GOTO1 =V(ACGETFLT),GFLTCMD                                             
         BNE   KFLTNM22            NO NAME FOR THIS FILTER                      
*                                                                               
         USING GFLVALD,R1                                                       
         ICM   R1,15,GFLTADR                                                    
         BNZ   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         XR    RF,RF                                                            
         IC    RF,5(R2)                                                         
         SLL   RF,32-4                                                          
         SRL   RF,32-4             PRESERVE LOW ORDER NIBBLE                    
         BCTR  RF,0                                                             
         SLL   RF,2                                                             
         L     RF,KFVTYP(RF)                                                    
         BR    RF                                                               
*                                                                               
KFLTNM14 CLC   GFLVLNM,SPACES      LONG NAME SET?                               
         BNH   KFLTNM16            NO - USE SHORT NAME THEN                     
*                                                                               
         LA    RF,GFLVLNM+L'GFLVLNM-1                                           
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RE,GFLVLNM                                                       
         SR    RF,RE                                                            
         B     KFLTNM20                                                         
*                                                                               
KFLTNM16 CLC   GFLVSNM,SPACES      SHORT NAME SET?                              
         BNH   KFLTNM18            NO - USE CODE THEN                           
*                                                                               
         LA    RF,GFLVSNM+L'GFLVSNM-1                                           
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RE,GFLVSNM                                                       
         SR    RF,RE                                                            
         B     KFLTNM20                                                         
*                                                                               
KFLTNM18 CLC   GFLVCDE,SPACES      CODE SET?                                    
         BNH   KFLTNM22            NO - USE 'FILTER X' THEN                     
*                                                                               
         LA    RF,GFLVCDE+L'GFLVCDE-1                                           
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RE,GFLVCDE                                                       
         SR    RF,RE                                                            
*                                                                               
KFLTNM20 EX    RF,*+8              MOVE IN CORRECT NAME VALUE                   
         B     *+10                                                             
         MVC   0(0,R5),0(RE)                                                    
         B     KFLTNMX                                                          
         DROP  R1                                                               
*                              *** FILL IN REAL CODE INSTEAD OF NAME            
KFLTNM22 XR    RF,RF                                                            
         IC    RF,5(R2)            B4B4 : FILTER NUMBER : TYPE REQ             
         SRL   RF,4                RF = FILTER NUMBER                           
         BCTR  RF,0                ZERO BASE IT                                 
         SLL   RF,1                DOUBLE IT                                    
         LA    RF,KFVDSP(RF)                                                    
         LH    RF,0(RF)            RF = DISPLACEMENT TO FILTER                  
         A     RF,AMONACC          RF = A(THIS FILTER VALUE)                    
*                                                                               
         MVC   0(L'ACMFLT1,R5),0(RF)                                            
         B     KFLTNMX                                                          
*                              *** DISPLACEMENTS TO FILTERS                     
KFVDSP   DC    Y(ACMFLT1-ACMD)     FILTER 1                                     
         DC    Y(ACMFLT2-ACMD)     FILTER 2                                     
         DC    Y(ACMFLT3-ACMD)     FILTER 3                                     
         DC    Y(ACMFLT4-ACMD)     FILTER 4                                     
         DC    Y(ACMFLT5-ACMD)     FILTER 5                                     
*                                                                               
*                              *** FILTER NAME - ALWAYS SHORT NAME LEN.         
KFTYP    DC    A(KFLTNM04)         1:  8 CHAR CODE                              
         DC    A(KFLTNM04)         2: 12 CHAR SHORT NAME                        
         DC    A(KFLTNM04)         3: 36 CHAR LONG NAME                         
*                                                                               
*                              *** FILTER VALUE - REQUESTED LENGTH              
KFVTYP   DC    A(KFLTNM18)         1:  8 CHAR CODE                              
         DC    A(KFLTNM16)         2: 12 CHAR SHORT NAME                        
         DC    A(KFLTNM14)         3: 36 CHAR LONG NAME                         
*                                                                               
KFNDCDD  DCDDL AC#FLT1,8,L          FILTERS 1-5 CODE LENGTH                     
         DCDDL AC#FLT2,8,L                                                      
         DCDDL AC#FLT3,8,L                                                      
         DCDDL AC#FLT4,8,L                                                      
         DCDDL AC#FLT5,8,L                                                      
KFNFLQ   EQU   *-KFNDCDD                                                        
         DCDDL AC#FLT1,12,L        FILTERS 1-5 SHORT NAME LENGTH                
         DCDDL AC#FLT2,12,L                                                     
         DCDDL AC#FLT3,12,L                                                     
         DCDDL AC#FLT4,12,L                                                     
         DCDDL AC#FLT5,12,L                                                     
         DCDDL AC#FLT1,36,L        FILTERS 1-5 LONG NAME LENGTH                 
         DCDDL AC#FLT2,36,L                                                     
         DCDDL AC#FLT3,36,L                                                     
         DCDDL AC#FLT4,36,L                                                     
         DCDDL AC#FLT5,36,L                                                     
*                                                                               
         DSDDL CLEAR=YES           DON'T GENERATE DS FOR THOSE ABOVE            
*                                                                               
KFLTNMX  B     PROC4                                                            
         EJECT                                                                  
***********************************************************************         
* REQUEST DETAILS - FOOTLINES                                         *         
***********************************************************************         
         SPACE 1                                                                
KRQDET   CLI   SYSPROF,NO          DONT EXECUTE IF SYSPROF SAYS SO              
         BE    PROC4                                                            
         MVI   REPACTN,REPAFUT     SET FOOTLINE OPTION                          
         GOTOR RQDT                PRINT REQUEST DETAIL                         
         CLI   REPREQF,0           CHECK FOR ANY DETAILS                        
         BE    PROC4                                                            
         LA    R7,REPAREA+(L'REPAREA-1)                                         
         CLI   0(R7),X'40'                                                      
         BH    *+10                                                             
         BCTR  R7,0                                                             
         B     *-10                                                             
         MVI   1(R7),C')'          CLOSE BRACKETS                               
         GOTO1 CHOPPER,REPPARA,(255,REPAREA),(108,(R5)),(C'P',2)                
         B     PROC4                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO EXTRACT NAME                                             *         
***********************************************************************         
         SPACE 1                                                                
FINDNAME AH    R1,DATADISP                                                      
         SR    RF,RF                                                            
         USING NAMELD,R1                                                        
FINDN2   CLI   NAMEL,0                                                          
         BE    PROC4                                                            
         CLI   NAMEL,NAMELQ                                                     
         BE    FINDN4                                                           
         ICM   RF,1,NAMLN                                                       
         BZ    PROC4                                                            
         AR    R1,RF                                                            
         B     FINDN2                                                           
FINDN4   IC    RF,NAMLN                                                         
         SH    RF,=Y(NAMEREC+1-NAMELD)                                          
         EX    RF,*+8                                                           
         B     PROC4                                                            
         MVC   0(0,R5),NAMEREC                                                  
         DROP  R1                                                               
         SPACE 2                                                                
***********************************************************************         
* ROUTINE TO EXTRACT ADDRESS                                          *         
***********************************************************************         
         SPACE 1                                                                
FINDADD  AH    R1,DATADISP                                                      
         SR    RF,RF                                                            
         USING ADRELD,R1                                                        
FINDA2   CLI   ADREL,0                                                          
         BE    PROC4                                                            
         CLI   ADREL,ADRELQ                                                     
         BE    FINDA4                                                           
         ICM   RF,1,ADRLN                                                       
         BZ    PROC4                                                            
         AR    R1,RF                                                            
         B     FINDA2                                                           
FINDA4   IC    RF,ADRNUM                                                        
         LA    R1,ADRADD1                                                       
FINDA6   MVC   0(L'ADRADD1,R5),0(R1)                                            
         A     R5,WIDTHOFP                                                      
         LA    R1,L'ADRADD1(R1)                                                 
         BCT   RF,FINDA6                                                        
         B     PROC4                                                            
         DROP  R1                                                               
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO VALIDATE REQUEST AND PRINT REQUEST REPORT                *         
***********************************************************************         
         SPACE 1                                                                
ACRQ     MVC   REPSAVRR,RCREQREP   SAVE REQREP VALUE                            
         CLI   SKIPSPEC,C'E'       TEST ERROR ON REQUEST                        
         BNE   *+8                                                              
         MVI   RCREQREP,YES        TURN ON REQUEST PRINTING IF ERROR            
         MVI   FIRSTFUT,YES        SET REQFIRST FOR ACPRINT                     
         L     RE,VCOMC                                                         
         MVI   COMSTART-COMCTRLD(RE),0                                          
         CLI   RCREQREP,NO                                                      
         BE    ACRX                                                             
         L     RE,ADBXAREA                                                      
         MVI   BOXOFF-BOXD(RE),YES                                              
*                                                                               
         CLI   RCREQREP,YES        TEST REQUEST REPORT OR VALIDATE ONLY         
         BNE   ACRQ10                                                           
         GOTO1 PRINT,REPPARA,WIDESPAC,BC01                                      
         L     RE,ADMASTC          SKIP 10 LINES IF FORMDEF=Y                   
         TM    MCPRTIND-MASTD(RE),MCPRTIFD                                      
         BZ    ACRQ02                                                           
         GOTO1 (RF),(R1),,BL08                                                  
         B     ACRQ04                                                           
*                                                                               
ACRQ02   CLI   RCCTRY,CTRYGER      GERMANY GET 2 NULL LINES ON REQ PAGE         
         BNE   ACRQ04                                                           
         GOTO1 (RF),(R1),,BL02                                                  
*                                                                               
ACRQ04   MVC   P,WIDESPAC                                                       
         MVC   P+19(L'ACRUNON@),ACRUNON@                                        
         MVC   P+31(L'REPDATE),REPDATE                                          
         MVC   P+45(L'AC@REQDE),AC@REQDE                                        
         GOTO1 (RF),(R1),P,BL01                                                 
         MVC   P,WIDESPAC                                                       
         MVC   P+45(L'AC$REQDE),AC$REQDE                                        
         MVC   P+19(L'ACAT@),ACAT@                                              
         GOTO1 TIME,P+31                                                        
         GOTO1 PRINT,REPPARA,P,BL03                                             
         MVC   P,WIDESPAC                                                       
         MVC   P+24(L'AC@REQFD),AC@REQFD                                        
         GOTO1 (RF),(R1),,BL01                                                  
         MVC   P+24(L'AC$REQFD),AC$REQFD                                        
         GOTO1 (RF),(R1),,BL03                                                  
         MVC   P,WIDESPAC                                                       
*                                                                               
ACRQ05   MVI   REPACTN,REPADRQ     SET DETAILS OF REQUEST                       
         GOTOR RQDT                PRINT REQUEST DETAIL                         
*                                                                               
ACRQ10   DS    0H                                                               
*&&UK                                                                           
         CLI   RCREQREP,YES        TEST PRINTING REQUEST REPORT                 
         BNE   ACRQ18                                                           
         TM    ACMINDS,ACMINEWO    TEST NEW OFFICE SYSTEM IN USE                
         BNZ   ACRQ16                                                           
         CLI   ACMOFCL,0           TEST OLD OFFICE LIMIT ACCESS SET             
         BE    ACRQ18                                                           
         GOTO1 PRINT,REPPARA,WIDESPAC,BL04                                      
         LA    R1,ACMOFCL                                                       
         MVC   P+24(REQNAMEL),AC@LACOF                                          
         LA    RE,P+45                                                          
         LA    R0,32                                                            
ACRQ12   CLI   0(R1),C'*'          IGNORE OFFICE ACTERISK                       
         BE    ACRQ14                                                           
         CLI   0(R1),0             IGNORE BINARY ZERO                           
         BE    ACRQ14                                                           
         MVC   0(1,RE),0(R1)       MOVE OUT OFFICE CHARACTER                    
         MVI   1(RE),C','                                                       
         LA    RE,2(RE)            BUMP TO NEXT OUTPUT CHARACTER                
ACRQ14   LA    R1,1(R1)            BUMP TO NEXT OFFICE IN LIST                  
         BCT   R0,ACRQ12           DO FOR NUMBER OF OFFICES                     
         BCTR  RE,0                                                             
         MVI   0(RE),C' '          REMOVE TRAILING DELIMITER                    
         GOTO1 PRINT,REPPARA,P,BL02                                             
         MVC   P,WIDESPAC                                                       
         B     ACRQ18                                                           
*                                                                               
ACRQ16   DS    0H                                                               
*&&                                                                             
ACRQ18   CLI   SKIPSPEC,C'E'       TEST REQUEST IN ERROR                        
         BNE   ACRQ20                                                           
         MVC   P,WIDESPAC          PRINT 'ERROR IN REQUEST FIELD'               
         GOTO1 PRINT,REPPARA,WIDESPAC,BL02                                      
         MVC   P+24(L'AC@RQERR),AC@RQERR                                        
         GOTO1 (RF),(R1),P,BL01                                                 
         MVC   P,WIDESPAC                                                       
*                                                                               
ACRQ20   L     RE,ADBXAREA                                                      
         MVC   BOXOFF-BOXD(,RE),REPBOXO                                         
         MVC   RCREQREP,REPSAVRR   RESTORE SAVED RCREQREP VALUE                 
         B     ACRX                                                             
         EJECT                                                                  
***********************************************************************         
* LOOP THROUGH TABLE AND HANDLE REQUESTS                              *         
***********************************************************************         
         SPACE 1                                                                
RQDT     NTR1  ,                                                                
         GOTOR SETUP               INITIALIZE THE TABLE                         
         MVI   REPAREA,C' '                                                     
         MVC   REPAREA+1(L'REPAREA-1),REPAREA                                   
         MVI   REPAREA,C'('                                                     
         MVC   REPAREA+1(L'ACREQDE@),ACREQDE@                                   
         MVI   REPREQF,0           INITIALISE FLAG                              
         LA    R7,REPAREA+18                                                    
         LA    R3,REPTABL                                                       
         USING REQTABD,R3          R3=A(REQUEST FIELD TABLE)                    
*                                                                               
RQDT03   CLI   REQDISP,EOT         REACHED END                                  
         BE    EXIT                                                             
         CLI   REQTYPE,0           TEST DUMMY ENTRY                             
         BE    RQDTXX                                                           
*                                                                               
         SR    R4,R4               CHECK FOR SIGNIFICANT DATA                   
         MVC   REPHALF,REQDISP                                                  
         NC    REPHALF,=X'7FFF'                                                 
         LH    R4,REPHALF                                                       
         LA    RF,ACWORKD                                                       
         TM    REQDISP,X'80'                                                    
         BZ    *+8                                                              
         L     RF,ADQSTACK                                                      
         AR    R4,RF                                                            
         SR    R5,R5                                                            
         IC    R5,REQLENG                                                       
         BCTR  R5,0                                                             
         EX    R5,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R4),SPACES                                                   
         BE    RQDTXX                                                           
*                                                                               
         MVC   REPITM,SPACES       BUILD ENTRY IN REPITM                        
         CLI   REPACTN,REPAFUT     IS ACTION FOOTLINES                          
         BNE   RQDT07                                                           
         TM    REQSTAT,REQSXFT     EXCLUDE FROM FOOTLINES                       
         BO    RQDTXX                                                           
         CLI   REQTYPE,REQTOPTS    TEST REQUEST OPTIONS                         
         BNE   *+12                                                             
         CLI   FCRQOPT,FCRQOPTQ    APPLICATION WILL HANDLE                      
         BE    RQDTXX                                                           
         TM    ACMINDS3,ACMIAUTO   TEST MASTER AUTO REQUEST                     
         BNZ   RQDTXX                                                           
*                                                                               
RQDT07   SR    RF,RF                                                            
         ICM   RF,3,REQDISPO                                                    
         LA    RF,REPDICO(RF)                                                   
         CLI   REQTYPE,REQTSPCL    NO NAME FOR SPECIAL FIELD                    
         BE    *+10                                                             
         MVC   REPITMN,0(RF)                                                    
         SR    RF,RF                                                            
         IC    RF,REQTYPE                                                       
         SLL   RF,2                                                             
         B     *+0(RF)                                                          
*                                                                               
         B     RQDTSPCL             1- PROCESS SPECIAL APPL FIELDS              
         B     RQDTREPT             2- REPORT CODE                              
         B     RQDTCOMP             3- COMPANY                                  
         B     RQDTACCT             4- ACCOUNT                                  
         B     RQDTALPH             5- GENERAL APLHA                            
         B     RQDTTTYP             6- TRANSACTION TYPE                         
         B     RQDTSELS             7- SELECT FIELDS                            
         B     RQDTMOAF             8- MOA FILTER                               
         B     RQDTOPTS             9- OPTIONS                                  
         B     RQDTOFFC            10- OFFICE                                   
         B     RQDTDUED            11- DUE DATE                                 
         B     RQDTCACF            12- CONTRA-ACCOUNT FILTER                    
         B     RQDTCONT            13- CONTRA U/L                               
         B     RQDTANAL            14- ANALYSIS ACCOUNT/LIST FILTERS            
         B     RQDTFSDT            15- START DATE FILTERING                     
         B     RQDTFEDT            16- END DATE FILTERING                       
         B     RQDTBDAY            17- DUE DAYS                                 
         B     RQDTDATE            18- DATE ROUTINE                             
         B     RQDTBUDG            19- BUDGETS                                  
         B     RQDTLOCS            20- LOCATIONS                                
         B     RQDTFNME            21- FILTER NAME                              
         B     RQDTDAT2            22- SPECIAL DATE                             
*&&UK*&& B     RQDTCURR            23- CURRENCY                                 
*&&US*&& B     RQDTUSER            23- USER ID                                  
         B     RQDTRCAP            24- RECAP DISPLAY FORMATS                    
*&&US*&& B     RQDTCYCM            25- CYCLE MONTH                              
*&&US*&& B     RQDTTOLR            26- TOLERANCE                                
*&&US*&& B     RQDFRMTY            27- FORM TYPE                                
*&&US*&& B     RQDLIVFM            28- LIVE FORMS                               
         EJECT                                                                  
***********************************************************************         
* ROUTINES TO FORMAT REQUEST FIELDS                                   *         
***********************************************************************         
*                                                                               
RQDTSPCL MVC   REPMODE,MODE        SPECIAL MODE TO PROCESS SPECIALS             
         MVI   MODE,PROCSPCL                                                    
         GOTO1 ACAPPLIC,REPPARA,ACWORKD                                         
         MVC   MODE,REPMODE        RESTORE MODE                                 
         B     RQDTXX                                                           
*                                                                               
RQDTREPT MVC   REPITMD(2),=C'AC'   REPORT CODE                                  
         MVC   REPITMD+2(2),0(R4)                                               
         B     RQDTX                                                            
*                                                                               
RQDTCOMP MVC   REPITMD(L'ALPHAID),ALPHAID                                       
         B     RQDTX                                                            
*                                  ACCOUNT CODE                                 
RQDTACCT CLI   SKIPSPEC,C'E'       IF ERROR IN REQUEST                          
         BE    RQDTALPH            DON'T PRINT ACCOUNT GROUP                    
         CLI   REPACTN,REPAFUT     IS ACTION FOOTLINES                          
         BE    RQDTALPH            DON'T PRINT ACCOUNT GROUP                    
         CLI   QACCOUNT+0,C'G'     TEST FOR ACCOUNT GROUP REQUEST               
         BNE   RQDTALPH                                                         
         CLI   QACCOUNT+2,C'='                                                  
         BNE   RQDTALPH                                                         
         L     RF,ADCOMP                                                        
         LA    RF,ACCORFST(RF)                                                  
*                                                                               
         USING FFTELD,RF                                                        
         SR    RE,RE                                                            
RQDTACC3 IC    RE,FFTLN            LOOK UP NAME OF GROUP TYPE                   
         AR    RF,RE                                                            
         CLI   FFTEL,0                                                          
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLI   FFTEL,FFTELQ                                                     
         BNE   RQDTACC3                                                         
         CLI   FFTTYPE,FFTTAAGR                                                 
         BNE   RQDTACC3                                                         
         MVC   REPWORK(1),FFTSEQ                                                
         OI    REPWORK,X'F0'                                                    
         CLC   REPWORK(1),QACCOUNT+1 MATCH ON GROUP TYPE                        
         BNE   RQDTACC3                                                         
         IC    RE,FFTDLEN                                                       
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   REPITMN(0),FFTDATA                                               
         LA    RE,*+10                                                          
         O     RE,=X'80000000'                                                  
         BSM   0,RE                                                             
         L     RE,ACMAGRPS                                                      
         MVC   REPITMD(L'GRPTNAM),GRPTNAM-GRPTABD(RE)                           
         LA    RE,*+6                                                           
         BSM   0,RE                                                             
         B     RQDTX                                                            
*                                                                               
*                                                                               
RQDTALPH EX    R5,MVCFIELD                                                      
         TM    REQSTAT,REQSCDT     TEST CHARACTER DATE                          
         BZ    RQDTALP3                                                         
         CLI   0(R4),X'FF'         SKIP OVER HIGH VALUES, LOW VALUES            
         BE    RQDTX                                                            
         CLI   0(R4),0                                                          
         BE    RQDTX                                                            
*&&US*&& LA    RF,8                                                             
*&&UK*&& LA    RF,17               USE YEAR,MONTH,DAY                           
         CLC   4(2,R4),WIDESPAC    IS THERE IS A DAY IN THE DATE ?              
         BH    *+8                                                              
         LA    RF,1(,RF)           USE YEAR,MONTH                               
         GOTO1 DATCON,DMCB,(0,0(R4)),((RF),REPITMD)                             
*                                                                               
RQDTALP3 TM    0(R4),X'40'         SPECIAL NEGATIVE FILTER FEATURE              
         BO    RQDTX                                                            
*                                                                               
RQDTALPX CLI   REPACTN,REPAFUT     TEST FOOTLINE                                
         BE    RQDTX                                                            
         MVC   REPITMD(L'AC@ALLEX),AC@ALLEX                                     
         EX    R5,*+8                                                           
         B     *+10                                                             
         MVC   REPITMD+11(0),0(R4)                                              
         OI    REPITMD+11,C' '                                                  
         B     RQDTX                                                            
*                                                                               
RQDTTTYP LR    RF,R4               TRANSACTION TYPE                             
         LA    R4,4(R4)            R4=DATA                                      
         LA    R5,1                R5=LENGTH                                    
         CLC   0(4,RF),=C'TYPE'    LOOK FOR SPECIAL KEYWORD                     
         BE    RQDTALPH                                                         
         BCTR  R4,0                                                             
         LA    R5,1(R5)                                                         
         CLC   0(3,RF),=C'TYP'                                                  
         BE    RQDTALPH                                                         
         B     RQDTXX                                                           
*                                                                               
RQDTSELS CLC   0(3,R4),=C'TYP'     LOOK FOR SPECIAL KEYWORD                     
         BE    RQDTXX                                                           
         B     RQDTALPH                                                         
*                                                                               
RQDTMOAF CLC   ACMCMSTR(L'ACMCMSTR+L'ACMCMEND),SPACES                           
         BE    RQDTXX              OLD WAY SKIP                                 
         MVC   REPITMD(L'ACMCMSTR),ACMCMSTR                                     
         CLC   ACMCMSTR,SPACES                                                  
         BNE   RQDTMOA3                                                         
         MVC   REPITMD(L'ACTHRU@),ACTHRU@                                       
         LA    R1,REPITMD+L'ACTHRU@-1                                           
         CLI   0(R1),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         MVC   2(L'ACMCMEND,R1),ACMCMEND                                        
         B     RQDTX                                                            
*                                                                               
RQDTMOA3 CLC   ACMCMSTR,ACMCMEND                                                
         BE    RQDTX                                                            
         LA    R1,REPITMD+L'ACMCMSTR-1                                          
         CLI   0(R1),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         MVI   1(R1),C'-'                                                       
         MVC   2(L'ACMCMEND,R1),ACMCMEND                                        
         B     RQDTX                                                            
*                                                                               
RQDTOPTS EX    R5,MVCFIELD                                                      
         CLI   FCRQOPT,FCRQOPTQ    TEST APPLICATION FORMATS OPTIONS             
         BNE   RQDTX                                                            
         TM    REPINDS,REPIOPTS    TEST PROCOPTS MODE ALREADY PASSED            
         BNZ   RQDTXX                                                           
         CLI   REPACTN,REPAFUT     TEST ACTION= FOOTLINES                       
         BE    RQDTXX                                                           
         OI    REPINDS,REPIOPTS                                                 
         MVC   REPMODE,MODE                                                     
         MVI   MODE,PROCOPTS       SPECIAL MODE TO PROCESS OPTIONS              
         GOTO1 ACAPPLIC,REPPARA,ACWORKD                                         
         MVC   MODE,REPMODE        RESTORE MODE                                 
         B     RQDTXX                                                           
*                                                                               
RQDTOFFC EX    R5,MVCFIELD                                                      
         CLI   REPACTN,REPAFUT     TEST ACTION= FOOTLINES                       
         BE    RQDTX                                                            
         TM    0(R4),X'40'         NEGATIVE OFFICE FILTER                       
         BNO   RQDTALPX            PRINT AS ALPHA                               
*                                                                               
         TM    ACMINDS,ACMINEWO    TEST NEW OFFICE SYSTEM                       
         BZ    RQDTX                                                            
         ICM   R5,15,ADOFFALD                                                   
         BZ    RQDTX                                                            
         ICM   R5,15,OFFAREQL-OFFALD(R5)                                        
         BZ    RQDTX                                                            
         SR    R0,R0                                                            
         ICM   R0,3,0(R5)          R0=NUMBER OF OFFICES IN LIST                 
         LA    R5,L'QOFFICE(R5)    R5=A(OFFICE LIST)                            
         CH    R0,=H'1'            DON'T PRINT LIST IF ONE ONLY                 
         BNE   RQDTOFF3            AND IT IS THE REQUESTED ONE                  
         CLC   0(L'QOFFICE,R4),0(R5)                                            
         BE    RQDTX                                                            
*                                                                               
RQDTOFF3 MVC   P+24(L'REPITM),REPITM                                            
         LA    RF,P+50             PRINT 16 OFFICES PER LINE                    
         LA    RE,16                                                            
         CR    R0,RE                                                            
         BH    *+6                                                              
         LR    RE,R0                                                            
         LR    R1,RE                                                            
RQDTOFF5 MVC   0(L'QOFFICE,RF),0(R5)                                            
         LA    RF,1(RF)                                                         
         CLI   0(RF),C' '                                                       
         BE    *+8                                                              
         LA    RF,1(RF)                                                         
         MVI   0(RF),C','                                                       
         LA    RF,1(RF)                                                         
         LA    R5,L'QOFFICE(R5)                                                 
         BCT   R1,RQDTOFF5                                                      
         BCTR  RF,0                                                             
         MVI   0(RF),C' '                                                       
         SR    R0,RE                                                            
         GOTO1 PRINT,REPPARA,P,BL01                                             
         MVC   P,SPACES                                                         
         MVC   REPITM,SPACES                                                    
         LTR   R0,R0                                                            
         BZ    RQDTXX                                                           
         B     RQDTOFF3                                                         
*                                                                               
RQDTDUED CLI   QAPFLAG,QAPFDUE     TEST DUE DATE PRESENT                        
         BNE   RQDTXX                                                           
         B     RQDTALPH                                                         
*                                                                               
RQDTCACF CLI   QAPFLAG,QAPFCAF     TEST CONTRA-ACCOUNT FILTER PRESENT           
         BNE   RQDTXX                                                           
         B     RQDTALPH                                                         
*                                                                               
RQDTCONT DS    0H                                                               
*&&UK                                                                           
         CLC   0(3,R4),=C'CL='                                                  
         BNE   RQDTXX                                                           
         LA    R4,3(R4)            SKIP TO DATA                                 
         SH    R5,=H'3'            DECREMENT LENGTH                             
*&&                                                                             
         EX    R5,MVCFIELD                                                      
         B     RQDTX                                                            
*                                                                               
         USING ACQD,R4                                                          
RQDTANAL LR    R1,R4                                                            
         SH    R1,=Y(ACQFLT1-ACQTYP1)                                           
         LA    RF,AC@SELAC-REPDICO "SELECTED ACCOUNT"                           
         CLI   0(R1),ACQANAL       IS IT ANALYSIS TYPE FILTERING ?              
         BE    RQDTANA3            YES                                          
         LA    RF,AC@CTR-REPDICO   "CONTRA ACCOUNT"                             
         CLI   0(R1),ACQCNTR       IS IT CONTRA TYPE FILTERING ?                
         BE    RQDTANA3            YES                                          
*&&US                                                                           
         LA    RF,AC@PRSNC-REPDICO "PERSON CODE"                                
         CLI   0(R1),ACQPRSN       IS THIS PERSON FILTERING?                    
         BE    RQDTANA3            YES                                          
*&&                                                                             
         LA    RF,AC@COVER-REPDICO "OVERHEAD RATE"                              
         CLI   0(R1),ACQOVHD       IS THIS APG OVERHEAD VALUE?                  
         BE    RQDTRENM            RENAME FIELD                                 
         B     RQDTXX              NO, BUMP TO NEXT IN TABLE                    
*                                                                               
RQDTANA3 CLI   1(R1),C'+'          IS IT A INCLUDE LIST TYPE?                   
         BE    *+8                                                              
         CLI   1(R1),C'-'          IS IT A EXCLUDE LIST TYPE?                   
         BNE   RQDTRENM            RENAME FIELD                                 
         LA    RF,AC@LSTOA-REPDICO                                              
         CLI   0(R1),ACQCNTR       IS IT CONTRA TYPE FILTERING ?                
         BNE   *+8                                                              
         LA    RF,AC@CTRL-REPDICO                                               
         B     RQDTRENM            RENAME FIELD                                 
*                                                                               
RQDTRENM LA    RF,REPDICO(RF)            RENAME FIELD                           
         MVC   REPITMN,0(RF)         MOVE IN NEW LABEL                          
         B     RQDTALPH                                                         
*                                                                               
RQDTFSDT LA    RE,ACQDTSTR-ACQTYP1                                              
         LA    RF,AC@ALTSD-REPDICO DEFAULT (ALTERNATE START DATE)               
         B     RQDTF100                                                         
*                                                                               
RQDTFEDT LA    RE,ACQDTEND-ACQTYP1                                              
         LA    RF,AC@ALTED-REPDICO DEFAULT (ALTERNATE END DATE)                 
*                                                                               
RQDTF100 LR    R1,R4                                                            
         SR    R1,RE               POINT TO START OF FIELD                      
         CLI   0(R1),ACQDATE       DATE TYPE FILTERING ?                        
         BNE   RQDTXX                                                           
*                                                                               
         USING PDATED,RE                                                        
         LA    RE,PDTETAB                                                       
RQDTF130 CLI   PDATETYP,EOT        END OF TABLE                                 
         BE    RQDTRENM            USE DEFAULT                                  
         CLC   1(1,R1),PDATETYP    DATE TYPE                                    
         BNE   RQDTF138            MATCHED                                      
         CLI   PDATEUNT,C' '       FILTER BASED ON UNIT/LEDGER ?                
         BNH   RQDTF140            OK AS IS                                     
         CLC   PDATEUNT,QUNIT                                                   
         BNE   RQDTF138            NO MATCH, GO NEXT                            
         CLI   PDATELDG,C' '                                                    
         BNH   RQDTF140            NO LEDGER TO MATCH ON, SO OK                 
         CLC   PDATELDG,QLEDGER                                                 
         BE    RQDTF140            NO LEDGER TO MATCH ON, SO OK                 
*                                                                               
RQDTF138 LA    RE,PDATEQ(RE)                                                    
         B     RQDTF130                                                         
*                                                                               
RQDTF140 ICM   RF,3,PDATESTR       GET DICTIONARY ITEM FOR START DATE           
         TM    PDATEIND,PDATERNG   DATE RANGE                                   
         BO    RQDTF150                                                         
         CLI   REQTYPE,REQTEDTE    FILTER END DATE                              
         BNE   RQDTRENM                                                         
         ICM   RF,3,PDATEEND       GET DICTIONARY ITEM FOR END DATE             
         B     RQDTRENM            RENAME FIELD                                 
         DROP  RE                                                               
*                                                                               
RQDTF150 LA    RF,REPDICO(RF)      RENAME FIELD                                 
         MVC   REPITMN,0(RF)       MOVE IN NEW LABEL                            
         CLI   REQTYPE,REQTSDTE    FILTER START DATE                            
         BE    RQDTF152            YES, SO PROCESS                              
         SHI   R4,6                END DATE ONLY ?                              
         CLC   0(6,R4),SPACES                                                   
         BH    RQDTXX              ALREADY PROCESSED                            
*                                                                               
RQDTF152 CLC   0(12,R4),SPACES     ANY DATES ?                                  
         BNH   RQDTXX              NO                                           
         CLC   0(L'ACQDTSTR,R4),SPACES                                          
         BH    RQDTF156                                                         
         MVC   REPITMD(L'ACTHRU@),ACTHRU@                                       
         LA    RF,REPITMD+L'ACTHRU@-1                                           
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RF,2(,RF)                                                        
*                                                                               
         MVC   REPADTE,6(R4)       END DATE                                     
         MVI   REPBYTE,17          FORMAT MMMDD/YY                              
         CLC   REPADTE+4(2),SPACES                                              
         BH    RQDTF154                                                         
         MVI   REPBYTE,18          FORMAT MMM/YY                                
         MVC   REPADTE+4(2),=C'01'                                              
*                                                                               
RQDTF154 GOTO1 DATCON,REPPARA,(0,REPADTE),(REPBYTE,(RF))                        
         B     RQDTX                                                            
*                                                                               
RQDTF156 MVC   REPADTE,0(R4)                                                    
         MVI   REPBYTE,17          FORMAT MMMDD/YY                              
         CLC   REPADTE+4(2),SPACES                                              
         BH    RQDTF158                                                         
         MVI   REPBYTE,18          FORMAT MMM/YY                                
         MVC   REPADTE+4(2),=C'01'                                              
*                                                                               
RQDTF158 GOTO1 DATCON,REPPARA,(0,REPADTE),(REPBYTE,REPITMD)                     
         CLC   0(6,R4),6(R4)                START MATCH END ?                   
         BE    RQDTX                        YES                                 
         LA    RF,REPITMD+10                                                    
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
*                                                                               
         MVI   1(RF),C'-'                                                       
         LA    RF,2(,RF)                                                        
         MVC   REPADTE,6(R4)                                                    
         CLC   REPADTE,SPACES                                                   
         BNH   RQDTX               NO 2ND DATE                                  
         CLI   REPBYTE,18          FORMAT MMM/YY                                
         BNE   *+10                NO, MUST BE MMMDD/YY                         
         MVC   REPADTE+4(2),=C'01'                                              
         GOTO1 DATCON,REPPARA,(0,REPADTE),(REPBYTE,(RF))                        
         B     RQDTX                                                            
*                                                                               
RQDTBDAY CLI   0(R4),X'FF'         00 OR FF IS NO DAYS                          
         BE    RQDTXX                                                           
         SR    R0,R0                                                            
         ICM   R0,1,0(R4)          GET THE NUMBER                               
         BZ    RQDTXX              EXIT IF NONE LEFT                            
         CVD   R0,REPDUB           CONVERT IT TO DECIMAL AND PRINT              
         OI    REPDUB+7,X'0F'                                                   
         UNPK  REPITMD(2),REPDUB                                                
         B     RQDTX                                                            
*                                                                               
RQDTDATE CLC   2(4,R4),WIDESPAC    TEST MONTH/DAY PRESENT                       
         BNE   *+14                                                             
         MVC   REPITMD(2),0(R4)    NO - JUST DISPLAY YEAR                       
         B     RQDTX                                                            
*                                                                               
         GOTO1 DATCON,DMCB,(0,(R4)),(17,REPITMD)                                
         ORG   *-2                                                              
         TM    RCFLAG1,RCFREQLC    TEST LOWER CASE REQUEST REPORT               
         BZ    *+8                                                              
         OI    0(R1),X'40'         YES - SET LOWER CASE MONTH NAME              
         BASR  RE,RF                                                            
         B     RQDTX                                                            
*                                                                               
RQDTDAT2 CLI   0(R4),X'FF'         SKIP OVER HIGH VALUES, LOW VALUES            
         BE    RQDTXX                                                           
         CLI   0(R4),0                                                          
         BE    RQDTXX                                                           
*&&US*&& GOTO1 DATCON,DMCB,(2,0(R4)),(8,REPITMD)                                
*&&UK*&& GOTO1 DATCON,DMCB,(2,0(R4)),(17,REPITMD)                               
         B     RQDTX                                                            
*&&UK                                                                           
RQDTCURR L     RE,ADCMPEL          REPORT CURRENCY                              
         CLC   RCPROG(2),=C'DB'    NO CURR INFO FOR THOSE REPORTS               
         BE    RQDTX                                                            
         CLC   RCPROG(2),=C'EB'                                                 
         BE    RQDTX                                                            
         CLC   RCPROG(2),=C'DD'                                                 
         BE    RQDTX                                                            
         CLC   RCPROG(2),=C'ED'                                                 
         BE    RQDTX                                                            
         LA    RF,CPYCURR-CPYELD(RE)                                            
         CLI   0(R4),ACQC2ND                                                    
         BNE   *+8                                                              
         LA    RF,CPYCURRS-CPYELD(RE)                                           
         MVC   REPITMD(L'CPYCURR),0(RF)                                         
         B     RQDTX                                                            
*&&                                                                             
RQDTBUDG OC    0(L'ACQAPPL,R4),0(R4) TEST ANY BUDGETS                           
         BZ    RQDTXX                                                           
         SR    R0,R0                                                            
         LA    R1,L'ACQAPPL-1                                                   
         LA    RF,REPITMD                                                       
*                                                                               
RQDTBUD3 EX    R1,*+8              ANY BUD OVER-RIDES LEFT?                     
         B     *+10                                                             
         OC    0(0,R4),0(R4)                                                    
         BZ    RQDTBUD5            NO, SO FINISHED                              
         ICM   R0,1,0(R4)          ANY OVER-RIDE                                
         BZ    *+8                                                              
         SH    R0,=H'48'           ADJUST X'30' FOR ESCAPE SEQ PROBLEM          
         CVD   R0,REPDUB           CONVERT IT TO DECIMAL AND PRINT              
         OI    REPDUB+7,X'0F'      FOLLOWED BY A COMMA                          
         UNPK  0(2,RF),REPDUB                                                   
         MVI   2(RF),C','                                                       
         LA    RF,3(RF)                                                         
         LA    R4,1(R4)            GET NEXT NUMBER                              
         BCT   R1,RQDTBUD3                                                      
RQDTBUD5 BCTR  RF,0                CLEAR TRAILING COMMA                         
         MVI   0(RF),C' '                                                       
         B     RQDTX                                                            
*                                                                               
RQDTLOCS CLC   =C'SC',QUNIT        CASH REPORT ?                                
         BNE   RQDTLOC1                                                         
         MVC   REPITMN,SPACES                                                   
         LA    RF,AC@RCND-REPDICO                                               
         LA    RF,REPDICO(RF)                                                   
         MVC   REPITMN,0(RF)         MOVE IN NEW LABEL                          
         B     RQDTALPH                                                         
*                                                                               
RQDTLOC1 CLC   =C'1R',QUNIT        PERSON REPORT ?                              
         BNE   RQDTXX              IGNORE DATA                                  
         L     RE,=A(LOCSTAB)      LOCATION STATUS VALUE TABLE                  
         MVC   REPBYTE,0(R4)                                                    
         OI    REPBYTE,X'40'                                                    
*                                                                               
RQDTLOC3 CLI   0(RE),EOT           END OF TABLE                                 
         BE    RQDTXX              UNKNOWN                                      
         CLC   REPBYTE,0(RE)       MATCH REQUEST CARD WITH TABLE                
         BE    RQDTLOC5                                                         
         LA    RE,LOCSTABQ(,RE)                                                 
         B     RQDTLOC3                                                         
*                                                                               
RQDTLOC5 SR    RF,RF               POINT TO WORD DESCRIPTION                    
         ICM   RF,3,1(RE)          GET DISPLACMENT TO DICTIONARY VALUE          
         LA    RF,REPDICO(RF)                                                   
         TM    0(R4),X'40'         EXCLUDE FACTOR ?                             
         BZ    RQDTLOC7                                                         
         MVC   REPITMD,0(RF)                                                    
         B     RQDTX                                                            
*                                                                               
RQDTLOC7 MVC   REPITMD(L'AC@ALLEX),AC@ALLEX                                     
         MVC   REPITMD+L'AC@ALLEX+1(20-L'AC@ALLEX-1),0(RF)                      
         B     RQDTX                                                            
*                                                                               
RQDTFNME L     RE,ADCMPEL                                                       
         TM    CPYSTAT8-CPYELD(RE),CPYSFNAM                                     
         BZ    RQDTALPH            NO FILTER NAMES - USE ALPHA                  
         LA    RF,FLTNTAB                                                       
RQDTFNM1 CLC   REQDISP,0(RF)                                                    
         BE    RQDTFNM2                                                         
         LA    RF,L'FLTNTAB(RF)                                                 
         CLI   0(RF),EOT                                                        
         BNE   RQDTFNM1                                                         
         B     RQDTALPH                                                         
*                                                                               
RQDTFNM2 MVC   GFLTRFLT,2(RF)      FILTER NUMBER                                
         MVC   GFLTCOM,ADCOMFAC    A(COMFACS)                                   
         MVI   GFLTCMD,GFLTCNAM    GET FILTER NAME                              
         MVC   GFLTBLD,=V(ACGFBUFF) A(TABLE BUILD AREA)                         
         MVC   GFLTCPY,RCSVCOMP    COMPANY HEXCOMP                              
         MVC   GFLTUL,QUNIT        UNIT/LEDGER                                  
         MVC   GFLTACT,SPACES      ACCOUNT                                      
         GOTO1 =V(ACGETFLT),GFLTCMD                                             
         BNE   RQDTFNM5            NO NAME FOR THIS FILTER                      
*                                                                               
         USING GFLNAMD,R1                                                       
         ICM   R1,15,GFLTADR                                                    
         BNZ   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         CLC   GFLNSNM,SPACES      SHORT NAME SET?                              
         BNH   RQDTFNM3            NO - USE CODE THEN                           
*                                                                               
         LA    RF,GFLNSNM+L'GFLNSNM-1                                           
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RE,GFLNSNM                                                       
         SR    RF,RE                                                            
         B     RQDTFNM4                                                         
*                                                                               
RQDTFNM3 CLC   GFLNCDE,SPACES      CODE SET?                                    
         BNH   RQDTFNM5            NO - USE 'FILTER X' THEN                     
*                                                                               
         LA    RF,GFLNCDE+L'GFLNCDE-1                                           
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RE,GFLNCDE                                                       
         SR    RF,RE                                                            
*                                                                               
RQDTFNM4 MVC   REPITMN,SPACES      CLEAR OLD NAME (FILTER 1...)                 
         EX    RF,*+8              MOVE IN CORRECT NAME VALUE                   
         B     *+10                                                             
         MVC   REPITMN(0),0(RE)                                                 
*                                                                               
RQDTFNM5 MVC   GFLTRVAL,0(R4)      VALUE                                        
         OI    GFLTRVAL,C' '       IN CASE 'ALL EXCEPT' FILTER                  
         MVC   GFLTCOM,ADCOMFAC    A(COMFACS)                                   
         MVI   GFLTCMD,GFLTCVAL    GET FILTER VALUE                             
         MVC   GFLTBLD,=V(ACGFBUFF) A(TABLE BUILD AREA)                         
         MVC   GFLTCPY,RCSVCOMP    COMPANY HEXCOMP                              
         MVC   GFLTUL,QUNIT        UNIT/LEDGER                                  
         MVC   GFLTACT,SPACES      ACCOUNT                                      
         GOTO1 =V(ACGETFLT),GFLTCMD                                             
         BNE   RQDTALPH            NO NAME FOR THIS FILTER                      
*                                                                               
         USING GFLVALD,R1                                                       
         ICM   R1,15,GFLTADR                                                    
         BNZ   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         CLC   GFLVSNM,SPACES      SHORT NAME SET?                              
         BNH   RQDTFNM7            NO - USE CODE THEN                           
*                                                                               
         LA    RF,GFLVSNM+L'GFLVSNM-1                                           
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RE,GFLVSNM                                                       
         SR    RF,RE                                                            
         B     RQDTFNM8                                                         
*                                                                               
RQDTFNM7 CLC   GFLVCDE,SPACES      CODE SET?                                    
         BNH   RQDTALPH            NO - USE 'FILTER X' THEN                     
*                                                                               
         LA    RF,GFLVCDE+L'GFLVCDE-1                                           
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RE,GFLVCDE                                                       
         SR    RF,RE                                                            
*                                                                               
RQDTFNM8 B     RQDTX                                                            
         DROP  R1                                                               
*                                                                               
RQDTUSER L     RE,ADMASTC          REQUESTORS USER ID                           
         MVC   REPITMD(L'MCUSERID),MCUSERID-MASTD(RE)                           
         B     RQDTX                                                            
*                                                                               
RQDTRCAP LR    R1,R4                                                            
         SH    R1,=Y(ACQDTSTR-ACQTYP1)                                          
         CLI   0(R1),ACQRCAP       RECAP REPORT ?                               
         BNE   RQDTXX                                                           
         LR    RF,R1                                                            
         LR    R1,R4               RELOAD                                       
         LA    R0,5                MAX OF 5 ATTACHED REPORTS                    
RQDTRC10 CLI   0(R1),C' '          END OF YES/NO SWITCHES                       
         BNH   RQDTXX                                                           
         CLI   0(R1),C'Y'          SEE IF ANY ARE SET TO "Y"                    
         BE    RQDTRC20            YES, SO RECAPS ARE ON                        
         LA    R1,1(,R1)                                                        
         BCT   R0,RQDTRC10                                                      
         B     RQDTXX              NOTHING SET TO "Y"                           
*                                                                               
RQDTRC20 MVC   REPMODE,MODE        SPECIAL MODE TO PROCESS SPECIALS             
         MVI   MODE,PROCSPCL                                                    
         GOTO1 ACAPPLIC,REPPARA,ACWORKD,(RF)                                    
         MVC   MODE,REPMODE        RESTORE MODE                                 
         B     RQDTXX                                                           
*                                                                               
RQDTCYCM GOTO1 DATCON,DMCB,(1,0(R4)),(6,REPITMD)                                
         B     RQDTX                                                            
*                                                                               
RQDTTOLR DS    0H                                                               
         EDIT  (2,0(R4)),(6,REPITMD),2,ALIGN=LEFT                               
         MVC   WORK(6),REPITMD                                                  
         LA    RF,REPITMD                                                       
         CLI   WORK,C'.'                                                        
         BNE   RQDTTOL3                                                         
         MVI   REPITMD,C'0'                                                     
         AHI   RF,1                                                             
*                                                                               
RQDTTOL3 MVC   0(6,RF),WORK                                                     
*                                                                               
         LA    RF,REPITMD                                                       
RQDTTOL5 CLI   0(RF),C' '                                                       
         BE    RQDTTOL7                                                         
         AHI   RF,1                                                             
         B     RQDTTOL5                                                         
*                                                                               
RQDTTOL7 MVI   0(RF),C'%'                                                       
         CLI   QOPT10,C'D'                                                      
         BNE   RQDTX                                                            
         MVI   0(RF),C'$'                                                       
         MVC   REPITMN,=CL20'TOLERANCE AMOUNT'                                  
         B     RQDTX                                                            
*                                                                               
RQDFRMTY MVC   REPITMD(1),QAPPL                                                 
         B     RQDTX                                                            
*                                                                               
RQDLIVFM MVC   REPITMD(1),QOPT1                                                 
         B     RQDTX                                                            
*                                  ACCOUNT CODE                                 
RQDTX    CLC   REPITM,SPACES          TEST ANY DATA                             
         BE    RQDTXX                                                           
         CLI   REPACTN,REPAFUT        TEST FOOTLINES                            
         BNE   RQDTX5                                                           
         MVC   REPWORK,SPACES         SQUASH DATA FOR THE FOOTLINE              
         LA    RF,REPWORK                                                       
         MVC   0(L'REPITMN,RF),REPITMN SET FOOTLINES                            
         LA    RF,(L'REPITMN-1)(RF)                                             
         LA    R1,L'REPITMN                                                     
         CLI   0(RF),X'40'                                                      
         BH    *+10                                                             
         BCTR  R1,0                                                             
         BCT   RF,*-10                                                          
         MVI   1(RF),C'='                                                       
         LA    RF,2(RF)                                                         
         LA    R1,1(R1)                                                         
         TM    REPITMD,C' '           TEST NEGATIVES                            
         BO    *+16                                                             
         MVI   0(RF),C'*'             PRINT AN ASTERISK FOR NEGATIVES           
         LA    RF,1(RF)                                                         
         LA    R1,1(R1)                                                         
         MVC   0(L'REPITMD,RF),REPITMD                                          
         OI    0(RF),X'40'                                                      
         LA    RF,(L'REPITMD-1)(RF)                                             
         LA    R1,(L'REPITMD)(R1)                                               
         CLI   0(RF),C' '                                                       
         BH    *+10                                                             
         BCTR  R1,0                                                             
         BCT   RF,*-10                                                          
         LA    RF,1(R1,R7)                                                      
         LA    RE,REPAREA+(L'REPAREA-1)                                         
         CR    RF,RE               TEST PASSED END OF REPAREA                   
         BH    RQDTXX                                                           
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R7),REPWORK     MOVE TO FOOTLINE AREA                        
         LA    R7,2(R1,R7)                                                      
         OI    REPREQF,1           SET DETAIL PRESENT                           
         B     RQDTXX                                                           
*                                                                               
RQDTX5   LA    R7,P+24             SET DATA FOR DETAILS OF REQUEST              
         LA    R1,L'REPITM         GET LENGTH IF DATA                           
         LA    RE,REPITM+(L'REPITM-1)                                           
         CLI   0(RE),X'40'                                                      
         BH    *+10                                                             
         BCTR  RE,0                                                             
         BCT   R1,*-10                                                          
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R7),REPITM      DATA TO OUTPUT                               
         CLI   RCREQREP,YES        TEST PRINTING REQUEST REPORT                 
         BNE   RQDTX7                                                           
         GOTO1 PRINT,REPPARA,P,BL02                                             
RQDTX7   MVC   P,SPACES                                                         
*                                                                               
RQDTXX   LA    R3,REQTABL(R3)      BUMP TO NEXT TABLE ENTRY                     
         B     RQDT03                                                           
*                                                                               
MVCFIELD MVC   REPITMD(0),0(R4)                                                 
         DROP  R3,R4                                                            
*                                                                               
FLTNTAB  DS    0XL3                                                             
         DC    AL2(QFILTER1-ACWORKD),AL1(1)                                     
         DC    AL2(QFILTER2-ACWORKD),AL1(2)                                     
         DC    AL2(QFILTER3-ACWORKD),AL1(3)                                     
         DC    AL2(QFILTER4-ACWORKD),AL1(4)                                     
         DC    AL2(QFILTER5-ACWORKD),AL1(5)                                     
         DC    AL1(EOT)                                                         
         EJECT                                                                  
***********************************************************************         
* SET PROGRAM CODE AND INITIALIZE TABLE                               *         
***********************************************************************         
         SPACE 1                                                                
SETUP    LA    R1,PGMTAB           SET PROGRAM CODE                             
         MVI   REPPGM,0                                                         
SETUP3   CLI   0(R1),EOT           TEST E-O-T                                   
         BE    SETUP5                                                           
         CLC   QPROG,0(R1)                                                      
         BE    *+12                                                             
         LA    R1,L'PGMTAB(R1)                                                  
         B     SETUP3                                                           
         MVC   REPPGM,2(R1)        SAVE PROGRAM CODE                            
*                                                                               
SETUP5   LA    R0,REPTABL                                                       
         LA    R1,L'REPTABL                                                     
         L     R2,AREQTAB                                                       
         LR    R3,R1                                                            
         MVCL  R0,R2               MOVE TABLE TO LOCAL STORAGE                  
*                                                                               
         L     R1,AREQXPT          LOOK UP PROGRAM REPLACE TABLE                
SETUP7   CLI   0(R1),EOT                                                        
         BE    SETUPX                                                           
         CLC   REPPGM,0(R1)        TEST PROGRAM CODE                            
         BE    *+12                                                             
         LA    R1,L'REQXPT(R1)                                                  
         B     SETUP7                                                           
         SR    RF,RF                                                            
         ICM   RF,7,1(R1)          SET A(REPLACE TABLE)                         
         LA    R3,REPTABL                                                       
*                                                                               
         USING REQTABD,R3                                                       
SETUP9   CLC   REQDISP(REQKEYL),REQDISP-REQTABD(RF)                             
         BNE   *+18                                                             
         TM    REQSTAT,REQSDNR     TEST DO NOT REPLACE                          
         BO    *+10                                                             
         MVC   REQTYPE(REQDATAL),REQTYPE-REQTABD(RF) REPLACE ENTRY              
         LA    R3,REQTABL(R3)                                                   
         CLI   0(R3),EOT                                                        
         BNE   SETUP9                                                           
         LA    R3,REPTABL                                                       
         LA    RF,REQTABL(RF)      NEXT ITEM TO REPLACE                         
         CLI   0(RF),EOT                                                        
         BNE   SETUP9                                                           
*                                                                               
SETUPX   BR    RE                                                               
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO RESOLVE DICTIONARY ENTRIES IN THE SPEC POOL              *         
***********************************************************************         
         SPACE 1                                                                
SETLNG   NTR1  ,                                                                
         L     R2,ACSPECS          R2=A(SPEC POOL)                              
         SR    R0,R0                                                            
         USING LITTABD,R3                                                       
*                                                                               
SETLNG02 CLI   0(R2),0             TEST END OF LITERAL POOL                     
         BE    SETLNGX                                                          
         CLI   0(R2),13            TEST LITERAL VALUE                           
         BE    SETLNG04                                                         
         CLI   0(R2),14            TEST ESCAPE SEQUENCE=LITERAL ADDRESS         
         BNE   SETLNG08                                                         
         SR    R3,R3                                                            
         ICM   R3,7,4(R2)          R3=A(LITTAB ENTRY)                           
         B     SETLNG06                                                         
*                                                                               
SETLNG04 CLI   4(R2),LITTELOQ      TEST FOR ESCAPE SEQUENCE CHARACTER           
         BL    SETLNG08                                                         
         CLI   4(R2),LITTEHIQ                                                   
         BH    SETLNG08                                                         
         L     R3,ALITTNXT         R3=A(NEXT LITTAB ENTRY)                      
         MVC   LITTESC,4(R2)                                                    
         CLI   LITTETYP,LITTESC2   SET LENGTH FOR SPECIAL SEQUENCES             
         BE    *+12                                                             
         CLI   LITTETYP,LITTESU2                                                
         BNE   *+8                                                              
         MVI   LITTELEN,2          2 BYTE ESCAPE SEQUENCE                       
         CLI   LITTETYP,LITTESC3                                                
         BE    *+12                                                             
         CLI   LITTETYP,LITTESU3                                                
         BNE   *+8                                                              
         MVI   LITTELEN,3          3 BYTE ESCAPE SEQUENCE                       
         MVI   0(R2),14            SET SPECIAL ELEMENT CODE                     
         STCM  R3,7,4(R2)          SET A(LITTAB ENTRY)                          
         SR    R1,R1                                                            
         ICM   R1,1,LITTELEN                                                    
         LA    R1,LITTKLNQ+LITTABD(R1)                                          
         C     R1,ALITTEND         TEST EXCEEDS TABLE SIZE                      
         BNH   *+6                                                              
         DC    H'0'                                                             
         STCM  R1,15,ALITTNXT      SET A(NEXT LITTAB ENTRY)                     
*                                                                               
SETLNG06 MVC   REPWORK(L'LITTESC),LITTESC                                       
         LA    R1,REPPARA          BUILD DICTATE PARAMETER LIST                 
         XC    REPPARA(REPPARAL),REPPARA                                        
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNS      RESOLVE SINGLE EXPRESSION                    
         MVI   DDRETN,0                                                         
         TM    RCFLAG1,RCFREPLC    TEST LOWER CASE REQUESTED                    
         BZ    *+8                                                              
         MVI   DDRETN,DDCASEL                                                   
         MVI   DDSYS,6                                                          
         MVC   DDLANG,RCLANG                                                    
         LA    RF,REPWORK                                                       
         STCM  RF,7,DDIADR                                                      
         GOTO1 ADDICTAT            TRANSLATE SINGLE EXPRESSION                  
         MVC   REPDUB(1),LITTELEN                                               
         NI    REPDUB,X'7F'                                                     
         SR    R1,R1                                                            
         IC    R1,REPDUB                                                        
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   LITTDATA(0),REPWORK                                              
*                                                                               
SETLNG08 IC    R0,1(R2)            BUMP TO NEXT SPEC POOL ENTRY                 
         AR    R2,R0                                                            
         B     SETLNG02                                                         
*                                                                               
SETLNGX  B     EXIT                                                             
         DROP  R1,R3                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO GET TIME OF DAY AND EDIT INTO AREA ADDRESSED BY R1       *         
***********************************************************************         
         SPACE 1                                                                
TIME     STM   RE,R2,12(RD)                                                     
         LR    R2,R1                                                            
         TIME  DEC                                                              
         SRL   R0,8                SHIFT OUT TENTHS & HUNDREDTHS                
         SLL   R0,4                MAKE ROOM FOR SIGN                           
         XC    REPDUB,REPDUB                                                    
         STCM  R0,14,REPDUB+5                                                   
         OI    REPDUB+7,X'0F'                                                   
         CVB   R0,REPDUB                                                        
         EDIT  (R0),(5,0(R2)),2,DUB=REPDUB,WRK=REPWORK                          
         LM    RE,R2,12(RD)                                                     
         BR    RE                                                               
         SPACE 2                                                                
***********************************************************************         
* ROUTINE TO CALL APPLICATION HEADHOOK ROUTINE                        *         
***********************************************************************         
         SPACE 1                                                                
HOOK     NTR1  ,                                                                
         CLI   SKIPSPEC,YES        NO HEADHOOK IF SKIPPING SPECS                
         BE    EXIT                                                             
         ST    RA,REPPARA                                                       
         L     RE,REPRD                                                         
         L     RF,HEADHOOK                                                      
         LA    R1,REPPARA                                                       
         LM    R2,RC,28(RE)                                                     
         BASR  RE,RF                                                            
         SPACE 2                                                                
EXIT     XIT1  ,                                                                
         EJECT                                                                  
ACPRINT2 CSECT                                                                  
         ENTRY REPDICI                                                          
REPDICI  DS    0X                  ** DICTATE INPUT LITERALS **                 
         DCDDL AC#RUNON,7,LABEL=ACRUNON@                                        
         DCDDL AC#AT,4,C,LABEL=ACAT@                                            
         DCDDL AC#RPT,7,LABEL=ACRPT@                                            
         DCDDL AC#PAGE,8,LABEL=ACPAGE@                                          
         DCDDL AC#FROM,5,LABEL=ACFROM@                                          
         DCDDL AC#TO,4,LABEL=ACTO@                                              
         DCDDL AC#REQR,10,LABEL=ACREQR@                                         
         DCDDL AC#CPY,7,LABEL=ACCPY@                                            
         DCDDL AC#UNIT,8,LABEL=ACUNIT@                                          
         DCDDL AC#LGR,8,LABEL=ACLGR@                                            
         DCDDL AC#REQDE,16,LABEL=ACREQDE@                                       
         DCDDL AC#THRU,7,LABEL=ACTHRU@                                          
         DCDDL AC#PSTGS,10,LABEL=ACPSTGS@                                       
         DCDDL AC#FOR,6,LABEL=ACFOR@                                            
         DCDDL AC#ONLY,6,LABEL=ACONLY@                                          
         DCDDL AC#ALLEX,10                                                      
*&&UK*&& DCDDL AC#RCURR,10,LABEL=ACRCURR@                                       
*                                                                               
         DCDDL AC#REQDE,30                                                      
         DCDDL AC#REQDE,30,LU,LABEL=AC$REQDE                                    
         DCDDL AC#REQFD,30                                                      
         DCDDL AC#REQFD,30,LU,LABEL=AC$REQFD                                    
         DCDDL AC#RQERR,60                                                      
*                                                                               
         DCDDL AC#RPT,20                                                        
         DCDDL AC#USRID,20                                                      
         DCDDL AC#CTRUL,20                                                      
         DCDDL AC#CPY,20                                                        
         DCDDL AC#UNIT,20                                                       
         DCDDL AC#LGR,20                                                        
         DCDDL AC#OFF,20                                                        
         DCDDL AC#JOBGR,20                                                      
         DCDDL AC#WCTYP,20                                                      
         DCDDL AC#FRMAT,20                                                      
         DCDDL AC#LEVEL,20                                                      
         DCDDL AC#STRMN,20                                                      
         DCDDL AC#ENDMN,20                                                      
         DCDDL AC#BGTS,20                                                       
         DCDDL AC#CYCLM,20                                                      
         DCDDL AC#ACC,20                                                        
         DCDDL AC#TRNFL,20                                                      
         DCDDL AC#TRNTF,20                                                      
         DCDDL AC#WCLST,20                                                      
         DCDDL AC#BLGGP,20                                                      
         DCDDL AC#FLT1,20                                                       
         DCDDL AC#FLT2,20                                                       
         DCDDL AC#FLT3,20                                                       
         DCDDL AC#FLT4,20                                                       
         DCDDL AC#FLT5,20                                                       
         DCDDL AC#CTRF1,20                                                      
         DCDDL AC#CTRF2,20                                                      
         DCDDL AC#CTRF3,20                                                      
         DCDDL AC#CTRF4,20                                                      
         DCDDL AC#CTRF5,20                                                      
         DCDDL AC#MEDFL,20                                                      
         DCDDL AC#MEDGP,20                                                      
         DCDDL AC#BLGTY,20                                                      
         DCDDL AC#CTR,20                                                        
         DCDDL AC#STRDT,20                                                      
         DCDDL AC#ENDDT,20                                                      
         DCDDL AC#SRTOP,20                                                      
         DCDDL AC#SELFL,20                                                      
         DCDDL AC#MOARA,20                                                      
         DCDDL AC#OPT#1,20                                                      
         DCDDL AC#OPT#2,20                                                      
         DCDDL AC#OPT#3,20                                                      
         DCDDL AC#OPT#4,20                                                      
         DCDDL AC#OPT#5,20                                                      
         DCDDL AC#OPT#6,20                                                      
         DCDDL AC#OPT#7,20                                                      
         DCDDL AC#OPT#8,20                                                      
         DCDDL AC#OPT#9,20                                                      
         DCDDL AC#OPT#A,20                                                      
         DCDDL AC#OPT#B,20                                                      
         DCDDL AC#OPT#C,20                                                      
         DCDDL AC#ACTST,20                                                      
         DCDDL AC#ACTND,20                                                      
         DCDDL AC#RVROP,20                                                      
         DCDDL AC#REQR,20                                                       
         DCDDL AC#LACOF,20                                                      
         DCDDL AC#STT,20                                                        
         DCDDL AC#SEQ,20                                                        
         DCDDL AC#DRFOP,20                                                      
         DCDDL AC#XJBOP,20                                                      
         DCDDL AC#TASK,20                                                       
         DCDDL AC#DPT,20                                                        
         DCDDL AC#DUEST,20                                                      
         DCDDL AC#DUEND,20                                                      
         DCDDL AC#DUEDD,20                                                      
         DCDDL AC#CTRFL,20                                                      
         DCDDL AC#ALMHD,20                                                      
         DCDDL AC#SELAC,20                                                      
         DCDDL AC#LSTOA,20                                                      
         DCDDL AC#CALST,20                                                      
         DCDDL AC#CALEN,20                                                      
         DCDDL AC#DEPST,20                                                      
         DCDDL AC#DEPEN,20                                                      
         DCDDL AC#CHKST,20                                                      
         DCDDL AC#CHKEN,20                                                      
         DCDDL AC#ITFST,20                                                      
         DCDDL AC#ITFEN,20                                                      
         DCDDL AC#TITSD,20                                                      
         DCDDL AC#TITED,20                                                      
         DCDDL AC#CTRL,20                                                       
         DCDDL AC#XTTY,20                                                       
         DCDDL AC#BLDST,20                                                      
         DCDDL AC#BLDEN,20                                                      
         DCDDL AC#OCLOS,20                                                      
         DCDDL AC#OLOCK,20                                                      
         DCDDL AC#ALTSD,20                                                      
         DCDDL AC#ALTED,20                                                      
         DCDDL AC#OFFGP,20                                                      
         DCDDL AC#WCGRP,20                                                      
         DCDDL AC#STUTY,20                                                      
         DCDDL AC#RSUSF,20                                                      
         DCDDL AC#BILDT,20                                                      
         DCDDL AC#COVER,20                                                      
         DCDDL AC#UNTLD,20                                                      
         DCDDL AC#RSLST,20                                                      
         DCDDL AC#ACTV,20                                                       
         DCDDL AC#TRM,20                                                        
         DCDDL AC#LOA,20                                                        
         DCDDL AC#XFR,20                                                        
         DCDDL AC#OTHER,20                                                      
         DCDDL AC#ANOFF,20                                                      
         DCDDL AC#OVRCU,20                                                      
         DCDDL AC#RCND,20                                                       
         DCDDL AC#RCAPF,20                                                      
         DCDDL AC#STMST,20                                                      
         DCDDL AC#STMEN,20                                                      
         DCDDL AC#MMOS,20                                                       
*&&US                                                                           
         DCDDL AC#OPNST,20                                                      
         DCDDL AC#OPNEN,20                                                      
         DCDDL AC#PRSNC,20                                                      
         DCDDL AC#CLSST,20                                                      
         DCDDL AC#CLSEN,20                                                      
         DCDDL AC#GRPCD,20                                                      
         DCDDL AC#GRPLG,20                                                      
         DCDDL AC#APSTD,20                                                      
         DCDDL AC#APEND,20                                                      
         DCDDL AC#PPSTD,20                                                      
         DCDDL AC#PPEND,20                                                      
         DCDDL AC#MEDC,20                                                       
         DCDDL AC#CLIP,20                                                       
         DCDDL AC#EST,20                                                        
         DCDDL AC#TOLPC,20                                                      
         DCDDL AC#DJBOP,20                                                      
         DCDDL AC#AP2CH,20                                                      
         DCDDL AC#MSTSA,20                                                      
         DCDDL AC#TERME,20                                                      
         DCDDL AC#OVRDU,20                                                      
         DCDDL AC#AWATA,20                                                      
         DCDDL AC#FRMTY,20                                                      
         DCDDL AC#LIVFM,20                                                      
*&&                                                                             
*&&UK                                                                           
         DCDDL AC#EPDST,20                                                      
         DCDDL AC#EPDND,20                                                      
         DCDDL AC#RCURR,20                                                      
*&&                                                                             
REPDICIX DC    X'00'                                                            
         EJECT                                                                  
ACPRINT  CSECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
       ++INCLUDE ACGETFLTD                                                      
         EJECT                                                                  
ACPRINT  CSECT                                                                  
AREQTAB  DC    A(REQTAB)                                                        
AREQXPT  DC    A(REQXPT)                                                        
AREPDICI DC    A(REPDICI)                                                       
NO       EQU   C'N'                                                             
YES      EQU   C'Y'                                                             
FF       EQU   X'FF'                                                            
         SPACE 1                                                                
ALITTNXT DC    A(LITTAB)                                                        
ALITTEND DC    A(LITTABX)                                                       
VACWORKC DC    V(ACWORKC)                                                       
VPRINT   DC    V(PRINT)                                                         
VCOMC    DC    V(COMC)                                                          
BC01     DC    C'BC01'                                                          
BL01     DC    C'BL01'                                                          
BL02     DC    C'BL02'                                                          
BL03     DC    C'BL03'                                                          
BL04     DC    C'BL04'                                                          
BL08     DC    C'BL08'                                                          
TL01     DC    C'TL01'                                                          
HEXCODE  DC    C'0123456789ABCDEF'                                              
EOT      EQU   X'FF'                                                            
         EJECT                                                                  
PGMRL    EQU   1                                                                
PGM21    EQU   2                                                                
PGM27    EQU   3                                                                
PGMM2    EQU   4                                                                
PGMC8    EQU   5                                                                
PGMWI    EQU   6                                                                
PGM55    EQU   7                                                                
PGMAA    EQU   8                                                                
PGMAC    EQU   9                                                                
PGMMT    EQU   10                                                               
PGMAB    EQU   11                                                               
PGMTT    EQU   12                                                               
PGMT7    EQU   13                                                               
*                                                                               
PGMTAB   DS    XL3                 PROGRAM EQUATE TABLE                         
         DC    C'RL',AL1(PGMRL)     SCRIBE RECEIVABLES                          
         DC    C'RP',AL1(PGMRL)                                                 
         DC    C'IL',AL1(PGMRL)            INCOME                               
         DC    C'IP',AL1(PGMRL)                                                 
         DC    C'PL',AL1(PGMRL)            PAYABLES                             
         DC    C'PP',AL1(PGMRL)                                                 
         DC    C'XL',AL1(PGMRL)            EXPENSE                              
         DC    C'XP',AL1(PGMRL)                                                 
         DC    C'VL',AL1(PGMRL)            PRODUCTION                           
         DC    C'VP',AL1(PGMRL)                                                 
         DC    C'1L',AL1(PGMRL)            PERSON                               
         DC    C'1P',AL1(PGMRL)                                                 
         DC    C'2L',AL1(PGMRL)            P & L                                
         DC    C'2P',AL1(PGMRL)                                                 
         DC    C'BL',AL1(PGMRL)            CASH (BANK)                          
         DC    C'BP',AL1(PGMRL)                                                 
         DC    C'GL',AL1(PGMRL)            GENERAL LEDGER                       
         DC    C'GP',AL1(PGMRL)                                                 
         DC    C'ZL',AL1(PGMRL)            MEDIA CONTROL (SZ)                   
         DC    C'ZP',AL1(PGMRL)                                                 
*                                                                               
         DC    C'21',AL1(PGM21)           PROD. BILLING                         
         DC    C'22',AL1(PGM21)                                                 
         DC    C'23',AL1(PGM21)                                                 
         DC    C'24',AL1(PGM21)                                                 
*                                                                               
         DC    C'27',AL1(PGM27)           PROF. BILLING                         
         DC    C'28',AL1(PGM27)                                                 
         DC    C'29',AL1(PGM27)                                                 
         DC    C'30',AL1(PGM27)                                                 
*                                                                               
         DC    C'M2',AL1(PGMM2)           APG                                   
         DC    C'FI',AL1(PGMM2)                                                 
         DC    C'IV',AL1(PGMM2)                                                 
*                                                                               
         DC    C'C8',AL1(PGMC8)           CHARGE RATE                           
*                                                                               
         DC    C'55',AL1(PGM55)           CHECKS                                
         DC    C'5D',AL1(PGM55)                                                 
         DC    C'5P',AL1(PGM55)                                                 
         DC    C'5T',AL1(PGM55)                                                 
*                                                                               
         DC    C'WI',AL1(PGMWI)           WORKING INVESTMENT                    
         DC    C'AA',AL1(PGMAA)           AUTO APPROVE                          
         DC    C'AC',AL1(PGMAC)           ACC CASHFLOW                          
         DC    C'MT',AL1(PGMMT)           MISSING TIMESHEETS                    
         DC    C'AB',AL1(PGMAB)           AUTO APPROVE BY VENDOR                
*                                                                               
         DC    C'TT',AL1(PGMTT)           FORM TYPE                             
         DC    C'T7',AL1(PGMTT)           FORM TYPE                             
*                                                                               
         DC    AL1(EOT)                                                         
         EJECT                                                                  
LOCSTAB  DC    C'A',AL2(AC@ACTV-REPDICO)                                        
LOCSTABQ EQU   *-LOCSTAB                                                        
         DC    C'T',AL2(AC@TRM-REPDICO)                                         
         DC    C'L',AL2(AC@LOA-REPDICO)                                         
         DC    C'M',AL2(AC@XFR-REPDICO)                                         
         DC    C'O',AL2(AC@OTHER-REPDICO)                                       
         DC    AL1(EOT)            END   OF TABLE                               
*                                                                               
PDTETAB  DS    0XL5                                                             
         DC    AL1(ACQDTCHK,0)                         CHECK DATES              
         DC    AL2(AC@CHKST-REPDICO,AC@CHKEN-REPDICO)                           
         DC    C'  '                                                            
*                                                                               
         DC    AL1(ACQDTBIL,0)                         BILL DATES               
         DC    AL2(AC@BLDST-REPDICO,AC@BLDEN-REPDICO)                           
         DC    C'  '                                                            
*                                                                               
         DC    AL1(ACQDTDEP,0)                         DEPOSIT DATES            
         DC    AL2(AC@DEPST-REPDICO,AC@DEPEN-REPDICO)                           
         DC    C'  '                                                            
*                                                                               
         DC    AL1(ACQDTITF,0)                         INTERFACE DATES          
         DC    AL2(AC@ITFST-REPDICO,AC@ITFEN-REPDICO)                           
         DC    C'  '                                                            
*                                                                               
         DC    AL1(ACQDTTIT,0)                         TITLE DATES              
         DC    AL2(AC@TITSD-REPDICO,AC@TITED-REPDICO)                           
         DC    C'  '                                                            
*                                                                               
         DC    AL1(ACQDTSSD,0)                         ALTERNATE DATE           
         DC    AL2(AC@ALTSD-REPDICO,AC@ALTED-REPDICO)  FORM TIMESHEET           
         DC    C'1R'                                   SUBMIT DATE              
*                                                                               
         DC    AL1(ACQDTSTM,0)                         STATEMENT DATES          
         DC    AL2(AC@STMST-REPDICO,AC@STMEN-REPDICO)                           
         DC    C'  '                                                            
*                                                                               
         DC    AL1(ACQDTDUE,0)                         DUE DATES                
         DC    AL2(AC@DUEST-REPDICO,AC@DUEND-REPDICO)                           
         DC    C'  '                                                            
*                                                                               
*&&US*&& DC    AL1(ACQDTOPN,0)                         OPEN DATES               
*&&US*&& DC    AL2(AC@OPNST-REPDICO,AC@OPNEN-REPDICO)                           
*&&US*&& DC    C'SJ'                                                            
*                                                                               
*&&US*&& DC    AL1(ACQDTCLS,0)                         CLOSE DATES              
*&&US*&& DC    AL2(AC@CLSST-REPDICO,AC@CLSEN-REPDICO)                           
*&&US*&& DC    C'SJ'                                                            
*                                                                               
*&&US*&& DC    AL1(ACQDTAPR,0)                         APRROVED                 
*&&US*&& DC    AL2(AC@APSTD-REPDICO,AC@APEND-REPDICO)                           
*&&US*&& DC    C'SJ'                                                            
*                                                                               
         DC    AL1(ACQDTPER,0)                         CALENDAR DATES           
         DC    AL2(AC@CALST-REPDICO,AC@CALEN-REPDICO)                           
         DC    C'1R'                                                            
*                                                                               
         DC    AL1(ACQDTSAP,0)                         ALTERNATE DATE           
         DC    AL2(AC@ALTSD-REPDICO,AC@ALTED-REPDICO)  FOR APPROVED             
         DC    C'1R'                                   TIME SHEETS              
*                                                                               
*&&US*&& DC    AL1(ACQDTPRE,0)                         PREPARER                 
*&&US*&& DC    AL2(AC@PPSTD-REPDICO,AC@PPEND-REPDICO)                           
*&&US*&& DC    C'SJ'                                                            
*                                                                               
         DC    AL1(ACQDTMOS,PDATERNG)                  MEDIA MOS DATE           
         DC    AL2(AC@MMOS-REPDICO,0)                                           
         DC    C'  '                                                            
*                                                                               
         DC    AL1(ACQDTREL,0)                         OVERRIDE CURRENT         
         DC    AL2(0,AC@OVRCU-REPDICO)                                          
         DC    C'  '                                                            
         DC    AL1(EOT)                                                         
*                                                                               
REGTAB   DS    0XL6                                                             
         DC    AL2(HEAD1-ACWORKD,HEAD12-ACWORKD,12)                             
         DC    AL2(MID1-ACWORKD,MID2-ACWORKD,2)                                 
         DC    AL2(P-ACWORKD,PFOURTH-ACWORKD,4)                                 
         DC    AL2(FOOT1-ACWORKD,FOOT2-ACWORKD,2)                               
         DC    AL2(REG$STR-ACWORKD,REG$END-ACWORKD,0)                           
         DC    AL1(EOT)                                                         
*                                                                               
BIGTAB   DS    0XL6                                                             
         DC    AL2(XHEAD1-BIGPRNTD,XHEAD12-BIGPRNTD,12)                         
         DC    AL2(XMID1-BIGPRNTD,XMID2-BIGPRNTD,2)                             
         DC    AL2(XP-BIGPRNTD,XPFOURTH-BIGPRNTD,4)                             
         DC    AL2(XFOOT1-BIGPRNTD,XFOOT2-BIGPRNTD,2)                           
         DC    AL2(BIG$STR-BIGPRNTD,BIG$END-BIGPRNTD,0)                         
         DC    AL1(EOT)                                                         
*                                  ADDRESSES SET FROM ABOVE TABLES              
AFU      DC    A(0)                A(FIRST UPPER LINE)                          
AFH      DC    A(0)                A(FIRST HEADLINE)                            
ALH      DC    A(0)                A(LAST HEADLINE)                             
NHL      DC    F'0'                NUMBER OF HEADLINES                          
LHL      DC    F'0'                LENGTH OF HEADLINE BLOCK                     
AFM      DC    A(0)                A(FIRST MIDLINE)                             
ALM      DC    A(0)                A(LAST MIDLINE)                              
NML      DC    F'0'                NUMBER OF MIDLINES                           
LML      DC    F'0'                LENGTH OF MIDLINE BLOCK                      
AFP      DC    A(0)                A(FIRST PRINTLINE)                           
ALP      DC    A(0)                A(LAST PRINTLINE)                            
NPL      DC    F'0'                NUMBER OF PRINTLINES                         
LPL      DC    F'0'                LENGTH OF PRINTLINE BLOCK                    
AFF      DC    A(0)                A(FIRST FOOTLINE)                            
ALF      DC    A(0)                A(LAST FOOTLINE)                             
NFL      DC    F'0'                NUMBER OF FOOTLINES                          
LFL      DC    F'0'                LENGTH OF FOOTLINE BLOCK                     
ASTR     DC    A(0)                A(START OF PRINT BLOCK)                      
AEND     DC    A(0)                A(END OF PRINT BLOCK)                        
         DC    F'0'                DO NOT USE                                   
         DC    F'0'                DO NOT USE                                   
         SPACE 1                                                                
WIDTHOFP DC    F'0'                ACTUAL WIDTH OF A LINE                       
WIDTHEXC DC    F'0'                WIDTH OF LINE-1                              
REPDATES DC    CL8' '              SAVED RCDATE VALUE                           
REPDATE  DC    CL9' '              TODAY'S DATE (DD MMM YY OR MMMDD/YY)         
REPLANG  DC    X'FF'               CURRENT LANGUAGE                             
WIDESPAC DC    CL256' '                                                         
         EJECT                                                                  
REPDICO  DS    0C                  ** DICTATE OUTPUT LITERALS **                
         DSDDL PRINT=YES                                                        
REPDICOX DS    0C                                                               
         EJECT                                                                  
REQTAB   DS    0X                  ** REQUEST TABLE **                          
         DC    AL2(QPROG-ACWORKD),AL1(L'QPROG)                                  
         DC    AL1(REQTREPT),AL1(REQSXFT)                                       
         DC    AL2(AC@RPT-REPDICO)                                              
*                                                                               
         DC    AL2(QPROG-ACWORKD),AL1(L'QPROG)                                  
         DC    AL1(REQTSPCL),AL1(REQSXFT)                                       
         DC    AL2(0)                                                           
*&&US                                                                           
         DC    AL2(QPROG-ACWORKD),AL1(L'QPROG)                                  
         DC    AL1(REQTUSER),AL1(REQSXFT)                                       
         DC    AL2(AC@USRID-REPDICO)                                            
*&&                                                                             
*&&UK                                                                           
         DC    AL2(QSRTAREA-ACWORKD),AL1(L'QSRTAREA-2)                          
         DC    AL1(REQTCONT),AL1(0)                                             
         DC    AL2(AC@CTRUL-REPDICO)                                            
*&&                                                                             
         DC    AL2(QCOMPANY-ACWORKD),AL1(L'QCOMPANY)                            
         DC    AL1(REQTCOMP),AL1(REQSXFT)                                       
         DC    AL2(AC@CPY-REPDICO)                                              
*                                                                               
         DC    AL2(QUNIT-ACWORKD),AL1(L'QUNIT)                                  
         DC    AL1(REQTALPH),AL1(REQSXFT)                                       
         DC    AL2(AC@UNIT-REPDICO)                                             
*                                                                               
         DC    AL2(QLEDGER-ACWORKD),AL1(L'QLEDGER)                              
         DC    AL1(REQTALPH),AL1(REQSXFT)                                       
         DC    AL2(AC@LGR-REPDICO)                                              
*                                                                               
         DC    AL2(QOFFICE-ACWORKD),AL1(L'QOFFICE)                              
         DC    AL1(REQTOFFC),AL1(0)                                             
         DC    AL2(AC@OFF-REPDICO)                                              
*                                                                               
         DC    AL2(X'8000'+ACQANOF-ACQD),AL1(L'ACQANOF)                         
         DC    AL1(REQTOFFC),AL1(0)                                             
         DC    AL2(AC@ANOFF-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL)                                  
         DC    AL1(REQTCACF),AL1(0)                                             
         DC    AL2(AC@CTRFL-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL-4)                                
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL-3)                                
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QBILGRUP)                               
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QOFFICE)                                
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(1)                                        
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL+2-ACWORKD),AL1(L'QTRNSFLT)                             
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL+2-ACWORKD),AL1(L'QAPPL-6)                              
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL+3-ACWORKD),AL1(L'QFILTER1)                             
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL+4-ACWORKD),AL1(L'QFILTER1)                             
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL+5-ACWORKD),AL1(L'QFILTER1)                             
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL+6-ACWORKD),AL1(L'QTRNSFLT)                             
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(QAPPL+8-ACWORKD),AL1(L'QTRNSFLT)                             
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(X'8000'+ACQDTSTR-ACQD),AL1(L'ACQDTSTR)                       
         DC    AL1(REQTRCAP),AL1(0)                                             
         DC    AL2(AC@RCAPF-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP2-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTRCAP),AL1(0)                                  
         DC    AL2(AC@RCAPF-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP3-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTRCAP),AL1(0)                                  
         DC    AL2(AC@RCAPF-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP4-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTRCAP),AL1(0)                                  
         DC    AL2(AC@RCAPF-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP5-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTRCAP),AL1(0)                                  
         DC    AL2(AC@RCAPF-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP6-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTRCAP),AL1(0)                                  
         DC    AL2(AC@RCAPF-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP7-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTRCAP),AL1(0)                                  
         DC    AL2(AC@RCAPF-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP8-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTRCAP),AL1(0)                                  
         DC    AL2(AC@RCAPF-REPDICO)                                            
*&&UK                                                                           
         DC    AL2(QSELECT-ACWORKD),AL1(L'QSELECT)                              
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@SELFL-REPDICO)                                            
*&&                                                                             
*&&US                                                                           
         DC    AL2(QSELECT-ACWORKD),AL1(L'QSELECT)                              
         DC    AL1(REQTSELS),AL1(0)                                             
         DC    AL2(AC@SELFL-REPDICO)                                            
*                                                                               
         DC    AL2(QSELECT-ACWORKD),AL1(L'QSELECT)                              
         DC    AL1(REQTTTYP),AL1(REQSDNR)                                       
         DC    AL2(AC@TRNTF-REPDICO)                                            
*&&                                                                             
*                                                                               
         DC    AL2(X'8000'+ACQOFGRP-ACQD),AL1(L'ACQOFGRP)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@OFFGP-REPDICO)                                            
*                                                                               
         DC    AL2(QACCOUNT-ACWORKD),AL1(L'QACCOUNT)                            
         DC    AL1(REQTACCT),AL1(0)                                             
         DC    AL2(AC@ACC-REPDICO)                                              
*                                                                               
         DC    AL2(QTRNSFLT-ACWORKD),AL1(L'QTRNSFLT)                            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@TRNFL-REPDICO)                                            
*&&UK                                                                           
         DC    AL2(QCUL-ACWORKD),AL1(L'QCUL+L'QCACCT)                           
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CTRFL-REPDICO)                                            
*&&                                                                             
         DC    AL2(QTRNSTYP-ACWORKD),AL1(L'QTRNSTYP)                            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@TRNTF-REPDICO)                                            
*                                                                               
         DC    AL2(QWRKLIST-ACWORKD),AL1(L'QWRKLIST)                            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@WCLST-REPDICO)                                            
*                                                                               
         DC    AL2(QBILGRUP-ACWORKD),AL1(L'QBILGRUP)                            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@BLGGP-REPDICO)                                            
*                                                                               
         DC    AL2(QFILTER1-ACWORKD),AL1(L'QFILTER1)                            
*&&US*&& DC    AL1(REQTALPH),AL1(0)                                             
*&&UK*&& DC    AL1(REQTFNME),AL1(0)                                             
         DC    AL2(AC@FLT1-REPDICO)                                             
*                                                                               
         DC    AL2(QFILTER2-ACWORKD),AL1(L'QFILTER2)                            
*&&US*&& DC    AL1(REQTALPH),AL1(0)                                             
*&&UK*&& DC    AL1(REQTFNME),AL1(0)                                             
         DC    AL2(AC@FLT2-REPDICO)                                             
*                                                                               
         DC    AL2(QFILTER3-ACWORKD),AL1(L'QFILTER3)                            
*&&US*&& DC    AL1(REQTALPH),AL1(0)                                             
*&&UK*&& DC    AL1(REQTFNME),AL1(0)                                             
         DC    AL2(AC@FLT3-REPDICO)                                             
*                                                                               
         DC    AL2(QFILTER4-ACWORKD),AL1(L'QFILTER4)                            
*&&US*&& DC    AL1(REQTALPH),AL1(0)                                             
*&&UK*&& DC    AL1(REQTFNME),AL1(0)                                             
         DC    AL2(AC@FLT4-REPDICO)                                             
*                                                                               
         DC    AL2(QFILTER5-ACWORKD),AL1(L'QFILTER5)                            
*&&US*&& DC    AL1(REQTALPH),AL1(0)                                             
*&&UK*&& DC    AL1(REQTFNME),AL1(0)                                             
         DC    AL2(AC@FLT5-REPDICO)                                             
*                                                                               
         DC    AL2(X'8000'+ACQCFLT1-ACQD),AL1(L'ACQCFLT1)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CTRF1-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQCFLT2-ACQD),AL1(L'ACQCFLT2)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CTRF2-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQCFLT3-ACQD),AL1(L'ACQCFLT3)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CTRF3-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQCFLT4-ACQD),AL1(L'ACQCFLT4)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CTRF4-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQCFLT5-ACQD),AL1(L'ACQCFLT5)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CTRF5-REPDICO)                                            
*                                                                               
         DC    AL2(QMEDIA-ACWORKD),AL1(L'QMEDIA)                                
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@MEDFL-REPDICO)                                            
*                                                                               
         DC    AL2(QMGROUP-ACWORKD),AL1(L'QMGROUP)                              
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@MEDGP-REPDICO)                                            
*                                                                               
         DC    AL2(QBILTYPE-ACWORKD),AL1(L'QBILTYPE)                            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@BLGTY-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQWCGRP-ACQD),AL1(L'ACQWCGRP)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@WCGRP-REPDICO)                                            
*                                                                               
         DC    AL2(QSTART-ACWORKD),AL1(L'QSTART)                                
*&&US*&& DC    AL1(REQTALPH),AL1(REQSCDT)                                       
*&&UK*&& DC    AL1(REQTDATE),AL1(0)                                             
         DC    AL2(AC@STRDT-REPDICO)                                            
*                                                                               
         DC    AL2(QEND-ACWORKD),AL1(L'QEND)                                    
*&&US*&& DC    AL1(REQTALPH),AL1(REQSCDT)                                       
*&&UK*&& DC    AL1(REQTDATE),AL1(0)                                             
         DC    AL2(AC@ENDDT-REPDICO)                                            
*                                                                               
         DC    AL2(QSORT-ACWORKD),AL1(L'QSORT)                                  
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@SRTOP-REPDICO)                                            
*                                                                               
         DC    AL2(QMOSSTRT-ACWORKD),AL1(L'QMOSSTRT+L'QMOSEND)                  
         DC    AL1(REQTMOAF),AL1(0)                                             
         DC    AL2(AC@MOARA-REPDICO)                                            
*&&US                                                                           
         DC    AL2(QCUL-ACWORKD),AL1(L'QCUL)                                    
         DC    AL1(REQTCONT),AL1(0)                                             
         DC    AL2(AC@CTRUL-REPDICO)                                            
*                                                                               
         DC    AL2(QCACCT-ACWORKD),AL1(L'QCACCT)                                
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CTR-REPDICO)                                              
*&&                                                                             
         DC    AL2(QDRAFT-ACWORKD),AL1(L'QDRAFT)                                
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@DRFOP-REPDICO)                                            
*                                                                               
         DC    AL2(QSEQ-ACWORKD),AL1(L'QSEQ)                                    
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@SEQ-REPDICO)                                              
*                                                                               
         DC    AL2(QOPT1-ACWORKD),AL1(L'QOPT1)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#1-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT2-ACWORKD),AL1(L'QOPT2)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#2-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT3-ACWORKD),AL1(L'QOPT3)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#3-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT4-ACWORKD),AL1(L'QOPT4)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#4-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT5-ACWORKD),AL1(L'QOPT5)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#5-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT6-ACWORKD),AL1(L'QOPT6)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#6-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT7-ACWORKD),AL1(L'QOPT7)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#7-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT8-ACWORKD),AL1(L'QOPT8)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#8-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT9-ACWORKD),AL1(L'QOPT9)                                  
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#9-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT10-ACWORKD),AL1(L'QOPT10)                                
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#A-REPDICO)                                            
*&&UK                                                                           
         DC    AL2(QOPT11-ACWORKD),AL1(L'QOPT11)                                
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#B-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT12-ACWORKD),AL1(L'QOPT12)                                
         DC    AL1(REQTOPTS),AL1(0)                                             
         DC    AL2(AC@OPT#C-REPDICO)                                            
*&&                                                                             
         DC    AL2(QACTSTRT-ACWORKD),AL1(L'QACTSTRT)                            
*&&US*&& DC    AL1(REQTALPH),AL1(REQSCDT)                                       
*&&UK*&& DC    AL1(REQTDATE),AL1(0)                                             
         DC    AL2(AC@ACTST-REPDICO)                                            
*                                                                               
         DC    AL2(QACTEND-ACWORKD),AL1(L'QACTEND)                              
*&&US*&& DC    AL1(REQTALPH),AL1(REQSCDT)                                       
*&&UK*&& DC    AL1(REQTDATE),AL1(0)                                             
         DC    AL2(AC@ACTND-REPDICO)                                            
*&&US                                                                           
         DC    AL2(QSTATUS-ACWORKD),AL1(L'QSTATUS)                              
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@STT-REPDICO)                                              
*                                                                               
         DC    AL2(QXJOB-ACWORKD),AL1(L'QXJOB)                                  
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@XJBOP-REPDICO)                                            
*&&                                                                             
         DC    AL2(QMTHD-ACWORKD),AL1(L'QMTHD)                                  
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@ALMHD-REPDICO)                                            
*                                                                               
         DC    AL2(QDUEST-ACWORKD),AL1(L'QDUEST)                                
         DC    AL1(REQTDUED),AL1(REQSCDT)                                       
         DC    AL2(AC@DUEST-REPDICO)                                            
*                                                                               
         DC    AL2(QDUEND-ACWORKD),AL1(L'QDUEND)                                
         DC    AL1(REQTDUED),AL1(REQSCDT)                                       
         DC    AL2(AC@DUEND-REPDICO)                                            
*                                                                               
         DC    AL2(QREVERSE-ACWORKD),AL1(L'QREVERSE)                            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@RVROP-REPDICO)                                            
*&&UK                                                                           
         DC    AL2(QCLOFILT-ACWORKD),AL1(L'QCLOFILT)                            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@OCLOS-REPDICO)                                            
*                                                                               
         DC    AL2(QLOKFILT-ACWORKD),AL1(L'QLOKFILT)                            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@OLOCK-REPDICO)                                            
*&&                                                                             
         DC    AL2(X'8000'+ACQFLT1-ACQD),AL1(L'ACQFLT1)                         
         DC    AL1(REQTANAL),AL1(0)                                             
         DC    AL2(AC@SELAC-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQDTSTR-ACQD),AL1(L'ACQDTSTR)                       
         DC    AL1(REQTSDTE),AL1(REQSCDT)                                       
         DC    AL2(AC@CHKST-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQDTEND-ACQD),AL1(L'ACQDTEND)                       
         DC    AL1(REQTEDTE),AL1(REQSCDT)                                       
         DC    AL2(AC@CHKEN-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQFLT2-ACQD),AL1(L'ACQFLT2)                         
         DC    AL1(REQTANAL),AL1(0)                                             
         DC    AL2(AC@SELAC-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP2-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTSDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKST-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP2-ACQD)+(ACQDTEND-ACQTYP1))                   
         DC    AL1(L'ACQDTEND,REQTEDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKEN-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQFLT3-ACQD),AL1(L'ACQFLT3)                         
         DC    AL1(REQTANAL),AL1(0)                                             
         DC    AL2(AC@SELAC-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP3-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTSDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKST-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP3-ACQD)+(ACQDTEND-ACQTYP1))                   
         DC    AL1(L'ACQDTEND,REQTEDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKEN-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQFLT4-ACQD),AL1(L'ACQFLT4)                         
         DC    AL1(REQTANAL),AL1(0)                                             
         DC    AL2(AC@SELAC-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP4-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTSDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKST-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP4-ACQD)+(ACQDTEND-ACQTYP1))                   
         DC    AL1(L'ACQDTEND,REQTEDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKEN-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQFLT5-ACQD),AL1(L'ACQFLT5)                         
         DC    AL1(REQTANAL),AL1(0)                                             
         DC    AL2(AC@SELAC-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP5-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTSDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKST-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP5-ACQD)+(ACQDTEND-ACQTYP1))                   
         DC    AL1(L'ACQDTEND,REQTEDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKEN-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQFLT6-ACQD),AL1(L'ACQFLT6)                         
         DC    AL1(REQTANAL),AL1(0)                                             
         DC    AL2(AC@SELAC-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP6-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTSDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKST-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP6-ACQD)+(ACQDTEND-ACQTYP1))                   
         DC    AL1(L'ACQDTEND,REQTEDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKEN-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQFLT7-ACQD),AL1(L'ACQFLT7)                         
         DC    AL1(REQTANAL),AL1(0)                                             
         DC    AL2(AC@SELAC-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP7-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTSDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKST-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP7-ACQD)+(ACQDTEND-ACQTYP1))                   
         DC    AL1(L'ACQDTEND,REQTEDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKEN-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQFLT8-ACQD),AL1(L'ACQFLT8)                         
         DC    AL1(REQTANAL),AL1(0)                                             
         DC    AL2(AC@SELAC-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP8-ACQD)+(ACQDTSTR-ACQTYP1))                   
         DC    AL1(L'ACQDTSTR,REQTSDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKST-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+(ACQTYP8-ACQD)+(ACQDTEND-ACQTYP1))                   
         DC    AL1(L'ACQDTEND,REQTEDTE),AL1(REQSCDT)                            
         DC    AL2(AC@CHKEN-REPDICO)                                            
*&&US                                                                           
         DC    AL2(X'8000'+ACQBDAY-ACQD),AL1(L'ACQBDAY)                         
         DC    AL1(REQTBDAY),AL1(0)                                             
         DC    AL2(AC@DUEDD-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQUSFLD-ACQD),AL1(L'ACQUSFLD)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@RSUSF-REPDICO)                                            
*                                                                               
         DC    AL2(X'8000'+ACQSTUTY-ACQD),AL1(L'ACQSTUTY)                       
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@STUTY-REPDICO)                                            
*&&                                                                             
         DC    AL2(X'8000'+ACQLOCS-ACQD),AL1(L'ACQLOCS)                         
         DC    AL1(REQTLOCS),AL1(0)                                             
         DC    AL2(AC@RSLST-REPDICO)                                            
*&&UK                                                                           
         DC    AL2(X'8000'+ACQCURR-ACQD),AL1(L'ACQCURR)                         
         DC    AL1(REQTCURR),AL1(0)                                             
         DC    AL2(AC@RCURR-REPDICO)                                            
*&&                                                                             
*&&US                                                                           
         DC    AL2(X'8000'+ACQDJOB-ACQD),AL1(L'ACQDJOB)                         
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@DJBOP-REPDICO)                                            
*&&                                                                             
         DC    AL2(QUESTOR-ACWORKD),AL1(L'QUESTOR)                              
         DC    AL1(REQTALPH),AL1(REQSXFT)                                       
         DC    AL2(AC@REQR-REPDICO)                                             
REQTABX  DC    AL1(EOT)                                                         
         EJECT                                                                  
REQXPT   DS    0XL4                ** REQUEST EXCEPTION TABLE **                
*&&US                                                                           
         DC    AL1(PGMRL),AL3(REQXRL)                                           
         DC    AL1(PGM21),AL3(REQX21)                                           
         DC    AL1(PGM27),AL3(REQX27)                                           
         DC    AL1(PGMM2),AL3(REQXM2)                                           
         DC    AL1(PGMC8),AL3(REQXC8)                                           
         DC    AL1(PGMWI),AL3(REQXWI)                                           
         DC    AL1(PGMAA),AL3(REQXAA)                                           
         DC    AL1(PGMAC),AL3(REQXAC)                                           
         DC    AL1(PGMMT),AL3(REQXMT)                                           
         DC    AL1(PGMAB),AL3(REQXAA)                                           
         DC    AL1(PGMTT),AL3(REQXTT)                                           
         DC    AL1(PGMT7),AL3(REQXTT)                                           
         DC    AL1(EOT)                                                         
*                                                                               
REQXRL   DS    0H                                 SCRIBE                        
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL-4)                                
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@FRMAT-REPDICO)                                            
         DC    AL1(EOT)                                                         
*                                                                               
REQX21   DS    0H                                PROD. BILLING                  
         DC    AL2(QAPPL+4-ACWORKD),AL1(L'QFILTER1)                             
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@FRMAT-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL+6-ACWORKD),AL1(L'QTRNSFLT)                             
         DC    AL1(REQTCYCM),AL1(0)                                             
         DC    AL2(AC@CYCLM-REPDICO)                                            
*                                                                               
         DC    AL2(QSTART-ACWORKD),AL1(L'QSTART)                                
*&&US*&& DC    AL1(REQTALPH),AL1(REQSCDT)                                       
*&&UK*&& DC    AL1(REQTDATE),AL1(0)                                             
         DC    AL2(AC@BILDT-REPDICO)                                            
         DC    AL1(EOT)                                                         
                                                                                
REQX27   DS    0H                                PROD. BILLING                  
         DC    AL2(QAPPL-ACWORKD),AL1(L'QBILGRUP)                               
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@JOBGR-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL+3-ACWORKD),AL1(L'QFILTER1)                             
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@WCTYP-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL+4-ACWORKD),AL1(L'QFILTER1)                             
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@FRMAT-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL+5-ACWORKD),AL1(L'QFILTER1)                             
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@LEVEL-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL+6-ACWORKD),AL1(L'QTRNSFLT)                             
         DC    AL1(REQTDAT2),AL1(0)                                             
         DC    AL2(AC@STRMN-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL+8-ACWORKD),AL1(L'QTRNSFLT)                             
         DC    AL1(REQTDAT2),AL1(0)                                             
         DC    AL2(AC@ENDMN-REPDICO)                                            
         DC    AL1(EOT)                                                         
*                                                                               
REQXM2   DS    0H                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL-3)                                
         DC    AL1(REQTBUDG),AL1(0)                                             
         DC    AL2(AC@BGTS-REPDICO)                                             
*                                                                               
         DC    AL2(QOPT2-ACWORKD),AL1(L'QOPT2)                                  
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@FRMAT-REPDICO)                                            
         DC    AL1(EOT)                                                         
*                                                                               
REQXC8   DS    0H                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QOFFICE)                                
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@OFF-REPDICO)                                              
*                                                                               
         DC    AL2(QSELECT-ACWORKD),AL1(L'QSELECT)                              
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@DPT-REPDICO)                                              
*                                                                               
         DC    AL2(QAPPL+2-ACWORKD),AL1(L'QTRNSFLT)                             
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@TASK-REPDICO)                                             
         DC    AL1(EOT)                                                         
*                                                                               
REQXWI   DS    0H                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL)                                  
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@GRPCD-REPDICO)                                            
*                                                                               
         DC    AL2(QSELECT-ACWORKD),AL1(L'QSELECT)                              
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@UNTLD-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT8-ACWORKD),AL1(L'QOPT8)                                  
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@GRPLG-REPDICO)                                            
         DC    AL1(EOT)                                                         
*                                                                               
REQXAA   DS    0H                                                               
*                                                                               
         DC    AL2(QSELECT-ACWORKD),AL1(L'QSELECT)   CLIENT PRODUCT             
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CLIP-REPDICO)                                             
*                                                                               
         DC    AL2(QAPPL+8-ACWORKD),AL1(L'QAPPL-10)  MEDIA                      
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@MEDC-REPDICO)                                             
*                                                                               
         DC    AL2(QAPPL+2-ACWORKD),AL1(L'QAPPL-6)   ESTIMATE                   
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@EST-REPDICO)                                              
*                                                                               
         DC    AL2(QOPT9-ACWORKD),AL1(L'QOPT9)       APPROVAL OPTION            
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@AP2CH-REPDICO)                                            
*                                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL-10)    TOLERANCE                  
         DC    AL1(REQTTOLR),AL1(0)                                             
         DC    AL2(AC@TOLPC-REPDICO)                                            
*                                                                               
         DC    AL1(EOT)                                                         
*                                                                               
REQXAC   DS    0H                                                               
*                                                                               
         DC    AL2(QSELECT-ACWORKD),AL1(L'QSELECT)   CLIENT PRODUCT             
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@CLIP-REPDICO)                                             
*                                                                               
         DC    AL2(QAPPL+8-ACWORKD),AL1(L'QAPPL-10)  MEDIA                      
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@MEDC-REPDICO)                                             
*                                                                               
         DC    AL1(EOT)                                                         
*                                                                               
REQXMT   DS    0H                                                               
*                                                                               
         DC    AL2(QOPT1-ACWORKD),AL1(L'QOPT1)       MISSING TIME STAT          
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@MSTSA-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT2-ACWORKD),AL1(L'QOPT2)       TERM EMPLOYEES             
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@TERME-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT3-ACWORKD),AL1(L'QOPT3)       OVERDUE TIME               
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@OVRDU-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT4-ACWORKD),AL1(L'QOPT4)       AWAITING APPROVAL          
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@AWATA-REPDICO)                                            
*                                                                               
         DC    AL1(EOT)                                                         
*                                                                               
REQXTT   DS    0H                                    1099                       
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL-11)    FORM TYPE                  
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@FRMTY-REPDICO)                                            
*                                                                               
         DC    AL2(QOPT1-ACWORKD),AL1(L'QOPT1)                                  
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@LIVFM-REPDICO)                                            
*                                                                               
         DC    AL1(EOT)                                                         
*                                                                               
*&&                                                                             
                                                                                
*&&UK                                                                           
         DC    AL1(PGMRL),AL3(REQXRL)                                           
         DC    AL1(PGM55),AL3(REQX55)                                           
         DC    AL1(EOT)                                                         
*                                                                               
REQXRL   DS    0H                                                               
         DC    AL2(QAPPL-ACWORKD),AL1(L'QAPPL-4)                                
         DC    AL1(REQTALPH),AL1(0)                                             
         DC    AL2(AC@FRMAT-REPDICO)                                            
         DC    AL1(EOT)                                                         
*                                                                               
REQX55   DC    AL2(QCUL-ACWORKD),AL1(L'QCUL+L'QCACCT)                           
         DC    AL1(0),AL1(0)                                                    
         DC    AL2(0)                                                           
         DC    AL1(EOT)                                                         
*&&                                                                             
         EJECT                                                                  
REPORTD  DSECT                     ** LOCAL W/S DSECT **                        
REPDUB   DS    D                                                                
REPHALF  DS    H                                                                
REPRD    DS    A                                                                
REPPARA  DS    6F                                                               
REPPARAL EQU   *-REPPARA                                                        
REPWORK  DS    XL64                                                             
REPBYTE  DS    XL1                                                              
REPMODE  DS    XL1                                                              
*                                                                               
REPINDS  DS    XL1                 INDICATOR BYTE                               
REPIOPTS EQU   X'80'               PROCOPTS ISSUED FOR THIS REQUEST             
REPISPCL EQU   X'40'               PROCSPCL ISSUED FOR THIS REQUEST             
*                                                                               
REPFLAG  DS    XL1                                                              
REPFSLA  EQU   X'80'               PRINT SPACE LINE AFTER LAST                  
REPFSPA  EQU   X'40'               USE SPACING                                  
REPFPRT  EQU   X'20'               PRINT LINE INDICATOR                         
REPFBOX  EQU   X'10'               TEST BOXREQ=B                                
*                                                                               
REPADTE  DS    CL6                 TEMP DATE AREA                               
REPBOXO  DS    CL(L'BOXOFF)                                                     
REPSAVRR DS    CL(L'RCREQREP)      SAVED RCREQREP VALUE                         
REPREQF  DS    XL1                 INITIALISATION FLAG                          
REPSW    DS    XL1                 FILTER SWITCH                                
REPPGQ   EQU   X'80'               PROGRAM SWITCH                               
REPCTQ   EQU   X'40'               COUNTRY SWITCH                               
REPLNQ   EQU   X'20'               LANGUAGE SWITCH                              
REPALL   EQU   REPPGQ+REPCTQ+REPLNQ                                             
REPAREA  DS    XL256                                                            
*                                                                               
REPACTN  DS    CL1                 ACTION                                       
REPAFUT  EQU   C'F'                PREPARE FOOTLINES                            
REPADRQ  EQU   C'D'                PRINT DETAILS OF REQUEST                     
*                                                                               
REPPGM   DS    XL1                PROGRAM EQUATE                                
*                                                                               
REPITM   DS    0CL(REPITMX-REPITMN)                                             
         ORG   REPITM                                                           
REPITMN  DS    CL(REQNAMEL)       NAME                                          
         DS    C                                                                
REPITMD  DS    CL20               DATA                                          
REPITMX  EQU   *                                                                
*                                                                               
REPTABL  DS    XL((REQTABX-REQTAB)+1)                                           
REPORTX  EQU   *                                                                
         EJECT                                                                  
REQTABD  DSECT                     ** REQUEST TABLE DSECT **                    
REQDISP  DS    XL2                 DISPLACEMENT TO REQUEST FIELD:- IF           
*                                  X'80' BIT IS ON THE FIELD IS IN              
*                                  REQUEST STACK (ADQSTACK)                     
REQLENG  DS    XL1                 LENGTH OF REQUEST FIELD                      
REQKEYL  EQU   *-REQTABD           KEY LENGTH                                   
*                                                                               
REQTYPE  DS    XL1                 FIELD TYPE -                                 
REQTSPCL EQU   1                   PROCESS SPECIAL APPLICATION FIELDS           
REQTREPT EQU   2                   REPORT                                       
REQTCOMP EQU   3                   COMPANY                                      
REQTACCT EQU   4                   ACCOUNT                                      
REQTALPH EQU   5                   GENERAL ALPHA                                
REQTTTYP EQU   6                   TRANSACTION TYPE                             
REQTSELS EQU   7                   SELECT FIELD                                 
REQTMOAF EQU   8                   MOA FILTER                                   
REQTOPTS EQU   9                   OPTIONS                                      
REQTOFFC EQU   10                  OFFICE                                       
REQTDUED EQU   11                  DUE DATE                                     
REQTCACF EQU   12                  CONTRA-ACCOUNT FILTER                        
REQTCONT EQU   13                  CONTRA U/L                                   
REQTANAL EQU   14                  ANALYSIS ACCOUNT/LIST FILTER                 
REQTSDTE EQU   15                  START DATE FILTERING                         
REQTEDTE EQU   16                  END DATE FILTERING                           
REQTBDAY EQU   17                  DUE DAYS                                     
REQTDATE EQU   18                  GENERAL DATE                                 
REQTBUDG EQU   19                  BUDGETS                                      
REQTLOCS EQU   20                  LOCATIONS STATUS                             
REQTFNME EQU   21                  FILTER NAME                                  
REQTDAT2 EQU   22                  SPECIAL DATE                                 
REQTUSER EQU   23                  USER ID                      (US)            
REQTCURR EQU   23                  REPORT CURRENCY              (UK)            
REQTRCAP EQU   24                  SCIRBE RECAP                                 
REQTCYCM EQU   25                  CYCLE MONTH                                  
REQTTOLR EQU   26                  TOLERANCE                                    
*                                                                               
*                                                                               
REQSTAT  DS    XL1                 STATUS                                       
REQSXFT  EQU   X'80'               EXCLUDE FROM FOOTLINES                       
REQSCDT  EQU   X'40'               CHARACTER DATE                               
REQSDNR  EQU   X'20'               DO NOT REPLACE                               
*                                                                               
REQDISPO DS    AL2                 DISPLACEMENT TO DICTIONARY WORD              
REQDATAL EQU   *-REQTYPE           DATA LENGTH                                  
REQTABL  EQU   *-REQTABD                                                        
*                                                                               
REQNAMEL EQU   20                  LENGTH OF NAME FIELD                         
         EJECT                                                                  
LITTABD  DSECT                     ** LITERAL POOL ENTRY **                     
LITTESC  DS    0XL4                ESCAPE SEQUENCE                              
LITTETYP DS    XL1                 ESCAPE SEQUENCE TYPE                         
LITTELOQ EQU   X'20'               LOW ESCAPE SEQUENCE CHARACTER                
LITTEHIQ EQU   X'2F'               HIGH ESCAPE SEQUENCE CHARACTER               
LITTESC2 EQU   X'20'               ESCAPE/LEFT/LENGTH=2                         
LITTESC3 EQU   X'21'               ESCAPE/LEFT/LENGTH=3                         
LITTESU2 EQU   X'28'               ESCAPE/UNDERLINE/LEFT/LENGTH=2               
LITTESU3 EQU   X'29'               ESCAPE/UNDERLINE/LEFT/LENGTH=3               
LITTEDNO DS    XL2                 DICTIONARY NUMBER                            
LITTELEN DS    XL1                 LITERAL LENGTH                               
LITTKLNQ EQU   *-LITTABD                                                        
*                                                                               
LITTDATA DS    0C                  TRANSLATED LITERAL VALUE                     
         SPACE 1                                                                
ACPRINT  CSECT                                                                  
LITTAB   DC    4096X'00'           LITERAL POOL FOR SPEC TRANSLATION            
LITTABX  EQU   *                                                                
         SPACE 1                                                                
GRPTABD  DSECT                     ** ACCOUNT GROUP TABLE **                    
GRPTTYP  DS    CL(L'AGRKGTYP)      GROUP TYPE (SEE AGRKGTYP)                    
GRPTEOTQ EQU   X'FF'               END OF TABLE INDICATOR                       
GRPTCOD  DS    CL(L'AGRKAGR)       GROUP CODE                                   
GRPTNAM  DS    CL(L'NAMEREC)       GROUP NAME                                   
GRPTOFF  DS    CL(L'RSTOFFC)       OFFICE CODE                                  
GRPTABL  EQU   *-GRPTABD                                                        
         SPACE 1                                                                
PDATED   DSECT                                                                  
PDATETYP DS    XL1                 DATE TYPE TO PRINT                           
PDATEIND DS    XL1                 DATE INDICATOR                               
PDATERNG EQU   X'80'               DATE RANGE                                   
PDATESTR DS    AL2                 DISPLACEMENT TO DICT. START DATE             
PDATEEND DS    AL2                 DISPLACEMENT TO DICT. END   DATE             
PDATEUNT DS    CL1                 UNIT   OR SPACE                              
PDATELDG DS    CL1                 LEDGER OR SPACE                              
PDATEQ   EQU   *-PDATED                                                         
         SPACE 1                                                                
* ACBIGPRNTD                                                                    
         PRINT OFF                                                              
       ++INCLUDE ACBIGPRNTD                                                     
         PRINT ON                                                               
         SPACE 1                                                                
* ACDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE ACDDEQUS                                                       
         PRINT ON                                                               
         SPACE 1                                                                
* ACGENFILE                                                                     
         PRINT OFF                                                              
       ++INCLUDE ACGENFILE                                                      
         PRINT ON                                                               
         SPACE 1                                                                
* ACGENMODES                                                                    
         PRINT OFF                                                              
       ++INCLUDE ACGENMODES                                                     
         PRINT ON                                                               
         SPACE 1                                                                
* ACMASTD                                                                       
         PRINT OFF                                                              
       ++INCLUDE ACMASTD                                                        
         PRINT ON                                                               
         SPACE 1                                                                
* ACOFFALD                                                                      
         PRINT OFF                                                              
       ++INCLUDE ACOFFALD                                                       
         PRINT ON                                                               
         SPACE 1                                                                
* ACQD                                                                          
         PRINT OFF                                                              
       ++INCLUDE ACQD                                                           
         PRINT ON                                                               
         SPACE 1                                                                
* ACREPWORKD                                                                    
         PRINT OFF                                                              
       ++INCLUDE ACREPWORKD                                                     
         PRINT ON                                                               
         SPACE 1                                                                
* DDBIGBOX                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDBIGBOX                                                       
         PRINT ON                                                               
         SPACE 1                                                                
* DDCOMCTRLD                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDCOMCTRLD                                                     
         PRINT ON                                                               
         SPACE 1                                                                
* DDCTRYEQUS                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDCTRYEQUS                                                     
         PRINT ON                                                               
         SPACE 1                                                                
* DDDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDDDEQUS                                                       
         PRINT ON                                                               
         SPACE 1                                                                
* DDDICTATED                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDDICTATED                                                     
         PRINT ON                                                               
         SPACE 1                                                                
* DDMASTD                                                                       
         PRINT OFF                                                              
       ++INCLUDE DDMASTD                                                        
         PRINT ON                                                               
         SPACE 1                                                                
* DDREPXTRAD                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDREPXTRAD                                                     
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'049ACPRINT   01/13/21'                                      
         END                                                                    
