*          DATA SET RXROUTSS   AT LEVEL 053 AS OF 02/06/03                      
*CATALP RXROUTS                                                                 
         TITLE 'EXTRACT ROUTINES FOR REPXTRACT'                                 
***********************************************************************         
*  CHANGES:                                                           *         
*  APR04/02 (BU ) --- DON'T ADJUST MONFORC DATES TO MONDAY            *         
*                                                                     *         
*                                                                     *         
*                                                                     *         
***********************************************************************         
         PRINT NOGEN                                                            
RXROUTS  CSECT                                                                  
         ENTRY REPDOLC           CONTRACT DOLLARS                               
         ENTRY REPAGYC           AGENCY                                         
         ENTRY REPADVC           ADVERTISER                                     
         ENTRY REPSALC           SALESPERSON                                    
         ENTRY REPCTYC           CONTRACT TYPE                                  
         ENTRY REPDCTC           DEV CONTRACT TYPE                              
         ENTRY REPSTAC           STATION                                        
         ENTRY REPDSPC           DEV SALESPERSON                                
         ENTRY REPTEMC           TEAM                                           
         ENTRY REPPRDC           PRODUCT CODE                                   
         ENTRY REPCLSC           CLASS                                          
         ENTRY REPCATC           CATEGORY                                       
         ENTRY REPOFFC           OFFICE                                         
         ENTRY REPOWNC           OWNER                                          
         ENTRY REPMKTC           MARKET                                         
         ENTRY REPGRPC           GROUP/SUBGROUP                                 
         ENTRY REPMSTC           SUB/MASTER                                     
         ENTRY REPREPC           REP INFO                                       
         ENTRY SETUPMON          SETUP DATE RRG STYLE DATE TABLES               
         ENTRY RXQWK             RRG/QWKD DATE TABLE                            
*                                                                               
EXIT     XIT1                                                                   
         EJECT                                                                  
***********************************************************************         
* REPDOLC - EXTRACT CONTRACT HEADER & DOLLAR RECORDS                            
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL1 REP PROFILE FLAGS, SEE REPPFLGS IN RXTRACT                      *         
* AL3 A(REPFILE RECORD)                                               *         
* AL1 0=BUILD 'K' RECORD, 1=BUILD ALL RECORDS, 2=PASS BACK NEXT       *         
*     X'FF' RETURNED IF NO MORE RECORDS TO PROCESS                    *         
* AL3 A(STATION RECORD)                                               *         
* AL4 A(SXDTABD)                                                      *         
*---------------------------------------------------------------------*         
         SPACE 1                                                                
REPDOLC  NMOD1 WORKL,*REPDOL*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,RXDOLLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REDOLD,R2           R2=A(EXTRACT RECORD)                         
         USING RCONREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         SR    RE,RE                                                            
         ICM   RE,7,9(R1)                                                       
         ST    RE,ASTAREC                                                       
*                                                                               
         BRAS  RE,LOADER                                                        
*                                                                               
         CLI   8(R1),1                                                          
         JL    RXDOLKIL            BUILD KILL RECORD                            
         JE    RXDOLSER            BUILD SERIES OF RECORDS                      
         J     RXDOLNXT            OUTPUT NEXT RECORD                           
*                                                                               
RXDOLLIT DC    A(LITERAL)                                                       
         EJECT                                                                  
*---------------------------------------------------------------------*         
* GET NEXT CONTRACT DOLLAR RECORD IN SERIES AND RETURN IT                       
*---------------------------------------------------------------------*         
         SPACE 1                                                                
RXDOLNXT L     RE,ANEXT                                                         
         OC    0(8,RE),0(RE)       RECORD TO PASS BACK?                         
         JNZ   *+12                                                             
         MVI   8(R1),X'FF'         NO MORE RECORDS                              
         J     EXIT                                                             
*                                                                               
         LA    R0,REDOLD           RETURN BUFFER                                
         L     RE,ANEXT            A(NEXT RECORD IN SERIES)                     
         SR    R1,R1               LENGHT OF NEXT RECORD                        
         ICM   R1,3,REDOLLEN-REDOLD(RE)                                         
         LA    RF,0(R1,RE)         SAVE NEXT ADDRESS                            
         ST    RF,ANEXT                                                         
         LR    RF,R1               SET LENGTH                                   
         MVCL  R0,RE                                                            
*                                                                               
         J     EXIT                                                             
         SPACE 1                                                                
*---------------------------------------------------------------------*         
* BUILD 'K' RECORD FOR CONTRACT RECORD AND EXIT                                 
*---------------------------------------------------------------------*         
         SPACE 1                                                                
RXDOLKIL DS    0H                                                               
         MVI   KILLMODE,C'Y'                                                    
*                                                                               
         LR    R5,R2               KEEP POINTER TO BLANK RECORD                 
         L     R2,RXDOLCC          WHERE RECORDS TO BE BUILT                    
         ST    R2,ANEXT            FOR NEXT TIME IN                             
         XC    0(8,R2),0(R2)                                                    
*                                                                               
         BRAS  RE,RXDOLCON         FIRST KILL HEADER                            
*                                                                               
         SR    RE,RE               CLEAR THE LAST RECORD                        
         ICM   RE,3,REDOLLEN                                                    
         AR    R2,RE                                                            
         XC    0(8,R2),0(R2)                                                    
*                                                                               
         L     R8,ANEWMON          THEN KILL BUCKETS                            
         BRAS  RE,RXDOLDOL                                                      
*                                                                               
         SR    RE,RE               CLEAR THE LAST RECORD                        
         ICM   RE,3,REDOLLEN                                                    
         AR    R2,RE                                                            
         XC    0(8,R2),0(R2)                                                    
*                                                                               
         J     EXIT                                                             
         SPACE 1                                                                
*---------------------------------------------------------------------*         
* BUILD SERIES OF RECORDS FOR THIS RECORD                             *         
*---------------------------------------------------------------------*         
         SPACE 1                                                                
RXDOLSER DS    0H                                                               
         LR    R5,R2               KEEP POINTER TO BLANK RECORD                 
         L     R2,RXDOLCC          WHERE RECORDS TO BE BUILT                    
         ST    R2,ANEXT            FOR NEXT TIME IN                             
         XC    0(8,R2),0(R2)                                                    
*                                                                               
         LA    RE,ASTAREC          TRICK RESETVAL TO SEE THIS RECORD            
         AHI   RE,-16                                                           
         ST    RE,VSPNDCTL                                                      
*                                                                               
         BRAS  RE,RXDOLCON         FIRST RECORD IS THE CONTRACT HEADER          
*                                                                               
         SR    RE,RE               CLEAR THE LAST RECORD                        
         ICM   RE,3,REDOLLEN                                                    
         AR    R2,RE                                                            
         XC    0(8,R2),0(R2)                                                    
*                                                                               
         L     R9,=A(RXQWK)                                                     
         USING QWKD,R9                                                          
*                                                                               
         GOTO1 VALU3NEW,PLIST,RCONREC,ANEWMON,QWMONINF,QWMONFOR,       +        
               (C'P',0),(0,QWCURND)                                             
**TEST                                                                          
***      CLC   RCONKCON,=X'03357485'                                            
***      JNE   *+6                                                              
***      DC    H'0'                                                             
**TEST                                                                          
*                                                                               
         TM    PARM+4,X'80'        HANDLE ZERO DOLLAR BUCKETS?                  
         JZ    POST0010            NO                                           
*                                                                               
**TEST                                                                          
***      CLC   RCONKCON,=X'03357485'                                            
**       JNE   SKIPATCH                                                         
**       L     RE,=A(SETVALU2)                                                  
**       LA    RE,368(RE)                                                       
**       LA    RE,544(RE)                                                       
**       MVC   0(4,RE),=A(0)                                                    
**TEST                                                                          
*                                                                               
SKIPATCH DS    0H                                                               
         GOTO1 =A(SETVALU2),PLIST,(RC),ANEWMON,QWMONFOR,QWCURST3                
*                                                                               
POST0010 EQU   *                                                                
         L     R8,ANEWMON                                                       
**TEST                                                                          
**       CLC   RCONKCON,=X'03357485'                                            
**       JNE   *+6                                                              
**       DC    H'0'                                                             
**TEST                                                                          
*                                                                               
*   FIND REQUEST START DATE IN TABLE.                                           
*                                                                               
POST0020 EQU   *                                                                
**JRD    CLC   0(4,R8),QFASTART    TABLE ENTRY VS REQ START DATE                
**       JNL   POST0030            FOUND - BEGIN TO PULL FIGURES                
**       LA    R8,NEXTBUCK(R8)     BUMP TO NEXT BUCKET                          
**       J     POST0020            GO BACK FOR NEXT                             
*                                                                               
POST0030 EQU   *                                                                
         CLI   0(R8),0             ANY TABLE ENTRY?                             
         JE    POST0100            NO  - EXIT                                   
         OC    BUCKDISP(BUCKSIZE,R8),BUCKDISP(R8)                               
         JZ    POST0040            NO MONEY IN BUCKET, SKIP TO NEXT             
*                                                                               
         BRAS  RE,RXDOLDOL                                                      
*                                                                               
**TEST                                                                          
**       CLC   RCONKCON,=X'03357485'                                            
**       JNE   *+6                                                              
**       DC    H'0'                                                             
**TEST                                                                          
         SR    RE,RE               CLEAR THE LAST RECORD                        
         ICM   RE,3,REDOLLEN                                                    
         AR    R2,RE                                                            
         XC    0(8,R2),0(R2)                                                    
*                                                                               
POST0040 EQU   *                                                                
         LA    R8,NEXTBUCK(R8)     BUMP BUCKET ADDRESS                          
         L     RE,ANEWMON                                                       
         AHI   RE,NEWMONL                                                       
         CR    R8,RE                                                            
         JL    POST0030            SWING BACK FOR NEXT BUCKET                   
*                                                                               
POST0100 EQU   *                                                                
**TEST                                                                          
***      L     RE,ANEWMON                                                       
***      CLC   RCONKCON,=X'03357485'                                            
***      JNE   *+6                                                              
***      DC    H'0'                                                             
**TEST                                                                          
         SR    RE,RE               CLEAR THE LAST RECORD                        
         ICM   RE,3,REDOLLEN                                                    
         AR    R2,RE                                                            
         XC    0(8,R2),0(R2)                                                    
*                                                                               
         J     EXIT                                                             
         EJECT                                                                  
*---------------------------------------------------------------------*         
* BUILD CONTRACT DOLLAR BUCKET RECORD                                           
*  R8 POINTS TO THE ENTRY IN NEWMON FOR THIS MONTH                              
*---------------------------------------------------------------------*         
         SPACE 1                                                                
RXDOLDOL NTR1  BASE=*,LABEL=*                                                   
         LA    R0,REDOLD           CLEAR THE RECORD                             
         LA    R1,REDOLDL                                                       
         SR    RF,RF                                                            
         SR    RE,RE                                                            
         MVCL  R0,RE                                                            
*                                                                               
         XC    REDOLLEN,REDOLLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REDOLLEN(2),=AL2(REDOLDL)                                        
         MVC   REDOLTYP,REPDOLQ                                                 
         MVI   REDOLDX,MXTRTQ                                                   
         MVI   REDOLDX+1,MXTRTQ                                                 
         MVI   REDOLREP-1,MXTRTQ                                                
         MVI   REDOLCON-1,MXTRTQ                                                
         MVI   REDOLMON-1,MXTRTQ                                                
         MVI   REDOLACD-1,MXTRTQ                                                
         MVI   REDOLDOL-1,MXTRTQ                                                
         MVI   REDOLADL-1,MXTRTQ                                                
         MVI   REDOLXRE-1,MXTRTQ                                                
*                                                                               
X        USING RECOND,R5           R5=A(INITIALIZED EXTRACT RECORD)             
         MVC   REDOLACT,X.RECONACT                                              
         MVC   REDOLDAT,X.RECONDAT                                              
         MVC   REDOLTME,X.RECONTME                                              
         DROP  X                                                                
*                                                                               
         MVC   REDOLREP,RCONKREP   REPCODE                                      
         TR    REDOLREP,MXTRT                                                   
         ZAP   WORK+200(5),=P'0'    CONTRACT NUMBER                             
         MVO   WORK+200(5),RCONKCON                                             
         EDIT  (P5,WORK+200),(8,REDOLCON),ALIGN=LEFT                            
         TR    REDOLCON,MXTRT                                                   
*                                                                               
         MVI   REDOLXRE,C'N'                                                    
         LA    R6,RCONREC                                                       
         MVI   ELCODE,X'2F'        RER ELEMENT                                  
         BRAS  RE,GETEL                                                         
         JNE   RXDOL001                                                         
*                                                                               
         USING RCONRER,R6                                                       
         TM    RCONFRER,X'01'      EXCLUDE FROM RER?                            
         BZ    RXDOL001                                                         
         DROP  R6                                                               
*                                                                               
         MVI   REDOLXRE,C'Y'                                                    
*                                                                               
RXDOL001 DS    0H                                                               
         TR    REDOLXRE,MXTRT                                                   
*                                                                               
         LA    R7,BUCKDISP(R8)     SET R7 TO A(BUCKETS IN MONTH)                
*                                                                               
         MVI   ELCODE,C'E'                                                      
         L     R6,CUASATIN(R7)                                                  
         TM    FLAG6(R8),X'01'                                                  
         JO    RXDOL002            CURRENT INVOICED DOLLARS FOUND               
         MVI   ELCODE,C'I'                                                      
         ICM   R6,15,TOTORD(R7)                                                 
         JNZ   RXDOL002            CURRENT BOOKED DOLLARS FOUND                 
*                                                                               
         SR    R6,R6                                                            
         J     RXDOL010            NO CURRENT DOLLARS                           
*                                                                               
RXDOL002 DS    0H                                                               
         GOTO1 DATCON,PLIST,(0,0(R8)),(10,REDOLMON)                             
***      XC    REDOLMON(2),REDOLMON+3 SWAP MM AND DD ABOUT                      
***      XC    REDOLMON+3(2),REDOLMON                                           
***      XC    REDOLMON(2),REDOLMON+3                                           
         TR    REDOLMON,MXTRT                                                   
*                                                                               
         GOTO1 DATCON,PLIST,(2,QWMONFOR+QWCASATF),(10,REDOLACD)                 
***      XC    REDOLACD(2),REDOLACD+3 SWAP MM AND DD ABOUT                      
***      XC    REDOLACD+3(2),REDOLACD                                           
***      XC    REDOLACD(2),REDOLACD+3                                           
         TR    REDOLACD,MXTRT                                                   
*                                                                               
         EDIT  (R6),(12,REDOLDOL),ZERO=NOBLANK,FILL=0,FLOAT=-                   
         TR    REDOLDOL,MXTRT                                                   
*                                                                               
****     SR    R6,R6               FINAL MATCHES CURRENT                        
         EDIT  (R6),(12,REDOLADL),ZERO=NOBLANK,FILL=0,FLOAT=-                   
         TR    REDOLADL,MXTRT                                                   
*                                                                               
**       MVC   REDOLFLG,ELCODE                                                  
**JRD    MVI   REDOLFLG,C'N'                                                    
**       TR    REDOLFLG,MXTRT                                                   
*                                                                               
RXDOL010 DS    0H                                                               
         MVI   ELCODE,C'F'                                                      
         L     R6,PRASATIN(R7)                                                  
         TM    FLAG6(R8),X'04'                                                  
         JO    RXDOL012            PRIOR INVOICED DOLLARS FOUND                 
         MVI   ELCODE,C'J'                                                      
         ICM   R6,15,PRASATOR(R7)                                               
         JNZ   RXDOL012            PRIOR BOOKED DOLLARS FOUND                   
*                                                                               
         SR    R6,R6                                                            
*                                                                               
RXDOL012 DS    0H                                                               
         CLI   REDOLDOL,C' '       ANY CURRENT DOLLARS SHOWN?                   
         BNH   RXDOL014            NO                                           
*                                                                               
         LA    R0,REDOLD           COPY THIS RECORD                             
         LA    R1,REDOLDL                                                       
         LA    RE,REDOLD+REDOLDL   TO THE NEXT RECORD                           
         LR    R2,RE                                                            
         LR    RF,R1                                                            
         MVCL  RE,R0                                                            
*                                                                               
         MVC   REDOLDOL,SPACES     CLEAR THE MONEY                              
*                                                                               
RXDOL014 DS    0H                                                               
         MVC   WORK(6),0(R8)                                                    
         GOTO1 VADDAY,PLIST,(C'Y',WORK),(0,WORK),-1                             
         GOTO1 DATCON,PLIST,(0,WORK),(10,REDOLMON)                              
***      XC    REDOLMON(2),REDOLMON+3 SWAP MM AND DD ABOUT                      
***      XC    REDOLMON+3(2),REDOLMON                                           
***      XC    REDOLMON(2),REDOLMON+3                                           
         TR    REDOLMON,MXTRT                                                   
*                                                                               
         GOTO1 DATCON,PLIST,(2,QWMONFOR+QWPASATF),(10,REDOLACD)                 
***      XC    REDOLACD(2),REDOLACD+3 SWAP MM AND DD ABOUT                      
***      XC    REDOLACD+3(2),REDOLACD                                           
***      XC    REDOLACD(2),REDOLACD+3                                           
         TR    REDOLACD,MXTRT                                                   
*                                                                               
         EDIT  (R6),(12,REDOLDOL),ZERO=NOBLANK,FILL=0,FLOAT=-                   
         TR    REDOLDOL,MXTRT                                                   
*                                                                               
         MVI   ELCODE,C'G'                                                      
         L     R0,PRTOTINV(R7)                                                  
         TM    FLAG6(R8),X'02'                                                  
         JO    RXDOL022            PRIOR ACTUAL DOLLARS FOUND                   
         MVI   ELCODE,C'K'                                                      
         ICM   R0,15,PRTOTORD(R7)                                               
*                                                                               
RXDOL022 DS    0H                                                               
****     SR    R0,R6               CALC + SAVE DELTA                            
****                               JUST SEND VALUE PER KATZ                     
         EDIT  (R0),(12,REDOLADL),ZERO=NOBLANK,FILL=0,FLOAT=-                   
         TR    REDOLADL,MXTRT                                                   
*                                                                               
         LTR   R0,R0               DATA?                                        
         BNZ   RXDOL110            YES                                          
*                                                                               
         LTR   R6,R6               DATA?                                        
         BNZ   RXDOL110            YES                                          
*                                                                               
         CLI   KILLMODE,C'Y'       KILLMODE?                                    
         BE    RXDOL110            YES                                          
*                                                                               
         XC    0(8,R2),0(R2)                                                    
*                                                                               
RXDOL110 DS    0H                                                               
         XIT1  REGS=(R2)                                                        
         DROP  R2,R9                                                            
*                                                                               
*---------------------------------------------------------------------*         
* BUILD CONTRACT HEADER RECORD                                        *         
*---------------------------------------------------------------------*         
         SPACE 1                                                                
RXDOLCON NTR1  BASE=*,LABEL=*                                                   
         USING RECOND,R2           R2=A(EXTRACT RECORD)                         
*                                                                               
         LA    R0,RECOND           CLEAR THE RECORD                             
         LA    R1,RECONDL                                                       
         SR    RF,RF                                                            
         SR    RE,RE                                                            
         MVCL  R0,RE                                                            
*                                                                               
         XC    RECONLEN,RECONLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   RECONLEN(2),=AL2(RECONDL)                                        
         MVC   RECONTYP,REPCONQ                                                 
         MVI   RECONDX,MXTRTQ                                                   
         MVI   RECONDX+1,MXTRTQ                                                 
         MVI   RECONREP-1,MXTRTQ                                                
         MVI   RECONCON-1,MXTRTQ                                                
         MVI   RECONSTA-1,MXTRTQ                                                
         MVI   RECONSAL-1,MXTRTQ                                                
         MVI   RECONOFF-1,MXTRTQ                                                
         MVI   RECONTEM-1,MXTRTQ                                                
         MVI   RECONADV-1,MXTRTQ                                                
         MVI   RECONAGY-1,MXTRTQ                                                
         MVI   RECONCTY-1,MXTRTQ                                                
         MVI   RECONDEV-1,MXTRTQ                                                
         MVI   RECONDSP-1,MXTRTQ                                                
         MVI   RECONPRC-1,MXTRTQ                                                
         MVI   RECONPRT-1,MXTRTQ                                                
         MVI   RECONDEM-1,MXTRTQ                                                
         MVI   RECONFLS-1,MXTRTQ                                                
         MVI   RECONFLE-1,MXTRTQ                                                
         MVI   RECONMAS-1,MXTRTQ                                                
         MVI   RECONXRE-1,MXTRTQ                                                
*                                                                               
B        USING RECOND,R5           R5=A(INITIALIZED EXTRACT RECORD)             
         MVC   RECONACT,B.RECONACT                                              
         MVC   RECONDAT,B.RECONDAT                                              
         MVC   RECONTME,B.RECONTME                                              
         DROP  B                                                                
*                                                                               
         MVC   RECONREP,RCONKREP   REPCODE                                      
         TR    RECONREP,MXTRT                                                   
         ZAP   WORK+20(5),=P'0'    CONTRACT NUMBER                              
         MVO   WORK+20(5),RCONKCON                                              
         EDIT  (P5,WORK+20),(8,RECONCON),ALIGN=LEFT                             
         TR    RECONCON,MXTRT                                                   
         MVC   RECONSTA,RCONKSTA   STATION                                      
         TR    RECONSTA,MXTRT                                                   
         MVC   RECONSAL,RCONSAL    SALESPERSON                                  
         TR    RECONSAL,MXTRT                                                   
         MVC   RECONOFF,RCONKOFF   OFFICE                                       
         TR    RECONOFF,MXTRT                                                   
         MVC   RECONTEM,RCONTEM    TEAM                                         
         TR    RECONTEM,MXTRT                                                   
         MVC   RECONADV,RCONKADV   ADVERTISER                                   
         TR    RECONADV,MXTRT                                                   
         MVC   RECONAGY,RCONKAGY   AGENCY/OFFICE                                
         TR    RECONAGY,MXTRT                                                   
         MVC   RECONCTY,RCONTYPE   CON TYPE                                     
         TR    RECONCTY,MXTRT                                                   
*                                                                               
         LA    R6,RCONREC                                                       
         MVI   ELCODE,X'18'                                                     
         BRAS  RE,GETEL                                                         
         JNE   RDCON010                                                         
*                                                                               
         USING RCONDVEL,R6                                                      
         MVC   RECONDEV,RCONDVCT   DEV TYPE                                     
         MVC   RECONDSP,RCONDVSP   DEV SALESPERSON                              
         DROP  R6                                                               
*                                                                               
RDCON010 DS    0H                                                               
         TR    RECONDEV,MXTRT                                                   
         TR    RECONDSP,MXTRT                                                   
*                                                                               
         CLC   RCONPRD,SPACES                                                   
         JNH   RDCON012                                                         
*                                                                               
         MVC   RECONPRC,RCONPRD    PRODUCT CODE                                 
         J     RDCON020                                                         
*                                                                               
RDCON012 DS    0H                                                               
         LA    R6,RCONREC                                                       
         MVI   ELCODE,X'05'                                                     
         BRAS  RE,GETEL                                                         
         JNE   RDCON020                                                         
*                                                                               
         USING RCONEXEL,R6                                                      
         MVC   RECONPRT,RCONEXPR   PRODUCT TEXT                                 
         DROP  R6                                                               
*                                                                               
RDCON020 DS    0H                                                               
         TR    RECONPRC,MXTRT                                                   
         TR    RECONPRT,MXTRT                                                   
*                                                                               
         LA    R6,RCONREC                                                       
         MVI   ELCODE,X'12'        SAR                                          
         BRAS  RE,GETEL                                                         
         JNE   RDCON022                                                         
*                                                                               
         USING RSARXEL,R6                                                       
         LA    RE,RSARXDEM                                                      
         LA    R0,8                                                             
         MVI   WORK+3,C'T'                                                      
         J     RDCON030                                                         
         DROP  R6                                                               
*                                                                               
RDCON022 DS    0H                                                               
         LA    R6,RCONREC                                                       
         MVI   ELCODE,X'10'        BOP                                          
         BRAS  RE,GETEL                                                         
         JNE   RDCON040                                                         
*                                                                               
         USING RCONBPEL,R6                                                      
         CLI   RCONBPDM,X'FF'                                                   
         JNE   RDCON040            SKIP OLD FORMAT DEMOS                        
*                                                                               
         LA    RE,RCONBPDM+1                                                    
         LA    R0,6                                                             
         MVI   WORK+3,C'R'                                                      
         DROP  R6                                                               
*                                                                               
RDCON030 DS    0H                                                               
         XC    WORK,WORK                                                        
         MVC   WORK(3),0(RE)                                                    
RDCON032 DS    0H                                                               
         CLI   0(RE),0     SET AS PRIMARY?                                      
         JE    *+14                                                             
         MVC   WORK(3),0(RE)                                                    
         J     *+12                                                             
         LA    RE,3(RE)                                                         
         BRCT  R0,RDCON032                                                      
*                                                                               
         OC    WORK(3),WORK                                                     
         BZ    RDCON040                                                         
*                                                                               
         MVI   WORK,0               FUDGE FOR DEMOCON                           
         CLI   WORK+1,C'T'                                                      
         JNE   *+8                                                              
         MVI   WORK+1,C'I'                                                      
*                                                                               
         LA    R6,WORK+10                                                       
         USING DBLOCK,R6                                                        
         XC    DBLOCK,DBLOCK                                                    
         MVC   DBFILE,=C'INV'                                                   
         MVC   DBCOMFCS,COMFACS                                                 
         MVC   DBSELMED,WORK+3                                                  
         DROP  R6                                                               
*                                                                               
         GOTO1 DEMOCON,PLIST,(1,WORK),(9,RECONDEM),(0,WORK+10)                  
*                                                                               
RDCON040 DS    0H                                                               
         TR    RECONDEM,MXTRT                                                   
*                                                                               
         GOTO1 DATCON,PLIST,(3,RCONDATE),(10,RECONFLS)                          
***      XC    RECONFLS(2),RECONFLS+3 SWAP MM AND DD ABOUT                      
***      XC    RECONFLS+3(2),RECONFLS                                           
***      XC    RECONFLS(2),RECONFLS+3                                           
         TR    RECONFLS,MXTRT                                                   
*                                                                               
         GOTO1 DATCON,PLIST,(3,RCONDATE+3),(10,RECONFLE)                        
***      XC    RECONFLE(2),RECONFLE+3 SWAP MM AND DD ABOUT                      
***      XC    RECONFLE+3(2),RECONFLE                                           
***      XC    RECONFLE(2),RECONFLE+3                                           
         TR    RECONFLE,MXTRT                                                   
*                                                                               
         MVI   RECONXRE,C'N'                                                    
         LA    R6,RCONREC                                                       
         MVI   ELCODE,X'2F'        RER ELEMENT                                  
         BRAS  RE,GETEL                                                         
         JNE   RDCON050                                                         
*                                                                               
         USING RCONRER,R6                                                       
         TM    RCONFRER,X'01'      EXCLUDE FROM RER?                            
         BZ    RDCON050                                                         
         DROP  R6                                                               
*                                                                               
         MVI   RECONXRE,C'Y'                                                    
*                                                                               
RDCON050 DS    0H                                                               
         TR    RECONXRE,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
       ++INCLUDE RESETVAL                                                       
         DROP  R2,R3                                                            
*                                                                               
RXDOLCC  DC    A(BUFFER1)          ADJUSTED RATE RECORD SAVE AREA               
ANEWMON  DC    A(NEWMON)           NEWMON TABLE                                 
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* REPAGYC - EXTRACT AGENCY RECORD                                               
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)   (AGENCY 2 RECORD)                           *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPAGYC  NMOD1 WORKL,*REPAGY*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REAGYLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REAGYD,R2           R2=A(EXTRACT RECORD)                         
         USING RAGYREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REAGYLEN,REAGYLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REAGYLEN(2),=AL2(REAGYDL)                                        
         MVC   REAGYTYP,REPAGYQ                                                 
         MVI   REAGYDX,MXTRTQ                                                   
         MVI   REAGYDX+1,MXTRTQ                                                 
         MVI   REAGYREP-1,MXTRTQ                                                
         MVI   REAGYAGY-1,MXTRTQ                                                
         MVI   REAGYNAM-1,MXTRTQ                                                
         MVI   REAGYAD1-1,MXTRTQ                                                
         MVI   REAGYAD2-1,MXTRTQ                                                
         MVI   REAGYCTY-1,MXTRTQ                                                
         MVI   REAGYSTA-1,MXTRTQ                                                
         MVI   REAGYZIP-1,MXTRTQ                                                
*                                                                               
         MVC   REAGYREP,RAGYKREP   REP COMPANY                                  
         TR    REAGYREP,MXTRT                                                   
         MVC   REAGYAGY,RAGYKAGY   AGENCY + AGNECY OFFICE                       
         TR    REAGYAGY,MXTRT                                                   
*                                                                               
         LA    R6,RAGYREC                                                       
         MVI   ELCODE,X'1F'        01 IS 1F IN AGY2 REC                         
         BRAS  RE,GETEL                                                         
         JNE   RAGY0010                                                         
*                                                                               
         USING RAGYELEM,R6                                                      
         MVC   REAGYNAM,RAGYNAM2   AGENCY NAME                                  
         DROP  R6                                                               
*                                                                               
RAGY0010 DS    0H                                                               
         TR    REAGYNAM,MXTRT                                                   
*                                                                               
         LA    R6,RAGYREC                                                       
         MVI   ELCODE,X'10'                                                     
         BRAS  RE,GETEL                                                         
         JNE   RAGY0020                                                         
*                                                                               
         USING RAGY2FXE,R6                                                      
         MVC   REAGYPHO,RAGY2FON   PHONE #                                      
         DROP  R6                                                               
*                                                                               
RAGY0020 DS    0H                                                               
         TR    REAGYPHO,MXTRT                                                   
*                                                                               
         LA    R6,RAGYREC                                                       
         MVI   ELCODE,X'20'                                                     
         BRAS  RE,GETEL                                                         
         JNE   RAGY0030                                                         
*                                                                               
         USING RAGY2AE1,R6                                                      
         MVC   REAGYAD1,RAGY2AD1   ADDRESS 1                                    
         MVC   REAGYAD2,RAGY2AD2   ADDRESS 2                                    
         MVC   REAGYCTY,RAGY2CTY   CITY                                         
         MVC   REAGYSTA,RAGY2STE   STATE                                        
         MVC   REAGYZIP,RAGY2ZIP   ZIP CODE                                     
         DROP  R6                                                               
*                                                                               
RAGY0030 DS    0H                                                               
         TR    REAGYAD1,MXTRT                                                   
         TR    REAGYAD2,MXTRT                                                   
         TR    REAGYCTY,MXTRT                                                   
         TR    REAGYSTA,MXTRT                                                   
         TR    REAGYZIP,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
REAGYLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPADVC - EXTRACT ADVERTISER RECORD                                           
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPADVC  NMOD1 WORKL,*REPADV*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,READVLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING READVD,R2           R2=A(EXTRACT RECORD)                         
         USING RADVREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    READVLEN,READVLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   READVLEN(2),=AL2(READVDL)                                        
         MVC   READVTYP,REPADVQ                                                 
         MVI   READVDX,MXTRTQ                                                   
         MVI   READVDX+1,MXTRTQ                                                 
         MVI   READVREP-1,MXTRTQ                                                
         MVI   READVADV-1,MXTRTQ                                                
         MVI   READVNAM-1,MXTRTQ                                                
         MVI   READVCAT-1,MXTRTQ                                                
         MVI   READVNET-1,MXTRTQ                                                
*                                                                               
         MVC   READVREP,RADVKREP   REP COMPANY                                  
         TR    READVREP,MXTRT                                                   
         MVC   READVADV,RADVKADV   ADVERTISER CODE                              
         TR    READVADV,MXTRT                                                   
         MVC   READVNAM,RADVNAME   ADVERTISER NAME                              
         TR    READVNAM,MXTRT                                                   
         MVC   READVCAT,RADVCATG   ADVERTISER CATEGORY CODE                     
         TR    READVCAT,MXTRT                                                   
         MVI   READVNET,C'N'       ADVERTISER INTERNET FLAG                     
         CLC   =C'INTERNET',RADVCITY                                            
         JNE   *+8                                                              
         MVI   READVNET,C'Y'                                                    
         TR    READVNET,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
READVLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPSALC - EXTRACT SALESPERSON RECORD                                          
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPSALC  NMOD1 WORKL,*REPSAL*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,RESALLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING RESALD,R2           R2=A(EXTRACT RECORD)                         
         USING RSALREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    RESALLEN,RESALLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   RESALLEN(2),=AL2(RESALDL)                                        
         MVC   RESALTYP,REPSALQ                                                 
         MVI   RESALDX,MXTRTQ                                                   
         MVI   RESALDX+1,MXTRTQ                                                 
         MVI   RESALREP-1,MXTRTQ                                                
         MVI   RESALSAL-1,MXTRTQ                                                
         MVI   RESALNAM-1,MXTRTQ                                                
         MVI   RESALTEM-1,MXTRTQ                                                
         MVI   RESALTEL-1,MXTRTQ                                                
*                                                                               
         MVC   RESALREP,RSALKREP   REP COMPANY                                  
         TR    RESALREP,MXTRT                                                   
         MVC   RESALSAL,RSALKSAL   SALESPERSON CODE                             
         TR    RESALSAL,MXTRT                                                   
         MVC   RESALNAM,RSALNAME   SALESPERSON NAME                             
         TR    RESALNAM,MXTRT                                                   
         MVC   RESALTEM,RSALTEAM   SALESPERSON TEAM                             
         TR    RESALTEM,MXTRT                                                   
         MVC   RESALTEL,RSALTEL    SALESPERSON TELEPHONE #                      
         TR    RESALTEL,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
RESALLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPCTYC - EXTRACT CONTRACT TYPE                                               
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPCTYC  NMOD1 WORKL,*REPCTY*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,RECTYLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING RECTYD,R2           R2=A(EXTRACT RECORD)                         
         USING RCTYREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    RECTYLEN,RECTYLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   RECTYLEN(2),=AL2(RECTYDL)                                        
         MVC   RECTYTYP,REPCTYQ                                                 
         MVI   RECTYDX,MXTRTQ                                                   
         MVI   RECTYDX+1,MXTRTQ                                                 
         MVI   RECTYREP-1,MXTRTQ                                                
         MVI   RECTYCTY-1,MXTRTQ                                                
         MVI   RECTYNAM-1,MXTRTQ                                                
*                                                                               
         MVC   RECTYREP,RCTYKREP   REP COMPANY                                  
         TR    RECTYREP,MXTRT                                                   
         MVC   RECTYCTY,RCTYKCTY   DEV CON TYPE                                 
         TR    RECTYCTY,MXTRT                                                   
         MVC   RECTYNAM,RCTYDESC   DEV CON TYPE NAME                            
         TR    RECTYNAM,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
RECTYLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPDCTC - EXTRACT DEVELOPMENT CONTRACT TYPE                                   
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPDCTC  NMOD1 WORKL,*REPDCT*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REDCTLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REDCTD,R2           R2=A(EXTRACT RECORD)                         
         USING RDCTREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REDCTLEN,REDCTLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REDCTLEN(2),=AL2(REDCTDL)                                        
         MVC   REDCTTYP,REPDCTQ                                                 
         MVI   REDCTDX,MXTRTQ                                                   
         MVI   REDCTDX+1,MXTRTQ                                                 
         MVI   REDCTREP-1,MXTRTQ                                                
         MVI   REDCTDCT-1,MXTRTQ                                                
         MVI   REDCTNAM-1,MXTRTQ                                                
*                                                                               
         MVC   REDCTREP,RDCTKREP   REP COMPANY                                  
         TR    REDCTREP,MXTRT                                                   
         MVC   REDCTDCT,RDCTKCTY   DEV CON TYPE                                 
         TR    REDCTDCT,MXTRT                                                   
         MVC   REDCTNAM,RDCTDESC   DEV CON TYPE NAME                            
         TR    REDCTNAM,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
REDCTLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPSTAC - EXTRACT STATION                                                     
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPSTAC  NMOD1 WORKL,*REPSTA*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,RESTALIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING RESTAD,R2           R2=A(EXTRACT RECORD)                         
         USING RSTAREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    RESTALEN,RESTALEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   RESTALEN(2),=AL2(RESTADL)                                        
         MVC   RESTATYP,REPSTAQ                                                 
         MVI   RESTADX,MXTRTQ                                                   
         MVI   RESTADX+1,MXTRTQ                                                 
         MVI   RESTAREP-1,MXTRTQ                                                
         MVI   RESTASTA-1,MXTRTQ                                                
         MVI   RESTAGRP-1,MXTRTQ                                                
         MVI   RESTAJDT-1,MXTRTQ                                                
         MVI   RESTALDT-1,MXTRTQ                                                
         MVI   RESTACDT-1,MXTRTQ                                                
         MVI   RESTAMKT-1,MXTRTQ                                                
         MVI   RESTAAFF-1,MXTRTQ                                                
         MVI   RESTAOWN-1,MXTRTQ                                                
*                                                                               
         MVC   RESTAREP,RSTAKREP   REP COMPANY                                  
         TR    RESTAREP,MXTRT                                                   
         MVC   RESTASTA,RSTAKSTA   STATION CODE                                 
         TR    RESTASTA,MXTRT                                                   
*                                  JOIN/LEAVE DATES                             
         GOTO1 DATCON,PLIST,(3,RSTASTRT),(10,RESTAJDT)                          
***      XC    RESTAJDT(2),RESTAJDT+3 SWAP MM AND DD ABOUT                      
***      XC    RESTAJDT+3(2),RESTAJDT                                           
***      XC    RESTAJDT(2),RESTAJDT+3                                           
         TR    RESTAJDT,MXTRT                                                   
*                                                                               
         OC    RSTAEND,RSTAEND                                                  
         JZ    RSTA0002                                                         
*                                                                               
         GOTO1 DATCON,PLIST,(3,RSTAEND),(10,RESTALDT)                           
***      XC    RESTALDT(2),RESTALDT+3 SWAP MM AND DD ABOUT                      
***      XC    RESTALDT+3(2),RESTALDT                                           
***      XC    RESTALDT(2),RESTALDT+3                                           
RSTA0002 DS    0H                                                               
         TR    RESTALDT,MXTRT                                                   
*                                                                               
         OC    RSTACLDT,RSTACLDT                                                
         JZ    RSTA0004                                                         
*                                  LAST INVOICED CLOSE DATE                     
         MVC   WORK(2),RSTACLDT                                                 
         MVI   WORK+2,X'01'        FUDGE USING 1ST OF MONTH                     
         GOTO1 DATCON,PLIST,(3,WORK),(10,RESTACDT)                              
***      XC    RESTACDT(2),RESTACDT+3 SWAP MM AND DD ABOUT                      
***      XC    RESTACDT+3(2),RESTACDT                                           
***      XC    RESTACDT(2),RESTACDT+3                                           
*                                                                               
RSTA0004 DS    0H                                                               
         TR    RESTACDT,MXTRT                                                   
*                                                                               
         MVC   RESTAGRP,RSTAGRUP   STATION GROUP CODE                           
         TR    RESTAGRP,MXTRT                                                   
         MVC   RESTAOWN,RSTAOWN    STATION OWNER CODE                           
         TR    RESTAOWN,MXTRT                                                   
         MVC   RESTAAFF,RSTAAFFL   STATION AFFILIATION                          
         TR    RESTAAFF,MXTRT                                                   
*                                                                               
         LA    R6,RSTAREC                                                       
         MVI   ELCODE,X'08'                                                     
         BRAS  RE,GETEL                                                         
         JNE   RSTA0010                                                         
*                                                                               
         USING RSTAXXEL,R6                                                      
         MVC   RESTAMKT,RSTAMKTC   STATION MARKET CODE                          
         DROP  R6                                                               
*                                                                               
RSTA0010 DS    0H                                                               
         TR    RESTAMKT,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
RESTALIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPGRPC - EXTRACT GROUP/SUB GROUP                                             
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPGRPC  NMOD1 WORKL,*REPGRP*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REGRPLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REGRPD,R2           R2=A(EXTRACT RECORD)                         
         USING RGRPREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REGRPLEN,REGRPLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REGRPLEN(2),=AL2(REGRPDL)                                        
         MVC   REGRPTYP,REPGRPQ                                                 
         MVI   REGRPDX,MXTRTQ                                                   
         MVI   REGRPDX+1,MXTRTQ                                                 
         MVI   REGRPREP-1,MXTRTQ                                                
         MVI   REGRPGRP-1,MXTRTQ                                                
         MVI   REGRPNAM-1,MXTRTQ                                                
         MVI   REGRPSNM-1,MXTRTQ                                                
*                                                                               
         MVC   REGRPREP,RGRPKREP   REP COMPANY                                  
         TR    REGRPREP,MXTRT                                                   
         MVC   REGRPGRP,RGRPKGRP   GROUP CODE                                   
         TR    REGRPGRP,MXTRT                                                   
         MVC   REGRPNAM,RGRPNAME   GROUP NAME                                   
         TR    REGRPNAM,MXTRT                                                   
         MVC   REGRPSNM,RGRPSBNM   SUB GROUP NAME                               
         TR    REGRPSNM,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
REGRPLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPDSPC - EXTRACT DEVELOPMENT SALESPERSON                                     
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPDSPC  NMOD1 WORKL,*REPDSP*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REDSPLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REDSPD,R2           R2=A(EXTRACT RECORD)                         
         USING RDSPREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REDSPLEN,REDSPLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REDSPLEN(2),=AL2(REDSPDL)                                        
         MVC   REDSPTYP,REPDSPQ                                                 
         MVI   REDSPDX,MXTRTQ                                                   
         MVI   REDSPDX+1,MXTRTQ                                                 
         MVI   REDSPREP-1,MXTRTQ                                                
         MVI   REDSPSAL-1,MXTRTQ                                                
         MVI   REDSPNAM-1,MXTRTQ                                                
         MVI   REDSPTEM-1,MXTRTQ                                                
         MVI   REDSPTEL-1,MXTRTQ                                                
*                                                                               
         MVC   REDSPREP,RDSPKREP   REP COMPANY                                  
         TR    REDSPREP,MXTRT                                                   
         MVC   REDSPSAL,RDSPKSAL   DEV SALESPERSON CODE                         
         TR    REDSPSAL,MXTRT                                                   
         MVC   REDSPNAM,RDSPNAME   DEV SALESPERSON NAME                         
         TR    REDSPNAM,MXTRT                                                   
         MVC   REDSPTEM,RDSPTEAM   DEV SALESPERSON TEAM                         
         TR    REDSPTEM,MXTRT                                                   
         MVC   REDSPTEL,RDSPTEL    DEV SALESPERSON TELEPHONE #                  
         TR    REDSPTEL,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
REDSPLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPTEMC - EXTRACT TEAM                                                        
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPTEMC  NMOD1 WORKL,*REPTEM*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,RETEMLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING RETEMD,R2           R2=A(EXTRACT RECORD)                         
         USING RTEMREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    RETEMLEN,RETEMLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   RETEMLEN(2),=AL2(RETEMDL)                                        
         MVC   RETEMTYP,REPTEMQ                                                 
         MVI   RETEMDX,MXTRTQ                                                   
         MVI   RETEMDX+1,MXTRTQ                                                 
         MVI   RETEMREP-1,MXTRTQ                                                
         MVI   RETEMTEM-1,MXTRTQ                                                
         MVI   RETEMNAM-1,MXTRTQ                                                
         MVI   RETEMDIV-1,MXTRTQ                                                
*                                                                               
         MVC   RETEMREP,RTEMKREP   REP COMPANY                                  
         TR    RETEMREP,MXTRT                                                   
         MVC   RETEMTEM,RTEMKTEM   TEAM CODE                                    
         TR    RETEMTEM,MXTRT                                                   
         MVC   RETEMNAM,RTEMNAME   TEAM NAME                                    
         TR    RETEMNAM,MXTRT                                                   
         MVC   RETEMDIV,RTEMDVNM   TEAM DIVISION NAME                           
         TR    RETEMDIV,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
RETEMLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPPRDC - EXTRACT PRODUCT                                                     
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPPRDC  NMOD1 WORKL,*REPPRD*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REPRDLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REPRDD,R2           R2=A(EXTRACT RECORD)                         
         USING RPRDREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REPRDLEN,REPRDLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REPRDLEN(2),=AL2(REPRDDL)                                        
         MVC   REPRDTYP,REPPRDQ                                                 
         MVI   REPRDDX,MXTRTQ                                                   
         MVI   REPRDDX+1,MXTRTQ                                                 
         MVI   REPRDREP-1,MXTRTQ                                                
         MVI   REPRDADV-1,MXTRTQ                                                
         MVI   REPRDPRD-1,MXTRTQ                                                
         MVI   REPRDNAM-1,MXTRTQ                                                
         MVI   REPRDCAT-1,MXTRTQ                                                
*                                                                               
         MVC   REPRDREP,RPRDKREP   REP COMPANY                                  
         TR    REPRDREP,MXTRT                                                   
         MVC   REPRDADV,RPRDKADV   ADVERTISER                                   
         TR    REPRDADV,MXTRT                                                   
         MVC   REPRDPRD,RPRDKPRD   PRODUCT CODE                                 
         TR    REPRDPRD,MXTRT                                                   
         MVC   REPRDNAM,RPRDNAME   PRODUCT NAME                                 
         TR    REPRDNAM,MXTRT                                                   
         MVC   REPRDCAT,RPRDCATG   PRODUCT CATEGORY CODE                        
         TR    REPRDCAT,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
REPRDLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPCLSC - EXTRACT CLASS                                                       
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPCLSC  NMOD1 WORKL,*REPCLS*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,RECLSLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING RECLSD,R2           R2=A(EXTRACT RECORD)                         
         USING RCLSREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    RECLSLEN,RECLSLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   RECLSLEN(2),=AL2(RECLSDL)                                        
         MVC   RECLSTYP,REPCLSQ                                                 
         MVI   RECLSDX,MXTRTQ                                                   
         MVI   RECLSDX+1,MXTRTQ                                                 
         MVI   RECLSREP-1,MXTRTQ                                                
         MVI   RECLSCOD-1,MXTRTQ                                                
         MVI   RECLSNAM-1,MXTRTQ                                                
*                                                                               
         MVC   RECLSREP,RCLSKREP   REP COMPANY                                  
         TR    RECLSREP,MXTRT                                                   
         MVC   RECLSCOD,RCLSKCLS   CLASS CODE                                   
         TR    RECLSCOD,MXTRT                                                   
         MVC   RECLSNAM,RCLSNAME   CLASS NAME                                   
         TR    RECLSNAM,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
RECLSLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPCATC - EXTRACT CATEGORY CODE                                               
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPCATC  NMOD1 WORKL,*REPCAT*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,RECATLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING RECATD,R2           R2=A(EXTRACT RECORD)                         
         USING RCTGREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    RECATLEN,RECATLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   RECATLEN(2),=AL2(RECATDL)                                        
         MVC   RECATTYP,REPCATQ                                                 
         MVI   RECATDX,MXTRTQ                                                   
         MVI   RECATDX+1,MXTRTQ                                                 
         MVI   RECATREP-1,MXTRTQ                                                
         MVI   RECATCOD-1,MXTRTQ                                                
         MVI   RECATNAM-1,MXTRTQ                                                
         MVI   RECATCLS-1,MXTRTQ                                                
*                                                                               
         MVC   RECATREP,RCTGKREP   REP COMPANY                                  
         TR    RECATREP,MXTRT                                                   
         MVC   RECATCOD,RCTGKCTG   CODE                                         
         TR    RECATCOD,MXTRT                                                   
         MVC   RECATNAM,RCTGNAME   NAME                                         
         TR    RECATNAM,MXTRT                                                   
         MVC   RECATCLS,RCTGCLSS   CLASS CODE                                   
         TR    RECATCLS,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
RECATLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPOFFC - EXTRACT OFFICE                                                      
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPOFFC  NMOD1 WORKL,*REPOFF*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REOFFLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REOFFD,R2           R2=A(EXTRACT RECORD)                         
         USING ROFFREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REOFFLEN,REOFFLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REOFFLEN(2),=AL2(REOFFDL)                                        
         MVC   REOFFTYP,REPOFFQ                                                 
         MVI   REOFFDX,MXTRTQ                                                   
         MVI   REOFFDX+1,MXTRTQ                                                 
         MVI   REOFFREP-1,MXTRTQ                                                
         MVI   REOFFCOD-1,MXTRTQ                                                
         MVI   REOFFNAM-1,MXTRTQ                                                
         MVI   REOFFREG-1,MXTRTQ                                                
         MVI   REOFFAD1-1,MXTRTQ                                                
         MVI   REOFFAD2-1,MXTRTQ                                                
         MVI   REOFFSTT-1,MXTRTQ                                                
         MVI   REOFFZIP-1,MXTRTQ                                                
*                                                                               
         MVC   REOFFREP,ROFFKREP   REP COMPANY                                  
         TR    REOFFREP,MXTRT                                                   
         MVC   REOFFCOD,ROFFKOFF   OFFICE CODE                                  
         TR    REOFFCOD,MXTRT                                                   
         MVC   REOFFNAM,ROFFNAME   OFFICE NAME                                  
         TR    REOFFNAM,MXTRT                                                   
         MVC   REOFFREG,ROFFREG    OFFICE REGION                                
         TR    REOFFREG,MXTRT                                                   
         MVC   REOFFREG,ROFFREG    OFFICE REGION                                
         TR    REOFFREG,MXTRT                                                   
         MVC   REOFFAD1,ROFFADD1   OFFICE ADDRESS LINE 1                        
         TR    REOFFAD1,MXTRT                                                   
         MVC   REOFFAD2,ROFFADD2   OFFICE ADDRESS LINE 2                        
         TR    REOFFAD2,MXTRT                                                   
         MVC   REOFFSTT,ROFFSTT    OFFICE STATE                                 
         TR    REOFFSTT,MXTRT                                                   
         MVC   REOFFZIP,ROFFZIP    OFFICE ZIPCODE                               
         TR    REOFFZIP,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
REOFFLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPOWNC - EXTRACT OWNER                                                       
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPOWNC  NMOD1 WORKL,*REPOWN*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REOWNLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REOWND,R2           R2=A(EXTRACT RECORD)                         
         USING ROWNREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REOWNLEN,REOWNLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REOWNLEN(2),=AL2(REOWNDL)                                        
         MVC   REOWNTYP,REPOWNQ                                                 
         MVI   REOWNDX,MXTRTQ                                                   
         MVI   REOWNDX+1,MXTRTQ                                                 
         MVI   REOWNREP-1,MXTRTQ                                                
         MVI   REOWNCOD-1,MXTRTQ                                                
         MVI   REOWNNAM-1,MXTRTQ                                                
*                                                                               
         MVC   REOWNREP,ROWNKREP   REP COMPANY                                  
         TR    REOWNREP,MXTRT                                                   
         MVC   REOWNCOD,ROWNKOWN   OWNER CODE                                   
         TR    REOWNCOD,MXTRT                                                   
         MVC   REOWNNAM,ROWNNAME   OWNER NAME                                   
         TR    REOWNNAM,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
REOWNLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPMKTC - EXTRACT MARKET                                                      
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPMKTC  NMOD1 WORKL,*REPMKT*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REMKTLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REMKTD,R2           R2=A(EXTRACT RECORD)                         
         USING RMKTREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REMKTLEN,REMKTLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REMKTLEN(2),=AL2(REMKTDL)                                        
         MVC   REMKTTYP,REPMKTQ                                                 
         MVI   REMKTDX,MXTRTQ                                                   
         MVI   REMKTDX+1,MXTRTQ                                                 
         MVI   REMKTREP-1,MXTRTQ                                                
         MVI   REMKTCOD-1,MXTRTQ                                                
         MVI   REMKTNAM-1,MXTRTQ                                                
*                                                                               
         MVC   REMKTREP,RMKTKREP   REP COMPANY                                  
         TR    REMKTREP,MXTRT                                                   
         MVC   REMKTCOD,RMKTKMKT   MARKET CODE                                  
         TR    REMKTCOD,MXTRT                                                   
         MVC   REMKTNAM,RMKTNAME   MARKET NAME                                  
         TR    REMKTNAM,MXTRT                                                   
*                                                                               
         J     EXIT                                                             
*                                                                               
REMKTLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPMSTC - EXTRACT SEE-ME/READ-ME MASTER/SUB INFORMATION                       
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPMSTC  NMOD1 WORKL,*REPMST*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REMSTLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REMSTD,R2           R2=A(EXTRACT RECORD)                         
         USING RREPREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REMSTLEN,REMSTLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REMSTLEN(2),=AL2(REMSTDL)                                        
         MVC   REMSTTYP,REPMSTQ                                                 
         MVI   REMSTDX,MXTRTQ                                                   
         MVI   REMSTDX+1,MXTRTQ                                                 
         MVI   REMSTSUB-1,MXTRTQ                                                
         MVI   REMSTMST-1,MXTRTQ                                                
*                                                                               
         MVC   REMSTSUB,RREPKREP   REP COMPANY                                  
         TR    REMSTSUB,MXTRT                                                   
*                                                                               
         MVC   REMSTMST,RREPKREP   REP COMPANY                                  
         CLC   RREPMAST,=C'  '      NO MASTER CONTROL                           
         JNH   RMST0010                                                         
         CLC   RREPMAST,=X'FFFF'    THIS IS THE MASTER                          
         JE    RMST0010                                                         
*                                                                               
         MVC   REMSTMST,RREPMAST   SET THE MASTER                               
*                                                                               
RMST0010 DS    0H                                                               
         TR    REMSTMST,MXTRT                                                   
         J     EXIT                                                             
*                                                                               
REMSTLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* REPREPC - EXTRACT REP COMPANY                                                 
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(ACCFILE RECORD)                                               *         
* AL4 0=REPFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
REPREPC  NMOD1 WORKL,*REPREP*,CLEAR=Y                                           
         USING WORKD,RC                                                         
         L     RA,REREPLIT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         USING REREPD,R2           R2=A(EXTRACT RECORD)                         
         USING RREPREC,R3          R3=A(REPFILE RECORD)                         
*                                                                               
         XC    REREPLEN,REREPLEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   REREPLEN(2),=AL2(REREPDL)                                        
         MVC   REREPTYP,REPREPQ                                                 
         MVI   REREPDX,MXTRTQ                                                   
         MVI   REREPDX+1,MXTRTQ                                                 
         MVI   REREPSUB-1,MXTRTQ                                                
         MVI   REREPNAM-1,MXTRTQ                                                
*                                                                               
         MVC   REREPSUB,RREPKREP   REP COMPANY                                  
         TR    REREPSUB,MXTRT                                                   
         MVC   REREPNAM,RREPNAME                                                
         TR    REREPNAM,MXTRT                                                   
         J     EXIT                                                             
*                                                                               
REREPLIT DC    A(LITERAL)                                                       
         LTORG                                                                  
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* SETUPMON - SETUP RRG STYLE DATE TABLES FOR CONTRACT BUCKETING       *         
*                                                                     *         
*---------------------------------------------------------------------*         
         SPACE 1                                                                
SETUPMON NMOD1 WORKL,*SMON*,CLEAR=Y                                             
         USING WORKD,RC                                                         
         L     RA,SMONLIT                                                       
         USING LITERAL,RA                                                       
         L     R9,SMONQWK                                                       
         USING QWKD,R9                                                          
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         L     R8,0(R1)            A(DXUSER)                                    
         USING RXUSERD,R8                                                       
*                                                                               
         GOTO1 DATCON,PLIST,(9,RXUCURST),(3,WORK)                               
         MVC   QWCURST,WORK        NO DAY IN REQUEST DATE                       
*                                                                               
         GOTO1 DATCON,PLIST,(9,RXUCURND),(3,WORK)                               
         MVC   QWCURND,WORK        NO DAY IN REQUEST DATE                       
*                                                                               
         GOTO1 DATCON,PLIST,(9,RXUCURST),(0,WORK+3)                             
         GOTO1 VADDAY,PLIST,(C'Y',WORK+3),(0,WORK+3),-1                         
         GOTO1 DATCON,PLIST,(0,WORK+3),(3,WORK)                                 
         MVC   QWPRIST,WORK        NO DAY IN REQUEST DATE                       
*                                                                               
         GOTO1 DATCON,PLIST,(9,RXUCURND),(0,WORK+3)                             
         GOTO1 VADDAY,PLIST,(C'Y',WORK+3),(0,WORK+3),-1                         
         GOTO1 DATCON,PLIST,(0,WORK+3),(3,WORK)                                 
         MVC   QWPRIND,WORK        NO DAY IN REQUEST DATE                       
*                                                                               
         BRAS  RE,ASATPROC         SET UP AS-AT DATES                           
*                                                                               
         LA    R4,QWMONINF         BUILD MONTHLY INFO LIST                      
         SR    R5,R5                                                            
         XC    QWMONINF,QWMONINF                                                
         MVC   WORK(2),QWCURST                                                  
         MVC   WORK+2(2),QWPRIST                                                
         MVI   WORK+1,1            ALWAYS START FROM JAN                        
         MVI   WORK+3,1                                                         
*                                                                               
         MVC   WORK+4(2),QWPRIST   CALCULATE 2 YEARS PRIOR                      
         IC    R5,WORK+4                                                        
         BCTR  R5,0                DECREMENT PRIOR YEAR BY 1                    
         STC   R5,WORK+4                                                        
         MVC   WORK+6(2),QWCURST   CALCULATE NEXT YEAR                          
         IC    R5,WORK+6                                                        
         LA    R5,1(R5)            ADD 1 YEAR TO CURRENT YEAR                   
         STC   R5,WORK+6                                                        
*                                                                               
SMON0100 MVC   0(2,R4),WORK        CURRENT YEAR/MO                              
         MVC   2(2,R4),WORK+2      PRIOR YEAR/NO                                
         MVC   4(2,R4),WORK+4      2 YEAR PRIOR YEAR/MO                         
         MVC   6(2,R4),WORK+6      NEXT YEAR                                    
         CLI   WORK+1,12           IS IT DECEMBER?                              
         JL    SMON0110            NO                                           
         MVI   WORK+3,1            SET PRIOR YEAR MONTH = JAN                   
         MVC   WORK+4(2),WORK+2    SET 2 YEAR PRIOR= PRIOR JAN                  
         MVI   WORK+1,1            SET CURRENT YEAR MONTH = JAN                 
         MVC   WORK+2(2),WORK      SET PRIOR YEAR = CURRENT JAN                 
         IC    R5,WORK             ADD 1 TO CURRENT YEAR                        
         LA    R5,1(R5)                                                         
         STC   R5,WORK                                                          
         MVI   WORK+7,1            SET NEXT YEAR MONTH = JAN                    
         IC    R5,WORK+6           ADD 1 TO NEXT YEAR                           
         LA    R5,1(R5)                                                         
         STC   R5,WORK+6                                                        
         J     SMON0120                                                         
*                                                                               
SMON0110 IC    R5,WORK+1           NO - INCREMENT THE MONTH                     
         LA    R5,1(R5)                                                         
         STC   R5,WORK+1                                                        
         STC   R5,WORK+3                                                        
         STC   R5,WORK+5                                                        
         STC   R5,WORK+5                                                        
*                                                                               
SMON0120 CLC   QWCURND,WORK        HAVE WE PASSED PERIOD END                    
         JL    SMON0130                                                         
         LA    R4,8(R4)                                                         
         J     SMON0100                                                         
*                                                                               
SMON0130 EQU   *                                                                
         BRAS  RE,SETMONTB                                                      
*                                                                               
         J     EXIT                                                             
         LTORG                                                                  
         SPACE 3                                                                
SMONLIT  DC    A(LITERAL)                                                       
SMONQWK  DC    V(RXQWK)                                                         
         EJECT                                                                  
***********************************************************************         
*  THIS ROUTINE SETS 'FORECAST' DATE BUCKETS USING AS AT DATES.  IF             
*     AN AS-AT TO-DATE HAS BEEN ENTERED, INDICATING A REQUEST FOR               
*     AS-AT RANGE TESTING, FOUR ADDITIONAL DATES ARE GENERATED.                 
*----------------------------------------------------------------------         
ASATPROC NTR1  BASE=*,LABEL=*                                                   
         XC    QWMONFOR(16),QWMONFOR INITIALIZE MONTH FCST TABLE                
         GOTO1 DATCON,PLIST,(5,0),(0,WORK)                                      
*                                                                               
         CLI   RXTODAY,C' '        DATE OVERRIDE                                
         BNH   *+10                NO                                           
         MVC   WORK(6),RXTODAY                                                  
*                                                                               
         MVC   WORK+36(6),WORK     USE WORK+36 TO SET DR CUTOFF                 
         BRAS  RE,DRCUTOFF         SET DR CUTOFF                                
*                                                                               
*   SET 'CURRENT AS-AT DATE' (FROM), AND THREE DATES BASED ON IT                
*                                                                               
         GOTO1 SET4DATS,PLIST,QWMONFOR,0                                        
*                                                                               
         J     EXIT                                                             
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*  THIS ROUTINE SETS THE DIRECT RESPONSE CUTOFF DATE:                           
*        DATE OF RUN IS ADJUSTED:                                               
*              IF DATE OF RUN IS WEDNESDAY, DATE IS USED AS IS                  
*              IF DATE OF RUN IS NOT WEDNESDAY, FOLLOWING                       
*                 WEDNESDAY IS CALCULATED, AND ITS DATE USED.                   
*        IF AS-AT DATE, AS CALCULATED ABOVE, IF AFTER 14TH OF MONTH,            
*              CURRENT YEAR/MONTH IS SET, ELSE PREVIOUS IS SET                  
*----------------------------------------------------------------------         
DRCUTOFF NTR1  BASE=*,LABEL=*                                                   
         MVC   WORK+42(6),WORK+36                                               
         GOTO1 VGETDAY,PLIST,WORK+42,FULL                                       
*                                  GET DAY OF WEEK                              
         CLI   PLIST,3             IS RUNDATE WEDNESDAY?                        
         JE    DRCU0060            YES - USE IT FOR CUTOFF TEST                 
         L     RF,=A(WEDADJST)                                                  
DRCU0010 EQU   *                                                                
         CLI   0(RF),0             END OF TABLE?                                
         JNE   *+6                                                              
         DC    H'0'                DAY NOT FOUND                                
         CLC   PLIST(1),0(RF)      DAY OF WEEK VS TABLE                         
         JE    DRCU0020            FOUND                                        
         LA    RF,5(RF)            BUMP TO NEXT ENTRY                           
         J     DRCU0010            GO BACK FOR NEXT                             
DRCU0020 EQU   *                                                                
         ZICM  R3,1(RF),4          GET DAY ADJUSTMENT TO WED                    
         GOTO1 VADDAY,PLIST,WORK+42,WORK+36,(R3)                                
DRCU0060 EQU   *                                                                
         GOTO1 DATCON,PLIST,(0,WORK+36),(3,WORK+42)                             
*                                  CONVERT DATE TO BINARY YMD                   
         CLI   WORK+44,X'0F'       DAY 15TH OR AFTER?                           
         JL    DRCU0080            NO  - SET PREVIOUS MONTH                     
         MVC   QWDRCOFF,WORK+42    YES - SAVE YM OF AS-AT DATE                  
         J     DRCU0160            EXIT                                         
DRCU0080 EQU   *                   SET PREVIOUS MONTH                           
         CLI   WORK+43,1           IS MONTH JANUARY?                            
         JE    DRCU0100            YES                                          
         ZIC   RF,WORK+43          NO  - DECREMENT 1 MONTH                      
         BCTR  RF,0                                                             
         STC   RF,WORK+43          REINSERT MONTH                               
         MVC   QWDRCOFF,WORK+42    SAVE YM OF AS-AT DATE                        
         J     DRCU0160            EXIT                                         
DRCU0100 EQU   *                                                                
         MVI   WORK+43,12          JANUARY: OVERLAY WITH DECEMBER               
         ZIC   RF,WORK+42          DECREMENT YEAR BY 1                          
         BCTR  RF,0                                                             
         STC   RF,WORK+42                                                       
         MVC   QWDRCOFF,WORK+42    SAVE YM OF AS-AT DATE                        
         J     DRCU0160            EXIT                                         
DRCU0160 EQU   *                                                                
         MVC   QWDRCOFP,QWDRCOFF   SET PRIOR YEAR CUTOFF                        
         ZIC   RF,QWDRCOFP         BACK UP 1 YEAR                               
         BCTR  RF,0                                                             
         STC   RF,QWDRCOFP         RESTORE YEAR                                 
         CLI   QWDRCOFP,96         LEAP YEAR?  1996                             
         JE    DRCU0180            YES - ANY DATE OKAY                          
         CLI   QWDRCOFP,100        LEAP YEAR?  2000                             
         JE    DRCU0180            YES - ANY DATE OKAY                          
         CLI   QWDRCOFP,104        LEAP YEAR?  2004                             
         JE    DRCU0180            YES - ANY DATE OKAY                          
         CLI   QWDRCOFP,108        LEAP YEAR?  2008                             
         JE    DRCU0180            YES - ANY DATE OKAY                          
         CLI   QWDRCOFP,112        LEAP YEAR? 2112                              
         JE    DRCU0180            YES - ANY DATE OKAY                          
         CLC   QWDRCOFP+1(2),=X'021D'                                           
*                                  NO  - FEB 29?                                
         JNE   DRCU0180            NO  - OKAY                                   
         MVC   QWDRCOFP+1(2),=X'021C'                                           
*                                  YES - SET TO FEB 28                          
DRCU0180 EQU   *                                                                
         XC    WORK+36(20),WORK+36 CLEAR THE WORK AREA                          
         J     EXIT                                                             
         LTORG                                                                  
*---------------------------------------------------------------------          
*                                                                               
*   WEDNESDAY ADJUSTMENT TABLE:  EACH ENTRY IS TWO CHARACTERS                   
*        CHAR 1:  DAY OF WEEK                                                   
*        CHAR 2:  ADJUSTMENT VALUE  - SUN THRU TUESDAY ADJUST                   
*                                     THU THRU SATURDAY DON'T                   
*---------------------------------------------------------------------          
WEDADJST DC    X'01',X'00000002'         MONDAY                                 
         DC    X'02',X'00000001'         TUESDAY                                
         DC    X'04',X'FFFFFFFF'         THURSDAY - BACK UP 1 DAY               
         DC    X'05',X'FFFFFFFE'         FRIDAY   - BACK UP 2 DAYS              
         DC    X'06',X'00000004'         SATURDAY                               
         DC    X'07',X'00000003'         SUNDAY                                 
         DC    X'0000'                                                          
         EJECT                                                                  
**********************************************************************          
*  THIS ROUTINE SETS THE SET OF FOUR DATES FOR AS-AT PROCESSING.                
*---------------------------------------------------------------------          
SET4DATS NTR1  BASE=*,LABEL=*                                                   
         L     R6,0(R1)            RESET A(TABLE ENTRIES)                       
         GOTO1 GETMDAY,PLIST,WORK,(R6)   CURRENT AS-AT DATE                     
         LA    R6,2(R6)            A(PRIOR AS-AT DATE)                          
*                                                                               
* GET BROADCAST YEAR OF AS-AT DATE:  MAY NOT BE SAME - IE:                      
*    DEC30/91 IS BROADCAST YEAR 02.  (CHECK THE CALENDAR).                      
*    TAKE THE YEAR FROM THE TO-DATE PORTION, FOR SAME REASON.                   
*                                                                               
         GOTO1 GETBROAD,PLIST,WORK,WORK+12                                      
         MVC   WORK+6(2),WORK+18   CALCULATE START BDCST YEAR                   
         MVC   WORK+8(4),=C'0115'  SET JAN15 OF YEAR                            
         GOTO1 GETBROAD,PLIST,WORK+6,WORK+12                                    
*                                                                               
*  CALCULATE WEEK # FROM BDCAST YEAR START THRU CURR AS AT DATE                 
*                                                                               
         GOTO1 =V(PERVERT),PLIST,WORK+12,WORK                                   
         ZICM  RF,PLIST+12,2       SAVE WEEK# OF CURR AS AT DATE                
         OC    PLIST+10(2),PLIST+10 ANY PERVERT DAYS REMAINING?                 
         JNZ   SETD0040            YES - DON'T ADJUST WEEK #                    
         BCTR  RF,0                NO  - DECREMENT WEEK #                       
SETD0040 EQU   *                                                                
         CLI   RXASATWK,C'B'       DECREMENT WEEK                               
         JNE   SETD0042                                                         
         BCTR  RF,0                                                             
SETD0042 EQU   *                                                                
         CLI   RXASATWK,C'F'       INCREMENT WEEK                               
         JNE   SETD0044                                                         
         LA    RF,1(RF)                                                         
SETD0044 EQU   *                                                                
         STCM  RF,3,WORK+32        SAVE WEEK# OF CURR AS AT DATE                
         GOTO1 DATCON,PLIST,(0,WORK+6),(3,DOUBLE)                               
         ZIC   RF,DOUBLE           EXTRACT YEAR FROM DATE                       
         BCTR  RF,0                SUBTRACT 1 FROM YEAR                         
         STC   RF,DOUBLE           PUT YEAR BACK                                
         GOTO1 DATCON,PLIST,(3,DOUBLE),(0,WORK+6)                               
         GOTO1 SETASAT,PLIST,(R6),0                                             
*                                                                               
         LA    R6,2(R6)            A(2YR PRIOR AS AT DATE)                      
         GOTO1 DATCON,PLIST,(0,WORK+6),(3,DOUBLE)                               
         ZIC   RF,DOUBLE           EXTRACT YEAR FROM DATE                       
         BCTR  RF,0                SUBTRACT 1 FROM YEAR                         
         STC   RF,DOUBLE           PUT YEAR BACK                                
         GOTO1 DATCON,PLIST,(3,DOUBLE),(0,WORK+6)                               
*                                                                               
         GOTO1 SETASAT,PLIST,(R6),0                                             
         GOTO1 DATCON,PLIST,(0,WORK+6),(3,DOUBLE)                               
         ZIC   RF,DOUBLE           EXTRACT YEAR FROM DATE                       
         LA    RF,3(RF)            ADD 3:  CALCULATE NEXT YEAR                  
*                                                                               
         STC   RF,DOUBLE           PUT YEAR BACK                                
         GOTO1 DATCON,PLIST,(3,DOUBLE),(0,WORK+6)                               
         LA    R6,2(R6)            A(NEXT YEAR AS AT DATE)                      
         GOTO1 SETASAT,PLIST,(R6),0                                             
*                                                                               
         J     EXIT                                                             
         EJECT                                                                  
**********************************************************************          
*  THIS ROUTINE CALCULATES THE MONDAY DATE OF THE NTH WEEK OF THE               
*     BROADCAST YEAR                                                            
*---------------------------------------------------------------------          
SETASAT  NTR1                                                                   
         L     R6,0(R1)            RESET A(MONFORC TABLE ENTRY)                 
         GOTO1 GETBROAD,PLIST,WORK+6,WORK+12                                    
         ZICM  R2,WORK+32,2        INSERT WEEK# OF CURRENT DATE                 
*                                                                               
*   WEEK # IS UNDERSTATED BY 1.  DAYS 1-7 ARE WEEK 1, BUT PERVERT               
*    CALCULATION RETURNS 0.                                                     
*                                                                               
         CHI   R2,52   '           IS CURRENT WEEK # 53?                        
         JNE   SASA0004            NO                                           
         BCTR  R2,0                YES - SET IT TO 52 FOR OTHER YEARS           
SASA0004 EQU   *                                                                
         MHI   R2,7                MULT BY 7 = # OF DAYS                        
         GOTO1 VADDAY,PLIST,WORK+12,WORK+18,(R2)                                
*                                                                               
* GET THE DAY NUMBER FOR THE CURRENT AS-AT DATE                                 
*                                                                               
         GOTO1 VGETDAY,PLIST,WORK,FULL                                          
         CLC   FULL(3),SPACES                                                   
         BNE   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         SR    R2,R2               ADD BACK DAY NUMBER                          
         IC    R2,PLIST            SO ITS THE CORRECT DAY OF WK                 
         BCTR  R2,0                                                             
         GOTO1 VADDAY,PLIST,WORK+18,WORK+18,(R2)                                
*                                                                               
*   FINAL CALL INSERTS MONDAY DATE OF WEEK# INTO MONFOR TABLE                   
*                                                                               
         GOTO1 GETMDAY,PLIST,WORK+18,(R6)                                       
*                                                                               
         J     EXIT                                                             
         LTORG                                                                  
         EJECT                                                                  
**********************************************************************          
*   ROUTINE TO USE OVERALL REQUEST DATES TO ESTABLISH A SINGLE                  
*     MONTH TABLE FOR ALL REPORTS.                                              
* !!!   NOTE    !!!                                                             
*       IF START AND END DATES ARE MORE THAN 6 YEARS APART (72 MOS)             
*       THERE IS A PROBLEM:  TABLE WON'T HANDLE THIS RANGE.  72 MOS,            
*       BEGINNING WITH JANUARY OF THE EARLIEST YEAR REQUESTED, WILL             
*       BE LOADED, AND THE REMAINDER WILL FALL INTO NEVER-NEVER LAND.           
*                                                                               
SETMONTB NTR1  BASE=*,LABEL=*                                                   
         LHI   RF,NEWMONL          L(NEW MONTH TABLE)                           
         L     RE,XNEWMON          A(NEW MONTH TABLE)                           
         XCEFL                                                                  
*                                                                               
*  SET THE ADDRESS OF CONTRACT SPECIFIC INFORMATION INTO THE MIS-               
*    CELLANEOUS STORAGE AREA JUST PRECEDING THE NEW MONTH TABLE.                
*    THIS SERVES AS A FLAG TO VALUENEW TO EXTRACT DATA.                         
*                                                                               
         L     R4,XNEWMON          A(NEW MONTH TABLE)                           
         AHI   R4,-CONSPINF        SET A(CONTRACT SPECIFIC INFO )               
         XC    0(4,R4),0(R4)       LOAD A(CONTRACT SPEC INFO)                   
         ST    RE,0(R4)                                                         
*                                                                               
         L     R4,XNEWMON          RESET A(NEW MONTH TABLE)                     
*        MVC   0(6,R4),SVQSTART    LOAD EARLIEST DATE                           
         GOTO1 DATCON,PLIST,(9,RXUCURST),(0,0(R4))                              
         MVC   2(4,R4),=C'0101'    SET EARLIEST DATE TO JAN/1                   
         LHI   R5,(NEWMONL/NEXTBUCK)-1     # BUCKETS, 1ST LOADED                
SETM0004 EQU   *                                                                
**       CLC   0(4,R4),SVQEND      ALL DATES LOADED?                            
**       BE    SETM0008            YES - NOW SEED OTHER DATES                   
         LA    R6,NEXTBUCK(R4)     SET A(NEXT DATE ENTRY)                       
         GOTO1 VADDAY,DMCB,(R4),(R6),45    CALC MIDDLE OF NEXT MONTH            
         MVC   4(2,R6),=C'01'      SET DAY OF NEXT MONTH                        
         LR    R4,R6                                                            
         BCT   R5,SETM0004         DO NEXT DATE                                 
SETM0008 EQU   *                                                                
         L     R4,XNEWMON          RESET START OF TABLE                         
         MVC   WORK(2),QWCURST     CURRENT START DATE (2-BYTE)                  
         MVC   WORK+1(1),=X'01'    SET MONTH TO 'JAN'                           
SETM0012 EQU   *                                                                
         MVC   8(2,R4),WORK        SET CURRENT START DATE                       
         ZIC   RF,WORK                                                          
         BCTR  RF,0                DECREMENT YEAR BY 1                          
         STC   RF,WORK             TO CALCULATE PRIOR YEAR                      
         MVC   10(2,R4),WORK       SET PRIOR DATE                               
         BCTR  RF,0                SUBTRACT ANOTHER TO CALCULATE                
         STC   RF,WORK             2 YEARS PRIOR                                
         MVC   12(2,R4),WORK       SET 2 YEARS PRIOR                            
         LA    RF,3(RF)            CALCULATE NEXT YEARS DATE                    
         STC   RF,WORK                                                          
         MVC   14(2,R4),WORK       SET NEXT YEARS DATE                          
         CLI   WORK+1,12           IS IT DECEMBER?                              
         BL    SETM0016            NO                                           
**       MVI   WORK+1,1            YES - SET MONTH TO JAN                       
*                                  YEAR IS ALREADY SET TO NEXT YEAR             
SETM0016 EQU   *                                                                
         BCTR  RF,0                DECREMENT NEXT YEAR TO THIS YEAR             
         STC   RF,WORK             RESET YEAR TO CURRENT                        
         ZIC   RF,WORK+1           INCREMENT MONTH                              
         LA    RF,1(RF)                                                         
         STC   RF,WORK+1           RESTORE NEW MONTH                            
*                                                                               
         CLC   QWCURND,WORK        END REACHED?                                 
         BL    SETM0024            YES                                          
         LA    R4,NEXTBUCK(R4)     NO  - NEXT TABLE ENTRY                       
         B     SETM0012            GO BACK AND DO NEXT                          
SETM0024 EQU   *                                                                
         J     EXIT                                                             
XNEWMON  DC    A(NEWMON)           NEWMON TABLE                                 
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* LITERALS AND CONSTANTS REQUIRED FOR ALL ROUTINES                    *         
***********************************************************************         
         SPACE 1                                                                
LITERAL  DS    0D                                                               
GETBROAD DC    V(GETBROAD)                                                      
DATCON   DC    V(DATCON)                                                        
VGETDAY  DC    V(GETDAY)                                                        
VADDAY   DC    V(ADDAY)                                                         
VLOADER  DC    V(LOADER)                                                        
COMFACS  DC    V(COMFACS)                                                       
VALU3NEW DC    V(VALU3NEW)                                                      
DEMOCON  DC    A(0)                                                             
ANEXT    DC    F'0'                                                             
*                                                                               
SPACES   DC    CL60' '                                                          
*                                                                               
*RXRECID                                                                        
       ++INCLUDE RXRECID                                                        
*                                                                               
LOADER   ICM   RF,15,DEMOCON                                                    
         BNZR  RE                                                               
         NTR1  ,                                                                
         MVC   WORK,=CL8'T00AE0'                                                
         XC    PLIST(6*4),PLIST                                                 
         GOTO1 VLOADER,PLIST,WORK,0                                             
         MVC   DEMOCON,4(R1)                                                    
         J     EXIT                                                             
*                                                                               
*GETEL                                                                          
         GETEL R6,=Y(RCONELEM-RCONREC),ELCODE                                   
         SPACE 2                                                                
*MXTRT                                                                          
       ++INCLUDE MXTRT                                                          
*                                                                               
***********************************************************************         
*        GETMDAY ROUTINE RETURNS MONDAY DATE FOR WEEK GIVEN                     
*                INPUT = YYMMDD                                                 
*                OUTPUT= 2-BYTE BINARY                                          
*----------------------------------------------------------------------         
         SPACE                                                                  
GETMDAY  NTR1  BASE=*,LABEL=*                                                   
         LM    R5,R6,0(R1)         R5=A(INPUT), R6=A(OUTPUT)                    
*                                                                               
         J     NOPMDAY             NOP OP ROUTINE FOR DAILY PACING              
*                                                                               
         CLC   0(6,R5),=C'940229' ****2YR PRIOR OF LEAP YR 96 ****              
         BE    GETM10                                                           
         CLC   0(6,R5),=C'950229' ****PRIOR YEAR FOR LEAP YR 96 ****            
         BE    GETM10                                                           
         CLC   0(6,R5),=C'970229' ****NEXT YEAR FOR LEAP YR 96 ****             
         BE    GETM10                                                           
         CLC   0(6,R5),=C'980229' ****2YR PRIOR OF LEAP YR 00 ****              
         BE    GETM10                                                           
         CLC   0(6,R5),=C'990229' ****PRIOR YEAR FOR LEAP YR 00 ****            
         BE    GETM10                                                           
         CLC   0(6,R5),=C'010229' ****NEXT YEAR FOR LEAP YR 00 ****             
         BE    GETM10                                                           
         CLC   0(6,R5),=C'020229' ****2YR PRIOR OF LEAP YR 04 ****              
         BE    GETM10                                                           
         CLC   0(6,R5),=C'030229' ****PRIOR YEAR FOR LEAP YR 04 ****            
         BE    GETM10                                                           
         CLC   0(6,R5),=C'050229' ****NEXT YEAR FOR LEAP YR 04 ****             
         BNE   GETM12                                                           
GETM10   EQU   *                                                                
         MVC   3(3,R5),=C'301'     ***PREVIOUS YEAR MUST BE MARCH 01***         
GETM12   EQU   *                                                                
         GOTO1 VGETDAY,PLIST,(R5),FULL                                          
         CLC   FULL(3),SPACES                                                   
         BNE   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         SR    RE,RE                                                            
         IC    RE,PLIST            DAY NUMBER                                   
         BCTR  RE,R0                                                            
         LNR   RE,RE                                                            
         ST    RE,PLIST+8          PUT IN NUMBER OF DAYS TO SUBTRACT            
*                                                                               
*   SET A PROFILE TEST HERE:  ONLY 'DAILY PACING' USERS SHOULD DO THE           
*        FOLLOWING RESET.  RIGHT NOW, EVERYONE WILL DO IT.                      
*                                                                               
NOPMDAY  DS    0H                                                               
         XC    PLIST+8(4),PLIST+8  CLEAR THE DAY ADJUSTMENT                     
*                                                                               
         GOTO1 VADDAY,PLIST,(R5),DUB                                            
*                                                                               
         GOTO1 DATCON,(R1),DUB,(2,(R6))                                         
*                                                                               
         J     EXIT                                                             
         LTORG                                                                  
         SPACE 3                                                                
         DC    CL8'BUFFER01'                                                    
BUFFER1  DC    3000XL8'00'         HOLDS RECORDS FOR WRITING TO FILE            
BUFFER1L EQU   *-BUFFER1                                                        
         DC    8X'FF'                                                           
         DC    CL8'*NEWMON*'                                                    
CONSPEC  DC    (64)X'00'                                                        
CONSPECX DC    (CONSPINF)X'00'                                                  
NEWMON   DC    (13*NEXTBUCK)X'00'  13 MONTH TABLE FOR VALU3NEW                  
NEWMONL  EQU   *-NEWMON                                                         
         DC    (NEXTBUCK)X'00'                                                  
*                                                                               
***********************************************************************         
* RRG/QWKD DATE AREA CSECT                                                      
***********************************************************************         
         DS    0L                                                               
         DC    CL16'**QWK*QWK**QWK**'                                           
RXQWK    CSECT                                                                  
         DC    (QWEND-QWKD)X'00'                                                
         EJECT                                                                  
***********************************************************************         
* WORKING STORAGE REQUIREMENTS                                        *         
***********************************************************************         
         SPACE 1                                                                
WORKD    DSECT                                                                  
DUB      DS    D                                                                
DOUBLE   DS    D                                                                
APARM    DS    A                   A(PARAMETER LIST)                            
*                                                                               
PARM     DS    0XL24               PARAMETER LIST                               
AXREC    DS    A                   A(EXTRACT RECORD)                            
RFREC    DS    A                   A(REPFILE RECORD)                            
         DS    A                                                                
         DS    A                                                                
         DS    A                                                                
         DS    A                                                                
*                                                                               
DMCB     DS    0F                                                               
PLIST    DS    6F                                                               
ADCONLST DS    0A                  FORCE RESETVAL TO ASSEMBLE                   
VSPNDCTL DS    A                   USED BY RESETVAL TO FIND STATION REC         
ASTAREC  DS    A                                                                
FULL     DS    F                                                                
HALF     DS    H                                                                
ELCODE   DS    X                                                                
KILLMODE DS    C                                                                
*                                                                               
WORK     DS    XL256                                                            
         DS    XL024               DBLOCK IS BUILT AT WORK+10 FOR 280           
*                                                                               
ADCONSD  DS    0A                                                               
*                                                                               
WORKL    EQU   *-WORKD                                                          
         EJECT                                                                  
***********************************************************************         
* OTHER INCLUDED DSECTS                                               *         
***********************************************************************         
         SPACE 1                                                                
*RXUSERD                                                                        
       ++INCLUDE RXUSERD                                                        
*RXRECD                                                                         
       ++INCLUDE RXRECD                                                         
*DXDSECTS                                                                       
       ++INCLUDE DXDSECTS                                                       
*REGENALL1A                                                                     
*REGENDCT                                                                       
*REGENDSP                                                                       
*REGENAGY2                                                                      
*DEDBLOCK                                                                       
*FASYSFAC                                                                       
*REREPQWKDD                                                                     
*REREPRGEQB                                                                     
         PRINT OFF                                                              
       ++INCLUDE REGENALL1A                                                     
       ++INCLUDE REGENDCT                                                       
       ++INCLUDE REGENDSP                                                       
       ++INCLUDE REGENAGY2                                                      
       ++INCLUDE DEDBLOCK                                                       
       ++INCLUDE FASYSFAC                                                       
       ++INCLUDE REREPQWKDD                                                     
       ++INCLUDE REREPRGEQB                                                     
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'053RXROUTSS  02/06/03'                                      
         END                                                                    
