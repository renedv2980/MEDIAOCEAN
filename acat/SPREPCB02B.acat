*          DATA SET SPREPCB02B AT LEVEL 014 AS OF 10/18/05                      
*CATALP SPCB02B                                                                 
        TITLE  'SPREPCB02B - COMPARATIVE BUYING REPORT - OUTPUT PHASE'          
*                                                                               
*        INPUT PARAMETERS: 0(R1) = A(SPOT WORKING STORAGE)                      
*                          4(R1) = A(SPCBWORK)                                  
*                                                                               
         SPACE                                                                  
SPCB02B  CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 0,SPCB2B,RC                                                      
         LA    RC,2048(RB)                                                      
         LA    RC,2048(RC)                                                      
*                                                                               
         L     RA,0(R1)                                                         
         LA    R9,2048(RA)                                                      
         LA    R9,2048(R9)                                                      
         USING SPWORKD,RA,R9                                                    
*                                                                               
         L     R8,4(R1)                                                         
         USING CBWORKD,R8                                                       
*                                                                               
         LA    R1,RCDTA            CLEAR THOSE STORAGE AREAS                    
         LA    R0,RCDTAX                                                        
         BAS   RE,CLEAR                                                         
         LA    R1,TOTALS                                                        
         LA    R0,TOTALSX                                                       
         BAS   RE,CLEAR                                                         
         LA    R1,BRCNTRS                                                       
         LA    R0,BRCNTRSX                                                      
         BAS   RE,CLEAR                                                         
*                                                                               
         LA    RE,P                                                             
         ST    RE,AP                                                            
         ST    RE,PNEXT                                                         
         MVI   MAXLINES,58                                                      
         XC    EBLOCK,EBLOCK                                                    
         MVI   EBLIN,4                                                          
         MVI   EBTIN,C'B'                                                       
*                                                                               
         BAS   RE,SETHEAD          SET THE HEADLINES FOR THE REPORT             
         MVI   FORCEHED,C'Y'                                                    
         MVC   PAGE,=H'1'                                                       
         LH    R1,CBHIROW                                                       
         LA    R1,1(R1)                                                         
         STC   R1,BRNUM                                                         
         LH    R1,CBHIROW                                                       
         BCTR  R1,0                                                             
         STC   R1,SPCLEVEL         SET SPACING LEVEL FOR TOTALS                 
         MVI   NOTOTLVL,0          INIT NO TOTAL LEVEL                          
*                                                                               
         GOTO1 CBSORTER,DMCB,=C'GET',0   GET SORTER RECORDS                     
         ICM   R7,15,4(R1)                                                      
         BZ    EOJ                                                              
         MVI   EOF,C'N'                                                         
         MVC   CBREC(CBRECLEN),0(R7)                                            
         MVI   BRLEVEL,1                                                        
         BAS   RE,BRFIRST          GIVE ALL LEVEL FIRSTS                        
         LH    R3,CBCMPRLN         KEY COMPARE LEN -1                           
*                                                                               
CB010    BAS   RE,POST             POST THE RECORD                              
         GOTO1 CBSORTER,DMCB,=C'GET',0   GET NEXT SORTED RECORD                 
         ICM   R7,15,4(R1)                                                      
         BNZ   CB012                                                            
         MVI   EOF,C'Y'            EOF - SET NEWREC TO HIGHVALS                 
         MVI   NEWREC,X'FF'                                                     
         MVC   NEWREC+1(CBRECLEN-1),NEWREC                                      
         B     CB015                                                            
*                                                                               
CB012    MVC   NEWREC(CBRECLEN),0(R7)                                           
         EX    R3,CLCREC           TEST FOR CONTROL BREAK                       
         BE    CB020                                                            
*                                                                               
CB015    MVC   BRLEVEL,BRNUM       SET CONTROL BREAK LEVEL + 1                  
         MVI   PRINTSW,C'Y'                                                     
         B     CB030                                                            
*                                                                               
CB020    MVC   CBREC,NEWREC        MOVE NEW RECORD TO RECORD                    
         B     CB010               AND CONTINUE                                 
*                                                                               
CLCREC   CLC   CBREC(0),NEWREC     EXECUTED                                     
         EJECT                                                                  
*                                                                               
*        PROCESS A CONTROL BREAK                                                
*                                                                               
CB030    ZIC   R5,BRLEVEL          GET HIGH ROW NUMBER                          
         BCTR  R5,0                DECREMENT                                    
         STC   R5,BRLEVEL          SET ROW NUMBER THIS CONTROL BREAK            
*                                                                               
         BAS   RE,FMT              FORMAT DATA                                  
         CLI   PRINTSW,C'N'                                                     
         BE    CB035                                                            
         CH    R5,CBHIROW          TEST FOR PRIMARY CONTROL BREAK               
         BNL   CB035                                                            
         GOTO1 REPORT              NO - PRINT THE PRINT BLOCK                   
         MVC   PNEXT,AP                                                         
*                                                                               
CB035    LR    RE,R5               GET ROW NUMBER                               
         BCTR  RE,0                                                             
         SLL   RE,2                X 4                                          
         LA    R1,RCDTA            GET ROW SPEC ADDRESS                         
*                                                                               
CB040    CLI   0(R1),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLM   RE,1,0(R1)                                                       
         BE    CB050                                                            
         LA    R1,8(R1)                                                         
         B     CB040                                                            
*                                                                               
CB050    L     RF,0(R1)                                                         
         TM    SPECIND-SPECDATA(RF),PL   TEST FOR PRINTLINE                     
         BO    CB060                                                            
         LR    RF,R5                     NO - ROW IS A HEADLINE                 
         BCTR  RF,0                                                             
         MH    RF,=H'132'                                                       
         LA    RF,HEAD4(RF)        FIRST HEADLINE ROW IS H4                     
         MVC   0(132,RF),SPACES    BLANK THE HEADLINE DATA                      
         MVI   FORCEHED,C'Y'       FORCE NEW PAGE                               
*                                                                               
CB060    LTR   RE,RE               TEST FOR FIRST ROW CONTROL BREAK             
         BZ    CB070               YES - NO MORE CONTROL BREAKS POSS            
         BCTR  RE,0                                                             
         EX    RE,CLCREC           TEST FURTHER CONTROL BREAK                   
         BNE   CB080               YES                                          
*                                                                               
CB070    CLI   EOF,C'Y'            TEST FOR END OF DATA                         
         BE    CB100                                                            
         MVC   CBREC,NEWREC        MOVE TO PROCESS                              
         CLI   FORCEHED,C'Y'                                                    
         BE    CB075                                                            
         CLC   BRLEVEL,CBHIROW+1   TEST FOR PRIMARY CONTROL BREAK ONLY          
         BNL   CB075                                                            
         GOTO1 REPORT              NO - SPACE A LINE                            
*                                                                               
CB075    BAS   RE,BRFIRST          INITIALIZE FOR NEW RECORD                    
         B     CB010               AND GO PROCESS                               
*                                                                               
CB080    LR    R4,R5               GET DSP INTO REC FOR FURTHER                 
         BCTR  R4,0                 CONTROL BREAK                               
         SLL   R4,2                                                             
         LA    R1,RCDTA                                                         
*                                                                               
CB090    CLI   0(R1),X'FF'         FIND SPEC FOR FURTHER CONTROL BREAK          
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLM   R4,1,0(R1)                                                       
         BE    CB092                                                            
         LA    R1,8(R1)                                                         
         B     CB090                                                            
*                                                                               
CB092    CLC   BRLEVEL,NOTOTLVL    TEST FOR NO TOTAL LINE                       
         BE    CB094                                                            
         L     R2,0(R1)                                                         
         USING SPECD,R2                                                         
         TM    SPECIND,PL          TEST FOR PRINT LINE                          
         BO    CB096                                                            
*                                                                               
CB094    MVI   PRINTSW,C'N'        NO - DON'T PRINT TOTALS LINE                 
         B     CB030                                                            
*                                                                               
CB096    L     RE,PNEXT                                                         
         CH    R5,CBHIROW          TEST FOR PRIMARY CONTROL BREAK               
         BNL   CB098                                                            
         MVI   0(RE),0             NO - SPACE ONE LINE                          
         LA    RE,132(RE)                                                       
         ST    RE,PNEXT                                                         
*                                                                               
CB098    ZIC   RF,4(R1)            PRINT LINE DISPLACEMENT                      
         AR    RF,RE                                                            
         MVC   0(5,RF),=C'*ALL*'                                                
         B     CB030                                                            
*                                                                               
CB100    B     EOJ                                                              
*                                                                               
*                                                                               
EOJ      B     EXIT                                                             
*                                                                               
EXIT     XIT1                                                                   
         EJECT                                                                  
SETHEAD  NTR1                                                                   
*                                                                               
*        ROUTINE TO SET THE HEADLINES                                           
*                                                                               
         MVI   CLEARHED,C'N'       SUPPRESS HEADLINE CLEARING                   
         LA    R0,14                                                            
         LA    R1,HEAD1                                                         
*                                                                               
SH005    MVC   0(132,R1),SPACES    CLEAR THE HEADLINES                          
         LA    R1,132(R1)                                                       
         BCT   R0,SH005                                                         
*                                                                               
         SR    RE,RE               CLEAR MAX ROW TITLE LENGTH                   
         SR    RF,RF               CLEAR MAX ROW CODE LENGTH                    
         LA    R1,CBSPECS                                                       
         USING SPECD,R2                                                         
*                                                                               
SH010    CLI   0(R1),X'FF'         TEST FOR END OF SPECS                        
         BE    SH030                                                            
         OC    0(4,R1),0(R1)       TEST FOR HOLE                                
         BZ    SH020                                                            
         L     R2,0(R1)                                                         
         TM    SPECIND,SUPPRESS    TEST FOR SUPPRESSED SPEC                     
         BO    SH020                                                            
         TM    SPECIND,PL          TEST FOR HEADLINE SPEC                       
         BO    SH020                                                            
         CLM   RE,1,SPECTLEN                                                    
         BNL   *+8                                                              
         ZIC   RE,SPECTLEN                                                      
         CLM   RF,1,SPECCLEN                                                    
         BNL   SH020                                                            
         ZIC   RF,SPECCLEN                                                      
*                                                                               
SH020    LA    R1,4(R1)                                                         
         B     SH010                                                            
*                                                                               
SH030    STC   RE,MAXTTL           SET MAX ROW TITLE LENGTH                     
         STC   RF,MAXCOD           SET MAX ROW CODE LENGTH                      
*                                                                               
         XC    RCDTA,RCDTA         CLEAR MY SPEC AREA                           
         LA    R3,RCDTA                                                         
         LA    R1,CBSPECS                                                       
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         MVI   DEMNFND,C'N'                                                     
         USING SPECD,R2                                                         
*                                                                               
SH040    CLI   0(R1),X'FF'         TEST FOR END OF SPECS                        
         BE    SH080                                                            
         OC    0(4,R1),0(R1)       TEST FOR HOLE                                
         BZ    SH075                                                            
         L     R2,0(R1)            LOAD SPEC ADDR                               
*                                                                               
         CLI   SPECDATA,SPECMGR1   SORT OUT MARKET AND PRODUCT GROUPS           
         BNE   *+14                MARKET GROUP 1                               
         MVC   SPECTITL(L'MGR1BK),MGR1BK                                        
         B     SH045                                                            
         CLI   SPECDATA,SPECMGR2   MARKET GROUP 2                               
         BNE   *+14                                                             
         MVC   SPECTITL(L'MGR2BK),MGR2BK                                        
         B     SH045                                                            
         CLI   SPECDATA,SPECMGR3   MARKET GROUP 3                               
         BNE   *+14                                                             
         MVC   SPECTITL(L'MGR3BK),MGR3BK                                        
         B     SH045                                                            
         CLI   SPECDATA,SPECPGR1   PRODUCT GROUP 1                              
         BNE   *+14                                                             
         MVC   SPECTITL(L'PGR1BK),PGR1BK                                        
         B     SH045                                                            
         CLI   SPECDATA,SPECPGR2   PRODUCT GROUP 2                              
         BNE   *+14                                                             
         MVC   SPECTITL(L'PGR2BK),PGR2BK                                        
         B     SH045                                                            
*                                                                               
         CLI   SPECDATA,SPECDM1    SORT OUT DEMOS                               
         BL    SH045                                                            
         CLI   SPECDATA,SPECDM4                                                 
         BH    SH045                                                            
         CLI   DEMNFND,C'Y'        TEST FOR DEMO NAMES FOUND                    
         BE    SH042                                                            
         BAS   RE,GETDEMS          GET THE DEMO NAMES                           
         MVI   DEMNFND,C'Y'                                                     
*                                                                               
SH042    ZIC   RE,SPECDATA         FIND THE RIGHT DEMO NAME                     
         LA    RF,SPECDM1                                                       
         SR    RE,RF                                                            
         MH    RE,=H'7'                                                         
         LA    RE,DMNAMES(RE)                                                   
         MVI   BYTE,C'P'           DEFAULT IS CPP                               
         OC    0(7,RE),0(RE)                                                    
         BZ    SH045                                                            
         CLI   0(RE),C'R'          IF RATING, THEN CPP                          
         BE    *+8                                                              
         MVI   BYTE,C'M'           OTHERWISE, IT'S CPM                          
         LR    RF,RE                                                            
         LA    R4,7                                                             
*                                                                               
SH043    CLI   0(RF),0             MOVE IT RIGHT ALIGNED TO TITLE               
         BE    SH044                                                            
         CLI   0(RF),C' '                                                       
         BE    SH044                                                            
         LA    RF,1(RF)                                                         
         BCT   R4,SH043                                                         
*                                                                               
SH044    LA    RF,SPECTITL(R4)                                                  
         LA    R5,6                                                             
         SR    R5,R4                                                            
         BM    SH045                                                            
         MVC   SPECTITL(7),SPACES   CLEAR TITLE BEFORE MOVING NEW ONE           
         EX    R5,SHTITMVC                                                      
         B     SH045                                                            
*                                                                               
SHTITMVC MVC   0(0,RF),0(RE)       EXECUTED                                     
*                                                                               
SH045    CLI   SPECDATA,SPECCP1    SORT OUT CPP SPECS                           
         BL    SH048                                                            
         CLI   SPECDATA,SPECCP4                                                 
         BH    SH048                                                            
         ZIC   RF,SPECTLEN                                                      
         BCTR  RF,0                                                             
         LA    RE,SPECTITL(RF)                                                  
*                                                                               
SH046    CLI   0(RE),C' '          MOVE P OR M TO LAST NON-BLANK                
         BH    SH047                CHARACTER OF TITLE                          
         BCTR  RE,0                                                             
         BCT   RF,SH046                                                         
*                                                                               
SH047    MVC   0(1,RE),BYTE                                                     
*                                                                               
SH048    MVC   0(4,R3),0(R1)       MOVE SPEC ADDR                               
         TM    SPECIND,PL          TEST PRINTLINE SPEC                          
         BZ    SH070               NO - NO NEED FOR ROW/COL WIDTH               
         TM    SPECIND,SUPPRESS    TEST SUPRESSED ROW                           
         BO    SH070               YES - NO WIDTH                               
         TM    SPECDATA,X'80'      TEST FOR COLUMN                              
         BO    SH060                                                            
         IC    RE,SPECCLEN         DETERMINE ROW WIDTH - CODE ONLY              
         CLI   SPECDATA,SPECMKT    TEST FOR MARKET ROW                          
         BNE   SH050                                                            
         IC    RF,SPECNLEN         YES - CODE AND NAME                          
         LA    RE,1(RF,RE)                                                      
*                                                                               
SH050    IC    RF,SPECTLEN         COMPARE AGAINST TITLE LENGTH                 
         CR    RE,RF                                                            
         BNL   *+6                 TAKE THE LARGER                              
         LR    RE,RF                                                            
         STC   RE,4(R3)            ROW WIDTH                                    
         B     SH070                                                            
*                                                                               
SH060    MVC   4(1,R3),SPECTLEN    COL WIDTH IS TITLE LENGTH                    
*                                                                               
SH070    LA    R3,8(R3)                                                         
*                                                                               
SH075    LA    R1,4(R1)                                                         
         B     SH040                                                            
*                                                                               
SH080    MVI   0(R3),X'FF'         SET END OF SPECS                             
         EJECT                                                                  
*                                                                               
*        FIND OUT LENGTH OF PRINT LINE                                          
*                                                                               
         LA    R0,CBROWMAX+CBCOLMAX                                             
         LA    RF,RCDTA                                                         
         SR    R1,R1                                                            
         SR    RE,RE                                                            
*                                                                               
SH110    CLI   0(RF),X'FF'                                                      
         BE    SH120                                                            
         ICM   RE,1,4(RF)                                                       
         BZ    *+10                                                             
         AR    R1,RE               ADD LENGTH OF THIS FIELD                     
         LA    R1,2(R1)              + 2 SPACES BETWEEN                         
         LA    RF,8(RF)                                                         
         BCT   R0,SH110                                                         
*                                                                               
SH120    BCTR  R1,0                ADJUST FOR FINAL SPACE                       
*                                                                               
         CH    R1,=H'255'                                                       
         BNH   *+6                                                              
         DC    H'0'                                                             
         LA    RE,132                                                           
         SR    RE,R1                                                            
         BNM   *+6                                                              
         DC    H'0'                TOO MUCH PRINT LINE DATA                     
         LA    RE,1(RE)            ROUND UP                                     
         SRL   RE,1                GIVES LEFTMOST PRINT DSPL                    
         STC   RE,MARGIN           SAVE IT                                      
*                                                                               
         XC    BXCOL,BXCOL                                                      
         IC    RE,MARGIN                                                        
         LA    RE,BXCOL-1(RE)                                                   
         MVI   0(RE),C'L'          SET LEFT HAND BOX COL                        
         LA    RE,1(R1,RE)                                                      
         MVI   0(RE),C'R'          SET RIGHT HAND BOX COL                       
*                                                                               
         L     R4,ABOX             TURN BOXES ON NOW                            
         USING BOXD,R4                                                          
         MVC   BOXROWS,BXROW                                                    
         MVI   BOXWT,1                                                          
         MVI   BOXYORN,C'Y'                                                     
         MVI   BOXOFF,0                                                         
         MVI   BOXINIT,0                                                        
         EJECT                                                                  
*                                                                               
*        SET ACTUAL PRINT LINE DISPLACEMENTS                                    
*                                                                               
         LA    R0,CBROWMAX+CBCOLMAX                                             
         LA    RF,RCDTA                                                         
         ZIC   R1,MARGIN           GET LEFTMOST COL                             
         SR    RE,RE                                                            
*                                                                               
SH140    CLI   0(RF),X'FF'                                                      
         BE    SH150                                                            
         ICM   RE,1,4(RF)          MOVE FIELD LENGTH                            
         BZ    SH145               ZERO - IT'S A HEADLINE OR SUPPRESSED         
         STC   R1,4(RF)            SET DISPLACEMENT                             
         AR    R1,RE                                                            
         LA    R1,2(R1)            TWO COLS BETWEEN FIELDS                      
*                                                                               
SH145    LA    RF,8(RF)                                                         
         BCT   R0,SH140                                                         
*                                                                               
SH150    LA    RF,RCDTA                                                         
*                                                                               
SH155    CLI   0(RF),CBKEYLEN      FIND FIRST COL                               
         BE    SH160                                                            
         LA    RF,8(RF)                                                         
         CLI   0(RF),X'FF'                                                      
         BNE   SH155                                                            
         DC    H'0'                                                             
*                                                                               
SH160    IC    RE,4(RF)            DISPLACEMENT OF FIRST COL                    
         LA    RE,BXCOL-1(RE)                                                   
         MVI   0(RE),C'C'          SET ROW/COL DIVIDER                          
         MVC   BOXCOLS(L'BXCOL),BXCOL                                           
         EJECT                                                                  
*                                                                               
*        MOVE TITLES OF PRINT LINES TO HEADLINES                                
*                                                                               
         LA    R3,RCDTA                                                         
         LA    R0,CBROWMAX+CBCOLMAX                                             
         SR    RE,RE                                                            
*                                                                               
SH170    CLI   0(R3),X'FF'                                                      
         BE    SH200                                                            
         CLI   4(R3),0             TEST FOR HEADLINE                            
         BE    SH190                                                            
         ZIC   R1,4(R3)            GET PRINT DSPL                               
         L     R2,0(R3)            GET SPEC ADDR                                
         LA    R1,HEAD11(R1)       POINT TO HEADLINE POSITION                   
         ZIC   RE,SPECTLEN         GET TITLE LENGTH                             
         BCTR  RE,0                                                             
         LA    RF,SPECTITL                                                      
         EX    RE,MOVETITL         MOVE TITLE TO HEADLINE                       
*                                                                               
SH190    LA    R3,8(R3)                                                         
         BCT   R0,SH170                                                         
*                                                                               
SH200    B     EXIT                                                             
*                                                                               
*                                                                               
MOVETITL MVC   0(0,R1),0(RF)       EXECUTED                                     
         EJECT                                                                  
GETDEMS  NTR1                                                                   
*                                                                               
*        ROUTINE TO GET THE DEMO NAMES                                          
*                                                                               
         L     R3,PRDBUFF                                                       
         LA    R3,28(R3)           POINT TO FIRST PRODUCT                       
         LA    RE,220                                                           
         CLC   QPRD,=C'POL'        PRODUCT POOL                                 
         BE    GD004                                                            
         CLC   QPRD,=C'ALL'                                                     
         BE    GD010                                                            
         L     R1,ADCLT            SINGLE PRODUCT                               
         LA    R1,CLIST-CLTHDRD(R1)                                             
*                                                                               
GD002    CLC   0(3,R1),SPACES                                                   
         BH    *+6                                                              
         DC    H'0'                                                             
         CLC   QPRD,0(R1)                                                       
         BE    *+12                                                             
         LA    R1,4(R1)                                                         
         B     GD002                                                            
         ZIC   RE,3(R1)                                                         
*                                                                               
GD004    BCTR  RE,0                                                             
         MH    RE,PRDBUFLN                                                      
         LA    R3,0(RE,R3)         POINT TO PRODUCT POOL DEMO NUMBERS           
*                                                                               
GD010    XC    DMNAMES,DMNAMES                                                  
         XC    DBLOCK,DBLOCK                                                    
         MVI   DBFUNCT,DBGETDEM                                                 
         MVI   DBTPTT,C'T'                                                      
         MVC   DBCOMFCS,ACOMFACS                                                
         MVC   DBFILE,=C'TP '                                                   
         MVI   DBSELMED,C'T'                                                    
         L     R4,ADEST                                                         
         USING ESTHDRD,R4                                                       
         LA    R4,EUSRNMS                                                       
         DROP  R4                  GET THE DEMO NAMES                           
         GOTO1 DEMOCON,DMCB,(4,(R3)),(2,DMNAMES),(C'S',DBLOCK),        X        
               (SPOTPROF+9,(R4))                                                
         B     EXIT                                                             
         EJECT                                                                  
BRFIRST  NTR1                                                                   
*                                                                               
*        ROUTINE TO PROCESS 'FIRSTS' FOR ROWS FROM BRLEVEL TO LAST ROW          
*                                                                               
BR005    ZIC   R7,BRLEVEL                                                       
         BCTR  R7,0                                                             
         SLL   R7,2                GET DISPLACEMENT INTO RECORD                 
         LA    R1,RCDTA                                                         
*                                                                               
BR007    CLI   0(R1),X'FF'         FIND SPEC FOR THIS LEVEL                     
         BE    BRNEXT                                                           
         CLM   R7,1,0(R1)                                                       
         BE    BR008                                                            
         LA    R1,8(R1)                                                         
         B     BR007                                                            
*                                                                               
BR008    L     R2,0(R1)                                                         
         TM    SPECIND,SUPPRESS    IGNORE SUPPRESSED ROWS                       
         BO    BRNEXT                                                           
         L     RE,BRCNTRS(R7)                                                   
         LA    RE,1(RE)                                                         
         ST    RE,BRCNTRS(R7)                                                   
         LA    R6,CBREC(R7)        POINT TO ROW CODE IN RECORD                  
         BAS   RE,GETNAME                                                       
         TM    SPECIND,PL                                                       
         BO    BR050               PRINTLINE                                    
         EJECT                                                                  
*                                                                               
*        HEADLINE ROW                                                           
*                                                                               
         MVI   FORCEHED,C'Y'                                                    
         ZIC   R4,BRLEVEL                                                       
         BCTR  R4,0                                                             
         MH    R4,=H'132'                                                       
         LA    R4,HEAD4(R4)        ROW 1 DATA GOES ON HEAD 4                    
         ZIC   RE,SPECTLEN         GET TITLE DATA LENGTH                        
         LTR   RE,RE                                                            
         BZ    BR020                                                            
         BCTR  RE,0                                                             
         EX    RE,BRMOVE                                                        
         B     BR020                                                            
*                                                                               
BRMOVE   MVC   0(0,R4),SPECTITL    EXECUTED                                     
*                                                                               
BR020    IC    RE,MAXTTL           GET MAX TITLE LENGTH                         
         LA    R4,1(RE,R4)         SET NEXT OUTPUT POSITION                     
         IC    RE,MAXCOD                                                        
         BCTR  RE,0                                                             
         EX    RE,BRMOVE2                                                       
         B     BR030                                                            
*                                                                               
BRMOVE2  MVC   0(0,R4),WORK                                                     
*                                                                               
BR030    LA    R4,2(R4,RE)         SET NEXT OUTPUT POSITION                     
         EX    RE,BRMOVE3                                                       
         B     BRNEXT                                                           
*                                                                               
BRMOVE3  MVC   0(24,R4),WORK+8     NAME LENGTH MAX IS 24                        
         EJECT                                                                  
BR050    DS    0H                                                               
*                                                                               
*        PRINT LINE ROW                                                         
*                                                                               
         ZIC   RE,4(R1)            DISPLACEMENT TO ROW                          
         L     R4,PNEXT                                                         
         AR    R4,RE               PRINT LINE ADDR                              
         LA    R5,4                                                             
         CLC   WORK(5),=C'*ALL*'                                                
         BE    BR060                                                            
         ZIC   R5,SPECCLEN                                                      
         CLI   SPECDATA,SPECMKT                                                 
         BE    *+10                                                             
         BCTR  R5,0                                                             
         B     BR060                                                            
         GOTO1 SQUASHER,DMCB,WORK,64   SQUASH PRINT LINE                        
         ZIC   RE,SPECNLEN                                                      
         AR    R5,RE                                                            
*                                                                               
BR060    EX    R5,BRMOVE2                                                       
*                                                                               
BRNEXT   ZIC   RE,BRLEVEL                                                       
         LA    RE,1(RE)                                                         
         STC   RE,BRLEVEL                                                       
         CLC   BRLEVEL,CBHIROW+1   PROCESS ALL ROWS                             
         BNH   BR005                                                            
*                                                                               
BR999    B     EXIT                                                             
         EJECT                                                                  
GETNAME  NTR1                                                                   
*                                                                               
*        ROUTINE TO BUILD PRINTABLE CODES AND EXTRACT NAMES AS REQUIRED         
*        R6 = A(ROW IN RECORD)                                                  
*        PRINTABLE DATA IS RETURNED IN WORK(64)                                 
*                                                                               
         MVC   WORK,SPACES                                                      
         LA    R1,GETTAB                                                        
*                                                                               
GN010    CLI   0(R1),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLC   SPECDATA,0(R1)                                                   
         BE    GN020                                                            
         LA    R1,4(R1)                                                         
         B     GN010                                                            
*                                                                               
GN020    ICM   RF,7,1(R1)                                                       
         BZ    GETNAMX                                                          
         BR    RF                  GO                                           
*                                                                               
GETOFC   MVC   WORK(2),0(R6)       OFFICE                                       
         B     GETNAMX                                                          
*                                                                               
GETCLINT MVC   WORK(3),CLT                                                      
         MVC   WORK+8(24),CLTNM                                                 
         B     GETNAMX                                                          
*                                                                               
GETMGR   XC    KEY,KEY                                                          
         MVC   KEY(2),=X'0D02'                                                  
         MVC   KEY+2(1),BAGYMD                                                  
         CLI   QMGR,C'F'                                                        
         BH    GETMGR2                                                          
         LH    RF,CBDSPCLT                                                      
         LA    RF,CBREC(RF)                                                     
         MVC   KEY+3(2),0(RF)      MGR A-F NEED CLIENT                          
*                                                                               
GETMGR2  MVC   KEY+8(1),QMGR                                                    
         CLC   0(2,R6),=X'9999'                                                 
         BE    GETMGR4                                                          
         MVC   KEY+9(2),0(R6)                                                   
         GOTO1 HIGH                                                             
         CLC   KEY(13),KEYSAVE                                                  
         BE    *+6                                                              
         DC    H'0'                                                             
         GOTO1 GETMKTGR                                                         
         MVC   WORK(5),MGR1                                                     
         MVC   WORK+8(24),MGR1NM                                                
         CLI   SPECDATA,SPECMGR1                                                
         BE    GETMGR6                                                          
         MVC   WORK(5),MGR2                                                     
         MVC   WORK+8(24),MGR2NM                                                
         CLI   SPECDATA,SPECMGR2                                                
         BE    GETMGR6                                                          
         MVC   WORK(5),MGR3                                                     
         MVC   WORK+8(24),MGR3NM                                                
         CLI   SPECDATA,SPECMGR3                                                
         BE    GETMGR6                                                          
         DC    H'0'                                                             
*                                                                               
GETMGR4  MVC   WORK+1(4),=C'9999'                                               
         MVC   WORK+8(24),BADNAME                                               
*                                                                               
GETMGR6  TM    SPECIND,PL                                                       
         BZ    GETNAMX                                                          
         XC    WORK+8(24),WORK+8                                                
         B     GETNAMX                                                          
*                                                                               
GETMKT   MVC   KEY,C'0'                                                         
         MVC   KEY+1(16),KEY                                                    
         MVI   KEY,C'M'                                                         
         MVC   KEY+1(1),QMED                                                    
         SR    R0,R0                                                            
         ICM   R0,3,0(R6)                                                       
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  KEY+2(4),DUB                                                     
         MVC   WORK(4),KEY+2       MARKET CODE                                  
         MVC   KEY+6(2),QAGY                                                    
         ICM   RF,15,ADMARKET                                                   
         BZ    *+14                                                             
         CLC   KEY(6),0(RF)                                                     
         BE    GETMKT2                                                          
         GOTO1 HIGHMKT                                                          
         L     RF,ADMARKET                                                      
         USING MKTRECD,RF                                                       
*                                                                               
GETMKT2  MVC   WORK+8(20),MKTNAME  MARKET NAME                                  
         CLC   KEY(8),0(RF)                                                     
         BE    GETNAMX                                                          
         MVC   WORK+8(24),BADNAME                                               
         B     GETNAMX                                                          
*                                                                               
GETSTA   CLC   0(4,R6),XFF                                                      
         BNE   GETSTA2                                                          
         MVC   WORK(5),=C'*ALL*'                                                
         MVC   NOTOTLVL,BRLEVEL    SET LEVEL FOR NO AUTO TOTALS                 
         B     GETNAMX                                                          
*                                                                               
GETSTA2  MVC   DUB+2(3),0(R6)                                                   
         GOTO1 MSUNPK,DMCB,DUB,FULL,WORK                                        
         XC    WORK,WORK                                                        
         LA    R4,WORK                                                          
         USING STAPACKD,R4                                                      
         MVI   STAPACT,C'U'                                                     
         MVC   STAPAGY,AGY                                                      
         MVI   STAPCTRY,C'U'                                                    
         CLI   COUNTRY,C' '                                                     
         BNH   *+10                                                             
         MVC   STAPCTRY,COUNTRY                                                 
         MVC   STAPMED,QMED                                                     
         MVC   STAPMKST+2(3),0(R6)                                              
         MVC   STAPACOM,ACOMFACS                                                
         GOTO1 VSTAPACK,WORK                                                    
         MVC   WORK(5),STAPQSTA                                                 
         CLI   WORK+4,C' '                                                      
         BE    GETNAMX                                                          
         MVC   WORK+5(1),WORK+4                                                 
         MVI   WORK+4,C'-'                                                      
         B     GETNAMX                                                          
*                                                                               
GETPGR   XC    KEY,KEY                                                          
         MVC   KEY(2),=X'0D01'                                                  
         MVC   KEY+2(1),BAGYMD                                                  
         LH    RF,CBDSPCLT                                                      
         LA    RF,CBREC(RF)                                                     
         MVC   KEY+3(2),0(RF)                                                   
         MVC   KEY+5(1),QPGR                                                    
         CLC   0(2,R6),=X'9999'                                                 
         BE    GETPGR2                                                          
         MVC   KEY+6(2),0(R6)                                                   
         GOTO1 HIGH                                                             
         CLC   KEY(13),KEYSAVE                                                  
         BE    *+6                                                              
         DC    H'0'                                                             
         GOTO1 GETPRDGR                                                         
         MVC   WORK(5),PGR1                                                     
         MVC   WORK+8(24),PGR1NM                                                
         CLI   SPECDATA,SPECPGR1                                                
         BE    GETMGR4                                                          
         MVC   WORK(5),PGR2                                                     
         MVC   WORK+8(24),PGR2NM                                                
         CLI   SPECDATA,SPECPGR2                                                
         BE    GETMGR4                                                          
         DC    H'0'                                                             
*                                                                               
GETPGR2  MVC   WORK+1(4),=C'9999'                                               
         MVC   WORK+8(24),BADNAME                                               
*                                                                               
GETPGR4  TM    SPECIND,PL                                                       
         BZ    GETNAMX                                                          
         XC    WORK+8(24),WORK+8                                                
         B     GETNAMX                                                          
*                                                                               
GETPROD  L     R1,ADCLT            POINT TO PRODUCT CODE LIST                   
         LA    R1,CLIST-CLTHDRD-1(R1) IN CLIENT HEADER                          
         OC    0(2,R6),0(R6)                                                    
         BNZ   GETPROD2                                                         
         MVC   WORK(3),=C'POL'     (ASSUMES POL REQUEST)                        
         MVC   WORK+8(12),=C'ALL PRODUCTS'                                      
         B     GETNAMX                                                          
GETPROD2 LR    RF,R1               FIRST PRODUCT                                
         AH    RF,0(R6)                                                         
         MVC   WORK(3),0(RF)                                                    
         MVC   WORK+8(L'PRDNM),PRDNM     (ASSUMES SINGLE PRODUCT REQ)           
         OC    2(2,R6),2(R6)                                                    
         BZ    GETNAMX                                                          
         LR    RF,R1               SECOND PRODUCT                               
         AH    RF,2(R6)                                                         
         MVI   WORK+3,C'-'                                                      
         MVC   WORK+4(3),0(RF)                                                  
         B     GETNAMX                                                          
*                                                                               
GETESTIM ZIC   R0,0(R6)                                                         
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(3),DUB                                                      
         B     GETNAMX                                                          
*                                                                               
GETPER   GOTO1 DATCON,DMCB,(2,0(R6)),(0,DUB)                                    
         LA    RE,QTRTAB                                                        
         LA    R0,4                                                             
*                                                                               
GETPER2  CLC   DUB+2(2),0(RE)                                                   
         BNH   GETPER4                                                          
         LA    RE,4(RE)                                                         
         BCT   R0,GETPER2                                                       
*                                                                               
GETPER4  MVC   WORK(2),2(RE)                                                    
         MVI   WORK+2,C'/'                                                      
         MVC   WORK+3(2),DUB                                                    
         B     GETNAMX                                                          
*                                                                               
GETDPT   CLC   0(4,R6),XFF                                                      
         BNE   GETDPT2                                                          
         MVC   WORK(5),=C'*ALL*'                                                
         MVC   NOTOTLVL,BRLEVEL                                                 
         B     GETNAMX                                                          
*                                                                               
GETDPT2  MVC   WORK(3),0(R6)                                                    
         B     GETNAMX                                                          
*                                                                               
GETSLN   ZIC   RE,0(R6)                                                         
         CVD   RE,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(3),DUB                                                      
         B     GETNAMX                                                          
*                                                                               
GETNAMX  B     EXIT                                                             
*                                                                               
BADNAME  DC    CL24'*** UNKNOWN ***'                                            
         SPACE 2                                                                
QTRTAB   DC    CL4'031Q'           LINK MONTHS TO QUARTERS                      
         DC    CL4'062Q'                                                        
         DC    CL4'093Q'                                                        
         DC    CL4'124Q'                                                        
         DC    CL4'**??'                                                        
         EJECT                                                                  
** TABLE OF SPECIAL ROUTINE ADDRESSES FOR PRINTING ROW CODES/NAMES **           
         SPACE 1                                                                
GETTAB   DC    AL1(SPECOFC),AL3(GETOFC)                                         
         DC    AL1(SPECCLT),AL3(GETCLINT)                                       
         DC    AL1(SPECMGR1),AL3(GETMGR)                                        
         DC    AL1(SPECMGR2),AL3(GETMGR)                                        
         DC    AL1(SPECMGR3),AL3(GETMGR)                                        
         DC    AL1(SPECMKT),AL3(GETMKT)                                         
         DC    AL1(SPECSTA),AL3(GETSTA)                                         
         DC    AL1(SPECPGR1),AL3(GETPGR)                                        
         DC    AL1(SPECPGR2),AL3(GETPGR)                                        
         DC    AL1(SPECPRD),AL3(GETPROD)                                        
         DC    AL1(SPECEST),AL3(GETESTIM)                                       
         DC    AL1(SPECPER),AL3(GETPER)                                         
         DC    AL1(SPECDPT),AL3(GETDPT)                                         
         DC    AL1(SPECSLN),AL3(GETSLN)                                         
         DC    X'FF'                                                            
         EJECT                                                                  
POST     NTR1                                                                   
*                                                                               
*        ROUTINE TO POST RECORD TO EACH TOTAL ROW                               
*                                                                               
         MVI   BYTE,1              START FROM ROW 1                             
         SR    RE,RE                                                            
*                                                                               
PS010    MH    RE,=Y(TOTROWLN)                                                  
         LA    RE,TOTALS(RE)       POINT TO TOTAL ROW                           
         SR    R3,R3               INDEX TO COLUMN                              
         LA    R4,CBREC+CBKEYLEN   POINT TO RECORD COLS                         
         LH    R0,CBHICOL                                                       
*                                                                               
PS020    L     RF,0(R3,R4)                                                      
         A     RF,0(R3,RE)                                                      
         ST    RF,0(R3,RE)                                                      
         LA    R3,4(R3)                                                         
         BCT   R0,PS020                                                         
*                                                                               
         CLC   BYTE,CBHIROW+1      TEST FOR LAST ROW                            
         BH    EXIT                                                             
         ZIC   RE,BYTE             NEXT ROW                                     
         LA    RF,1(RE)                                                         
         STC   RF,BYTE                                                          
         B     PS010                                                            
         EJECT                                                                  
FMT      NTR1                                                                   
*                                                                               
*        ROUTINE TO FORMAT THE COLS                                             
*                                                                               
         ZIC   R7,BRLEVEL                                                       
         MH    R7,=Y(TOTROWLN)                                                  
         LA    R7,TOTALS(R7)       R7 POINTS TO TOTALS ROW                      
         CLI   PRINTSW,C'N'        TEST FOR NO PRINT                            
         BE    FM070                                                            
         L     R3,PNEXT            R3 = A(CURRENT PRINT LINE)                   
         ZIC   RE,BRLEVEL                                                       
         CH    RE,CBHIROW          TEST FOR PRIMARY CONTROL BREAK               
         BNL   FM005                                                            
         SLL   RE,2                NO - TEST ONLY ONE ITEM IN TOTALS            
         L     RE,BRCNTRS(RE)                                                   
         BCTR  RE,0                                                             
         LTR   RE,RE                                                            
         BNZ   FM005                                                            
         MVC   0(132,R3),SPACES                                                 
         B     FM070                    YES - DO NOT PRINT TOTALS               
*                                                                               
FM005    LA    R0,CBROWMAX+CBCOLMAX                                             
         LA    R1,RCDTA            POINT TO MY SPECS                            
*                                                                               
FM010    CLI   0(R1),X'FF'                                                      
         BE    FM060               FINISHED                                     
         L     R2,0(R1)                                                         
         TM    SPECDATA,X'80'      TEST FOR COLUMN                              
         BZ    FM050                                                            
         TM    SPECIND,SUPPRESS    TEST FOR SUPPRESSED COL                      
         BO    FM050                                                            
         ZIC   R5,4(R1)                                                         
         AR    R5,R3               POINT R5 TO PRINT LINE POS                   
         ZIC   R6,0(R1)                                                         
         SH    R6,=Y(CBKEYLEN)                                                  
         AR    R6,R7               POINT R6 TO COLUMN IN TOTALS ROW             
         LA    RF,COLTAB                                                        
*                                                                               
FM030    CLI   0(RF),X'FF'   SEARCH FOR SPEC DATA CODE IN BRANCH TAB            
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLC   SPECDATA,0(RF)                                                   
         BE    FM040                                                            
         LA    RF,4(RF)                                                         
         B     FM030                                                            
*                                                                               
FM040    L     RF,0(RF)            FOUND                                        
         BASR  RE,RF               GO FORMAT THE COL                            
*                                                                               
FM050    LA    R1,8(R1)            NEXT ROW/COL                                 
         BCT   R0,FM010                                                         
*                                                                               
FM060    LA    R3,132(R3)          POINT TO NEXT PRINT LINE                     
         ST    R3,PNEXT                                                         
*                                                                               
FM070    XC    0(TOTROWLN,R7),0(R7)   CLEAR THE TOTALS ROW                      
         ZIC   RE,BRLEVEL                                                       
         SLL   RE,2                                                             
         LA    RE,BRCNTRS(RE)                                                   
         XC    0(4,RE),0(RE)       CLEAR ITEM COUNT FOR NEXT LEVEL              
*                                                                               
FM999    B     EXIT                                                             
         SPACE 2                                                                
COLTAB   DC    AL1(SPECSPT),AL3(FMTBIN)    SPOTS                                
         DC    AL1(SPECDOL),AL3(FMTBIN)    DOLLARS                              
         DC    AL1(SPECDM1),AL3(FMTBIN)    DEMO 1                               
         DC    AL1(SPECDM2),AL3(FMTBIN)    DEMO 2                               
         DC    AL1(SPECDM3),AL3(FMTBIN)    DEMO 3                               
         DC    AL1(SPECDM4),AL3(FMTBIN)    DEMO 4                               
         DC    AL1(SPECCP1),AL3(FMTCPP)    CPP 1                                
         DC    AL1(SPECCP2),AL3(FMTCPP)    CPP 2                                
         DC    AL1(SPECCP3),AL3(FMTCPP)    CPP 3                                
         DC    AL1(SPECCP4),AL3(FMTCPP)    CPP 4                                
         DC    X'FF'                                                            
         EJECT                                                                  
FMTBIN   NTR1                                                                   
*                                                                               
*        ROUTINE TO FORMAT 4 BYTE BINARY FIELD                                  
*        R6 POINTS TO INPUT FIELD                                               
*        R5 POINTS TO OUTPUT FIELD                                              
*        SPECTLEN HAS LENGTH OF OUTPUT FIELD                                    
*        RF HIGH BYTE HAS SPEC CODE                                             
*                                                                               
         STCM  RF,8,BYTE                                                        
         CLI   BYTE,SPECDOL                                                     
         BNE   *+12                                                             
         MVI   EBROUND,2           ROUND PENNIES TO DOLLARS                     
         B     FB010                                                            
         CLI   BYTE,SPECDM1                                                     
         BL    FB010                                                            
         CLI   BYTE,SPECDM4                                                     
         BH    FB010                                                            
         MVI   EBROUND,1           ROUND RATING FROM TENTHS TO UNITS            
*                                                                               
FB010    ST    R6,EBAIN            INPUT ADDR                                   
         ST    R5,EBAOUT           OUTPUT ADDR                                  
         MVC   EBLOUT,SPECTLEN     OUTPUT LENGTH                                
         TM    SPECIND,LE                                                       
         BO    FB020                                                            
         TM    SPECIND,CE                                                       
         BZ    *+8                                                              
*                                                                               
FB020    MVI   EBALIGN,C'L'        LEFT ALIGN                                   
         GOTO1 =V(EDITOR),DMCB,EBLOCK                                           
         MVI   EBROUND,0                                                        
         MVI   EBALIGN,0                                                        
         MVI   EBDECS,0                                                         
         CLC   BRLEVEL,CBHIROW+1   CHECK FOR *ALL* ROW                          
         BNL   FB030                                                            
         TM    SPECIND,RI          YES - CHECK FOR RIGHT ALIGN                  
         BZ    FB030                                                            
         ZIC   RE,SPECTLEN               YES - MOVE * AFTER NUMBER              
         AR    RE,R5                                                            
         BCTR  RE,0                                                             
         CLI   0(RE),X'40'                                                      
         BNH   FB030                                                            
         MVI   1(RE),C'*'                                                       
*                                                                               
FB030    TM    SPECIND,CE                                                       
         BZ    EXIT                                                             
         ZIC   RE,SPECTLEN                                                      
         ST    RE,DMCB+4                                                        
         GOTO1 CENTER,DMCB,(R5)                                                 
         B     EXIT                                                             
         EJECT                                                                  
FMTCPP   NTR1                                                                   
*                                                                               
*        ROUTINE TO FORMAT COST PER POINT                                       
*        R5 POINTS TO OUTPUT FIELD                                              
*        SPECTLEN HAS LENGTH OF OUTPUT FIELD                                    
*        R7 POINTS TO TOTALS ROW                                                
*        RF HIGH BYTE HAS CPP SPEC CODE                                         
*                                                                               
         SRL   RF,24                                                            
         STC   RF,BYTE             SAVE CPP SPEC CODE IN BYTE                   
         LA    RE,SPECCP1                                                       
         SR    RF,RE                                                            
         SLL   RF,1                                                             
         LA    RF,CBDSPDM1(RF)                                                  
         LH    RF,0(RF)            DSP TO RATING FIELD                          
         LA    RF,4(RF)            DSP TO EQUIV RATING FIELD                    
         SH    RF,=Y(CBKEYLEN)     SUBTRACT KEY LENGTH                          
         L     RF,0(RF,R7)         RF ENDS UP WITH EQUIV RATING                 
         LTR   RF,RF                                                            
         BZ    EXIT                                                             
         LH    R1,CBDSPDOL                                                      
         SH    R1,=Y(CBKEYLEN)                                                  
         L     R1,0(R1,R7)         R1 HAS ACTUAL DOLLARS                        
         SR    R0,R0                                                            
         M     R0,=F'10'           X 10 FOR 2 DECIMAL PLACE PRECISION           
*  FUTURE TEST SWITCH FOR CALCULATION TYPE  *                                   
         DR    R0,RF              DIVIDE ACTUAL DOLLARS BY EQUIV RATING         
         ST    R1,FULL             GIVES CPP                                    
         LA    R6,FULL                                                          
         MVI   EBDECS,2                                                         
         SR    RF,RF                                                            
         ICM   RF,8,BYTE           RESTORE CPP SPEC CODE                        
         BAS   RE,FMTBIN           FORMAT                                       
         B     EXIT                                                             
         EJECT                                                                  
*                                                                               
*        ROUTINE TO CLEAR FROM R1 TO R0 *                                       
*                                                                               
         SPACE 1                                                                
CLEAR    SR    R0,R1               GIVES LENGTH TO CLEAR                        
         BP    *+6                                                              
         DC    H'0'                                                             
         LA    RF,256                                                           
*                                                                               
CLEAR2   CR    R0,RF                                                            
         BNH   CLEAR4                                                           
         XC    0(256,R1),0(R1)                                                  
         AR    R1,RF                                                            
         SR    R0,RF                                                            
         B     CLEAR2                                                           
CLEAR4   LR    RF,R0                                                            
         BCTR  RF,0                                                             
         EX    RF,CLEARXC                                                       
         BR    RE                                                               
CLEARXC  XC    0(0,R1),0(R1) *EXECUTED*                                         
         EJECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
         DS    0F                                                               
AP       DS    A                                                                
PNEXT    DS    A                                                                
EOF      DS    C                                                                
DEMNFND  DS    C                                                                
PRINTSW  DS    C                                                                
SPCLEVEL DS    X                                                                
NOTOTLVL DS    X                                                                
MAXTTL   DS    X                                                                
MAXCOD   DS    X                                                                
MARGIN   DS    X                                                                
BRLEVEL  DS    X                                                                
BRNUM    DS    X                                                                
NOPRINT  DS    C                                                                
DMNAMES  DS    CL28                                                             
PSAVE    DS    CL132                                                            
XFF      DC    16X'FF'                                                          
*                                                                               
BXROW    DC    9X'00',C'T',X'00',C'M',46X'00'                                   
         DC    C'B'                59                                           
BXCOL    DS    XL132                                                            
*                                                                               
         DS    0D                                                               
         DC    C'*NEWREC*'                                                      
NEWREC   DS    XL(CBRECLEN)                                                     
*                                                                               
         DC    C'**RCDTA*'                                                      
RCDTA    DS    (8*(CBROWMAX+CBCOLMAX))X'00'                                     
RCDTAX   EQU   *                                                                
*                                                                               
         DC    CL8'*TOTALS*'                                                    
TOTALS   DC    ((CBROWMAX+1)*CBCOLMAX*4)X'00'                                   
TOTALSX  EQU   *                                                                
TOTROWLN EQU   CBCOLMAX*4                                                       
*                                                                               
         DC    CL8'COUNTERS'                                                    
BRCNTRS  DC    XL(CBROWMAX*4)'00'                                               
BRCNTRSX EQU   *                                                                
         EJECT                                                                  
         PRINT OFF                                                              
       ++INCLUDE DEDBLOCK                                                       
         EJECT                                                                  
       ++INCLUDE DDEBLOCK                                                       
         EJECT                                                                  
         PRINT ON                                                               
       ++INCLUDE SPREPCBWRK                                                     
         EJECT                                                                  
         PRINT OFF                                                              
       ++INCLUDE SPREPWORKD                                                     
         EJECT                                                                  
       ++INCLUDE DDBIGBOX                                                       
         EJECT                                                                  
ESTHDRD  DSECT                                                                  
       ++INCLUDE SPGENEST                                                       
         EJECT                                                                  
MKTRECD  DSECT                                                                  
       ++INCLUDE SPGENMKT                                                       
         EJECT                                                                  
CLTHDRD  DSECT                                                                  
       ++INCLUDE SPGENCLT                                                       
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'014SPREPCB02B10/18/05'                                      
         END                                                                    
