*          DATA SET PPREP52C   AT LEVEL 025 AS OF 02/25/20                      
*CATALP PP52C                                                                   
         TITLE 'PP5202 - CHANGE LOG                   '                         
*                                                                               
* JSAY 09/19  SPEC-37978  PRINT SECOND ALLOCATION LINE.                         
*                                                                               
* SMUR 04/18  SPEC-17729 NEW MEDIA (D)IGITAL AUDIO (18.3)                       
*                                                                               
* BPLA 03/14    CHANGES FOR MEDIA L - SOCIAL                                    
*                                                                               
* SMYE 03/02/05 SAVE 52A PROFILE FIELD - SKIP COMMENTS (ESCSKIP)                
*                                                                               
* KWAN 03/08/01 BUG FIX INTRODUCED BY UCOMM CODES                               
*                                                                               
* KWAN  10/00   WATCH OUT FOR SPECIAL PRD CODE AAA WHEN PRINTING UCOMM          
*                                                                               
* KWAN  09/00   AFTER UDEF PRINT UCOMM                                          
*                                                                               
* BPLA  6/99    FIX KEVIN'S BUG IN GETBUD (INTRODUCED WITH                      
*               HIS PACKED ACCUMLATORS)                                         
*                                                                               
* SMYE 03/10/98 SAVE A 52A PROFILE FIELD FOR UNIT RATE AT NET                   
*                                                                               
* SMYE 12/17/97 SECOND STANDARD COMMENT FOR ESTIMATES (CP4 PROC)                
*                                                                               
* BPLA 5/96     CHECK FOR MEDIA NAME OVERRIDE BY CLIENT                         
*                                                                               
* BPLA 3/96     ALSO DISPLAY N-CD IN RECAPS IF ESCLINS IS C'0'                  
*               (3RD COLUMN SHOULD BE AVAILABLE)                                
*                                                                               
* BPLA 12/95    CHANGE CALLS FOR DTCNV TO DATCON                                
*                                                                               
* BPLA 4/95     READ B2 BILLING PROFILE TO SEE IF TAX IS BEING                  
*               SUBTRACTED FROM BILLING FORMULA BASE                            
*               IF SO, ALTER CALL TO GETCOST                                    
*                                                                               
* BPLS 6/29/94  FIX FRENCH - USE 'DATE D'INSERTN' INSTEAD OF                    
*               'DATE INSERTION' FOR MAGSAND 'INSERTION DATE'                   
*               FOR NEWSPAPERS                                                  
*                                                                               
* BPLA 11/10/93 I MUST READ 'AAA' PRD AND EST INTO SPECIAL                      
*               RECORD AREAS WHEN CHECKING FOR "AAA" PRD AND                    
*               EST USER FIELDS                                                 
*                                                                               
* BPLA 11/8/93  IN COMPRT IF QPRODUCT = SPACES, TRY FOR PRODUCT                 
*               "AAA" USER FIELDS AND IF ONE EST TRY FOR "AAA"                  
*               ESTIMATE USER FIELDS                                            
*                                                                               
* BPLA 4/8/93   ADD USER FIELD PRINTING TO COMPRT                               
*                                                                               
* BPLA 10/21/91 NO-OP ADDING FILENUM TO PP52WKN                                 
*                                                                               
* BPLA 8/23/91  ADD "I" GROSS,NET,COST TO DETLST                                
*               ADD "I" GROSS,NET,COST TO SUMLST                                
*               ADD "J" GROSS,NET,CD,COST TO SUMLST                             
*                                                                               
* BPLA 5/1/91   IF FRENCH INVERT CERTAIN HEADWDS                                
*               ALSO INVERT INSERTION DATE AND BILL MONTH                       
*                                                                               
* BPLA 4/29/91  ALTER MEDIA NAME DISPLAY (FROM PAGYMED)                         
*                                                                               
* BPLA 4/2/91   MANY FRENCH FIXES                                               
*                                                                               
* BPLA 9/14/90  CONVERT BUDGET AMOUNTS TO $ IF ESCCENTS = $                     
*                                                                               
*                                                                               
* BPLA  7/17/90 CONTROL DATE MOVED FROM QPUBCLAS+1(3) TO                        
*               QCNTLDT(3) TO FREE COL. 61 FOR 2 REQ CARDS                      
*               ALSO REQ STANDARD COMMENT MOVED FROM QPAY(6)                    
*               TO QCOMM (COL 21 2ND REQ CARD)                                  
*                                                                               
* BPLA  6/30/89 NO RECAPS FOR EC                                                
*                                                                               
* ROSA  7/23/88 LAURENCE CHARLES- NEW COMBINATION OF DATES & DOLLARS            
*               OPTION H - PRINT GROSS AND GROSS-CD IN DETAIL LINE              
*               AND SUMMARY.                                                    
*               OPTION 8 IN DATLST // PRINT PAYABLE/SPACE CLOSING AND           
*               ON SALE DATES                                                   
* ROSA  7/12/88 IF EC DOES NOT HAVE A PROFILE SET ONE UP INTERNALLY             
*               USING DEFAULT VALUES.                                           
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
         EJECT                                                                  
         TITLE 'PP5202 - ESMONTHS - EST FIRST ROUTINES'                         
         PRINT NOGEN                                                            
*                                                                               
ESMONTHS CSECT                                                                  
*                                                                               
         ENTRY JOBLST                                                           
*                                                                               
         NMOD1 0,ESMONTHS                                                       
         USING PPWORKD,RA          RA=V(PPWROKC)                                
         L     RC,PPFILEC                                                       
         USING PPFILED,RC,R9       R9=RC+4096                                   
         USING PP52WRKD,R8         R8=A(PP52WRKC)                               
         LA    R7,1(RB)                                                         
         LA    R7,4095(R7)                                                      
         USING ESMONTHS+4096,R7    ** SECOND BASE REGISTER **                   
*                                                                               
         XC    DMCB,DMCB                                                        
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,4                                                          
         MVC   DDLANG,RCLANG                                                    
         LA    RF,DCLIST                                                        
         STCM  RF,7,DDIADR                                                      
         LA    RF,DSLIST                                                        
         STCM  RF,7,DDOADR                                                      
         GOTO1 ADICTATE                                                         
         DROP  R1                                                               
         CLI   RCALLALL,C'Y'       FOR SPECIAL 52/EC REQUESTS                   
         BNE   ESM0                FROM BILLING REQUESTS                        
         MVC   WORK(12),PESTST     USE ESTIMATE START AND END                   
         MVC   PAGE,=H'1'          RENUMBER FOR EACH EST                        
         MVC   RPAGE,=H'1'                                                      
         MVC   SPAGE,=H'1'                                                      
         MVI   COMSW,0             SO REVISION MESSAGE AND COMMENTS             
*                                  REPRINT AT START OF EACH ESTIMATE            
         MVI   CNTLSET,C'N'        SO PROCBUY WILL RESET CONTROL DATES          
         B     ESM1B                                                            
*                                  WILL PRINT                                   
*                                  AND REBUILD RMTAB FOR EACH ESTIMATE          
*                                  OK - SINCE THERE WILL BE NO                  
*                                  BRAND,DIV, OR CLIENT SUMMARIES               
ESM0     MVC   WORK(12),QSTART                                                  
         CLC   QEST,=C'ALL'                                                     
         BE    ESM1B                                                            
         CLC   QEST,SPACES         TEST HAVE EST                                
         BE    ESM1                                                             
         CLC   QESTEND,SPACES                                                   
         BE    ESM1B                                                            
*                                                                               
ESM1     DS    0H                                                               
         XC    PESTREC(250),PESTREC                                             
ESM1B    DS    0H                                                               
         GOTO1 DATCON,DMCB,(0,WORK),(3,BSTART)                                  
         GOTO1 (RF),(R1),(0,WORK+6),(3,BEND)                                    
*                                                                               
         XC    RMTAB,RMTAB                                                      
*                                  CALC NO. OF MONTHS IN REQ                    
         ZIC   R0,BSTART+1                                                      
         ZIC   R1,BEND+1                                                        
         SR    R1,R0                                                            
         CLC   BSTART(1),BEND      TEST SAME YEAR                               
         BE    *+8                                                              
         AHI   R1,12               R1=MONTHS                                    
         LA    R1,1(R1)                                                         
*                                                                               
* 21 MONTHS - NO. IN REQ = LEFT OVER                                            
*                                                                               
         LA    R0,21                                                            
         SR    R0,R1                                                            
         LR    R1,R0                                                            
         SR    R0,R0                                                            
         SLL   R1,1                                                             
         D     R0,=F'3'            2/3 BEFORE, REST AFTER                       
         STH   R1,HALF                                                          
*                                                                               
* START BACK N MONTHS AND GO FOR 21 MONTHS                                      
*                                                                               
         ZIC   R0,BSTART           YEAR                                         
         ZIC   R1,BSTART+1         MONTH                                        
         SH    R1,HALF                                                          
         BP    ESM1D                                                            
         AHI   R1,12                                                            
         BCTR  R0,R0                                                            
ESM1D    DS    0H                                                               
         STC   R0,RMTAB            YEAR                                         
         STC   R1,RMTAB+1          MONTH                                        
*                                                                               
* NOW GO FORWARD TO END (21 MONTHS TOTAL)                                       
*                                                                               
         LA    R2,RMTAB+2                                                       
         LA    RE,20               MAX 20 MORE MONTHS                           
*                                                                               
ESM4     LA    R1,1(R1)                                                         
         CHI   R1,12                                                            
         BNH   *+12                                                             
         AHI   R0,1                                                             
         LA    R1,1                                                             
ESM4A    STC   R0,0(R2)                                                         
         STC   R1,1(R2)                                                         
         LA    R2,2(R2)                                                         
         BCT   RE,ESM4                                                          
*                                  PROCESS PROFILES                             
         OC    PROF,PROF                                                        
         BNZ   ESM20                                                            
         MVC   HOLDPROF,PROGPROF                                                
         OC    HOLDPROF,HOLDPROF   TEST ANY PROFILE                             
         BNZ   ESM119              WAS BZ  ESM19                                
         CLC   QPROG,=C'EC'        ESTIMATE CHANGE REQUESTED                    
         BNE   ESM19                                                            
*                                                                               
         MVC   HOLDPROF,=C'Q1NNNNNNNYNIBQNN'  DEFAULT VALUES                    
         B     ESM19                                                            
*                                                                               
ESM119   LA    RF,HOLDPROF                                                      
         CLC   QPROG,=C'53'                                                     
         BNE   ESM7                                                             
***TESTBUY                                                                      
         CLI   PROGPROF+11,C'Y'       SEE IF INCLUDING TEST BUYS                
         BNE   *+8                                                              
         MVI   FCRDTEST,C'Y'                                                    
***TESTBUY                                                                      
*        PRESET SOME PROF BYTE FOR 53'S                                         
         MVI   8(RF),C'N'          PUB RECAPS                                   
         MVI   11(RF),C'N'         SUMMARY 1                                    
         MVI   12(RF),C'N'         SUMMARY 2                                    
         MVI   13(RF),C'N'         SUMMARY COLS                                 
         MVI   14(RF),C'N'         QTR TOTS                                     
         MVI   15(RF),C'N'         AUTH $                                       
*                                                                               
ESM7     DS    0H                                                               
*                                  PUT HOLDPROF BYTES IN OLD ORDER              
         MVC   PROF+19(1),0(RF)    DET $                                        
         MVC   PROF+20(1),1(RF)    DATES                                        
*                                                                               
         MVI   PROF+21,C'0'        PUB ADDR  N=0                                
         CLI   3(RF),C'N'                                                       
         BE    *+8                                                              
         MVI   PROF+21,C'1'                  Y=1                                
*                                                                               
         MVC   PROF+22(1),2(RF)    CONTRACT                                     
         CLI   2(RF),C'Y'                                                       
         BNE   *+8                                                              
         MVI   PROF+22,C'0'        Y=0                                          
         CLI   2(RF),C'P'          PARTIAL                                      
         BNE   *+8                                                              
         MVI   PROF+22,C'S'        = SUPPRESS                                   
*                                                                               
         LA    RE,4(RF)                                                         
         LA    R0,7                                                             
ESM18B   DS    0H                                                               
         CLI   0(RE),C'N'                                                       
         BNE   *+8                                                              
         MVI   0(RE),C'0'                                                       
         LA    RE,1(RE)                                                         
         BCT   R0,ESM18B                                                        
*                                                                               
*                       LEAVE HOLDPROF+11(2) ALONE                              
*                                                                               
         LA    RE,13(RF)                                                        
         LA    R0,3                                                             
ESM18C   DS    0H                                                               
         CLI   0(RE),C'N'                                                       
         BNE   *+8                                                              
         MVI   0(RE),C'0'                                                       
         LA    RE,1(RE)                                                         
         BCT   R0,ESM18C                                                        
         CLI   HOLDPROF+9,C'0'                                                  
         BNE   *+8                                                              
         MVI   HOLDPROF+9,C'N'          RESET TO "N"                            
*                                                                               
*                                                                               
         MVC   PROF+23(1),13(RF)        SUM $                                   
         MVC   PROF+24(1),04(RF)        LINES IN TOTALS                         
         MVC   PROF+26(1),14(RF)        QTOTS                                   
         MVC   PROF+27(1),07(RF)        EDITION TOTS                            
         MVC   PROF+28(1),08(RF)        PUB RECAPS                              
         MVC   PROF+29(1),15(RF)        AUTHORIZED $                            
         MVC   PROF+31(1),06(RF)        ADFILE                                  
*                                                                               
*                                                                               
         MVI   PROF+30,C'S'        CIRC - SUPPRESS                              
         CLI   5(RF),C'0'                                                       
         BE    ESM18D                                                           
         MVI   PROF+30,C'0'               YES Y=0                               
         CLI   5(RF),C'Y'                                                       
         BE    ESM18D                                                           
         MVC   PROF+30(1),5(RF)           TOTAL                                 
ESM18D   DS    0H                                                               
*                                  QTR TOTS                                     
         MVI   PROF+26,C'0'        NONE                                         
         CLI   HOLDPROF+14,C'N'                                                 
         BE    ESM18F                                                           
         MVI   PROF+26,C'Q'                                                     
         CLI   HOLDPROF+14,C'Y'                                                 
         BE    ESM18F                                                           
         MVC   PROF+26(1),HOLDPROF+14                                           
ESM18F   DS    0H                                                               
         CLI   8(RF),C'Y'          PUB RECAP (N=0)                              
         BNE   *+8                                                              
         MVI   PROF+28,C'1'        Y=1                                          
         CLI   8(RF),C'S'                                                       
         BNE   *+8                                                              
         MVI   PROF+28,C'2'        S=2                                          
*                                                                               
*                                  EDIT TOTS/1 PUB PER PAGE (CLTPROF28          
         CLI   7(RF),C'Y'                                                       
         BE    ESM18G                                                           
         MVI   PROF+27,C'0'                                                     
         CLI   10(RF),C'Y'                                                      
         BNE   *+8                                                              
         MVI   PROF+27,C'T'                                                     
         B     ESM18H                                                           
*                                                                               
ESM18G   DS    0H                                                               
         MVI   PROF+27,C'U'                                                     
         CLI   10(RF),C'Y'                                                      
         BNE   *+8                                                              
         MVI   PROF+27,C'V'                                                     
*                                                                               
ESM18H   DS    0H                                                               
         B     ESM20                                                            
*                                                                               
ESM19    DS    0H                                                               
         MVC   PROF,PCLTPROF                                                    
         CLI   PESTPROF+18,C'0'                                                 
         BNH   *+10                                                             
         MVC   PROF,PESTPROF                                                    
         CLC   QPROG,=C'EC'        SEE IF ESTIMATE CHANGE REPORT                
         BNE   ESM20                                                            
         MVI   PROF+19,C'Q'        SET DEFAULT TO OLD GRS,CHG GRS,GRS           
         MVI   PROF+23,C'Q'        SAME FOR SUMMARIES                           
*                                                                               
ESM20    DS    0H                                                               
*            FIRST TRY TO READ B2 PROFILE (NEEDED FOR GETCOST)                  
         XC    B2PROF,B2PROF                                                    
         XC    WORK,WORK                                                        
         MVC   WORK(12),=CL12'P000'                                             
         MVC   WORK+2(2),=C'B2'    B2 PROFILE                                   
         MVC   WORK+4(2),QAGENCY                                                
         MVC   WORK+6(1),QMEDIA                                                 
         MVC   WORK+7(3),PCLTKCLT                                               
         CLI   PCLTOFF,C' '                                                     
         BNH   *+14                                                             
         MVI   WORK+10,C'*'                                                     
         MVC   WORK+11(1),PCLTOFF                                               
         GOTO1 GETPROF,DMCB,WORK,B2PROF,DATAMGR                                 
         MVC   TAXOPT,B2PROF+12                                                 
         CLI   TAXOPT,0                                                         
         BNE   *+8                                                              
         MVI   TAXOPT,C'N'       DEFAULT TO N                                   
*                                                                               
*              NOW TRY TO READ 52A PROFILE                                      
*                                                                               
         XC    HOLDPROA,HOLDPROA                                                
         XC    WORK,WORK                                                        
         MVI   WORK,C'P'                                                        
         MVC   WORK+1(2),QPROG     52 OR 53                                     
         MVI   WORK+3,C'A'                                                      
         NI    WORK,X'BF'          MAKE SYS LOWER CASE FOR PAGE A               
         MVC   WORK+4(2),QAGENCY                                                
         MVC   WORK+6(1),QMEDIA                                                 
         MVC   WORK+7(3),PCLTKCLT                                               
         CLI   PCLTOFF,C' '                                                     
         BNH   *+14                                                             
         MVI   WORK+10,C'*'                                                     
         MVC   WORK+11(1),PCLTOFF                                               
         GOTO1 GETPROF,DMCB,WORK,HOLDPROA,DATAMGR                               
*                                                                               
*              SEE IF OVERRIDING PROFILE AT REQ LEVEL                           
         CLI   QOPT6,C' '          DETAIL $ CONTROL                             
         BE    ESM20B                                                           
         CLI   QOPT6,C'*'          DETAIL $ CONTROL                             
*                                  * MEANS NOT OVERRIDING THIS CONTROL          
         BE    *+10                                                             
         MVC   PROF+19(1),QOPT6                                                 
ESM20B   CLI   QOPT7,C' '          SUMMARIES $ CONTROL                          
         BE    ESM20D                                                           
         CLI   QOPT7,C'*'          SUMMARIES $ CONTROL                          
*                                  * MEANS NOT OVERRIDING THIS CONTROL          
         BE    *+10                                                             
         MVC   PROF+23(1),QOPT7                                                 
*                                                                               
ESM20D   XC    ESCTL,ESCTL                                                      
*                                                                               
         OC    HOLDPROA,HOLDPROA   CHK FOR 52A PROFILE                          
         BZ    ESM20E                                                           
         MVC   ESCDAY,HOLDPROA                                                  
         MVC   ESCZMTH,HOLDPROA+1   FOR SHOWING O MTHS IN REQ PERIOD            
         MVC   ESCUNET,HOLDPROA+2   'Y' = ALWAYS SHOW UNIT RATE AT NET          
         MVC   ESCSKIP,HOLDPROA+3   SKIP COMMENT IF 1ST CHARACTER =             
*                                                                               
ESM20E   LA    R3,DETLST                                                        
ESM21    CLC   0(1,R3),PROF+19                                                  
         BE    ESM22                                                            
         CLI   0(R3),C' '                                                       
         BE    ESM22                                                            
         LA    R3,4(R3)                                                         
         B     ESM21                                                            
ESM22    MVC   ESCDETS,1(R3)            DETAIL $                                
         LA    R3,DATLST                                                        
ESM23    CLC   0(1,R3),PROF+20                                                  
         BE    ESM24                                                            
         CLI   0(R3),C' '                                                       
         BE    ESM24                                                            
         LA    R3,3(R3)                                                         
         B     ESM23                                                            
ESM24    MVC   ESCDATS,1(R3)            DATES                                   
*                                                                   L01         
         MVI   LCHAR,0        CLEAR LAURENCE CHARLES INDICATOR      L01         
         CLI   0(R3),C'8'     SPECIAL DATE HANDLING                 L01         
         BNE   *+8                                                  L01         
         MVI   LCHAR,C'L'     INDICATOR                             L01         
*              3 DATES - -PAYABLE,SPACE CLOSING,ON-SALE             L02         
*              AND DON'T SHOW BILL MONTH (NO ROOM)                  L02         
*                                                                   L01         
         LA    R3,SUMLST                                                        
ESM25    CLC   0(1,R3),PROF+23                                                  
         BE    ESM26                                                            
         CLI   0(R3),C' '                                                       
         BE    ESM26                                                            
         LA    R3,6(R3)                                                         
         B     ESM25                                                            
ESM26    MVC   ESCSUMS,1(R3)            SUMMARY $                               
         MVC   ESCPBAD,PROF+21          PUB ADDR                                
         MVC   ESCCONC,PROF+22          CONTRACT CTL                            
         MVI   FCGTCONT,C'Y'                                                    
         CLI   ESCCONC,C'N'                                                     
         BNE   *+8                                                              
         MVI   FCGTCONT,C'N'                                                    
         CLI   QOPT3,C'S'          IF SUMMARIES ONLY                            
         BNE   *+8                                                              
         MVI   FCGTCONT,C'N'       THEN NO CONTRACTS NEEDED                     
         MVC   ESCLINS,PROF+24                                                  
         CLI   PROF+24,C'0'             LINES                                   
         BE    ESM27                                                            
         OI    ESCLINS,X'01'       SET PUB LINE TOTS                            
ESM27    DS    0H                                                               
         OC    HOLDPROF,HOLDPROF                                                
         BZ    ESM27B                                                           
         MVC   ESCSUM1(2),HOLDPROF+11     SUMM OPTIONS FORM PROF                
         MVC   ESCCHGS,HOLDPROF+9                                               
         MVI   ESCCCON,0                                                        
***NEW 1/27/88                                                                  
         CLC   QPROG,=C'EC'         SPECIAL FOR EC                              
         BNE   ESM27C                                                           
**                                                                              
*    HOLDPROF+9 MUST BE Y,$,B,T,L                                               
*                                                                               
*       IF Y SET QOPT5 TO C AND ESCCCON TO 0                                    
*       IF L SET QOPT5 TO C AND ESCCCON TO 0                                    
*       IF $ SET QOPT5 TO C AND ESCCCON TO $                                    
*       IF B SET QOPT5 TO T AND ESCCCON TO $                                    
*       IF T SET QOPT5 TO T AND ESCCCON TO 0                                    
*                                                                               
*        SVQOPT5 (SAVED AT FBUYREC) OVERRIDES HOLDPROF+9                        
*                                                                               
         MVI   ESCCHGS,C'Y'        DEFAULT FOR EC                               
*                                                                               
         CLI   SVQOPT5,C' '          SEE IF PROFILE BEING OVERRIDDEN            
         BE    ESM27A                                                           
         MVC   HOLDPROF+9(1),SVQOPT5    USE 'REAL' QOPT5                        
*                                                                               
ESM27A   MVI   QOPT5,C'C'                                                       
         CLI   HOLDPROF+9,0           IN CASE NO EC PROFILE SET-UP              
         BE    ESM27C                 TREAT AS 'Y'                              
         CLI   HOLDPROF+9,C'Y'                                                  
         BE    ESM27C                                                           
         CLI   HOLDPROF+9,C'L'                                                  
         BE    ESM27C                                                           
         MVI   ESCCCON,C'$'        FOR SHOWING ONLY $ CHANGES                   
         CLI   HOLDPROF+9,C'$'                                                  
         BE    ESM27C                                                           
         MVI   QOPT5,C'T'                                                       
         CLI   HOLDPROF+9,C'B'                                                  
         BE    ESM27C                                                           
         MVI   ESCCCON,0                                                        
*                              HOLDPROF+9 MUST BE 'T'                           
         B     ESM27C                                                           
*                                                                               
ESM27B   DS    0H                  FROM CLT PROF                                
         MVC   ESCSUM1(2),=C'IN'   INS AND NOTHING                              
         CLI   QMEDIA,C'N'                                                      
         BE    ESM27C                                                           
         MVI   ESCSUM2,C'B'        INS AND BILL                                 
         CLI   PROF+25,C'0'                                                     
         BE    ESM27C                                                           
         MVI   ESCSUM1,C'S'        OS AND BILL                                  
ESM27C   DS    0H                                                               
         CLI   QOPT2,C' '                                                       
         BE    *+10                                                             
         MVC   ESCSUM2(1),QOPT2    REQ OVERRIDE FOR 2ND SUMMARY                 
         CLC   QPROG,=C'53'                                                     
         BNE   *+10                                                             
         MVC   ESCSUM1(2),=C'NN'   NO SUMMS ON TA'S                             
         MVC   ESCCENTS,PCLTPROF+18    SET $ OR CENTS OPT                       
**NEW 11/4/88                                                                   
         CLI   ESCCENTS,C'1'                                                    
         BNE   *+8                                                              
         MVI   ESCCENTS,C'$'       CHANGE 1 TO $                                
**NEW 11/4/88                                                                   
*                                  QTR TOTS OPT                                 
         MVI   ESCQTRS,0                                                        
         CLI   PROF+26,C'0'                                                     
         BE    ESM27D                                                           
         MVI   ESCQTRS,1                                                        
         CLI   PROF+26,C'Q'                                                     
         BE    ESM27D                                                           
         SR    R1,R1                                                            
         IC    R1,PROF+26                                                       
         SR    R0,R0                                                            
         D     R0,=F'3'                                                         
         LTR   R0,R0                                                            
         BNZ   *+8                                                              
         LA    R0,3                                                             
         STC   R0,ESCQTRS          1,2,3 = JAN,FEB,MAR                          
ESM27D   DS    0H                                                               
         MVC   ESCPBTOT,PROF+27         PUB TOTS + 1 PUB PER PAGE               
         MVC   ESCPBREC,PROF+28         PUB RECAP ON SUMMARIES                  
         MVC   ESCCIRC,PROF+30     CIRC CONTROL                                 
         CLI   ESCCIRC,C'R'                                                     
         BNE   *+12                                                             
         MVI   ESCCIRCR,C'Y'                                                    
         MVI   ESCCIRC,C'T'        'R' TO 'T' FOR CIRC TOTALS                   
         CLI   ESCCIRC,C'T'                                                     
         BNE   *+12                                                             
         OI    ESCLINS,X'01'       SET 'LINES' TOT                              
         B     *+12                                                             
         CLI   ESCCIRC,C'D'                                                     
         BNE   *+8                                                              
         MVI   ESCCIRCD,C'Y'       CIRC DATE AND SOURCE                         
         MVC   ESCJOB,PROF+31           JOB NO. OPTION                          
*                                                                               
         MVC   ESCSUMSB,ESCSUMS                                                 
         CLI   PROF+29,C'0'                                                     
         BE    ESM40               NO BUDGET                                    
         CLI   QOPT1,C'S'          OPTION TO SUPPRESS BUDG                      
         BE    ESM40                                                            
         MVI   ESCBUDG,X'01'       MONTHLY                                      
         CLI   PROF+29,C'3'                                                     
         BNE   *+8                                                              
         MVI   ESCBUDG,X'02'       YEARLY                                       
         MVI   BYTE,1              GROSS                                        
         CLI   PCLTPROF+14,C'N'                                                 
         BNE   *+12                                                             
         OI    ESCBUDG,X'80'       NET NOT GROSS                                
         MVI   BYTE,2              NET                                          
         CLI   PCLTPROF+14,C'C'                                                 
         BNE   *+12                                                             
         OI    ESCBUDG,X'40'                                                    
         MVI   BYTE,X'11'                                                       
         TM    ESCBUDG,X'01'                                                    
         BZ    ESM40                                                            
*                                  IF MONTHLY BUDGET FIX ESCSUMS                
         MVC   WORK(5),ESCSUMS                                                  
         LA    R2,ESCSUMS                                                       
         LA    R3,5                                                             
ESM28    CLC   BYTE,0(R2)                                                       
         BE    ESM29                                                            
         CLI   0(R2),0                                                          
         BE    ESM28A                                                           
         LA    R2,1(R2)                                                         
         BCT   R3,ESM28                                                         
ESM28A   LA    R2,ESCSUMS                                                       
ESM29    MVC   1(2,R2),=X'0A0C'         GROSS                                   
         TM    ESCBUDG,X'80'                                                    
         BZ    *+10                                                             
         MVC   1(2,R2),=X'0B0D'         NET                                     
         TM    ESCBUDG,X'40'                                                    
         BZ    *+10                                                             
         MVC   1(2,R2),=X'1314'                                                 
         LR    R3,R2                                                            
         LA    R2,2(R2)                                                         
         CLI   PROF+29,C'1'             TEST DIFF OPT                           
         BE    *+8                      NO                                      
         LA    R2,1(R2)                                                         
         LA    R0,ESCSUMS                                                       
         SR    R3,R0                                                            
         LA    R3,WORK+1(R3)                                                    
         LA    R4,ESCSUMS+4                                                     
         SR    R4,R2                                                            
         BNP   ESM40                                                            
         EX    R4,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R2),0(R3)            SHIFT OVER 1 OR 2                       
*                                                                               
*                                  HEADLINES                                    
*                                                                               
ESM40    MVC   MYHEAD8,SPACES                                                   
         MVC   MYHEAD9,SPACES                                                   
         MVC   MYHEAD10,SPACES                                                  
         MVC   MYSUMHD8,SPACES                                                  
         MVC   MYSUMH10,SPACES                                                  
         MVC   MYSUMH11,SPACES                                                  
         MVC   MYSUMH12,SPACES                                                  
         MVC   MYSMBH10,SPACES                                                  
         MVC   MYSMBH11,SPACES                                                  
         MVC   MYSMBH12,SPACES                                                  
         CLI   QMEDIA,C'N'                                                      
         BNE   ESM60                                                            
*                                       NEWS                                    
         MVC   MYHEAD9+1(L'PP@PUBL),PP@PUBL                                     
         MVC   MYHEAD10+1(L'PPUPUBL),PPUPUBL                                    
         MVC   MYHEAD8+41(L'PP9INSER),PP9INSER                                  
         MVC   MYHEAD9+43(L'PP4DATE),PP4DATE                                    
*                                                                               
         CLI   RCLANG,4        SEE IF FRENCH                                    
         BNE   ESM40F                                                           
         MVC   MYHEAD8+41(L'PP9INSER),SPACES                                    
         MVC   MYHEAD8+43(L'PP4DATE),PP4DATE                                    
         MVC   MYHEAD9+41(9),=C'D''INSERTN'                                     
         MVI   MYHEAD10+41+L'PP9INSER-1,C'-'                                    
*                                                                               
ESM40F   DS    0H                                                               
         MVC   MYHEAD9+52(L'PP@SPACE),PP@SPACE                                  
         MVC   MYHEAD9+65(L'PP@RATE),PP@RATE                                    
         MVC   MYHEAD10+41(L'PP9INSER-1),MYDASH                                 
*                                 NOTE**  -1 SHOW IT WON'T ABUT SPACE           
*                                           UNDERLINING                         
         MVC   MYHEAD10+52(L'PPUSPACE),PPUSPACE                                 
         MVC   MYHEAD10+65(L'PPURATE),PPURATE                                   
         CLI   ESCDETS,0                                                        
         BNE   ESM42                                                            
         MVC   MYHEAD9+74(L'PP@PCOST),PP@PCOST                                  
         MVC   MYHEAD10+74(L'PPUPCOST),PPUPCOST                                 
ESM42    LA    R4,MYHEAD8+74                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDETS                                                       
         BAS   RE,FILLHEAD                                                      
         LA    R4,MYHEAD8+86                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDETS+1                                                     
         BAS   RE,FILLHEAD                                                      
         LA    R4,MYHEAD8+98                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDETS+2                                                     
         BAS   RE,FILLHEAD                                                      
         B     ESM70                                                            
*                                  MAGS                                         
*                                                                               
ESM60    DS    0H                                                               
         CLI   QMEDIA,C'O'                                                      
         BE    ESM62                                                            
         MVC   MYHEAD9+1(L'PP@PUBL),PP@PUBL                                     
         MVC   MYHEAD10+1(L'PP@PUBL),MYDASH                                     
         MVC   MYHEAD8+39(L'PP9INSER),PP9INSER                                  
         MVC   MYHEAD9+41(L'PP4DATE),PP4DATE                                    
         CLI   RCLANG,4             SPECIAL FOR FRENCH                          
         BNE   ESM61                INVERT INSERTION DATE                       
         MVC   MYHEAD8+39(L'PP9INSER),SPACES                                    
         MVC   MYHEAD8+41(L'PP4DATE),PP4DATE                                    
         MVC   MYHEAD9+38(9),=C'D''INSERTN'                                     
         MVI   MYHEAD10+38,C'-'                                                 
*                                                                               
ESM61    MVC   MYHEAD10+39(L'PP9INSER-1),MYDASH                                 
*                                 NOTE**  -1 SHOW IT WON'T ABUT SPACE           
*                                           UNDERLINING                         
         B     ESM63                                                            
*                                                                               
*                                  OUTDORR                                      
ESM62    DS    0H                                                               
         MVC   MYHEAD9+1(L'PP@VEND),PP@VEND                                     
         MVC   MYHEAD8+39(L'PP7POST),PP7POST                                    
         MVC   MYHEAD9+41(L'PP4DATE),PP4DATE                                    
         MVC   MYHEAD10+1(L'PPUVEND),PPUVEND                                    
         MVC   MYHEAD10+39(L'PPU7POST),PPU7POST                                 
*                                                                               
*                                                                               
ESM63    DS    0H                                                               
         CLI   ESCDETS,0                                                        
         BNE   ESM64                                                            
*                                  NO 3RD $                                     
         CLI   QMEDIA,C'O'                                                      
         BNE   ESM63B                                                           
*                                  NEW OUTDOOR                                  
         MVC   MYHEAD8+48(L'PP@SIZE),PP@SIZE                                    
         MVC   MYHEAD8+54(L'PP@DISP),PP@DISP                                    
         MVC   MYHEAD9+48(L'PP@SRILL),PP@SRILL                                  
         MVC   MYHEAD10+48(16),=C'----  ---  -----'                             
*                                                                               
*        INSTRUCTION ABOVE WORKS SINCE PP@SRILL IS EQUAL                        
*        IN ENGLISH AND FRENCH                                                  
*                                                                               
         B     ESM63D                                                           
*                                                                               
ESM63B   DS    0H                                                               
         MVC   MYHEAD9+48(L'PP@SDESC),PP@SDESC                                  
         MVC   MYHEAD10+48(L'PP@SDESC),MYDASH                                   
         LA    RE,MYHEAD9+48+L'PP@SDESC                                         
         LA    RF,MYHEAD10+48+L'PP@SDESC                                        
         CLI   0(RE),C' '                                                       
         BNE   ESM63D                                                           
         MVI   0(RF),C' '                                                       
         BCTR  RE,0                                                             
         BCTR  RF,0                                                             
         B     *-16                                                             
ESM63D   DS    0H                                                               
*                                                                               
         CLC   ESCDATS,=X'FFFF'   NO DATE + NO BILL MONTH                       
         BE    ESM63G                                                           
*                                                                               
         LA    R4,MYHEAD8+66                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDATS                                                       
         BAS   RE,FILLHEAD                                                      
         LA    R4,MYHEAD8+72                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDATS+1                                                     
         BAS   RE,FILLHEAD                                                      
*                                                                   L01         
         CLI   LCHAR,C'L'     SPECIAL DATE HANDLING                 L01         
         BNE   ESM63E                                               L01         
         MVC   MYHEAD8+78(L'PP4SALE),PP4SALE ON STAND IN PLACE OF   L01         
         MVC   MYHEAD9+78(L'PP4DATE),PP4DATE    ON-SALE             L01         
*                                                                               
         CLI   RCLANG,4         SEE IF FRENCH                                   
         BNE   ESM63D5          INVERT SALE DATE                                
         MVC   MYHEAD8+78(L'PP4DATE),PP4DATE    ON-SALE             L01         
         MVC   MYHEAD9+78(L'PP4SALE),PP4SALE                        L01         
*                                                                               
ESM63D5  MVC   MYHEAD10+78(4),MYDASH                                            
         CLC   QAGENCY,=C'LC'     SPECIAL FOR LAWRENCE CHARLES                  
         BNE   ESM63G             LEAVE AS ON-SALE                              
         MVC   MYHEAD8+78(L'PP@ON),PP@ON                            L01         
         MVC   MYHEAD9+78(L'PP@STAND),PP@STAND                      L01         
         MVC   MYHEAD10+78(L'PPUSTAND),PPUSTAND                                 
         B     ESM63G                                               L01         
ESM63E   DS    0H                                                   L01         
         MVC   MYHEAD8+79(L'PP@BILL),PP@BILL                                    
         MVC   MYHEAD9+78(L'PP@MONTH),PP@MONTH                                  
         CLI   RCLANG,4             SPECIAL FOR FRENCH                          
         BNE   ESM63F               INVERT BILL MONTH                           
         MVC   MYHEAD8+78(L'PP@MONTH),PP@MONTH                                  
         MVC   MYHEAD9+79(L'PP@BILL),PP@BILL                                    
*                                                                               
ESM63F   MVC   MYHEAD10+78(L'PPUMONTH),PPUMONTH                                 
*                                                                               
ESM63G   LA    R4,MYHEAD8+86                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDETS+1                                                     
         BAS   RE,FILLHEAD                                                      
         LA    R4,MYHEAD8+98                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDETS+2                                                     
         BAS   RE,FILLHEAD                                                      
         B     ESM70                                                            
*                                       3 $ ON DETAIL                           
ESM64    DS    0H                                                               
*                                                                               
         CLC   ESCDATS,=X'FFFF'    NO DATES + NO BILL MONTH                     
         BE    ESM64AX                                                          
*                                                                               
ESM64A   LA    R4,MYHEAD8+55                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDATS                                                       
         BAS   RE,FILLHEAD                                                      
         LA    R4,MYHEAD8+61                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDATS+1                                                     
         BAS   RE,FILLHEAD                                                      
ESM64AX  CLI   QMEDIA,C'O'                                                      
         BE    ESM65                                                            
ESM64B   DS    0H                                                               
         MVC   MYHEAD9+48(L'PP@SPACE),PP@SPACE                                  
         MVC   MYHEAD10+48(L'PPUSPACE),PPUSPACE                                 
         CLC   ESCDATS,=X'FFFF'     NO DATES OPTION                             
         BE    ESM64E               CAN USE FULL HEADLINE                       
         CLI   ESCDATS,0                                                        
         BNE   ESM67                                                            
         MVC   MYHEAD9+48+L'PP@SPACE+1(L'PP@DESC),PP@DESC                       
         MVC   MYHEAD10+48+L'PP@SPACE+1(L'PPUDESC),PPUDESC                      
         CLI   ESCDATS+1,0                                                      
         BNE   ESM67                                                            
ESM64E   DS    0H                                                               
         MVC   MYHEAD9+48+L'PP@SPACE+1(L'PPLDESC),PPLDESC                       
         MVC   MYHEAD10+48+L'PP@SPACE+1(L'PPULDESC),PPULDESC                    
         B     ESM67                                                            
*                                                                               
*                                 OUTDOOR                                       
ESM65    DS    0H                                                               
         CLC   ESCDATS,=X'FFFF'     NO DATES OPTION                             
         BE    ESM65C                                                           
         MVC   MYHEAD9+48(L'PP@SPACE),PP@SPACE                                  
         MVC   MYHEAD10+48(L'PPUSPACE),PPUSPACE                                 
         OC    ESCDATS,ESCDATS                                                  
         BNZ   ESM67                                                            
         MVC   MYHEAD9+48(L'PP@SPACE),SPACES    CLEAR MYHEAD9 AND 10            
         MVC   MYHEAD10+48(L'PPUSPACE),SPACES                                   
*                                                                               
ESM65C   DS    0H                                                               
         MVC   MYHEAD8+48(L'PP@SIZE),PP@SIZE                                    
         MVC   MYHEAD8+54(L'PP@DISP),PP@DISP                                    
         MVC   MYHEAD9+48(L'PP@SRILL),PP@SRILL                                  
         MVC   MYHEAD10+48(16),=C'----  ---  -----'                             
*                                                                               
*        INSTUCTION ABOVE WORKS SINCE PP@SRILL IS EQUAL                         
*        IN ENGLISH AND FRENCH                                                  
*                                                                               
ESM67    DS    0H                                                               
*                                                                   L01         
         CLC   ESCDATS,=X'FFFF'    NO DATES OPTION                              
         BE    ESM67D              SKIP TO $                                    
*                                                                               
         CLI   LCHAR,C'L'     SPECIAL DATE HANDLING                 L01         
         BNE   ESM67B                                               L01         
*                             3 DATES AND NO BILL MONTH                         
         MVC   MYHEAD8+67(L'PP4SALE),PP4SALE  ON-SALE DATE          L01         
         MVC   MYHEAD9+67(L'PP4DATE),PP4DATE                        L01         
*                                                                               
         CLI   RCLANG,4            SEE IF FRENCH                                
         BNE   ESM67A                                                           
         MVC   MYHEAD8+67(L'PP4DATE),PP4DATE                        L01         
         MVC   MYHEAD9+67(L'PP4SALE),PP4SALE  ON-SALE DATE          L01         
*                                                                               
ESM67A   MVC   MYHEAD10+67(4),MYDASH                                            
         CLC   QAGENCY,=C'LC'         SPECIAL FOR LAWRENCE CHARLES              
         BNE   ESM67D                 LEAVE AS ON-SALE                          
         MVC   MYHEAD8+67(L'PP@ON),PP@ON                                        
         MVC   MYHEAD9+67(L'PP@STAND),PP@STAND                      L01         
         MVC   MYHEAD10+67(5),MYDASH                                            
         B     ESM67C                                               L01         
ESM67B   DS    0H                                                   L01         
         MVC   MYHEAD8+68(L'PP@BILL),PP@BILL                                    
         MVC   MYHEAD9+67(L'PP@MONTH),PP@MONTH                                  
         CLI   RCLANG,4             SPECIAL FOR FRENCH                          
         BNE   ESM67C               INVERT BILL MONTH                           
         MVC   MYHEAD8+67(L'PP@MONTH),PP@MONTH                                  
         MVC   MYHEAD9+68(L'PP@BILL),PP@BILL                                    
*                                                                               
ESM67C   MVC   MYHEAD10+67(5),MYDASH                                            
ESM67D   LA    R4,MYHEAD8+74                                                    
         SR    R3,R3                                                            
         IC    R3,ESCDETS                                                       
         BAS   RE,FILLHEAD                                                      
         LA    R4,12(R4)                                                        
         SR    R3,R3                                                            
         IC    R3,ESCDETS+1                                                     
         BAS   RE,FILLHEAD                                                      
         LA    R4,12(R4)                                                        
         SR    R3,R3                                                            
         IC    R3,ESCDETS+2                                                     
         BAS   RE,FILLHEAD                                                      
*                                                                               
*                                  SET PRD-EST HEADLINE                         
ESM70    DS    0H                                                               
         MVI   PRDESTSW,C'F'       FLAG                                         
         CLI   QCNTLDT,C' '        TEST CHANGES TO BE FLAGGED                   
         BNE   ESM74               YES                                          
         MVI   PRDESTSW,C'T'       T/A                                          
         CLC   QPROG,=C'53'                                                     
         BE    ESM74                                                            
         CLC   QEST,SPACES                                                      
         BE    ESM72                                                            
         CLC   QESTEND,SPACES                                                   
         BE    ESM73                                                            
ESM72    DS    0H                                                               
         CLC   QPRODUCT,SPACES                                                  
         BE    ESM72B                                                           
         MVI   PRDESTSW,C'E'       EST                                          
         MVC   MYHEAD9+33(L'PP3ESTM),PP3ESTM                                    
         MVC   MYHEAD10+33(3),MYDASH                                            
         B     ESM74                                                            
ESM72B   DS    0H                                                               
         MVI   PRDESTSW,C'B'       BOTH, PRD-EST                                
         MVC   MYHEAD9+31(L'PP@PRDES),PP@PRDES                                  
         MVC   MYHEAD10+31(L'PP@PRDES),MYDASH                                   
         MVI   MYHEAD10+30,C' '                                                 
         B     ESM74                                                            
ESM73    DS    0H                                                               
         MVI   PRDESTSW,C'Z'       ONLY Z                                       
         CLC   QPRODUCT,SPACES                                                  
         BNE   ESM74                                                            
         MVI   PRDESTSW,C'P'       PRD                                          
         MVC   MYHEAD9+33(3),=C'PRD'                                            
         MVC   MYHEAD10+33(3),MYDASH                                            
         B     ESM74                                                            
ESM74    DS    0H                                                               
         LA    R6,2                                                             
         LA    R4,MYSUMH10+37                                                   
         LA    R5,ESCSUMS                                                       
ESM74A   DS    0H                                                               
         LA    R0,5                                                             
ESM76    SR    R3,R3                                                            
         IC    R3,0(R5)                                                         
         LTR   R3,R3                                                            
         BZ    ESM78                                                            
         BAS   RE,FILLHEAD                                                      
         LA    R4,15(R4)                                                        
         LA    R5,1(R5)                                                         
         BCT   R0,ESM76                                                         
         B     ESM79               NO ROOM FOR LINES                            
ESM78    DS    0H                                                               
         LA    R3,18               CIRC                                         
         CLI   ESCCIRC,C'T'                                                     
         BE    ESM78A                                                           
         TM    ESCLINS,X'02'       TEST LINES ON SUMMARY                        
         BZ    ESM79                                                            
         LA    R3,16               POSTINGS                                     
         CLI   QMEDIA,C'O'                                                      
         BE    ESM78A                                                           
         LA    R3,14               INSERTIONS                                   
         CLI   QMEDIA,C'N'                                                      
         BNE   ESM78A                                                           
         LA    R3,9                LINES                                        
         TM    ESCLINS,X'20'                                                    
         BNZ   *+8                                                              
         LA    R3,15               INCHES                                       
ESM78A   DS    0H                                                               
         BAS   RE,FILLHEAD                                                      
*                                                                               
ESM79    LA    R4,MYSMBH10+37                                                   
         LA    R5,ESCSUMSB                                                      
         BCT   R6,ESM74A                                                        
*                                                                               
ESM80    DS    0H                                                               
*                                  SET MEDIA NAME AND UNDERLINE                 
         MVC   MEDIANM,SPACES                                                   
         MVC   MEDIAUL,SPACES                                                   
         MVC   WORK(25),SPACES                                                  
         MVC   WORK(10),PAGYMED                                                 
*                                                                               
*                                 CHECK FOR MEDIA NAME OVERRIDE                 
         LA    R2,PCLTREC+33                                                    
         MVI   ELCOD,X'41'                                                      
         BAS   RE,NEXTEL                                                        
         BNE   *+10                                                             
         MVC   WORK(10),2(R2)                                                   
*                                                                               
         DS    0H                                                               
         CLI   RCLANG,4                 SEE IF FRENCH                           
         BNE   ESM80A                                                           
         CLI   PAGYKMED,C'M'            MAGAZINES IS THE SAME                   
         BE    ESM80A                                                           
         CLI   PAGYKMED,C'S'            SUPPLEMENTS ALSO                        
         BE    ESM80A                                                           
         MVC   WORK(10),=CL10'JOURNAUX'    FOR NEWSPAPERS                       
         CLI   PAGYKMED,C'N'                                                    
         BE    ESM80A                                                           
         MVC   WORK(10),=CL10'EXTERIEUR' FOR OUTDOOR                            
         CLI   PAGYKMED,C'O'                                                    
         BE    ESM80A                                                           
         MVC   WORK(10),=CL10'INDUSTRIE'                                        
         CLI   PAGYKMED,C'T'                                                    
         BE    ESM80A                                                           
         MVC   WORK(14),=CL14'MEDIAS SOCIAUX'                                   
         CLI   PAGYKMED,C'L'                                                    
         BE    ESM80A1                                                          
         MVC   WORK(14),=CL14'MOBILE'                                           
         CLI   PAGYKMED,C'B'                                                    
         BE    ESM80A1                                                          
         MVC   WORK(14),=CL15'AUDIO NUMRIQUE'                                  
         CLI   PAGYKMED,C'D'                                                    
         BE    ESM80A1                                                          
         MVC   WORK(15),=CL15'VIDEO NATIONALE'                                  
         CLI   PAGYKMED,C'V'                                                    
         BE    ESM80A1                                                          
         MVC   WORK(15),=CL15'VIDEO LOCALE'                                     
         CLI   PAGYKMED,C'W'                                                    
         BE    ESM80A1                                                          
         MVC   WORK(15),SPACES       CLEAR                                      
         MVC   WORK(10),PAGYMED      UNKNOWN - USE PAGYMED                      
*                                                                               
ESM80A   DS    0H                                                               
         MVI   WORK+10,C' '    SINCE I NOW NEED 11                              
ESM80A1  OC    WORK(10),SPACES                                                  
*                                                                               
*        CHECK FOR VARIOUS SPELLING FOR INTERACTIVE                             
*        AND CONVERT THEM TO "INTERACTIVE" FOR THE TITLE                        
*                                                                               
         CLC   WORK(10),=C'INTERACTIV'                                          
         BE    ESM80A5                                                          
         CLC   WORK(9),=C'INTERACTV' COVERS INTERACTV AND INTERACTVE            
         BE    ESM80A5                                                          
         CLC   WORK(6),=C'INTRAC' COVERS INTRACTIVE (AND OTHERS)                
         BE    ESM80A5                                                          
         B     ESM80AX                                                          
*                                                                               
ESM80A5  MVC   WORK(11),=C'INTERACTIVE'                                         
*                                                                               
ESM80AX  DS    0H                                                               
         LA    R4,WORK+15                                                       
         OI    0(R4),C' '                                                       
         CLI   0(R4),C' '                                                       
         BNE   *+8                                                              
         BCT   R4,*-12                                                          
         MVC   2(L'PP8ESTM,R4),PP8ESTM                                          
*                                                                               
         LA    R4,9(R4)                                                         
         CLI   0(R4),C' '                                                       
         BNE   *+8                                                              
         BCT   R4,*-8                                                           
*                                                                               
         CLC   QPROG,=C'53'                                                     
         BNE   *+14                                                             
         MVC   1(5,R4),=C'- T/A'                                                
         LA    R4,5(R4)                                                         
         LA    R0,WORK-1                                                        
         SR    R4,R0                                                            
         LA    R5,25                                                            
         SR    R5,R4                                                            
         SRL   R5,1                                                             
         LA    R6,MEDIANM(R5)                                                   
         BCTR  R4,R0                                                            
         EX    R4,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R6),WORK                                                     
         LA    R6,MEDIAUL(R5)                                                   
         EX    R4,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R6),MYDASH                                                   
*                                                                               
         MVC   PERHD,SPACES                                                     
         CLI   QBPDATE,C' '                                                     
         BE    ESM80B                                                           
         MVC   PERHD(L'PP@BILPD),PP@BILPD                                       
         CLI   QBPDATE,C'B'                                                     
         BE    ESM80B                                                           
         MVC   PERHD(L'PP@PYPD),PP@PYPD                                         
         CLI   QBPDATE,C'P'                                                     
         BE    ESM80B                                                           
         MVC   PERHD(L'PP@OSDAT),PP@OSDAT                                       
         CLI   QBPDATE,C'S'                                                     
         BE    ESM80B                                                           
         MVC   PERHD(L'PP@CDATE),PP@CDATE                                       
         CLI   QBPDATE,C'C'                                                     
         BE    ESM80B                                                           
         MVC   PERHD(L'PP@CLDAT),PP@CLDAT                                       
         CLI   QBPDATE,C'1'                                                     
         BE    ESM80B                                                           
*                                                                               
ESM80B   DS    0H                                                               
*                                                                               
         CLI   ESCPBREC,C'0'                                                    
         BE    ESM90                                                            
         MVC   PBHEAD10,SPACES                                                  
         MVC   PBHEAD11,SPACES                                                  
         MVC   PBHEAD12,SPACES                                                  
         CLI   QMEDIA,C'O'                                                      
         BNE   ESM80C                                                           
         MVC   PBHEAD11+03(L'PP@VEND),PP@VEND           OUTDOOR                 
         MVC   PBHEAD12+03(L'PPUVEND),PPUVEND                                   
         MVC   PBHEAD11+24(L'PP@VCODE),PP@VCODE                                 
         MVC   PBHEAD12+24(L'PPUVCODE),PPUVCODE                                 
         MVC   PBHEAD10+45(L'PP@SIZE),PP@SIZE                                   
         MVC   PBHEAD10+51(L'PP@DISP),PP@DISP                                   
         MVC   PBHEAD11+45(L'PP@SRILL),PP@SRILL                                 
         MVC   PBHEAD12+45(16),=C'----  ---  -----'                             
*                                                                               
*        INSTRUCTION ABOVE WORKS SINCE PP@SRILL IS EQUAL                        
*        IN ENGLISH AND FRENCH                                                  
*                                                                               
         B     ESM82                                                            
ESM80C   DS    0H                                                               
         MVC   PBHEAD11+03(L'PP@PUBL),PP@PUBL                                   
         MVC   PBHEAD12+03(L'PPUPUBL),PPUPUBL                                   
         MVC   PBHEAD11+27(L'PP@PCODE),PP@PCODE                                 
         MVC   PBHEAD12+27(L'PPUPCODE),PPUPCODE                                 
ESM80D   DS    0H                                                               
         MVC   PBHEAD11+45(L'PP@SDESC),PP@SDESC                                 
         MVC   PBHEAD12+45(L'PPUSDESC),PPUSDESC                                 
         LA    RE,PBHEAD11+45+16                                                
         LA    RF,PBHEAD12+45+16                                                
         CLI   0(RE),C' '                                                       
         BNE   *+16                                                             
         MVI   0(RF),C' '                                                       
         BCTR  RE,0                                                             
         BCTR  RF,0                                                             
         B     *-16                                                             
         B     ESM82                                                            
*                                                                               
ESM82    LA    R4,PBHEAD10+67                                                   
         LA    R5,ESCDETS                                                       
         LA    R6,3                                                             
ESM83    DS    0H                                                               
         CLI   0(R5),1             GROSS                                        
         BE    ESM85                                                            
         CLI   0(R5),2             NET                                          
         BE    ESM85                                                            
         CLI   0(R5),4             GROSS - CD                                   
         BE    ESM85                                                            
         CLI   0(R5),X'11'         ACTUAL                                       
         BE    ESM85                                                            
         CLI   0(R5),5             NET-CD                                       
         BE    ESM85                                                            
***                                NOTE - NO MORE THAN 2 OF THE ABOVE           
***                                MAY BE IN ESCDETS                            
***                                AS ONLY 2 COLS. + LINES/IN                   
***                                MAY BE ON RECAPS                             
ESM84    LA    R5,1(R5)                                                         
         BCT   R6,ESM83                                                         
         B     ESM86                                                            
ESM85    SR    R3,R3                                                            
         IC    R3,0(R5)                                                         
*                   SEE IF DISPLAYING SOMETHING ELSE IN 3RD COLUMN              
         CLI   ESCLINS,C'0'                                                     
         BE    ESM85C    NO                                                     
         LA    RE,PBHEAD10+67+15+15                                             
         CR    R4,RE     SEE IF AT 3RD COLUMN                                   
         BE    ESM86     STOP - I CAN ONLY DO 2 COST COLUMNS'                   
*                                                                               
ESM85C   BAS   RE,FILLHEAD                                                      
         LA    R4,15(R4)                                                        
         B     ESM84                                                            
*                                                                               
ESM86    DS    0H                                                               
         CLI   ESCLINS,C'0'                                                     
         BZ    ESM90                                                            
         LA    R3,18               CIRC                                         
         CLI   ESCCIRC,C'T'                                                     
         BE    ESM86A                                                           
         LA    R3,16               POSTINGS                                     
         CLI   QMEDIA,C'O'                                                      
         BE    ESM86A                                                           
         LA    R3,14               INSERTIONS                                   
         CLI   QMEDIA,C'N'                                                      
         BNE   ESM86A                                                           
         LA    R3,9                LINES                                        
         TM    ESCLINS,X'20'                                                    
         BNZ   *+8                                                              
         LA    R3,15               INCHES                                       
ESM86A   DS    0H                                                               
         BAS   RE,FILLHEAD                                                      
*                                                                               
ESM90    DS    0H                                                               
         MVC   JOBFILT,SPACES                                                   
         CLI   QPUB+1,C'J'                                                      
         BNE   *+10                                                             
         MVC   JOBFILT,QPUB+2                                                   
*                                  BILLING FORMULA                              
         XC    BILPROF,BILPROF                                                  
         MVC   BFORMD,SPACES                                                    
         MVC   BILADAT,=X'FFFFFF'     SO REQS NOT SHOWING COST                  
*                                     WILL NOT GO TO GETCOST                    
*                                     IN BUYACC                                 
         LA    R3,ESCDETS                                                       
         LA    R4,8                DETS + SUMS                                  
ESM90A   DS    0H                                                               
         CLI   0(R3),X'11'                                                      
         BE    ESM90B                                                           
         LA    R3,1(R3)                                                         
         BCT   R4,ESM90A                                                        
         B     ESM99               NO FORMULA                                   
ESM90B   DS    0H                                                               
         XC    BILADAT,BILADAT     CLEAR OUT X'FF' S SET IN ESM90               
         CLI   QPRODUCT,C' '                                                    
         BE    ESM92                                                            
         CLI   QEST,C' '                                                        
         BE    ESM91                                                            
         OC    BILPROF,PESTBILP                                                 
         BNZ   ESM95                                                            
ESM91    DS    0H                                                               
         OC    BILPROF,PPRDBILP                                                 
         BNZ   ESM95                                                            
*                                  TRY FOR AAA PRODUCT                          
ESM92    DS    0H                                                               
         MVC   WORK(64),KEY                                                     
         XC    KEY,KEY                                                          
         MVC   KEY(7),RCSVAGY                                                   
         MVC   KEY+7(3),=C'AAA'                                                 
         CLI   QEST,C' '                                                        
         BE    ESM93                                                            
         MVI   KEY+3,7                                                          
         MVC   KEY+10(2),PESTKEST  TRY FOR AAA EST                              
         CLC   QEST,=C'ALL'                                                     
         BE    ESM92B                                                           
         PACK  DUB,QEST                                                         
         CVB   R0,DUB                                                           
         STH   R0,KEY+10                                                        
ESM92B   DS    0H                                                               
         B     ESM94                                                            
ESM93    DS    0H                                                               
         MVI   KEY+3,6                                                          
ESM94    DS    0H                                                               
         MVC   KEYSAVE,KEY                                                      
         GOTO1 DATAMGR,DMCB,DMRDHI,PRTDIR,KEY,KEY                               
*                                                                               
         CLC   KEY(25),KEYSAVE                                                  
         BE    ESM94B                                                           
ESM94A   DS    0H                                                               
         CLI   KEYSAVE+3,6                                                      
         BE    ESM94C                                                           
         MVC   KEY,KEYSAVE                                                      
         XC    KEY+10(15),KEY+10                                                
         B     ESM93               TRY FOR AAA RPOD                             
ESM94B   DS    0H                                                               
         GOTO1 (RF),(R1),GETREC,PRTFILE,KEY+27,ALISREC,DMWORK                   
*                                                                               
         L     RE,ALISREC                                                       
         LA    R3,PPRDBILP-PPRDREC(RE)                                          
         CLI   KEY+3,6                                                          
         BE    *+8                                                              
         LA    R3,PESTBILP-PESTREC(RE)                                          
       OC    BILPROF,0(R3)                                                      
         BNZ   ESM94C                                                           
         B     ESM94A                                                           
ESM94C   DS    0H                                                               
         MVC   KEY(64),WORK             RESTORE KEY FOR SEQ                     
         GOTO1 (RF),(R1),DMRDHI,PRTDIR,KEY,KEY                                  
*                                                                               
ESM95    DS    0H                                                               
         OC    BILBASA(5),BILBASA                                               
         BNZ   *+16                                                             
         MVC   BILBASA(5),DFLTFORM                                              
         XC    BILADAT,BILADAT     CLEAR OUT X'FF' S SET IN ESM90               
*                                  SO BUYS GO TO GETCOST                        
         CLI   TAXOPT,C'N'                                                      
         BE    ESM97                                                            
         GOTO1 AGETCOST,DMCB,(C'T',BILBASA),(1,BFORMD),0                        
         B     ESM99                                                            
*                                                                               
ESM97    DS    0H                                                               
         GOTO1 AGETCOST,DMCB,BILBASA,(1,BFORMD),0                               
*                                                                               
ESM99    DS    0H                                                               
         SPACE 2                                                                
         XMOD1 1                                                                
         SPACE 3                                                                
FILLHEAD LTR   R3,R3                                                            
         BZR   RE                                                               
         MH    R3,=H'9'                                                         
         ST    R5,SAVER5                                                        
         LA    R3,HEADWDS-9(R3)                                                 
         ST    R3,FILLHR3                                                       
         SR    R5,R5                                                            
         ICM   R5,7,0(R3)                                                       
         MVC   0(10,R4),0(R5)                                                   
         SR    R5,R5                                                            
         ICM   R5,7,3(R3)                                                       
         MVC   132(10,R4),0(R5)                                                 
         SR    R5,R5                                                            
         ICM   R5,7,6(R3)                                                       
         MVC   264(10,R4),0(R5)                                                 
         L     R5,SAVER5                                                        
*                                                                               
         CLI   RCLANG,4             SPECIAL FOR FRENCH                          
         BNER  RE                                                               
*                                                                               
         SR    R1,R1                                                            
         L     R3,FILLHR3                                                       
         LA    R1,HWCL1              SEE IF CLOSING DATE                        
         CR    R3,R1                                                            
         BE    FILLH10                                                          
         LA    R1,HWSL1              SEE IF ON-SALE DATE                        
         CR    R3,R1                                                            
         BE    FILLH10                                                          
         LA    R1,HWPY1              SEE IF PAYABLE DATE                        
         CR    R3,R1                                                            
         BE    FILLH10                                                          
         BR    RE                                                               
*                                                                               
FILLH10  DS    0H                    INVERT HEADWDS                             
         MVC   FILLWK(10),0(R4)                                                 
         MVC   0(10,R4),132(R4)                                                 
         MVC   132(10,R4),FILLWK                                                
         BR    RE                                                               
*                                                                               
         SPACE                                                                  
         SPACE 3                                                                
NEXTEL   SR    R0,R0                                                            
         IC    R0,1(R2)                                                         
         AR    R2,R0                                                            
         CLI   0(R2),0                                                          
         JE    NEXTELX                                                          
         CLC   ELCOD,0(R2)                                                      
         BER   RE                                                               
         J     NEXTEL+2                                                         
NEXTELX  LTR   R2,R2               SET CC ROT =                                 
         BR    RE                                                               
*                                                                               
*                                                                               
         LTORG                                                                  
         SPACE 2                                                                
*                                                                               
FILLWK   DS    CL10                                                             
SAVER5   DS    F                                                                
FILLHR3  DS    F                                                                
         SPACE                                                                  
*                                                                               
DCLIST   DS    0C                                                               
         DCDDL PP#GROSS,10,R,LABEL=PP10GROS                                     
         DCDDL PP#GROSS,10,RU,LABEL=PPU10GRS                                    
         DCDDL PP#PUBL,11                                                       
         DCDDL PP#PUBL,11,LU,LABEL=PPUPUBL                                      
         DCDDL PP#INSER,9,LABEL=PP9INSER                                        
         DCDDL PP#DATE,4,LABEL=PP4DATE                                          
         DCDDL PP#SPACE,6                                                       
         DCDDL PP#SPACE,6,LU,LABEL=PPUSPACE                                     
         DCDDL PP#RATE,5,R                                                      
         DCDDL PP#RATE,5,RU,LABEL=PPURATE                                       
         DCDDL PP#PCOST,9                                                       
         DCDDL PP#PCOST,9,LU,LABEL=PPUPCOST                                     
         DCDDL PP#VEND,7                                                        
         DCDDL PP#VEND,7,LU,LABEL=PPUVEND                                       
         DCDDL PP#POST,7,LABEL=PP7POST                                          
         DCDDL PP#POST,7,LU,LABEL=PPU7POST                                      
         DCDDL PP#SIZE,4                                                        
         DCDDL PP#DISP,10                                                       
         DCDDL PP#SRILL,16                                                      
         DCDDL PP#SDESC,17                                                      
         DCDDL PP#SDESC,17,LU,LABEL=PPUSDESC                                    
         DCDDL PP#SALE,4,LABEL=PP4SALE                                          
         DCDDL PP#ON,5,C                                                        
         DCDDL PP#STAND,5                                                       
         DCDDL PP#STAND,5,LU,LABEL=PPUSTAND                                     
         DCDDL PP#BILL,4                                                        
         DCDDL PP#MONTH,5,R                                                     
         DCDDL PP#MONTH,5,RU,LABEL=PPUMONTH                                     
         DCDDL PP#DESC,5                                                        
         DCDDL PP#DESC,5,LU,LABEL=PPUDESC                                       
         DCDDL PP#DESC,11,LABEL=PPLDESC                                         
         DCDDL PP#DESC,11,LU,LABEL=PPULDESC                                     
         DCDDL PP#ESTM,3,LABEL=PP3ESTM                                          
         DCDDL PP#PRDES,7                                                       
         DCDDL PP#PRD,3                                                         
         DCDDL PP#ESTM,8,LABEL=PP8ESTM                                          
         DCDDL PP#BILPD,24,C                                                    
         DCDDL PP#PYPD,24,C                                                     
         DCDDL PP#OSDAT,24,C                                                    
         DCDDL PP#CDATE,24,C                                                    
         DCDDL PP#CLDAT,24,C                                                    
         DCDDL PP#VCODE,15                                                      
         DCDDL PP#VCODE,15,LU,LABEL=PPUVCODE                                    
         DCDDL PP#PCODE,8                                                       
         DCDDL PP#PCODE,8,LU,LABEL=PPUPCODE                                     
         DCDDL PP#BLANK,10                                                      
         DCDDL PP#GCOST,10,R                                                    
         DCDDL PP#GCOST,10,RU,LABEL=PPUGCOST                                    
         DCDDL PP#NCOST,10,R                                                    
         DCDDL PP#NCOST,10,RU,LABEL=PPUNCOST                                    
         DCDDL PP#CASH,10                                                       
         DCDDL PP#DISC,10,R                                                     
         DCDDL PP#DISC,10,RU,LABEL=PPUDISC                                      
         DCDDL PP#GLESS,10                                                      
         DCDDL PP#CDISC,10                                                      
         DCDDL PP#CDISC,10,LU,LABEL=PPUCDISC                                    
         DCDDL PP#NLESS,10,C                                                    
         DCDDL PP#CLOSE,10                                                      
         DCDDL PP#DATE,10,L,LABEL=PP10DATE                                      
         DCDDL PP#DATE,10,LU,LABEL=PPUDATE                                      
         DCDDL PP#SALE4,10,L,LABEL=PP10SALE                                     
         DCDDL PP#PYABL,4                                                       
         DCDDL PP#LINE,10,R                                                     
         DCDDL PP#LINE,10,RU,LABEL=PPULINE                                      
         DCDDL PP#AUTH,10                                                       
         DCDDL PP#AUTH,10,LU,LABEL=PPUAUTH                                      
         DCDDL PP#GROSP,10,C                                                    
         DCDDL PP#GROSP,10,CU,LABEL=PPUGROSP                                    
         DCDDL PP#NETP,10,C                                                     
         DCDDL PP#NETP,10,CU,LABEL=PPUNETP                                      
         DCDDL PP#INSER,10,LABEL=PP10INSER                                      
         DCDDL PP#INSER,10,LU,LABEL=PPUINSER                                    
         DCDDL PP#INCH,10,R                                                     
         DCDDL PP#INCH,10,RU,LABEL=PPUINCH                                      
         DCDDL PP#POST,10,R,LABEL=PP10POST                                      
         DCDDL PP#POST,10,RU,LABEL=PPUPOST                                      
         DCDDL PP#COST,10,R,LABEL=PP10COST                                      
         DCDDL PP#COSTU,10,R,LABEL=PPUCOST                                      
         DCDDL PP#CIRCS,10,R                                                    
         DCDDL PP#LATN,10,R                                                     
         DCDDL PP#LATN,10,RU,LABEL=PPULATN                                      
         DCDDL PP#CLESS,10,R                                                    
         DCDDL PP#GROSS,5,R                                                     
         DCDDL PP#GROSS,5,RU,LABEL=PPUGROSS                                     
         DCDDL PP#CHA,10,R,LABEL=PP10CHA                                        
         DCDDL PP#CHA,10,RU,LABEL=PP10UCHA                                      
         DCDDL PP#NET,10,R,LABEL=PP10NET                                        
         DCDDL PP#CHA,10,C,LABEL=PPCCHA                                         
         DCDDL PP#CHA,10,CU,LABEL=PPCUCHA                                       
         DCDDL PP#GCD,10,R                                                      
         DCDDL PP#GCD,10,RU,LABEL=PPUGCD                                        
         DCDDL PP#NCD,10,R                                                      
         DCDDL PP#NCD,10,RU,LABEL=PPUNCD                                        
         DCDDL PP#PRIOR,10,R                                                    
         DCDDL PP#PRIOR,10,RU,LABEL=PPUPRIOR                                    
DCLISTX  DC    X'00'                                                            
*                                                                               
DSLIST   DS    0C                                                               
         DSDDL PRINT=YES                                                        
         PRINT GEN                                                              
DSLISTX  EQU   *                                                                
         PRINT NOGEN                                                            
         SPACE 3                                                                
*                                                                               
DATLST   DC    C'1',X'0806'        P + C                                        
         DC    C'2',X'0607'        C + S                                        
         DC    C'3',X'0708'        S + P                                        
         DC    C'4',X'0008'        P                                            
         DC    C'5',X'0006'        C                                            
         DC    C'6',X'0007'        S                                            
         DC    C'7',X'0000'        NONE                                         
         DC    C'8',X'0806'        P + C AND ON SALE DATE           L01         
         DC    C'X',X'FFFF'        NO DATES AND NO BILL MONTH       L01         
         DC    C' ',X'0607'        C + S DEFAULT                                
*                                                                               
*                                                                               
*              NOTE- NO ENTRY SHOULD CONTAIN                                    
*              ANY 3 OF THESE :                                                 
*              G,N,G-CD,COST                                                    
*              BECAUSE RECAPS CAN ONLY SHOW 2 + LINES/INCHES                    
*                                                                               
*                                                                               
DETLST   DC    C'1',X'000100'      G                                            
         DC    C'2',X'000103'      G + CD                                       
         DC    C'3',X'000200'      N                                            
         DC    C'4',X'000203'      N + CD                                       
         DC    C'5',X'000102'      G + N                                        
         DC    C'6',X'010203'      G + N + CD                                   
         DC    C'7',X'010304'      G + CD + G-CD                                
         DC    C'8',X'020305'      N+ CD + N-CD                                 
         DC    C'9',X'010205'      G + N + N-CD                                 
         DC    C'B',X'010305'      G + CD + N-CD                                
         DC    C'C',X'001100'      ACTUAL COST (BILL FORM)                      
         DC    C'D',X'000111'      G + COST                                     
         DC    C'E',X'010311'      G + CD + COST                                
         DC    C'F',X'000211'      NET + COST                                   
         DC    C'G',X'020311'      N + CD + COST                                
         DC    C'H',X'000104'      G + G-CD                       L01           
         DC    C'I',X'010211'      G + N + COST                                 
         DC    C'P',X'001518'      G CHG + GLCD CHG                             
         DC    C'Q',X'1B1501'      OLD GRS + CHG GRS + GRS                      
         DC    C'R',X'1C1602'      OLD NET + CHG NET + NET                      
         DC    C'S',X'1E1804'      OLD G-CD + CHG G-CD + G-CD                   
         DC    C'T',X'1F1905'      OLD N-CD + CHG N-CD + N-CD                   
         DC    C' ',X'000103'      G + CD  DEFAULT                              
*                                                                               
SUMLST   DC    C'1',X'0100000000'       G                                       
         DC    C'2',X'0103040000'       G + CD + G-CD                           
         DC    C'3',X'0200000000'       N                                       
         DC    C'4',X'0203050000'       N + CD + N-CD                           
         DC    C'5',X'0102000000'       G + N                                   
         DC    C'6',X'0102030405'       G + N + CD + G-CD + N-CD                
         DC    C'7',X'0102030400'      G + N + CD + G-CD                        
         DC    C'C',X'1100000000'  ACTUAL COST                                  
         DC    C'D',X'0111000000'  GROSS + COST                                 
         DC    C'E',X'0103110000'  G + CD + COST                                
         DC    C'F',X'0211000000'  NET + COST                                   
         DC    C'G',X'0203110000'  N + CD + COST                                
         DC    C'H',X'0104000000'  G + G-CDL01                                  
         DC    C'I',X'0102110000'  G + N + COST                                 
         DC    C'J',X'0102031100'  G + N + CD + COST                            
         DC    C'P',X'0115040000'  G + G CHG + G-CD                             
         DC    C'Q',X'1B15010000'  OLD GRS + CHG GRS + GRS                      
         DC    C'R',X'1C16020000'  OLD NET + CHG NET + NET                      
         DC    C'S',X'1E18040000'  OLD G-CD + CHG G-CD + G-CD                   
         DC    C'T',X'1F19050000'  OLD N-CD + CHG N-CD + N-CD                   
         DC    C' ',X'0103040000'       G + CD + G-CD  DEFAULT                  
*                                                                               
*                                                                               
DFLTFORM DC    X'0505000000'       DEFAULT BILLING FORMULA (G-CD)               
*                                                                               
         SPACE 2                                                                
*                                                                               
HEADWDS  DC    AL3(PP@BLANK)                                                    
         DC    AL3(PP@GCOST)                                                    
         DC    AL3(PPUGCOST)                                                    
         DC    AL3(PP@BLANK)                                                    
         DC    AL3(PP@NCOST)                                                    
         DC    AL3(PPUNCOST)                                                    
         DC    AL3(PP@CASH)                                                     
         DC    AL3(PP@DISC)                                                     
         DC    AL3(PPUDISC)                                                     
         DC    AL3(PP@GLESS)                                                    
         DC    AL3(PP@CDISC)                                                    
         DC    AL3(PPUCDISC)                                                    
         DC    AL3(PP@NLESS)                                                    
         DC    AL3(PP@CDISC)                                                    
         DC    AL3(PPUCDISC)                                                    
HWCL1    DC    AL3(PP@CLOSE)                                                    
HWCL2    DC    AL3(PP10DATE)                                                    
         DC    AL3(PPUDATE)                                                     
HWSL1    DC    AL3(PP10SALE)                                                    
HWSL2    DC    AL3(PP10DATE)                                                    
         DC    AL3(PPUDATE)                                                     
HWPY1    DC    AL3(PP@PYABL)                                                    
HWPY2    DC    AL3(PP10DATE)                                                    
         DC    AL3(PPUDATE)                                                     
         DC    AL3(PP@BLANK)                                                    
         DC    AL3(PP@LINE)                                                     
         DC    AL3(PPULINE)                                                     
         DC    AL3(PP@AUTH)                                                     
         DC    AL3(PP@GROSP)                                                    
         DC    AL3(PPUGROSP)                                                    
         DC    AL3(PP@AUTH)                                                     
         DC    AL3(PP@NETP)                                                     
         DC    AL3(PPUNETP)                                                     
         DC    AL3(PP@GLESS)                                                    
         DC    AL3(PP@AUTH)                                                     
         DC    AL3(PPUAUTH)                                                     
         DC    AL3(PP@NLESS)                                                    
         DC    AL3(PP@AUTH)                                                     
         DC    AL3(PPUAUTH)                                                     
         DC    AL3(PP@BLANK)                                                    
         DC    AL3(PP10INSER)                                                   
         DC    AL3(PPUINSER)                                                    
         DC    AL3(PP@BLANK)                                                    
         DC    AL3(PP@INCH)                                                     
         DC    AL3(PPUINCH)                                                     
         DC    AL3(PP@BLANK)                                                    
         DC    AL3(PP10POST)                                                    
         DC    AL3(PPUPOST)                                                     
         DC    AL3(PP@BLANK)                                                    
         DC    AL3(PP10COST)                                                    
         DC    AL3(PPUCOST)                                                     
         DC    AL3(PP@CIRCS)                                                    
         DC    AL3(PP@LATN)                                                     
         DC    AL3(PPULATN)                                                     
         DC    AL3(PP@BLANK)                                                    
         DC    AL3(PP@AUTH)                                                     
         DC    AL3(PPUAUTH)                                                     
         DC    AL3(PP@CLESS)                                                    
         DC    AL3(PP@AUTH)                                                     
         DC    AL3(PPUAUTH)                                                     
         DC    AL3(PP10GROS)                                                    
         DC    AL3(PP10CHA)                                                     
         DC    AL3(PP10UCHA)                                                    
         DC    AL3(PP10NET)                                                     
         DC    AL3(PP10CHA)                                                     
         DC    AL3(PP10UCHA)                                                    
         DC    AL3(PP@CDISC)                                                    
         DC    AL3(PPCCHA)                                                      
         DC    AL3(PPCUCHA)                                                     
         DC    AL3(PP@GCD)                                                      
         DC    AL3(PP10CHA)                                                     
         DC    AL3(PP10UCHA)                                                    
         DC    AL3(PP@NCD)                                                      
         DC    AL3(PP10CHA)                                                     
         DC    AL3(PP10UCHA)                                                    
         DC    AL3(PP10COST)          **FUTURE USE**                            
         DC    AL3(PP10CHA)                                                     
         DC    AL3(PP10UCHA)                                                    
         DC    AL3(PP@PRIOR)                                                    
         DC    AL3(PP10GROS)                                                    
         DC    AL3(PPU10GRS)                                                    
         DC    AL3(PP@PRIOR)                                                    
         DC    AL3(PP10NET)                                                     
         DC    AL3(PPUPRIOR)                                                    
         DC    AL3(PP@PRIOR)                                                    
         DC    AL3(PP@CDISC)                                                    
         DC    AL3(PPUCDISC)                                                    
         DC    AL3(PP@PRIOR)                                                    
         DC    AL3(PP@GCD)                                                      
         DC    AL3(PPUGCD)                                                      
         DC    AL3(PP@PRIOR)                                                    
         DC    AL3(PP@NCD)                                                      
         DC    AL3(PPUNCD)                                                      
*                                                                               
         EJECT                                                                  
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
         TITLE 'PP5202 - GET + PRINT COMMENT'                                   
*                                                                               
COMPRT   CSECT                                                                  
*                                                                               
         NMOD1 0,COMPRT                                                         
         USING PPWORKD,RA                                                       
         L     RC,PPFILEC                                                       
         USING PPFILED,RC,R9                                                    
         USING PP52WRKD,R8                                                      
         XC    DMCB,DMCB                                                        
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,4                                                          
         MVC   DDLANG,RCLANG                                                    
         LA    RF,DC1LIST                                                       
         STCM  RF,7,DDIADR                                                      
         LA    RF,DS1LIST                                                       
         STCM  RF,7,DDOADR                                                      
         GOTO1 ADICTATE                                                         
         DROP  R1                                                               
*                                                                               
COMP5    DS    0H                  DISPLAY USER FIELDS NOW                      
         MVC   SAVEP,P             HOLD PRINT LINES                             
         MVC   SAVEP2,PSECOND                                                   
         MVC   P,SPACES                                                         
         MVC   PSECOND,SPACES                                                   
         MVC   SAVESPC,SPACING     AND SPACING                                  
         MVI   SPACING,1                                                        
*                                                                               
         MVI   BYTE,0                                                           
         MVI   AAASW,0                                                          
         CLC   QPRODUCT,SPACES           SEE IF COMBINING PRODUCTS              
         BNE   COMP8      READ "AAA"     PRODUCT HEADER INTO  COMPRDR           
         MVI   AAASW,X'01'               MEANS QPRODUCT WAS SPACES              
         MVC   WORK(32),KEY              SAVE PPG'S KEY                         
         BAS   RE,COMAAAP                                                       
         BE    COMP6               SKIP IF AAA PRODUCT NOT FOUND                
COMP5X   DS    0H                                                               
         MVC   KEY,WORK                                                         
         BAS   RE,COMHI                                                         
         B     COMP77                                                           
*                                                                               
COMP6    CLC   QEST,SPACES                                                      
         BE    COMP7                                                            
         BAS   RE,COMAAAE          READ "AAA" EST HDR INTO COMESTR              
*                                                                               
COMP7    MVC   KEY,WORK            RESTORE PPG'S KEY AND READ HIGH              
         BAS   RE,COMHI            (CLOBBERED BY COMAAAP AND COMAAAE)           
*                                                                               
COMP8    DS    0H                                                               
         TM    AAASW,X'03'                                                      
         BM    COMP77              MIXED - QPRD IS SPACES + NO AAA PRD          
*                                                                               
         BAS   R2,COMP72U          POINT R7 TO CORRECT PRD                      
*                                                                               
         GOTO1 AGETUSER,DMCB,(C'P',PCLTREC),(C'P',0(R7)),(C':',P+1),0           
         CLC   QPROG,=C'EC'                                                     
         BNE   COMP10                                                           
         TM    DMCB+4,X'20'        SEE IF TO PRINT ON EC                        
         BZ    COMP20              NO                                           
         B     COMP15                                                           
*                                                                               
COMP10   TM    DMCB+4,X'40'        SEE IF TO PRINT ON 52/53                     
         BZ    COMP20                                                           
COMP15   DS    0H                                                               
         MVI   BYTE,1                                                           
         GOTO1 APRNT                                                            
*                                                                               
COMP20   DS    0H                                                               
         MVC   P,SPACES                                                         
*                                                                               
         BAS   R2,COMP72U          POINT R7 TO CORRECT PRD                      
*                                                                               
         GOTO1 AGETUSER,DMCB,(C'P',PCLTREC),(C'P',0(R7)),0,(C':',P+1)           
         CLC   QPROG,=C'EC'                                                     
         BNE   COMP25                                                           
         TM    DMCB+6,X'20'        SEE IF TO PRINT ON EC                        
         BZ    COMP40              NO                                           
         B     COMP30                                                           
*                                                                               
COMP25   TM    DMCB+6,X'40'        SEE IF TO PRINT ON 52/53                     
         BZ    COMP40                                                           
COMP30   DS    0H                                                               
         MVI   BYTE,1                                                           
         GOTO1 APRNT                                                            
*                                                                               
COMP40   DS    0H                                                               
         MVC   P,SPACES                                                         
         CLI   BYTE,1              SEE IF I PRINT PRD USER DATA                 
         BNE   COMP42                                                           
         GOTO1 APRNT               YES THE SKIP BEFORE EST                      
*                                                                               
COMP42   MVI   BYTE,0                                                           
         CLC   QEST,SPACES         SEE IF COMBINING ESTS                        
         BE    COMP72                                                           
*                                                                               
         TM    AAASW,X'05'                                                      
         BM    COMP72              MIXED - QPRD IS SPACES + NO AAA EST          
*                                                                               
         BAS   R2,COMP72W          POINT R7 TO CORRECT EST                      
*                                                                               
         GOTO1 AGETUSER,DMCB,(C'P',PCLTREC),(C'E',0(R7)),(C':',P+1),0           
         CLC   QPROG,=C'EC'                                                     
         BNE   COMP45                                                           
         TM    DMCB+4,X'20'        SEE IF TO PRINT ON EC                        
         BZ    COMP60              NO                                           
         B     COMP50                                                           
*                                                                               
COMP45   TM    DMCB+4,X'40'        SEE IF TO PRINT ON 52/53                     
         BZ    COMP60                                                           
COMP50   DS    0H                                                               
         MVI   BYTE,1                                                           
         GOTO1 APRNT                                                            
*                                                                               
COMP60   DS    0H                                                               
         MVC   P,SPACES                                                         
*                                                                               
         BAS   R2,COMP72W          POINT R7 TO CORRECT EST                      
*                                                                               
         GOTO1 AGETUSER,DMCB,(C'P',PCLTREC),(C'E',0(R7)),0,(C':',P+1)           
         CLC   QPROG,=C'EC'                                                     
         BNE   COMP65                                                           
         TM    DMCB+6,X'20'        SEE IF TO PRINT ON EC                        
         BZ    COMP72              NO                                           
         B     COMP70                                                           
*                                                                               
COMP65   TM    DMCB+6,X'40'        SEE IF TO PRINT ON 52/53                     
         BZ    COMP72                                                           
COMP70   DS    0H                                                               
         MVI   BYTE,1                                                           
         GOTO1 APRNT                                                            
*                                                                               
COMP72   DS    0H                                                               
         MVC   P,SPACES                                                         
         CLI   BYTE,1              SEE IF I PRINTED EST DATA                    
         BNE   COMP73                                                           
         GOTO1 APRNT               YES THEN SKIP AFTER                          
         B     COMP73                                                           
*                                                                               
*                                                                               
*                                                                               
COMP72U  LA    R7,COMPRDR                                                       
         TM    AAASW,X'03'                                                      
         BO    *+8                 IF ONES USE COMPRDR                          
         LA    R7,PPRDREC                                                       
         BR    R2                                                               
*                                                                               
COMP72W  LA    R7,COMESTR                                                       
         TM    AAASW,X'05'                                                      
         BO    *+8                 IF ONES USE COMESTR                          
         LA    R7,PESTREC                                                       
         BR    R2                                                               
*                                                                               
COMP73   DS    0H                  UCOMM                                        
         MVC   MYSVKEY(L'KEY),KEY  DDUCOM CALL WILL CREAM KEY                   
*                                                                               
         XC    DUB,DUB                                                          
         BAS   R2,COMP72U          POINT R7 TO CORRECT PRD                      
         MVC   DUB+0(3),07(R7)                                                  
         BAS   R2,COMP72W          POINT R7 TO CORRECT EST                      
         MVC   DUB+4(2),10(R7)                                                  
         GOTO1 =A(PRTUCOM),DMCB,RR=Y                                            
*                                                                               
         MVC   KEY(L'KEY),MYSVKEY                                               
         BAS   RE,COMHI                                                         
         CLC   KEY(25),KEYSAVE                                                  
         BE    *+6                                                              
         DC    H'0'                PPG SEQUENCE IS NOT RESTORED!                
*                                                                               
COMP77   DS    0H                                                               
         CLI   QCNTLDT,C' '        TEST CHG FLAG DATE                           
         BE    CP01                                                             
         CLC   QCNTLDT(3),=X'010101'     SPECIAL CHG CONTROL DATE               
         BE    CP01                      FOR BILLED TODAY REQUESTS              
*                                        WITH NO PRIOR BILLING                  
         CLC   QPROG,=C'53'                                                     
         BE    CP01                                                             
*                                                                               
         LA    R3,QCNTLDT                                                       
         GOTO1 DATCON,DMCB,(3,(R3)),(5,WORK)                                    
         MVC   P+1(L'PP@REVDT),PP@REVDT                                         
         MVC   P+1+18(8),WORK                                                   
         MVI   SPACING,2                                                        
         GOTO1 APRNT                                                            
*                                                                               
CP01     DS    0H                                                               
*                                                                               
         L     R3,PPWORK2C                                                      
         USING PPWORK2D,R3                                                      
         CLI   BILBASA,0                                                        
         BE    CP1                                                              
*                                  BILLING FORMULA                              
         MVC   P+1(L'PP6COST),PP6COST                                           
         MVC   P+8(53),BFORMD                                                   
         GOTO1 APRNT                                                            
*                                                                               
* CHECK FOR ANY FOLLOWING LINES TO BE PRINTED, IF NOT PRINT BLANK LINE          
*                                                                               
         CLI   QOPT9,C'O'          COST2/OPEN?                                  
         BNE   CP100A              PRINT A BLANK LINE FOR DOUBLE SPACE          
*                                                                               
CP1      DS    0H                                                               
         CLI   QOPT9,C'O'          COST2/OPEN?                                  
         BNE   CP100F                                                           
*                                                                               
         MVC   P+1(L'COS2MSG),COS2MSG                                           
         GOTO1 APRNT                                                            
         B     CP100A                                                           
COS2MSG  DC    C'*** DOLLAR AMOUNTS ARE COST TO CLIENT ***'                     
MYSVKEY  DS    CL(L'KEY)                                                        
*                                                                               
CP100A   DS    0H                                                               
         GOTO1 APRNT               BLANK LINE, SAME EFFECT AS 2 SPACING         
         DROP  R3                                                               
*                                                                               
CP100F   DS    0H                                                               
         XC    WKJOB,WKJOB                                                      
         CLI   JOBFILT,C' '                                                     
         BE    *+10                                                             
         MVC   WKJOB,JOBFILT                                                    
         CLI   PESTJOB,C' '                                                     
         BNH   *+10                                                             
         MVC   WKJOB,PESTJOB                                                    
         CLI   WKJOB,C' '                                                       
         BNH   CP2                                                              
         GOTO1 AFNDJOB                                                          
*                                                                               
         L     R3,DMCB                                                          
         LTR   R3,R3                                                            
         BZ    CP2                                                              
         MVC   P+1(L'PP@ADNO),PP@ADNO                                           
         MVC   P+10(6),WKJOB                                                    
         MVC   PSECOND+1(L'PP@COPY),PP@COPY                                     
         MVC   PSECOND+8(17),9(R3)                                              
         GOTO1 APRNT                                                            
         MVC   P+1(25),26(R3)      CAP1                                         
         MVC   PSECOND+1(25),51(R3)                                             
         MVI   SPACING,2                                                        
         GOTO1 APRNT                                                            
*                                                                               
CP2      DS    0H                                                               
         CLI   QPRODUCT,C' '                                                    
         BNH   CP6                                                              
         CLI   PESTZZZ,C' '                                                     
         BNH   CP4                                                              
         CLI   COMSW,C'E'                                                       
         BNE   CP4                                                              
         MVC   P+1(L'PP@PALLC),PP@PALLC                                         
         MVC   P+21(47),PESTZZZ                                                 
*                                                                               
         LA    R2,PESTREC+33                                                    
         MVI   ELCOD,X'66'                                                      
         JAS   RE,NEXTEL                                                        
         JNE   CP2C                                                             
*                                                                               
         LA    R0,47                                                            
         LA    R5,P+21                                                          
         USING PESTALLX,R2                                                      
CP2A     CLI   0(R5),X'40'                                                      
         JNH   CP2B                                                             
         LA    R5,1(R5)                                                         
         JCT   R0,CP2A                                                          
*                                                                               
CP2B     MVC   0(L'PEALLZZZ,R5),PEALLZZZ                                        
         DROP  R2                                                               
*                                                                               
CP2C     MVI   SPACING,2                                                        
         GOTO1 APRNT                                                            
*                                                                               
CP4      DS    0H                                                               
         CLC   PESTCOM,SPACES                                                   
         BNH   CP6                                                              
         LA    R2,PESTCOM                                                       
         BAS   RE,COMPRT0                                                       
*                                                                               
         CLC   PESTCOM2,SPACES                                                  
         BNH   CP6                                                              
         LA    R2,PESTCOM2                                                      
         BAS   RE,COMPRT0                                                       
*                                                                               
CP6      DS    0H                                                               
         L     RF,PPWORK2C                                                      
         USING PPWORK2D,RF                                                      
         CLC   QCOMM(6),SPACES                                                  
         BE    COMPRTXX                                                         
         LA    R2,QCOMM                                                         
*                                                                               
         DROP  RF                                                               
*                                                                               
         BAS   RE,COMPRT0                                                       
         B     COMPRTXX                                                         
*                                                                               
*                                                                               
*                                                                               
COMPRT0  NTR1                                                                   
         MVC   WORK(32),KEY        SAVE KEY FOR PPG                             
         XC    KEY,KEY                                                          
         MVC   KEY(3),QAGENCY                                                   
         MVI   KEY+3,X'40'                                                      
         MVC   WORK2+6(6),0(R2)                                                 
         MVC   WORK2(6),SPACES                                                  
         LA    R2,WORK2+6                                                       
         CLI   5(R2),C' '                                                       
         BNE   *+8                                                              
         BCT   R2,*-8                                                           
         MVC   KEY+4(6),0(R2)                                                   
         BAS   RE,COMHI                                                         
         CLC   KEY(10),KEYSAVE                                                  
         BE    COMPRT0C                                                         
         MVC   KEY,WORK         RESTORE PPG KEY IF COMMENT NOT FOUND            
         BAS   RE,COMHI                                                         
         B     COMPRTX2                                                         
*                                                                               
COMPRT0C BAS   RE,COMGET                                                        
*                                  RESTORE PPG READ                             
         MVC   KEY,WORK                                                         
         BAS   RE,COMHI                                                         
*                                                                               
* NOTE - COMMENT REC READ INTO PLISREC                                          
*                                                                               
COMPRT1  DS    0H                                                               
         L     R2,ALISREC                                                       
         LA    R2,33(R2)                                                        
COMPRT2  DS    0H                                                               
         CLI   0(R2),0             EOR                                          
         BE    COMPRTX                                                          
         CLI   0(R2),X'40'                                                      
         BE    COMPRT6                                                          
COMPRT4  DS    0H                                                               
         SR    R0,R0                                                            
         IC    R0,1(R2)                                                         
         AR    R2,R0                                                            
         B     COMPRT2                                                          
COMPRT6  DS    0H                                                               
*                                                                               
         CLC   =C'++START',2(R2)   IF ++START                                   
         BNE   COMPRT6B                                                         
         CLI   COMSW,C'S'          SKIP ON SUMMARIES                            
         BE    COMPRTX2         DON'T RESTORE SAVEP AND SAVEP2 NOW              
         B     COMPRT4                                                          
COMPRT6B DS    0H                                                               
         CLC   =C'++END',2(R2)     IF ++END                                     
         BNE   COMPRT6D                                                         
         CLI   COMSW,C'E'          SKIP ON ESTIMATE                             
         BE    COMPRTX2          DON'T RESTORE SAVEP AND SAVEP2 NOW             
         B     COMPRT4                                                          
COMPRT6D DS    0H                                                               
         LA    R4,2(R2)                                                         
         SR    R5,R5                                                            
         IC    R5,1(R2)                                                         
         AHI   R5,-2                                                            
         CLI   0(R4),C'+'                                                       
         BNE   COMPRT8                                                          
         MVC   SPACING,1(R4)                                                    
         NI    SPACING,X'0F'                                                    
         CLI   SPACING,3                                                        
         BNH   *+8                                                              
         MVI   SPACING,3                                                        
         CLI   SPACING,0                                                        
         BNE   *+8                                                              
         MVI   SPACING,1                                                        
         LA    R4,2(R4)                                                         
         AHI   R5,-2                                                            
         GOTO1 APRNT               DO SPACING                                   
COMPRT8  DS    0H                                                               
         LTR   R5,R5                                                            
         BNP   COMPRT4                                                          
         BCTR  R5,R0                                                            
         EX    R5,COMMVC                                                        
         MVI   SPACING,1                                                        
         GOTO1 APRNT                                                            
         B     COMPRT4                                                          
COMMVC   MVC   P+1(0),0(R4)                                                     
COMPRTX  DS    0H                                                               
         MVI   SPACING,2                                                        
         GOTO1 APRNT                                                            
*                                                                               
         B     COMPRTX2                                                         
COMPRTXX DS    0H                                                               
         MVC   P,SAVEP             RESTORE PRINT LINES                          
         MVC   PSECOND,SAVEP2                                                   
         MVC   SPACING,SAVESPC                                                  
COMPRTX2 DS    0H                                                               
         XIT1                                                                   
*                                                                               
*                                                                               
*                                                                               
COMAAAP  NTR1                  READ FOR PRODUCT AAA                             
         XC    KEY,KEY                                                          
         MVC   KEY(7),PCLTREC                                                   
         MVI   KEY+3,X'06'                                                      
         MVC   KEY+7(3),=C'AAA'                                                 
         BAS   RE,COMHI                                                         
         CLC   KEY(10),KEYSAVE                                                  
         BE    COMAAAP5                                                         
*                              RETURN WITH CC NOT EQUAL                         
         B     COMAAAPX                                                         
*                                                                               
COMAAAP5 DS    0H                                                               
         OI    AAASW,X'02'         AAA PRD FOUND                                
         GOTO1 DATAMGR,DMCB,(DMINBTS,GETREC),PRTFILE,KEY+27,           X        
               COMPRDR,DMWORK                                                   
         SPACE 1                                                                
         DS    0H                                                               
         MVC   BYTE,DMCB+8                                                      
         NC    BYTE,DMOUTBTS                                                    
         BZ    *+6                                                              
         DC    H'0'                                                             
         CR    RE,RE         RETURN WITH CC EQUAL                               
COMAAAPX XIT1                                                                   
*                                                                               
*                                                                               
*                                                                               
COMAAAE  NTR1                 READ FOR PRD AAA ESTIMATE HEADER                  
         XC    KEY,KEY                                                          
         MVC   KEY(12),PESTREC                                                  
         MVC   KEY+7(3),=C'AAA'                                                 
         BAS   RE,COMHI                                                         
         CLC   KEY(12),KEYSAVE                                                  
         BE    COMAAAE5                                                         
         B     COMAAAEX            RETURNS WITH CC NOT EQUAL                    
*                                                                               
COMAAAE5 DS    0H                                                               
         OI    AAASW,X'04'         AAA EST FOUND                                
         GOTO1 DATAMGR,DMCB,(DMINBTS,GETREC),PRTFILE,KEY+27,           X        
               COMESTR,DMWORK                                                   
         SPACE 1                                                                
         DS    0H                                                               
         MVC   BYTE,DMCB+8                                                      
         NC    BYTE,DMOUTBTS                                                    
         BZ    *+6                                                              
         DC    H'0'                                                             
         CR    RE,RE         RETURN WITH CC EQUAL                               
COMAAAEX XIT1                                                                   
*                                                                               
*                                                                               
*                                                                               
COMHI    MVC   KEYSAVE,KEY                                                      
         ST    RE,SAVERE                                                        
         GOTO1 DATAMGR,DMCB,(DMINBTS,DMRDHI),PRTDIR,KEY,KEY                     
         SPACE 1                                                                
         B     COMCHK                                                           
COMGET   ST    RE,SAVERE                                                        
         GOTO1 DATAMGR,DMCB,(DMINBTS,GETREC),PRTFILE,KEY+27,           X        
               ALISREC,DMWORK                                                   
         SPACE 1                                                                
COMCHK   DS    0H                                                               
         MVC   BYTE,DMCB+8                                                      
         NC    BYTE,DMOUTBTS                                                    
         BZ    *+6                                                              
         DC    H'0'                                                             
         L     RE,SAVERE                                                        
         BR    RE                                                               
*                                                                               
         LTORG                                                                  
AAASW    DS    CL1                                                              
*                                                                               
DC1LIST  DS    0C                                                               
         DCDDL PP#REVDT,41                                                      
         DCDDL PP#COST,6,LABEL=PP6COST                                          
         DCDDL PP#ADNO,8                                                        
         DCDDL PP#COPY,6                                                        
         DCDDL PP#PALLC,19                                                      
DC1LISTX DC    X'00'                                                            
*                                                                               
DS1LIST  DS    0C                                                               
         DSDDL PRINT=YES                                                        
         PRINT GEN                                                              
DS1LISTX EQU   *                                                                
*                                                                               
COMPRDR  DS    CL700         SPECIAL RECORD AREA FOR AAA PRD                    
COMESTR  DS    CL700         SPECIAL RECORD AREA FOR AAA EST                    
         EJECT                                                                  
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
PRTUCOM  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BAS   RE,COMP73R          SET UP PARAMETERS FOR UCOMM CALL             
         GOTO1 =V(DDUCOM),WKAREA                                                
         LA    R7,WKAREA                                                        
         USING DDUCOMD,R7                                                       
         TM    UCDATA,UCDNOPRD+UCDNOEST                                         
         BO    COMP73X             NO PRD AND EST FOUND, DONE                   
*                                                                               
         OC    UCPLENS,UCPLENS     CHECKING PRD LEVEL                           
         BZ    COMP73H                                                          
         CLI   UCPLENS+0,X'00'     DO FIRST PAIR (PRD)                          
         BE    COMP73FD                                                         
         MVC   DOUBLE+0(4),UCPTTLS                                              
         MVC   DOUBLE+4(4),UCPDATA                                              
         MVC   THREE(1),UCPLENS+0                                               
         BAS   RE,COMP73U          PROCESS UCOMM                                
*                                                                               
COMP73FD CLI   UCPLENS+1,X'00'     DO SECOND PAIR (PRD)                         
         BE    COMP73FE                                                         
         L     RE,UCPTTLS                                                       
         LA    RE,20(RE)                                                        
         ST    RE,DOUBLE                                                        
         L     RE,UCPDATA                                                       
         LA    RE,32(RE)                                                        
         ST    RE,DOUBLE+4                                                      
         MVC   THREE(1),UCPLENS+1                                               
         BAS   RE,COMP73U          PROCESS UCOMM                                
*                                                                               
COMP73FE CLI   UCPLENS+2,X'00'     DO THRID PAIR (PRD)                          
         BE    COMP73FF                                                         
         L     RE,UCPTTLS                                                       
         LA    RE,40(RE)                                                        
         ST    RE,DOUBLE                                                        
         L     RE,UCPDATA                                                       
         LA    RE,64(RE)                                                        
         ST    RE,DOUBLE+4                                                      
         MVC   THREE(1),UCPLENS+2                                               
         BAS   RE,COMP73U          PROCESS UCOMM                                
*                                                                               
COMP73FF CLI   UCPLENS+3,X'00'     DO FOURTH PAIR (PRD)                         
         BE    COMP73H                                                          
         L     RE,UCPTTLS                                                       
         LA    RE,60(RE)                                                        
         ST    RE,DOUBLE                                                        
         L     RE,UCPDATA                                                       
         LA    RE,96(RE)                                                        
         ST    RE,DOUBLE+4                                                      
         MVC   THREE(1),UCPLENS+3                                               
         BAS   RE,COMP73U          PROCESS UCOMM                                
*                                                                               
COMP73H  DS    0H                                                               
         OC    UCELENS,UCELENS     CHECKING EST LEVEL                           
         BZ    COMP73X                                                          
         CLI   UCELENS+0,X'00'     DO FIRST PAIR (EST)                          
         BE    COMP73HD                                                         
         MVC   DOUBLE+0(4),UCETTLS                                              
         MVC   DOUBLE+4(4),UCEDATA                                              
         MVC   THREE(1),UCELENS+0                                               
         BAS   RE,COMP73U          PROCESS UCOMM                                
*                                                                               
COMP73HD CLI   UCELENS+1,X'00'     DO SECOND PAIR (EST)                         
         BE    COMP73HE                                                         
         L     RE,UCETTLS                                                       
         LA    RE,20(RE)                                                        
         ST    RE,DOUBLE                                                        
         L     RE,UCEDATA                                                       
         LA    RE,32(RE)                                                        
         ST    RE,DOUBLE+4                                                      
         MVC   THREE(1),UCELENS+1                                               
         BAS   RE,COMP73U          PROCESS UCOMM                                
*                                                                               
COMP73HE CLI   UCELENS+2,X'00'     DO THIRD PAIR (EST)                          
         BE    COMP73HF                                                         
         L     RE,UCETTLS                                                       
         LA    RE,40(RE)                                                        
         ST    RE,DOUBLE                                                        
         L     RE,UCEDATA                                                       
         LA    RE,64(RE)                                                        
         ST    RE,DOUBLE+4                                                      
         MVC   THREE(1),UCELENS+2                                               
         BAS   RE,COMP73U          PROCESS UCOMM                                
*                                                                               
COMP73HF CLI   UCELENS+3,X'00'     DO FOURTH PAIR (EST)                         
         BE    COMP73X                                                          
         L     RE,UCETTLS                                                       
         LA    RE,40(RE)                                                        
         ST    RE,DOUBLE                                                        
         L     RE,UCEDATA                                                       
         LA    RE,64(RE)                                                        
         ST    RE,DOUBLE+4                                                      
         MVC   THREE(1),UCELENS+3                                               
         BAS   R2,COMP73P          PROCESS UCOMM W/O RESTORE UCOMM BLK          
         B     COMP73X                                                          
         DROP  R7                  DONE WITH USING UCOMM BLK                    
*                                                                               
* MUST PASS DESIRED PAIRS AND ADDRS AS PARAMETERS (DOUBLE AND THREE)            
*                                                                               
COMP73P  DS    0H                  PUT TITLE AND DATA FIELDS ON P               
         XC    P,P                 NEED TO HAVE BINARY ZEROS                    
         L     R3,DOUBLE           GET ADDRESS OF DESIRED TITLE                 
         MVI   P,C' '                                                           
         MVC   P+1(20),0(R3)       PUT UCOM PRD TITLE INTO P                    
         LA    RF,P                                                             
         BAS   RE,COMP73T          NEED TO POINT TO END OF P                    
         MVI   0(RF),C':'          PUT COLON INTO P                             
         MVI   1(RF),C' '          PUT A SPACE NEXT TO COLON                    
         AHI   R0,2                TWO MORE CHARACTERS IN P                     
         LA    RF,2(RF)            POINT TO END OF P AGAIN                      
         L     R3,DOUBLE+4         GET ADDRESS OF DESIRED DATA FIELD            
         ZIC   RE,THREE+0          GET LENGTH OF FIELD DATA                     
         AR    R0,RE               TOTAL OF CHARACTERS IN P                     
         BCTR  RE,0                FOR "EX" INSTRUCTION                         
         EX    RE,COMP73P2                                                      
         B     *+10                                                             
*                                                                               
COMP73P2 MVC   0(0,RF),0(R3)       GET DATA FIELD                               
*                                                                               
         LA    RE,132              LENGTH OF P                                  
         SR    RE,R0               NUMBER OF X'00' REMAINED IN P                
         LA    RF,P                POINT TO BEGINNING OF P                      
         AR    RF,R0               POINT TO END OF P                            
         CHI   RE,0                                                             
         BE    COMP73PH            P IS FINE GO PRINT IT                        
         BCTR  RE,0                                                             
         EX    RE,COMP73P3                                                      
         B     *+10                                                             
*                                                                               
COMP73P3 MVC   0(0,RF),SPACES      FILL X'00' WITH SPACES                       
*                                                                               
COMP73PH GOTO1 APRNT                                                            
         MVC   P,SPACES            PRINT A BLANK LINE                           
         GOTO1 APRNT                                                            
         BR    R2                                                               
*                                                                               
* SET UP PARAMETERS FOR UCOMM CALL                                              
*                                                                               
COMP73R  XC    WKAREA,WKAREA                                                    
         LA    RF,WKAREA           BUILD UCOMM CALL PARAMETERS                  
         USING DDUCOMD,RF                                                       
         MVC   UCACOMF,VCOMFACS                                                 
         MVI   UCSYS,C'P'          SYSTEM=PRINT                                 
         MVC   UCAGY,QAGENCY       AGENCY                                       
         MVC   UCMED,QMEDIA        MEDIA                                        
         MVC   UCCLT,PCLTREC+04                                                 
         MVC   UCPRD,DUB+0                                                      
         MVC   UCEST,DUB+4                                                      
         OI    UCOPT,UCOPRD+UCOEST                                              
         DROP  RF                                                               
         BR    RE                                                               
*                                                                               
* DETERMINES NUMBER OF SIGNIFICANT CHARS IN P AND POINT TO END OF IT            
*                                                                               
COMP73T  DS    0H                  RF MUST BE POINTING TO P                     
         SR    R0,R0                                                            
COMP73TG CLI   0(RF),0             AT END OF P?                                 
         BER   RE                                                               
         LA    RF,1(RF)                                                         
         AHI   R0,1                NUMBER OF NONE X'00' CHARS IN P              
         CHI   R0,132                                                           
         BNH   *+6                                                              
         DC    H'0'                LINE IS FULL, NOT POSSIBLE                   
         B     COMP73TG                                                         
*                                                                               
* PRINT UCOMM AND RESTORE UCOMM BLOCK                                           
*                                                                               
COMP73U  DS    0H                                                               
         ST    RE,SAVERE                                                        
         BAS   R2,COMP73P          P IS PRINTED (UCOMM BLK IS CREAMED)          
         BAS   RE,COMP73R          NEED TO RESTORE UCOMM BLOCK                  
         GOTO1 =V(DDUCOM),WKAREA                                                
         LA    R7,WKAREA           UCOMM BLOCK RESOTRED                         
         L     RE,SAVERE                                                        
         BR    RE                                                               
*                                                                               
COMP73X  XIT1                      DONE WITH UCOMM STUFFS                       
*                                                                               
WKAREA   DS    XL65                GENERAL WORKING STORAGE AREA                 
         LTORG                                                                  
*                                                                               
       ++INCLUDE DDUCOMD           FOR UCOM CALLS                               
         EJECT                                                                  
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
         TITLE 'PP5202 - WORKFILE MODULE'                                       
WFMOD    CSECT                                                                  
         NMOD1 0,**WFMOD                                                        
         USING PPWORKD,RA                                                       
         L     RC,PPFILEC                                                       
         USING PPFILED,RC,R9                                                    
         USING PP52WRKD,R8                                                      
*                                                                               
         XC    DMCB,DMCB                                                        
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,4                                                          
         MVC   DDLANG,RCLANG                                                    
         LA    RF,DC2LIST                                                       
         STCM  RF,7,DDIADR                                                      
         LA    RF,DS2LIST                                                       
         STCM  RF,7,DDOADR                                                      
         GOTO1 ADICTATE                                                         
         DROP  R1                                                               
         CLC   QPROG,=C'53'                                                     
         BE    WFEXIT                                                           
         CLC   QPROG,=C'EC'               NO REACPS FOR EC        L02           
         BE    WFEXIT                                             L02           
         BC    0,WFMOD2                                                         
         OI    *-3,X'F0'                                                        
*                                                                               
*&&DO                                                                           
         OPENR PP52WFN                                                          
*&&                                                                             
*&&OS                                                                           
         OPEN  (PP52WFN,(OUTIN))                                                
*&&                                                                             
*                                                                               
*                                                                               
WFMOD2   DS    0H                                                               
         ZAP   DSTBUD,=P'0'                                                     
         ZAP   REGBUD,=P'0'                                                     
         CLI   LASTMODE,LBUYPUB                                                 
         BE    WFPUBT                                                           
         CLI   MODE,LBUYDST                                                     
         BE    WFDSTT                                                           
         CLI   MODE,LBUYREG                                                     
         BE    WFREGT                                                           
         CLI   MODE,LBUYMKT                                                     
         BE    WFMKTT                                                           
         B     WFESTT                                                           
*                                                                               
WFEXIT   XMOD1 1                                                                
*                                                                               
WFPUBT   DS    0H                                                               
         CLI   WFREGSW,C'R'                                                     
         BNE   WFPUBT1                                                          
         MVI   WFREGSW,0                                                        
*                                       REGION NAME                             
         MVC   WFREC(3),=C'RN '                                                 
         MVC   WFREC+3(3),PREGKREG                                              
         MVC   WFREC+6(20),PREGNAME                                             
         BAS   RE,WFWRITE                                                       
         BAS   RE,WFNOTE                                                        
         ST    R1,REGNOTE                                                       
         STH   R0,REGNOTE+4                                                     
WFPUBT1  DS    0H                                                               
         CLI   WFDSTSW,C'D'                                                     
         BNE   WFPUBT1B                                                         
         MVI   WFDSTSW,0                                                        
*                                       DISTRICT NAME                           
         MVC   WFREC(3),=C'DN '                                                 
         MVC   WFREC+3(3),PDSTKDST                                              
         MVC   WFREC+6(20),PDSTNAME                                             
         BAS   RE,WFWRITE                                                       
         BAS   RE,WFNOTE                                                        
         ST    R1,DSTNOTE                                                       
         STH   R0,DSTNOTE+4                                                     
*                                       PUB TOTALS                              
WFPUBT1B DS    0H                                                               
         CLI   ESCPBREC,C'0'                                                    
         BE    WFEXIT                                                           
         MVC   WFREC(3),=C'PS '                                                 
         MVC   WFREC+75(6),SVPKPUB                                              
         MVC   WFREC+81(40),SVPNAME                                             
         L     R3,ASPCTAB                                                       
         CLI   0(R3),0                                                          
         BE    WFEXIT                                                           
*                                  SORT SPACES                                  
         SR    R6,R6                                                            
         LA    R4,68                                                            
         L     R5,ASPCTABX                                                      
WFP2     DS    0H                                                               
         CLI   0(R3),0                                                          
         BE    WFP4                                                             
         LA    R6,1(R6)                                                         
         BXLE  R3,R4,WFP2                                                       
*                                                                               
WFP4     DS    0H                                                               
         CHI   R6,1                                                             
         BNH   WFP6                                                             
*                                                                               
         GOTO1 XSORT,DMCB,ASPCTAB,(R6),68,17,0                                  
*                                                                               
WFP6     DS    0H                                                               
         L     R3,ASPCTAB                                                       
         LA    R4,68                                                            
         L     R5,ASPCTABX                                                      
WFPUBT2  CLI   0(R3),0                                                          
         BE    WFPUBT4                                                          
         MVC   WFREC+121(17),0(R3)                                              
         CLI   0(R3),X'FF'                                                      
         BNE   *+14                                                             
         MVC   WFREC+121(16),1(R3)           SPACE + 1                          
         MVI   WFREC+121+16,C' '                                                
*                                                                               
         CLI   QMEDIA,C'N'                   FOR NEWS                           
         BNE   *+16                                                             
         MVC   WFREC+134(2),SVPSTATE         STATE                              
         MVC   WFREC+136(16),SVPCITY         + CITY                             
*                                                                               
         MVC   WFREC+3(48),20(R3)            6 SETS OF PL8                      
         BAS   RE,WFWRITE                                                       
         XC    WFREC+75(46),WFREC+75                                            
*                                                                               
         LR    RE,R3                                                            
         XC    0(20,RE),0(RE)                                                   
         LA    RE,20(RE)                     POINT TO PACK NUMBERS              
         LA    RF,6                          6 SETS                             
         ZAP   0(8,RE),=P'0'                                                    
         LA    RE,8(RE)                                                         
         BCT   RF,*-10                                                          
*                                                                               
         BXLE  R3,R4,WFPUBT2                                                    
*                                                                               
WFPUBT4  DS    0H                                                               
         MVC   WFREC(3),=C'ET '                                                 
         CLI   EDVENSW,C'E'                                                     
         BE    *+10                                                             
         MVC   WFREC(3),=C'VT '                                                 
         MVC   WFREC+3(72),WRITTOTS                                             
         BAS   RE,WFWRITE                                                       
         B     WFEXIT                                                           
*                                  MARKET TOTALS                                
WFMKTT   DS    0H                                                               
         CLI   ESCPBREC,C'0'                                                    
         BE    WFEXIT                                                           
         MVC   WFREC(3),=C'MT '                                                 
         MVC   WFREC+3(72),WRITTOTS                                             
         MVC   WFREC+75(20),PUBZNAME                                            
         CLI   QMEDIA,C'O'                                                      
         BE    WFMKTT2                                                          
         MVC   WFREC+75(2),PUBSTATE                                             
         MVI   WFREC+77,C','                                                    
         MVI   WFREC+78,C' '                                                    
         MVC   WFREC+79(16),PUBCITY                                             
WFMKTT2  DS    0H                                                               
         BAS   RE,WFWRITE                                                       
         B     WFEXIT                                                           
*                                  DISTRICT TOTALS                              
WFDSTT   DS    0H                                                               
         CLI   WFDSTSW,C'D'        TEST DST ACTIVE                              
         BE    WFEXIT              NO                                           
         MVC   WFREC(3),=C'DT '                                                 
         MVC   WFREC+3(72),WRITTOTS                                             
         MVC   WFREC+75(3),PDSTKDST                                             
         MVC   WFREC+78(20),PDSTNAME                                            
         BAS   RE,WFWRITE                                                       
         CLI   ESCPBREC,C'0'                                                    
         BE    WFEXIT                                                           
         LA    R0,DSTNOTE                                                       
         BAS   RE,WFPOINT                                                       
         BAS   RE,WFPUBR                                                        
         B     WFEXIT                                                           
*                                       REGION TOTALS                           
WFREGT   DS    0H                                                               
         CLI   WFREGSW,C'R'        TEST REG ACTIVE                              
         BE    WFEXIT              NO                                           
         MVC   WFREC(3),=C'RT '                                                 
         MVC   WFREC+3(72),WRITTOTS                                             
         MVC   WFREC+75(3),PREGKREG                                             
         MVC   WFREC+78(20),PREGNAME                                            
         BAS   RE,WFWRITE                                                       
*                                                                               
         CLC   QDIST,=C'ALL'                                                    
         BNE   WFREGT2                                                          
         MVC   RDHEAD11,SPACES                                                  
         MVC   RDHEAD12,SPACES                                                  
         MVC   RDHEAD11+6(L'PP@DIST),PP@DIST                                    
         MVC   RDHEAD12+6(L'PPUDIST),PPUDIST                                    
         MVC   MYSUMHD8,SPACES                                                  
         ST    R2,SAVER22                                                       
         ST    R4,SAVER4                                                        
         SR    R4,R4                                                            
         ICM   R4,7,DSRCHD                                                      
         LA    R2,L'PP@DREC                                                     
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   MYSUMHD8+37(0),0(R4)                                             
         L     R2,SAVER22                                                       
         L     R4,SAVER4                                                        
*                                                                               
         LA    R0,REGNOTE                                                       
         BAS   RE,WFPOINT                                                       
         BAS   RE,WFRDR                                                         
*                                                                               
WFREGT2  CLI   ESCPBREC,C'0'                                                    
         BE    WFEXIT                                                           
         LA    R0,REGNOTE                                                       
         BAS   RE,WFPOINT                                                       
         BAS   RE,WFPUBR                                                        
         B     WFEXIT                                                           
*                                       ESTIMATE TOTALS                         
WFESTT   DS    0H                                                               
         CLI   WFREC,X'FF'         DONT DO RECAPS TWICE                         
         BE    WFESTT10                                                         
         MVC   WFREC(3),=C'GT '                                                 
         MVC   WFREC+3(72),WRITTOTS                                             
         BAS   RE,WFWRITE                                                       
*                                                                               
         MVC   MYSUMHD8,SPACES                                                  
         MVC   RDHEAD11,SPACES                                                  
         MVC   RDHEAD12,SPACES                                                  
         CLC   QREGION(6),=C'ALLALL'                                            
         BNE   WFESTT2                                                          
         MVC   RDHEAD11+3(L'PP@REGDT),PP@REGDT                                  
         MVC   RDHEAD12+3(L'PPUREGDT),PPUREGDT                                  
         ST    R2,SAVER22                                                       
         ST    R4,SAVER4                                                        
         SR    R4,R4                                                            
         ICM   R4,7,RGDSRCHD                                                    
         LA    R2,L'PP@RDREC                                                    
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   MYSUMHD8+37(0),0(R4)                                             
         L     R2,SAVER22                                                       
         L     R4,SAVER4                                                        
         B     WFESTT6                                                          
*                                                                               
WFESTT2  CLC   QREGION,=C'ALL'                                                  
         BNE   WFESTT4                                                          
         MVC   RDHEAD11+3(L'PP6REGN),PP6REGN                                    
         MVC   RDHEAD12+3(L'PP6UREGN),PP6UREGN                                  
         ST    R2,SAVER22                                                       
         ST    R4,SAVER4                                                        
         SR    R4,R4                                                            
         ICM   R4,7,RGRCHD                                                      
         LA    R2,L'PP@RREC                                                     
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   MYSUMHD8+37(0),0(R4)                                             
         L     R2,SAVER22                                                       
         L     R4,SAVER4                                                        
         B     WFESTT6                                                          
*                                                                               
WFESTT4  CLC   QDIST,=C'ALL'                                                    
         BNE   WFESTT8                                                          
         MVC   RDHEAD11+6(L'PP@DIST),PP@DIST                                    
         MVC   RDHEAD12+6(L'PPUDIST),PPUDIST                                    
         ST    R4,SAVER4                                                        
         ST    R2,SAVER22                                                       
         SR    R4,R4                                                            
         ICM   R4,7,DSRCHD                                                      
         LA    R2,L'PP@DREC                                                     
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   MYSUMHD8+37(0),0(R4)                                             
         L     R2,SAVER22                                                       
         L     R4,SAVER4                                                        
WFESTT6  DS    0H                                                               
         BAS   RE,WFPOINS                                                       
         BAS   RE,WFRDR                                                         
WFESTT8  DS    0H                                                               
         CLI   ESCPBREC,C'0'                                                    
         BE    WFESTT10                                                         
         BAS   RE,WFPOINS                                                       
         BAS   RE,WFPUBR                                                        
*                                                                               
WFESTT10 BAS   RE,WFPOINS                                                       
         MVI   WFREC,X'FF'         SET HAVE DONE RECAPS                         
         B     WFEXIT                                                           
         EJECT                                                                  
*                                  PUB RECAP                                    
         SPACE 2                                                                
WFPUBR   DS    0H                                                               
         ST    RE,SAVERE                                                        
         MVI   LASTEDVN,C'V'                                                    
         MVC   MYSUMHD8,SPACES                                                  
         ST    R2,SAVER22                                                       
         ST    R4,SAVER4                                                        
         SR    R4,R4                                                            
         ICM   R4,7,PUBRCHD                                                     
         LA    R2,L'PP@PREC                                                     
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   MYSUMHD8+37(0),0(R4)                                             
         CLI   QMEDIA,C'O'                                                      
         BNE   AROUND                                                           
         SR    R4,R4                                                            
         ICM   R4,7,PUBRCHDV                                                    
         LA    R2,L'PP@VREC                                                     
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   MYSUMHD8+37(0),0(R4)                                             
AROUND   L     R2,SAVER22                                                       
         L     R4,SAVER4                                                        
         CLI   ESCPBREC,C'2'       NEW PAGE OPT                                 
         BE    WFPBR1              YES                                          
         SR    RE,RE          NEED 10 LINES TO START                            
         IC    RE,LINE                                                          
         LA    RE,10(RE)                                                        
         STC   RE,BYTE                                                          
         CLC   BYTE,MAXLINES                                                    
         BNH   *+12                                                             
WFPBR1   DS    0H                                                               
         MVI   LINE,99                                                          
         B     WFPBR2                                                           
*                                                                               
         MVI   SPACING,2                                                        
         BAS   RE,WFPBREP                                                       
*                                                                               
         MVI   SPACING,2                                                        
         MVC   P,MYSUMHD8                                                       
         BAS   RE,WFPBREP                                                       
*                                                                               
         CLC   PBHEAD10,SPACES                                                  
         BE    *+14                                                             
         MVC   P,PBHEAD10                                                       
         BAS   RE,WFPBREP                                                       
         MVI   SPACING,1                                                        
         MVC   P,PBHEAD11                                                       
         MVC   PSECOND,PBHEAD12                                                 
         BAS   RE,WFPBREP                                                       
*                                                                               
WFPBR2   DS    0H                                                               
*                                                                               
WFPBR4   BAS   RE,WFREAD                                                        
         CLC   WFREC(2),=C'PS'                                                  
         BE    WFPBR5                                                           
         CLC   WFREC(2),=C'ET'                                                  
         BE    WFPBR6                                                           
         CLC   WFREC(2),=C'VT'                                                  
         BE    WFPBR6                                                           
         CLC   WFREC(2),=C'MT'                                                  
         BE    WFPBR7                                                           
         CLC   WFREC(2),=C'DN'                                                  
         BE    WFPBR8                                                           
         CLC   WFREC(2),=C'RN'                                                  
         BE    WFPBR10                                                          
         CLC   WFREC(2),=C'DT'                                                  
         BE    WFPBR12                                                          
         CLC   WFREC(2),=C'RT'                                                  
         BE    WFPBR14                                                          
         CLC   WFREC(2),=C'GT'                                                  
         BE    WFPBR16                                                          
         DC    H'0'                                                             
*                                            SPACE RECORD                       
WFPBR5   DS    0H                                                               
         MVI   BYTE,0                                                           
         CLC   P,SPACES                                                         
         BE    *+8                                                              
         MVI   MAXLINES,99                                                      
         OC    WFREC+81(40),SPACES                                              
         MVC   P+45(13),WFREC+121            SPACE - 13 FOR NEWS                
         CLI   QMEDIA,C'N'                                                      
         BE    *+10                                                             
         MVC   P+45(17),WFREC+121            SPACE - 17 FOR MAGS                
         CLI   WFREC+81,C' '                                                    
         BNH   WFPBR5B                                                          
         CLI   QMEDIA,C'N'                                                      
         BE    *+14                                                             
         MVC   P+03(20),WFREC+81                                                
         B     WFPBR5A                                                          
*                                  NEWS                                         
         MVC   P+03(2),WFREC+134   STATE                                        
         MVI   P+05,C','                                                        
         MVC   P+07(16),WFREC+136       CITY                                    
WFPBR5A  DS    0H                                                               
         IC    R0,PAGYPROF+12                                                   
         GOTO1 PUBEDIT,DMCB,((R0),WFREC+75),P+27                                
*                                                                               
*                                                                               
*                                                                               
WFPBR5B  BAS   RE,WFPBFMT                                                       
         BAS   RE,WFPBREP                                                       
         MVC   P+03(20),WFREC+101  ZONE ON NEXT LINE                            
         CLI   QMEDIA,C'N'                                                      
         BNE   WFPBR5D                                                          
*                                  NEWS                                         
         MVC   P+03(20),WFREC+81   PUB NAME                                     
         LA    RF,P+03+20                                                       
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         MVC   3(20,RF),WFREC+101  FLOAT ZONE                                   
*                                                                               
WFPBR5D  DS    0H                                                               
         B     WFPBR4                                                           
*                                                                               
WFPBR6   DS    0H                  PUB LINE                                     
WFPBR6B  DS    0H                                                               
         MVI   MAXLINES,99                                                      
         MVC   P+45(L'PP@VNTOT),PP@VNTOT                                        
         CLI   WFREC,C'V'                                                       
         BE    *+10                                                             
         MVC   P+45(L'PP@EDTOT),PP@EDTOT                                        
         MVI   SPACING,2                                                        
         MVI   BYTE,1                                                           
*                                                                               
         BAS   RE,WFPBFMT                                                       
         BAS   RE,WFPBREP                                                       
         MVC   LASTEDVN,WFREC      SAVE LAST EDIT OR VEN                        
         B     WFPBR4                                                           
*                                                                               
*                                  MARKET TOTALS                                
WFPBR7   DS    0H                                                               
         MVC   P+03(20),WFREC+75                                                
         MVC   P+24(L'PP@MKTST),PP@MKTST                                        
         MVI   BYTE,1                                                           
         MVI   SPACING,2                                                        
         BAS   RE,WFPBFMT                                                       
         BAS   RE,WFPBREP                                                       
         B     WFPBR4                                                           
WFPBR8   DS    0H                  DISTRIC NAME                                 
         CLI   MODE,LBUYDST                                                     
         BE    WFPBR4                                                           
*                                                                               
WFPBR8B  MVC   P+03(L'PP@DIST),PP@DIST                                          
         MVC   P+12(3),WFREC+3                                                  
         MVC   P+17(20),WFREC+6                                                 
*                                                                               
         SR    RE,RE                                                            
         IC    RE,LINE                                                          
         LA    RE,3(RE)            NEED 3 LINES                                 
         STC   RE,BYTE                                                          
         CLC   BYTE,MAXLINES                                                    
         BNH   *+8                                                              
         MVI   LINE,99                                                          
         MVI   SPACING,2                                                        
         BAS   RE,WFPBREP                                                       
         B     WFPBR4                                                           
*                                                                               
WFPBR10  DS    0H                  REGION NAME                                  
         CLI   MODE,LBUYDST                                                     
         BE    WFPBR4                                                           
         CLI   MODE,LBUYREG                                                     
         BE    WFPBR4                                                           
         MVI   SPACING,2                                                        
         MVC   P+03(L'PP6REGN),PP6REGN                                          
         MVC   P+12(3),WFREC+3                                                  
         MVC   P+17(20),WFREC+6                                                 
*                                                                               
         SR    RE,RE                                                            
         IC    RE,LINE                                                          
         LA    RE,5(RE)            NEED 5 LINES                                 
         STC   RE,BYTE                                                          
         CLC   BYTE,MAXLINES                                                    
         BNH   *+8                                                              
         MVI   LINE,99                                                          
         BAS   RE,WFPBREP                                                       
         B     WFPBR4                                                           
*                                                                               
WFPBR12  DS    0H                  DISTRICT TOTAL                               
         MVC   P+24(L'PP@DTOT),PP@DTOT                                          
         MVI   BYTE,3                                                           
         BAS   RE,WFPBFMT                                                       
         MVI   SPACING,2                                                        
         MVI   MAXLINES,99                                                      
         BAS   RE,WFPBREP                                                       
         CLI   MODE,LBUYDST                                                     
         BE    WFPBRX                                                           
         B     WFPBR4                                                           
*                                                                               
WFPBR14  DS    0H                  REGION TOTALS                                
         MVC   P+24(L'PP@RTOT),PP@RTOT                                          
         MVI   BYTE,3                                                           
         BAS   RE,WFPBFMT                                                       
         MVI   SPACING,2                                                        
         MVI   MAXLINES,99                                                      
         BAS   RE,WFPBREP                                                       
         CLI   MODE,LBUYREG                                                     
         BE    WFPBRX                                                           
         B     WFPBR4                                                           
*                                                                               
WFPBR16  DS    0H                                                               
         MVI   MAXLINES,99                                                      
         BAS   RE,WFPBREP                                                       
         MVI   BYTE,3                                                           
         MVC   P+34(L'PP9TOTS),PP9TOTS                                          
WFPBR17  DS    0H                                                               
         BAS   RE,WFPBFMT                                                       
         MVI   MAXLINES,99                                                      
         BAS   RE,WFPBREP                                                       
         B     WFPBRX                                                           
*                                                                               
WFPBRX   L     RE,SAVERE                                                        
         BR    RE                                                               
*                                                                               
WFPBREP  DS    0H                                                               
         CLI   PRNTSW,C'N'                                                      
         BE    WFPBREP2                                                         
         MVC   HEAD8,MYSUMHD8                                                   
         MVC   HEAD10,PBHEAD10                                                  
         MVC   HEAD11,PBHEAD11                                                  
         MVC   HEAD12,PBHEAD12                                                  
WFPBREP2 DS    0H                                                               
         LR    R0,RE                                                            
         GOTO1 APRNT                                                            
*                                                                               
         MVC   MAXLINES,SAVEMAX                                                 
         LR    RE,R0                                                            
         BR    RE                                                               
*                                                                               
WFPBFMT  LR    R7,RE                                                            
         LA    R4,P+62                                                          
         LA    R5,ESCDETS                                                       
         LA    R6,3                                                             
WFPBFMT2 CLI   0(R5),1             GROSS                                        
         BE    WFPBFMT4                                                         
         CLI   0(R5),2             NET                                          
         BE    WFPBFMT5                                                         
         CLI   0(R5),4             GROSS - CD                                   
         BE    WFPBFMT6                                                         
         CLI   0(R5),X'11'         ACTUAL COST                                  
         BE    WFPBCOST                                                         
         CLI   0(R5),5             NET - CD                                     
         BE    WFPBFMT7                                                         
WFPBFMT3 LA    R5,1(R5)                                                         
         BCT   R6,WFPBFMT2                                                      
         B     WFPBFMTL            GO SEE IF SHOWING LINES                      
*                                                                               
WFPBCOST LA    RF,WFPBACT                                                       
         B     WFPBFMT9                                                         
*                                                                               
WFPBFMT4 LA    RF,WFPBGR                                                        
         B     WFPBFMT9                                                         
WFPBFMT5 LA    RF,WFPBNT                                                        
         B     WFPBFMT9                                                         
WFPBFMT6 LA    RF,WFPBGRCD                                                      
         B     WFPBFMT9                                                         
WFPBFMT7 LA    RF,WFPBNTCD                                                      
         B     WFPBFMT9                                                         
*                                                                               
WFPBFMT9 DS    0H                                                               
         CLI   ESCLINS,C'0'    SEE IF SOMETHIN ELSE IN 3RD COLUMN               
         BE    WFPBFMTB        NO                                               
         LA    RE,P+62+15+15   SEE IF AT 3RD COLUMN                             
         CR    R4,RE                                                            
         BE    WFPBFMTL                                                         
*                                                                               
WFPBFMTB BASR  RE,RF                                                            
         LA    R4,15(R4)                                                        
         B     WFPBFMT3                                                         
*                                                                               
WFPBFMTL DS    0H                                                               
         TM    ESCLINS,X'01'       LINES                                        
         BZ    WFPBFMTX                                                         
         BAS   RE,WFPBLN                                                        
*                                                                               
WFPBFMTX LR    RE,R7                                                            
         BR    RE                                                               
*                                                                               
***********************************************************************         
*                                                                               
WFPBGR   MVC   DUB,WFREC+3         GROSS                                        
         B     WFPBEDT                                                          
*                                                                               
WFPBNT   MVC   DUB,WFREC+3         GROSS                                        
         SP    DUB,WFREC+19(8)     LESS AC = NET                                
         B     WFPBEDT                                                          
*                                                                               
WFPBGRCD MVC   DUB,WFREC+3         GROSS                                        
         SP    DUB,WFREC+11(8)     GROSS - CD                                   
         B     WFPBEDT                                                          
*                                                                               
WFPBNTCD MVC   DUB,WFREC+3         GROSS                                        
         SP    DUB,WFREC+19(8)     LESS AC = NET                                
         SP    DUB,WFREC+11(8)     NET - CD                                     
         B     WFPBEDT                                                          
*                                                                               
WFPBACT  DS    0H                  ACTUAL COST                                  
         MVC   DUB,WFREC+43                                                     
*                                                                               
WFPBEDT  DS    0H                                                               
         TM    BYTE,X'02'          SEE IF DST TOTAL OR HIGHER                   
         BZ    WFPBEDT4            NO                                           
         CLI   ESCCENTS,C'$'    YES - SEE IF CARRIED IN $ AMTS                  
         BNE   WFPBEDT4            NO                                           
         ST    RE,SAVERE1                                                       
         ST    RF,SAVERF                                                        
         ST    R1,SAVER1                                                        
         MVI   MYCTAB+3,0                                                       
         CURED (P8,DUB),(14,1(R4)),MYCTAB,COMMAS=YES,                  +        
               FLOAT=-,MODADDR=ACUREDIT                                         
         L     R1,SAVER1                                                        
         L     RF,SAVERF                                                        
         L     RE,SAVERE1                                                       
         B     WFPBEDT6                                                         
*                                                                               
WFPBEDT4 DS    0H                                                               
         ST    RE,SAVERE1                                                       
         ST    RF,SAVERF                                                        
         ST    R1,SAVER1                                                        
         MVI   MYCTAB+3,2                                                       
         CURED (P8,DUB),(14,1(R4)),MYCTAB,COMMAS=YES,                  +        
               FLOAT=-,MODADDR=ACUREDIT                                         
         L     R1,SAVER1                                                        
         L     RF,SAVERF                                                        
         L     RE,SAVERE1                                                       
WFPBEDT6 TM    BYTE,X'01'          SEE IF TOTAL                                 
         BZR   RE                                                               
         MVI   15(R4),C'*'                                                      
         BR    RE                  RETURNS FOR NEXT ESCDETS ENTRY               
*                                                                               
***********************************************************************         
*                                                                               
WFPBLN   MVC   DUB,WFREC+3+24                                                   
         CLI   ESCCIRC,C'T'                                                     
         BE    WFPBLIN2                                                         
         CLI   QMEDIA,C'N'                                                      
         BNE   WFPBLIN2                                                         
*                                                                               
         TM    ESCLINS,X'20'       LINES VS INCHES                              
         BNZ   WFPBLIN2                                                         
         AP    DUB,=P'7'                                                        
         DP    DUB,=P'14'          INCH = 14 LINES                              
         ZAP   DUB,DUB(6)          GET QUOTIENT                                 
WFPBLIN2 DS    0H                                                               
         ST    RE,SAVERE1                                                       
         ST    RF,SAVERF                                                        
         ST    R1,SAVER1                                                        
         MVI   MYCTAB+3,0                                                       
         CURED (P8,DUB),(13,2(R4)),MYCTAB,COMMAS=YES,MODADDR=ACUREDIT           
         L     R1,SAVER1                                                        
         L     RF,SAVERF                                                        
         L     RE,SAVERE1                                                       
         CLI   BYTE,1                                                           
         BLR   RE                                                               
         MVI   15(R4),C'*'                                                      
         BR    RE                                                               
         SPACE 2                                                                
         EJECT                                                                  
*                                                                               
***********************************************************************         
*                                                                               
*                                  REG/DIST RECAP                               
         SPACE 2                                                                
WFRDR    ST    RE,SAVERE                                                        
         SR    RE,RE               NEED 10 LINES TO START                       
         IC    RE,LINE                                                          
         LA    RE,10(RE)                                                        
         STC   RE,BYTE                                                          
         CLC   BYTE,MAXLINES                                                    
         BNH   *+12                                                             
         MVI   LINE,99                                                          
         B     WFRDR2                                                           
*                                                                               
         MVI   SPACING,2                                                        
         BAS   RE,WFRDREP                                                       
*                                                                               
         MVC   P,MYSUMHD8                                                       
         BAS   RE,WFRDREP                                                       
         MVI   SPACING,2                                                        
         MVC   P(18),RDHEAD11                                                   
         MVC   PSECOND(18),RDHEAD12                                             
         BAS   RE,WFRDREP                                                       
*                                                                               
WFRDR2   DS    0H                                                               
         MVI   SUMSW,C'I'                                                       
         MVC   SUMSUMS,ESCSUMS                                                  
         CLI   BUDSW,0             TEST BUDGET DATA                             
         BNE   *+10                YES                                          
         MVC   SUMSUMS,ESCSUMSB    NO- SUPRESS BUDGET COLS                      
*                                                                               
WFRDR4   BAS   RE,WFREAD                                                        
         CLC   WFREC(2),=C'RN'                                                  
         BE    WFRDR6                                                           
         CLC   WFREC(2),=C'DT'                                                  
         BE    WFRDR8                                                           
         CLC   WFREC(2),=C'RT'                                                  
         BE    WFRDR10                                                          
         CLC   WFREC(2),=C'GT'                                                  
         BE    WFRDR12                                                          
         B     WFRDR4                                                           
*                                                                               
WFRDR6   CLI   MODE,LBUYREG                                                     
         BE    WFRDR4                                                           
         CLC   QDIST,=C'ALL'                                                    
         BNE   WFRDR4                                                           
         MVC   P+3(3),WFREC+3                                                   
         MVC   P+8(20),WFREC+6                                                  
         MVI   SPACING,2                                                        
*                                                                               
         SR    RE,RE                                                            
         IC    RE,LINE                                                          
         LA    RE,4(RE)            NEED 4 LINES                                 
         STC   RE,BYTE                                                          
         CLC   BYTE,MAXLINES                                                    
         BNH   *+8                                                              
         MVI   LINE,99                                                          
         BAS   RE,WFRDREP                                                       
         B     WFRDR4                                                           
*                                                                               
WFRDR8   MVC   P+6(3),WFREC+75                                                  
         MVC   P+11(20),WFREC+78                                                
         GOTO1 ASUMFMT,DMCB,WFREC+3                                             
         BAS   RE,WFRDREP                                                       
*                                                                               
         MVC   DUB,WFREC+3+32      BUDG                                         
         AP    DSTBUD,DUB                                                       
         B     WFRDR4                                                           
*                                                                               
WFRDR10  DS    0H                                                               
         CLC   DSTBUD,WFREC+3+32                                                
         BE    WFRDR10A                                                         
         CP    DSTBUD,=P'0'                                                     
         BE    WFRDR10A                                                         
         MVC   DUB,WFREC+3+32                                                   
         SP    DUB,DSTBUD                                                       
*                                                                               
         LA    RE,QTRTOTS          INITIALIZE QTRTOT (9PL8)                     
         LA    RF,9                                                             
         ZAP   0(8,RE),=P'0'                                                    
         LA    RE,8(RE)                                                         
         BCT   RF,*-10                                                          
*                                                                               
         MVC   QTRTOTS+32(8),DUB                                                
         GOTO1 ASUMFMT,DMCB,QTRTOTS                                             
*                                                                               
         MVC   P+6(L'PP@DIST),PP@DIST                                           
         MVC   P+6+L'PP@DIST(L'PP@WAUTH),PP@WAUTH                               
         MVC   PSECOND+6(L'PP@ORNB),PP@ORNB                                     
         BAS   RE,WFRDREP                                                       
*                                                                               
WFRDR10A CLI   MODE,LBUYREG                                                     
         BE    WFRDR10B                                                         
         CLC   QDIST,=C'ALL'                                                    
         BE    WFRDR10B                                                         
*                                                                               
         MVC   P+3(3),WFREC+75                                                  
         MVC   P+8(20),WFREC+78                                                 
         SR    R0,R0               NO TOTALS*                                   
         B     WFRDR10D                                                         
*                                                                               
WFRDR10B DS    0H                                                               
         MVI   MAXLINES,99         GET ON SAME PAGE                             
         BAS   RE,WFRDREP          SKIP A LINE                                  
         MVI   SPACING,2                                                        
         LA    R0,1                TOTALS*                                      
         MVC   P+3(L'PP@RTST),PP@RTST                                           
         MVI   MAXLINES,99                                                      
         L     R2,SAVER22                                                       
*                                                                               
WFRDR10D DS    0H                                                               
         GOTO1 ASUMFMT,DMCB,((R0),WFREC+3)                                      
*                                                                               
         BAS   RE,WFRDREP                                                       
*                                                                               
WFRDR10E DS    0H                                                               
         ZAP   DSTBUD,=P'0'                                                     
         AP    REGBUD,WFREC+3+32(8)                                             
*                                                                               
         CLI   MODE,LBUYREG                                                     
         BE    WFRDR12D                                                         
         B     WFRDR4                                                           
*                                                                               
WFRDR12  DS    0H                                                               
         CP    REGBUD,WFREC+3+32(8)                                             
         BE    WFRDR12C                                                         
         CP    REGBUD,=P'0'                                                     
         BNE   WFRDR12A                                                         
         CP    DSTBUD,WFREC+3+32(8)                                             
         BE    WFRDR12C                                                         
         CP    DSTBUD,=P'0'                                                     
         BE    WFRDR12C                                                         
*                                                                               
         MVC   P+3(L'PP@DIST),PP@DIST                                           
         B     *+10                                                             
WFRDR12A DS    0H                                                               
         MVC   P+3(8),SPACES                                                    
         MVC   P+5(L'PP6REGN),PP6REGN                                           
         MVC   P+5+L'PP6REGN(L'PP@WAUTH),PP@WAUTH                               
         MVC   PSECOND+3(L'PP@ORNB),PP@ORNB                                     
         MVC   DUB,WFREC+3+32                                                   
         CP    REGBUD,=P'0'                                                     
         BNE   *+14                                                             
         SP    DUB,DSTBUD                                                       
         B     *+10                                                             
         SP    DUB,REGBUD                                                       
*                                                                               
         LA    RE,QTRTOTS          INITIALIZE QTRTOT (9PL8)                     
         LA    RF,9                                                             
         ZAP   0(8,RE),=P'0'                                                    
         LA    RE,8(RE)                                                         
         BCT   RF,*-10                                                          
*                                                                               
         MVC   QTRTOTS+32(8),DUB                                                
         GOTO1 ASUMFMT,DMCB,QTRTOTS                                             
*                                                                               
         BAS   RE,WFRDREP                                                       
WFRDR12C DS    0H                                                               
         MVI   MAXLINES,99         GET ON SAME PAGE                             
         BAS   RE,WFRDREP          SKIP A LINE                                  
         MVC   P+3(L'PP8TOTS),PP8TOTS                                           
         GOTO1 ASUMFMT,DMCB,(1,WFREC+3)                                         
*                                                                               
         MVI   MAXLINES,99                                                      
         BAS   RE,WFRDREP                                                       
*                                                                               
*                                                                               
WFRDR12D ZAP   DSTBUD,=P'0'                                                     
         ZAP   REGBUD,=P'0'                                                     
         MVI   LINE,99                                                          
         B     WFRDRX                                                           
*                                                                               
WFRDRX   L     RE,SAVERE                                                        
         BR    RE                                                               
*                                                                               
***********************************************************************         
*                                                                               
WFRDREP  DS    0H                                                               
         CLI   PRNTSW,C'N'                                                      
         BE    WFRDREP3                                                         
         MVC   HEAD10,MYSUMH10                                                  
         MVC   HEAD11,MYSUMH11                                                  
         MVC   HEAD12,MYSUMH12                                                  
         MVC   HEAD11(18),RDHEAD11                                              
         MVC   HEAD12(18),RDHEAD12                                              
         MVC   HEAD8,MYSUMHD8                                                   
         CLI   BUDSW,0             TEST BUDGET DATA                             
         BNE   WFRDREP3            YES                                          
*                                  NO - SUPPRESS BUDGET COLUMNS                 
         MVC   HEAD10,MYSMBH10                                                  
         MVC   HEAD11,MYSMBH11                                                  
         MVC   HEAD12,MYSMBH12                                                  
*                                                                               
WFRDREP3 DS    0H                                                               
         LR    R0,RE                                                            
         GOTO1 APRNT                                                            
*                                                                               
         MVC   MAXLINES,SAVEMAX                                                 
         LR    RE,R0                                                            
         BR    RE                                                               
*                                                                               
***********************************************************************         
*                                                                               
         SPACE 3                                                                
WFFLOAT  OI    0(R7),C' '                                                       
         CLI   0(R7),C' '                                                       
         BNER  RE                                                               
         BCT   R7,WFFLOAT                                                       
         SPACE 3                                                                
*                                                                               
*                                                                               
WFSAVRE  DS    F                                                                
         SPACE 2                                                                
WFREAD   ST    RE,WFSAVRE                                                       
         LA    R2,PP52WFN                                                       
         LA    R0,WFREC                                                         
*&&DO                                                                           
         READ  (2),SQ,(0)                                                       
*&&                                                                             
*&&OS                                                                           
         PRINT GEN                                                              
         READ  DECB0001,SF,(2),(0)                                              
*&&                                                                             
*                                                                               
*&&DO                                                                           
         CHECK (1)                                                              
*&&                                                                             
*&&OS                                                                           
         CHECK DECB0001                CHECK                                    
*&&                                                                             
*                                                                               
         B     WFBACK                                                           
         SPACE 2                                                                
*                                                                               
***********************************************************************         
*                                                                               
WFWRITE  ST    RE,WFSAVRE                                                       
         LA    R2,PP52WFN                                                       
         LA    R0,WFREC                                                         
*&&DO                                                                           
         WRITE  (2),SQ,(0)                                                      
*&&                                                                             
*&&OS                                                                           
         WRITE DECB0002,SF,(2),(0)                                              
*&&                                                                             
*                                                                               
*&&DO                                                                           
         CHECK (2)                                                              
*&&                                                                             
*&&OS                                                                           
         CHECK DECB0002                CHECK                                    
*&&                                                                             
*                                                                               
         B     WFBACK                                                           
         SPACE 2                                                                
*                                                                               
***********************************************************************         
*                                                                               
WFPOINT  ST    RE,WFSAVRE                                                       
         LA    R1,PP52WFN                                                       
*&&DO                                                                           
         POINTR (1),(0)                                                         
*&&                                                                             
*&&OS                                                                           
         POINT (1),(0)                                                          
*&&                                                                             
*                                                                               
         B     WFBACK                                                           
         SPACE 2                                                                
WFPOINS  ST    RE,WFSAVRE                                                       
         LA    R1,PP52WFN                                                       
*&&DO                                                                           
         POINTS (1)                                                             
*&&                                                                             
*&&OS                                                                           
         POINT (1),TTRFIRST                                                     
         PRINT NOGEN                                                            
*&&                                                                             
*                                                                               
         B     WFBACK                                                           
         SPACE 2                                                                
WFNOTE   ST    RE,WFSAVRE                                                       
         LA    R1,PP52WFN                                                       
         NOTE  (1)                                                              
*                                                                               
         B     WFBACK                                                           
         SPACE 2                                                                
*                                                                               
***********************************************************************         
*                                                                               
WFBACK   L     RE,WFSAVRE                                                       
         BR    RE                                                               
*                                                                               
***********************************************************************         
*                                                                               
         SPACE 3                                                                
SAVER22  DS    F                                                                
SAVER4   DS    F                                                                
DSRCHD   DC    AL3(PP@DREC)                                                     
RGRCHD   DC    AL3(PP@RREC)                                                     
RGDSRCHD DC    AL3(PP@RDREC)                                                    
PUBRCHD  DC    AL3(PP@PREC)                                                     
PUBRCHDV DC    AL3(PP@VREC)                                                     
         EJECT                                                                  
*&&DO                                                                           
PP52WFN  DTFSD BLKSIZE=152,RECFORM=FIXUNB,TYPEFLE=WORK,NOTEPNT=YES,    X        
               EOFADDR=EOF,DEVICE=3340                                          
*&&                                                                             
*&&OS                                                                           
PP52WFN  DCB   DDNAME=PP52WFN,                                         X        
               DSORG=PS,                                               X        
               RECFM=FB,                                               X        
               LRECL=00152,                                            X        
               BLKSIZE=00152,          DOS BLKSIZE=00128               X        
               MACRF=(RP,WP)           CHECK                                    
TTRFIRST DC    A(1)                                                             
*&&                                                                             
         SPACE 3                                                                
EOF      DC    H'0'                                                             
         SPACE 3                                                                
         LTORG                                                                  
         SPACE 3                                                                
DC2LIST  DS    0C                                                               
         DCDDL PP#REGDT,15                                                      
         DCDDL PP#REGDT,15,LU,LABEL=PPUREGDT                                    
         DCDDL PP#REGN,6,LABEL=PP6REGN                                          
         DCDDL PP#REGN,6,LU,LABEL=PP6UREGN                                      
         DCDDL PP#DIST,8                                                        
         DCDDL PP#DIST,8,LU,LABEL=PPUDIST                                       
         DCDDL PP#EDTOT,18                                                      
         DCDDL PP#MKTST,17                                                      
         DCDDL PP#DTOT,19                                                       
         DCDDL PP#VNTOT,18                                                      
         DCDDL PP#RTOT,17                                                       
         DCDDL PP#TOTS,9,LABEL=PP9TOTS                                          
         DCDDL PP#WAUTH,14                                                      
         DCDDL PP#ORNB,22                                                       
         DCDDL PP#RTST,15                                                       
         DCDDL PP#REGN,8,R,LABEL=PP8REGN                                        
         DCDDL PP#TOTS,8,LABEL=PP8TOTS                                          
         DCDDL PP#DREC,28,C                                                     
         DCDDL PP#RREC,28,C                                                     
         DCDDL PP#RDREC,28                                                      
         DCDDL PP#PREC,30,C                                                     
         DCDDL PP#VREC,30,C                                                     
DC2LISTX DC    X'00'                                                            
*                                                                               
DS2LIST  DS    0C                                                               
         DSDDL PRINT=YES                                                        
         PRINT GEN                                                              
DS2LISTX EQU   *                                                                
*                                                                               
***********************************************************************         
*                                                                               
         PRINT NOGEN                                                            
         SPACE 3                                                                
         TITLE 'PP5202 - GET BUDGET RECS AND POST TO ACCUMS'                    
GETBUD   CSECT                                                                  
         NMOD1 0,**GETBUD                                                       
         USING PPWORKD,RA                                                       
         L     RC,PPFILEC                                                       
         USING PPFILED,RC,R9                                                    
         USING PP52WRKD,R8                                                      
         L     R7,APRDTAB          PRD NAME TABLE FREE UNTIL BRD SUMS           
         USING PBUDREC,R7                                                       
*                                                                               
*                                  NOTE- ALL RECORDS ARE REREAD                 
*                                  AT END OF REGION/ESTIMATE TO                 
*                                  INSURE THAT ALL ARE FOUND                    
*                                                                               
         CLI   MODE,LBUYDST                                                     
         BE    GB4                                                              
         CLI   MODE,LBUYREG                                                     
         BE    GB4                                                              
         CLI   MODE,LBUYEST                                                     
         BE    GB4                                                              
         CLI   MODE,LBUYPRO                                                     
         BNE   GB3                                                              
         CLC   QEST,=C'ALL'                                                     
         BE    GETBUDX                                                          
         B     GB4                                                              
GB3      DS    0H                                                               
         CLI   MODE,LBUYCLI                                                     
         BNE   GETBUDX                                                          
         CLI   QPRODUCT,C' '                                                    
         BNE   GETBUDX                                                          
         B     GB4                                                              
GETBUDX  XMOD1 1                                                                
*                                                                               
*                                                                               
*                                                                               
GB4      DS    0H                                                               
         MVC   WORK(L'KEY),KEY                                                  
         XC    KEY,KEY                                                          
         MVC   KEY(7),PCLTKEY                                                   
         MVI   KEY+3,X'18'                                                      
*                                                                               
         CLC   QPRODUCT,SPACES                                                  
         BE    *+20                                                             
         CLC   QPRODUCT,=C'ZZZ'                                                 
         BE    *+10                                                             
         MVC   KEY+7(3),PPRDKPRD                                                
*                                                                               
         CLC   QEST,SPACES                                                      
         BE    GB6                                                              
         CLC   QESTEND,SPACES                                                   
         BNE   GB5                                                              
         SR    R0,R0                                                            
         ICM   R0,3,PESTKEST                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  KEY+10(3),DUB                                                    
         B     GB6                                                              
*                                                                               
GB5      MVC   KEY+10(3),QEST                                                   
*                                                                               
GB6      CLI   MODE,LBUYREG                                                     
         BNE   GB8                                                              
         MVC   KEY+13(3),PREGKREG                                               
         CLC   QDIST,SPACES                                                     
         BE    GB12                                                             
         CLC   QDIST,=C'ALL'                                                    
         BE    GB12                                                             
         MVC   KEY+16(3),QDIST                                                  
         B     GB12                                                             
*                                                                               
GB8      CLI   MODE,LBUYDST                                                     
         BNE   GB10                                                             
         MVC   KEY+13(6),PDSTKREG                                               
         B     GB12                                                             
*                                                                               
GB10     CLC   QREGION,SPACES                                                   
         BE    *+20                                                             
         CLC   QREGION,=C'ALL'                                                  
         BE    *+10                                                             
         MVC   KEY+13(3),QREGION                                                
         CLC   QDIST,SPACES                                                     
         BE    *+20                                                             
         CLC   QDIST,=C'ALL'                                                    
         BE    *+10                                                             
         MVC   KEY+16(3),QDIST                                                  
*                                                                               
GB12     BAS   RE,GBHIGH                                                        
         B     *+8                                                              
*                                                                               
GB14     BAS   RE,GBSEQ                                                         
         CLC   KEY(7),KEYSAVE                                                   
         BNE   GB50                                                             
*                                                                               
         OC    KEYSAVE+7(3),KEYSAVE+7                                           
         BZ    *+14                                                             
         CLC   KEY+7(3),KEYSAVE+7                                               
         BNE   GB50                                                             
*                                                                               
         OC    KEYSAVE+10(3),KEYSAVE+10                                         
         BZ    GB15                                                             
         CLC   KEY+10(3),KEYSAVE+10                                             
         BE    GB15                                                             
         CLC   QESTEND,SPACES                                                   
         BE    GB14                                                             
         CLC   KEY+10(3),QESTEND                                                
         BH    GB14                                                             
*                                                                               
GB15     DS    0H                                                               
         OC    KEYSAVE+13(3),KEYSAVE+13                                         
         BZ    *+14                                                             
         CLC   KEY+13(3),KEYSAVE+13                                             
         BNE   GB14                                                             
*                                                                               
         OC    KEYSAVE+16(3),KEYSAVE+16                                         
         BZ    *+14                                                             
         CLC   KEY+16(3),KEYSAVE+16                                             
         BNE   GB14                                                             
*                                                                               
         CLC   QPRODUCT,=C'ZZZ'                                                 
         BNE   GB20                                                             
*                                  IF ZZZ MAKE SURE THERE IS A                  
*                                  ZZZ EST FOR THIS BUDGET REC                  
         MVC   WORK2(64),KEY       SAVE KEY AND KEYSAVE                         
         MVI   KEY+3,7                                                          
         MVC   KEY+7(3),=C'ZZZ'                                                 
         PACK  DUB,KEY+10(3)                                                    
         CVB   R0,DUB                                                           
         STH   R0,KEY+10                                                        
         XC    KEY+12(13),KEY+12                                                
         BAS   RE,GBHIGH                                                        
         MVI   BYTE,0                                                           
         CLC   KEY(25),KEYSAVE                                                  
         BE    *+8                                                              
         MVI   BYTE,1              NOT FOUND                                    
         MVC   KEY,WORK2           RESTORE KEY                                  
         BAS   RE,GBHIGH                                                        
         MVC   KEYSAVE,WORK2+32    RESTORE KEYSAVE                              
         CLI   BYTE,1                                                           
         BE    GB14                DO NOT PROCESS                               
*                                                                               
*                                                                               
GB20     DS    0H                                                               
         BAS   RE,GBGETREC                                                      
*                               SEE IF DOING $ IN DST AND HIGHER                
         CLI   ESCCENTS,C'$'                                                    
         BNE   *+8                                                              
         BAS   RE,BCONDOL                                                       
*                                                                               
         DS    0H                                                               
         OC    PBUDAMTS(48),PBUDAMTS                                            
         BNZ   GB22                                                             
*                                  NO MONTHLY AMOUNTS                           
         LA    R0,1                DST                                          
         L     R4,ADSTTOT                                                       
         CLI   MODE,LBUYDST                                                     
         BE    GB20A                                                            
         L     R4,AREGTOT                                                       
         CLI   MODE,LBUYREG                                                     
         BE    GB20A                                                            
         LA    R0,5                EST/PRD/DIV/CLT/XRQ                          
         L     R4,AESTTOT                                                       
GB20A    DS    0H                                                               
         MVC   FULL,PBUDAMTS+48                                                 
         L     R5,FULL                                                          
         CVD   R5,DUB                                                           
GB21     AP    ACCL-16(8,R4),DUB   POST BUDG TOTALS                             
         LA    R4,ACCL(R4)         NEXT ENTRY                                   
         BCT   R0,GB21                                                          
         B     GB30                                                             
*                                                                               
GB22     DS    0H                                                               
         LA    R2,RMTAB                                                         
         GOTO1 DATCON,DMCB,(0,PBUDST),(3,DUB)                                   
*                                                                               
GB23     CLC   DUB(2),0(R2)                                                     
         BE    GB24                                                             
         OC    0(2,R2),0(R2)                                                    
         LA    R2,2(R2)                                                         
         BNZ   GB23                                                             
         B     GB14                                                             
*                                                                               
GB24     ST    R2,WORK2            SAVE MONTH ADDR OF BUDGET START              
         LA    R0,RMTAB                                                         
         SR    R2,R0                                                            
         MH    R2,=Y(ROWL/2)                                                    
         ST    R2,IMDSPL                                                        
*                                                                               
         LA    R0,1                DST                                          
         L     R4,ADSTTOT                                                       
         CLI   MODE,LBUYDST                                                     
         BE    GB24A                                                            
         L     R4,AREGTOT                                                       
         CLI   MODE,LBUYREG                                                     
         BE    GB24A                                                            
         LA    R0,5                EST/PRD/DIV/CLT/XRQ                          
         L     R4,AESTTOT                                                       
GB24A    DS    0H                                                               
GB25     L     R3,WORK2                                                         
         L     R2,IMDSPL                                                        
         LA    R6,PBUDAMTS                                                      
         LA    R5,12               FOR INTERIOR BCT                             
*                                                                               
GB26     CLC   0(2,R3),BSTART                                                   
         BL    GB27                                                             
         CLC   0(2,R3),BEND                                                     
         BH    GB28                                                             
*                                                                               
         MVC   DUB(4),0(R6)                                                     
         L     RE,DUB                                                           
         CVD   RE,DUB                                                           
         LR    RE,R4                                                            
         AR    R4,R2                                                            
         AP    32(8,R4),DUB                                                     
         LR    R4,RE                                                            
*                                                                               
GB27     LA    R3,2(R3)                                                         
         LA    R2,ROWL(R2)                                                      
         LA    R6,4(R6)                                                         
         BCT   R5,GB26                                                          
*                                                                               
GB28     LA    R4,ACCL(R4)                                                      
         BCT   R0,GB25                                                          
*                                                                               
*                                                                               
GB30     DS    0H                                                               
         CLI   MODE,LBUYDST                                                     
         BE    GB14                                                             
         CLI   MODE,LBUYREG                                                     
         BE    GB14                                                             
**NEW 2/18/88                                                                   
         CLI   RCALLALL,C'Y'         SEE IF SPECIAL EC/52 REQUEST               
         BE    GB14                  FROM BILLING REQUEST                       
*                                    NO BRAND SUMMARIES                         
**NEW 2/18/88                                                                   
         CLC   QPRODUCT,=C'ZZZ'                                                 
         BE    GB32                                                             
         CLC   QPRODUCT,=C'ALL'                                                 
         BE    GB32                                                             
         CLC   QPRODUCT,SPACES                                                  
         BE    GB32                                                             
         B     GB14                                                             
*                                  POST TO BRAND SUMS                           
GB32     L     R3,ABRDT            FIND BRD ACCUM OR ADD ONE                    
         LA    R4,ACCL                                                          
         L     R5,ABRDTX                                                        
*                                                                               
GB33     OC    ACCL-8(3,R3),ACCL-8(R3)                                          
         BE    GB34                                                             
         CLC   ACCL-8(3,R3),PBUDKPRD                                            
         BE    GB34                                                             
         BXLE  R3,R4,GB33                                                       
         DC    H'0'                                                             
*                                                                               
GB34     L     R4,ABRDT                                                         
         SR    R4,R3                                                            
         LPR   R4,R4                                                            
         A     R4,ABRDTB                                                        
*                                                                               
         MVC   ACCL-8(3,R3),PBUDKPRD    MOVE PRODUCT CODES                      
         MVC   ACCL-8(3,R4),PBUDKPRD                                            
*                                                                               
         OC    PBUDAMTS(48),PBUDAMTS                                            
         BNZ   GB35                                                             
*                                  NO MONTHLY $                                 
         MVC   FULL,PBUDAMTS+48                                                 
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         AP    ACCL-16(8,R3),DUB   POST BUDGET TOTAL                            
         B     GB14                DONE                                         
*                                                                               
GB35     A     R3,IMDSPL                                                        
         L     R2,WORK2            MONTH ADDR OF BUD START                      
         LA    R6,PBUDAMTS                                                      
         LA    R0,12               FOR BCT LOOP                                 
GB36     CLC   0(2,R2),BSTART                                                   
         BL    GB37                                                             
         CLC   0(2,R2),BEND                                                     
         BH    GB14                DONE                                         
         MVC   DUB(4),0(R6)                                                     
         L     RE,DUB                                                           
         CVD   RE,DUB                                                           
         AP    32(8,R3),DUB                                                     
GB37     LA    R3,ROWL(R3)                                                      
         LA    R2,2(R2)                                                         
         LA    R6,4(R6)                                                         
         BCT   R0,GB36                                                          
         B     GB14                                                             
*                                                                               
GB50     DS    0H                                                               
         MVC   KEY,WORK                                                         
         BAS   RE,GBHIGH                                                        
         B     GETBUDX                                                          
         SPACE 3                                                                
*                                                                               
GBHIGH   MVC   KEYSAVE,KEY                                                      
         LA    R2,DMRDHI                                                        
         B     *+8                                                              
GBSEQ    LA    R2,DMRSEQ                                                        
*                                                                               
         ST    RE,SAVERE                                                        
         GOTO1 DATAMGR,DMCB,(DMINBTS,(R2)),PRTDIR,KEY,KEY                       
*                                                                               
         B     GBDMCHK                                                          
*                                                                               
GBGETREC ST    RE,SAVERE                                                        
         GOTO1 DATAMGR,DMCB,(DMINBTS,GETREC),PRTFILE,KEY+27,           X        
               PBUDREC,DMWORK                                                   
*                                                                               
GBDMCHK  DS    0H                                                               
         MVC   BYTE,DMCB+8                                                      
         NC    BYTE,DMOUTBTS                                                    
         BZ    *+6                                                              
         DC    H'0'                                                             
         L     RE,SAVERE                                                        
         BR    RE                                                               
         SPACE 3                                                                
*                                                                               
***********************************************************************         
*                                                                               
BCONDOL  NTR1         CONVERT TO $ AMOUNTS                                      
         LA    R6,13    12 MTHS AND TOTAL                                       
         LA    R7,PBUDAMTS                                                      
*                                                                               
BCOND5   L     R2,0(R7)                                                         
         SR    R3,R3                                                            
         SRDA  R2,31                                                            
         D     R2,=F'100'                                                       
         LTR   R3,R3                                                            
         BM    *+8                                                              
         AHI   R3,1                                                             
         SRA   R3,1                                                             
         ST    R3,0(R7)                                                         
         LA    R7,4(R7)                                                         
         BCT   R6,BCOND5                                                        
*                                                                               
BCONDX   XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
***********************************************************************         
*                                                                               
         EJECT                                                                  
FNDJOB   CSECT                                                                  
         NMOD1 0,FNDJOB                                                         
         SPACE 2                                                                
         USING PPWORKD,RA                                                       
         L     RC,PPFILEC                                                       
         USING PPFILED,RC,R9                                                    
         USING PP52WRKD,R8                                                      
         SPACE 2                                                                
         XC    DMCB(4),DMCB                                                     
         LA    R6,WKJOB                                                         
         CLI   WKJOB,C' '                                                       
         BH    FJ1                                                              
         LA    R6,PBDJOB                                                        
         CLI   QOPT3,C'S'          IF SUMMARY ONLY                              
         BE    FNDJOBX             THEN NO JOB RECORDS                          
FJ1      DS    0H                                                               
         OC    0(6,R6),0(R6)                                                    
         BE    FNDJOBX             NO JOB NO.                                   
*                                                                               
FJ2      DS    0H                                                               
         L     R3,AJOBLST                                                       
         OC    0(2,R3),0(R3)                                                    
         BNZ   FJ3                                                              
         MVC   0(2,R3),=Y(JOBLSTEL)                                             
         LA    R5,5(R3)                                                         
         ST    R5,2(R3)                                                         
*                                                                               
FJ3      DS    0H                                                               
         LH    R4,0(R3)                                                         
         L     R5,2(R3)                                                         
         LA    R3,6(R3)                                                         
*                                                                               
*                                                                               
FJ4      DS    0H                                                               
         CLC   PBUYKPRD,0(R3)                                                   
         BNE   *+14                                                             
         CLC   0(6,R6),3(R3)                                                    
         BE    FJ8                                                              
         BXLE  R3,R4,FJ4                                                        
*                                                                               
         BAS   RE,RJOB                                                          
*                                                                               
         LH    R0,=Y(JOBLSTEL*JOBLSTN+6-1)                                      
         A     R0,AJOBLST                                                       
         CR    R0,R5                                                            
         BH    *+6                                                              
         SR    R3,R4               NO MORE ROOM - USE LAST OVER                 
         MVC   0(3,R3),PBUYKPRD                                                 
         MVC   3(6,R3),0(R6)                                                    
         MVC   9(17,R3),PJOBCPY                                                 
         MVC   26(50,R3),PJOBCAP1                                               
         AR    R4,R3                                                            
         BCTR  R4,R0                                                            
         L     R5,AJOBLST                                                       
         ST    R4,2(R5)                                                         
FJ8      DS    0H                                                               
         ST    R3,DMCB             RETURN A(JOB INFO)                           
         B     FNDJOBX                                                          
*                                                                               
FNDJOBX  DS    0H                                                               
         XIT1                                                                   
         EJECT                                                                  
RJOB     NTR1                                                                   
         SPACE 2                                                                
         MVC   WORK(64),KEY                                                     
         XC    KEY,KEY                                                          
         MVC   KEY(10),PBUYKEY                                                  
         MVI   KEY+3,X'15'                                                      
         MVC   KEY+10(6),0(R6)                                                  
         BAS   RE,RJHI                                                          
         CLC   KEY(25),KEYSAVE                                                  
         BE    RJ2                                                              
         MVC   PJOBCPY,SPACES                                                   
         MVC   PJOBCPY(13),=C'**NOT FOUND**'                                    
         MVC   PJOBCAP1(50),SPACES                                              
         B     RJ4                                                              
RJ2      DS    0H                                                               
         BAS   RE,RJGET                                                         
*                                                                               
RJ4      DS    0H                                                               
         MVC   KEY,WORK                                                         
         BAS   RE,RJHI             RESTORE SEQ                                  
         B     RJOBX                                                            
*                                                                               
RJOBX    DS    0H                                                               
         XIT1                                                                   
         SPACE 3                                                                
RJHI     MVC   KEYSAVE,KEY                                                      
         LA    R2,DMRDHI                                                        
*                                                                               
         ST    RE,SAVERE                                                        
         GOTO1 DATAMGR,DMCB,(DMINBTS,(R2)),PRTDIR,KEY,KEY                       
*                                                                               
         B     RJDMCK                                                           
*                                                                               
RJGET    ST    RE,SAVERE                                                        
         GOTO1 DATAMGR,DMCB,(DMINBTS,GETREC),PRTFILE,KEY+27,           X        
               PJOBREC,DMWORK                                                   
*                                                                               
RJDMCK   DS    0H                                                               
         MVC   BYTE,DMCB+8                                                      
         NC    BYTE,DMOUTBTS                                                    
         BZ    *+6                                                              
         DC    H'0'                                                             
         L     RE,SAVERE                                                        
         BR    RE                                                               
         SPACE 2                                                                
         DROP R7                                                                
         EJECT                                                                  
         LTORG                                                                  
*                                                                               
JOBLSTEL EQU   76                                                               
JOBLSTN  EQU   20                                                               
*                                                                               
         CNOP  2,4                                                              
JOBLST   DC    H'0'                                                             
         DC    A(JOBLSTEL)                                                      
         DC    A(0)                                                             
*                                                                               
         ORG   *+JOBLSTEL*JOBLSTN                                               
*                                  PRD/JOB/COPY/CAPTIONS                        
       ++INCLUDE PP52WRK                                                        
*                                                                               
         PRINT OFF                                                              
*                                                                               
       ++INCLUDE PPREPWORK                                                      
       ++INCLUDE PPREPWORK2                                                     
         PRINT ON                                                               
         ORG   Q2USER                                                           
QCOMM    DS    CL6                 STANDARD COMMENT COL 21 REQ CARD 2           
         ORG                                                                    
*                                                                               
         PRINT OFF                                                              
       ++INCLUDE PPDDEQUS                                                       
       ++INCLUDE PPNEWFILE                                                      
       ++INCLUDE PPMODEQU                                                       
       ++INCLUDE DDDICTATED                                                     
*                                                                               
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'025PPREP52C  02/25/20'                                      
         END                                                                    
