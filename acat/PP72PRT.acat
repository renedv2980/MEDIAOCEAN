*          DATA SET PP72PRT    AT LEVEL 010 AS OF 07/17/18                      
*CATALP PP72PRT                                                                 
*                                                                               
         TITLE 'PP72PRT- PRINT CHANGE LOG'                                      
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
* SMUR 04/18  SPEC-17729  NEW MEDIA (D)IGITAL AUDIO                             
*                                                                               
* BPLA 07/15    CHANGES FOR NEW MEDIA CODES                                     
*                                                                               
* BPLA 04/02    FIX PAGE DISPLAY                                                
*                                                                               
* BPLA 10/00    CHANGES FOR ONEEOPT (EST IN HEADLINES)                          
*               SPECIAL NOTE - ON P72 REQUESTS                                  
*               QEST WILL BE BLANK (FOR ALL)                                    
*               OR A SINGLE EST                                                 
*               CHANGE ASSUMES THIS                                             
*                                                                               
* BPLA 06/00    NOW LIVE SOURCE (WAS PP72PRTB)                                  
*               CATALP AND ++INCLUDE PP72WORK RESTORED                          
*                                                                               
* SMYE 10/18/99 USE "INTERACTIVE" FOR MEDIA NAME IN PLACE OF OTHER              
*               SPELLINGS (AT LABEL PH4D)                                       
*                                                                               
* SMYE 04/16/99 "JULJUI" CHANGED TO "JULJUL" IN DATETAB                         
*                                                                               
* BPLA 11/98    WEBOPT - OPTION TO PRINT WEBSITE UNDER TELEPHONE                
*               AND FAX                                                         
*                                                                               
* BPLA 05/98    ADJUST END OF PAGE ROUTINE FOR MAXLADJ                          
*                                                                               
* BPLA 12/97    NEW VALUES FOR NAMOPT (AGY NAME + ADDR SUPPRESSION)             
*               "B" - SUPPRESS ONLY AT BOTTOM                                   
*               "T" = SUPPRESS ONLY AT TOP                                      
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
         TITLE 'INSERTION ORDERS - PRINT CONTROL'                               
IOPRNT   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 0,**IOPRT*,RR=R7                                                 
*                                                                               
         ST    R7,RELO                                                          
         B     *+8                                                              
RELO     DC    F'0'                                                             
*                                                                               
         USING PPWORKD,RA                                                       
         USING IOWORKD,R8                                                       
         USING PPFILED,RC,R9                                                    
         L     RC,PPFILEC                                                       
*                                                                               
         CLI   PRINTSW,C'N'                                                     
         BNE   PRT0                                                             
         OC    ERR(2),ERR                                                       
         BZ    PRTX                                                             
*                                                                               
PRT0     DS    0H                                                               
         CLI   FORCEFUT,C'Y'                                                    
         BNE   PRT1                                                             
         BAS   RE,PRTEOP                                                        
         B     PRTX                                                             
*                                  CHECK END OF PAGE                            
PRT1     DS    0H                                                               
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         IC    RE,LINE                                                          
         IC    RF,LINENEED         LINES NEEDED                                 
         AR    RE,RF                                                            
         STC   RE,BYTE                                                          
         CLC   BYTE,MAXLINES                                                    
         BL    *+8                                                              
         MVI   FORCEHED,C'Y'                                                    
         MVI   LINENEED,0                                                       
         CLI   FORCEHED,C'Y'                                                    
         BNE   PRT4                                                             
         CLC   P,SPACES            DONT LET BLANK LINE CAUSE NEW PAGE           
         BE    PRTX                                                             
         CLC   PAGE,=H'1'                                                       
         BE    PRT2                                                             
         BAS   RE,PRTEOP                                                        
*                                                                               
PRT2     DS    0H                                                               
         BAS   RE,PRTHEAD                                                       
*                                                                               
PRT4     DS    0H                                                               
         GOTO1 REPORT                                                           
*                                                                               
PRTX     XIT1                                                                   
         EJECT                                                                  
*                                                                               
PRTEOP   NTR1                      END OF PAGE                                  
         MVI   FORCEHED,C'N'                                                    
         MVC   SAVEMAX,MAXLINES                                                 
         MVI   MAXLINES,99                                                      
         MVC   SAVEP,P                                                          
         MVC   SAVEP2,PSECOND                                                   
         MVC   SAVESPAC,SPACING                                                 
         MVC   P,SPACES                                                         
         MVC   PSECOND,SPACES                                                   
         CLI   FORCEFUT,C'Y'       CONT MSG ONLY IF MORE TO PRINT               
         MVI   FORCEFUT,C'N'                                                    
         BE    EOP4                                                             
*                                                                               
EOP2     DS    0H                                                               
         MVI   P,0                                                              
         MVC   PSECOND+35(11),=C'(CONTINUED)'                                   
         GOTO1 REPORT                                                           
*                                                                               
EOP4     DS    0H                                                               
         SR    R0,R0                                                            
         IC    R0,LINE                                                          
         LA    R4,79               BOTTOM LINE                                  
         ZIC   R1,MAXLADJ                                                       
         SR    R4,R1               ADJUST BOTTOM LINE                           
         SR    R4,R0                                                            
*                                                                               
EOP6     DS    0H                                                               
         CHI   R4,3                                                             
         BL    EOP8                                                             
         MVI   SPACING,3                                                        
         GOTO1 REPORT                                                           
*                                                                               
         AHI   R4,-3                                                            
         B     EOP6                                                             
*                                                                               
EOP8     DS    0H                                                               
         LTR   R4,R4                                                            
         BNP   EOP10                                                            
         STC   R4,SPACING                                                       
         GOTO1 REPORT                                                           
*                                                                               
EOP10    DS    0H                                                               
         L     RF,LOGOC                                                         
         MVC   W+20(4),LOGOJOB-LOGOD(RF)                                        
         XC    W(15),W             NO-OP X'S                                    
         CLI   XXOPT,C'N'                                                       
         BE    EOP12                                                            
         MVC   W(15),=15C'X'                                                    
EOP12    LA    R1,P+21                                                          
*                                                                               
         CLI   NAMOPT,C'T'         SEE IF SUPPRESSING ONLY AT TOP               
         BE    EOP12C                                                           
*                                                                               
         CLI   NAMOPT,C'N'         TEST SUPRESS NAME                            
         BNE   EOP13               YES                                          
*                                                                               
EOP12C   DS    0H                                                               
         MVC   000(33,R1),PAGYNAME                                              
         MVC   132(33,R1),PAGYADDR                                              
EOP13    DS    0H                                                               
         MVC   P+1(15),W                                                        
         MVC   PSECOND+1(15),W                                                  
         MVC   P+77(1),W+20        JOB NAME                                     
         MVC   PSECOND+77(1),W+21                                               
         GOTO1 REPORT                                                           
*                                                                               
         MVC   P+1(15),W                                                        
         MVC   PSECOND+1(15),W                                                  
         MVC   P+77(1),W+22        JOB NAME + 2                                 
         MVC   PSECOND+77(1),W+23                                               
         GOTO1 REPORT                                                           
*                                                                               
         MVC   P+1(15),W                                                        
         MVC   P+64(12),PJOBSIG                                                 
         GOTO1 REPORT                                                           
*                                  RESTORE PRINTS                               
EOPX     DS    0H                                                               
         MVC   P,SAVEP                                                          
         MVC   PSECOND,SAVEP2                                                   
         MVC   SPACING,SAVESPAC                                                 
         MVC   MAXLINES,SAVEMAX                                                 
         MVI   FORCEHED,C'Y'                                                    
*                                                                               
         J     PRTX                                                             
         EJECT                                                                  
*                                  HEADLINES                                    
PRTHEAD  NTR1                                                                   
*                                                                               
         CLI   SKIPSPEC,C'Y'                                                    
         MVI   FORCEHED,C'Y'                                                    
*                                                                               
         BE    PRTHEADX                                                         
         CLI   HLIN1,C' '          TEST ALREADY BUILT                           
         BNE   PH20                YES                                          
*                                                                               
         LA    R0,14                                                            
         LA    R1,HLIN1                                                         
         MVC   0(132,R1),SPACES                                                 
         LA    R1,132(R1)                                                       
         BCT   0,*-10                                                           
*                                                                               
* TRY SETTING DICTIONARY HERE USING PUBLANG                                     
*                                                                               
         L     R5,=A(DICSECTI)                                                  
         A     R5,RELO                                                          
         USING DICSECTI,R5                                                      
         XC    DMCB,DMCB                                                        
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL      TRANSLATE LIST                               
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,4                                                          
         MVI   DDLANG,0            DEFAULT TO ENGLISH                           
         CLI   PUBLANG,C'F'                                                     
         BNE   *+8                                                              
         MVI   DDLANG,4            4 IS FRENCH                                  
         LA    RF,DCLIST                                                        
         STCM  RF,7,DDIADR                                                      
         LA    RF,DSLIST                                                        
         STCM  RF,7,DDOADR                                                      
         GOTO1 ADICTATE                                                         
         DROP  R1,R5                                                            
*                                                                               
         L     R5,=A(DICSECTI)                                                  
         A     R5,RELO                                                          
         USING DICSECTI,R5                                                      
*                                                                               
* OLD HEAD FORMAT - THRU PHC2 -                                                 
*                                                                               
         CLI   OLDOPT,C'N'                                                      
         BE    PHC2                                                             
         CLI   PUBLANG,C'F'        IF FRENCH MUST USE SPECIAL CODE              
         BE    FRPH                                                             
         LA    R1,HLIN1+1                                                       
         MVC   000(12,R1),STARS                                                 
         MVI   132(R1),C'*'                                                     
         MVC   264(11,R1),=C'* INSERTION'                                       
         MVI   396(R1),C'*'                                                     
         MVC   528(12,R1),STARS                                                 
         CLI   CHANGSW,0                                                        
         BNE   PHA                                                              
         MVC   000+012(07,R1),STARS                                             
         MVI   132+018(R1),C'*'                                                 
         MVC   264+012(07,R1),=C'ORDER *'                                       
         MVI   396+018(R1),C'*'                                                 
         MVC   528+012(07,R1),STARS                                             
         B     PHC                                                              
*                                                                               
PHA      DS    0H                                                               
         CLI   CHANGSW,C'C'                                                     
         BNE   PHB                                                              
         MVC   000+012(14,R1),STARS                                             
         MVI   132+025(R1),C'*'                                                 
         MVC   264+012(14,R1),=C'CHANGE ORDER *'                                
         MVC   396+012(07,R1),DASHES                                            
         MVI   396+025(R1),C'*'                                                 
         MVC   528+012(14,R1),STARS                                             
         B     PHC                                                              
*                                                                               
PHB      DS    0H                                                               
         MVC   000+012(20,R1),STARS                                             
         MVI   132+031(R1),C'*'                                                 
         MVC   264+012(20,R1),=C'CANCELLATION ORDER *'                          
         MVC   396+012(12,R1),DASHES                                            
         MVI   396+031(R1),C'*'                                                 
         MVC   528+012(20,R1),STARS                                             
         B     PH2                                                              
*                                                                               
FRPH     DS    0H                  SPECIAL FOR FRENCH                           
         LA    R1,HLIN1+1                                                       
         MVC   000(19,R1),STARS                                                 
         MVI   132(R1),C'*'                                                     
         MVI   132+18(R1),C'*'                                                  
         MVC   264(19,R1),=C'* BON D''INSERTION *'                              
         MVI   396(R1),C'*'                                                     
         MVI   396+018(R1),C'*'                                                 
         MVC   528(19,R1),STARS                                                 
         CLI   CHANGSW,0                                                        
         BE    PH2                                                              
*                                                                               
FRPHA    DS    0H                                                               
         MVI   132+18(R1),C' '     BLANK OUT UNNEEDED STARS                     
         MVI   396+18(R1),C' '                                                  
*                                                                               
         CLI   CHANGSW,C'C'                                                     
         BNE   FRPHB                                                            
         MVC   000(20,R1),STARS                                                 
         MVI   20(R1),C'*'         SINCE STARS IS ONLY 20 BYTES                 
         MVI   132(R1),C'*'                                                     
         MVI   132+020(R1),C'*'                                                 
         MVC   264(21,R1),=C'* BON DE CHANGEMENT *'                             
         MVI   396(R1),C'*'                                                     
         MVI   396+020(R1),C'*'                                                 
         MVC   528(20,R1),STARS                                                 
         MVI   528+20(R1),C'*'     SINCE STARS IS ONLY 20 BYTES                 
         B     PH2                                                              
*                                                                               
FRPHB    DS    0H                                                               
         MVC   000(20,R1),STARS                                                 
         MVI   20(R1),C'*'         SINCE STARS IS ONLY 20 BYTES                 
         MVI   132(R1),C'*'                                                     
         MVI   132+20(R1),C'*'                                                  
         MVC   264(21,R1),=C'* BON D''ANNULATION  *'                            
         MVI   396(R1),C'*'                                                     
         MVI   396+020(R1),C'*'                                                 
         MVC   528(20,R1),STARS                                                 
         MVI   528+020(R1),C'*'    SINCE STARS IS ONLY 20 BYTES                 
*                                                                               
PHC      DS    0H                                                               
         B     PH2                                                              
*                                                                               
PHC2     DS    0H                                                               
         LA    R1,HLIN1+1                                                       
         CLI   CHANGSW,C'C'                                                     
         BE    PH1                                                              
         BH    PH1A                                                             
*                                  ORIGIANL ORDER                               
         MVC   000(19,R1),STARS                                                 
         MVI   132(R1),C'*'                                                     
         MVI   132+18(R1),C'*'                                                  
*--->    LA    RF,=C'* INSERTION ORDER *'                                       
         LA    RF,PP@IOI1                                                       
         CLI   QMEDIA,C'O'                                                      
         BNE   PH0                                                              
*                                                                               
         CLI   PUBLANG,C'F'        SEE IF FRENCH - SPECIAL CODE                 
         BE    FRPHC4                                                           
*                                                                               
         LA    RF,=C'*     POSTING     *'                                       
         CLI   PBUYKEY+15,C'P'                                                  
         BNE   PH00                                                             
         LA    RF,=C'*    PAINTING     *'                                       
PH00     MVC   396(19,R1),=C'*  INSTRUCTIONS   *'                               
         B     PH0                                                              
*                                                                               
FRPHC4   DS    0H                 SPECIAL FRENCH CODE                           
         LA    RF,=C'*   INSTRUCTIONS  *'                                       
         MVC   396(19,R1),=C'*  POUR AFFICHANT *'                               
         CLI   PBUYKEY+15,C'P'                                                  
         BNE   PH0                                                              
         MVC   396(19,R1),=C'*  POUR PEINDRANT *'                               
*                                                                               
PH0      DS    0H                                                               
         MVC   264(19,R1),0(RF)                                                 
         MVI   396(R1),C'*'                                                     
         MVI   396+18(R1),C'*'                                                  
         MVC   528(19,R1),STARS                                                 
         B     PH2                                                              
*                                                                               
PH1      DS    0H                                                               
         LA    R2,BIGCHG                                                        
         CLI   PUBLANG,C'F'        SEE IF FRENCH                                
         BNE   PH1B                                                             
         B     FRPHA               MUST USE 'OLD' FORMAT                        
*                                                                               
PH1A     DS    0H                                                               
         LA    R2,BIGCAN                                                        
         CLI   PUBLANG,C'F'        IF FRENCH MUST USE 'OLD' FORMAT              
         BNE   PH1B                                                             
         B     FRPHB                                                            
*                                                                               
PH1B     MVC   000(30,R1),000(R2)                                               
         MVC   132(30,R1),030(R2)                                               
         MVC   264(30,R1),060(R2)                                               
         MVC   396(30,R1),090(R2)                                               
         MVC   528(30,R1),120(R2)                                               
         MVC   264+31(05,R1),=C'ORDER'                                          
         MVC   396+31(05,R1),=C'-----'                                          
*                                                                               
PH2      DS    0H                                                               
         CLI   MEMBOPT,C'N'                                                     
         BE    PH2B                                                             
         LA    R1,HLIN1+45                                                      
         MVI   0(R1),C'*'                                                       
         MVC   1(17,R1),0(R1)                                                   
*                                                                               
PH2B     DS    0H                                                               
         CLI   NAMOPT,C'B'         SEE IF SUPRESSING ONLY AT BOTTOM             
         BE    PH2C                                                             
*                                                                               
         CLI   NAMOPT,C'N'         TEST SUPRESS NAME                            
         BNE   PH2D                YES                                          
*                                                                               
PH2C     LA    R1,HLIN2+45         AGY NAME/ADDR                                
         MVC   0(33,R1),PAGYNAME                                                
         MVC   132(33,R1),PAGYADDR                                              
*                                                                               
*--->    MVC   HLIN5+69(4),=C'PAGE'                                             
PH2D     MVC   HLIN5+69(L'PP@PAGE),PP@PAGE                                      
*                                                                               
         LA    R1,HLIN7+1                                                       
*--->    MVC   0(9,R1),=C'ORDER NO.'                                            
         MVC   0(L'PP@ORDNO,R1),PP@ORDNO                                        
         MVC   10(1,R1),PAGYKMED                                                
         MVI   11(R1),C'-'                                                      
         MVC   12(5,R1),ETODAY+1                                                
         MVI   17(R1),C'-'                                                      
         LH    R0,REFNO                                                         
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  18(4,R1),DUB                                                     
*                                                                               
PH3C     DS    0H                                                               
         LA    R1,HLIN11+1                                                      
         CLI   ONEEOPT,C'Y'        EST IN HEADLINES                             
         BNE   PH3C5                                                            
         CLC   QEST,SPACES         ONE ESTIMATE?                                
         BE    PH3C5               NO                                           
         LA    R1,HLIN9+1          MUST START HIGHER                            
*                                                                               
PH3C5    DS    0H                                                               
*--->    MVC   0(4,R1),=C'DATE'                                                 
         MVC   0(L'PP@DATE,R1),PP@DATE                                          
*--->    MVC   08(8,R1),CTODAY                                                  
*                                                                               
         MVC   WORK(8),CTODAY                                                   
         CLI   PUBLANG,C'F'                                                     
         BNE   *+8                                                              
         BAS   RE,FRDATE                                                        
         MVC   08(8,R1),WORK                                                    
*                                                                               
         CLI   CHANGSW,0           DONT DO CLT/PRD HERE                         
         BE    PH4                 FOR ORIGIANL ORDER                           
*                                                                               
         LA    R1,264(R1)          SKIP A LINE                                  
*--->    MVC   0(6,R1),=C'CLIENT'                                               
         MVC   0(L'PP@CLI,R1),PP@CLI                                            
         MVC   09(3,R1),PCLTKCLT                                                
         MVC   13(20,R1),PCLTNAME                                               
*                                                                               
         LA    R1,132(R1)          NEXT LINE                                    
*--->    MVC   0(7,R1),=C'PRODUCT'                                              
         MVC   0(L'PP@PRO,R1),PP@PRO                                            
         MVC   09(3,R1),PPRDKPRD                                                
         MVC   13(20,R1),PPRDNAME                                               
*                                                                               
         CLI   ONEEOPT,C'Y'                                                     
         BNE   PH4                                                              
         CLC   QEST,SPACES                                                      
         BE    PH4                                                              
         LA    R1,132(R1)          NEXT LINE (HLIN13)                           
         MVC   0(8,R1),=C'ESTIMATE'                                             
         MVC   09(3,R1),QEST                                                    
         MVC   13(20,R1),PESTNAME                                               
         LA    R1,132(R1)          NEXT LINE (HLIN14)                           
         MVC   13(20,R1),PESTNAM2                                               
*                                                                               
PH4      DS    0H                  MEDIA                                        
         LA    R1,HLIN8+1                                                       
         MVC   0(10,R1),PAGYMED                                                 
*                                                                               
* SEE IF OVERRIDING MEDIA NAME FOR THIS CLIENT                                  
*                                                                               
         LA    R2,PCLTREC+33                                                    
         CLI   0(R2),0                                                          
         BE    PH4A                TO PREVENT LOOPS                             
         MVI   ELCODE,X'41'                                                     
         BRAS  RE,NXTELEM                                                       
         BNE   *+10                                                             
         MVC   0(10,R1),2(R2)                                                   
*                                                                               
PH4A     DS    0H                  IF FRENCH FIX MEDIA NAMES                    
         CLI   PUBLANG,C'F'                                                     
         BNE   PH4D                                                             
*                                                                               
*        NO LANGUAGE CHANGES FOR MEDIA L OR B                                   
*                                                                               
         CLI   QMEDIA,C'D'                                                      
         BNE   PH4AV                                                            
         MVC   0(10,R1),=CL10'AUDIO NUM.'                                       
         B     PH4D                                                             
*                                                                               
PH4AV    CLI   QMEDIA,C'V'                                                      
         BNE   PH4AW                                                            
         MVC   0(10,R1),=CL10'VIDEO NAT.'                                       
         B     PH4D                                                             
*                                                                               
PH4AW    CLI   QMEDIA,C'W'                                                      
         BNE   PH4AX                                                            
         MVC   0(10,R1),=CL10'VIDEO LOC.'                                       
         B     PH4D                                                             
*                                                                               
PH4AX    CLI   QMEDIA,C'N'                                                      
         BNE   PH4B                                                             
         MVC   0(10,R1),=CL10'JOURNAUX'                                         
         B     PH4D                                                             
*                                                                               
PH4B     CLI   QMEDIA,C'O'                                                      
         BNE   PH4C                                                             
         MVC   0(10,R1),=CL10'EXTERIEUR'                                        
         B     PH4D                                                             
*                                                                               
PH4C     CLI   QMEDIA,C'T'         TRADE                                        
         BNE   PH4D                                                             
         MVC   0(10,R1),=CL10'INDUSTRIE'                                        
*                                                                               
* CHECK FOR VARIOUS SPELLINGS FOR INTERACTIVE                                   
* AND CONVERT THEM TO "INTERACTIVE" FOR THE TITLE                               
*                                                                               
PH4D     DS    0H                                                               
         CLC   0(10,R1),=C'INTERACTIV'                                          
         BE    PH4E                                                             
         CLC   0(9,R1),=C'INTERACTV'                                            
         BE    PH4E                                                             
         CLC   0(6,R1),=C'INTRAC'                                               
         BE    PH4E                                                             
         B     PH4F                                                             
*                                                                               
PH4E     MVC   0(11,R1),=C'INTERACTIVE'                                         
*                                                                               
PH4F     DS    0H                  PUBLISHER                                    
         LA    R1,HLIN7+45                                                      
*--->    MVC   0(16,R1),=C'TO PUBLISHER OF-'                                    
         MVC   0(L'PP@IOI2,R1),PP@IOI2                                          
         CLI   QMEDIA,C'O'                                                      
         BNE   *+10                                                             
*--->    MVC   0(24,R1),=C'OUTDOOR ADVERTISING CO.-'                            
         MVC   0(L'PP@IOI3,R1),PP@IOI3                                          
*                                                                               
         MVC   WORK,SPACES                                                      
         GOTO1 APUBEDIT,DMCB,PUBKPUB,WORK                                       
*                                                                               
         LA    R7,WORK+20                                                       
         BAS   RE,PHFLOAT                                                       
         LA    R0,WORK-1                                                        
         SR    R7,R0               LENGTH IN R7                                 
         LA    R1,HLIN8+78                                                      
         SR    R1,R7               R1 = TO                                      
         MVC   0(17,R1),WORK                                                    
*                                  PUB NAME + ZONE                              
         LA    R1,HLIN9+45                                                      
         MVC   0(20,R1),PUBNAME                                                 
         MVC   132(20,R1),PUBZNAME                                              
*                                                                               
         CLI   MKZOPT,C'Y'         SEE IF DISPLAYING "MARKET" BEFORE            
         BNE   PH10                BEFORE OUTDOOR ZONES                         
         CLI   PUBZNAME,C' '       SEE IF I HAVE A ZONE                         
         BNH   PH10                                                             
         CLI   QMEDIA,C'O'         MUST BE OUTDOOR                              
         BNE   PH10                                                             
*--->    MVC   124(7,R1),=C'MARKET:'                                            
         MVC   124(L'PP@MARKT,R1),PP@MARKT                                      
*                                                                               
PH10     CLI   QMEDIA,C'N'                                                      
         BNE   PRT5                                                             
         MVC   WORK,SPACES                                                      
         MVC   WORK(16),PUBCITY                                                 
         LA    R7,WORK+16                                                       
         BAS   RE,PHFLOAT                                                       
         MVI   1(R7),C','                                                       
         MVC   3(2,R7),PUBSTATE                                                 
         CLI   132(R1),C' '        TEST IF ZONE NAME                            
         BNH   *+8                                                              
         LA    R1,132(R1)          YES                                          
         MVC   132(25,R1),WORK                                                  
*                                                                               
PRT5     DS    0H                                                               
         MVC   WORK,SPACES                                                      
         GOTO1 APUBEDIT,DMCB,PUBKPUB,(C'E',WORK)                                
*                                                                               
         LA    R1,HLIN9+45                                                      
         CLI   0(R1),C' '                                                       
         BNH   *+12                                                             
         LA    R1,132(R1)                                                       
         B     *-12                                                             
         MVC   132(11,R1),WORK     EDITION 'NAME'                               
*                                                                               
PRT6     DS    0H                                                               
         CLI   TLFXOPT,C'A'        DEFAULT TO TELEPHONE OPTION ONLY?            
         BH    *+8                                                              
         MVI   TLFXOPT,C'T'        TELEPHONE NUMBER                             
*                                                                               
         CLI   TLFXOPT,C'F'        ONLY PRINT FAX?                              
         BE    PRT7                                                             
         XC    WORK,WORK                                                        
         CLI   PREPKEY,0                                                        
         BE    *+14                                                             
         MVC   WORK(12),PREPTEL                                                 
         B     PRT6D                                                            
*                                                                               
         LA    R2,PUBREC+33                                                     
         CLI   0(R2),X'11'                                                      
         BE    PRT6B                                                            
         MVI   ELCODE,X'11'                                                     
         BRAS  RE,NXTELEM                                                       
         BNE   PRT6D                                                            
*                                                                               
PRT6B    DS    0H                                                               
         USING PUBSADEL,R2                                                      
         MVC   WORK(12),PUBTEL                                                  
         DROP  R2                                                               
*                                                                               
PRT6D    DS    0H                                                               
         OC    WORK(12),SPACES                                                  
         CLC   WORK(12),SPACES                                                  
         BE    PRT6E                                                            
         LA    R1,HLIN13+45                                                     
         MVC   0(3,R1),=C'TEL'                                                  
         MVC   4(12,R1),WORK                                                    
PRT6E    CLI   TLFXOPT,C'T'        TELEPHONE ONLY?                              
         BE    PRT7F                                                            
*                                                                               
PRT7     DS    0H                  FAX NUMBER                                   
         XC    WORK,WORK                                                        
         CLI   PREPKEY,0                                                        
         BE    *+14                                                             
         MVC   WORK(12),PREPFAX                                                 
         B     PRT7D                                                            
*                                                                               
         LA    R2,PUBREC+33                                                     
         CLI   0(R2),X'11'                                                      
         BE    PRT7B                                                            
         MVI   ELCODE,X'11'                                                     
         BRAS  RE,NXTELEM                                                       
         BNE   PRT7D                                                            
*                                                                               
PRT7B    DS    0H                                                               
         USING PUBSADEL,R2                                                      
         MVC   WORK(12),PUBSFAXN                                                
         DROP  R2                                                               
*                                                                               
PRT7D    DS    0H                                                               
         OC    WORK(12),SPACES                                                  
         CLC   WORK(12),SPACES                                                  
         BE    PRT7F                                                            
         LA    R1,HLIN13+45                                                     
         CLI   TLFXOPT,C'F'                                                     
         BE    NOTEL                                                            
         MVC   18(3,R1),=C'FAX'                                                 
         MVC   22(12,R1),WORK                                                   
         B     PRT7F                                                            
NOTEL    MVC   0(3,R1),=C'FAX'                                                  
         MVC   4(12,R1),WORK                                                    
*                                                                               
PRT7F    DS    0H                                                               
         CLI   WEBOPT,C'Y'                                                      
         BNE   PRT7I                                                            
*                                                                               
         LA    R2,PUBREC+33                                                     
         CLI   0(R2),X'70'         WEBSITE ELEMENT                              
         BE    PRT7G                                                            
         MVI   ELCODE,X'70'                                                     
         BRAS  RE,NXTELEM                                                       
         BNE   PRT7I                                                            
*                                                                               
PRT7G    DS    0H                                                               
         USING PUBWEBD,R2                                                       
         ZIC   R7,1(R2)            ELEMENT LENGTH                               
         AHI   R7,-3                                                            
         BM    PRT7I                                                            
         LA    R1,HLIN14+45        ELSE USE HLIN14                              
*                                  +45 IS IDEAL STARTING POSITION               
         CHI   R7,34                                                            
         BL    PRT7H                                                            
*                                  TOO LONG                                     
         LR    RE,R7                                                            
         AHI   RE,-34                                                           
         SR    R1,RE               ADJUST R1 BY THE DIFFERENCE                  
*                                  BETWEEN TOTAL LENGTH AND 34                  
         AHI   R1,-1               BACK-UP ONE MORE                             
         CLC   0(2,R1),SPACES      BE SURE NOTHING IS THERE ALREADY             
         BNH   PRT7G5                                                           
*                                                                               
         LA    R1,HLIN12+79        ELSE USE HLIN12                              
         SR    R1,R7               SUBTRACT LENGTH OF DATA                      
         B     PRT7H                                                            
*                                                                               
PRT7G5   AHI   R1,1                RESTORE TO PROPER POSITION                   
*                                                                               
* NOTE IF LENGTH OF DATA EXC                                                    
*                                                                               
PRT7H    EX    R7,MOVEWEB                                                       
         B     PRT7I                                                            
*                                                                               
MOVEWEB  MVC   0(0,R1),PUBWEBS                                                  
         DROP  R2                                                               
*                                  INSURE PRINTING OF ENOUGH HLINLINES          
PRT7I    DS    0H                                                               
         LA    R0,14               14 FOR FIRST PAGE                            
         OC    PAGE,PAGE                                                        
         BE    *+8                                                              
         LA    R0,14               14 FOR ALL OTHERS                            
         LA    R1,HLIN1                                                         
         MVI   0(R1),0                                                          
         LA    R1,132(R1)                                                       
         BCT   R0,*-8                                                           
*                                                                               
PH20     DS    0H                                                               
         EDIT  (B2,PAGE),(3,HLIN5+74),0,ALIGN=LEFT                              
         LA    R0,14                                                            
         LA    R1,HEAD1                                                         
         LA    R2,HLIN1                                                         
*                                                                               
PH21     DS    0H                                                               
         MVC   0(132,R1),0(R2)                                                  
         LA    R1,132(R1)                                                       
         LA    R2,132(R2)                                                       
         BCT   R0,PH21                                                          
*                                                                               
PRTHEADX J     PRTX                                                             
*                                                                               
PHFLOAT  DS    0H                                                               
         CLI   0(R7),C' '                                                       
         BHR   RE                                                               
         BCT   R7,*-6                                                           
*                                                                               
NXTELEM  ZIC   R0,1(R2)                                                         
         AR    R2,R0                                                            
         CLC   ELCODE,0(R2)                                                     
         JE    NXTELX              CC IS EQUAL                                  
         CLI   0(R2),0                                                          
         JNE   NXTELEM                                                          
         LTR   R2,R2               CC IS NOT EQUAL                              
NXTELX   BR    RE                                                               
*                                                                               
FRDATE   NTR1                      CONVERT DATE IN WORK (MMMDD/YY)              
         LA    R1,DATETAB                                                       
FRDAT2   CLI   0(R1),X'FF'         END OF TABLE                                 
         BNE   *+6                                                              
         DC    H'0'                SOMEHTING VERY WRONG                         
*                                                                               
         CLC   WORK(3),0(R1)                                                    
         BE    FRDAT10                                                          
         LA    R1,6(R1)                                                         
         B     FRDAT2                                                           
*                                  TO FRENCH                                    
FRDAT10  MVC   WORK(3),3(R1)                                                    
         J     PRTX                                                             
*                                                                               
DATETAB  DC    C'JANJAN'                                                        
         DC    C'FEBFEV'                                                        
         DC    C'MARMAR'                                                        
         DC    C'APRAVR'                                                        
         DC    C'MAYMAI'                                                        
         DC    C'JUNJUN'                                                        
         DC    C'JULJUL'                                                        
         DC    C'AUGAOU'                                                        
         DC    C'SEPSEP'                                                        
         DC    C'OCTOCT'                                                        
         DC    C'NOVNOV'                                                        
         DC    C'DECDEC'                                                        
         DC    X'FF'                                                            
*                                                                               
         EJECT                                                                  
*                                                                               
BIGCHG   DC    C'CCCC H  H  AA  N  N GGGG EEEE '                                
         DC    C'C    H  H A  A NN N G    E    '                                
         DC    C'C    HHHH AAAA NNNN G GG EEE  '                                
         DC    C'C    H  H A  A N NN G  G E    '                                
         DC    C'CCCC H  H A  A N  N GGGG EEEE '                                
*                                                                               
BIGCAN   DC    C'CCCC  AA  N  N CCCC EEEE L    '                                
         DC    C'C    A  A NN N C    E    L    '                                
         DC    C'C    AAAA NNNN C    EEE  L    '                                
         DC    C'C    A  A N NN C    E    L    '                                
         DC    C'CCCC A  A N  N CCCC EEEE LLLL '                                
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
         PRINT OFF                                                              
*                                                                               
       ++INCLUDE PPIOIOPD                                                       
         EJECT                                                                  
*                                                                               
PUBWEBD  DSECT                                                                  
       ++INCLUDE PUBWEBEL                                                       
         EJECT                                                                  
*                                                                               
       ++INCLUDE DDLOGOD                                                        
         EJECT                                                                  
*                                                                               
       ++INCLUDE PP72WORK                                                       
         EJECT                                                                  
*                                                                               
         PRINT ON                                                               
*                                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'010PP72PRT   07/17/18'                                      
         END                                                                    
