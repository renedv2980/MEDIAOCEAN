*          DATA SET SP005      AT LEVEL 075 AS OF 05/01/02                      
*CATALP SP005                                                                   
         TITLE 'SP005 - BILLING INTERFACES - JWT/NHS/NHS/CNW/MARST/FCB'         
SP005    CSECT                                                                  
         PRINT NOGEN                                                            
         DS    5000C                                                            
         ORG   *-5000                                                           
         NMOD1 0,*SP005                                                         
         SPACE 2                                                                
         LA    R8,1(RB)                                                         
         LA    R8,4095(R8)                                                      
         USING SP005+4096,R8       2ND BASE REG                                 
         L     RC,=V(RPWORKC)                                                   
         USING RPWORK,RC                                                        
         L     RA,=V(SP05WRKC)                                                  
         USING SP05WORK,RA                                                      
*                                                                               
         CLI   CBMODE,12                                                        
         BE    ENDRPT                                                           
         CLI   CBMODE,10                                                        
         BE    ENDREQ                                                           
         CLI   CBMODE,8                                                         
         BE    *+6                                                              
         DC    H'0'                                                             
         EJECT                                                                  
*                                                                               
         CLI   FRSTIM,0                                                         
         BE    NEXTCLT                                                          
         MVI   FRSTIM,0                                                         
         MVI   LNCNT+1,200         FORCE NEW PAGE                               
         LA    RF,RPAGY                                                         
         CLI   QOPT2,C' '                                                       
         BE    *+8                                                              
         LA    RF,QOPT2            USE QOPT2(2) AS AGENCY                       
         LA    R1,NHSFILE                                                       
         CLC   =C'NH',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'NI',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'HC',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'NE',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'JW',0(RF)                                                     
         BNE   OP2                                                              
         LA    R1,MEDIAN                                                        
         CLI   QOPT1,C'M'                                                       
         BE    OPEN                                                             
         LA    R1,JWJSBTP                                                       
         CLI   QOPT1,C'S'          SCHLITZ                                      
         BE    OPEN                                                             
         LA    R1,JWTFILE                                                       
         B     OPEN                                                             
OP2      DS    0H                                                               
         LA    R1,CNWFILE                                                       
         CLC   =C'CW',0(RF)                                                     
         BE    OPEN                                                             
         LA    R1,STFILE                                                        
         CLC   =C'ST',0(RF)        MARSTELLER                                   
         BE    OPEN                                                             
         LA    R1,FCFILE                                                        
         CLC   =C'FC',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'FT',0(RF)                                                     
         BE    OPEN                                                             
         LA    R1,CAFILE                                                        
         CLC   =C'CA',0(RF)        CAMPBELL MITHUN                              
         BE    OPEN                                                             
         CLC   =C'SS',0(RF)        SSCB SHARES DTF                              
         BE    OPEN                                                             
         LA    R1,RRFILE                                                        
         CLC   =C'RR',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'RC',0(RF)                                                     
         BE    OPEN                                                             
         LA    R1,INTFILE                                                       
         CLC   =C'MC',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'CH',0(RF)                                                     
         BE    OPEN                                                             
         LA    R1,BJFILE                                                        
         CLC   =C'BJ',0(RF)                                                     
         BE    OPEN                                                             
         LA    R1,CMPFIL                                                        
         CLC   =C'CO',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'RH',0(RF)                                                     
         BE    OPEN                                                             
         CLC   =C'RN',0(RF)                                                     
         BE    OPEN                                                             
         LA    R1,KNFILE                                                        
         CLC   =C'KN',0(RF)                                                     
         BE    OPEN                                                             
         LA    R1,HEFILE                                                        
         CLC   =C'HE',0(RF)                                                     
         BE    OPEN                                                             
         B     OPENX                                                            
*                                                                               
OPEN     ST    R1,TPFILE                                                        
         OPEN  (1)                                                              
*                                                                               
OPENX    DS    0H                                                               
         SPACE 2                                                                
* RESEQUENCE SPTDIR TO CLTHDR                                                   
NEXTCLT  MVI   PL,X'41'            SKIP A LINE                                  
         GOTO1 =V(DATAMGR),DMCB,DMRDHI,SDIR,CKEY,KEY                            
         CLI   8(R1),0                                                          
         BE    *+6                                                              
         DC    H'0'                                                             
         EJECT                                                                  
NEXTREC  GOTO1 =V(DATAMGR),DMCB,DMRSEQ,SDIR,,KEY                                
         CLI   8(R1),0                                                          
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         CLC   KEY(4),CKEY         A-M/CLT                                      
         BNE   ENDCLT                                                           
         OC    KEY+7(6),KEY+7      TEST PRDHDR                                  
         BZ    NEWPRD                                                           
         OC    KEY+8(5),KEY+8      TEST FOR BILL DATA                           
         BZ    NEXTREC             NO - MUST BE ESTHDR (SKIP)                   
         EJECT                                                                  
* MUST BE BILL                                                                  
         GOTO1 =V(DATAMGR),DMCB,DMRDIR,SPOT,KEY+14,BILLREC                      
         CLI   8(R1),0                                                          
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         CLC   BDATE,QSTART                                                     
         BL    NEXTREC                                                          
         CLC   BDATE,QEND                                                       
         BH    NEXTREC                                                          
         CLC   BQDATE,BDATE        TEST FOR TRANSITION PROBLEMS                 
         BNL   *+10                                                             
         MVC   BQDATE,BDATE                                                     
*                                                                               
         TM    BADJIND,X'02'       TEST COMM ONLY BILL                          
         BZ    *+10                                                             
         XC    BNET,BNET           SET NET = 0 (COMM = ACTUAL)                  
*                                                                               
* PRINT BILL RECORD                                                             
         MVI   CLTACT,C'Y'         SET ACTIVITY SWITCH                          
         LH    R0,CLTHDR+22                                                     
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  PL+4(3),DUB                                                      
         GOTO1 =V(CLUNPK),DMCB,BKEY+2,PL+8                                      
         MVC   PL+12(3),BKEY+4                                                  
         CLI   BKEY+7,0                                                         
         BE    BIR4                                                             
         EDIT  (1,BKEY+7),(3,PL+17)                                             
BIR4     MVC   PL+23(2),BMONSERV+2                                              
         MVI   PL+25,C'/'                                                       
         MVC   PL+26(2),BMONSERV                                                
         MVC   PL+31(2),BINVNO                                                  
         MVI   PL+33,C'-'                                                       
         MVC   PL+34(4),BINVNO+2                                                
*                                                                               
         PACK  DUB,BAMT                                                         
         CVB   R0,DUB                                                           
         EDIT  (R0),(16,PL+38),2,COMMAS=YES,CR=YES                              
*                                                                               
         LM    RE,RF,CLTTOTG                                                    
         AR    RE,R0               BUMP CLT TOT                                 
         AR    RF,R0               BUMP RPT TOT                                 
         STM   RE,RF,CLTTOTG                                                    
*                                                                               
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         EDIT  (R0),(16,PL+54),2,COMMAS=YES,CR=YES                              
*                                                                               
         LM    RE,RF,CLTTOTN                                                    
         AR    RE,R0               BUMP CLT TOT                                 
         AR    RF,R0               BUMP RPT TOT                                 
         STM   RE,RF,CLTTOTN                                                    
*                                                                               
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         EDIT  (R0),(16,PL+70),2,COMMAS=YES,CR=YES                              
*                                                                               
         LM    RE,RF,CLTTOTA                                                    
         AR    RE,R0                                                            
         AR    RF,R0                                                            
         STM   RE,RF,CLTTOTA                                                    
*                                                                               
         BAS   RE,PRTPL                                                         
         EJECT                                                                  
         LA    RF,RPAGY                                                         
         CLI   QOPT2,C' '                                                       
         BE    *+8                                                              
         LA    RF,QOPT2            USE QOPT2(2) AS AGENCY                       
         CLC   =C'NH',0(RF)                                                     
         BE    NHS                                                              
         CLC   =C'NI',0(RF)                                                     
         BE    NHS                                                              
         CLC   =C'HC',0(RF)                                                     
         BE    NHS                                                              
         CLC   =C'NE',0(RF)                                                     
         BE    NHS                                                              
         CLC   =C'JW',0(RF)                                                     
         BE    JWT                                                              
         CLC   =C'CW',0(RF)                                                     
         BE    CNW                                                              
         CLC   =C'ST',0(RF)                                                     
         BE    MARST                                                            
         CLC   =C'SS',0(RF)        SSCB SAME AS MARST                           
         BE    MARST                                                            
         CLC   =C'FC',0(RF)                                                     
         BE    FCB                                                              
         CLC   =C'FT',0(RF)                                                     
         BE    FCB                                                              
         CLC   =C'CA',0(RF)                                                     
         BE    CAMPMTH                                                          
         CLC   =C'RR',0(RF)                                                     
         BE    ROSS                                                             
         CLC   =C'RC',0(RF)                                                     
         BE    ROSS                                                             
         CLC   =C'MC',0(RF)                                                     
         BE    INTP                                                             
         CLC   =C'CH',0(RF)                                                     
         BE    INTP                                                             
         CLC   =C'BJ',0(RF)                                                     
         BE    BJTP                                                             
         CLC   =C'CO',0(RF)                                                     
         BE    COMTP                                                            
         CLC   =C'RH',0(RF)                                                     
         BE    COMTP                                                            
         CLC   =C'RN',0(RF)                                                     
         BE    COMTP                                                            
         CLC   =C'KN',0(RF)                                                     
         BE    KNTP                                                             
         CLC   =C'HE',0(RF)                                                     
         BE    HETP                                                             
         B     NEXTREC                                                          
         EJECT                                                                  
* CREARE INTERFACE RECORD                                                       
*                                                                               
JWT      EQU   *                                                                
         CLI   QOPT1,C' '                                                       
         BE    JWT2                BILLING TAPE                                 
         CLI   QOPT1,C'S'          SCHLITZ TAPE                                 
         BE    JWT10                                                            
         MVI   MIREC,C' '                                                       
         MVC   MIREC+1(116),MIREC                                               
         LA    R1,MIREC                                                         
         MVC   0(3,R1),=C'6S0'                                                  
         CLC   CLTHDR+22(2),=H'280'                                             
         BL    *+18                                                             
         CLC   CLTHDR+22(2),=H'370'                                             
         BH    *+8                                                              
         MVI   2(R1),C'1'                                                       
         LH    R0,CLTHDR+22                                                     
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  6(3,R1),DUB                                                      
         MVC   9(3,R1),PACCT+1                                                  
         MVC   12(2,R1),BDATE                                                   
         SR    R0,R0                                                            
         IC    R0,BKEY+7           EST                                          
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  14(3,R1),DUB                                                     
         MVI   23(R1),C'0'                                                      
         MVC   28(2,R1),BMONSERV+2                                              
         MVC   30(2,R1),=C'01'                                                  
         MVC   32(2,R1),BMONSERV                                                
         MVI   39(R1),C'6'                                                      
         CLI   QMED,C'R'                                                        
         BE    *+8                                                              
         MVI   39(R1),C'7'                                                      
         MVC   DUB(4),BACTUAL                                                   
         L     R0,DUB                                                           
         CVD   R0,DUB                                                           
         UNPK  51(8,R1),DUB                                                     
         MVC   DUB(4),BNET                                                      
         L     R0,DUB                                                           
         CVD   R0,DUB                                                           
         UNPK  59(8,R1),DUB                                                     
*                                                                               
         LA    R1,MEDIAN                                                        
         PUT   (R1)                                                             
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
JWT2     DS    0H                                                               
*                                                                               
*                ** ADD SPECIAL CODE FOR THIS AGENCY HERE **                    
*                                                                               
*                                  ** JWT INTERFACE TAPE **                     
         MVI   TREC,C' '                                                        
         MVC   TREC+1(134),TREC                                                 
         MVI   TREC,C'1'                                                        
         MVC   HALF,CCLTINTR                                                    
         LH    R0,HALF                                                          
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  TREC+1(4),DUB                                                    
         MVC   TREC+5(3),PACCT+1                                                
         MVC   TREC+8(2),BDATE+2                                                
         MVC   TREC+10(2),=C'VS'                                                
         CLI   QMED,C'T'                                                        
         BE    *+8                                                              
         MVI   TREC+10,C'B'                                                     
         MVC   TREC+12(4),BINVNO+2     INVOICE NO.                              
         MVC   TREC+16(4),BQDATE+2     INV DATE                                 
         MVC   TREC+20(2),BQDATE                                                
         GOTO1 =V(DATCON),DMCB,(3,BDUEDATE),WORK                                
         MVC   TREC+22(4),WORK+2                                                
         MVC   TREC+26(2),WORK                                                  
         ZIC   R0,BKEY+7                                                        
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  TREC+28(5),DUB       EST                                         
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  TREC+34(11),DUB     ACTUAL                                       
         MVC   TREC+45(9),=11C'0'                                               
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  TREC+54(11),DUB     NET                                          
         MVC   FULL,BACTUAL                                                     
         L     RF,FULL                                                          
         SR    RF,R0               ACTUAL - NET = PROFIT                        
         CVD   RF,DUB                                                           
         UNPK  TREC+65(11),DUB                                                  
         MVC   TREC+76(11),=11C'0'                                              
         MVC   TREC+87(9),=11C'0'                                               
         MVC   TREC+122(1),COFFICE                                              
*                                                                               
         GOTO1 =V(CLUNPK),DMCB,BKEY+2,TREC+123      CLIENT                      
         OI    TREC+125,C' '                                                    
*                                                                               
         MVC   TREC+126(3),BKEY+4 PRODUCT                                       
         MVI   TREC+129,C' '                                                    
*                                                                               
         LA    R3,PNAME+19                                                      
*                                  USE LAST 5 NON-BLANK CHARACTERS              
*                                  (MCA FOR SCHLITZ)                            
         CLI   0(R3),C' '                                                       
         BH    *+8                                                              
         BCT   R3,*-8                                                           
*                                                                               
         SH    R3,=H'4'                                                         
         MVC   TREC+130(5),0(R3)                                                
*                                                                               
*                                                                               
         LA    R1,JWTFILE                                                       
         LA    R0,TREC                                                          
         PUT   (1),(0)                                                          
         B     NEXTREC                                                          
         EJECT                                                                  
*                        JWT - SCHLITZ COOP TAPE                                
JWT10    DS    0H                                                               
*                                                                               
         CLC   BTYPE,=C'B5'        ONLY B5 (COOP) BILLS                         
         BNE   NEXTREC                                                          
         MVI   TREC,C' '                                                        
         MVC   TREC+1(79),TREC                                                  
         MVC   TREC(2),=C'I2'                                                   
         MVC   TREC+2(2),QSTART+2       MONTH OF BILLS                          
         MVC   TREC+4(2),=C'00'         FIRST TAPE                              
         CLI   QOPT4,C' '                                                       
         BE    *+10                                                             
         MVC   TREC+5(1),QOPT4          TAPE NO. IF NOT FIRST                   
         MVC   TREC+6(2),BMONSERV         YEAR OF BILLS                         
         MVC   TREC+8(3),=C'975'                                                
*                                                                               
         GOTO1 =V(CLUNPK),DMCB,BKEY+2,TREC+11     PRODUCT (CLIENT CODE)         
*                                                                               
         MVC   TREC+13(3),=C'802'       RADIO                                   
         CLI   QMED,C'R'                                                        
         BE    *+10                                                             
         MVC   TREC+13(3),=C'812'       TV                                      
*                                                                               
         LA    R3,PNAME+19                                                      
         CLI   0(R3),C' '                                                       
         BH    *+8                                                              
         BCT   R3,*-8                                                           
         SH    R3,=H'3'                                                         
         MVC   TREC+16(4),0(R3)         LAST 4 CHARS OF PRD = MCA               
*                                                                               
         MVC   TREC+20(3),=C'JWT'                                               
         MVI   TREC+23,C'3'                                                     
         MVC   TREC+24(9),=11C'0'                                               
         MVC   TREC+33(4),BQDATE+2                                              
         MVC   TREC+37(2),BQDATE                                                
         MVC   TREC+39(4),=11C'0'                                               
*                                       INVOICE NUM                             
         MVC   TREC+43(4),=11C'0'                                               
         MVC   TREC+47(4),BINVNO+2                                              
*                                                                               
         GOTO1 =V(DATCON),DMCB,(3,BDUEDATE),WORK                                
         MVC   TREC+51(4),WORK+2                                                
         MVC   TREC+55(2),WORK                                                  
*                                                                               
         MVC   TREC+57(2),BMONSERV+2                                            
*                                                                               
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  TREC+59(11),DUB     ACTUAL                                       
*                                                                               
         LA    R1,JWJSBTP                                                       
         LA    R0,TREC                                                          
         PUT   (1),(0)                                                          
         B     NEXTREC                                                          
*                                                                               
         EJECT                                                                  
NHS      DS    0H                                                               
         MVI   NHSREC,C' '                                                      
         MVC   NHSREC+1(149),NHSREC                                             
         MVI   NHSREC,C'2'                                                      
         CLI   QMED,C'N'                                                        
         BNE   *+8                                                              
         MVI   NHSREC,C'N'                                                      
         LH    0,CLTHDR+22                                                      
         BAS   R9,CVD                                                           
         MVC   NHSREC+1(3),WORK+7                                               
         MVC   NHSREC+4(2),PACCT+2                                              
         MVC   NHSREC+7(2),=C'24'  TV CODE                                      
         CLI   QMED,C'T'                                                        
         BE    NHS2                                                             
         MVC   NHSREC+7(2),=C'21'  NETWORK CODE                                 
         CLI   QMED,C'N'                                                        
         BE    NHS2                                                             
         MVC   NHSREC+7(2),=C'14'  RADIO CODE                                   
*                                                                               
NHS2     DS    0H                                                               
         SR    0,0                                                              
         IC    R0,BKEY+7                                                        
         BAS   R9,CVD                                                           
         MVC   NHSREC+9(3),WORK+7                                               
         MVI   NHSREC+12,C'0'                                                   
         MVC   NHSREC+20(2),BMONSERV+2   MONTH OF SVC (FMT IS MMYY)             
         MVC   NHSREC+22(2),BMONSERV                                            
         ZIC   R0,BDUEDATE                                                      
         BAS   R9,CVD                                                           
         MVC   NHSREC+49(2),WORK+8                                              
         IC    R0,BDUEDATE+1                                                    
         BAS   R9,CVD                                                           
         MVC   NHSREC+45(2),WORK+8                                              
         IC    R0,BDUEDATE+2                                                    
         BAS   R9,CVD                                                           
         MVC   NHSREC+47(2),WORK+8                                              
*                                                                               
         OC    BDUEDATE,BDUEDATE     TEST NEW FORMAT                            
         BNZ   NHS4                YES                                          
* CALCULATE DUE DATE                                                            
         GOTO1 =V(ADDAY),DMCB,BQDATE,WORK,10                                    
         MVC   NHSREC+45(4),WORK+2 MOVE MMDD                                    
         MVC   NHSREC+49(2),WORK   MOVE YY                                      
*                                                                               
NHS4     MVC   DUB(4),BACTUAL      ACTUAL BILLING                               
         L     R0,DUB                                                           
         BAS   R9,CVD                                                           
         MVC   NHSREC+31(9),WORK+1                                              
         MVC   DUB(4),BNET         NET BILLING                                  
         L     R0,DUB                                                           
         BAS   R9,CVD                                                           
         MVC   NHSREC+135(9),WORK+1                                             
         MVC   NHSREC+117(2),BDATE+2  SET BILLING MONTH                         
         MVC   NHSREC+119(4),BINVNO+2                                           
         MVI   NHSREC+128,C'1'                                                  
         MVC   NHSREC+129(4),BQDATE+2                                           
         MVC   NHSREC+133(2),BQDATE                                             
*                                                                               
         LA    R1,NHSFILE                                                       
         LA    R0,NHSREC                                                        
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
CNW      DS    0H                                                               
         MVI   CNWREC,C' '                                                      
         MVC   CNWREC+1(79),CNWREC                                              
         MVC   CNWREC(3),PACCT+1                                                
         SR    R0,R0                                                            
         IC    R0,BKEY+7           EST                                          
         BAS   R9,CVD                                                           
         MVC   CNWREC+3(3),WORK+7                                               
         MVI   CNWREC+9,X'60'                                                   
         ZIC   R0,BDUEDATE                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(2),DUB                                                      
         IC    R0,BDUEDATE+1                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+2(2),DUB                                                    
         IC    R0,BDUEDATE+2                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+4(2),DUB                                                    
*                                                                               
         OC    BDUEDATE,BDUEDATE     TEST NEW FORMAT                            
         BNZ   CNW4                YES                                          
* CALCULATE DUE DATE                                                            
         GOTO1 =V(ADDAY),DMCB,BDATE,WORK,10                                     
*                                                                               
CNW4     BAS   R9,CNWMON                                                        
         MVC   CNWREC+21(4),WORK                                                
         MVC   CNWREC+25(2),=C'08'  TV                                          
         CLI   QMED,C'T'                                                        
         BE    *+10                                                             
         MVC   CNWREC+25(2),=C'06'  RADIO                                       
*                                                                               
         MVI   CNWREC+27,C'0'                                                   
         MVC   CNWREC+28(4),BINVNO+2                                            
*                                                                               
         MVC   WORK(6),BDATE                                                    
         BAS   R9,CNWMON                                                        
         MVC   CNWREC+32(4),WORK                                                
*                                                                               
         MVC   DUB(4),BACTUAL      ACTUAL                                       
         L     R0,DUB                                                           
         LR    R5,R0               SAVE                                         
         BAS   R9,CVD                                                           
         MVC   CNWREC+44(9),WORK+1  SET AS GROSS                                
         MVC   CNWREC+68(8),WORK+2   AND NET RECEIVABLE                         
         MVC   DUB(4),BNET                                                      
         L     R0,DUB                                                           
         BAS   R9,CVD                                                           
         MVC   CNWREC+60(8),WORK+2                                              
*                                                                               
         SR    R5,R0               ACT-NET = COMM                               
         LR    R0,R5                                                            
         BAS   R9,CVD                                                           
         MVC   CNWREC+36(8),WORK+2                                              
*                                                                               
         SR    R0,R0                                                            
         BAS   R9,CVD                                                           
         MVC   CNWREC+53(7),WORK+3                                              
*                                                                               
         LA    R1,CNWFILE                                                       
         PUT   (1)                                                              
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
* CONVERT YYMMDD TO MDDY. OCT=X'D0',NOV=X'D1',DEC=X'D2'                         
*                                                                               
CNWMON   CLC   WORK+2(2),=C'10'                                                 
         BL    CNWMONX                                                          
         NI    WORK+3,X'D0'        CHANGE X'FN' TO X'DN'                        
CNWMONX  MVC   FULL(1),WORK+3      M                                            
         MVC   FULL+1(2),WORK+4    DD                                           
         MVC   FULL+3(1),WORK+1    Y                                            
         MVC   WORK(4),FULL                                                     
         BR    R9                                                               
         EJECT                                                                  
MARST    DS    0H                                                               
         MVI   STREC,C' '                                                       
         MVC   STREC+1(99),STREC                                                
         MVC   STREC(3),RPCLT                                                   
         LH    R0,CLTHDR+22                                                     
         BAS   R9,CVD                                                           
         MVC   STREC+3(3),WORK+7                                                
         MVC   STREC+6(3),PKEY+4                                                
         MVC   STREC+9(4),PACCT                                                 
         SR    R0,R0                                                            
         IC    R0,BKEY+7                                                        
         BAS   R9,CVD                                                           
         MVC   STREC+14(3),WORK+7                                               
*                                                                               
         MVC   STREC+17(4),BMONSERV  YYMM                                       
         MVC   STREC+21(6),BINVNO                                               
         MVC   STREC+27(6),BQDATE                                               
*                                                                               
         PACK  STREC+33(6),BAMT    GROSS                                        
*                                                                               
         MVC   DUB(4),BNET                                                      
         L     R0,DUB                                                           
         BAS   R9,CVD                                                           
         ZAP   STREC+39(6),DUB     NET                                          
*                                                                               
         MVC   DUB(4),BACTUAL                                                   
         L     R0,DUB                                                           
         BAS   R9,CVD                                                           
         ZAP   STREC+45(6),DUB     ACTUAL                                       
*                                                                               
         ZAP   DUB,STREC+45(6)     ACTUAL                                       
         SP    DUB,STREC+39(6)     -NET                                         
         ZAP   STREC+51(6),DUB     =COMM                                        
*                                                                               
         ZAP   STREC+57(6),=P'0'   CASH DISC                                    
*                                                                               
         MVC   STREC+63(1),QMED    MEDIA CODE                                   
         MVI   STREC+73,C'O'                                                    
         CLI   BTYPE,4                                                          
         BNE   *+8                                                              
         MVI   STREC+73,C'D'                                                    
*                                                                               
         L     R1,TPFILE                                                        
         LA    R0,STREC                                                         
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
CAMPMTH  DS    0H                                                               
         MVI   CAREC,C' '                                                       
         MVC   CAREC+1(99),CAREC                                                
*                                                                               
         GOTO1 =V(CLUNPK),DMCB,BKEY+2,CAREC                                     
         MVC   CAREC+3(3),BKEY+4                                                
         ZIC   R0,BKEY+7                                                        
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  CAREC+6(3),DUB                                                   
         MVC   CAREC+9(4),BMONSERV                                              
         MVC   CAREC+13(2),=C'TV'                                               
         CLI   QMED,C'T'                                                        
         BE    CMTH4                                                            
         MVC   CAREC+13(2),=C' R'                                               
         CLI   QMED,C'R'                                                        
         BE    CMTH4                                                            
         MVC   CAREC+13(2),=C' N'                                               
         CLI   QMED,C'N'                                                        
         BE    CMTH4                                                            
         MVC   CAREC+13(2),=C' X'                                               
         CLI   QMED,C'X'                                                        
         BE    CMTH4                                                            
*                                                                               
CMTH4    DS    0H                                                               
         MVI   CAREC+15,C'-'                                                    
         MVC   CAREC+16(2),BDATE+2                                              
         MVI   CAREC+18,C'-'                                                    
         MVC   CAREC+19(4),BINVNO+2                                             
*                                                                               
         MVC   CAREC+23(6),BQDATE                                               
*                                                                               
         PACK  DUB,BAMT                                                         
         UNPK  CAREC+29(10),DUB                                                 
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  CAREC+39(10),DUB                                                 
         ZAP   DUB,=P'0'                                                        
         UNPK  CAREC+49(10),DUB                                                 
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  CAREC+59(10),DUB                                                 
*                                                                               
         LH    R0,CLTHDR+22                                                     
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  CAREC+69(3),DUB                                                  
*                                                                               
         GOTO1 =V(DATCON),DMCB,(3,BDUEDATE),CAREC+72                            
*                                                                               
         LA    R1,CAFILE                                                        
         PUT   (1)                                                              
*                                                                               
         B     NEXTREC                                                          
         SPACE 2                                                                
         EJECT                                                                  
FCB      DS    0H                                                               
         MVI   FCREC,C' '                                                       
         MVC   FCREC+1(127),FCREC                                               
         MVC   FCREC(8),=C'02001125'                                            
         MVC   FCREC+8(2),=C'04'                                                
         CLI   QMED,C'R'                                                        
         BNE   *+10                                                             
         MVC   FCREC+8(2),=C'05'                                                
         IC    RE,COFFICE                                                       
         SLL   RE,28                                                            
         SRL   RE,27                                                            
         LA    RE,FCTAB-2(RE)                                                   
         MVC   FCREC+10(2),0(RE)                                                
         B     FC2                                                              
FCTAB    DC    C'020406900810'                                                  
*                                                                               
FC2      MVC   FCREC+12(4),PACCT                                                
         MVC   FCREC+16(3),PKEY+4                                               
         ZIC   R0,BKEY+7                                                        
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  FCREC+19(4),DUB                                                  
* TEST ADJUSTMENT, CURRENT, OR FUTURE BILLING                                   
         ZIC   R0,BKEY+8           GET Y/S                                      
         SRDL  R0,32                                                            
         D     R0,=F'10'                                                        
         SLL   R0,4                SHIFT REMAINDER                              
         STC   R0,DUB                                                           
         OC    DUB(1),BKEY+9       'OR' IN MOS                                  
         CLC   DUB(1),BKEY+10      TEST MOS = BILL MONTH                        
         MVC   FCREC+23(2),=C'60'  CURRENT                                      
         BE    FC4                                                              
         MVC   FCREC+23(2),=C'00'  ADJ                                          
         BL    FC4                                                              
         MVC   FCREC+23(2),=C'70'  FUTURE                                       
*                                                                               
FC4      MVC   FCREC+25(2),=C'00'                                               
         MVC   FCREC+27(6),BINVNO                                               
*                                                                               
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         BAS   R9,CVD                                                           
         MVC   FCREC+33(2),=C'00'                                               
         MVC   FCREC+35(10),WORK                                                
*                                                                               
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         BAS   R9,CVD                                                           
         MVC   FCREC+45(2),=C'00'                                               
         MVC   FCREC+47(10),WORK                                                
         MVC   FCREC+57(12),FCREC+45                                            
*                                                                               
         ZIC   R0,BDUEDATE                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(2),DUB                                                      
         IC    R0,BDUEDATE+1                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+2(2),DUB                                                    
         IC    R0,BDUEDATE+2                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+4(2),DUB                                                    
         MVC   FCREC+69(6),WORK                                                 
*                                                                               
         MVC   FCREC+75(6),BDATE                                                
         OC    FCREC+81(20),CNAME  'OR' IN TO PRESERVE SPACES                   
         OC    FCREC+101(20),PNAME                                              
         GOTO1 =V(CLUNPK),DMCB,CKEY+2,FCREC+121                                 
         MVC   FCREC+124(3),PKEY+4                                              
*                                                                               
         LA    R1,FCFILE                                                        
         LA    R0,FCREC                                                         
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
ROSS     DS    0H                                                               
         MVI   ROSSREC,C' '                                                     
         MVC   ROSSREC+1(79),ROSSREC                                            
*                                                                               
         MVC   ROSSREC(6),BINVNO                                                
*                                                                               
ROSS4    MVC   ROSSREC+6(4),BQDATE+2  MMDD                                      
         MVC   ROSSREC+10(2),BQDATE YY                                          
*                                                                               
         LH    R0,CLTHDR+22                                                     
         BAS   R9,CVD                                                           
         MVC   ROSSREC+12(4),WORK+6                                             
*                                                                               
         MVC   ROSSREC+16(2),=C'14'                                             
         CLI   QMED,C'R'                                                        
         BE    ROSS6                                                            
         MVC   ROSSREC+16(2),=C'15'                                             
         CLI   QMED,C'T'                                                        
         BE    ROSS6                                                            
         MVC   ROSSREC+16(1),QMED                                               
         MVI   ROSSREC+17,C' '                                                  
*                                                                               
ROSS6    DS    0H                                                               
         ZIC   R0,BDUEDATE                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(2),DUB                                                      
         IC    R0,BDUEDATE+1                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+2(2),DUB                                                    
         IC    R0,BDUEDATE+2                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+4(2),DUB                                                    
         MVC   ROSSREC+18(4),WORK+2 MMDD                                        
         MVC   ROSSREC+22(2),WORK  YY                                           
*                                                                               
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         BAS   R9,CVD                                                           
         MVC   ROSSREC+24(8),WORK+2                                             
*                                                                               
         SR    R0,R0                                                            
         BAS   R9,CVD                                                           
         MVC   ROSSREC+32(6),WORK+4                                             
*                                                                               
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         BAS   R9,CVD                                                           
         MVC   ROSSREC+38(8),WORK+2                                             
         MVC   ROSSREC+46(8),WORK+2                                             
*                                                                               
         MVC   ROSSREC+54(2),=C'TV'                                             
         CLI   QMED,C'T'                                                        
         BE    ROSS7                                                            
         CLI   QMED,C'N'                                                        
         BE    ROSS7                                                            
         MVC   ROSSREC+54(2),=C' R'                                             
ROSS7    DS    0H                                                               
         MVC   ROSSREC+56(6),ROSSREC                                            
         LA    R0,ROSSREC                                                       
         LA    R1,RRFILE                                                        
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
*                             INTERPUBLIC                                       
INTP     DS    0H                                                               
         MVI   INTPREC,C' '                                                     
         MVC   INTPREC+1(99),INTPREC                                            
*                                                                               
         MVC   INTPREC(2),RPAGY         AGENCY                                  
         MVI   INTPREC+2,C'S'           SPOT                                    
         MVC   INTPREC+3(1),QMED        MEDIA                                   
*                                                                               
         MVC   INTPREC+4(3),RPCLT       CLIENT                                  
         LH    R0,CLTHDR+22                                                     
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  INTPREC+7(4),DUB         CLT NUM                                 
         MVC   INTPREC+11(1),COFFICE                                            
*                                                                               
         MVC   INTPREC+12(3),PKEY+4     PRD CODE                                
         MVC   INTPREC+16(4),PACCT PRD ACCT NO.                                 
*                                                                               
         ZIC   R0,BKEY+7                EST                                     
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  INTPREC+20(3),DUB                                                
*                                                                               
         MVC   INTPREC+23(6),BINVNO     INVOICE NO.                             
*                                                                               
         MVC   INTPREC+29(6),BQDATE     INV. DATE                               
*                                                                               
         ZIC   R0,BDUEDATE                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(2),DUB                                                      
         IC    R0,BDUEDATE+1                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+2(2),DUB                                                    
         IC    R0,BDUEDATE+2                                                    
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+4(2),DUB                                                    
         MVC   INTPREC+35(6),WORK       DUE DATE                                
*                                                                               
         MVC   FULL,BACTUAL             ACTUAL                                  
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  INTPREC+41(10),DUB                                               
*                                                                               
         MVC   FULL,BNET                NET                                     
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  INTPREC+51(10),DUB                                               
*                                                                               
         MVC   FULL,BACTUAL             ACTUAL                                  
         L     R0,FULL                                                          
         MVC   FULL,BNET                LESS NET                                
         S     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  INTPREC+61(10),DUB       = COMMISSION                            
*                                                                               
         MVC   INTPREC+71(10),=10C'0'   C.D.                                    
*                                                                               
         LA    R0,INTPREC                                                       
         LA    R1,INTFILE                                                       
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
*                                  BOZELL & JACOBS                              
         SPACE 2                                                                
BJTP     DS    0H                                                               
         MVI   BJREC,C' '                                                       
         MVC   BJREC+1(L'BJREC-1),BJREC                                         
*                                                                               
         MVI   BJREC,C'S'               SPOT                                    
         MVC   BJREC+1(1),QMED          MEDIA                                   
         MVC   BJREC+2(1),COFFICE       OFFICE                                  
         MVC   BJREC+3(3),RPCLT         CLT                                     
         MVC   BJREC+6(3),BKEY+4        PRD                                     
         ZIC   R0,BKEY+7                                                        
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  BJREC+9(3),DUB      EST                                          
         MVC   BJREC+12(4),BMONSERV     MOS                                     
*                                       INV. NO. PREFIX                         
         MVC   BJREC+16(2),=C'TV'                                               
         CLI   QMED,C'T'                                                        
         BE    BJ4                                                              
         MVC   BJREC+16(2),=C' R'                                               
         CLI   QMED,C'R'                                                        
         BE    BJ4                                                              
         MVC   BJREC+16(2),=C' N'                                               
         CLI   QMED,C'N'                                                        
         BE    BJ4                                                              
         MVC   BJREC+16(2),=C' X'                                               
         CLI   QMED,C'X'                                                        
         BE    BJ4                                                              
*                                                                               
BJ4      DS    0H                                                               
         MVC   BJREC+18(2),BINVNO       MONTH                                   
         MVC   BJREC+20(4),BINVNO+2     INV NO                                  
         MVC   BJREC+24(6),BQDATE       DATE ON BILL                            
         GOTO1 =V(DATCON),DMCB,(3,BDUEDATE),BJREC+30   DUE                      
         MVC   BJREC+36(10),BAMT                                                
         UNPK  BJREC+46(10),=P'0'                                               
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  BJREC+56(10),DUB                                                 
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  BJREC+66(10),DUB                                                 
*                                  MARKET GROUP                                 
         MVC   BJREC+76(5),BCANINV   MKT GROUP                                  
BJ6      DS    0H                                                               
         LA    RF,ESTHDR                                                        
         CLC   BKEY(8),0(RF)            TEST HAVE EST                           
         BNE   *+10                                                             
         MVC   TREC+79(20),EDESC-ESTHDR(RF)                                     
*                                                                               
         MVC   TREC+99(3),PDIV              DIVISION                            
*                                                                               
         LA    R0,BJREC                                                         
         LA    R1,BJFILE                                                        
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
*                                  COMPTON                                      
         SPACE 2                                                                
COMTP    DS    0H                                                               
         MVI   TREC,C' '                                                        
         MVC   TREC+1(L'TREC-1),TREC                                            
*                                                                               
*                                  ** COMPTON INTERFACE TAPE **                 
*                                  ** ALSO RUMRILL-HOYT - RH **                 
*                                  ** ALSO ROSS ROY NEW YORK - RN **            
*                                                                               
         MVC   TREC(2),=C'01'      MEDIA                                        
         CLI   QMED,C'T'                                                        
         BE    *+10                                                             
         MVC   TREC(2),=C'02'                                                   
*                                                                               
         ZIC   R0,BKEY+7          EST                                           
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  TREC+2(4),DUB                                                    
*                                                                               
         MVC   TREC+11(6),ZEROS                                                 
         MVC   TREC+17(4),BMONSERV MOS                                          
*                                                                               
         GOTO1 =V(CLUNPK),DMCB,BKEY+2,TREC+24   CLIENT                          
         MVC   TREC+27(3),BKEY+4            PRODUCT                             
         MVC   TREC+30(3),ZEROS                                                 
         MVC   TREC+78(6),ZEROS                                                 
         MVC   TREC+91(11),ZEROS                                                
*                                                                               
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  TREC+102(9),DUB     ACTUAL                                       
*                                                                               
         MVC   TREC+111(7),ZEROS                                                
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  TREC+118(9),DUB     NET                                          
*                                                                               
         MVC   TREC+127(9),ZEROS                                                
         MVC   TREC+136(5),ZEROS                                                
         MVC   TREC+141(4),BQDATE+2      BQDATE (MMDDYY)                        
         MVC   TREC+145(2),BQDATE                                               
*                                                                               
         MVC   TREC+147(3),BINVNO+3     INVOICE NUMBER                          
         LA    RF,ESTHDR                                                        
         CLC   BKEY(8),0(RF)            TEST HAVE EST                           
         BNE   *+10                                                             
         MVC   TREC+150(11),EDESC-ESTHDR(RF)                                    
*                                                                               
         LA    RF,CLTHDR                                                        
         MVC   TREC+161(16),CNAME-CLTHDR(RF)                                    
*                                                                               
         LA    R1,CMPFIL                                                        
         LA    R0,TREC                                                          
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
*                             K + E                                             
KNTP     DS    0H                                                               
         MVI   TREC,C' '                                                        
         MVC   TREC+1(L'TREC-1),TREC                                            
*                                                                               
*                             **KENYON + ECKHARDT**                             
         LA    RF,CLTHDR                                                        
         LH    R0,22(RF)                                                        
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  TREC(3),DUB         CLT NUM                                      
         LA    RF,PRDHDR                                                        
         MVC   TREC+3(2),PACCT+2-PRDHDR(RF)  PRD ACCT                           
         MVC   TREC+5(5),TREC                                                   
         MVI   TREC+10,C'S'                                                     
         MVC   TREC+11(1),QMED                                                  
         MVC   TREC+12(6),BINVNO                                                
         MVC   TREC+19(4),BQDATE+2                                              
         MVC   TREC+23(2),BQDATE                                                
*                                                                               
         MVC   FULL,BACTUAL                                                     
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  TREC+28(10),DUB          ACTUAL                                  
*                                                                               
         MVC   TREC+38(7),ZEROS                                                 
*                                                                               
         MVC   DUB,BNET                                                         
         L     R0,DUB+4            ACTUAL                                       
         S     R0,DUB              - NET = PROFIT                               
         CVD   R0,DUB                                                           
         UNPK  TREC+45(10),DUB                                                  
*                                                                               
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  TREC+55(10),DUB     NET                                          
*                                                                               
         MVC   TREC+75(2),BDATE+2                                               
         MVC   TREC+77(2),BDATE                                                 
         MVI   TREC+79,C'B'                                                     
*                                                                               
*                                                                               
         LA    R1,KNFILE                                                        
         LA    R0,TREC                                                          
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
*                                  HENDERSON                                    
         SPACE 2                                                                
HETP     DS    0H                                                               
         XC    TREC,TREC                                                        
*                                                                               
         MVC   TREC+2(6),BINVNO                                                 
         MVC   TREC+8(2),=C'TV'                                                 
         CLI   QMED,C'T'                                                        
         BE    HETP4                                                            
         MVC   TREC+8(2),=C'R '                                                 
         CLI   QMED,C'R'                                                        
         BE    HETP4                                                            
         MVC   TREC+8(2),=C'N '                                                 
         CLI   QMED,C'N'                                                        
         BE    HETP4                                                            
         MVC   TREC+8(2),=C'X '                                                 
         CLI   QMED,C'X'                                                        
         BE    HETP4                                                            
*                                                                               
HETP4    DS    0H                                                               
         MVC   TREC+10(4),BQDATE+2                                              
         MVC   TREC+14(2),BQDATE                                                
         MVC   TREC+16(10),BAMT                                                 
*                                                                               
         MVC   FULL,BNET                                                        
         L     R0,FULL                                                          
         CVD   R0,DUB                                                           
         UNPK  TREC+26(10),DUB                                                  
*                                                                               
         MVC   TREC+36(10),=10C'0'                                              
*                                                                               
         MVC   TREC+45(4),PACCT                                                 
         MVC   TREC+49(2),PNAME+18                                              
*                                                                               
         LA    R0,TREC                                                          
         LA    R1,HEFILE                                                        
         PUT   (1),(0)                                                          
*                                                                               
         B     NEXTREC                                                          
         EJECT                                                                  
NEWPRD   GOTO1 =V(DATAMGR),DMCB,DMRDIR,SPOT,KEY+14,PRDHDR                       
         CLI   8(R1),0                                                          
         BE    *+6                                                              
         DC    H'0'                                                             
         B     NEXTREC                                                          
         SPACE 2                                                                
ENDCLT   CLI   CLTACT,0                                                         
         BE    EXIT                                                             
         MVI   CLTACT,0                                                         
         MVI   PL,X'41'                                                         
         MVC   PL+2(19),=C'** CLIENT TOTALS **'                                 
         LA    R4,CLTTOTG                                                       
         BAS   RE,FMTTOT                                                        
         BAS   RE,PRTPL                                                         
         B     EXIT                                                             
         SPACE 2                                                                
ENDREQ   MVI   LNCNT+1,200         FORCE NEW PAGE                               
         MVC   PL+2(20),=C'** REQUEST TOTALS **'                                
         LA    R4,RPTTOTG                                                       
         BAS   RE,FMTTOT                                                        
         BAS   RE,PRTPL                                                         
         MVI   PL,X'41'                                                         
         MVC   PL+2(80),QAREA                                                   
         BAS   RE,PRTPL                                                         
         MVI   LNCNT+1,200                                                      
         B     EXIT                                                             
         EJECT                                                                  
*                                                                               
ENDRPT   L     R1,TPFILE                                                        
         LTR   R1,R1                                                            
         BZ    CLOSEX                                                           
CLOSE    DS    0H                                                               
*                                                                               
         CLOSE (1)                                                              
*                                                                               
CLOSEX   DS    0H                                                               
EXIT     XMOD1 1                                                                
         SPACE 2                                                                
CVD      CVD   R0,DUB                                                           
         LTR   R0,R0                                                            
         BM    *+8                                                              
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(10),DUB                                                     
         BR    R9                                                               
         EJECT                                                                  
FMTTOT   L     R0,0(R4)            GROSS                                        
         XC    0(4,R4),0(R4)                                                    
         EDIT  (R0),(16,PL+38),2,COMMAS=YES,CR=YES                              
         LTR   R0,R0                                                            
         BM    *+8                                                              
         MVI   PL+52,C'*'                                                       
*                                                                               
         L     R0,8(R4)            NET                                          
         XC    8(4,R4),8(R4)                                                    
         EDIT  (R0),(16,PL+54),2,COMMAS=YES,CR=YES                              
         LTR   R0,R0                                                            
         BM    *+8                                                              
         MVI   PL+68,C'*'                                                       
*                                                                               
         L     R0,16(R4)           ACTUAL                                       
         XC    16(4,R4),16(R4)                                                  
         EDIT  (R0),(16,PL+70),2,COMMAS=YES,CR=YES                              
         LTR   R0,R0                                                            
         BM    *+8                                                              
         MVI   PL+84,C'*'                                                       
*                                                                               
*                                                                               
         BR    RE                                                               
         SPACE 3                                                                
ZEROS    DC    30C'0'                                                           
         EJECT                                                                  
PRTPL    RPPRT PL,52,SP005HL                                                    
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
SP005HL  CSECT                                                                  
         NMOD1 0,SP005HL                                                        
         L     RC,=V(RPWORKC)                                                   
         USING RPWORK,RC                                                        
*                                                                               
         XC    HL,HL                                                            
         MVI   HL,X'C1'                                                         
         L     R4,=V(MEDEXP)                                                    
         MVC   HL+1(10),1(R4)                                                   
         L     R1,TPFILE                                                        
         LTR   R1,R1                                                            
         BZ    *+10                                                             
         MVC   HL+25(7),22(R1)     MOVE DTF NAME                                
         MVC   HL+33(23),=C'INTERFACE TAPE CREATION'                            
         MVC   HL+70(33),AGYNAME                                                
         BAS   RE,PRTHL                                                         
         MVC   HL+25(30),=30C'-'                                                
         MVC   HL+70(33),AGYADDR                                                
         BAS   RE,PRTHL                                                         
         GOTO1 =V(PFRMTO),DMCB,HL+25                                            
         GOTO1 =V(RUNTIM),(R1),HL+1                                             
         MVC   HL+70(4),=C'PAGE'                                                
         MVC   NUM,MASKA                                                        
         LH    R0,PGCNT                                                         
         CVD   R0,DUB                                                           
         ED    NUM,DUB+3                                                        
         MVC   HL+75(3),NUM+7                                                   
         BAS   RE,PRTHL                                                         
*                                                                               
         MVI   HL,X'41'                                                         
         MVC   HL+1(85),TITLE1                                                  
         BAS   RE,PRTHL                                                         
         MVC   HL+1(85),TITLE1UN                                                
         BAS   RE,PRTHL                                                         
         BAS   RE,PRTHL            SKIP A LINE                                  
*                                                                               
         XMOD1 1                                                                
*                                                                               
TITLE1   DC    C'       CLT PRD  EST   MON SVC INVOICE         GROSS   X        
                         NET          ACTUAL'                                   
TITLE1UN DC    C'       --- ---  ---   ------- -------   ------------- X        
                 -------------    ------------'                                 
         EJECT                                                                  
PRTHL    RPPRT HL                                                               
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
       ++INCLUDE SP005WRK                                                       
         PRINT OFF                                                              
       ++INCLUDE RPWORK                                                         
