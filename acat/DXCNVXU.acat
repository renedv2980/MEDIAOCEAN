*          DATA SET DXCNVXU    AT LEVEL 013 AS OF 09/20/00                      
*CATALP DXCNVX                                                                  
         PRINT NOGEN                                                            
         TITLE 'DXCNVX- DXTRACT SQL DATA CONVBERSION MODULE'                    
***********************************************************************         
*                                                                     *         
* TITLE:      DXCNVX - DXTRACT SQL DATA CONVERSION MODULE             *         
*                                                                     *         
* COMMENTS:   MODULE INCLUDED IN DXTRACT CONTROLLER                   *         
*             CONVERTS STANDARD SQL EXTRACT DATA RECORD               *         
*             AS GENERATED BY APPLICATION SUB-SYSTEM MODULE           *         
*             TO FORMATS SUTABLE FOR VARIOUS DATABASE                 *         
*             PLATFORMS AND OPERATING CONTEXTS.                       *         
*             CALLED BY EXTRACT SUB-SYSTEM MODULE.                    *         
*             CONTROLLED BY PARAMETERS IN DXTRACT CONTROL BLOCKS      *         
*             (SEE DXDSECTS) AND DATA IN APPLICATION DATA RECORD      *         
*             SPECIFIC RECORD CONVERSION TABLE (SEE DXCNVXD)          *         
*                                                                     *         
* PARAMETER ON ENTRY:                                                 *         
*                P1 = A(RECORD CONVERT TABLE)                         *         
*                                                                     *         
* INPUT RECORD:  DXAXREC - A(EXTRACT RECORD BUFFER)                   *         
*                                                                     *         
* OUTPUT RECORD: DXASQLB - A(SQL DATA RECORD BUFFER)                  *         
*                                                                     *         
***********************************************************************         
         SPACE 1                                                                
DXCNVX   CSECT                                                                  
         NMOD1 WORKL,*DXCNVX*,RA,CLEAR=YES                                      
         USING WORKD,RC                                                         
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
*                                                                               
         L     R8,=V(DXBLOCK)                                                   
         USING DXBLOCKD,R8                                                      
         L     R7,DXSTPTR                                                       
         USING SXDTABD,R7                                                       
         ICM   R3,15,DXAXREC                                                    
INREC    USING DXHDRD,R3                                                        
         ICM   R4,15,DXASQLB                                                    
OUTREC   USING DXHDRD,R4                                                        
*                                                                               
         XC    OUTREC.DXHDRLEN,OUTREC.DXHDRLEN                                  
         LA    RF,4(R4)                                                         
         ST    RF,ANOW             SET A(FIRST DATA)                            
*                                                                               
         MVC   VERSION,SXDTVER     GET DXDSECTS CONTROL PARAMETERS              
         MVC   PLATFORM,SXDTPLFM                                                
         MVC   DELIM,DXDELIM                                                    
         CLI   DELIM,0                                                          
         BNE   *+8                                                              
         MVI   DELIM,C';'                                                       
         MVC   FIXEDFLG,DXFIXED                                                 
         MVC   FORMCODE,DXFORMAT                                                
         MVC   NULLCODE,DXNULCOD                                                
         MVC   NULLIFCD,DXNLIFCD                                                
         MVC   ESCODE,DXESCAPE                                                  
         MVC   TRANSCOD,DXTRANS                                                 
         MVC   MONYCODE,DXMONCOD                                                
         MVC   DATEFORM,DXDAFORM                                                
         MVC   ERRFLG,DXERROR                                                   
         MVC   SYSTEM,DXSYSTEM                                                  
         MVC   SUBSYS,DXSUBSYS                                                  
         DROP  R7                                                               
*                                                                               
         MVI   LOADMODE,C'Y'                                                    
         CLI   DXMODE,DXUPDTQ                                                   
         BNE   *+8                                                              
         MVI   LOADMODE,C'U'                                                    
*                                                                               
         MVI   KILLMODE,C'N'                                                    
         CLI   INREC.DXHDRRTY,C'K'                                              
         BNE   *+8                                                              
         MVI   KILLMODE,C'Y'                                                    
*                                                                               
         BAS   RE,TRANSACT         CONVERT TRANSACTION CONTROL FIELDS           
*                                                                               
         ICM   R6,15,ADXCRCT                                                    
         USING DXCRECD,R6                                                       
         SR    R5,R5                                                            
         ICM   R5,3,0(R6)                                                       
         AR    R5,R6                                                            
         LA    R6,2(R6)                                                         
*                                                                               
DXCN010  EQU   *                                                                
         CR    R6,R5                                                            
         BNL   DXCN030                                                          
*                                                                               
         LA    R7,FCNVTAB                                                       
         USING FCNVTABD,R7                                                      
*                                                                               
DXCN012  CLI   0(R7),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLC   DXCRDT,FCNVTYPE     MATCH DATA TYPE NAME                         
         BE    DXCN014                                                          
*                                                                               
         LA    R7,FCNVTABL(R7)                                                  
         B     DXCN012                                                          
*                                                                               
DXCN014  XR    R2,R2                                                            
         ICM   R2,3,DXCRLEN        GET LENGTH OF INPUT                          
         XR    R3,R3                                                            
         ICM   R3,3,DXCRDSP                                                     
*                                                                               
         ICM   RF,15,DXAXREC                                                    
         AR    R3,RF               R3=A(DATA IN UNCONVERTED RECORD)             
         L     R4,ANOW             R4=A(BUILD AREA IN CONVERTED RECORD)         
*                                                                               
         MVI   OPTIONAL,C'N'                                                    
         LA    RF,DXCRRN           FOR NORMAL BUILD                             
         CLI   KILLMODE,C'Y'       'KILL' MODE                                  
         BNE   *+8                 NO                                           
         LA    RF,DXCRRK           FOR 'KILL' BUILD                             
         CLI   0(RF),DXCOPT                                                     
         BNE   *+8                                                              
         MVI   OPTIONAL,C'Y'                                                    
*                                                                               
         CLC   DXCRVER,VERSION     MAKE SURE FOR THIS VERSION                   
         BH    DXCN020             NO                                           
*                                                                               
         MVI   NUMTYPE,C'N'                                                     
         TM    FCNVFLGS,FCNVFNUQ   TEST NUMERIC DATA TYPE CONVERSION            
         BZ    *+8                                                              
         MVI   NUMTYPE,C'Y'                                                     
*                                                                               
         MVI   DECPOINT,0                                                       
         TM    FCNVFLGS,FCNVFDCQ   TEST DECIMAL NUMVERIC TYPE                   
         BZ    *+10                                                             
         MVC   DECPOINT,FCNVDECP                                                
*                                                                               
         CLI   DXCRDT,DXCBIT                                                    
         BE    DXCN016                                                          
         CLI   DXCRDT,DXCNONE                                                   
         BE    DXCN016                                                          
         CLI   DXCRDT,DXCDEF                                                    
         BE    DXCN016                                                          
         BAS   RE,NULLFLD          CHECK FOR NULL FIELD                         
         BE    DXCN018                                                          
*                                                                               
DXCN016  EQU   *                                                                
         ICM   RF,15,FCNVROUT                                                   
         BASR  RE,RF               BRANCH TO PROCESSING ROUTINE                 
*                                                                               
DXCN018  BAS   RE,DELIMOUT         OUTPUT FIELD DELIMITER                       
*                                                                               
DXCN020  EQU   *                                                                
         LA    R6,DXCRECLQ(R6)                                                  
         B     DXCN010             DO FOR ALL DATA FIELDS IN RECORD             
         DROP  R6,R7                                                            
*                                                                               
DXCN030  EQU   *                                                                
         ICM   RF,15,DXASQLB                                                    
         L     R4,ANOW                                                          
         SR    R4,RF                                                            
         SLL   R4,16                                                            
         STCM  R4,15,0(RF)                                                      
         B     EXITOK                                                           
*                                                                               
EXITOK   SR    RC,RC                                                            
EXITNO   LTR   RC,RC                                                            
EXIT     XMOD1 ,                                                                
         EJECT                                                                  
***********************************************************************         
* CONVERT CHARACTER STRING DATA TYPE                                  *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CCHAR    NTR1  ,                                                                
         BAS   RE,DROPSPC          DROP TRAILING SPACES                         
         BAS   RE,MVCIO            MOVE CHARACTERS TO OUTPUT BUFFER             
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT VARCHAR STRING DATA TYPE                                    *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CVCHAR   NTR1  ,                                                                
         BAS   RE,DROPSPC          DROP TRAILING SPACES                         
         BAS   RE,MVCIO            MOVE CHARACTERS TO OUTPUT BUFFER             
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT VARIABLE CHARACTER STRING DATA TYPE                                   
*                                                                               
* NTRY: R2 = L'UNCONVERTED STRING                                               
*       R3 = A(UNCONVERTED STRING)                                              
*       R4 = A(OUTPUT BUFFER)                                                   
***********************************************************************         
         SPACE 1                                                                
VCHARDB2 NTR1  ,                                                                
         BAS   RE,DROPSPC          DROP TRAILING SPACES                         
         BAS   RE,MVCIO            MOVE CHARACTERS TO OUTPUT BUFFER             
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT TINY INTEGER DATA TYPE                                      *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CTINT    NTR1  ,                                                                
         BAS   RE,DROPZERO         DROP LEADING ZEROES                          
         MVI   SIGNFLAG,0                                                       
         LR    RE,R2                                                            
         LR    RF,R3                                                            
*                                                                               
         CLI   0(R3),C'+'          CHECK FOR PREFIX SIGN CHARACTER              
         BE    *+12                                                             
         CLI   0(R3),C'-'                                                       
         BNE   CTIN010                                                          
         MVI   SIGNFLAG,1          SET SIGN EXISTS                              
         BCTR  RE,0                                                             
         LA    RF,1(RF)                                                         
*                                  RF = A(FIRST CHARACTER)                      
*                                  R0 = LENGTH LEFT TO VALIDATE                 
CTIN010  EQU   *                                                                
         CLI   0(RF),C'0'          TEST FOR VALID DIGIT CHARACTERS              
         BL    CTINERR                                                          
         CLI   0(RF),C'9'                                                       
         BH    CTINERR                                                          
         LA    RF,1(RF)                                                         
         BCT   RE,CTIN010                                                       
*                                                                               
         LR    RF,R2                                                            
         CLI   SIGNFLAG,0                                                       
         BE    *+6                                                              
         BCTR  RF,0                                                             
         CH    RF,=H'3'            MAXIMUM 3 NUMERIC DIGITS                     
         BH    CTINERR                                                          
         BAS   RE,MVCIO            MOVE DIGITS TO OUTPUT BUFFER                 
         B     CTINOK                                                           
*                                                                               
CTINERR  EQU   *                                                                
         CLI   ERRFLG,C'Y'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         BAS   RE,DEFAULT                                                       
         B     CTINOK                                                           
*                                                                               
CTINNO   B     NO                                                               
CTINOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT SMALL INTEGER DATA TYPE                                     *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CSINT    NTR1  ,                                                                
         BAS   RE,DROPZERO         DROP LEADING ZEROES                          
         MVI   SIGNFLAG,0                                                       
         LR    RE,R2                                                            
         LR    RF,R3                                                            
*                                                                               
         CLI   0(R3),C'+'          CHECK FOR PREFIX SIGN CHARACTER              
         BE    *+12                                                             
         CLI   0(R3),C'-'                                                       
         BNE   CSIN010                                                          
         MVI   SIGNFLAG,1          SET SIGN EXISTS                              
         BCTR  RE,0                                                             
         LA    RF,1(RF)                                                         
*                                  RF = A(FIRST CHARACTER)                      
*                                  R0 = LENGTH LEFT TO VALIDATE                 
CSIN010  EQU   *                                                                
         CLI   0(RF),C'0'          TEST FOR VALID DIGIT CHARACTERS              
         BL    CSINERR                                                          
         CLI   0(RF),C'9'                                                       
         BH    CSINERR                                                          
         LA    RF,1(RF)                                                         
         BCT   RE,CSIN010                                                       
*                                                                               
         LR    RF,R2                                                            
         CLI   SIGNFLAG,0                                                       
         BE    *+6                                                              
         BCTR  RF,0                                                             
         CH    RF,=H'5'            MAXIMUM 5 NUMERIC DIGITS                     
         BH    CSINERR                                                          
         BAS   RE,MVCIO            MOVE DIGITS TO OUTPUT BUFFER                 
         B     CSINOK                                                           
*                                                                               
CSINERR  EQU   *                                                                
         CLI   ERRFLG,C'Y'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         BAS   RE,DEFAULT                                                       
         B     CSINOK                                                           
*                                                                               
CSINNO   B     NO                                                               
CSINOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT INTEGER DATA TYPE                                           *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CINT     NTR1  ,                                                                
         BAS   RE,DROPZERO         DROP LEADING ZEROES                          
         MVI   SIGNFLAG,0                                                       
         LR    RE,R2                                                            
         LR    RF,R3                                                            
*                                                                               
         CLI   0(R3),C'+'          CHECK FOR PREFIX SIGN CHARACTER              
         BE    *+12                                                             
         CLI   0(R3),C'-'                                                       
         BNE   CINT010                                                          
         MVI   SIGNFLAG,1          SET SIGN EXISTS                              
         BCTR  RE,0                                                             
         LA    RF,1(RF)                                                         
*                                  RF = A(FIRST CHARACTER)                      
*                                  R0 = LENGTH LEFT TO VALIDATE                 
CINT010  EQU   *                                                                
         CLI   0(RF),C'0'          TEST FOR VALID DIGIT CHARACTERS              
         BL    CINTERR                                                          
         CLI   0(RF),C'9'                                                       
         BH    CINTERR                                                          
         LA    RF,1(RF)                                                         
         BCT   RE,CINT010                                                       
*                                                                               
         LR    RF,R2                                                            
         CLI   SIGNFLAG,0                                                       
         BE    *+6                                                              
         BCTR  RF,0                                                             
         CH    RF,=H'10'           MAXIMUM 10 NUMERIC DIGITS                    
         BH    CINTERR                                                          
         BAS   RE,MVCIO            MOVE DIGITS TO OUTPUT BUFFER                 
         B     CINTOK                                                           
*                                                                               
CINTERR  EQU   *                                                                
         CLI   ERRFLG,C'Y'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         BAS   RE,DEFAULT                                                       
         B     CINTOK                                                           
*                                                                               
CINTNO   B     NO                                                               
CINTOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT REAL DECIMAL DATA TYPE                                      *         
* PROCESSES UPTO 7 DIGITS WITH 2 DECIMAL PLACES IMPLIED               *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CREAL    NTR1  ,                                                                
         ZIC   RF,DECPOINT                                                      
         SR    R2,RF                                                            
         BM    CREAERR                                                          
         BAS   RE,DROPZERO         DROP LEADING ZEROES                          
         LR    RE,R2                                                            
         LR    RF,R3                                                            
*                                                                               
         MVI   SIGNFLAG,0          LOOK FOR PREFIX SIGN                         
         CLI   0(R3),C'+'                                                       
         BE    *+12                                                             
         CLI   0(R3),C'-'                                                       
         BNE   CREA010                                                          
         MVI   SIGNFLAG,1          SET SIGN EXISTS                              
         LTR   RE,RE                                                            
         BZ    CREAERR                                                          
         MVC   0(1,R4),0(R3)                                                    
         LA    R3,1(R3)                                                         
         LA    R4,1(R4)                                                         
         BCTR  RE,0                                                             
         LA    RF,1(RF)                                                         
*                                                                               
CREA010  LTR   RE,RE                                                            
         BNZ   CREA020                                                          
         MVI   0(R4),C'0'          VALUE IS +/-0.XX                             
         LA    R4,1(R4)                                                         
         LA    R2,1(R2)                                                         
         B     CREA030                                                          
*                                                                               
CREA020  EQU   *                                                                
         CLI   0(RF),C'0'                                                       
         BL    CREAERR                                                          
         CLI   0(RF),C'9'                                                       
         BH    CREAERR                                                          
         LA    RF,1(RF)                                                         
         BCT   RE,CREA020                                                       
*                                                                               
         CLI   SIGNFLAG,1                                                       
         BNE   *+6                                                              
         BCTR  R2,0                                                             
         C     R2,=F'6'                                                         
         BH    CREAERR                                                          
         BCTR  R2,0                MOVE DIGITS TO OUTPUT BUFFER                 
         EX    R2,*+4                                                           
         MVC   0(0,R4),0(R3)                                                    
         LA    R2,1(R2)                                                         
         AR    R3,R2                                                            
         AR    R4,R2                                                            
*                                                                               
CREA030  MVI   0(R4),C'.'          OUTPUT DECIMAL POINT                         
         MVC   1(2,R4),0(R3)       MOVE OUT 2 DECIMAL PLACES OF DIGITS          
         LA    R2,3(R2)                                                         
         CLI   SIGNFLAG,1                                                       
         BNE   *+8                                                              
         LA    R2,1(R2)                                                         
         STC   R2,OUTPUTL                                                       
         B     CREAOK                                                           
*                                                                               
CREAERR  EQU   *                                                                
         CLI   ERRFLG,C'Y'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         BAS   RE,DEFAULT                                                       
         B     CREAOK                                                           
*                                                                               
CREANO   B     NO                                                               
CREAOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT FLOAT DECIMAL DATA TYPE                                     *         
* PROCESSES UPTO 15 DIGITS WITH 4 DECIMAL PLACES IMPLIED              *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CFLOAT   NTR1  ,                                                                
         ZIC   RF,DECPOINT                                                      
         SR    R2,RF                                                            
         BM    CFLOERR                                                          
         BAS   RE,DROPZERO         DROP LEADING ZEROES                          
         LR    RE,R2                                                            
         LR    RF,R3                                                            
*                                                                               
         MVI   SIGNFLAG,0          LOOK FOR PREFIX SIGN                         
         CLI   0(R3),C'+'                                                       
         BE    *+12                                                             
         CLI   0(R3),C'-'                                                       
         BNE   CFLO010                                                          
         MVI   SIGNFLAG,1          SET SIGN EXISTS                              
         LTR   RE,RE                                                            
         BZ    CFLOERR                                                          
         MVC   0(1,R4),0(R3)                                                    
         LA    R3,1(R3)                                                         
         LA    R4,1(R4)                                                         
         BCTR  RE,0                                                             
         LA    RF,1(RF)                                                         
*                                                                               
CFLO010  LTR   RE,RE                                                            
         BNZ   CFLO020                                                          
         MVI   0(R4),C'0'          VALUE IS +/-0.XX                             
         LA    R4,1(R4)                                                         
         LA    R2,1(R2)                                                         
         B     CFLO030                                                          
*                                                                               
CFLO020  EQU   *                                                                
         CLI   0(RF),C'0'                                                       
         BL    CFLOERR                                                          
         CLI   0(RF),C'9'                                                       
         BH    CFLOERR                                                          
         LA    RF,1(RF)                                                         
         BCT   RE,CFLO020                                                       
*                                                                               
         CLI   SIGNFLAG,1                                                       
         BNE   *+6                                                              
         BCTR  R2,0                                                             
         C     R2,=F'12'                                                        
         BH    CFLOERR                                                          
         BCTR  R2,0                MOVE DIGITS TO OUTPUT BUFFER                 
         EX    R2,*+4                                                           
         MVC   0(0,R4),0(R3)                                                    
         LA    R2,1(R2)                                                         
         AR    R3,R2                                                            
         AR    R4,R2                                                            
*                                                                               
CFLO030  MVI   0(R4),C'.'          OUTPUT DECIMAL POINT                         
         MVC   1(4,R4),0(R3)       MOVE OUT 2 DECIMAL PLACES OF DIGITS          
         LA    R2,5(R2)                                                         
         CLI   SIGNFLAG,1                                                       
         BNE   *+8                                                              
         LA    R2,1(R2)                                                         
         STC   R2,OUTPUTL                                                       
         B     CFLOOK                                                           
*                                                                               
CFLOERR  EQU   *                                                                
         CLI   ERRFLG,C'Y'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         BAS   RE,DEFAULT                                                       
         B     CFLOOK                                                           
*                                                                               
CFLONO   B     NO                                                               
CFLOOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT BIT DATA TYPE                                                         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CBIT     NTR1  ,                                                                
         MVI   OUTPUTL,1                                                        
         LTR   R2,R2               HANDLE ZERO LENGTH FIELD                     
         BZ    CBITOFF                                                          
         CLI   0(R3),0                                                          
         BE    CBITOFF                                                          
         CLI   0(R3),C'N'                                                       
         BE    CBITOFF                                                          
         CLI   0(R3),C'Y'                                                       
         BE    CBITON                                                           
         B     CBITON                                                           
*                                                                               
CBITON   MVI   0(R4),C'1'         BIT SETTING OF ON                             
         B     XIT                                                              
*                                                                               
CBITOFF  MVI   0(R4),C'0'         BIT SETTING OF OFF                            
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT MONEY DATA TYPE                                             *         
* PROCESSES UPTO 12 DIGITS WITH 2 DECIMAL PLACES IMPLIED              *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CMONEY   NTR1  ,                                                                
         ZIC   RF,DECPOINT                                                      
         SR    R2,RF                                                            
         BM    CMONERR                                                          
         BAS   RE,DROPZERO         DROP LEADING ZEROES                          
         LR    RE,R2                                                            
         LR    RF,R3                                                            
*                                                                               
         MVI   SIGNFLAG,0          LOOK FOR PREFIX SIGN                         
         CLI   0(R3),C'+'                                                       
         BE    *+12                                                             
         CLI   0(R3),C'-'                                                       
         BNE   CMON010                                                          
         MVI   SIGNFLAG,1          SET SIGN EXISTS                              
         LTR   RE,RE                                                            
         BZ    CMONERR                                                          
         MVC   0(1,R4),0(R3)                                                    
         LA    R3,1(R3)                                                         
         LA    R4,1(R4)                                                         
         BCTR  RE,0                                                             
         LA    RF,1(RF)                                                         
*                                                                               
CMON010  EQU   *                                                                
         CLI   MONYCODE,0                                                       
         BE    *+14                                                             
         MVC   0(1,R4),MONYCODE    PREFIX MONEY CODE                            
         LA    R4,1(R4)                                                         
         LTR   RE,RE                                                            
         BNZ   CMON020                                                          
         MVI   0(R4),C'0'          VALUE IS +/-0.XX                             
         LA    R4,1(R4)                                                         
         LA    R2,1(R2)                                                         
         B     CMON030                                                          
*                                                                               
CMON020  EQU   *                                                                
         CLI   0(RF),C'0'                                                       
         BL    CMONERR                                                          
         CLI   0(RF),C'9'                                                       
         BH    CMONERR                                                          
         LA    RF,1(RF)                                                         
         BCT   RE,CMON020                                                       
*                                                                               
         CLI   SIGNFLAG,1                                                       
         BNE   *+6                                                              
         BCTR  R2,0                                                             
         C     R2,=F'12'                                                        
         BH    CMONERR                                                          
         BCTR  R2,0                MOVE DIGITS TO OUTPUT BUFFER                 
         EX    R2,*+4                                                           
         MVC   0(0,R4),0(R3)                                                    
         LA    R2,1(R2)                                                         
         AR    R3,R2                                                            
         AR    R4,R2                                                            
*                                                                               
CMON030  MVI   0(R4),C'.'          OUTPUT DECIMAL POINT                         
         MVC   1(2,R4),0(R3)       MOVE OUT 2 DECIMAL PLACES OF DIGITS          
         LA    R2,3(R2)                                                         
         CLI   SIGNFLAG,1                                                       
         BNE   *+8                                                              
         LA    R2,1(R2)                                                         
         CLI   MONYCODE,0                                                       
         BE    *+8                                                              
         LA    R2,1(R2)                                                         
         STC   R2,OUTPUTL                                                       
         B     CMONOK                                                           
*                                                                               
CMONERR  EQU   *                                                                
         CLI   ERRFLG,C'Y'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         BAS   RE,DEFAULT                                                       
         B     CMONOK                                                           
*                                                                               
CMONNO   B     NO                                                               
CMONOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT TIME STRING DATA TYPE                                       *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CTIME    NTR1  ,                                                                
         BAS   RE,DROPSPC          DROP TRAILING SPACES                         
         BAS   RE,MVCIO            MOVE CHARACTERS TO OUTPUT BUFFER             
         B     XIT                                                              
         EJECT                                                                  
**********************************************************************          
* CONVERT DATE DATA TYPE                                             *          
*                                                                    *          
* NTRY: R2 = L'UNCONVERTED STRING                                    *          
*       R3 = A(UNCONVERTED STRING)                                   *          
*       R4 = A(OUTPUT BUFFER)                                        *          
**********************************************************************          
         SPACE 1                                                                
CDATE    NTR1  ,                                                                
         CLI   DATEFORM,DXTDFI4Q                                                
         BE    CDAT020                                                          
         CLI   DATEFORM,DXTDFI9Q                                                
         BE    CDAT030                                                          
         CLI   PLATFORM,DXTPSYBQ                                                
         BNE   CDAT012                                                          
         LA    RF,8                SET DEFAULT LENGTH                           
         STC   RF,OUTPUTL                                                       
*                                  OUTPUT DATE AS IS FOR UK                     
*&&UK                                                                           
         MVC   0(8,R4),0(R3)                                                    
*                                  SPECIAL EXIT IF MEDIA/SQL SUBSYSTEM          
         CLI   SYSTEM,MEDSYSQ                                                   
         BNE   *+12                                                             
         CLI   SUBSYS,SQLSUBQ                                                   
         BE    CDATOK                                                           
*&&                                                                             
*                                  OUTPUT DATE MM/DD/YY FOR US                  
*                                  ASSUME GIVEN DATE DD/MM/YY                   
*&&US                                                                           
         MVC   0(2,R4),3(R3)                                                    
         MVI   2(R4),C'/'                                                       
         MVC   3(2,R4),0(R3)                                                    
         MVI   5(R4),C'/'                                                       
         MVC   6(2,R4),6(R3)                                                    
*&&                                                                             
*                                                                               
         CLI   DATEFORM,DXTDFNDQ                                                
         BE    CDATOK                                                           
*                                  OUTPUT DEFAULT TIME STAMP                    
         MVI   8(R4),C' '          OUTPUT SPACE TO SEPARATE DATE-TIME           
         MVC   9(L'HHMMSS,R4),HHMMSS                                            
         LA    RF,17               SET OUTPUT LENGTH                            
         STC   RF,OUTPUTL                                                       
         B     CDATOK                                                           
*                                  OUTPUT DATCON 4 DATE TO DD/MM/YYYY           
CDAT012  EQU   *                   (THE OLD RXCNVXDB2 DID THIS - WHY?)          
         B     CDAT020             BUT TERRY CORRECTLY SAYS DO THIS             
         MVC   WORK(8),0(R3)                                                    
         GOTO1 =V(DATCON),DMCB,(4,WORK),(23,WORK+10),RR=Y                       
         MVC   0(2,R4),WORK+15                                                  
         MVI   2(R4),C'/'                                                       
         MVC   3(2,R4),WORK+18                                                  
         MVI   5(R4),C'/'                                                       
         MVC   6(4,R4),WORK+10                                                  
         LA    RF,10                                                            
         STC   RF,OUTPUTL          SAVE OUTPUT LENGTH                           
         B     CDATOK                                                           
*                                                                               
CDAT020  EQU   *                                                                
*                                  OUTPUT DATCON 4 DATE TO YYYY-MM-DD           
         MVC   WORK(8),0(R3)                                                    
         GOTO1 =V(DATCON),DMCB,(4,WORK),(23,WORK+10),RR=Y                       
         MVC   0(10,R4),WORK+10                                                 
         LA    RF,10                                                            
         STC   RF,OUTPUTL          SAVE OUTPUT LENGTH                           
         B     CDATOK                                                           
*                                                                               
CDAT030  EQU   *                                                                
*                                  OUTPUT DATCON 9 DATE TO YYYY-MM-DD           
         MVC   WORK(8),0(R3)                                                    
         GOTO1 =V(DATCON),DMCB,(9,WORK),(23,WORK+10),RR=Y                       
         MVC   0(10,R4),WORK+10                                                 
         LA    RF,10                                                            
         STC   RF,OUTPUTL          SAVE OUTPUT LENGTH                           
         B     CDATOK                                                           
*                                                                               
CDATNO   B     NO                                                               
CDATOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT PACKED DATE TO ISO-DATE                                     *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CPDATE   NTR1  ,                                                                
         GOTO1 VDATCON,DMCB,(1,(R3)),(23,(R4)),0                                
         STC   R2,OUTPUTL                                                       
         B     CPDAOK                                                           
*                                                                               
CPDANO   B     NO                                                               
CPDAOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT BINARY VALUE TO INTEGER NUMBER                              *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CBINT    NTR1  ,                                                                
         XR    R5,R5                                                            
         C     R2,=F'1'            CHECKING LENGTH OF INPUT                     
         BNE   CBIN2               ASSUMING IT CAN NOT BE MORE                  
         IC    R5,0(R3)            THAN 4 BYTES                                 
         EDIT  (R5),(3,0(R4))                                                   
         MVI   OUTPUTL,3                                                        
         B     CBINOK                                                           
CBIN2    C     R2,=F'2'                                                         
         BNE   CBIN3                                                            
         ICM   R5,3,0(R3)                                                       
         EDIT  (R5),(5,0(R4))                                                   
         MVI   OUTPUTL,5                                                        
         B     CBINOK                                                           
CBIN3    C     R2,=F'3'                                                         
         BNE   CBIN4                                                            
         ICM   R5,7,0(R3)                                                       
         EDIT  (R5),(7,0(R4))                                                   
         MVI   OUTPUTL,7                                                        
         B     CBINOK                                                           
CBIN4    ICM   R5,15,0(R3)         LENGTH=4 BYTES                               
         EDIT  (R5),(12,0(R4))                                                  
         MVI   OUTPUTL,9                                                        
         B     CBINOK                                                           
*                                                                               
CBINNO   B     NO                                                               
CBINOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT HEX NUMBER TO PRINTABLE OUTPUT                              *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
CHEXOUT  NTR1                                                                   
         GOTO1 VHEXOUT,DMCB,(R3),(R4),(R2),=C'TOG'                              
         AR    R2,R2               L'OUTPUT = L'INPUT * 2                       
         STC   R2,OUTPUTL          SAVE OUTPUT BUFFER LENGTH                    
         B     CHOUOK                                                           
*                                                                               
CHOUNO   B     NO                                                               
CHOUOK   B     YES                                                              
         EJECT                                                                  
***********************************************************************         
* CONVERT PACKED NUMBER TO DECIMAL NUMBER (2 DECIMAL PLACES)          *         
*                                                                     *         
* NTRY: R2 = L'UNCONVERTED STRING                                     *         
*       R3 = A(UNCONVERTED STRING)                                    *         
*       R4 = A(OUTPUT BUFFER)                                         *         
***********************************************************************         
         SPACE 1                                                                
C2PACK   NTR1                                                                   
         CURED (P6,0(R3)),(13,(R4)),2,FLOAT=-,ALIGN=LEFT                        
         ORG   *-2                                                              
         USING CURPARMD,R1                                                      
         STC   R2,CURPINPT         SET INPUT LENGTH                             
         OI    CURPINPT,CURPIPAK   SET INPUT PACKED NUMBER                      
         BASR  RE,RF                                                            
         DROP  R1                                                               
*                                                                               
         AR    R2,R2               L'OUTPUT = (L'INPUT*2)+1                     
         LA    R2,1(R2)                                                         
         STC   R2,OUTPUTL          SAVE OUTPUT BUFFER LENGTH                    
         B     C2PAOK                                                           
*                                                                               
C2PANO   B     NO                                                               
C2PAOK   B     YES                                                              
         EJECT                                                                  
**********************************************************************          
* OUTPUT DELIMITER CHARACTER                                         *          
**********************************************************************          
         SPACE 1                                                                
DELIMOUT XR    RF,RF                                                            
         IC    RF,OUTPUTL                                                       
         A     RF,ANOW                                                          
         CLI   DELIM,DXTDNONQ                                                   
         BE    DELO020                                                          
         MVC   0(1,RF),DELIM                                                    
         LA    RF,1(RF)                                                         
*                                                                               
DELO020  DS    0H                                                               
         ST    RF,ANOW                                                          
         BR    RE                                                               
         SPACE 2                                                                
***********************************************************************         
* MOVE CHARACTERS FROM INPUT TO OUTPUT BUFFER                         *         
*                                                                    *          
* NTRY: R2 = L'DATA                                                  *          
*       R3 = A(INPUT)                                                *          
*       R4 = A(OUTPUT)                                               *          
* EXIT  LENGTH OUTPUT IN OUTPUTL                                     *          
***********************************************************************         
         SPACE 1                                                                
MVCIO    EQU   *                                                                
         BCTR  R2,0                                                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),0(R3)                                                    
         LA    R2,1(R2)                                                         
         STC   R2,OUTPUTL          SAVE OUTPUT DATA LENGTH                      
         BR    RE                                                               
         SPACE 2                                                                
***********************************************************************         
* DROP TRAILING SPACES FROM CHARACTER FIELD IN INPUT BUFFER           *         
*                                                                     *         
* NTRY: R2 = L'DATA                                                   *         
*       R3 = A(INPUT)                                                 *         
*       R4 = A(OUTPUT)                                                *         
***********************************************************************         
         SPACE 1                                                                
DROPSPC  EQU   *                                                                
         CLI   FIXEDFLG,C'Y'                                                    
         BE    DSPCX                                                            
         LR    R1,R2                                                            
         BCTR  R1,0                                                             
         LTR   R1,R1                                                            
         BM    DSPCX                                                            
         BZ    DSPCX                                                            
         LA    RF,0(R2,R3)                                                      
*                                                                               
DSPC010  BCTR  RF,0                DROP TRAILING SPACES                         
         CLI   0(RF),C' '                                                       
         BNE   DSPCX                                                            
         BCTR  R2,0                                                             
         BCT   R1,DSPC010                                                       
*                                                                               
DSPCX    BR    RE                                                               
         SPACE 2                                                                
***********************************************************************         
* DROP LEADING ZEROES FROM NUMERIC FIELD IN INPUT BUFFER              *         
*                                                                     *         
* NTRY: R2 = L'DATA                                                   *         
*       R3 = A(INPUT)                                                 *         
*       R4 = A(OUTPUT)                                                *         
***********************************************************************         
         SPACE 1                                                                
DROPZERO EQU   *                                                                
         CLI   FIXEDFLG,C'Y'                                                    
         BE    DZERX                                                            
         LA    RF,1                                                             
*                                                                               
DZER010  CR    R2,RF                                                            
         BNH   DZERX                                                            
         CLI   0(R3),C'0'          DROP LEADING ZEROES                          
         BE    DZER020                                                          
         CLI   0(R3),C'1'          CHECK DIGITS                                 
         BL    DZERX                                                            
         CLI   0(R3),C'9'                                                       
         BH    DZERX                                                            
         B     DZERX                                                            
DZER020  LA    R3,1(R3)                                                         
         BCT   R2,DZER010                                                       
*                                                                               
DZERX    BR    RE                                                               
         EJECT                                                                  
***********************************************************************         
* CHECK FOR NULL FIELD                                                *         
*                                                                     *         
* NTRY: R2 = L'DATA                                                   *         
*       R3 = A(INPUT)                                                 *         
*       R4 = A(OUTPUT)                                                *         
***********************************************************************         
         SPACE 1                                                                
NULLFLD  NTR1                                                                   
         LTR   R2,R2                                                            
         BZ    NFLD010                                                          
*                                                                               
         LR    RF,R2                                                            
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         OC    0(0,R3),0(R3)                                                    
         BZ    NFLD010                                                          
*                                                                               
         LR    RF,R2                                                            
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R3),SPACES                                                   
         BNE   NFLDNO                                                           
         CLI   OPTIONAL,C'Y'                                                    
         BE    NFLD020                                                          
         CLI   NUMTYPE,C'Y'                                                     
         BE    NFLD010                                                          
         B     NFLDNO                                                           
*                                                                               
NFLD010  EQU   *                                                                
         CLI   ERRFLG,C'Y'                                                      
         BNE   NFLD020                                                          
         CLI   OPTIONAL,C'Y'                                                    
         BE    NFLD020                                                          
         DC    H'0'                                                             
*                                                                               
NFLD020  EQU   *                                                                
         BAS   RE,DEFAULT                                                       
         B     NFLDYES                                                          
*                                                                               
NFLDYES  B     YES                                                              
NFLDNO   B     NO                                                               
         EJECT                                                                  
***********************************************************************         
* OUTPUT DEFAULT VALUE FOR FIELD                                      *         
*                                                                     *         
* NTRY: R2 = L'DATA                                                   *         
*       R3 = A(INPUT)                                                 *         
*       R4 = A(OUTPUT)                                                *         
***********************************************************************         
         SPACE 1                                                                
DEFAULT  NTR1                                                                   
         CLI   OPTIONAL,C'Y'                                                    
         BE    DEFA200                                                          
         CLI   NUMTYPE,C'Y'                                                     
         BE    DEFA110                                                          
         CLI   FIXEDFLG,C'Y'                                                    
         BE    DEFA240                                                          
         LA    R2,1                                                             
         B     DEFA240                                                          
*                                                                               
DEFA110  EQU   *                                                                
         CLI   DECPOINT,0                                                       
         BNE   DEFA120                                                          
         CLI   FIXEDFLG,C'Y'                                                    
         BE    DEFA250                                                          
         LA    R2,1                                                             
         B     DEFA250                                                          
*                                                                               
DEFA120  EQU   *                                                                
         CLI   FIXEDFLG,C'Y'                                                    
         BE    DEFA130                                                          
         ZIC   RF,DECPOINT                                                      
         LA    RF,2(RF)                                                         
         STC   RF,OUTPUTL                                                       
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),ZEROES                                                   
         MVI   1(R4),C'.'                                                       
         B     DEFAYES                                                          
*                                                                               
DEFA130  EQU   *                                                                
         STC   R2,OUTPUTL                                                       
         LTR   RF,R2                                                            
         BZ    DEFA132                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),ZEROES                                                   
DEFA132  EQU   *                                                                
         ZIC   RF,DECPOINT                                                      
         CR    RF,R2                                                            
         BH    *+6                                                              
         DC    H'0'                                                             
         LA    RE,0(R2,R4)                                                      
         SR    RE,RF                                                            
         MVI   0(RE),C'.'                                                       
         B     DEFAYES                                                          
*                                                                               
DEFA200  EQU   *                                                                
         CLI   NULLCODE,DXTNDEFQ                                                
         BE    DEFA210                                                          
         CLI   NULLCODE,DXTNNULQ                                                
         BE    DEFA220                                                          
         CLI   NULLCODE,DXTNZERQ                                                
         BE    DEFA230                                                          
         CLI   NULLCODE,DXTNSPCQ                                                
         BE    DEFA240                                                          
         B     DEFA220                                                          
*                                                                               
DEFA210  EQU   *                                                                
         CLI   PLATFORM,DXTPDB2Q                                                
         BE    DEFA230                                                          
*                                                                               
DEFA220  EQU   *                                                                
         STC   R2,OUTPUTL                                                       
         LTR   RF,R2                                                            
         BZ    DEFA222                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),SPACES                                                   
DEFA222  EQU   *                                                                
         MVC   0(L'NULLSTR,R4),NULLSTR                                          
         CLI   FIXEDFLG,C'Y'                                                    
         BE    DEFAYES                                                          
         MVI   OUTPUTL,L'NULLSTR                                                
         B     DEFAYES                                                          
*                                                                               
DEFA230  EQU   *                                                                
         STC   R2,OUTPUTL                                                       
         LTR   RF,R2                                                            
         BZ    DEFA232                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         XC    0(0,R4),0(R4)                                                    
DEFA232  EQU   *                                                                
         B     DEFAYES                                                          
*                                                                               
DEFA240  EQU   *                                                                
         STC   R2,OUTPUTL                                                       
         LTR   RF,R2                                                            
         BZ    DEFA242                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),SPACES                                                   
DEFA242  EQU   *                                                                
         B     DEFAYES                                                          
*                                                                               
DEFA250  EQU   *                                                                
         STC   R2,OUTPUTL                                                       
         LTR   RF,R2                                                            
         BZ    DEFA252                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),ZEROES                                                   
DEFA252  EQU   *                                                                
         B     DEFAYES                                                          
*                                                                               
DEFAYES  B     YES                                                              
DEFANO   B     NO                                                               
         SPACE 2                                                                
***********************************************************************         
* CONVERT TRANSACTION CONTROL HEADER FIELDS                           *         
*                                                                     *         
***********************************************************************         
         SPACE 1                                                                
TRANSACT NTR1                                                                   
         ICM   R5,15,DXAXREC                                                    
         USING DXHDRD,R5                                                        
*                                                                               
         CLI   TRANSCOD,DXTTDALQ                                                
         BE    TRANOK                                                           
*                                                                               
         MVI   OPTIONAL,C'N'                                                    
         MVI   NUMTYPE,C'N'                                                     
         LA    R2,L'DXHDRTYP                                                    
         LA    R3,DXHDRTYP                                                      
         L     R4,ANOW                                                          
         BAS   RE,CCHAR                                                         
         BAS   RE,DELIMOUT                                                      
*                                                                               
         CLI   TRANSCOD,DXTTDRIQ                                                
         BE    TRANOK                                                           
*                                                                               
         LA    R2,L'DXHDRACT                                                    
         LA    R3,DXHDRACT                                                      
         L     R4,ANOW                                                          
         BAS   RE,CCHAR                                                         
         BAS   RE,DELIMOUT                                                      
*                                                                               
         LA    R3,DXHDRCDT                                                      
         L     R4,ANOW                                                          
*                                                                               
         CLI   PLATFORM,DXTPSYBQ                                                
         BNE   TACT010                                                          
         MVC   0(2,R4),6(R3)       OUTPUT DATE DD/MM/YY                         
         MVI   2(R4),C'/'                                                       
         MVC   3(2,R4),4(R3)                                                    
         MVI   5(R4),C'/'                                                       
         MVC   6(2,R4),2(R3)                                                    
         LA    R4,8(R4)                                                         
         LA    R2,8                                                             
         B     TACT020                                                          
*                                                                               
TACT010  EQU   *                                                                
*                                  OUTPUT DATCON 9 DATE TO YYYY-MM-DD           
         MVC   WORK(8),0(R3)                                                    
         GOTO1 =V(DATCON),DMCB,(9,WORK),(23,WORK+10),RR=Y                       
         MVC   0(10,R4),WORK+10                                                 
         LA    R4,10(R4)                                                        
         LA    R2,10                                                            
*                                                                               
TACT020  EQU   *                                                                
         CLI   DELIM,DXTDNONQ                                                   
         BE    TACT040                                                          
         CLI   TRANSCOD,DXTTDTMQ                                                
         BE    TACT030                                                          
         CLI   TRANSCOD,DXTTIRMQ                                                
         BE    TACT030                                                          
         CLI   TRANSCOD,DXTTIAMQ                                                
         BE    TACT030                                                          
         MVC   0(1,R4),DELIM        OUTPUT NORMAL FIELD DELIMITER               
         LA    R4,1(R4)                                                         
         LA    R2,1(R2)                                                         
         B     TACT040                                                          
*                                                                               
TACT030  EQU   *                                                                
         MVI   0(R4),C' '           MERGE INTO ONE DATETIME STAMP FIELD         
         LA    R4,1(R4)                                                         
         LA    R2,1(R2)                                                         
*                                                                               
TACT040  EQU   *                                                                
         MVC   0(2,R4),9(R3)        OUTPUT TIME HH:MM:SS                        
         MVI   2(R4),C':'                                                       
         MVC   3(2,R4),11(R3)                                                   
         MVI   5(R4),C':'                                                       
         MVC   6(2,R4),13(R3)                                                   
         LA    R2,8(R2)                                                         
         STC   R2,OUTPUTL                                                       
         BAS   RE,DELIMOUT                                                      
         B     TRANOK                                                           
*                                                                               
TRANNO   B     NO                                                               
TRANOK   B     YES                                                              
         SPACE 2                                                                
***********************************************************************         
* EXIT POINTS                                                         *         
***********************************************************************         
         SPACE 1                                                                
*                                                                               
YES      SR    RC,RC               RETURN CC EQUAL                              
NO       LTR   RC,RC               RETURN CC NOT EQUAL                          
XIT      XIT1                                                                   
         SPACE 2                                                                
***********************************************************************         
* LITERALS AND CONSTANTS                                              *         
***********************************************************************         
         SPACE 1                                                                
         LTORG                                                                  
         EJECT                                                                  
SPACES   DC    255C' '                                                          
ZEROES   DC    255C'0'                                                          
NULLSTR  DC    CL4'NULL'                                                        
NULLS    DC    XL255'00'                                                        
*                                                                               
CUREDIT  DC    V(CUREDIT)                                                       
VDATCON  DC    V(DATCON)                                                        
VHEXOUT  DC    V(HEXOUT)                                                        
*                                                                               
MEDSYSQ  EQU   X'04'                                                            
SQLSUBQ  EQU   X'01'                                                            
*                                                                               
HHMMSS   DC    CL8'00:00:00'       OUTPUT TIME HH:MM:SS                         
         EJECT                                                                  
***********************************************************************         
* FIELD DATA TYPE CONVERSION TABLES                                   *         
***********************************************************************         
         SPACE 1                                                                
FCNVTAB  DC    AL1(DXCCHAR),AL4(CCHAR),X'00',AL1(0)                             
         DC    AL1(DXCTINT),AL4(CTINT),X'80',AL1(0)                             
         DC    AL1(DXCSINT),AL4(CSINT),X'80',AL1(0)                             
         DC    AL1(DXCINT),AL4(CINT),X'80',AL1(0)                               
         DC    AL1(DXCREAL),AL4(CREAL),X'C0',AL1(2)                             
         DC    AL1(DXCFLOAT),AL4(CFLOAT),X'C0',AL1(4)                           
         DC    AL1(DXCBIT),AL4(CBIT),X'00',AL1(0)                               
         DC    AL1(DXCMONEY),AL4(CMONEY),X'C0',AL1(2)                           
         DC    AL1(DXCTIME),AL4(CTIME),X'00',AL1(0)                             
         DC    AL1(DXCDATE),AL4(CDATE),X'00',AL1(0)                             
         DC    AL1(DXCPDATE),AL4(CPDATE),X'00',AL1(0)                           
         DC    AL1(DXCBINT),AL4(CBINT),X'80',AL1(0)                             
         DC    AL1(DXCHXOUT),AL4(CHEXOUT),X'00',AL1(0)                          
         DC    AL1(DXC2PACK),AL4(C2PACK),X'C0',AL1(2)                           
         DC    AL1(DXCVCHAR),AL4(CVCHAR),X'00',AL1(0)                           
         DC    AL1(DXCNONE),AL4(MVCIO),X'00',AL1(0)                             
         DC    AL1(DXCDEF),AL4(MVCIO),X'00',AL1(0)                              
         DC    X'FF'                                                            
         SPACE 3                                                                
*                                                                               
FCNVTABD DSECT                    COVERS FCNVTAB - CONVERT TABLE                
FCNVTYPE DS    XL1                                                              
FCNVROUT DS    XL4                                                              
FCNVFLGS DS    XL1                                                              
FCNVFNUQ EQU   X'80'                                                            
FCNVFDCQ EQU   X'40'                                                            
FCNVDECP DS    AL1                                                              
FCNVTABL EQU   *-FCNVTABD                                                       
         SPACE 3                                                                
*                                                                               
         EJECT                                                                  
***********************************************************************         
* WORKING STORAGE AND OTHER DSECTS                                    *         
***********************************************************************         
         SPACE 1                                                                
WORKD    DSECT                                                                  
DUB      DS    D                                                                
DMCB     DS    6F                                                               
APARM    DS    A                                                                
ANOW     DS    A                   CURRENT ADDRESS REACHED IN SQL BUFF          
*                                                                               
PARM     DS    0XL4                PARAMETER LIST                               
ADXCRCT  DS    AL4                 A(CALLER'S RECORD CONVERSION TABLE)          
PARMX    EQU   *+L'PARM                                                         
*                                                                               
WORK     DS    CL256                                                            
*                                                                               
SYSTEM   DS    XL1                                                              
SUBSYS   DS    XL1                                                              
PLATFORM DS    XL1                                                              
VERSION  DS    XL1                                                              
OPTIONAL DS    CL1                                                              
NUMTYPE  DS    CL1                                                              
DECPOINT DS    AL1                                                              
SIGNFLAG DS    XL1                                                              
OUTPUTL  DS    XL1                                                              
DELIM    DS    CL1                                                              
LOADMODE DS    XL1                                                              
KILLMODE DS    XL1                                                              
FIXEDFLG DS    CL1                                                              
FORMCODE DS    XL1                                                              
NULLCODE DS    XL1                                                              
NULLIFCD DS    XL1                                                              
ESCODE   DS    CL1                                                              
TRANSCOD DS    XL1                                                              
MONYCODE DS    CL1                                                              
DATEFORM DS    XL1                                                              
ERRFLG   DS    CL1                                                              
*                                                                               
WORKL    EQU   *-WORKD                                                          
         EJECT                                                                  
*                                                                               
* DXDSECTS                                                                      
       ++INCLUDE DXDSECTS                                                       
*                                                                               
* DXHDRD                                                                        
       ++INCLUDE DXHDRD                                                         
*                                                                               
* DDCUREDIT                                                                     
       ++INCLUDE DDCUREDITD                                                     
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'013DXCNVXU   09/20/00'                                      
         END                                                                    
