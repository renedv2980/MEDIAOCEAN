*          DATA SET FANETGEN   AT LEVEL 009 AS OF 05/01/02                      
*CATALP FANETGEN                                                                
         TITLE 'FANETGEN - NETWORK GENERATOR - DOS AND MVS'                     
         PRINT NOGEN                                                            
NETGEN   CSECT                                                                  
         NBASE 000,*NETGEN*,R8,R7,WORK=A(NETWRK)                                
         ST    RD,SAVERD                                                        
*                                                                               
         GOTO1 =V(STXITER),PARA,A(DUMPLIST)                                     
*                                                                               
         LA    R9,C                R9=A(GENERATE RECORD AREA)                   
         USING GEND,R9                                                          
         L     RA,=V(CPRINT)       RA=PRINTER CONTROL REGISTER                  
         USING DPRINT,RA                                                        
         MVC   TITLE(29),=C'FACILITIES NETWORK GENERATION'                      
         SPACE 2                                                                
SRTINIT  LA    R4,SRTCRD1          INITIALISE FOR SORTER                        
         LA    R5,SRTCRD2                                                       
         LA    R0,40                                                            
         L     RF,=A(SORTAREA)                                                  
         GOTO1 =V(SORTER),PARA,(R4),(R5),((R0),(RF))                            
         EJECT                                                                  
*READ CONTROL CARDS                                                             
*                                                                               
CONREAD  GOTO1 =V(CARDS),PARA,C,=C'RE00'                                        
         CLC   C(2),=C'**'                                                      
         BE    CONREAD1                                                         
         CLC   C(2),=C'/*'                                                      
         BNE   CONREAD4                                                         
CONREAD1 CLC   INTYPE,SPACES                                                    
         BNE   CONREAD2                                                         
         MVI   ERRNUM,X'01'        MISSING INPUT= CONTROL CARD                  
         B     ERROR                                                            
         SPACE 2                                                                
CONREAD2 MVC   SUB1(23),=C'NETWORK DATA CARDS     '                             
         MVC   SUB2(23),=C'------------------     '                             
         ZAP   LINE,=P'75'                                                      
         ZAP   PAGE,=P'1'                                                       
         B     CONREADX                                                         
         SPACE 2                                                                
CONREAD4 MVC   SUB1(23),=C'NETWORK CONTROL CARDS  '                             
         MVC   SUB2(23),=C'---------------------  '                             
         MVC   P(80),C                                                          
         GOTO1 =V(PRINTER)                                                      
         CLC   C(09),=C'TRACE=YES'                                              
         BNE   CONREAD6                                                         
         MVI   TRACOPT,C'Y'                                                     
         B     CONREAD                                                          
         SPACE 2                                                                
CONREAD6 CLC   C(6),=C'INPUT='                                                  
         BNE   CONREAD8                                                         
         MVC   INTYPE,C+6                                                       
         B     CONREAD                                                          
         SPACE 2                                                                
CONREAD8 CLC   C(7),=C'OUTPUT='                                                 
         BNE   CONREADA                                                         
         MVC   OUTTYPE,C+7                                                      
         B     CONREAD                                                          
         SPACE 2                                                                
CONREADA MVI   ERRNUM,X'02'        INVALID CONTROL CARD                         
         B     ERROR                                                            
CONREADX DC    0H'0'                                                            
         EJECT                                                                  
*READ INPUT NETWORK DATA CARDS AND WRITE RECORDS TO SORT FILE                   
*                                                                               
INPUT    L     R2,ASPECIAL         RELEASE SPECIAL CARDS TO SORT                
         CLI   0(R2),X'FF'                                                      
         BE    INPUT2                                                           
         MVC   C,SPACES                                                         
         MVC   C(8),0(R2)                                                       
         LA    R2,8(R2)                                                         
         ST    R2,ASPECIAL                                                      
         B     RELEASE                                                          
         SPACE 2                                                                
INPUT2   L     R2,AREGULAR         RELEASE REGULAR CARDS TO SORT                
         CLI   0(R2),X'FF'         IF ANY ARE PENDING                           
         BNE   INPUT3                                                           
         CLI   FIRSTIME,C'Y'                                                    
         BE    INPUT4                                                           
         MVC   C,SAVECARD                                                       
         MVI   FIRSTIME,C'Y'                                                    
         B     SCAN1                                                            
         SPACE 2                                                                
INPUT3   MVC   C,SPACES                                                         
         MVC   C(L'GENREC),0(R2)                                                
         LA    R2,L'GENREC(R2)                                                  
         ST    R2,AREGULAR                                                      
         B     RELEASE                                                          
         SPACE 2                                                                
DATAREAD DS    0H                                                               
INPUT4   CLC   INTYPE(4),=C'CARD'  OPTIONAL DATA CARD READ                      
         BNE   INPUT6                                                           
         GOTO1 =V(CARDS),PARA,C,=C'RE00'                                        
         B     INPUT8                                                           
         SPACE 2                                                                
INPUT6   GOTO1 =V(PANIC),PARA,(X'80',=C'READ'),=C'PAN',INTYPE,C                 
         TM    PARA+8,X'10'                                                     
         BNO   INPUT8                                                           
         MVI   ERRNUM,X'03'        PAN BOOK NOT ON LIBRARY                      
         B     ERROR                                                            
         SPACE 2                                                                
INPUT8   CLC   C(2),=C'/*'         END OF DATA CARDS                            
         BNE   INPUT10                                                          
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'75'                                                      
         MVC   SUB1(23),=C'NETWORK OUTPUT TRACE   '                             
         MVC   SUB2(23),=C'--------------------   '                             
         B     OUTPUT                                                           
         SPACE 2                                                                
INPUT10  MVC   P(80),C                                                          
         UNPK  P+81(5),SEQUENCE                                                 
         OI    P+85,X'F0'                                                       
         AP    SEQUENCE,=P'1'                                                   
         GOTO1 =V(PRINTER)                                                      
         CLI   C,C'*'                                                           
         BE    DATAREAD                                                         
         MVC   SAVECARD,C                                                       
         EJECT                                                                  
*CONTROL OF SCANNING ROUTINES                                                   
*                                                                               
SCAN1    GOTO1 =V(SCANNER),PARA,(C'C',C+15),ABLOCK                              
         L     R2,ABLOCK                                                        
         SR    R3,R3                                                            
         IC    R3,PARA+4                                                        
         LTR   R3,R3                                                            
         BNZ   SCAN1A                                                           
         MVI   ERRNUM,X'10'        MISSING OR INVALID OPERAND                   
         B     ERROR                                                            
SCAN1A   CLI   C+14,C' '           TEST FOR CONTINUATION                        
         BE    SCAN2                                                            
SCAN1B   STM   R2,R3,DUB           SAVE SCAN INFO                               
*                                                                               
         CLC   INTYPE(4),=C'CARD'  READ CONTINUATION CARD                       
         BNE   SCAN1C                                                           
         GOTO1 =V(CARDS),PARA,D,=C'RE00'                                        
         B     SCAN1D                                                           
SCAN1C   GOTO1 =V(PANIC),PARA,(X'80',=C'READ'),=C'PAN',INTYPE,D                 
         TM    PARA+8,X'10'                                                     
         BNO   *+6                                                              
         DC    H'0'                                                             
*                                                                               
SCAN1D   MVC   P(80),D             PRINT CONTINUATION CARD                      
         UNPK  P+81(5),SEQUENCE                                                 
         OI    P+85,X'F0'                                                       
         AP    SEQUENCE,=P'1'                                                   
         GOTO1 =V(PRINTER)                                                      
         CLC   D(14),SPACES                                                     
         BE    SCAN1F                                                           
SCAN1E   MVI   ERRNUM,X'11'        INVALID CONTINUATION CARD                    
         B     ERROR                                                            
*                                                                               
SCAN1F   SLL   R3,5                FIND END OF LAST SCAN BLOCK                  
         AR    R2,R3                                                            
         GOTO1 =V(SCANNER),PARA,(C'C',D+15),(R2)                                
         SR    R3,R3                                                            
         IC    R3,PARA+4                                                        
         LTR   R3,R3                                                            
         BZ    SCAN1E                                                           
         L     R2,DUB                                                           
         A     R3,DUB+4            BUMP NUMBER OF SCANNER BLOCKS                
*                                                                               
SCAN1G   CLI   D+14,C' '                                                        
         BNE   SCAN1B                                                           
         SPACE 2                                                                
SCAN2    CLC   C+9(4),=C'TERM'                                                  
         BNE   SCAN4                                                            
         BAS   RE,TERMVAL                                                       
         B     DATAREAD                                                         
         SPACE 2                                                                
SCAN4    CLC   C+9(4),=C'POLL'                                                  
         BNE   SCAN6                                                            
         BAS   RE,POLLVAL                                                       
         B     DATAREAD                                                         
         SPACE 2                                                                
SCAN6    CLI   FIRSTIME,C'Y'       ROUTINES FOR END OF A LINE                   
         BE    SCAN8                                                            
         BAS   RE,LOGVAL           TEST IF POLL/TERM CARDS COMPATIBLE           
         BAS   RE,BUILDREC         BUILD LIST OF RECS FOR RELEASE               
         MVC   AREGULAR,=A(REGULAR)                                             
         B     INPUT2              RETURN TO RELEASE RECORDS                    
         SPACE 2                                                                
SCAN8    MVI   FIRSTIME,C'N'                                                    
         CLC   C+9(4),=C'LINE'                                                  
         BNE   SCAN10                                                           
         BAS   RE,LINEVAL                                                       
         B     DATAREAD                                                         
         SPACE 2                                                                
SCAN10   CLC   C+9(4),=C'CNTL'                                                  
         BNE   SCAN12                                                           
         BAS   RE,CNTLVAL                                                       
         B     DATAREAD                                                         
         SPACE 2                                                                
SCAN12   MVI   ERRNUM,X'12'        INVALID OPERATOR                             
         B     ERROR                                                            
         EJECT                                                                  
*VALIDATION OF LINE CARDS                                                       
*                                                                               
LINEVAL  NTR1                                                                   
         LA    R4,SAVELINE         LINE DATA SAVED IN SAVELINE                  
         USING LINED,R4                                                         
         MVC   LINREC,SPACES                                                    
         MVI   LINCTRY,0                                                        
         MVI   ERRNUM,X'20'        INVALID LINE ID                              
         CLC   C+4(5),SPACES                                                    
         BNE   ERROR                                                            
         MVC   LINID,C                                                          
         L     R1,=A(LINEPOOL)                                                  
*                                                                               
LINE1    CLI   0(R1),0             SEARCH FOR SLOT IN LINE POOL                 
         BE    LINE1A                                                           
         CLI   0(R1),X'FF'         DIE IF LINE POOL FULL                        
         BNE   *+6                                                              
         DC    H'0'                                                             
         MVI   ERRNUM,X'21'        DUPLICATE LINE ID                            
         CLC   LINID,0(R1)                                                      
         BE    ERROR                                                            
         LA    R1,12(R1)                                                        
         B     LINE1                                                            
LINE1A   MVC   0(4,R1),LINID       SAVE LINE ID IN LINE POOL                    
         ST    R1,ALINPOOL         SAVE A(LINE POOL ENTRY)                      
         SPACE 2                                                                
LINE2    CLC   12(2,R2),=CL10'SYSNUM'                                           
         BNE   LINE3                                                            
         MVI   ERRNUM,X'22'        INVALID SYSNUM                               
         TM    3(R2),X'80'                                                      
         BNO   ERROR                                                            
         L     R5,8(R2)            SYSNUM S/B 1-255                             
         LTR   R5,R5                                                            
         BZ    ERROR                                                            
         CH    R5,=H'255'                                                       
         BH    ERROR                                                            
         L     R1,=A(LINEPOOL)                                                  
         MVI   ERRNUM,X'23'        DUPLICATE SYSNUM                             
*                                                                               
LINE2A   CLI   0(R1),0                                                          
         BE    LINE2B                                                           
         CLC   11(1,R2),4(R1)                                                   
         BE    ERROR                                                            
         LA    R1,12(R1)                                                        
         B     LINE2A                                                           
*                                                                               
LINE2B   L     R1,ALINPOOL         SAVE SYSNUM IN LINE POOL                     
         STC   R5,4(R1)                                                         
         EDIT  (R5),(3,LINSYS),FILL=0                                           
         B     LINEX                                                            
         SPACE 2                                                                
LINE3    CLC   12(2,R2),=CL10'DDNAME'                                           
         BNE   LINE4                                                            
         MVC   LINDD,22(R2)                                                     
         MVI   ERRNUM,X'24'        INVALID DDNAME                               
         CLI   1(R2),4                                                          
         BL    ERROR                                                            
         CLI   1(R2),7                                                          
         BH    ERROR                                                            
         MVI   ERRNUM,X'25'        DUPLICATE DDNAME                             
         L     R1,=A(LINEPOOL)                                                  
*                                                                               
LINE3A   CLI   0(R1),0             TEST AVAILABLE SLOT IN LINE POOL             
         BE    LINE3B                                                           
         CLC   LINDD,5(R1)                                                      
         BE    ERROR                                                            
         LA    R1,12(R1)                                                        
         B     LINE3A                                                           
*                                                                               
LINE3B   L     R1,ALINPOOL         SAVE DDNAME IN LINE POOL                     
         MVC   5(7,R1),LINDD                                                    
         B     LINEX                                                            
         SPACE 2                                                                
LINE4    CLC   12(2,R2),=CL10'TYPE'                                             
         BNE   LINE6                                                            
         MVC   LINTYPE,22(R2)                                                   
         MVC   SAVTYPE,LINTYPE                                                  
         CLC   LINTYPE,=C'MD'      S/S MULTI DROP                               
         BE    LINEX                                                            
         CLC   LINTYPE,=C'PP'      S/S POINT TO POINT                           
         BE    LINEX                                                            
         CLC   LINTYPE,=C'MB'      BSC MULTI DROP                               
         BE    LINEX                                                            
         CLC   LINTYPE,=C'PB'      BSC POINT TO POINT                           
         BE    LINEX                                                            
         CLC   LINTYPE,LCLLINE     BSC LOCAL (LB)                               
         BE    LINEX                                                            
         CLC   LINTYPE,RJELINE     BSC RJE (RB)                                 
         BE    LINEX                                                            
         CLC   LINTYPE,TWXLINE     TWX (TW)                                     
         BE    LINEX                                                            
         MVI   ERRNUM,X'26'        INVALID LINE TYPE                            
         B     ERROR                                                            
         SPACE 2                                                                
LINE6    CLC   12(2,R2),=CL10'MAXBUFFS'                                         
         BNE   LINE8                                                            
         MVC   LINMAX,22(R2)                                                    
         CLI   LINMAX,C'0'                                                      
         MVI   ERRNUM,X'27'        MAXBUFFS NOT 1 THRU 9                        
         BL    ERROR                                                            
         CLI   LINMAX,C'9'                                                      
         BH    ERROR                                                            
         B     LINEX                                                            
         SPACE 2                                                                
LINE8    CLC   12(2,R2),=CL10'OP'                                               
         BNE   LINE10                                                           
         MVC   LINOP,22(R2)                                                     
         CLC   22(3,R2),=C'YES'                                                 
         BE    LINEX                                                            
         CLC   22(3,R2),=C'NO '                                                 
         BE    LINEX                                                            
         MVI   ERRNUM,X'28'        LINE OP NOT YES/NO                           
         B     ERROR                                                            
         SPACE 2                                                                
LINE10   CLC   12(2,R2),=CL10'BAUD'                                             
         BNE   LINE12                                                           
         MVI   ERRNUM,X'29'        INVALID BAUD RATE                            
         TM    3(R2),X'80'                                                      
         BNO   ERROR                                                            
         L     R5,8(R2)                                                         
         C     R5,=F'0300'                                                      
         BL    ERROR                                                            
         C     R5,=F'19200'                                                     
         BH    ERROR                                                            
         CVD   R5,DUB                                                           
         UNPK  LINBAUD,DUB                                                      
         OI    LINBAUD+4,X'F0'                                                  
         B     LINEX                                                            
         SPACE 2                                                                
LINE12   CLC   12(2,R2),=CL10'CTRY'                                             
         BNE   LINE14                                                           
         MVI   ERRNUM,X'30'        INVALID COUNTRY CODE                         
         L     R5,=A(CTRYTAB)                                                   
         USING CTRYTABD,R5         R5=A(COUNTRY TABLE)                          
         LH    R0,0(R5)                                                         
         LA    R5,6(R5)                                                         
LINE12A  CLI   CTRYCODE,X'FF'      TEST END OF TABLE                            
         BE    ERROR                                                            
         CLC   CTRYSHR,22(R2)      MATCH ON SHORT CTRY/TOWN NAME                
         BE    LINE12B                                                          
         AR    R5,R0                                                            
         B     LINE12A                                                          
LINE12B  MVC   LINCTRY,CTRYCODE    SAVE BINARY COUNTRY CODE                     
         B     LINEX                                                            
         DROP  R5                                                               
         SPACE 2                                                                
LINE14   MVI   ERRNUM,X'2A'        INVALID LINE CARD OPERAND                    
         B     ERROR                                                            
         SPACE 2                                                                
LINEX    LA    R2,32(R2)           BUMP TO NEXT SCANNER ENTRY                   
         BCT   R3,LINE2                                                         
         SPACE 2                                                                
LINEX1   CLC   LINSYS,SPACES       SYSNUM REQUIRED FOR DOS                      
         BNE   LINEX1A                                                          
         MVI   ERRNUM,X'2B'        MISSING SYSNUM                               
*&&DO*&& B     ERROR                                                            
*&&OS*&& B     LINEX1A                                                          
LINEX1A  CLC   LINDD,SPACES        DDNAME DEFAULTS TO LINXXXX                   
         BNE   LINEX2                                                           
         MVC   LINDD(3),=C'LIN'                                                 
         MVC   LINDD+3(4),LINID                                                 
         L     R1,=A(LINEPOOL)     CHECK DEFAULT FOR DUPLICATE                  
         MVI   ERRNUM,X'25'        DUPLICATE DDNAME                             
LINEX1B  CLI   0(R1),0                                                          
         BE    LINEX1C                                                          
         CLC   LINDD,5(R1)                                                      
         BE    ERROR                                                            
         LA    R1,12(R1)                                                        
         B     LINEX1B                                                          
LINEX1C  L     R1,ALINPOOL         SET DEFAULT DDNAME IN LINE POOL              
         MVC   5(7,R1),LINDD                                                    
         SPACE 2                                                                
LINEX2   CLC   LINTYPE,SPACES                                                   
         BNE   LINEX4                                                           
         MVI   ERRNUM,X'2C'        MISSING LINE TYPE                            
         B     ERROR                                                            
         SPACE 2                                                                
LINEX4   CLI   LINMAX,C' '                                                      
         BE    LINEX4A                                                          
         CLC   LINTYPE,TWXLINE                                                  
         BNE   LINEX6                                                           
         MVI   ERRNUM,X'2D'        MAXBUFFS N/A FOR TWX                         
         B     ERROR                                                            
LINEX4A  CLC   LINTYPE,=C'MD'                                                   
         BNE   LINEX6                                                           
         MVI   ERRNUM,X'2E'        MAXBUFFS REQUIRED FOR MULTI DROP             
         B     ERROR                                                            
         SPACE 2                                                                
LINEX6   L     R4,=A(TERMPOOL)     INITIALISE LINE TERMPOOL/POLLPOOL            
         MVI   0(R4),X'FF'                                                      
         L     R4,=A(POLLPOOL)                                                  
         MVI   0(R4),X'FF'                                                      
         B     XIT                                                              
         EJECT                                                                  
*VALIDATION OF POLL CARDS                                                       
*                                                                               
POLLVAL  NTR1                                                                   
         L     R4,=A(POLLPOOL)                                                  
         CLC   C(4),SAVELINE                                                    
         BE    POLL2                                                            
         MVI   ERRNUM,X'40'        LINE ID FOR POLL CARD DIFFERS                
         B     ERROR                                                            
         SPACE 2                                                                
POLL2    CLI   0(R4),X'FF'         FIND NEXT ENTRY IN POLL POOL                 
         BE    POLL4                                                            
         LA    R4,6(R4)                                                         
         B     POLL2                                                            
         SPACE 2                                                                
POLL4    MVC   0(4,R4),12(R2)      SAVE ALPHA POLL IN POLLPOOL                  
         TM    2(R2),X'20'                                                      
         BO    POLL6                                                            
         MVI   ERRNUM,X'41'        POLL S/B VALID HEXADECIMAL                   
         B     ERROR                                                            
         SPACE 2                                                                
POLL6    CLI   0(R2),4                                                          
         BE    POLL8                                                            
         MVI   ERRNUM,X'42'        POLL OPERANDS S/B 4 CHARACTERS               
         B     ERROR                                                            
         SPACE 2                                                                
POLL8    CLI   SAVTYPE+1,C'B'      TEST BSC                                     
         BNE   POLL10                                                           
         MVC   LOOK(4),12(R2)                                                   
         CLC   LOOK+2(2),=C'FF'    ALLOW BSC GENERAL POLL                       
         BNE   *+10                                                             
         MVC   LOOK+2(2),=C'40'                                                 
         BAS   RE,LOOKUP                                                        
         CLC   LOOK+4(4),SPACES                                                 
         BNE   POLL10                                                           
         MVI   ERRNUM,X'43'        BSC POLLS S/B EBCDIC                         
         B     ERROR                                                            
         SPACE 2                                                                
POLL10   GOTO1 =V(HEXIN),PARA,(R4),4(R4),4                                      
         MVI   6(R4),X'FF'                                                      
         CLC   SAVTYPE,TWXLINE     FOR TWX ONLY SINGLE DUMMY POLL               
         BNE   POLLX                                                            
         MVI   ERRNUM,X'44'        POLL NOT VALID FOR TW                        
         CH    R3,=H'1'                                                         
         BNE   ERROR                                                            
         CLC   0(4,R4),TWXPOLL                                                  
         BNE   ERROR                                                            
         SPACE 2                                                                
POLLX    LA    R2,32(R2)           BUMP TO NEXT SCANNER ENTRY                   
         LA    R4,6(R4)                                                         
         BCT   R3,POLL4                                                         
         B     XIT                                                              
         EJECT                                                                  
*VALIDATION OF TERMINAL CARDS                                                   
*                                                                               
TERMVAL  NTR1                                                                   
         L     R4,=A(TERMPOOL)                                                  
         USING TERMD,R4                                                         
         MVI   ERRNUM,X'60'        LINE ID FOR TERM CARD DIFFERS                
         CLC   C(4),SAVELINE                                                    
         BNE   ERROR                                                            
         SPACE 2                                                                
TERM2    CLI   0(R4),X'FF'         FIND NEXT SPACE IN TERMINAL POOL             
         BE    TERM4                                                            
         LA    R4,L'TRMREC(R4)                                                  
         B     TERM2                                                            
         SPACE 2                                                                
TERM4    MVC   TRMREC,SPACES       INITIALISE TERMPOOL ENTRY                    
         MVI   TRMQU,0                                                          
         MVC   TRMCTRY,SAVELINE+LINCTRY-LINREC                                  
         MVI   L'TRMREC(R4),X'FF'                                               
         MVC   TRMDEV,=C'TRM'      DEFAULT VALUES                               
         MVC   TRMTYPE,=C'CRR'                                                  
         CLI   SAVTYPE+1,C'B'                                                   
         BNE   *+10                                                             
         MVC   TRMTYPE,=C'327'                                                  
TERM4A   CLC   SAVTYPE,LCLLINE     DEFAULT VALUES FOR LCL                       
         BNE   TERM4B                                                           
         MVC   TRMREC,LCLTERM                                                   
         B     TERM6                                                            
TERM4B   CLC   SAVTYPE,RJELINE     DEFAULT VALUES FOR RJE                       
         BNE   TERM4C                                                           
         MVC   TRMREC,RJETERM                                                   
         B     TERM6                                                            
TERM4C   CLC   SAVTYPE,TWXLINE     DEFAULT VALUES FOR TWX                       
         BNE   TERM6                                                            
         MVC   TRMREC,TWXTERM                                                   
         SPACE 2                                                                
TERM6    CLC   12(02,R2),=CL10'ADDRESS'                                         
         BNE   TERM10                                                           
         TM    3(R2),X'20'                                                      
         BNO   TERM8                                                            
         CLI   1(R2),4                                                          
         BNE   TERM8                                                            
         CLI   SAVTYPE+1,C'B'                                                   
         BNE   TERM7                                                            
         MVC   LOOK(4),22(R2)                                                   
         BAS   RE,LOOKUP                                                        
         CLC   LOOK+4(4),SPACES                                                 
         BNE   TERM7                                                            
         MVI   ERRNUM,X'61'        BSC TERMINALS NEED EBCDIC ADDRESSES          
         B     ERROR                                                            
*                                                                               
TERM7    MVC   TRMADDR,22(R2)                                                   
         CLC   TRMADDR+2(2),=C'FF'                                              
         BE    TERM9                                                            
         B     TERMX                                                            
*                                                                               
TERM8    MVI   ERRNUM,X'62'        TERMINAL ADDR S/B 4 CHARACTERS HEX           
         B     ERROR                                                            
TERM9    MVI   ERRNUM,X'63'        TERMINAL CANT HAVE MAJOR ADDRESS             
         B     ERROR                                                            
         SPACE 2                                                                
TERM10   CLC   12(02,R2),=C'OFFICE'                                             
         BNE   TERM12                                                           
         MVC   TRMOFF,22(R2)                                                    
         B     TERMX                                                            
         SPACE 2                                                                
TERM12   CLC   12(02,R2),=CL10'TYPE'                                            
         BNE   TERM14                                                           
         MVC   TRMTYPE,22(R2)                                                   
         B     TERMX                                                            
         SPACE 2                                                                
TERM14   CLC   12(2,R2),=C'DEVICE'                                              
         BNE   TERM16                                                           
         MVC   TRMDEV,22(R2)                                                    
         MVC   TRMDEV1,25(R2)                                                   
         B     TERMX                                                            
         SPACE 2                                                                
TERM16   CLC   12(02,R2),=CL10'SPEED'                                           
         BNE   TERM18                                                           
         MVI   ERRNUM,X'64'        INVALID PRINTER SPEED                        
         TM    3(R2),X'80'                                                      
         BNO   ERROR                                                            
         L     R5,8(R2)                                                         
         LTR   R5,R5                                                            
         BNP   ERROR                                                            
         C     R5,=F'1200'                                                      
         BH    ERROR                                                            
         CVD   R5,DUB                                                           
         UNPK  TRMSPEED,DUB                                                     
         OI    TRMSPEED+3,X'F0'                                                 
         B     TERMX                                                            
         SPACE 2                                                                
TERM18   CLC   12(2,R2),=C'BUFFERS'                                             
         BNE   TERM20                                                           
         MVI   ERRNUM,X'65'        INVALID BUFFER SIZE                          
         TM    3(R2),X'80'                                                      
         BNO   ERROR                                                            
         L     R5,8(R2)                                                         
         LTR   R5,R5                                                            
         BNP   ERROR                                                            
         C     R5,=F'0128'                                                      
         BL    ERROR                                                            
         C     R5,=F'2048'                                                      
         BH    ERROR                                                            
         CVD   R5,DUB                                                           
         UNPK  TRMBUFF,DUB                                                      
         OI    TRMBUFF+3,X'F0'                                                  
         B     TERMX                                                            
         SPACE 2                                                                
TERM20   CLC   12(2,R2),=C'QUEUE'                                               
         BNE   TERM22                                                           
         MVI   ERRNUM,X'66'        INVALID QUEUE LENGTH                         
         TM    3(R2),X'80'                                                      
         BNO   ERROR                                                            
         L     R5,8(R2)                                                         
         LTR   R5,R5                                                            
         BNP   ERROR                                                            
         C     R5,=F'99'                                                        
         BH    ERROR                                                            
         STC   R5,TRMQU                                                         
         B     TERMX                                                            
         SPACE 2                                                                
TERM22   CLC   12(2,R2),=C'ATTRIBUTES'                                          
         BNE   TERM24                                                           
         MVI   ERRNUM,X'70'        INVALID ATTRIBUTE LIST                       
         MVC   TRMATTB,=8C'0'                                                   
         CLI   1(R2),1             ALLOW EMPTY LIST                             
         BL    TERMX                                                            
         CLI   1(R2),8             MAX OF 8 VALUES A-H                          
         BH    ERROR                                                            
         LA    RE,22(R2)           POINT TO ATTR LIST                           
         ZIC   RF,1(R2)                                                         
TERM22A  CLI   0(RE),C'A'          A=10000000                                   
         BNE   *+12                                                             
         MVI   TRMATTB+0,C'1'                                                   
         B     TERM22B                                                          
         CLI   0(RE),C'B'          B=01000000                                   
         BNE   *+12                                                             
         MVI   TRMATTB+1,C'1'                                                   
         B     TERM22B                                                          
         CLI   0(RE),C'C'          C=00100000                                   
         BNE   *+12                                                             
         MVI   TRMATTB+2,C'1'                                                   
         B     TERM22B                                                          
         CLI   0(RE),C'D'          D=00010000                                   
         BNE   *+12                                                             
         MVI   TRMATTB+3,C'1'                                                   
         B     TERM22B                                                          
         CLI   0(RE),C'E'          E=00001000                                   
         BNE   *+12                                                             
         MVI   TRMATTB+4,C'1'                                                   
         B     TERM22B                                                          
         CLI   0(RE),C'F'          F=00000100                                   
         BNE   *+12                                                             
         MVI   TRMATTB+5,C'1'                                                   
         B     TERM22B                                                          
         CLI   0(RE),C'G'          G=00000010                                   
         BNE   *+12                                                             
         MVI   TRMATTB+6,C'1'                                                   
         B     TERM22B                                                          
         CLI   0(RE),C'H'          H=00000001                                   
         BNE   *+12                                                             
         MVI   TRMATTB+7,C'1'                                                   
         B     TERM22B                                                          
         CLI   0(RE),C'*'          *=NOP CHR                                    
         BNE   ERROR                                                            
TERM22B  LA    RE,1(RE)            BUMP TO NEXT ATTR INPUT CHR                  
         BCT   RF,TERM22A                                                       
         B     TERMX                                                            
         SPACE 2                                                                
TERM24   CLC   12(2,R2),=C'CTRY'                                                
         BNE   TERM26                                                           
         MVI   ERRNUM,X'71'        INVALID COUNTRY CODE                         
         L     R5,=A(CTRYTAB)                                                   
         USING CTRYTABD,R5         R5=A(COUNTRY TABLE)                          
         LH    R0,0(R5)                                                         
         LA    R5,6(R5)                                                         
TERM24A  CLI   CTRYCODE,X'FF'      TEST END OF TABLE                            
         BE    ERROR                                                            
         CLC   CTRYSHR,22(R2)      MATCH ON SHORT CTRY/TOWN NAME                
         BE    TERM24B                                                          
         AR    R5,R0                                                            
         B     TERM24A                                                          
TERM24B  MVC   TRMCTRY,CTRYCODE    SAVE BINARY COUNTRY CODE                     
         B     TERMX                                                            
         DROP  R5                                                               
         SPACE 2                                                                
TERM26   MVI   ERRNUM,X'67'        INVALID TERM CARD OPERAND                    
         B     ERROR                                                            
         SPACE 2                                                                
TERMX    LA    R2,32(R2)           BUMP TO NEXT SCANNER ENTRY                   
         BCT   R3,TERM6                                                         
*                                                                               
         CLC   TRMADDR,SPACES                                                   
         BNE   *+12                                                             
         MVI   ERRNUM,X'68'        MISSING TERM ADDR OPERAND                    
         B     ERROR                                                            
         CLC   SAVTYPE,TWXLINE                                                  
         BNE   TERMX2                                                           
         CLC   TRMADDR,TWXTERM                                                  
         BE    TERMX2                                                           
         MVI   ERRNUM,X'69'        ADDRESS NOT VALID FOR TW                     
         B     ERROR                                                            
         SPACE 2                                                                
TERMX2   CLC   TRMTYPE,=C'327'     CHECK TERM TYPE WITH LINE TYPE               
         BNE   *+16                                                             
         CLI   SAVTYPE+1,C'B'                                                   
         BNE   TERMX2E                                                          
         B     TERMX4                                                           
         CLC   TRMTYPE,=C'226'                                                  
         BE    TERMX2A                                                          
         CLC   TRMTYPE,=C'CRR'                                                  
         BE    TERMX2A                                                          
         CLC   TRMTYPE,=C'ICC'                                                  
         BE    TERMX2A                                                          
         CLC   TRMTYPE,=C'SR1'                                                  
         BE    TERMX2A                                                          
         CLC   TRMTYPE,=C'RMC'                                                  
         BE    TERMX2A                                                          
         CLC   TRMTYPE,TWXTERM+8                                                
         BE    TERMX2B                                                          
         CLC   TRMTYPE,RJETERM+8                                                
         BE    TERMX2C                                                          
         MVI   ERRNUM,X'6A'        INVALID TERMINAL TYPE                        
         B     ERROR                                                            
TERMX2A  CLC   SAVTYPE,TWXLINE                                                  
         BE    TERMX2E                                                          
         CLC   SAVTYPE,RJELINE                                                  
         BE    TERMX2E                                                          
         B     TERMX4                                                           
TERMX2B  CLC   SAVTYPE,TWXLINE                                                  
         BE    TERMX4                                                           
         B     TERMX2E                                                          
TERMX2C  CLC   SAVTYPE,RJELINE                                                  
         BE    TERMX4                                                           
         B     TERMX2E                                                          
TERMX2E  MVI   ERRNUM,X'6B'        TERM TYPE N/A FOR LINE TYPE                  
         B     ERROR                                                            
         SPACE 2                                                                
TERMX4   MVI   ERRNUM,X'6C'        TERM DEV S/B TRM OR PRT OR PRN               
         CLC   TRMDEV,=C'TRM'                                                   
         BNE   TERMX4A                                                          
         CLC   SAVTYPE,TWXLINE                                                  
         BNE   *+12                                                             
         MVI   ERRNUM,X'6D'        TERM DEV S/B PRT FOR TWX                     
         B     ERROR                                                            
         CLI   TRMDEV1,C' '                                                     
         BNE   ERROR                                                            
         B     TERMX6                                                           
TERMX4A  CLC   TRMDEV,=C'CPU'                                                   
         BNE   TERMX4B                                                          
         B     TERMX6                                                           
TERMX4B  CLC   TRMDEV,=C'PRN'                                                   
         BE    TERMX4C                                                          
         CLC   TRMDEV,=C'PRT'                                                   
         BE    TERMX4C                                                          
         B     ERROR                                                            
TERMX4C  MVI   ERRNUM,X'6E'        TERM DEV TYPE S/B B/C/L                      
         CLI   TRMDEV1,C' '                                                     
         BE    TERMX4D                                                          
         CLI   TRMDEV1,C'B'                                                     
         BE    TERMX4D                                                          
         CLI   TRMDEV1,C'C'                                                     
         BE    TERMX4D                                                          
         CLI   TRMDEV1,C'L'                                                     
         BE    TERMX4D                                                          
         B     ERROR                                                            
TERMX4D  DC    0H'0'                                                            
         SPACE 2                                                                
TERMX6   CLC   TRMOFF,SPACES                                                    
         BNE   TERMX8                                                           
         MVI   ERRNUM,X'6F'        MISSING OFFICE OPERAND                       
         B     ERROR                                                            
         SPACE 2                                                                
TERMX8   B     XIT                                                              
         EJECT                                                                  
*VALIDATE THE CNTL CARD                                                         
*                                                                               
CNTLVAL  NTR1                                                                   
         CLC   12(2,R2),=C'BUFFS'                                               
         BE    CNTL2                                                            
         MVI   ERRNUM,X'80'         MISSING BUFFS= OPERAND                      
         B     ERROR                                                            
         SPACE 2                                                                
CNTL2    TM    3(R2),X'80'                                                      
         BO    *+12                                                             
         MVI   ERRNUM,X'81'         NON-NUMERIC BUFFS= OPERAND                  
         B     ERROR                                                            
         MVC   SAVEBUFF,8(R2)                                                   
         SPACE 2                                                                
CNTL4    LA    R2,32(R2)                                                        
         SH    R3,=H'1'                                                         
         BZ    CNTLX                                                            
         MVI   ERRNUM,X'82'         INVALID CNTL CARD OPERAND                   
         B     ERROR                                                            
         SPACE 2                                                                
CNTLX    B     XIT                                                              
         EJECT                                                                  
*ROUTINE TO LOOK UP ADDRESSES                                                   
*                                                                               
LOOKUP   NTR1                                                                   
         MVC   LOOK+4(4),SPACES                                                 
         LA    R2,BSCADR                                                        
         SPACE 2                                                                
LOOKUP2  CLI   0(R2),X'FF'                                                      
         BE    LOOKUP8                                                          
         CLC   0(2,R2),LOOK                                                     
         BNE   LOOKUP4                                                          
         MVC   LOOK+4(2),2(R2)                                                  
         SPACE 2                                                                
LOOKUP4  CLC   0(2,R2),LOOK+2                                                   
         BNE   LOOKUP6                                                          
         MVC   LOOK+6(2),2(R2)                                                  
         SPACE 2                                                                
LOOKUP6  LA    R2,L'BSCADR(R2)                                                  
         B     LOOKUP2                                                          
         SPACE 2                                                                
LOOKUP8  CLC   LOOK+4(2),SPACES                                                 
         BE    LOOKUP10                                                         
         CLC   LOOK+6(2),SPACES                                                 
         BE    LOOKUP10                                                         
         B     XIT                                                              
         SPACE 2                                                                
LOOKUP10 MVC   LOOK+4(4),SPACES                                                 
         B     XIT                                                              
         EJECT                                                                  
*CHECK POLLING SEQUENCE                                                         
*                                                                               
LOGVAL   NTR1                                                                   
         ZAP   LERBCNT,=P'1'                                                    
         L     R2,=A(POLLPOOL)                                                  
         CLI   0(R2),X'FF'                                                      
         BNE   LV2                                                              
         CLC   SAVTYPE,LCLLINE     POLL CARD OPTIONAL FOR LCL LINE              
         BE    LV0LCL                                                           
         CLC   SAVTYPE,RJELINE     POLL CARD OPTIONAL FOR RJE LINE              
         BE    LV0RJE                                                           
         CLC   SAVTYPE,TWXLINE     POLL CARD OPTIONAL FOR TWX LINE              
         BE    LV0TWX                                                           
         MVI   ERRNUM,X'48'        MISSING POLL CARD                            
         B     ERROR                                                            
LV0LCL   MVC   0(6,R2),LCLPOLL                                                  
         MVI   6(R2),X'FF'                                                      
         B     LV2                                                              
LV0RJE   MVC   0(6,R2),RJEPOLL                                                  
         MVI   6(R2),X'FF'                                                      
         B     LV2                                                              
LV0TWX   MVC   0(6,R2),TWXPOLL                                                  
         MVI   6(R2),X'FF'                                                      
         B     LV2                                                              
         SPACE 2                                                                
LV2      CLI   6(R2),X'FF'         POLL MUST ASCEND BETWEEN DUPLICATES          
         BE    LV10                                                             
         CLC   4(1,R2),10(R2)      TEST ASCENDING MAJOR ADDR                    
         BNL   LV4                 NO                                           
         CLI   5(R2),X'FF'         TEST GENERAL POLL                            
         BNE   LV4                                                              
         AP    LERBCNT,=P'1'                                                    
         LA    R2,6(R2)                                                         
         B     LV2                                                              
         SPACE 2                                                                
LV4      L     R3,=A(POLLPOOL)     BREAK IN SEQUENCE                            
         LA    R4,6                CHECK REMAINING POLLS                        
         LA    R5,6-1(R2)          MUST BE PRECEDED BY A GENERAL POLL           
         CLI   5(R2),X'FF'                                                      
         BE    LV8                                                              
         CR    R2,R3                                                            
         BNE   LV6                                                              
         CLI   SAVTYPE+1,C'B'                                                   
         BNE   LV6ERR                                                           
         B     LV8                 ALLOW BISYNC SPECIFIC POLLS                  
         SPACE 2                                                                
LV6      CLC   4(1,R2),4(R3)       MATCH MAJORS                                 
         BE    LV8                                                              
         BXLE  R3,R4,*-10                                                       
         SPACE 2                                                                
LV6ERR   MVI   ERRNUM,X'49'        INVALID POLLING SEQUENCE                     
         B     ERROR                                                            
         SPACE 2                                                                
LV8      L     R3,=A(POLLPOOL)     RESET POINTER                                
         LA    R2,6(R2)            NEXT POLL                                    
         CLI   0(R2),X'FF'         CHECK FOR LAST                               
         BNE   LV6                                                              
         SPACE 2                                                                
LV10     L     R4,=A(TERMPOOL)     CHECK EVERY TERM COVERED BY POLL             
         USING TERMD,R4                                                         
         CLI   0(R4),X'FF'                                                      
         BNE   LV12                                                             
         CLC   SAVTYPE,LCLLINE     TERM CARD OPTIONAL FOR LCL LINE              
         BE    LV10LCL                                                          
         CLC   SAVTYPE,RJELINE     TERM CARD OPTIONAL FOR RJE LINE              
         BE    LV10RJE                                                          
         CLC   SAVTYPE,TWXLINE     TERM CARD OPTIONAL FOR TWX LINE              
         BE    LV10TWX                                                          
         MVI   ERRNUM,X'73'        MISSING TERM CARD                            
         B     ERROR                                                            
LV10LCL  MVC   TRMREC,LCLTERM      SET DEFAULT FOR LCL TERM                     
         MVI   L'TRMREC(R4),X'FF'                                               
         B     LV12                                                             
LV10RJE  MVC   TRMREC,RJETERM      SET DEFAULT FOR RJE TERM                     
         MVC   L'TRMREC(L'TRMREC,R4),RJETERM1                                   
         MVI   2*L'TRMREC(R4),X'FF'                                             
         B     LV12                                                             
LV10TWX  MVC   TRMREC,TWXTERM      SET DEFAULT FOR TWX TERM                     
         MVI   L'TRMREC(R4),X'FF'                                               
         B     LV12                                                             
         SPACE 2                                                                
LV12     CLI   0(R4),X'FF'                                                      
         BE    LV30                                                             
         L     R2,=A(POLLPOOL)                                                  
         SPACE 2                                                                
LV14     CLI   0(R2),X'FF'                                                      
         BNE   LV16                                                             
         MVI   ERRNUM,X'74'        TERMINAL NOT COVERED BY POLL                 
         B     ERROR                                                            
         SPACE 2                                                                
LV16     CLC   TRMADDR,0(R2)       CHECK FOR SPECIFIC POLL                      
         BE    LV20                                                             
         CLC   TRMDEV(2),=C'PRT'                                                
         BNE   *+12                                                             
         CLI   SAVTYPE+1,C'B'      GENERAL POLL OK FOR BSC                      
         BNE   LV18                SPECIFIC POLL FOR S/S PRINTER                
         CLC   2(2,R2),=C'FF'      CHECK FOR GENERAL POLL                       
         BNE   LV18                                                             
         CLC   0(2,R2),TRMADDR                                                  
         BE    LV20                                                             
         SPACE 2                                                                
LV18     LA    R2,6(R2)            BUMP TO NEXT POLL IN LIST                    
         B     LV14                                                             
         SPACE 2                                                                
LV20     LA    R4,L'TRMREC(R4)     BUMP TO NEXT TERMINAL IN LIST                
         B     LV12                                                             
         SPACE 2                                                                
LV30     L     R2,=A(POLLPOOL)     EVERY POLL MUST HAVE A TERMINAL              
         SPACE 2                                                                
LV32     CLI   0(R2),X'FF'                                                      
         BE    XIT                                                              
         L     R4,=A(TERMPOOL)                                                  
         USING TERMD,R4                                                         
         SPACE 2                                                                
LV34     CLI   0(R4),X'FF'                                                      
         BNE   LV36                                                             
         MVI   ERRNUM,X'75'        EVERY POLL MUST HAVE A TERMINAL              
         B     ERROR                                                            
         SPACE 2                                                                
LV36     CLC   TRMADDR,0(R2)       SPECIFIC POLL                                
         BE    LV40                                                             
         CLC   2(2,R2),=C'FF'      OR GENERAL                                   
         BNE   LV38                                                             
         CLC   0(2,R2),TRMADDR                                                  
         BE    LV40                                                             
         SPACE 2                                                                
LV38     LA    R4,L'TRMREC(R4)                                                  
         B     LV34                                                             
         SPACE 2                                                                
LV40     LA    R2,6(R2)                                                         
         B     LV32                                                             
         EJECT                                                                  
*GENERATE THE OUTPUT RECORDS                                                    
*                                                                               
BUILDREC NTR1                                                                   
         L     R9,=A(REGULAR)                                                   
         USING GEND,R9                                                          
         MVC   0(L'GENREC,R9),SPACES                                            
         L     R3,=A(POLLPOOL)                                                  
         L     R4,=A(TERMPOOL)                                                  
         USING TERMD,R4                                                         
         LA    R2,SAVELINE                                                      
         USING LINED,R2                                                         
         SPACE 2                                                                
BR2      CLI   LINTYPE+1,C'B'      ADJUST BSC TERM ADDR FOR SORT                
         BNE   BR2B                                                             
         CLC   TRMADDR+2(2),=C'40'                                              
         BNE   BR2B                                                             
         MVC   TRMADDR+2(2),=C'C0'                                              
         SPACE 2                                                                
BR2B     MVC   GENCODE,=C'105'     UTL FOR EACH TERMINAL                        
         MVC   GENLINE,LINID                                                    
         CLC   GENLINE(3),=C'DDS '                                              
         BNE   *+10                                                             
         MVC   GENLINE(3),SPACES   ENSURE DDS TERMINALS SORT FIRST              
         MVC   GENADDR,TRMADDR                                                  
         MVC   GENTYPE,LINTYPE                                                  
         MVC   GENMAKE,TRMTYPE                                                  
         MVC   GENDEV,TRMDEV                                                    
         MVC   GENOFF,TRMOFF                                                    
         MVC   GENSYS(4),TRMBUFF                                                
         MVC   GENATTB,TRMATTB                                                  
         MVC   GENOP(1),TRMDEV1                                                 
         MVC   GENPOLL(4),TRMSPEED                                              
         ZIC   R1,TRMCTRY                                                       
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  GENCTRY,DUB                                                      
         BAS   RE,GO                                                            
         SPACE 2                                                                
BR2C     CLC   TRMDEV(2),=C'PRT'   PRQ FOR EACH PRINTER                         
         BNE   BR2D                                                             
         MVC   GENCODE,=C'205'                                                  
         MVC   GENLINE,LINID                                                    
         CLC   GENLINE(3),=C'DDS '                                              
         BNE   *+10                                                             
         MVC   GENLINE(3),SPACES   ENSURE DDS TERMINALS SORT FIRST              
         MVC   GENADDR,TRMADDR                                                  
         MVC   GENTYPE,LINTYPE                                                  
         ZIC   R0,TRMQU            SET NUMBER OF QUEUE ENTRYS                   
         LTR   R0,R0                                                            
         BNZ   *+8                                                              
         LA    R0,8                DEFAULT=8                                    
         CVD   R0,DUB                                                           
         UNPK  DUB(4),DUB+6(2)                                                  
         OI    DUB+3,X'F0'                                                      
         MVC   GENPOLL(4),DUB                                                   
         BAS   RE,GO                                                            
         SPACE 2                                                                
BR2D     MVC   GENCODE,=C'305'     ADDR FOR EACH TERMINAL                       
         MVC   GENADDR,TRMADDR                                                  
         MVC   GENTYPE,LINTYPE                                                  
         BAS   RE,GO                                                            
         SPACE 2                                                                
BR2E     LA    R4,L'TRMREC(R4)                                                  
         CLI   0(R4),X'FF'                                                      
         BNE   BR2                                                              
         SPACE 2                                                                
BR3      MVC   GENCODE,=C'405'     DECB FOR EACH LINE                           
         MVC   GENLINE,LINID                                                    
         MVC   GENTYPE,LINTYPE                                                  
         MVC   GENMAX,LINMAX                                                    
         MVC   GENOP,LINOP                                                      
         MVC   GENOP+1(5),LINBAUD                                               
         ZIC   R1,LINCTRY                                                       
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  GENCTRY,DUB                                                      
         BAS   RE,GO                                                            
         SPACE 2                                                                
BR4      MVC   GENCODE,=C'505'     POLL FOR EACH POLL ENTRY                     
         MVC   GENLINE,LINID                                                    
         MVC   GENTYPE,LINTYPE                                                  
         MVC   GENPOLL,0(R3)                                                    
         CLC   GENPOLL+2(2),=C'FF'                                              
         BE    *+8                                                              
         MVI   GENADDR,C'S'        ENSURE GENERALS PRECEDE SPECIFICS            
         BAS   RE,GO                                                            
         LA    R3,6(R3)                                                         
         CLI   0(R3),X'FF'                                                      
         BNE   BR4                                                              
         SPACE 2                                                                
BR5      MVC   GENCODE,=C'605'     ECB FOR EACH LINE                            
         MVC   GENLINE,LINID                                                    
         BAS   RE,GO                                                            
         SPACE 2                                                                
         MVC   GENCODE,=C'705'     DTFBT/DCB FOR EACH LINE                      
         MVC   GENLINE,LINID                                                    
         MVC   GENTYPE,LINTYPE                                                  
         MVC   GENSYS,LINSYS                                                    
         MVC   GENDD,LINDD                                                      
         BAS   RE,GO                                                            
         SPACE 2                                                                
         L     R3,=A(POLLPOOL)     LERB FOR EACH LINE                           
         ZAP   DUB,LERBCNT                                                      
         CVB   R0,DUB                                                           
*                                                                               
BR6      MVC   GENCODE,=C'805'                                                  
         MVC   GENLINE,LINID                                                    
         MVC   GENTYPE,0(R3)       GENTYPE IS MAJOR ADDRESS                     
         MVC   GENTYPE2,LINTYPE+1                                               
         CLI   LINTYPE,C'M'                                                     
         BE    *+12                                                             
         BAS   RE,GO                                                            
         B     BR8                                                              
         SPACE 2                                                                
         C     R3,=A(POLLPOOL)     MULTI-DROP GETS LERB/ASCENDING POLL          
         BE    *+8                                                              
         MVI   GENMAX,C'1'         SET NO LABEL REQUIRED                        
         BAS   RE,GO                                                            
         LA    R3,6(R3)                                                         
         BCT   R0,BR6                                                           
         SPACE 2                                                                
BR8      MVC   GENCODE,=C'905'     ONE BUFFER PER LINE                          
         MVC   GENLINE,LINID                                                    
         MVC   GENTYPE,LINTYPE                                                  
         BAS   RE,GO                                                            
         SPACE 2                                                                
         CLI   LINMAX,C'2'                                                      
         BL    XIT                                                              
         MVC   GENCODE,=C'955'     ONE LCBUFF PER LINE IF MAXBUFF GE 2          
         MVC   GENLINE,LINID                                                    
         BAS   RE,GO                                                            
         B     XIT                                                              
         SPACE 2                                                                
GO       LA    R9,L'GENREC(R9)                                                  
         MVC   0(L'GENREC,R9),SPACES                                            
         MVI   0(R9),X'FF'                                                      
         BR    RE                                                               
         EJECT                                                                  
*RELEASE OF RECORDS TO SORT, ERROR HANDLING AND XIT                             
*                                                                               
RELEASE  LA    R2,C                                                             
         UNPK  GENSEQ,OUTSEQ                                                    
         OI    GENSEQ+4,X'F0'                                                   
         AP    OUTSEQ,=P'1'                                                     
         CLI   TRACOPT,C'Y'                                                     
         BNE   RELEASE1                                                         
         MVC   P(80),C                                                          
         GOTO1 =V(PRINTER)                                                      
*                                                                               
RELEASE1 GOTO1 =V(SORTER),PARA,=C'PUT',(R2)                                     
         B     INPUT                                                            
         SPACE 2                                                                
ERROR    MVC   SVERRNUM,ERRNUM     SAVE ERROR NUMBER                            
         L     R5,=A(ERRMSG)                                                    
ERROR1   CLI   0(R5),X'FF'         EXIT IF UNKNOWN ERROR NUMBER                 
         BE    ERROR2                                                           
         CLC   0(1,R5),ERRNUM                                                   
         BE    ERROR2                                                           
         LA    R5,40(R5)                                                        
         B     ERROR1                                                           
*                                                                               
ERROR2   MVC   P,SPACES            FORMAT/DISPLAY/PRINT ERROR MESSAGE           
         GOTO1 =V(PRINTER)                                                      
         MVC   P(20),=CL20'***NETGEN ERROR***'                                  
         MVC   P+20(38),2(R5)                                                   
         GOTO1 =V(LOGIO),PARA,1,(58,P)                                          
         GOTO1 =V(PRINTER)                                                      
         MVC   P,SPACES                                                         
         L     R5,=A(ERRMSG)       POINT TO ABEND ERROR MESSAGE                 
         MVC   P(38),2(R5)                                                      
         GOTO1 =V(LOGIO),PARA,1,(38,P)                                          
         GOTO1 =V(PRINTER)                                                      
         MVC   RETCODE+3(1),SVERRNUM                                            
         L     RD,SAVERD           FORCE EXIT FROM SUBROUTINE                   
         B     EOJ                                                              
         SPACE 2                                                                
XIT      XIT1                                                                   
         EJECT                                                                  
*READ SORT FILE RECORDS AND OUTPUT PAN DISK FILE                                
*                                                                               
OUTPUT   GOTO1 =V(SORTER),PARA,=C'GET'                                          
         L     R9,4(R1)                                                         
         USING GEND,R9                                                          
         LTR   R9,R9               TEST EOF ON SORT FILE                        
         BZ    FINAL                                                            
         MVC   C,SPACES                                                         
         MVC   C(L'GENREC),GENREC                                               
         BAS   RE,ANYPRT                                                        
         L     R2,=A(OUTLIST)                                                   
         SPACE 2                                                                
OUTPUT2  CLC   GENCODE,0(R2)       LOOK UP BRANCH ADDRESS                       
         BE    OUTPUT4                                                          
         CLI   0(R2),X'FF'                                                      
         BE    OUTPUT                                                           
         LA    R2,8(R2)                                                         
         B     OUTPUT2                                                          
         SPACE 2                                                                
OUTPUT4  L     R3,4(R2)            PASS CONTROL TO OUTPUT ROUTINE               
         BR    R3                                                               
         EJECT                                                                  
*OUTPUT OF HEADER CARDS                                                         
*                                                                               
OUT101   BAS   RE,OPNPAN           OPEN OUTPUT PAN FILE                         
         CLC   OUTTYPE,SPACES                                                   
         BE    OUT101A                                                          
         L     RE,=A(CARD101A)                                                  
         LA    RE,9(RE)                                                         
         MVC   0(12,RE),OUTTYPE    SET OUTPUT PAN NAME                          
         CLI   0(RE),C' '                                                       
         BE    *+12                                                             
         LA    RE,1(RE)                                                         
         B     *-12                                                             
         MVC   0(20,RE),=CL20',0,ALL'                                           
         SPACE 2                                                                
OUT101A  L     R2,=A(CARD101)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
OUTADDR  CLI   GENTYPE+1,C'B'      ADJUST BSC TERM ADDR FROM SORT               
         BNER  RE                                                               
         CLC   GENADDR+2(2),=C'C0'                                              
         BNER  RE                                                               
         MVC   GENADDR+2(2),=C'40'                                              
         BR    RE                                                               
         EJECT                                                                  
*OUTPUT OF UTL CARDS                                                            
*                                                                               
OUT105   MVC   C,CARD105A          LABEL FOR LINE/ADDRESS                       
         CLC   GENLINE(3),SPACES                                                
         BNE   *+10                                                             
         MVC   GENLINE(3),=C'DDS '                                              
         BAS   RE,OUTADDR                                                       
         MVC   C(4),GENLINE                                                     
         MVC   C+4(4),GENADDR                                                   
         CLI   C+3,C' '                                                         
         BNE   *+10                                                             
         MVC   C+3(5),C+4                                                       
         CLC   GENDEV(2),=C'PRT'   COMMENT FOR PRINT QUEUE NUMBER               
         BNE   OUT105A                                                          
         AP    PQNUM,=P'1'                                                      
         MVC   C+35(17),=C'PRINT Q NUMBER = '                                   
         EDIT  (P4,PQNUM),(4,C+52),ALIGN=LEFT                                   
*                                                                               
OUT105A  BAS   RE,PUTPAN                                                        
         MVC   C,CARD105           UTL BASIC MACRO DEFINITION                   
         UNPK  C+4(4),TERMSEQ                                                   
         OI    C+7,X'F0'                                                        
         AP    TERMSEQ,=P'1'                                                    
         CLI   GENTYPE+1,C'B'      BSC USE FATRB MACRO                          
         BNE   *+10                                                             
         MVC   C+9(5),=C'FATRB'                                                 
         MVC   C+23(4),GENADDR                                                  
         MVC   C+33(4),GENLINE                                                  
         MVC   C+43(3),GENMAKE                                                  
         MVC   C+54(3),GENDEV                                                   
         MVC   C+65(4),GENOFF                                                   
         CLI   C+36,C' '                                                        
         BNE   *+10                                                             
         MVC   C+36(40),C+37                                                    
*                                                                               
OUT105B  CLC   GENDEV(2),=C'PRT'   TEST IF PRINTER TERMINAL                     
         BNE   OUT105C                                                          
         LA    RE,C+70             SET TO CONTINUE MACRO PARAMS                 
         CLI   0(RE),C' '                                                       
         BNE   *+10                                                             
         BCTR  RE,0                                                             
         B     *-10                                                             
         LA    RE,1(RE)                                                         
         MVI   0(RE),C','                                                       
         MVI   C+71,C'X'                                                        
         BAS   RE,PUTPAN                                                        
         MVC   C,CARD105C          BASIC PRINTER DEFINITION                     
         CLI   GENOP,C' '                                                       
         BE    *+10                                                             
         MVC   C+22(1),GENOP                                                    
         CLI   GENPOLL,C' '                                                     
         BE    *+10                                                             
         MVC   C+32(4),GENPOLL                                                  
         CLI   GENSYS,C' '                                                      
         BE    *+10                                                             
         MVC   C+44(4),GENSYS                                                   
*                                                                               
OUT105C  LA    RE,C+70             SET TO CONTINUE MACRO PARMS                  
         CLI   0(RE),C' '                                                       
         BNE   *+10                                                             
         BCTR  RE,0                                                             
         B     *-10                                                             
         LA    RE,1(RE)                                                         
         MVI   0(RE),C','                                                       
         MVI   C+71,C'X'                                                        
         BAS   RE,PUTPAN                                                        
         MVC   C,CARD105D          BASIC ATTRIBUTE/COUNTRY PARAMS               
         CLC   GENATTB,SPACES                                                   
         BE    *+10                                                             
         MVC   C+20(8),GENATTB                                                  
         CLC   GENCTRY,SPACES                                                   
         BE    *+10                                                             
         MVC   C+34(3),GENCTRY                                                  
*                                                                               
OUT106   BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT109   L     R2,=A(CARD109)      UTL END                                      
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
CARD105  DC    C'TERMNNNN FATRM ADDRESS=AAAA,LINE=LLLL,'                        
         DC    C'TYPE=ICC,DEVICE=TRM,OFFICE=OOOO'                               
         DC    CL20' '                                                          
         SPACE 1                                                                
CARD105A DC    CL80'LLLLTTTT DC    0H''0'' '                                    
         SPACE 1                                                                
CARD105C DC    CL15' '                                                          
         DC    C'PRTYPE=B,PRSPEED=0120,PRBUFF=1920'                             
         DC    CL32' '                                                          
         SPACE 1                                                                
CARD105D DC    CL15' '                                                          
         DC    C'ATTR=00000000,CTRY=000'                                        
         DC    CL43' '                                                          
         EJECT                                                                  
*OUTPUT OF PRINT QUEUE CARDS                                                    
*                                                                               
OUT201   L     R2,=A(CARD201)      PRINTER QUEUES HEADING                       
         BAS   RE,PUTMULT                                                       
         ZAP   PQNUM,=P'0'                                                      
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT205   L     R2,=A(CARD205)      ONE ENTRY FOR EACH PRINTER                   
         MVC   C(80),0(R2)                                                      
         AP    PQNUM,=P'1'                                                      
         EDIT  (P4,PQNUM),(4,C+3),ALIGN=LEFT                                    
         CLC   GENLINE(3),SPACES                                                
         BNE   *+10                                                             
         MVC   GENLINE(3),=C'DDS '                                              
         BAS   RE,OUTADDR                                                       
         MVC   C+37(2),GENPOLL+2   NUM OF ENTRYS IN QUEUE                       
         MVC   C+61(2),GENPOLL+2   NUM OF ENTRYS IN QUEUE                       
         MVC   C+51(4),GENLINE     LINE ID                                      
         MVC   C+55(4),GENADDR     ADDR ID                                      
         CLI   C+54,C' '                                                        
         BNE   *+14                                                             
         MVC   C+54(6),C+55        SHIFT LEFT IF 3CHR LINE ID                   
         MVI   C+60,C'0'                                                        
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT209   L     R2,=A(CARD209)      PRINTER QUEUES END                           
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         EJECT                                                                  
*OUTPUT OF ADDRESS CARDS                                                        
*                                                                               
OUT301   L     R2,=A(CARD301)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT305   MVC   C(32),=C'ADDRXXXX DFTRMLST OPENLST,(XXXX)'                       
         MVC   C+32(48),SPACES                                                  
         BAS   RE,OUTADDR                                                       
         MVC   C+4(4),GENADDR                                                   
         MVC   C+27(4),GENADDR                                                  
         CLI   GENTYPE+1,C'B'      FOR BSC AABB BECOMES CCCCDDDD2D              
         BNE   OUT305B                                                          
         MVC   LOOK(4),GENADDR                                                  
         BAS   RE,LOOKUP                                                        
         MVC   C+27(2),LOOK+4                                                   
         MVC   C+29(2),LOOK+4                                                   
         MVC   C+31(2),LOOK+2                                                   
         MVC   C+33(2),LOOK+2                                                   
         MVC   C+35(3),=C'2D)'                                                  
         SPACE 2                                                                
OUT305B  CLC   GENADDR,LASTADDR                                                 
         BE    *+8                                                              
         BAS   RE,PUTPAN                                                        
         MVC   LASTADDR,GENADDR                                                 
         B     OUTPUT                                                           
         EJECT                                                                  
*OUTPUT OF DECB CARDS                                                           
*                                                                               
OUT401   L     R2,=A(CARD401)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT405   L     R2,=A(CARD405)                                                   
         MVC   SAVE405(160),0(R2)                                               
         CLI   GENTYPE+1,C'B'      BSC USES FALNB MACRO                         
         BNE   *+10                                                             
         MVC   9(5,R2),=C'FALNB'                                                
         MVC   20(4,R2),GENLINE                                                 
         MVC   31(1,R2),GENMAX                                                  
         CLI   GENMAX,C' '                                                      
         BNE   *+8                                                              
         MVI   31(R2),C'0'                                                      
         MVC   38(2,R2),GENTYPE                                                 
         CLI   GENOP+1,C' '                                                     
         BE    *+10                                                             
         MVC   46(5,R2),GENOP+1                                                 
         MVC   55(4,R2),=C'YES,'                                                
         CLI   GENOP,C'N'                                                       
         BNE   *+10                                                             
         MVC   55(4,R2),=C'NO, '                                                
         CLI   23(R2),C' '                                                      
         BNE   *+10                                                             
         MVC   23(41,R2),24(R2)                                                 
         LA    RE,80(R2)                                                        
         MVC   20(3,RE),GENCTRY                                                 
         BAS   RE,PUTMULT                                                       
         MVC   0(160,R2),SAVE405                                                
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT409   L     R2,=A(CARD409)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
SAVE405  DS    CL160                                                            
         EJECT                                                                  
*OUTPUT OF POLL CARDS                                                           
*                                                                               
OUT501   L     R2,=A(CARD501)      COMMENTS FOR POLLING LISTS                   
         BAS   RE,PUTMULT                                                       
         MVI   FRSTPOLL,C'Y'       INITIALISE FOR FIRST POLL CARD               
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT505   CLI   FRSTPOLL,C'Y'       TEST IF CHANGE OF LINE ID                    
         BE    OUT505A                                                          
         CLC   GENLINE,LASTLINE                                                 
         BE    OUT505B                                                          
         BAS   RE,PUTWRAP          YES-WRITE OUT DFTRMLST CARDS                 
*&&OS                                                                           
         MVC   C+9(3),=C'ORG'                                                   
         BAS   RE,PUTPAN                                                        
*&&                                                                             
OUT505A  MVI   FRSTPOLL,C'N'       NEW LINE ID                                  
         MVC   LASTLINE,GENLINE                                                 
         BAS   RE,NEWWRAP                                                       
         B     OUTPUT                                                           
*                                                                               
OUT505B  BAS   RE,ADDWRAP          SAME LINE ID AS LAST                         
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT509   BAS   RE,PUTWRAP          END OF POLL CARDS                            
*&&OS                                                                           
         MVC   C+9(3),=C'ORG'                                                   
         BAS   RE,PUTPAN                                                        
*&&                                                                             
         B     OUTPUT                                                           
         SPACE 2                                                                
NEWWRAP  NTR1                      SET FIRST POLL IN WRAP BUFFER                
         MVC   C(80),SPACES                                                     
*&&DO                                                                           
         MVC   C+9(13),=C'DC    AL1(96)'                                        
         BAS   RE,PUTPAN                                                        
*&&                                                                             
*&&OS                                                                           
         CLI   GENTYPE+1,C'B'      TEST BSC                                     
         BE    NEWWRAP1                                                         
         MVC   C+9(19),=C'DC    96X''00'',X''80'''                              
         BAS   RE,PUTPAN                                                        
         MVC   C+9(10),=C'ORG   *-97'                                           
         BAS   RE,PUTPAN                                                        
NEWWRAP1 DS    0H                                                               
*&&                                                                             
         MVC   WRAPBUFF(32),=C'POLLXXXX DFTRMLST WRAPLST,(PPPP)'                
         MVC   WRAPBUFF+4(4),GENLINE                                            
         MVC   WRAPBUFF+27(4),GENPOLL                                           
         MVC   WRAPBUFF+32(80),SPACES                                           
         CLI   GENTYPE+1,C'B'                                                   
         BE    NEWWRAP2             BSC POLLS HAVE DIFFERENT FORMAT             
         B     XIT                                                              
*&&DO                                                                           
NEWWRAP2 MVC   WRAPBUFF+18(24),=C'AUTOWLST,3732,AAAABBBB2D'                     
         LA    R2,WRAPBUFF+32                                                   
         B     ADDWRAP8                                                         
*&&                                                                             
*&&OS                                                                           
NEWWRAP2 MVC   WRAPBUFF+18(24),=C'AUTOWLST,(AAAABBBB2D)   '                     
         LA    R2,WRAPBUFF+28                                                   
         B     ADDWRAP8                                                         
*&&                                                                             
         SPACE 2                                                                
ADDWRAP  NTR1                      EXTEND WRAP BUFFER WITH NEXT POLL            
         LA    R2,WRAPBUFF+31                                                   
         CLI   GENTYPE+1,C'B'                                                   
         BE    ADDWRAP6                                                         
*                                                                               
ADDWRAP2 CLI   0(R2),C')'          S/S SEARCH FOR END OF LIST                   
         BE    ADDWRAP4                                                         
         LA    R2,1(R2)                                                         
         B     ADDWRAP2                                                         
ADDWRAP4 MVC   0(6,R2),=C',PPPP)'  ADD POLL TO END OF LIST                      
         MVC   1(4,R2),GENPOLL                                                  
         MVC   6(80,R2),SPACES                                                  
         B     XIT                                                              
*                                                                               
ADDWRAP6 DS    0H                  BSC SEARCH FOR END OF LIST                   
*&&DO                                                                           
         CLI   0(R2),C' '          DOS ENDS WITH BLANK                          
         BE    ADDWRAP7                                                         
*&&                                                                             
*&&OS                                                                           
         CLI   0(R2),C')'          MVS ENDS WITH PAREN                          
         BNE   *+12     '                                                       
         SH    R2,=H'11'           CUT BACK PAST LAST ENTRY                     
         B     ADDWRAP7                                                         
*&&                                                                             
         LA    R2,1(R2)                                                         
         B     ADDWRAP6                                                         
ADDWRAP7 MVI   0(R2),C','                                                       
         LA    R2,1(R2)                                                         
ADDWRAP8 MVC   0(2,R2),GENPOLL     ADD POLL TO END OF LIST                      
         MVC   2(2,R2),GENPOLL                                                  
         MVC   4(2,R2),GENPOLL+2                                                
         MVC   6(2,R2),GENPOLL+2                                                
         CLC   GENPOLL+2(2),=C'FF'                                              
         BNE   *+10                                                             
         MVC   4(4,R2),=C'7F7F'                                                 
         MVC   8(2,R2),=C'2D'                                                   
*&&DO*&& MVC   10(80,R2),SPACES    SET END OF LIST                              
*&&OS                                                                           
         MVC   10(12,R2),=C',3737373737)'                                       
         MVC   22(80,R2),SPACES                                                 
*&&                                                                             
         B     XIT                                                              
         SPACE 2                                                                
PUTWRAP  NTR1                      CARVE WRAP POOL INTO 80 COL CARDS            
         LA    R2,WRAPBUFF                                                      
         MVC   C(80),SPACES                                                     
         MVC   C(72),0(R2)                                                      
         BAS   RE,PUTPAN                                                        
         LA    R2,71(R2)                                                        
*                                                                               
PUTWRAP2 CLI   0(R2),C' '          TEST END OF LIST                             
         BE    XIT                                                              
         MVC   C(80),SPACES                                                     
         MVC   C+15(57),0(R2)                                                   
         BAS   RE,PUTPAN                                                        
         LA    R2,56(R2)                                                        
         B     PUTWRAP2                                                         
         EJECT                                                                  
*OUTPUT OF ECB CARDS                                                            
*                                                                               
OUT601   L     R2,=A(CARD601)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT605   MVC   C(80),SPACES                                                     
         MVC   C+9(17),=C'DC    A(DECBLLLL)'                                    
         MVC   C+21(4),GENLINE                                                  
         CLI   C+24,C' '                                                        
         BNE   *+10                                                             
         MVC   C+24(3),C+25                                                     
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT609   L     R2,=A(CARD609)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         EJECT                                                                  
*OUTPUT OF BTAM DTF/DCB CARDS                                                   
*                                                                               
OUT701   L     R2,=A(CARD701)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
*&&DO                                                                           
OUT705   L     R2,=A(CARD705)                                                   
         MVC   3(4,R2),GENLINE                                                  
         MVC   24(3,R2),GENSYS                                                  
         MVC   C(80),0(R2)                                                      
         CLC   GENTYPE,TWXLINE     TWX HAS DIFFERENT DTF                        
         BE    OUT705T                                                          
         CLI   GENTYPE+1,C'B'      BSC HAS DIFFERENT DTF                        
         BE    OUT705B                                                          
*                                                                               
OUT705S  DS    0H                  S/S DTF IS DEFAULT                           
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
*                                                                               
OUT705T  DS    0H                  TWX DTF                                      
         MVC   C+29(40),=C'SWITCH=YES,ERROPT=N,CU=2701,DEVICE=TW33 '            
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
*                                                                               
OUT705B  DS    0H                  BSC DTF                                      
         CLI   GENTYPE,C'L'                                                     
         BE    OUT705L                                                          
         MVC   C+39(31),=C'CU=2703,DEVICE=BSC3,CONFIG=MPT,'                     
         MVI   C+71,C'X'                                                        
         BAS   RE,PUTPAN                                                        
         MVC   C(80),SPACES                                                     
         MVC   C+15(34),=C'MODELST=(0),CTLCHAR=EBCDIC,RETRY=3'                  
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
*                                                                               
OUT705L  DS    0H                  BSC LOCAL DTF                                
         MVC   C+29(40),=C'CU=3272,DEVICE=3277                     '            
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
*&&                                                                             
*&&OS                                                                           
OUT705   L     R2,=A(CARD705)                                                   
         MVC   3(4,R2),GENLINE                                                  
         MVC   C(80),0(R2)                                                      
         MVC   C+43(7),GENDD                                                    
         LA    RE,C+43             POINT RE TO FIRST BLANK COL                  
         CLI   0(RE),C' '                                                       
         BE    *+12                                                             
         LA    RE,1(RE)                                                         
         B     *-12                                                             
         CLC   GENTYPE,TWXLINE     TWX HAS DIFFERENT DCB                        
         BE    OUT705T                                                          
         CLI   GENTYPE+1,C'B'      BSC HAS DIFFERENT DCB                        
         BE    OUT705B                                                          
*                                                                               
OUT705S  DS    0H                  S/S DCB                                      
         MVC   0(08,RE),=C',EROPT=N'                                            
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
*                                                                               
OUT705T  DS    0H                  TWX DCB                                      
         MVC   0(08,RE),=C',EROPT=N'                                            
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
*                                                                               
OUT705B  CLI   GENTYPE,C'L'        BSC DCB                                      
         BE    OUT705L                                                          
         MVC   0(08,RE),=C',DEVD=BS'                                            
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
*                                                                               
OUT705L  DS    0H                  BSC LOCAL DCB                                
         MVC   0(08,RE),=C',DEVD=LD'                                            
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
*&&                                                                             
         EJECT                                                                  
*OUTPUT OF LERB CARDS                                                           
*                                                                               
OUT801   L     R2,=A(CARD801)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT805   MVC   C(80),SPACES                                                     
         CLI   GENMAX,C'1'                                                      
         BE    *+16                                                             
         MVC   C(4),=C'LERB'                                                    
         MVC   C+4(4),GENLINE                                                   
         MVC   C+9(25),=C'DC    5F''0'',9X''00'',X''00'','                      
         MVC   C+30(2),GENTYPE                                                  
         MVC   C+34(11),=C'2X''00'',F''0'''                                     
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
         EJECT                                                                  
*OUTPUT OF BUFFER CARDS                                                         
*                                                                               
OUT901   L     R2,=A(CARD901)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT905   MVC   C(80),SPACES                                                     
         MVC   C(19),=C'BFLLLL   DS    257D'                                    
         MVC   C+2(4),GENLINE                                                   
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT909   L     R2,=A(CARD909)                                                   
         BAS   RE,PUTMULT                                                       
         L     R2,SAVEBUFF         OUTPUT MULTI-BUFFS                           
         LTR   R2,R2                                                            
         BZ    OUT909B                                                          
         LA    R3,1                                                             
*                                                                               
OUT909A  MVC   C(80),SPACES                                                     
         MVC   C(19),=C'MBUFFNNN DS    257D'                                    
         EDIT  (R3),(3,C+5),FILL=0                                              
         BAS   RE,PUTPAN                                                        
         LA    R3,1(R3)                                                         
         BCT   R2,OUT909A                                                       
*                                                                               
OUT909B  L     R2,=A(CARD9092)                                                  
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         EJECT                                                                  
*OUTPUT OF LCBUFF CARDS                                                         
*                                                                               
OUT951   L     R2,=A(CARD951)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT955   MVC   C(80),SPACES                                                     
         MVC   C+9(24),=C'DC    C''B'',AL3(BFLLLL+8)'                           
         MVC   C+26(4),GENLINE                                                  
         CLI   GENLINE+3,C' '                                                   
         BNE   *+10                                                             
         MVC   C+29(2),=C'+0'                                                   
         MVC   C+45(4),GENLINE                                                  
         BAS   RE,PUTPAN                                                        
         B     OUTPUT                                                           
         SPACE 2                                                                
OUT959   MVC   C(80),SPACES        GENERATE MULTI-BUFF ADDRESSES                
         MVC   C+9(7),=C'SPACE 1'                                               
         BAS   RE,PUTPAN                                                        
         L     R2,SAVEBUFF                                                      
         LTR   R2,R2                                                            
         BZ    OUT959B                                                          
         LA    R3,1                                                             
*                                                                               
OUT959A  MVC   C(80),SPACES                                                     
         MVC   C+9(19),=C'DC    A(MBUFFNNN+8)'                                  
         EDIT  (R3),(3,C+22),FILL=0                                             
         BAS   RE,PUTPAN                                                        
         LA    R3,1(R3)                                                         
         BCT   R2,OUT959A                                                       
*                                                                               
OUT959B  L     R2,=A(CARD959)                                                   
         BAS   RE,PUTMULT                                                       
         B     OUTPUT                                                           
         SPACE 2                                                                
FINAL    BAS   RE,CLSPAN           CLOSE OUTPUT PAN FILE                        
         SPACE 2                                                                
EOJ      XBASE RC=RETCODE                                                       
         EJECT                                                                  
*ROUTINES TO HANDLE I/0 TO OUTPUT DISK FILE                                     
*                                                                               
OPNPAN   NTR1                                                                   
         LA    R2,PANFIL                                                        
*&&DO*&& OPEN  (2)                                                              
*&&OS*&& OPEN  ((2),OUTPUT)                                                     
         B     XIT                                                              
         SPACE 2                                                                
CLSPAN   NTR1                                                                   
         LA    R2,PANFIL                                                        
*&&DO*&& CLOSE (2)                                                              
*&&OS*&& CLOSE ((2))                                                            
         B     XIT                                                              
         SPACE 2                                                                
PUTPAN   NTR1                      SINGLE RECORD WRITE TO DISK                  
         CLI   TRACOPT,C'Y'                                                     
         BNE   PUTPAN2                                                          
         MVC   P,SPACES                                                         
         MVC   P(80),C                                                          
         GOTO1 =V(PRINTER)                                                      
*                                                                               
PUTPAN2  LA    R1,PANFIL                                                        
         LA    R0,C                                                             
         PUT   (1),(0)                                                          
         MVC   C,SPACES                                                         
         B     XIT                                                              
         SPACE 2                                                                
PUTMULT  NTR1                      MULTI RECORD WRITES TO DISK                  
PUTMUL2  MVC   C(80),0(R2)                                                      
         BAS   RE,PUTPAN                                                        
         LA    R2,80(R2)                                                        
         CLI   0(R2),X'FF'                                                      
         BNE   PUTMUL2                                                          
         B     XIT                                                              
         SPACE 2                                                                
ANYPRT   CLI   TRACOPT,C'Y'        PRINT DATA IF TRACE OPTION                   
         BNER  RE                                                               
         NTR1                                                                   
         MVC   P,SPACES                                                         
         MVC   P(L'GENREC),0(R9)                                                
         GOTO1 =V(PRINTER)                                                      
         B     XIT                                                              
         EJECT                                                                  
*&&DO                                                                           
PANFIL   DTFSD BLKSIZE=88,RECFORM=FIXUNB,TYPEFLE=OUTPUT,               X        
               DEVICE=3340,IOAREA1=PANIOA1,IOAREA2=PANIOA2,WORKA=YES            
         ORG   PANFIL+22                                                        
         DC    CL7'KHOUT'                                                       
         ORG                                                                    
PANIOA1  DS    CL88                                                             
PANIOA2  DS    CL88                                                             
*&&                                                                             
         SPACE 2                                                                
*&&OS                                                                           
PANFIL   DCB   DDNAME=PANFIL,DSORG=PS,RECFM=FB,LRECL=80,               X        
               BLKSIZE=0,MACRF=PM                                               
*&&                                                                             
         EJECT                                                                  
DUB      DS    D                                                                
PARA     DS    6F                                                               
SAVERD   DS    F                                                                
ALINPOOL DC    A(0)                                                             
SAVEBUFF DC    F'0'                                                             
RETCODE  DC    F'0'                                                             
ASPECIAL DC    A(SPECIAL)                                                       
AREGULAR DC    A(REGULAR)                                                       
ABLOCK   DC    A(BLOCK)                                                         
*                                                                               
TRACOPT  DC    C'N'                                                             
FIRSTIME DC    C'Y'                                                             
FRSTPOLL DC    C'Y'                                                             
ERRNUM   DC    X'00'                                                            
SVERRNUM DC    X'00'                                                            
SAVTYPE  DC    CL2' '                                                           
LASTADDR DC    CL4' '                                                           
LASTLINE DC    CL4' '                                                           
LOOK     DC    CL8' '                                                           
INTYPE   DC    CL12' '                                                          
OUTTYPE  DC    CL12' '                                                          
SAVELINE DC    CL48' '                                                          
*                                                                               
SEQUENCE DC    PL4'1'                                                           
OUTSEQ   DC    PL4'1'                                                           
PQNUM    DC    PL4'0'                                                           
LERBCNT  DC    PL4'0'                                                           
SAVEPQ   DC    PL4'400'                                                         
TERMSEQ  DC    PL4'1'                                                           
*                                                                               
LCLLINE  DC    C'LB'               3270 BSC LOCAL                               
LCLPOLL  DC    C'4040',X'4040'                                                  
LCLTERM  DC    CL23'4040DDS*327TRM         ',X'00',C'        '                  
         DC    AL1(000),CL15' '                                                 
*                                                                               
RJELINE  DC    C'RB'               3780 RJE BSC TERMINAL                        
RJEPOLL  DC    C'40FF',X'40FF'                                                  
RJETERM  DC    CL23'40C1GRF1378TRM         ',X'00',C'        '                  
         DC    AL1(000),CL15' '                                                 
RJETERM1 DC    CL23'40C2GRF1378PRTB    0256',X'08',C'10100001'                  
         DC    AL1(000),CL15' '                                                 
*                                                                               
TWXLINE  DC    C'TW'                                                            
TWXPOLL  DC    C'A0A0',X'A0A0'                                                  
TWXTERM  DC    CL23'A0A0TWXOTWXPRTB        ',X'08',C'00000000'                  
         DC    AL1(000),CL15' '                                                 
*                                                                               
C        DC    CL80' ',CL16' '                                                  
D        DC    CL80' ',CL16' '                                                  
WORK     DC    CL80' '                                                          
SAVECARD DC    CL80' '                                                          
*                                                                               
SRTCRD1  DC    CL80'SORT FIELDS=(1,20,A),FORMAT=BI,WORK=1 '                     
SRTCRD2  DC    CL80'RECORD TYPE=F,LENGTH=64'                                    
*                                                                               
WRAPBUFF DS    10CL80              BUFFER FOR WRAP LIST                         
         EJECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
BSCADR   DS    0CL4                 LOOK UP TABLE FOR BSC ADDRESSES             
         DC    C'4060'                                                          
         DC    C'C161'                                                          
         DC    C'C2E2'                                                          
         DC    C'C3E3'                                                          
         DC    C'C4E4'                                                          
         DC    C'C5E5'                                                          
         DC    C'C6E6'                                                          
         DC    C'C7E7'                                                          
         DC    C'C8E8'                                                          
         DC    C'C9E9'                                                          
         DC    C'4A6A'                                                          
         DC    C'4B6B'                                                          
         DC    C'4C6C'                                                          
         DC    C'4D6D'                                                          
         DC    C'4E6E'                                                          
         DC    C'4F6F'                                                          
         DC    C'50F0'                                                          
         DC    C'D1F1'                                                          
         DC    C'D2F2'                                                          
         DC    C'D3F3'                                                          
         DC    C'D4F4'                                                          
         DC    C'D5F5'                                                          
         DC    C'D6F6'                                                          
         DC    C'D7F7'                                                          
         DC    C'D8F8'                                                          
         DC    C'D9F9'                                                          
         DC    C'5A7A'                                                          
         DC    C'5B7B'                                                          
         DC    C'5C7C'                                                          
         DC    C'5D7D'                                                          
         DC    C'5E7E'                                                          
         DC    C'5F7F'                                                          
         DC    X'FF'                                                            
         EJECT                                                                  
*ERROR MESSAGES                                                                 
*                                                                               
ERRMSG   DS    0CL40                                                            
         DC    X'0000',CL38'***NETGEN ERROR***  RUN TERMINATED    '             
         DC    X'0100',CL38'MISSING INPUT=CARD/PAN CARD'                        
         DC    X'0200',CL38'INVALID CONTROL CARD'                               
         DC    X'0300',CL38'PAN BOOK NOT IN LIBRARY'                            
*                                                                               
         DC    X'1000',CL38'MISSING OR INVALID OPERAND'                         
         DC    X'1100',CL38'INVALID CONTINUATION CARD'                          
         DC    X'1200',CL38'OPERATOR NOT CNTL/LINE/POLL/TERM'                   
*                                                                               
         DC    X'2000',CL38'MISSING LINE ID'                                    
         DC    X'2100',CL38'DUPLICATE LINE ID'                                  
         DC    X'2200',CL38'INVALID SYSNUM'                                     
         DC    X'2300',CL38'DUPLICATE SYSNUM'                                   
         DC    X'2400',CL38'INVALID DDNAME'                                     
         DC    X'2500',CL38'DUPLICATE DDNAME'                                   
         DC    X'2600',CL38'LINE TYPE NOT MD/PP/MB/PB/LB/TW'                    
         DC    X'2700',CL38'MAXBUFFS NOT 1 THRU 9'                              
         DC    X'2800',CL38'LINE OP NOT YES/NO'                                 
         DC    X'2900',CL38'INVALID BAUD RATE'                                  
         DC    X'2A00',CL38'INVALID LINE CARD OPERAND'                          
         DC    X'2B00',CL38'MISSING SYSNUM'                                     
         DC    X'2C00',CL38'MISSING LINE TYPE'                                  
         DC    X'2D00',CL38'MAXBUFFS N/A FOR TW'                                
         DC    X'2E00',CL38'MAXBUFFS REQUIRED FOR MULTI DROP'                   
         DC    X'2F00',CL38'INVALID ATTRIBUTE LIST'                             
         DC    X'3000',CL38'INVALID COUNTRY CODE'                               
*                                                                               
         DC    X'4000',CL38'LINE ID FOR POLL CARD DIFFERS'                      
         DC    X'4100',CL38'POLL NOT VALID EBCDIC'                              
         DC    X'4200',CL38'POLL OPERAND NOT FOUR CHRS'                         
         DC    X'4300',CL38'BSC POLL NOT EBCDIC'                                
         DC    X'4400',CL38'POLL NOT VALID FOR TWX'                             
         DC    X'4800',CL38'MISSING POLL CARD'                                  
         DC    X'4900',CL38'INVALID POLLING SEQUENCE'                           
*                                                                               
         DC    X'6000',CL38'LINE ID FOR TERM CARD DIFFERS'                      
         DC    X'6100',CL38'BSC TERMINALS NEED EBCDIC ADDRESSES'                
         DC    X'6200',CL38'TERMINAL ADDRESS NOT FOUR HEX CHRS'                 
         DC    X'6300',CL38'TERMINALS CANT HAVE MAJOR ADDRESSES'                
         DC    X'6400',CL38'INVALID PRINTER SPEED'                              
         DC    X'6500',CL38'INVALID BUFFER SIZE'                                
         DC    X'6600',CL38'INVALID QUEUE LENGTH'                               
         DC    X'6700',CL38'INVALID TERM CARD OPERAND'                          
         DC    X'6800',CL38'MISSING ADDRESS OPERAND'                            
         DC    X'6900',CL38'ADDRESS NOT VALID FOR TWX'                          
         DC    X'6A00',CL38'TERM TYPE NOT ICC/CRR/TTY/SR1/327'                  
         DC    X'6B00',CL38'TERM TYPE NOT AVAIL FOR LINE TYPE'                  
         DC    X'6C00',CL38'TERM DEV NOT TRM/PRN/PRT'                           
         DC    X'6D00',CL38'TERM DEV S/B PRT FOR TWX LINE'                      
         DC    X'6E00',CL38'TERM DEV TYPE NOT B/C/L'                            
         DC    X'6F00',CL38'MISSING OFFICE OPERAND'                             
         DC    X'7000',CL38'INVALID ATTRIBUTE LIST'                             
         DC    X'7100',CL38'INVALID COUNTRY CODE'                               
         DC    X'7300',CL38'MISSING TERM CARD'                                  
         DC    X'7400',CL38'TERMINAL NOT COVERED BY POLL'                       
         DC    X'7500',CL38'EVERY POLL MUST HAVE A TERMINAL'                    
*                                                                               
         DC    X'8000',CL38'MISSING BUFFS OPERAND'                              
         DC    X'8100',CL38'INVALID BUFFS OPERAND'                              
         DC    X'8200',CL38'INVALID CNTL CARD OPERAND'                          
*                                                                               
ERRMSGX  DC    X'FF00',CL38'UNSPECIFIED'                                        
         EJECT                                                                  
*LIST OF OUTPUT ROUTINE ADDRESSES                                               
*                                                                               
OUTLIST  DC    0F'0'                                                            
         DC    C'101',X'00',A(OUT101)                                           
         DC    C'105',X'00',A(OUT105)                                           
         DC    C'109',X'00',A(OUT109)                                           
         DC    C'201',X'00',A(OUT201)                                           
         DC    C'205',X'00',A(OUT205)                                           
         DC    C'209',X'00',A(OUT209)                                           
         DC    C'301',X'00',A(OUT301)                                           
         DC    C'305',X'00',A(OUT305)                                           
         DC    C'401',X'00',A(OUT401)                                           
         DC    C'405',X'00',A(OUT405)                                           
         DC    C'409',X'00',A(OUT409)                                           
         DC    C'501',X'00',A(OUT501)                                           
         DC    C'505',X'00',A(OUT505)                                           
         DC    C'509',X'00',A(OUT509)                                           
         DC    C'601',X'00',A(OUT601)                                           
         DC    C'605',X'00',A(OUT605)                                           
         DC    C'609',X'00',A(OUT609)                                           
         DC    C'701',X'00',A(OUT701)                                           
         DC    C'705',X'00',A(OUT705)                                           
         DC    C'801',X'00',A(OUT801)                                           
         DC    C'805',X'00',A(OUT805)                                           
         DC    C'901',X'00',A(OUT901)                                           
         DC    C'905',X'00',A(OUT905)                                           
         DC    C'909',X'00',A(OUT909)                                           
         DC    C'951',X'00',A(OUT951)                                           
         DC    C'955',X'00',A(OUT955)                                           
         DC    C'959',X'00',A(OUT959)                                           
         DC    X'FF'                                                            
         EJECT                                                                  
*UTL CARDS                                                                      
*                                                                               
CARD101  DC    0C' '                                                            
*&&DO*&& DC    CL80'// EXEC PAN#1'                                              
CARD101A DC    CL80'++UPDATE FANET,0,ALL'                                       
         DC    CL80'         TITLE ''FANET  - COMMON CONTROL TABLE'' '          
         DC    CL80'         PRINT NOGEN'                                       
         DC    CL80'FANET    CSECT'                                             
         DC    CL80'         ENTRY UTL'                                         
         DC    CL80'         ENTRY PRQ'                                         
         DC    CL80'         ENTRY DECBLST'                                     
         DC    CL80'         ENTRY ECBLIST'                                     
         DC    CL80'         TITLE ''FANET  - USER TERMINAL LIST'' '            
         DC    CL80'       ++INCLUDE FAUTL'                                     
         DC    CL80'         EJECT '                                            
         DC    CL80'*USER TERMINAL LIST'                                        
         DC    CL80'*'                                                          
         DC    CL80'FANET    CSECT'                                             
         DC    CL80'         CNOP  2,4'                                         
         DC    CL80'UTL      DC    AL2(TUTLLEN)'                                
         DC    CL80'         DC    A(UTLX-1)'                                   
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD109  DC    0C' '                                                            
         DC    CL80'*'                                                          
         DC    CL80'UTLX     EQU   *'                                           
         DC    X'FF'                                                            
         EJECT                                                                  
*PRINT QUEUE CARDS                                                              
*                                                                               
CARD201  DC    0C' '                                                            
         DC    CL80'         TITLE ''FANET  - PRINTER QUEUES'' '                
         DC    CL80'       ++INCLUDE FAPRQ'                                     
         DC    CL80'         EJECT'                                             
         DC    CL80'*PRINTER QUEUES'                                            
         DC    CL80'*'                                                          
         DC    CL80'FANET    CSECT'                                             
         DC    CL80'         CNOP  2,4'                                         
         DC    CL80'PRQ      DC    H''328'' '                                   
         DC    CL80'         DC    A(PRQX-1)'                                   
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD205  DC    0C' '                                                            
         DC    CL80'PQQNNNN  DC    XL188''00'',XL5''00'',AL1(NN),XL2''0X        
               0'',A(LLLLTTTT),NNXL16''00'' '                                   
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD209  DC    0C' '                                                            
         DC    CL80'*'                                                          
         DC    CL80'PRQX     EQU   *'                                           
         DC    X'FF'                                                            
         EJECT                                                                  
*ADDRESS CARDS                                                                  
*                                                                               
CARD301  DC    0C' '                                                            
         DC    CL80'         TITLE ''FANET  - ADDRESSING LISTS'' '              
         DC    CL80'*ADDRESSING LISTS'                                          
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         EJECT                                                                  
*DECB CARDS                                                                     
*                                                                               
CARD401  DC    0C' '                                                            
         DC    CL80'         TITLE ''FANET  - DECBS'' '                         
         DC    CL80'       ++INCLUDE FADECB'                                    
         DC    CL80'         EJECT'                                             
         DC    CL80'*DATA EVENT CONTROL BLOCKS'                                 
         DC    CL80'*'                                                          
         DC    CL80'FANET    CSECT'                                             
         DC    CL80'         CNOP  2,4'                                         
         DC    CL80'DECBLST  DC    H''84'' '                                    
         DC    CL80'         DC    A(DECBLSTX-1)'                               
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD405  DC    0C' '                                                            
         DC    CL40'         FALNE LINE=XXXX,BUFFS=N,TYPE=XX'                   
         DC    CL40',BAUD=02400,OP=XXX,            X        '                   
         DC    CL40'               CTRY=000                 '                   
         DC    CL40'                                        '                   
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD409  DC    0C' '                                                            
         DC    CL80'*'                                                          
         DC    CL80'DECBLSTX EQU   *'                                           
         DC    X'FF'                                                            
         EJECT                                                                  
*POLL CARDS AND ECB CARDS                                                       
*                                                                               
CARD501  DC    0C' '                                                            
         DC    CL80'         TITLE ''FANET  - POLLING LISTS'' '                 
         DC    CL80'*POLLING LISTS'                                             
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD601  DC    0C' '                                                            
         DC    CL80'         TITLE ''FANET  - ECBLIST '' '                      
         DC    CL80'*EVENT CONTROL BLOCK LIST'                                  
         DC    CL80'*'                                                          
         DC    CL80'         DC    F''0'' '                                     
         DC    CL80'ECBLIST  DS    0F'                                          
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD609  DC    0C' '                                                            
         DC    CL80'         ORG   *-4'                                         
         DC    CL80'         DC    X''80'' '                                    
         DC    CL80'         ORG'                                               
         DC    X'FF'                                                            
         EJECT                                                                  
*DTF AND LERB CARDS                                                             
*                                                                               
CARD701  DC    0C' '                                                            
*&&DO*&& DC    CL80'         TITLE ''FANET  - BTAM DTFS'' '                     
*&&OS*&& DC    CL80'         TITLE ''FANET  - BTAM DCBS'' '                     
*&&DO*&& DC    CL80'*BTAM DTFS'                                                 
*&&OS*&& DC    CL80'*BTAM DCBS'                                                 
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD705  DC    0C' '                                                            
*&&DO                                                                           
         DC    C'DTFXXXX  DTFBT LINELST=(NNN),SWITCH=NO,'                       
         DC    C'ERROPT=N,CU=2701,DEVICE=2848'                                  
         DC    CL20' '                                                          
*&&                                                                             
*&&OS                                                                           
         DC    C'DTFXXXX  DCB   DSORG=CX,MACRF=(R,W),DDNAME=LINXXXX'            
         DC    CL30' '                                                          
*&&                                                                             
         ORG   CARD705+80                                                       
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD801  DC    0C' '                                                            
         DC    CL80'         TITLE ''FANET  - LINE ERROR BLOCKS'' '             
         DC    CL80'       ++INCLUDE FALERB'                                    
         DC    CL80'         EJECT '                                            
         DC    CL80'*LINE ERROR BLOCKS'                                         
         DC    CL80'*'                                                          
         DC    CL80'FANET    CSECT '                                            
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         EJECT                                                                  
*BUFFER CARDS                                                                   
*                                                                               
CARD901  DC    0C' '                                                            
         DC    CL80'         TITLE ''FANET  - BUFFER AREAS'' '                  
         DC    CL80'*BUFFER AREAS'                                              
         DC    CL80'*'                                                          
         DC    CL80'BUFFERS  CSECT'                                             
         DC    CL80'         ENTRY BUFFERX'                                     
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD909  DC    0C' '                                                            
         DC    CL80'          EJECT'                                            
         DC    CL80'*MULTI-POLL BUFFERS'                                        
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
CARD9092 DC    0C' '                                                            
         DC    CL80'*'                                                          
         DC    CL80'BUFFERX  EQU   *-1'                                         
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD951  DC    0C' '                                                            
         DC    CL80'         TITLE ''FANET  - MULTI-POLL BUFFERS '' '           
         DC    CL80'*MULTI-POLL BUFFER CONTROL TABLE'                           
         DC    CL80'*'                                                          
         DC    CL80'LCBUFFS  CSECT'                                             
         DC    CL80'         ENTRY LCBUFFX'                                     
         DC    CL80'*'                                                          
         DC    X'FF'                                                            
         SPACE 2                                                                
CARD959  DC    0C' '                                                            
         DC    CL80'*'                                                          
         DC    CL80'LCBUFFX  EQU   *-1'                                         
         DC    CL80'         SPACE 2'                                           
         DC    CL80'         END'                                               
         DC    CL80'/*'                                                         
*&&DO*&& DC    CL80'/&&   '                                                     
*&&DO*&& DC    CL80'CLOSE SYSIN,X''00C'' '                                      
         DC    X'FF'                                                            
         EJECT                                                                  
SPECIAL  DC    0D'0'                                                            
         DC    CL8'101 UTL'                                                     
         DC    CL8'109 UTL'                                                     
         DC    CL8'201 PQ '                                                     
         DC    CL8'209 PQ '                                                     
         DC    CL8'301 ADDR'                                                    
         DC    CL8'309 ADDR'                                                    
         DC    CL8'401 DECB'                                                    
         DC    CL8'409 DECB'                                                    
         DC    CL8'501 POLL'                                                    
         DC    CL8'509 POLL'                                                    
         DC    CL8'601 ECB '                                                    
         DC    CL8'609 ECB '                                                    
         DC    CL8'701 DTF '                                                    
         DC    CL8'709 DTF '                                                    
         DC    CL8'801 LERB'                                                    
         DC    CL8'809 LERB'                                                    
         DC    CL8'901 BUFF'                                                    
         DC    CL8'909 BUFF'                                                    
         DC    CL8'951 LCB'                                                     
         DC    CL8'959 LCB'                                                     
         DC    X'FF'                                                            
         EJECT                                                                  
         DC    0D'0'                                                            
         DC    CL8'CTRYTAB '                                                    
       ++INCLUDE FACTRYTAB                                                      
         EJECT                                                                  
DUMPLIST DS    0A                                                               
         DC    A(NETGEN)                                                        
         DC    V(CARDS)                                                         
         ORG   *-4                                                              
         DC    X'80'                                                            
         ORG                                                                    
         SPACE 1                                                                
         DC    0D'0'                                                            
         DC    CL8'SCANBLCK'                                                    
BLOCK    DC    40XL32'00'                                                       
         SPACE 1                                                                
         DC    0D'0'                                                            
         DC    CL8'REGULAR'                                                     
REGULAR  DC    X'FF'                                                            
         DS    60000C                                                           
         SPACE 1                                                                
         DC    0D'0'                                                            
         DC    CL8'LINEPOOL'                                                    
LINEPOOL DC    512XL12'00'                                                      
         DC    X'FF'                                                            
         SPACE 1                                                                
         DC    0D'0'                                                            
         DC    CL8'POLLPOOL'                                                    
POLLPOOL DC    X'FF'                                                            
         DC    100XL6'00'                                                       
         SPACE 1                                                                
         DC    0D'0'                                                            
         DC    CL8'TERMPOOL'                                                    
TERMPOOL DC    X'FF'                                                            
         DS    256XL48'00'                                                      
         SPACE 1                                                                
         DC    0D'0'                                                            
         DC    CL8'WORKAREA'                                                    
NETWRK   DS    200D                                                             
         SPACE 1                                                                
         DC    0D'0'                                                            
         DC    CL8'SORTAREA'                                                    
SORTAREA DS    48000C                                                           
         EJECT                                                                  
GEND     DSECT                                                                  
GENREC   DS    0CL64                                                            
*                                                                               
GENKEY   DS    0CL20                                                            
GENCODE  DS    CL3                                                              
         DS    CL1                                                              
GENLINE  DS    CL4                                                              
         DS    CL1                                                              
GENADDR  DS    CL4                                                              
         DS    CL1                                                              
GENSEQ   DS    CL5                                                              
         DS    CL1                                                              
*                                                                               
GENDATA  DS    0CL44                                                            
GENSYS   DS    CL3                                                              
         DS    CL1                                                              
GENATTB  DS    0CL8                                                             
GENDD    DS    CL7                                                              
         DS    CL1                                                              
GENTYPE  DS    CL2                                                              
GENTYPE2 DS    CL1                                                              
GENMAX   DS    CL1                                                              
         DS    CL1                                                              
GENOFF   DS    CL4                                                              
         DS    CL1                                                              
GENMAKE  DS    CL3                                                              
         DS    CL1                                                              
GENDEV   DS    CL3                                                              
         DS    CL1                                                              
GENOP    DS    CL1                                                              
         DS    CL1                                                              
GENPOLL  DS    CL4                                                              
         DS    CL1                                                              
GENCTRY  DS    CL3                                                              
         DS    CL4                                                              
         EJECT                                                                  
LINED    DSECT                                                                  
LINREC   DS    0CL48                                                            
LINID    DS    CL4                                                              
LINSYS   DS    CL3                                                              
LINDD    DS    CL7                                                              
LINTYPE  DS    CL2                                                              
LINMAX   DS    CL1                                                              
LINOP    DS    CL1                                                              
LINBAUD  DS    CL5                                                              
LINCTRY  DS    XL1                                                              
         DS    CL24                                                             
         SPACE 2                                                                
TERMD    DSECT                                                                  
TRMREC   DS    0CL48                                                            
TRMADDR  DS    CL4                                                              
TRMOFF   DS    CL4                                                              
TRMTYPE  DS    CL3                                                              
TRMDEV   DS    CL3                                                              
TRMDEV1  DS    CL1                                                              
TRMSPEED DS    CL4                                                              
TRMBUFF  DS    CL4                                                              
TRMQU    DS    XL1                                                              
TRMATTB  DS    CL8                                                              
TRMCTRY  DS    XL1                                                              
         DS    CL15                                                             
         EJECT                                                                  
*FACTRY                                                                         
       ++INCLUDE FACTRY                                                         
         EJECT                                                                  
*DDDPRINT                                                                       
       ++INCLUDE DDDPRINT                                                       
         SPACE 2                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'009FANETGEN  05/01/02'                                      
         END                                                                    
