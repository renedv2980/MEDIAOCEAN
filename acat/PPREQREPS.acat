*          DATA SET PPREQREPS  AT LEVEL 103 AS OF 05/01/02                      
*CATALP PPREQREP                                                                
         TITLE 'CHANGE LOG'                                                     
* SMYE  5/02/97 CHANGE TO PRINT "UNPRINTABLE"  21ST CENTURY YEARS               
* ROSA  2/27/91 ADD NEW REQUEST FIELD "OPTIONS 8-14"               L01          
         TITLE 'MODULE EDITS REQUESTS AND (OPTIONALLY) PRINTS REPORT'           
PPREQREP CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 10,PPREQREP                                                      
         USING REQREPD,RC                                                       
         L     RA,=V(PPWORKC)      PARAMETER 1 RETURNED BY MODULE               
         USING PPWORKD,RA                      0=REQUEST OK                     
         L     R8,PPWORK2C                                                      
         USING PPWORK2D,R8                                                      
         MVC   ADICTATE,DICTATE                                                 
         DROP  R8                                                               
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,4                                                          
         MVC   DDLANG,RCLANG                                                    
         LA    RF,DCLIST                                                        
         STCM  RF,7,DDIADR                                                      
         LA    RF,DSLIST                                                        
         STCM  RF,7,DDOADR                                                      
         GOTO1 ADICTATE                                                         
*                                              1=REQUEST ERROR                  
         LR    R2,R1                                                            
         XC    0(4,R2),0(R2)                                                    
         MVC   PRSWITCH,RCREQREP                                                
         L     R4,=V(BOXAREA)                                                   
         LTR   R4,R4                                                            
         BZ    *+8                                                              
         USING BOXD,R4                                                          
         MVI   BOXOFF,C'Y'                                                      
*                                                                               
         MVI   RQFLTRSW,C'N'                                                    
         CLI   QEST,C'0'                                                        
         BNL   HEADS                                                            
         CLC   QESTEND(3),SPACES                                                
         BE    HEADS                                                            
         MVI   RQFLTRSW,C'Y'                                                    
*                                                                               
         EJECT                                                                  
*                   PRINT SOME MINIMAL HEADLINES                                
         SPACE 3                                                                
HEADS    LA    R8,REQTAB                                                        
         LA    R9,29               NUMBER OF ENTRIES IN TABLE                   
         MVC   5(20,R8),=CL20' '   CLEAR TABLE ENTRIES                          
         LA    R8,25(R8)           BUMP TO NEXT ENTRY                           
         BCT   R9,*-10                                                          
*                                                                               
         LA    R8,REQTAB                                                        
         MVC   5(L'PP@MED,R8),PP@MED                                            
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@CLI,R8),PP@CLI                                            
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@DIV,R8),PP@DIV                                            
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@PRO,R8),PP@PRO                                            
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@REGN,R8),PP@REGN                                          
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@DIST,R8),PP@DIST                                          
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@ESTM,R8),PP@ESTM                                          
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@SCEST,R8),PP@SCEST                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@PUBL,R8),PP@PUBL                                          
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@ZONE,R8),PP@ZONE                                          
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@EDIT,R8),PP@EDIT                                          
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@STDAT,R8),PP@STDAT                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@ENDAT,R8),PP@ENDAT                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@BPDFT,R8),PP@BPDFT                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@SMENU,R8),PP@SMENU                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@BMODE,R8),PP@BMODE                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@CLFLT,R8),PP@CLFLT                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@FQFLT,R8),PP@FQFLT                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@OPTNS,R8),PP@OPTNS                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@RQNAM,R8),PP@RQNAM                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@ADNO,R8),PP@ADNO                                          
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@COMNO,R8),PP@COMNO                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@CNTNO,R8),PP@CNTNO                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@ASCDT,R8),PP@ASCDT                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@ASCDT,R8),PP@ASCDT                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@CURMO,R8),PP@CURMO                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@CODAT,R8),PP@CODAT                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@UPCOD,R8),PP@UPCOD                                        
         LA    R8,25(R8)                                                        
         MVC   5(L'PP@PUBL,R8),PP@PUBL                                          
         LA    R8,25(R8)                                           L01          
         MVC   5(L'PP@OPTN2,R8),PP@OPTN2 OPTIONS 8-14              L01          
*                                                                               
         CLI   PRSWITCH,C'Y'                                                    
         BNE   VALIDATE                                                         
         MVC   P,SPACES                                                         
         MVC   PSECOND,SPACES                                                   
         GOTO1 PRINT,RQWORK,P,=C'BC01'                                          
         MVC   P+24(L'PP@RUNON),PP@RUNON                                        
         MVC   P+31(8),RCDATE                                                   
         PACK  RQDUB,RCDATE(2)                                                  
         CVB   R3,RQDUB                                                         
         BCTR  R3,R0                                                            
         MH    R3,=H'3'                                                         
         LA    R3,MONTHS(R3)                                                    
         MVC   P+31(3),0(R3)                                                    
         MVC   P+45(L'PP@DTREQ),PP@DTREQ                                        
         MVC   P+69(L'PP@REQNN),PP@REQNN                                        
         EDIT  RCRQTOT,(3,P+77)                                                 
         BAS   RE,PRINT1                                                        
         MVC   P+45(L'PPUDTREQ),PPUDTREQ                                        
         CLI   PP@DTREQ+18,C' '                                                 
         BNE   *+10                                                             
         MVC   P+45+18(4),SPACES                                                
         MVC   P+28(L'PP@AT),PP@AT                                              
*                                                                               
         TIME  DEC                                                              
         LR    R1,R0                                                            
         SRL   R1,8                SHIFT OUT 10'S AND 100'S                     
         SLL   R1,4                ROOM FOR SIGN                                
         AH    R1,=H'12'           MAKE POSITIVE                                
*                                                                               
         XC    RQDUB,RQDUB                                                      
         ST    R1,RQWORK                                                        
         MVC   RQDUB+5(3),RQWORK                                                
         OI    RQDUB+7,X'0F'                                                    
         CVB   R3,RQDUB                                                         
         EDIT  (R3),(5,P+31),2,DUB=RQDUB,WRK=RQWORK                             
         BAS   RE,PRINT3                                                        
         SPACE 2                                                                
         MVC   P+24(L'PP@REQFD),PP@REQFD                                        
         MVC   P+45(L'PP@DATA),PP@DATA                                          
         MVC   P+69(L'PP@ERROR),PP@ERROR                                        
         BAS   RE,PRINT1                                                        
         MVC   P+24(L'PPUREQFD),PPUREQFD                                        
         CLI   PP@REQFD+13,C' '                                                 
         BNE   *+10                                                             
         MVC   P+24+13(5),SPACES                                                
         MVC   P+45(L'PPUDATA),PPUDATA                                          
         CLI   PP@DATA+4,C' '                                                   
         BNE   *+10                                                             
         MVC   P+45+4(2),SPACES                                                 
         MVC   P+69(L'PPUERROR),PPUERROR                                        
         BAS   RE,PRINT3                                                        
         EJECT                                                                  
*                   LOOP THROUGH TABLE AND HANDLE REQUESTS                      
         SPACE 3                                                                
VALIDATE DS    0H                                                               
         L     R6,PPSPECS                                                       
         SR    R4,R4                                                            
VAL2     DS    0H                                                               
         CLI   0(R6),0             END OF SPECS                                 
         BE    VAL4                                                             
         IC    R4,1(R6)                                                         
         AR    R6,R4                                                            
         B     VAL2                                                             
VAL4     DS    0H                                                               
         CLC   =C'REQLST=',1(R6)                                                
         LA    R6,8(R6)                                                         
         BE    VAL6                                                             
*                                                                               
         LA    R6,REQLST           DEFAULT                                      
*                                                                               
VAL6     DS    0H                                                               
         SR    R7,R7               USED FOR USER SPECIALS                       
         SPACE 2                                                                
LOOP     DS    0H                                                               
         CLI   0(R6),0             END                                          
         BNE   LOOP2                                                            
*                                  DO ANY USER SPECIALS                         
         LTR   R7,R7                                                            
         BNZ   LOOP1B                                                           
         LA    R7,1(R6)                                                         
         B     LOOP1D                                                           
LOOP1B   DS    0H                                                               
         LA    R7,25(R7)                                                        
LOOP1D   DS    0H                                                               
         CLI   0(R7),0                                                          
         BE    LOOPX                                                            
         LR    R3,R7                                                            
         B     LOOP2A                                                           
*                                                                               
LOOPX    DS    0H               END  - SO PRINT 80 COL CARD IMAGES              
         CLI   PRSWITCH,C'Y'    SEE IF PRINTING DETAILS OF REQUEST              
         BNE   LOOPXX                                                           
*                                                                               
         BAS   RE,PRINT1        SKIP A LINE                                     
         MVC   P(14),=C'COLUMN NUMBERS'                                         
         MVC   P+23(80),COLS                                                    
         BAS   RE,PRINT1                                                        
         MVC   P(20),=C'REQUEST CARD 1 IMAGE'                                   
         MVC   P+23(80),QRECORD                                                 
         MVC   BYTE,QRECORD+37     POSSIBLE START DATE                          
         CLI   BYTE,C'9'           21ST CENTURY DATE ?                          
         BNH   LOOPX5              NO                                           
         MVI   P+60,C'0'                 AND TEST FOR REPLACEMENT               
         CLI   BYTE,X'FA'                                                       
         BE    LOOPX5                                                           
         MVI   P+60,C'1'                                                        
         CLI   BYTE,X'FB'                                                       
         BE    LOOPX5                                                           
         MVI   P+60,C'2'                                                        
         CLI   BYTE,X'FC'                                                       
         BE    LOOPX5                                                           
         MVI   P+60,C'3'                                                        
         CLI   BYTE,X'FD'                                                       
         BE    LOOPX5                                                           
         MVI   P+60,C'4'                                                        
         CLI   BYTE,X'FE'                                                       
         BE    LOOPX5                                                           
         MVI   P+60,C'5'           "YEAR" MUST BE X'FF'                         
LOOPX5   MVC   BYTE,QRECORD+43     POSSIBLE END DATE                            
         CLI   BYTE,C'9'           21ST CENTURY DATE ?                          
         BNH   LOOPX10             NO                                           
         MVI   P+66,C'0'                 AND TEST FOR REPLACEMENT               
         CLI   BYTE,X'FA'                                                       
         BE    LOOPX10                                                          
         MVI   P+66,C'1'                                                        
         CLI   BYTE,X'FB'                                                       
         BE    LOOPX10                                                          
         MVI   P+66,C'2'                                                        
         CLI   BYTE,X'FC'                                                       
         BE    LOOPX10                                                          
         MVI   P+66,C'3'                                                        
         CLI   BYTE,X'FD'                                                       
         BE    LOOPX10                                                          
         MVI   P+66,C'4'                                                        
         CLI   BYTE,X'FE'                                                       
         BE    LOOPX10                                                          
         MVI   P+66,C'5'           "YEAR" MUST BE X'FF'                         
LOOPX10  BAS   RE,PRINT2                                                        
*                                                                               
         L     RF,PPWORK2C                                                      
         USING PPWORK2D,RF                                                      
         CLC   QAREA2,SPACES                                                    
         BE    LOOPXX                                                           
         MVC   P(20),=C'REQUEST CARD 2 IMAGE'                                   
         MVC   P+23(80),QAREA2                                                  
         BAS   RE,PRINT2                                                        
*                                                                               
         DROP  RF                                                               
*                                                                               
LOOPXX   B     EXIT                                                             
*                                                                               
COLS     DC    CL40'1...5...10...15...20...25...30...35...40'                   
         DC    CL40'...45...50...55...60...65...70...75...80'                   
*                                                                               
EXIT     L     R4,=V(BOXAREA)                                                   
         LTR   R4,R4                                                            
         BZ    *+8                                                              
         USING BOXD,R4                                                          
         MVI   BOXOFF,C'N'                                                      
         XMOD1 1                                                                
         SPACE 2                                                                
LOOP2    DS    0H                                                               
         SR    R3,R3                                                            
         IC    R3,0(R6)                                                         
         MH    R3,=H'25'                                                        
         LA    R3,REQTAB-25(R3)                                                 
LOOP2A   DS    0H                                                               
*                                  A0-A9 MEANS COLS 100-109                     
*                                  B0-B9 MEANS COLS 110-119                     
*                              ETC....                                          
         CLI   0(R3),C'0'          SEE IF STARTS WITH A-F                       
         BNL   LOOP2A4                                                          
         MVC   DUB(2),0(R3)                                                     
         MVI   DUB,C'0'                                                         
         PACK  RQDUB,DUB(2)                                                     
         CVB   R4,RQDUB                                                         
         LH    RF,=H'100'                                                       
         CLI   0(R3),C'A'                                                       
         BE    LOOP2A3                                                          
         LH    RF,=H'110'                                                       
         CLI   0(R3),C'B'                                                       
         BE    LOOP2A3                                                          
         LH    RF,=H'120'                                                       
         CLI   0(R3),C'C'                                                       
         BE    LOOP2A3                                                          
         LH    RF,=H'130'                                                       
         CLI   0(R3),C'D'                                                       
         BE    LOOP2A3                                                          
         LH    RF,=H'140'                                                       
         CLI   0(R3),C'E'                                                       
         BE    LOOP2A3                                                          
         LH    RF,=H'150'                                                       
         CLI   0(R3),C'F'                                                       
         BE    LOOP2A3                                                          
*                                 OTHER LETTERS ARE INVALID                     
*                                 DON'T BLOW -UP JUST USE 150                   
*                                                                               
LOOP2A3  AR    R4,RF                                                            
         B     LOOP2A5                                                          
*                                                                               
LOOP2A4  DS    0H                                                               
         PACK  RQDUB,0(2,R3)       GET ADDRESS AND LENGTH OF FIELD              
         CVB   R4,RQDUB                                                         
*                                                                               
LOOP2A5  CH    R4,=H'80'            SEE IF ON 2ND CARD                          
         BNH   LOOP2A6                                                          
         SH    R4,=H'80'                                                        
         L     RF,PPWORK2C                                                      
         USING PPWORK2D,RF                                                      
         LA    R4,QAREA2-1(R4)                                                  
         B     LOOP2A7                                                          
*                                                                               
         DROP  RF                                                               
*                                                                               
LOOP2A6  LA    R4,QRECORD-1(R4)                                                 
LOOP2A7  PACK  RQDUB,2(2,R3)                                                    
         CVB   R5,RQDUB                                                         
         BCTR  R5,R0                                                            
         EX    R5,SPACOMP                                                       
         BE    LOOP8                                                            
         CLI   4(R3),C'B'                                                       
         BNE   LOOP3                                                            
*                                  BINARY NUMBER                                
         CLI   PRSWITCH,C'Y'                                                    
         BNE   LOOP8                                                            
         XC    RQDUB,RQDUB                                                      
         LA    RF,3                                                             
         SR    RF,R5                                                            
         LA    RF,RQDUB(RF)                                                     
         EX    R5,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RF),0(R4)                                                    
*                                                                               
         L     RE,RQDUB                                                         
         CLI   3(R3),C'1'          1 BYTE OK                                    
         BE    LOOP2B                                                           
         NI    0(RF),X'7F'                                                      
         L     RE,RQDUB                                                         
         TM    0(R4),X'80'         ELSE TEST FOR MINUS                          
         BZ    *+6                                                              
         LCR   RE,RE                                                            
LOOP2B   DS    0H                                                               
         CVD   RE,RQDUB                                                         
         OI    RQDUB+7,X'0F'                                                    
         UNPK  P+45(12),RQDUB                                                   
         B     LOOP6B                                                           
*                                                                               
LOOP3    DS    0H                                                               
         CLI   4(R3),C'N'          NUMERIC TESTS                                
         BNE   LOOP4                                                            
         CLC   0(3,R4),=C'ALL'     AND SO IS ALL                                
         BE    LOOP6                                                            
         MVC   RQWORK(8),=8X'F0'                                                
         EX    R5,MUVZONES                                                      
         CLC   RQWORK(8),=8X'F0'                                                
         BE    LOOP6                                                            
         CLI   PRSWITCH,C'Y'                                                    
         BNE   ERRET                                                            
         MVC   P+69(L'PP@FDNNM),PP@FDNNM                                        
         MVI   3(R2),1                                                          
         B     LOOP6                                                            
         SPACE 2                                                                
ERRET    MVI   PRSWITCH,C'Y'                                                    
         B     VALIDATE                                                         
         SPACE 2                                                                
SPACOMP  CLC   0(0,R4),SPACES                                                   
MUVZONES MVZ   RQWORK(0),0(R4)                                                  
MUVFIELD MVC   P+45(0),0(R4)                                                    
         SPACE 2                                                                
LOOP4    CLI   4(R3),C'D'          DATE TESTS                                   
         BNE   LOOP6                                                            
         CLI   3(R3),C'6'                                                       
         BNE   LOOP4B                                                           
         CLC   0(2,R4),=C'ES'                                                   
         BE    LOOP6                                                            
         CLC   0(6,R4),SPACES      SET IF I HAVE ANY DATA                       
         BE    LOOP6                                                            
*                                                                               
         MVC   DATE,0(R4)                                                       
         CLC   DATE+4(2),SPACES    SEE IF I HAVE A DAY                          
         BNE   *+10                                                             
         MVC   DATE+4(2),=C'01'    IF MISSING SET DAY TO 01                     
*                                                                               
         GOTO1 GETDAY,RQWORK,DATE,RQDUB                                         
         CLC   RQDUB(3),SPACES                                                  
         BNE   LOOP6                                                            
         CLI   PRSWITCH,C'Y'                                                    
         BNE   ERRET                                                            
         MVC   P+69(L'PP@NVDAT),PP@NVDAT                                        
         MVI   3(R2),1                                                          
         B     LOOP6                                                            
*                                                                               
LOOP4B   DS    0H                                                               
         CLI   PRSWITCH,C'Y'                                                    
         BNE   LOOP8                                                            
         MVC   BYTE,3(R3)          BINARY DATE TYPE                             
         NI    BYTE,X'0F'                                                       
*****    GOTO1 DATCON,RQWORK,(BYTE,(R4)),P+45                                   
         GOTO1 DATCON,RQWORK,(BYTE,(R4)),(X'20',P+45)                           
         B     LOOP6B                                                           
*                                                                               
         SPACE 2                                                                
LOOP6    CLI   PRSWITCH,C'Y'       ONLY PRINT IF OPTION ON                      
         BNE   LOOP8                                                            
         EX    R5,MUVFIELD                                                      
         CLI   4(R3),C'D'          DATE TESTS                                   
         BNE   LOOP6B                                                           
         CLI   3(R3),C'6'                                                       
         BNE   LOOP6B                                                           
         CLI   P+45,C'9'           21ST CENTURY ?                               
         BNH   LOOP6B              NO                                           
         MVC   BYTE,P+45           YES - SAVE FIRST POSITION OF YEAR            
         MVI   P+45,C'0'                 AND TEST FOR REPLACEMENT               
         CLI   BYTE,X'FA'                                                       
         BE    LOOP6B                                                           
         MVI   P+45,C'1'                                                        
         CLI   BYTE,X'FB'                                                       
         BE    LOOP6B                                                           
         MVI   P+45,C'2'                                                        
         CLI   BYTE,X'FC'                                                       
         BE    LOOP6B                                                           
         MVI   P+45,C'3'                                                        
         CLI   BYTE,X'FD'                                                       
         BE    LOOP6B                                                           
         MVI   P+45,C'4'                                                        
         CLI   BYTE,X'FE'                                                       
         BE    LOOP6B                                                           
         MVI   P+45,C'5'           "YEAR" MUST BE X'FF'                         
LOOP6B   DS    0H                                                               
         MVC   P+24(20),5(R3)                                                   
*****                                                                           
         CLC   =C'2711',0(R3)        IS IT PUB FIELD (COLUMN 27)                
         BNE   LOOP6P                                                           
         CLI   QPUB,C' '                                                        
         BNE   LOOP7X                                                           
*                                                                               
         MVC   P+24(20),SPACES                                                  
         MVC   P+45(11),SPACES                                                  
         CLI   QPUB+1,C'J'                                                      
         BNE   LOOP6D                                                           
         MVC   P+24(L'PP@ADCOD),PP@ADCOD                                        
         MVC   P+45(6),QPUB+2                                                   
         B     LOOP7X                                                           
LOOP6D   CLC   QPUB+1(3),=C'RD='                                                
         BNE   LOOP6F                                                           
         MVC   P+24(11),=C'REG/DST CLT'                                         
         MVC   P+24(L'PP@REGDT),PP@REGDT                                        
         MVC   P+32(L'PP@CLT),PP@CLT                                            
         MVC   P+45(3),QPUB+4                                                   
         B     LOOP6H                                                           
*                                                                               
LOOP6F   MVC   P+24(L'PP@INVOC),PP@INVOC                                        
         MVC   P+32(L'PP@DATE),PP@DATE                                          
         MVC   P+45(6),QPUB+1                                                   
LOOP6H   CLC   QPUB+7(2),=C'  '                                                 
         BE    LOOP7X                                                           
         BAS   RE,PRINT2                                                        
         MVC   P+24(L'PP@DUE),PP@DUE                                            
         MVC   P+28(L'PP@DAY),PP@DAY                                            
         MVC   P+45(2),QPUB+7                                                   
         B     LOOP7X                                                           
*                                                                               
*****                                                                           
LOOP6P   CLC   =C'2403',0(R3)      PROCESSING QESTEND                           
         BNE   LOOP7X              NO                                           
         CLI   RQFLTRSW,C'Y'       TEST FILTERING                               
         BNE   LOOP7X              NO                                           
         MVC   P+24(16),SPACES                                                  
         MVC   P+24(L'PP@EST01),PP@EST01                                        
*                                                                               
         MVC   P+45(5),SPACES                                                   
         LA    RE,QESTEND                                                       
         LA    RF,P+45                                                          
         LA    R0,3                                                             
*                                                                               
LOOPFLT2 TM    0(RE),X'40'         TEST NEGATIVE FILTER                         
         BO    *+12                NO                                           
         MVI   0(RF),C'-'                                                       
         LA    RF,1(RF)                                                         
*                                                                               
         MVC   0(1,RF),0(RE)                                                    
         OI    0(RF),C' '          INSURE UPPER CASE                            
         LA    RE,1(RE)            NEXT FILTER CHAR                             
         LA    RF,2(RF)            SPACE BETWEEN OUTPUT CHARS                   
         BCT   R0,LOOPFLT2                                                      
*                                                                               
         SPACE 2                                                                
LOOP7X   DS    0H                                                               
         BAS   RE,PRINT2                                                        
         SPACE 2                                                                
LOOP8    DS    0H                                                               
         CLI   0(R6),0             ALREADY AT END                               
         BE    LOOP                                                             
         LA    R6,1(R6)                                                         
         B     LOOP                                                             
         EJECT                                                                  
*                   TABLE OF REQUEST FIELDS                                     
         SPACE 3                                                                
REQTAB   DS    0CL25                                                            
         DC    CL25'0501AMEDIA'                  01                             
         DC    CL25'0603ACLIENT'                 02                             
         DC    CL25'0903NDIVISION'               03                             
         DC    CL25'1203APRODUCT'                04                             
         DC    CL25'1503AREGION'                 05                             
         DC    CL25'1803ADISTRICT'               06                             
         DC    CL25'2103AESTIMATE'               07                             
         DC    CL25'2403ASECOND ESTIMATE'        08                             
         DC    CL25'2708APUBLICATION'            09                             
         DC    CL25'3502AZONE'                   10   X'0A'                     
         DC    CL25'3701AEDITION'                11   X'0B'                     
         DC    CL25'3806DSTART DATE'             12   X'0C'                     
         DC    CL25'4406DEND DATE'               13   X'0D'                     
         DC    CL25'5001ABILL/PAY DATE FILTER'   14   X'0E'                     
         DC    CL25'5102ASORT MENU'              15   X'0F'                     
         DC    CL25'5701ABILLING MODE'           16   X'10'                     
         DC    CL25'5802ACLASS FILTER'           17   X'11'                     
         DC    CL25'6001AFREQUENCY FILTER'       18   X'12'                     
         DC    CL25'6207AOPTIONS'                19   X'13'                     
         DC    CL25'6912AREQUESTOR NAME'         20   X'14'                     
         DC    CL25'1505AAD NO.'                 21   X'15'                     
         DC    CL25'A106ACOMMENT NO.'            22   X'16'                     
*                                 A1 = COL 101 = COL 21 CARD 2                  
         DC    CL25'2103NCONTRACT NUMBER'         23  X'17'                     
         DC    CL25'1506D''AS OF'' CONTROL DATE'  24  X'18'                     
         DC    CL25'5306D''AS OF'' CONTROL DATE'  25  X'19'                     
         DC    CL25'5304ACURRENT MONTH'           26  X'1A'                     
         DC    CL25'1506DCUT-OFF DATE'            27  X'1B'                     
         DC    CL25'5304AUSERP CODE'              28  X'1C'                     
         DC    CL25'2711APUBLICATION'             29  X'1D'                     
         DC    CL25'E207AOPTIONS 8-14'            30  X'1E'        L01          
*                   ^^---> COL 142 (WHERE E= 14 2=2)  SECOND REQ CARD           
*                     ^^--> 07 = LENGTH OF MOVE FROM 142                        
*                       ^--> CHARACTERISTIC A=ALPHA D=DATE N=NUMBER             
         DC    C'END'                                                           
*                                                                               
REQLST   DC    X'0102030405060708090A0B0C0D0E0F13140000'                        
         EJECT                                                                  
*                   PRINTING AIDS                                               
         SPACE 2                                                                
PRINT1   MVC   RQCON,=C'BL01'                                                   
         B     GOPRINT                                                          
         SPACE 2                                                                
PRINT2   MVC   RQCON,=C'BL02'                                                   
         B     GOPRINT                                                          
         SPACE 2                                                                
PRINT3   MVC   RQCON,=C'BL03'                                                   
         B     GOPRINT                                                          
         SPACE 2                                                                
GOPRINT  NTR                                                                    
         GOTO1 PRINT,RQWORK,P,RQCON                                             
         MVC   P,SPACES                                                         
         XIT                                                                    
         EJECT                                                                  
         LTORG                                                                  
*                   DSECT FOR MODULE                                            
         SPACE 3                                                                
ADICTATE DS    V                                                                
DCLIST   DS    0C                                                               
         DCDDL PP#RUNON,6                                                       
         DCDDL PP#DTREQ,22                                                      
         DCDDL PP#DTREQ,22,LU,LABEL=PPUDTREQ                                    
         DCDDL PP#REQNN,11                                                      
         DCDDL PP#AT,2                                                          
         DCDDL PP#REQFD,18                                                      
         DCDDL PP#REQFD,18,LU,LABEL=PPUREQFD                                    
         DCDDL PP#DATA,6                                                        
         DCDDL PP#DATA,6,LU,LABEL=PPUDATA                                       
         DCDDL PP#ERROR,6                                                       
         DCDDL PP#ERROR,6,LU,LABEL=PPUERROR                                     
         DCDDL PP#FDNNM,17                                                      
         DCDDL PP#NVDAT,16                                                      
         DCDDL PP#ADCOD,7                                                       
         DCDDL PP#REGDT,7                                                       
         DCDDL PP#CLT,3                                                         
         DCDDL PP#INVOC,7                                                       
         DCDDL PP#DATE,4                                                        
         DCDDL PP#DUE,3                                                         
         DCDDL PP#DAY,4                                                         
         DCDDL PP#EST01,16                                                      
         DCDDL PP#ESTM,8                                                        
         DCDDL PP#MED,5                                                         
         DCDDL PP#CLI,6                                                         
         DCDDL PP#DIV,8                                                         
         DCDDL PP#PRO,7                                                         
         DCDDL PP#REGN,6                                                        
         DCDDL PP#DIST,8                                                        
         DCDDL PP#SCEST,15                                                      
         DCDDL PP#PUBL,11                                                       
         DCDDL PP#ZONE,4                                                        
         DCDDL PP#EDIT,7                                                        
         DCDDL PP#STDAT,14                                                      
         DCDDL PP#ENDAT,11                                                      
         DCDDL PP#BPDFT,20                                                      
         DCDDL PP#SMENU,9                                                       
         DCDDL PP#BMODE,12                                                      
         DCDDL PP#CLFLT,12                                                      
         DCDDL PP#FQFLT,16                                                      
         DCDDL PP#OPTNS,7                                                       
         DCDDL PP#RQNAM,14                                                      
         DCDDL PP#ADNO,6                                                        
         DCDDL PP#COMNO,14                                                      
         DCDDL PP#CNTNO,15                                                      
         DCDDL PP#ASCDT,20                                                      
         DCDDL PP#CURMO,13                                                      
         DCDDL PP#CODAT,12                                                      
         DCDDL PP#UPCOD,10                                                      
         DCDDL PP#OPTN2,12                                         L01          
DCLISTX  DC    X'00'                                                            
*                                                                               
DSLIST   DS    0C                                                               
         DSDDL PRINT=YES                                                        
         PRINT GEN                                                              
DSLISTX  EQU   *                                                                
         SPACE 3                                                                
REQREPD  DSECT                                                                  
RQDUB    DS    D                                                                
RQWORK   DS    CL24                                                             
PRSWITCH DS    CL1                                                              
RQCON    DS    CL4                                                              
DATE     DS    CL6                                                              
RQFLTRSW DS    C                                                                
       ++INCLUDE PPREPWORK                                                      
       ++INCLUDE DDBIGBOX                                                       
       ++INCLUDE PPDDEQUS                                                       
       ++INCLUDE PPREPWORK2                                                     
       ++INCLUDE DDDICTATED                                                     
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'103PPREQREPS 05/01/02'                                      
         END                                                                    
