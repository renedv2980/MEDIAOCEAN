*          DATA SET NENETACCN  AT LEVEL 014 AS OF 05/08/13                      
*CATALP NETACCN                                                                 
         TITLE 'NETACCN - ROUTINE TO RETURN ACCOUNTING VALUES'                  
*****************************************************************               
* LEVEL 12 - REMOVED OLD STARRED OUT CODE                                       
* LEVEL 12 - ADDED CODE TO SKIP X'03' MIDAS ELEMENTS                            
*****************************************************************               
NETACC   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 WRKLENE,**ACGN**,RA                                              
         USING NETACCD,RC                                                       
         ZIC   RF,0(R1)            PARAMETER 1 1   ROUTINE NUMBER               
         L     R3,0(R1)                        2-4 A(9-BYTE OUTPUT)             
         L     R9,4(R1)            PARAMETER 2 1-4 A(NETBLOCK)                  
         MVC   ADJPCT,8(R1)        PARAMETER 3 1   DECIMALS (DEFAULT=2)         
*                                              2-4 A(FULL ADJUSTMENT)           
         USING NETBLOCK,R9                                                      
         MVI   MASKBYTE,0                                                       
         MVC   DATADISP,=H'27'     IS NOT SET  SOMETIMES ??                     
         SR    R1,R1               R1=CURRENT VALUE                             
         LTR   RF,RF               PROTECT V BAD ROUTINE NUMBER                 
         BZ    END                                                              
****     CH    RF,=H'210'          WHAT THE F****?                              
****     BH    END                                                              
         EJECT                                                                  
*              BRANCH TO APPROPRIATE ROUTINE                                    
         SPACE 3                                                                
         BCTR  RF,0                                                             
         SLL   RF,2                                                             
         B     BRANCH(RF)                                                       
         SPACE 1                                                                
BRANCH   DS    0F                                                               
*                                  GENERAL VALUES                               
         B     ASS                 01 ASSIGNED                                  
         B     ASSPLUS             02 ASSIGNED + INTEGRATION                    
         B     ACT                 03 ACTUAL                                    
         B     ACTPLUS             04 ACTUAL + INTEGRATION                      
         B     GROSS               05 GROSS (ACTUAL)                            
         B     DIFF                06 DIFFERENCE (ASS-ACT)                      
         B     INT                 07 INTEGRATION                               
         B     CUTIN               08 CUTIN                                     
         B     TOTAL               09 TOTAL GROSS                               
         B     TOTNET              10 TOTAL NET                                 
         B     END                 11 LIST (NO VALUES)                          
         B     COMM                12 COMMISSION                                
         B     NET                 13 NET                                       
         B     NETTOT              14 NETTOT (NET (ACT+INT))                    
         B     PAID                15 CLEARED/PAID  (TIME+INT)                  
         B     PAYABLE             16 UNCLEARED/PAYABLE                         
         B     BILLED              17 BILLED                                    
         B     BILLABLE            18 BILLABLE/UNBILLED                         
         B     NINT                19 INTEGRATION NET                           
         B     TOTAL               20 TOTAL GROSS                               
         SPACE 1                                                                
*                                  ORDERED VALUES                               
         B     ORDRTG              21 ORDERED TIME GROSS                        
         B     ORDRIG              22 ORDERED INTEGRATION GROSS                 
         B     ORDRSG              23 ORDERED SPECIAL GROSS                     
         B     ORDRUG              24 ORDERED CUT-IN GROSS                      
         B     ORDRBG              25 ORDERED BLACKOUT GROSS                    
         B     ORDRPG              26 ORDERED COPY-SPLIT GROSS                  
         B     ORDROG              27 ORDERED OTHER GROSS                       
         B     ORDTIS              28 TIME+INTEG+SPECIAL                        
         B     ORDRLTE             29 ORDERED LATE GROSS                        
         B     ORDRTOTG            30 ORDERED TOTAL GROSS                       
         SPACE 1                                                                
         B     ORDRTN              31 ORDERED TIME NET                          
         B     ORDRIN              32 ORDERED INTEGRATION NET                   
         B     ORDRSN              33 ORDERED SPECIAL NET                       
         B     ORDRUN              34 ORDERED CUT-IN NET                        
         B     ORDRBN              35 ORDERED BLACKOUT NET                      
         B     ORDRPN              36 ORDERED COPY-SPLIT NET                    
         B     ORDRON              37 ORDERED OTHER NET                         
         B     ORDTISN             38 ORDERED TIME+INTEG+SPECIAL NET            
         B     ORDRLTN             39 ORDERED LATE NET                          
         B     ORDRTOTN            40 ORDERED TOTAL NET                         
         SPACE 1                                                                
*                                  PAID VALUES                                  
         B     PAIDTG              41 PAID TIME GROSS                           
         B     PAIDIG              42 PAID INTEGRATION GROSS                    
         B     PAIDSG              43 PAID SPECIAL GROSS                        
         B     PAIDUG              44 PAID CUT-IN GROSS                         
         B     PAIDBG              45 PAID BLACKOUT GROSS                       
         B     PAIDPG              46 PAID COPY-SPLIT GROSS                     
         B     PAIDOG              47 PAID OTHER GROSS                          
         B     PAIDTIS             48 PAID TIME/INTEG/SPECIAL                   
         B     PAIDLG              49 PAID LATE GROSS                           
         B     PAIDTOTG            50 PAID TOTAL GROSS                          
         SPACE 1                                                                
         B     PAIDTN              51 PAID TIME NET                             
         B     PAIDIN              52 PAID INTEGRATION NET                      
         B     PAIDSN              53 PAID SPECIAL NET                          
         B     PAIDUN              54 PAID CUT-IN NET                           
         B     PAIDBN              55 PAID BLACKOUT NET                         
         B     PAIDPN              56 PAID COPY-SPLIT NET                       
         B     PAIDON              57 PAID OTHER NET                            
         B     PAIDTISN            58 PAID TIME/INTEG/SPECNET                   
         B     PAIDLN              59 PAID LATE NET                             
         B     PAIDTOTN            60 PAID TOTAL NET                            
         SPACE 1                                                                
*                                  PAYABLE VALUES                               
         B     PABLTG              61 PAYABLE TIME GROSS                        
         B     PABLIG              62 PAYABLE INTEGRATION GROSS                 
         B     PABLSG              63 PAYABLE SPECIAL GROSS                     
         B     PABLUG              64 PAYABLE CUT-IN GROSS                      
         B     PABLBG              65 PAYABLE BLACKOUT GROSS                    
         B     PABLPG              66 PAYABLE COPY-SPLIT GROSS                  
         B     PABLOG              67 PAYABLE OTHER GROSS                       
         B     PABLASG             68 PAYABLE ASSIGNED GROSS                    
         B     PABLASIN            69 PAYABLE ASSIGN+INT NET                    
         B     PABLTOTG            70 PAYABLE TOTAL GROSS                       
         SPACE 1                                                                
         B     PABLTN              71 PAYABLE TIME NET                          
         B     PABLIN              72 PAYABLE INTEGRATION NET                   
         B     PABLSN              73 PAYABLE SPECIAL NET                       
         B     PABLUN              74 PAYABLE CUT-IN NET                        
         B     PABLBN              75 PAYABLE BLACKOUT NET                      
         B     PABLPN              76 PAYABLE COPY-SPLIT NET                    
         B     PABLON              77 PAYABLE OTHER NET                         
         B     PABLASN             78 PAYABLE ASSIGNED NET                      
         B     PABLASI             79 PAYABLE ASSIGNED+INTG                     
         B     PABLTOTN            80 PAYABLE TOTAL NET                         
         SPACE 1                                                                
*                                  BILLING VALUES                               
         B     BILLTG              81 BILLED TIME GROSS                         
         B     BILLIG              82 BILLED INTEGRATION GROSS                  
         B     BILLSG              83 BILLED SPECIAL GROSS                      
         B     BILLUG              84 BILLED CUT-IN GROSS                       
         B     BILLBG              85 BILLED BLACKOUT GROSS                     
         B     BILLPG              86 BILLED COPY-SPLIT GROSS                   
         B     BILLOG              87 BILLED OTHER GROSS                        
         B     BILLTIS             88 BILLED TIME/INTEG/SPECIAL                 
         B     BILLLG              89 BILLED LATE GROSS                         
         B     BILLTOTG            90 BILLED TOTAL GROSS                        
         SPACE 1                                                                
         B     BILLTN              91 BILLED TIME NET                           
         B     BILLIN              92 BILLED INTEGRATION NET                    
         B     BILLSN              93 BILLED SPECIAL NET                        
         B     BILLUN              94 BILLED CUT-IN NET                         
         B     BILLBN              95 BILLED BLACKOUT NET                       
         B     BILLPN              96 BILLED COPY-SPLIT NET                     
         B     BILLON              97 BILLED OTHER NET                          
         B     BILLTISN            98 BILLED TIME/INTEG/SPECIAL                 
         B     BILLLN              99 BILLED LATE NET                           
         B     BILLTOTN           100 BILLED TOTAL NET                          
         SPACE 1                                                                
*                                  BILLABLE VALUES                              
         B     BABLTG             101 BILLABLE TIME GROSS                       
         B     BABLIG             102 BILLABLE INTEGRATION GROSS                
         B     BABLSG             103 BILLABLE SPECIAL GROSS                    
         B     BABLUG             104 BILLABLE CUT-IN GROSS                     
         B     BABLBG             105 BILLABLE BLACKOUT GROSS                   
         B     BABLPG             106 BILLABLE COPY-SPLIT GROSS                 
         B     BABLOG             107 BILLABLE OTHER GROSS                      
         B     BABLTIS            108 BILLABLE TIME/INTEG/SPECIAL               
         B     BABLTISN           109 BILLABLE TIME/INTEG/SPECIAL NET           
         B     BABLTOTG           110 BILLABLE TOTAL GROSS                      
         SPACE 1                                                                
         B     BABLTN             111 BILLABLE TIME NET                         
         B     BABLIN             112 BILLABLE INTEGRATION NET                  
         B     BABLSN             113 BILLABLE SPECIAL NET                      
         B     BABLUN             114 BILLABLE CUT-IN NET                       
         B     BABLBN             115 BILLABLE BLACKOUT NET                     
         B     BABLPN             116 BILLABLE COPY-SPLIT NET                   
         B     BABLON             117 BILLABLE OTHER NET                        
         B     BABLAN             118 BILLABLE TIME ASSIGNED NET                
         B     BABLAIN            119 BILLABLE ASSIGNED+INTG NET                
         B     BABLTOTN           120 BILLABLE TOTAL NET                        
         SPACE 1                                                                
*                                  ODDMENTS                                     
         B     ACT99              121 99.3% OF ACTUAL                           
         B     ASS99              122 99.3% OF ASSIGNED                         
         B     BILL99             123 99.3% OF BILLED                           
         B     PAID99             124 99.3% OF PAID                             
         B     UNITS              125 UNITS                                     
         B     PAIDCOMM           126 COMMISSION PAID                           
         B     PABLCOMM           127 COMMISSION PAYABLE                        
         B     BILLCOMM           128 COMMISSION BILLED                         
         B     BABLCOMM           129 COMMISSION BILLABLE                       
         B     ASS                130 ALLOCATED = ASSIGNED                      
         B     ACT                131 PROGRAM TIME = ACTUAL                     
         B     ACT                132 NETWORK$ = ACTUAL                         
         B     INT99              133 99.3% INTEGRATION                         
         B     ASS                134 ORDERED ASSIGNED                          
         B     BILLTG             135 BILLED ASSIGNED                           
         B     BABLASS            136 BILLABLE ASSIGNED+INTG                    
         B     ORDRTOTG           137 %BILLED (PICK UP ORDERED)                 
         B     ORDRTOTG           138 %PAID   (PICK UP ORDERED)                 
         B     BBLTASS            139 BILLABLE ASSIGNED                         
         B     END                140 CROSS CAST                                
         SPACE 1                                                                
         B     ACT                141 ACT%     PERCENT FIELDS                   
         B     ASS                142 ASS%                                      
         B     BILLED             143 BILL%                                     
         B     PAID               144 CLEAR%                                    
         B     INT                145 INT%                                      
         B     ORDTIS             146 TIS%                                      
         B     BILLABLE           147 BILLABLE%                                 
         B     PAYABLE            148 PAYABLE%                                  
         B     ACTPLUS            149 ACT+%                                     
         B     ASSPLUS            150 ASS+%                                     
         SPACE 1                                                                
         B     NASS               151 NET ASSIGNED                              
         B     NASSPLUS           152 NET (ASSIGNED+INTEGRATION)                
         B     ASSACT             153 ASSIGNED ELSE ACTUAL                      
         B     ASSACTPL           154 ASSIGNED OR ACTUAL + INTEGRATION          
         B     PABLTIS            155 PAYABLE TIME/INTEG/SPECIAL                
         B     PABLTISN           156 PAYABLE TIME/INTEG/SPECIAL NET            
         B     BLTG               157 BLTG%    PERCENT                          
         B     ASSACTN            158 ASSIGNED ELSE ACTUAL(NET)                 
         B     BLTGA              159 BILLED ASSIGNED GROSS MIDAS               
         B     BLTNA              160 BILLED ASSIGNED NET MIDAS                 
         SPACE 1                                                                
         B     END                161 SPARE    DEMO FIELDS                      
         B     END                162 SPARE                                     
         B     END                163 SPARE                                     
         B     END                164 SPARE                                     
         B     END                165 SPARE                                     
         B     END                166 SPARE                                     
         B     END                167 SPARE                                     
         B     END                168 SPARE                                     
         B     END                169 SPARE                                     
         B     END                170 SPARE                                     
         SPACE 1                                                                
*                                  SUPPLEMENTAL SPECIAL ROUTINES                
*                                  ORDERED VALUES                               
         B     ORDRXG             171 ORDERED TAX GROSS                         
         B     ORDRAG             172 ORDERED ADMINISTRATION GROSS              
         B     ORDREG             173 ORDERED SECTIONAL GROSS                   
         SPACE 1                                                                
         B     ORDRXN             174 ORDERED TAX NET                           
         B     ORDRAN             175 ORDERED ADMINISTRATION NET                
         B     ORDREN             176 ORDERED SECTIONAL NET                     
         SPACE 1                                                                
*                                  PAID VALUES                                  
         B     PAIDXG             177 PAID TAX GROSS                            
         B     PAIDAG             178 PAID ADMINISTRATION GROSS                 
         B     PAIDEG             179 PAID SECTIONAL GROSS                      
         SPACE 1                                                                
         B     PAIDXN             180 PAID TAX NET                              
         B     PAIDAN             181 PAID ADMINISTRATION NET                   
         B     PAIDEN             182 PAID SECTIONAL NET                        
         SPACE 1                                                                
*                                  PAYABLE VALUES                               
         B     PABLXG             183 PAYABLE TAX GROSS                         
         B     PABLAG             184 PAYABLE ADMINISTRATION GROSS              
         B     PABLEG             185 PAYABLE SECTIONAL GROSS                   
         SPACE 1                                                                
         B     PABLXN             186 PAYABLE TAX NET                           
         B     PABLAN             187 PAYABLE ADMINISTRATION NET                
         B     PABLEN             188 PAYABLE SECTIONAL NET                     
         SPACE 1                                                                
*                                  BILLING VALUES                               
         B     BILLXG             189 BILLED TAX GROSS                          
         B     BILLAG             190 BILLED ADMINISTRATION GROSS               
         B     BILLEG             191 BILLED SECTIONAL GROSS                    
         SPACE 1                                                                
         B     BILLXN             192 BILLED TAX NET                            
         B     BILLAN             193 BILLED ADMINISTRATION NET                 
         B     BILLEN             194 BILLED SECTIONAL NET                      
         SPACE 1                                                                
*                                  BILLABLE VALUES                              
         B     BABLXG             195 BILLABLE TAX GROSS                        
         B     BABLAG             196 BILLABLE ADMINISTRATION GROSS             
         B     BABLEG             197 BILLABLE SECTIONAL GROSS                  
         SPACE 1                                                                
         B     BABLXN             198 BILLABLE TAX NET                          
         B     BABLAAN            199 BILLABLE ADMINISTRATION NET               
         B     BABLEN             200 BILLABLE SECTIONAL NET                    
         SPACE 1                                                                
         B     PABLATE            201 PAYABLE SPECIAL LATE                      
         B     PABLATN            202 PAYABLE SPECIAL LATE NET                  
         B     BABLATE            203 BILABLE SPECIAL LATE                      
         B     BABLATN            204 BILABLE SPECIAL LATE NET                  
*                                                                               
         B     PBTOT              205 PABLTOTN + PABLSN                         
         B     NBMNP              206 NET BILLED-NET PAID                       
         B     ORGDELV            207 ORDERED GROSS DELIV ADJ                   
         B     ORNDELV            208 ORDERED NET DELIV ADJ                     
*                                 EARNED COST                                   
         B     ORGERNC            209 ORDERED GROSS EARNC ADJ                   
         B     ORNERNC            210 ORDERED NET EARNC ADJ                     
         B     BLGERNC            211 BILLED GROSS EARNC ADJ                    
         B     BLERNCN            212 BILLED NET EARNC ADJ                      
         B     BBGERNC            213 BILLABLE GROSS EARCN ADJ                  
         B     BBNERNC            214 BILLABLE NET EARNC ADJ                    
         B     PDGERNC            215 PAID GROSS EARNC ADJ                      
         B     PDNERNC            216 PAID NET EARNC ADJ                        
         B     PBGERNC            217 PAYABLE GROSS EARNC ADJ                   
         B     PBNERNC            218 PAYABLE NET EARNC ADJ                     
*                                                                               
         B     TRDCACT            219 TRADE CREDIT ACTUAL                       
         B     TRDCACTN           220 TRADE CREDIT ACTUAL NET                   
         B     TRDCACTB           221 TRADE CREDIT ACTUAL BILLED                
         B     TRDCACBN           222 TRADE CREDIT ACTUAL BILNET                
         B     TRDCACTP           222 TRADE CREDIT ACTUAL PAYED                 
         B     TRDCACPN           224 TRADE CREDIT ACTUAL PAYED NET             
         B     TRDBLBAC           225 TRADE CREDIT ACTUAL BILLABLE              
         B     TRDBLBAN           226 TRADE CREDIT ACTUAL BILLABLE NET          
*                                                                               
         B     TRDASS             227 TRADE CREDIT ASSIGNED                     
*                                                                               
         EJECT                                                                  
*              GENERAL ROUTINES                                                 
         SPACE 3                                                                
ASS      BAS   RE,ASSIGN           01 ASSIGNED                                  
         L     R1,ASSGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
ASSPLUS  BAS   RE,ASSIGN           02 ASSIGNED +INTEGRATION + CUTIN             
         BAS   RE,INTEG                                                         
         L     R1,ASSGROSS                                                      
         A     R1,INTGROSS                                                      
*                                  (CUTIN NOT SUPPORTED YET)                    
         B     END                                                              
         SPACE 1                                                                
ACT      BAS   RE,ACTUAL           03 ACTUAL                                    
         L     R1,ACTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
ACTPLUS  BAS   RE,ACTUAL           04 ACTUAL + INTEGRATION + CUTIN              
         BAS   RE,INTEG                                                         
         L     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
*                                  (CUTIN NOT SUPPORTED YET)                    
         B     END                                                              
         SPACE 1                                                                
GROSS    BAS   RE,CALCOS           05 GROSS                                     
         L     R1,ACTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
DIFF     BAS   RE,ACTUAL           06 DIFFERENCE (ASS-ACT)                      
         L     R1,ACTGROSS                                                      
         LTR   R1,R1                                                            
         BZ    *+8                                                              
         BAS   RE,ADJST                                                         
         LR    R4,R1                                                            
         SR    R1,R1                                                            
         BAS   RE,ASSIGN                                                        
         L     R1,ASSGROSS                                                      
         LTR   R1,R1                                                            
         BZ    *+8                                                              
         BAS   RE,ADJST                                                         
         SR    R1,R4                                                            
         B     NOADJ                                                            
         SPACE 1                                                                
INT      BAS   RE,INTEG            07 INTEGRATION                               
         L     R1,INTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
*                                  (CUTIN NOT SUPPORTED YET)                    
CUTIN    B     END                                                              
         SPACE 1                                                                
TOTAL    BAS   RE,ACTUAL           09 TOTAL (ACT+INT)                           
         BAS   RE,INTEG                                                         
         L     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
TOTNET   BAS   RE,ACTUAL           10 TOTAL (ACT+INT) NET                       
         BAS   RE,INTEG                                                         
         L     R1,ACTNET                                                        
         A     R1,INTNET                                                        
         B     END                                                              
         SPACE 1                                                                
COMM     BAS   RE,CALCOS           12 COMMISSION                                
         L     R1,ACTNET                                                        
         LCR   R1,R1                                                            
         A     R1,ACTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
NET      BAS   RE,CALCOS           13 NET                                       
         L     R1,ACTNET                                                        
         B     END                                                              
         SPACE 1                                                                
NETTOT   BAS   RE,CALCOS           14 NETTOT (NET + INT NET)                    
         BAS   RE,INTEG                                                         
         L     R1,ACTNET                                                        
         A     R1,INTNET                                                        
         B     END                                                              
         SPACE 1                                                                
PAID     A     R1,NBPAYTGR         15 PAID/CLEARED                              
         A     R1,NBPAYIGR                                                      
         B     END                                                              
         SPACE 1                                                                
PAYABLE  BAS   RE,CALCOS           16 PAYABLE/UNCLEARED                         
         BAS   RE,INTEG            16 PAYABLE/UNCLEARED                         
         L     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
         S     R1,NBPAYTGR                                                      
         S     R1,NBPAYIGR                                                      
         B     END                                                              
         SPACE 1                                                                
BILLED   A     R1,NBBILTGR         17 BILLED                                    
         A     R1,NBBILIGR                                                      
         B     END                                                              
         SPACE 1                                                                
BLTG     A     R1,NBBILTGR         157 BLTG%  PERCENT BILLED                    
         B     END                                                              
         SPACE 1                                                                
BILLABLE BAS   RE,CALCOS           18 BILLABLE/UNBILLED                         
         BAS   RE,INTEG            16 PAYABLE/UNCLEARED                         
         L     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
         S     R1,NBBILTGR                                                      
         S     R1,NBBILIGR                                                      
         B     END                                                              
         SPACE 1                                                                
NINT     BAS   RE,INTEG            19 INTEGRATION NET                           
         L     R1,INTNET                                                        
         B     END                                                              
         EJECT                                                                  
*              ORDERED ROUTINES                                                 
         SPACE 3 I                                                              
ORDRTG   BAS   RE,CALCOS           21 ORDERED TIME GROSS                        
         L     R1,ACTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
ORDRIG   BAS   RE,INTEG            22 ORDERED INTEGRATION GROSS                 
         L     R1,INTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
ORDRSG   DS    0H                  23 ORDERED SPECIAL GROSS                     
         XC    ORDTOT,ORDTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTOT                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRUG   DS    0H                  24 ORDERED CUT-IN GROSS                      
         XC    ORDCUT,ORDCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDCUT                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRBG   DS    0H                  25 ORDERED BLACKOUT GROSS                    
         XC    ORDBLK,ORDBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDBLK                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRPG   DS    0H                  26 ORDERED COPY-SPLIT GROSS                  
         XC    ORDCOP,ORDCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDCOP                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRXG   DS    0H                 171 ORDERED TAX GROSS                         
         XC    ORDTAX,ORDTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTAX                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRAG   DS    0H                 172 ORDERED ADMINISTRATION GROSS              
         XC    ORDADM,ORDADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDADM                                                        
         B     END                                                              
         SPACE 1                                                                
ORDREG   DS    0H                 173 ORDERED SECTIONAL GROSS                   
         XC    ORDSEC,ORDSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDSEC                                                        
         B     END                                                              
         SPACE 1                                                                
ORDROG   DS    0H                  27 ORDERED OTHER SPECIAL GROSS               
         XC    ORDOTH,ORDOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDOTH                                                        
         B     END                                                              
         SPACE 1                                                                
ORDTIS   DS    0H                  28 ORDERED TIME+INTEG+SPECIAL                
         XC    ORDTOT,ORDTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTOT                                                        
         BAS   RE,ACTUAL                                                        
         BAS   RE,INTEG                                                         
         A     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
ORDRTOTG BAS   RE,CALCOS           30 ORDERED TOTAL GROSS                       
         BAS   RE,INTEG                                                         
         L     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
         B     END                                                              
         SPACE 1                                                                
ORDRTN   BAS   RE,CALCOS           31 ORDERED TIME NET                          
         L     R1,ACTNET                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRIN   BAS   RE,INTEG            32 ORDERED INTEGRATION NET                   
         L     R1,INTNET                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRSN   DS    0H                  33 ORDERED SPECIAL NET                       
         XC    ODNTOT,ODNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRUN   DS    0H                  34 ORDERED CUT-IN NET                        
         XC    ODNCUT,ODNCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNCUT                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRBN   DS    0H                  35 ORDERED BLACKOUT NET                      
         XC    ODNBLK,ODNBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNBLK                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRPN   DS    0H                  36 ORDERED COPY-SPLIT NET                    
         XC    ODNCOP,ODNCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNCOP                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRXN   DS    0H                 174 ORDERED TAX NET                           
         XC    ODNTAX,ODNTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTAX                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRAN   DS    0H                 175 ORDERED ADMINISTRATION NET                
         XC    ODNADM,ODNADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNADM                                                        
         B     END                                                              
         SPACE 1                                                                
ORDREN   DS    0H                 176 ORDERED SECTIONAL NET                     
         XC    ODNSEC,ODNSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNSEC                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRON   DS    0H                  37 ORDERED OTHER SPECIAL NET                 
         XC    ODNOTH,ODNOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNOTH                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRLTE  DS    0H                  29 ORDERED SPECIAL LATE                      
         XC    ORDLATE,ORDLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDLATE                                                       
         B     END                                                              
         SPACE 1                                                                
ORGDELV  DS    0H                  207 ORDERED DELIV ADJ                        
         XC    ORDDELV,ORDDELV                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDDELV                                                       
         B     END                                                              
         SPACE 1                                                                
ORNDELV  DS    0H                  208 ORDERED NET DELIV ADJ                    
         XC    ODNDELV,ODNDELV                                                  
         BAS   RE,SRRET                                                         
         A     R1,ODNDELV                                                       
         B     END                                                              
ORGERNC  DS    0H                  209 ORDERED EARNED COST                      
         XC    ORDERNC,ORDERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDERNC                                                       
         B     END                                                              
         SPACE 1                                                                
ORNERNC  DS    0H                  210 ORDERED NET EARNC                        
         XC    ODNERNC,ODNERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ODNERNC                                                       
         B     END                                                              
BLGERNC  DS    0H                  211 BILLED GROSS ERNC                        
         XC    BILERNC,BILERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,BILERNC                                                       
         B     END                                                              
BLERNCN  DS    0H                  212 BILLED NET EARNC                         
         XC    BLNERNC,BLNERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,BLNERNC                                                       
         B     END                                                              
BBGERNC  DS    0H                  213 BILLABLE GROSS EARNC                     
         XC    ORDERNC,ORDERNC                                                  
         XC    BILERNC,BILERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDERNC                                                       
         S     R1,BILERNC                                                       
         B     END                                                              
BBNERNC  DS    0H                  214 BILLABLE NET EARNC                       
         XC    ODNERNC,ODNERNC                                                  
         XC    BLNERNC,BLNERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ODNERNC                                                       
         S     R1,BLNERNC                                                       
         B     END                                                              
PDGERNC  DS    0H                  215 PAID GROSS EARNC ADJ                     
         XC    PAYERNC,PAYERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,PAYERNC                                                       
         B     END                                                              
PDNERNC  DS    0H                  216 PAID NET EARNC ADJ                       
         XC    PYNERNC,PYNERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,PYNERNC                                                       
         B     END                                                              
PBGERNC  DS    0H                  217 PAYABLE GROSS EARNC ADJ                  
         XC    ORDERNC,ORDERNC                                                  
         XC    PAYERNC,PAYERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDERNC                                                       
         S     R1,PAYERNC                                                       
         B     END                                                              
PBNERNC  DS    0H                  218 PAYABLE NET EARNC ADJ                    
         XC    ODNERNC,ODNERNC                                                  
         XC    PYNERNC,PYNERNC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDTRDC                                                       
         S     R1,ORDTRDC                                                       
         B     END                                                              
         SPACE 1                                                                
TRDCACT  DS    0H                  219 ORDERED TRADE CREDIT ACTUAL              
         XC    ORDTRDC,ORDTRDC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDTRDC                                                       
         B     END                                                              
TRDCACTN DS    0H                  220 ORDERED TRADE CREDIT NET                 
         XC    ODNTRDC,ODNTRDC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ODNTRDC                                                       
         B     END                                                              
TRDCACTB DS    0H                  221 BILLED TRADE ACTUAL                      
         XC    BILTRDC,BILTRDC                                                  
         BAS   RE,SRRET                                                         
         A     R1,BILTRDC                                                       
         B     END                                                              
TRDCACBN DS    0H                  222 BILLED TRADE ACT NET                     
         XC    BLNTRDC,BLNTRDC                                                  
         BAS   RE,SRRET                                                         
         A     R1,BLNTRDC                                                       
         B     END                                                              
TRDCACTP DS    0H                  223 PAID TRADE ACTUAL                        
         XC    PAYTRDC,PAYTRDC                                                  
         BAS   RE,SRRET                                                         
         A     R1,PAYTRDC                                                       
         B     END                                                              
         SPACE 1                                                                
TRDCACPN DS    0H                  224 PAID TRADE ACTUAL NET                    
         XC    PYNETRD,PYNETRD                                                  
         BAS   RE,SRRET                                                         
         A     R1,PYNETRD                                                       
         B     END                                                              
         SPACE 1                                                                
TRDBLBAC DS    0H                  225 BLBL TRADE ACTUAL NET                    
         XC    ORDTRDC,ORDTRDC                                                  
         XC    BILTRDC,BILTRDC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDTRDC                                                       
         S     R1,BILTRDC                                                       
         B     END                                                              
         SPACE 1                                                                
TRDBLBAN DS    0H                  226 BLBL TRADE ACTUAL NET                    
         XC    ODNTRDC,ODNTRDC                                                  
         XC    BLNTRDC,BLNTRDC                                                  
         BAS   RE,SRRET                                                         
         A     R1,ODNTRDC                                                       
         S     R1,BLNTRDC                                                       
         B     END                                                              
         SPACE 1                                                                
TRDASS   DS    0H                  227 ASSIGNED TRADE CREDIT                    
         XC    ORDTRAS,ORDTRAS                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDTRAS                                                       
         B     END                                                              
         SPACE 1                                                                
ORDRLTN  DS    0H                  39 ORDERED SPECIAL LATE NET                  
         XC    ODNLATE,ODNLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,ODNLATE                                                       
         B     END                                                              
         SPACE 1                                                                
PAIDLG   DS    0H                  49 PAID SPECIAL LATE                         
         XC    PAYLATE,PAYLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,PAYLATE                                                       
         B     END                                                              
         SPACE 1                                                                
PAIDLN   DS    0H                  59 PAID SPECIAL LATE NET                     
         XC    PYNLATE,PYNLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,PYNLATE                                                       
         B     END                                                              
         SPACE 1                                                                
BILLLG   DS    0H                  89 BILLED SPECIAL LATE GROSS                 
         XC    BILLATE,BILLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,BILLATE                                                       
         B     END                                                              
         SPACE 1                                                                
BILLLN   DS    0H                  99 BILLED SPECIAL LATE NET                   
         XC    BLNLATE,BLNLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,BLNLATE                                                       
         B     END                                                              
         SPACE 1                                                                
ORDTISN  DS    0H                  38 ORDERED TIME+INTEG+SPECIAL NET            
         XC    ODNTOT,ODNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTOT                                                        
         BAS   RE,CALCOS                                                        
         A     R1,ACTNET                                                        
         BAS   RE,INTEG                                                         
         A     R1,INTNET                                                        
         B     END                                                              
         SPACE 1                                                                
ORDRTOTN BAS   RE,CALCOS           40 ORDERED TOTAL NET                         
         BAS   RE,INTEG                                                         
         L     R1,ACTNET                                                        
         A     R1,INTNET                                                        
         B     END                                                              
         EJECT                                                                  
*              PAID ROUTINES                                                    
         SPACE 3                                                                
PAIDTG   A     R1,NBPAYTGR         41 PAID TIME GROSS                           
         B     END                                                              
         SPACE 1                                                                
PAIDIG   A     R1,NBPAYIGR         42 PAID INTEGRATION GROSS                    
         B     END                                                              
         SPACE 1                                                                
PAIDSG   DS    0H                  43 PAID SPECIAL GROSS                        
         XC    PAYTOT,PAYTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYTOT                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDUG   DS    0H                  44 PAID CUT-IN GROSS                         
         XC    PAYCUT,PAYCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYCUT                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDBG   DS    0H                  45 PAID BLACKOUT GROSS                       
         XC    PAYBLK,PAYBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYBLK                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDPG   DS    0H                  46 PAID COPY SPLIT GROSS                     
         XC    PAYCOP,PAYCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYCOP                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDXG   DS    0H                 177 PAID TAX GROSS                            
         XC    PAYTAX,PAYTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYTAX                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDAG   DS    0H                 178 PAID ADMINISTRATION GROSS                 
         XC    PAYADM,PAYADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYADM                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDEG   DS    0H                 179 PAID SECTIONAL GROSS                      
         XC    PAYSEC,PAYSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYSEC                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDOG   DS    0H                  47 PAID OTHER SPECIAL GROSS                  
         XC    PAYOTH,PAYOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYOTH                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDTIS  DS    0H                  48 PAID TIME/INTEG/SPECIAL                   
         A     R1,NBPAYTGR                                                      
         A     R1,NBPAYIGR                                                      
         XC    PAYTOT,PAYTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,PAYTOT                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDTOTG A     R1,NBPAYTGR         50 PAID TOTAL GROSS                          
         A     R1,NBPAYIGR                                                      
         B     END                                                              
         SPACE 1                                                                
PAIDTN   A     R1,NBPAYTNT         51 PAID TIME NET                             
         B     END                                                              
         SPACE 1                                                                
PAIDIN   A     R1,NBPAYINT         52 PAID INTEGRATION NET                      
         B     END                                                              
         SPACE 1                                                                
PAIDSN   DS    0H                  53 PAID SPECIAL NET                          
         XC    PYNTOT,PYNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDUN   DS    0H                  54 PAID CUT-IN NET                           
         XC    PYNCUT,PYNCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNCUT                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDBN   DS    0H                  55 PAID BLACKOUT NET                         
         XC    PYNBLK,PYNBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNBLK                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDPN   DS    0H                  56 PAID COPY-SPLIT NET                       
         XC    PYNCOP,PYNCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNCOP                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDXN   DS    0H                 180 PAID TAX NET                              
         XC    PYNTAX,PYNTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNTAX                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDAN   DS    0H                 181 PAID ADMINISTRATION NET                   
         XC    PYNADM,PYNADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNADM                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDEN   DS    0H                 182 PAID SECTIONAL NET                        
         XC    PYNSEC,PYNSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNSEC                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDON   DS    0H                  57 PAID OTHER SPECIAL NET                    
         XC    PYNOTH,PYNOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNOTH                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDTISN DS    0H                  58 PAID TIME/INTEG/SPEC NET                  
         A     R1,NBPAYTNT                                                      
         A     R1,NBPAYINT                                                      
         XC    PYNTOT,PYNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
PAIDTOTN A     R1,NBPAYTNT         60 PAID TOTAL NET                            
         A     R1,NBPAYINT                                                      
         B     END                                                              
         EJECT                                                                  
*              PAYABLE ROUTINES                                                 
         SPACE 3 I                                                              
PABLTG   BAS   RE,CALCOS           61 PAYABLE TIME GROSS                        
         L     R1,ACTGROSS                                                      
         S     R1,NBPAYTGR                                                      
         B     END                                                              
         SPACE 1                                                                
PABLIG   BAS   RE,INTEG                                                         
         L     R1,INTGROSS         62 PAYABLE INTEGRATION GROSS                 
         S     R1,NBPAYIGR                                                      
         B     END                                                              
         SPACE 1                                                                
PABLSG   DS    0H                  63 PAYABLE SPECIAL GROSS                     
         XC    ORDTOT,ORDTOT                                                    
         XC    PAYTOT,PAYTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTOT                                                        
         S     R1,PAYTOT                                                        
         B     END                                                              
         SPACE 1                                                                
PABLUG   DS    0H                  64 PAYABLE CUT-IN GROSS                      
         XC    ORDCUT,ORDCUT                                                    
         XC    PAYCUT,PAYCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDCUT                                                        
         S     R1,PAYCUT                                                        
         B     END                                                              
         SPACE 1                                                                
PABLBG   DS    0H                  65 PAYABLE BLACKOUT GROSS                    
         XC    ORDBLK,ORDBLK                                                    
         XC    PAYBLK,PAYBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDBLK                                                        
         S     R1,PAYBLK                                                        
         B     END                                                              
         SPACE 1                                                                
PABLPG   DS    0H                  66 PAYABLE COPY-SPLIT GROSS                  
         XC    ORDCOP,ORDCOP                                                    
         XC    PAYCOP,PAYCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDCOP                                                        
         S     R1,PAYCOP                                                        
         B     END                                                              
         SPACE 1                                                                
PABLATE  DS    0H                  201 PAYABLE LATE GROSS                       
         XC    ORDLATE,ORDLATE                                                  
         XC    PAYLATE,PAYLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDLATE                                                       
         S     R1,PAYLATE                                                       
         B     END                                                              
         SPACE 1                                                                
PABLATN  DS    0H                  202 PAYABLE LATE NET                         
         XC    ODNLATE,ODNLATE                                                  
         XC    PYNLATE,PYNLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,ODNLATE                                                       
         S     R1,PYNLATE                                                       
         B     END                                                              
         SPACE 1                                                                
BABLATE  DS    0H                  203 BILLABLE LATE                            
         XC    ORDLATE,ORDLATE                                                  
         XC    BILLATE,BILLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,ORDLATE                                                       
         S     R1,BILLATE                                                       
         B     END                                                              
         SPACE 1                                                                
BABLATN  DS    0H                  204 BILLABLE LATE NET                        
         XC    ODNLATE,ODNLATE                                                  
         XC    BLNLATE,BLNLATE                                                  
         BAS   RE,SRRET                                                         
         A     R1,ODNLATE                                                       
         S     R1,BLNLATE                                                       
         B     END                                                              
         SPACE 1                                                                
PABLXG   DS    0H                 183 PAYABLE TAX GROSS                         
         XC    ORDTAX,ORDTAX                                                    
         XC    PAYTAX,PAYTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTAX                                                        
         S     R1,PAYTAX                                                        
         B     END                                                              
         SPACE 1                                                                
PABLAG   DS    0H                 184 PAYABLE ADMINISTRATION GROSS              
         XC    ORDADM,ORDADM                                                    
         XC    PAYADM,PAYADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDADM                                                        
         S     R1,PAYADM                                                        
         B     END                                                              
         SPACE 1                                                                
PABLEG   DS    0H                 185 PAYABLE SECTIONAL GROSS                   
         XC    ORDSEC,ORDSEC                                                    
         XC    PAYSEC,PAYSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDSEC                                                        
         S     R1,PAYSEC                                                        
         B     END                                                              
         SPACE 1                                                                
PABLOG   DS    0H                  67 PAYABLE OTHER SPECIAL GROSS               
         XC    ORDOTH,ORDOTH                                                    
         XC    PAYOTH,PAYOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDOTH                                                        
         S     R1,PAYOTH                                                        
         B     END                                                              
         SPACE 1                                                                
PABLASG  BAS   RE,ASSIGN           68 PAYABLE ASSIGNED GROSS                    
         L     R1,ASSGROSS                                                      
         S     R1,NBPAYTGR                                                      
         B     END                                                              
         SPACE 1                                                                
PABLASIN BAS   RE,ASSIGN           69 PAYABLE ASSIGNED+INTG NET                 
         BAS   RE,INTEG                                                         
         L     R1,ASSNET                                                        
         A     R1,INTNET                                                        
         S     R1,NBPAYTNT                                                      
         S     R1,NBPAYINT                                                      
         B     END                                                              
         SPACE 1                                                                
PABLTOTG BAS   RE,CALCOS           70 PAYABLE TOTAL GROSS                       
         BAS   RE,INTEG            70 PAYABLE TOTAL GROSS                       
         L     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
         S     R1,NBPAYTGR                                                      
         S     R1,NBPAYIGR                                                      
         B     END                                                              
         SPACE 1                                                                
PABLTIS  BAS   RE,CALCOS           155 PAYABLE TIME/INTEG/SPECIAL               
         BAS   RE,INTEG                                                         
         L     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
         S     R1,NBPAYTGR                                                      
         S     R1,NBPAYIGR                                                      
         XC    ORDTOT,ORDTOT                                                    
         XC    PAYTOT,PAYTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTOT                                                        
         S     R1,PAYTOT                                                        
         B     END                                                              
         SPACE 1                                                                
PABLTISN BAS   RE,CALCOS           156 PAYABLE TIME/INTEG/SPECIAL NET           
         L     R1,ACTNET                                                        
         S     R1,NBPAYTNT                                                      
         BAS   RE,INTEG                                                         
         A     R1,INTNET                                                        
         S     R1,NBPAYINT                                                      
         XC    ODNTOT,ODNTOT                                                    
         XC    PYNTOT,PYNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTOT                                                        
         S     R1,PYNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
PABLTN   BAS   RE,CALCOS           71 PAYABLE TIME NET                          
         L     R1,ACTNET                                                        
         S     R1,NBPAYTNT                                                      
         B     END                                                              
         SPACE 1                                                                
PABLIN   BAS   RE,INTEG            72 PAYABLE INTEGRATION NET                   
         L     R1,INTNET                                                        
         S     R1,NBPAYINT                                                      
         B     END                                                              
         SPACE 1                                                                
PABLSN   DS    0H                  73 PAYABLE SPECIAL NET                       
         XC    ODNTOT,ODNTOT                                                    
         XC    PYNTOT,PYNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTOT                                                        
         S     R1,PYNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
PABLUN   DS    0H                  74 PAYABLE CUT-IN NET                        
         XC    ODNCUT,ODNCUT                                                    
         XC    PYNCUT,PYNCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNCUT                                                        
         S     R1,PYNCUT                                                        
         B     END                                                              
         SPACE 1                                                                
PABLBN   DS    0H                  75 PAYABLE BLACKOUT NET                      
         XC    ODNBLK,ODNBLK                                                    
         XC    PYNBLK,PYNBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNBLK                                                        
         S     R1,PYNBLK                                                        
         B     END                                                              
         SPACE 1                                                                
PABLPN   DS    0H                  76 PAYABLE COPY-SPLIT NET                    
         XC    ODNCOP,ODNCOP                                                    
         XC    PYNCOP,PYNCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNCOP                                                        
         S     R1,PYNCOP                                                        
         B     END                                                              
         SPACE 1                                                                
PABLXN   DS    0H                 186 PAYABLE TAX NET                           
         XC    ODNTAX,ODNTAX                                                    
         XC    PYNTAX,PYNTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTAX                                                        
         S     R1,PYNTAX                                                        
         B     END                                                              
         SPACE 1                                                                
PABLAN   DS    0H                 187 PAYABLE ADMINISTRATION NET                
         XC    ODNADM,ODNADM                                                    
         XC    PYNADM,PYNADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNADM                                                        
         S     R1,PYNADM                                                        
         B     END                                                              
         SPACE 1                                                                
PABLEN   DS    0H                 188 PAYABLE SECTIONAL NET                     
         XC    ODNSEC,ODNSEC                                                    
         XC    PYNSEC,PYNSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNSEC                                                        
         S     R1,PYNSEC                                                        
         B     END                                                              
         SPACE 1                                                                
PABLON   DS    0H                  77 PAYABLE OTHER SPECIAL NET                 
         XC    ODNOTH,ODNOTH                                                    
         XC    PYNOTH,PYNOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNOTH                                                        
         S     R1,PYNOTH                                                        
         B     END                                                              
         SPACE 1                                                                
PABLASN  BAS   RE,ASSIGN           78 PAYABLE ASSIGNED NET                      
         L     R1,ASSNET                                                        
         S     R1,NBPAYTNT                                                      
         B     END                                                              
         SPACE 1                                                                
PABLASI  BAS   RE,ASSIGN           79 PAYABLE ASSIGNED+INTG  GROSS              
         BAS   RE,INTEG                                                         
         L     R1,ASSGROSS                                                      
         A     R1,INTGROSS                                                      
         S     R1,NBPAYTGR                                                      
         S     R1,NBPAYIGR                                                      
         B     END                                                              
         SPACE 1                                                                
PABLTOTN BAS   RE,CALCOS           80 PAYABLE TOTAL NET                         
         BAS   RE,INTEG                                                         
         L     R1,ACTNET                                                        
         A     R1,INTNET                                                        
         S     R1,NBPAYTNT                                                      
         S     R1,NBPAYINT                                                      
         B     END                                                              
         SPACE 1                                                                
* PABLTOTN + PABLSN                                                             
PBTOT    DS    0H                                                               
         XC    ODNTOT,ODNTOT         PAYABLE SPECIAL CHARGES NET                
         XC    PYNTOT,PYNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTOT                                                        
         S     R1,PYNTOT                                                        
*                                                                               
         BAS   RE,CALCOS             PAYABLE NET                                
         BAS   RE,INTEG                                                         
         A     R1,ACTNET                                                        
         A     R1,INTNET                                                        
         S     R1,NBPAYTNT                                                      
         S     R1,NBPAYINT                                                      
         B     END                                                              
         EJECT                                                                  
*              BILLING ROUTINES                                                 
         SPACE 3 I                                                              
BILLTG   A     R1,NBBILTGR         81 BILLED TIME GROSS                         
         B     END                                                              
         SPACE 1                                                                
BILLIG   A     R1,NBBILIGR         82 BILLED INTEGRATION GROSS                  
         B     END                                                              
         SPACE 1                                                                
BILLSG   DS    0H                  83 BILLED SPECIAL GROSS                      
         XC    BILTOT,BILTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILTOT                                                        
         B     END                                                              
         SPACE 1                                                                
BILLUG   DS    0H                  84 BILLED CUT-IN GROSS                       
         XC    BILCUT,BILCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILCUT                                                        
         B     END                                                              
         SPACE 1                                                                
BILLBG   DS    0H                  85 BILLED BLACKOUT GROSS                     
         XC    BILBLK,BILBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILBLK                                                        
         B     END                                                              
         SPACE 1                                                                
BILLPG   DS    0H                  86 BILLED COPY-SPLIT GROSS                   
         XC    BILCOP,BILCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILCOP                                                        
         B     END                                                              
         SPACE 1                                                                
BILLXG   DS    0H                 189 BILLED TAX GROSS                          
         XC    BILTAX,BILTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILTAX                                                        
         B     END                                                              
         SPACE 1                                                                
BILLAG   DS    0H                 190 BILLED ADMINISTRATION GROSS               
         XC    BILADM,BILADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILADM                                                        
         B     END                                                              
         SPACE 1                                                                
BILLEG   DS    0H                 191 BILLED SECTIONAL GROSS                    
         XC    BILSEC,BILSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILSEC                                                        
         B     END                                                              
         SPACE 1                                                                
BILLOG   DS    0H                  87 BILLED OTHER SPECIAL GROSS                
         XC    BILOTH,BILOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILOTH                                                        
         B     END                                                              
         SPACE                                                                  
BILLTIS  A     R1,NBBILTGR         88 BILLED TIME/INTEG/SPECIAL                 
         A     R1,NBBILIGR                                                      
         XC    BILTOT,BILTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,BILTOT                                                        
         B     END                                                              
         SPACE 1                                                                
         SPACE 1                                                                
BILLTOTG A     R1,NBBILTGR         90 BILLED TOTAL GROSS                        
         A     R1,NBBILIGR                                                      
         B     END                                                              
         SPACE 1                                                                
BILLTN   A     R1,NBBILTNT         91 BILLED TIME NET                           
         B     END                                                              
         SPACE 1                                                                
BILLIN   A     R1,NBBILINT         92 BILLED INTEGRATION NET                    
         B     END                                                              
         SPACE 1                                                                
BILLSN   DS    0H                  93 BILLED SPECIAL NET                        
         XC    BLNTOT,BLNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
BILLUN   DS    0H                  94 BILLED CUT-IN NET                         
         XC    BLNCUT,BLNCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNCUT                                                        
         B     END                                                              
         SPACE 1                                                                
BILLBN   DS    0H                  95 BILLED BLACKOUT NET                       
         XC    BLNBLK,BLNBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNBLK                                                        
         B     END                                                              
         SPACE 1                                                                
BILLPN   DS    0H                  96 BILLED COPY-SPLIT NET                     
         XC    BLNCOP,BLNCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNCOP                                                        
         B     END                                                              
         SPACE 1                                                                
BILLXN   DS    0H                 192 BILLED TAX NET                            
         XC    BLNTAX,BLNTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNTAX                                                        
         B     END                                                              
         SPACE 1                                                                
BILLAN   DS    0H                 193 BILLED ADMINISTRATION NET                 
         XC    BLNADM,BLNADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNADM                                                        
         B     END                                                              
         SPACE 1                                                                
BILLEN   DS    0H                 194 BILLED SECTIONAL NET                      
         XC    BLNSEC,BLNSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNSEC                                                        
         B     END                                                              
         SPACE 1                                                                
BILLON   DS    0H                  97 BILLED OTHER SPECIAL NET                  
         XC    BLNOTH,BLNOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNOTH                                                        
         B     END                                                              
         SPACE 1                                                                
BILLTISN A     R1,NBBILTNT         98 BILLED TIME/INTEG/SPECIAL                 
         A     R1,NBBILINT                                                      
         XC    BLNTOT,BLNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
         SPACE 1                                                                
BILLTOTN A     R1,NBBILTNT        100 BILLED TOTAL NET                          
         A     R1,NBBILINT                                                      
         B     END                                                              
                                                                                
NBMNP    DS    0H                  206  NET BILLED-NET PAID                     
* GET TOTAL NET BILLED                                                          
         SR    R1,R1                                                            
         XC    BLNTOT,BLNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,BLNTOT              BILLED SPECIAL NET                        
         A     R1,NBBILTNT            BILLED ACT                                
         A     R1,NBBILINT            BILLED INT                                
         ST    R1,SVAREA              SAVE TOT BILLED NET                       
* GET TOTAL NET PAID                                                            
         SR    R1,R1                                                            
         XC    PYNTOT,PYNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,PYNTOT              SPECIAL PAID NET                          
         A     R1,NBPAYTNT            PAID TOTAL NET                            
         A     R1,NBPAYINT            PAID INT NET                              
         LR    RE,R1                  PUT PAID INTO -> RE                       
         L     R1,SVAREA              PUT BILLED -> R1                          
         SR    R1,RE                  BILLED-PAID                               
         B     END                                                              
         EJECT                                                                  
*              BILLABLE ROUTINES                                                
         SPACE 3 I                                                              
BABLTG   BAS   RE,CALCOS          101 BILLABLE TIME GROSS                       
         L     R1,ACTGROSS                                                      
         S     R1,NBBILTGR                                                      
         B     END                                                              
         SPACE 1                                                                
BABLIG   BAS   RE,INTEG                                                         
         L     R1,INTGROSS        102 BILLABLE INTEGRATION GROSS                
         S     R1,NBBILIGR                                                      
         B     END                                                              
         SPACE 1                                                                
BABLSG   DS    0H                 103 BILLABLE SPECIAL GROSS                    
         XC    ORDTOT,ORDTOT                                                    
         XC    BILTOT,BILTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTOT                                                        
         S     R1,BILTOT                                                        
         B     END                                                              
         SPACE 1                                                                
BABLUG   DS    0H                 104 BILLABLE CUT-IN GROSS                     
         XC    ORDCUT,ORDCUT                                                    
         XC    BILCUT,BILCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDCUT                                                        
         S     R1,BILCUT                                                        
         B     END                                                              
         SPACE 1                                                                
BABLBG   DS    0H                 105 BILLABLE BLACKOUT GROSS                   
         XC    ORDBLK,ORDBLK                                                    
         XC    BILBLK,BILBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDBLK                                                        
         S     R1,BILBLK                                                        
         B     END                                                              
         SPACE 1                                                                
BABLPG   DS    0H                 106 BILLABLE COPY-SPLIT GROSS                 
         XC    ORDCOP,ORDCOP                                                    
         XC    BILCOP,BILCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDCOP                                                        
         S     R1,BILCOP                                                        
         B     END                                                              
         SPACE 1                                                                
BABLXG   DS    0H                 195 BILLABLE TAX GROSS                        
         XC    ORDTAX,ORDTAX                                                    
         XC    BILTAX,BILTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTAX                                                        
         S     R1,BILTAX                                                        
         B     END                                                              
         SPACE 1                                                                
BABLAG   DS    0H                 196 BILLABLE ADMINISTRATION GROSS             
         XC    ORDADM,ORDADM                                                    
         XC    BILADM,BILADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDADM                                                        
         S     R1,BILADM                                                        
         B     END                                                              
         SPACE 1                                                                
BABLEG   DS    0H                 197 BILLABLE SECTIONAL GROSS                  
         XC    ORDSEC,ORDSEC                                                    
         XC    BILSEC,BILSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDSEC                                                        
         S     R1,BILSEC                                                        
         B     END                                                              
         SPACE 1                                                                
BABLOG   DS    0H                 107 BILLABLE OTHER SPECIAL GROSS              
         XC    ORDOTH,ORDOTH                                                    
         XC    BILOTH,BILOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDOTH                                                        
         S     R1,BILOTH                                                        
         B     END                                                              
         SPACE 1                                                                
BABLTIS  BAS   RE,CALCOS          108 BILLABLE TIME/INTEG/SPECIAL               
         L     R1,ACTGROSS                                                      
         S     R1,NBBILTGR                                                      
         BAS   RE,INTEG                                                         
         A     R1,INTGROSS                                                      
         S     R1,NBBILIGR                                                      
         XC    ORDTOT,ORDTOT                                                    
         XC    BILTOT,BILTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ORDTOT                                                        
         S     R1,BILTOT                                                        
         B     END                                                              
         SPACE                                                                  
BABLTISN BAS   RE,CALCOS          109 BILLABLE TIME/INTEG/SPECIAL NET           
         L     R1,ACTNET                                                        
         S     R1,NBBILTNT                                                      
         BAS   RE,INTEG                                                         
         A     R1,INTNET                                                        
         S     R1,NBBILINT                                                      
         XC    ODNTOT,ODNTOT                                                    
         XC    BLNTOT,BLNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTOT                                                        
         S     R1,BLNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
BABLTOTG BAS   RE,CALCOS          110 BILLABLE TOTAL GROSS                      
         BAS   RE,INTEG                                                         
         L     R1,ACTGROSS                                                      
         A     R1,INTGROSS                                                      
         S     R1,NBBILTGR                                                      
         S     R1,NBBILIGR                                                      
         B     END                                                              
         SPACE 1                                                                
BABLTN   BAS   RE,CALCOS          111 BILLABLE TIME NET                         
         L     R1,ACTNET                                                        
         S     R1,NBBILTNT                                                      
         B     END                                                              
         SPACE 1                                                                
BABLIN   BAS   RE,INTEG           112 BILLABLE INTEGRATION NET                  
         L     R1,INTNET                                                        
         S     R1,NBBILINT                                                      
         B     END                                                              
         SPACE 1                                                                
BABLSN   DS    0H                 113 BILLABLE SPECIAL NET                      
         XC    ODNTOT,ODNTOT                                                    
         XC    BLNTOT,BLNTOT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTOT                                                        
         S     R1,BLNTOT                                                        
         B     END                                                              
         SPACE 1                                                                
BABLUN   DS    0H                 114 BILLABLE CUT-IN NET                       
         XC    ODNCUT,ODNCUT                                                    
         XC    BLNCUT,BLNCUT                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNCUT                                                        
         S     R1,BLNCUT                                                        
         B     END                                                              
         SPACE 1                                                                
BABLBN   DS    0H                 115 BILLABLE BLACKOUT NET                     
         XC    ODNBLK,ODNBLK                                                    
         XC    BLNBLK,BLNBLK                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNBLK                                                        
         S     R1,BLNBLK                                                        
         B     END                                                              
         SPACE 1                                                                
BABLPN   DS    0H                 116 BILLABLE COPY-SPLIT NET                   
         XC    ODNCOP,ODNCOP                                                    
         XC    BLNCOP,BLNCOP                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNCOP                                                        
         S     R1,BLNCOP                                                        
         B     END                                                              
         SPACE 1                                                                
BABLXN   DS    0H                 198 BILLABLE TAX NET                          
         XC    ODNTAX,ODNTAX                                                    
         XC    BLNTAX,BLNTAX                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNTAX                                                        
         S     R1,BLNTAX                                                        
         B     END                                                              
         SPACE 1                                                                
BABLAAN  DS    0H                 199 BILLABLE ADMINISTRATION NET               
         XC    ODNADM,ODNADM                                                    
         XC    BLNADM,BLNADM                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNADM                                                        
         S     R1,BLNADM                                                        
         B     END                                                              
         SPACE 1                                                                
BABLEN   DS    0H                 200 BILLABLE SECTIONAL NET                    
         XC    ODNSEC,ODNSEC                                                    
         XC    BLNSEC,BLNSEC                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNSEC                                                        
         S     R1,BLNSEC                                                        
         B     END                                                              
         SPACE 1                                                                
BABLON   DS    0H                 117 BILLABLE OTHER SPECIAL NET                
         XC    ODNOTH,ODNOTH                                                    
         XC    BLNOTH,BLNOTH                                                    
         BAS   RE,SRRET                                                         
         A     R1,ODNOTH                                                        
         S     R1,BLNOTH                                                        
         B     END                                                              
         SPACE 1                                                                
BABLTOTN BAS   RE,CALCOS          120 BILLABLE TOTAL NET                        
         BAS   RE,INTEG                                                         
         L     R1,ACTNET                                                        
         A     R1,INTNET                                                        
         S     R1,NBBILTNT                                                      
         S     R1,NBBILINT                                                      
         B     END                                                              
         SPACE 1                                                                
BABLASS  BAS   RE,ASSIGN       136 BILLABLE ASSIGNED+INTG                       
         BAS   RE,INTEG                                                         
         L     R1,ASSGROSS                                                      
         A     R1,INTGROSS                                                      
         S     R1,NBBILTGR                                                      
         S     R1,NBBILIGR                                                      
         B     END                                                              
         SPACE 1                                                                
BBLTASS  BAS   RE,ASSIGN          139 BILLABLE TIME ASSIGNED                    
         L     R1,ASSGROSS                                                      
         S     R1,NBBILTGR                                                      
         B     END                                                              
         SPACE 1                                                                
BABLAN   BAS   RE,ASSIGN          118 BILLABLE TIME ASSIGNED NET                
         L     R1,ASSNET                                                        
         S     R1,NBBILTNT                                                      
         B     END                                                              
         SPACE 1                                                                
BABLAIN  BAS   RE,ASSIGN          119 BILLABLE ASSIGNED+INTG  NET               
         L     R1,ASSNET                                                        
         A     R1,INTNET                                                        
         S     R1,NBBILTNT                                                      
         S     R1,NBBILINT                                                      
         B     END                                                              
         EJECT                                                                  
*              ODD ROUTINES                                                     
         SPACE 3                                                                
ACT99    BAS   RE,ACTUAL          121 99.3% ACTUAL                              
         L     R1,ACTGROSS                                                      
         BAS   RE,DO99                                                          
         B     NOADJ                                                            
         SPACE 1                                                                
ASS99    BAS   RE,ASSIGN          122 99.3% ASSIGNED                            
         L     R1,ASSGROSS                                                      
         BAS   RE,DO99                                                          
         B     NOADJ                                                            
         SPACE 1                                                                
BILL99   A     R1,NBBILTGR        123 99.3% BILLED (GROSS)                      
         A     R1,NBBILIGR                                                      
         BAS   RE,DO99                                                          
         B     NOADJ                                                            
         SPACE 1                                                                
PAID99   A     R1,NBPAYTGR        124 99.3% PAID (GROSS)                        
         A     R1,NBPAYIGR                                                      
         BAS   RE,DO99                                                          
         B     NOADJ                                                            
         SPACE 1                                                                
INT99    BAS   RE,INTEG                                                         
         L     R1,INTGROSS        133 99.3% INTEGRATION                         
         BAS   RE,DO99                                                          
         B     NOADJ                                                            
         SPACE 1                                                                
UNITS    AH    R1,NBACTUN         125 UNITS                                     
         B     NOADJ                                                            
         SPACE 1                                                                
NASS     BAS   RE,ASSIGN          151 NET ASSIGNED                              
         L     R1,ASSNET                                                        
         B     END                                                              
         SPACE 1                                                                
NASSPLUS BAS   RE,ASSIGN          152 NET (ASSIGNED+INTEGRATION)                
         BAS   RE,INTEG                                                         
         L     R1,ASSNET                                                        
         A     R1,INTNET                                                        
         B     END                                                              
         SPACE 1                                                                
ASSACT   BAS   RE,ASSIGN          153 ASSIGNED ELSE ACTUAL                      
         L     R1,ASSGROSS                                                      
         LTR   R1,R1                                                            
         BNZ   END                                                              
         TM    NBUNITST,X'08'      ASSIGNED COST INPUT                          
         BO    END                                                              
         BAS   RE,ACTUAL                                                        
         L     R1,ACTGROSS                                                      
         B     END                                                              
ASSACTN  BAS   RE,ASSIGN          158 ASSIGNED ELSE ACTUAL                      
         L     R1,ASSNET                                                        
         LTR   R1,R1                                                            
         BNZ   END                                                              
         TM    NBUNITST,X'08'      ASSIGNED COST INPUT                          
         BO    END                                                              
         BAS   RE,ACTUAL                                                        
         L     R1,ACTNET                                                        
         B     END                                                              
         SPACE 1                                                                
ASSACTPL BAS   RE,INTEG                                                         
         BAS   RE,ASSIGN          154 ASSIGNED OR ACTUAL PLUS INTEG             
         L     R1,ASSGROSS                                                      
         LTR   R1,R1                                                            
         BNZ   ASSAPL3                                                          
         TM    NBUNITST,X'08'      ASSIGNED COST INPUT                          
         BO    ASSAPL3                                                          
         BAS   RE,ACTUAL                                                        
         L     R1,ACTGROSS                                                      
ASSAPL3  A     R1,INTGROSS                                                      
         B     END                                                              
*                                                                               
BLTGA    XC    BIL2GROS,BIL2GROS                                                
******   TM    NBUNITST,X'42'      NOT FOR PRE-EMPT OR MISSED                   
******   BNZ   BLTMANO                                                          
         BAS   RE,SRRET                                                         
         MVC   FULL,BIL2GROS                                                    
         B     BLMIDAS                                                          
BLTNA    XC    BIL2NET,BIL2NET                                                  
******   TM    NBUNITST,X'42'      NOT FOR PRE-EMPT OR MISSED                   
******   BNZ   BLTMANO                                                          
         BAS   RE,SRRET                                                         
         MVC   FULL,BIL2NET                                                     
         B     BLMIDAS                                                          
**************************************                                          
BLMIDAS  TM    NBUNTSW,X'10'      MIDAS CLIENT?                                 
         BNO   BLTMANO             NO                                           
         L     R4,NBAIO            WAS IT BILLED                                
         MVI   ELCODE,X'10'                                                     
         BAS   RE,GETEL                                                         
         BE    BLTMAYS             YES                                          
BLTMANO  XC    FULL,FULL           NO                                           
BLTMAYS  L     R1,FULL                                                          
         B     END                                                              
         EJECT                                                                  
*              COMMISSION ROUTINES                                              
         SPACE 3                                                                
PAIDCOMM A     R1,NBPAYTGR         126 COMMISSION PAID                          
         A     R1,NBPAYIGR                                                      
         S     R1,NBPAYTNT                                                      
         S     R1,NBPAYINT                                                      
         B     END                                                              
         SPACE 1                                                                
PABLCOMM BAS   RE,CALCOS           127 COMMISSION PAYABLE                       
         L     R1,ACTNET                                                        
         LCR   R1,R1                                                            
         A     R1,ACTGROSS                                                      
         S     R1,NBPAYTGR                                                      
         S     R1,NBPAYIGR                                                      
         A     R1,NBPAYTNT                                                      
         A     R1,NBPAYINT                                                      
         B     END                                                              
         SPACE 1                                                                
BILLCOMM A     R1,NBBILTGR         128 COMMISSION BILLED                        
         A     R1,NBBILIGR                                                      
         S     R1,NBBILTNT                                                      
         S     R1,NBBILINT                                                      
         B     END                                                              
         SPACE 1                                                                
BABLCOMM BAS   RE,CALCOS           129 COMMISSION BILLABLE                      
         L     R1,ACTNET                                                        
         LCR   R1,R1                                                            
         A     R1,ACTGROSS                                                      
         S     R1,NBBILTGR                                                      
         S     R1,NBBILIGR                                                      
         A     R1,NBBILTNT                                                      
         A     R1,NBBILINT                                                      
         B     END                                                              
         EJECT                                                                  
*              UTILITIES                                                        
         SPACE 3                                                                
ACTUAL   NTR1                                                                   
         XC    ACTGROSS(8),ACTGROSS                                             
         TM    NBUNITST,X'42'      NOT FOR PRE-EMPT OR MISSED                   
         BNZ   *+24                                                             
         L     R1,NBACTUAL                                                      
         MVI   BYTE,C'T'                                                        
         BAS   RE,DONET                                                         
         ST    R2,ACTGROSS                                                      
         ST    R1,ACTNET                                                        
         TM    NBUNITST,X'20'      CHECK FOR ACTUAL COST BIT                    
         BNO   *+8                                                              
         OI    MASKBYTE,X'20'      PASS BACK ZERO=NOBLANK                       
         B     XIT                                                              
         SPACE 1                                                                
ASSIGN   NTR1                                                                   
         XC    ASSGROSS(8),ASSGROSS                                             
         TM    NBUNITST,X'42'      NOT FOR PRE-EMPT OR MISSED                   
         BNZ   *+24                                                             
         L     R1,NBASSIGN                                                      
         MVI   BYTE,C'T'                                                        
         BAS   RE,DONET                                                         
         ST    R2,ASSGROSS                                                      
         ST    R1,ASSNET                                                        
         TM    NBUNITST,X'08'      CHECK FOR ASSIGNED COST BIT                  
         BNO   *+8                                                              
         OI    MASKBYTE,X'20'      PASS BACK ZERO=NOBLANK                       
         B     XIT                                                              
         SPACE 1                                                                
INTEG    NTR1                                                                   
         XC    INTGROSS(8),INTGROSS                                             
         L     R1,NBINTEG                                                       
         TM    NBPACKST,X'04'      NON-COM INTEG?                               
         BNO   *+10                                                             
         LR    R2,R1               YES- INTGROSS=INTNET                         
         B     *+12                                                             
         MVI   BYTE,C'I'                                                        
         BAS   RE,DONET                                                         
         ST    R2,INTGROSS                                                      
         ST    R1,INTNET                                                        
         TM    NBUNST4,X'80'                                                    
         BNO   *+8                                                              
         OI    MASKBYTE,X'20'      YES/PASS BACK ZERO=NOBLANK                   
INTEGX   B     XIT                                                              
         SPACE 1                                                                
CALCOS   B     ACTUAL              USE ACTUAL                                   
         SPACE 1                                                                
***      A     R1,NBCALCOS         (CODE CUT OUT 1/8/87)                        
***      CLI   NBUSER+8,C'Y'       OPTION NOT TO USE ASSIGNED                   
***      BE    CALCOS2                                                          
***      TM    NBUNITST,X'20'      CHECK FOR ACTUAL COST BIT                    
***      BNO   *+8                                                              
***      OI    BYTE,X'20'          PASS BACK ZERO=NOBLANK                       
***      BR    RE                                                               
***      SPACE 1                                                                
***                                OPTION TO USE ASSIGNED                       
***COS2  TM    NBUNITST,X'08'      CHECK FOR ASSIGNED COST BIT                  
***      BNO   *+8                                                              
***      OI    BYTE,X'20'          PASS BACK ZERO=NOBLANK                       
***      BR    RE                                                               
         EJECT                                                                  
*              HANDLE NET AND OTHER ADJUSTS                                     
         SPACE 3                                                                
**DONETT   MVI   BYTE,C'T'           CLACULATE NET FOR TIME                     
**         B     DO10                                                           
**DONETI   MVI   BYTE,C'I'           CLACULATE NET FOR INTEGRATION              
**         B     DO10                                                           
**DONETS   MVI   BYTE,C'S'           CLACULATE NET FOR SPECIAL CHARGES          
**         B     DO10                                                           
*                                                                               
DONET    L     R0,=F'8500'         USE 85%                                      
         L     RF,=V(NETNET)       IF NETNET IS NOT AVAILABLE                   
         LTR   RF,RF                                                            
         BZ    DOALL                                                            
*                                                                               
         NTR1                                                                   
         CLI   BYTE,C'T'                                                        
         BE    DO20                                                             
         CLI   BYTE,C'I'                                                        
         BE    DO30                                                             
*---SET UP DMCB FOR NETNET CALL FOR SPECIAL CHARGE INPUT                        
         MVI   BYTE,C'F'           SET GROSS=NET                                
         CLI   4(R4),C'C'          SEE IF SPECIAL RATE IS COMMISIONABLE         
         BE    *+12                                                             
         CLI   4(R4),C'Y'          SEE IF SPECIAL RATE IS COMMISIONABLE         
         BNE   DO50                NO SET GROSS=NET                             
         MVC   BYTE(1),NBRTTYPE                                                 
         CLI   NBSDRTCV,0          COVERAGE=0                                   
         BE    DO50                WORK OFF OF RATE TYPE                        
         CLI   NBSDRTCV,C'A'       DOES RATE COVER SPECIAL CHARGES              
         BE    DO50                YES WORK OFF OF RATE TYPE                    
         MVI   BYTE,0              SET NET=85%GROSS                             
         B     DO50                                                             
*---SET UP DMCB FOR NETNET CALL FOR TIME CHARGE INPUT                           
DO20     MVC   BYTE,NBRTTYPE                                                    
         B     DO50                                                             
*---SET UP DMCB FOR NETNET CALL FOR INTEGRATION CHARGE INPUT                    
DO30     MVC   BYTE,NBRTTYPE                                                    
         CLI   NBSDRTCV,0          COVERAGE=0                                   
         BE    DO50                WORK OFF OF RATE TYPE                        
         CLI   NBSDRTCV,C'I'       DOES RATE COVER INTEGRATION                  
         BE    DO50                YES WORK OFF OF RATE TYPE                    
         MVI   BYTE,0              SET NET=85%GROSS                             
*                                                                               
DO50     ST    R1,RATE             ELSE PASS INFO. TO NETNET                    
         LA    R1,RELOC                                                         
         S     R1,RELOC                                                         
         AR    RF,R1                                                            
         GOTO1 (RF),PARAS,(BYTE,RATE),GROSSNET                                  
         L     R1,GROSSNET+4                                                    
         L     R2,GROSSNET                                                      
         XIT1  REGS=(R1,R2)                                                     
         SPACE 1                                                                
DO99     L     R0,=F'9930'         GET 99.3 PERCENT INTO R0                     
         SPACE 1                                                                
DOALL    SLL   R0,1                (X2)                                         
         MR    R0,R0                                                            
         D     R0,=F'10000'                                                     
         LTR   R1,R1                                                            
         BM    *+8                                                              
         AH    R1,=H'1'                                                         
         SRA   R1,1                                                             
         BR    RE                                                               
         EJECT                                                                  
*              RETRIEVE SPECIAL RATE INFORMATION                                
         SPACE 3                                                                
SRRET    NTR1                                                                   
* NBKEYSV IS CLEARED SO TBL03 IN BLDPRD MODE IS REBUILT                         
* TBL03 KEEPS A TABLE OF X'03' PAID SPECIAL CHARGES                             
* AND X'12' SPECAIL CHARGES - SINCE SRRET GOES THROUGH THE                      
* PAID SECTION FOR ALL SPECIAL CHARGE KEYWORDS THE TABEL                        
* IS CORRUPTED WHEN DOING A CLEARD SPECIAL GROSS KEYWORD                        
* BEFORE EVEN GETTING TO THE SPECIAL PAID KEYWORDS                              
* SO WE CAN NOT ONLY BUILD TABLE FOR EVERY UNIT - NEED TO                       
* BUILD IT FOR EVERY ENTRY INTO THIS ROUTINE SO IT IS FRESH                     
* FOR THE PAID SPECIAL KEYWORDS                                                 
*                                                                               
* RUN THROUGH PAID ELEMS AND TURN ON BARTER PAID FLAGS (C AND F)                
* PROBLEM IS THAT CHANGES TO UNIT CAN RESET BARTER X'03' ELEMENT                
* AND THIS RESETS PAID FLAG ON X'03' TO ZERO-THUS WRITER THINKS                 
* THE BARTER CHARGE HAS NOT BEEN PAID                                           
         NI    BRTRPDST,X'FF'-(BRTRCPD+BRTRFPD)                                 
         L     R4,NBAIO                                                         
         MVI   ELCODE,X'12'        ORDERED FROM SPECIAL RATE ELEMENT            
         BAS   RE,GETEL                                                         
         BNE   BARTX                                                            
         USING NUPAYD,R4                                                        
         B     *+12                                                             
BART01   BAS   RE,NEXTEL                                                        
         BNE   BARTX                                                            
         CLI   NUPAYTYP,C'C'                                                    
         BNE   *+8                                                              
         OI    BRTRPDST,BRTRCPD    BARTER TYPE C PAID                           
         CLI   NUPAYTYP,C'F'                                                    
         BNE   BART01                                                           
         OI    BRTRPDST,BRTRFPD    BARTFR TYPE F PAID                           
         B     BART01                                                           
BARTX    DS    0H                                                               
         DROP  R4                                                               
*                                                                               
         XC    NBKEYSV,NBKEYSV     CLEAR THIS KEY AT EVERY ENTRY                
*                                                                               
         MVC   DATADISP,=X'001B'                                                
         TM    NBINDS3,NBI3BPRD    IF BILLING PRODUCT MODE                      
         BO    SRRET00             ACCEPT ALL PRODS                             
*                                                                               
         CLI   NBSPLPRN,X'FF'      UNALLOCATED?                                 
         BE    SRRET00                                                          
         CLI   NBSPLPRN,0          IF NBSPLPRN NOT = NPRD/2                     
         BE    SRRET00             MUST BE PRD CHANGE AFTER BILLING             
         CLC   NBSPLPR3,NBPR1CL3   SKIP ORDERED/PAID SPECIAL CHARGES            
         BE    SRRET00                                                          
         CLC   NBSPLPR3,NBPR2CL3                                                
         BE    SRRET00                                                          
         CLI   NBPRDNO,0           ARE WE DEALING WITH MULTI PRODS?             
         BE    SRPAY               NO-SO SKIP BILLING                           
         BAS   RE,CHKMULT          YES-CHECK AGAINST MULT PRODUCTS              
         BE    SRRET00                                                          
         B     SRPAY               ELSE GO TO PAY                               
SRRET00  DS    0H                                                               
         TM    NBUNITST,X'42'      NOT FOR PRE-EMPT OR MISSED                   
         BNZ   SRBIL                                                            
*                                                                               
*                                                                               
         L     R4,NBAIO                                                         
         MVI   ELCODE,X'03'        ORDERED FROM SPECIAL RATE ELEMENT            
         BAS   RE,GETEL                                                         
         BNE   SRBIL                                                            
         USING NUSPRD,R4                                                        
         B     SRSR020                                                          
         SPACE 1                                                                
SRSR010  BAS   RE,NEXTEL                                                        
         BNE   SRBIL                                                            
         SPACE 1                                                                
* IN BPRD MODE NBSPLPRN MUST MATCH BILLED PRODUCT ON ELEMENT                    
* IF NO BILLED PRODUCT ON ELEMENT, ASSIGN $$ AS USUSAL TO                       
* SHCEDULED PRODUCTS - SEE NEWRI20 (SEND$TYP) FOR MORE INFO                     
SRSR020  CLI   NUSPRTYP,C'M'      IF MIDAS, SKIP                                
         BE    SRSR010                                                          
*                                                                               
         TM    NBINDS3,NBI3BPRD    BILLING PRODUCT MODE?                        
         BNO   SRSR024                                                          
         CLI   NUSPRLEN,NUSPRLN1   OLD TYPE ELEMENT?                            
         BE    SRSR022             YES-HAS NO PROD ON ELEM                      
         CLI   NUSPRBPR,0          NO-IS THERE A BILLING PRODUCT?               
         BNE   SRSR020B               YES                                       
         CLI   NUSPRLEN,NUSPRLN4      NO - 3 CHAR PROD ELEM?                    
         BNE   SRSR022                     NO-                                  
         CLI   NUSPRBPC,0                  YES- 3 CHAR BILL PROD?               
         BE    SRSR022                          NO-                             
*                                                                               
SRSR020B DS    0H                 ELEM HAS BILLED PROD                          
***** ONLY CHECK IF BILLED PROD                                                 
***** (WHEN NO BILLED PROD NEEDS TO PROCESS MULTIPLE TIMES                      
***** (WHEN THERE ARE DUPLICATE PRODS WITH DIFF PERCENTS)                       
         BAS   RE,CHKDUPRD         ALREADY DONE THIS PROD?                      
         BE    SRBIL               YES                                          
*                                                                               
         CLI   NUSPRLEN,NUSPRLN4   NEW 3 CHAR?                                  
         BNE   SRSR020D            NO-USE 1 CHAR                                
         CLC   NUSPRBPC,NBSPLPR3   YES-USE 3 CHAR                               
         BE    SRSR024             YES/PROCESS                                  
         BNE   SRSR010             NO-NEXT ELEM                                 
*                                                                               
SRSR020D CLC   NUSPRBPR,NBSPLPRN   BILLED PROD = NBSPLPRN                       
         BE    SRSR024             YES/PROCESS                                  
         B     SRSR010             NO/GET NEXT ELEM                             
                                                                                
**********************************************************                      
*NO BILLED PRODUCT, NBSPLPRN MUST MATCH A SCHEDULED PRODUCT                     
**********************************************************                      
SRSR022  DS    0H                                                               
         CLC   NBSPLPR3,NBPR1CL3                                                
         BE    SRSR024                                                          
         CLC   NBSPLPR3,NBPR2CL3                                                
         BE    SRSR024                                                          
         CLI   NBPRDNO,0           ARE THERE MULTIPLE PRODUCTS?                 
         BE    SRSR010             NO/GET NEXT ELEM                             
         BAS   RE,CHKMULT          MUST MATCH AMULTI PRODUCT                    
         BNE   SRSR010             NO MATCH-GET NEXT ELEM                       
*                                                                               
SRSR024  MVC   FULL,NUSPRAMT       PASS $$$ AMOUNT                              
         CLI   NUSPRLEN,NUSPRLN1   IF OLD TYPE ELEM(IT HAS NO PROD)             
         BE    SRSR024C            GO SPLIT $$$                                 
*                                                                               
         TM    NBINDS3,NBI3BPRD    BILLED PROD MODE?                            
         BNO   SRSR024C            NO-GO SPLIT $$$                              
*                                                                               
***********************************                                             
         CLC   NBPR1CL3,NBPR2CL3   IF BOTH BRANDS THE SAME                      
         BNE   SRSR024B                                                         
         CLI   NBSPLTYP,C'F'       ONLY PICK UP FIRST TIME                      
         BE    SRSR024B                                                         
         CLI   NBSPLTYP,0          OR WHEN UNIT UNALLOCATED                     
         BE    SRSR024B            (SINCE NBPR1 WILL = NBPR2)                   
*                                 OR IF PIGGYBACKS WITH SAME PROD               
*                                 AND THEY HAVE PROD %                          
*                                 THEN SEND THROUGH ON 2D PIGGY                 
*                                 SINCE 1ST TIME DOES NOT GET ALL $$            
         CLI   NBSPLTYP,C'S'      ??? WHAT HAPPENS WITH MULTIS?                 
         BNE   SRSR010                                                          
         OC    NBP1SHR,NBP1SHR                                                  
         BZ    SRSR010            NO % GET NEXT ELEM                            
         CLC   NBP1SHR,=X'2710'                                                 
         BE    SRSR010            100% GET ENXT ELEM                            
************************************                                            
SRSR024B CLI   NUSPRBPR,0        **IS THERE BILLED PRODUCT?                     
         BNE   SRSR024E          **THEN SKIP SPLITTING                          
         CLI   NUSPRLEN,NUSPRLN4    NEW 3 CHAR LEN?                             
         BNE   SRSR024C            NO                                           
         CLI   NUSPRBPC,0          YES-3 CHAR PROD?                             
         BNE   SRSR024E                                                         
SRSR024C BAS   RE,SPLIT            (MAY NEED TO SPLIT FOR PIGGYS)               
*                                                                               
SRSR024E MVC   BYTE,NUSPRTYP     ELSE POSSIBLE R1 NOT FILLED                    
         ICM   R1,15,FULL        FOR DONETS ROUTINE                             
         LA    R5,ORDCUT                                                        
         BAS   RE,CALSR                                                         
         SPACE 1                                                                
         CLI   NUSPRCOM,C'C'           COMMISSION='C'/'Y'                       
         BE    *+12                                                             
         CLI   NUSPRCOM,C'Y'                                                    
         BNE   SRSR025C                                                         
         MVI   BYTE,C'S'                                                        
         BAS   RE,DONET                                                         
         ST    R1,FULL                                                          
SRSR025C MVC   BYTE,NUSPRTYP                                                    
         LA    R5,ODNCUT                                                        
         BAS   RE,CALSR                                                         
         B     SRSR010                                                          
         SPACE 1                                                                
*******************************************************                         
SRBIL    L     R4,NBAIO                                                         
         MVI   ELCODE,X'10'        BILLING ELEMENT                              
         BAS   RE,GETEL                                                         
         BNE   SRPAY                                                            
         BAS   RE,CHKDUPRD         ALREADY DONE THIS PROD?                      
         BE    SRPAY               YES-GO TO PAY                                
         DROP  R4                                                               
         USING NUBILD,R4                                                        
         B     SRSR040                                                          
         SPACE 1                                                                
SRSR030  BAS   RE,NEXTEL                                                        
         BNE   SRPAY                                                            
         SPACE 1                                                                
SRSR040  CLI   NUBILTYP,C'M'       SKIP MIDAS TRADE BILLS                       
         BE    SRSR030                                                          
*                                                                               
         TM    NUBILST,X'20'         IF UNBILLED                                
         BO    SRSR030               SKIP                                       
         OC    NBBILSTR,NBBILSTR      FILTER ON START/END                       
         BZ    SRSR041                                                          
         CLC   NUBILDAT,NBBILSTR                                                
         BL    SRSR030                                                          
         CLC   NUBILDAT,NBBILEND                                                
         BH    SRSR030                                                          
SRSR041  CLI   NBSPLPR3,0          IF PRODUCT BEING HANDLED                     
         BE    SRSR042                                                          
         CLI   NBPRDNO,0           ,,IF MULT PRODS                              
         BE    SRSR041B              NO                                         
         BAS   RE,CHKMULT          ,,CHECK THEM                                 
         BE    SRSR041A            ,,YES/NBSPLPRN IS A MULTI PRODUCT            
         TM    NBINDS3,NBI3BPRD    ,,NO/IS IT BILLING PROD MODE?                
         BNO   SRSR030               NO/GET NEXT ELEM                           
SRSR041A DS    0H                  ,,MATCH FOR PRODUCT                          
*                                                                               
SRSR041B CLI   NUBILLEN,29         3 CHAR PROD?                                 
         BE    SRSR041D            YES                                          
                                                                                
*                                  NO-                                          
* NO 3 CHAR PROD ON BILLING ELEM - MUST USE 1 CHAR -                            
* NEED TO CHECK THAT NBSPLPRN IS NOT A FUDGE FOR INTERNAL                       
* NETVAL USE                                                                    
         TM    NBINDS6,NBI6XOVP    IS NBSPLPRN A FUDGE ?                        
         BO    SRSR030             YES-NO MATCH-                                
*                                                                               
         CLC   NUBILPRD,NBSPLPRN   NO                                           
         BNE   SRSR030                                                          
         B     SRSR041E                                                         
                                                                                
SRSR041D DS    0H                  3 CHAR PROD ON BILL                          
         CLC   NBSPLPR3,NUBILPRC                                                
         BNE   SRSR030                                                          
         B     SRSR041E                                                         
                                                                                
SRSR041E DS    0H                                                               
         CLI   NBPRDNO,0          IF MULTI                                      
         BNE   SRSR042            GO                                            
         CLC   NBPR1CL3,NBPR2CL3        BUT, IF ITS A BOOKEND                   
         BNE   SRSR042                  (BOTH BRANDS THE SAME)                  
         CLI   NBSPLTYP,C'F'            ONLY PICK IT UP ON FIRST                
         BNE   SRSR030                       TIME BRAND IS PROCESSED            
         B     SRSR042                                                          
*                                                                               
         SPACE 1                                                                
*                                                                               
SRSR042  ICM   RE,15,NUBILGR2                                                   
         A     RE,BIL2GROS                                                      
         ST    RE,BIL2GROS                                                      
         MVC   BYTE,NUBILTYP                                                    
         ICM   R1,15,NUBILGR2                                                   
         BAS   RE,DONET                                                         
         A     R1,BIL2NET                                                       
         ST    R1,BIL2NET                                                       
         MVC   FULL,NUBILGRS       CALCULATE GROSS DOLLARS                      
         MVC   BYTE,NUBILTYP                                                    
         LA    R5,BILCUT                                                        
         BAS   RE,CALSR                                                         
         MVC   FULL,NUBILNET       CALCULATE NET NUMBERS                        
         LA    R5,BLNCUT                                                        
         BAS   RE,CALSR                                                         
         B     SRSR030                                                          
                                                                                
         EJECT                                                                  
* PAYING                                                                        
SRPAY    CLI   NBSPLPRN,0          IF NBSPLPRN NOT = NPRD/2                     
         BE    SRPAY00             MUST BE PRD CHANGE AFTER BILLING             
*                                  SKIP ORDERED/PAID SPECIAL CHARGES            
*                                  UNLESS BLDPRD MODE                           
*                                                                               
         TM    NBINDS3,NBI3BPRD    BILLING PRODUCT MODE?                        
         BNO   SRPAYBPX            NO                                           
*                                                                               
* I NOTE THAT ROUTINE EXITS RATHER THAN GOING TO SRBIL -                        
* SEEMS TO WORK GIVEN THE NATURE OF BILL ROUTINE -                              
*                                                                               
         CLI   NBPRDNO,0           IF MULTI                                     
         BNE   SRPB01              YES                                          
         CLC   NBPR1CL3,NBPR2CL3   NO-SAME PIGGY?                               
         BNE   SRPB01                 NO                                        
         CLI   NBSPLTYP,C'F'          YES - FIRST TIME IN                       
         BE    SRPB01                       YES -                               
         OC    NBP1SHR,NBP1SHR              NO-DOES IT HAVE PROD % ?            
         BZ    SREXIT                          NO-THAT'S ALL                    
         CLC   =X'2710',NBP1SHR                YES-IF 100%                      
         BE    SREXIT                              THAT'S ALL                   
         B     SRPB01                              ELSE SEND THROUGH            
***************************************                                         
SRPB01   DS    0H                                                               
*                                                                               
         CLC   NBKEYSV,NBKEY       SAME UNIT?                                   
         BE    SRPB02              YES-TBL03 ALREADY SET                        
         MVC   NBKEYSV,NBKEY       SAVE NEW UNIT KEY                            
         MVI   BYTE,X'FF'          SET BYTE TO CLEAR TABLE/BUILD                
         BRAS  RE,CLSCHK           DO TBL03                                     
SRPB02   L     R4,NBAIO                                                         
         MVI   ELCODE,X'03'        YES/GET PAY FROM X'03' ELEMS                 
         USING NUSPREL,R4                                                       
         BAS   RE,GETEL                                                         
         BNE   SREXIT                                                           
         B     SRPB10                                                           
SRPB05   BAS   RE,NEXTEL                                                        
         BNE   SREXIT                                                           
*                                                                               
SRPB10   DS    0H                                                               
         CLI   NUSPRLEN,NUSPRLN1   OLD STYLE?                                   
         BE    SRPB17              YES-KEEP IT/GO TO NO BILLED PROD             
*                                                                               
         TM    NUSPRSTA,NUSPRCPD   PAID?                                        
         BO    SRPB10B             YES                                          
         CLI   NUSPRTYP,C'C'       C TYPE                                       
         BNE   *+12                NO                                           
         TM    BRTRPDST,BRTRCPD    C PAID ?                                     
         BO    SRPB10B             YES                                          
         CLI   NUSPRTYP,C'F'       F TYPE                                       
         BNE   SRPB05              NO                                           
         TM    BRTRPDST,BRTRFPD    F PAID ?                                     
         BNO   SRPB05              NO                                           
*                                                                               
*                                                                               
SRPB10B  TM    NUSPRSTA,NUSPRPRE   MISSED/PRE-EMPT?                             
         BO    SRPB05              YES- SKIP                                    
         B     SRPB11                                                           
*                                                                               
*IF REQUESTED PROD = BILLED PROD, ALL DOLLARS GO TO THAT PROD                   
*IF NO BILLED PROD:                                                             
*IF NBSPLPRN IS NOT A SCHEDULED PROD, THEN SKIP IT                              
*IF NBSPLPRN IS A SCHEDULED PROD, SPLIT ITS DOLLARS                             
SRPB11   CLI   NUSPRBPR,0          1 BYTE BILLED PRODUCT ELEM?                  
         BNE   SRPB12              YES                                          
         CLI   NUSPRLEN,NUSPRLN4   NO-3 CHAR PROD?                              
         BNE   SRPB17                 NO                                        
         OC    NUSPRBPC,NUSPRBPC      YES-ASSIGNED TO A PRODUCT?                
         BZ    SRPB17                     NO                                    
         CLC   NBSPLPR3,NUSPRBPC          YES-3 CHAR PROD MATCH ?               
         BNE   SRPB05                         NO MATCH-NEXT ELEM                
         B     SRPB13                         YES MATCH PROCESS                 
                                                                                
* X'03' HAS A 1 BYTE PROD CODE NOT 3 CHAR PROD CODE                             
SRPB12   CLC   NBSPLPRN,NUSPRBPR   BILLED=REQUESTED PROD?                       
         BNE   SRPB05              NO-GET NEXT ELEM                             
SRPB13   MVC   FULL,NUSPRAMT       YES-SO NO SPLIT                              
************************************                                            
         MVC   BYTE,NUSPRTYP                                                    
         BRAS  RE,CLSCHK           CHECK 03 PAID VS 12 PAID                     
         OC    FULL,FULL                                                        
         BZ    SRPB05                                                           
SRPB16   B     SRPB22                                                           
                                                                                
* NO BILLED PROD - CHECK IF NBSPLPRN IS A SCHEDULED PROD                        
SRPB17   DS    0H                                                               
         CLC   NBSPLPR3,NBPR1CL3                                                
         BE    SRPB20                                                           
         CLC   NBSPLPR3,NBPR2CL3                                                
         BE    SRPB20                                                           
         CLI   NBPRDNO,0           ARE THERE MULTIPLE PRODUCTS?                 
         BE    SRPB05              NO/SKIP THIS ELEM                            
         BAS   RE,CHKMULT          MUST MATCH AMULTI PRODUCT                    
         BNE   SRPB05              NO MATCH-GET NEXT ELEM                       
                                                                                
*                                                                               
SRPB20   MVC   FULL,NUSPRAMT       CALCULATE GROSS DOLLARS                      
************************************                                            
         MVC   BYTE,NUSPRTYP                                                    
         BRAS  RE,CLSCHK           CHECK 03 PAID VS 12 PAID                     
         OC    FULL,FULL                                                        
         BZ    SRPB05                                                           
**************************************                                          
         BAS   RE,SPLIT                                                         
SRPB22   ICM   R1,15,FULL          COMES HERE IF NOT SPLITTING                  
         MVC   BYTE,NUSPRTYP                                                    
         LA    R5,PAYCUT                                                        
         BAS   RE,CALSR                                                         
         CLI   NUSPRCOM,C'C'            COMMISSION?                             
         BE    *+12                                                             
         CLI   NUSPRCOM,C'Y'            COMMISSION?                             
         BNE   SRPB23                  NO                                       
         MVI   BYTE,C'S'                                                        
         BAS   RE,DONET                                                         
         ST    R1,FULL                                                          
SRPB23   MVC   BYTE,NUSPRTYP                                                    
         LA    R5,PYNCUT                                                        
         BAS   RE,CALSR                                                         
         B     SRPB05                                                           
********************************************************                        
         EJECT                                                                  
SRPAYBPX EQU   *                                                                
         CLC   NBSPLPR3,NBPR1CL3                                                
         BE    SRPAY00                                                          
         CLC   NBSPLPR3,NBPR2CL3                                                
         BE    SRPAY00                                                          
         BAS   RE,CHKMULT          CHECK IF MULT PRODS                          
         BE    SRPAY00                                                          
         B     SREXIT                                                           
SRPAY00  L     R4,NBAIO                                                         
         MVI   ELCODE,X'12'        PAYING ELEMENT                               
         BAS   RE,GETEL                                                         
         BNE   SREXIT                                                           
         DROP  R4                                                               
         USING NUPAYD,R4                                                        
         B     SRSR060                                                          
         SPACE 1                                                                
SRSR050  BAS   RE,NEXTEL                                                        
         BNE   SREXIT                                                           
         SPACE 1                                                                
SRSR060  OC    NBPAYSTR,NBPAYSTR   FILTER ON PAID START/END                     
         BZ    SRSR061                                                          
         CLC   NUPAYDAT,NBPAYSTR                                                
         BL    SRSR050                                                          
         CLC   NUPAYDAT,NBPAYEND                                                
         BH    SRSR050                                                          
SRSR061  DS    0H                                                               
*                                                                               
SRSR070  MVC   FULL,NUPAYGRS       CALCULATE GROSS DOLLARS                      
         BAS   RE,SPLIT                                                         
         ICM   R1,15,FULL                                                       
         MVC   BYTE,NUPAYTYP                                                    
         LA    R5,PAYCUT                                                        
         BAS   RE,CALSR                                                         
         MVC   FULL,NUPAYNET       CALCULATE NET NUMBERS                        
         BAS   RE,SPLIT                                                         
         ICM   R1,15,FULL                                                       
         LA    R5,PYNCUT                                                        
         BAS   RE,CALSR                                                         
         B     SRSR050                                                          
         SPACE 1                                                                
SREXIT   DS    0H                                                               
         B     XIT                                                              
         SPACE 1                                                                
* - FULL HAS VALUE TO BE SPLIT                                                  
SPLIT    NTR1                                                                   
         CLI   NBPRDNO,0           ,,IF MULT PRODS                              
         BE    SPLIT0                                                           
         CLI   NBSPLPRN,0                                                       
         BE    XIT                                                              
         XC    OUTAREA,OUTAREA     ,,DO SPECIAL PROD PROCESSING                 
         ICM   R2,15,FULL            VALUE TO SPLIT                             
         MVC   PARAS,NBAPROD                 ADDR OF MULT PROD ELEM             
         MVC   PARAS(1),NBSPLCNT             RETURN SPECIFIC PROD DATA          
         L     RF,=V(NEPACC)                                                    
         LA    R1,RELOC                                                         
         S     R1,RELOC                                                         
         AR    RF,R1                                                            
         GOTO1 (RF),PARAS,,(R2),(1,OUTAREA),NETBLOCK                            
         MVC   FULL,OUTAREA                                                     
         B     XIT                                                              
*                                                                               
SPLIT0   CLI   NBSPLPRN,0                                                       
         BE    XIT                                                              
         CLI   NBPR2CL3,0          ONLY NEEDED IF 2 PRODUCTS                    
         BE    XIT                                                              
         SR    R1,R1               OR NOTHING ?                                 
         OC    NBP1SHR,NBP1SHR                                                  
         BZ    SPLIT2                                                           
         MVC   DUB(2),NBP1SHR                                                   
         LH    R1,DUB                                                           
         SPACE 1                                                                
SPLIT2   M     R0,FULL             FIGURE OUT FIRST PROD SHARE                  
         D     R0,=F'10000'                                                     
         CLC   NBSPLPR3,NBPR1CL3   .IF NOT FIRST PRODUCT                        
         BNE   SPLIT3              .CALCULATE 2ND PROD SHARE                    
         CLC   NBPR1CL3,NBPR2CL3   ..IS IT BOOKENDS                             
         BNE   SPLIT4              ..NO                                         
         CLI   NBSPLTYP,C'F'       YES/FIRST                                    
         BE    SPLIT4                                                           
SPLIT3   LR    R0,R1                                                            
         L     R1,FULL                                                          
         SR    R1,R0               REST FOR SECOND PRODUCT                      
         SPACE 1                                                                
SPLIT4   ST    R1,FULL                                                          
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
* - SEE IF PRODUCT IN PRODLIST OF MULT PROD UNIT                                
CHKMULT  NTR1                                                                   
         CLI   NBPRDNO,0           ARE THERE MULTIPLE PRODS                     
         BE    CKYES               NO - EXIT WITH OK                            
         ICM   R2,15,NBADPLST      3 CHAR PORD LIST                             
         BNZ   *+6                                                              
         DC    H'0'                                                             
         ZIC   R1,NBPRDNO                                                       
CK5      CLC   NBSPLPR3,0(R2)                                                   
         BE    CKYES               IT'S A MATCH - OK                            
         LA    R2,3(R2)                                                         
         BCT   R1,CK5                                                           
         B     CKNO                                                             
CKYES    SR    R2,R2                                                            
CKNO     LTR   R2,R2                                                            
         B     XIT                                                              
*                                                                               
CHKDUPRD NTR1                                                                   
         CLI   NBSPLCNT,1          ARE WE ON FIRST PROD?                        
         BNH   CHKDOK                                                           
         ZIC   R1,NBSPLCNT         R1=CURRENT PROD IN LIST                      
         BCTR  R1,0                FOR BCT                                      
         ICM   R2,15,NBADPLST                                                   
         BNZ   *+6                                                              
         DC    H'0'                                                             
CHKD02   CLC   NBSPLPR3,0(R2)                                                   
         BE    CHKD                                                             
         LA    R2,3(R2)                                                         
         BCT   R1,CHKD02                                                        
CHKDOK   LTR   RE,RE                                                            
CHKD     XIT1                                                                   
         EJECT                                                                  
*              ACCUMULATOR FOR SPECIAL RATE INFO                                
        SPACE 3                                                                 
*              INPUT               BYTE=TYPE FIELD FROM ELEMENT                 
*                                  FULL=AMOUNT TO BE ADDED                      
*                                  R5=A(FIELDS TO BE ADDED TO)                  
         SPACE 1                                                                
CALSR    NTR1                                                                   
*                                  CALCULATE NUMBERS FROM SPECIAL               
*                                  RATE ELEMENT                                 
         LA    R7,SRTAB                                                         
         LR    R6,R5                                                            
         SPACE 1                                                                
CSR020   CLC   BYTE,0(R7)                                                       
         BE    CSR060                                                           
         LA    R7,1(R7)                                                         
         CLI   0(R7),C' '                                                       
         BE    CALSEXIT                                                         
         LA    R6,4(R6)                                                         
         B     CSR020                                                           
         SPACE 1                                                                
CSR060   L     RE,0(R6)                                                         
         A     RE,FULL                                                          
         ST    RE,0(R6)                                                         
         SPACE 1                                                                
         TM    NBINDS4,NBI4ECOP        INCLUDE EARNED COST ?                    
         BO    CSR061                                                           
         CLI   BYTE,C'Q'               EARNED COST SPECIAL CHARGE ?             
         BE    CALSEXIT                YES-DON'T ADD TO TOTALS                  
CSR061   DS    0H                                                               
         L     RE,48(R5)                                                        
         A     RE,FULL                                                          
         ST    RE,48(R5)                                                        
         SPACE 1                                                                
CALSEXIT B     XIT                                                              
         SPACE 1                                                                
SRTAB    DC    CL15'UBSXAEOLDQCF   '           NOTE LENGTH !!!                  
         DC    X'40'                                                            
         EJECT                                                                  
*              EXITS AND ODDMENTS                                               
         SPACE 3                                                                
END      OC    ADJPCT,ADJPCT       ANY ADJUSTMENT REQUESTED                     
         BZ    NOADJ                                                            
         MVC   FULL,=F'10000'      2 DECIMAL DEFAULT                            
         MVC   BYTE,ADJPCT                                                      
         CLI   BYTE,2                                                           
         BNH   DOADJ                                                            
         L     RE,FULL                                                          
ELOOP    MH    RE,=H'10'                                                        
         ST    RE,FULL                                                          
         ZIC   R0,BYTE                                                          
         BCTR  R0,0                                                             
         CH    R0,=H'2'                                                         
         BE    DOADJ                                                            
         STC   R0,BYTE                                                          
         B     ELOOP                                                            
DOADJ    L     R0,ADJPCT                                                        
         SLL   R0,8                                                             
         SRL   R0,7                                                             
         MR    R0,R0                                                            
         D     R0,FULL                                                          
         LTR   R1,R1                                                            
         BM    *+8                                                              
         AH    R1,=H'1'                                                         
         SRA   R1,1                                                             
         SPACE 1                                                                
NOADJ    CVD   R1,DUB                                                           
         MVC   0(1,R3),MASKBYTE    PASS BACK EDIT BYTE                          
         MVC   1(8,R3),DUB         AND 8-BYTE PACKED VALUE                      
         SPACE 1                                                                
XIT      XIT1                                                                   
         EJECT                                                                  
*              CALLED TO ADJUST BETWEEN ADDS/SUB ETC.                           
         SPACE 3                                                                
ADJST    NTR1                                                                   
         OC    ADJPCT,ADJPCT       ANY ADJUSTMENT REQUESTED                     
         BZ    ADJX                                                             
         MVC   FULL,=F'10000'      2 DECIMAL DEFAULT                            
         MVC   BYTE,ADJPCT                                                      
         CLI   BYTE,2                                                           
         BNH   DOADJS                                                           
         L     RE,FULL                                                          
         SPACE 1                                                                
ELOOPS   MH    RE,=H'10'                                                        
         ST    RE,FULL                                                          
         ZIC   R0,BYTE                                                          
         BCTR  R0,0                                                             
         CH    R0,=H'2'                                                         
         BE    DOADJS                                                           
         STC   R0,BYTE                                                          
         B     ELOOPS                                                           
         SPACE 1                                                                
DOADJS   L     R0,ADJPCT                                                        
         SLL   R0,8                                                             
         SRL   R0,7                                                             
         MR    R0,R0                                                            
         D     R0,FULL                                                          
         LTR   R1,R1                                                            
         BM    *+8                                                              
         AH    R1,=H'1'                                                         
         SRA   R1,1                                                             
         SPACE 1                                                                
ADJX     XIT1  REGS=(R1)                                                        
         SPACE 1                                                                
         GETEL R4,DATADISP,ELCODE                                               
         SPACE 1                                                                
RELOC    DC    A(*)                                                             
         EJECT                                                                  
*                                  LTORG                                        
NBKEYSV  DS    CL20                                                             
         LTORG                                                                  
                                                                                
**************************************************                              
*WHEN USING BLDPRD AND FIRST TIME THROUGH FOR A UNIT                            
*CHECKS SPECIAL CHARGE PAID ELEMENTS BY TYPE                                    
*AGAINST X'12' PAID ELEMS BY TYPE                                               
*IF DOLLARS DON'T MATCH USES X'12' DOLLARS AND ASSIGNS                          
*ALL TO FIRST PRODUCT ON UNIT                                                   
* R4-> POINTS TO X'03' ELEMENT                                                  
*******************************************************                         
CLSCHK   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         CLI   BYTE,X'FF'          CLEAR TABLE                                  
         BNE   CLS10                                                            
         LA    R1,TBL03                                                         
         XC    0(250,R1),0(R1)                                                  
         LA    R1,250(R1)                                                       
         XC    0(200,R1),0(R1)                                                  
*                                                                               
CLS10    LA    R2,TBL03            TABLE FILLED?                                
         CLI   0(R2),0                                                          
         BNE   CLS20               YES                                          
         BAS   R5,CREATBL          LOAD X'03'/X'12' TABLES                      
         B     CLSXX                                                            
*                                                                               
CLS20    BAS   R5,CMPTBLS          COMPARE TABLES                               
         B     CLSXX                                                            
*                                                                               
CLSXX    XIT1                                                                   
*                                                                               
**********************************************************                      
* COMPARE 03 PAID AGAINST 12 PAID FOR EACH SPECIAL CHARGE                       
* IF TOTALS NOT EQUAL                                                           
* USE X'12' TOTAL AND ASSIGN IT ALL TO FIRST PRODUCT                            
************************************************************                    
CMPTBLS  DS    0H                                                               
         LA    R1,TBL03                                                         
CMP10    CLI   0(R1),0                                                          
         BNE   *+6                                                              
         DC    H'0'                MUST BE IN TABLE                             
         CLI   0(R1),X'FF'         EOF                                          
         BNE   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         CLC   BYTE,0(R1)                                                       
         BE    CMP12                                                            
         LA    R1,9(R1)                                                         
         B     CMP10                                                            
*                                                                               
CMP12    CLC   1(4,R1),5(R1)    X'03'=X'12' ?                                   
         BER   R5               YES- NORMAL PROCESSING                          
*                                                                               
* NOT EQUAL GIVE IT TO 1ST PROD ON UNIT- ELSE PASS ZEROS                        
         CLC   5(4,R1),=4X'FF'     ALL TO 1ST PROD ALREADY?                     
         BE    CMP15               YES- PASS BACK ZEROS                         
         CLC   NBSPLPR3,NBPR1CL3   WE ARE DEALING WITH 1ST PROD?                
         BE    CMP17               YES-1ST PROD                                 
         CLI   NBPRDNO,0           NO-MULTIPRODS?                               
         BE    CMP15                  NOT MULTI                                 
         L     R2,NBAPROD             YES MULTI                                 
         LTR   R2,R2                                                            
         BNZ   *+6                                                              
         DC    H'0'                                                             
         USING NXBLKD,R2                                                        
         CLC   NBSPLPR3,NXPCL3     ARE WE DEALING WITH 1ST MULTI                
         BE    CMP17               YES-1ST PROD                                 
CMP15    XC    FULL,FULL           NOT FIRST PROD-PASS ZEROS                    
         BR    R5                                                               
CMP17    MVC   FULL,5(R1)          1ST PROD-USE X'12' AMOUNT                    
         MVC   5(4,R1),=4X'FF'     SET ALREADY PASSED FLAG                      
         BR    R5                                                               
         DROP  R2                                                               
*                                                                               
**********************************************************                      
* READ 03 ELEMENTS - CREAT TOTALS FOR EACH PAID SPECIAL CHARGE TYPE             
* READ 12 ELEMENTS - CREAT TOTAL FOR EACH SPECIAL CHARGE TYPE                   
* TABLE = CL1(TYPE),XL4(03 CHARGE),XL4( 12 CHARGE)                              
* ROOM FOR 50 SPECIAL CHARGES                                                   
************************************************************                    
CREATBL  DS    0H                                                               
         XC    TBL03,TBL03                                                      
         L     R4,NBAIO            FILL TBL WITH TYPE+$$$                       
         MVI   ELCODE,X'03'                                                     
         BAS   RE,GETEL                                                         
         BNE   CRTXX                                                            
         B     CRT10                                                            
CRT05    BAS   RE,NEXTEL                                                        
         BE    CRT10                                                            
         B     CRT20               NO MORE X'03' ELEMENTS                       
         USING NUSPREL,R4                                                       
CRT10    CLI   NUSPRLEN,NUSPRLN1   OLD STYLE?                                   
         BE    CRT12               YES-ACCEPT-                                  
*                                                                               
         TM    NUSPRSTA,NUSPRCPD   NO-PAID?                                     
         BO    CRT12               YES                                          
*                                                                               
         TM    BRTRPDST,(BRTRCPD+BRTRFPD)  C OR F PAID                          
         BZ    CRT05                                                            
         CLI   NUSPRTYP,C'C'       C BARTER TYPE                                
         BNE   *+12                                                             
         TM    BRTRPDST,BRTRCPD                                                 
         BO    CRT12                                                            
         CLI   NUSPRTYP,C'F'                                                    
         BNE   CRT05                                                            
         TM    BRTRPDST,BRTRFPD                                                 
         BNO   CRT05                                                            
*                                                                               
CRT12    LA    R2,TBL03                                                         
*                                                                               
CRT15    CLI   0(R2),0                                                          
         BE    CRT17                                                            
         CLC   0(1,R2),NUSPRTYP                                                 
         BE    CRT17                                                            
         LA    R2,9(R2)            BUMP TO NXT TYPE                             
         B     CRT15                                                            
*                                                                               
CRT17    MVC   0(1,R2),NUSPRTYP                                                 
         ICM   RE,15,NUSPRAMT      PAID SPECIAL CHARGE                          
         ICM   RF,15,1(R2)         ADD TO TABLE                                 
         AR    RF,RE                                                            
         STCM  RF,15,1(R2)                                                      
         B     CRT05               NEXT EL                                      
         DROP  R4                                                               
***************************************************************                 
CRT20    DS    0H                  NOW HANDLE X'12' SPECIAL CHARGES             
         L     R4,NBAIO                                                         
         USING NUPAYEL,R4                                                       
         MVI   ELCODE,X'12'      PAY ELEMENTS                                   
         BAS   RE,GETEL                                                         
         BE    CRT27                                                            
         B     CRTXX              MUST BE HERE                                  
*                                                                               
CRT25    BAS   RE,NEXTEL                                                        
         BNE   CRTXX                                                            
CRT27    CLI   NUPAYTYP,C'T'       ONLY WANT SPECIAL CHARGES                    
         BE    CRT25                                                            
         CLI   NUPAYTYP,C'I'                                                    
         BE    CRT25                                                            
         LA    R2,TBL03                                                         
*                                                                               
CRT30    CLI   0(R2),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                TABLE FULL                                   
         CLI   0(R2),0                                                          
         BE    CRT40                                                            
         CLC   0(1,R2),NUPAYTYP    PAY TYPE MATCH                               
         BE    CRT40                                                            
         LA    R2,9(R2)            BUMP TO NXT TBL AREA                         
         B     CRT30                                                            
*                                                                               
CRT40    MVC   0(1,R2),NUPAYTYP                                                 
         ICM   RE,15,NUPAYGRS                                                   
         ICM   RF,15,5(R2)                                                      
         AR    RF,RE                                                            
         STCM  RF,15,5(R2)                                                      
         B     CRT25               GET NEXT X'12'                               
CRTXX    BR    R5                                                               
*                                                                               
         LTORG                                                                  
*                                                                               
TBL03    DC    450X'00'            TABLE FOR 50                                 
         DC    X'FF'               CL1(TYPE),XL4(03 $$),XL4(12 $$)              
         SPACE 1                                                                
*                                  DSECT FOR MODULE                             
NETACCD  DSECT                                                                  
DUB      DS    D                                                                
ADJPCT   DS    F                                                                
FULL     DS    F                                                                
RATE     DS    F                                                                
GROSSNET DS    D                                                                
PARAS    DS    6F                                                               
OUTAREA  DS    6F                                                               
BYTE     DS    CL1                                                              
MASKBYTE DS    CL1                                                              
BRTRPDST DS    XL1                 BARTER PAID STATUS                           
BRTRCPD  EQU   X'01'               "C" ACTUAL BARTER PAID                       
BRTRFPD  EQU   X'02'               "F" ASSIGNED BARTER PAID                     
SPAREIND DS    XL1                 SPARE INDICATOR                              
*                                                                               
SVAREA   DS    F                                                                
         SPACE 1                                                                
*                                  GROSS SPECIAL AMOUNTS                        
ORDCUT   DS    F                   CUT-IN                                       
ORDBLK   DS    F                   BLACKOUT                                     
ORDCOP   DS    F                   COPY -SPLIT                                  
ORDTAX   DS    F                   TAX                                          
ORDADM   DS    F                   ADMINISTRATION                               
ORDSEC   DS    F                   SECTIONAL                                    
ORDOTH   DS    F                   OTHER                                        
ORDLATE  DS    F                   LATE                                         
ORDDELV  DS    F                   DELIVERY ADJUSTMENT                          
ORDERNC  DS    F                   EARNED COST                                  
ORDTRDC  DS    F                   ACTUAL COST TRADE CREDIT                     
ORDTRAS  DS    F                   ASSIGN COST TRADE CREDIT                     
ORDTOT   DS    F                   TOTAL                                        
         SPACE 1                                                                
*                                  GROSS PAID AMOUNTS                           
PAYCUT   DS    F                   CUT-IN                                       
PAYBLK   DS    F                   BLACKOUT                                     
PAYCOP   DS    F                   COPY-SPLIT                                   
PAYTAX   DS    F                   TAX                                          
PAYADM   DS    F                   ADMINISTRATION                               
PAYSEC   DS    F                   SECTIONAL                                    
PAYOTH   DS    F                   OTHER                                        
PAYLATE  DS    F                   LATER                                        
PAYDELV  DS    F                   DELIV ADJ                                    
PAYERNC  DS    F                   EARNED COST                                  
PAYTRDC  DS    F                   TRADE CREDIT                                 
PAYTRAS  DS    F                   ASSIGNED TRADE CREDIT                        
PAYTOT   DS    F                   TOTAL                                        
         SPACE 1                                                                
*                                  GROSS BILLED AMOUNTS                         
BILCUT   DS    F                   CUT-IN                                       
BILBLK   DS    F                   BLACKOUT                                     
BILCOP   DS    F                   COPY SPLIT                                   
BILTAX   DS    F                   TAX                                          
BILADM   DS    F                   ADMINISTRATION                               
BILSEC   DS    F                   SECTIONAL                                    
BILOTH   DS    F                   OTHER                                        
BILLATE  DS    F                   LATE                                         
BILDELV  DS    F                   DELIV ADJ                                    
BILERNC  DS    F                   EARNED COST                                  
BILTRDC  DS    F                   TRADE CREDIT                                 
BILTRAS  DS    F                   ASSIGNED TRADE CREDIT                        
BILTOT   DS    F                   TOTAL                                        
         SPACE 1                                                                
*                                  NET SPECIAL AMOUNTS                          
ODNCUT   DS    F                   CUT-IN                                       
ODNBLK   DS    F                   BLACKOUT                                     
ODNCOP   DS    F                   COPY -SPLIT                                  
ODNTAX   DS    F                   TAX                                          
ODNADM   DS    F                   ADMINISTRATION                               
ODNSEC   DS    F                   SECTIONAL                                    
ODNOTH   DS    F                   OTHER                                        
ODNLATE  DS    F                   LATE                                         
ODNDELV  DS    F                   DELIV ADJ                                    
ODNERNC  DS    F                   EARNED COST                                  
ODNTRDC  DS    F                   TRADE CREDIT                                 
ODNTRAS  DS    F                   ASSIGNED TRADE CREDIT                        
ODNTOT   DS    F                   TOTAL                                        
         SPACE 1                                                                
*                                  NET PAID AMOUNTS                             
PYNCUT   DS    F                   CUT-IN                                       
PYNBLK   DS    F                   BLACKOUT                                     
PYNCOP   DS    F                   COPY-SPLIT                                   
PYNTAX   DS    F                   TAX                                          
PYNADM   DS    F                   ADMINISTRATION                               
PYNSEC   DS    F                   SECTIONAL                                    
PYNOTH   DS    F                   OTHER                                        
PYNLATE  DS    F                   LATE                                         
PYNDELV  DS    F                   DELIV ADJ                                    
PYNERNC  DS    F                   EARNED COST                                  
PYNETRD  DS    F                   TRADE CREDIT                                 
PYNETRA  DS    F                   ASSIGNED TRADE CREDIT                        
PYNTOT   DS    F                   TOTAL                                        
                                                                                
*                                  NET BILLED AMOUNTS                           
         SPACE 1                                                                
BLNCUT   DS    F                   CUT-IN                                       
BLNBLK   DS    F                   BLACKOUT                                     
BLNCOP   DS    F                   COPY SPLIT                                   
BLNTAX   DS    F                   TAX                                          
BLNADM   DS    F                   ADMINISTRATION                               
BLNSEC   DS    F                   SECTIONAL                                    
BLNOTH   DS    F                   OTHER                                        
BLNLATE  DS    F                   LATE                                         
BLNDELV  DS    F                   DELIV ADJ                                    
BLNERNC  DS    F                   EARNED COST                                  
BLNTRDC  DS    F                   TRADE CREDIT                                 
BLNTRDA  DS    F                   ASSIGNED TRADE CREDIT                        
BLNTOT   DS    F                   TOTAL                                        
         SPACE 1                                                                
ACTGROSS DS    F                   ACTUAL GROSS                                 
ACTNET   DS    F                   ACTUAL NET                                   
ASSGROSS DS    F                   ASSIGNED GROSS                               
ASSNET   DS    F                   ASSIGNED NET                                 
INTGROSS DS    F                   INTEGRATION GROSS                            
INTNET   DS    F                   INTEGRATION NET                              
BIL2GROS DS    F                   BILLED 2ND GROSS                             
BIL2NET  DS    F                   BILLED 2ND NET                               
         SPACE 1                                                                
DATADISP DS    H                    GETEL SUPPORT                               
ELCODE   DS    CL1                                                              
WRKLENE  EQU   *-DUB                                                            
         SPACE 1                                                                
*                                  NETBLOCK HERE                                
         PRINT OFF                                                              
       ++INCLUDE NETXBLKD                                                       
NETBLKD  DSECT                                                                  
       ++INCLUDE NETBLOCKN                                                      
NETBUYR  DSECT                                                                  
       ++INCLUDE NEGENUNIT                                                      
         PRINT ON                                                               
         SPACE 1                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'014NENETACCN 05/08/13'                                      
         END                                                                    
