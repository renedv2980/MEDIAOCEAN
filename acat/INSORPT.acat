*          DATA SET INSORPT    AT LEVEL 019 AS OF 04/14/03                      
*CATALP INSORPT                                                                 
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
         TITLE 'PRINTPAK - ON-LINE PRINT CONTROLLER'                            
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
* KWAN 08/12/02 SECOND FAX                                                      
*                                                                               
* KWAN 05/21/02 REPLACE GETFAX WITH FXKYL= KEYWORD                              
*                                                                               
* KWAN 08/03/01 NEED TO BE RE-CATELP FOR LARGER RECORD AREAS IN POLFILE         
*                                                                               
* BPLA 06/00    NOW LIVE SOURCE (WAS INSORPB)                                   
*               CATALP AND ++INCLUDE T413WKA RESTORED                           
*                                                                               
* BPLA 02/00    COPY OF INSORPT LEVEL 11 MADE 02/09/00                          
*               T413WKAB FOR T413WKA                                            
*                                                                               
* SMYE 07/30/97 REMOVE 6/23/97 USE OF CLIENT CODE FROM GETFAX                   
*                                                                               
* SMYE 06/23/97 ADD USE OF CLIENT CODE TO GET FAX NUMBER                        
*               FROM CONTROL FILE FAX REC                                       
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
IREPORT  CSECT                                                                  
         NMOD1 (PPREPDX-PPREPD),IREPORT                                         
*                                                                               
         USING PPREPD,RC                                                        
         USING IOWORKD,R8                                                       
         USING POLWRKD,R9                                                       
         USING POLFILED,RA                                                      
         L     RA,PPFILEC                                                       
         L     R7,VTWA                                                          
         USING T413FFD,R7                                                       
*                                                                               
* OPTION JUST TO CLEAR ALL PRINT LINES                                          
*                                                                               
         CLI   FORCECLR,C'N'                                                    
         BE    PC4                                                              
         MVI   FORCECLR,C'N'                                                    
         B     PC15                                                             
*                                                                               
* CONTROL SPEC PROCESSING                                                       
*                                                                               
PC4      CLI   SKIPSPEC,C'Y'                                                    
         BE    PC6                                                              
         CLI   FORCEHED,C'Y'       DONT EXECUTE SPECS IF                        
         BE    PC5                 JUST HANDLING PLINES                         
         CLI   FORCEMID,C'Y'                                                    
         BE    PC5                                                              
         CLI   FORCEFUT,C'Y'                                                    
         BE    PC5                                                              
         CLC   LINE,MAXLINES                                                    
         BL    PC14                                                             
*                                                                               
PC5      BAS   RE,PROCSPEC                                                      
*                                                                               
* CONTROL OF HEADLINE PRINTING                                                  
*                                                                               
PC6      CLI   FORCEHED,C'N'                                                    
         BE    PC8                                                              
         MVI   FORCEHED,C'N'                                                    
         B     PC10                                                             
*                                                                               
PC8      CLC   LINE,MAXLINES                                                    
         BL    PC12                                                             
*                                                                               
PC10     MVI   FORCEMID,C'Y'                                                    
         GOTO1 PRINT,P1,SPACES,=C'BC01',VTIA,VDATAMGR                           
*                                                                               
         CLI   QOPT7,C'F'          SEE IF FAXING                                
         BNE   PC10X                                                            
*                                                                               
PC10D    MVI   FTIME,C'Y'                                                       
         L     R2,AFAXBUF                                                       
         CLC   0(5,R2),=C'START'   SEE IF FIRST TIME                            
         BE    *+8                                                              
         MVI   FTIME,C'N'                                                       
         CLI   FTIME,C'Y'                                                       
         BNE   PC10P                                                            
*                                                                               
* NOTE: NO SKIP TO CHANNEL 1 NEEDED                                             
* IF FAXING  (/PAGE WILL CAUSE NEW PAGE)                                        
*                                                                               
         MVC   SVFAX,MYFAX         TO CHECK FAX NUMBER CHANGES LATER            
         MVC   MYPLINE,SPACES                                                   
*                                                                               
         MVC   WU9FB(5),=C'*HDR*'                                               
         MVC   WUDESTID(4),=C'FAXL'                                             
         MVC   WUDESTID+5(12),MYFAX                                             
*                                                                               
         CLC   MYFAX(5),=C'MB=62'  CHECK FOR EASY-LINK MAIL BOX                 
         BNE   PC10F               (THEY ALL MUST BEGIN WITH 62)                
         MVC   WUDESTID(17),SPACES                                              
         MVC   WUDESTID(8),MYFAX+3 MOVE MAIL BOX NUMBER                         
         B     PC10G                                                            
*                                                                               
PC10F    CLC   MYFAX(3),=C'FX='    CHECK FOR FAX CODE                           
         BNE   PC10G                                                            
*                                                                               
         MVC   WUDESTID(17),SPACES                                              
         MVC   WUDESTID(6),=C'FXKYL='                                           
         MVC   WUDESTID+6(9),MYFAX+3                                            
*                                                                               
PC10G    MVC   WUBILL(1),PRQMED                                                 
         MVC   WUBILL+1(3),PRQCLT                                               
         MVC   WUBILL+4(3),PRQPRD                                               
*                                                                               
         MVC   WUDEST(12),MYFAX                                                 
*                                                                               
         CLC   MYFAX(3),=C'FX='    USING FAX CODE?                              
         BNE   *+10                                                             
         MVC   WUDEST(12),SPACES   NOT NEEDED WHEN USING FAX CODES              
*                                                                               
         OC    WUBILL(7),SPACES                                                 
         MVI   WUEND,C'.'                                                       
         MVC   WUEND+1(7),WUEND                                                 
         L     RF,AFAXBUF                                                       
         SR    RE,RE                                                            
         ICM   RE,3,5(RF)                                                       
*                                                                               
         CVD   RE,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WUEND+2(5),DUB+3(5)                                              
*                                                                               
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF,VDATAMGR                       
*                                                                               
         BRAS  RE,CKSECFAX         CK FOR POSSIBLE 2ND FAX                      
*                                                                               
         MVC   MYPLINE,SPACES                                                   
         MVC   MYPLINE(5),=C'++DDS'                                             
         MVC   MYPLINE+6(8),=C'PPINSTRN'                                        
         MVC   PPEDMED,PRQMED                                                   
         MVC   PPEDCLT,PRQCLT                                                   
         MVC   PPEDPRD,PRQPRD                                                   
         MVC   PPEDJOB,PRQJOB                                                   
         MVC   PPEDREQ(3),PRQUID                                                
*                                                                               
         LA    R6,1(RA)                                                         
         LA    R6,4095(R6)                                                      
         USING POLFILED+4096,R6                                                 
         GOTO1 APUBEDIT,DMCB,PUBKPUB,PPEDPUB                                    
         DROP  R6                                                               
*                                                                               
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF,VDATAMGR                       
*                                                                               
         OC    SECONDFX,SECONDFX   SECOND FAX PRESENT?                          
         BZ    PC10L                                                            
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF2,VDATAMGR                      
*                                                                               
* THIS SHOULD SUPPRESS EASYLINK HEADER MSG                                      
*                                                                               
PC10L    MVC   MYPLINE,SPACES                                                   
         MVC   MYPLINE(10),=C'/FORM/PAGE'                                       
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF,VDATAMGR                       
*                                                                               
         OC    SECONDFX,SECONDFX   SECOND FAX PRESENT?                          
         BZ    PC10X                                                            
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF2,VDATAMGR                      
*                                                                               
         B     PC10X                                                            
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
PC10P    CLC   SVFAX,MYFAX         CHECK FOR NEW FAX NUMBER                     
         BE    PC10P8                                                           
         CLC   PAGE,=H'1'          SEE IF PAGE GREATER THAN 1                   
         BH    PC10P8              YES - THEN SEND TO SAME FAX                  
         MVC   MYPLINE,SPACES                                                   
         MVC   MYPLINE(26),=C'*** END OF DDS MESSAGE ***'                       
*                                                                               
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF,VDATAMGR                       
*                                                                               
         MVC   SVFAX,MYFAX         SAVE FAX NUMBER                              
         MVC   MYPLINE,SPACES                                                   
         MVC   WU9FB(5),=C'*HDR*'                                               
         MVC   WUDESTID(4),=C'FAXL'                                             
         MVC   WUDESTID+5(12),MYFAX                                             
*                                                                               
         CLC   MYFAX(5),=C'MB=62'  CHECK FOR EASY LINK MAIL BOX                 
         BNE   PCP05               (THEY ALL MIST BEGIN WITH 62)                
         MVC   WUDESTID(17),SPACES                                              
         MVC   WUDESTID(8),MYFAX+3                                              
         B     PCP05X                                                           
*                                                                               
PCP05    CLC   MYFAX(3),=C'FX='    CHECK FOR FAX CODE                           
         BNE   PCP05X                                                           
*                                                                               
         MVC   WUDESTID(17),SPACES                                              
         MVC   WUDESTID(6),=C'FXKYL='                                           
         MVC   WUDESTID+6(9),MYFAX+3                                            
*                                                                               
PCP05X   MVC   WUBILL(1),PRQMED                                                 
         MVC   WUBILL+1(3),PRQCLT                                               
         MVC   WUBILL+4(3),PRQPRD                                               
*                                                                               
         MVC   WUDEST(12),MYFAX                                                 
*                                                                               
         CLC   MYFAX(3),=C'FX='    SEE IF USING FAX CODE                        
         BNE   *+10                                                             
         MVC   WUDEST(12),SPACES   NOT NEEDED OR FAX CODES                      
*                                                                               
         OC    WUBILL(7),SPACES                                                 
         MVI   WUEND,C'.'                                                       
         MVC   WUEND+1(7),WUEND                                                 
         L     RF,AFAXBUF                                                       
         SR    RE,RE                                                            
         ICM   RE,3,5(RF)                                                       
*                                                                               
         CVD   RE,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WUEND+2(5),DUB+3(5)                                              
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF,VDATAMGR                       
*                                                                               
         MVC   MYPLINE,SPACES                                                   
         MVC   MYPLINE(5),=C'++DDS'                                             
         MVC   MYPLINE+6(8),=C'PPINSTRN'                                        
         MVC   PPEDMED,PRQMED                                                   
         MVC   PPEDCLT,PRQCLT                                                   
         MVC   PPEDPRD,PRQPRD                                                   
         MVC   PPEDJOB,PRQJOB                                                   
         MVC   PPEDREQ(3),PRQUID                                                
*                                                                               
         LA    R6,1(RA)                                                         
         LA    R6,4095(R6)                                                      
         USING POLFILED+4096,R6                                                 
         GOTO1 APUBEDIT,DMCB,PUBKPUB,PPEDPUB                                    
         DROP  R6                                                               
*                                                                               
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF,VDATAMGR                       
*                                                                               
         MVC   MYPLINE,SPACES                                                   
         MVC   MYPLINE(10),=C'/FORM/PAGE'                                       
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF,VDATAMGR                       
         B     PC10X                                                            
*                                                                               
PC10P8   MVC   MYPLINE,SPACES                                                   
         MVC   MYPLINE(5),=C'/PAGE'                                             
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF,VDATAMGR                       
*                                                                               
         OC    SECONDFX,SECONDFX   SECOND FAX PRESENT?                          
         BZ    PC10X                                                            
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF2,VDATAMGR                      
*                                                                               
PC10X    DS    0H                                                               
         MVI   LINE,1                                                           
         LA    R2,HEAD1                                                         
         LA    R3,14                                                            
         BAS   RE,PRINCON                                                       
         SR    R4,R4                                                            
         MVC   REPDUB(4),PAGE      ADD 1 TO PAGE AND SUBPAGE                    
         LH    R4,REPDUB                                                        
         LA    R4,1(R4)                                                         
         STH   R4,REPDUB                                                        
         LH    R4,REPDUB+2                                                      
         LA    R4,1(R4)                                                         
         STH   R4,REPDUB+2                                                      
         MVC   PAGE(4),REPDUB                                                   
*                                                                               
* CONTROL OF MIDLINE PRINTING                                                   
*                                                                               
PC12     CLI   FORCEMID,C'N'                                                    
         BE    PC14                                                             
         MVI   FORCEMID,C'N'                                                    
         LA    R2,MID1                                                          
         LA    R3,2                                                             
         BAS   RE,PRINCON                                                       
         CLC   LINE,MAXLINES                                                    
         BNL   PC10                                                             
*                                                                               
* CONTROL OF PRINT LINES                                                        
*                                                                               
PC14     LA    R2,P                                                             
         LA    R3,2                                                             
         BRAS  RE,PRINP                                                         
         MVI   SPACING,1                                                        
*                                                                               
* CONTROL OF FOOTLINE PRINTING                                                  
*                                                                               
         CLI   FORCEFUT,C'N'                                                    
         BE    PC15                                                             
         MVI   FORCEFUT,C'N'                                                    
         GOTO1 PRINT,P,SPACES,=C'BC09',VTIA,VDATAMGR                            
*                                                                               
         CLI   QOPT7,C'F'           SEE IF FAXING                               
         BNE   PC14C                                                            
         GOTO1 PRINT,P1,SPACES,=C'BC09',AFAXBUF,VDATAMGR                        
*                                                                               
         OC    SECONDFX,SECONDFX   SECOND FAX PRESENT?                          
         BZ    PC14C                                                            
         GOTO1 PRINT,P1,SPACES,=C'BC09',AFAXBUF2,VDATAMGR                       
*                                                                               
PC14C    LA    R2,FOOT1                                                         
         LA    R3,2                                                             
         BAS   RE,PRINCON                                                       
         MVI   FORCEHED,C'Y'                                                    
*                                                                               
PC15     MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
*                                                                               
PC17     MVC   P,SPACES                                                         
         MVC   PSECOND,SPACES                                                   
*                                                                               
PC18     MVC   FOOT1,SPACES                                                     
         MVC   FOOT2,SPACES                                                     
*                                                                               
         B     PCEXT                                                            
         EJECT                                                                  
*                                                                               
* CONTROL PRINTING OF A BLOCK                                                   
*                                                                               
PRINCON  NTR1                                                                   
         MVC   REPWORK,SPACES                                                   
         LR    R4,R2                                                            
         LR    R5,R3                                                            
         LA    R6,REPWORK                                                       
*                                                                               
PC20     CLC   0(132,R4),SPACES    BUILD A TABLE OF PRINT LINE BYTES            
         BE    *+8                                                              
         MVI   0(R6),C'P'                                                       
         LA    R4,132(R4)                                                       
         LA    R6,1(R6)                                                         
         BCT   R5,PC20                                                          
*                                  NOW CONVERT TO PRINTING NUMBERS              
         LA    R6,REPWORK                                                       
*                                                                               
PC22     CLC   0(16,R6),SPACES     ANY LEFT                                     
         BE    PC30                NO                                           
*                                                                               
PC26     LA    RE,2                                                             
         CLC   1(15,R6),SPACES     IS THIS THE LAST                             
         BE    PC28                                                             
         CLC   1(2,R6),=C' P'                                                   
         BE    PC28                                                             
         LA    RE,1                                                             
         CLI   1(R6),C'P'                                                       
         BE    PC28                                                             
         LA    RE,3                                                             
*                                                                               
PC28     STC   RE,0(R6)                                                         
         AR    R6,RE                                                            
         SR    RF,RF                                                            
         IC    RF,LINE                                                          
         AR    RF,RE                                                            
         STC   RF,LINE                                                          
         B     PC22                                                             
*                                                                               
* NOW PRINT R2=DATA, R3=N'LINES, R6=SKIP NUMBERS                                
*                                                                               
PC30     LA    R6,REPWORK                                                       
*                                                                               
PC32     CLI   0(R6),C' '                                                       
         BE    PC34                                                             
         MVC   CONTROL(3),=C'BL0'                                               
         MVC   CONTROL+3(1),0(R6)                                               
         OI    CONTROL+3,X'F0'                                                  
         OC    0(132,R2),SPACES    ENSURE PRINTABLE CHARACTERS                  
*                                                                               
         GOTO1 PRINT,P1,(R2),CONTROL,VTIA,VDATAMGR                              
*                                                                               
         CLI   QOPT7,C'F'          SEE IF FAXING                                
         BNE   PC34                                                             
         MVC   CONTROL(3),=C'BL0'                                               
         MVC   CONTROL+3(1),0(R6)                                               
         OI    CONTROL+3,X'F0'                                                  
         OC    0(132,R2),SPACES    ENSURE PRINTABLE CHARACTERS                  
*                                                                               
* FOR FAX COPY MUST ALWAYS PUT AGYNAME AND ADDRESS                              
*                                                                               
         LA    RE,HEAD2                                                         
         CR    RE,R2               SEE IF DOING HEADLINE 2                      
         BNE   PC32A                                                            
         MVC   HEAD2+45(33),PAGYNAME                                            
         B     PC32AX                                                           
PC32A    LA    RE,HEAD3                                                         
         CR    RE,R2               SEE IF DOING HEADLINE 3                      
         BNE   PC32AX                                                           
         MVC   HEAD3+45(33),PAGYADDR                                            
*                                                                               
PC32AX   GOTO1 PRINT,P1,(R2),CONTROL,AFAXBUF,VDATAMGR                           
*                                                                               
         OC    SECONDFX,SECONDFX   SECOND FAX PRESENT?                          
         BZ    PC34                                                             
         GOTO1 PRINT,P1,(R2),CONTROL,AFAXBUF2,VDATAMGR                          
*                                                                               
PC34     LA    R2,132(R2)                                                       
         LA    R6,1(R6)                                                         
         BCT   R3,PC32                                                          
*                                                                               
JUMPXIT1 XIT1                                                                   
         EJECT                                                                  
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
PCEXT    MVI   SKIPSPEC,C'N'                                                    
         XMOD1 1                                                                
*                                                                               
PLCNT    SR    RF,RF                                                            
         IC    RF,LINE                                                          
         AHI   RF,1                                                             
         STC   RF,LINE                                                          
         BR    RE                                                               
         EJECT                                                                  
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
PROCSPEC NTR1                      EXECUTE SPEC POOL                            
*                                                                               
         LA    RE,RELO                                                          
         S     RE,RELO                                                          
         ST    RE,REPRELO                                                       
         B     RELO+4                                                           
*                                                                               
RELO     DC    A(*)                                                             
*                                                                               
         L     R2,PPSPECS          POINT TO SPEC POOL                           
         LTR   R2,R2                                                            
         BZ    EX6                                                              
         SR    R3,R3                                                            
         MVI   PROGSW,C'Y'         PRESET SWITCHES                              
         CLI   RCSUBPRG,0                                                       
         BE    EX2                                                              
         MVI   PROGSW,C'N'                                                      
*                                                                               
EX2      IC    R3,1(R2)                                                         
         AR    R2,R3               GET NEXT SPEC                                
*                                                                               
EX4      SR    R4,R4                                                            
         IC    R4,0(R2)                                                         
         SLL   R4,2                                                             
         L     R4,INBRTAB(R4)      GO TO ROUTINE DEPENDENT                      
         A     R4,REPRELO                                                       
         BR    R4                  ON THE VALUE OF ELEMENT                      
*                                                                               
EX6      J     JUMPXIT1                                                         
*                                                                               
EX8      MVI   PROGSW,C'N'                                                      
         B     EX2                                                              
*                                                                               
EX10     CLC   RCSUBPRG(1),2(R2)   CHECK MATCH OF SUB-PROGRAM                   
         BNE   EX2                                                              
         MVI   PROGSW,C'Y'                                                      
         B     EX2                                                              
         EJECT                                                                  
*                                                                               
* PRINT SPEC CONTROL AND LITERALS                                               
*                                                                               
EX46     CLI   PROGSW,C'Y'                                                      
         BNE   EX2                                                              
         MVC   REPDUB(2),2(R2)     WORK OUT DISLACEMENT                         
         LH    R5,REPDUB                                                        
         LA    R5,HEAD1(R5)                                                     
         CLI   0(R2),13                                                         
         BE    EX48                                                             
         SR    R4,R4               WORK OUT BRANCH BY INSTRUCTION NUM           
         IC    R4,4(R2)                                                         
         SLL   R4,2                                                             
         L     R4,PRBRTAB(R4)                                                   
         A     R4,REPRELO                                                       
         BR    R4                                                               
*                                                                               
EX48     SR    R4,R4               HANDLE LITERALS                              
         IC    R4,1(R2)                                                         
         AHI   R4,-5               LENGTH IS L'ELEMENT - 4                      
         EX    R4,MUVLIT                                                        
         B     EX2                                                              
*                                                                               
MUVLIT   MVC   0(0,R5),4(R2)                                                    
         EJECT                                                                  
*                                                                               
* TABLE OF INTERNAL BRANCH VALUES                                               
*                                                                               
         DS    0F                                                               
INBRTAB  DC    AL4(EX6)     0      END OF SPECS                                 
         DC    AL4(EX8)     1      PROGRAM RESET                                
         DC    AL4(EX10)    2              FILTER                               
         DC    9AL4(0)                                                          
         DC    AL4(EX46)   12      PRINT KEYWORD SPEC                           
         DC    AL4(EX46)   13      PRINT LITERAL SPEC                           
         EJECT                                                                  
*                                                                               
* ROUTINES FOR PRINT SPECS (0-3)                                                
*                                                                               
EX50     MVC   0(110,R5),SPACES    SPACES                                       
         CLI   SKIPSPEC,C'T'                                                    
         BE    EX2                                                              
         MVC   0(132,R5),SPACES                                                 
         B     EX2                                                              
*                                                                               
EX52     MVC   0(7,R5),=C'RUN ON ' RUN                                          
         MVC   7(8,R5),RCDATE                                                   
         PACK  REPDUB,RCDATE(2)                                                 
         CVB   R6,REPDUB                                                        
         BCTR  R6,R0                                                            
         MHI   R6,3                                                             
         LA    R6,MONTHS(R6)                                                    
         MVC   7(3,R5),0(R6)                                                    
         MVC   15(4,R5),=C' AT '                                                
*                                                                               
       ++INCLUDE DDGETIME                                                       
*                                                                               
         ST    R1,REPWORK                                                       
         MVC   REPDUB+5(3),REPWORK                                              
         OI    REPDUB+7,X'0F'                                                   
         CVB   R6,REPDUB                                                        
         EDIT  (R6),(5,19(R5)),2                                                
         B     EX2                                                              
*                                                                               
EX54     MVC   0(16,R5),=C'PRINTPAK REPORT '                                    
         MVC   16(2,R5),RCPROG                                                  
         B     EX2                                                              
*                                                                               
EX56     MVC   0(5,R5),=C'PAGE '                                                
         EDIT  PAGE,(4,5(R5)),ALIGN=LEFT                                        
         B     EX2                                                              
*                                                                               
EX57     MVC   0(8,R5),=C'SUBPAGE '                                             
         EDIT  SUBPAGE,(4,8(R5)),ALIGN=LEFT                                     
         B     EX2                                                              
         EJECT                                                                  
*                                                                               
* ROUTINES FOR PRINT SPECS (4-8)                                                
*                                                                               
EX58     CLC   QSTART(6),SPACES    PERIOD                                       
         BE    EX62                                                             
         CLC   QEND(6),SPACES                                                   
         BNE   EX60                                                             
         MVC   0(5,R5),=C'FROM '                                                
         LA    R5,5(R5)                                                         
*                                                                               
EX60     GOTO1 DATCON,REPWORK,(0,QSTART),(5,0(R5))                              
         CLC   QEND(6),SPACES                                                   
         BE    EX2                                                              
         LA    R5,9(R5)                                                         
*                                                                               
EX62     CLC   QEND(6),SPACES                                                   
         BE    EX2                                                              
         MVC   0(5,R5),=C'THRU '                                                
         GOTO1 DATCON,REPWORK,(0,QEND),(5,5(R5))                                
         B     EX2                                                              
*                                                                               
EX64     MVC   0(13,R5),=C'REQUESTOR    '                                       
         MVC   13(12,R5),QUESTOR                                                
         B     EX2                                                              
*                                                                               
EX66     MVC   0(13,R5),=CL13'MEDIA'                                            
         MVC   9(1,R5),PAGYKMED                                                 
         MVC   13(10,R5),PAGYMED                                                
         B     EX2                                                              
*                                                                               
EX67     MVC   0(10,R5),PAGYMED                                                 
         B     EX2                                                              
*                                                                               
EX68     MVC   0(33,R5),PAGYNAME   AGENCY NAME                                  
         B     EX2                                                              
*                                                                               
EX70     MVC   0(33,R5),PAGYADDR   AGENCY ADDRESS                               
         B     EX2                                                              
         EJECT                                                                  
*                                                                               
* ROUTINES FOR PRINT SPECS (9-14)                                               
*                                                                               
EX72     MVC   0(06,R5),=C'CLIENT'                                              
         MVC   9(3,R5),PCLTKCLT                                                 
         MVC   13(20,R5),PCLTNAME                                               
         B     EX2                                                              
*                                                                               
EX74     MVC   0(20,R5),PCLTNAME                                                
         B     EX2                                                              
*                                                                               
EX76     MVC   0(20,R5),PCLTBNAM                                                
         MVC   132(30,R5),PCLTLIN1                                              
         MVC   264(30,R5),PCLTLIN2                                              
         MVC   396(24,R5),PCLTATTN                                              
         B     EX2                                                              
*                                                                               
EX78     CLI   PPRDKEY+1,0                                                      
         BE    EX2                                                              
         MVC   0(7,R5),=C'PRODUCT'                                              
         MVC   9(3,R5),PPRDKPRD                                                 
         MVC   13(20,R5),PPRDNAME                                               
         B     EX2                                                              
*                                                                               
EX80     MVC   0(20,R5),PPRDNAME                                                
         B     EX2                                                              
*                                                                               
EX82     MVC   000(20,R5),PPRDBILL                                              
         MVC   132(30,R5),PPRDLIN1                                              
         MVC   264(30,R5),PPRDLIN2                                              
         B     EX2                                                              
         EJECT                                                                  
*                                                                               
* ROUTINES FOR PRINT SPECS (15-17)                                              
*                                                                               
EX84     MVC   0(9,R5),=C'ESTIMATES'                                            
         CLC   QESTEND,SPACES                                                   
         BNE   EX88                                                             
         CLC   QEST,SPACES                                                      
         BE    EX86                                                             
         OC    PESTKEY,PESTKEY                                                  
         BNE   *+14                                                             
         MVC   0(9,R5),SPACES      NO ESTIMATE THERE                            
         B     EX2                                                              
         EDIT  (2,PESTKEST),(4,9(R5)),ALIGN=LEFT                                
         MVI   8(R5),C' '                                                       
         MVC   13(20,R5),PESTNAME                                               
         B     EX2                                                              
*                                                                               
EX86     MVC   09(16,R5),=C'    ALL TOGETHER'                                   
         B     EX2                                                              
*                                                                               
EX88     PACK  DUB,QEST                                                         
         CVB   R6,DUB                                                           
         EDIT  (R6),(3,13(R5)),ALIGN=LEFT                                       
         AR    R5,R0                                                            
         BCTR  R5,R0                                                            
         MVI   14(R5),C'-'                                                      
         PACK  DUB,QESTEND                                                      
         CVB   R6,DUB                                                           
         EDIT  (R6),(3,15(R5)),ALIGN=LEFT                                       
         B     EX2                                                              
*                                                                               
EX90     MVC   0(20,R5),PESTNAME                                                
         B     EX2                                                              
*                                                                               
EX92     MVC   0(3,R5),=C'ALL'                                                  
         CLC   QEST,SPACES                                                      
         BE    EX2                                                              
         EDIT  (2,PESTKEST),(3,0(R5))                                           
         B     EX2                                                              
         EJECT                                                                  
*                                                                               
* ROUTINES FOR PRINT SPECS (31-35)                                              
*                                                                               
EX120    B     EX2                 WAS REGION                                   
*                                                                               
EX122    B     EX2                 WAS DISTRICT                                 
*                                                                               
EX124    B     EX2                 WAS DIVISION                                 
         EJECT                                                                  
*                                                                               
* BRANCH TABLE FOR PRINT SPECS                                                  
*                                                                               
PRBRTAB  DC    AL4(EX50)    0      SPACES                                       
         DC    AL4(EX52)    1      RUN                                          
         DC    AL4(EX54)    2      REPORT                                       
         DC    AL4(EX56)    3      PAGE                                         
         DC    AL4(EX58)    4      PERIOD                                       
         DC    AL4(EX64)    5      REQUESTOR                                    
         DC    AL4(EX66)    6      MEDIA                                        
         DC    AL4(EX68)    7      AGYNAME                                      
         DC    AL4(EX70)    8      AGYADD                                       
         DC    AL4(EX72)    9      CLIENT                                       
         DC    AL4(EX74)   10      CLINAME                                      
         DC    AL4(EX76)   11      CLIADD                                       
         DC    AL4(EX78)   12      PRODUCT                                      
         DC    AL4(EX80)   13      PRONAME                                      
         DC    AL4(EX82)   14      PROADD                                       
         DC    AL4(EX84)   15      ESTIMATE                                     
         DC    AL4(EX90)   16      ESTNAME                                      
         DC    AL4(EX92)   17      ESTNUM                                       
         DC    13AL4(0)                                                         
         DC    AL4(EX120)  31      REGION                                       
         DC    AL4(EX122)  32      DISTRICT                                     
         DC    AL4(EX124)  33      DIVISION                                     
         DC    2AL4(0)                                                          
         DC    AL4(EX57)   36      SUBPAGE                                      
         DC    AL4(0)                                                           
         DC    AL4(EX67)   38      MEDIANAME                                    
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
PRINP    NTR1  BASE=*,LABEL=*      SPECIAL ROUTINE FOR PRINT LINES              
*                                                                               
         CLC   PSECOND,SPACES      ALWAYS SINGLE-PRINT 1/2                      
         BE    PC36                                                             
         GOTO1 PRINT,P1,(R2),=C'BL01',VTIA,VDATAMGR                             
*                                                                               
         CLI   QOPT7,C'F'          SEE IF FAXING                                
         BNE   PRINP10                                                          
         CLI   EOPIND,C'1'         SEE IF DOING FIRST EOP LINE                  
         BNE   PRINP2                                                           
         MVC   1(15,R2),SPACES     BLANK OUT X'S                                
         MVC   21(33,R2),PAGYNAME                                               
         MVC   64(12,R2),PJOBSIG                                                
         B     PRINP8                                                           
*                                                                               
PRINP2   CLI   EOPIND,C'2'         OR SECOND EOP LINE                           
         BNE   PRINP8                                                           
*                                  SKIP GOTO1 PRINT                             
         B     PRINP10                                                          
*                                                                               
PRINP8   GOTO1 PRINT,P1,(R2),=C'BL01',AFAXBUF,VDATAMGR                          
*                                                                               
         OC    SECONDFX,SECONDFX   SECOND FAX PRESENT?                          
         BZ    PRINP10                                                          
         GOTO1 PRINT,P1,(R2),=C'BL01',AFAXBUF2,VDATAMGR                         
*                                                                               
PRINP10  BRAS  RE,PLCNT                                                         
         LA    R2,132(R2)                                                       
*                                                                               
PC36     MVC   CONTROL(3),=C'BL0'  USERS SPACING FOR ONE OR 2/2                 
         MVC   CONTROL+3(1),SPACING                                             
         CLC   RCSPACNG,SPACING    OPTION DOUBLE/TRIPLE RSPEC SPACING           
         BNH   *+10                                                             
         MVC   CONTROL+3(1),RCSPACNG                                            
         OI    CONTROL+3,X'F0'                                                  
         GOTO1 PRINT,P1,(R2),CONTROL,VTIA,VDATAMGR                              
*                                                                               
         CLI   QOPT7,C'F'          SEE IF FAXING                                
         BNE   PC36C                                                            
         CLI   EOPIND,C'X'         BOTTOM OF PAGE?                              
         BE    PC36C               NOT NEEDED IF FAXING                         
*                                                                               
         MVC   CONTROL(3),=C'BL0'  USERS SPACING FOR ONE OR 2/2                 
         MVC   CONTROL+3(1),SPACING                                             
         CLC   RCSPACNG,SPACING    OPTION DOUBLE/TRIPLE RSPEC SPACING           
         BNH   *+10                                                             
         MVC   CONTROL+3(1),RCSPACNG                                            
         OI    CONTROL+3,X'F0'                                                  
*                                                                               
         CLI   EOPIND,C'1'         FIRST END OF PAGE LINE?                      
         BNE   PRINP20                                                          
         MVC   1(15,R2),SPACES     BLANKOUT X'S                                 
         MVC   21(33,R2),PAGYADDR                                               
         B     PRINP25                                                          
*                                                                               
PRINP20  CLI   EOPIND,C'2'         SEE IF SECOND EOP LINE                       
         BNE   PRINP22                                                          
         B     PC36C               NOTHING TO PRINT IF FAXING                   
*                                                                               
PRINP22  CLI   EOPIND,C'3'         SEE IF THIRD EOP LINE                        
         BNE   PRINP25                                                          
         B     PC36C               NOTHING TO PRINT IF FAXING                   
*                                                                               
PRINP25  GOTO1 PRINT,P1,(R2),CONTROL,AFAXBUF,VDATAMGR                           
*                                                                               
         OC    SECONDFX,SECONDFX   SECOND FAX PRESENT?                          
         BZ    PC36C                                                            
         CLI   SUPCOSSF,C'Y'       SUPPRESS COST?                               
         BNE   PRINP30                                                          
*                                                                               
         CLI   TOTOPT,C'N'         SHOWING TOTAL COST?                          
         BE    PRINP27             NO, CK INSERTION COST OPTION                 
         CLI   SVLANG,C'F'         FRENCH?                                      
         BNE   *+18                                                             
         CLC   =C'TOTAUX',05(R2)   SHOWING TOTAL IN FRENCH?                     
         BE    PC36C               YES, SKIP THIS PRINT LINE                    
         B     PRINP27             NO, CK INSERTION COST OPTION                 
         CLC   =C'TOTAL',05(R2)    SHOWING TOTAL(S)?                            
         BE    PC36C               YES, SKIP THIS PRINT LINE                    
*                                                                               
PRINP27  CLI   COSTOPT,C'N'        SHOWING INSERTION COST?                      
         BE    PRINP30             NO, COST IS ALREADY SUPPRESSED               
         CLI   SVLANG,C'F'         FRENCH?                                      
         BNE   *+18                                                             
         CLC   =C'COUT=',15(R2)    SHOWING COST IN FRENCH?                      
         BE    PC36C               YES, SKIP THIS PRINT LINE                    
         B     PRINP30             NO ADDTNL CHRGS FOR FRENCH                   
         CLC   =C'COST=',15(R2)    PRINT LINE W/ COST IN IT?                    
         BE    PC36C               YES, SKIP THIS PRINT LINE                    
*                                                                               
* CK IF DOING ADDITIONAL CHARGES                                                
*                                                                               
         CLI   NUMACLNS,0          ANY MORE ADDITIONAL CHARGES LINES?           
         BE    PRINP30             NO MORE, DO NOT SKIP ANYMORE                 
         TM    NUMACLNS,X'80'      SUPPRESSING ADDITIONAL CHARGES?              
         BZ    PRINP28             NO, NOT YET, CK FOR AC HEADER                
         NI    NUMACLNS,X'FF'-X'80'                                             
         ZIC   RE,NUMACLNS                                                      
         BCTR  RE,0                DECREMENT                                    
         STC   RE,NUMACLNS                                                      
         CHI   RE,0                DOWN TO LAST LINE FOR ADDTNL CHRGS?          
         BE    *+8                                                              
         OI    NUMACLNS,X'80'      TURN BIT ON AGAIN FOR SUPPRESSING AC         
         B     PC36C               SKIP ADDITIONAL CHARGES PRINT LINE           
*                                                                               
PRINP28  CLC   =C'** ADDITIONAL CHARGES **',10(R2)                              
         BNE   PRINP30                                                          
         OI    NUMACLNS,X'80'      HIGH BIT IS NOT USED (MAX IS 13)             
         B     PC36C               SWITCH IS SET TO SUPPRESS AC                 
*                                                                               
PRINP30  GOTO1 PRINT,P1,(R2),CONTROL,AFAXBUF2,VDATAMGR                          
*                                                                               
PC36C    SR    RF,RF                                                            
         IC    RE,CONTROL+3                                                     
         SLL   RE,28                                                            
         SRL   RE,28                                                            
         IC    RF,LINE                                                          
         AR    RE,RF                                                            
         STC   RE,LINE                                                          
         J     JUMPXIT1                                                         
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
CKSECFAX NTR1  BASE=*,LABEL=*      CK FOR POSSIBLE 2ND FAX                      
*                                                                               
         OC    SECONDFX,SECONDFX                                                
         BZ    CKSFXX                                                           
*                                                                               
         MVC   MYPLINE,SPACES                                                   
*                                                                               
         MVC   WU9FB(5),=C'*HDR*'                                               
         MVC   WUDESTID(4),=C'FAXL'                                             
         MVC   WUDESTID+5(12),SECONDFX                                          
*                                                                               
* CK FOR EASY-LINK MAIL BOX, MUST ALL BEGIN WITH 62                             
*                                                                               
         CLC   SECONDFX(5),=C'MB=62'                                            
         BNE   CKSFX20                                                          
         MVC   WUDESTID(17),SPACES                                              
         MVC   WUDESTID(8),SECONDFX+3                                           
         B     CKSFX30                                                          
*                                                                               
CKSFX20  CLC   SECONDFX(3),=C'FX=' FAX CODE?                                    
         BNE   CKSFX30                                                          
*                                                                               
         MVC   WUDESTID(17),SPACES                                              
         MVC   WUDESTID(6),=C'FXKYL='                                           
         MVC   WUDESTID+6(9),SECONDFX+3                                         
*                                                                               
CKSFX30  MVC   WUBILL(1),PRQMED                                                 
         MVC   WUBILL+1(3),PRQCLT                                               
         MVC   WUBILL+4(3),PRQPRD                                               
*                                                                               
         MVC   WUDEST(12),SECONDFX                                              
*                                                                               
         CLC   SECONDFX(3),=C'FX=' USING FAX CODE?                              
         BNE   *+10                                                             
         MVC   WUDEST(12),SPACES   NOT NEEDED WHEN USING FAX CODES              
*                                                                               
         OC    WUBILL(7),SPACES                                                 
         MVI   WUEND,C'.'                                                       
         MVC   WUEND+1(7),WUEND                                                 
         L     RF,AFAXBUF2                                                      
         SR    RE,RE                                                            
         ICM   RE,3,5(RF)                                                       
*                                                                               
         CVD   RE,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WUEND+2(5),DUB+3(5)                                              
*                                                                               
         GOTO1 PRINT,P1,MYPLINE,=C'BL01',AFAXBUF2,VDATAMGR                      
*                                                                               
CKSFXX   J     JUMPXIT1                                                         
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
*                                                                               
PPREPD   DSECT                                                                  
REPDUB   DS    D                                                                
REPWORK  DS    CL40                                                             
CONTROL  DS    CL4                                                              
PROGSW   DS    CL1                                                              
REPRELO  DS    F                                                                
SIOKEY   DS    CL32                                                             
*                                                                               
TOFAX    DS    CL16                FROM CONTROL FILE FAX RECORD                 
*                                                                               
FTIME    DS    CL1                                                              
MYPLINE  DS    CL132                                                            
         ORG   MYPLINE                                                          
WUORIG   DS    CL4                 WAS AGYORIG                                  
WU9FB    DS    CL5                 OLD - WAS USED BY GRAFNET (/9FB)             
WUDESTID DS    CL24                C'FAXL AAA-NNN-NNNN'  (FAX NUMBER)           
*                                  FAXL IS 90 CHARS WIDE BY 14 INCHES           
         DS    CL5                 SPARE                                        
WUDEST   DS    CL16                FORMATTED DESTINATION  (FAX NUMBER)          
*                                                                               
WUBILL   DS    CL20                QMED/QCLIENT/QPRD                            
WUEND    DS    CL8                                                              
*                                                                               
         ORG   MYPLINE+15                                                       
       ++INCLUDE PPEDICT                                                        
         ORG                                                                    
IO       DS    600C                CONTROL FILE IO AREA                         
*                                                                               
PPREPDX  DS    0H                                                               
*                                                                               
* END OF WORKING AREA FOR THIS MODULE                                           
*                                                                               
         EJECT                                                                  
*                                                                               
       ++INCLUDE T413WKA                                                        
         EJECT                                                                  
*                                                                               
       ++INCLUDE POLFILE                                                        
         EJECT                                                                  
*                                                                               
       ++INCLUDE T413WKB                                                        
         EJECT                                                                  
*                                                                               
         PRINT OFF                                                              
*                                                                               
       ++INCLUDE CTGENFAX                                                       
         EJECT                                                                  
*                                                                               
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'019INSORPT   04/14/03'                                      
         END                                                                    
*                                                                               
