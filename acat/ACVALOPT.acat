*          DATA SET ACVALOPT   AT LEVEL 045 AS OF 07/01/20                      
*CATALP ACVALOPT                                                                
*                                                                               
********************************************************************            
* ACVALOPT - VALIDATE OPTION INPUT                                 *            
*                                                                  *            
* AT ENTRY - P1=A(FLD HDR)                                         *            
*          - P2=A(OPTION ELEMENT)                                  *            
*          - P3=A(GEND)                                            *            
* ON EXIT  - P2 B0 X'FF' - EXIT VIA VOERRCUR                       *            
********************************************************************            
*                                                                               
         TITLE 'ACVALOPT - MODULE TO VALIDATE OPTIONS'                          
* GHOA 044 13FEB18 DSRD-18081 OPT/MAIN 'EMAIL IF PERSN ASSIGN 2 JOB'            
* ASAX 045 26MAY20 DSRD-25987 NEW OPT/MAIN 'DATE EST IN LAST FISCAL YR'         
                                                                                
ACVALOPT CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 WORKX-WORKD,**VOPT**,R8,RA,CLEAR=YES                             
         LR    R7,RC                                                            
         USING WORKD,R7                                                         
         ST    R1,APARMS                                                        
         L     RC,8(R1)                                                         
         USING GEND,RC                                                          
*        L     R8,ASPOOLD                                                       
*        USING SPOOLD,R8                                                        
         L     R9,ASUBSYSD                                                      
         USING SUBSYSD,R9                                                       
         L     RA,ATWA                                                          
         USING T60BFFD,RA                                                       
*                                                                               
         MVI   MYSPACE,C' '                                                     
         MVC   MYSPACE+1(L'MYSPACE-1),MYSPACE                                   
*                                                                               
         L     R2,0(R1)            R2=A(FIELD HEADER)                           
         L     R6,4(R1)            GET A(OPTION ELEMENT)                        
         GOTO1 DICTATE,DMCB,C'LU  ',DDIN,DDOUT                                  
         USING OPDELD,R6                                                        
         MVI   OPDEL,OPDELQ                                                     
         MVC   OPDPERS,TWAALIAS    SET NEW USER                                 
         MVC   OPDLAST,TODAYP      AND DATE OF LAST UPDATE                      
         L     R5,AOPTTAB                                                       
         USING OPTBD,R5                                                         
VALOPT1  CLI   OPTBOPN,0           TEST FOR EOT                                 
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLC   OPDNUM,OPTBOPN      MATCH ON OPTION NUMBER                       
         BE    VALOPT2                                                          
         LA    R5,OPTBL(R5)                                                     
         B     VALOPT1                                                          
*                                                                               
VALOPT2  ST    R5,AOPTENT          SET A(OPTION ENTRY)                          
         ZIC   RF,OPTBVRTN         GET DISPLAY ROUTINE NUMBER                   
         BCTR  RF,0                                                             
         SLL   RF,2                                                             
         B     VOBRANCH(RF)                                                     
*                                                                               
VOBRANCH DS    0F                                                               
         B     VO1                 PERCENTAGE, 4 DECIMALS                       
         B     VO2                 UNBILLABLE WORKCODE LIST                     
         B     VO3                 BILL TYPE                                    
         B     VO4                 NUMERIC 0-255                                
         B     VO5                 CASH                                         
         B     VO6                 YES/NO                                       
         B     VO7                 CHARACTERS                                   
         B     VO8                 NEW BILL TYPE                                
         B     VO9                 APPROVE ESTIMATE                             
         B     VO1B                PERCENTAGE, 2 DECIMALS                       
         B     VO11                NUMERIC 1-999                                
         B     VO12                PRODUCTION SCHEME                            
         B     VO13                DISTRIBUTION SCHEME                          
         B     VO14                PANEL CODE                                   
         B     VO15                ESTIMATE TYPE                                
         B     VO16                BATCH APPROVAL/CHECKING                      
         B     VO7                 ROUTINE 17                                   
         B     VO18                ACCOUNT NUMBER, VARIOUS UNIT/LEDGERS         
         B     VO19                NEW BUSINESS/PRO BONO                        
         B     VO20                GST OUTPUT CODE                              
         B     VO21                NUMERIC 0-9                                  
         B     VO22                ESTIMATE REPORT                              
         B     VO23                TEXT SCROLL SEQUENCE                         
         B     VO24                COLUMNS FOR JOB INQUIRY                      
         B     VO24                VO25 STARTS OUT SAME PLACE AS VO24           
         B     VO27                VO26 IS SAME AS VO27                         
         B     VO27                AWO FINACNE/ANALYSIS OFFICE                  
         B     VO18                VO28 STARTS OUT SAME PLACE AS VO18           
         B     VO29                NUMERIC 1 OR 2                               
         B     VO30                TIMESHEET DEFAULT                            
         B     VO31                FORCE JOB/PRODUCT ON TIMESHEET               
         B     VO32                AWO ANALYSIS DEPARTMENT                      
         B     VO33                AWO ANALYSIS STAFF                           
         B     VO34                WORKCODE BASIS (H,U)                         
         B     VO35                TAX WORKCODE                                 
         B     VO18                VO36                                         
         B     VO18                VO37                                         
         B     VO18                VO38                                         
         B     VO39                TAX LOCALITY                                 
         B     VO40                STUDIO TYPE                                  
         B     VO41                PROVINCE/PST CODE                            
         B     VO42                T,O OR P.                                    
         B     VO18                VO43                                         
         B     VO44                CBILL COLUMNS                                
         B     VO45                STICKY LABELS                                
         B     VO46                TIME WORKCODE TYPES                          
         B     VO18                VO47                                         
         B     VO18                VO48                                         
         B     VO18                VO49                                         
         B     VO50                WORKCODE ON ESTIMATE                         
         B     VO18                VO51                                         
         B     VO52                PERCENTAGE, 6 DECIMALS                       
         B     VO53                VALIDATE B.O. ESTIMATE FORMAT CODE           
         B     VO54                VALIDATE B.O. SELECTED ESTIMATES             
         B     VO55                VALIDATE B.O. NARRATIVE ON TIME              
         B     VO56                PERCENTAGE TO 2 DEC                          
         B     VO57A               NONE/IN PROGRESS/SUB/PART APP/APP            
         B     VO58                NONE/ERROR/WARNING                           
         B     VO59                BLANK OR 1-8                                 
         B     VO60                ARTIST, INTERNAL, PRODUCTION,EXPENSE         
         B     VO61                YES, NO COMPULSORY                           
         B     VO62                NUMERIC 0-100000                             
         B     VO63                NO, TEXT APPROVED, APPROVED                  
         B     VO64                APPROVER/SUBMITTER/NONE                      
         B     VO65                MEDIA/WORK CODE SI/SK                        
         B     VO66                YES/NO/DRAFT                                 
         B     VO67                2 CHAR ARTIST/INTERNAL/PROD/EXPENSE          
         B     VO68                SALES OR COST                                
         B     VO57B               IN PROGRESS/SUB/PART APP/APP                 
         B     VO57                NONE/IN PRO/SUB/CLI APP/MAN APP/APP          
         B     VO71                IN PRO/SUB/CLI APP/MAN APP/APP               
         B     VO72                SINGLE CHARACTER INPUT                       
         B     VO73                YES/NO/CONTINGENCY                           
         B     VO74                IN PROGRESS/SUB INT/INT APP/SUB 2 CL         
         B     VO75                YES/NO/AMOUNT                                
         B     VO76                NONE/IN PRO/SUB/CLI APP/MAN APP/APP          
         B     VO4A                NUMERIC 1-90                                 
         B     VO4B                NUMERIC 1-3                                  
         B     VO79                NARRATIVE CODE FOR AUTOMATIC BILL            
*                                                                               
VO1      LA    R4,4                PERCENTAGE TO 4 DEC                          
         B     VO1D                                                             
                                                                                
VO1B     LA    R4,2                PERCENTAGE TO 2 DEC                          
*                                                                               
VO1D     ZIC   R3,5(R2)            PERCENTAGE TO (R4) DEC                       
         MVI   OPDLN,OPDLN1Q+4                                                  
         BAS   RE,CONNUMB                                                       
         ZAP   DUB,DUB                                                          
         BM    VOERR                                                            
         MVC   OPDDATA(4),DUB+4    RETURN 4 BYTE PERCENT (PACKED)               
         B     VOX                                                              
*                                                                               
VO2      DS    0H                  UNBILLABLE W/C LIST                          
         CLI   5(R2),4                                                          
         BNE   VO2A                                                             
         CLC   8(4,R2),AC@NONE     TEST FOR NONE                                
         BNE   VO2A                                                             
         MVC   OPDDATA(2),MYSPACE                                               
         MVI   OPDLN,OPDLN1Q+2                                                  
         B     VOX                                                              
*                                                                               
VO2A     GOTO1 SCANNER,DMCB,(R2),BLOCK,0                                        
         ZIC   R0,DMCB+4                                                        
         LTR   R0,R0                                                            
         BZ    VOERR                                                            
         CHI   R0,6                                                             
         BH    VOERR                                                            
         LR    R1,R0                                                            
         SLL   R1,1                LENGTH IS N'EXPRESSIONS *2                   
         LA    R1,16(R1)                     PLUS 16                            
         STC   R1,OPDLN                                                         
         LA    R3,BLOCK                                                         
         LA    R4,OPDDATA                                                       
*                                                                               
VO2B     CLI   0(R3),0             LENGTH MUST BE 1-2                           
         BE    VOERR                                                            
         CLI   0(R3),2                                                          
         BH    VOERR                                                            
         MVC   0(2,R4),12(R3)                                                   
         LA    R3,32(R3)                                                        
         LA    R4,2(R4)                                                         
         BCT   R0,VO2B                                                          
         B     VOX                                                              
*                                                                               
VO3      MVC   OPDDATA(1),8(R2)    BILLING TYPE                                 
         MVI   OPDLN,OPDLN1Q+1                                                  
         ZIC   R1,5(R2)                                                         
         BCTR  R1,0                                                             
         EX    R1,TESTPROG         CHECK FOR SIMPLE TYPES                       
         BE    VOX                                                              
         EX    R1,TESTTOTL                                                      
         BE    VOX                                                              
         EX    R1,TESTUNBL                                                      
         BE    VOX                                                              
         EX    R1,TESTCLNT                                                      
         BE    VOX                                                              
         EX    R1,TEST1LN1                                                      
         BE    VOX                                                              
         EX    R1,TEST1LN2                                                      
         BE    VOX                                                              
         EX    R1,TEST1LN3                                                      
         BE    VOX                                                              
         EX    R1,TESTAUTO                                                      
         BE    VOX                                                              
         MVI   OPDDATA,C'S'        CHECK FOR SPECIAL                            
         MVI   OPDLN,OPDLN1Q+5                                                  
         ZIC   R3,5(R2)                                                         
         GOTO1 CASHVAL,DMCB,8(R2),(R3)                                          
         MVC   OPDDATA+1(4),DMCB+4                                              
         CLI   DMCB,0                                                           
         BE    VOX                                                              
         MVI   OPDDATA,C'F'        AND FOR FEE                                  
         CLC   8(3,R2),AC@FEE                                                   
         BNE   VO3B                                                             
         SHI   R3,3                                                             
         GOTO1 CASHVAL,DMCB,11(R2),(R3)                                         
         MVC   OPDDATA+1(4),DMCB+4                                              
         CLI   DMCB,0                                                           
         BE    VOX                                                              
         B     VOERR                                                            
*                                                                               
VO3B     XC    BLOCK(96),BLOCK     NOW TRY FOR ESTIMATE                         
         MVI   OPDDATA,C'E'                                                     
         GOTO1 SCANNER,DMCB,(R2),(3,BLOCK)                                      
         LA    R3,BLOCK                                                         
         LA    R4,OPDDATA+1                                                     
         SR    R5,R5               ADDING PERCENTS IN R5                        
         ZIC   R1,DMCB+4                                                        
         LR    R0,R1                                                            
         LTR   R0,R0                                                            
         BZ    VOERR                                                            
         SLL   R1,2                LENGTH IS NUMBER OF PERCENTS *4              
         LA    R1,17(R1)                     PLUS 17                            
         STC   R1,OPDLN                                                         
*                                                                               
VO3D     ZIC   R1,0(R3)            LENGTH OF THIS EXPRESSION                    
         LA    R1,12-1(R3,R1)      POSITION TO LAST CHARACTER                   
         CLI   0(R1),C'%'          WHICH MUST BE A PERCENT SIGN                 
         BNE   VOERR                                                            
         ZIC   R1,0(R3)            EXPRESSION LESS END CHARACTER                
         BCTR  R1,0                SHOULD NOW BE VALID 'CASH'                   
         ST    R1,DMCB+4                                                        
         GOTO1 CASHVAL,DMCB,12(R3)                                              
         CLI   DMCB,X'FF'                                                       
         BE    VOERR                                                            
         A     R5,DMCB+4           ADD IN THIS PERCENT                          
         MVC   0(4,R4),DMCB+4                                                   
         LA    R3,32(R3)                                                        
         LA    R4,4(R4)                                                         
         BCT   R0,VO3D                                                          
*                                  CHECK TOTAL OF PERCENTS                      
         C     R5,=F'-10000'       VALID RANGE IS -100% TO +100%                
         BL    VOERR                                                            
         C     R5,=F'10000'                                                     
         BH    VOERR                                                            
         B     VOX                                                              
*                                                                               
TESTPROG CLC   8(0,R2),AC@PRGSV                                                 
TESTTOTL CLC   8(0,R2),AC@TOTAL                                                 
TESTUNBL CLC   8(0,R2),AC@UBLB                                                  
TESTCLNT CLC   8(0,R2),AC@CLINT                                                 
TEST1LN1 CLC   8(0,R2),=C'1 LINE'                                               
TEST1LN2 CLC   8(0,R2),=C'1LINE'                                                
TEST1LN3 CLC   8(0,R2),=C'1-LINE'                                               
TESTAUTO CLC   8(0,R2),AC@AUTO                                                  
*                                                                               
VO4      GOTO1 NUMERIC             NUMERIC 0-255                                
         LTR   R1,R1                                                            
         BNZ   *+12                                                             
         TM    OPTBIND,OPTBZERO    TEST IF ZERO ALLOWED                         
         BZ    VOERR                                                            
         CHI   R1,255                                                           
         BH    VOERR                                                            
         B     VO4X                                                             
                                                                                
VO4A     GOTO1 NUMERIC             NUMERIC 1-90                                 
         LTR   R1,R1                                                            
         BNZ   *+12                                                             
         TM    OPTBIND,OPTBZERO    TEST IF ZERO ALLOWED                         
         BZ    VOERR                                                            
         CH    R1,=H'90'                                                        
         BH    VOERR                                                            
         B     VO4X                                                             
                                                                                
VO4B     GOTO1 NUMERIC             NUMERIC 1-3                                  
         LTR   R1,R1                                                            
         BZ    VOERR                                                            
         CHI   R1,X'03'                                                         
         BH    VOERR                                                            
         B     VO4X                                                             
                                                                                
VO4X     MVI   OPDLN,OPDLN1Q+1                                                  
         STC   R1,OPDDATA                                                       
         B     VOX                                                              
*                                                                               
VO5      ZIC   R3,5(R2)            CASH FIELD                                   
         GOTO1 CASHVAL,DMCB,8(R2),(R3)                                          
         CLI   DMCB,X'FF'                                                       
         BE    VOERR                                                            
         MVI   OPDLN,OPDLN1Q+4                                                  
         L     R1,DMCB+4                                                        
         CVD   R1,DUB                                                           
         MVC   OPDDATA(4),DUB+4    RETURN PENNIES (PACKED)                      
         B     VOX                                                              
*                                                                               
VO6      MVC   OPDDATA(1),8(R2)    Y(ES) N(O) FIELD                             
         MVI   OPDLN,OPDLN1Q+1                                                  
         CLI   OPDDATA,C'Y'                                                     
         BE    VOX                                                              
         CLI   OPDDATA,C'N'                                                     
         BE    VOX                                                              
         B     VOERR                                                            
*                                                                               
VO7      GOTO1 ANY                 CHARACTERS NO VALIDATION                     
         ZIC   R1,5(R2)                                                         
         CLM   R1,1,OPTBMAX        CHECK AGAINST MAXIMUM LENGTH                 
         BH    VOERR                                                            
         LA    R1,OPDLN1Q(R1)                                                   
         STC   R1,OPDLN                                                         
         SHI   R1,OPDLN1Q+1                                                     
         EX    R1,*+8                                                           
         B     VOX                                                              
         MVC   OPDDATA(0),WORK                                                  
*                                                                               
VO8      LA    R0,VO08TBLN         NEW BILL TYPE                                
         LA    RE,VO08TAB          VALID NEW BILL TYPES                         
         B     VAL1BYTE                                                         
*                                                                               
VO9      LA    R0,VO09TBLN         APPROVE ESTIMATE                             
         LA    RE,VO09TAB          VALID ENTRIES                                
         B     VAL1BYTE                                                         
*                                                                               
VO11     GOTO1 NUMERIC             NUMERIC 1-999                                
         LTR   R1,R1                                                            
         BZ    VOERR                                                            
         CHI   R1,999                                                           
         BH    VOERR                                                            
         MVI   OPDLN,OPDLN1Q+2                                                  
         STCM  R1,3,OPDDATA                                                     
         B     VOX                                                              
*                                                                               
VO12     L     R0,AIO              SAVE IO POINTER                              
         MVC   AIO,AIO3            USE IO3 FOR SCHEME VALIDATION                
         GOTO1 VALSCH                                                           
         ST    R0,AIO              RESTORE IO POINTER                           
         MVI   OPDLN,OPDLN1Q+L'SCHEME                                           
         MVC   OPDDATA(L'SCHEME),SCHEME                                         
         B     VOX                                                              
*                                                                               
VO13     GOTO1 ANY                 DISTRIBUTION SCHEME CODE                     
         CLI   5(R2),4                                                          
         BNE   VO13A                                                            
         CLC   8(4,R2),AC@NONE                                                  
         BNE   VOERR                                                            
         MVC   OPDDATA(3),MYSPACE                                               
         MVI   OPDLN,OPDLN1Q+3                                                  
         B     VOX                                                              
*                                                                               
VO13A    CLI   5(R2),3             TEST FOR 3 BYTE INPUT                        
         BNE   VOERR                                                            
         MVC   OPDDATA(3),WORK                                                  
         MVI   OPDLN,OPDLN1Q+3                                                  
         L     R0,AIO              SAVE IO AREA POINTER                         
*                                                                               
         MVC   KEY,MYSPACE         FIRST CHARACTER IS A LEDGER                  
         MVC   KEY(1),CUL          COMPANY                                      
         MVI   KEY+1,C'3'          LEDGER IS ON UNIT 3                          
         MVC   KEY+2(1),WORK       LEDGER                                       
         MVI   RDUPDATE,C'N'                                                    
         MVC   AIO,AIO3            USE IO3 FOR READING                          
         GOTO1 HIGH                                                             
         CLC   KEY(3),KEYSAVE      TEST IF LEDGER FOUND                         
         BE    VO13B               YES                                          
         MVI   ERROR,INVLDGR                                                    
         B     VOERRCUR                                                         
*                                                                               
VO13B    MVC   KEY,MYSPACE                                                      
         MVI   KEY,X'0A'           NOW READ FOR WORKCODE RECORD                 
         MVC   KEY+1(1),CUL                                                     
         MVI   KEY+2,C'3'                                                       
         MVC   KEY+3(3),WORK       LEDGER/WORKCODE                              
         MVI   RDUPDATE,C'N'                                                    
         GOTO1 HIGH                                                             
         ST    R0,AIO              RESTORE IO POINTER                           
         CLC   KEY(6),KEYSAVE      TEST IF WORKCODE FOUND                       
         BE    VOX                                                              
         MVI   ERROR,BADWORK                                                    
         MVI   ERRNDX,1                                                         
         B     VOERRCUR                                                         
*                                                                               
VO14     L     R0,AIO              SAVE IO POINTER                              
         MVC   AIO,AIO3            USE IO3 TO AVOID CONFLICT                    
         GOTO1 VALPAN              EDIT PANEL CODE                              
         ST    R0,AIO              RESTORE IO POINTER                           
         MVI   OPDLN,OPDLN1Q+L'PANEL                                            
         MVC   OPDDATA(L'PANEL),PANEL                                           
         B     VOX                                                              
*                                                                               
VO15     CLI   5(R2),1             TEST FOR ONE BYTE INPUT                      
         BNE   VOERR                                                            
         MVC   OPDDATA(1),8(R2)    ESTIMATE TYPE                                
         MVI   OPDLN,OPDLN1Q+1                                                  
         CLI   OPDDATA,C'N'                                                     
         BE    VOX                                                              
         CLI   OPDDATA,C'B'                                                     
         BE    VOX                                                              
         B     VOERR                                                            
*                                                                               
VO16     MVC   OPDDATA(1),8(R2)    BATCH APPROVAL/CHECKING                      
         MVI   OPDLN,OPDLN1Q+1                                                  
         ZIC   R1,5(R2)                                                         
         BCTR  R1,0                                                             
         EX    R1,TESTZERO         CHECK FOR EACH VALUE                         
         BE    VOX                                                              
         EX    R1,TESTNO                                                        
         BE    VOX                                                              
         EX    R1,TESTYES                                                       
         BE    VOX                                                              
         EX    R1,TESTMAX                                                       
         BE    VOX                                                              
         EX    R1,TESTCHK                                                       
         BE    VOX                                                              
         EX    R1,TESTAPP                                                       
         BE    VOX                                                              
         EX    R1,TESTTOT                                                       
         BE    VOX                                                              
         B     VOERR                                                            
*                                                                               
TESTZERO CLC   8(0,R2),AC@ZERO                                                  
TESTNO   CLC   8(0,R2),AC@NO                                                    
TESTYES  CLC   8(0,R2),AC@YES                                                   
TESTMAX  CLC   8(0,R2),AC@MAX                                                   
TESTCHK  CLC   8(0,R2),AC@CHK3                                                  
TESTAPP  CLC   8(0,R2),AC@APRVL                                                 
TESTTOT  CLC   8(0,R2),AC@TOTAL                                                 
*                                                                               
VO18     CLI   5(R2),3             TEST FOR MINIMUM INPUT                       
         BL    VOERR                                                            
         CLI   5(R2),14            TEST MAXIMUM LENGTH                          
         BH    VOERR                                                            
*                                                                               
         CLI   OPTBVRTN,28         EDIT ROUTINE 28?                             
         BNE   VO18A               NO                                           
*                                                                               
         CLC   =C'SE',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SB',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18A    CLI   OPTBVRTN,36         EDIT ROUTINE 36?                             
         BNE   VO18B               NO                                           
         CLC   =C'SI',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SK',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18B    CLI   OPTBVRTN,37         EDIT ROUTINE 37?                             
         BNE   VO18C               NO                                           
         CLC   =C'SR',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SB',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18C    CLI   OPTBVRTN,38         EDIT ROUTINE 38?                             
         BNE   VO18D               NO                                           
         CLC   =C'SR',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SB',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SX',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SV',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SW',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SY',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SC',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18D    CLI   OPTBVRTN,18         EDIT ROUTINE 18?                             
         BNE   VO18E               NO                                           
         CLC   =C'SI',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18E    CLI   OPTBVRTN,43         EDIT ROUTINE 43?                             
         BNE   VO18F               NO                                           
         CLC   =C'SI',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SK',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18F    CLI   OPTBVRTN,47         EDIT ROUTINE 47?                             
         BNE   VO18G               NO                                           
         CLC   =C'SE',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SI',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SB',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18G    CLI   OPTBVRTN,48         EDIT ROUTINE 48?                             
         BNE   VO18H               NO                                           
         CLC   =C'SE',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18H    CLI   OPTBVRTN,49         EDIT ROUTINE 49?                             
         BNE   VO18I               NO                                           
         CLC   =C'SK',8(R2)                                                     
         BE    VO18V                                                            
         CLC   =C'SB',8(R2)                                                     
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18I    CLC   =C'SV',8(R2)        MUST BE 51 THEN                              
         BE    VO18V                                                            
         B     VOERR                                                            
*                                                                               
VO18V    L     R0,AIO              SAVE IO POINTER                              
         MVC   AIO,AIO3                                                         
         GOTO1 VALAC14                                                          
         GOTO1 HELLO,DMCB,(C'G',SYSFIL),('ABLELQ',AIO),0                        
         CLI   12(R1),0            TEST IF BALANCE ELEMENT FOUND                
         BE    *+12                                                             
         MVI   ERROR,INVPOST                                                    
         B     VOERRCUR                                                         
*                                                                               
         GOTO1 HELLO,DMCB,(C'G',SYSFIL),('RSTELQ',AIO),0                        
         CLI   12(R1),0                                                         
         BE    *+6                                                              
         DC    H'0'                REAL TROUBLE IF NO STATUS                    
         L     RE,12(R1)                                                        
         USING RSTELD,RE                                                        
         TM    RSTSTAT1,RSTSACIL   TEST IF LOCKED                               
         BZ    *+12                                                             
         MVI   ERROR,INVPOST                                                    
         B     VOERRCUR                                                         
         DROP  RE                                                               
*                                                                               
         CLI   OPTBVRTN,28         EDIT ROUTINE 28?                             
         BNE   VO18W               NO, SAVE 15 BYTE ACCOUNT                     
*                                                                               
         MVC   OPDDATA(14),KEY+1                                                
         MVI   OPDLN,OPDLN1Q+14                                                 
         B     VO18X               RESTORE AI1                                  
*                                                                               
VO18W    MVC   OPDDATA(15),KEY                                                  
         MVI   OPDLN,OPDLN1Q+15                                                 
*                                                                               
VO18X    ST    R0,AIO              RESET IO POINTER                             
         B     VOX                                                              
*                                                                               
VO19     LA    R0,VO19TBLN                                                      
         LA    RE,VO19TAB                                                       
         B     VAL1BYTE                                                         
*                                                                               
VO20     L     R1,AIO3                                                          
         USING VTCD,R1                                                          
         XC    VTCD(VTCLNQ),VTCD                                                
         MVI   VTCACTN,VTCAOVAL    VALIDATE OUTPUT TAX CODE                     
         MVC   VTCCPY,CUL          COMPANY CODE                                 
         MVC   VTCCOMF,ACOMFACS                                                 
         ST    R2,VTCAFLDH                                                      
         GOTO1 VVATICAN                                                         
         BNE   VOERR                                                            
*                                                                               
         MVC   OPDDATA(L'VTCTYPE),VTCTYPE   OUTPUT TAX CODE                     
         MVI   OPDLN,OPDLN1Q+L'VTCTYPE                                          
         B     VOX                                                              
         DROP  R1                                                               
*                                                                               
VO21     CLI   5(R2),1             EDIT FOR 1-9                                 
         BNE   VOERR                                                            
         MVC   OPDDATA(1),8(R2)                                                 
         TM    OPDDATA,X'F0'       TEST FOR NUMBER                              
         BNO   VOERR               NO                                           
         NI    OPDDATA,X'0F'                                                    
         MVI   OPDLN,OPDLN1Q+1                                                  
         B     VOX                                                              
*                                                                               
VO22     GOTO1 VALPROG,PARAS,(R2),AIO3,OPDDATA                                  
         BNE   VOERRCUR                                                         
         MVI   OPDLN,OPDLN1Q+L'CT01NAME                                         
         B     VOX                                                              
*                                                                               
VO23     XC    BLOCK(255),BLOCK                                                 
         MVI   ERRNDX,0                                                         
         GOTO1 SCANNER,DMCB,(R2),(X'86',BLOCK),0                                
         CLI   4(R1),0             TEST FOR BIG PROBLEMS                        
         BE    VOERR                                                            
         ZIC   R3,4(R1)            R3=LOOP COUNTER                              
         ST    R3,FULL             SAVE NUMBER OF BLOCK ENTRIES                 
         LA    R4,BLOCK            R4=A(SCAN BLOCK ENTRY)                       
         USING SCANBLKD,R4                                                      
         LA    R5,OPDDATA          R5=OUTPUT POINTER                            
*                                                                               
VO23A    MVC   ERRNDX,SC1STNUM                                                  
         CLI   SC1STLEN,0                                                       
         BE    VOERR                                                            
         CLI   SC1STLEN,2                                                       
         BH    VOERR                                                            
         MVC   0(2,R5),SCONEFLD                                                 
*                                                                               
         LA    R0,WHERES           R0=LOOP COUNTER                              
         LA    RE,WHERETAB         RE=A(TABLE ENTRY)                            
         CLC   SCONEFLD(L'WHERETAB),0(RE) TEST IF WHERE CODE VALID              
         BE    *+16                YES                                          
         LA    RE,L'WHERETAB(RE)                                                
         BCT   R0,*-14                                                          
         B     VOERR                                                            
*                                                                               
         MVC   ERRNDX,SC2NDNUM                                                  
         CLI   SC2NDLEN,0          TEST NO PARAMETERS                           
         BNE   VOERR                                                            
*                                                                               
VO23B    LA    R4,L'SCLINE(R4)                                                  
         LA    R5,L'WHERETAB(R5)                                                
         BCT   R3,VO23A                                                         
*                                                                               
VO23C    L     R3,FULL             RESTORE LOOP COUNTER                         
         CHI   R3,1                TEST FOR ONLY ONE ENTRY                      
         BE    VO23E               YES-NO NEED TO CHECK FOR DUPLICATES          
*                                                                               
         LA    R4,BLOCK            RESET BLOCK POINTER                          
*                                                                               
VO23D    LA    R5,L'SCLINE(R4)     POINT TO NEXT ENTRY                          
         LR    R0,R3               COMPUTE LOOP COUNT BY                        
         BCT   R0,*+8              SUBTRACTING ONE                              
         B     VO23E               ALL DONE                                     
*                                                                               
         MVC   ERRNDX,SC1STNUM-SCANBLKD(R5)                                     
         CLC   SCONEFLD(2),SCONEFLD-SCANBLKD(R5) TEST FOR DUPLICATE             
         BE    VOERR                                                            
         LA    R5,L'SCLINE(R5)                                                  
         BCT   R0,*-20                                                          
*                                                                               
         LA    R4,L'SCLINE(R4)                                                  
         BCT   R3,VO23D                                                         
*                                                                               
VO23E    MVI   ERRNDX,0                                                         
         L     R3,FULL                                                          
         SLL   R3,1                                                             
         LA    R3,OPDLN1Q(R3)                                                   
         STC   R3,OPDLN                                                         
         B     VOX                                                              
         DROP  R4                                                               
*                                                                               
VO24     GOTO1 VJOBCOL,PARAS,(R2),BLOCK,ACOMFACS                                
         CLI   4(R1),0                                                          
         BNE   VO24A                                                            
         MVI   ERROR,INVALID                                                    
         MVC   ERRNDX,5(R1)                                                     
         B     VOERRCUR                                                         
*                                                                               
VO24A    MVI   ERROR,COLSERR                                                    
         CLI   4(R1),4                                                          
         BH    COLCUR                                                           
*                                                                               
VO25     ZIC   R1,5(R2)                                                         
         LA    R1,OPDLN1Q(R1)                                                   
         STC   R1,OPDLN                                                         
         SHI   R1,OPDLN1Q+1                                                     
         EX    R1,*+8                                                           
         B     VOX                                                              
         MVC   OPDDATA(0),8(R2)                                                 
         B     VOX                                                              
*                                                                               
COLCUR   LA    R0,4                SET UP FOR VO24 ERROR                        
         CLI   OPTBVRTN,X'19'      IS THIS ACTUALLY ROUTINE #25                 
         BNE   COLCUR1             NO, > 4 IS AN ERROR THEN                     
         CLI   4(R1),6             YES, IS IT > 6 ?                             
         BNH   VO25                NO, IT'S OK                                  
         LA    R0,6                YES, SET UP FOR VO25 ERROR                   
*                                                                               
COLCUR1  LA    RE,8(R2)                                                         
*                                                                               
COLCUR2  CLI   0(RE),C','                                                       
         BE    *+12                                                             
         LA    RE,1(RE)                                                         
         B     *-12                                                             
*                                                                               
         LA    RE,1(RE)                                                         
         BCT   R0,COLCUR2                                                       
*                                                                               
COLCURX  LA    RF,8(R2)                                                         
         SR    RE,RF                                                            
         STC   RE,ERRNDX                                                        
         B     VOERRCUR                                                         
*                                                                               
VO27     MVI   ERROR,NOOFF2                                                     
         TM    COMPSTA4,X'01'      TEST ON NEW OFFICES                          
         BO    *+12                                                             
         CLI   5(R2),1             TEST INPUT LENGTH                            
         BH    VOERR                                                            
*                                                                               
         L     R1,AOFFBLK          VALIDATE AN OFFICE                           
         USING OFFALD,R1                                                        
         MVC   OFFAREQO,MYSPACE                                                 
         MVC   OFFAOFFC,MYSPACE                                                 
         ZIC   R3,5(R2)                                                         
         BCTR  R3,0                                                             
         LTR   R3,R3                                                            
         BM    VOERR               LENGTH ERROR                                 
*                                                                               
         EX    R3,*+8                                                           
         B     *+10                                                             
         MVC   OFFAOFFC(0),8(R2)                                                
*                                                                               
         MVI   OFFAACT,OFFAVAL                                                  
         GOTO1 OFFAL                                                            
         TM    OFFAERR,OFFAEOFF  INVALID OFFICE                                 
         BO    VOERR                                                            
*                                                                               
         MVC   KEY,MYSPACE         VALIDATE OFFICE AS 2D ACCOUNT                
         MVC   KEY(1),CUL                                                       
         MVC   KEY+1(2),=C'2D'                                                  
         ZIC   R3,5(R2)                                                         
         BCTR  R3,0                                                             
         EX    R3,*+8                                                           
         B     *+10                                                             
         MVC   KEY+3(0),8(R2)                                                   
         MVC   FULL,AIO                                                         
         MVC   AIO,AIO3                                                         
         MVI   RDUPDATE,C'N'                                                    
         GOTO1 HIGH                                                             
         MVC   AIO,FULL                                                         
         CLC   KEY(15),KEYSAVE                                                  
         BE    VOMOVEX             MOVE FIELD TO OPDDATA AND XIT                
         MVI   ERROR,NOTFOUND                                                   
         B     VOERR                                                            
         DROP  R1                                                               
*                                                                               
VO29     MVI   ERROR,INP2LONG                                                   
         CLI   5(R2),1                                                          
         BH    VOERR                                                            
         CLI   8(R2),C'1'                                                       
         BE    VO29A                                                            
         CLI   8(R2),C'2'                                                       
         BE    VO29A                                                            
         B     VOERR                                                            
*                                                                               
VO29A    MVI   OPDLN,OPDLN1Q+1     SAVE 1 BYTE IN OPDDATA                       
         MVC   OPDDATA(1),8(R2)                                                 
         NI    OPDDATA,X'0F'       STORE AS NUMERIC                             
         B     VOX                                                              
*                                                                               
VO30     LA    R0,VO30TBLN                                                      
         LA    RE,VO30TAB                                                       
         B     VAL1BYTE                                                         
*                                                                               
VO31     LA    R0,VO31TBLN                                                      
         LA    RE,VO31TAB                                                       
         B     VAL1BYTE                                                         
*                                                                               
VO32     DS    0H                  VALIDATE AWO ANALYSIS DEPARTMENT             
         ZIC   R1,5(R2)                                                         
*                                                                               
         MVI   ERROR,TOOLNG                                                     
         CLM   R1,1,DPTLNGTH                                                    
         BH    VOERR               PRINT ERROR                                  
         B     VOMOVEX             MOVE FIELD TO OPDDATA AND XIT                
*                                                                               
VO33     DS    0H                  VALIDATE AWO ANALYSIS STAFF                  
         MVI   ERROR,TOOLNG                                                     
         CLI   5(R2),6                                                          
         BH    VOERR                                                            
         B     VOMOVEX             MOVE FIELD TO OPDDATA AND XIT                
*                                                                               
VO34     LA    R0,VO34TBLN                                                      
         LA    RE,VO34TAB                                                       
         B     VAL1BYTE                                                         
*                                                                               
VO35     CLI   5(R2),2             ONLY ALLOW FOR 1 WORKCODE                    
         BH    VOERR                                                            
         L     R0,AIO                                                           
         MVC   AIO,AIO3                                                         
         GOTO1 VALWORK             READ FOR WORKCODE                            
         ST    R0,AIO                                                           
         MVI   OPDLN,OPDLN1Q+L'WORKCODE                                         
         MVC   OPDDATA(L'WORKCODE),WORKCODE                                     
         B     VOX                                                              
*                                                                               
VO39     CLI   5(R2),8             MAXIMUM LENGTH 8                             
         BH    VOERR                                                            
         L     R0,AIO                                                           
         MVC   AIO,AIO3                                                         
         GOTO1 VALLOC              READ FOR LOCALITY CODE                       
         ST    R0,AIO                                                           
         MVI   OPDLN,OPDLN1Q+L'LOCCODE                                          
         MVC   OPDDATA(L'LOCCODE),LOCCODE                                       
         B     VOX                                                              
*                                                                               
         USING STURECD,R1                                                       
VO40     LA    R1,KEY              FORMAT KEY OF STUDIO TYPE RECORD             
         XC    STUKEY,STUKEY                                                    
         MVI   STUKTYP,STUKTYPQ                                                 
         MVI   STUKSUB,STUKSUBQ                                                 
         MVC   STUKCPY,CUL                                                      
         ZIC   R3,5(R2)                                                         
         BCTR  R3,0                                                             
         EX    R3,*+8                                                           
         B     *+10                                                             
         MVC   STUKCODE(0),8(R2)                                                
         OC    STUKCODE,MYSPACE                                                 
*                                                                               
         MVC   FULL,AIO                                                         
         MVC   AIO,AIO3                                                         
         MVI   RDUPDATE,C'N'                                                    
         GOTO1 HIGH                                                             
         MVC   AIO,FULL                                                         
         MVI   ERROR,NOTFOUND                                                   
         CLC   KEY(15),KEYSAVE                                                  
         BNE   VOERR                                                            
         MVC   OPDDATA(L'STUKCODE),STUKCODE                                     
         MVI   OPDLN,OPDLN1Q+L'STUKCODE                                         
         B     VOX                                                              
         DROP  R1                                                               
*                                                                               
*                                                                               
VO41     DS    0H                  PROVINCE/PST OUTPUT CODE                     
         GOTO1 SCANNER,DMCB,(R2),BLOCK,C',=/='                                  
         ZIC   R0,DMCB+4                                                        
         LTR   R0,R0                                                            
         BZ    VOX                                                              
         CH    R0,=H'3'                                                         
         BH    VOERR                                                            
         LA    R3,BLOCK                                                         
         LA    R4,OPDDATA                                                       
*                                                                               
         CLI   0(R3),2             FIRST LENGTH MUST BE 2                       
         BNE   VOERR                                                            
         MVC   0(2,R4),12(R3)                                                   
         LA    R3,32(R3)                                                        
*                                                                               
         CLI   0(R3),1             SECOND LENGTH MUST BE 1                      
         BNE   VOERR                                                            
         MVC   2(1,R4),12(R3)                                                   
*                                                                               
         L     R1,AIO3                                                          
         USING VTCD,R1                                                          
         XC    VTCD(VTCLNQ),VTCD                                                
         MVI   VTCACTN,VTCAOOPT    VALIDATE OUTPUT TAX CODE                     
         MVC   VTCCPY,CUL          COMPANY CODE                                 
         MVC   VTCCOMF,ACOMFACS                                                 
         MVC   VTCPRV,OPDDATA                                                   
         MVC   VTCTYPE,OPDDATA+2                                                
         ST    R2,VTCAFLDH                                                      
         GOTO1 VVATICAN                                                         
         BNE   VOERR                                                            
*                                                                               
         MVI   OPDLN,OPDLN1Q+L'VTCTYPE+L'VTCPRV                                 
         B     VOX                                                              
         DROP  R1                                                               
*                                                                               
VO42     LA    R0,VO42TBLN         WORKCODE TYPES (O,P OR T)                    
         LA    RE,VO42TAB                                                       
         B     VAL1BYTE                                                         
*                                                                               
VO44     DC    H'0'                SHOULDN'T GET HERE                           
*                                                                               
VO45     LA    R0,VO45TBLN         STICKY LABLES                                
         LA    RE,VO45TAB          VALID ENTRIES = Y, N AND C                   
         B     VAL1BYTE                                                         
*                                                                               
VO46     SR    R1,R1                                                            
         IC    R1,5(R2)            R1=NUM OF INPUT WCTYPES                      
         LA    RF,8(R2)            RF=A(INPUT)                                  
VO46A    LA    R0,VO42TBLN         WORKCODE TYPES (O,P,R OR T)                  
         LA    RE,VO42TAB                                                       
VO46B    CLC   0(1,RF),0(RE)       TEST INPUT TYPE IN TABLE                     
         BE    VO46C                                                            
         LA    RE,1(RE)            NEXT TABLE ENTRY                             
         BCT   R0,VO46B                                                         
         B     VOERR               NOT IN TABLE - INVALID INPUT                 
VO46C    LA    RF,1(RF)            NEXT INPUT TYPE                              
         BCT   R1,VO46A                                                         
         B     VOMOVEX                                                          
*                                                                               
VO50     LA    R0,VO50TBLN                                                      
         LA    RE,VO50TAB                                                       
         B     VAL1BYTE                                                         
*                                                                               
VO52     LA    R4,6                PERCENTAGE TO 6 DEC                          
         ZIC   R3,5(R2)                                                         
         MVI   OPDLN,OPDLN1Q+5                                                  
         LA    R1,7(R2,R3)         POSITION R1 TO END OF FIELD                  
         CLI   0(R1),C'%'          IS THIS A PERCENTAGE SIGN                    
         BNE   *+6                                                              
         BCTR  R3,0                THEN REDUCE FIELD LENGTH                     
         GOTO1 CASHVAL,DMCB,((R4),8(R2)),(R3)                                   
         CLI   DMCB,X'FF'                                                       
         BE    VOERR                                                            
         L     R1,DMCB+4                                                        
         CVD   R1,DUB                                                           
         MVC   OPDDATA(5),DUB+3    RETURN 5 BYTE PERCENT (PACKED)               
         B     VOX                                                              
*                                                                               
VO53     CLI   5(R2),L'GOREPFOR                                                 
         BH    VOERR               TOO LONG                                     
         CLI   5(R2),0                                                          
         BE    VOERR                                                            
         XR    RF,RF                                                            
         IC    RF,5(R2)                                                         
         L     R0,AIO                                                           
*                                                                               
         USING ERFRECD,R1                                                       
         LA    R1,KEY                                                           
         XC    ERFKEY,ERFKEY                                                    
         MVI   ERFKTYP,ERFKTYPQ                                                 
         MVI   ERFKSUB,ERFKSUBQ                                                 
         MVC   ERFKCPY,CUL                                                      
         MVI   ERFKAPPL,ERFKESTQ                                                
         MVC   ERFKFRMT,MYSPACE                                                 
         SHI   RF,1                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   ERFKFRMT(0),8(R2)                                                
         MVI   RDUPDATE,C'N'                                                    
         MVC   AIO,AIO3                                                         
         GOTO1 HIGH                                                             
         CLC   KEY(L'ERFKEY),KEYSAVE                                            
         BE    VO53A               FOUND IT                                     
         MVI   ERROR,BADFORM                                                    
         B     VOERRCUR                                                         
*                                                                               
VO53A    ST    R0,AIO                                                           
         L     R1,AIO3                                                          
         MVC   OPDDATA(L'ERFKFRMT),ERFKFRMT                                     
         MVI   OPDLN,OPDLN1Q+L'ERFKFRMT                                         
         B     VOX                                                              
         DROP  R1                                                               
*                                                                               
VO54     XC    MYTEMP,MYTEMP                                                    
         GOTO1 SCANNER,DMCB,(R2),BLOCK,0                                        
         XR    R1,R1                                                            
         IC    R1,DMCB+4                                                        
         LTR   R1,R1                                                            
         BZ    VOERR                                                            
         CHI   R1,L'GOSELEST-1                                                  
         BH    VOERR                                                            
         LA    R3,BLOCK                                                         
         LA    R4,MYTEMP                                                        
         MVI   MYBYTE2,1                                                        
*                                                                               
VO54A    CLI   0(R3),0             LENGTH MUST BE 1-2                           
         BE    VOERR                                                            
         CLI   0(R3),3                                                          
         BH    VOERR                                                            
         ST    R1,MYFULL                                                        
         XR    RF,RF                                                            
         IC    RF,0(R3)                                                         
         GOTO1 CASHVAL,DMCB,(C'N',12(R3)),(RF)                                  
         CLI   0(R1),0                                                          
         BNE   VOERR                                                            
         L     RF,4(R1)                                                         
         CHI   RF,255                                                           
         BNL   VOERR                                                            
         LTR   RF,RF                                                            
         BNP   VOERR                                                            
         STC   RF,MYBYTE1                                                       
         LA    RE,MYTEMP                                                        
*                                                                               
VO54B    CLI   0(RE),0             CHECK FOR DUPE                               
         BE    VO54C                                                            
         CLC   MYBYTE1,0(RE)                                                    
         BE    VOERR                                                            
         AHI   RE,1                                                             
         B     VO54B                                                            
*                                                                               
VO54C    MVC   0(1,R4),MYBYTE1                                                  
         XR    RF,RF                                                            
         IC    RF,MYBYTE2                                                       
         AHI   RF,1                                                             
         STC   RF,MYBYTE2                                                       
         AHI   R3,32                                                            
         AHI   R4,1                                                             
         L     R1,MYFULL                                                        
         BCT   R1,VO54A                                                         
*                                                                               
VO54D    XR    RF,RF                                                            
         IC    RF,MYBYTE2                                                       
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   OPDDATA(0),MYTEMP                                                
         AHI   RF,OPDLN1Q                                                       
         STC   RF,OPDLN                                                         
         B     VOX                                                              
*                                                                               
VO55     CLI   5(R2),5             MAX LEN 'X,X,X'                              
         BH    VOERR                                                            
         SR    RF,RF                                                            
         IC    RF,5(R2)                                                         
         MVC   OPDDATA(3),MYSPACE                                               
         LA    R1,OPDDATA          R1=A(OUTPUT ELEMENT DATA)                    
*                                                                               
VO55A    LA    R0,3                R0=N'VALID VALUES                            
         LA    RE,VO30TAB          RE=A(VALID VALUES)                           
*                                                                               
VO55B    LA    R3,8-1(RF,R2)       WORK BACKWARDS ALONG INPUT                   
         CLI   0(R3),C','          TEST COMMA                                   
         BNE   VO55C               NO                                           
         BCT   RF,VO55B            DECREMENT RF, AND TRY AGAIN                  
         B     VOERR               1ST CHAR=COMMA - ERROR                       
*                                                                               
VO55C    CLC   0(1,R3),0(RE)       TEST INPUT VS TABLE VALUE                    
         BE    VO55D               MATCHES                                      
         AHI   RE,1                ELSE BUMP TO NEXT TABLE VALUE                
         BCT   R0,VO55C            AND LOOP                                     
         B     VOERR               NO MATCH - ERROR                             
*                                                                               
VO55D    MVC   0(1,R1),0(R3)       MOVE VALUE TO ELEMENT                        
         AHI   R1,1                BUMP A(OUTPUT)                               
         BCT   RF,VO55A            AND LOOP                                     
                                                                                
         MVI   OPDLN,OPDLN1Q+3     HARD LENGTH                                  
         B     VOX                                                              
*                                                                               
VO56     LA    R4,2                PERCENTAGE TO 2 DEC                          
         MVI   OPDLN,OPDLN1Q+3                                                  
         BAS   RE,CONNUMB                                                       
         CP    DUB,=P'10000'       100%                                         
         BH    VOERR                                                            
         MVC   OPDDATA(3),DUB+5    RETURN 3 BYTE PERCENT (PACKED)               
         B     VOX                                                              
*                                                                               
VO57     MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(L'AC@CLIAP),AC@CLIAP  CLIENT APPROVED                       
         MVI   BYTE,X'06'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(16),=C'MANAGER APPROVED'                                    
         MVI   BYTE,X'07'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(L'AC@NONE),AC@NONE     NONE                                 
         MVI   BYTE,X'01'                                                       
         BAS   RE,VO57T                                                         
         B     VO57C                                                            
*                                                                               
VO57A    MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(L'AC@NONE),AC@NONE     NONE                                 
         MVI   BYTE,X'01'                                                       
         BAS   RE,VO57T                                                         
         B     *+8                                                              
*                                                                               
VO57B    MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(13),=C'PART APPROVED'  PART APPROVED                        
         MVI   BYTE,X'05'                                                       
         BAS   RE,VO57T                                                         
*                                                                               
VO57C    MVC   WORK(L'AC@APRVD),AC@APRVD   APPROVED                             
         MVI   BYTE,X'02'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(11),=C'IN PROGRESS'    IN PROGRESS                          
         MVI   BYTE,X'03'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(L'AC@ESSUB),AC@ESSUB   SUBMITTED                            
         MVI   BYTE,X'04'                                                       
         BAS   RE,VO57T                                                         
         B     VOERR                                                            
*                                                                               
VO57T    CLC   8(1,R2),WORK                CHECK MATCH ON ENTRY                 
         BE    VO57X                       *LANGUAGE SOFT TEST*                 
         BR    RE                                                               
*                                                                               
VO57X    MVC   OPDDATA(1),BYTE     PUT THE DATA IN                              
         B     VOX                                                              
*                                                                               
VO58     MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(L'AC@NONE),AC@NONE     NONE                                 
         MVI   BYTE,X'01'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(L'AC@ERROR),AC@ERROR   ERROR                                
         MVI   BYTE,X'02'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(7),=C'WARNING'         WARNING                              
         MVI   BYTE,X'03'                                                       
         BAS   RE,VO57T                                                         
         B     VOERR                                                            
*                                                                               
VO59     MVI   OPDLN,OPDLN1Q+1                                                  
         CLI   8(R2),C' '          BLANK                                        
         BNH   VOERR                                                            
         CLI   8(R2),C'1'          1-8                                          
         BL    VOERR                                                            
         CLI   8(R2),C'8'                                                       
         BH    VOERR                                                            
         CLI   9(R2),C' '          ENTRY TOO LONG?                              
         BH    VOERR                                                            
*                                                                               
VO59X    NI    8(R2),X'FF'-X'F0'                                                
         MVC   OPDDATA(1),8(R2)                                                 
         B     VOX                                                              
*                                  MYBYTE5 STORES LENGTH OF ENTRY               
VO60     MVI   OPDLN,OPDLN1Q+4                = 21 BYTES                        
         MVI   MYBYTE5,C'1'                                                     
*                                                                               
VO60A    LA    RF,8(R2)                                                         
         XC    MYBYTE1(MYBYTE4-MYBYTE1),MYBYTE1                                 
         XR    RE,RE                                                            
         LHI   RE,4                                                             
         CLC   0(12,RF),MYSPACE    EMPTY?                                       
         BNH   VO60L                                                            
*                                                                               
VO60B    CLI   0(RF),C' '                                                       
         BNH   VO60G                                                            
         CLI   0(RF),C'A'          ARTIST                                       
         BNE   VO60C                                                            
         TM    MYBYTE1,X'80'                                                    
         BNZ   VOERR                                                            
         OI    MYBYTE1,X'80'                                                    
         B     VO60F                                                            
*                                                                               
VO60C    CLI   0(RF),C'I'          INTERNAL                                     
         BNE   VO60D                                                            
         TM    MYBYTE2,X'80'                                                    
         BNZ   VOERR                                                            
         OI    MYBYTE2,X'80'                                                    
         B     VO60F                                                            
*                                                                               
VO60D    CLI   0(RF),C'P'          PRODUCTION                                   
         BNE   VO60E                                                            
         TM    MYBYTE3,X'80'                                                    
         BNZ   VOERR                                                            
         OI    MYBYTE3,X'80'                                                    
         B     VO60F                                                            
*                                                                               
VO60E    CLI   0(RF),C'E'          EXPENSE                                      
         BNE   VOERR                                                            
         TM    MYBYTE4,X'80'                                                    
         BNZ   VOERR                                                            
         OI    MYBYTE4,X'80'                                                    
*                                                                               
                                                                                
VO60F    CLI   MYBYTE5,C'2'        2 CHAR ENTRIES                               
         BL    VO60G                                                            
         AHI   RF,1                                                             
         CLI   0(RF),C'C'          COMPULSORY?                                  
         BE    VO60G                                                            
         CLI   0(RF),C'O'                                                       
         BE    VO60G                                                            
         B     VOERR                                                            
*                                                                               
VO60G    AHI   RF,1                                                             
         CLI   0(RF),C' '                                                       
         BNH   VO60H                                                            
         CLI   0(RF),C','          ENTRIES SEPARATED BY COMMAS                  
         BNE   *+8                                                              
         AHI   RF,1                                                             
         BCT   RE,VO60B                                                         
         CLI   0(RF),C' '          TOO MUCH ENTERED?                            
         BH    VOERR                                                            
*                                                                               
VO60H    LA    RF,8(R2)                                                         
         LHI   RE,7                                                             
         CLI   MYBYTE5,C'2'                                                     
         BL    *+8                                                              
         LHI   RE,11                                                            
*                                                                               
VO60I    CLI   0(RF),C' '                                                       
         BNH   VO60K                                                            
         CLI   0(RF),C','                                                       
         BNE   VO60J                                                            
         MVC   0(10,RF),1(RF)                                                   
         B     *+8                                                              
*                                                                               
VO60J    AHI   RF,1                                                             
         BCT   RE,VO60I                                                         
*                                                                               
VO60K    CR    RE,1                WE'VE GOT SPACES                             
         BH    VOERR                                                            
         LHI   RE,3                                                             
         CLI   MYBYTE5,C'2'                                                     
         BL    *+8                                                              
         LHI   RE,7                                                             
         MVC   OPDDATA(0),8(R2)                                                 
         EX    RE,*-6                                                           
VO60L    OC    OPDDATA,MYSPACE                                                  
         B     VOX                                                              
*                                                                               
VO61     MVI   OPDLN,OPDLN1Q+1                                                  
         MVI   BYTE,C'Y'                                                        
         CLC   8(1,R2),AC@YES      YES                                          
         BE    VO61X                                                            
         MVI   BYTE,C'N'                                                        
         CLC   8(1,R2),AC@NO       NO                                           
         BE    VO61X                                                            
         MVI   BYTE,C'C'                                                        
         CLC   8(1,R2),AC@COMP     COMPULSORY                                   
         BE    VO61X                                                            
         B     VOERR                                                            
*                                                                               
VO61X    MVC   OPDDATA(1),BYTE                                                  
         B     VOX                                                              
*                                                                               
VO62     LA    RF,8(R2)                                                         
         CLI   0(RF),C'0'          CHECK ENTRY IS NUMERIC                       
         BL    VOERR                                                            
         BH    VO62B                                                            
         LHI   RE,19               MAX 20 CHARS                                 
         AHI   RF,1                                                             
*                                                                               
VO62A    CLI   0(RF),C'0'          EXCLUDE LEADING ZEROS                        
         BH    VO62B                                                            
         AHI   RF,1                                                             
         BCT   RE,VO62A                                                         
*                                                                               
VO62B    LHI   RE,6                FIND LENGTH OF OUR ENTRY                     
         LR    R1,RF               R1=BEGINNING OF ENTRY                        
*                                                                               
VO62C    CLI   0(RF),C'0'                                                       
         BL    VO62D                                                            
         AHI   RF,1                                                             
         BCT   RE,VO62C                                                         
         CLI   0(RF),C'0'          CHECK ENTRY NOT TOO LONG                     
         BNL   VOERR                                                            
*                                                                               
VO62D    SR    RF,R1               GET LENGTH OF ENTRY IN RF                    
         MVI   WORK,C'0'           PAD OUT WITH ZEROS                           
         MVC   WORK+1(L'WORK-1),WORK                                            
         LHI   RE,6                                                             
         SR    RE,RF                                                            
         LA    RE,WORK(RE)                                                      
         MVC   0(0,RE),0(R1)                                                    
         EX    RF,*-6                                                           
*                                                                               
         CLC   WORK(6),=C'100000'  PUT OUR CHECK HERE TO AVOID DUMPS            
         BH    VOERR               ON MONSTER NUMBERS                           
         GOTO1 NUMERIC             NUMERIC 1-100000                             
         STCM  R1,7,OPDDATA                                                     
         MVI   OPDLN,OPDLN1Q+3                                                  
         B     VOX                                                              
*                                                                               
VO63     MVI   OPDLN,OPDLN1Q+1             CHANGE AS RESUBMIT                   
         MVC   WORK(L'AC@ALL),AC@ALL       ALL FIELDS                           
         MVI   BYTE,C'A'                                                        
         BAS   RE,VO57T                                                         
*                                                                               
         MVC   WORK(L'AC@KEY),AC@KEY       KEY FIELDS                           
         MVI   BYTE,C'K'                                                        
         BAS   RE,VO57T                                                         
*                                                                               
         MVC   WORK(L'AC@NO),AC@NO         NO                                   
         MVI   BYTE,C'N'                                                        
         BAS   RE,VO57T                                                         
         B     VOERR                                                            
*                                                                               
VO64     MVI   OPDLN,OPDLN1Q+1             ORDER ANALYSIS                       
         MVC   WORK(L'AC@APRVR),AC@APRVR   APPROVER                             
         MVI   BYTE,X'01'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(9),=C'SUBMITTER'       SUBMITTER                            
         MVI   BYTE,X'02'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(L'AC@NONE),AC@NONE     NONE                                 
         MVI   BYTE,X'03'                                                       
         BAS   RE,VO57T                                                         
         B     VOERR                                                            
*                                                                               
VO65     MVI   OPDLN,OPDLN1Q+1             CHECK FOR MATCH ON FULL              
         LLC   RE,7(R2)                                                         
         OC    8(0,R2),MYSPACE                                                  
         EX    RE,*-6                                                           
         CLC   8(0,R2),=C'MEDIA SI'                                             
         EX    RE,*-6                                                           
         BNE   *+12                                                             
         MVI   OPDDATA,X'01'                                                    
         B     VOX                                                              
*                                                                               
         CLC   8(0,R2),=C'MEDIA SK'                                             
         EX    RE,*-6                                                           
         BNE   *+12                                                             
         MVI   OPDDATA,X'02'                                                    
         B     VOX                                                              
*                                                                               
         CLC   8(0,R2),=C'WORK CODE SI'                                         
         EX    RE,*-6                                                           
         BNE   *+12                                                             
         MVI   OPDDATA,X'03'                                                    
         B     VOX                                                              
*                                                                               
         CLC   8(02,R2),=C'WORK CODE SK'                                        
         EX    RE,*-6                                                           
         BNE   *+12                                                             
         MVI   OPDDATA,X'04'                                                    
         B     VOX                                                              
*                                          NOW TRY 2 LETTER MATCH               
         MVC   WORK(8),=C'MEDIA SI'     MEDIA                                   
         MVI   BYTE,C'M'                                                        
         BAS   RE,VO65A                                                         
         MVC   WORK(12),=C'WORK CODE SI'   WORK CODE                            
         MVI   BYTE,C'W'                                                        
         BAS   RE,VO65A                                                         
         B     VOERR                                                            
*                                                                               
VO65A    CLC   8(1,R2),WORK                CHECK MATCH ON ENTRY                 
         BE    VO65B                       *LANGUAGE SOFT TEST*                 
         BR    RE                                                               
*                                                                               
VO65B    MVC   OPDDATA(L'BYTE),BYTE                                             
         MVI   BYTE,C'I'                                                        
         BAS   RE,VO65C                                                         
         MVI   BYTE,C'K'                                                        
         BAS   RE,VO65C                                                         
         B     VOERR                                                            
*                                                                               
VO65C    CLC   9(1,R2),BYTE                                                     
         BE    VO65D                                                            
         BR    RE                                                               
*                                                                               
VO65D    CLC   8(2,R2),=C'MI'                                                   
         BNE   *+12                                                             
         MVI   BYTE,X'01'                                                       
         B     VO65X                                                            
         CLC   8(2,R2),=C'MK'                                                   
         BNE   *+12                                                             
         MVI   BYTE,X'02'                                                       
         B     VO65X                                                            
         CLC   8(2,R2),=C'WI'                                                   
         BNE   *+12                                                             
         MVI   BYTE,X'03'                                                       
         B     VO65X                                                            
         CLC   8(2,R2),=C'WK'                                                   
         BE    *+6                                                              
         DC    H'0'                                                             
         MVI   BYTE,X'04'                                                       
*                                                                               
VO65X    MVC   OPDDATA+1(L'BYTE),BYTE                                           
         B     VOX                                                              
*                                                                               
VO66     MVI   OPDLN,OPDLN1Q+1                                                  
         CLC   8(1,R2),AC@DRAFT    CHECK DRAFT                                  
         BNE   VO6                                                              
         MVI   OPDDATA,C'D'                                                     
         B     VOX                                                              
*                                                                               
VO67     MVI   OPDLN,OPDLN1Q+8                = 25 BYTES                        
         MVI   MYBYTE5,C'2'        SET TO USE 2 BYTE ENTRIES                    
         B     VO60A                                                            
*                                                                               
VO68     MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(4),=C'COST'           COST                                  
         MVI   BYTE,X'01'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(5),=C'SALES'          OR SALES                              
         MVI   BYTE,X'02'                                                       
         BAS   RE,VO57T                                                         
         B     VOERR                                                            
*                                                                               
VO71     MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(L'AC@CLIAP),AC@CLIAP   CLIENT APPROVED                      
         MVI   BYTE,X'06'                                                       
         BAS   RE,VO57T                                                         
         MVC   WORK(16),=C'MANAGER APPROVED'                                    
         MVI   BYTE,X'07'                                                       
         BAS   RE,VO57T                                                         
         B     VO57C                                                            
*                                                                               
VO72     CLI   5(R2),1             TEST FOR ONE BYTE INPUT                      
         BNE   VOERR                                                            
         CLI   8(R2),C'1'          CHECK VALID NUMBER                           
         BL    VO72A                                                            
         CLI   8(R2),C'9'                                                       
         BH    VO72A                                                            
         B     VO72B                                                            
*                                                                               
VO72A    CLI   8(R2),X'C1'         CHECK CHARACTER IS IN VALID RANGE            
         BL    VOERR                                                            
         CLI   8(R2),X'E9'                                                      
         BH    VOERR                                                            
         CLI   8(R2),C'}'                                                       
         BE    VOERR                                                            
         CLI   8(R2),C'\'                                                       
         BE    VOERR                                                            
*                                                                               
VO72B    MVC   OPDDATA(1),8(R2)                                                 
         MVI   OPDLN,OPDLN1Q+1                                                  
         B     VOX                                                              
*                                                                               
VO73     MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(11),=C'CONTINGENCY'                                         
         MVI   BYTE,C'C'                                                        
         BAS   RE,VO57T                                                         
*                                                                               
VO73A    MVC   WORK(L'AC@YES),AC@YES      YES                                   
         MVI   BYTE,C'Y'                                                        
         BAS   RE,VO57T                                                         
         MVC   WORK(L'AC@NO),AC@NO        NO                                    
         MVI   BYTE,C'N'                                                        
         BAS   RE,VO57T                                                         
         B     VOERR                                                            
*                                                                               
VO74     MVI   OPDLN,OPDLN1Q+5                                                  
         LHI   R0,5                5 ENTRIES                                    
         LA    RF,8(R2)                                                         
         LA    RE,OPDDATA                                                       
*                                                                               
VO74A    CLI   0(RF),C' '          HIT END?                                     
         BNH   VO74X                                                            
         CLI   0(RF),C'P'          IN PROGRESS                                  
         BE    VO74B                                                            
         CLI   0(RF),C'B'          SUBMITTED INTERNALLY                         
         BE    VO74B                                                            
         CLI   0(RF),C'I'          INTERNALLY APPROVED                          
         BE    VO74B                                                            
         CLI   0(RF),C'S'          SUBMITTED TO CLIENT                          
         BE    VO74B                                                            
         CLI   0(RF),C'A'          CLIENT APPROVED                              
         BE    VO74B                                                            
         B     VOERR               BAD OPTION                                   
*                                                                               
VO74B    MVC   0(1,RE),0(RF)       SAVE VALUE                                   
         AHI   RF,1                                                             
         AHI   RE,1                                                             
         CLI   0(RF),C','          SEPARATED BY COMMAS?                         
         BNE   *+8                                                              
         AHI   RF,1                                                             
         BCT   R0,VO74A                                                         
*                                                                               
VO74X    B     VOX                                                              
*                                                                               
VO75     MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(7),=C'AMOUNT'                                               
         MVI   BYTE,C'A'                                                        
         BAS   RE,VO57T                                                         
         B     VO73A                                                            
*                                                                               
VO76     MVI   OPDLN,OPDLN1Q+1                                                  
         MVC   WORK(L'AC@NONE),AC@NONE     NONE                                 
         MVI   BYTE,X'01'                                                       
         BAS   RE,VO57T                                                         
         B     VO71                                                             
*                                                                               
VO79     L     R0,AIO              SAVE IO AREA POINTER                         
         XC    KEY,KEY                                                          
         MVI   KEY,X'0C'                                                        
         MVC   KEY+1(1),CUL                                                     
         MVC   KEY+2(6),MYSPACE                                                 
         LA    RF,KEY+2+6          CODES ARE RIGHT ALIGNED                      
         SR    R3,R3                                                            
         IC    R3,5(R2)                                                         
         SR    RF,R3                                                            
         BCTR  R3,0                                                             
         EX    R3,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RF),8(R2)                                                    
         MVI   RDUPDATE,C'N'                                                    
         MVC   AIO,AIO3            USE IO3 FOR READING                          
         GOTO1 HIGH                                                             
         ST    R0,AIO                                                           
         CLC   KEY(8),KEYSAVE      TEST IF NARRATIVE RECORD FOUND               
         BE    *+12                YES                                          
         MVI   ERROR,NORECQ                                                     
         B     VOERRCUR                                                         
         MVC   OPDDATA(6),KEY+2                                                 
         MVI   OPDLN,OPDDATA-OPDEL+6                                            
         B     VOX                                                              
*                                                                               
CONNUMB  ST    RE,MYFULL                                                        
         LLC   R3,5(R2)            PERCENTAGE TO (R4) DEC                       
         LA    R1,7(R2,R3)         POSITION R1 TO END OF FIELD                  
         CLI   0(R1),C'%'          IS THIS A PERCENTAGE SIGN                    
         BNE   *+6                                                              
         BCTR  R3,0                THEN REDUCE FIELD LENGTH                     
         GOTO1 CASHVAL,DMCB,((R4),8(R2)),(R3)                                   
         CLI   DMCB,X'FF'                                                       
         BE    VOERR                                                            
         L     R1,DMCB+4                                                        
         CVD   R1,DUB                                                           
         L     RE,MYFULL                                                        
         BR    RE                                                               
*        VALOPT GENERAL EXITS                                                   
*                                                                               
VAL1BYTE DS    0H                  VALIDATE A 1 BTYE ENTRY                      
*                                  RE=A(TABLE OF VALID ENTRIES)                 
*                                  R0=NUMBER OF VALID ENTRIES                   
*                                  R2=A(FIELD TO VALIDATE                       
*                                  R6=A(OPTION ELEMENT TO BUILD                 
*                                                                               
         CLI   5(R2),1             TEST FOR ONE BYTE INPUT                      
         BNE   VOERR                                                            
         MVC   OPDDATA(1),8(R2)    FINISH ELEMENT                               
         MVI   OPDLN,OPDLN1Q+1                                                  
*                                                                               
         CLC   OPDDATA(1),0(RE)    VALIDATE ENTRY FROM TABLE                    
         BE    VOX                                                              
         LA    RE,1(RE)                                                         
         BCT   R0,*-14                                                          
         B     VOERR                                                            
*                                                                               
*        MOVE THE CHARACTERS AT 8(R2) OPDDATA(R6) FOR 5(R2)                     
*        THEN XIT                                                               
VOMOVEX  DS    0H                                                               
         ZIC   R1,5(R2)                                                         
         LA    R1,OPDLN1Q(R1)           MAKE IT ELEMENT LENGTH                  
         STC   R1,OPDLN                 SAVE LENGTH                             
         SHI   R1,OPDLN1Q+1                                                     
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   OPDDATA(0),8(R2)                                                 
         B     VOX                                                              
*                                                                               
VOERR    MVI   ERROR,INVALID                                                    
         L     R1,APARMS                                                        
         MVI   4(R1),01                                                         
         B     XIT                                                              
*                                                                               
VOX      L     R1,APARMS                                                        
         MVI   4(R1),0                                                          
         B     XIT                                                              
*                                                                               
XIT      XMOD1                                                                  
*                                                                               
VOERRCUR L   R1,APARMS                                                          
         MVI   4(R1),X'FF'                                                      
         B     XIT                                                              
         EJECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
*        CONSTANTS NEEDED BY VALOPT ROUTINES                                    
*                                                                               
* TABLE OF WHERE POSITION CODE                                                  
*                                                                               
WHERETAB DS    0CL2                                                             
         DC    C'T '                                                            
         DC    C'ST'                                                            
         DC    C'H '                                                            
         DC    C'SH'                                                            
         DC    C'F '                                                            
         DC    C'SF'                                                            
WHERES   EQU   (*-WHERETAB)/L'WHERETAB                                          
*                                                                               
* TABLES OF VALID 1 BYTE ENTRIES                                                
*                                                                               
VO08TAB  DS    0C                                                               
         DC    C'ET'                                                            
VO08TBLN EQU   (*-VO08TAB)                                                      
*                                                                               
VO09TAB  DS    0C                                                               
         DC    C'MP'                                                            
VO09TBLN EQU   (*-VO09TAB)                                                      
*                                                                               
VO19TAB  DS    0C                                                               
         DC    C'BPNO'                                                          
VO19TBLN EQU   (*-VO19TAB)                                                      
*                                                                               
VO30TAB  DS    0C                                                               
         DC    C'BNR'                                                           
VO30TBLN EQU   (*-VO30TAB)                                                      
*                                                                               
VO31TAB  DS    0C                                                               
         DC    C'RNAX'                                                          
VO31TBLN EQU   (*-VO31TAB)                                                      
*                                                                               
VO34TAB  DS    0C                                                               
         DC    C'HU'                                                            
VO34TBLN EQU   (*-VO34TAB)                                                      
*                                                                               
VO42TAB  DS    0C                                                               
         DC    C'OPRT'                                                          
VO42TBLN EQU   (*-VO42TAB)                                                      
*                                                                               
VO45TAB  DS    0C                                                               
         DC    C'NYC'                                                           
VO45TBLN EQU   (*-VO45TAB)                                                      
*                                                                               
VO50TAB  DS    0C                                                               
         DC    C'YNCB'                                                          
VO50TBLN EQU   (*-VO50TAB)                                                      
*                                                                               
         EJECT                                                                  
DDIN     DS    0C                                                               
         DCDDL AC#NONE,4                                                        
         DCDDL AC#FEE,8                                                         
         DCDDL AC#ZERO,4                                                        
         DCDDL AC#NO,4                                                          
         DCDDL AC#YES,3                                                         
         DCDDL AC#CHK3,3                                                        
         DCDDL AC#APRVL,8                                                       
         DCDDL AC#MAX,7                                                         
         DCDDL AC#CLINT,8                                                       
         DCDDL AC#PRGSV,12                                                      
         DCDDL AC#TOTAL,5                                                       
         DCDDL AC#UBLB,10                                                       
         DCDDL AC#AUTO,4                                                        
         DCDDL AC#APRVR,8                                                       
         DCDDL AC#APRVD,8                                                       
         DCDDL AC#ESSUB,9                                                       
         DCDDL AC#DRAFT,5                                                       
         DCDDL AC#CLIAP,15                                                      
         DCDDL AC#ERROR,5                                                       
         DCDDL AC#COMP,10                                                       
         DCDDL AC#KEY,3                                                         
         DCDDL AC#ALL,3                                                         
         DC    X'00'                                                            
         EJECT                                                                  
WORKD    DSECT                                                                  
APARMS   DS    A                                                                
PARMS    DS    0C                                                               
AFLDHDR  DS    A                                                                
AOPTEL   DS    A                                                                
AGEND    DS    A                                                                
PARML    EQU   *-PARMS                                                          
*                                                                               
ADDIN    DS    A                                                                
MYDUB    DS    D                                                                
MYFULL   DS    F                                                                
MYHALF   DS    H                                                                
MYBYTE1  DS    X                                                                
MYBYTE2  DS    X                                                                
MYBYTE3  DS    X                                                                
MYBYTE4  DS    X                                                                
MYBYTE5  DS    X                                                                
MYTEMP   DS    XL16                                                             
MYWORK   DS    XL64                                                             
MYSPACE  DS    CL80                                                             
MYELEM   DS    XL255                                                            
*                                                                               
*                                                                               
DDOUT    DS    0C                                                               
         DSDDL PRINT=YES                                                        
*                                                                               
WORKX    EQU   *                                                                
       ++INCLUDE ACPROWORKD                                                     
         EJECT                                                                  
*ACGENFILE                                                                      
         PRINT OFF                                                              
       ++INCLUDE ACGENFILE                                                      
         PRINT ON                                                               
*DDSPOOLD                                                                       
         PRINT OFF                                                              
       ++INCLUDE DDSPOOLD                                                       
         PRINT ON                                                               
*DDSPLWORKD                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDSPLWORKD                                                     
         PRINT ON                                                               
*ACVATICAND                                                                     
         PRINT OFF                                                              
       ++INCLUDE ACVATICAND                                                     
         PRINT ON                                                               
*CTGENFILE                                                                      
         PRINT OFF                                                              
       ++INCLUDE CTGENFILE                                                      
         PRINT ON                                                               
*DDCOMFACS                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDCOMFACS                                                      
         PRINT ON                                                               
*DDSCANBLKD                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDSCANBLKD                                                     
         PRINT ON                                                               
*ACDDEQUS                                                                       
         PRINT OFF                                                              
       ++INCLUDE ACDDEQUS                                                       
         PRINT ON                                                               
*DDCTRYEQUS                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDCTRYEQUS                                                     
         PRINT ON                                                               
         EJECT                                                                  
GOBLOCKD DSECT                                                                  
       ++INCLUDE ACGOBLOCK                                                      
         EJECT                                                                  
       ++INCLUDE ACGOBBLOCK                                                     
         EJECT                                                                  
       ++INCLUDE ACGOXBLOCK                                                     
         EJECT                                                                  
       ++INCLUDE ACCLBCOLS                                                      
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'045ACVALOPT  07/01/20'                                      
         END                                                                    
