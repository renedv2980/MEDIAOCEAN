*          DATA SET ACREQRFP   AT LEVEL 002 AS OF 02/17/99                      
*CATALP ACREQRFP                                                                
ACREQRFP TITLE '- FORMAT REQUEST DETAILS FOR RFP DISPLAY'                       
ACREQRFP CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 WORKX-WORKD,**AREQ**,RA,CLEAR=YES                                
                                                                                
         USING WORKD,RC            RC=A(LOCAL WORKING STORAGE)                  
         LR    R2,R1               R2=A(PARAMETER LIST)                         
         USING PLISTD,R2                                                        
         LM    R8,R9,PLAREQ                                                     
         USING ACQD,R8             R8=A(REQUEST CARDS)                          
         USING COMFACSD,R9         R9=A(COMFACS)                                
                                                                                
         LA    R1,DMCB             GET REPORT LITERALS                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,DDCASEL                                                   
         MVI   DDSYS,6                                                          
         MVC   DDLANG,PLLANG                                                    
         LA    RF,DDIN                                                          
         STCM  RF,7,DDIADR                                                      
         LA    RF,DDOUT                                                         
         STCM  RF,7,DDOADR                                                      
         GOTO1 CDICTATE            RESOLVE DICTIONARY WORDS                     
                                                                                
         MVI   SPACES,SPACE                                                     
         MVC   SPACES+1(L'SPACES-1),SPACES                                      
                                                                                
         LA    R0,OUTPUT           CLEAR OUTPUT AREA TO SPACES                  
         LA    R1,OUTPUTL                                                       
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE                                                            
                                                                                
         LA    R0,L'FLDH+L'FLD     CREATE FIELD HEADER FOR SOFDAT CALLS         
         STC   R0,FLDH                                                          
                                                                                
         SR    RE,RE                                                            
         IC    RE,PLLANG                                                        
         SLL   RE,1                                                             
         LA    RE,CHARTAB(RE)                                                   
         MVC   CHARS,0(RE)         SET LANGUAGE BASED CHARACTERS                
                                                                                
         LA    RE,CNTTAB           RE=DISPLACEMENTS TO CONTINUATION             
         LA    R0,CNTTABN          R0=N'ENTRIES IN TABLE                        
         LA    RF,1                RF=N'REQUEST CARDS                           
PRT02    SR    R1,R1                                                            
         ICM   R1,3,0(RE)                                                       
         LA    R1,ACQD(R1)         POINT TO CONTINUATION COLUMN                 
         CLI   0(R1),ACQCONTQ      TEST CONINUATION SET                         
         BNE   PRT04                                                            
         LA    RE,L'CNTTAB(RE)     YES - BUMP TO NEXT TABLE ENTRY               
         LA    RF,1(RF)                                                         
         BCT   R0,PRT02                                                         
                                                                                
PRT04    STC   RF,PLNREQ           SET NUMBER OF REQUEST CARDS                  
         MH    RF,=Y(L'ACQCARD1)                                                
         STCM  RF,3,MAXDSP         AND MAXIMUM DISPLACEMENTS                    
                                                                                
         LA    R3,PRGTAB           LOOK UP PROGRAM IN TABLE                     
         USING PRGTABD,R3          R3=A(PROGRAM TABLE)                          
PRT06    CLC   PRGTPRG,PRGTABX     TEST DEFAULT PROGRAM ENTRY                   
         BE    PRT08                                                            
         CLC   PRGTPRG,ACQPROG     MATCH PROGRAM CODE                           
         BE    PRT08                                                            
         LA    R3,PRGTABL(R3)      NO MATCH - BUMP TO NEXT TABLE ENTRY          
         B     PRT06                                                            
PRT08    MVC   PRGIND,PRGTIND      EXTRACT PROGRAM INDICATOR                    
         DROP  R3                                                               
                                                                                
         MVC   OPTIONS(OPTIONSL),SPACES                                         
         MVC   OPTION1,ACQOPT1     MOVE OPTIONS TO WORKING STORAGE              
         MVC   OPTION2,ACQOPT2                                                  
         MVC   OPTION3,ACQOPT3                                                  
         MVC   OPTION4,ACQOPT4                                                  
         MVC   OPTION5,ACQOPT5                                                  
         MVC   OPTION6,ACQOPT6                                                  
         MVC   OPTION7,ACQOPT7                                                  
         CLI   PLNREQ,1            OPTIONS 8-12 ARE ON CARD 2                   
         BE    PRT10                                                            
         MVC   OPTION8,ACQOPT8                                                  
         MVC   OPTION9,ACQOPT9                                                  
         MVC   OPTION10,ACQOPT10                                                
*&&UK*&& MVC   OPTION11,ACQOPT11                                                
*&&UK*&& MVC   OPTION12,ACQOPT12                                                
                                                                                
PRT10    LA    R3,REQTAB           R3=A(REQUEST FIELD TABLE)                    
         USING REQTABD,R3                                                       
         LA    R4,OUTPUT           R4=A(NEXT OUTPUT AREA)                       
                                                                                
PRT12    CLI   REQTABD,REQTEOTQ    TEST END OF TABLE                            
         BE    PRTEXIT                                                          
                                                                                
         MVC   WORK(L'REQTDSP),REQTDSP                                          
         NI    WORK,ALLBITS-REQTDWRK                                            
         SR    RF,RF                                                            
         ICM   RF,3,WORK                                                        
         TM    REQTDSP,REQTDWRK    TEST SPECIAL DISPLACEMENT                    
         BZ    *+12                                                             
         LA    RF,WORKD(RF)        YES - INDEX INTO WORKD                       
         B     PRT14                                                            
         CLC   REQTDSP,MAXDSP      TEST CARD PRESENT                            
         BH    PRT16                                                            
         LA    RF,ACQD(RF)         YES - POINT TO REQUEST DATA FIELD            
                                                                                
PRT14    SR    RE,RE                                                            
         IC    RE,REQTLEN                                                       
         BCTR  RE,0                                                             
         EX    RE,*+8              TEST FIELD IS SPACES                         
         BNE   PRT18                                                            
         CLC   0(0,RF),SPACES                                                   
                                                                                
PRT16    LA    R3,REQTABL(R3)      BUMP TO NEXT REQTAB ENTRY                    
         B     PRT12                                                            
                                                                                
PRT18    TM    REQTIND1,REQTIAPF   TEST IF TO CHECK ACQAPFLG FOR VALUE          
         BZ    *+14                                                             
         CLC   ACQAPFLG,REQTIND2   YES - NEXT IF NO MATCH                       
         BNE   PRT16                                                            
                                                                                
         TM    REQTIND1,REQTIPRG   TEST IF TO CHECK PRGIND FOR VALUE            
         BZ    *+14                                                             
         CLC   PRGIND,REQTIND2     YES - NEXT IF NO MATCH                       
         BNE   PRT16                                                            
                                                                                
         MVC   DATA,SPACES         EXTRACT DATA FROM REQUEST CARD               
         EX    RE,*+4                                                           
         MVC   DATA(0),0(RF)                                                    
                                                                                
         SR    RE,RE                                                            
         ICM   RE,3,REQTNAM                                                     
         LA    RE,DDOUT(RE)                                                     
         MVC   KEYWORD,SPACES                                                   
         SR    RF,RF                                                            
         ICM   RF,1,REQTNAML       RF=L'KEYWORD                                 
         BZ    *+16                                                             
         BCTR  RF,0                                                             
         EX    RF,*+4                                                           
         MVC   KEYWORD(0),0(RE)    EXTRACT KEYWORD FROM LIST                    
                                                                                
         SR    RE,RE                                                            
         IC    RE,REQTFRM          GO TO FORMAT ROUTINE                         
         SLL   RE,2                                                             
         B     *(RE)                                                            
                                                                                
         B     PRTADDF             GENERAL ALPHA FIELD (XXX=YYY)                
         B     PRTREPT             REPORT=ACNN                                  
         B     PRTDATE             XXXX DATE=EXPRESSION                         
         B     PRTULAC             UNIT/LEDGER/ACCOUNT=U(L(A))                  
         B     PRTCAUL             CONTRA UNIT/LEDGER=XX                        
         B     PRTSELS             SELECTIVE FIELD         (US SPECIAL)         
         B     PRTTTYP             TRANSACTION TYPE FILTER (US SPECIAL)         
         B     PRTBDAY             DUE DATE DAYS           (US SPECIAL)         
         B     PRTDATF             SCRIBE DATE FILTERS                          
         B     PRTOTHR             SCRIBE OTHER FILTERS/OPTIONS                 
                                                                                
PRTREPT  MVC   DATA+L'ACRLIT(L'ACRLIT),DATA                                     
         MVC   DATA(L'ACRLIT),ACRLIT                                            
         B     PRTADDF                                                          
                                                                                
PRTDATE  CLI   DATA,SPACE          HANDLE DATES                                 
         BE    *+12                                                             
         TM    DATA,NUMERIC        TEST FOR RFP WORDS                           
         BM    PRTDATE4                                                         
         LA    R1,SOFBLOCK                                                      
         USING SOFDATD,R1                                                       
         MVC   SOFITYPE,REQTIND3                                                
         MVC   SOFIINDS,REQTIND4                                                
         CLI   SOFITYPE,SOFITSD2   TEST YYMMDD                                  
         BNE   PRTDATE2                                                         
         CLC   DATA+4(2),SPACES    YES - TEST YYMM ONLY                         
         BNE   PRTDATE2                                                         
         MVI   SOFITYPE,SOFITSD1   YES - SET PROPER INPUT TYPE                  
                                                                                
PRTDATE2 MVI   SOFOTYPE,SOFOTPRT                                                
         LA    R0,DATA                                                          
         ST    R0,SOFAINP                                                       
         LA    R0,FLDH                                                          
         ST    R0,SOFAOUT                                                       
         MVC   SOFACOM,PLACOM                                                   
         MVI   SOFSYSN,6                                                        
         MVC   SOFLANG,PLLANG                                                   
         GOTO1 CSOFDAT                                                          
         MVC   DATA,FLD                                                         
         B     PRTADDF                                                          
         DROP  R1                                                               
                                                                                
PRTDATE4 LA    R1,DATA             R1=A(DATE EXPRESSION)                        
         BAS   RE,RFPSYM           TEST FOR RFP SYMBOLS                         
         B     PRTADDF                                                          
                                                                                
PRTULAC  CLI   ACQLDG,SPACE        UNIT/LEDGER/ACCOUNT                          
         BE    PRTADDF                                                          
         MVC   KEYWORD,SPACES                                                   
         MVC   KEYWORD(L'AC@LGR),AC@LGR                                         
         CLI   ACQACT,SPACE                                                     
         BE    PRTADDF                                                          
         MVC   KEYWORD,SPACES                                                   
         MVC   KEYWORD(L'AC@ACC),AC@ACC                                         
         B     PRTADDF                                                          
                                                                                
PRTCAUL  CLC   CLFLIT,DATA         CONTRA UNIT/LEDGER FILTER                    
         BNE   PRT16                                                            
         MVC   DATA(L'DATA-L'CLFLIT),DATA+L'CLFLIT                              
         MVC   DATA+L'DATA-L'CLFLIT(L'CLFLIT),SPACES                            
         B     PRTADDF                                                          
                                                                                
PRTSELS  CLC   TYPLIT,DATA         SELECTIVE FIELD         (US SPECIAL)         
         BE    PRT16                                                            
         B     PRTADDF                                                          
                                                                                
PRTTTYP  CLC   TYPLIT,DATA         TRANSACTION TYPE FILTER (US SPECIAL)         
         BNE   PRT16                                                            
         MVC   DATA(L'DATA-L'TYPLIT),DATA+L'TYPLIT                              
         MVC   DATA+L'DATA-L'TYPLIT(L'TYPLIT),SPACES                            
         CLI   DATA,C'E'                                                        
         BNE   PRTADDF                                                          
         MVC   DATA(L'DATA-1),DATA+1                                            
         MVC   DATA+L'DATA-1(1),SPACES                                          
         B     PRTADDF                                                          
                                                                                
PRTBDAY  TM    DATA,ALLBITS        DUE DATE DAYS                                
         BNM   PRT16                                                            
         SR    R0,R0                                                            
         IC    R0,DATA                                                          
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,DIGIT                                                
         UNPK  DATA(2),DUB                                                      
         B     PRTADDF                                                          
                                                                                
PRTDATF  MVC   WORK(L'DATA),DATA   HANDLE SCRIBE DATE FILTERS                   
DAT      USING ACQTYP1,WORK                                                     
         CLI   DAT.ACQTYP1,ACQDATE TEST THIS IS A DATE                          
         BNE   PRT16                                                            
         SR    R5,R5               LOOK UP DATE TYPE IN TABLE                   
         ICM   R5,3,REQTNAM                                                     
         LA    R5,ACREQRFP(R5)                                                  
         USING DATTABD,R5                                                       
PRTDATF2 CLI   DATTTYP,DATTEOTQ    TEST END OF TABLE                            
         BE    PRT16                                                            
         CLC   DATTTYP,DAT.ACQDTTYP MATCH TYPE TO REQUEST                       
         BE    *+12                                                             
         LA    R5,DATTABL(R5)      BUMP TO NEXT TABLE ENTRY                     
         B     PRTDATF2                                                         
                                                                                
         SR    RE,RE               EXTRACT START DATE KEYWORD                   
         ICM   RE,3,DATTNAM1                                                    
         LA    RE,DDOUT(RE)                                                     
         SR    RF,RF                                                            
         IC    RF,DATTLEN1                                                      
         BCTR  RF,0                                                             
         MVC   KEYWORD,SPACES                                                   
         EX    RF,*+4                                                           
         MVC   KEYWORD(0),0(RE)                                                 
                                                                                
         LA    R1,SOFBLOCK                                                      
         USING SOFDATD,R1          INTIALISE SOFDAT CONTROL BLOCK               
         XC    SOFDATD(SOFDATL),SOFDATD                                         
         MVC   SOFACOM,PLACOM                                                   
         MVC   SOFLANG,PLLANG                                                   
         MVI   SOFSYSN,6                                                        
                                                                                
         MVI   SOFITYPE,SOFITSD2   HANDLE START DATE                            
         CLC   DAT.ACQDTSTR+4(2),SPACES                                         
         BNE   *+8                                                              
         MVI   SOFITYPE,SOFITSD1                                                
         MVI   SOFOTYPE,SOFOTPRT                                                
         LA    R0,DAT.ACQDTSTR                                                  
         ST    R0,SOFAINP                                                       
         LA    R0,FLDH                                                          
         ST    R0,SOFAOUT                                                       
         CLC   DAT.ACQDTSTR,SPACES                                              
         BE    PRTDATF6                                                         
         TM    DAT.ACQDTSTR,NUMERIC                                             
         BM    PRTDATF4                                                         
         GOTO1 CSOFDAT                                                          
         MVC   DATA,FLD                                                         
         BAS   RE,ADDOUT           ADD START DATE TO OUTPUT                     
         B     PRTDATF6                                                         
                                                                                
PRTDATF4 LA    R1,DAT.ACQDTSTR     TEST FOR RFP SYMBOLS                         
         BAS   RE,RFPSYM                                                        
         BAS   RE,ADDOUT                                                        
                                                                                
PRTDATF6 CLC   DAT.ACQDTEND,SPACES HANDLE END DATE                              
         BE    PRT16                                                            
         SR    RE,RE               EXTRACT END DATE KEYWORD                     
         ICM   RE,3,DATTNAM2       ZERO MEANS NO END DATE                       
         BZ    PRT16                                                            
         LA    RE,DDOUT(RE)                                                     
         SR    RF,RF                                                            
         IC    RF,DATTLEN2                                                      
         BCTR  RF,0                                                             
         MVC   KEYWORD,SPACES                                                   
         EX    RF,*+4                                                           
         MVC   KEYWORD(0),0(RE)                                                 
         MVI   SOFITYPE,SOFITSD2                                                
         CLC   DAT.ACQDTEND+4(2),SPACES                                         
         BNE   *+8                                                              
         MVI   SOFITYPE,SOFITSD1                                                
         MVI   SOFOTYPE,SOFOTPRT                                                
         LA    R0,DAT.ACQDTEND                                                  
         ST    R0,SOFAINP                                                       
         TM    DAT.ACQDTSTR,NUMERIC                                             
         BM    PRTDATF8                                                         
         GOTO1 CSOFDAT                                                          
         MVC   DATA,FLD                                                         
         BAS   RE,ADDOUT           ADD END DATE TO OUTPUT                       
         B     PRT16                                                            
                                                                                
PRTDATF8 LA    R1,DAT.ACQDTEND     TEST FOR RFP SYMBOLS                         
         BAS   RE,RFPSYM                                                        
         BAS   RE,ADDOUT                                                        
         B     PRT16                                                            
         DROP  DAT,R1,R5                                                        
                                                                                
PRTOTHR  MVC   WORK(L'DATA),DATA   HANDLE SCRIBE OTHER FILTERS                  
OTH      USING ACQTYP1,WORK                                                     
         CLI   OTH.ACQTYP1,ACQDATE TEST THIS IS A DATE                          
         BNE   PRT16                                                            
         SR    R5,R5               LOOK UP DATA TYPE IN TABLE                   
         ICM   R5,3,REQTNAM                                                     
         LA    R5,ACREQRFP(R5)                                                  
         USING OTHTABD,R5                                                       
PRTOTHR2 CLI   OTHTTYP,OTHTEOTQ    TEST END OF TABLE                            
         BE    PRT16                                                            
         CLC   OTHTTYP,OTH.ACQTYP1 MATCH TYPE TO REQUEST                        
         BE    *+12                                                             
         LA    R5,OTHTABL(R5)      BUMP TO NEXT TABLE ENTRY                     
         B     PRTOTHR2                                                         
                                                                                
         SR    RE,RE               EXTRACT START DATE KEYWORD                   
         ICM   RE,3,OTHTNAM                                                     
         LA    RE,DDOUT(RE)                                                     
         SR    RF,RF                                                            
         IC    RF,OTHTLEN                                                       
         BCTR  RF,0                                                             
         MVC   KEYWORD,SPACES                                                   
         EX    RF,*+4                                                           
         MVC   KEYWORD(0),0(RE)                                                 
         MVC   DATA(L'DATA-L'ACQTYP1),DATA+L'ACQTYP1                            
         MVC   DATA+L'DATA-L'ACQTYP1(L'ACQTYP1),SPACES                          
         B     PRTADDF                                                          
         DROP  OTH,R5                                                           
         EJECT                                                                  
***********************************************************************         
* ADD KEYWORD AND DATA TO OUTPUT STRING                               *         
* NTRY - KEYWORD=DATA KEYWORD                                         *         
*        DATA=DATA VALUE (1ST BYTE X'40' OFF INDICATES 'ALL EXCEPT')  *         
*        R4=A(NEXT OUTPUT AREA)                                       *         
***********************************************************************         
                                                                                
PRTADDF  BAS   RE,ADDOUT                                                        
         B     PRT16                                                            
                                                                                
ADDOUT   MVC   0(L'KEYWORD,R4),KEYWORD                                          
         LA    R4,L'KEYWORD-1(R4)                                               
         CLI   0(R4),SPACE                                                      
         BH    *+8                                                              
         BCT   R4,*-8                                                           
         MVC   1(L'EQUAL,R4),EQUAL                                              
         TM    DATA,SPACE          TEST 'ALL EXCEPT'                            
         BNZ   *+16                                                             
         OI    DATA,SPACE                                                       
         MVI   1+L'EQUAL(R4),ALLXCEPT                                           
         LA    R4,1(R4)                                                         
         MVC   1+L'EQUAL(L'DATA,R4),DATA                                        
         LA    R4,1+L'EQUAL+L'DATA-1(R4)                                        
         CLI   0(R4),SPACE                                                      
         BH    *+8                                                              
         BCT   R4,*-8                                                           
         MVC   1(L'COMMA,R4),COMMA                                              
         LA    R4,1+L'COMMA(R4)                                                 
         BR    RE                                                               
                                                                                
***********************************************************************         
* MOVE OUTPUT STRING TO CALLER'S INPUT AREA                           *         
***********************************************************************         
                                                                                
PRTEXIT  L     R0,PLAREQ           RETURN STRING IN CALLER'S AREA               
         LA    R1,ACQL                                                          
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE                                                            
                                                                                
         LA    R0,OUTPUT                                                        
         ST    R0,PLAOUT           RETURN A(OUTPUT) TO CALLER                   
         MVI   PLNREQ,3                                                         
         L     R1,PLAREQ           POINT TO FIRST OUTPUT AREA                   
         LA    RE,OUTPUT+(L'ACQCARD1-2)                                         
         CLC   0(L'COMMA,RE),COMMA LOCATE COMMA AT END OF INPUT STRING          
         BE    *+8                                                              
         BCT   RE,*-10                                                          
         LA    RF,OUTPUT                                                        
         SR    RE,RF                                                            
         SH    RE,=Y(L'COMMA)                                                   
         EX    RE,*+4                                                           
         MVC   0(0,R1),OUTPUT                                                   
         LA    R1,L'ACQCARD1(R1)                                                
         LA    RF,1+L'COMMA(RE,RF)                                              
                                                                                
         CLI   0(RF),SPACE         TEST ANY MORE TO OUTPUT                      
         BE    EXIT                                                             
         LA    RE,L'ACQCARD1-L'COMMA-1(RF)                                      
         CLC   0(L'COMMA,RE),COMMA                                              
         BE    *+8                                                              
         BCT   RE,*-10                                                          
         SR    RE,RF                                                            
         SH    RE,=Y(L'COMMA)                                                   
         EX    RE,*+4                                                           
         MVC   0(0,R1),0(RF)                                                    
                                                                                
EXIT     XIT1  ,                                                                
         EJECT                                                                  
***********************************************************************         
* TEST DATE EXPRESSION FOR RFP KEYWORD, RETURN DATA KEYWORD IF TRUE   *         
* NTRY - R1=A(DATE EXPRESSION)                                        *         
* EXIT - DATA INTACT OR CONTAINS RFP KEYWORD                          *         
***********************************************************************         
                                                                                
RFPSYM   CLI   0(R1),DD#ESCL       TEST STARTS WITH ESCAPE SEQUENCE             
         BLR   RE                                                               
         CLI   0(R1),DD#ESCS                                                    
         BHR   RE                                                               
         LR    R0,RE               SAVE RETURN ADDRESS                          
         ICM   RF,3,1(R1)                                                       
         MVC   DATA,SPACES         EXTRACT DATA FROM REQUEST CARD               
         MVI   DATA,DD#ESCL                                                     
         STCM  RF,3,DATA+1                                                      
         MVI   DATA+3,L'DATA                                                    
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNS      ISSUE SINGLE UPPER TRANSLATE                 
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,6                                                          
         MVC   DDLANG,PLLANG                                                    
         LA    RF,DATA                                                          
         STCM  RF,7,DDIADR                                                      
         LA    RF,DUB                                                           
         STCM  RF,7,DDOADR                                                      
         GOTO1 CDICTATE            RESOLVE RFP SYMBOL                           
         LR    RE,R0                                                            
         BR    RE                                                               
         DROP  R1                                                               
         EJECT                                                                  
INWS     EQU   REQTDWRK*256        REQUEST FIELD IS IN LOCAL W/S                
KEYLONG  EQU   20                  L'LONG KEYWORD ENTRY                         
KEYSHORT EQU   10                  L'SHORT KEYWORD ENTRY                        
SPACE    EQU   C' '                                                             
ALLXCEPT EQU   C'*'                                                             
ALLBITS  EQU   X'FF'                                                            
NUMERIC  EQU   X'F0'                                                            
DIGIT    EQU   X'0F'                                                            
                                                                                
         LTORG                                                                  
                                                                                
CLFLIT   DC    C'CL='                                                           
TYPLIT   DC    C'TYP'                                                           
ACRLIT   DC    C'AC'                                                            
                                                                                
CNTTAB   DS    0AL2                ** DISPLACEMENTS TO CONTINUATIONS **         
         DC    AL2(ACQCONT1-ACQD)                                               
         DC    AL2(ACQCONT2-ACQD)                                               
         DC    AL2(ACQCONT3-ACQD)                                               
         DC    AL2(ACQCONT4-ACQD)                                               
         DC    AL2(ACQCONT5-ACQD)                                               
         DC    AL2(ACQCONT6-ACQD)                                               
         DC    AL2(ACQCONT7-ACQD)                                               
CNTTABN  EQU   (*-CNTTAB)/L'CNTTAB                                              
                                                                                
CHARTAB  DS    0CL2                ** LANGUAGE DEPENDENT CHARACTERS **          
         DC    C',='                                                            
         DC    C',='                                                            
         DC    C',='                                                            
         DC    C'#='                                                            
         DC    C',='                                                            
         DC    C',='                                                            
         DC    C',='                                                            
         DC    C',='                                                            
         DC    C',='                                                            
         DC    C',='                                                            
         DC    C',='                                                            
         EJECT                                                                  
DATTAB   DS    0XL(DATTABL)        ** SCRIBE DATE TABLE **                      
                                                                                
         DC    AL1(ACQDTBIL)                                                    
         DC    AL1(L'AC@BLDST),AL2(AC@BLDST-DDOUT)                              
         DC    AL1(L'AC@BLDEN),AL2(AC@BLDEN-DDOUT)                              
                                                                                
         DC    AL1(ACQDTCHK)                                                    
         DC    AL1(L'AC@CHKST),AL2(AC@CHKST-DDOUT)                              
         DC    AL1(L'AC@CHKEN),AL2(AC@CHKEN-DDOUT)                              
                                                                                
         DC    AL1(ACQDTDEP)                                                    
         DC    AL1(L'AC@DEPST),AL2(AC@DEPST-DDOUT)                              
         DC    AL1(L'AC@DEPEN),AL2(AC@DEPEN-DDOUT)                              
                                                                                
         DC    AL1(ACQDTTRM)                                                    
         DC    AL1(L'AC@TRMDT),AL2(AC@TRMDT-DDOUT)                              
         DC    AL1(0),AL2(0)                                                    
                                                                                
         DC    AL1(ACQDTHIR)                                                    
         DC    AL1(L'AC@HREDT),AL2(AC@HREDT-DDOUT)                              
         DC    AL1(0),AL2(0)                                                    
                                                                                
         DC    AL1(ACQDTITF)                                                    
         DC    AL1(L'AC@ITFST),AL2(AC@ITFST-DDOUT)                              
         DC    AL1(L'AC@ITFEN),AL2(AC@ITFEN-DDOUT)                              
                                                                                
*&&US*&& DC    AL1(ACQDTCLS)                                                    
*&&US*&& DC    AL1(L'AC@CLSST),AL2(AC@CLSST-DDOUT)                              
*&&US*&& DC    AL1(L'AC@CLSEN),AL2(AC@CLSEN-DDOUT)                              
                                                                                
*&&US*&& DC    AL1(ACQDTOPN)                                                    
*&&US*&& DC    AL1(L'AC@OPNST),AL2(AC@OPNST-DDOUT)                              
*&&US*&& DC    AL1(L'AC@OPNEN),AL2(AC@OPNEN-DDOUT)                              
                                                                                
         DC    AL1(ACQDTPER)                                                    
         DC    AL1(L'AC@CALST),AL2(AC@CALST-DDOUT)                              
         DC    AL1(L'AC@CALEN),AL2(AC@CALEN-DDOUT)                              
                                                                                
         DC    AL1(ACQDTTIT)                                                    
         DC    AL1(L'AC@TITSD),AL2(AC@TITSD-DDOUT)                              
         DC    AL1(L'AC@TITED),AL2(AC@TITED-DDOUT)                              
                                                                                
         DC    AL1(ACQDTUTL)                                                    
         DC    AL1(L'AC@UDATE),AL2(AC@UDATE-DDOUT)                              
         DC    AL1(0),AL2(0)                                                    
                                                                                
DATTABX  DC    AL1(DATTEOTQ)                                                    
                                                                                
OTHTAB   DS    0XL(OTHTABL)        ** SCRIBE OTHER TABLE **                     
                                                                                
         DC    AL1(ACQANAL),AL2(AC@SELAC-DDOUT),AL1(L'AC@SELAC)                 
                                                                                
         DC    AL1(ACQCNTR),AL2(AC@CTR-DDOUT),AL1(L'AC@CTR)                     
                                                                                
         DC    AL1(ACQPID),AL2(AC@RSPID-DDOUT),AL1(L'AC@RSPID)                  
                                                                                
         DC    AL1(ACQOVHD),AL2(AC@COVER-DDOUT),AL1(L'AC@COVER)                 
                                                                                
*&&US*&& DC    AL1(ACQPRSN),AL2(AC@PRSNC-DDOUT),AL1(L'AC@PRSNC)                 
                                                                                
OTHTABX  DC    AL1(OTHTEOTQ)                                                    
         EJECT                                                                  
DDIN     DS    0X                  ** DICTIONARY LOOKUP LIST **                 
                                                                                
         DCDDL AC#RPT,KEYLONG      REPORT                                       
         DCDDL AC#OPTS,KEYLONG     OPTIONS                                      
         DCDDL AC#STRDT,KEYLONG    START DATE                                   
         DCDDL AC#ENDDT,KEYLONG    END DATE                                     
         DCDDL AC#MOARA,KEYLONG    MOA RANGE                                    
         DCDDL AC#UNIT,KEYLONG     UNIT                                         
         DCDDL AC#LGR,KEYLONG      LEDGER                                       
         DCDDL AC#ACC,KEYSHORT     ACCOUNT                                      
         DCDDL AC#OFF,KEYLONG      OFFICE                                       
         DCDDL AC#ANOFF,KEYLONG    ANALYSIS OFFICE                              
         DCDDL AC#CTRFL,KEYSHORT   CONTRA ACCOUNT FILTER                        
         DCDDL AC#DUEST,KEYSHORT   DUE DATE START                               
         DCDDL AC#DUEND,KEYSHORT   DUE DATE END                                 
         DCDDL AC#CTRUL,KEYSHORT   CONTRA UNIT/LEDGER                           
         DCDDL AC#SELFL,KEYLONG    SELECTIVE FIELD                              
         DCDDL AC#TRNTF,KEYLONG    TRANSACTION TYPE FILTER                      
         DCDDL AC#OFFGP,KEYLONG    OFFICE GROUP                                 
         DCDDL AC#TRNFL,KEYLONG    TRANSACTION CODE FILTER                      
         DCDDL AC#WCLST,KEYLONG    WORK CODE LIST                               
         DCDDL AC#BLGGP,KEYLONG    BILLING GROUP                                
         DCDDL AC#FLT1,KEYSHORT    ACCOUNT FILTER 1                             
         DCDDL AC#FLT2,KEYSHORT    ACCOUNT FILTER 2                             
         DCDDL AC#FLT3,KEYSHORT    ACCOUNT FILTER 3                             
         DCDDL AC#FLT4,KEYSHORT    ACCOUNT FILTER 4                             
         DCDDL AC#FLT5,KEYSHORT    ACCOUNT FILTER 5                             
         DCDDL AC#CTRF1,KEYSHORT   CONTRA ACCOUNT FILTER 1                      
         DCDDL AC#CTRF2,KEYSHORT   CONTRA ACCOUNT FILTER 2                      
         DCDDL AC#CTRF3,KEYSHORT   CONTRA ACCOUNT FILTER 3                      
         DCDDL AC#CTRF4,KEYSHORT   CONTRA ACCOUNT FILTER 4                      
         DCDDL AC#CTRF5,KEYSHORT   CONTRA ACCOUNT FILTER 5                      
         DCDDL AC#MEDFL,KEYLONG    MEDIA FILTER                                 
         DCDDL AC#MEDGP,KEYLONG    MEDIA GROUP                                  
         DCDDL AC#BLGTY,KEYLONG    BILLING TYPE                                 
         DCDDL AC#WCGRP,KEYLONG    WORK CODE GROUP                              
         DCDDL AC#SRTOP,KEYLONG    SORT OPTION                                  
         DCDDL AC#CTR,KEYLONG      CONTRA ACCOUNT                               
         DCDDL AC#DRFOP,KEYLONG    DRAFT OPTION                                 
         DCDDL AC#SEQ,KEYLONG      SEQUENCE                                     
         DCDDL AC#ACTST,KEYLONG    ACTIVITY START DATE                          
         DCDDL AC#ACTND,KEYLONG    ACTIVITY END DATE                            
*&&US*&& DCDDL AC#STT,KEYLONG      STATUS                                       
*&&US*&& DCDDL AC#XJBOP,KEYLONG    EXPENSE JOB OPTION                           
         DCDDL AC#ALMHD,KEYLONG    ALLOCATION METHOD                            
         DCDDL AC#RVROP,KEYLONG    REVERSE OPTION                               
*&&UK*&& DCDDL AC#OCLOS,KEYLONG    CLOSED OPTION                                
*&&UK*&& DCDDL AC#OLOCK,KEYLONG    LOCKED OPTION                                
*&&US*&& DCDDL AC#DUEDD,KEYLONG    DUE DATE DAYS                                
*&&US*&& DCDDL AC#RSUSF,KEYLONG    USER FIELD                                   
*&&US*&& DCDDL AC#STUTY,KEYLONG    STUDIO TYPE                                  
         DCDDL AC#RSLST,KEYLONG    LOCATION STATUS                              
*&&UK*&& DCDDL AC#RCURR,KEYLONG    REPORT CURRENCY                              
         DCDDL AC#BLDST,KEYLONG    BILLED START DATE                            
         DCDDL AC#BLDEN,KEYLONG    BILLED END DATE                              
         DCDDL AC#CHKST,KEYLONG    CHEQUE START DATE                            
         DCDDL AC#CHKEN,KEYLONG    CHEQUE END DATE                              
         DCDDL AC#DEPST,KEYLONG    DEPOSIT START DATE                           
         DCDDL AC#DEPEN,KEYLONG    DEPOSIT END DATE                             
         DCDDL AC#HREDT,KEYLONG    HIRE DATE                                    
         DCDDL AC#TRMDT,KEYLONG    TERMINATION DATE                             
         DCDDL AC#ITFST,KEYLONG    INTERFACE START DATE                         
         DCDDL AC#ITFEN,KEYLONG    INTERFACE END DATE                           
*&&US*&& DCDDL AC#CLSST,KEYLONG    JOB CLOSE START DATE                         
*&&US*&& DCDDL AC#CLSEN,KEYLONG    JOB CLOSE END DATE                           
*&&US*&& DCDDL AC#OPNST,KEYLONG    JOB OPEN START DATE                          
*&&US*&& DCDDL AC#OPNEN,KEYLONG    JOB OPEN END DATE                            
         DCDDL AC#CALST,KEYLONG    CALENDAR START MONTH                         
         DCDDL AC#CALEN,KEYLONG    CALENDAR END MONTH                           
         DCDDL AC#TITSD,KEYLONG    TITLE START DATE                             
         DCDDL AC#TITED,KEYLONG    TITLE END DATE                               
         DCDDL AC#UDATE,KEYLONG    UTILISED DATE                                
         DCDDL AC#SELAC,KEYLONG    SELECTED ACCOUNTS                            
         DCDDL AC#RSPID,KEYLONG    PERSON ID                                    
         DCDDL AC#COVER,KEYLONG    OVERHEAD                                     
*&&US*&& DCDDL AC#PRSNC,KEYLONG    PERSON CODE                                  
         DCDDL AC#FRMAT,KEYLONG    FORMAT (SCRIBE)                              
                                                                                
DDINX    DC    X'00'                                                            
                                                                                
PRGTAB   DS    0X                  ** PROGRAM INDICATOR TABLE **                
         DC    C'RL',AL1(PRGTSCRQ)                                              
         DC    C'RP',AL1(PRGTSCRQ)                                              
         DC    C'IL',AL1(PRGTSCRQ)                                              
         DC    C'IP',AL1(PRGTSCRQ)                                              
         DC    C'PL',AL1(PRGTSCRQ)                                              
         DC    C'PP',AL1(PRGTSCRQ)                                              
         DC    C'XL',AL1(PRGTSCRQ)                                              
         DC    C'XP',AL1(PRGTSCRQ)                                              
         DC    C'VL',AL1(PRGTSCRQ)                                              
         DC    C'VP',AL1(PRGTSCRQ)                                              
         DC    C'1L',AL1(PRGTSCRQ)                                              
         DC    C'1P',AL1(PRGTSCRQ)                                              
         DC    C'2L',AL1(PRGTSCRQ)                                              
         DC    C'2P',AL1(PRGTSCRQ)                                              
         DC    C'BL',AL1(PRGTSCRQ)                                              
         DC    C'BP',AL1(PRGTSCRQ)                                              
         DC    C'GL',AL1(PRGTSCRQ)                                              
         DC    C'GP',AL1(PRGTSCRQ)                                              
PRGTABX  DC    AL2(PRGTDEFQ),AL1(0)                                             
                                                                                
REQTAB   DS    0X                  ** REQUEST FIELD TABLE **                    
                                                                                
         DC    AL2(ACQPROG-ACQD,AC@RPT-DDOUT),AL1(L'AC@RPT)                     
         DC    AL1(L'ACQPROG,REQTREPT,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQAPPL-ACQD,AC@FRMAT-DDOUT),AL1(L'AC@FRMAT)                 
         DC    AL1(L'ACQAPPL-4,REQTALPH,REQTIPRG,PRGTSCRQ,0,0)                  
                                                                                
         DC    AL2(ACQUNT-ACQD,AC@UNIT-DDOUT),AL1(L'AC@UNIT)                    
         DC    AL1(L'ACQUNT+L'ACQLDG+L'ACQACT,REQTULAC,0,0,0,0)                 
                                                                                
         DC    AL2(ACQSTART-ACQD,AC@STRDT-DDOUT),AL1(L'AC@STRDT)                
         DC    AL1(L'ACQSTART,REQTDATE)                                         
         DC    AL1(0,0,SOFITSD2,SOFIIONE)                                       
                                                                                
         DC    AL2(ACQEND-ACQD,AC@ENDDT-DDOUT),AL1(L'AC@ENDDT)                  
         DC    AL1(L'ACQEND,REQTDATE)                                           
         DC    AL1(0,0,SOFITSD2,SOFIIONE)                                       
                                                                                
         DC    AL2(ACQDUEST-ACQD,AC@DUEST-DDOUT),AL1(L'AC@DUEST)                
         DC    AL1(L'ACQDUEST,REQTDATE,REQTIAPF,ACQAPFDD)                       
         DC    AL1(SOFITSD2,SOFIIONE)                                           
                                                                                
         DC    AL2(ACQDUEND-ACQD,AC@DUEND-DDOUT),AL1(L'AC@DUEND)                
         DC    AL1(L'ACQDUEND,REQTDATE,REQTIAPF,ACQAPFDD)                       
         DC    AL1(SOFITSD2,SOFIIONE)                                           
                                                                                
         DC    AL2(ACQACTST-ACQD,AC@ACTST-DDOUT),AL1(L'AC@ACTST)                
         DC    AL1(L'ACQACTST,REQTDATE,0,0)                                     
         DC    AL1(SOFITSD2,SOFIIONE)                                           
                                                                                
         DC    AL2(ACQACTND-ACQD,AC@ACTND-DDOUT),AL1(L'AC@ACTND)                
         DC    AL1(L'ACQACTND,REQTDATE,0,0)                                     
         DC    AL1(SOFITSD2,SOFIIONE)                                           
                                                                                
         DC    AL2(ACQMOSPD-ACQD,AC@MOARA-DDOUT),AL1(L'AC@MOARA)                
         DC    AL1(L'ACQMOSPD,REQTDATE)                                         
         DC    AL1(0,0,SOFITSD1,0)                                              
                                                                                
         DC    AL2(OPTIONS-WORKD+INWS,AC@OPTS-DDOUT),AL1(L'AC@OPTS)             
         DC    AL1(OPTIONSL,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(ACQOFGRP-ACQD,AC@OFFGP-DDOUT),AL1(L'AC@OFFGP)                
         DC    AL1(L'ACQOFGRP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQOFFFL-ACQD,AC@OFF-DDOUT),AL1(L'AC@OFF)                    
         DC    AL1(L'ACQOFFFL,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQANOF-ACQD,AC@ANOFF-DDOUT),AL1(L'AC@ANOFF)                 
         DC    AL1(L'ACQANOF,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQAPPL-ACQD,AC@CTRFL-DDOUT),AL1(L'AC@CTRFL)                 
         DC    AL1(L'ACQAPPL,REQTALPH,REQTIAPF,ACQAPFCA,0,0)                    
                                                                                
*&&UK*&& DC    AL2(ACQSRTAR-ACQD,AC@CTRUL-DDOUT),AL1(L'AC@CTRUL)                
*&&UK*&& DC    AL1(L'ACQSRTAR-2,REQTCAUL,0,0,0,0)                               
                                                                                
*&&UK*&& DC    AL2(ACQSEL-ACQD,AC@SELFL-DDOUT),AL1(L'AC@SELFL)                  
*&&UK*&& DC    AL1(L'ACQSEL,REQTALPH,0,0,0,0)                                   
                                                                                
*&&US*&& DC    AL2(ACQSEL-ACQD,AC@SELFL-DDOUT),AL1(L'AC@SELFL)                  
*&&US*&& DC    AL1(L'ACQSEL,REQTSELS,0,0,0,0)                                   
                                                                                
*&&US*&& DC    AL2(ACQSEL-ACQD,AC@TRNTF-DDOUT),AL1(L'AC@TRNTF)                  
*&&US*&& DC    AL1(L'ACQSEL,REQTTTYP,0,0,0,0)                                   
                                                                                
         DC    AL2(ACQTRNF-ACQD,AC@TRNFL-DDOUT),AL1(L'AC@TRNFL)                 
         DC    AL1(L'ACQTRNF,REQTALPH,0,0,0,0)                                  
                                                                                
*&&UK*&& DC    AL2(ACQCACUL-ACQD,AC@CTRFL-DDOUT),AL1(L'AC@CTRFL)                
*&&UK*&& DC    AL1(L'ACQCACUL,REQTALPH,0,0,0,0)                                 
                                                                                
*&&UK*&& DC    AL2(ACQTTYPE-ACQD,AC@TRNTF-DDOUT),AL1(L'AC@TRNTF)                
*&&UK*&& DC    AL1(L'ACQTTYPE,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQWRKLS-ACQD,AC@WCLST-DDOUT),AL1(L'AC@WCLST)                
         DC    AL1(L'ACQWRKLS,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQBILGP-ACQD,AC@BLGGP-DDOUT),AL1(L'AC@BLGGP)                
         DC    AL1(L'ACQBILGP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF1-ACQD,AC@FLT1-DDOUT),AL1(L'AC@FLT1)                  
         DC    AL1(L'ACQACTF1,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF2-ACQD,AC@FLT2-DDOUT),AL1(L'AC@FLT2)                  
         DC    AL1(L'ACQACTF2,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF3-ACQD,AC@FLT3-DDOUT),AL1(L'AC@FLT3)                  
         DC    AL1(L'ACQACTF3,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF4-ACQD,AC@FLT4-DDOUT),AL1(L'AC@FLT4)                  
         DC    AL1(L'ACQACTF4,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF5-ACQD,AC@FLT5-DDOUT),AL1(L'AC@FLT5)                  
         DC    AL1(L'ACQACTF5,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT1-ACQD,AC@CTRF1-DDOUT),AL1(L'AC@CTRF1)                
         DC    AL1(L'ACQCFLT1,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT2-ACQD,AC@CTRF2-DDOUT),AL1(L'AC@CTRF2)                
         DC    AL1(L'ACQCFLT2,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT3-ACQD,AC@CTRF3-DDOUT),AL1(L'AC@CTRF3)                
         DC    AL1(L'ACQCFLT3,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT4-ACQD,AC@CTRF4-DDOUT),AL1(L'AC@CTRF4)                
         DC    AL1(L'ACQCFLT4,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT5-ACQD,AC@CTRF5-DDOUT),AL1(L'AC@CTRF5)                
         DC    AL1(L'ACQCFLT5,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQMEDFL-ACQD,AC@MEDFL-DDOUT),AL1(L'AC@MEDFL)                
         DC    AL1(L'ACQMEDFL,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQMEDGP-ACQD,AC@MEDGP-DDOUT),AL1(L'AC@MEDGP)                
         DC    AL1(L'ACQMEDGP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQBILTY-ACQD,AC@BLGTY-DDOUT),AL1(L'AC@BLGTY)                
         DC    AL1(L'ACQBILTY,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQWCGRP-ACQD,AC@WCGRP-DDOUT),AL1(L'AC@WCGRP)                
         DC    AL1(L'ACQWCGRP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQSORT-ACQD,AC@SRTOP-DDOUT),AL1(L'AC@SRTOP)                 
         DC    AL1(L'ACQSORT,REQTALPH,0,0,0,0)                                  
                                                                                
*&&US*&& DC    AL2(ACQCACUL-ACQD,AC@CTRUL-DDOUT),AL1(L'AC@CTRUL)                
*&&US*&& DC    AL1(L'ACQCACUL,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQCACT-ACQD,AC@CTR-DDOUT),AL1(L'AC@CTR)                     
*&&US*&& DC    AL1(L'ACQCACT,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQDRFOP-ACQD,AC@DRFOP-DDOUT),AL1(L'AC@DRFOP)                
         DC    AL1(L'ACQDRFOP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQREPSQ-ACQD,AC@SEQ-DDOUT),AL1(L'AC@SEQ)                    
         DC    AL1(L'ACQREPSQ,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQTRNST-ACQD,AC@STT-DDOUT),AL1(L'AC@STT)                    
*&&US*&& DC    AL1(L'ACQTRNST,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQXJOB-ACQD,AC@XJBOP-DDOUT),AL1(L'AC@XJBOP)                 
*&&US*&& DC    AL1(L'ACQXJOB,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQMTHD-ACQD,AC@ALMHD-DDOUT),AL1(L'AC@ALMHD)                 
         DC    AL1(L'ACQMTHD,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQREVOP-ACQD,AC@RVROP-DDOUT),AL1(L'AC@RVROP)                
         DC    AL1(L'ACQREVOP,REQTALPH,0,0,0,0)                                 
                                                                                
*&&UK*&& DC    AL2(ACQACLOS-ACQD,AC@OCLOS-DDOUT),AL1(L'AC@OCLOS)                
*&&UK*&& DC    AL1(L'ACQACLOS,REQTALPH,0,0,0,0)                                 
                                                                                
*&&UK*&& DC    AL2(ACQALOCK-ACQD,AC@OLOCK-DDOUT),AL1(L'AC@OLOCK)                
*&&UK*&& DC    AL1(L'ACQALOCK,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQBDAY-ACQD,AC@DUEDD-DDOUT),AL1(L'AC@DUEDD)                 
*&&US*&& DC    AL1(L'ACQBDAY,REQTBDAY,0,0,0,0)                                  
                                                                                
*&&US*&& DC    AL2(ACQUSFLD-ACQD,AC@RSUSF-DDOUT),AL1(L'AC@RSUSF)                
*&&US*&& DC    AL1(L'ACQUSFLD,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQSTUTY-ACQD,AC@STUTY-DDOUT),AL1(L'AC@STUTY)                
*&&US*&& DC    AL1(L'ACQSTUTY,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQLOCS-ACQD,AC@RSLST-DDOUT),AL1(L'AC@RSLST)                 
         DC    AL1(L'ACQLOCS,REQTALPH,0,0,0,0)                                  
                                                                                
*&&UK*&& DC    AL2(ACQCURR-ACQD,AC@RCURR-DDOUT),AL1(L'AC@RCURR)                 
*&&UK*&& DC    AL1(L'ACQCURR,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQTYP1-ACQD,DATTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP1+L'ACQFLT1,REQTDATF,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP1-ACQD,OTHTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP1+L'ACQFLT1,REQTOTHR,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP2-ACQD,DATTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP2+L'ACQFLT2,REQTDATF,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP2-ACQD,OTHTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP2+L'ACQFLT2,REQTOTHR,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP3-ACQD,DATTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP3+L'ACQFLT3,REQTDATF,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP3-ACQD,OTHTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP3+L'ACQFLT3,REQTOTHR,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP4-ACQD,DATTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP4+L'ACQFLT4,REQTDATF,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP4-ACQD,OTHTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP4+L'ACQFLT4,REQTOTHR,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP5-ACQD,DATTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP5+L'ACQFLT5,REQTDATF,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP5-ACQD,OTHTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP5+L'ACQFLT5,REQTOTHR,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP6-ACQD,DATTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP6+L'ACQFLT6,REQTDATF,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP6-ACQD,OTHTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP6+L'ACQFLT6,REQTOTHR,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP7-ACQD,DATTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP7+L'ACQFLT7,REQTDATF,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP7-ACQD,OTHTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP7+L'ACQFLT7,REQTOTHR,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP8-ACQD,DATTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP8+L'ACQFLT8,REQTDATF,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP8-ACQD,OTHTAB-ACREQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP8+L'ACQFLT8,REQTOTHR,0,0,0,0)                        
                                                                                
REQTABX  DC    AL1(REQTEOTQ)                                                    
         EJECT                                                                  
PLISTD   DSECT                     ** INPUT PARAMETER LIST **                   
PLLANG   DS    0X                  LANGUAGE CODE                                
PLAREQ   DS    A                   A(REQUEST CARDS)                             
PLNREQ   DS    0X                  NUMBER OF REQUEST CARDS                      
PLACOM   DS    A                   A(COMFACS)                                   
PLAOUT   DS    A                   RETURN A(OUTPUT) IN HERE                     
PLISTL   EQU   *-PLISTD                                                         
                                                                                
WORKD    DSECT                     ** LOCAL WORKING STORAGE **                  
DUB      DS    D                                                                
DMCB     DS    6F                                                               
WORK     DS    XL64                                                             
SPACES   DS    CL64                                                             
                                                                                
MAXDSP   DS    XL2                 MAXIMUM REQUEST CARD DISPLACEMENT            
                                                                                
SOFBLOCK DS    (SOFDATL)X          SOFDAT PARAMETER BLOCK                       
                                                                                
PRGIND   DS    XL1                 PROGRAM INDICATOR BYTE (SEE PRGTABD)         
                                                                                
OPTIONS  DS    0C                  ** EXTRACTED OPTIONS **                      
OPTION1  DS    CL(L'ACQOPT1)                                                    
OPTION2  DS    CL(L'ACQOPT2)                                                    
OPTION3  DS    CL(L'ACQOPT3)                                                    
OPTION4  DS    CL(L'ACQOPT4)                                                    
OPTION5  DS    CL(L'ACQOPT5)                                                    
OPTION6  DS    CL(L'ACQOPT6)                                                    
OPTION7  DS    CL(L'ACQOPT7)                                                    
OPTION8  DS    CL(L'ACQOPT8)                                                    
OPTION9  DS    CL(L'ACQOPT9)                                                    
OPTION10 DS    CL(L'ACQOPT10)                                                   
*&&UK                                                                           
OPTION11 DS    CL(L'ACQOPT11)                                                   
OPTION12 DS    CL(L'ACQOPT12)                                                   
*&&                                                                             
OPTIONSX EQU   *                                                                
OPTIONSL EQU   *-OPTIONS                                                        
                                                                                
CHARS    DS    0CL(L'CHARTAB)      ** LANGUAGE BASED CHARACTERS **              
COMMA    DS    C                   COMMA CHARACTER                              
EQUAL    DS    C                   EQUALS CHARACTER                             
         ORG   CHARS+L'CHARS                                                    
                                                                                
KEYWORD  DS    CL(KEYLONG)         CURRENT DATA KEYWORD                         
DATA     DS    CL18                CURRENT DATA FIELD                           
                                                                                
FLDH     DS    XL8                 FIELD HEADER (FOR SOFDAT)                    
FLD      DS    CL(L'DATA)          FIELD DATA                                   
                                                                                
OUTPUT   DS    CL512               FULL OUTPUT STRING                           
OUTPUTL  EQU   *-OUTPUT                                                         
                                                                                
DDOUT    DS    0X                  ** TRANSLATED DICTIONARY WORDS **            
         DSDDL PRINT=YES                                                        
DDOUTX   EQU   *                                                                
                                                                                
WORKX    EQU   *                                                                
         EJECT                                                                  
PRGTABD  DSECT                     ** PROGRAM TABLE **                          
PRGTDEFQ EQU   0                                                                
PRGTPRG  DS    CL(L'ACQPROG)       PROGRAM CODE                                 
PRGTIND  DS    XL1                 PROGRAM INDICATOR                            
PRGTSCRQ EQU   X'80'               SCRIBE REQUEST                               
PRGTABL  EQU   *-PRGTABD           LENGTH OF TABLE ENTRY                        
                                                                                
REQTABD  DSECT                     ** REQUEST TABLE **                          
REQTEOTQ EQU   X'FF'               END OF TABLE INDICATOR                       
REQTDWRK EQU   X'80'               DATA IS IN WORKD NOT ACQD                    
REQTDSP  DS    AL2                 DISPLACEMENT TO REQUEST FIELD                
REQTNAM  DS    AL2                 DISPLACEMENT TO KEYWORD                      
REQTNAML DS    AL1                 LENGTH OF KEYWORD                            
REQTLEN  DS    AL1                 LENGTH OF REQUEST FIELD                      
REQTFRM  DS    AL1                 FORMAT ROUTINE NUMBER                        
REQTALPH EQU   01                  ALPHA (MVC)                                  
REQTREPT EQU   02                  REPORT=ACNN                                  
REQTDATE EQU   03                  DATE TYPE=EXPRESSION                         
REQTULAC EQU   04                  UNIT/LEDGER/ACCOUNT=U(L(A))                  
REQTCAUL EQU   05                  CONTRAL UNIT/LEDGER                          
REQTSELS EQU   06                  SELECTIVE FIELD         (US ROUTINE)         
REQTTTYP EQU   07                  TRANSACTION TYPE FILTER (US ROUTINE)         
REQTBDAY EQU   08                  DUE DATE DAYS           (US ROUTINE)         
REQTDATF EQU   09                  SCRIBE DATE FILTERS                          
REQTOTHR EQU   10                  SCRIBE OTHER FILTERS/OPTIONS                 
REQTIND1 DS    XL1                 FIELD INDICATORS BYTE 1                      
REQTIAPF EQU   X'80'               CHECK ACQAPFLG FOR VALUE IN REQTIND2         
REQTIPRG EQU   X'40'               CHECK PRGIND   FOR VALUE IN REQTIND2         
REQTIND2 DS    XL1                 FIELD INDICATORS BYTE 2                      
REQTIND3 DS    XL1                 FIELD INDICATORS BYTE 3                      
REQTIND4 DS    XL1                 FIELD INDICATORS BYTE 4                      
REQTABL  EQU   *-REQTABD           LENGTH OF TABLE ENTRY                        
                                                                                
DATTABD  DSECT                     ** SCRIBE DATE KEYWORD TABLE **              
DATTEOTQ EQU   X'00'                                                            
DATTTYP  DS    CL(L'ACQDTTYP)      DATE/PERIOD TYPE                             
DATTLEN1 DS    AL1                 LENGTH OF START DATE NAME                    
DATTNAM1 DS    AL2                 DISPLACEMENT TO START DATE NAME              
DATTLEN2 DS    AL1                 LENGTH OF END DATE NAME                      
DATTNAM2 DS    AL2                 DISPLACEMENT TO END DATE NAME (OR 0)         
DATTABL  EQU   *-DATTABD           LENGTH OF TABLE ENTRY                        
                                                                                
OTHTABD  DSECT                     ** SCRIBE OTHER KEYWORD TABLE **             
OTHTEOTQ EQU   X'00'                                                            
OTHTTYP  DS    CL(L'ACQDTTYP)      FILTER/OPTION TYPE                           
OTHTNAM  DS    AL2                 DISPLACEMENT TO DATA NAME                    
OTHTLEN  DS    AL1                 LENGTH OF DATA NAME                          
OTHTABL  EQU   *-OTHTABD           LENGTH OF TABLE ENTRY                        
         EJECT                                                                  
* ACQD                                                                          
         PRINT OFF                                                              
       ++INCLUDE ACQD                                                           
ACQL     EQU   *-ACQD                                                           
         PRINT ON                                                               
                                                                                
* ACDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE ACDDEQUS                                                       
         PRINT ON                                                               
                                                                                
* DDCOMFACS                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDCOMFACS                                                      
         PRINT ON                                                               
                                                                                
* DDSOFDATD                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDSOFDATD                                                      
         PRINT ON                                                               
                                                                                
* DDDICTATED                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDDICTATED                                                     
DICTATEL EQU   *-DICTATED                                                       
         PRINT ON                                                               
                                                                                
* DDDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDDDEQUS                                                       
         PRINT ON                                                               
                                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'002ACREQRFP  02/17/99'                                      
         END                                                                    
