*          DATA SET PPREPORTW  AT LEVEL 007 AS OF 02/26/03                      
*CATALP REPORTW                                                                 
*                                                                               
*        COPY OF PPREPORTW MADE 10/30/00 - LEVEL RESET TO 1                     
*                                                                               
***      AS OF DEC 01/00                                                        
***      OLD PPREPORTW IS NOW PPREPORTZ                                         
***      OLD RMREPORTW IS NOW RMREPORTZ                                         
***                                                                             
*        CHANGE LOG                                                             
*                                                                               
*   BPLA  02/03    ENSURE PRINTABLE CHARACTERS                                  
*                                                                               
*   BPLA  07/02    USE PUBEDIT INSTEAD OF =V(PUBEDIT)                           
*                                                                               
*   BPLA  12/00    CHANGES FOR EMFILES                                          
*                  CSECT NAME CHANGED TO REPORTW TO                             
*                  AVOID ERRORS, IN PPWORKC V(REPORT)                           
*                  CHANGED TO V(REPORTW)                                        
*                                                                               
*   SMYE  04/00    CHANGES FOR LARGER PPNEWFILE                                 
*                                                                               
*   BPLA  9/99     CHECK FOR VARIOUS ABREVIATIONS FOR INTERACTIVE               
*                  AND DISPLAY AS "INTERACTIVE" IN HEADLINES                    
*                                                                               
*   BPLA 5/96      CHANGE FOR CLIENT OVERRIDE OF MEDIA NAME                     
*                                                                               
*   BPLA 1/96      CHANGE CALLS TO DTCNV TO USE DATCON                          
*                                                                               
*   BPLA 12/93     COPY OF PPREPORTW (LEVEL 67)                                 
*                  CHANGES FOR RCWHATPR (2 PRINTERS)                            
*                                                                               
*   BPLA 3/30/93   CHANGE TO ALLOW HEADHOOK RETURN                              
*                  FOR ADDITIONAL HEADLINES                                     
*   BPLA 5/2/91    FIX PP@ALL + FLOAT PP@TOGET BEHIND IT                        
*                                                                               
         TITLE 'MODULE CONTROLS HANDLING OF PPG PRINTING'                       
         PRINT NOGEN                                                            
REPORTW  CSECT                                                                  
         NMOD1 PPREPX-PPREPD,REPORTW                                            
         USING PPREPD,RC                                                        
         L     RA,=V(PPWORKC)                                                   
         USING PPWORKD,RA                                                       
*                                                                               
         L     R2,PPWORK2C         NEEDED SHORT TERM FOR ACONIO                 
         USING PPWORK2D,R2                                                      
         MVC   ACONIO1,ACONIO      STORE PCONREC ADDRESS                        
         DROP  R2                                                               
*                                                                               
         L     R9,PPFILEC                                                       
         LA    R7,2048(R9)                                                      
         LA    R7,2048(R7)                                                      
         USING PPFILED,R9,R7                                                    
         LA    R8,2048(RB)                                                      
         LA    R8,2048(R8)                                                      
         USING REPORTW+4096,R8                                                  
         MVC   USERRD,4(RD)                                                     
*                                                                               
         CLI   FORCEHED,C'P'       TEST FORCING PAGE NUMBER                     
         BNE   PCPR6                                                            
         CLI   RCWHATPR,0                                                       
         BE    PCPR4                                                            
         LA    R2,MYPAGE1                                                       
         LA    R3,MYSUBPG1                                                      
         CLI   RCWHATPR,2                                                       
         BNE   PCPR2                                                            
         LA    R2,MYPAGE2                                                       
         LA    R3,MYSUBPG2                                                      
*                                                                               
PCPR2    MVC   0(2,R2),PAGE                                                     
         MVC   0(2,R3),SUBPAGE                                                  
*                                                                               
PCPR4    MVI   FORCEHED,C'Y'       THEN SET NORMAL FORCEHED OPTION              
*                                                                               
PCPR6    DS    0H                                                               
         MVC   APRINT,=V(PRINTS)                                                
         CLI   RCWHATPR,0  SEE IF NOT WRITING TO MORE THAN ONE PRINTER          
         BE    PCPRX       LEAVE PAGE AND SUBPAGE ALONE                         
*                                                                               
         MVC   PAGE,MYPAGE1                                                     
         MVC   SUBPAGE,MYSUBPG1                                                 
*                                                                               
         CLI   RCWHATPR,2                                                       
         BNE   PCPRX            IF NOT ZERO OR 2 MUST BE ONE                    
         MVC   APRINT,=V(PRINTS2)                                               
         MVC   PAGE,MYPAGE2                                                     
         MVC   SUBPAGE,MYSUBPG2                                                 
*                                                                               
PCPRX    DS    0H                                                               
*                                                                               
         MVC   RCURTAB,=X'00000000215B4040'                                     
*                                                                               
         XC    REPDMCB,REPDMCB                                                  
*                                                                               
         L     R2,PPWORK2C        NEEDED SHORT TERM FOR DICTATE,                
         USING PPWORK2D,R2        P1,P14,ABOX                                   
*                                                                               
         LA    R1,REPDMCB                                                       
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,4                                                          
         MVC   DDLANG,RCLANG                                                    
         LA    RF,DCLIST                                                        
         STCM  RF,7,DDIADR                                                      
         LA    RF,DSLIST                                                        
         STCM  RF,7,DDOADR                                                      
*                                                                               
         GOTO1 DICTATE                                                          
         DROP  R1                                                               
         EJECT                                                                  
*              SET UP FOR 132 OR 198 PRINT SUPPORT                              
         SPACE 3                                                                
         MVC   PWIDTH,=F'132'      PRESET FOR REGULAR PRINT LINES               
         MVI   WIDEOPT,C'N'                                                     
         LA    R1,HEAD1                                                         
         ST    R1,AH1                                                           
         LA    R1,MID1                                                          
         ST    R1,AM1                                                           
         LA    R1,MID2                                                          
         ST    R1,AM2                                                           
         LA    R1,P                DEFAULT IS FOR 2 AT P                        
         ST    R1,AP1                                                           
         LA    R1,PSECOND                                                       
         ST    R1,APLAST                                                        
         XC    NPLINES,NPLINES                                                  
         MVI   NPLINES+3,2                                                      
*                                                                               
         L     R1,=V(MASTC)                                                     
         USING MASTD,R1                                                         
         MVC   REPMAX,MAXLINES                                                  
         CLI   MCMAXLIN,0                                                       
         BE    *+10                                                             
         MVC   REPMAX,MCMAXLIN     USE MCMAXLIN IF SPECIFIED                    
         DROP  R1                                                               
         SPACE 1                                                                
         CLI   RC2DSECT,C'Y'       OPTIONALLY 14 AT P1                          
         BNE   SETW2                                                            
*                                                                               
         LA    R1,P1                                                            
         ST    R1,AP1                                                           
         LA    R1,P14                                                           
         ST    R1,APLAST                                                        
         MVI   NPLINES+3,14                                                     
*                                                                               
         SPACE 1                                                                
SETW2    L     R1,ABOX                                                          
         DROP  R2                                                               
*                                                                               
         LR    R2,R1                                                            
         LTR   R2,R2                                                            
         BZ    SETW4                                                            
         USING BOXD,R2                                                          
         CLC   BOXWIDTH,=F'132'    CHECK FOR WIDE PRINT                         
         BNH   SETW4                                                            
         MVC   PWIDTH,=F'198'      SET UP FOR WIDE PRINT LINES                  
         MVI   WIDEOPT,C'Y'                                                     
         L     R2,BOXAWIDE                                                      
         USING WIDED,R2                                                         
         LA    R1,XHEAD1                                                        
         ST    R1,AH1                                                           
         LA    R1,XMID1                                                         
         ST    R1,AM1                                                           
         LA    R1,XMID2                                                         
         ST    R1,AM2                                                           
         LA    R1,XP                                                            
         ST    R1,AP1                                                           
         LA    R1,XP4                                                           
         ST    R1,APLAST                                                        
         MVI   NPLINES+3,4                                                      
         DROP  R2                                                               
         SPACE 1                                                                
SETW4    MVI   MYSPACES,C' '                                                    
         MVC   MYSPACES+1(197),MYSPACES                                         
         L     R1,PWIDTH                                                        
         BCTR  R1,0                                                             
         ST    R1,EXWIDE           WIDTH-1 FOR EX INSTRUCTIONS                  
         EJECT                                                                  
*                                                                               
         EJECT                                                                  
*                   OPTION JUST TO CLEAR ALL PRINT LINES                        
         SPACE 3                                                                
         CLI   FORCECLR,C'N'                                                    
         BE    PC4                                                              
         MVI   FORCECLR,C'N'                                                    
         SPACE 2                                                                
PC1      L     R2,AH1                                                           
         LA    R3,14                                                            
         BAS   RE,SPCLEAR                                                       
         SPACE 1                                                                
         L     R2,AM1                                                           
         LA    R3,2                                                             
         BAS   RE,SPCLEAR                                                       
         SPACE 1                                                                
         L     R2,AP1                                                           
         L     R3,NPLINES                                                       
         BAS   RE,SPCLEAR                                                       
         MVC   FOOT1,SPACES                                                     
         B     PCEXT                                                            
         SPACE 1                                                                
SPCLEAR  L     R1,EXWIDE                                                        
         SPACE 1                                                                
SPCLEAR2 EX    R1,R2CLEAR                                                       
         A     R2,PWIDTH                                                        
         BCT   R3,SPCLEAR2                                                      
         BR    RE                                                               
         SPACE 1                                                                
R2CLEAR  MVC   0(0,R2),MYSPACES                                                 
R2TEST   CLC   0(0,R2),MYSPACES                                                 
R4TEST   CLC   0(0,R4),MYSPACES                                                 
R2SPACES OC    0(0,R2),MYSPACES                                                 
         EJECT                                                                  
*                   CONTROL SPEC PROCESSING                                     
         SPACE 2                                                                
PC4      CLI   SKIPSPEC,C'Y'                                                    
         BE    PC6                                                              
         CLI   RCFLONLY,C'Y'                                                    
         BE    PC5                                                              
         CLI   FORCEHED,C'Y'       DONT EXECUTE SPECS IF JUST                   
         BE    PC5                 HANDLING PLINES                              
         CLI   FORCEMID,C'Y'                                                    
         BE    PC5                                                              
         CLI   FORCEFUT,C'Y'                                                    
         BE    PC5                                                              
         SR    RF,RF               CHECK IF LINE + ALLOWLIN EXCEEDS MAX         
         IC    RF,LINE                                                          
         SR    R0,R0                                                            
         IC    R0,ALLOWLIN                                                      
         MVI   ALLOWLIN,0                                                       
         AR    RF,R0                                                            
         IC    R0,REPMAX                                                        
         CR    RF,R0                                                            
         BL    PC4B                                                             
         MVI   FORCEHED,C'Y'       SO ENSURE HEADLINES                          
         B     PC5                                                              
         SPACE 2                                                                
*                                                                               
PC4B     L     R2,APLAST           HOW MANY PRINT LINES ARE THERE               
         L     R3,NPLINES                                                       
         L     R1,EXWIDE                                                        
         SPACE 1                                                                
PC4D     EX    R1,R2TEST                                                        
         BNE   PC4F                                                             
         S     R2,PWIDTH                                                        
         BCT   R3,PC4D                                                          
         LA    R3,1                                                             
         SPACE 2                                                                
PC4F     ZIC   R2,SPACING          ADD IN SPACING                               
         CLC   RCSPACNG,SPACING                                                 
         BNH   *+8                                                              
         IC    R2,RCSPACNG                                                      
         AR    R3,R2                                                            
         BCTR  R3,0                -1                                           
         ZIC   R2,LINE             AND PRESENT LINE COUNT                       
         AR    R3,R2                                                            
         ZIC   R2,REPMAX           WILL THEY FIT                                
         CR    R3,R2                                                            
         BNH   PC14                                                             
         MVI   FORCEHED,C'Y'                                                    
         SPACE 2                                                                
PC5      DS    0H                                                               
         BAS   RE,PROCSPEC                                                      
         CLI   RCFLONLY,C'Y'                                                    
         BNE   PC6                                                              
         MVI   RCFLONLY,C'N'                                                    
         B     PCEXT                                                            
         EJECT                                                                  
*                   CONTROL OF HEADLINE PRINTING                                
         SPACE 3                                                                
PC6      CLI   FORCEHED,C'N'                                                    
         BE    PC12                                                             
         MVI   FORCEHED,C'N'                                                    
         SPACE 2                                                                
PC10     MVI   FORCEMID,C'Y'                                                    
         GOTO1 APRINT,REPARA,MYSPACES,=C'BC01'                                  
*                                                                               
         CLI   RQEMAIL,C'Y'                                                     
         BNE   PC10A                                                            
         GOTO1 =V(EMLPUT),(R1)                                                  
*                                                                               
PC10A    DS    0H                                                               
         MVI   LINE,1                                                           
*                                                                               
PC10A5   DS    0H                                                               
         OC    HEADHOOK,HEADHOOK                                                
         BZ    PC10B                                                            
         L     RF,HEADHOOK                                                      
         BAS   RE,GOHOOK                                                        
*                                                                               
PC10B    DS    0H                                                               
         L     R2,AH1                                                           
         LA    R3,14                                                            
         BAS   RE,PRINCON                                                       
*                                                                               
         CLI   HEADHOOK,C'R'      CHECK FOR ADDN'L HEADLINE REQUEST             
         BE    PC10A5                                                           
*                                                                               
         SR    R4,R4                                                            
         MVC   REPDUB(4),PAGE      ADD 1 TO PAGE AND SUBPAGE                    
         LH    R4,REPDUB                                                        
         LA    R4,1(R4)                                                         
         STH   R4,REPDUB                                                        
         LH    R4,REPDUB+2                                                      
         LA    R4,1(R4)                                                         
         STH   R4,REPDUB+2                                                      
         MVC   PAGE(4),REPDUB                                                   
         EJECT                                                                  
*                   CONTROL OF MIDLINE PRINTING                                 
         SPACE 3                                                                
PC12     CLI   FORCEMID,C'N'                                                    
         BE    PC14                                                             
         MVI   FORCEMID,C'N'                                                    
         OC    MIDHOOK,MIDHOOK                                                  
         BZ    PC12B                                                            
         GOTO1 MIDHOOK,REPARA,(RA)                                              
*                                                                               
PC12B    DS    0H                                                               
         L     R2,AM1                                                           
         LA    R3,2                                                             
         BAS   RE,PRINCON                                                       
         CLC   LINE,REPMAX                                                      
         BNL   PC10                                                             
         SPACE 2                                                                
*                   CONTROL OF PRINT LINES                                      
         SPACE 3                                                                
PC14     DS    0H                                                               
         L     R2,AP1              USE P AND PSECOND                            
         L     R3,NPLINES                                                       
         BAS   RE,PRINP                                                         
         MVI   SPACING,1                                                        
         SPACE 2                                                                
*                   CONTROL OF FOOTLINE PRINTING                                
         SPACE 3                                                                
PC15     DS    0H                                                               
         CLI   FORCEFUT,C'N'                                                    
         BE    PC17                                                             
         MVI   FORCEFUT,C'N'                                                    
         GOTO1 APRINT,P,SPACES,=C'BC09'                                         
*                                                                               
         CLI   RQEMAIL,C'Y'                                                     
         BNE   PC16                                                             
         GOTO1 =V(EMLPUT),(R1)                                                  
*                                                                               
PC16     LA    R2,FOOT1                                                         
         LA    R3,1                                                             
         BAS   RE,PRINCON                                                       
         MVI   FORCEHED,C'Y'                                                    
*                                                                               
PC17     DS    0H                                                               
         CLI   RCWHATPR,0                                                       
         BE    PC17X                                                            
*                                                                               
         LA    R2,MYPAGE1                                                       
         LA    R3,MYSUBPG1                                                      
         CLI   RCWHATPR,2                                                       
         BNE   *+12                                                             
         LA    R2,MYPAGE2                                                       
         LA    R3,MYSUBPG2                                                      
         MVC   0(2,R2),PAGE                                                     
         MVC   0(2,R3),SUBPAGE                                                  
*                                                                               
PC17X    B     PC1                                                              
         EJECT                                                                  
*                   CONTROL PRINTING OF A BLOCK                                 
         SPACE 3                                                                
PRINCON  NTR1                                                                   
         MVC   REPWORK,SPACES                                                   
         LR    R4,R2                                                            
         LR    R5,R3                                                            
         LA    R6,REPWORK                                                       
         L     R1,EXWIDE                                                        
         SPACE 2                                                                
PC20     EX    R1,R4TEST           BUILD A TABLE OF PRINT LINE BYTES            
         BE    *+8                                                              
         MVI   0(R6),C'P'                                                       
         A     R4,PWIDTH                                                        
         LA    R6,1(R6)                                                         
         BCT   R5,PC20                                                          
         SPACE 2                                                                
*                                  NOW CONVERT TO PRINTING NUMBERS              
         LA    R6,REPWORK                                                       
         SPACE 2                                                                
PC22     CLC   0(16,R6),SPACES     ANY LEFT                                     
         BE    PC30                NO                                           
         SPACE 2                                                                
PC26     LA    RE,2                                                             
         CLC   1(15,R6),SPACES     IS THIS THE LAST                             
         BE    PC28                                                             
         CLC   1(2,R6),=C' P'                                                   
         BE    PC28                                                             
         LA    RE,1                                                             
         CLI   1(R6),C'P'                                                       
         BE    PC28                                                             
         LA    RE,3                                                             
         SPACE 2                                                                
PC28     STC   RE,0(R6)                                                         
         AR    R6,RE                                                            
         SR    RF,RF                                                            
         IC    RF,LINE                                                          
         AR    RF,RE                                                            
         STC   RF,LINE                                                          
         B     PC22                                                             
         SPACE 2                                                                
PC30     LA    R6,REPWORK          NOW PRINT R2 = DATA                          
*                                            R3 = N'LINES                       
*                                            R6 = SKIP NUMBERS                  
PC32     CLI   0(R6),C' '                                                       
         BE    PC34                                                             
         MVC   CONTROL(3),=C'BL0'                                               
         MVC   CONTROL+3(1),0(R6)                                               
         OI    CONTROL+3,X'F0'                                                  
*                                                                               
         L     R1,EXWIDE                                                        
         EX    R1,R2SPACES  ENSURES PRINTABLE CHARACTERS                        
*                                                                               
         GOTO1 APRINT,REPARA,(R2),CONTROL                                       
*                                                                               
         CLI   RQEMAIL,C'Y'                                                     
         BNE   PC34                                                             
         GOTO1 =V(EMLPUT),(R1)                                                  
*                                                                               
         SPACE 2                                                                
PC34     A     R2,PWIDTH                                                        
         LA    R6,1(R6)                                                         
         BCT   R3,PC32                                                          
         B     XIT                                                              
         EJECT                                                                  
*                   SPECIAL ROUTINE FOR PRINT LINES                             
         SPACE 2                                                                
PRINP    NTR1                                                                   
         BCTR  R3,R0                                                            
         L     R1,EXWIDE                                                        
*                                  SINGLE PRINT UNTIL LAST                      
PRINP2   LR    RF,R2                                                            
         A     RF,PWIDTH           SET RF TO A(NEXT PRINT LINE)                 
         EX    R1,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RF),MYSPACES                                                 
         BE    PC36                                                             
         GOTO1 APRINT,REPARA,(R2),=C'BL01'                                      
*                                                                               
         CLI   RQEMAIL,C'Y'                                                     
         BNE   PC35                                                             
         GOTO1 =V(EMLPUT),(R1)                                                  
*                                                                               
PC35     DS    0H                                                               
         SR    RF,RF                                                            
         IC    RF,LINE                                                          
         LA    RF,1(RF)                                                         
         STC   RF,LINE                                                          
         A     R2,PWIDTH                                                        
         L     R1,EXWIDE           MUST RESET FOR NEXT EX                       
         BCT   R3,PRINP2                                                        
         SPACE 2                                                                
PC36     MVC   CONTROL(3),=C'BL0'  USERS SPACING FOR ONE OR 2/2                 
         MVC   CONTROL+3(1),SPACING                                             
         CLC   RCSPACNG,SPACING    OPTION DOUBLE/TRIPLE RSPEC SPACING           
         BNH   *+10                                                             
         MVC   CONTROL+3(1),RCSPACNG                                            
         OI    CONTROL+3,X'F0'                                                  
         GOTO1 APRINT,REPARA,(R2),CONTROL                                       
*                                                                               
         CLI   RQEMAIL,C'Y'                                                     
         BNE   PC37                                                             
         GOTO1 =V(EMLPUT),(R1)                                                  
*                                                                               
PC37     DS    0H                                                               
         SR    RF,RF                                                            
         IC    RE,CONTROL+3                                                     
         SLL   RE,28                                                            
         SRL   RE,28                                                            
         IC    RF,LINE                                                          
         AR    RE,RF                                                            
         STC   RE,LINE                                                          
         B     XIT                                                              
         SPACE 2                                                                
PCEXT    MVI   SKIPSPEC,C'N'                                                    
         XMOD1 1                                                                
         SPACE 2                                                                
GOHOOK   NTR1                                                                   
         L     RE,USERRD           USERS RD                                     
         LM    R0,RC,20(RE)       RESTORE USERS R0-RC                           
         BASR  RE,RF               RF CONTAINED A(HEADHOOK ROUTINE)             
XIT      XIT1                                                                   
         EJECT                                                                  
APRINT   DS    A                                                                
MYPAGE1  DC    H'1'                                                             
MYSUBPG1 DC    H'0'                                                             
MYPAGE2  DC    H'1'                                                             
MYSUBPG2 DC    H'0'                                                             
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*                   EXECUTE THE SPEC POOL                                       
         SPACE 3                                                                
PROCSPEC NTR1                                                                   
         L     R2,PPSPECS          POINT TO SPEC POOL                           
         SR    R3,R3                                                            
         MVI   PROGSW,C'Y'         PRESET SWITCHES                              
         MVI   FILTSW,C'Y'                                                      
         CLI   RCSUBPRG,0                                                       
         BE    EX1                                                              
         MVI   PROGSW,C'N'                                                      
         SPACE 2                                                                
EX1      CLI   RCFLONLY,C'Y'       PRESET I/O VALUES TO N                       
         BNE   EX4                                                              
         MVC   FCRDCLI(24),=24C'N'                                              
         B     EX4                                                              
         SPACE 2                                                                
         SPACE 2                                                                
EX2      IC    R3,1(R2)                                                         
         AR    R2,R3               GET NEXT SPEC                                
         SPACE 2                                                                
EX4      SR    R4,R4                                                            
         IC    R4,0(R2)                                                         
         SLL   R4,2                                                             
         L     R4,INBRTAB(R4)      GO TO ROUTINE DEPENDENT                      
         BR    R4                  ON THE VALUE OF ELEMENT                      
         SPACE 2                                                                
EX6      B     XIT                                                              
         SPACE 2                                                                
EX8      MVI   PROGSW,C'N'                                                      
         MVI   FILTSW,C'Y'         RESET FOR SUB-PROGRAM FILTERING              
         B     EX2                                                              
         SPACE 2                                                                
EX10     CLC   RCSUBPRG(1),2(R2)   CHECK MATCH OF SUB-PROGRAM                   
         BNE   EX2                                                              
         MVI   PROGSW,C'Y'                                                      
         B     EX2                                                              
         EJECT                                                                  
*                   AGENCY/MEDIA/CLIENT FILTERS                                 
         SPACE 3                                                                
EX12     MVI   FILTSW,C'N'         FILTER RESET                                 
         B     EX2                                                              
         SPACE 2                                                                
EX14     CLC   PCLTKCLT(3),4(R2)   A/C                                          
         BNE   EX2                                                              
         B     EX24                                                             
         SPACE 2                                                                
EX16     CLC   PCLTKCLT(3),3(R2)   M/C                                          
         BNE   EX2                                                              
         SPACE 2                                                                
EX18     CLC   QMEDIA,2(R2)        + MEDIA                                      
         BNE   EX2                                                              
         MVI   FILTSW,C'Y'                                                      
         B     EX2                                                              
         SPACE 2                                                                
EX20     CLC   PCLTKCLT(3),5(R2)   A/M/C                                        
         BNE   EX2                                                              
         SPACE 2                                                                
EX22     CLC   QMEDIA,4(R2)        + A/M                                        
         BNE   EX2                                                              
         SPACE 2                                                                
EX24     CLC   QAGENCY,2(R2)       + A                                          
         BNE   EX2                                                              
         MVI   FILTSW,C'Y'                                                      
         B     EX2                                                              
         EJECT                                                                  
*                   FILE AND RUN CONTROL SPECS                                  
         SPACE 3                                                                
EX26     CLI   RCFLONLY,C'Y'                                                    
         BNE   EX2                                                              
         CLI   FILTSW,C'Y'                                                      
         BNE   EX2                                                              
         CLI   PROGSW,C'Y'                                                      
         BNE   EX2                                                              
         SPACE 1                                                                
         SR    R4,R4                                                            
         IC    R4,2(R2)                                                         
         BCTR  R4,R0                                                            
         LA    R4,FCRDCLI(R4)                                                   
         MVI   0(R4),C'Y'                                                       
         B     EX2                                                              
         SPACE 2                                                                
EX28     CLI   RCFLONLY,C'Y'                                                    
         BNE   EX2                                                              
         CLI   FILTSW,C'Y'                                                      
         BNE   EX2                                                              
         CLI   PROGSW,C'Y'                                                      
         BNE   EX2                                                              
         CLI   2(R2),2                                                          
         BH    EX32                                                             
         BE    EX30                                                             
         MVI   SPACING,1                                                        
         B     EX2                                                              
         SPACE 2                                                                
EX30     MVI   SPACING,2                                                        
         B     EX2                                                              
         SPACE 2                                                                
EX32     CLI   2(R2),4                                                          
         BH    EX36                                                             
         BE    EX34                                                             
         MVI   SPACING,3                                                        
         B     EX2                                                              
         SPACE 2                                                                
EX34     MVI   RCLINEUP,C'Y'                                                    
         B     EX2                                                              
         SPACE 2                                                                
EX36     CLI   2(R2),6                                                          
         BH    EX40                                                             
         BE    EX38                                                             
         MVI   RCREQREP,C'Y'                                                    
         B     EX2                                                              
         SPACE 2                                                                
EX38     MVI   RCREQREP,C'N'                                                    
         B     EX2                                                              
         SPACE 2                                                                
EX40     CLI   2(R2),8                                                          
         BH    EX44                                                             
         BE    EX42                                                             
         MVI   RCREQSUM,C'Y'                                                    
         B     EX2                                                              
         SPACE 2                                                                
EX42     MVI   RCREQSUM,C'N'                                                    
         B     EX2                                                              
         SPACE 2                                                                
EX44     CLI   2(R2),9                                                          
         BH    EX45                                                             
         SR    R4,R4                                                            
         IC    R4,3(R2)                                                         
         CVD   R4,REPDUB                                                        
         UNPK  RCPROG,REPDUB                                                    
         OI    RCPROG+1,X'F0'                                                   
         B     EX2                                                              
         SPACE 2                                                                
EX45     MVC   MAXLINES,2(R2)                                                   
         B     EX2                                                              
         EJECT                                                                  
*                   PRINT SPEC CONTROL AND LITERALS                             
         SPACE 2                                                                
EX46     CLI   RCFLONLY,C'Y'                                                    
         BE    EX2                                                              
         CLI   PROGSW,C'Y'                                                      
         BNE   EX2                                                              
         CLI   FILTSW,C'Y'                                                      
         BNE   EX2                                                              
         MVC   REPDUB(2),2(R2)     WORK OUT DISLACEMENT                         
         L     R5,AH1                                                           
         AH    R5,REPDUB                                                        
         CLI   0(R2),13                                                         
         BE    EX48                                                             
         SR    R4,R4               WORK OUT BRANCH BY INSTRUCTION NUM           
         IC    R4,4(R2)                                                         
         SLL   R4,2                                                             
         L     R4,PRBRTAB(R4)                                                   
         BR    R4                                                               
         SPACE 2                                                                
EX48     DS    0H                                                               
         CLI   4(R2),X'20'         TEST LITERAL NEEDS DICTIONARY LOOKUP         
         BL    EX49                                                             
         CLI   4(R2),X'2F'                                                      
         BH    EX49                                                             
*                                                                               
         XC    REPDMCB,REPDMCB                                                  
         LA    R1,REPDMCB          BUILD DICTATE PARAMETER LIST                 
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNS      RESOLVE SINGLE EXPRESSION INTO SPEC          
         MVI   DDRETN,DDCASEU                                                   
         MVI   DDSYS,4             PRINT SYSTEM                                 
         MVC   DDLANG,RCLANG                                                    
         LA    RF,4(R2)                                                         
         STCM  RF,7,DDIADR                                                      
         DROP  R1                                                               
         L     R4,PPWORK2C         NEEDED SHORT TERM FOR DICTATE                
         USING PPWORK2D,R4                                                      
         GOTO1 DICTATE                                                          
         DROP  R4                                                               
*                                                                               
EX49     DS    0H                                                               
         SR    R4,R4               HANDLE LITERALS                              
         IC    R4,1(R2)                                                         
         SH    R4,=H'5'            LENGTH IS L'ELEMENT - 4                      
         EX    R4,MUVLIT                                                        
         B     EX2                                                              
         SPACE 2                                                                
MUVLIT   MVC   0(0,R5),4(R2)                                                    
         EJECT                                                                  
*                   TABLE OF INTERNAL BRANCH VALUES                             
         SPACE 3                                                                
         DS    0F                                                               
INBRTAB  DC    AL4(EX6)     0      END OF SPECS                                 
         DC    AL4(EX8)     1      PROGRAM RESET                                
         DC    AL4(EX10)    2              FILTER                               
         DC    AL4(EX12)    3      A/M/C   RESET                                
         DC    AL4(EX18)    4      MEDIA   FILTER                               
         DC    AL4(EX24)    5      AGENCY                                       
         DC    AL4(EX22)    6      A/M                                          
         DC    AL4(EX16)    7      M/CLI                                        
         DC    AL4(EX14)    8      A/CLI                                        
         DC    AL4(EX20)    9      A/M/CLI                                      
         DC    AL4(EX26)   10      FILE CONTROL SPEC                            
         DC    AL4(EX28)   11      RUN CONTROL SPEC                             
         DC    AL4(EX46)   12      PRINT KEYWORD SPEC                           
         DC    AL4(EX46)   13      PRINT LITERAL SPEC                           
         EJECT                                                                  
*                   ROUTINES FOR PRINT SPECS (0-3)                              
         SPACE 2                                                                
EX50     MVC   0(110,R5),SPACES    SPACES                                       
         CLI   SKIPSPEC,C'T'                                                    
         BE    EX2                                                              
         L     R1,EXWIDE                                                        
         EX    R1,*+8                                                           
         B     EX2                                                              
         MVC   0(0,R5),SPACES                                                   
         B     EX2                                                              
         SPACE 2                                                                
EX52     MVC   0(L'PP@RUNON,R5),PP@RUNON                                        
         MVC   7(8,R5),RCDATE                                                   
         PACK  REPDUB,RCDATE(2)                                                 
         CVB   R6,REPDUB                                                        
         BCTR  R6,R0                                                            
         MH    R6,=H'3'                                                         
         LA    R6,MONTHS(R6)                                                    
         MVC   7(3,R5),0(R6)                                                    
         MVC   15(4,R5),=C' AT '                                                
*&&DO                                                                           
         GETIME STANDARD                                                        
*&&                                                                             
*&&OS                                                                           
         TIME  DEC                                                              
         LR    R1,R0               TIME IN HUNDREDTHS IN R1                     
         SRL   R1,8                                                             
         SLL   R1,4                ROOM FOR SIGN                                
         AH    R1,=H'12'           SET POSITIVE SIGN                            
*&&                                                                             
         ST    R1,REPWORK                                                       
         MVC   REPDUB+5(3),REPWORK                                              
         OI    REPDUB+7,X'0F'                                                   
         CVB   R6,REPDUB                                                        
         STM   RE,R1,CURER1                                                     
         MVI   RCURTAB+3,2                                                      
*                                                                               
         L     R4,PPWORK2C     NEEDED SHORT TERM FOR CUREDIT                    
         USING PPWORK2D,R4                                                      
*                                                                               
         CURED (R6),(5,19(R5)),RCURTAB                                          
*                                                                               
         DROP  R4                                                               
*                                                                               
         LM    RE,R1,CURER1                                                     
         B     EX2                                                              
         SPACE 2                                                                
EX54     MVC   0(L'PP@PRTPK,R5),PP@PRTPK                                        
         MVC   9(L'PP@RPT,R5),PP@RPT                                            
         MVC   17(2,R5),RCPROG                                                  
         B     EX2                                                              
         SPACE 2                                                                
EX56     MVC   0(L'PP@PAGE,R5),PP@PAGE                                          
         EDIT  PAGE,(4,5(R5)),ALIGN=LEFT                                        
         B     EX2                                                              
         SPACE 2                                                                
EX57     MVC   0(L'PP@SUBPG,R5),PP@SUBPG                                        
         EDIT  SUBPAGE,(4,8(R5)),ALIGN=LEFT                                     
         B     EX2                                                              
         EJECT                                                                  
*                   ROUTINES FOR PRINT SPECS (4-8)                              
         SPACE 2                                                                
EX58     CLC   QSTART(6),SPACES    PERIOD                                       
         BE    EX62                                                             
         CLC   QEND(6),SPACES                                                   
         BNE   EX60                                                             
         MVC   0(L'PP@FROM,R5),PP@FROM                                          
         LA    R5,5(R5)                                                         
         SPACE 2                                                                
*******  GOTO1 DTCNV,REPWORK,(0,QSTART),(3,0(R5))                               
EX60     GOTO1 DATCON,REPWORK,(0,QSTART),(5,0(R5))                              
         CLC   QEND(6),SPACES                                                   
         BE    EX2                                                              
         LA    R5,9(R5)                                                         
         SPACE 2                                                                
EX62     CLC   QEND(6),SPACES                                                   
         BE    EX2                                                              
         MVC   0(L'PP@THRU,R5),PP@THRU                                          
*******  GOTO1 DTCNV,REPWORK,(0,QEND),(3,5(R5))                                 
         GOTO1 DATCON,REPWORK,(0,QEND),(5,5(R5))                                
         CLI   1(R5),C' '                                                       
         BNE   EX2                                                              
         MVC   2(8,R5),5(R5)                                                    
         MVC   10(3,R5),SPACES                                                  
         B     EX2                                                              
         SPACE 2                                                                
EX64     MVC   0(L'PP@RQSTR,R5),PP@RQSTR                                        
         MVC   13(12,R5),QUESTOR                                                
         B     EX2                                                              
         SPACE 2                                                                
EX66     MVC   0(L'PP@MED,R5),PP@MED                                            
         MVC   9(1,R5),PAGYKMED                                                 
         MVC   13(10,R5),PAGYMED                                                
*                                                                               
         CLI   PCLTKEY,0      BE SURE I HAVE A CLIENT HEADER                    
         BE    EX66X                                                            
         CLI   PCLTKEY+33,X'02' ANOTHER CHECK TO PREVENT LOOPS                  
         BNE   EX66X                                                            
         LA    R4,PCLTREC+33      CHECK FOR OVERRIDE ELEM                       
         MVI   RELCODE,X'41'                                                    
         BAS   RE,NEXTEL                                                        
         BNE   EX66X                                                            
         MVC   13(10,R5),2(R4)    MEDIA NAME OVERRIDE                           
*                                                                               
EX66X    CLC   13(10,R5),=C'INTERACTIV'                                         
         BE    EX66X5                                                           
         CLC   13(9,R5),=C'INTERACTV' COVERS INTERACTV AND INTERACTVE           
         BE    EX66X5                                                           
         CLC   13(6,R5),=C'INTRAC'    INTRACTIVE (AND OTHERS)                   
         BE    EX66X5                                                           
         B     EX2                                                              
EX66X5   MVC   13(11,R5),=C'INTERACTIVE'                                        
         B     EX2                                                              
*                                                                               
         SPACE 2                                                                
EX67     MVC   0(10,R5),PAGYMED                                                 
*                                                                               
         CLI   PCLTKEY,0      BE SURE I HAVE A CLIENT HEADER                    
         BE    EX67X                                                            
         CLI   PCLTKEY+33,X'02' ANOTHER CHECK TO PREVENT LOOPS                  
         BNE   EX67X                                                            
         LA    R4,PCLTREC+33      CHECK FOR OVERRIDE ELEM                       
         MVI   RELCODE,X'41'                                                    
         BAS   RE,NEXTEL                                                        
         BNE   EX67X                                                            
         MVC   0(10,R5),2(R4)    MEDIA NAME OVERRIDE                            
*                                                                               
EX67X    CLC   0(10,R5),=C'INTERACTIV'                                          
         BE    EX67X5                                                           
         CLC   0(9,R5),=C'INTERACTV' COVERS INTERACTV AND INTERACTVE            
         BE    EX67X5                                                           
         CLC   0(6,R5),=C'INTRAC'    INTRACTIVE (AND OTHERS)                    
         BE    EX67X5                                                           
         B     EX2                                                              
EX67X5   MVC   0(11,R5),=C'INTERACTIVE'                                         
         B     EX2                                                              
*                                                                               
         SPACE 2                                                                
EX68     MVC   0(33,R5),PAGYNAME   AGENCY NAME                                  
         B     EX2                                                              
         SPACE 2                                                                
EX70     MVC   0(33,R5),PAGYADDR   AGENCY ADDRESS                               
         B     EX2                                                              
         EJECT                                                                  
*                   ROUTINES FOR PRINT SPECS (9-14)                             
         SPACE 3                                                                
EX72     DS    0H                                                               
         CLI   PCLTKEY,0                                                        
         BE    EX2                                                              
         MVC   0(L'PP@CLI,R5),PP@CLI                                            
         MVC   9(3,R5),PCLTKCLT                                                 
         MVC   13(20,R5),PCLTNAME                                               
         B     EX2                                                              
         SPACE 2                                                                
EX74     MVC   0(20,R5),PCLTNAME                                                
         B     EX2                                                              
         SPACE 2                                                                
EX76     MVC   0(20,R5),PCLTNAME      SPECIAL FOR LONG CLIENT NAMES             
         MVC   20(20,R5),PCLTBNAM                                               
         B     EX2                                                              
         SPACE 2                                                                
**76     MVC   0(20,R5),PCLTBNAM     OLD EX76 NO-OPED                           
**       A     R5,PWIDTH                                                        
**       MVC   0(30,R5),PCLTLIN1                                                
**       A     R5,PWIDTH                                                        
**       MVC   0(30,R5),PCLTLIN2                                                
**       A     R5,PWIDTH                                                        
**       MVC   0(24,R5),PCLTATTN                                                
**       B     EX2                                                              
         SPACE 2                                                                
EX78     CLI   PPRDKEY+1,0                                                      
         BE    EX2                                                              
         MVC   0(L'PP@PRO,R5),PP@PRO                                            
         MVC   9(3,R5),PPRDKPRD                                                 
         MVC   13(20,R5),PPRDNAME                                               
         B     EX2                                                              
         SPACE 2                                                                
EX80     MVC   0(20,R5),PPRDNAME                                                
         B     EX2                                                              
         SPACE 2                                                                
EX82     MVC   0(20,R5),PPRDBILL                                                
         A     R5,PWIDTH                                                        
         MVC   0(30,R5),PPRDLIN1                                                
         A     R5,PWIDTH                                                        
         MVC   0(30,R5),PPRDLIN2                                                
         B     EX2                                                              
         EJECT                                                                  
*                   ROUTINES FOR PRINT SPECS (15-17)                            
         SPACE 3                                                                
EX84     MVC   0(L'PP@ESTM,R5),PP@ESTM                                          
         CLC   QEST,SPACES                                                      
         BE    EX86                                                             
         CLC   QEST,=C'ALL'                                                     
         BE    *+14                                                             
         CLC   QESTEND,SPACES                                                   
         BNE   EX88                                                             
         OC    PESTKEY,PESTKEY                                                  
         BNE   *+14                                                             
         MVC   0(9,R5),SPACES      NO ESTIMATE THERE                            
         B     EX2                                                              
         MVC   DUB(2),PESTKEST                                                  
         LH    R0,DUB                                                           
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  9(3,R5),DUB                                                      
*                                                                               
         MVI   8(R5),C' '                                                       
         MVC   13(20,R5),PESTNAME                                               
         B     EX2                                                              
         SPACE 2                                                                
EX86     MVC   13(L'PP@ALL,R5),PP@ALL                                           
         LA    RE,13+L'PP@ALL(R5)                                               
EX86C    CLI   0(RE),C' '                                                       
         BH    EX86D                                                            
         BCT   RE,EX86C                                                         
*                                                                               
EX86D    MVC   2(L'PP@TOGER,RE),PP@TOGER                                        
         BAS   RE,FLTRES                                                        
         B     EX2                                                              
         SPACE 2                                                                
EX88     DS    0H                                                               
         MVC   13(3,R5),QEST                                                    
         MVI   16(R5),C'-'                                                      
         MVC   17(3,R5),QESTEND                                                 
         B     EX2                                                              
         SPACE 2                                                                
EX90     MVC   0(20,R5),PESTNAME                                                
         B     EX2                                                              
         SPACE 2                                                                
EX92     MVC   0(L'PP@ALL,R5),PP@ALL                                            
         CLC   QEST,SPACES                                                      
         BE    EX2                                                              
         EDIT  (2,PESTKEST),(3,0(R5))                                           
         B     EX2                                                              
         EJECT                                                                  
*                   ROUTINES FOR PRINT SPECS (18-24)                            
         SPACE 3                                                                
         ST    R3,FULL             "JUST IN CASE"                               
         L     R3,ACONIO1          PCONREC ADDRESS                              
         USING PCONREC,R3                                                       
*                                                                               
EX94     GOTO1 DATCON,REPWORK,(3,PCONSTRT),(5,0(R5))                            
         MVC   8(L'PP@THRU,R5),PP@THRU                                          
         GOTO1 DATCON,REPWORK,(3,PCONEND),(5,14(R5))                            
*                                                                               
         DROP  R3                                                               
         L     R3,FULL    RESTORE WHATEVER WAS IN R3 BEFORE ABOVE               
*                                                                               
         B     EX2                                                              
         SPACE 2                                                                
EX96     DS    0H                                                               
         B     EX2                                                              
         SPACE 2                                                                
EX98     EQU   *                                                                
         GOTO1 PUBEDIT,REPWORK,PUBKPUB,(R5)                                     
         B     EX2                                                              
         SPACE 2                                                                
EX100    MVC   0(20,R5),PUBNAME                                                 
         B     EX2                                                              
         SPACE 2                                                                
EX102    MVC   0(30,R5),PUBLINE1                                                
         A     R5,PWIDTH                                                        
         MVC   0(30,R5),PUBLINE2                                                
         B     EX2                                                              
         SPACE 2                                                                
EX103    MVC   0(20,R5),PUBZNAME                                                
         B     EX2                                                              
         SPACE 2                                                                
EX104    MVC   0(30,R5),PREPNAME                                                
         B     EX2                                                              
         SPACE 2                                                                
EX106    MVC   0(30,R5),PREPLIN1                                                
         A     R5,PWIDTH                                                        
         MVC   0(30,R5),PREPLIN2                                                
         A     R5,PWIDTH                                                        
         MVC   0(20,R5),PREPATTN                                                
         B     EX2                                                              
         EJECT                                                                  
*                   ROUTINES FOR PRINT SPECS (25-30)                            
         SPACE 3                                                                
EX108    MVC   0(5,R5),=C'15PCT'                                                
         B     EX2                                                              
         SPACE 2                                                                
EX110    EQU   *                                                                
         STM   RE,R1,CURER1                                                     
         MVI   RCURTAB+3,1                                                      
*                                                                               
         L     R4,PPWORK2C     NEEDED SHORT TERM FOR CUREDIT                    
         USING PPWORK2D,R4                                                      
*                                                                               
         CURED PBDCD,(4,0(R5)),RCURTAB                                          
*                                                                               
         DROP  R4                                                               
*                                                                               
         LM    RE,R1,CURER1                                                     
         B     EX2                                                              
         SPACE 2                                                                
EX112    MVC   0(L'PP@INVOC,R5),PP@INVOC                                        
         MVC   08(L'PP@DATE,R5),PP@DATE                                         
         MVC   13(8,R5),RCDATE                                                  
         PACK  REPDUB,RCDATE(2)                                                 
         CVB   R6,REPDUB                                                        
         BCTR  R6,R0                                                            
         MH    R6,=H'3'                                                         
         LA    R6,MONTHS(R6)                                                    
         MVC   13(3,R5),0(R6)                                                   
         B     EX2                                                              
         SPACE 2                                                                
EX114    MVC   0(L'PP@INVOC,R5),PP@INVOC                                        
         EDIT  RCSPECNO,(6,10(R5)),FILL=0                                       
         B     EX2                                                              
         SPACE 2                                                                
EX116    MVC   REPWORK(2),RCDATE+6                                              
         MVC   REPWORK+2(2),RCDATE                                              
         MVC   REPWORK+4(2),RCDATE+3                                            
         GOTO1 ADDAY,REPWORK+12,REPWORK,REPDUB,10                               
*******  GOTO1 DTCNV,REPWORK,(0,REPDUB),(3,13(R5))                              
         GOTO1 DATCON,REPWORK,(0,REPDUB),(5,13(R5))                             
         MVC   0(L'PP@DUE,R5),PP@DUE                                            
         MVC   4(L'PP@DATE,R5),PP@DATE                                          
         B     EX2                                                              
         SPACE 2                                                                
EX118    MVC   0(L'PP@MONTH,R5),PP@MONTH                                        
         MVC   06(L'PP@OF,R5),PP@OF                                             
******** GOTO1 DTCNV,REPWORK,(0,QSTART),(5,9(R5))                               
         GOTO1 DATCON,REPWORK,(0,QSTART),(9,9(R5))                              
         CLI   QBILMODE,C'P'                                                    
         BNE   EX2                                                              
         MVC   16(L'PP@ANDPP,R5),PP@ANDPP                                       
         B     EX2                                                              
         EJECT                                                                  
*                   ROUTINES FOR PRINT SPECS (31-35)                            
         SPACE 3                                                                
EX120    CLI   QREGION,C' '                                                     
         BE    EX2                                                              
         CLI   PREGKEY,0                                                        
         BE    EX2                                                              
         MVC   0(L'PP@REGN,R5),PP@REGN                                          
         MVC   9(3,R5),PREGKREG                                                 
         MVC   13(20,R5),PREGNAME                                               
         B     EX2                                                              
         SPACE 2                                                                
EX122    CLI   QDIST,C' '                                                       
         BE    EX2                                                              
         CLI   PDSTKEY,0                                                        
         BE    EX2                                                              
         MVC   0(L'PP@DIST,R5),PP@DIST                                          
         MVC   9(3,R5),PDSTKDST                                                 
         MVC   13(20,R5),PDSTNAME                                               
         B     EX2                                                              
         SPACE 2                                                                
EX124    CLI   QDIV,C' '                                                        
         BE    EX2                                                              
         CLI   PDIVKEY,0                                                        
         BE    EX2                                                              
         MVC   0(L'PP@DIV,R5),PP@DIV                                            
         MVC   9(3,R5),PDIVKDIV                                                 
         MVC   13(20,R5),PDIVNAME                                               
         B     EX2                                                              
         SPACE 2                                                                
EX126    MVC   0(L'PP@VEND,R5),PP@VEND                                          
         MVC   8(20,R5),PUBNAME                                                 
         B     EX2                                                              
         SPACE 2                                                                
EX128    MVC   0(L'PP@PAYEE,R5),PP@PAYEE                                        
         MVC   8(30,R5),PREPNAME                                                
         B     EX2                                                              
         EJECT                                                                  
*              SPECIAL ROUTINES FOR ESTIMATE FILTERS                            
         SPACE 3                                                                
FLTRES   NTR1                                                                   
*                                                                               
         CLC   QESTEND,SPACES                                                   
         BE    FLTRESX                                                          
*                                                                               
         MVC   0(27,R5),SPACES                                                  
         MVC   0(L'PP@ALESF,R5),PP@ALESF                                        
         LA    RE,QESTEND                                                       
         ZAP   DUB,=P'1'                                                        
         LA    RF,21(R5)                                                        
*                                                                               
FLTRES2  CLI   0(RE),C' '                                                       
         BE    FLTRES4                                                          
         CLI   0(RE),C'*'                                                       
         BE    FLTRES4                                                          
         OI    DUB+7,X'0F'                                                      
         UNPK  0(1,RF),DUB                                                      
         MVI   1(RF),C'='                                                       
         TM    0(RE),X'40'         TEST NEGATIVE FILTER                         
         BO    *+12                                                             
         MVI   2(RF),C'-'                                                       
         LA    RF,1(RF)                                                         
         MVC   2(1,RF),0(RE)                                                    
         OI    2(RF),C' '          INSURE UPPER CASE ON - FILTERS               
         MVI   3(RF),C','                                                       
         LA    RF,4(RF)                                                         
*                                                                               
FLTRES4  LA    RE,1(RE)                                                         
         AP    DUB,=P'1'                                                        
         CP    DUB,=P'3'                                                        
         BNH   FLTRES2                                                          
         BCTR  RF,0                                                             
         MVI   0(RF),C')'                                                       
*                                                                               
FLTRESX  B     XIT                                                              
*                                                                               
NEXTEL   DS    0H                                                               
         CLI   0(R4),0                                                          
         BE    NEXTELX                                                          
         SR    R0,R0                                                            
         IC    R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLC   RELCODE,0(R4)                                                    
         BER   RE                EXIT WITH CC EQUAL                             
         CLI   0(R4),0                                                          
         BNE   *-18                                                             
NEXTELX  LTR   R4,R4               SET CC TO NOT EQUAL                          
         BR    RE                                                               
         EJECT                                                                  
*                                                                               
         LTORG                                                                  
RELCODE  DS    CL1                                                              
*                                                                               
RCURTAB  DS    CL8              CURTAB FOR THIS PROGRAM                         
*                                                                               
CURER1   DS    4A                                                               
*                                                                               
DCLIST   DS    0C                                                               
         DCDDL PP#RUNON,7                                                       
         DCDDL PP#PRTPK,8                                                       
         DCDDL PP#RPT,7                                                         
         DCDDL PP#PAGE,5                                                        
         DCDDL PP#SUBPG,8                                                       
         DCDDL PP#FROM,5                                                        
         DCDDL PP#THRU,5                                                        
         DCDDL PP#RQSTR,13                                                      
         DCDDL PP#MED,5                                                         
         DCDDL PP#CLI,6                                                         
         DCDDL PP#PRO,7                                                         
         DCDDL PP#ESTM,9                                                        
         DCDDL PP#ALL,4                                                         
         DCDDL PP#TOGER,8                                                       
         DCDDL PP#INVOC,7                                                       
         DCDDL PP#DATE,4                                                        
         DCDDL PP#DUE,3                                                         
         DCDDL PP#MONTH,5                                                       
         DCDDL PP#OF,2                                                          
         DCDDL PP#ANDPP,11                                                      
         DCDDL PP#REGN,7                                                        
         DCDDL PP#DIST,9                                                        
         DCDDL PP#DIV,9                                                         
         DCDDL PP#VEND,8                                                        
         DCDDL PP#PAYEE,8                                                       
         DCDDL PP#ALESF,21                                                      
DCLISTX  DC    X'00'                                                            
*                                                                               
DSLIST   DS    0C                                                               
         DSDDL PRINT=YES                                                        
         PRINT GEN                                                              
DSLISTX  EQU   *                                                                
*                   BRANCH TABLE FOR PRINT SPECS                                
         SPACE 3                                                                
         SPACE 3                                                                
         DS    0F                                                               
PRBRTAB  DC    AL4(EX50)    0      SPACES                                       
         DC    AL4(EX52)    1      RUN                                          
         DC    AL4(EX54)    2      REPORT                                       
         DC    AL4(EX56)    3      PAGE                                         
         DC    AL4(EX58)    4      PERIOD                                       
         DC    AL4(EX64)    5      REQUESTOR                                    
         DC    AL4(EX66)    6      MEDIA                                        
         DC    AL4(EX68)    7      AGYNAME                                      
         DC    AL4(EX70)    8      AGYADD                                       
         DC    AL4(EX72)    9      CLIENT                                       
         DC    AL4(EX74)   10      CLINAME                                      
         DC    AL4(EX76)   11      CLIADD                                       
         DC    AL4(EX78)   12      PRODUCT                                      
         DC    AL4(EX80)   13      PRONAME                                      
         DC    AL4(EX82)   14      PROADD                                       
         DC    AL4(EX84)   15      ESTIMATE                                     
         DC    AL4(EX90)   16      ESTNAME                                      
         DC    AL4(EX92)   17      ESTNUM                                       
         DC    AL4(EX94)   18      CONTRACT                                     
         DC    AL4(EX96)   19      LASTCONT                                     
         DC    AL4(EX98)   20      PUBNUM                                       
         DC    AL4(EX100)  21      PUBNAME                                      
         DC    AL4(EX102)  22      PUBADD                                       
         DC    AL4(EX104)  23      REPNAME                                      
         DC    AL4(EX106)  24      REPADD                                       
         DC    AL4(EX108)  25      AGYCOMM                                      
         DC    AL4(EX110)  26      CASHDISC                                     
         DC    AL4(EX112)  27      INVDATE                                      
         DC    AL4(EX114)  28      INVNUM                                       
         DC    AL4(EX116)  29      DUEDATE                                      
         DC    AL4(EX118)  30      INVMONTH                                     
         DC    AL4(EX120)  31      REGION                                       
         DC    AL4(EX122)  32      DISTRICT                                     
         DC    AL4(EX124)  33      DIVISION                                     
         DC    AL4(EX126)  34      VENDOR                                       
         DC    AL4(EX128)  35      PAYEE                                        
         DC    AL4(EX57)   36      SUBPAGE                                      
         DC    AL4(EX103)  37      PUBZONE                                      
         DC    AL4(EX67)   38      MEDIANAME                                    
         EJECT                                                                  
*                   DSECT FOR THIS MODULE                                       
         SPACE 3                                                                
PPREPD   DSECT                                                                  
REPDUB   DS    D                                                                
REPDMCB  DS    CL24                                                             
REPARA   DS    6F                                                               
USERRD   DS    F                                                                
REPWORK  DS    CL40                                                             
CONTROL  DS    CL4                                                              
PROGSW   DS    CL1                                                              
FILTSW   DS    CL1                                                              
WIDEOPT  DS    CL1                                                              
REPMAX   DS    XL1                                                              
PWIDTH   DS    F                                                                
EXWIDE   DS    F                                                                
AH1      DS    A                   A(HEADLINES)                                 
AM1      DS    A                   A(MIDLINES)                                  
AM2      DS    A                                                                
AP1      DS    A                   A(PRINT LINES)                               
APLAST   DS    A                                                                
AF1      DS    A                   A(FOOT LINE)                                 
NPLINES  DS    F                   NUMBER OF PRINT LINES                        
MYSPACES DS    CL198                                                            
ACONIO1  DS    A                   A(PCONREC)                                   
PPREPX   EQU   *                                                                
*                                                                               
*   INCLUDE    PPREPWORK                                                        
*   INCLUDE    PPREPWORK2                                                       
*   INCLUDE    DDBIGBOX                                                         
*   INCLUDE    DDWIDED                                                          
*   INCLUDE    PPNEWFILE                                                        
*   INCLUDE    DDREPMASTD                                                       
         SPACE 1                                                                
*        PRINT OFF                                                              
       ++INCLUDE PPREPWORK                                                      
       ++INCLUDE PPREPWORK2                                                     
       ++INCLUDE DDBIGBOX                                                       
       ++INCLUDE DDWIDED                                                        
       ++INCLUDE PPNEWFILE                                                      
       ++INCLUDE DDREPMASTD                                                     
       ++INCLUDE PPDDEQUS                                                       
       ++INCLUDE DDDICTATED                                                     
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'007PPREPORTW 02/26/03'                                      
         END                                                                    
         EJECT                                                                  
