*          DATA SET SPREPCB02A AT LEVEL 023 AS OF 10/18/05                      
*CATALP SPCB02A                                                                 
***********************************************************************         
*                                                                     *         
* 31MAR87 CHANGE DPTOVTAB TO ELIMINATE ACCESS PER D B THORNTON JWNY   *         
*                                                                     *         
* 30JUN87 ADD QOPT1 TO ALLOW SLN BREAKOUT                             *         
*                                                                     *         
* 23AUG94 NEW STAPACK                                                 *         
*                                                                     *         
***********************************************************************         
         TITLE 'SPREPCB02A - COMPARATIVE BUYING REPORT-INPUT ROUTINES'          
SPCB02A  CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 0,**CB2A                                                         
*                                                                               
         LA    RC,2048(RB)                                                      
         LA    RC,2048(RC)                                                      
         USING SPCB02A+4096,RC                                                  
*                                                                               
         L     R9,0(R1)                                                         
         LA    RA,2048(R9)                                                      
         LA    RA,2048(RA)                                                      
         USING SPWORKD,R9,RA                                                    
*                                                                               
         L     R8,=A(SPCBWORK)                                                  
         USING CBWORKD,R8                                                       
         USING OFFICED,OFCBLK                                                   
*                                                                               
         CLI   MODE,PROCBUY                                                     
         BE    CB200                                                            
         CLI   MODE,ESTFRST                                                     
         BE    CB150                                                            
         CLI   MODE,STAFRST                                                     
         BE    CB170                                                            
         CLI   MODE,STALAST                                                     
         BE    CB180                                                            
         CLI   MODE,CLTFRST                                                     
         BE    CB100                                                            
         CLI   MODE,REQLAST                                                     
         BE    CB300                                                            
         CLI   MODE,REQFRST                                                     
         BE    CB10                                                             
*                                                                               
EXIT     XIT1                                                                   
         EJECT                                                                  
* REQFRST *                                                                     
         SPACE 1                                                                
CB10     DS    0H                                                               
         LA    R0,BFREC                                                         
         ST    R0,BUFFIO                                                        
         L     R0,=A(BUFFALOC)                                                  
         ST    R0,BUFFBUFF                                                      
*                                                                               
         GOTO1 BUFFALO,DMCB,=C'SET',BUFFBUFF                                    
         SPACE 1                                                                
         L     R2,MEDBUFF          CLEAR MEDBUFF                                
         LA    R0,5                                                             
         XC    0(256,R2),0(R2)                                                  
         LA    R2,256(R2)                                                       
         BCT   R0,*-10                                                          
*                                                                               
         L     R2,MEDBUFF                                                       
         USING MEDBLOCK,R2                                                      
*                                                                               
         XC    MEDNUMWK,MEDNUMWK                                                
         MVC   MEDNUMMO,=F'13'                                                  
         MVC   MEDNUMQT,=F'5'      ***** FORCE FOR NOW                          
         MVC   MEDSPQRT,PROGPROF+0 SET SPECIAL QTR FLAG FROM PROGPROF           
         MVC   MEDNUMPE,=F'1'                                                   
         MVI   RQDAYPT,C'Y'                                                     
         MVI   RQEQUIV,C'Y'                                                     
         MVI   MEDEXTDM,4          SET FOR 4 DEMOS                              
         MVC   MEDLCHNK,=AL4(MEDBY5-MEDGLD)                                     
*                                                                               
         MVC   CBREC-8(8),=CL8'**CBREC*'     SET EYECATCHERS                    
         MVC   CBSPECS-8(8),=CL8'**SPECS*'                                      
         MVC   CBDSP-8(8),=CL8'**CBDSP*'                                        
         MVC   CBSORTER,=V(SORTER)                                              
*                                                                               
         GOTO1 =V(SORTER),DMCB,=C'END'                                          
*                                                                               
         LA    R0,CBKEYLEN                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  SORTCARD+15(3),DUB                                               
*                                                                               
         LA    R0,CBRECLEN                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  RECCARD+21(3),DUB                                                
         GOTO1 =V(SORTER),DMCB,SORTCARD,RECCARD,0                               
         B     CB20                                                             
*                                                                               
SORTCARD DC    CL80'SORT FIELDS=(1,XXX,BI,A),WORK=1'                            
RECCARD  DC    CL80'RECORD TYPE=F,LENGTH=XXX'                                   
         EJECT                                                                  
* PROCESS SPEC LIST *                                                           
         SPACE 1                                                                
CB20     XC    CBSPECS,CBSPECS                                                  
         LA    R1,CBSPECS                                                       
         LA    R4,QSPECJW                                                       
         CLI   QOPT1,C'Y'          TEST SLN BREAKOUT                            
         BNE   *+8                                                              
         LA    R4,QSPECJW1                                                      
*                                                                               
         LA    RE,HROWS                                                         
         ST    RE,FULL                                                          
*                                                                               
CB22     CLI   0(R4),SPECMGR1                                                   
         BNE   *+12                                                             
         CLI   QMGR,C' '           IGNORE MGRP IF NOT REQUESTED                 
         BE    *+8                                                              
*                                                                               
         CLI   0(R4),0                                                          
         BE    *+8                                                              
         BAS   RE,SETSPEC                                                       
*                                                                               
         CLI   1(R4),X'FF'         TEST LAST HEADLINE                           
         BE    CB24                                                             
         LA    R4,1(R4)                                                         
         B     CB22                                                             
*                                                                               
CB24     LA    R4,2(R4)            POINT BEYOND X'FF'                           
*                                                                               
         LA    RE,PROWS                                                         
         ST    RE,FULL             SET BASE FOR PRINT LINE ROWS                 
*                                                                               
CB26     CLI   0(R4),0                                                          
         BE    *+8                                                              
         BAS   RE,SETSPEC                                                       
         CLI   1(R4),X'FF'         TEST LAST PRINT LINE ROW                     
         BE    CB28                                                             
         LA    R4,1(R4)                                                         
         B     CB26                                                             
*                                                                               
CB28     LA    RE,CBSPECS                                                       
         SR    RE,R1               GIVES BYTES OF ACTUAL ROW SPECS              
         LPR   RE,RE               MAKE POSITIVE                                
         BCTR  RE,0                SUB 1                                        
         STH   RE,CBCMPRLN         SET EX LEN FOR KEY COMPARES                  
*                                                                               
         LA    RE,1(RE)            RESTORE                                      
         SRL   RE,2                DIVIDE BY 4                                  
         STH   RE,CBHIROW          SET ACTUAL HIGH ROW NUMBER                   
*                                                                               
         LA    R4,2(R4)            POINT BEYOND X'FF'                           
*                                                                               
         LA    RE,PCOLS                                                         
         ST    RE,FULL             SET BASE FOR PRINT LINE COLS                 
*                                                                               
         LR    R0,R1               SAVE FIRST COL SPEC ADDR                     
*                                                                               
CB29     CLI   0(R4),0                                                          
         BE    *+8                                                              
         BAS   RE,SETSPEC                                                       
         LA    R4,1(R4)                                                         
         CLI   0(R4),X'FF'         TEST END OF SPECS                            
         BNE   CB29                                                             
         MVI   0(R1),X'FF'         SET EOL FLAG                                 
*                                                                               
         SR    R1,R0               GIVES LEN OF COLSPECS                        
         SRL   R1,2                DIVIDE BY 4                                  
         STH   R1,CBHICOL          SET HIGH COLUMN NUM                          
         B     CB30                                                             
         EJECT                                                                  
* THESE SPECS SHOULD GO IN A PROFILE RECORD FOR EACH AGENCY *                   
*                                                                               
QSPECJW  DC    AL1(SPECMGR1,SPECCLT,SPECPRD,SPECMKT)                            
         DC    X'FF'                 INDICATE END OF HEADLINES                  
         DC    AL1(SPECSTA,SPECDPT,SPECPER)                                     
         DC    X'FF'               INDICATE END OF PRINT LINE ROWS              
         DC    AL1(SPECSPT,SPECDOL)                                             
         DC    AL1(SPECDM1,SPECDM2)                                             
         DC    X'FF'               INDICATE END OF SPEC LIST                    
         SPACE 1                                                                
QSPECJW1 DC    AL1(SPECMGR1,SPECCLT,SPECPRD,SPECMKT)                            
         DC    X'FF'                 INDICATE END OF HEADLINES                  
         DC    AL1(SPECSTA,SPECDPT,SPECPER,SPECSLN)                             
         DC    X'FF'               INDICATE END OF PRINT LINE ROWS              
         DC    AL1(SPECSPT,SPECDOL)                                             
         DC    AL1(SPECDM1,SPECDM2)                                             
         DC    X'FF'               INDICATE END OF SPEC LIST                    
         SPACE 2                                                                
* SUBR TO MOVE SPEC ADDRESSES TO LIST *                                         
* RE IS RETURN                                                                  
* R1 POINTS TO OPEN SLOT IN LIST                                                
* R4 POINTS TO QSPEC                                                            
* FULL HAS BASE SPEC LIST ADDRESS                                               
         SPACE 1                                                                
SETSPEC  DS    0H                                                               
         ZIC   RF,0(R4)            GET SPEC NUMBER                              
         N     RF,=X'0000000F'                                                  
         BCTR  RF,0                                                             
         MH    RF,=H'12'           X ENTRY WIDTH                                
         A     RF,FULL             POINT TO ENTRIES                             
*                                                                               
         USING SPECD,R2                                                         
*                                                                               
         L     R2,0(RF)            GET FIRST SPEC ADDRESS                       
         ST    R2,0(R1)                                                         
         LA    R1,4(R1)                                                         
*                                                                               
         ICM   R2,15,4(RF)         GET SECOND ENTRY                             
         BZR   RE                                                               
*                                                                               
         CLI   SPECDATA,SPECMGR2                                                
         BNE   *+12                                                             
         CLC   MGR1LEN,MGR2LEN     TEST 2 LEVELS OF MKTGRP                      
         BER   RE                  NO - DONE                                    
         CLI   SPECDATA,SPECPGR2                                                
         BNE   *+12                                                             
         CLC   PGR1LEN,PGR2LEN     TEST 2 LEVELS OF PRDGRP                      
         BER   RE                  NO                                           
         ST    R2,0(R1)                                                         
         LA    R1,4(R1)                                                         
*                                                                               
         ICM   R2,15,8(RF)         GET THIRD ENTRY                              
         BZR   RE                                                               
         CLI   SPECDATA,SPECMGR2                                                
         BNE   *+12                                                             
         CLC   MGR2LEN,MGR3LEN     TEST 3 LEVELS OF MKTGRP                      
         BER   RE                  NO - DONE                                    
         ST    R2,0(R1)                                                         
         LA    R1,4(R1)                                                         
         BR    RE                                                               
         EJECT                                                                  
* NOW SET DISPLACEMENTS TO DATA VALUES IN RECORD *                              
         SPACE 1                                                                
CB30     DS    0H                                                               
         LA    R1,CBSPECS                                                       
         SR    RE,RE               INITIAL ROW VALUE                            
         LA    RF,CBKEYLEN         INITIAL COL VALUE                            
*                                                                               
CB32     L     R2,0(R1)                                                         
         USING SPECD,R2                                                         
*                                                                               
         CLI   SPECDATA,128        TEST ROW OR COL                              
         BH    CB34                                                             
         STC   RE,0(R1)            SET ROW DATA DSPL                            
         LA    RE,4(RE)                                                         
         B     CB36                                                             
*                                                                               
CB34     STC   RF,0(R1)            SET COL DATA DSPL                            
         LA    RF,4(RF)                                                         
*                                                                               
CB36     LA    R1,4(R1)            NEXT LIST ENTRY                              
         CLI   0(R1),X'FF'                                                      
         BNE   CB32                                                             
         SPACE 1                                                                
* SET SIGNIFCANT DATA ABOUT SPECS *                                             
         SPACE 1                                                                
         XC    CBDSP,CBDSP         CLEAR DISPLACEMENT TABLE                     
         SR    R0,R0                                                            
         LA    R1,CBSPECS                                                       
*                                                                               
CB40     L     R2,0(R1)                                                         
         USING SPECD,R2                                                         
*                                                                               
         CLI   SPECDATA,SPECOFC                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPOFC                                                      
*                                                                               
         CLI   SPECDATA,SPECCLT                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPCLT                                                      
*                                                                               
         CLI   SPECDATA,SPECPGR1                                                
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPPGR                                                      
*                                                                               
         CLI   SPECDATA,SPECPRD                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPPRD                                                      
*                                                                               
         CLI   SPECDATA,SPECMGR1                                                
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPMGR                                                      
*                                                                               
         CLI   SPECDATA,SPECMKT                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPMKT                                                      
*                                                                               
         CLI   SPECDATA,SPECSTA                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPSTA                                                      
*                                                                               
         CLI   SPECDATA,SPECEST                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPEST                                                      
*                                                                               
         CLI   SPECDATA,SPECPER                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPPER                                                      
*                                                                               
         CLI   SPECDATA,SPECDPT                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPDPT                                                      
*                                                                               
         CLI   SPECDATA,SPECSLN                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPSLN                                                      
*                                                                               
         CLI   SPECDATA,SPECSPT                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPSPT                                                      
*                                                                               
         CLI   SPECDATA,SPECDOL                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPDOL                                                      
*                                                                               
         CLI   SPECDATA,SPECDM1                                                 
         BNE   *+12                                                             
         IC    R0,0(R1)                                                         
         STH   R0,CBDSPDM1                                                      
*                                                                               
         CLI   SPECDATA,SPECDM2                                                 
         BNE   CB42                                                             
         LA    R0,8                                                             
         AH    R0,CBDSPDM1                                                      
         STH   R0,CBDSPDM2         DEMO 2 IS 8 BYTES BEYOND DEMO 1              
*                                                                               
CB42     CLI   SPECDATA,SPECDM3                                                 
         BNE   CB44                                                             
         LA    R0,8                                                             
         AH    R0,CBDSPDM2                                                      
         STH   R0,CBDSPDM3                                                      
*                                                                               
CB44     CLI   SPECDATA,SPECDM4                                                 
         BNE   CB46                                                             
         LA    R0,8                                                             
         AH    R0,CBDSPDM3                                                      
         STH   R0,CBDSPDM4                                                      
*                                                                               
CB46     LA    R1,4(R1)                                                         
         CLI   0(R1),X'FF'                                                      
         BNE   CB40                                                             
         EJECT                                                                  
* CLEAR MGRTAB *                                                                
         SPACE 1                                                                
CB60     LA    R0,20000/250                                                     
         L     R1,AMGRTAB          GET MGRTAB ADDRESS                           
         ST    R1,CBMGRTAB         AND SET FOR OUTPUT PHASE                     
*                                                                               
         XC    0(250,R1),0(R1)                                                  
         LA    R1,250(R1)                                                       
         BCT   R0,*-10                                                          
*                                                                               
         MVC   CBQMGR,QMGR         SAVE REQUESTED MGRP ID                       
         CLI   QMGR,C' '           TEST MKTGRP REQUEST                          
         BE    CB70                                                             
         CLC   =C'ALL',QSTA        TEST ALL MKTGRP REQUEST                      
         BNE   *+8                 NO                                           
         MVI   QMGR,C' '           YES SUPPRESS SPONSOR MGRP PROCESSING         
         SPACE 1                                                                
* BUILD MKTGRP ASSGN TABLE *                                                    
         SPACE 1                                                                
         XC    KEY,KEY                                                          
         MVC   KEY(2),=X'0D82'                                                  
         MVC   KEY+2(1),BAGYMD                                                  
         MVC   KEY+8(1),CBQMGR                                                  
*                                                                               
         CLC   =C'ALL',QCLT                                                     
         BE    CB62                                                             
         SPACE 1                                                                
* FOR ONE CLIENT REQ, ALLOW CLT SPECIFIC MKTGRP *                               
         SPACE 1                                                                
         GOTO1 CLPACK,DMCB,QCLT,KEY+3                                           
         GOTO1 HIGH                                                             
         CLC   KEY(9),KEYSAVE      TEST CLIENT RECORDS FOUND                    
         BE    CB66                                                             
         CLI   CBQMGR,C'F'         MUST FIND FOR ID A-F                         
         BH    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         MVC   KEY,KEYSAVE         RESTORE KEY                                  
         XC    KEY+3(2),KEY+3      CLEAR CLIENT                                 
*                                                                               
CB62     GOTO1 HIGH                                                             
         CLC   KEY(9),KEYSAVE                                                   
         BE    CB66                                                             
         DC    H'0'                NO MARKETS ASSIGNED                          
*                                                                               
CB64     GOTO1 SEQ                                                              
*                                                                               
CB66     CLC   KEY(9),KEYSAVE                                                   
         BNE   CB70                                                             
*                                                                               
         SR    RE,RE                                                            
         ICM   RE,3,KEY+11         GET MKT NUM                                  
         AR    RE,RE               X 2                                          
         A     RE,CBMGRTAB         + TABLE START                                
         MVC   0(2,RE),KEY+9       MOVE MKTGRP NUMBER                           
         B     CB64                                                             
         EJECT                                                                  
* SET MASKS FOR MKTGRPS *                                                       
         SPACE 1                                                                
CB70     CLC   MGR3LEN,MGR2LEN     TEST 3 LEVELS OF MKTGRP                      
         BE    CB72                NO                                           
         ZIC   R0,MGR2LEN                                                       
         BAS   RE,SETMASK                                                       
         STH   R0,MGR2MASK                                                      
*                                                                               
CB72     CLC   MGR2LEN,MGR1LEN     TEST 2 LEVELS OF MKTGRP                      
         BE    CB74                                                             
         ZIC   R0,MGR1LEN                                                       
         BAS   RE,SETMASK                                                       
         STH   R0,MGR1MASK                                                      
         B     CB74                                                             
         SPACE 2                                                                
SETMASK  LTR   R0,R0                                                            
         BP    *+6                                                              
         DC    H'0'                                                             
         LA    RF,MGRMASKS-2                                                    
         LA    RF,2(RF)                                                         
         BCT   R0,*-4                                                           
         LH    R0,0(RF)                                                         
         BR    RE                                                               
*                                                                               
MGRMASKS DC    X'0FFF'             FOR BREAK LEN = 3                            
         DC    X'00FF'                             2                            
         DC    X'000F'                             1                            
         SPACE 2                                                                
CB74     B     EXIT                                                             
         EJECT                                                                  
* CLTFRST *                                                                     
         SPACE 1                                                                
CB100    MVI   QBPRD,0                                                          
         CLI   QPRD,C'0'           TEST FOR SINGLE PRODUCT REQUEST              
         BNL   CB110                                                            
         CLC   QPRD,=C'ALL'                                                     
         BE    CB110                                                            
         CLC   QPRD,=C'POL'                                                     
         BE    CB110                                                            
         L     RF,ADCLT            YES - FIND ITS CODE                          
         LA    RF,CLIST-CLTHDRD(RF)                                             
*                                                                               
CB102    MVC   QBPRD,3(RF)                                                      
         CLC   QPRD,0(RF)                                                       
         BE    CB110                                                            
         LA    RF,4(RF)                                                         
         CLI   0(RF),C' '                                                       
         BH    CB102                                                            
         DC    H'0'                                                             
*                                                                               
CB110    B     EXIT                                                             
         EJECT                                                                  
* ESTFRST *                                                                     
         SPACE 1                                                                
CB150    DS    0H                                                               
         GOTO1 MEDDATE,DMCB,(R9)                                                
*                                                                               
         GOTO1 MEDPRDRD,DMCB,(R9)                                               
* IF YOU THINK THE DMCB AND (R9) ARE REDUNDANT, TRY TAKING THEM OUT             
         B     EXIT                                                             
         SPACE 2                                                                
* STAFRST *                                                                     
         SPACE 1                                                                
CB170    DS    0H                                                               
         MVC   BUYKSAVE,KEY        SAVE BUY KEY                                 
         SPACE 1                                                                
* BUILD PARAMETERS TO READ MARKET RECORD *                                      
         SPACE 1                                                                
         L     R6,ADBLOCK                                                       
         USING DBLOCKD,R6                                                       
         XC    DBLOCK,DBLOCK                                                    
         MVC   DBCOMFCS,ACOMFACS                                                
         MVI   DBFUNCT,DBVLST                                                   
         MVC   DBFILE,=C'TP '                                                   
         MVI   DBSELSRC,C'N'                                                    
         MVI   DBSELMED,C'T'                                                    
         MVC   DBAREC,ADCOMREC     PASS I/O AREA ADDRESS                        
*                                                                               
         L     RE,ADBUY                                                         
         XC    WORK,WORK                                                        
         LA    R4,WORK                                                          
         USING STAPACKD,R4                                                      
         MVI   STAPACT,C'U'                                                     
         MVC   STAPAGY,AGY                                                      
         MVI   STAPCTRY,C'U'                                                    
         CLI   COUNTRY,C' '                                                     
         BNH   *+10                                                             
         MVC   STAPCTRY,COUNTRY                                                 
         MVC   STAPMED,QMED                                                     
         MVC   STAPMKST,4(RE)                                                   
         MVC   STAPACOM,ACOMFACS                                                
         GOTO1 VSTAPACK,WORK                                                    
         MVC   DBSELSTA(4),STAPQSTA                                             
         DROP  R4                                                               
*                                                                               
         GOTO1 DEMAND,DMCB,ADBLOCK,0                                            
         CLI   DBERROR,0                                                        
         BE    *+10                                                             
         XC    DBACTRMK,DBACTRMK   SET ERROR FLAG                               
         SPACE 1                                                                
         LH    R0,DBACTRMK                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  NSIMKT,DUB                                                       
         B     EXIT                                                             
         DROP  R6                                                               
         SPACE 2                                                                
* STALAST *                                                                     
         SPACE 1                                                                
CB180    BAS   RE,CBGEN            GENERATE SORT RECORDS                        
         B     EXIT                                                             
         EJECT                                                                  
* PROCBUY *                                                                     
         SPACE 1                                                                
CB200    DS    0H                                                               
*                                                                               
         L     RE,ADBUY                                                         
         CLC   KEY+4(2),4(RE)      TEST SPILL MARKET                            
         BNE   EXIT                YES - DO NOT PROCESS                         
*                                                                               
         XC    PSLIST,PSLIST                                                    
         GOTO1 MEDPSL,DMCB,(R9),PSLIST    BUILD PRD/SLN LIST                    
*                                                                               
CB210    LA    R4,PSLIST                                                        
*                                                                               
CB215    L     R2,MEDBUFF                                                       
         USING MEDBLOCK,R2                                                      
*                                                                               
         MVC   MEDBRAND,0(R4)                                                   
         MVC   MEDSPTLN,1(R4)                                                   
         CLI   QBPRD,0             TEST SINGLE PRODUCT REQUEST                  
         BE    *+14                                                             
         CLC   MEDBRAND,QBPRD      YES - IS THIS IT ?                           
         BNE   CB240                                                            
*                                                                               
         LA    R0,2                SET FOR BUYER'S DEMOS                        
         ST    R0,DMCB+4                                                        
         GOTO1 MEDGETBY,DMCB,(R9)                                               
*                                                                               
         LA    R5,MEDQRT01                                                      
*                                                                               
CB220    L     R1,4(R5)                                                         
         USING MEDDATA,R1                                                       
         SPACE 1                                                                
* SET BUFFALO DATA *                                                            
         SPACE 1                                                                
         XC    BFREC,BFREC         CLEAR BUFFALO DATA                           
         MVC   BFPRD(1),0(R4)      PRD                                          
         CLC   QPRD,=C'POL'                                                     
         BNE   *+8                                                              
         MVI   BFPRD,X'FF'                                                      
         CLC   QPRD,=C'ALL'                                                     
         BNE   *+8                                                              
         MVI   BFPRD,0                                                          
*                                                                               
         OC    CBDSPSLN,CBDSPSLN   TEST PROCESS BY SLN                          
         BZ    *+10                                                             
         MVC   BFSLN,1(R4)                                                      
*                                                                               
         MVC   BFPER,2(R5)         PERIOD END DATE                              
*                                                                               
         OC    CBDSPEST,CBDSPEST   TEST PROCESS BY EST                          
         BZ    *+10                NO                                           
         MVC   BFEST,KEY+9                                                      
*                                                                               
         MVC   BFDPT,MEDDPART      MOVE ACTUAL DAYPART CODE                     
         BAS   RE,SETDPT           AND RECODE IF NECESSARY                      
*                                                                               
         MVC   BFSPT,MEDBYSPT      SPOTS                                        
         MVC   BFDOL(8),MEDBYD     ACTUAL/EQUIV DOLLARS                         
         MVC   BFDM1(32),MEDBY1    ACTUAL/EQUIV DEMOS 1-4                       
         DROP  R1                                                               
*                                                                               
         OC    BFSPT(8),BFSPT      TEST FOR SPOTS OR DOLLARS                    
         BZ    CB235                                                            
*                                                                               
         CLI   QOPT4,C'Y'                                                       
         BNE   CB230                                                            
         MVC   P(4),=C'BPUT'                                                    
         BAS   RE,BUFFTRC                                                       
*                                                                               
CB230    DS    0H                                                               
         GOTO1 BUFFALO,DMCB,=C'PUT',BUFFBUFF,BFREC,1                            
*                                                                               
CB235    LA    R5,12(R5)           NEXT ENTRY                                   
         OC    0(2,R5),0(R5)       TEST E-O-L                                   
         BZ    CB240                                                            
         LA    R0,MEDQRT05          GET HIGHEST POSSIBLE QTR ADDRESS            
         CR    R5,R0                                                            
         BNH   CB220                                                            
*                                                                               
CB240    LA    R4,2(R4)            NEXT PSLIST ENTRY                            
         CLI   0(R4),0             TEST E-O-L                                   
         BNZ   CB215                                                            
*                                                                               
         B     EXIT                                                             
         EJECT                                                                  
* ALL INPUT DATA PROCESSED - PASS CONTROL TO OUTPUT ROUTINES *                  
         SPACE 1                                                                
CB300    DS    0H                                                               
         MVC   QMGR,CBQMGR         RESTORE MKTGRP FOR OUTPUT                    
         L     RF,=V(SPCB02B)      GO TO OUTPUT PHASE                           
         GOTO1 (RF),DMCB,(R9),(R8)                                              
         B     EXIT                                                             
         EJECT                                                                  
* SUBROUTINE TO OVERRIDE DPT CODES *                                            
         SPACE 1                                                                
SETDPT   NTR1                                                                   
         L     R6,ADBUY                                                         
         USING BUYRECD,R6                                                       
*                                                                               
         LA    R1,DPTOVTAB                                                      
         LA    RE,4                                                             
         LA    RF,DPTOVTBX                                                      
SETDPT1A CLC   BDDAYPT,0(R1)       MATCH OVERRIDE TABLE ENTRY                   
         BE    SETDPT1B                                                         
         BL    SETDPT1X                                                         
         BXLE  R1,RE,SETDPT1A                                                   
         B     SETDPT1X                                                         
*                                                                               
SETDPT1B MVC   BFDPT,1(R1)         SET OVERRIDE DPT CODE                        
*                                                                               
SETDPT1X L     R6,ADSTAT                                                        
         USING STARECD,R6                                                       
         CLC   =C'NBC',SNETWRK     TEST AFFILIATE                               
         BE    SETDPT2                                                          
         CLC   =C'CBS',SNETWRK                                                  
         BE    SETDPT2                                                          
         CLC   =C'ABC',SNETWRK                                                  
         BE    SETDPT2                                                          
         B     EXIT                NOT AN AFFILIATE                             
         DROP  R6                                                               
*                                                                               
DPTOVTAB DS    0F                                                               
         DC    C'CZZZDZZZIPRIKZZZQPRIRELYULTE'                                  
DPTOVTBX EQU   *-1                                                              
*                                                                               
SETDPT2  LA    R4,XRDPTAB2         POINT TO TABLE FOR MOUNTAIN/CENTRAL          
         CLI   NSIMKT,C'2'         NSI MKT CODE TELLS TIME ZONE                 
         BE    SETDPT4                TO SOME PEOPLE                            
         CLI   NSIMKT,C'3'                                                      
         BE    SETDPT4                                                          
         LA    R4,XRDPTAB1         POINT TO TABLE FOR EASTERN/PACIFIC           
*                                                                               
SETDPT4  L     R6,ADBUY                                                         
         USING BUYRECD,R6                                                       
*                                                                               
SETDPT6  ZIC   RE,BDDAY                                                         
         EX    RE,*+8                                                           
         B     *+8                                                              
         TM    0(R4),0 *EXECUTED*                                               
         BNO   SETDPT10            PROCESS IF ALL DAYS IN TABLE ENTRY           
* TEST TIME                                                                     
         SR    R0,R0                                                            
         ICM   R0,3,BDTIMST                                                     
         CH    R0,=H'600'                                                       
         BH    *+8                                                              
         AH    R0,=H'2400'                                                      
         CLM   R0,3,1(R4)          BUY START TO TABLE START                     
         BL    SETDPT10                                                         
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,BDTIMEND                                                    
         CH    R0,=H'600'                                                       
         BH    *+8                                                              
         AH    R0,=H'2400'                                                      
         CLM   R0,3,3(R4)          BUY END TO TABLE END                         
         BH    SETDPT10                                                         
         MVC   BFDPT,5(R4)         OVERRIDE THE DAYPART CODE                    
         B     EXIT                                                             
*                                                                               
SETDPT10 LA    R4,8(R4)                                                         
         CLI   0(R4),X'FF'                                                      
         BNE   SETDPT6                                                          
         B     EXIT                                                             
         EJECT                                                                  
* THIS TABLE FOR EASTERN AND PACIFIC TIME ZONES *                               
         SPACE 1                                                                
XRDPTAB1 DS    0F                                                               
         DC    B'01111100',AL2(1800,1900),C'ENW'  MO-FR/6-7P                    
         DC    B'01111111',AL2(2300,2330),C'LNW'  MO-SU/11-1130P                
         DC    B'01111111',AL2(2000,2300),C'PRI'  MO-SU/8-11P                   
         DC    B'00000001',AL2(1900,2300),C'PRI'  SUN/7-11P                     
         DC    X'FF'                                                            
         SPACE 1                                                                
* THIS TABLE FOR MOUNTAIN AND CENTRAL TIME ZONES *                              
         SPACE 1                                                                
XRDPTAB2 DS    0F                                                               
         DC    B'01111100',AL2(1700,1800),C'ENW'  MO-FR/5-6P                    
         DC    B'01111111',AL2(2200,2230),C'LNW'  MO-SU/10-1030P                
         DC    B'01111111',AL2(1900,2200),C'PRI'  MO-SU/7-10P                   
         DC    B'00000001',AL2(1800,2200),C'PRI'  SUN/6-10P                     
         DC    X'FF'                                                            
         EJECT                                                                  
NEXTEL   SR    R0,R0                                                            
         ICM   R0,1,1(R6)                                                       
         BNZ   *+6                                                              
         DC    H'0'                                                             
         AR    R6,R0                                                            
NEXTEL2  CLI   0(R6),0                                                          
         BE    NEXTELX                                                          
         CLC   0(1,R6),ELCDLO                                                   
         BL    NEXTEL                                                           
         CLC   0(1,R6),ELCDHI                                                   
         BH    NEXTEL                                                           
         CR    RE,RE                                                            
         BR    RE                  EXIT WITH CC EQUAL                           
NEXTELX  LTR   RE,RE                                                            
         BR    RE                  EXIT WITH CC NOT EQUAL                       
         SPACE 2                                                                
BUFFTRC  NTR1                                                                   
         L     RF,BUFFBUFF                                                      
         L     R0,BUFFLALL-BUFFALOD(RF)                                         
         GOTO1 HEXOUT,DMCB,BFREC,P+5,(R0),=C'N'                                 
         GOTO1 REPORT                                                           
         B     EXIT                                                             
         EJECT                                                                  
* SUBROUTINE TO GENERATE SORT RECORDS AT END OF STATION *                       
         SPACE 1                                                                
CBGEN    NTR1                                                                   
*                                                                               
         XC    CBREC,CBREC                                                      
         LA    R1,CBSPECS          POINT TO SPEC LIST                           
*                                                                               
CBGEN2   L     R2,0(R1)            POINT TO DATA SPEC                           
         USING SPECD,R2                                                         
         CLI   SPECDATA,128        TEST ROW DATA                                
         BH    CBGEN4              NO                                           
         ZIC   RF,SPECDATA                                                      
         N     RF,=X'0000000F'                                                  
         BCTR  RF,0                                                             
         SLL   RF,2                X  4                                         
*                                                                               
         MVI   BYTE,4              SET DEFAULT MOVE LENGTH                      
         XC    WORK,WORK           CLEAR MOVE AREA                              
         B     EXTTAB(RF)          CALL EXTRACT ROUTINE                         
*                                                                               
CBGEN4   LA    R1,4(R1)            NEXT SPEC                                    
         CLI   0(R1),X'FF'                                                      
         BNE   CBGEN2                                                           
         B     CBGEN10                                                          
         SPACE 1                                                                
* JUMP TABLE TO DATA EXTRACT ROUTINES *                                         
         SPACE 1                                                                
EXTTAB   B     EXTOFC                                                           
         B     EXTCLT                                                           
         B     EXTMGR                                                           
         B     EXTMKT                                                           
         B     EXTSTA                                                           
         B     EXTPGR                                                           
         B     CBGEN4  ** PRD                                                   
         B     CBGEN4  ** EST                                                   
         B     CBGEN4  ** PER                                                   
         B     CBGEN4  ** DPT                                                   
         B     CBGEN4  ** SLN                                                   
         EJECT                                                                  
EXTOFC   L     R6,ADCLT                                                         
         USING CLTHDRD,R6                                                       
         XC    OFCBLK,OFCBLK                                                    
         MVI   OFCSYS,C'S'                                                      
         MVC   OFCAGY,AGENCY                                                    
         MVC   OFCOFC,COFFICE                                                   
         L     RF,ADCONLST         ADDRESS OF OFFICER IN ADCON                  
         L     RF,VOFFICER-SPADCONS(RF)                                         
         GOTO1 (RF),DMCB,(C'2',OFFICED),(0,ACOMFACS)                            
         CLI   0(R1),0                                                          
         BNE   EXTX                                                             
         MVC   WORK(2),OFCOFC2                                                  
         B     EXTX                                                             
*                                                                               
EXTCLT   L     R6,ADCLT                                                         
         MVC   WORK(2),2(R6)                                                    
         B     EXTX                                                             
*                                                                               
EXTMGR   CLI   CBQMGR,C' '                                                      
         BE    CBGEN4                                                           
         SR    RF,RF                                                            
         ICM   RF,3,BUYKSAVE+4                                                  
         AR    RF,RF               X 2                                          
         A     RF,CBMGRTAB         ADD A(MKTGRP ASSGN TABLE)                    
         OC    0(2,RF),0(RF)                                                    
         BNZ   *+8                                                              
         LA    RF,=X'9999'         POINT TO UNDEFINED MKTGRP                    
         MVC   WORK(2),0(RF)                                                    
         OC    WORK(2),MGR1MASK                                                 
*                                                                               
         CLC   MGR1LEN,MGR2LEN     TEST 2 LEVELS                                
         BE    EXTX                NO                                           
*                                                                               
         MVI   BYTE,8              SET TO MOVE 8 BYTES                          
         MVC   WORK+4(2),0(RF)                                                  
         OC    WORK+4(2),MGR2MASK                                               
*                                                                               
         CLC   MGR2LEN,MGR3LEN     TEST 3 LEVELS                                
         BE    EXTX                NO                                           
*                                                                               
         MVI   BYTE,12             SET TO MOVE 12 BYTES                         
         MVC   WORK+8(2),0(RF)                                                  
         B     EXTX                                                             
*                                                                               
EXTMKT   MVC   WORK(2),BUYKSAVE+4                                               
         B     EXTX                                                             
*                                                                               
EXTSTA   MVC   WORK(3),BUYKSAVE+6                                               
         B     EXTX                                                             
*                                                                               
EXTPGR   CLI   QPGR,C' '                                                        
         BE    CBGEN4                                                           
********* NOTE PGROUP NOT CURRENTLY SUPPORTED                                   
         B     EXTX                                                             
*                                                                               
EXTX     ZIC   RF,0(R1)            GET DATA DSPL                                
         LA    RF,CBREC(RF)        POINT TO COL                                 
         ZIC   RE,BYTE             GET LENGTH TO MOVE                           
         BCTR  RE,0                                                             
         EX    RE,EXTMVC                                                        
         B     CBGEN4                                                           
*                                                                               
EXTMVC   MVC   0(0,RF),WORK   *EXECUTED*                                        
         EJECT                                                                  
* NOW GENERATE SORT RECORDS *                                                   
         SPACE 1                                                                
CBGEN10  DS    0H                                                               
         XC    BFREC,BFREC                                                      
         GOTO1 BUFFALO,DMCB,=C'HIGH',BUFFBUFF,BFREC,1                           
         TM    8(R1),X'80'                                                      
         BO    EXIT                                                             
         B     CBGEN14                                                          
*                                                                               
CBGEN12  GOTO1 BUFFALO,DMCB,=C'SEQ',BUFFBUFF,BFREC,1                            
         TM    8(R1),X'80'                                                      
         BO    CBGENX                                                           
*                                                                               
CBGEN14  CLI   QOPT4,C'Y'          TEST BUFFALO TRACE                           
         BNE   *+14                                                             
         MVC   P(4),=C'BGET'                                                    
         BAS   RE,BUFFTRC                                                       
*                                                                               
         LA    RE,CBREC+CBKEYLEN                                                
         XC    0(CBRECLEN-CBKEYLEN,RE),0(RE)  CLEAR COLUMNS                     
         SPACE 1                                                                
* TRANSLATE PRD CODE TO DISPLACEMENT IN CLTHDR PRD LIST *                       
         SPACE 1                                                                
         LA    R1,BFPRD                                                         
         CLI   0(R1),219           TEST FOR UNAL                                
         BNE   *+8                                                              
         LA    R1,XFF              POINT TO FF                                  
         BAS   RE,CBGETPRD         GET DSPL IN RF                               
*                                                                               
         LA    RE,CBREC                                                         
         SR    R0,R0                                                            
         ICM   R0,3,CBDSPPRD       ADD DSPL TO PRD                              
         BZ    *+10                                                             
         AR    RE,R0                                                            
         STH   RF,0(RE)                                                         
*                                                                               
         LA    RE,CBREC                                                         
         SR    R0,R0                                                            
         ICM   R0,3,CBDSPDPT       ADD DSPL TO DPT                              
         BZ    *+12                                                             
         AR    RE,R0                                                            
         MVC   0(3,RE),BFDPT                                                    
*                                                                               
         LA    RE,CBREC                                                         
         SR    R0,R0                                                            
         ICM   R0,3,CBDSPSLN       ADD DSPL TO SLN                              
         BZ    *+12                                                             
         AR    RE,R0                                                            
         MVC   0(1,RE),BFSLN                                                    
*                                                                               
         LA    RE,CBREC                                                         
         AH    RE,CBDSPPER         ADD DSPL TO PERIOD                           
         MVC   0(2,RE),BFPER                                                    
*                                                                               
         LA    RE,CBREC                                                         
         SR    R0,R0                                                            
         ICM   R0,3,CBDSPSPT       ADD DSPL TO SPOTS                            
         BZ    *+12                                                             
         AR    RE,R0                                                            
         MVC   0(4,RE),BFSPT       MOVE SPOTS                                   
*                                                                               
         LA    RE,CBREC                                                         
         SR    R0,R0                                                            
         ICM   R0,3,CBDSPDOL       ADD DSPL TO DOLLARS                          
         BZ    *+12                                                             
         AR    RE,R0                                                            
         MVC   0(8,RE),BFDOL       MOVE ACTUAL/EQUIV DOLLARS                    
*                                                                               
         LA    RE,CBREC                                                         
         SR    R0,R0                                                            
         ICM   R0,3,CBDSPDM1       ADD DSPL TO DEMO 1                           
         BZ    *+12                                                             
         AR    RE,R0                                                            
         MVC   0(32,RE),BFDM1       MOVE ACTUAL/EQUIV DEMOS 1-4                 
*                                                                               
         BAS   RE,SORTPUT          PUT SORT REC                                 
*                                                                               
         LH    R3,CBDSPDPT                                                      
         LA    R3,CBREC(R3)                                                     
         MVC   FULL,0(R3)          SAVE THE DPT                                 
         MVC   0(4,R3),XFF         MOVE IN HIGHVALS FOR ALL DPTS                
         BAS   RE,SORTPUT          PUT 'ALL DPT' RECORD                         
         MVC   0(4,R3),FULL        RESTORE DPT                                  
*                                                                               
         LH    R3,CBDSPSTA                                                      
         LA    R3,CBREC(R3)                                                     
         MVC   FULL,0(R3)          SAVE THE STATION                             
         MVC   0(4,R3),XFF         MOVE IN HIGHVALS FOR MKT TOTAL               
         BAS   RE,SORTPUT          PUT MARKET TOTAL RECORD                      
         MVC   0(4,R3),FULL        RESTORE STATION                              
         B     CBGEN12                                                          
*                                                                               
CBGENX   DS    0H                                                               
         GOTO1 BUFFALO,DMCB,=C'CLEAR',BUFFBUFF,(X'80',1)                        
         B     EXIT                                                             
         SPACE 2                                                                
* SUBR TO TRANSLATE NUMERIC PRD CODE TO DSPL IN CLTHDR CLIST                    
* DSPL IS RETURNED AS HALFWORD IN RF. R1 POINTS TO 1 BYTE PRD CODE              
         SPACE 1                                                                
CBGETPRD CLI   0(R1),0                                                          
         BNE   *+8                                                              
         SR    RF,RF                                                            
         BR    RE                                                               
         L     RF,ADCLT                                                         
         LA    RF,CLIST-CLTHDRD(RF)                                             
         LR    R0,RF               SAVE CLIST ADDRESS                           
*                                                                               
CBGETPR2 CLC   0(1,R1),3(RF)                                                    
         BE    CBGETPR4                                                         
         LA    RF,4(RF)                                                         
         CLI   0(RF),C' '                                                       
         BH    CBGETPR2                                                         
         DC    H'0'                                                             
*                                                                               
CBGETPR4 SR    RF,R0               GET DISPLACEMENT                             
         LA    RF,1(RF)            ADD 1 SO DSPL NEVER 0                        
         BR    RE                                                               
         EJECT                                                                  
* ROUTINE TO PUT A RECORD TO SORTER AND OPTIONALLY PRINT A TRACE *              
         SPACE                                                                  
SORTPUT  ST    RE,SAVERE                                                        
         GOTO1 =V(SORTER),DMCB,=C'PUT',CBREC                                    
*                                                                               
         CLI   QOPT5,C'Y'          TEST TRACE INPUT                             
         BNE   SORTPUT2                                                         
*                                                                               
         GOTO1 PRNTBL,DMCB,=C'PUT',CBREC,C'DUMP',CBRECLEN,=C'1D00'              
*                                                                               
SORTPUT2 L     RE,SAVERE                                                        
         BR    RE                                                               
         SPACE                                                                  
SAVERE   DS    F                                                                
         EJECT                                                                  
AMGRTAB  DC    A(MGRTAB)                                                        
NSIMKT   DS    CL3                 EBCDIC RTG SVC MKT CODE                      
ELCDLO   DS    C                                                                
ELCDHI   DS    C                                                                
MGR1MASK DS    H                                                                
MGR2MASK DS    H                                                                
BUYKSAVE DS    XL13                                                             
OFCBLK   DS    XL(OFCLENQ)         BLOCK FOR OFFICER                            
XFF      DC    16X'FF'                                                          
PSLIST   DS    XL256                                                            
QBPRD    DS    X                                                                
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
* ENTRIES BELOW ARE LIST OF SPEC ADDRESSES FOR DATA SPECS *                     
* 3 ENTRIES PER SPEC NUMBER - IN SEQUENCE                                       
         SPACE 1                                                                
HROWS    DS    0A                                                               
         DC    A(HROWOFF,0,0)                                                   
         DC    A(HROWCLT,0,0)                                                   
         DC    A(HROWMGR1,HROWMGR2,HROWMGR3)                                    
         DC    A(HROWMKT,0,0)                                                   
         DC    A(HROWSTA,0,0)                                                   
         DC    A(HROWPGR1,HROWPGR2,0)                                           
         DC    A(HROWPRD,0,0)                                                   
         DC    A(HROWEST,0,0)                                                   
*                                                                               
PROWS    DS    0A                                                               
         DC    A(PROWOFF,0,0)                                                   
         DC    A(PROWCLT,0,0)                                                   
         DC    A(PROWMGR1,PROWMGR2,PROWMGR3)                                    
         DC    A(PROWMKT,0,0)                                                   
         DC    A(PROWSTA,0,0)                                                   
         DC    A(0,0,0)            PRDGRP                                       
         DC    A(PROWPRD,0,0)                                                   
         DC    A(PROWEST,0,0)                                                   
         DC    A(PROWPER,0,0)                                                   
         DC    A(PROWDPT,0,0)                                                   
         DC    A(PROWSLN,0,0)                                                   
*                                                                               
PCOLS    DC    A(COLSPT,0,0)                                                    
         DC    A(COLDOL,COLEQDOL,0)                                             
         DC    A(COLDM1,COLEQDM1,COLCP1)                                        
         DC    A(COLDM2,COLEQDM2,COLCP2)                                        
         DC    A(COLDM3,COLEQDM3,COLCP3)                                        
         DC    A(COLDM4,COLEQDM4,COLCP4)                                        
         SPACE 1                                                                
* DATA SPECS FOR HEADLINE ROWS *                                                
         SPACE 1                                                                
HROWOFF  DC    AL1(SPECOFC,HL,06,02,00),CL6'OFFICE'                             
HROWCLT  DC    AL1(SPECCLT,HL,06,03,24),CL6'CLIENT'                             
HROWMGR1 DC    AL1(SPECMGR1,HL,12,05,24),CL12' '                                
HROWMGR2 DC    AL1(SPECMGR2,HL,12,05,24),CL12' '                                
HROWMGR3 DC    AL1(SPECMGR3,HL,12,05,24),CL12' '                                
HROWMKT  DC    AL1(SPECMKT,HL,06,04,20),CL6'MARKET'                             
HROWSTA  DC    AL1(SPECSTA,HL,07,07,00),CL7'STATION'                            
HROWPGR1 DC    AL1(SPECPGR1,HL,12,04,24),CL12' '                                
HROWPGR2 DC    AL1(SPECPGR2,04,24),CL12' '                                      
HROWPRD  DC    AL1(SPECPRD,HL,07,03,24),CL7'PRODUCT'                            
HROWEST  DC    AL1(SPECEST,HL,08,03,24),CL8'ESTIMATE'                           
         EJECT                                                                  
* DATA SPECS FOR PRINT LINE ROWS/COLUMNS'                                       
         SPACE 1                                                                
PROWOFF  DC    AL1(SPECOFC,PL+CE,06,02,00),CL6'OFFICE'                          
PROWCLT  DC    AL1(SPECCLT,PL+LE,06,03,00),CL6'CLIENT'                          
PROWMGR1 DC    AL1(SPECMGR1,PL+LE,12,05,00),CL12' '                             
PROWMGR2 DC    AL1(SPECMGR2,PL+LE,12,05,00),CL12' '                             
PROWMGR3 DC    AL1(SPECMGR3,PL+LE,12,05,00),CL12' '                             
PROWMKT  DC    AL1(SPECMKT,PL+LE,06,04,20),CL6'MARKET'                          
PROWSTA  DC    AL1(SPECSTA,PL+LE,09,07,00),CL9'STATION'                         
PROWPRD  DC    AL1(SPECPRD,PL+LE,07,03,00),CL7'PRODUCT'                         
PROWEST  DC    AL1(SPECEST,PL+LE,03,03,00),CL3'EST'                             
PROWDPT  DC    AL1(SPECDPT,PL+LE,05,03,00),CL5'DPT  '                           
PROWSLN  DC    AL1(SPECSLN,PL+RI,03,03,00),CL3'SLN'                             
PROWPER  DC    AL1(SPECPER,PL+LE,08,06,00),CL8'PERIOD  '                        
         SPACE 1                                                                
COLSPT   DC    AL1(SPECSPT,PL+RI,05,00,00),CL5'SPOTS'                           
COLDOL   DC    AL1(SPECDOL,PL+RI,10,00,00),CL10'   DOLLARS'                     
COLEQDOL DC    AL1(SPECEQDL,SUPPRESS,0,0,0)                                     
COLDM1   DC    AL1(SPECDM1,PL+RI,07,00,00),CL7' '                               
COLEQDM1 DC    AL1(SPECEQD1,SUPPRESS,0,0,0)                                     
COLCP1   DC    AL1(SPECCP1,PL+RI,07,00,00),CL7'    CPP'                         
COLDM2   DC    AL1(SPECDM2,PL+RI,07,00,00),CL7' '                               
COLEQDM2 DC    AL1(SPECEQD2,SUPPRESS,0,0,0)                                     
COLCP2   DC    AL1(SPECCP2,PL+RI,07,00,00),CL7'    CPP'                         
COLDM3   DC    AL1(SPECDM3,PL+RI,07,00,00),CL7' '                               
COLEQDM3 DC    AL1(SPECEQD3,SUPPRESS,0,0,0)                                     
COLCP3   DC    AL1(SPECCP3,PL+RI,07,00,00),CL7'    CPP'                         
COLDM4   DC    AL1(SPECDM4,PL+RI,07,00,00),CL7' '                               
COLEQDM4 DC    AL1(SPECEQD4,SUPPRESS,0,0,0)                                     
COLCP4   DC    AL1(SPECCP4,PL+RI,07,00,00),CL7'    CPP'                         
         EJECT                                                                  
* SORT RECORDS ARE GENERATED AT END OF STATION,                                 
* SO THIS RECORD DOESN'T NEED OFC/CLT/PGR/PRD/MGR/MKT/STA                       
*                                                                               
         DS    0D                                                               
         DC    CL8'**BFREC*'                                                    
BFREC    DS    0XL80                                                            
*                                                                               
BFPRD    DS    XL1                 PRD CODE                                     
BFEST    DS    XL1                 ESTIMATE                                     
BFDPT    DS    CL3                 DAYPART                                      
BFSLN    DS    XL1                 SPOTLEN                                      
BFPER    DS    XL2                 PERIOD START DATE                            
*                                                                               
BFSPT    DS    F                   SPOTS                                        
BFDOL    DS    F                   GROSS DOLLARS                                
BFDOLEQ  DS    F                                                                
BFDM1    DS    F                   DEMO 1                                       
BFDM1EQ  DS    F                                                                
BFDM2    DS    F                   DEMO 2                                       
BFDM2EQ  DS    F                                                                
BFDM3    DS    F                   DEMO 3                                       
BFDM3EQ  DS    F                                                                
BFDM4    DS    F                   DEMO 4                                       
BFDM4EQ  DS    F                                                                
         SPACE 2                                                                
MGRTAB   DS    2500D                                                            
SPCBWORK DS    250D                                                             
         SPACE 2                                                                
         BUFF  LINES=300,ROWS=1,COLUMNS=11,FLAVOR=BINARY,              X        
               KEYLIST=(8,A)                                                    
*                                                                               
         SPACE 2                                                                
       ++INCLUDE SPREPCBWRK                                                     
         PRINT OFF                                                              
       ++INCLUDE SPREPWORKD                                                     
       ++INCLUDE SPREPMODES                                                     
       ++INCLUDE SPMEDBLOCK                                                     
       ++INCLUDE DDBUFFALOD                                                     
       ++INCLUDE DDOFFICED                                                      
CLTHDRD  DSECT                                                                  
       ++INCLUDE SPGENCLT                                                       
STARECD  DSECT                                                                  
       ++INCLUDE SPGENSTA                                                       
BUYRECD  DSECT                                                                  
       ++INCLUDE SPGENBUY                                                       
DBLOCKD  DSECT                                                                  
       ++INCLUDE DEDBLOCK                                                       
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'023SPREPCB02A10/18/05'                                      
         END                                                                    
