*          DATA SET ACAPG      AT LEVEL 031 AS OF 05/01/02                      
*CATALP APG                                                                     
         TITLE 'APG - ACCPAK PROGRAM GENERATOR'                                 
         PRINT NOGEN                                                            
APG      CSECT                                                                  
         NBASE 0,**APG***,=V(REGSAVE),R8,R7,R9                                  
         L     R2,0(R1)                                                         
         CLC   2(6,R2),=C'NOSTAT'                                               
         BE    *+8                                                              
         MVI   STAT,C'Y'                                                        
         CLC   2(7,R2),=C'NOPLIST'                                              
         BNE   LRA                                                              
         MVI   STAT,C'N'                                                        
         MVI   PNTOFF,C'Y'                                                      
LRA      L     RA,=V(CPRINT)                                                    
         USING DPRINT,RA                                                        
         MVC   TITLE(18),=C'APG SOURCE LISTING'                                 
         MVC   SUB1(17),=C'SOURCE STATEMENTS'                                   
         MVC   SUB2(17),=C'-----------------'                                   
         MVC   SUB1+72(8),=C'SEQ  LVL'                                          
         MVC   SUB2+72(8),=C'---  ---'                                          
         MVC   SUB1+85(15),=C'DETECTED ERRORS'                                  
         MVC   SUB2+85(15),=C'---------------'                                  
         OPEN  (ASMFIL,(OUTPUT))                                                
         OPEN  (LNKFIL,(OUTPUT))                                                
         EJECT                                                                  
**********************************************************************          
*              MAIN LOGIC FLOW                                       *          
**********************************************************************          
         SPACE 1                                                                
READ     GOTO1 =V(CARDS),PARAS,P,=C'RE00'                                       
         CLC   P(2),=C'/*'         CHECK IF EOD                                 
         BE    LAST                  IF SO PRINT OUT CLOSING AND EXIT           
         ZAP   PN,=P'1'                                                         
         MVC   UPN,=C'01'                                                       
         MVI   ERSW,C'0'                                                        
         CLC   P(4),=C'PAN='       DID USER SPECIFY A PAN BOOK                  
         BNE   READ4                                                            
         MVC   BOMB,P+79           SAVE TEST IND                                
         MVC   PANNAME,P+4                                                      
         GOTO1 =V(PANIC),PARAS,(X'80',=C'READ'),=C'PAN',PANNAME,C               
         TM    PARAS+8,X'10'       X'10'-COND. NAME NOT IN LIBRARY              
         BNO   READ1               IF NAME IS IN LIBRARY CONTINUE               
         MVC   P+85(23),=C'PAN-NAME NOT IN LIBRARY'                             
         GOTO1 =V(PRINTER)               ELSE PRINT OUT MESSAGE                 
         B     READ                      AND LOOP BACK                          
*                                                                               
READ1    MVC   P(80),C                                                          
*                                                                               
READ2    BAS   RE,DATA             LOOP ROUND PAN BOOK                          
         GOTO1 =V(PRINTER)                                                      
         GOTO1 =V(PANIC),PARAS,(X'80',=C'READ'),=C'PAN',PANNAME,P               
         CLC   P(2),=C'/*'         CHECK IF EOD                                 
         BNE   READ2               IF NOT LOOP BACK TO GET NEXT LINE            
         B     READ                  ELSE BRANCH TO BEGINNING                   
*                                                                               
READ4    BAS   RE,DATA             DATA CARDS SUBMITTED DIRECT                  
         GOTO1 =V(PRINTER)         PRINT OUT DATA                               
         B     READ                BRANCH BACK TO BEGINNING                     
         EJECT                                                                  
*                                                                               
*              CLOSING STATEMENTS                                               
*                                                                               
LAST     LA    R2,ENDSTACK         R2 = A(ENDSTACK)                             
         CLI   ERSW,C'1'           CHECK IF ERRORS WERE FOUND                   
         BNE   NOER                IF NONE SEND DATA TO OUTPUT                  
         MVC   P(2),=C'  '                                                      
         GOTO1 =V(PRINTER)                                                      
         MVC   P(23),=C'*** ERROR(S) FOUND ***'                                 
         GOTO1 =V(PRINTER)                                                      
         GOTO1 =V(PRINT),PARAS,=C'CLOSE'                                        
         LA    R6,16               SETTING R6 FOR EXIT                          
         XBASE RC=(R6)             EXIT                                         
*                                                                               
NOER     BAS   RE,MULTI                                                         
         GOTO1 =V(PRINT),PARAS,=C'CLOSE'                                        
         PUT   LNKFIL,BEGPH                                                     
         CLOSE (ASMFIL,)           CLOSE FILES                                  
         CLOSE (LNKFIL,)           CLOSE FILES                                  
         XBASE                     EXIT                                         
         EJECT                                                                  
**********************************************************************          
*              CONTROL THE DATA VALIDATION - SPECIAL CARDS           *          
**********************************************************************          
         SPACE 1                                                                
DATA     NTR1                                                                   
         LH    RF,LINENUM                                                       
         AHI   RF,1                                                             
         STH   RF,LINENUM                                                       
         CHI   RF,2                                                             
         BNE   DATA1                                                            
         CLC   P(4),=C'*APG'               FIRST CARD FOR PANAPT                
         BE    XIT                                                              
         MVC   P,SPACES                                                         
         MVC   P+3(33),=C'MISSING "*APG" FOR PANAPT CONTROL'                    
         GOTO1 =V(PRINTER)                                                      
         MVI   ERSW,C'1'                                                        
         B     XIT                                                              
*                                                                               
DATA1    CLI   P,C'*'                      CHECK 1ST LINE FOR COMMENT           
         BE    XIT                         IF COMMENT EXIT SUB.                 
         CLC   P(15),=C'         TITLE '   TITLE                                
         BNE   DATA2                       BRANCH TO NEXT CHECK                 
         MVI   TITLE+19,C'*'               MOVE '*' INTO TITLE LINE             
         MVC   TITLE+21(50),P+15           MOVE TITLE INTO TITLE LINE           
         MVC   P,SPACES                    CLEAR P                              
         B     XIT                                                              
*                                                                               
DATA2    CLC   P(15),=C'         SPACE '   CHECK IF LINE IS A SKIP              
         BNE   DATA6                       IF NOT BRANCH TO NEXT CHECK          
         ZIC   R2,P+15                     ZIC LENGTH OF SPACING IN R2          
         SLL   R2,28                       WEED OUT UNDESIRABLE LENGTHS         
         SRL   R2,28                         BY SHIFTING R2                     
         MVC   P,SPACES                    CLEAR P                              
         BCT   R2,*+8                                                           
         B     XIT                         EXIT IF R2 = 0                       
         SLL   R2,28                                                            
         SRL   R2,28                                                            
*                                                                               
DATA4    GOTO1 =V(PRINTER)                 PRINT OUT DATA                       
         BCT   R2,DATA4                                                         
         B     XIT                         EXIT IF R2 = 0                       
*                                                                               
DATA6    CLC   P(15),=C'         EJECT '                                        
         BNE   DATA8                                                            
         MVC   P,SPACES                    CLEAR P                              
         ZAP   LINE,=P'75'                                                      
         B     XIT                         EXIT                                 
*                                                                               
DATA8    CLC   P(9),=C'TRACE=YES'          CHECK IF LINE IS TRACE               
         BNE   DATA10                      START LOOKING FOR COMMANDS           
         MVI   TRACOPT,C'Y'                  ELSE SET TRACOPT TO 'Y'            
         B     XIT                         EXIT                                 
         EJECT                                                                  
*                                                                               
*              SCAN FOR RECOGNIZED COMMAND                                      
*                                                                               
DATA10   L     R2,=A(COMTABLE)     R2 = A(COMTABLE)                             
         L     R3,=A(OUTTAB)       R3 = A(OUTABLE)                              
*                                                                               
DATA12   CLC   P(8),0(R2)          LOOK FOR COMMAND                             
         BE    DATA14              IF FOUND START EXTRACTING DATA               
         CLC   P+9(5),0(R2)        LOOK FOR COMMAND                             
         BE    DATA14                                                           
         LA    R2,12(R2)           IF NOT BUMP R2 TO NEXT COMMAND               
         LA    R3,60(R3)           BUMP R3 TO NEXT LINE                         
         CLI   0(R2),X'FF'         CHECK IF EOD                                 
         BNE   DATA12              IF NOT LOOP BACK TO CHECK NEXT LINE          
         B     ER2                   ELSE BRANCH TO ERROR ROUTINE               
*                                                                               
DATA14   MVC   D,SPACES                 FILL IN PRELIMINARY CARD                
         MVC   D+9(10),=C'DC    AL1('   SET CONSTANSTS                          
         MVC   D+19(60),0(R3)           FILL IN REMAINING STATEMENT             
         L     RF,8(R2)                 AND GO TO SPECIAL ROUTINES              
         BR    RF                       RF=ROUTINE ASSOCIATED W/COMMAND         
*                                                                               
DATAPUT  BAS   RE,PUT              BRANCH TO SUB TO PRINT DATA                  
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*              INDIVIDUAL ROUTINES                                              
*                                                                               
DATA20   CLI   P+13,C' '              PHASE MUST HAVE A LETTER 09/05/00         
         BNH   ER30                                                             
         MVC   BEGPH+11(5),P+9        PHASE  COMPLETE PHASE                     
         MVC   BEGCS+2(5),P+9                AND CSECT                          
         MVC   P+15(48),=C'(MODULE MUST BE EXECUTED WITH P=     IN RQ CX        
               ARD)'                                                            
         MVC   P+47(2),P+9              MOVE 1ST 2 CHARS. OF PHASE NAME         
         MVC   P+49(2),P+13             MOVE LAST CHAR OF PHASE NAME            
         MVC   P+85(10),=C'<---- NOTE'  MOVE LITERAL TO MAKE NOTE               
         CLI   P+14,C' '                     CAN BE A 6-CHARACTER NAME          
         BE    DATA21                                                           
         MVC   BEGPH+11(6),P+9        MOVE PHASE NAME INTO BEGPH                
         MVC   BEGPH+17(3),=C'(R)'    MOVE IN LITERAL                           
*                                                                               
DATA21   LA    R2,BEGSTACK         R2 = A(BEGSTACK)                             
         BAS   RE,MULTI                                                         
         CLI   PNTOFF,C'Y'                                                      
         BNE   XIT                                                              
         MVC   D,SPACES                                                         
         MVC   D+9(9),=C'PRINT OFF'                                             
         MVC   D+35(23),=C'INVOKED BY PARM=NOPLIST'                             
         B     PUT3                                                             
*                                                                               
DATA22   LA    R3,D+28             SYSNAME                                      
         LA    R4,2                                                             
         B     DATALIT                                                          
*                                                                               
DATA23   MVC   D+28(2),P+9         CONLEDG ROWLIST                              
         MVC   D+30(2),P+15                                                     
         B     DATAPUT                                                          
*                                                                               
DATA23A  MVC   D+29(1),P+9         OFFSEC    VALUES=N,E,C OR B                  
         B     DATAPUT                                                          
*                                                                               
DATA24   MVC   D+28(2),P+9         READ      UNIT/LEDGER                        
         MVC   RLCO,=C'00'                                                      
         CLC   P+9(4),=C'LIST'                                                  
         BE    DATA25                                                           
         CLC   P+9(3),=C'XC='                                                   
         BNE   DATA24A                                                          
         MVC   RLCO,P+12                                                        
         B     DATA25                                                           
*                                                                               
DATA24A  L     RF,=A(PLAINRD)                                                   
         MVC   D+19(26),0(RF)                                                   
         MVC   D+28(2),P+9                                                      
         CLI   P+15,C'D'           DEFAULT BUCKETS                              
         BNE   *+12                                                             
         MVI   D+30,C'D'           CAN BE DETAILS                               
         B     DATAPUT                                                          
         CLI   P+15,C'*'           OR BOTH                                      
         BNE   *+8                                                              
         MVI   D+30,C'*'                                                        
         B     DATAPUT                                                          
*                                                                               
DATA25   MVI   D+20,C'5'           READ LIST                                    
         MVC   SCAN,SPACES                                                      
         MVC   SCAN(50),P+15                                                    
         GOTO1 =V(SCANNER),PARA,(C'C',SCAN),(16,BLOCK),0                        
*&&US*&& LA    R2,D+34                                                          
*&&UK*&& LA    R2,D+28                                                          
         LA    R4,BLOCK                                                         
         ZIC   R3,PARA+4                                                        
         LTR   R3,R3                                                            
         BZ    ER8                                                              
         LR    R1,R3               ADJUST LENGTH (NX3)+3                        
         MHI   R1,3                                                             
*&&US*&& LA    R1,3(R1)                                                         
*&&UK*&& LA    R1,2(R1)                                                         
         EDIT  (R1),(2,D+22),FILL=0                                             
*                                                                               
DATA25B  MVC   0(3,R2),12(R4)      MOVE IN LIST OF READS                        
         LA    R2,3(R2)                                                         
         MVI   0(R2),C''''                                                      
         LA    R4,32(R4)                                                        
         BCT   R3,DATA25B                                                       
*&&US*&& MVC   D+28(2),RLCO                                                     
         B     DATAPUT                                                          
*                                                                               
DATA26   MVC   D+28(1),P+9         BASIS     BROADCAST OR CALENDAR              
         CLI   P+9,C'?'            WHAT TO BASE S/L QUESTION MARKS ON           
         BNE   DATA26A                                                          
         MVC   D+28(1),P+10        STORE START OR END DATE INDICATOR            
         CLI   D+28,C'E'           END DATE                                     
         BE    DATA26A                                                          
         CLI   D+28,C'S'           START DATE                                   
         BE    DATA26A                                                          
         B     ER28                                                             
*                                                                               
DATA26A  CLI   P+15,C' '                                                        
         BE    *+10                                                             
         MVC   D+35(1),P+15        AND FORMULA # 0-9                            
         B     DATAPUT                                                          
*                                                                               
DATA27   MVC   D+28(8),P+9         HOOKLOAD MOVE IN PHASE NAME                  
         B     DATAPUT                                                          
*                                                                               
DATA28   LA    R2,P+9              REPORT/COPIES/SPACING                        
*                                                                               
DATA29   BAS   RE,VALNUM           BRANCH TO SUB TO VALIDATE NUMBER             
         BNE   ER8                                                              
         CLC   =C'SPACING',P                                                    
         BNE   DATA290                                                          
         MVC   D+28(2),=C'00'                                                   
         CLI   P+15,C' '           COMPARE P AT POSITION TO SPACE               
         BE    DATA290               TO FIND THE LENGTH OF THE FIELD            
         CLC   =C'SKIP',P+15                                                    
         BE    DATA2901                                                         
         CLI   P+16,C' '                                                        
         BE    PK1                 IF LENGTH IS 1 BYTE BRANCH TO PK1            
         PACK  WK29(2),P+15(2)       ELSE PACK 2 BYTE FIELD INTO WK29           
         B     DED29                 AND THEN BRANCH TO EDIT RESULT             
*                                                                               
PK1      PACK  WK29(2),P+15(1)                                                  
*                                                                               
DED29    EDIT  (P2,WK29),(2,D+28),FILL=0                                        
         B     DATA290                                                          
*                                                                               
DATA2901 MVC   D+28(2),=C'99'                                                   
*                                                                               
DATA290  EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         CLI   NUMBER,100                                                       
         BL    DATA29A                                                          
         EDIT  (1,NUMBER),(3,D+25),FILL=0                                       
         CLC   =C'SPACING',P                                                    
         BNE   DATA291                                                          
         MVI   D+30,C')'                                                        
         B     DATA29A                                                          
*                                                                               
DATA291  MVI   D+28,C')'                                                        
*                                                                               
DATA29A  CLC   =C'REPORT',P        IF REPORT CHECK NUMERICAL SEQUENCE           
         BNE   DATAPUT             IF NOT REPORT BRANCH TO OUTPUT DATA          
         MVI   THATCOL,X'01'                                                    
         MVI   THATROW,X'01'                                                    
         CLC   UPN,D+25                                                         
         BE    DATA29B                                                          
         BAS   RE,ADDN                                                          
         B     ER20                                                             
DATA29B  BAS   RE,ADDN                                                          
         B     DATAPUT                                                          
*                                                                               
DATA30   MVC   D+28(2),P+9         REPCODE                                      
         B     DATAPUT                                                          
*                                                                               
DATA32   LA    R3,D+28             REPNAME                                      
         LA    R4,2                                                             
         B     DATALIT                                                          
*                                                                               
DATA34   LA    R2,P+9              IGNORE/FILTER                                
         BAS   RE,VALCON                                                        
         BNE   ER4                                                              
         EDIT  (1,CONCODE),(2,D+25),FILL=0                                      
         CLC   P+15(2),SPACES      MAY BE A SYS/LEDG COND                       
         BE    DATAPUT                                                          
         MVI   D+23,C'5'           ADJUST LENGTH                                
         MVC   D+28(6),=C',C''XX'' '                                            
         MVC   D+31(2),P+15                                                     
         B     DATAPUT                                                          
*                                                                               
DATA36   LA    R2,OPTLIST          OPTIONS                                      
         LA    R3,1                                                             
*                                                                               
DATA38   CLI   0(R2),X'FF'         CHECK OPTION LIST                            
         BE    ER6                                                              
         CLC   0(10,R2),P+15                                                    
         BE    DATA40                                                           
         LA    R2,10(R2)                                                        
         LA    R3,1(R3)                                                         
         B     DATA38                                                           
*                                                                               
DATA40   EDIT  (R3),(2,D+25),FILL=0                                             
         B     DATAPUT                                                          
*                                                                               
*        RECAP/FDOWN                                                            
*                                                                               
DATA41   LA    R2,P+9              RECAP REPORT N AT LEVEL N                    
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         CLC   =C'04',D+22         LENGTH 04 (RECAP) OR 05 (FDOWN)              
         BNE   DATAPUT                                                          
         LA    R2,P+15                                                          
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
         B     DATAPUT                                                          
*                                                                               
*              FISCAL/ROUND/ENCROACH/MODEHOOK                                   
*                                                                               
DATA43   TM    P+9,X'F0'           ONE CHARACTER NUMERIC                        
         BNO   ER8                                                              
         SR    RF,RF                                                            
         CLI   P+10,C' '           OR TWO CHARACTER NUMERIC                     
         BE    *+16                                                             
         TM    P+10,X'F0'                                                       
         BNO   ER8                                                              
         LA    RF,1                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         PACK  DUB,P+9(0)                                                       
         CVB   R3,DUB                                                           
         MVC   D+31(1),P+15                                                     
         MVI   D+32,C''''                                                       
         B     DATA40              GO EDIT LIKE AN OPTION                       
*&&UK                                                                           
DATA48   CLC   P+9(2),SPACES                                                    
         BE    *+10                                                             
         MVC   D+25(2),P+9         DISP INTO ACCOUNT                            
         CLC   P+15(2),SPACES                                                   
         BE    *+10                                                             
         MVC   D+28(2),P+15        LENGTH OF CONTROL BREAK                      
         B     DATAPUT                                                          
*&&                                                                             
         EJECT                                                                  
*                                                                               
*              HANDLE ROW AND ROWNAME                                           
*                                                                               
DATA42   CLC   P+9(3),=C'EQU'      ROW EQU N                                    
         BNE   DATA44                                                           
         MVC   D+15(13),=C'AL1(34,03,NN)'                                       
         LA    R2,P+15                                                          
         MVC   D+28(52),SPACES                                                  
         B     DATA29                                                           
*                                                                               
DATA44   LA    R2,P+9              ROW NNN FROM                                 
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         ZIC   R1,THATROW                                                       
         LA    R1,1(R1)                                                         
         STC   R1,THATROW                                                       
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         LA    R2,P+15                                                          
         BAS   RE,VALIFROM                                                      
         BNE   ER10                                                             
         EDIT  (1,FROM),(2,D+28),FILL=0                                         
         EDIT  (1,DISP),(2,D+31),FILL=0                                         
         EDIT  (1,LNTH),(2,D+34),FILL=0                                         
         CLC   FROMCON,SPACES      MAY BE A SYS/LEDG COND.                      
         BE    DATAPUT                                                          
         MVI   D+23,C'8'                                                        
         MVC   D+37(6),=C',C''XX'' '                                            
         MVC   D+40(2),FROMCON                                                  
         B     DATAPUT                                                          
*                                                                               
DATA46   BAS   RE,VALILINE         ROWCODE/ROWNAME/ROWBOTH                      
         BNE   ER12                                                             
         EDIT  (1,LINO),(2,D+28),FILL=0                                         
         EDIT  (1,DISP),(2,D+31),FILL=0                                         
         MVC   C,SPACES                                                         
         MVC   C+9(8),=C'DC    C'''                                             
         MVI   BKSW,C'B'                                                        
         LA    R3,C+17                                                          
         LA    R4,5                                                             
         BAS   R6,DATALIT                                                       
         BAS   RE,PUT                                                           
         MVI   BKSW,C' '                                                        
         MVC   D,C                                                              
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              HANDLE COLUMN EXPRESSIONS                                        
*                                                                               
DATA50   CLC   P+9(3),=C'ALL'               ALL                                 
         BNE   DATA52                                                           
         MVC   D+15(65),SPACES                                                  
         MVC   D+15(16),=C'AL1(46,04,00,00)'                                    
         LA    R2,P+15                                                          
         BAS   RE,VALIKEY                                                       
         BNE   ER14                                                             
         EDIT  (1,KEYTYPE),(2,D+25),FILL=0                                      
         EDIT  (1,KEYCODE),(2,D+28),FILL=0                                      
         B     DATAPUT                                                          
*                                                                               
DATA52   CLC   P+9(3),=C'EQU'                EQU                                
         BNE   DATA54                                                           
         MVC   D+15(65),SPACES                                                  
         MVC   D+15(13),=C'AL1(44,03,00)'                                       
         LA    R2,P+15                                                          
         B     DATA29                                                           
*                                                                               
DATA54   LA    R2,P+9                        COLUMN NUMBER                      
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         MVC   THISCOL,NUMBER                                                   
         CLC   THATCOL,NUMBER                                                   
         BNE   ER25                                                             
         ZIC   R1,THATCOL                                                       
         LA    R1,1(R1)                                                         
         STC   R1,THATCOL                                                       
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         MVC   SCAN,SPACES                   SCAN FOR UP TO 4 KEYWORDS          
         MVC   SCAN(40),P+15                                                    
         CLC   SCAN,SPACES         MAY BE NONE AT ALL                           
         BE    DATAPUT                                                          
         CLC   SCAN(2),=C'W='      MAY BE PRECEEDED BY WIDTH                    
         BNE   DATA55                                                           
         MVC   DUB,SPACES                                                       
         MVC   DUB(2),SCAN+2       ASSUME  W=NN,                                
         MVC   SCAN(40),P+20                                                    
         CLI   DUB+1,C','          BUT MAY BE W=N,                              
         BNE   *+14                                                             
         MVI   DUB+1,C' '                                                       
         MVC   SCAN(40),P+19                                                    
         LA    R2,DUB                                                           
         BAS   RE,VALNUM                                                        
         CLI   NUMBER,1                                                         
         BL    ER14                                                             
         CLI   NUMBER,16                                                        
         BH    ER14                                                             
*MN      EDIT  (1,NUMBER),(2,D+52),FILL=0                                       
         EDIT  (1,NUMBER),(2,D+56),FILL=0                                       
         CLC   SCAN,SPACES                                                      
         BE    DATAPUT                                                          
*                                                                               
DATA55   GOTO1 =V(SCANNER),PARA,(C'C',SCAN),(4,BLOCK),0                         
         ZIC   R3,PARA+4                                                        
         LTR   R3,R3                                                            
         BZ    ER14                                                             
         LA    R2,BLOCK+12                                                      
         LA    R4,D+28                                                          
*                                                                               
DATA56   BAS   RE,VALIKEY                                                       
         BNE   ER14                                                             
         EDIT  (1,KEYTYPE),(2,0(R4)),FILL=0                                     
*MN      EDIT  (1,KEYCODE),(2,3(R4)),FILL=0                                     
         EDIT  (1,KEYCODE),(3,3(R4)),FILL=0                                     
         CLI   KEYTYPE,9           IF ITS A BUDGET                              
         BNE   DATA58                                                           
         CLI   KEYCODE,KWBG1                                                    
         BL    DATA58                                                           
         CLI   KEYCODE,KWBG9                                                    
         BH    DATA58                                                           
         CLC   P+15(2),=C'W='      UNLESS LENGTH WAS OVERRIDDEN                 
         BE    DATA58                                                           
         MVC   D+52(2),=C'10'      DEFAULT LENGTH IS 10                         
*                                                                               
DATA58   LA    R2,32(R2)                                                        
*MN      LA    R4,6(R4)                                                         
         LA    R4,7(R4)                                                         
         BCT   R3,DATA56                                                        
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              CONDITIONALS                                                     
*                                                                               
DATA60   LA    R2,P                          CONDITION NUMBER                   
         CLC   P(8),SPACES                                                      
         BE    DATA61                                                           
         BAS   RE,VALCON                                                        
         BNE   ER4                                                              
         MVC   THISCON,CONCODE                                                  
*                                                                               
DATA61   LA    R2,CONLIST                                                       
*                                                                               
DATA62   EDIT  (1,THISCON),(2,D+25),FILL=0                                      
         MVC   SCAN,SPACES                                                      
         MVC   SCAN(30),P+15                                                    
         MVC   PARA+8(4),=C',=,='                                               
         MVC   PARA+11(1),0(R2)              MOVE IN SEPARATOR                  
         GOTO1 =V(SCANNER),PARA,(C'C',SCAN),(1,BLOCK)                           
         CLI   PARA+4,1                                                         
         BNE   DATA62B                       SPLIT CONDITION AND VALUE          
         CLI   BLOCK+1,0                                                        
         BNE   DATA63                                                           
*                                                                               
DATA62B  LA    R2,1(R2)                      TRY NEXT SEPARATOR                 
         CLI   0(R2),X'FF'                                                      
         BNE   DATA62                                                           
         B     ER4                                                              
*                                                                               
DATA63   MVC   CONFOUND,0(R2)                                                   
         LA    R2,BLOCK+12                                                      
         BAS   RE,VALIFROM                                                      
         BNE   ER10                                                             
         EDIT  (1,FROM),(2,D+28),FILL=0                                         
         EDIT  (1,DISP),(2,D+31),FILL=0                                         
         EDIT  (1,LNTH),(2,D+34),FILL=0                                         
         CLI   FROM,FRST                                                        
         BL    DATA631                                                          
         CLI   FROM,FRTY                                                        
         BH    DATA631                                                          
         MVC   MYWK(2),=C'01'                                                   
         CLI   SVSG,C'-'                                                        
         BE    D63                                                              
         MVC   MYWK(2),=C'02'                                                   
*                                                                               
D63      BAS   RE,D63A                                                          
         MVC   D+34(2),MYWK                                                     
         EDIT  (R1),(2,D+31),FILL=0                                             
*                                                                               
DATA631  LA    R2,BLOCK+22                                                      
         MVC   BLOCK+32(16),SPACES INSURANCE                                    
         MVC   D+40(1),CONFOUND    PUT IN THE SEPARATOR                         
         LA    R3,D+41                                                          
         LA    R4,7                                                             
         CLI   BLOCK+22,C'&&'      AMPERSAND INDICATES SOFT CONDITION           
         BE    DATA63A                                                          
         CLI   FROM,FRTT           TRANS TYPE "ISN'T" DECIMAL                   
         BNE   DATALIT2              ("AIN'T" AIN'T NO GOOD ENGLISH)            
         MVC   0(6,R3),=C''',AL1('   SO MAKE IT A HEX LITERAL                   
         LA    R3,6(R3)                                                         
         B     DATALIT2                                                         
*                                                                               
DATA63A  MVC   D+22(2),=C'11'      THESE ARE LENGTH 11                          
         MVI   D+41,C''''                                                       
         MVC   D+42(17),=C',AL1(00,F2,D2,00)'                                   
         LA    R2,BLOCK+23         VALIDATE SECOND FROM                         
         XC    NUMBER2,NUMBER2                                                  
         BAS   RE,VALIFROM                                                      
         BNE   ER10                                                             
         EDIT  (1,FROM),(2,D+50),FILL=0                                         
         EDIT  (1,DISP),(2,D+53),FILL=0                                         
         MVC   D+56(2),D+34                                                     
         CLI   FROM,FRST                                                        
         BL    DATAPUT                                                          
         CLI   FROM,FRTY                                                        
         BH    DATAPUT                                                          
         MVC   MYWK(2),=C'01'                                                   
         CLI   SVSG,C'-'                                                        
         BE    D63B                                                             
         MVC   MYWK(2),=C'02'                                                   
*                                                                               
D63B     BAS   RE,D63A                                                          
         MVC   D+56(2),MYWK                                                     
         EDIT  (R1),(2,D+53),FILL=0                                             
         B     DATAPUT                                                          
*                                                                               
D63A     LH    R1,NUMBER2                                                       
         PACK  DUB,MYWK(2)                                                      
         CH    R1,=H'300'                                                       
         BL    D63A1                                                            
         SH    R1,=H'300'                                                       
         AP    DUB,=P'48'                                                       
         B     D63A3                                                            
*                                                                               
D63A1    CH    R1,=H'200'                                                       
         BL    D63A2                                                            
         AP    DUB,=P'32'                                                       
         SH    R1,=H'200'                                                       
         B     D63A3                                                            
*                                                                               
D63A2    CH    R1,=H'100'                                                       
         BLR   RE                                                               
         AP    DUB,=P'16'                                                       
         SH    R1,=H'100'                                                       
D63A3    UNPK  MYWK(2),DUB                                                      
         MVZ   MYWK+1(1),=X'F0'                                                 
         BR    RE                                                               
         EJECT                                                                  
*                                                                               
*              COLNAME                                                          
*                                                                               
DATA64   LA    R2,P+9              COLUMN NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         CLC   THISCOL,NUMBER                                                   
         BNE   ER24                                                             
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         MVC   SCAN,SPACES                                                      
         MVC   SCAN(38),P+15                                                    
         LA    R1,SCAN                                                          
         LA    R0,38                                                            
*                                                                               
DATA66   CLI   0(R1),C' '          TURN IMBEDDED SPACES INTO ZEROS              
         BNE   DATA68                                                           
         CLC   0(20,R1),SPACES                                                  
         BE    DATA68                                                           
         MVI   0(R1),0                                                          
*                                                                               
DATA68   LA    R1,1(R1)                                                         
         BCT   R0,DATA66                                                        
         GOTO1 =V(SCANNER),PARA,(C'C',SCAN),(3,BLOCK),0                         
         MVI   D+67,C''''                                                       
         ZIC   R3,PARA+4                                                        
         LTR   R3,R3                                                            
         BZ    DATAPUT                                                          
         LA    R4,BLOCK                                                         
         LA    R5,D+31                                                          
*                                                                               
DATA70   MVC   0(12,R5),12(R4)   PICK OUT UP TO 3 DESCRIPTORS                   
*&&UK                                                                           
         LA    RF,12(R4)                                                        
         LA    RE,12                                                            
DATA71   CLC   0(2,RF),=C''''''                                                 
         BNE   *+8                                                              
         LA    R5,1(R5)                                                         
         LA    RF,1(RF)                                                         
         BCT   RE,DATA71                                                        
*&&                                                                             
         LA    R4,32(R4)                                                        
         LA    R5,12(R5)                                                        
         BCT   R3,DATA70                                                        
*&&UK                                                                           
         LA    RE,D+67                                                          
         CR    R5,RE                                                            
         BNL   *+12                                                             
         LA    R5,12(R5)                                                        
         B     *-10                                                             
         MVI   0(R5),C''''         REPLACE TERMINAL DINK                        
*&&                                                                             
         LA    R1,D+31                                                          
         LA    R0,36                                                            
*                                                                               
DATA72   CLI   0(R1),0                                                          
         BNE   *+8                                                              
         B     *+12                                                             
         CLI   0(R1),C'?'         QUESTION MARKS GENERATE BLANKS                
         BNE   *+8                                                              
         MVI   0(R1),C' '                                                       
         LA    R1,1(R1)                                                         
         BCT   R0,DATA72                                                        
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              CHUNK ROUTINE                                                    
*                                                                               
DATA74   MVC   SCAN,SPACES                                                      
         MVC   SCAN(5),P+9                                                      
         GOTO1 =V(SCANNER),PARA,(C'C',SCAN),(3,BLOCK),0                         
         CLI   PARA+4,2                                                         
         BNE   ER16                                                             
         L     R1,BLOCK+4                                                       
         LTR   R1,R1                                                            
         BZ    ER16                                                             
         EDIT  (R1),(2,D+25),FILL=0                                             
         L     R1,BLOCK+36                                                      
         LTR   R1,R1                                                            
         BZ    ER16                                                             
         EDIT  (R1),(2,D+28),FILL=0                                             
         CLC   BLOCK+4(4),BLOCK+36                                              
         BNL   ER16                                                             
         LA    R3,D+34                                                          
         LA    R4,4                                                             
         B     DATALIT                                                          
         EJECT                                                                  
*                                                                               
*              HANDLE COLCOMP EXPRESSIONS                                       
*                                                                               
DATA80   LA    R2,P+9              COLUMN NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         CLC   THISCOL,NUMBER                                                   
         BNE   ER24                                                             
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         BAS   RE,PUT                                                           
         MVC   D+19(40),=C'000,000,000,000,000,000,000,000,000,000)'            
         MVC   SCAN,SPACES                                                      
         MVC   SCAN(40),P+15                                                    
         GOTO1 =V(SCANNER),PARA,(C'C',SCAN),(9,BLOCK),0                         
         TM    PARA+4,X'01'                                                     
         BNO   ER18                MUST BE ODD NUMBER OF OPERANDS               
         LA    R4,BLOCK                                                         
         ZIC   R3,PARA+4                                                        
         LA    R5,D+19                                                          
         B     DATA84                                                           
*                                                                               
DATA82   BAS   RE,VALIOP                                                        
         BNE   ER18                                                             
         EDIT  (1,NUMBER),(3,0(R5)),FILL=0                                      
         LA    R4,32(R4)                                                        
         LA    R5,4(R5)                                                         
         BCTR  R3,0                                                             
*                                                                               
DATA84   BAS   RE,VALICOL                                                       
         BNE   ER18                                                             
         EDIT  (1,NUMBER),(3,0(R5)),FILL=0                                      
         LA    R4,32(R4)                                                        
         LA    R5,4(R5)                                                         
         BCT   R3,DATA82                                                        
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              HANDLE BUDGET EXPRESSION                                         
*                                                                               
DATA90   LA    R2,P+9                                                           
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         LA    R2,P+15                                                          
         BAS   RE,VALNUM                                                        
         BNE   DATA92                                                           
         EDIT  (1,NUMBER),(3,D+34),FILL=0                                       
         B     DATAPUT                                                          
*                                                                               
DATA92   MVC   D+41(10),P+15                                                    
         B     DATAPUT                                                          
*                                                                               
*              HANDLE NOTOT, NOROLL AND REVEDIT EXPRESSIONS                     
*                                                                               
DATA94   CLC   =C'NOROLL',P                                                     
         BE    DATA94B                                                          
         CLC   =C'KEYCOL',P                                                     
         BE    DATA94B                                                          
         CLC   =C'SECCOL',P                                                     
         BE    DATA94B                                                          
         CLC   =C'OVRCOL',P                                                     
         BE    DATA94B                                                          
         CLC   =C'STOP',P                                                       
         BE    DATA94B                                                          
*                                                                               
DATA94A  LA    R2,P+9                                                           
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
DATA94B  CLC   P+15(30),SPACES                                                  
         BE    DATAPUT                                                          
         MVC   SCAN,SPACES                                                      
         MVC   SCAN(40),P+15                                                    
         GOTO1 =V(SCANNER),PARA,(C'C',SCAN),(16,BLOCK),0                        
         LA    R4,BLOCK                                                         
         ZIC   R3,PARA+4                                                        
         LTR   R3,R3                                                            
         BZ    ER8                                                              
         LA    R1,3(R3)            ADJUST LENGTH TO N+3                         
         EDIT  (R1),(2,D+22),FILL=0                                             
         LA    R5,D+27                                                          
*                                                                               
DATA96   L     R1,4(R4)            VALIDATE COLUMNS                             
         LTR   R1,R1                                                            
         BZ    ER8                                                              
         CH    R1,=H'99'           SPECIAL (ALL COLUMNS)                        
         BE    *+8                                                              
         CH    R1,=H'32'           MUST BE 1-32                                 
         BH    ER8                                                              
         MVI   0(R5),C','                                                       
         EDIT  (R1),(2,1(R5)),FILL=0                                            
         MVI   3(R5),C')'                                                       
         LA    R4,32(R4)                                                        
         LA    R5,3(R5)                                                         
         BCT   R3,DATA96                                                        
         B     DATAPUT                                                          
*                                                                               
DATA100  LA    R2,P+9                                                           
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         LA    R2,P+15                                                          
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
         CLI   P,C'F'                                                           
         BE    OT10                                                             
         CLI   NUMBER,X'0A'                                                     
         BL    OT9                                                              
         MVC   D+37(32),P+18                                                    
         B     *+10                                                             
*                                                                               
OT9      MVC   D+37(32),P+17                                                    
         MVI   D+69,C''''                                                       
         B     DATAPUT                                                          
OT10     BAS   RE,PUT                                                           
         MVC   D+9(8),=C'DC    C'''                                             
         CLI   NUMBER,X'0A'                                                     
         BL    OT11                                                             
         MVC   D+17(50),P+18                                                    
         B     *+10                                                             
OT11     MVC   D+17(50),P+17                                                    
         MVI   D+67,C''''                                                       
         B     DATAPUT                                                          
*                                                                               
DATA101  CLI   P+9,C'S'                                                         
         BNE   DATAPUT                                                          
         MVC   D+25(2),=C'02'                                                   
         B     DATAPUT                                                          
*                                                                               
DATA102  LA    R1,MOLST                                                         
CLC102   CLC   P+9(3),0(R1)                                                     
         BE    RIGHT102                                                         
         LA    R1,3(R1)                                                         
         CLI   0(R1),X'FF'                                                      
         BNE   CLC102                                                           
         B     ER27                                                             
RIGHT102 MVC   D+28(3),P+9                                                      
         B     DATAPUT                                                          
*                                                                               
*              GENERATE PROFORMA REPORT                                         
*                                                                               
DATAGPR  MVC   D+31(2),P+9         UNIT LEDGER                                  
         CLI   P+15,C'1'           LEVEL                                        
         BL    ER29                                                             
         CLI   P+15,C'4'                                                        
         BH    ER29                                                             
         MVC   D+26(1),P+15                                                     
         B     DATAPUT                                                          
*                                                                               
*              DOWN LOAD OPTIONS                                                
*                                                                               
DATADWN  MVC   SCAN,SPACES                                                      
         MVC   SCAN(50),P+15                                                    
         LA    R4,BLOCK                                                         
         GOTO1 =V(SCANNER),PARA,(C'C',SCAN),(16,BLOCK),0                        
         SR    R3,R3                                                            
         ICM   R3,1,PARA+4         NUMBER OF PARAMETERS                         
         BZ    ER9                 MISSING DATA                                 
         XC    DWNOPTS,DWNOPTS     CLEAR                                        
         LA    R2,DOWNOPT          DOWN LOAD OPTIONS                            
DATADWN2 CLI   0(R2),X'FF'         END OF TABLE                                 
         BE    ER6                 OPTION NOT RECOGNIZED                        
         CLC   0(10,R2),12(R4)     MATCH DOWN OPTION                            
         BE    DATADWN4                                                         
         LA    R2,L'DOWNOPT(R2)    BUMP UP IN TABLE                             
         B     DATADWN2                                                         
*                                                                               
DATADWN4 OC    DWNOPTS,10(R2)      OR IN OPTIONS                                
         LA    R2,DOWNOPT          DOWN LOAD OPTIONS                            
         LA    R4,32(R4)           NEXT POSSIBLE OPTION                         
         BCT   R3,DATADWN2         LOOP FOR NEXT OPTION                         
*                                                                               
         GOTO1 =V(HEXOUT),PARA,DWNOPTS,D+29,2                                   
         B     DATAPUT                                                          
         EJECT                                                                  
**********************************************************************          
*              SUPER CALCULATIONS (SUPERCAL)                         *          
**********************************************************************          
         SPACE 1                                                                
SUPERC   MVI   SCSW,C'Y'           SET VALUE FOR CHECKING                       
         CLI   P+10,C' '                                                        
         BNE   SC0                                                              
         MVC   P+10(1),P+9         PAD 1 BYTE INTEGER (N) INTO 2 BYTE           
         MVI   P+9,C'0'              INTEGER WITH A LEADING 0 - 0(N)            
         CLI   P+10,X'F1'          IF COLUMN NUMBER IS LESS THAN 1              
         BL    ER23                  BRANCH TO ERROR ROUTINE                    
         B     SC1                                                              
*                                                                               
SC0      CLI   P+10,X'F1'                                                       
         BL    ER23                                                             
*                                                                               
SC1      PACK  WORK(2),P+9(2)                                                   
         CP    WORK(2),=P'1'       BRANCH TO ERROR ROUTINE FOR ANY              
         BL    ER23                  VALUE THAT IS LESS THAN 1                  
         CP    WORK(2),=P'9'         OR GREATER THAN 9                          
         BH    ER23                                                             
         EDIT  (P2,WORK),(2,D+25),FILL=0                                        
         CLC   P+15(3),=C'   '     CHECK HEADER STATEMENT FOR FILTERS           
         BE    SC5                   IF EMPTY GOTO TO OUTPUT                    
         LA    R1,P+15             R1 = A(P+15)                                 
         CLI   P+15,C','           CHECK IF 1ST FILTER IS PRESENT               
         BE    SC3                   IF NOT SKIP TO NEXT POSITION               
         MVC   D+31(1),P+15          ELSE MOVE FILTER INTO D                    
         LA    R1,1(R1)                                                         
*                                                                               
SC3      LA    R1,1(R1)            BUMP R1 PAST ','                             
         MVC   D+32(1),0(R1)       MOVE 2ND FILTER INTO D                       
*                                                                               
SC5      B     DATAPUT             SEND DATA TO OUTPUT                          
*                                                                               
*              MANIPULATING THE FIGURES                                         
*                                                                               
SC6      CLI   SCSW,C'Y'           CHECK THAT 1ST ROUTINE WAS RUN               
         BNE   ER21                  IF NOT BRANCH TO ERROR ROUTINE             
         LA    R1,OPLIST2          R1 = A(OPLIST2)                              
*                                                                               
SC7      CLC   0(1,R1),P+15        CHECK OPER. AT P+15 W/ OPER. TABLE           
         BE    SC8                 IF EQUAL INSERT CURRENT VALUE IN RF          
         LA    R1,2(R1)              ELSE BUMP TO NEXT OPERATOR                 
         CLI   0(R1),X'FF'         CHECK IF END OF TABLE                        
         BE    ER22                IF IT IS BRANCH TO ERROR ROUTINE             
         B     SC7                   ELSE LOOP BACK FOR NEXT COMPARE            
*                                                                               
SC8      ZIC   RF,1(R1)            INSERT CURRENT VALUE ASSOCIATED              
         EDIT  (RF),(2,D+25),FILL=0  W/OPERATOR INTO RF AND GOTO EDIT           
         CLI   P+17,C' '           CHECK THAT THERE IS A NUMBER                 
         BE    ER8                   IF NOT BRANCH TO ERROR ROUTINE             
         LA    RF,P+17             LOAD THE ADDRESS OF NUMBER INTO RF           
         LA    R1,0                                                             
*                                                                               
*              DETERMINING THE LENGTH OF THE NUMBER (THE OPERAND)               
*                                                                               
SC8A     LA    RF,1(RF)            BUMP THROUGH RF UNTIL                        
         CLI   0(RF),C' '            A SPACE IS FOUND AND THEN                  
         BE    SC9                   BRANCH TO CHECK IF NUM.IS NUMERIC          
         LA    R1,1(R1)            INCREMENT R1 FOR EX MVC                      
         B     SC8A                                                             
*                                                                               
*              PROCEDURE TO CHECK IF NUMBER IS NUMERIC                          
*                                                                               
*C9      EX    R1,*+8                                                           
*        B     *+10                                                             
SC9      MVC   WORK(8),=8X'F0'     EXPLICIT LENGTH ??????                       
*        MVC   WORK(0),=8X'F0'     SETTING WORK AS MASK                         
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVZ   WORK(0),P+17                                                     
         CLI   WORK,C'-'           COMPARE IF FIELD IN NON NUMERIC              
         BNE   *+8                   IF IT IS BRANCH TO NEXT CONDITION          
         MVI   WORK,X'F0'            ELSE REPLACE TO MAKE NUMERIC               
*        EX    R1,*+8                                                           
*        B     *+10                                                             
         CLC   WORK(8),=8X'F0'     CHECK THAT FIELD IS CORRECTLY SET            
         BNE   ER8                   ELSE BRANCH TO ERROR ROUTINE               
         LR    R2,R1               LOAD LENGTH OF OPERAND INTO R2               
         LA    R2,1(R2)            INCREMENT LENGTH BY 1                        
         MVC   WK2(8),=8C'0'       WK2 SET TO CL10?????                         
         LA    R1,WK2+7            TWO BYTES OF GARBAGE!!!!!!                   
*        MVC   WK2,=10C'0'         SET WK2 TO 0'S                               
*        LA    R1,WK2+9            SET R1 TO LAST POSITION OF WK2               
         BCTR  RF,0                DECREMENT RF TO LAST POS OF OPERAND          
*                                                                               
SC9A     MVC   0(1,R1),0(RF)       MOVE OPERAND IN RF INTO R1 FROM LAST         
         BCTR  RF,0                  POS. TO FIRST BY DECREMENTING RF           
         BCTR  R1,0                  AND DECREMENTING R1                        
         BCT   R2,SC9A                                                          
         MVC   D+33(8),WK2         MOVE OPERAND INTO D AT OFFSET                
         LA    R1,D+40             MOVE SIGN ALSO INTO D AT OFFSET              
         LA    RF,8                                                             
*                                                                               
SC9B     CLI   0(R1),C'-'          CHECK TO SEE IF THE SIGN IS (-)              
         BE    SC9C                  IF SO BRANCH TO SHIFT SIGN'S POS.          
         BCTR  R1,0                                                             
         BCT   RF,SC9B                                                          
         B     DATAPUT             SEND DATA TO OUTPUT                          
*                                                                               
SC9C     MVI   0(R1),C'0'          REPLACE SIGN WITH TRAILING 0                 
         MVI   D+33,C'-'           MOVE SIGN TO BEGINNING OF OPERAND            
         B     DATAPUT                                                          
*                                                                               
*              CLOSING AND SENDING DATA TO OUTPUT                               
*                                                                               
SC10     CLI   SCSW,C'Y'           CHECK THAT INITIAL ROUTINES RAN AND          
         MVI   SCSW,C'N'             RESET VALUE FOR CHECKING ELSE              
         BNE   ER21                  BRANCH TO ERROR ROUTINE                    
         B     DATAPUT             SEND DATA TO OUTPUT                          
         EJECT                                                                  
**********************************************************************          
*              SUBSIDIARY ROUTINES FOR COLCOMP                       *          
**********************************************************************          
         SPACE 1                                                                
VALIOP   NTR1                                                                   
         CLI   12(R4),C'V'         UNLESS V                                     
         BE    VALIOP4                                                          
         LA    R1,OPLIST           LOOK UP OPLIST                               
*                                                                               
VALIOP2  MVC   NUMBER,1(R1)                                                     
         CLC   12(1,R4),0(R1)                                                   
         BE    YES                                                              
         LA    R1,2(R1)                                                         
         CLI   0(R1),X'FF'         CHECK CURRENT POSITION OF R1 TO EOF          
         BNE   VALIOP2               IF NOT, MOVE NEXT POS. INTO NUMBER         
         B     NO                    ELSE SET FLAG                              
*                                                                               
VALIOP4  LA    R2,13(R4)                                                        
         BAS   RE,VALNUM                                                        
         BNE   NO                                                               
         CLI   NUMBER,0                                                         
         BE    NO                                                               
         CLI   NUMBER,9                                                         
         BH    NO                                                               
         AI    NUMBER,10                                                        
         B     YES                                                              
*                                                                               
VALICOL  NTR1                                                                   
         CLI   12(R4),C''''        UNLESS LITERAL                               
         BE    VALICOL2                                                         
         LA    R2,12(R4)           S/B COLUMN 1-32                              
         BAS   RE,VALNUM                                                        
         BNE   NO                                                               
         CLI   NUMBER,0                                                         
         BE    NO                                                               
         CLI   NUMBER,32                                                        
         BH    NO                                                               
         B     YES                                                              
*                                                                               
VALICOL2 ZIC   R1,0(R4)                                                         
         LA    R1,11(R1,R4)                                                     
         CLI   0(R1),C''''         CHECK END LIT                                
         BNE   NO                                                               
         MVI   0(R1),C' '          CREAM IT                                     
         LA    R2,13(R4)                                                        
         MVI   SGN,C'+'                                                         
         CLI   0(R2),C'-'          MAY BE PRECEDED BY -                         
         BNE   *+12                                                             
         MVI   SGN,C'-'                                                         
         LA    R2,1(R2)                                                         
         BAS   RE,VALNUM           SHOULD NOW BE NUMERIC                        
         BNE   NO                                                               
         CLI   NUMBER,100                                                       
         BH    NO                                                               
         AI    NUMBER,30                                                        
         CLI   SGN,C'-'                                                         
         BNE   YES                                                              
         AI    NUMBER,100          MINUS INTEGERS ARE 101-200                   
         B     YES                                                              
         EJECT                                                                  
**********************************************************************          
*              COMPLETE LITERALS                                     *          
**********************************************************************          
         SPACE 1                                                                
DATALIT  LA    R2,P+15             POSITION R2 TO START OF LITERAL              
*                                                                               
DATALIT2 MVC   0(1,R3),0(R2)                                                    
         CLI   0(R3),C'?'          QUESTION MARKS ARE FOR SHIFTING              
         BNE   *+8                 HEADLINES                                    
         MVI   0(R3),C' '          SO BLANK THEM OUT                            
         CLI   0(R3),C''''         QUOTES ARE DOUBLED                           
         BNE   *+12                                                             
         LA    R3,1(R3)                                                         
         MVI   0(R3),C''''                                                      
         CLI   0(R3),C'&&'         AS ARE AMPERSANDS                            
         BNE   *+12                                                             
         LA    R3,1(R3)                                                         
         MVI   0(R3),C'&&'                                                      
         LA    R2,1(R2)            BUMP INPUT                                   
         LA    R3,1(R3)                 OUTPUT                                  
         LA    R4,1(R4)                 LENGTH                                  
         CLC   0(8,R2),SPACES       EITHER 8 SPACES OR EXCLAMATION              
         BE    DATALIT3             POINT TERMINATES LITERAL                    
         CLI   0(R2),C'!'                                                       
         BNE   DATALIT2                                                         
*                                                                               
DATALIT3 MVI   0(R3),C''''         COMPLETE LITERAL                             
         CLI   FROM,FRTT                                                        
         BNE   *+12                                                             
         MVI   0(R3),C')'                                                       
         LA    R4,8                TT IS ALWAYS 8                               
         EDIT  (R4),(2,D+22),FILL=0         ADD LENGTH                          
         CLI   BKSW,C'B'                                                        
         BER   R6                                                               
         B     DATAPUT                                                          
         EJECT                                                                  
**********************************************************************          
*              VALIDATE NUMERIC FIELD                                *          
**********************************************************************          
         SPACE 1                                                                
VALNUM   NTR1                                                                   
         SR    R3,R3               INITIALIZE R3                                
         CLI   1(R2),C' '          CKECK LENGTH OF FIELD                        
         BE    VALNUM2                                                          
         CLI   1(R2),C','                                                       
         BE    VALNUM2                                                          
         LA    R3,1                SETTING R3 FOR EXECUTE MOVE                  
         CLI   2(R2),C' '                                                       
         BE    VALNUM2                                                          
         CLI   2(R2),C','                                                       
         BE    VALNUM2                                                          
         LA    R3,2                                                             
         CLI   3(R2),C' '                                                       
         BE    VALNUM2                                                          
         CLI   3(R2),C','                                                       
         BNE   NO                                                               
*                                                                               
VALNUM2  MVC   WORK(3),=C'000'                                                  
         EX    R3,NUMZONE                                                       
         EX    R3,NUMCOMP                                                       
         BNE   NO                  BRANCH TO SET FLAG IF NOT EQUAL              
         EX    R3,NUMPACK          EXECUTE PACK AT NUMPACK                      
         CVB   R1,DUB                                                           
         CLI   FROM,FRST                                                        
         BL    *+12                                                             
         CLI   FROM,FRTY                                                        
         BNH   VALNUM4                                                          
         CHI   R1,256              CHECK CONTENTS OF R1                         
         BH    NO                                                               
         B     VALNUM4                                                          
*                                                                               
VALNUM3  CHI   R1,364                                                           
         BH    NO                                                               
*                                                                               
VALNUM4  STC   R1,NUMBER           STORE VALUE OF R1 INTO NUMBER                
         STH   R1,NUMBER2          STORE VALUE OF R1 INTO NUMBER2               
         B     YES                                                              
*                                                                               
NUMZONE  MVZ   WORK(0),0(R2)                                                    
NUMCOMP  CLC   WORK(0),=C'000'                                                  
NUMPACK  PACK  DUB,0(0,R2)                                                      
*                                                                               
YES      SR    R0,R0                                                            
         B     *+8                                                              
NO       LA    R0,1                                                             
         LTR   R0,R0                                                            
         B     XIT                                                              
*                                                                               
VALCON   NTR1                      ROUTINE TO VALIDATE CON1-CON99               
         CLC   0(3,R2),=C'CON'                                                  
         BNE   NO                                                               
         LA    R2,3(R2)                                                         
         BAS   RE,VALNUM                                                        
         BNE   NO                                                               
         MVC   CONCODE,NUMBER                                                   
         B     YES                                                              
         EJECT                                                                  
**********************************************************************          
*              ROUTINE TO VALIDATE FROM CODES                        *          
**********************************************************************          
         SPACE 1                                                                
VALIFROM NTR1                                                                   
         L     R3,=A(FROMLIST)     R3 = A(FROMLIST)                             
         MVC   FROMAREA,0(R2)                                                   
         LA    R2,FROMAREA         R2 = A(FROMAREA)                             
         MVC   FROMCON,SPACES                                                   
         LA    R1,2(R2)                                                         
         LA    R0,10                                                            
*                                                                               
VFB      CLI   0(R1),C','                                                       
         BE    VFD                                                              
         LA    R1,1(R1)                                                         
         BCT   R0,VFB                                                           
         B     VF2                                                              
*                                                                               
VFD      MVC   FROMCON,1(R1)                                                    
         MVC   0(4,R1),SPACES                                                   
*                                                                               
VF2      CLI   0(R3),X'FF'                                                      
         BE    NO                                                               
         CLC   0(2,R3),0(R2)                                                    
         BE    VF4                                                              
         LA    R3,4(R3)                                                         
         B     VF2                                                              
*                                                                               
VF4      MVC   FROM,2(R3)          FROM CODE FOUND                              
         MVI   DISP,0              ASSUME NO DISPLACEMENT                       
         MVC   LNTH,3(R3)                 AND DEFAULT LENGTH                    
         LA    R2,2(R2)                                                         
         MVC   SVSG,0(R2)                                                       
         CLI   0(R2),C' '                                                       
         BE    YES                                                              
         CLI   0(R2),C'+'          DISPLACEMENT                                 
         BE    VF5                                                              
         CLI   FROM,FRST                                                        
         BL    VF8                                                              
         CLI   FROM,FRTY                                                        
         BH    VF8                                                              
         CLI   0(R2),C'-'                                                       
         BNE   VF8                                                              
*                                                                               
VF5      MVC   MYWK,SPACES                                                      
         MVC   MYWK(1),1(R2)       +N                                           
         MVI   MYWK+1,C' '                                                      
         LA    R2,2(R2)                                                         
         CLI   0(R2),C'('                                                       
         BE    VF6                                                              
         CLI   0(R2),C' '                                                       
         BE    VF6                                                              
         MVC   MYWK+1(1),0(R2)     OR +NN                                       
         LA    R2,1(R2)                                                         
         CLI   0(R2),C' '                                                       
         BE    VF6                                                              
         CLI   0(R2),C'('                                                       
         BE    VF6                                                              
         MVC   MYWK+2(1),0(R2)    OR NNN                                        
         LA    R2,1(R2)                                                         
*                                                                               
VF6      LR    R0,R2                                                            
         LA    R2,MYWK                                                          
         BAS   RE,VALNUM                                                        
         BNE   NO                                                               
         MVC   DISP,NUMBER                                                      
         LR    R2,R0                                                            
*                                                                               
VF8      CLI   0(R2),C' '                                                       
         BE    YES                                                              
         CLI   0(R2),C'('          MAY BE A LENGTH EXPRESSION (NN)              
         BNE   NO                                                               
         MVC   MYWK,SPACES                                                      
         MVC   MYWK(2),1(R2)                                                    
         CLI   MYWK+1,C')'                                                      
         BNE   *+8                                                              
         MVI   MYWK+1,C' '                                                      
         LA    R2,MYWK                                                          
         BAS   RE,VALNUM                                                        
         BNE   NO                                                               
         MVC   LNTH,NUMBER                                                      
         B     YES                                                              
         EJECT                                                                  
***********************************************************************         
*              ROUTINE TO VALIDATE A LINE EXPRESSION                  *         
***********************************************************************         
         SPACE 1                                                                
VALILINE NTR1                                                                   
         MVI   LINO,1              START WITH H,M,P                             
         CLI   P+9,C'H'                                                         
         BE    VL2                                                              
         MVI   LINO,2                                                           
         CLI   P+9,C'M'                                                         
         BE    VL2                                                              
         MVI   LINO,3                                                           
         CLI   P+9,C'P'                                                         
         BNE   NO                                                               
*                                                                               
VL2      MVI   DISP,0              DEFAULT NO DISPLACEMENT                      
         CLI   P+10,C' '                                                        
         BE    YES                                                              
         CLI   P+10,C'+'                                                        
         BNE   NO                                                               
         LA    R2,P+11                                                          
         BAS   RE,VALNUM                                                        
         BNE   NO                                                               
         MVC   DISP,NUMBER                                                      
         B     YES                                                              
         EJECT                                                                  
**********************************************************************          
*              VALIDATE A KEY EXPRESSION                             *          
**********************************************************************          
         SPACE 1                                                                
VALIKEY  NTR1                                                                   
         MVI   KEYTYPE,0           ALLOW MISSING KEYS                           
         MVI   KEYCODE,0                                                        
         CLI   0(R2),C' '                                                       
         BE    YES                                                              
         CLI   0(R2),C'*'          CANNED FORMULA                               
         BE    VK9                                                              
         MVI   KEYTYPE,17          CONDITIONALS                                 
         LA    R3,2(R2)                                                         
         CLC   0(2,R2),=C'IF '     IF OR                                        
         BE    VK2                                                              
         LA    R3,1(R3)                                                         
         CLC   0(3,R2),=C'CON'     CON OR                                       
         BE    VK2                                                              
         MVI   KEYTYPE,18                                                       
         CLC   0(3,R2),=C'NOT'     NOT OR                                       
         BE    VK2                                                              
         MVI   KEYTYPE,19                                                       
         CLC   0(3,R2),=C'REV'     REV                                          
         BNE   VK4                                                              
*                                                                               
VK2      LR    R2,R3                                                            
         BAS   RE,VALNUM           HAVE CONDITIONAL NUMBER                      
         BNE   NO                                                               
         ZIC   R1,NUMBER                                                        
         STC   R1,KEYCODE                                                       
         B     YES                                                              
*                                                                               
VK4      BAS   RE,PERVAL           IS IT A VALID PERIOD EXPRESSION              
         BE    YES                                                              
         L     R3,=A(KEYLIST)      OTHERWISE LOOK UP KEYCODE LIST               
         MVI   KEYTYPE,9                                                        
*                                                                               
VK6      CLI   0(R3),X'FF'                                                      
         BE    VK12                                                             
         CLC   0(7,R3),0(R2)                                                    
         BE    VK8                                                              
         LA    R3,8(R3)                                                         
         B     VK6                                                              
*                                                                               
VK8      MVC   KEYCODE,7(R3)                                                    
         B     YES                                                              
*                                                                               
VK9      MVC   WORK(3),=3X'F0'                                                  
         MVZ   WORK(3),1(R2)                                                    
         CLC   WORK(3),=3X'F0'                                                  
         BNE   NO                                                               
         CLI   1(R2),C'1'                                                       
         BL    NO                                                               
         CLI   1(R2),C'9'                                                       
         BH    NO                                                               
         PACK  DUB,1(1,R2)                                                      
         AP    DUB,=P'20'                                                       
         CVB   R1,DUB                                                           
         STC   R1,KEYTYPE                                                       
         PACK  DUB,2(2,R2)                                                      
         CVB   R1,DUB                                                           
         STC   R1,KEYCODE                                                       
         B     YES                                                              
*                                                                               
VK12     CLC   0(4,R2),=C'HOOK'    CHECK FOR HOOK(=NN)                          
         BNE   NO                                                               
         MVI   KEYTYPE,10          (TYPE 10)                                    
         SH    R2,=H'12'           BACK UP TO SCANNER HEADER                    
         MVC   KEYCODE,11(R2)      PASS BACK OPTIONAL PARAMETER                 
         CLI   1(R2),0                                                          
         BE    YES                 (NO =NN SO WE'RE DONE)                       
         CLI   1(R2),2             NN IS LIMITED TO 99                          
         BH    NO                                                               
         CLI   KEYCODE,0           MUST NOW HAVE NUMERIC CODE                   
         BE    NO                  (ELSE AN ERROR)                              
         B     YES                                                              
         EJECT                                                                  
***********************************************************************         
*              VALIDATE FOR PERIOD CODE                               *         
***********************************************************************         
         SPACE 1                                                                
PERVAL   NTR1                                                                   
         MVI   KEYTYPE,0           MAY BE PRECEDED BY MINUS                     
         CLI   0(R2),C'-'          (PREVIOUS YEAR)                              
         BNE   PV1                                                              
         MVI   KEYTYPE,4                                                        
         LA    R2,1(R2)                                                         
         B     PV2                                                              
PV1      CLI   0(R2),C'+'          (NEXT YEAR)                                  
         BNE   *+12                                                             
         MVI   KEYTYPE,10                                                       
         LA    R2,1(R2)                                                         
*                                                                               
PV2      LA    R1,SPECPER          LOOK FOR SPECIAL CODE                        
*                                                                               
PV4      CLC   0(6,R1),0(R2)                                                    
         BE    PV6                                                              
         CLI   0(R1),X'FF'                                                      
         BE    PV8                                                              
         LA    R1,8(R1)                                                         
         B     PV4                                                              
*                                                                               
PV6      ZIC   R0,6(R1)            FOUND                                        
         MVC   KEYCODE,7(R1)                                                    
         ZIC   R1,KEYTYPE                                                       
         AR    R1,R0                                                            
         STC   R1,KEYTYPE                                                       
         B     YES                                                              
*                                                                               
PV8      ZIC   R1,KEYTYPE          OTHERWISE CODE IS P,Y,R,F,A                  
         LA    R1,1(R1)                                                         
         CLI   0(R2),C'P'                                                       
         BE    PV10                                                             
         LA    R1,1(R1)                                                         
         CLI   0(R2),C'Y'                                                       
         BE    PV10                                                             
         LA    R1,1(R1)                                                         
         CLI   0(R2),C'R'                                                       
         BE    PV10                                                             
         LA    R1,1(R1)                                                         
         CLI   0(R2),C'F'                                                       
         BE    PV10                                                             
*        LA    R1,6(R1)                                                         
*        CLI   0(R2),C'A'                                                       
*        BE    PV10                                                             
         B     NO                                                               
*                                                                               
PV10     STC   R1,KEYTYPE     FOLLOWED BY MONTH,QUARTER,SIX MONTH               
         LA    R2,1(R2)                     EXPRESSION                          
         LA    R1,PEREXP                                                        
*                                                                               
PV12     CLC   0(3,R1),0(R2)                                                    
         BE    PV14                                                             
         CLI   0(R1),X'FF'                                                      
         BE    NO                                                               
         LA    R1,4(R1)                                                         
         B     PV12                                                             
*                                                                               
PV14     MVC   KEYCODE,3(R1)                                                    
         B     YES                                                              
*                                                                               
ADDN     NTR1                                                                   
         AP    PN,=P'1'                                                         
         UNPK  UPN,PN                                                           
         MVZ   UPN+1(1),=X'F0'                                                  
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*              ERROR XITS                                             *         
***********************************************************************         
         SPACE 1                                                                
ER2      MVC   P+85(22),=C'COMMAND NOT RECOGNIZED'                              
         B     ERRSET                                                           
*                                                                               
ER4      MVC   P+85(22),=C'INVALID CONDITION CODE'                              
         B     ERRSET                                                           
*                                                                               
ER6      MVC   P+85(21),=C'OPTION NOT RECOGNIZED'                               
         B     ERRSET                                                           
*                                                                               
ER8      MVC   P+85(11),=C'NOT NUMERIC'                                         
         B     ERRSET                                                           
*                                                                               
ER9      MVC   P+85(12),=C'MISSING DATA'                                        
         B     ERRSET                                                           
*                                                                               
ER10     MVC   P+85(17),=C'INVALID FROM CODE'                                   
         B     ERRSET                                                           
*                                                                               
ER12     MVC   P+85(17),=C'INVALID LINE CODE'                                   
         B     ERRSET                                                           
*                                                                               
ER14     MVC   P+85(22),=C'KEYWORD NOT RECOGNIZED'                              
         B     ERRSET                                                           
*                                                                               
ER16     MVC   P+85(21),=C'CHUNKS NEED 2 COLUMNS'                               
         B     ERRSET                                                           
*                                                                               
ER18     MVC   P+85(21),=C'INVALID COLCOMP EXP. '                               
         B     ERRSET                                                           
*                                                                               
ER20     MVC   P+85(26),=C'NOT THE NEXT REPORT NUMBER'                          
         B     ERRSET                                                           
*                                                                               
ER21     MVC   P+85(18),=C'NOT IN RIGHT ORDER'                                  
         B     ERRSET                                                           
*                                                                               
ER22     MVC   P+85(16),=C'INVALID OPERATOR'                                    
         B     ERRSET                                                           
*                                                                               
ER23     MVC   P+85(20),=C'SUPERCAL MUST BE 1-9'                                
         B     ERRSET                                                           
*                                                                               
ER24     MVC   P+85(18),=C'COLUMN NOT DEFINED'                                  
         B     ERRSET                                                           
*                                                                               
ER25     MVC   P+85(26),=C'NOT THE NEXT COLUMN NUMBER'                          
         B     ERRSET                                                           
*                                                                               
ER26     MVC   P+85(23),=C'NOT THE NEXT ROW NUMBER'                             
         B     ERRSET                                                           
*                                                                               
ER27     MVC   P+85(22),=C'WEEKDAY NOT RECOGNIZED'                              
         B     ERRSET                                                           
*                                                                               
ER28     MVC   P+85(29),=C'QUESTION MARK BASIS NOT VALID'                       
         B     ERRSET                                                           
*                                                                               
ER29     MVC   P+85(13),=C'INVALID LEVEL'                                       
         B     ERRSET                                                           
*                                                                               
ER30     MVC   P+85(19),=C'MISSING FORMAT CODE'                                 
         B     ERRSET                                                           
*                                                                               
ERRSET   MVI   ERSW,C'1'                                                        
         CLI   BOMB,C'T'                                                        
         BNE   *+6                                                              
         DC    H'0'                                                             
         B     XIT                                                              
         EJECT                                                                  
**********************************************************************          
*              ROUTINES TO HANDLE OUTPUT                             *          
**********************************************************************          
         SPACE 1                                                                
PUT      NTR1                                                                   
         CLI   TRACOPT,C'Y'                                                     
         BNE   PUT2                                                             
         MVC   P(80),D                                                          
         GOTO1 =V(PRINTER)                                                      
*                                                                               
PUT2     CLC   P2X+2(69),P                                                      
         BE    PUT3                                                             
         CLC   P(5),=C'PHASE'                                                   
         BE    PUT3                                                             
         CLI   STAT,C'N'                                                        
         BE    PUT3                                                             
         MVC   P2X,SPACES                                                       
         MVC   P2X+9(07),=C'SPACE 1'                                            
         PUT   ASMFIL,P2X                                                       
         MVI   P2X,C'*'                                                         
         MVC   P2X+2(69),P                                                      
         PUT   ASMFIL,P2X                                                       
PUT3     PUT   ASMFIL,D                                                         
         B     XIT                                                              
         EJECT                                                                  
**********************************************************************          
*              ROUTINE TO HANDLE MULTI-OUTPUT                        *          
**********************************************************************          
         SPACE 1                                                                
MULTI    NTR1                                                                   
*                                                                               
MULTI2   MVC   D,0(R2)                                                          
         BAS   RE,PUT                                                           
         LA    R2,80(R2)                                                        
         CLI   0(R2),X'FF'                                                      
         BNE   MULTI2                                                           
*                                                                               
XIT      XIT1                                                                   
         EJECT                                                                  
**********************************************************************          
*              STACKS                                                *          
**********************************************************************          
         SPACE 1                                                                
BEGSTACK DS    0D                                                               
         DC    CL80'         TITLE ''USER GENERATED APG REPORT'''               
BEGCS    DC    CL80'ACPPAA   CSECT'                                             
         DC    CL80'         SPACE 1'                                           
         DC    X'FF'                                                            
ENDSTACK DS    0D                                                               
         DC    CL80'         DC    X''FF'''                                     
         DC    CL80'         SPACE 1'                                           
         DC    CL80'         END'                                               
         DC    X'FF'                                                            
BEGPH    DC    CL80'   NAME  ACPPAAX(R)'                                        
         DC    X'FF'                                                            
         EJECT                                                                  
**********************************************************************          
*              CONSTANTS, WORK AREAS                                 *          
**********************************************************************          
         SPACE 1                                                                
RLCO     DC    C'00'                                                            
BKSW     DC    C' '                                                             
CONLIST  DC    C'=<>#/\',X'FF'                                                  
CONFOUND DC    C' '                                                             
SCSW     DC    C'N'                                                             
WK2      DS    CL10                                                             
BOMB     DC    C' '                                                             
SVSG     DC    C' '                                                             
ERSW     DC    C'0'                                                             
WK29     DS    CL2                                                              
*                                                                               
MOLST    DC    C'SUNMONTUEWEDTHUFRISAT',X'FF'                                   
*                                                                               
DOWNOPT  DS    0CL12               DOWNLOAD OPTIONS                             
         DC    CL10'MICRO  ',X'8000'          MICRO                             
         DC    CL10'NOHEAD ',X'4000'          EXCLUDE COLUMN HEADS              
         DC    CL10'NONAMES',X'2000'          EXCLUDE ROW NAMES                 
         DC    CL10'NOMOD  ',X'1000'          EXCLUDE MODULE CODE               
         DC    X'FF'                                                            
*                                                                               
OPTLIST  DS    0CL10               OPTION TABLE                                 
         DC    CL10'MINTOTS'                                                    
         DC    CL10'NOPAGE'                                                     
         DC    CL10'NO100'                                                      
         DC    CL10'MAX100'                                                     
         DC    CL10'ENDDATE'                                                    
         DC    CL10'WHOLEPCT'                                                   
         DC    CL10'CLIMWR'                                                     
         DC    CL10'ROUNDALL'                                                   
         DC    CL10'BUDCENTS'                                                   
*&&US*&& DC    CL10'PEREND'                                                     
*&&UK*&& DC    CL10'NOCHUNK'                                                    
*&&US*&& DC    CL10'NOREVERSAL'    SKIP REVERSALS                               
*&&UK*&& DC    CL10'UNDERTOT'                                                   
         DC    CL10'NOPERIOD'                                                   
         DC    X'FF'                                                            
*                                                                               
OPLIST   DC    C'I',AL1(5)                                                      
         DC    C'%',AL1(6)                                                      
         DC    C'R',AL1(7)                                                      
OPLIST2  DC    C'+',AL1(1)                                                      
         DC    C'-',AL1(2)                                                      
         DC    C'X',AL1(3)                                                      
         DC    C'/',AL1(4)                                                      
         DC    X'FF'                                                            
*                                                                               
SPECPER  DC    C'PERIOD',AL1(1,0)                                               
         DC    C'PER   ',AL1(1,0)                                               
         DC    C'P     ',AL1(1,0)                                               
         DC    C'YTD   ',AL1(2,0)                                               
         DC    C'YEAR  ',AL1(2,0)                                               
         DC    C'Y     ',AL1(2,0)                                               
         DC    C'ROLL  ',AL1(3,0)                                               
         DC    C'R     ',AL1(3,0)                                               
         DC    C'MONTH ',AL1(3,12)                                              
         DC    C'MON   ',AL1(3,12)                                              
         DC    C'M     ',AL1(3,12)                                              
         DC    C'FISCAL',AL1(4,0)                                               
         DC    C'F     ',AL1(4,0)                                               
*        DC    C'AHEAD ',AL1(10,0)                                              
*        DC    C'A     ',AL1(10,0)                                              
         DC    X'FF'                                                            
         SPACE 1                                                                
STAT     DC    C'N'                                                             
         EJECT                                                                  
ASMFIL   DCB   DDNAME=ASMFIL,                                          X        
               DSORG=PS,                                               X        
               RECFM=FB,                                               X        
               LRECL=00080,                                            X        
               BLKSIZE=00000,          DOS BLKSIZE=00080               X        
               MACRF=PM                                                         
LNKFIL   DCB   DDNAME=LNKFIL,                                          X        
               DSORG=PS,                                               X        
               RECFM=FB,                                               X        
               LRECL=00080,                                            X        
               BLKSIZE=00000,          DOS BLKSIZE=00080               X        
               MACRF=PM                                                         
*                                                                               
DUB      DS    D                                                                
WORK     DS    CL32                                                             
MYWK     DS    CL32                                                             
PARA     DS    0CL24                                                            
PARAS    DS    6F                                                               
BLOCK    DS    512C                                                             
DWNOPTS  DS    XL2                                                              
LINENUM  DC    H'0'                                                             
PANNAME  DC    CL10' '                                                          
CONCODE  DC    AL1(0)                                                           
KEYTYPE  DS    CL1                                                              
KEYCODE  DC    AL1(0)                                                           
FROM     DC    AL1(0)                                                           
DISP     DC    AL1(0)                                                           
LNTH     DC    AL1(0)                                                           
LINO     DC    AL1(0)                                                           
NUMBER   DC    AL1(0)                                                           
NUMBER2  DC    H'0'                                                             
PNTOFF   DC    C'N'                                                             
SGN      DS    CL1                                                              
D        DS    CL80                                                             
C        DS    CL80                                                             
TRACOPT  DC    C'N'                                                             
SCAN     DC    CL80' '                                                          
FROMAREA DC    CL50' '                                                          
THISCON  DC    AL1(1)                                                           
FROMCON  DS    CL2                                                              
PN       DC    PL2'1'                                                           
UPN      DC    CL2'01'                                                          
THISCOL  DS    C                                                                
THATCOL  DS    C                                                                
THATROW  DS    C                                                                
P2X      DS    CL80                                                             
         EJECT                                                                  
**********************************************************************          
*              LTORG FOR APG                                         *          
**********************************************************************          
         SPACE 1                                                                
         LTORG                                                                  
         EJECT                                                                  
**********************************************************************          
*              TABLE OF COMMANDS, ADDRESSES                                     
**********************************************************************          
         SPACE 1                                                                
COMTABLE DS    0D                                                               
         DC    C'PHASE   ',A(DATA20)         SYSTEM COMMANDS                    
         DC    C'SYSNAME ',A(DATA22)                                            
         DC    C'CONLEDG ',A(DATA23)                                            
         DC    C'READ    ',A(DATA24)                                            
         DC    C'BASIS   ',A(DATA26)                                            
         DC    C'DOWNLOAD',A(DATADWN)                                           
         DC    C'HOOKLOAD',A(DATA27)                                            
         DC    C'WIDTH   ',A(DATA28)                                            
         DC    C'NOBOX   ',A(DATAPUT)                                           
         DC    C'FISCAL  ',A(DATA43)                                            
         DC    C'SHOWALL ',A(DATAPUT)                                           
         DC    C'FORCETD ',A(DATAPUT)                                           
         DC    C'BUCKET$ ',A(DATAPUT)                                           
*&&UK*&& DC    C'RESET   ',A(DATA48)                                            
         DC    C'POSTMOS ',A(DATAPUT)                                           
         DC    C'POSTBDAT',A(DATAPUT)                                           
         DC    C'POSTDEPT',A(DATAPUT)                                           
         DC    C'NOBINARY',A(DATAPUT)                                           
         DC    C'ADJHOURS',A(DATAPUT)                                           
         DC    C'MODEHOOK',A(DATA43)                                            
         DC    C'GPR     ',A(DATAGPR)                                           
         DC    C'GENBUK  ',A(DATAPUT)                                           
         DC    C'OFFSEC  ',A(DATA23A)                                           
*                                                                               
         DC    C'REPORT  ',A(DATA28)         REPORT COMMANDS                    
         DC    C'SORTHOOK',A(DATA28)                                            
         DC    C'SORTOUT ',A(DATA28)                                            
         DC    C'PUTHOOK ',A(DATA28)                                            
         DC    C'GETHOOK ',A(DATA28)                                            
         DC    C'REPCODE ',A(DATA30)                                            
         DC    C'REPNAME ',A(DATA32)                                            
         DC    C'SHOWZERO',A(DATAPUT)                                           
         DC    C'REPRIGHT',A(DATA32)                                            
         DC    C'COPIES  ',A(DATA28)                                            
         DC    C'SPACING ',A(DATA28)                                            
         DC    C'NULMIDS ',A(DATA101)                                           
         DC    C'NOAUTOCN',A(DATAPUT)                                           
         DC    C'NOSRTOT ',A(DATAPUT)                                           
         DC    C'KEYCOL  ',A(DATA94)                                            
         DC    C'SECCOL  ',A(DATA94)                                            
         DC    C'OVRCOL  ',A(DATA94)                                            
*&&US*&& DC    C'LPOOLROW',A(DATA28)                                            
*                                                                               
         DC    C'IGNORE  ',A(DATA34)         OPTIONS                            
         DC    C'SORTD   ',A(DATAPUT)                                           
         DC    C'FILTER  ',A(DATA34)                                            
         DC    C'REVEDIT ',A(DATA94)                                            
         DC    C'OPTION  ',A(DATA36)                                            
         DC    C'RECAP   ',A(DATA41)                                            
         DC    C'FDOWN   ',A(DATA41)                                            
         DC    C'ROWLIST ',A(DATA23)                                            
         DC    C'ENCROACH',A(DATA43)                                            
         DC    C'ROUND   ',A(DATA43)                                            
*                                                                               
         DC    C'ROW     ',A(DATA42)         ROWS                               
         DC    C'ROWNAME ',A(DATA46)                                            
         DC    C'ROWCODE ',A(DATA46)                                            
         DC    C'ROWBOTH ',A(DATA46)                                            
         DC    C'ROWNMSQ ',A(DATAPUT)                                           
*                                                                               
         DC    C'NOTOT   ',A(DATA94)                                            
         DC    C'NOROLL  ',A(DATA94)                                            
         DC    C'STOP    ',A(DATA94)                                            
         DC    C'CHOP    ',A(DATA28)                                            
         DC    C'FOLD    ',A(DATA28)                                            
*                                                                               
         DC    C'COL     ',A(DATA50)         COLUMNS                            
         DC    C'COLCOMP ',A(DATA80)         COLUMNS                            
         DC    C'COLCOMP-',A(DATA80)         COLUMNS                            
         DC    C'COLNAME ',A(DATA64)                                            
         DC    C'CHUNK   ',A(DATA74)                                            
*                                                                               
         DC    C'IF      ',A(DATA60)         CONDITIONAL                        
         DC    C'OR      ',A(DATA60)                                            
         DC    C'AND     ',A(DATA60)                                            
         DC    C'BUDGET  ',A(DATA90)                                            
         DC    C'RPOOL   ',A(DATA100)                                           
         DC    C'LPOOL   ',A(DATA100)                                           
         DC    C'FPOOL   ',A(DATA100)                                           
         DC    C'PRTNOMOD',A(DATAPUT)                                           
         DC    C'SUPERCAL',A(SUPERC)                                            
         DC    C'DO      ',A(SC6)                                               
         DC    C'SCEND   ',A(SC10)                                              
         DC    C'A-HOURS ',A(DATAPUT)                                           
         DC    C'WEEKEND ',A(DATA102)                                           
         DC    X'FF'                                                            
         EJECT                                                                  
**********************************************************************          
*              TABLE OF CARD DATA (COMES AFTER DC   AL01(..)         *          
**********************************************************************          
         SPACE 1                                                                
OUTTAB   DS    0D                                                               
         DC    CL60' '                                 PHASE                    
         DC    CL60'02,LL),C'' '                       SYSNAME                  
         DC    CL60'03,06),C''UL  '''                  CONLEDG                  
*&&US*&& DC    CL60'04,06),X''00'',C''ULB'' '          READ                     
*&&UK*&& DC    CL60'04,05),C''ULB'' '                  READ                     
         DC    CL60'06,04),C''B'',AL1(0)'              BASIS                    
         DC    CL60'102,04),X''0000'' '                DOWNLOAD                 
         DC    CL60'07,10),C''XXXXXXXX'' '             HOOKLOAD                 
         DC    CL60'08,03,NN)'                         WIDTH                    
         DC    CL60'09,02)'                            NOBOX                    
         DC    CL60'11,03,NN)'                         FISCAL                   
         DC    CL60'71,02)'                            SHOWALL                  
         DC    CL60'72,02)'                            FORCETD                  
         DC    CL60'93,02)'                            BUCKET$                  
*&&UK*&& DC    CL60'95,04,00,01)'                      RESET                    
         DC    CL60'96,02)'                            POSTMOS                  
         DC    CL60'97,02)'                            POSTBDAT                 
         DC    CL60'101,02)'                           POSTDEPT                 
         DC    CL60'98,02)'                            NOBINARY                 
         DC    CL60'33,02)'                            ADJHOURS                 
         DC    CL60'99,03,NN)'                         MODEHOOK                 
         DC    CL60'100,05,L),C''UL'' '                GPR                      
         DC    CL60'103,02)'                           GENBUK                   
         DC    CL60'104,03),C''N'' '                   OFFSEC                   
*                                                                               
         DC    CL60'10,03,NN)'                         REPORT                   
         DC    CL60'27,03,NN)'                         SORTHOOK                 
         DC    CL60'29,03,NN)'                         SORTOUT                  
         DC    CL60'31,03,NN)'                         PUTHOOK                  
         DC    CL60'37,03,NN)'                         GETHOOK                  
         DC    CL60'12,04),C''XX'' '                   REPCODE                  
         DC    CL60'14,LL),C'' '                       REPNAME                  
         DC    CL60'13,02)'                            SHOWZERO                 
         DC    CL60'15,LL),C'' '                       REPRIGHT                 
         DC    CL60'16,03,NN)'                         COPIES                   
         DC    CL60'18,04,NN,NN)'                      SPACING                  
         DC    CL60'17,03,01)'                         NULMIDS                  
         DC    CL60'73,02)'                            NOAUTOCN                 
         DC    CL60'75,02)'                            NOSRTOT                  
         DC    CL60'94,03,01)'                         KEYCOL                   
         DC    CL60'94,03,02)'                         SECCOL                   
         DC    CL60'94,03,03)'                         OVRCOL                   
*&&US*&& DC    CL60'95,03,NN)'                         LPOOLROW                 
*                                                                               
         DC    CL60'20,03,NN)'                         IGNORE                   
         DC    CL60'21,02)'                            SORTD                    
         DC    CL60'22,03,NN)'                         FILTER                   
         DC    CL60'23,03,NN)'                         REVEDIT                  
         DC    CL60'24,03,NN)'                         OPTION                   
         DC    CL60'26,04,NN,NN)'                      RECAP                    
         DC    CL60'26,05,NN,00,00)'                   FDOWN                    
         DC    CL60'28,06),C''UL  '''                  ROWLIST                  
         DC    CL60'25,03,NN)'                         ENCROACH                 
         DC    CL60'19,04,NN),C'' '                    ROUND                    
*                                                                               
         DC    CL60'30,06,LV,FR,DS,LN)'                ROW                      
         DC    CL60'32,LL,01,LI,DS)'                   ROWNAME                  
         DC    CL60'32,LL,02,LI,DS)'                   ROWCODE                  
         DC    CL60'32,LL,03,LI,DS)'                   ROWBOTH                  
         DC    CL60'39,02)'                            ROWNMSQ                  
*                                                                               
         DC    CL60'35,03,NN)'                         NOTOT                    
         DC    CL60'35,03,64)'                         NOROLL                   
         DC    CL60'35,03,65)'                         STOP                     
         DC    CL60'36,03,NN)'                         CHOP                     
         DC    CL60'38,03,NN)'                         FOLD                     
*                                                                               
*MN      DC    CL60'40,12,NN,00,00,00,00,00,00,00,00,08)'  COL                  
         DC    CL60'40,12,NN,00,000,00,000,00,000,00,000,08)'  COL              
         DC    CL60'41,13,NN)'                         COLCOMP                  
         DC    CL60'45,13,NN)'                         COLCOMP-                 
         DC    CL60'42,39,NN),C''  '                   COLNAME                  
         DC    CL60'43,NN,CC,CC),C''  '                CHUNK                    
*                                                                               
         DC    CL60'50,LL,CC,FR,DS,LN),C''   '         IF                       
         DC    CL60'52,LL,CC,FR,DS,LN),C''   '         OR                       
         DC    CL60'54,LL,CC,FR,DS,LN),C''   '         AND                      
         DC    CL60'60,15,NN),AL2(0000),C''          ''' BUDGET                 
         DC    CL60'70,37,RR,01,CC),C'' '                RPOOL                  
         DC    CL60'70,37,RR,02,CC),C'' '                LPOOL                  
         DC    CL60'70,55,RR,03,CC)'                     FPOOL                  
         DC    CL60'74,02)'                              PRTNOMOD               
         DC    CL60'88,05,NN),C''  '''                   SUPERCAL               
         DC    CL60'89,07,OP),PL4''        '''            DO                    
         DC    CL60'90,03),C''#'''                        SCEND                 
         DC    CL60'91,02)'                             A-HOURS                 
         DC    CL60'92,05),C''XXX'''                    WEEKEND                 
PLAINRD  DC    CL26'04,05),C''ULB'' '                                           
         EJECT                                                                  
**********************************************************************          
*              PERIOD KEYWORDS                                       *          
**********************************************************************          
         SPACE 1                                                                
PEREXP   DS    0F                                                               
         DC    C'M01',AL1(1)                                                    
         DC    C'M1 ',AL1(1)                                                    
         DC    C'M02',AL1(2)                                                    
         DC    C'M2 ',AL1(2)                                                    
         DC    C'M03',AL1(3)                                                    
         DC    C'M3 ',AL1(3)                                                    
         DC    C'M04',AL1(4)                                                    
         DC    C'M4 ',AL1(4)                                                    
         DC    C'M05',AL1(5)                                                    
         DC    C'M5 ',AL1(5)                                                    
         DC    C'M06',AL1(6)                                                    
         DC    C'M6 ',AL1(6)                                                    
         DC    C'M07',AL1(7)                                                    
         DC    C'M7 ',AL1(7)                                                    
         DC    C'M08',AL1(8)                                                    
         DC    C'M8 ',AL1(8)                                                    
         DC    C'M09',AL1(9)                                                    
         DC    C'M9 ',AL1(9)                                                    
         DC    C'M10',AL1(10)                                                   
         DC    C'M11',AL1(11)                                                   
         DC    C'M12',AL1(12)                                                   
         DC    C'Q01',AL1(13)                                                   
         DC    C'Q1 ',AL1(13)                                                   
         DC    C'Q02',AL1(14)                                                   
         DC    C'Q2 ',AL1(14)                                                   
         DC    C'Q03',AL1(15)                                                   
         DC    C'Q3 ',AL1(15)                                                   
         DC    C'Q04',AL1(16)                                                   
         DC    C'Q4 ',AL1(16)                                                   
         DC    C'601',AL1(17)                                                   
         DC    C'61 ',AL1(17)                                                   
         DC    C'602',AL1(18)                                                   
         DC    C'62 ',AL1(18)                                                   
         DC    X'FF'                                                            
         EJECT                                                                  
**********************************************************************          
*              DATA TYPE KEYWORDS                                    *          
**********************************************************************          
         SPACE 1                                                                
KEYLIST  DS    0D                                                               
         DC    C'SAL    ',AL1(KWSAL)   SALARY COSTS (ALLOCATED)                 
         DC    C'SALARY ',AL1(KWSAL)                                            
         DC    C'HRS    ',AL1(KWHRS)   HOURS                                    
         DC    C'HOURS  ',AL1(KWHRS)                                            
         DC    C'G%     ',AL1(KWGRS)   GROSS PERCENT OF HOURS                   
         DC    C'GROSS  ',AL1(KWGRS)                                            
         DC    C'GROSS% ',AL1(KWGRS)                                            
         DC    C'N%     ',AL1(KWNET)   NET PERCENT OF HOURS                     
         DC    C'NET    ',AL1(KWNET)                                            
         DC    C'NET%   ',AL1(KWNET)                                            
         DC    C'%      ',AL1(KWPCT)   PERCENT OF HOURS                         
         DC    C'PCT    ',AL1(KWPCT)                                            
         DC    C'PERCENT',AL1(KWPCT)                                            
*&&US                                                                           
         DC    C'TMP    ',AL1(KWTMP)   TEMPORARY SALARIES                       
         DC    C'TEMP   ',AL1(KWTMP)                                            
         DC    C'OV     ',AL1(KWOVR)   OVERTIME SALARIES                        
         DC    C'OVER   ',AL1(KWOVR)                                            
*&&                                                                             
*&&UK                                                                           
         DC    C'UVAT   ',AL1(KWUVT)   UNBILLABLE V.A.T.                        
         DC    C'UV     ',AL1(KWUVT)                                            
         DC    C'BVAT   ',AL1(KWBVT)   BILLABLE V.A.T.                          
         DC    C'BV     ',AL1(KWBVT)                                            
*&&                                                                             
         DC    C'BON    ',AL1(KWBON)   BONUSES                                  
         DC    C'BONUS  ',AL1(KWBON)                                            
         DC    C'BEN    ',AL1(KWBEN)   BENEFITS (ALLOCATED)                     
         DC    C'BENEFIT',AL1(KWBEN)                                            
         DC    C'FEES   ',AL1(KWFEE)   ALLOCATED FEES                           
         DC    C'DR     ',AL1(KWDRS)   DEBIT AMOUNTS                            
         DC    C'DEBIT  ',AL1(KWDRS)                                            
         DC    C'CR     ',AL1(KWCRS)   CREDIT AMOUNTS                           
         DC    C'CREDIT ',AL1(KWCRS)                                            
         DC    C'BAL    ',AL1(KWBAL)   BALANCE AMOUNTS                          
         DC    C'BALANCE',AL1(KWBAL)                                            
         DC    C'DISC   ',AL1(KWCSD)   CASH DISCOUNTS                           
         DC    C'CD     ',AL1(KWCSD)                                            
         DC    C'COM    ',AL1(KWCOM)   COMMISSIONS                              
         DC    C'COMM   ',AL1(KWCOM)                                            
         DC    C'BIL    ',AL1(KWBIL)   GROSS BILLING                            
         DC    C'BILL   ',AL1(KWBIL)                                            
         DC    C'BILLED ',AL1(KWBIL)                                            
         DC    C'BILLING',AL1(KWBIL)                                            
         DC    C'BASIC  ',AL1(KWBAS)   BASIC SALARY (UNALLOCATED)               
         DC    C'TOTSAL ',AL1(KWTSL)   TOTAL SALARIES                           
         DC    C'NETBILL',AL1(KWNBL)   NET BILLING                              
         DC    C'DR0    ',AL1(KWDR0)   DEBIT AMOUNT (0 DEC)                     
         DC    C'DRO    ',AL1(KWDR0)                                            
         DC    C'CR0    ',AL1(KWCR0)   CREDIT AMOUNT (0 DEC)                    
         DC    C'CRO    ',AL1(KWCR0)                                            
         DC    C'BAL0   ',AL1(KWBL0)   BALANCE AMOUNTS (0 DEC)                  
         DC    C'BALO   ',AL1(KWBL0)                                            
         DC    C'ORDER  ',AL1(KWORD)   ORDERED                                  
         DC    C'ORDERED',AL1(KWORD)                                            
         DC    C'UNBILL ',AL1(KWUBL)   UNBILL                                   
         DC    C'BILLABL',AL1(KWBLB)   BILLED                                   
         DC    C'CLEAR  ',AL1(KWCLD)   CLEARED TO PAY                           
         DC    C'CLEARED',AL1(KWCLD)                                            
         DC    C'PAID   ',AL1(KWPAD)   PAID                                     
         DC    C'UNCLEAR',AL1(KWUCL)   UNCLEARED                                
         DC    C'ADMIN  ',AL1(KWADM)   ADMIN                                    
         DC    C'BUD1   ',AL1(KWBG1)   BUDGET NUMBER 1                          
         DC    C'BUD2   ',AL1(KWBG2)   BUDGET NUMBER 2                          
         DC    C'BUD3   ',AL1(KWBG3)   BUDGET NUMBER 3                          
         DC    C'BUD4   ',AL1(KWBG4)   BUDGET NUMBER 4                          
         DC    C'BUD5   ',AL1(KWBG5)   BUDGET NUMBER 5                          
         DC    C'BUD6   ',AL1(KWBG6)   BUDGET NUMBER 6                          
         DC    C'BUD7   ',AL1(KWBG7)   BUDGET NUMBER 7                          
         DC    C'BUD8   ',AL1(KWBG8)   BUDGET NUMBER 8                          
         DC    C'BUD9   ',AL1(KWBG9)   BUDGET NUMBER 9                          
         DC    C'NSAL   ',AL1(KWNSL)   NET SALARY (W/O BENEFITS/ADMIN)          
         DC    C'BBF    ',AL1(KWBLF)   BALANCE BROUGHT FORWARD                  
         DC    C'BALFWD ',AL1(KWBLF)                                            
         DC    C'BBF0   ',AL1(KWBF0)   BALANCE BROUGHT FORWARD(0 DEC)           
         DC    C'BALFWD0',AL1(KWBF0)                                            
         DC    C'OEST   ',AL1(KWOES)   ORIGINAL ESTIMATE AMOUNT(2 DEC)          
         DC    C'OEST0  ',AL1(KWOE0)   ORIGINAL ESTIMATE AMOUNT(0 DEC)          
         DC    C'CEST   ',AL1(KWCES)   CURRENT ESTIMATE AMOUNT (2 DEC)          
         DC    C'CEST0  ',AL1(KWCE0)   CURRENT ESTIMATE AMOUNT (0 DEC)          
         DC    C'PEST   ',AL1(KWPES)   PREVIOUS ESTIMATE AMOUNT(2 DEC)          
         DC    C'PEST0  ',AL1(KWPE0)   PREVIOUS ESTIMATE AMOUNT(0 DEC)          
*&&US                                                                           
         DC    C'EXPBGR ',AL1(KWXGR)   EXPENDITURE SYSTEM BILLING GROS          
         DC    C'EXPBGR0',AL1(KWXG0)   SAME AS ABOVE (0 DEC)                    
         DC    C'EXPBNE ',AL1(KWXNE)   EXPENDITURE SYSTEM BILLING NET           
         DC    C'EXPBNE0',AL1(KWXN0)   SAME AS ABOVE (0 NET)                    
         DC    C'ADJD   ',AL1(KWADJ)   ADJUSTMENTS, DEBIT SIDE (2 DEC)          
*&&                                                                             
*&&UK                                                                           
         DC    C'VAT    ',AL1(KWVAT)   VALUE ADDED TAX (2 DEC)                  
         DC    C'VAT0   ',AL1(KWVT0)   VALUE ADDED TAX (0 DEC)                  
         DC    C'CHOURS ',AL1(KWCHR)   CHARGED HOURS                            
         DC    C'CHRS   ',AL1(KWCHR)                                            
         DC    C'CAMT   ',AL1(KWCAM)   CHARGED AMOUNT (2 DEC)                   
         DC    C'CAMT0  ',AL1(KWCA0)   CHARGED AMOUNT (0 DEC)                   
*&&                                                                             
         DC    C'ADJD0  ',AL1(KWAJ0)   ADJUSTMENT, DEBIT SIDE (0 DEC)           
         DC    C'ADJC   ',AL1(KWADC)   ADJUSTMENT, CREDIT SIDE (2 DEC)          
         DC    C'ADJC0  ',AL1(KWAC0)   ADJUSTMENT, CREDIT SIDE (0 DEC)          
         DC    C'FEEADJ ',AL1(KWFAD)   ADJUSTMENT TO THE FEES (CREDIT)          
         DC    C'ADJFEES',AL1(KWADF)   ADJUSTED FEES (DEBITS/CREDITS)           
         DC    C'MWR    ',AL1(KWMWR)   MAN WEEK RATIO                           
         DC    C'MWRATIO',AL1(KWMWR)                                            
         DC    C'TYPE1% ',AL1(KWTP1)   TYPE1%                                   
         DC    C'TOTHRS ',AL1(KWTOH)   TOTHRS                                   
         DC    C'STDHRS ',AL1(KWSTH)   STDHRS                                   
         DC    C'CLTHRS ',AL1(KWCLH)   CLTHRS                                   
         DC    C'BR     ',AL1(KWBRA)   BR                                       
         DC    C'BRHRS  ',AL1(KWBRH)   BRHRS                                    
         DC    C'ADJHRS ',AL1(KWADH)   ADJUSTED HOURS                           
         DC    C'MISHRS ',AL1(KWMSH)   MISSING HOURS                            
         DC    C'ASAL   ',AL1(KWASL)   ALLOCATED SALARY                         
         DC    C'ABEN   ',AL1(KWABN)   ALLOCATED BENEFIT                        
         DC    C'APEN   ',AL1(KWAPN)   ALLOCATED PENSION                        
         DC    C'ATOTS  ',AL1(KWATS)   ALLOCATED TOTAL SALARY                   
         DC    C'BUDA   ',AL1(KWBGA)   BUDGET 10                                
         DC    C'BUDB   ',AL1(KWBGB)          11                                
         DC    C'BUDC   ',AL1(KWBGC)          12                                
         DC    C'BUDD   ',AL1(KWBGD)          13                                
         DC    C'BUDE   ',AL1(KWBGE)          14                                
         DC    C'BUDF   ',AL1(KWBGF)          15                                
         DC    C'THR    ',AL1(KWTHR)   TRANSACTION HOURS                        
         DC    C'MTS    ',AL1(KWMTS)   MISSING TIME SHEETS                      
         DC    C'STDR   ',AL1(KWSTR)   STANDARD RATE                            
         DC    C'STD$   ',AL1(KWST$)   STANDARD DOLLARS (RATE * HOURS)          
         DC    C'PSR    ',AL1(KWPSR)   PERSONAL SALARY RATE                     
         DC    C'PS$    ',AL1(KWPS$)   PERSOANL SALARY DOLLARS                  
         DC    C'PBR    ',AL1(KWPBR)   PERSONAL BENEFIT RATE                    
         DC    C'PB$    ',AL1(KWPB$)   PERSOANL BENEFIT DOLLARS                 
         DC    C'PPR    ',AL1(KWPPR)   PERSONAL PENSION RATE                    
         DC    C'PP$    ',AL1(KWPP$)   PERSOANL PENSION DOLLARS                 
         DC    C'PTR    ',AL1(KWPTR)   PERSONAL TOTAL RATE                      
         DC    C'PT$    ',AL1(KWPT$)   PERSOANL TOTAL DOLLARS                   
         DC    C'TH%    ',AL1(KWTHP)   TRANSACTION % OF TOTAL HOURS             
         DC    C'TO$    ',AL1(KWTO$)   TOTAL DOLLARS                            
         DC    C'MS$    ',AL1(KWMS$)   MISSING T/S $                            
         DC    C'AD$    ',AL1(KWAD$)   ADJUSTED T/S $                           
         DC    C'CU$    ',AL1(KWCU$)   CURRENT $                                
         DC    C'CUR    ',AL1(KWCUR)   CURRENT RATE                             
         DC    C'SPBT$  ',AL1(KWSPBT$) SAL, PEN OR BEN TOTAL$                   
         DC    C'SPBM$  ',AL1(KWSPBM$) SAL, PEN OR BEN MISSING$                 
         DC    C'SPBA$  ',AL1(KWSPBA$) SAL, PEN OR BEN ADJUST$                  
         DC    C'SPBC$  ',AL1(KWSPBC$) SAL, PEN OR BEN CURRENT$                 
         DC    C'SPBR   ',AL1(KWSPBR)  SAL, PEN OR BEN RATE                     
         DC    C'TLPHRS ',AL1(KWTLP)   TOT HOURS-LEAVE-PERSONAL                 
*MN                                                                             
         DC    C'HIST   ',AL1(KWHIST)  SALARY HISTORY DOLLARS                   
*MN                                                                             
         DC    C'FF'                                                            
         EJECT                                                                  
**********************************************************************          
*              FROM LIST KEYWORDS                                    *          
**********************************************************************          
         SPACE 1                                                                
FROMLIST DC    C'AU',AL1(FRAU,2)      FROM CODE/NUMBER/LEN                      
         DC    C'AC',AL1(FRAC,12)     ACCOUNT                                   
         DC    C'CU',AL1(FRCU,2)      CONTRA UNIT/LEDGER                        
         DC    C'CA',AL1(FRCA,12)     CONTRA ACCOUNT                            
         DC    C'F1',AL1(FRF1,1)      ACCOUNT FILTER 1                          
         DC    C'F2',AL1(FRF2,1)      ACCOUNT FILTER 2                          
         DC    C'F3',AL1(FRF3,1)      ACCOUNT FILTER 3                          
         DC    C'WC',AL1(FRWC,2)      WORK CODE                                 
         DC    C'DT',AL1(FRDT,20)     TRANSACTION DATE (DETAILS)                
         DC    C'RF',AL1(FRRF,6)      REFERENCE                                 
         DC    C'NU',AL1(FRNU,12)     CODE FROM NUMBER ELEMENT                  
         DC    C'AN',AL1(FRAN,1)      ACCOUNT ANALYSIS CODE                     
         DC    C'T1',AL1(FRT1,3)      FIRST PIECE OF T/E                        
         DC    C'T2',AL1(FRT2,6)      SECOND PIECE OF T/E                       
         DC    C'L1',AL1(FRL1,0)      SOFT ACCOUNT CODE LEVEL 1                 
         DC    C'L2',AL1(FRL2,0)      SOFT ACCOUNT CODE LEVEL 2                 
         DC    C'L3',AL1(FRL3,0)      SOFT ACCOUNT CODE LEVEL 3                 
         DC    C'L4',AL1(FRL4,0)      SOFT ACCOUNT CODE LEVEL 4                 
         DC    C'LV',AL1(FRLV,1)      NUMBER OF LEVELS                          
         DC    C'01',AL1(FR01,1)      1  POSITION IN PROFILE                    
         DC    C'02',AL1(FR02,1)      2  POSITION IN PROFILE                    
         DC    C'03',AL1(FR03,1)      3  POSITION IN PROFILE                    
         DC    C'04',AL1(FR04,1)      4  POSITION IN PROFILE                    
         DC    C'05',AL1(FR05,1)      5  POSITION IN PROFILE                    
         DC    C'06',AL1(FR06,1)      6  POSITION IN PROFILE                    
         DC    C'07',AL1(FR07,1)      7  POSITION IN PROFILE                    
         DC    C'08',AL1(FR08,1)      8  POSITION IN PROFILE                    
         DC    C'09',AL1(FR09,1)      9  POSITION IN PROFILE                    
         DC    C'10',AL1(FR10,1)      10 POSITION IN PROFILE                    
         DC    C'11',AL1(FR11,1)      11 POSITION IN PROFILE                    
         DC    C'12',AL1(FR12,1)      12 POSITION IN PROFILE                    
         DC    C'13',AL1(FR13,1)      13 POSITION IN PROFILE                    
         DC    C'14',AL1(FR14,1)      14 POSITION IN PROFILE                    
         DC    C'15',AL1(FR15,1)      15 POSITION IN PROFILE                    
         DC    C'16',AL1(FR16,1)      16 POSITION IN PROFILE                    
         DC    C'TA',AL1(FRTA,2)      TRANSACTION ANALYSIS                      
         DC    C'TB',AL1(FRTB,16)     TRANSACATION BATCH                        
         DC    C'TN',AL1(FRTN,1)      NARRATIVE                                 
         DC    C'RQ',AL1(FRRQ,1)      REQUEST CARD                              
         DC    C'Q1',AL1(FRQ1,1)      OPTION 1 IN REQUEST                       
         DC    C'Q2',AL1(FRQ2,1)      OPTION 2 IN REQUEST                       
         DC    C'Q3',AL1(FRQ3,1)      OPTION 3 IN REQUEST                       
         DC    C'Q4',AL1(FRQ4,1)      OPTION 4 IN REQUEST                       
         DC    C'Q5',AL1(FRQ5,1)      OPTION 5 IN REQUEST                       
         DC    C'Q6',AL1(FRQ6,1)      OPTION 6 IN REQUEST                       
         DC    C'Q7',AL1(FRQ7,1)      OPTION 7 IN REQUEST                       
         DC    C'OT',AL1(FROT,1)      OTHER NUMBER                              
         DC    C'F4',AL1(FRF4,1)      ACCOUNT FILTER 4                          
         DC    C'F5',AL1(FRF5,1)      ACCOUNT FILTER 5                          
         DC    C'C1',AL1(FRC1,0)      SOFT CONTRA ACCOUNT LEVEL 1               
         DC    C'C2',AL1(FRC2,0)      SOFT CONTRA ACCOUNT LEVEL 2               
         DC    C'C3',AL1(FRC3,0)      SOFT CONTRA ACCOUNT LEVEL 3               
         DC    C'C4',AL1(FRC4,0)      SOFT CONTRA ACCOUNT LEVEL 4               
         DC    C'RL',AL1(FRRL,12)     ROWLIST                                   
         DC    C'AD',AL1(FRAD,20)     ACTIVITY DATE (DATE TRANS ADDED)          
         DC    C'MD',AL1(FRMD,20)     MARKED DATE                               
         DC    C'EP',AL1(FREP,85)     THE EXTRA PAYMENT INFO ELEMENT            
         DC    C'DU',AL1(FRDU,20)     DATE USED                                 
         DC    C'AL',AL1(FRAL,12)     ACC CODE/ROW NAME FROM NAME POOL          
         DC    C'CL',AL1(FRCL,12)     SAME AS ABOVE EXCEPT FOR CONTRA           
         DC    C'TT',AL1(FRTT,1)      TRANSACTION TYPE                          
         DC    C'RU',AL1(FRRU,2)      REAL ACCOUNT UNIT/LEDGER                  
         DC    C'RA',AL1(FRRA,12)     REAL ACCOUNT                              
         DC    C'BF',AL1(FRBF,20)                                               
         DC    C'HI',AL1(FRHI,20)     HIRE DATE                                 
         DC    C'TR',AL1(FRTR,20)     TERMINATION DATE                          
         DC    C'DD',AL1(FRDD,20)     DUE DATE                                  
         DC    C'ST',AL1(FRST,0)      START DATE                                
         DC    C'EN',AL1(FREN,0)      END DATE                                  
         DC    C'TY',AL1(FRTY,0)                                                
         DC    C'BK',AL1(FRBK,1)      BUCKET TYPE                               
         DC    C'JB',AL1(FRJB,12)     JOB                                       
         DC    C'TK',AL1(FRTK,2)      TASK                                      
         DC    C'CG',AL1(FRCG,1)      COSTING GROUP                             
         DC    C'NT',AL1(FRNT,1)      TYPE OF 1N TIME                           
         DC    C'R2',AL1(FRR2,1)      SECOND REQUEST CARD                       
         DC    C'TI',AL1(FRTI,1)      B, N OR R TIME                            
         DC    X'FF'                                                            
         SPACE 1                                                                
       ++INCLUDE ACAPGEQU                                                       
         EJECT                                                                  
       ++INCLUDE DDDPRINT                                                       
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'031ACAPG     05/01/02'                                      
         END                                                                    
