*          DATA SET DDSOFDAT   AT LEVEL 019 AS OF 06/15/20                      
*CATALP SOFDAT                                                                  
SOFDAT   TITLE 'HANDLE DDS DATE EXRESSIONS'                                     
SOFDAT   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 WORKL,**SDAT**,RA,CLEAR=YES,RR=RE                                
         USING WORKD,RC            RC=A(LOCAL WORKING STORAGE)                  
         ICM   RF,15,VGETBRD                                                    
         BZ    *+10                                                             
         AR    RF,RE                                                            
         ST    RF,AGETBRD          SET A(GETBROAD)                              
         LR    R2,R1                                                            
         USING SOFDATD,R2          R2=A(PARAMETER BLOCK)                        
         EJECT                                                                  
***********************************************************************         
* MAIN CONTROL CODE                                                   *         
***********************************************************************         
                                                                                
MAIN     XC    SOFOVALS(SOFOVALL),SOFOVALS                                      
         MVI   SOFOINDS,0          CLEAR OUTPUT AREAS                           
                                                                                
         ICM   RE,15,SOFACOM       EXTRACT ADDRESSES FROM COMFACS               
         USING COMFACSD,RE                                                      
         MVC   VADDAY,CADDAY                                                    
         MVC   VDATCON,CDATCON                                                  
         MVC   VDICTATE,CDICTATE                                                
         MVC   VGETDAY,CGETDAY                                                  
         MVC   VGETRET,CGETRET                                                  
         MVC   VPERVAL,CPERVAL                                                  
         MVC   VPERVERT,CPERVERT                                                
         DROP  RE                                                               
                                                                                
         LA    RE,SYSTAB           LOOK UP SYSTEM IN TABLE                      
         USING SYSTABD,RE          RE=A(SYSTEM TABLE)                           
         LA    R0,SYSTABN          R0=N'ENTRIES IN SYSTEM TABLE                 
MAIN02   CLC   SYSTSYSN,SOFSYSN    MATCH ON SYSTEM NUMBER                       
         BE    MAIN04                                                           
         AHI   RE,SYSTABL          NO - BUMP TO NEXT TABLE ENTRY                
         BCT   R0,MAIN02                                                        
         DC    H'0'                                                             
                                                                                
MAIN04   SR    RF,RF               SET A(SYSTEM TABLE)                          
         ICM   RF,3,SYSTTDSP                                                    
         LA    RF,SOFDAT(RF)                                                    
         ST    RF,ASOFTAB                                                       
                                                                                
         SR    RF,RF               EXTRACT ERROR MESSAGE NUMBERS                
         ICM   RF,3,SYSTEDSP                                                    
         LA    RF,SOFDAT(RF)                                                    
         MVC   ERRORS(ERRORSL),0(RF)                                            
                                                                                
         SR    RF,RF               SET A(SYSTEM KEYWORD DCDD LIST)              
         ICM   RF,3,SYSTDDSP                                                    
         LA    RF,SOFDAT(RF)                                                    
         ST    RF,ADCDTAB                                                       
         MVC   NDCDNUM,SYSTDNUM    EXTRACT N'ENTRIES IN KEYWORD TABLE           
         MVC   DICSYSN,SYSTSSYS                                                 
         MVC   RFPSYSN,SYSTRSYS                                                 
         DROP  RE                                                               
                                                                                
         OC    SOFTODAY,SOFTODAY   GET TODAY'S DATE IF NOT GIVEN                
         BNZ   MAIN06                                                           
         GOTOR VDATCON,DMCB,(5,0),SOFTODAY                                      
                                                                                
MAIN06   MVC   OTYPE,SOFOTYPE      EXTRACT OUTPUT TYPE                          
         MVC   OINDS,OTYPE                                                      
         NI    OTYPE,DIGIT                                                      
         NI    OINDS,NUMERIC       AND OUTPUT INDICATORS                        
                                                                                
         MVC   ITYPE,SOFITYPE      EXTRACT INPUT TYPE                           
         MVC   IINDS,ITYPE                                                      
         NI    ITYPE,DIGIT                                                      
         NI    IINDS,NUMERIC       AND INPUT INDICATORS                         
                                                                                
         TM    SOFIINDS,SOFIIONE   TEST SINGLE DATE ONLY                        
         BNZ   *+8                                                              
         NI    IINDS,ALLBITS-(SOFITEND)                                         
                                                                                
         LA    RE,KEYWORDS         POINT TO KEYWORDS IN LOCAL STORAGE           
         TM    IINDS,SOFITXTN      TEST EXTENSION BLOCK PROVIDED                
         BZ    MAIN08                                                           
         ICM   RF,15,SOFABUFF      TEST BUFFER PROVIDED                         
         BZ    MAIN08                                                           
         MVC   LASTS(LASTSL),0(RF) YES - EXTRACT LOOKUP KEY                     
         LA    RE,LASTSL(RF)       AND POINT TO KEYWORD LIST                    
MAIN08   ST    RE,AKEYWRDS         SAVE A(KEYWORD LIST)                         
                                                                                
         MVC   TODAY1,SOFTODAY                                                  
         MVC   TODAY2,SOFTODAY                                                  
                                                                                
         GOTOR GO                  DO VALIDATION PASS                           
         BE    MAIN10                                                           
                                                                                
***********************************************************************         
* VALIDATION ERROR HAS OCCURRED.  IF THE INPUT EXPRESSION WAS OF THE  *         
* TYPE !(MONTH EXPRESSION)-(PRIOR MONTH EXPRESSION) (WHERE NEITHER    *         
* EXPRESSION HAS A YEAR MODIFIER) AND THE ERROR IS 'START GREATER     *         
* THAN END' THEN ADJUST THE BASE DATE OF THE START DATE (GO BACK ONE  *         
* YEAR) AND REPEAT THE INPUT VALIDATION                               *         
***********************************************************************         
                                                                                
         TM    INDS,INDSSOFT       TEST SOFT DATE EXPRESSION                    
         BZ    MAINX                                                            
         TM    INDS,INDSSGRE       TEST START GREATER THAN END                  
         BZ    MAINX                                                            
         TM    INDS,INDSYRMO       TEST YEAR MODIFIER INPUT                     
         BNZ   MAINX                                                            
         TM    INDS,INDSPMON       TEST END DATE IS PRIOR MONTH                 
         BZ    MAINX                                                            
         GOTOR VADDAY,DMCB,('ADDMONQ',TODAY1),WORK,-12                          
         MVC   TODAY1,WORK         SET START DATE BASE TO PREVIOUS YEAR         
         XC    SOFERROR,SOFERROR   CLEAR ERROR                                  
         MVI   SOFOINDS,0          AND TRY VALIDATING AGAIN                     
         MVI   INDS,0                                                           
         GOTOR GO                                                               
         BNE   MAINX                                                            
                                                                                
MAIN10   MVI   SOFOINDS,0          DO PROCESSING PASS                           
         MVI   INDS,0                                                           
         MVI   PASS,1                                                           
         GOTOR GO                                                               
         BE    MAINX                                                            
         DC    H'0'                                                             
                                                                                
MAINX    OC    LASTS,LASTS         TEST DICTIONARY LOOKUP DONE                  
         BZ    EXITTST                                                          
         TM    IINDS,SOFITXTN      TEST EXTENSION BLOCK PASSED                  
         BZ    EXITTST                                                          
         ICM   RF,15,SOFABUFF      TEST BUFFER ADDRESS PASSED                   
         BZ    EXITTST                                                          
         MVC   0(LASTSL,RF),LASTS  SAVE LOOKUP KEY IN BUFFER                    
                                                                                
EXITTST  OC    SOFERROR,SOFERROR   SET CC ON EXIT                               
                                                                                
EXIT     XIT1  ,                                                                
         EJECT                                                                  
***********************************************************************         
* CALL VALIDATION ROUTINE                                             *         
***********************************************************************         
                                                                                
GO       NTR1  ,                                                                
         SR    RE,RE                                                            
         ICM   RE,1,ITYPE          PICK UP INPUT TYPE                           
         BNZ   *+6                                                              
         DC    H'0'                                                             
         SLL   RE,2                                                             
         B     *+0(RE)                                                          
                                                                                
         B     SALL                SOFT/HARD (YYMM(YYMM) EBCDIC)                
         B     SALL                SOFT/HARD (YYMMDD(YYMMDD) EBCDIC)            
         B     SALL                SOFT/HARD (YYMMDD(YYMMDD) CMPRESSED)         
         B     SALL                SOFT/HARD (YYMM(YYMM) PWOS)                  
         B     SALL                SOFT/HARD (YYMMDD(YYMMDD) PWOS)              
         B     SALL                SOFT/HARD (YYMM(YYMM) BINARY)                
         B     SALL                SOFT/HARD (YYMMDD(YYMMDD) BINARY)            
         B     IYM                 YEAR/MONTH VALIDATION                        
         B     IYMD                YEAR/MONTH/DAY VALIDATION                    
         B     SALL                SOFT/HARD JULIAN                             
         B     SALL                SOFT/HARD SHORT JULIAN                       
         B     SALL                SOFT/HARD (YYMMDD(YYMMDD) NEW CMPR)          
         DC    AL4(0)              NEXT INPUT TYPE                              
         DC    AL4(0)              NEXT INPUT TYPE                              
         DC    AL4(0)              NEXT INPUT TYPE                              
         EJECT                                                                  
***********************************************************************         
* INPUT VALIDATION                                                    *         
***********************************************************************         
                                                                                
IYM      MVI   YMDFILT,SOFTYM      YEAR/MONTH ONLY VALID                        
         OI    OINDS,SOFOTPYM      SET YEAR/MONTH OUTPUT                        
         B     IALL                                                             
                                                                                
IYMD     MVI   YMDFILT,SOFTYMD     YEAR/MONTH/DAY ONLY VALID                    
                                                                                
IALL     SR    RE,RE                                                            
         IC    RE,OTYPE                                                         
         LA    RF,LENTAB-L'LENTAB(RE)                                           
         MVC   DATILEN,0(RF)       SET OUTPUT DATA LENGTH                       
         LA    RF,INDTAB-L'INDTAB(RE)                                           
         OC    OINDS,0(RF)         SET PRINT INDICATORS                         
         SLL   RE,1                                                             
         LA    RF,TYPTAB-L'TYPTAB(RE)                                           
         MVC   DATTYPE,0(RF)       SET DATCON INPUT/OUTPUT TYPE                 
         LA    RF,DSPTAB-L'DSPTAB(RE)                                           
         MVC   PERDSPS,0(RF)       SET DISPLACEMENTS TO PERVAL VALUES           
                                                                                
IALL02   ICM   RE,15,SOFAOUT       POINT TO OUTPUT AREA                         
         BNZ   *+6                                                              
         DC    H'0'                                                             
         SR    RF,RF                                                            
         IC    RF,DATILEN          OUTPUT DATA LENGTH                           
         SHI   RF,2                MINUS TWO FOR EXECUTE LENGTH                 
                                                                                
         MVI   0(RE),SPACE         DEFAULT START DATE IS SPACES                 
         TM    SOFIINDS,SOFIISLH   TEST TO SET LOW/HIGH VALUES                  
         BZ    *+8                                                              
         MVI   0(RE),LOVALUE       SET LOW VALUE IN START DATE                  
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   1(0,RE),0(RE)                                                    
         TM    SOFIINDS,SOFIIONE   TEST SINGLE INPUT FIELD                      
         BNZ   IALL04                                                           
                                                                                
         LA    RE,2(RF,RE)                                                      
         MVI   0(RE),SPACE         DEFAULT END DATE IS SPACES                   
         TM    SOFIINDS,SOFIISLH   TEST TO SET LOW/HIGH VALUE                   
         BZ    *+8                                                              
         MVI   0(RE),HIVALUE       SET HIGH VALUE IN END DATE                   
         EX    RF,*+8                                                           
         B     IALL04                                                           
         MVC   1(0,RE),0(RE)       CLEAR OUTPUT TO SPACES                       
                                                                                
IALL04   MVI   FLD1L,0             CLEAR INTERNAL FIELDS                        
         MVI   FLD1,SPACE                                                       
         MVC   FLD1+1(L'FLD1-1),FLD1                                            
         MVC   FLD2L(L'FLD1L+L'FLD1),FLD1L                                      
                                                                                
         MVI   SOFOVSTD,SPACE                                                   
         MVC   SOFOVSTD+1(L'SOFOVSTD+L'SOFOVEND-1),SOFOVSTD                     
                                                                                
         OC    SOFAINP2,SOFAINP2   TEST SECOND INPUT FIELD PASSED               
         BZ    IONE                                                             
         EJECT                                                                  
***********************************************************************         
* TWO TWA FIELDS INPUT                                                *         
***********************************************************************         
                                                                                
ITWO     TM    SOFIINDS,SOFIIONE   TEST VALIDATING SINGLE DATE                  
         BZ    *+6                                                              
         DC    H'0'                YES - CAN'T PASS TWO FIELDS                  
                                                                                
         ICM   R1,15,SOFAINP1      A(INPUT FIELD 1)                             
         BNZ   *+6                                                              
         DC    H'0'                                                             
         GOTOR XDATA               EXTRACT DATA AND SET LENGTH                  
         MVC   FLD1L(L'FLD1L+L'FLD1),WORK                                       
         BNZ   *+12                                                             
         OI    SOFOINDS,SOFOIF1I   SET FIELD 1 INPUT                            
         B     ITWO02                                                           
                                                                                
         TM    SOFIINDS,SOFIIF1O   TEST FIELD 1 OPTIONAL                        
         BNZ   ITWO02                                                           
         OI    SOFEINDS,SOFEIF1E   SET FIELD 1 IN ERROR                         
         B     EXITTST                                                          
                                                                                
ITWO02   ICM   R1,15,SOFAINP2      A(INPUT FIELD 2)                             
         BNZ   *+6                                                              
         DC    H'0'                                                             
         GOTOR XDATA               EXTRACT DATA AND SET LENGTH                  
         MVC   FLD2L(L'FLD2L+L'FLD2),WORK                                       
         BNZ   *+12                                                             
         OI    SOFOINDS,SOFOIF2I   SET FIELD 2 INPUT                            
         B     ITWO04                                                           
                                                                                
         TM    SOFIINDS,SOFIIF2O   TEST FIELD 2 OPTIONAL                        
         BNZ   *+12                                                             
         OI    SOFEINDS,SOFEIF2E   SET FIELD 2 IN ERROR                         
         B     EXITTST                                                          
                                                                                
         CLC   FLD1L,FLD2L         TEST ANY INPUT AT ALL                        
         BNE   ITWO04                                                           
         OI    SOFOINDS,SOFOINOI   SET NOTHING INPUT                            
         XC    SOFERROR,SOFERROR                                                
         B     EXITTST                                                          
                                                                                
ITWO04   TM    SOFIINDS,SOFIIHRD   TEST HARD DATES ALLOWED                      
         BZ    ISOFT                                                            
         TM    SOFIINDS,SOFIISFT   TEST SOFT DATES ALLOWED                      
         BZ    IHARD                                                            
                                                                                
         CLI   FLD1,SOFTSYM1       TEST FIELD IS A SOFT DATE EXPRESSION         
         BE    ISOFT                                                            
         CLI   FLD1,SOFTSYM2                                                    
         BE    ISOFT                                                            
         CLI   FLD2,SOFTSYM1                                                    
         BE    ISOFT                                                            
         CLI   FLD2,SOFTSYM2                                                    
         BE    ISOFT                                                            
         B     IHARD                                                            
         EJECT                                                                  
***********************************************************************         
* ONE TWA FIELD INPUT - SPLIT INTO TWO FIELDS UNLESS SOFIINDS BIT     *         
* SOFIIONE IS SET ON IN WHICH CASE THE FIELD IS EXPECTED TO CONTAIN   *         
* A SINGLE DATE EXPRESSION                                            *         
***********************************************************************         
                                                                                
IONE     ICM   R1,15,SOFAINP1      A(INPUT FIELD)                               
         BNZ   *+6                                                              
         DC    H'0'                                                             
                                                                                
         GOTOR XDATA               EXTRACT DATA AND SET LENGTH                  
         BZ    IONE02                                                           
         TM    SOFIINDS,SOFIIF1O+SOFIIF2O                                       
         BNO   EXITTST                                                          
         OI    SOFOINDS,SOFOINOI   SET NO INPUT                                 
         XC    SOFERROR,SOFERROR                                                
         B     EXITTST                                                          
                                                                                
IONE02   CLI   WORK+1,SOFTSYM1     TEST SOFT DATE EXPRESSION                    
         BE    *+8                                                              
         CLI   WORK+1,SOFTSYM2                                                  
         BNE   IHARD                                                            
                                                                                
         TM    SOFIINDS,SOFIISFT   TEST SOFT DATES ARE VALID                    
         BNZ   *+14                                                             
         MVC   SOFERROR,INVALID    NO - SET INVALID INPUT ERROR & EXIT          
         B     EXITTST                                                          
                                                                                
         SR    RE,RE                                                            
         IC    RE,WORK             RE=L'INPUT STRING                            
         LR    R0,RE               R0=SAVED LENGTH OF STRING                    
         LA    RF,WORK(RE)         RF=A(LAST CHARACTER OF INPUT)                
                                                                                
         CLI   0(RF),HYPHEN        TEST LAST BYTE IS A HYPHEN                   
         BNE   IONE06                                                           
         TM    SOFIINDS,SOFIIONE   TEST ONE DATE EXPECTED                       
         BZ    *+14                                                             
         MVC   SOFERROR,INVALID    YES - SET INVALID INPUT & EXIT               
         B     EXITTST                                                          
         TM    SOFIINDS,SOFIIF2O   TEST FIELD 2 IS OPTIONAL                     
         BNZ   IONE04                                                           
         MVC   SOFERROR,MISSING    SET MISSING INPUT                            
         OI    SOFEINDS,SOFEIF2E   SET FIELD 2 IN ERROR & EXIT                  
         B     EXITTST                                                          
                                                                                
IONE04   BCTR  RE,0                SET FIELD 1 VALUES ONLY                      
         STC   RE,FLD1L            (MINUS ONE FOR HYPHEN)                       
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   FLD1(0),WORK+1                                                   
         OI    SOFOINDS,SOFOIF1I   SET FIELD 1 INPUT                            
         B     ISOFT                                                            
                                                                                
IONE06   CLI   WORK+2,HYPHEN       TEST STARTS WITH A HYPHEN                    
         BNE   IONE10                                                           
         TM    SOFIINDS,SOFIIONE   TEST ONE DATE EXPECTED                       
         BZ    *+14                                                             
         MVC   SOFERROR,INVALID    YES - SET INVALID INPUT & EXIT               
         B     EXITTST                                                          
         TM    SOFIINDS,SOFIIF1O   TEST FIELD 1 IS OPTIONAL                     
         BNZ   IONE08                                                           
         MVC   SOFERROR,MISSING    SET MISSING INPUT FIELD                      
         OI    SOFEINDS,SOFEIF1E   SET FIELD 1 IN ERROR & EXIT                  
         B     EXITTST                                                          
                                                                                
IONE08   BCTR  RE,0                SET FIELD 2 VALUES ONLY                      
         STC   RE,FLD2L                                                         
         MVI   FLD2,SOFTSYM1                                                    
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   FLD2+1(0),WORK+3                                                 
         OI    SOFOINDS,SOFOIF2I   SET FIELD 2 INPUT                            
         B     ISOFT                                                            
                                                                                
IONE10   CLI   0(RF),HYPHEN        TEST HYPHEN                                  
         BNE   IONE12                                                           
         TM    1(RF),NUMERIC       TEST FOLLOWED BY A NUMBER                    
         BO    IONE12              YES - MUST BE A YEAR MODIFIER                
         CLI   1(RF),SPACE         TEST FOLLOWED BY DATA                        
         BH    IONE14                                                           
         MVC   SOFERROR,INVALID    SET INVALID INPUT FIELD & EXIT               
         B     EXITTST                                                          
                                                                                
IONE12   BCTR  RF,0                                                             
         BCT   RE,IONE10                                                        
         OI    SOFOINDS,SOFOIF1I   SET FIELD 1 INPUT                            
         MVC   FLD1L(L'FLD1L+L'FLD1),WORK                                       
         MVC   FLD2L(L'FLD2L+L'FLD2),WORK                                       
         B     ISOFT                                                            
                                                                                
IONE14   TM    SOFIINDS,SOFIIONE   TEST SINGLE EXPRESSION EXPECTED              
         BZ    *+14                                                             
         MVC   SOFERROR,INVALID    YES - EXIT WITH INVALID INPUT FIELD          
         B     EXITTST                                                          
                                                                                
         OI    SOFOINDS,SOFOIF1I+SOFOIF2I                                       
         SHI   RE,2                ADJUST FOR EXECTUE                           
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   FLD1(0),WORK+1      FIRST FIELD DATA                             
         AHI   RE,1                                                             
         STC   RE,FLD1L                                                         
                                                                                
         AHI   RE,2                                                             
         SR    R0,RE                                                            
         LR    RE,R0               RE=L'SECOND HALF OF FIELD-1                  
         AHI   RF,1                RF=A(1ST CHARACTER OF 2ND FIELD)             
         CLI   0(RF),SOFTSYM1      TEST 2ND FIELD STARTS WITH SOFT CHAR         
         BE    IONE16                                                           
         CLI   0(RF),SOFTSYM2                                                   
         BE    IONE16                                                           
                                                                                
         MVI   FLD2,SOFTSYM1       NO - INSERT ONE AND TACK ON DATA             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   FLD2+1(0),0(RF)                                                  
         AHI   RE,2                1 FOR EXECUTE AND 1 FOR SOFT CHAR            
         STC   RE,FLD2L                                                         
         B     ISOFT                                                            
                                                                                
IONE16   EX    RE,*+8              2ND FIELD STARTS WITH SOFT CHAR              
         B     *+10                                                             
         MVC   FLD2(0),0(RF)                                                    
         AHI   RE,1                                                             
         STC   RE,FLD2L                                                         
         B     ISOFT                                                            
         EJECT                                                                  
***********************************************************************         
* SOFT DATE VALIDATION                                                *         
*                                                                     *         
* NTRY - FLD1L/FLD1 SET TO LENGTH OF START DATE/START EXPRESSION      *         
*        FLD2L/FLD2 SET TO LENGTH OF END DATE/END EXPRESSION          *         
*        DATILEN SET TO LENGTH OF OUTPUT DATE                         *         
***********************************************************************         
                                                                                
ISOFT    ICM   R5,15,SOFAOUT       R5=A(OUTPUT AREA)                            
         OI    SOFOINDS,SOFOISFT   SET SOFT DATE INPUT                          
         OI    INDS,INDSSOFT       SET GLOBAL SOFT DATE FLAG                    
         CLI   FLD1L,0             TEST INPUT IN FIELD 1                        
         BNE   ISOFT02                                                          
         SR    RE,RE                                                            
         IC    RE,DATILEN                                                       
         AR    R5,RE               POINT TO SECOND DATE IN PAIR                 
         B     ISOFT06                                                          
                                                                                
ISOFT02  MVI   FLDNUM,1            SET FIELD 1 VALIDATION                       
         GOTOR VSOFT,FLD1L         VALIDATE FIRST EXPRESSION                    
         BE    *+12                                                             
         OI    SOFEINDS,SOFEIF1E   SET FIELD 1 IN ERROR                         
         B     EXITTST                                                          
                                                                                
         MVC   SOFOVSTD,ODATE      SAVE START DATE                              
         SR    RE,RE                                                            
         IC    RE,DATILEN                                                       
         SHI   RE,L'SDATE          RIGHT ALIGN DATE AND PAD WITH                
         BZ    ISOFT04             BINARY ZEROES                                
         LR    RF,RE                                                            
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     ISOFT04                                                          
         XC    0(0,R5),0(R5)                                                    
ISOFT04  AR    R5,RE               POINT TO SOFT DATE                           
         MVC   0(L'SDATE,R5),SDATE MOVE SOFT START TO OUTPUT AREA               
         AHI   R5,L'SDATE          AND BUMP TO END DATE                         
                                                                                
ISOFT06  TM    SOFIINDS,SOFIIONE   TEST SINGLE EXPRESSION VALIDATION            
         BNZ   ISOFT10                                                          
         CLI   FLD2L,0             TEST FIELD 2 PRESENT                         
         BE    ISOFT10                                                          
                                                                                
         MVI   FLDNUM,2            SET FIELD 1 VALIDATION                       
         GOTOR VSOFT,FLD2L         VALIDATE SECOND EXPRESSION                   
         BE    *+12                                                             
         OI    SOFEINDS,SOFEIF2E   SET FIELD 2 IN ERROR                         
         B     EXITTST                                                          
                                                                                
         MVC   SOFOVEND,ODATE      SAVE END DATE                                
         SR    RE,RE                                                            
         IC    RE,DATILEN                                                       
         SHI   RE,L'SDATE          RIGHT ALIGN DATE AND PAD WITH                
         BZ    ISOFT08             BINARY ZEROES                                
         LR    RF,RE                                                            
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     ISOFT08                                                          
         XC    0(0,R5),0(R5)                                                    
ISOFT08  AR    R5,RE               POINT TO SOFT DATE                           
         MVC   0(L'SDATE,R5),SDATE MOVE SOFT END TO OUTPUT AREA                 
                                                                                
ISOFT10  TM    SOFIINDS,SOFIIRES   TEST RESOLVE SOFT DATE NOW                   
         BZ    ISOFT12                                                          
         CLI   PASS,0              TEST VALIDATION PASS                         
         BE    ISOFT12                                                          
         ICM   R3,15,SOFAOUT       R3=A(INPUT SOFT DATE)                        
         LR    R5,R3               R5=A(OUTPUT HARD DATE)                       
         OI    SFLAG,SFLAGRES                                                   
         B     SALL02              GO TO SOFT CONVERSION CODE                   
                                                                                
ISOFT12  GOTOR SETDMY              CALCULATE PERIOD                             
                                                                                
ISOFTX   B     EXITTST                                                          
         EJECT                                                                  
***********************************************************************         
* HARD DATE VALIDATION                                                *         
***********************************************************************         
                                                                                
IHARD    TM    SOFIINDS,SOFIIHRD   TEST HARD DATE IS VALID                      
         BNZ   *+14                                                             
         MVC   SOFERROR,INVALID    NO - SET INVALID INPUT ERROR & EXIT          
         B     EXITTST                                                          
         OI    SOFOINDS,SOFOIHRD   SET HARD DATE INPUT                          
                                                                                
         ICM   R1,15,SOFAINP1      POINT TO FIRST INPUT FIELD                   
         GOTOR XDATA               EXTRACT DATA AND LENGTH INTO WORK            
         BNZ   IHARD02                                                          
         MVC   FLD1L(L'FLD1L+L'FLD1),WORK                                       
         B     IHARD06                                                          
                                                                                
IHARD02  ICM   R1,15,SOFAINP2      TEST TWO FIELDS PASSED                       
         BNZ   IHARD04                                                          
         TM    SOFIINDS,SOFIIF1O+SOFIIF2O                                       
         BNO   EXITTST                                                          
         OI    SOFOINDS,SOFOINOI   SET NO INPUT                                 
         XC    SOFERROR,SOFERROR                                                
         B     EXITTST                                                          
                                                                                
IHARD04  TM    SOFIINDS,SOFIIF1O   TEST FIELD 1 OPTIONAL                        
         BNZ   *+12                                                             
         OI    SOFEINDS,SOFEIF1E   SET FIELD 1 INVALID ON ERROR                 
         B     EXITTST                                                          
         MVI   FLD1L,1                                                          
         MVI   FLD1,HYPHEN                                                      
         B     IHARD10                                                          
                                                                                
IHARD06  TM    SOFIINDS,SOFIIONE   TEST SINGLE DATE ONLY VALID                  
         BNZ   IHARD16                                                          
         ICM   R1,15,SOFAINP2      POINT TO SECOND INPUT FIELD                  
         BNZ   IHARD10                                                          
                                                                                
         SR    RF,RF               TEST SPLIT FIELD (START-END)                 
         IC    RF,FLD1L                                                         
         LA    RE,FLD1                                                          
IHARD08  CLI   0(RE),HYPHEN                                                     
         BE    IHARD16                                                          
         AHI   RE,1                                                             
         BCT   RF,IHARD08                                                       
                                                                                
         IC    RF,FLD1L            NO SPLIT CHARACTER FOUND                     
         LA    RE,FLD1(RF)                                                      
         MVI   0(RE),HYPHEN        MANUFACTURE START-START                      
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   1(0,RE),FLD1                                                     
         AHI   RF,1                ADD BACK THE ONE FOR EXECUTE                 
         SLL   RF,1                MULTIPLY BY TWO                              
         AHI   RF,1                ADD ONE FOR SPLIT CHRACTER                   
         STC   RF,FLD1L            TO GIVE THE TOTAL FIELD LENGTH               
         OI    SOFOINDS,SOFOIF2I                                                
         B     IHARD16                                                          
                                                                                
IHARD10  GOTOR XDATA               EXTRACT DATA AND LENGTH INTO WORK            
         BNZ   *+12                                                             
         OI    SOFOINDS,SOFOIF2I                                                
         B     IHARD14                                                          
                                                                                
         TM    SOFIINDS,SOFIIF2O   TEST FIELD 2 OPTIONAL                        
         BNZ   *+12                                                             
         OI    SOFEINDS,SOFEIF2E   SET FIELD 2 INVALID ON ERROR                 
         B     EXITTST                                                          
                                                                                
         TM    SOFOINDS,SOFOIF1I   TEST FIELD 1 INPUT                           
         BNZ   IHARD12                                                          
         OI    SOFOINDS,SOFOINOI   SET NO INPUT                                 
         XC    SOFERROR,SOFERROR                                                
         B     EXITTST                                                          
                                                                                
IHARD12  MVI   FLD2L,1                                                          
         MVI   FLD2,HYPHEN                                                      
                                                                                
IHARD14  SR    RE,RE               CONCATENATE THE TWO INPUT FIELDS             
         IC    RE,FLD1L                                                         
         LA    R1,FLD1(RE)                                                      
         MVI   0(R1),HYPHEN                                                     
         SR    RF,RF                                                            
         IC    RF,WORK                                                          
         LA    RE,1(RE,RF)                                                      
         STC   RE,FLD1L                                                         
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     IHARD16                                                          
         MVC   1(0,R1),WORK+1                                                   
                                                                                
IHARD16  SR    RF,RF                                                            
         IC    RF,FLD1L                                                         
         CLI   YMDFILT,SOFTYMD     TEST YEAR/MONTH/DAY IS VALID                 
         BNE   *+8                                                              
         LA    RF,PVALDDMM(RF)     YES - SET TO VALIDATE FOR DDMM               
         SR    R0,R0                                                            
         TM    SOFIINDS,SOFIIONE   TEST SINGLE DATE VALID                       
         BZ    IHARD18                                                          
         LA    R0,PVINSGLO+PVINSGLS                                             
         TM    IINDS,SOFITEND      TEST SINGLE DATE IS END DATE                 
         BZ    IHARD18                                                          
         LA    R0,PVINSGLO         SET SINGLE DATE ONLY                         
                                                                                
IHARD18  SR    RE,RE                                                            
         IC    RE,SOFLANG                                                       
         OR    R0,RE               SET LANGUAGE TOO                             
         LA    R3,WORK                                                          
         USING PERVALD,R3                                                       
         GOTOR VPERVAL,DMCB,((RF),FLD1),((R0),PERVALD)                          
                                                                                
         MVI   BYTE1,SOFOIF1I+SOFOIF2I                                          
         CLI   4(R1),PVRCOK                                                     
         BE    IHARD20                                                          
                                                                                
         CLI   4(R1),PVRCONE                                                    
         BNE   *+12                                                             
         MVI   BYTE1,SOFOIF1I      SET ONE FIELD INPUT                          
         B     IHARD20                                                          
                                                                                
         MVC   SOFERROR,INVALID                                                 
         TM    4(R1),PVRCINV1      TEST/SET FIELD 1 INVALID                     
         BZ    *+8                                                              
         OI    SOFEINDS,SOFEIF1E                                                
         TM    4(R1),PVRCINV2      TEST/SET FIELD 2 INVALID                     
         BZ    *+8                                                              
         OI    SOFEINDS,SOFEIF2E                                                
         B     EXITTST                                                          
                                                                                
IHARD20  CLI   YMDFILT,SOFTYM      TEST YEAR/MONTH ONLY                         
         BNE   IHARD22                                                          
         LHI   RE,PVALASD+PVALAED  YES - ENSURE USER DIDN'T ENTER DAY           
         TM    SOFIINDS,SOFIIONE                                                
         BZ    *+8                                                              
         LHI   RE,PVALASD                                                       
         EX    RE,*+8                                                           
         BO    IHARD22                                                          
         TM    PVALASSM,0                                                       
         MVC   SOFERROR,INVALID    ERROR IF S/HE DID                            
         B     EXITTST                                                          
                                                                                
IHARD22  OC    SOFOINDS,BYTE1      TURN ON OUTPUT BITS IN BLOCK                 
         SR    R1,R1                                                            
         IC    R1,DATILEN                                                       
         BCTR  R1,0                R1=OUTPUT DATA LENGTH-1                      
         ICM   RE,15,SOFAOUT       RE=A(CALLER'S OUTPUT AREA)                   
         SR    RF,RF                                                            
         IC    RF,PERDSPF1                                                      
         LA    RF,PERVALD(RF)      RF=A(START DATE)                             
                                                                                
         TM    PVALASSM,PVALASD+PVALASM+PVALASY                                 
         BNO   IHARD24                                                          
         TM    SOFIINDS,SOFIIF1O   TEST FIELD 1 OPTIONAL                        
         BNZ   IHARD30                                                          
         MVC   SOFERROR,MISSING    NO - SET MISSING INPUT & EXIT                
         OI    SOFEINDS,SOFEIF1E                                                
         B     EXITTST                                                          
                                                                                
IHARD24  TM    PVALASSM,PVALASD    IF START DAY WAS INPUT THEN USE              
         BNZ   *+8                 START DATE FOR SINGLE DATE                   
         NI    IINDS,ALLBITS-(SOFITEND)                                         
         TM    IINDS,SOFITEND      TEST SINGLE IS END DATE                      
         BNZ   IHARD32                                                          
                                                                                
         MVC   SOFOVSTD,PVALESTA   SET START DATE                               
                                                                                
         CLI   OTYPE,SOFOTSD8      TEST LONG JULIAN DATE                        
         BE    *+12                                                             
         CLI   OTYPE,SOFOTSD9      TEST SHORT JULIAN DATE                       
         BNE   IHARD26                                                          
         STM   RE,R1,SAVERER1      YES - CALL DATCON TO CONVERT                 
         GOTOR VDATCON,DMCB,(0,PVALESTA),(DATTYPEO,PVALJLST)                    
         LM    RE,R1,SAVERER1                                                   
                                                                                
IHARD26  CLI   OTYPE,SOFOTSD2      TEST 6 BYTE EBCDIC OUTPUT                    
         BNE   IHARD28                                                          
         CLI   YMDFILT,SOFTYM      AND YEAR/MONTH ONLY                          
         BNE   IHARD28                                                          
         TM    OINDS,SOFOTSPC      AND USER WANTS SPACES IN DAY                 
         BZ    IHARD28                                                          
         MVC   0(L'ODATEYY+L'ODATEMM,RE),0(RF)                                  
         B     IHARD30                                                          
                                                                                
IHARD28  EX    R1,*+8                                                           
         B     IHARD30                                                          
         MVC   0(0,RE),0(RF)       MOVE DATA TO USER'S OUTPUT AREA              
                                                                                
IHARD30  TM    SOFIINDS,SOFIIONE   TEST SINGLE DATE EXPRESSION                  
         BNZ   IHARD42                                                          
         LA    RE,1(RE,R1)         POINT TO SECOND OUTPUT DATE                  
                                                                                
IHARD32  SR    RF,RF               POINT TO END DATE                            
         IC    RF,PERDSPF2                                                      
         LA    RF,PERVALD(RF)      RF=A(END DATE)                               
                                                                                
         TM    IINDS,SOFITEND      TEST SINGLE IS END DATE                      
         BNZ   IHARD34                                                          
                                                                                
         TM    PVALASSM,PVALAED+PVALAEM+PVALAEY                                 
         BNO   IHARD34                                                          
         TM    SOFIINDS,SOFIIF2O   TEST FIELD 2 OPTIONAL                        
         BNZ   IHARD42                                                          
         MVC   SOFERROR,MISSING    NO - SET MISSING INPUT & EXIT                
         OI    SOFEINDS,SOFEIF2E                                                
         B     EXITTST                                                          
                                                                                
IHARD34  MVC   SOFOVEND,PVALEEND   SET END DATE                                 
                                                                                
         CLI   OTYPE,SOFOTSD8      TEST LONG JULIAN DATE                        
         BE    *+12                                                             
         CLI   OTYPE,SOFOTSD9      TEST SHORT JULIAN DATE                       
         BNE   IHARD36                                                          
         STM   RE,R1,SAVERER1      YES - CALL DATCON TO CONVERT                 
         GOTOR VDATCON,DMCB,(0,PVALEEND),(DATTYPEO,PVALJLND)                    
         LM    RE,R1,SAVERER1                                                   
                                                                                
IHARD36  CLI   OTYPE,SOFOTSD2      TEST 6 BYTE EBCDIC OUTPUT                    
         BNE   IHARD38                                                          
         CLI   YMDFILT,SOFTYM      AND YEAR/MONTH ONLY                          
         BNE   IHARD38                                                          
         TM    OINDS,SOFOTSPC      AND USER WANTS SPACES IN DAY                 
         BZ    IHARD38                                                          
         MVC   0(L'ODATEYY+L'ODATEMM,RE),0(RF)                                  
         B     IHARD40                                                          
                                                                                
IHARD38  EX    R1,*+8                                                           
         B     IHARD40                                                          
         MVC   0(0,RE),0(RF)       MOVE DATA TO USER'S OUTPUT AREA              
                                                                                
IHARD40  TM    IINDS,SOFITEND      TEST SINGLE DATE IS END DATE                 
         BNZ   IHARD42                                                          
                                                                                
         GOTOR SETDMY              CALCULATE PERIOD                             
                                                                                
IHARD42  TM    SOFIINDS,SOFIIOUT   TEST CALLER WANTS OUTPUT EXPANDED            
         BZ    IHARDX                                                           
         CLI   PASS,0              TEST VALIDATION CALL                         
         BE    IHARDX                                                           
         L     R5,SOFAINP                                                       
         L     R3,SOFAOUT                                                       
         MVC   ITYPE,OTYPE                                                      
         B     PALL02                                                           
                                                                                
IHARDX   B     EXITTST                                                          
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* HANDLE DATE CONVERSIONS                                             *         
***********************************************************************         
                                                                                
SALL     SR    RE,RE                                                            
         IC    RE,ITYPE                                                         
         LA    RF,LENTAB-L'LENTAB(RE)                                           
         MVC   DATILEN,0(RF)       SET INPUT/OUTPUT DATA LENGTH                 
         LA    RF,INDTAB-L'INDTAB(RE)                                           
         OC    OINDS,0(RF)         SET PRINT INDICATORS                         
         SLL   RE,1                                                             
         LA    RF,TYPTAB-L'TYPTAB(RE)                                           
         MVC   DATTYPE,0(RF)       SET DATCON INPUT/OUTPUT DATA TYPE            
                                                                                
         ICM   R3,15,SOFAINP       NOW EXPLODE DATES                            
         BNZ   *+6                                                              
         DC    H'0'                                                             
         CLI   OTYPE,SOFOTPRT      TEST OUTPUT IN PRINTABLE FORMAT 1            
         BE    PALL                                                             
         CLI   OTYPE,SOFOTPR2      TEST OUTPUT IN PRINTABLE FORMAT 2            
         BE    PALL                                                             
                                                                                
         ICM   R5,15,SOFAOUT       R5=A(OUTPUT AREA)                            
         BNZ   SALL02                                                           
         LR    R5,R3               SET R5=A(INPUT) IF NOT GIVEN                 
                                                                                
SALL02   SR    R4,R4                                                            
         IC    R4,DATILEN                                                       
         SHI   R4,L'SDATE                                                       
                                                                                
         LA    R1,0(R3,R4)         R1=A(2 BYTE SOFT DATE)                       
                                                                                
         MVI   FLDNUM,1            SET FIELD 1 VALIDATION                       
         GOTOR CDATE               EXPLODE FIRST DATE                           
         MVC   SOFOVSTD,ODATE      SAVE START DATE                              
         BNE   SALL06              NOT SOFT - CAN'T CONVERT FORMAT              
                                                                                
         ICM   R0,1,DATTYPEO       CONVERT FORMATS IF REQUIRED                  
         BZ    SALL04                                                           
         GOTOR VDATCON,DMCB,(0,ODATE),((R0),WORK)                               
         MVC   ODATE,WORK          AND SET AS ODATE                             
                                                                                
SALL04   CLI   PASS,0              TEST VALIDATION PASS                         
         BE    SALL06                                                           
         SR    RE,RE               MOVE TO OUTPUT AREA                          
         IC    RE,DATILEN                                                       
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     SALL06                                                           
         MVC   0(0,R5),ODATE                                                    
                                                                                
SALL06   SR    RE,RE               MOVE TO OUTPUT AREA                          
         IC    RE,DATILEN                                                       
         AR    R3,RE               POINT TO SECOND DATE IN INPUT                
         LA    R1,0(R3,R4)         POINT TO SOFT DATE EXPRESSION                
         AR    R5,RE               POINT TO SECOND DATE IN OUTPUT               
                                                                                
         TM    SOFIINDS,SOFIIONE   TEST SINGLE EXPRESSION INPUT                 
         BNZ   SALLX                                                            
                                                                                
         MVI   FLDNUM,2            SET FIELD 2 VALIDATION                       
         GOTOR CDATE               EXPLODE SECOND DATE                          
         MVC   SOFOVEND,ODATE      SAVE END DATE                                
         BNE   SALLX               NOT SOFT - CAN'T CONVERT FORMAT              
                                                                                
         ICM   R0,1,DATTYPEO       CONVERT FORMATS IF REQUIRED                  
         BZ    SALL08                                                           
         GOTOR VDATCON,DMCB,(0,ODATE),((R0),WORK)                               
         MVC   ODATE,WORK          AND SET AS ODATE                             
                                                                                
SALL08   CLI   PASS,0              TEST VALIDATION PASS                         
         BE    SALL10                                                           
         SR    RE,RE               MOVE TO OUTPUT AREA                          
         IC    RE,DATILEN                                                       
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     SALL10                                                           
         MVC   0(0,R5),ODATE                                                    
                                                                                
SALL10   GOTOR SETDMY              CALCULATE PERIOD                             
         BNZ   EXITTST                                                          
                                                                                
SALLX    TM    SFLAG,SFLAGRES      TEST HERE FOR VALIDATION                     
         BZ    EXITTST                                                          
         L     R5,SOFAINP          R5=A(1ST INPUT FIELD HEADER)                 
         L     R3,SOFAOUT          R3=A(REQUEST DATES)                          
         MVC   ITYPE,OTYPE         SET INPUT TYPE FOR PDATE ROUTINE             
         B     PALL02                                                           
         EJECT                                                                  
***********************************************************************         
* CONVERT DATES INTO PRINTABLE FORMAT                                 *         
***********************************************************************         
                                                                                
PALL     ICM   R5,15,SOFAOUT       R5=A(1ST OUTPUT AREA)                        
         BNZ   PALL02                                                           
         DC    H'0'                                                             
                                                                                
PALL02   ST    R5,AOUT             SAVE A(FIRST OUTPUT FIELD)                   
         SR    R1,R1               START DATE                                   
         IC    R1,DATILEN                                                       
         SHI   R1,L'SDATE                                                       
         AR    R1,R3               R1=A(FIRST DATE)                             
         GOTOR CLRFLD              CLEAR FIRST OUTPUT FIELD                     
         MVI   FLDNUM,1                                                         
         GOTOR PDATE               CONVERT TO PRINTABLE FORMAT                  
                                                                                
         TM    SOFIINDS,SOFIIONE   TEST SINGLE DATE FIELD                       
         BNZ   PALLX                                                            
                                                                                
         ICM   R0,15,SOFAOUT2      TEST SECOND FIELD PRESENT                    
         BZ    *+10                                                             
         LR    R5,R0                                                            
         GOTOR CLRFLD              CLEAR SECOND OUTPUT FIELD                    
         MVI   FLDNUM,2                                                         
                                                                                
         SR    RE,RE                                                            
         IC    RE,DATILEN                                                       
         AR    R1,RE               R1=A(SECOND SOFT DATE EXPRESSION)            
         LA    RF,0(R3,RE)         POINT TO SECOND DATE                         
         BCTR  RE,0                                                             
         C     R5,AOUT             TEST ONE OUTPUT FIELD                        
         BNE   PALL04                                                           
         EX    RE,PALLCOMP         YES - TEST START/END ARE THE SAME            
         BE    PALLX                                                            
                                                                                
PALL04   LA    R3,1(RE,R3)         R3=A(SECOND DATE IN PERIOD)                  
         GOTOR PDATE               CONVERT TO PRINTABLE FORMAT                  
                                                                                
PALLX    B     EXITTST                                                          
                                                                                
PALLCOMP CLC   0(0,R3),0(RF)       COMPARE START/END DATES                      
         EJECT                                                                  
***********************************************************************         
* EXPLODE A SINGLE SOFT DATE EXPRESSION                               *         
*                                                                     *         
* NTRY - R1=A(2 BYTE DATE), FLDNUM=1 (START DATE) OR 2 (END DATE)     *         
* EXIT - CC=EQUAL WITH ODATE SET TO CALCULATED DATE (YYMMDD EBCDIC)   *         
*           IF INPUT WAS A SOFT DATE EXPRESSION                       *         
*        CC=NOT EQUAL WITH ODATE SET TO SPACES/BINARY ZEROES/X'FF'S   *         
*           IF INPUT NOT A SOFT DATE EXPRESSION                       *         
***********************************************************************         
                                                                                
CDATE    NTR1  ,                                                                
         TM    0(R1),SDATTST       TEST SOFT DATE                               
         BNZ   CDATEN                                                           
         CLI   1(R1),LOVALUE                                                    
         BE    CDATEN                                                           
         OI    INDS,INDSSOFT       SET GLOBAL SOFT DATE FLAG                    
         MVC   BYTE1,0(R1)                                                      
         NI    BYTE1,SDATVAL       MAXIMUM YEAR MODIFIER                        
         SR    RE,RE                                                            
         IC    RE,BYTE1                                                         
         TM    0(R1),SDATNEG       TEST NEGATIVE MODIFIER                       
         BZ    *+6                                                              
         LNR   RE,RE                                                            
         STCM  RE,15,YEARMOD       SAVE MODIFIER AS SIGNED FULLWORD             
         OC    YEARMOD,YEARMOD     TEST YEAR MODIFIER PRESENT                   
         BZ    *+8                                                              
         OI    INDS,INDSYRMO       YES - SET GLOBAL FLAG                        
                                                                                
         SR    R6,R6                                                            
         ICM   R6,1,1(R1)          R6=SOFT WORD NUMBER                          
         BNZ   *+6                                                              
         DC    H'0'                                                             
         SHI   R6,SDATBASE+1                                                    
         SLL   R6,2                ((NUMBER-1)*4)                               
         A     R6,ASOFTAB          R6=A(SOFTAB TABLE ENTRY)                     
         USING SOFTABD,R6                                                       
         MVC   ODATE,TODAY1                                                     
         CLI   FLDNUM,2            TEST PROCESSING END DATE                     
         BNE   CDATE02                                                          
         MVC   ODATE,TODAY2                                                     
         TM    SOFTIND1,SOFTPMON   TEST PRIOR MONTH EXPRESSION                  
         BZ    CDATE02                                                          
         OI    INDS,INDSPMON       SET GLOBAL INDICATOR                         
         EJECT                                                                  
***********************************************************************         
* HANDLE YEAR/MONTH EXPRESSIONS                                       *         
***********************************************************************         
                                                                                
CDATE02  TM    SOFTIND2,SOFTYM     TEST YEAR/MONTH EXPRESSION                   
         BZ    CDATE20                                                          
         MVC   ODATEDD,DAY01                                                    
                                                                                
         GOTOR BLDMON              BUILD LIST OF MONTHS                         
                                                                                
         TM    SOFTIND2,SOFTFISC   TEST BASED ON FISCAL MONTHS (ACC)            
         BZ    *+8                                                              
         GOTOR BLDFSC                                                           
                                                                                
         TM    SOFTIND3,SOFTABSM   TEST ABSOLUTE MONTH                          
         BZ    CDATE04                                                          
         SR    R1,R1                                                            
         IC    R1,SOFTMOD                                                       
         BCTR  R1,0                                                             
         SLL   R1,2                                                             
         LA    RE,MONLST                                                        
         TM    SOFTIND2,SOFTFISC   TEST BASED ON FISCAL MONTH                   
         BZ    *+8                                                              
         LA    RE,FSCLST                                                        
         AR    RE,R1                                                            
         MVC   ODATE(L'MONLST),0(RE)                                            
         B     CDATE10                                                          
                                                                                
CDATE04  TM    SOFTIND3,SOFTRELH+SOFTRELQ                                       
         BZ    CDATE10                                                          
                                                                                
         LA    RE,MONLST           FIND MONTH IN APPROPRIATE LIST               
         TM    SOFTIND2,SOFTFISC                                                
         BZ    *+8                                                              
         LA    RE,FSCLST                                                        
         LR    RF,RE                                                            
         LHI   R0,MONSYEAR                                                      
CDATE06  CLC   ODATE(L'MONLST),0(RE)                                            
         BE    *+14                                                             
         AHI   RE,L'MONLST                                                      
         BCT   R0,CDATE06                                                       
         DC    H'0'                                                             
                                                                                
         TM    SOFTIND3,SOFTRELH   TEST RELATIVE TO HALF YEAR                   
         BZ    CDATE08                                                          
                                                                                
         LA    R1,6*L'MONLST(RF)                                                
         CR    RE,R1               TEST 2ND HALF-YEAR                           
         BNL   *+6                                                              
         LR    R1,RF               MUST BE 1ST HALF-YEAR                        
         MVC   ODATE(L'MONLST),0(R1)                                            
         B     CDATE10                                                          
                                                                                
CDATE08  LA    R1,9*L'MONLST(RF)   TEST 4TH QUARTER                             
         CR    RE,R1                                                            
         BNL   *+10                                                             
         LA    R1,6*L'MONLST(RF)   TEST 3RD QUARTER                             
         CR    RE,R1                                                            
         BNL   *+10                                                             
         LA    R1,3*L'MONLST(RF)   TEST 2ND QUARTER                             
         CR    RE,R1                                                            
         BNL   *+6                                                              
         LR    R1,RF               MUST BE 1ST QUARTER                          
         MVC   ODATE(L'MONLST),0(R1)                                            
                                                                                
CDATE10  TM    SOFTIND3,SOFTSPCL   TEST MODIFY MONTH                            
         BNO   *+6                                                              
         DC    H'0'                BAD TABLE ENTRY                              
         BZ    CDATE12                                                          
         SR    RF,RF                                                            
         IC    RF,SOFTMOD                                                       
         TM    SOFTIND3,SOFTSUB                                                 
         BZ    *+6                                                              
         LNR   RF,RF                                                            
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,(RF)                          
         MVC   ODATE(L'MONLST),WORK                                             
                                                                                
CDATE12  TM    SOFTIND2,SOFTMODY   TEST YEAR MODIFIER ALLOWED                   
         BZ    CDATE14                                                          
         ICM   RF,15,YEARMOD       TEST MODIFY VALUE                            
         BZ    CDATE14                                                          
         GOTOR VADDAY,DMCB,('ADDYEARQ',ODATE),WORK,(RF)                         
         MVC   ODATE(L'MONLST),WORK                                             
                                                                                
CDATE14  CLI   FLDNUM,2            TEST FIELD 2 VALIDATION                      
         BNE   CDATEYES                                                         
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,32                            
         MVC   WORK+ODATEDD-ODATE(L'ODATEDD),DAY01                              
         GOTOR (RF),(R1),('ADDDAYQ',WORK),ODATE,-1                              
         B     CDATEYES                                                         
         EJECT                                                                  
***********************************************************************         
* HANDLE YEAR/MONTH/DAY EXPRESSIONS                                   *         
***********************************************************************         
                                                                                
CDATE20  TM    SOFTIND3,SOFTRELM   HANDLE RELATIVE TO START OF MONTH            
         BZ    CDATE22                                                          
         MVC   ODATEDD,DAY01                                                    
         B     CDATE28                                                          
                                                                                
CDATE22  TM    SOFTIND3,SOFTRELD   TEST RELATIVE TO TODAY                       
         BNZ   CDATE28                                                          
                                                                                
         TM    SOFTIND3,SOFTRELW   HANDLE RELATIVE TO START OF WEEK             
         BZ    CDATE30                                                          
         MVC   DOWBASE,SOFSDOW     TEST START DAY OF WEEK GIVEN                 
         CLI   DOWBASE,0                                                        
         BNE   *+8                                                              
         MVI   DOWBASE,1           NO - SET DEFAULT TO MONDAY                   
         GOTOR VGETDAY,DMCB,ODATE,WORK                                          
         MVC   DOW,0(R1)           SAVE CURRENT DAY                             
         CLI   DOW,0               AND TEST IF VALID                            
         BNE   *+6                                                              
         DC    H'0'                DIE IF IT ISN'T                              
         CLC   DOW,DOWBASE         TEST WE ARE AT START OF WEEK                 
         BE    CDATE28                                                          
         BH    CDATE24             TODAY IS HIGHER THAN BASE                    
                                                                                
         SR    RF,RF               TODAY LOWER THAN BASE - BACK UP              
         IC    RF,DOW                                                           
         AHI   RF,DAYSWEEK                                                      
         SR    RE,RE                                                            
         IC    RE,DOWBASE                                                       
         SR    RF,RE                                                            
         B     CDATE26                                                          
                                                                                
CDATE24  SR    RF,RF               TODAY HIGHER THAN BASE                       
         IC    RF,DOW                                                           
         SR    RE,RE                                                            
         IC    RE,DOWBASE                                                       
         SR    RF,RE                                                            
                                                                                
CDATE26  LNR   RF,RF               CALCULATE START DAY OF WEEK                  
         GOTOR VADDAY,DMCB,ODATE,WORK,(RF)                                      
         MVC   ODATE,WORK                                                       
                                                                                
CDATE28  TM    SOFTIND3,SOFTSPCL   APPLY DAY MODIFIER                           
         BNO   *+6                                                              
         DC    H'0'                                                             
         BZ    CDATE40                                                          
         SR    RF,RF                                                            
         IC    RF,SOFTMOD                                                       
         TM    SOFTIND3,SOFTSUB                                                 
         BZ    *+6                                                              
         LNR   RF,RF                                                            
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,(RF)                          
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
***********************************************************************         
* HANDLE SPECIAL YEAR/MONTH/DAY EXPRESSIONS                           *         
***********************************************************************         
                                                                                
CDATE30  TM    SOFTIND3,SOFTSPCL   HANDLE SPECIAL DATES                         
         BO    *+6                                                              
         DC    H'0'                                                             
         SR    RE,RE                                                            
         IC    RE,SOFTMOD                                                       
         SLL   RE,2                                                             
         B     *+0(RE)                                                          
                                                                                
         B     CDATSPM             START OF PREVIOUS MONTH                      
         B     CDATECM             END OF CURRENT MONTH                         
         B     CDATSNM1            START OF NEXT MONTH                          
         B     CDATENM1            END OF NEXT MONTH                            
         B     CDATSY              START OF YEAR                                
         B     CDATEY              END OF YEAR                                  
         B     CDATNBD             NEXT BUSINESS DAY                            
         B     CDATSPBM            START OF PREVIOUS BROADCAST MONTH            
         B     CDATEPBM            END OF PREVIOUS BROADCAST MONTH              
         B     CDATSCBM            START OF CURRENT BROADCAST MONTH             
         B     CDATECBM            END OF CURRENT BROADCAST MONTH               
         B     CDATSNBM            START OF NEXT BROADCAST MONTH                
         B     CDATENBM            END OF NEXT BROADCAST MONTH                  
         B     CDATSPM2            START OF PREVIOUS MONTH-1                    
         B     CDATSPM3            START OF PREVIOUS MONTH-2                    
         B     CDATEPM2            END OF PREVIOUS MONTH-1                      
         B     CDATEPM3            END OF PREVIOUS MONTH-2                      
         B     CDATSPB2            START OF PREVIOUS BROADCAST MONTH-1          
         B     CDATEPB2            END OF PREVIOUS BROADCAST MONTH-1            
         B     CDATSBY             START OF BROADCAST YEAR                      
         B     CDATEBY             END OF BROADCAST YEAR                        
         B     CDATSNM2            START OF NEXT MONTH+1                        
         B     CDATENM2            END OF NEXT MONTH+1                          
         B     CDATSNM3            START OF NEXT MONTH+2                        
         B     CDATENM3            END OF NEXT MONTH+2                          
         B     CDATSPM4            START OF PREVIOUS MONTH-3                    
         B     CDATSPM5            START OF PREVIOUS MONTH-4                    
         B     CDATSPM6            START OF PREVIOUS MONTH-5                    
         B     CDATSPM7            START OF PREVIOUS MONTH-6                    
         B     CDATSPM8            START OF PREVIOUS MONTH-7                    
         B     CDATSPM9            START OF PREVIOUS MONTH-8                    
         B     CDATSPM10           START OF PREVIOUS MONTH-9                    
         B     CDATSPM11           START OF PREVIOUS MONTH-10                   
         B     CDATSPM12           START OF PREVIOUS MONTH-11                   
         B     CDATSPB18           START OF PREVIOUS BROADCAST MONTH-18         
         B     CDATSPM18           START OF PREVIOUS MONTH-18                   
                                                                                
CDATSPM  MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH                      
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-1                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATECM  MVC   ODATEDD,DAY01       END OF CURRENT MONTH                         
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,32                            
         MVC   WORK+ODATEDD-ODATE(L'ODATEDD),DAY01                              
         GOTOR (RF),(R1),('ADDDAYQ',WORK),ODATE,-1                              
         B     CDATE40                                                          
                                                                                
CDATSNM1 LA    R0,1                START OF NEXT MONTH                          
         B     CDATSNM                                                          
                                                                                
CDATENM1 LA    R0,1                END OF NEXT MONTH                            
         B     CDATENM                                                          
                                                                                
CDATSY   MVC   ODATEMM,MON01       START OF YEAR                                
         MVC   ODATEDD,DAY01                                                    
         B     CDATE40                                                          
                                                                                
CDATEY   MVC   ODATEMM,MON12       END OF YEAR                                  
         MVC   ODATEDD,DAY31                                                    
         B     CDATE40                                                          
                                                                                
         USING GETRETD,WORK        NEXT BUSINESS DAY                            
CDATNBD  XC    GETRETD(GETRETL),GETRETD                                         
         GOTOR VDATCON,DMCB,(0,ODATE),(3,GRDIDY)                                
         LHI   R0,24                                                            
         STCM  R0,3,GRDHRS                                                      
         CLI   SOFSYSN,TALSYSQ     TEST TALENT                                  
         BNE   *+8                                                              
         OI    GRDFLAG,GRDFTAL     YES - USE TALENT CALENDAR                    
         GOTOR VGETRET,GETRETD                                                  
         GOTOR VDATCON,DMCB,(3,GRDODY),(0,ODATE)                                
         B     CDATEYES                                                         
                                                                                
CDATSBY  MVC   ODATEMM,MON01       START OF BROADCAST YEAR                      
         MVC   ODATEDD,DAY15                                                    
         GOTOR ADJBRD                                                           
         MVC   ODATE,WORK                                                       
         B     CDATEYES                                                         
                                                                                
CDATEBY  MVC   ODATEMM,MON12       END OF BROADCAST YEAR                        
         MVC   ODATEDD,DAY15                                                    
         GOTOR ADJBRD                                                           
         MVC   ODATE,WORK+6                                                     
         B     CDATEYES                                                         
                                                                                
CDATSPBM GOTOR ADJBRD              START OF PREVIOUS BROADCAST MONTH            
         MVC   ODATE,WORK                                                       
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,-1                            
         MVC   ODATE,WORK                                                       
         GOTOR GETBRD,ODATE                                                     
         MVC   ODATE,WORK                                                       
         B     CDATEYES                                                         
                                                                                
CDATEPBM GOTOR ADJBRD              END OF PREVIOUS BROADCAST MONTH              
         MVC   ODATE,WORK                                                       
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,-1                            
         MVC   ODATE,WORK                                                       
         GOTOR GETBRD,ODATE                                                     
         MVC   ODATE,WORK+6                                                     
         B     CDATEYES                                                         
                                                                                
CDATSPB2 LA    R4,2                START OF PREVIOUS BROADCAST MONTH-1          
         B     SPB2A                                                            
CDATSPB18 LA   R4,18               START OF PREVIOUS BROADCAST MONTH-18         
SPB2A    GOTOR ADJBRD                                                           
         MVC   ODATE,WORK                                                       
SPB2B    GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,-1                            
         MVC   ODATE,WORK                                                       
         GOTOR GETBRD,ODATE                                                     
         MVC   ODATE,WORK                                                       
         BCT   R4,SPB2B                                                         
         B     CDATEYES                                                         
                                                                                
CDATEPB2 GOTOR ADJBRD              END OF PREVIOUS BROADCAST MONTH-1            
         MVC   ODATE,WORK                                                       
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,-1                            
         MVC   ODATE,WORK                                                       
         GOTOR GETBRD,ODATE                                                     
         MVC   ODATE,WORK                                                       
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,-1                            
         MVC   ODATE,WORK                                                       
         GOTOR GETBRD,ODATE                                                     
         MVC   ODATE,WORK+6                                                     
         B     CDATEYES                                                         
                                                                                
CDATSCBM GOTOR ADJBRD              START OF CURRENT BROADCAST MONTH             
         MVC   ODATE,WORK                                                       
         B     CDATEYES                                                         
                                                                                
CDATECBM GOTOR ADJBRD              END OF CURRENT BROADCAST MONTH               
         MVC   ODATE,WORK+6                                                     
         B     CDATEYES                                                         
                                                                                
CDATSNBM GOTOR ADJBRD              START OF NEXT BROADCAST MONTH                
         MVC   ODATE,WORK+6                                                     
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,1                             
         MVC   ODATE,WORK                                                       
         GOTOR GETBRD,ODATE                                                     
         MVC   ODATE,WORK                                                       
         B     CDATEYES                                                         
                                                                                
CDATENBM GOTOR ADJBRD              END OF NEXT BROADCAST MONTH                  
         MVC   ODATE,WORK+6                                                     
         GOTOR VADDAY,DMCB,('ADDDAYQ',ODATE),WORK,1                             
         MVC   ODATE,WORK                                                       
         GOTOR GETBRD,ODATE                                                     
         MVC   ODATE,WORK+6                                                     
         B     CDATEYES                                                         
                                                                                
CDATSPM2 MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH-1                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-2                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM3 MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH-2                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-3                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM4 MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH-3                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-4                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM5 MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH-4                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-5                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM6 MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH-5                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-6                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM7 MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH-6                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-7                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM8 MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH-7                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-8                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM9 MVC   ODATEDD,DAY01       START OF PREVIOUS MONTH-8                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-9                            
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM10 MVC  ODATEDD,DAY01       START OF PREVIOUS MONTH-9                    
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-10                           
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM11 MVC  ODATEDD,DAY01       START OF PREVIOUS MONTH-10                   
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-11                           
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM12 MVC  ODATEDD,DAY01       START OF PREVIOUS MONTH-11                   
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-11                           
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSPM18 MVC  ODATEDD,DAY01       START OF PREVIOUS MONTH-18                   
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,-18                           
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATEPM2 DS    0H                  END OF PREVIOUS MONTH-1                      
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),(X'80',WORK),-2                    
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATEPM3 DS    0H                  END OF PREVIOUS MONTH-2                      
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),(X'80',WORK),-3                    
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATSNM2 LA    R0,2                START OF NEXT MONTH+1                        
         B     CDATSNM                                                          
                                                                                
CDATENM2 LA    R0,2                END OF NEXT MONTH+1                          
         B     CDATENM                                                          
                                                                                
CDATSNM3 LA    R0,3                START OF NEXT MONTH+2                        
         B     CDATSNM                                                          
                                                                                
CDATENM3 LA    R0,3                END OF NEXT MONTH+2                          
         B     CDATENM                                                          
                                                                                
CDATSNM  MVC   ODATEDD,DAY01       START OF NEXT MONTH+N (N IN R0)              
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),WORK,(R0)                          
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATENM  MVC   ODATEDD,DAY01       END OF NEXT MONTH+N (N IN R0)                
         GOTOR VADDAY,DMCB,('ADDMONQ',ODATE),(X'80',WORK),(R0)                  
         MVC   ODATE,WORK                                                       
         B     CDATE40                                                          
                                                                                
CDATE40  TM    SOFTIND2,SOFTMODY   TEST YEAR MODIFIER ALLOWED                   
         BZ    CDATEYES                                                         
         ICM   RF,15,YEARMOD       TEST MODIFY VALUE                            
         BZ    CDATEYES                                                         
         SR    R0,R0                                                            
         TM    SOFTIND2,SOFTEOM    TEST END OF MONTH EXPRESSION                 
         BZ    *+8                                                              
         LHI   R0,X'80'            YES - SET FLAG FOR ADDAY                     
         GOTOR VADDAY,DMCB,('ADDYEARQ',ODATE),((R0),WORK),(RF)                  
         MVC   ODATE(L'MONLST),WORK                                             
         B     CDATEYES                                                         
                                                                                
CDATEN   MVI   ODATE,SPACE         DEFAULT OUTPUT IS SPACES                     
         TM    SOFIINDS,SOFIISLH   TEST SET LOW/HIGH OUTPUT VALUES              
         BZ    CDATEN02                                                         
         MVI   ODATE,LOVALUE       SET TO LOW VALUES (START DATE)               
         CLI   FLDNUM,2                                                         
         BNE   CDATEN02                                                         
         MVI   ODATE,HIVALUE       OR HIGH VALUES (END DATE)                    
                                                                                
CDATEN02 MVC   ODATE+1(L'ODATE-1),ODATE                                         
         CLI   *+0,0               SET CC=NEQ IF NOT A SOFT DATE                
         B     CDATEX                                                           
                                                                                
CDATEYES CLI   *+1,0               SET CC=EQUAL IF IS A SOFT DATE               
                                                                                
CDATEX   B     EXIT                                                             
         DROP  R6                                                               
         EJECT                                                                  
***********************************************************************         
* APPLY YEAR ADJUSTMENT TO BROADCAST MONTH DATES                      *         
*                                                                     *         
* NTRY - ODATE IS DATE IN BROADCAST MONTH                             *         
*        YEARMOD IS SIGNED YEAR MODIFIER                              *         
* EXIT - WORK+0(6)=START OF BROADCAST MONTH                           *         
*        WORK+6(6)=END OF BROADCAST MONTH                             *         
***********************************************************************         
                                                                                
ADJBRD   NTR1  ,                                                                
         OC    YEARMOD,YEARMOD     TEST YEAR MODIFIER PRESENT                   
         BZ    ADJBRD02                                                         
         GOTOR GETBRD,ODATE        GET CURRENT BROADCAST PERIOD                 
         MVC   ODATE,WORK+6        BROADCAST END DATE IS CORRECT MONTH          
         MVC   ODATEDD,DAY15       SET MID-POINT & ADJUST YEAR                  
         GOTOR VADDAY,DMCB,('ADDYEARQ',ODATE),WORK,YEARMOD                      
         MVC   ODATE,WORK          SET AS BASIS FOR FINAL CALL                  
                                                                                
ADJBRD02 GOTOR GETBRD,ODATE        GET BROADCAST MONTH DATES                    
         B     EXIT                                                             
                                                                                
***********************************************************************         
* GET BROADCAST MONTH DATES FOR A GIVEN DATE                          *         
*                                                                     *         
* NTRY - R1=A(DATE BASIS)                                             *         
* EXIT - WORK+0(6)=START OF BROADCAST MONTH                           *         
*        WORK+6(6)=END OF BROADCAST MONTH                             *         
***********************************************************************         
                                                                                
GETBRD   LR    R0,RE                                                            
         LR    RF,R1               RF=A(INPUT DATE)                             
         GOTOR AGETBRD,DMCB,(1,(RF)),WORK,VGETDAY,VADDAY                        
         LR    RE,R0                                                            
         BR    RE                                                               
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO CONVERT DATE INTO PRINTABLE FORMAT                       *         
*                                                                     *         
* NTRY - R1=A(2 BYTE SOFT DATE EXPRESSION)                            *         
*        R3=A(FULL DATE EXPRESSION)                                   *         
*        R5=A(TWA FIELD HEADER)                                       *         
*        FLDNUM=1 (START DATE) OR 2 (END DATE)                        *         
***********************************************************************         
                                                                                
         USING FLDHDRD,R5                                                       
PDATE    NTR1  ,                                                                
         MVC   SDATE,0(R1)         COPY INPUT INTO LOCAL STORAGE                
                                                                                
         CLI   ITYPE,SOFITSD9      TEST SHORT JULIAN DATE TYPE                  
         BNE   PDATE02                                                          
         OC    0(3,R3),0(R3)       TEST ALL ZEROES                              
         BZ    PDATE06             YES - HARD DATE                              
         OC    0(2,R3),0(R3)                                                    
         BZ    PDATE08             SOFT SHORT JULIAN DATE                       
         B     PDATE06             HARD SHORT JULIAN DATE                       
                                                                                
PDATE02  CLI   ITYPE,SOFITSD8      TEST JULIAN DATE TYPE                        
         BNE   PDATE04                                                          
         OC    0(4,R3),0(R3)       TEST ALL ZEROES                              
         BZ    PDATE06             YES - HARD DATE                              
         OC    0(2,R3),0(R3)                                                    
         BZ    PDATE08             SOFT JULIAN DATE                             
         B     PDATE06             HARD JULIAN DATE                             
                                                                                
PDATE04  TM    SDATMOD,SDATTST     TEST INPUT IS A SOFT DATE                    
         BNZ   PDATE06                                                          
         CLI   SDATNUM,SDATBASE                                                 
         BNL   PDATE08                                                          
                                                                                
PDATE06  CLI   FLDNUM,2            TEST FIELD 2 IN PROCESS                      
         BNE   PDATE14                                                          
                                                                                
         CLI   0(R3),HIVALUE       TEST HIGH VALUE OR SPACE                     
         BE    *+12                                                             
         CLI   0(R3),SPACE                                                      
         BNE   PDATE14                                                          
                                                                                
         SR    RF,RF                                                            
         ICM   RF,1,FLDILEN        GET LENGTH OF OUTPUT SO FAR                  
         BZ    PDATEX              EXIT IF AT FRONT OF FIELD                    
         TM    FLD1IND,FLDIRFP     TEST FIELD 1 IS RFP SYMBOL                   
         BNZ   PDATEX                                                           
         LA    RE,FLDDATA(RF)                                                   
         MVI   0(RE),HYPHEN        SUFFIX STRING WITH A HYPHEN                  
         AHI   RF,1                                                             
         STC   RF,FLDILEN                                                       
         B     PDATEX                                                           
                                                                                
PDATE08  GOTOR RESKEY              RESOLVE KEYWORD LIST                         
                                                                                
         SR    RE,RE                                                            
         IC    RE,SDATNUM          RE=KEYWORD NUMBER                            
         SHI   RE,SDATBASE+1       SUBTRACT BASE NUMBER                         
         SLL   RE,3                KEYWORD*8                                    
         A     RE,AKEYWRDS         RE=A(SOFT KEYWORD)                           
                                                                                
         SR    RF,RF                                                            
         ICM   RF,1,FLDILEN                                                     
         LA    RF,FLDDATA(RF)                                                   
         MVI   0(RF),SOFTSYM1      1ST FIELD - OUTPUT SOFT IDENTIFIER           
         BZ    *+12                                                             
         MVI   0(RF),HYPHEN        2ND FIELD - MOVE IN A HYPHEN                 
         B     PDATE10                                                          
         CLI   FLDNUM,2            TEST THIS IS FIELD 2                         
         BNE   PDATE10                                                          
         C     R5,AOUT             TEST ONLY ONE OUTPUT FIELD                   
         BNE   PDATE10                                                          
         AHI   RF,1                YES - INSERT A HYPHEN                        
         MVI   0(RF),HYPHEN                                                     
                                                                                
PDATE10  MVC   1(SOFNTRYL,RF),0(RE)                                             
         AHI   RF,SOFNTRYL         LOCATE END OF SOFT KEYWORD                   
         CLI   0(RF),SPACE                                                      
         BH    *+8                                                              
         BCT   RF,*-8                                                           
                                                                                
         TM    SDATMOD,SDATVAL     TEST YEAR MODIFIER PRESENT                   
         BZ    PDATE12                                                          
         MVC   BYTE1,SDATMOD                                                    
         NI    BYTE1,SDATVAL       ISOLATE MODIFIER VALUE IN BYTE1              
         OI    BYTE1,NUMERIC       AND TURN INTO EBCDIC                         
         MVI   1(RF),ADDSYMB                                                    
         TM    SDATMOD,SDATNEG     TEST NEGATIVE YEAR MODIFIER                  
         BZ    *+8                                                              
         MVI   1(RF),SUBSYMB                                                    
         MVC   2(1,RF),BYTE1                                                    
         AHI   RF,2                BUMP ONE FOR SIGN & ONE FOR NUMBER           
                                                                                
PDATE12  LA    RE,FLDDATA-1                                                     
         SR    RF,RE               RF=L(INPUT FIELD)                            
         STC   RF,FLDILEN          SET INPUT FIELD LENGTH                       
         OI    FLDOIND,FOUTTRN     SET TRANSMIT ON                              
         B     PDATEX                                                           
                                                                                
PDATE14  CLI   0(R3),SPACE                                                      
         BE    PDATEX                                                           
         CLI   ITYPE,SOFITSD8      TEST JULIAN DATE INPUT                       
         BNE   PDATE16                                                          
         OC    0(2,R3),0(R3)       YES - TEST FIRST 2 BYTES FOR ZEROES          
         BZ    PDATEX                                                           
         B     PDATE18                                                          
                                                                                
PDATE16  CLI   0(R3),LOVALUE       TEST FOR LOW VALUE                           
         BE    PDATEX                                                           
                                                                                
PDATE18  CLI   0(R3),DD#ESCL       TEST FOR RFP ESCAPE SEQUENCE                 
         BL    PDATE20                                                          
         CLI   0(R3),DD#ESCS                                                    
         BH    PDATE20                                                          
         MVI   WORK,SPACE                                                       
         MVC   WORK+1(9),WORK                                                   
         MVI   WORK,DD#ESCL                                                     
         MVC   WORK+1(2),1(R3)                                                  
         MVI   WORK+3,10                                                        
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNS      ISSUE SINGLE UPPER TRANSLATE                 
         MVI   DDRETN,DDCASEU                                                   
         MVC   DDSYS,RFPSYSN                                                    
         MVC   DDLANG,SOFLANG                                                   
         LA    RF,WORK                                                          
         STCM  RF,7,DDIADR                                                      
         LA    RF,DUB                                                           
         STCM  RF,7,DDOADR                                                      
         GOTOR VDICTATE            RESOLVE RFP SYMBOL                           
         CLI   FLDNUM,1                                                         
         BNE   *+12                                                             
         OI    FLD1IND,FLDIRFP     SET FIELD 1 IS RFP                           
         B     PDATE26                                                          
         OI    FLD2IND,FLDIRFP     SET FIELD 2 IS RFP                           
         B     PDATE26                                                          
                                                                                
PDATE20  MVC   ODATE,0(R3)         EXTRACT DATE INTO ODATE                      
         TM    OINDS,SOFOTPYM      TEST YEAR/MONTH ONLY                         
         BZ    PDATE22                                                          
         CLI   ITYPE,SOFITSD1      ENSURE DAY VALUE IS SET                      
         BNE   *+14                                                             
         MVC   ODATEDD,DAY01                                                    
         B     PDATE24                                                          
                                                                                
         CLI   ITYPE,SOFITSD4                                                   
         BE    *+12                                                             
         CLI   ITYPE,SOFITSD6                                                   
         BNE   PDATE24                                                          
         MVI   ODATE+2,1                                                        
         B     PDATE24                                                          
                                                                                
PDATE22  CLI   ITYPE,SOFITSD2      TEST EBCDIC DATE HAS SPACES IN DAY           
         BH    PDATE24                                                          
         CLI   ODATEDD,SPACE                                                    
         BH    PDATE24                                                          
         MVC   ODATEDD,DAY01       SET DAY TO C'01' JUST IN CASE                
         OI    OINDS,SOFOTPYM      AND YEAR/MONTH ONLY                          
                                                                                
PDATE24  LHI   R0,17               SET DDMMYY FORMAT                            
         CLI   OTYPE,SOFOTPR2                                                   
         BNE   *+8                                                              
         LHI   R0,20               SET YYYYMMDD FORMAT                          
         TM    OINDS,SOFOTPYM      TEST WANT YEAR/MONTH ONLY                    
         BZ    *+8                                                              
         LHI   R0,18               SET MMYY FORMAT                              
         MVI   WORK,SPACE          CLEAR 10 BYTES OF WORK TO SPACES             
         MVC   WORK+1(9),WORK                                                   
         SR    RF,RF                                                            
         IC    RF,DATTYPEI                                                      
         TM    OINDS,SOFOTMIX      TEST MIXED CASE REQUESTED                    
         BZ    *+8                                                              
         AHI   RF,X'40'                                                         
         GOTOR VDATCON,DMCB,((RF),ODATE),((R0),WORK)                            
                                                                                
PDATE26  SR    RF,RF                                                            
         ICM   RF,1,FLDILEN                                                     
         LA    RF,FLDDATA(RF)                                                   
         BZ    PDATE28                                                          
         MVI   0(RF),HYPHEN        2ND FIELD - MOVE IN A HYPHEN                 
         AHI   RF,1                                                             
         B     PDATE30                                                          
                                                                                
PDATE28  CLI   FLDNUM,2            TEST THIS IS FIELD 2                         
         BNE   PDATE30                                                          
         C     R5,AOUT             TEST ONLY ONE OUTPUT FIELD                   
         BNE   PDATE30                                                          
         TM    FLD2IND,FLDIRFP     TEST FIELD 1 IS RFP                          
         BNZ   PDATE30                                                          
         MVI   0(RF),HYPHEN                                                     
         AHI   RF,1                YES - INSERT A HYPHEN                        
                                                                                
PDATE30  LA    RE,WORK+9           MOVE DATE TO OUTPUT FIELD                    
         CLI   0(RE),SPACE                                                      
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         LA    R0,WORK                                                          
         SR    RE,R0                                                            
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RF),WORK                                                     
         LA    RF,1(RE,RF)                                                      
         LA    RE,FLDDATA                                                       
         SR    RF,RE                                                            
         STC   RF,FLDILEN          SET TOTAL FIELD LENGTH                       
         OI    FLDOIND,FOUTTRN     SET TRANSMIT ON                              
                                                                                
PDATEX   B     EXIT                                                             
         DROP  R5                                                               
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO EXTRACT DATA FROM INPUT FIELD INTO WORK+1 AND SET INPUT  *         
* DATA LENGTH AT WORK+0                                               *         
*                                                                     *         
* NTRY - R1=A(INPUT FIELD HEADER)                                     *         
* EXIT - CC=NOT EQUAL IF NO DATA INPUT & SOFERROR SET                 *         
*        CC=EQUAL IF AT LEAST ONE CHARACTER OF DATA INPUT             *         
***********************************************************************         
                                                                                
         USING FLDHDRD,R1                                                       
XDATA    STM   RE,R1,12(RD)        SAVE RE THROUGH R1                           
         SR    RE,RE                                                            
         IC    RE,FLDLEN                                                        
         LHI   RF,FLDHDRL          RF=L'FIELD HEADER                            
         SR    RE,RF                                                            
         TM    FLDATB,FATBXHDR     TEST EXTENDED FIELD HEADER                   
         BZ    *+6                                                              
         SR    RE,RF                                                            
                                                                                
         MVI   WORK,SPACE          CLEAR WORK TO SPACES                         
         MVC   WORK+1(L'WORK-1),WORK                                            
         MVI   WORK,0              SET NO INPUT                                 
         LA    RF,FLDDATA-1(RE)    POINT TO LAST INPUT CHARACTER                
         CLI   0(RF),SPACE         AND LOOK BACK FOR LAST INPUT                 
         BH    XDATA02                                                          
         BCTR  RF,0                                                             
         BCT   RE,*-10                                                          
         MVC   SOFERROR,MISSING    SET MISSING INPUT FIELD ERROR                
         B     XDATAX                                                           
                                                                                
XDATA02  BCTR  RE,0                                                             
         EX    RE,*+8              MOVE DATA TO WORK+1                          
         B     *+10                                                             
         MVC   WORK+1(0),FLDDATA                                                
         AHI   RE,1                RE=REAL LENGTH OF DATA                       
                                                                                
XDATA04  STC   RE,WORK                                                          
         CLI   WORK+1,SPACE        DISPOSE OF LEADING SPACES                    
         BH    XDATAX                                                           
         MVC   WORK+1(L'WORK-2),WORK+2                                          
         MVI   WORK+L'WORK-1,SPACE                                              
         BCT   RE,XDATA04                                                       
         DC    H'0'                                                             
                                                                                
XDATAX   LM    RE,R1,12(RD)        RESTORE SAVED REGISTERS                      
         OC    SOFERROR,SOFERROR   SET CC FOR CALLER                            
         BR    RE                                                               
         DROP  R1                                                               
         EJECT                                                                  
***********************************************************************         
* VALIDATE A SOFT DATE EXPRESSION                                     *         
*                                                                     *         
* NTRY - R1=A(FIELD LENGTH (AL1) FOLLOWED BY DATA)                    *         
* EXIT - CC=EQUAL WITH SDATE CONTAINING SOFT DATE EXPRESSION AND      *         
*           ODATE CONTAINING DATE BASED ON TODAY'S DATE               *         
*        CC=NOT EQUAL WITH SOFERROR CONTAINING ERROR NUMBER           *         
***********************************************************************         
                                                                                
VSOFT    NTR1  ,                                                                
         XC    SDATE,SDATE         CLEAR OUTPUT DATE AREA                       
         MVI   WORK,SPACE                                                       
         MVC   WORK+1(L'WORK-1),WORK                                            
         SR    RE,RE                                                            
         IC    RE,0(R1)            GET L'FIELD                                  
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   WORK(0),0(R1)       SAVE DATA IN WORK                            
         LA    RF,WORK(RE)         RE=A(LAST CHARACTER OF STRING)               
                                                                                
VSOFT02  CLI   0(RF),ADDSYMB       TEST YEAR MODIFIER PRESENT                   
         BE    VSOFT04                                                          
         CLI   0(RF),SUBSYMB                                                    
         BE    VSOFT04                                                          
         BCTR  RF,0                                                             
         BCT   RE,VSOFT02                                                       
         B     VSOFT06                                                          
                                                                                
VSOFT04  TM    1(RF),NUMERIC       MUST BE FOLLOWED BY A NUMBER                 
         BNZ   *+14                                                             
         MVC   SOFERROR,INVALID    ERROR IF NOT                                 
         B     VSOFTX                                                           
                                                                                
         CLI   2(RF),SPACE         AND A SPACE                                  
         BNH   *+14                                                             
         MVC   SOFERROR,NOTNUMRC                                                
         B     VSOFTX                                                           
                                                                                
         OI    INDS,INDSYRMO       SET YEAR MODIFIER INPUT                      
         MVC   SDATMOD,1(RF)       EXTRACT YEAR                                 
         NI    SDATMOD,SDATNEG+SDATVAL                                          
         TM    SDATMOD,SDATNEG     TEST NOT GREATER THAN 7 (8 OR 9)             
         BZ    *+14                                                             
         MVC   SOFERROR,TOOLARGE                                                
         B     VSOFTX                                                           
                                                                                
         TM    SDATMOD,SDATVAL     TEST NON-ZERO                                
         BNZ   *+14                                                             
         MVC   SOFERROR,TOOSMALL                                                
         B     VSOFTX                                                           
                                                                                
         CLI   0(RF),SUBSYMB                                                    
         BNE   *+8                                                              
         OI    SDATMOD,SDATNEG     TURN ON X'08' BIT IF NEGATIVE VALUE          
                                                                                
         MVI   0(RF),SPACE         MOVE IN A SPACE CHARACTER                    
         BCTR  RE,0                                                             
         STC   RE,WORK             DECREMENT INPUT LENGTH                       
                                                                                
VSOFT06  GOTOR RESKEY              RESOLVE SOFT KEYWORDS                        
                                                                                
         SR    R0,R0                                                            
         IC    R0,NDCDNUM                                                       
         L     RF,AKEYWRDS                                                      
         IC    RE,WORK                                                          
         SHI   RE,2                DECREMENT INPUT LENGTH FOR SOFTSYM           
         STC   RE,WORK                                                          
                                                                                
VSOFT08  LA    RE,SOFNTRYL-1(RF)   POINT TO END OF KEYWORD AREA                 
         LHI   R1,SOFNTRYL-1       R1=L'KEYWORD-1                               
VSOFT10  CLI   0(RE),SPACE         LOCATE END OF KEYWORD                        
         BH    VSOFT12                                                          
         BCTR  RE,0                                                             
         BCT   R1,VSOFT10                                                       
         DC    H'0'                                                             
                                                                                
VSOFT12  CLM   R1,1,WORK           TEST KEYWORDS HAVE SAME LENGTH(-1)           
         BNE   VSOFT14                                                          
         EX    R1,*+8                                                           
         BE    VSOFT16                                                          
         CLC   WORK+2(0),0(RF)     MATCH ALL KEYWORD CHARACTERS                 
VSOFT14  AHI   RF,SOFNTRYL         BUMP TO NEXT KEYWORD IN LIST                 
         BCT   R0,VSOFT08                                                       
                                                                                
VSOFT16  L     RE,AKEYWRDS                                                      
         SR    RF,RE               RF=DISPLACEMENT TO KEYWORD IN LIST           
         SRL   RF,3                (DIVIDE BY 8 - L'KEYWORDS)                   
         LA    RE,SDATBASE+1(RF)   AND ADD BASE NUMBER PLUS 1                   
         STC   RE,SDATNUM          THAT'S THE NUMBER                            
         SLL   RF,2                (MULTIPLY BY 4 - L'SOFTAB)                   
         A     RF,ASOFTAB          RF=A(SOFTAB TABLE ENTRY)                     
                                                                                
         USING SOFTABD,RF                                                       
         CLI   FLDNUM,2            TEST PROCESSING FIELD 2                      
         BNE   VSOFT18                                                          
         TM    SOFTIND1,SOFTPMON   TEST PRIOR MONTH EXPRESSION                  
         BZ    VSOFT18                                                          
         OI    INDS,INDSPMON       SET GLOBAL INDICATOR                         
                                                                                
VSOFT18  MVC   BYTE1,SOFTIND2      TEST VALID FOR INPUT TYPE                    
         NC    BYTE1,YMDFILT                                                    
         BNZ   *+14                                                             
         MVC   SOFERROR,INVALID    SET INVALID INPUT FIELD ERROR                
         B     VSOFTX                                                           
                                                                                
         TM    SOFTIND2,SOFTMODY   TEST MODIFIER ALLOWED                        
         BNZ   VSOFT20                                                          
         TM    SDATMOD,SDATNEG+SDATVAL                                          
         BZ    VSOFT20                                                          
         MVC   SOFERROR,INVALID    NO - ERROR IF SPECIFIED                      
         B     EXITTST                                                          
                                                                                
VSOFT20  GOTOR CDATE,SDATE         EXPLODE USING TODAY'S DATE AS BASIS          
                                                                                
VSOFTX   B     EXITTST                                                          
         EJECT                                                                  
***********************************************************************         
* CALL PERVERT AND SET #DAYS, #MONTHS AND #YEARS IN SOFDATD           *         
*                                                                     *         
* NTRY - SOFOVSTD CONTAINS REQUEST START DATE, SOFOVEND CONTAINS END  *         
* EXIT - SOFOVDIP, SOFOVMIP AND SOFOVYIP ARE ALWAYS SET.              *         
*        CC=NOT EQUAL IF USER MAXIMUM PERIOD VALUE IS EXCEEDED OR     *         
*           END DATE IS LESS THAN START DATE WITH ERROR NUMBER SET    *         
***********************************************************************         
                                                                                
SETDMY   LR    R0,RE                                                            
         TM    SOFOVSTD,NUMERIC    TEST START DATE GIVEN                        
         BNO   SETDMYX                                                          
         TM    SOFOVEND,NUMERIC    TEST END DATE GIVEN                          
         BNO   SETDMYX                                                          
         CLI   SOFOVEND,HIVALUE    AND NOT SET TO HIGH VALUES                   
         BE    SETDMYX                                                          
                                                                                
         GOTOR VPERVERT,DMCB,SOFOVSTD,SOFOVEND                                  
         MVC   SOFOVDIP,08(R1)     RETURN #DAYS                                 
         MVC   SOFOVMIP,14(R1)            #MONTHS                               
         MVC   SOFOVYIP,16(R1)            #YEARS IN BLOCK                       
         TM    SOFOVDIP,X'80'      TEST NEGATIVE NUMBER OF DAYS                 
         BZ    SETDMY02                                                         
         MVC   SOFERROR,STDGREND                                                
         OI    SOFEINDS,SOFEIF1E   SET FIELD 1 IN ERROR                         
         OI    INDS,INDSSGRE       SET GLOBAL ERROR INDICATOR                   
         B     SETDMYX                                                          
                                                                                
SETDMY02 OC    SOFMAXPV,SOFMAXPV   TEST MAXIMUM PERIOD VALUE SET                
         BZ    SETDMYX                                                          
         SR    RE,RE                                                            
         ICM   RE,1,SOFMAXPT       TEST MAXIMUM PERIOD TYPE SET                 
         BZ    SETDMYX                                                          
         SLL   RE,1                                                             
         LA    RE,SOFOVYIP-L'SOFOVYIP(RE)                                       
         CLC   0(L'SOFOVYIP,RE),SOFMAXPV                                        
         BNH   SETDMYX                                                          
         MVC   SOFERROR,PERIODTL   SET PERIOD TOO LONG ERROR                    
         OI    SOFEINDS,SOFEIF2E   SET FIELD 2 IN ERROR                         
                                                                                
SETDMYX  LR    RE,R0                                                            
         OC    SOFERROR,SOFERROR   SET CC=NOT EQUAL ON ERROR                    
         BR    RE                                                               
         EJECT                                                                  
***********************************************************************         
* BUILD LIST OF CALENDAR MONTHS FOR CURRENT YEAR                      *         
***********************************************************************         
                                                                                
BLDMON   LA    R1,MONLST                                                        
         LHI   R0,MONSYEAR                                                      
         LHI   RF,1                                                             
                                                                                
BLDMON02 MVC   0(2,R1),ODATEYY                                                  
         CVD   RF,DUB                                                           
         OI    DUB+L'DUB-1,DIGIT                                                
         UNPK  2(2,R1),DUB                                                      
         AHI   RF,1                                                             
         AHI   R1,4                                                             
         BCT   R0,BLDMON02                                                      
                                                                                
BLDMONX  BR    RE                                                               
         EJECT                                                                  
***********************************************************************         
* BUILD LIST OF FISCAL MONTHS FOR CURRENT FISCAL YEAR                 *         
***********************************************************************         
                                                                                
BLDFSC   NTR1  ,                                                                
         LHI   R1,1                                                             
         MVI   MONBASE,1           DEFAULT IS JANUARY FISCAL START              
         CLI   SOFSYSN,ACCSYSQ     TEST ACCPAK SYSTEM                           
         BNE   BLDFSC02                                                         
         CLI   SOFACFST,0          YES - DECODE FISCAL START                    
         BE    BLDFSC02                                                         
         MVC   MONBASE,SOFACFST                                                 
         CLI   SOFACFST,MONSYEAR   TEST PASSED IN BINARY                        
         BNH   BLDFSC02                                                         
         NI    MONBASE,DIGIT                                                    
         SR    R1,R1                                                            
         IC    R1,MONBASE                                                       
         TM    SOFACFST,NUMERIC                                                 
         BO    *+8                                                              
         AHI   R1,9                                                             
         STC   R1,MONBASE                                                       
                                                                                
BLDFSC02 CLI   MONBASE,1           IF FISCAL START IS JANUARY                   
         BNE   *+14                USE CALENDAR MONTHS                          
         MVC   FSCLST(FSCLSTL),MONLST                                           
         B     BLDFSCX                                                          
                                                                                
         MVC   WORK+ODATEYY-ODATE(L'ODATEYY),ODATEYY                            
         CVD   R1,DUB                                                           
         OI    DUB+L'DUB-1,DIGIT                                                
         UNPK  WORK+ODATEMM-ODATE(L'ODATEMM),DUB                                
         MVC   WORK+ODATEDD-ODATE(L'ODATEDD),DAY01                              
         CLC   ODATEMM,WORK+ODATEMM-ODATE                                       
         BNL   BLDFSC04                                                         
         GOTOR VADDAY,DMCB,('ADDYEARQ',WORK),WORK+L'ODATE,-1                    
         MVC   WORK(L'ODATE),WORK+L'ODATE                                       
                                                                                
BLDFSC04 MVC   FSCLST,WORK         SET FIRST FISCAL MONTH IN LIST               
         LA    R6,FSCLST+L'FSCLST                                               
         LHI   R0,MONSYEAR-1       AND CALL ADDAY TO CALCULATE OTHERS           
         GOTOR ,DMCB,('ADDMONQ',WORK),WORK+L'ODATE,1                            
         L     RF,VADDAY                                                        
                                                                                
BLDFSC06 GOTOR (RF),(R1)                                                        
         MVC   WORK(L'ODATE),WORK+L'ODATE                                       
         MVC   0(L'FSCLST,R6),WORK                                              
         AHI   R6,L'FSCLST                                                      
         BCT   R0,BLDFSC06                                                      
                                                                                
BLDFSCX  B     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO CLEAR TWA FIELD TO SPACES & SET INPUT LENGTH TO ZERO     *         
*                                                                     *         
* NTRY - R5=A(TWA FIELD HEADER)                                       *         
***********************************************************************         
                                                                                
         USING FLDHDRD,R5                                                       
CLRFLD   SR    RF,RF                                                            
         IC    RF,FLDLEN           RF=TOTAL FIELD LENGTH                        
         LHI   R0,FLDHDRL                                                       
         SR    RF,R0               SUBTRACT LENGTH OF HEADER                    
         TM    FLDATB,FATBXHDR     TEST EXTENDED FIELD HEADER                   
         BZ    *+6                                                              
         SR    RF,R0               YES - SUBTRACT ITS LENGTH TOO                
         SHI   RF,2                                                             
         MVI   FLDDATA,SPACE                                                    
         EX    RF,*+8              FILL FIELD WITH SPACES                       
         B     *+10                                                             
         MVC   FLDDATA+1(0),FLDDATA                                             
         AHI   RF,1                RETURN L'FIELD-1 IN RF                       
         MVI   FLDILEN,0                                                        
                                                                                
CLRFLDX  BR    RE                                                               
         DROP  R5                                                               
                                                                                
***********************************************************************         
* ROUTINE TO RESOLVE SOFT KEYWORDS                                    *         
***********************************************************************         
                                                                                
RESKEY   OC    LASTS,LASTS         TEST KEYWORDS RESOLVED                       
         BZ    RESKEY02                                                         
         CLC   LASTSYSN,DICSYSN    TEST SAME SYSTEM AS LAST TIME                
         BNE   RESKEY02                                                         
         CLC   LASTLANG,SOFLANG    TEST SAME LANGUAGE AS LAST TIME              
         BNE   RESKEY02                                                         
         L     RF,AKEYWRDS         TEST FIRST KEYWORD IS RESOLVED               
         OC    0(SOFNTRYL,RF),0(RF)                                             
         BNZ   RESKEYX                                                          
                                                                                
RESKEY02 LR    R0,RE                                                            
         LA    R1,DMCB             BUILD SYSTEM KEYWORD LIST                    
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,DDCASEU                                                   
         MVC   DDSYS,DICSYSN                                                    
         MVC   DDLANG,SOFLANG                                                   
         MVC   DDIADR,ADCDTAB+1                                                 
         MVC   DDOADR,AKEYWRDS+1                                                
         GOTOR VDICTATE                                                         
         MVC   LASTSYSN,DICSYSN                                                 
         MVC   LASTLANG,SOFLANG                                                 
         LR    RE,R0                                                            
                                                                                
RESKEYX  BR    RE                                                               
         DROP  R1                                                               
         EJECT                                                                  
         LTORG                                                                  
                                                                                
VGETBRD  DC    V(GETBROAD)                                                      
                                                                                
TYPTAB   DS    0XL2                ** DATCON INPUT/OUTPUT TYPES **              
         DC    AL1(00,00)                                                       
         DC    AL1(00,00)                                                       
         DC    AL1(02,02)          COMPRESSED DATE TYPE 2                       
         DC    AL1(01,01)                                                       
         DC    AL1(01,01)                                                       
         DC    AL1(03,03)                                                       
         DC    AL1(03,03)                                                       
         DC    AL1(00,00)          DUMMY (FILLER ENTRY)                         
         DC    AL1(00,00)          DUMMY (FILLER ENTRY)                         
         DC    AL1(06,15)                                                       
         DC    AL1(08,19)                                                       
         DC    AL1(14,30)          NEW DATE TYPE 14 BASE 1964                   
                                                                                
INDTAB   DS    0X                  ** PRINT FORMAT INDICATORS **                
         DC    AL1(SOFOTPYM)       1                                            
         DC    AL1(0)              2                                            
         DC    AL1(0)              3 COMPRESSED DATE TYEP 2                     
         DC    AL1(SOFOTPYM)       4                                            
         DC    AL1(0)              5                                            
         DC    AL1(SOFOTPYM)       6                                            
         DC    AL1(0)              7                                            
         DC    AL1(0)              8                                            
         DC    AL1(0)              9                                            
         DC    AL1(0)              10                                           
         DC    AL1(0)              11                                           
         DC    AL1(0)              12 NEW DATE TYPE 14                          
                                                                                
LENTAB   DS    0X                  ** LENGTHS OF OUTPUT DATES **                
         DC    AL1(L'PVALESTA-2)   YM EBCDIC                                    
         DC    AL1(L'PVALESTA)     YMD EBCDIC                                   
         DC    AL1(L'PVALCSTA)     YMD COMPRESSED                               
         DC    AL1(L'PVALPSTA-1)   YM PWOS                                      
         DC    AL1(L'PVALPSTA)     YMD PWOS                                     
         DC    AL1(L'PVALBSTA-1)   YM BINARY                                    
         DC    AL1(L'PVALBSTA)     YMD BINARY                                   
         DC    AL1(0)              DUMMY (FILLER ENTRY)                         
         DC    AL1(0)              DUMMY (FILLER ENTRY)                         
         DC    AL1(L'PVALJLST)     MCYD PWOS                                    
         DC    AL1(L'PVALJSST)     MCYD PACKED                                  
         DC    AL1(L'PVALNSTA)     YMD NEW DATE 14, 1964 - 2059                 
                                                                                
DSPTAB   DS    0XL2                ** DISPLACEMENTS TO PERVAL VALUES **         
         DC    AL1(PVALESTA-PERVALD,PVALEEND-PERVALD)                           
         DC    AL1(PVALESTA-PERVALD,PVALEEND-PERVALD)                           
         DC    AL1(PVALCSTA-PERVALD,PVALCEND-PERVALD)                           
         DC    AL1(PVALPSTA-PERVALD,PVALPEND-PERVALD)                           
         DC    AL1(PVALPSTA-PERVALD,PVALPEND-PERVALD)                           
         DC    AL1(PVALBSTA-PERVALD,PVALBEND-PERVALD)                           
         DC    AL1(PVALBSTA-PERVALD,PVALBEND-PERVALD)                           
         DC    AL1(0,0)            DUMMY (FILLER ENTRY)                         
         DC    AL1(0,0)            DUMMY (FILLER ENTRY)                         
         DC    AL1(PVALJLST-PERVALD,PVALJLND-PERVALD)                           
         DC    AL1(PVALJSST-PERVALD,PVALJSND-PERVALD)                           
         DC    AL1(PVALNSTA-PERVALD,PVALCEND-PERVALD)                           
                                                                                
DAY01    DC    C'01'                                                            
DAY15    DC    C'15'                                                            
DAY31    DC    C'31'                                                            
MON01    DC    C'01'                                                            
MON12    DC    C'12'                                                            
                                                                                
ADDDAYQ  EQU   C'D'                ADDAY DAYS PARAMETER                         
ADDMONQ  EQU   C'M'                ADDAY MONTHS PARAMETER                       
ADDYEARQ EQU   C'Y'                ADDAY YEARS PARAMETER                        
HYPHEN   EQU   C'-'                FIELD SPLIT CHARACTER                        
ADDSYMB  EQU   C'+'                ADD CHARACTER                                
SUBSYMB  EQU   C'-'                SUBTRACT CHARACTER                           
SOFTSYM1 EQU   C'!'                FIRST SOFT DATE INPUT IDENTIFIER             
SOFTSYM2 EQU   C'|'                SECOND SOFT DATE INPUT IDENTIFIER            
SPACE    EQU   C' '                SPACE CHARACTER                              
NUMERIC  EQU   C'0'                NUMERIC TEST/SET                             
DIGIT    EQU   X'0F'               DIGIT TEST/SET                               
LOVALUE  EQU   X'00'               LOW DATE OUTPUT VALUE                        
HIVALUE  EQU   X'FF'               HIGH DATE OUTPUT VALUE                       
ALLBITS  EQU   X'FF'               ALL BITS ON                                  
FLDHDRL  EQU   FLDDATA-FLDHDRD     LENGTH OF TWA FIELD HEADER                   
MONSYEAR EQU   12                  MONTHS IN YEAR                               
DAYSWEEK EQU   7                   DAYS IN WEEK                                 
                                                                                
SPTSYSQ  EQU   X'02'               SPOTPAK SYSTEM EQUATE                        
NETSYSQ  EQU   X'03'               NETPAK SYSTEM EQUATE                         
MEDSYSQ  EQU   X'04'               MEDLINE SYSTEM EQUATE                        
PRTSYSQ  EQU   X'04'               PRINTPAK SYSTEM EQUATE                       
MPLSYSQ  EQU   X'05'               MEDIA PLANNING SYSTEM EQUATE                 
ACCSYSQ  EQU   X'06'               ACCPAK SYSTEM EQUATE                         
TALSYSQ  EQU   X'07'               TALENT SYSTEM EQUATE                         
REPSYSQ  EQU   X'08'               REPPAK SYSTEM EQUATE                         
MBASYSQ  EQU   X'09'               MEDIABASE SYSTEM EQUATE                      
CONSYSQ  EQU   X'0A'               CONTROL SYSTEM EQUATE                        
STRSYSQ  EQU   X'0D'               SPOT TYRAFFIC SYSTEM EQUATE                  
         EJECT                                                                  
***********************************************************************         
* SYSTEM TABLE - SEE SYSTABD                                          *         
***********************************************************************         
                                                                                
SYSTAB   DS    0X                                                               
                                                                                
         DC    AL1(ACCSYSQ)        ** ACCPAK SYSTEM **                          
         DC    AL2(ACCTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(ACCERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(ACCDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(ACCDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(ACCSYSQ)                                                     
                                                                                
         DC    AL1(CONSYSQ)        ** CONTROL SYSTEM **                         
         DC    AL2(CONTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(CONERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(CONDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(CONDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(CONSYSQ)                                                     
*&&UK                                                                           
         DC    AL1(MEDSYSQ)        ** MEDLINE SYSTEM **                         
         DC    AL2(MEDTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(MEDERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(MEDDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(MEDDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(MEDSYSQ)                                                     
                                                                                
         DC    AL1(MPLSYSQ)        ** MEDIA PLANNING SYSTEM **                  
         DC    AL2(MPLTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(MPLERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(MPLDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(MPLDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(MPLSYSQ)                                                     
                                                                                
         DC    AL1(MBASYSQ)        ** MEDIABASE SYSTEM **                       
         DC    AL2(MBATAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(MBAERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(MBADCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(MBADCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(MBASYSQ)                                                     
*&&                                                                             
*&&US                                                                           
         DC    AL1(TALSYSQ)        ** TALENT SYSTEM **                          
         DC    AL2(TALTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(TALERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(TALDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(TALDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(TALSYSQ)                                                     
                                                                                
         DC    AL1(SPTSYSQ)        ** SPOTPAK SYSTEM **                         
         DC    AL2(SPTTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(SPTERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(SPTDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(SPTDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(SPTSYSQ)                                                     
                                                                                
         DC    AL1(NETSYSQ)        ** NETPAK SYSTEM **                          
         DC    AL2(NETTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(NETERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(NETDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(NETDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(NETSYSQ)                                                     
                                                                                
         DC    AL1(PRTSYSQ)        ** PRINTPAK SYSTEM **                        
         DC    AL2(PRTTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(PRTERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(PRTDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(PRTDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(PRTSYSQ)                                                     
                                                                                
         DC    AL1(MPLSYSQ)        ** MEDIA PLANNING SYSTEM **                  
         DC    AL2(MPLTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(MPLERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(MPLDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(MPLDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(MPLSYSQ)                                                     
                                                                                
         DC    AL1(REPSYSQ)        ** REPPAK SYSTEM **                          
         DC    AL2(REPTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(REPERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(REPDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(REPDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(REPSYSQ)                                                     
                                                                                
         DC    AL1(MBASYSQ)        ** MEDIABASE SYSTEM **                       
         DC    AL2(MBATAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(MBAERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(MBADCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(MBADCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(MBASYSQ)                                                     
                                                                                
         DC    AL1(STRSYSQ)        ** SPOT TRAFFIC SYSTEM **                    
         DC    AL2(STRTAB-SOFDAT)  SOFT DATE TABLE                              
         DC    AL2(STRERR-SOFDAT)  ERROR MESSAGE NUMBERS                        
         DC    AL2(STRDCD-SOFDAT)  DCDD LIST                                    
         DC    AL1(STRDCDN)        N'ENTRIES IN DCDD LIST                       
         DC    AL1(ACCSYSQ)                                                     
         DC    AL1(STRSYSQ)                                                     
*&&                                                                             
SYSTABN  EQU   (*-SYSTAB)/SYSTABL                                               
         EJECT                                                                  
*&&US                                                                           
STRERR   DS    0X                  ** SPOT TRAFFIC MESSAGE NUMBERS **           
SPTERR   DS    0X                  ** SPOTPAK MESSAGE NUMBERS **                
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(4)              FIELD VALUE TOO LARGE                        
         DC    AL2(5)              FIELD VALUE TOO SMALL                        
         DC    AL2(6)              END DATE IS BEFORE START DATE                
         DC    AL2(7)              REQUEST PERIOD TOO LONG                      
                                                                                
SPTERRX  DS    0X                                                               
STRERRX  DS    0X                                                               
                                                                                
NETERR   DS    0X                  ** NETPAK MESSAGE NUMBERS **                 
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(4)              FIELD VALUE TOO LARGE                        
         DC    AL2(5)              FIELD VALUE TOO SMALL                        
         DC    AL2(6)              END DATE IS BEFORE START DATE                
         DC    AL2(7)              REQUEST PERIOD TOO LONG                      
                                                                                
NETERRX  DS    0X                                                               
                                                                                
PRTERR   DS    0X                  ** PRINTPAK MESSAGE NUMBERS **               
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(4)              FIELD VALUE TOO LARGE                        
         DC    AL2(5)              FIELD VALUE TOO SMALL                        
         DC    AL2(6)              END DATE IS BEFORE START DATE                
         DC    AL2(7)              REQUEST PERIOD TOO LONG                      
                                                                                
PRTERRX  DS    0X                                                               
                                                                                
MPLERR   DS    0X                  ** MEDIA PLANNING MESSAGE NUMBERS **         
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(4)              FIELD VALUE TOO LARGE                        
         DC    AL2(5)              FIELD VALUE TOO SMALL                        
         DC    AL2(6)              END DATE IS BEFORE START DATE                
         DC    AL2(7)              REQUEST PERIOD TOO LONG                      
                                                                                
MPLERRX  DS    0X                                                               
                                                                                
TALERR   DS    0X                  ** TALENT MESSAGE NUMBERS **                 
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(700)            FIELD VALUE TOO LARGE                        
         DC    AL2(701)            FIELD VALUE TOO SMALL                        
         DC    AL2(702)            END DATE IS BEFORE START DATE                
         DC    AL2(703)            REQUEST PERIOD TOO LONG                      
                                                                                
TALERRX  DS    0X                                                               
                                                                                
REPERR   DS    0X                  ** REPPAK MESSAGE NUMBERS **                 
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(4)              FIELD VALUE TOO LARGE                        
         DC    AL2(5)              FIELD VALUE TOO SMALL                        
         DC    AL2(6)              END DATE IS BEFORE START DATE                
         DC    AL2(7)              REQUEST PERIOD TOO LONG                      
                                                                                
REPERRX  DS    0X                                                               
                                                                                
MBAERR   DS    0X                  ** MEDIABASE MESSAGE NUMBERS **              
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(4)              FIELD VALUE TOO LARGE                        
         DC    AL2(5)              FIELD VALUE TOO SMALL                        
         DC    AL2(6)              END DATE IS BEFORE START DATE                
         DC    AL2(7)              REQUEST PERIOD TOO LONG                      
                                                                                
MBAERRX  DS    0X                                                               
*&&                                                                             
*&&UK                                                                           
MEDERR   DS    0X                  ** MEDLINE MESSAGE NUMBERS **                
                                                                                
         DC    AL2(EM#MIF)         MISSING INPUT FIELD                          
         DC    AL2(EM#IIF)         INVALID INPUT FIELD                          
         DC    AL2(EM#FNN)         NON NUMERIC INPUT FIELD                      
         DC    AL2(EM#FLDVB)       FIELD VALUE TOO LARGE                        
         DC    AL2(EM#FLDVS)       FIELD VALUE TOO SMALL                        
         DC    AL2(EM#SGTE)        END DATE IS BEFORE START DATE                
         DC    AL2(EM#RPTL)        REQUEST PERIOD TOO LONG                      
                                                                                
MEDERRX  DS    0X                                                               
                                                                                
MPLERR   DS    0X                  ** MEDIA PLANNING MESSAGE NUMBERS **         
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(4)              FIELD VALUE TOO LARGE                        
         DC    AL2(5)              FIELD VALUE TOO SMALL                        
         DC    AL2(6)              END DATE IS BEFORE START DATE                
         DC    AL2(7)              REQUEST PERIOD TOO LONG                      
                                                                                
MPLERRX  DS    0X                                                               
                                                                                
MBAERR   DS    0X                  ** MEDIABASE MESSAGE NUMBERS **              
                                                                                
         DC    AL2(1)              MISSING INPUT FIELD                          
         DC    AL2(2)              INVALID INPUT FIELD                          
         DC    AL2(3)              NON NUMERIC INPUT FIELD                      
         DC    AL2(4)              FIELD VALUE TOO LARGE                        
         DC    AL2(5)              FIELD VALUE TOO SMALL                        
         DC    AL2(6)              END DATE IS BEFORE START DATE                
         DC    AL2(7)              REQUEST PERIOD TOO LONG                      
                                                                                
MBAERRX  DS    0X                                                               
*&&                                                                             
ACCERR   DS    0X                  ** ACCPAK MESSAGE NUMBERS **                 
                                                                                
         DC    AL2(AE$MISIF)       MISSING INPUT FIELD                          
         DC    AL2(AE$INVIF)       INVALID INPUT FIELD                          
         DC    AL2(AE$NONIF)       NON NUMERIC INPUT FIELD                      
         DC    AL2(AE$FLVTS)       FIELD VALUE TOO LARGE                        
         DC    AL2(AE$FLVTL)       FIELD VALUE TOO SMALL                        
         DC    AL2(AE$NDBSD)       END DATE IS BEFORE START DATE                
         DC    AL2(AE$RPTL)        REQUEST PERIOD TOO LONG                      
                                                                                
ACCERRX  DS    0X                                                               
                                                                                
CONERR   DS    0X                  ** CONTROL MESSAGE NUMBERS **                
                                                                                
         DC    AL2(CE#MISIF)       MISSING INPUT FIELD                          
         DC    AL2(CE#INVIF)       INVALID INPUT FIELD                          
         DC    AL2(CE#FNOTN)       NON NUMERIC INPUT FIELD                      
         DC    AL2(CE#FVMAX)       FIELD VALUE TOO LARGE                        
         DC    AL2(CE#FLMIN)       FIELD VALUE TOO SMALL                        
         DC    AL2(CE#INCDA)       END DATE IS BEFORE START DATE                
         DC    AL2(CE#PTL)         REQUEST PERIOD TOO LONG                      
                                                                                
CONERRX  DS    0X                                                               
         EJECT                                                                  
ACCTAB   DS    0X                  ** ACCPAK SOFT DATE TABLE **                 
                                                                                
AC$PM    DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTSUB,1)                          
AC$CM    DC    AL1(0,SOFTYM+SOFTMODY,0,0)                                       
AC$NM    DC    AL1(0,SOFTYM+SOFTMODY,SOFTADD,1)                                 
AC$M1    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,1)                                
AC$M2    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,2)                                
AC$M3    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,3)                                
AC$M4    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,4)                                
AC$M5    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,5)                                
AC$M6    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,6)                                
AC$M7    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,7)                                
AC$M8    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,8)                                
AC$M9    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,9)                                
AC$M10   DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,10)                               
AC$M11   DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,11)                               
AC$M12   DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,12)                               
AC$PQSM  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTRELQ+SOFTSUB,3)                 
AC$PQEM  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTRELQ+SOFTSUB,1)                 
AC$CQSM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELQ,0)                                
AC$CQEM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELQ+SOFTADD,2)                        
AC$NQSM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELQ+SOFTADD,3)                        
AC$NQEM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELQ+SOFTADD,5)                        
AC$Q1SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,1)                                
AC$Q1EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,3)                                
AC$Q2SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,4)                                
AC$Q2EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,6)                                
AC$Q3SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,7)                                
AC$Q3EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,9)                                
AC$Q4SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,10)                               
AC$Q4EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,12)                               
AC$PHSM  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTRELH+SOFTSUB,6)                 
AC$PHEM  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTRELH+SOFTSUB,1)                 
AC$CHSM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELH,0)                                
AC$CHEM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELH+SOFTADD,5)                        
AC$NHSM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELH+SOFTADD,6)                        
AC$NHEM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELH+SOFTADD,11)                       
AC$H1SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,1)                                
AC$H1EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,6)                                
AC$H2SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,7)                                
AC$H2EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,12)                               
AC$PD    DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,1)                       
AC$CD    DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD,0)                               
AC$ND    DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTADD,1)                       
AC$SPW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTSUB,7)                       
AC$EPW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTSUB,1)                       
AC$SCW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW,0)                               
AC$ECW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTADD,6)                       
AC$SNW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTADD,7)                       
AC$ENW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTADD,13)                      
AC$SPM   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM)                         
AC$EPM   DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTRELM+SOFTSUB,1)               
AC$SCM2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELM,0)                               
AC$ECM   DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTECM)                 
AC$SNM   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSNM)                         
AC$ENM   DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTENM)                 
AC$SY    DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSOY)                         
AC$EY    DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTEOY)                 
AC$PFM   DC    AL1(SOFTPMON,SOFTYM+SOFTMODY+SOFTFISC,SOFTSUB,1)                 
AC$CFM   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,0,0)                              
AC$NFM   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTADD,1)                        
AC$PFQSM DC    AL1(SOFTPMON,SOFTYM+SOFTMODY+SOFTFISC)                           
         DC    AL1(SOFTRELQ+SOFTSUB,3)                                          
AC$PFQEM DC    AL1(SOFTPMON,SOFTYM+SOFTMODY+SOFTFISC)                           
         DC    AL1(SOFTRELQ+SOFTSUB,1)                                          
AC$CFQSM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTRELQ,0)                       
AC$CFQEM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTRELQ+SOFTADD,2)               
AC$NFQSM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTRELQ+SOFTADD,3)               
AC$NFQEM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTRELQ+SOFTADD,5)               
AC$FQ1SM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,1)                       
AC$FQ1EM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,3)                       
AC$FQ2SM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,4)                       
AC$FQ2EM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,6)                       
AC$FQ3SM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,7)                       
AC$FQ3EM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,9)                       
AC$FQ4SM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,10)                      
AC$FQ4EM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,12)                      
AC$PFHSM DC    AL1(SOFTPMON,SOFTYM+SOFTMODY+SOFTFISC)                           
         DC    AL1(SOFTRELH+SOFTSUB,6)                                          
AC$PFHEM DC    AL1(SOFTPMON,SOFTYM+SOFTMODY+SOFTFISC)                           
         DC    AL1(SOFTRELH+SOFTSUB,1)                                          
AC$CFHSM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTRELH,0)                       
AC$CFHEM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTRELH+SOFTADD,5)               
AC$NFHSM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTRELH+SOFTADD,6)               
AC$NFHEM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTRELH+SOFTADD,11)              
AC$FH1SM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,1)                       
AC$FH1EM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,6)                       
AC$FH2SM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,7)                       
AC$FH2EM DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,12)                      
AC$FM1   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,1)                       
AC$FM2   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,2)                       
AC$FM3   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,3)                       
AC$FM4   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,4)                       
AC$FM5   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,5)                       
AC$FM6   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,6)                       
AC$FM7   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,7)                       
AC$FM8   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,8)                       
AC$FM9   DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,9)                       
AC$FM10  DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,10)                      
AC$FM11  DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,11)                      
AC$FM12  DC    AL1(0,SOFTYM+SOFTMODY+SOFTFISC,SOFTABSM,12)                      
AC$NBD   DC    AL1(0,SOFTYMD,SOFTSPCL,SOFTNBD)                                  
AC$PD2   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,2)                       
AC$PD3   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,3)                       
AC$PD4   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,4)                       
AC$PD5   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,5)                       
AC$PD6   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,6)                       
AC$PD7   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,7)                       
AC$SPM2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM2)                        
AC$EPM2  DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTEPM2)                
AC$SPM3  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM3)                        
AC$EPM3  DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTEPM3)                
AC$PM2   DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTSUB,2)                          
AC$PM3   DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTSUB,3)                          
AC$NM1   DC    AL1(0,SOFTYM+SOFTMODY,SOFTADD,2)                                 
AC$SNM2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSNM2)                        
AC$ENM2  DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTENM2)                
AC$SNM3  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSNM3)                        
AC$ENM3  DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTENM3)                
         EJECT                                                                  
REPTAB   DS    0X                  ** REPPAK SOFT DATE TABLE **                 
SPTTAB   DS    0X                  ** SPOTPAK SOFT DATE TABLE **                
NETTAB   DS    0X                  ** NETPAK SOFT DATE TABLE **                 
PRTTAB   DS    0X                  ** PRINTPAK SOFT DATE TABLE **               
MEDTAB   DS    0X                  ** MEDLINE SOFT DATE TABLE **                
MPLTAB   DS    0X                  ** MEDIA PLANNING SOFT DATE TABLE **         
TALTAB   DS    0X                  ** TALENT SOFT DATE TABLE **                 
MBATAB   DS    0X                  ** MEDIABASE SOFT DATE TABLE **              
STRTAB   DS    0X                  ** SPOT TRAFFIC SOFT DATE TABLE **           
CONTAB   DS    0X                  ** CONTROL SOFT DATE TABLE **                
                                                                                
GE$PM    DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTSUB,1)                          
GE$CM    DC    AL1(0,SOFTYM+SOFTMODY,0,0)                                       
GE$NM    DC    AL1(0,SOFTYM+SOFTMODY,SOFTADD,1)                                 
GE$M1    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,1)                                
GE$M2    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,2)                                
GE$M3    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,3)                                
GE$M4    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,4)                                
GE$M5    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,5)                                
GE$M6    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,6)                                
GE$M7    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,7)                                
GE$M8    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,8)                                
GE$M9    DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,9)                                
GE$M10   DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,10)                               
GE$M11   DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,11)                               
GE$M12   DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,12)                               
GE$PQSM  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTRELQ+SOFTSUB,3)                 
GE$PQEM  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTRELQ+SOFTSUB,1)                 
GE$CQSM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELQ,0)                                
GE$CQEM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELQ+SOFTADD,2)                        
GE$NQSM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELQ+SOFTADD,3)                        
GE$NQEM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELQ+SOFTADD,5)                        
GE$Q1SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,1)                                
GE$Q1EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,3)                                
GE$Q2SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,4)                                
GE$Q2EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,6)                                
GE$Q3SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,7)                                
GE$Q3EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,9)                                
GE$Q4SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,10)                               
GE$Q4EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,12)                               
GE$PHSM  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTRELH+SOFTSUB,6)                 
GE$PHEM  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTRELH+SOFTSUB,1)                 
GE$CHSM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELH,0)                                
GE$CHEM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELH+SOFTADD,5)                        
GE$NHSM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELH+SOFTADD,6)                        
GE$NHEM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTRELH+SOFTADD,11)                       
GE$H1SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,1)                                
GE$H1EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,6)                                
GE$H2SM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,7)                                
GE$H2EM  DC    AL1(0,SOFTYM+SOFTMODY,SOFTABSM,12)                               
GE$PD    DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,1)                       
GE$CD    DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD,0)                               
GE$ND    DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTADD,1)                       
GE$SPW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTSUB,7)                       
GE$EPW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTSUB,1)                       
GE$SCW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW,0)                               
GE$ECW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTADD,6)                       
GE$SNW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTADD,7)                       
GE$ENW   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELW+SOFTADD,13)                      
GE$SPM   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM)                         
GE$EPM   DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTRELM+SOFTSUB,1)               
GE$SCM2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELM,0)                               
GE$ECM   DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTECM)                 
GE$SNM   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSNM)                         
GE$ENM   DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTENM)                 
GE$SY    DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSOY)                         
GE$EY    DC    AL1(0,SOFTYMD+SOFTEOM+SOFTMODY,SOFTSPCL,SOFTEOY)                 
GE$NBD   DC    AL1(0,SOFTYMD,SOFTSPCL,SOFTNBD)                                  
GE$PD2   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,2)                       
GE$PD3   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,3)                       
GE$PD4   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,4)                       
GE$PD5   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,5)                       
GE$PD6   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,6)                       
GE$PD7   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTRELD+SOFTSUB,7)                       
GE$SPBM  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPBM)                        
GE$EPBM  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTEPBM)                        
GE$SCBM  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSCBM)                        
GE$ECBM  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTECBM)                        
GE$SNBM  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSNBM)                        
GE$ENBM  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTENBM)                        
GE$SPM2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM2)                        
GE$EPM2  DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTEPM2)                
GE$SPM3  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM3)                        
GE$EPM3  DC    AL1(0,SOFTYMD+SOFTMODY+SOFTEOM,SOFTSPCL,SOFTEPM3)                
GE$PM2   DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTSUB,2)                          
GE$PM3   DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTSUB,3)                          
GE$NM1   DC    AL1(0,SOFTYM+SOFTMODY,SOFTADD,2)                                 
GE$SPB2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPB2)                        
GE$EPB2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTEPB2)                        
GE$SBY   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSBY)                         
GE$EBY   DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTEBY)                         
GE$SNM2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSNM2)                        
GE$ENM2  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTENM2)                        
GE$SNM3  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSNM3)                        
GE$ENM3  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTENM3)                        
GE$PM12  DC    AL1(SOFTPMON,SOFTYM+SOFTMODY,SOFTSUB,12)                         
GE$SPM4  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM4)                        
GE$SPM5  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM5)                        
GE$SPM6  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM6)                        
GE$SPM7  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM7)                        
GE$SPM8  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM8)                        
GE$SPM9  DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM9)                        
GE$SPM10 DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM10)                       
GE$SPM11 DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM11)                       
GE$SPM12 DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM12)                       
GE$SPB18 DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPB18)                       
GE$SPM18 DC    AL1(0,SOFTYMD+SOFTMODY,SOFTSPCL,SOFTSPM18)                       
         EJECT                                                                  
ACCDCD   DS    0XL4                ** ACCPAK KEYWORDS **                        
         DCDDL AC#PM,SOFNTRYL                                                   
         DCDDL AC#CM,SOFNTRYL                                                   
         DCDDL AC#NM,SOFNTRYL                                                   
         DCDDL AC#M1,SOFNTRYL                                                   
         DCDDL AC#M2,SOFNTRYL                                                   
         DCDDL AC#M3,SOFNTRYL                                                   
         DCDDL AC#M4,SOFNTRYL                                                   
         DCDDL AC#M5,SOFNTRYL                                                   
         DCDDL AC#M6,SOFNTRYL                                                   
         DCDDL AC#M7,SOFNTRYL                                                   
         DCDDL AC#M8,SOFNTRYL                                                   
         DCDDL AC#M9,SOFNTRYL                                                   
         DCDDL AC#M10,SOFNTRYL                                                  
         DCDDL AC#M11,SOFNTRYL                                                  
         DCDDL AC#M12,SOFNTRYL                                                  
         DCDDL AC#PQSM,SOFNTRYL                                                 
         DCDDL AC#PQEM,SOFNTRYL                                                 
         DCDDL AC#CQSM,SOFNTRYL                                                 
         DCDDL AC#CQEM,SOFNTRYL                                                 
         DCDDL AC#NQSM,SOFNTRYL                                                 
         DCDDL AC#NQEM,SOFNTRYL                                                 
         DCDDL AC#Q1SM,SOFNTRYL                                                 
         DCDDL AC#Q1EM,SOFNTRYL                                                 
         DCDDL AC#Q2SM,SOFNTRYL                                                 
         DCDDL AC#Q2EM,SOFNTRYL                                                 
         DCDDL AC#Q3SM,SOFNTRYL                                                 
         DCDDL AC#Q3EM,SOFNTRYL                                                 
         DCDDL AC#Q4SM,SOFNTRYL                                                 
         DCDDL AC#Q4EM,SOFNTRYL                                                 
         DCDDL AC#PHSM,SOFNTRYL                                                 
         DCDDL AC#PHEM,SOFNTRYL                                                 
         DCDDL AC#CHSM,SOFNTRYL                                                 
         DCDDL AC#CHEM,SOFNTRYL                                                 
         DCDDL AC#NHSM,SOFNTRYL                                                 
         DCDDL AC#NHEM,SOFNTRYL                                                 
         DCDDL AC#H1SM,SOFNTRYL                                                 
         DCDDL AC#H1EM,SOFNTRYL                                                 
         DCDDL AC#H2SM,SOFNTRYL                                                 
         DCDDL AC#H2EM,SOFNTRYL                                                 
         DCDDL AC#PD,SOFNTRYL                                                   
         DCDDL AC#CD,SOFNTRYL                                                   
         DCDDL AC#ND,SOFNTRYL                                                   
         DCDDL AC#SPW,SOFNTRYL                                                  
         DCDDL AC#EPW,SOFNTRYL                                                  
         DCDDL AC#SCW,SOFNTRYL                                                  
         DCDDL AC#ECW,SOFNTRYL                                                  
         DCDDL AC#SNW,SOFNTRYL                                                  
         DCDDL AC#ENW,SOFNTRYL                                                  
         DCDDL AC#SPM,SOFNTRYL                                                  
         DCDDL AC#EPM,SOFNTRYL                                                  
         DCDDL AC#SCM2,SOFNTRYL                                                 
         DCDDL AC#ECM,SOFNTRYL                                                  
         DCDDL AC#SNM,SOFNTRYL                                                  
         DCDDL AC#ENM,SOFNTRYL                                                  
         DCDDL AC#SY,SOFNTRYL                                                   
         DCDDL AC#EY,SOFNTRYL                                                   
         DCDDL AC#PFM,SOFNTRYL                                                  
         DCDDL AC#CFM,SOFNTRYL                                                  
         DCDDL AC#NFM,SOFNTRYL                                                  
         DCDDL AC#PFQSM,SOFNTRYL                                                
         DCDDL AC#PFQEM,SOFNTRYL                                                
         DCDDL AC#CFQSM,SOFNTRYL                                                
         DCDDL AC#CFQEM,SOFNTRYL                                                
         DCDDL AC#NFQSM,SOFNTRYL                                                
         DCDDL AC#NFQEM,SOFNTRYL                                                
         DCDDL AC#FQ1SM,SOFNTRYL                                                
         DCDDL AC#FQ1EM,SOFNTRYL                                                
         DCDDL AC#FQ2SM,SOFNTRYL                                                
         DCDDL AC#FQ2EM,SOFNTRYL                                                
         DCDDL AC#FQ3SM,SOFNTRYL                                                
         DCDDL AC#FQ3EM,SOFNTRYL                                                
         DCDDL AC#FQ4SM,SOFNTRYL                                                
         DCDDL AC#FQ4EM,SOFNTRYL                                                
         DCDDL AC#PFHSM,SOFNTRYL                                                
         DCDDL AC#PFHEM,SOFNTRYL                                                
         DCDDL AC#CFHSM,SOFNTRYL                                                
         DCDDL AC#CFHEM,SOFNTRYL                                                
         DCDDL AC#NFHSM,SOFNTRYL                                                
         DCDDL AC#NFHEM,SOFNTRYL                                                
         DCDDL AC#FH1SM,SOFNTRYL                                                
         DCDDL AC#FH1EM,SOFNTRYL                                                
         DCDDL AC#FH2SM,SOFNTRYL                                                
         DCDDL AC#FH2EM,SOFNTRYL                                                
         DCDDL AC#FM1,SOFNTRYL                                                  
         DCDDL AC#FM2,SOFNTRYL                                                  
         DCDDL AC#FM3,SOFNTRYL                                                  
         DCDDL AC#FM4,SOFNTRYL                                                  
         DCDDL AC#FM5,SOFNTRYL                                                  
         DCDDL AC#FM6,SOFNTRYL                                                  
         DCDDL AC#FM7,SOFNTRYL                                                  
         DCDDL AC#FM8,SOFNTRYL                                                  
         DCDDL AC#FM9,SOFNTRYL                                                  
         DCDDL AC#FM10,SOFNTRYL                                                 
         DCDDL AC#FM11,SOFNTRYL                                                 
         DCDDL AC#FM12,SOFNTRYL                                                 
         DCDDL AC#NBD,SOFNTRYL                                                  
         DCDDL AC#PD2,SOFNTRYL                                                  
         DCDDL AC#PD3,SOFNTRYL                                                  
         DCDDL AC#PD4,SOFNTRYL                                                  
         DCDDL AC#PD5,SOFNTRYL                                                  
         DCDDL AC#PD6,SOFNTRYL                                                  
         DCDDL AC#PD7,SOFNTRYL                                                  
         DCDDL AC#SPM2,SOFNTRYL                                                 
         DCDDL AC#EPM2,SOFNTRYL                                                 
         DCDDL AC#SPM3,SOFNTRYL                                                 
         DCDDL AC#EPM3,SOFNTRYL                                                 
         DCDDL AC#PM2,SOFNTRYL                                                  
         DCDDL AC#PM3,SOFNTRYL                                                  
         DCDDL AC#NM1,SOFNTRYL                                                  
         DCDDL AC#SNM2,SOFNTRYL                                                 
         DCDDL AC#ENM2,SOFNTRYL                                                 
         DCDDL AC#SNM3,SOFNTRYL                                                 
         DCDDL AC#ENM3,SOFNTRYL                                                 
ACCDCDN  EQU   (*-ACCDCD)/L'ACCDCD                                              
         DC    X'00'                                                            
         EJECT                                                                  
SPTDCD   DS    0XL4                ** SPOTPAK KEYWORDS **                       
NETDCD   DS    0XL4                ** NETPAK KEYWORDS **                        
PRTDCD   DS    0XL4                ** PRINTPAK KEYWORDS **                      
MEDDCD   DS    0XL4                ** MEDLINE KEYWORDS **                       
MPLDCD   DS    0XL4                ** MEDIA PLANNING KEYWORDS **                
TALDCD   DS    0XL4                ** TALENT KEYWORDS **                        
REPDCD   DS    0XL4                ** REPPAK KEYWORDS **                        
MBADCD   DS    0XL4                ** MEDIABASE KEYWORDS **                     
STRDCD   DS    0XL4                ** SPOT TRAFFIC KEYWORDS **                  
CONDCD   DS    0XL4                ** CONTROL KEYWORDS **                       
         DCDDL AC#PM,SOFNTRYL                                                   
         DCDDL AC#CM,SOFNTRYL                                                   
         DCDDL AC#NM,SOFNTRYL                                                   
         DCDDL AC#M1,SOFNTRYL                                                   
         DCDDL AC#M2,SOFNTRYL                                                   
         DCDDL AC#M3,SOFNTRYL                                                   
         DCDDL AC#M4,SOFNTRYL                                                   
         DCDDL AC#M5,SOFNTRYL                                                   
         DCDDL AC#M6,SOFNTRYL                                                   
         DCDDL AC#M7,SOFNTRYL                                                   
         DCDDL AC#M8,SOFNTRYL                                                   
         DCDDL AC#M9,SOFNTRYL                                                   
         DCDDL AC#M10,SOFNTRYL                                                  
         DCDDL AC#M11,SOFNTRYL                                                  
         DCDDL AC#M12,SOFNTRYL                                                  
         DCDDL AC#PQSM,SOFNTRYL                                                 
         DCDDL AC#PQEM,SOFNTRYL                                                 
         DCDDL AC#CQSM,SOFNTRYL                                                 
         DCDDL AC#CQEM,SOFNTRYL                                                 
         DCDDL AC#NQSM,SOFNTRYL                                                 
         DCDDL AC#NQEM,SOFNTRYL                                                 
         DCDDL AC#Q1SM,SOFNTRYL                                                 
         DCDDL AC#Q1EM,SOFNTRYL                                                 
         DCDDL AC#Q2SM,SOFNTRYL                                                 
         DCDDL AC#Q2EM,SOFNTRYL                                                 
         DCDDL AC#Q3SM,SOFNTRYL                                                 
         DCDDL AC#Q3EM,SOFNTRYL                                                 
         DCDDL AC#Q4SM,SOFNTRYL                                                 
         DCDDL AC#Q4EM,SOFNTRYL                                                 
         DCDDL AC#PHSM,SOFNTRYL                                                 
         DCDDL AC#PHEM,SOFNTRYL                                                 
         DCDDL AC#CHSM,SOFNTRYL                                                 
         DCDDL AC#CHEM,SOFNTRYL                                                 
         DCDDL AC#NHSM,SOFNTRYL                                                 
         DCDDL AC#NHEM,SOFNTRYL                                                 
         DCDDL AC#H1SM,SOFNTRYL                                                 
         DCDDL AC#H1EM,SOFNTRYL                                                 
         DCDDL AC#H2SM,SOFNTRYL                                                 
         DCDDL AC#H2EM,SOFNTRYL                                                 
         DCDDL AC#PD,SOFNTRYL                                                   
         DCDDL AC#CD,SOFNTRYL                                                   
         DCDDL AC#ND,SOFNTRYL                                                   
         DCDDL AC#SPW,SOFNTRYL                                                  
         DCDDL AC#EPW,SOFNTRYL                                                  
         DCDDL AC#SCW,SOFNTRYL                                                  
         DCDDL AC#ECW,SOFNTRYL                                                  
         DCDDL AC#SNW,SOFNTRYL                                                  
         DCDDL AC#ENW,SOFNTRYL                                                  
         DCDDL AC#SPM,SOFNTRYL                                                  
         DCDDL AC#EPM,SOFNTRYL                                                  
         DCDDL AC#SCM2,SOFNTRYL                                                 
         DCDDL AC#ECM,SOFNTRYL                                                  
         DCDDL AC#SNM,SOFNTRYL                                                  
         DCDDL AC#ENM,SOFNTRYL                                                  
         DCDDL AC#SY,SOFNTRYL                                                   
         DCDDL AC#EY,SOFNTRYL                                                   
         DCDDL AC#NBD,SOFNTRYL                                                  
         DCDDL AC#PD2,SOFNTRYL                                                  
         DCDDL AC#PD3,SOFNTRYL                                                  
         DCDDL AC#PD4,SOFNTRYL                                                  
         DCDDL AC#PD5,SOFNTRYL                                                  
         DCDDL AC#PD6,SOFNTRYL                                                  
         DCDDL AC#PD7,SOFNTRYL                                                  
         DCDDL AC#SPBM,SOFNTRYL                                                 
         DCDDL AC#EPBM,SOFNTRYL                                                 
         DCDDL AC#SCBM,SOFNTRYL                                                 
         DCDDL AC#ECBM,SOFNTRYL                                                 
         DCDDL AC#SNBM,SOFNTRYL                                                 
         DCDDL AC#ENBM,SOFNTRYL                                                 
         DCDDL AC#SPM2,SOFNTRYL                                                 
         DCDDL AC#EPM2,SOFNTRYL                                                 
         DCDDL AC#SPM3,SOFNTRYL                                                 
         DCDDL AC#EPM3,SOFNTRYL                                                 
         DCDDL AC#PM2,SOFNTRYL                                                  
         DCDDL AC#PM3,SOFNTRYL                                                  
         DCDDL AC#NM1,SOFNTRYL                                                  
         DCDDL AC#SPBM2,SOFNTRYL                                                
         DCDDL AC#EPBM2,SOFNTRYL                                                
         DCDDL AC#SBY,SOFNTRYL                                                  
         DCDDL AC#EBY,SOFNTRYL                                                  
         DCDDL AC#SNM2,SOFNTRYL                                                 
         DCDDL AC#ENM2,SOFNTRYL                                                 
         DCDDL AC#SNM3,SOFNTRYL                                                 
         DCDDL AC#ENM3,SOFNTRYL                                                 
         DCDDL AC#PM12,SOFNTRYL                                                 
         DCDDL AC#SPM4,SOFNTRYL                                                 
         DCDDL AC#SPM5,SOFNTRYL                                                 
         DCDDL AC#SPM6,SOFNTRYL                                                 
         DCDDL AC#SPM7,SOFNTRYL                                                 
         DCDDL AC#SPM8,SOFNTRYL                                                 
         DCDDL AC#SPM9,SOFNTRYL                                                 
         DCDDL AC#SPM10,SOFNTRYL                                                
         DCDDL AC#SPM11,SOFNTRYL                                                
         DCDDL AC#SPM12,SOFNTRYL                                                
         DCDDL AC#SPB18,SOFNTRYL                                                
         DCDDL AC#SPM18,SOFNTRYL                                                
SPTDCDN  EQU   (*-SPTDCD)/L'SPTDCD                                              
NETDCDN  EQU   (*-NETDCD)/L'NETDCD                                              
PRTDCDN  EQU   (*-PRTDCD)/L'PRTDCD                                              
MEDDCDN  EQU   (*-MEDDCD)/L'MEDDCD                                              
MPLDCDN  EQU   (*-MPLDCD)/L'MPLDCD                                              
TALDCDN  EQU   (*-TALDCD)/L'TALDCD                                              
REPDCDN  EQU   (*-REPDCD)/L'REPDCD                                              
MBADCDN  EQU   (*-MBADCD)/L'MBADCD                                              
STRDCDN  EQU   (*-STRDCD)/L'STRDCD                                              
CONDCDN  EQU   (*-CONDCD)/L'CONDCD                                              
         DC    X'00'                                                            
*                                                                               
WORKD    DSECT                     ** LOCAL WORKING STORAGE **                  
                                                                                
DUB      DS    D                                                                
DMCB     DS    6F                                                               
WORK     DS    XL64                                                             
HALF     DS    H                                                                
BYTE1    DS    X                                                                
BYTE2    DS    X                                                                
                                                                                
AGETBRD  DS    V                   RELOCATED (MUST BE IN US LINK)               
VADDAY   DS    V                   SET FROM CADDAY                              
VDATCON  DS    V                   SET FROM CDATCON                             
VDICTATE DS    V                   SET FROM CDICTATE                            
VGETDAY  DS    V                   SET FROM CGETDAY                             
VGETRET  DS    V                   SET FROM CGETRET                             
VPERVAL  DS    V                   SET FROM CPERVAL                             
VPERVERT DS    V                   SET FROM CPERVERT                            
ASOFTAB  DS    A                   A(SYSTEM SOFT DATE TABLE)                    
ADCDTAB  DS    A                   A(SYSTEM KEYWORD DCDD LIST)                  
AOUT     DS    A                   A(1ST OUTPUT FLD FOR PDATE ROUTINE)          
AKEYWRDS DS    A                   A(KEYWORD LIST)                              
                                                                                
SAVERER1 DS    4A                  SAVE AREA FOR RE THROUGH R1                  
                                                                                
PASS     DS    X                   0=VALIDATE, 1=PROCESS                        
INDS     DS    X                   GLOBAL INDICATORS                            
INDSSGRE EQU   X'80'               START GREATER THAN END ERROR                 
INDSYRMO EQU   X'40'               YEAR MODIFIER APPLIED                        
INDSPMON EQU   X'20'               END DATE IS PRIOR MONTH EXPRESSION           
INDSSOFT EQU   X'10'               SOFT DATE INPUT                              
                                                                                
LASTS    DS    0X                  ** LAST TIME KEY **                          
LASTSYSN DS    X                   LAST TIME SYSTEM                             
LASTLANG DS    X                   LAST TIME LANG                               
LASTSL   EQU   *-LASTS             LENGTH OF KEY                                
                                                                                
ITYPE    DS    X                   EXTRACTED INPUT TYPE                         
IINDS    DS    X                   EXTRACTED INPUT INDICATORS                   
OTYPE    DS    X                   EXTRACTED OUTPUT TYPE                        
OINDS    DS    X                   EXTRACTED OUTPUT INDICATORS                  
NDCDNUM  DS    X                   N'ENTRIES IN SYSTEM DCDD LIST                
DICSYSN  DS    X                   SYSTEM NUMBER FOR SOFT KEYWORDS              
RFPSYSN  DS    X                   SYSTEM NUMBER FOR RFP KEYWORDS               
                                                                                
YEARMOD  DS    A                   YEAR MODIFIER (+/- 0-7)                      
MONBASE  DS    X                   MONTH BASIS                                  
DOWBASE  DS    X                   DAY OF WEEK BASIS                            
DOW      DS    X                   DAY OF WEEK OF TODAY'S DATE                  
YMDFILT  DS    X                   YM/YMD KEYWORD FILTER                        
                                                                                
PERDSPS  DS    0XL2                DISPLACEMENTS TO PERVAL DATE VALUES          
PERDSPF1 DS    X                   DISPLACEMENT TO FIELD 1 (START DATE)         
PERDSPF2 DS    X                   DISPLACEMENT TO FIELD 2 (END DATE)           
                                                                                
SFLAG    DS    X                   SALL ROUTINE EXIT FLAG                       
SFLAGRES EQU   X'80'               CALLED TO RESOLVE DATES                      
                                                                                
SDATE    DS    0XL2                SOFT DATE                                    
SDATMOD  DS    X                   YEAR MODIFIER                                
SDATTST  EQU   X'F0'               SOFT DATE TEST BITS                          
SDATNEG  EQU   X'08'               NEGATIVE MODIFIER VALUE                      
SDATVAL  EQU   X'07'               MODIFIER VALUE (0-7)                         
SDATNUM  DS    X                   SOFT DATE NUMBER                             
SDATBASE EQU   64                  SOFT DATE BASE NUMBER                        
                                                                                
TODAY1   DS    CL6                 DATE BASE FOR START DATE                     
TODAY2   DS    CL6                 DATE BASE FOR END DATE                       
                                                                                
ODATE    DS    0CL6                EXPLODED SOFT DATE                           
ODATEYY  DS    CL2                 YEAR                                         
ODATEMM  DS    CL2                 MONTH                                        
ODATEDD  DS    CL2                 DAY                                          
                                                                                
MONLST   DS    (MONSYEAR)CL4       LIST OF CALENDAR MONTHS                      
FSCLST   DS    (MONSYEAR)CL4       LIST OF FISCAL MONTHS                        
FSCLSTL  EQU   *-FSCLST                                                         
                                                                                
DATILEN  DS    X                   INPUT/OUTPUT DATE LENGTH                     
                                                                                
DATTYPE  DS    0XL2                OUTPUT DATE FORMAT FOR DATCON                
DATTYPEI DS    X                   DATCON INPUT TYPE                            
DATTYPEO DS    X                   DATCON OUTPUT TYPE                           
                                                                                
FLDNUM   DS    X                   FIELD NUMBER BEING VALIDATED                 
                                                                                
FLDIRFP  EQU   X'80'               FIELD N IS RFP SYMBOL                        
                                                                                
FLD1IND  DS    X                   FIELD 1 INDICATOR BYTE                       
FLD1L    DS    X                   FIELD 1 DATA LENGTH                          
FLD1     DS    CL32                FIELD 1 DATA VALUE                           
                                                                                
FLD2IND  DS    X                   FIELD 1 INDICATOR BYTE                       
FLD2L    DS    X                   FIELD 2 DATA LENGTH                          
FLD2     DS    CL32                FIELD 2 DATA VALUE                           
                                                                                
ERRORS   DS    0X                  ** SYSTEM ERROR MESSAGE NUMBERS **           
MISSING  DS    XL2                 MISSING INPUT FIELD                          
INVALID  DS    XL2                 INVALID INPUT FIELD                          
NOTNUMRC DS    XL2                 NON-NUMERIC INPUT FIELD                      
TOOLARGE DS    XL2                 FIELD VALUE TOO LARGE                        
TOOSMALL DS    XL2                 FIELD VALUE TOO SMALL                        
STDGREND DS    XL2                 START DATE GREATER THAN END                  
PERIODTL DS    XL2                 PERIOD TOO LONG                              
ERRORSL  EQU   *-ERRORS                                                         
                                                                                
KEYWORDS DS    (SOFNTRYM)CL(SOFNTRYL)                                           
                                                                                
         ORG   KEYWORDS                                                         
                                                                                
***********************************************************************         
* ACCPAK KEYWORDS                                                     *         
***********************************************************************         
                                                                                
***********************************************************************         
* CALENDAR MONTH EXPRESSIONS (YEAR/MONTH ONLY)                        *         
***********************************************************************         
                                                                                
AC@PM    DS    CL(SOFNTRYL)        PREVIOUS MONTH                               
AC@CM    DS    CL(SOFNTRYL)        CURRENT MONTH                                
AC@NM    DS    CL(SOFNTRYL)        NEXT MONTH                                   
AC@M1    DS    CL(SOFNTRYL)        MONTH 1  - JANUARY                           
AC@M2    DS    CL(SOFNTRYL)        MONTH 2  - FEBRUARY                          
AC@M3    DS    CL(SOFNTRYL)        MONTH 3  - MARCH                             
AC@M4    DS    CL(SOFNTRYL)        MONTH 4  - APRIL                             
AC@M5    DS    CL(SOFNTRYL)        MONTH 5  - MAY                               
AC@M6    DS    CL(SOFNTRYL)        MONTH 6  - JUNE                              
AC@M7    DS    CL(SOFNTRYL)        MONTH 7  - JULY                              
AC@M8    DS    CL(SOFNTRYL)        MONTH 8  - AUGUST                            
AC@M9    DS    CL(SOFNTRYL)        MONTH 9  - SEPTEMBER                         
AC@M10   DS    CL(SOFNTRYL)        MONTH 10 - OCTOBER                           
AC@M11   DS    CL(SOFNTRYL)        MONTH 11 - NOVEMBER                          
AC@M12   DS    CL(SOFNTRYL)        MONTH 12 - DECEMBER                          
AC@PQSM  DS    CL(SOFNTRYL)        PREVIOUS QUARTER START MONTH                 
AC@PQEM  DS    CL(SOFNTRYL)        PREVIOUS QUARTER END MONTH                   
AC@CQSM  DS    CL(SOFNTRYL)        CURRENT QUARTER START MONTH                  
AC@CQEM  DS    CL(SOFNTRYL)        CURRENT QUARTER END MONTH                    
AC@NQSM  DS    CL(SOFNTRYL)        NEXT QUARTER START MONTH                     
AC@NQEM  DS    CL(SOFNTRYL)        NEXT QUARTER END MONTH                       
AC@Q1SM  DS    CL(SOFNTRYL)        QUARTER 1 START MONTH - JANUARY              
AC@Q1EM  DS    CL(SOFNTRYL)        QUARTER 1 END MONTH   - MARCH                
AC@Q2SM  DS    CL(SOFNTRYL)        QUARTER 2 START MONTH - APRIL                
AC@Q2EM  DS    CL(SOFNTRYL)        QUARTER 2 END MONTH   - JUNE                 
AC@Q3SM  DS    CL(SOFNTRYL)        QUARTER 3 START MONTH - JULY                 
AC@Q3EM  DS    CL(SOFNTRYL)        QUARTER 3 END MONTH   - SEPTEMBER            
AC@Q4SM  DS    CL(SOFNTRYL)        QUARTER 4 START MONTH - OCTOBER              
AC@Q4EM  DS    CL(SOFNTRYL)        QUARTER 4 END MONTH   - DECEMBER             
AC@PHSM  DS    CL(SOFNTRYL)        PREVIOUS HALF YEAR START MONTH               
AC@PHEM  DS    CL(SOFNTRYL)        PREVIOUS HALF YEAR END MONTH                 
AC@CHSM  DS    CL(SOFNTRYL)        CURRENT HALF YEAR START MONTH                
AC@CHEM  DS    CL(SOFNTRYL)        CURRENT HALF YEAR END MONTH                  
AC@NHSM  DS    CL(SOFNTRYL)        NEXT HALF YEAR START MONTH                   
AC@NHEM  DS    CL(SOFNTRYL)        NEXT HALF YEAR END MONTH                     
AC@H1SM  DS    CL(SOFNTRYL)        HALF YEAR 1 START MONTH - JANUARY            
AC@H1EM  DS    CL(SOFNTRYL)        HALF YEAR 1 END MONTH   - JUNE               
AC@H2SM  DS    CL(SOFNTRYL)        HALF YEAR 2 START MONTH - JULY               
AC@H2EM  DS    CL(SOFNTRYL)        HALF YEAR 2 END MONTH   - DECEMBER           
                                                                                
***********************************************************************         
* CALENDAR EXPRESSIONS (YEAR/MONTH/DAY ONLY)                          *         
***********************************************************************         
                                                                                
AC@PD    DS    CL(SOFNTRYL)        PREVIOUS DAY (YESTERDAY)                     
AC@CD    DS    CL(SOFNTRYL)        CURRENT DAY (TODAY)                          
AC@ND    DS    CL(SOFNTRYL)        NEXT DAY (TOMORROW)                          
AC@SPW   DS    CL(SOFNTRYL)        START DAY OF PREVIOUS WEEK                   
AC@EPW   DS    CL(SOFNTRYL)        END DAY OF PREVIOUS WEEK                     
AC@SCW   DS    CL(SOFNTRYL)        START DAY OF CURRENT WEEK                    
AC@ECW   DS    CL(SOFNTRYL)        END DAY OF CURRENT WEEK                      
AC@SNW   DS    CL(SOFNTRYL)        START DAY OF NEXT WEEK                       
AC@ENW   DS    CL(SOFNTRYL)        END DAY OF NEXT WEEK                         
AC@SPM   DS    CL(SOFNTRYL)        START DAY OF PREVIOUS MONTH                  
AC@EPM   DS    CL(SOFNTRYL)        END DAY OF PREVIOUS MONTH                    
AC@SCM2  DS    CL(SOFNTRYL)        START DAY OF CURRENT MONTH                   
AC@ECM   DS    CL(SOFNTRYL)        END DAY OF CURRENT MONTH                     
AC@SNM   DS    CL(SOFNTRYL)        START DAY OF NEXT MONTH                      
AC@ENM   DS    CL(SOFNTRYL)        END DAY OF NEXT MONTH                        
AC@SY    DS    CL(SOFNTRYL)        START DAY OF CURRENT YEAR                    
AC@EY    DS    CL(SOFNTRYL)        LAST DAY OF CURRENT YEAR                     
                                                                                
***********************************************************************         
* FISCAL EXPRESSIONS (YEAR/MONTH ONLY)                                *         
***********************************************************************         
                                                                                
AC@PFM   DS    CL(SOFNTRYL)        PREVIOUS MONTH                               
AC@CFM   DS    CL(SOFNTRYL)        CURRENT MONTH                                
AC@NFM   DS    CL(SOFNTRYL)        NEXT MONTH                                   
AC@PFQSM DS    CL(SOFNTRYL)        PREVIOUS QUARTER START MONTH                 
AC@PFQEM DS    CL(SOFNTRYL)        PREVIOUS QUARTER END MONTH                   
AC@CFQSM DS    CL(SOFNTRYL)        CURRENT QUARTER START MONTH                  
AC@CFQEM DS    CL(SOFNTRYL)        CURRENT QUARTER END MONTH                    
AC@NFQSM DS    CL(SOFNTRYL)        NEXT QUARTER START MONTH                     
AC@NFQEM DS    CL(SOFNTRYL)        NEXT QUARTER END MONTH                       
AC@FQ1SM DS    CL(SOFNTRYL)        QUARTER 1 START MONTH                        
AC@FQ1EM DS    CL(SOFNTRYL)        QUARTER 1 END MONTH                          
AC@FQ2SM DS    CL(SOFNTRYL)        QUARTER 2 START MONTH                        
AC@FQ2EM DS    CL(SOFNTRYL)        QUARTER 2 END MONTH                          
AC@FQ3SM DS    CL(SOFNTRYL)        QUARTER 3 START MONTH                        
AC@FQ3EM DS    CL(SOFNTRYL)        QUARTER 3 END MONTH                          
AC@FQ4SM DS    CL(SOFNTRYL)        QUARTER 4 START MONTH                        
AC@FQ4EM DS    CL(SOFNTRYL)        QUARTER 4 END MONTH                          
AC@PFHSM DS    CL(SOFNTRYL)        PREVIOUS HALF YEAR START MONTH               
AC@PFHEM DS    CL(SOFNTRYL)        PREVIOUS HALF YEAR END MONTH                 
AC@CFHSM DS    CL(SOFNTRYL)        CURRENT HALF YEAR START MONTH                
AC@CFHEM DS    CL(SOFNTRYL)        CURRENT HALF YEAR END MONTH                  
AC@NFHSM DS    CL(SOFNTRYL)        NEXT HALF YEAR START MONTH                   
AC@NFHEM DS    CL(SOFNTRYL)        NEXT HALF YEAR END MONTH                     
AC@FH1SM DS    CL(SOFNTRYL)        HALF YEAR 1 START MONTH                      
AC@FH1EM DS    CL(SOFNTRYL)        HALF YEAR 1 END MONTH                        
AC@FH2SM DS    CL(SOFNTRYL)        HALF YEAR 2 START MONTH                      
AC@FH2EM DS    CL(SOFNTRYL)        HALF YEAR 2 END MONTH                        
AC@FM1   DS    CL(SOFNTRYL)        MONTH 1                                      
AC@FM2   DS    CL(SOFNTRYL)        MONTH 2                                      
AC@FM3   DS    CL(SOFNTRYL)        MONTH 3                                      
AC@FM4   DS    CL(SOFNTRYL)        MONTH 4                                      
AC@FM5   DS    CL(SOFNTRYL)        MONTH 5                                      
AC@FM6   DS    CL(SOFNTRYL)        MONTH 6                                      
AC@FM7   DS    CL(SOFNTRYL)        MONTH 7                                      
AC@FM8   DS    CL(SOFNTRYL)        MONTH 8                                      
AC@FM9   DS    CL(SOFNTRYL)        MONTH 9                                      
AC@FM10  DS    CL(SOFNTRYL)        MONTH 10                                     
AC@FM11  DS    CL(SOFNTRYL)        MONTH 11                                     
AC@FM12  DS    CL(SOFNTRYL)        MONTH 12                                     
                                                                                
***********************************************************************         
* OTHER DATE EXPRESSIONS                                              *         
***********************************************************************         
                                                                                
AC@NBD   DS    CL(SOFNTRYL)        NEXT BUSINESS DAY                            
AC@PD2   DS    CL(SOFNTRYL)        PREVIOUS DAY-1                               
AC@PD3   DS    CL(SOFNTRYL)        PREVIOUS DAY-2                               
AC@PD4   DS    CL(SOFNTRYL)        PREVIOUS DAY-3                               
AC@PD5   DS    CL(SOFNTRYL)        PREVIOUS DAY-4                               
AC@PD6   DS    CL(SOFNTRYL)        PREVIOUS DAY-5                               
AC@PD7   DS    CL(SOFNTRYL)        PREVIOUS DAY-6                               
AC@SPM2  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-1                    
AC@EPM2  DS    CL(SOFNTRYL)        END OF PREVIOUS MONTH-1                      
AC@SPM3  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-2                    
AC@EPM3  DS    CL(SOFNTRYL)        END OF PREVIOUS MONTH-2                      
                                                                                
AC@PM2   DS    CL(SOFNTRYL)        PREVIOUS MONTH-1                             
AC@PM3   DS    CL(SOFNTRYL)        PREVIOUS MONTH-2                             
AC@NM1   DS    CL(SOFNTRYL)        NEXT MONTH+1                                 
AC@SNM2  DS    CL(SOFNTRYL)        START DAY OF NEXT MONTH+1                    
AC@ENM2  DS    CL(SOFNTRYL)        END DAY OF NEXT MONTH+1                      
AC@SNM3  DS    CL(SOFNTRYL)        START DAY OF NEXT MONTH+2                    
AC@ENM3  DS    CL(SOFNTRYL)        END DAY OF NEXT MONTH+2                      
                                                                                
         ORG   KEYWORDS                                                         
                                                                                
***********************************************************************         
* MEDIA SYSTEM KEYWORDS                                               *         
***********************************************************************         
                                                                                
***********************************************************************         
* CALENDAR MONTH EXPRESSIONS (YEAR/MONTH ONLY)                        *         
***********************************************************************         
                                                                                
GE@PM    DS    CL(SOFNTRYL)        PREVIOUS MONTH                               
GE@CM    DS    CL(SOFNTRYL)        CURRENT MONTH                                
GE@NM    DS    CL(SOFNTRYL)        NEXT MONTH                                   
GE@M1    DS    CL(SOFNTRYL)        MONTH 1  - JANUARY                           
GE@M2    DS    CL(SOFNTRYL)        MONTH 2  - FEBRUARY                          
GE@M3    DS    CL(SOFNTRYL)        MONTH 3  - MARCH                             
GE@M4    DS    CL(SOFNTRYL)        MONTH 4  - APRIL                             
GE@M5    DS    CL(SOFNTRYL)        MONTH 5  - MAY                               
GE@M6    DS    CL(SOFNTRYL)        MONTH 6  - JUNE                              
GE@M7    DS    CL(SOFNTRYL)        MONTH 7  - JULY                              
GE@M8    DS    CL(SOFNTRYL)        MONTH 8  - AUGUST                            
GE@M9    DS    CL(SOFNTRYL)        MONTH 9  - SEPTEMBER                         
GE@M10   DS    CL(SOFNTRYL)        MONTH 10 - OCTOBER                           
GE@M11   DS    CL(SOFNTRYL)        MONTH 11 - NOVEMBER                          
GE@M12   DS    CL(SOFNTRYL)        MONTH 12 - DECEMBER                          
GE@PQSM  DS    CL(SOFNTRYL)        PREVIOUS QUARTER START MONTH                 
GE@PQEM  DS    CL(SOFNTRYL)        PREVIOUS QUARTER END MONTH                   
GE@CQSM  DS    CL(SOFNTRYL)        CURRENT QUARTER START MONTH                  
GE@CQEM  DS    CL(SOFNTRYL)        CURRENT QUARTER END MONTH                    
GE@NQSM  DS    CL(SOFNTRYL)        NEXT QUARTER START MONTH                     
GE@NQEM  DS    CL(SOFNTRYL)        NEXT QUARTER END MONTH                       
GE@Q1SM  DS    CL(SOFNTRYL)        QUARTER 1 START MONTH - JANUARY              
GE@Q1EM  DS    CL(SOFNTRYL)        QUARTER 1 END MONTH   - MARCH                
GE@Q2SM  DS    CL(SOFNTRYL)        QUARTER 2 START MONTH - APRIL                
GE@Q2EM  DS    CL(SOFNTRYL)        QUARTER 2 END MONTH   - JUNE                 
GE@Q3SM  DS    CL(SOFNTRYL)        QUARTER 3 START MONTH - JULY                 
GE@Q3EM  DS    CL(SOFNTRYL)        QUARTER 3 END MONTH   - SEPTEMBER            
GE@Q4SM  DS    CL(SOFNTRYL)        QUARTER 4 START MONTH - OCTOBER              
GE@Q4EM  DS    CL(SOFNTRYL)        QUARTER 4 END MONTH   - DECEMBER             
GE@PHSM  DS    CL(SOFNTRYL)        PREVIOUS HALF YEAR START MONTH               
GE@PHEM  DS    CL(SOFNTRYL)        PREVIOUS HALF YEAR END MONTH                 
GE@CHSM  DS    CL(SOFNTRYL)        CURRENT HALF YEAR START MONTH                
GE@CHEM  DS    CL(SOFNTRYL)        CURRENT HALF YEAR END MONTH                  
GE@NHSM  DS    CL(SOFNTRYL)        NEXT HALF YEAR START MONTH                   
GE@NHEM  DS    CL(SOFNTRYL)        NEXT HALF YEAR END MONTH                     
GE@H1SM  DS    CL(SOFNTRYL)        HALF YEAR 1 START MONTH - JANUARY            
GE@H1EM  DS    CL(SOFNTRYL)        HALF YEAR 1 END MONTH   - JUNE               
GE@H2SM  DS    CL(SOFNTRYL)        HALF YEAR 2 START MONTH - JULY               
GE@H2EM  DS    CL(SOFNTRYL)        HALF YEAR 2 END MONTH   - DECEMBER           
                                                                                
***********************************************************************         
* CALENDAR EXPRESSIONS (YEAR/MONTH/DAY ONLY)                          *         
***********************************************************************         
                                                                                
GE@PD    DS    CL(SOFNTRYL)        PREVIOUS DAY (YESTERDAY)                     
GE@CD    DS    CL(SOFNTRYL)        CURRENT DAY (TODAY)                          
GE@ND    DS    CL(SOFNTRYL)        NEXT DAY (TOMORROW)                          
GE@SPW   DS    CL(SOFNTRYL)        START DAY OF PREVIOUS WEEK                   
GE@EPW   DS    CL(SOFNTRYL)        END DAY OF PREVIOUS WEEK                     
GE@SCW   DS    CL(SOFNTRYL)        START DAY OF CURRENT WEEK                    
GE@ECW   DS    CL(SOFNTRYL)        END DAY OF CURRENT WEEK                      
GE@SNW   DS    CL(SOFNTRYL)        START DAY OF NEXT WEEK                       
GE@ENW   DS    CL(SOFNTRYL)        END DAY OF NEXT WEEK                         
GE@SPM   DS    CL(SOFNTRYL)        START DAY OF PREVIOUS MONTH                  
GE@EPM   DS    CL(SOFNTRYL)        END DAY OF PREVIOUS MONTH                    
GE@SCM2  DS    CL(SOFNTRYL)        START DAY OF CURRENT MONTH                   
GE@ECM   DS    CL(SOFNTRYL)        END DAY OF CURRENT MONTH                     
GE@SNM   DS    CL(SOFNTRYL)        START DAY OF NEXT MONTH                      
GE@ENM   DS    CL(SOFNTRYL)        END DAY OF NEXT MONTH                        
GE@SY    DS    CL(SOFNTRYL)        START DAY OF CURRENT YEAR                    
GE@EY    DS    CL(SOFNTRYL)        LAST DAY OF CURRENT YEAR                     
GE@NBD   DS    CL(SOFNTRYL)        NEXT BUSINESS DAY                            
GE@PD2   DS    CL(SOFNTRYL)        PREVIOUS DAY-1                               
GE@PD3   DS    CL(SOFNTRYL)        PREVIOUS DAY-2                               
GE@PD4   DS    CL(SOFNTRYL)        PREVIOUS DAY-3                               
GE@PD5   DS    CL(SOFNTRYL)        PREVIOUS DAY-4                               
GE@PD6   DS    CL(SOFNTRYL)        PREVIOUS DAY-5                               
GE@PD7   DS    CL(SOFNTRYL)        PREVIOUS DAY-6                               
GE@SPBM  DS    CL(SOFNTRYL)        START DAY OF PREV BROADCAST MONTH            
GE@EPBM  DS    CL(SOFNTRYL)        END DAY OF PREV BROADCAST MONTH              
GE@SCBM  DS    CL(SOFNTRYL)        START DAY OF CURR BROADCAST MONTH            
GE@ECBM  DS    CL(SOFNTRYL)        END DAY OF CURR BROADCAST MONTH              
GE@SNBM  DS    CL(SOFNTRYL)        START DAY OF NEXT BROADCAST MONTH            
GE@ENBM  DS    CL(SOFNTRYL)        END DAY OF NEXT BROADCAST MONTH              
GE@SPM2  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-1                    
GE@EPM2  DS    CL(SOFNTRYL)        END OF PREVIOUS MONTH-1                      
GE@SPM3  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-2                    
GE@EPM3  DS    CL(SOFNTRYL)        END OF PREVIOUS MONTH-2                      
                                                                                
GE@PM2   DS    CL(SOFNTRYL)        PREVIOUS MONTH-1                             
GE@PM3   DS    CL(SOFNTRYL)        PREVIOUS MONTH-2                             
GE@NM1   DS    CL(SOFNTRYL)        NEXT MONTH+1                                 
                                                                                
GE@SPB2  DS    CL(SOFNTRYL)        START DAY OF PREV BROADCAST MONTH-1          
GE@EPB2  DS    CL(SOFNTRYL)        END DAY OF PREV BROADCAST MONTH-1            
GE@SBY   DS    CL(SOFNTRYL)        START OF BROADCAST YEAR                      
GE@EBY   DS    CL(SOFNTRYL)        END OF BROADCAST YEAR                        
                                                                                
GE@SNM2  DS    CL(SOFNTRYL)        START DAY OF NEXT MONTH+1                    
GE@ENM2  DS    CL(SOFNTRYL)        END DAY OF NEXT MONTH+1                      
GE@SNM3  DS    CL(SOFNTRYL)        START DAY OF NEXT MONTH+2                    
GE@ENM3  DS    CL(SOFNTRYL)        END DAY OF NEXT MONTH+2                      
                                                                                
GE@PM12  DS    CL(SOFNTRYL)        PREVIOUS MONTH-11                            
                                                                                
GE@SPM4  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-3                    
GE@SPM5  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-4                    
GE@SPM6  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-5                    
GE@SPM7  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-6                    
GE@SPM8  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-7                    
GE@SPM9  DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-8                    
GE@SPM10 DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-9                    
GE@SPM11 DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-10                   
GE@SPM12 DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-11                   
GE@SPB18 DS    CL(SOFNTRYL)        START DAY OF PREV BROADCAST MONTH-18         
GE@SPM18 DS    CL(SOFNTRYL)        START OF PREVIOUS MONTH-18                   
         ORG                                                                    
                                                                                
WORKL    EQU   *-WORKD                                                          
         EJECT                                                                  
SYSTABD  DSECT                     ** SYSTEM TABLE **                           
SYSTSYSN DS    X                   SYSTEM NUMBER                                
SYSTTDSP DS    AL2                 DISPLACEMENT TO SOFT DATE TABLE              
SYSTEDSP DS    AL2                 DISPLACEMENT TO ERROR NUMBER TABLE           
SYSTDDSP DS    AL2                 DISPLACEMENT TO KEYWORD DCDD LIST            
SYSTDNUM DS    X                   N'ENTRIES IN SYSTEM DCDD LIST                
SYSTSSYS DS    X                   SYSTEM NUMBER FOR SOFT KEYWORDS              
SYSTRSYS DS    X                   SYSTEM NUMBER FOR RFP KEYWORDS               
SYSTABL  EQU   *-SYSTABD                                                        
                                                                                
SOFTABD  DSECT                     ** SOFT KEYWORD TABLE **                     
                                                                                
SOFTIND1 DS    X                   ** INDICATOR BYTE 1 **                       
SOFTPMON EQU   X'80'               PRIOR MONTH EXPRESSION                       
                                                                                
SOFTIND2 DS    X                   ** INDICATOR BYTE 2 **                       
SOFTYM   EQU   X'80'               YEAR/MONTH                                   
SOFTYMD  EQU   X'40'               YEAR/MONTH/DAY                               
SOFTMODY EQU   X'20'               ACCEPTS YEAR MODIFIER                        
SOFTFISC EQU   X'10'               FISCAL EXPRESSION                            
SOFTEOM  EQU   X'08'               END OF MONTH EXPRESSION                      
                                                                                
SOFTIND3 DS    X                   ** INDICATOR BYTE 3 **                       
SOFTRELD EQU   X'80'               RELATIVE TO TODAY             (YMD)          
SOFTRELW EQU   X'40'               RELATIVE TO START OF WEEK     (YMD)          
SOFTABSM EQU   X'20'               ABSOLUTE MONTH                (YM)           
SOFTRELM EQU   X'10'               RELATIVE TO START OF MONTH    (YMD)          
SOFTRELQ EQU   X'08'               RELATIVE TO START OF QUARTER  (YM)           
SOFTRELH EQU   X'04'               RELATIVE TO START OF HALFYEAR (YM)           
SOFTSPCL EQU   X'03'               SPECIAL ROUTINES - SOFTMOD IS NUMBER         
SOFTSUB  EQU   X'02'               SUBTRACT DAY OR MONTH MODIFIER               
SOFTADD  EQU   X'01'               ADD DAY OR MONTH MODIFIER                    
                                                                                
SOFTMOD  DS    X                   DAY OR MONTH MODIFIER VALUE                  
*                                  SPECIAL VALUES  (SOFTIND3=SOFTSPCL)          
SOFTSPM  EQU   1                   START OF PREVIOUS MONTH       (YMD)          
SOFTECM  EQU   2                   END OF CURRENT MONTH          (YMD)          
SOFTSNM  EQU   3                   START OF NEXT MONTH           (YMD)          
SOFTENM  EQU   4                   END OF NEXT MONTH             (YMD)          
SOFTSOY  EQU   5                   START OF YEAR                 (YMD)          
SOFTEOY  EQU   6                   END OF YEAR                   (YMD)          
SOFTNBD  EQU   7                   NEXT BUSINESS DAY             (YMD)          
SOFTSPBM EQU   8                   START OF PREV BROADCAST MONTH (YMD)          
SOFTEPBM EQU   9                   END OF PREV BROADCAST MONTH   (YMD)          
SOFTSCBM EQU   10                  START OF CURR BROADCAST MONTH (YMD)          
SOFTECBM EQU   11                  END OF CURR BROADCAST MONTH   (YMD)          
SOFTSNBM EQU   12                  START OF NEXT BROADCAST MONTH (YMD)          
SOFTENBM EQU   13                  END OF NEXT BROADCAST MONTH   (YMD)          
SOFTSPM2 EQU   14                  START OF PREVIOUS MONTH-1     (YMD)          
SOFTSPM3 EQU   15                  START OF PREVIOUS MONTH-2     (YMD)          
SOFTEPM2 EQU   16                  END OF PREVIOUS MONTH-1       (YMD)          
SOFTEPM3 EQU   17                  END OF PREVIOUS MONTH-2       (YMD)          
SOFTSPB2 EQU   18                  START OF PREV B'CAST MONTH-1  (YMD)          
SOFTEPB2 EQU   19                  END OF PREV B'CAST MONTH-1    (YMD)          
SOFTSBY  EQU   20                  START OF BROADCAST YEAR       (YMD)          
SOFTEBY  EQU   21                  END OF BROADCAST YEAR         (YMD)          
SOFTSNM2 EQU   22                  START OF NEXT MONTH+1         (YMD)          
SOFTENM2 EQU   23                  END OF NEXT MONTH+1           (YMD)          
SOFTSNM3 EQU   24                  START OF NEXT MONTH+2         (YMD)          
SOFTENM3 EQU   25                  END OF NEXT MONTH+2           (YMD)          
SOFTSPM4 EQU   26                  START OF PREVIOUS MONTH-3     (YMD)          
SOFTSPM5 EQU   27                  START OF PREVIOUS MONTH-4     (YMD)          
SOFTSPM6 EQU   28                  START OF PREVIOUS MONTH-5     (YMD)          
SOFTSPM7 EQU   29                  START OF PREVIOUS MONTH-6     (YMD)          
SOFTSPM8 EQU   30                  START OF PREVIOUS MONTH-7     (YMD)          
SOFTSPM9 EQU   31                  START OF PREVIOUS MONTH-8     (YMD)          
SOFTSPM10 EQU  32                  START OF PREVIOUS MONTH-9     (YMD)          
SOFTSPM11 EQU  33                  START OF PREVIOUS MONTH-10    (YMD)          
SOFTSPM12 EQU  34                  START OF PREVIOUS MONTH-11    (YMD)          
SOFTSPB18 EQU  35                  START OF PREV B'CAST MONTH-18 (YMD)          
SOFTSPM18 EQU  36                  START OF PREVIOUS MONTH-18    (YMD)          
SOFTABL  EQU   *-SOFTABD                                                        
         EJECT                                                                  
       ++INCLUDE DDSOFDATD                                                      
         EJECT                                                                  
* ACDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE ACDDEQUS                                                       
         PRINT ON                                                               
*&&UK                                                                           
* MEMSGEQUS                                                                     
         PRINT OFF                                                              
       ++INCLUDE MEMSGEQUS                                                      
         PRINT ON                                                               
*&&                                                                             
* ACMSGEQUS                                                                     
         PRINT OFF                                                              
       ++INCLUDE ACMSGEQUS                                                      
         PRINT ON                                                               
                                                                                
* CTMSGEQUS                                                                     
         PRINT OFF                                                              
       ++INCLUDE CTMSGEQUS                                                      
         PRINT ON                                                               
                                                                                
* DDCOMFACSD                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDCOMFACSD                                                     
         PRINT ON                                                               
                                                                                
* DDPERVALD                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDPERVALD                                                      
PVALJSST DS    0XL3                SHORT JULIAN START OF PERIOD                 
PVALJLST DS    XL4                 LONG  JULIAN START OF PERIOD                 
PVALJSND DS    0XL3                SHORT JULIAN END OF PERIOD                   
PVALJLND DS    XL4                 LONG  JULIAN END OF PERIOD                   
         PRINT ON                                                               
                                                                                
* DDPERVERTD                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDPERVERTD                                                     
         PRINT ON                                                               
                                                                                
* DDFLDHDR                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDFLDHDR                                                       
         PRINT ON                                                               
                                                                                
* DDGETRETD                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDGETRETD                                                      
GETRETL  EQU   *-GETRETD                                                        
         PRINT ON                                                               
                                                                                
* DDDICTATED                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDDICTATED                                                     
         PRINT ON                                                               
                                                                                
* DDDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDDDEQUS                                                       
         PRINT ON                                                               
                                                                                
* DDLANGEQUS                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDLANGEQUS                                                     
         PRINT ON                                                               
                                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'019DDSOFDAT  06/15/20'                                      
         END                                                                    
