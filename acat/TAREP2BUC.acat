*          DATA SET TAREP2BUC  AT LEVEL 164 AS OF 03/12/15                      
*CATALP TA2BUC                                                                  
         TITLE 'TA2BUC - UC TAPES, DISKS AND 941 FORMS'                         
TA2BUC   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 0,TA2BUC,R7,R6,R5                                                
         L     RC,0(R1)            P1=A(GEND)                                   
         USING GEND,RC                                                          
         L     RA,4(R1)            P2=A(MYD)                                    
         USING MYD,RA                                                           
         L     R9,ASUBSYSD                                                      
         USING SUBSYSD,R9                                                       
         L     R8,ASPOOLD                                                       
         USING SPOOLD,R8                                                        
         CLI   0(R1),1             P1, BYTE 1 1=UC A(REC IN ASORTREC)           
         BE    UCPOST                                                           
         DC    H'0'                                                             
*                                                                               
UCPOST   DS    0H                                                               
         MVI   NEGFLAG,C'N'                                                     
*                                                                               
         LH    R1,=Y(NEGTAB-TA2BUC)                                             
         LA    R1,TA2BUC(R1)       R1=A(NEGTABLE)                               
         ST    R1,ANEGTAB                                                       
*                                                                               
         MVI   SKIPNEG,0                                                        
         BRAS  RE,DOTAPE           DECIDE IF REPORT OR TAPE/DISK                
         BNE   PRREPT              941 REPORT                                   
         MVI   SKIPNEG,C'Y'        SKIP ADDNEG ROUTINE IN MAIN ROUTINE          
         B     PRTAPE              TAPE/DISK                                    
         SPACE 2                                                                
UCDISK   EQU   72                  UC DISK                                      
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PROCESS 941                                                 
*                                                                               
PRREPTL  NTR1                      ENTRY FROM TAPE ROUTINES                     
*                                                                               
PRREPT   DS    0H                                                               
*                                                                               
         L     R3,ASORTREC                                                      
         USING UCRD,R3                                                          
         BAS   RE,SETINFO          PRESET SOME USEFUL INFORMATION               
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF THIS IS A HEADER RECORD                   
         BNE   PRR10                                                            
         CLI   FIRSTIME,C'Y'                                                    
         BE    *+12                                                             
         CLI   UCRFTYPE,UCRFTYR                                                 
         BE    PRR05                                                            
         BAS   RE,SETPAGE                                                       
         BAS   RE,PRINTIT                                                       
         MVI   FIRSTIME,C'N'                                                    
         BRAS  RE,NEWPRTQ          CLOSE & OPEN PRINT QUEUE FOR NEW             
*                                        TYPE OF REPORT                         
PRR05    BAS   RE,INIT             INITIALIZE                                   
         BAS   RE,PROCHED          PROCESS HEADER INFORMATION                   
         CLI   UCRFTYPE,UCRFTYS    THIS IS A SPECIAL FORM                       
         BE    PRR50                                                            
         BAS   RE,PRHEAD                                                        
         B     PRRX                                                             
*                                                                               
PRR10    CLI   UCRTYPE,UCRTDET     IF THIS IS A DETAIL RECORD                   
         BNE   PRR30                                                            
         CLI   UCRFTYPE,UCRFTYS                                                 
         BE    PRR50                                                            
         CLC   COUNTER,FULLPAGE                                                 
         BL    PRR20                                                            
         BAS   RE,BOTSUM                                                        
         BAS   RE,PRHEAD           PROCESS HEADER INFORMATION                   
*                                                                               
PRR20    DS    0H                                                               
         CLI   UCRSIGN,C'N'                                                     
         BNE   PRR22                                                            
         CLI   SKIPNEG,C'Y'        SKIP ADDNEG, DO LATER FOR DISK/TAPE          
         BE    PRRX                                                             
         BRAS  RE,ADDNEG           PUT INFO IN TABLE TO PRINT LATER             
         B     PRRX                                                             
*                                                                               
PRR22    ZIC   R1,COUNTER          INCREMENT COUNTER                            
         LA    R1,1(R1)                                                         
         STC   R1,COUNTER                                                       
         LA    R2,P                PUT INFO TO PRINT LINE                       
         USING LINED,R2                                                         
         MVC   LSSN1,UCRSSN        SS NUMBER (FIRST 3 DIGITS)                   
         MVC   LSSN2,UCRSSN+3                 SECOND 2 DIGITS                   
         MVC   LSSN3,UCRSSN+5                 LAST 4 DIGITS                     
         MVC   LFNAME,UCRFRST      FIRST NAME                                   
         LA    R1,LLNAME                                                        
         BAS   RE,SHUFFLE          SHUFFLE BACK TO NON BLANK                    
         MVC   0(16,R1),UCRLAST    LAST NAME                                    
         LA    R1,UCRGROSQ                                                      
         LA    RF,LWAGES                                                        
         BAS   RE,EDIT11                                                        
*                                                                               
         CLI   SSSUI,C'Y'          OPTION TO PRINT SUI WAGES                    
         BNE   PRR25                                                            
         LA    R1,UCRSUIWQ                                                      
         LA    RF,LSUI                                                          
         BAS   RE,EDIT11                                                        
*                                                                               
         CLC   UCRSTATE(2),=C'OK'  SKIP SDI IF OKLAHOMA                         
         BE    PRR25                                                            
         CLC   UCRSTATE(2),=C'IA'  OR IOWA                                      
         BE    PRR25                                                            
         LA    R1,UCRSDIWQ         IF MASS THIS IS E.H.T                        
         LA    RF,LSDI                                                          
         BAS   RE,EDIT11                                                        
*                                                                               
PRR25    CLI   EXCESS,C'Y'         OPTION TO PRINT EXCESS WAGES                 
         BNE   PRR26                                                            
         ZAP   DUB,UCRGROSQ                                                     
         SP    DUB,UCRSUIWQ                                                     
         LA    R1,DUB              NON-TAXABLE SUI WAGES                        
         LA    RF,LSUI                                                          
         BAS   RE,EDIT11                                                        
*                                                                               
PRR26    CLC   UCRSTATE(2),=C'CO'  SKIP IF COLORADO                             
         BE    PRR27                                                            
         EDIT  (B1,UCRWEEK),(2,LWKS),ZERO=NOBLANK  WEEKS WORKED                 
*                                                                               
PRR27    DS    0H                                                               
*                                                                               
         CLI   OMNTHS,C'Y'                                                      
         BNE   PRR29                                                            
         MVC   P+80(3),UCRMTH1                                                  
         OC    P+80(3),=C'000'                                                  
*                                                                               
PRR29    BAS   RE,PRINTIT                                                       
         BRAS  RE,PRTOT            KEEP TOTALS                                  
*                                                                               
PRR30    CLI   UCRTYPE,UCRTRAIL    IF THIS IS A TRAILER RECORD                  
         BNE   PRRX                                                             
         CLI   UCRFTYPE,UCRFTYS                                                 
         BE    PRR50                                                            
         BAS   RE,BOTSUM                                                        
         BAS   RE,SETTOT                                                        
         BAS   RE,UNTPRT                                                        
         BAS   RE,PROCNEG          PRINT OUT PERFS WITH NEG EARNINGS            
         B     PRRX                                                             
*                                                                               
PRR50    BAS   RE,DOFORM           PROCCESS SPECIAL FORMS                       
*                                                                               
PRRX     B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO FIND ROUTINE THAT PROCESSES SPECIAL FORM                    
*                                                                               
DOFORM   NTR1                                                                   
         MVI   MAXLINES,68                                                      
         USING FORMD,R4                                                         
         LA    R4,FORMTAB          TABLE OF STATES THAT PROCESS FORMS           
         USING UCRD,R3                                                          
         L     R3,ASORTREC                                                      
*                                                                               
DF10     CLI   0(R4),X'FF'         IF WE REACHED END OF TABLE                   
         BE    NO                  THIS IS NOT A SPECIAL FORM                   
         CLC   FORMEMP,UCREMP      IS THIS EMP                                  
         BNE   DF20                                                             
         CLC   FORMST,UCRSTATE     /STATE A SPECIAL FORM                        
         BE    DF30                                                             
*                                                                               
DF20     LA    R4,L'FORMTAB(R4)    BUMP TO NEXT ENTRY IN TABLE                  
         B     DF10                                                             
*                                                                               
DF30     ICM   RF,7,FORMRTN        DISP TO ROUTINE TO PROCESS TAPE              
         AR    RF,RB               A(ROUTINE)                                   
         BASR  RE,RF                                                            
         B     XIT                                                              
         EJECT                                                                  
*        PRINT BOTTOM SUM                                                       
*                                                                               
BOTSUM   NTR1                                                                   
         CLI   COUNTER,0           NO ONE WAS PRINTED ON THIS PAGE              
         BE    BS10                                                             
         ZIC   R1,COUNTER                                                       
         ZIC   R4,FULLPAGE                                                      
         SR    R4,R1               LINES LEFT TO SKIP TO BOTTOM OF PAGE         
         LA    R4,3(R4)            & SKIP 2 MORE LINES                          
         STC   R4,SPACING                                                       
         BAS   RE,PRINTIT                                                       
*                                                                               
         LA    R2,P                                                             
         USING LINED,R2                                                         
         LA    R1,PGTOT                                                         
         LA    RF,LWAGES                                                        
         BAS   RE,EDIT11                                                        
*                                                                               
         CLI   SSSUI,C'Y'          IF PRINT SUI WAGES OPTION                    
         BNE   BOTSUM2                                                          
         LA    R1,PGTOT2           PRINT SUI WAGES                              
         LA    RF,LSUI                                                          
         BAS   RE,EDIT11                                                        
         LA    R1,PGTOT3           PRINT SDI/EHT WAGES                          
         LA    RF,LSDI                                                          
         BAS   RE,EDIT11                                                        
         B     BOTSUM5                                                          
*                                                                               
BOTSUM2  CLI   EXCESS,C'Y'         IF EXCESS OPTION                             
         BNE   BOTSUM5                                                          
         LA    R1,PGTOT2           PRINT NON-TAXABLE SUI WAGES                  
         LA    RF,LSUI                                                          
         BAS   RE,EDIT11                                                        
*                                                                               
BOTSUM5  BAS   RE,PRINTIT                                                       
         ZAP   PGTOT,=P'0'         CLEAR PAGE TOTALS                            
         ZAP   PGTOT2,=P'0'                                                     
         ZAP   PGTOT3,=P'0'                                                     
         XC    COUNTER,COUNTER                                                  
*                                                                               
BS10     BAS   RE,SETSKIP                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*              ROUTINE PRINTS TOTAL PAGE AT UNIT CHANGE                         
         SPACE 1                                                                
*                                                                               
UNTPRT   NTR1                                                                   
         BAS   RE,PRHEAD           PRINT HEADER INFORMATION                     
         MVC   P+6(19),=C'*** TOTALS FOR UUUUUUUU ***'                          
         MVC   P+21(8),TGTANAME                                                 
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT                                                       
*                                                                               
         LH    R4,=Y(LITTAB-TA2BUC)                                             
         LA    R4,TA2BUC(R4)       R4=A(LITERAL TABLE)                          
*                                                                               
         LA    R3,UNTACCS          ******                                       
         BAS   RE,OUT10                                                         
         BAS   RE,OUT20                                                         
         BAS   RE,OUT92                                                         
         BAS   RE,OUT96                                                         
         BAS   RE,OUT60                                                         
         BAS   RE,OUT80                                                         
         BAS   RE,OUT100                                                        
         BAS   RE,OUT120                                                        
         BAS   RE,OUT132           E.H.T PERIOD NON-TAXABLE                     
         BAS   RE,OUT136           E.H.T PERIOD TAXABLE                         
         BAS   RE,OUT140                                                        
         BAS   RE,OUT160                                                        
         BAS   RE,OUT200                                                        
         BAS   RE,OUT220                                                        
         BAS   RE,OUT260           TAX WITHHELD                                 
         BAS   RE,OUT180                                                        
         MVI   SPACING,2                                                        
         BAS   RE,OUT240           YTD                                          
         BAS   RE,OUT30                                                         
         BAS   RE,OUT94                                                         
         BAS   RE,OUT98                                                         
         BAS   RE,OUT70                                                         
         BAS   RE,OUT90                                                         
         BAS   RE,OUT110                                                        
         BAS   RE,OUT130                                                        
         BAS   RE,OUT134           E.H.T YTD NON-TAXABLE                        
         BAS   RE,OUT138           E.H.T YTD TAXABLE                            
         BAS   RE,OUT150                                                        
         BAS   RE,OUT170                                                        
         BAS   RE,OUT210                                                        
         BAS   RE,OUT230                                                        
         BAS   RE,OUT270           TAX WITHHELD                                 
         BAS   RE,SETPAGE                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*              UNIT TOTAL PAGE OUTPUT ROUTINES                                  
*                                                                               
         USING ACCUMD,R3                                                        
         USING LITTABD,R4                                                       
OUT10    DS    0H                  PERIOD TOTALS                                
         MVC   P+6(L'LIT13),LIT13                                               
         BR    RE                                                               
*                                                                               
OUT20    NTR1                      EARNINGS FOR PERIOD                          
         MVC   P+6(L'LIT1),LIT1                                                 
         LA    R1,PDEARN                                                        
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT30    NTR1                      Y-T-D EARNINGS                               
         MVC   P+6(L'LIT1),LIT1                                                 
         LA    R1,YTDEARN                                                       
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT60    NTR1                      PERIOD NON-TAXABLE WAGES                     
         MVC   P+6(L'LIT2),LIT2                                                 
         LA    R1,FCAMAX                                                        
         BAS   RE,EDITF23                                                       
         LA    R1,PDFICA                                                        
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT70    NTR1                      Y-T-D NON-TAXABLE WAGES                      
         MVC   P+6(L'LIT2),LIT2                                                 
         LA    R1,FCAMAX                                                        
         BAS   RE,EDITF23                                                       
         ZAP   DUB(8),YTDEARN                                                   
         SP    DUB(8),YTDFICA                                                   
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT80    NTR1                      PERIOD TAXABLE WAGES                         
         MVC   P+6(L'LIT3),LIT3                                                 
         ZAP   DUB(8),PDEARN       TOTAL EARNINGS                               
         SP    DUB(8),PDFICA       LESS NON-TAXABLE EARNINGS                    
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT90    NTR1                      Y-T-D TAXABLE WAGES                          
         MVC   P+6(L'LIT3),LIT3                                                 
         LA    R1,YTDFICA                                                       
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT92    NTR1                      PERIOD NON-TAXABLE WAGES                     
         MVC   P+6(L'LIT2),LIT2                                                 
         LA    R1,MEDMAX                                                        
         BAS   RE,EDITF23                                                       
         LA    R1,PDMED                                                         
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT94    NTR1                      Y-T-D NON-TAXABLE WAGES                      
         MVC   P+6(L'LIT2),LIT2                                                 
         LA    R1,MEDMAX                                                        
         BAS   RE,EDITF23                                                       
         ZAP   DUB(8),YTDEARN     TOTAL EARNINGS                                
         SP    DUB(8),YTDMED      LESS NON-TAXABLE EARNINGS                     
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT96    NTR1                      PERIOD TAXABLE WAGES                         
         MVC   P+6(L'LIT3),LIT3                                                 
         ZAP   DUB(8),PDEARN       TOTAL EARNINGS                               
         SP    DUB(8),PDMED        LESS NON-TAXABLE EARNINGS                    
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT98    NTR1                      Y-T-D TAXABLE WAGES                          
         MVC   P+6(L'LIT3),LIT3                                                 
         LA    R1,YTDMED                                                        
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT100   NTR1                      PERIOD NON-TAXABLE DISABILITY WAGES          
         OC    SDIMAX,SDIMAX                                                    
         BZ    XIT                                                              
         MVC   P+6(L'LIT4),LIT4                                                 
         LA    R1,SDIMAX                                                        
         BAS   RE,EDITF30                                                       
         LA    R1,PDSDI                                                         
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT110   NTR1                      Y-T-D NON-TAXABLE DISABILITY WAGES           
         OC    SDIMAX,SDIMAX                                                    
         BZ    XIT                                                              
         MVC   P+6(L'LIT4),LIT4                                                 
         LA    R1,SDIMAX                                                        
         BAS   RE,EDITF30                                                       
         ZAP   DUB(8),YTDEARN                                                   
         SP    DUB(8),YTDSDI                                                    
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT120   NTR1                      PERIOD TAXABLE DISABILITY WAGES              
         OC    SDIMAX,SDIMAX                                                    
         BZ    XIT                                                              
         MVC   P+6(L'LIT5),LIT5                                                 
         ZAP   DUB(8),PDEARN                                                    
         SP    DUB(8),PDSDI                                                     
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT130   NTR1                      Y-T-D TAXABLE DISABILITY WAGES               
         OC    SDIMAX,SDIMAX                                                    
         BZ    XIT                                                              
         MVC   P+6(L'LIT5),LIT5                                                 
         LA    R1,YTDSDI                                                        
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT132   NTR1                      PERIOD NON-TAXABLE EMP HEALTH WAGES          
         OC    EHTMAX,EHTMAX                                                    
         BZ    XIT                                                              
         MVC   P+6(L'LIT16),LIT16                                               
         LA    R1,EHTMAX                                                        
         BAS   RE,EDITF30                                                       
         LA    R1,PDSDI                                                         
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT134   NTR1                      Y-T-D NON-TAXABLE EMP HEALTH WAGES           
         OC    EHTMAX,EHTMAX                                                    
         BZ    XIT                                                              
         LA    R1,EHTMAX                                                        
         MVC   P+6(L'LIT16),LIT16                                               
         BAS   RE,EDITF30                                                       
         ZAP   DUB(8),YTDEARN                                                   
         SP    DUB(8),YTDSDI                                                    
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT136   NTR1                      PERIOD TAXABLE EMP HEALTH WAGES              
         OC    EHTMAX,EHTMAX                                                    
         BZ    XIT                                                              
         MVC   P+6(L'LIT17),LIT17                                               
         ZAP   DUB(8),PDEARN                                                    
         SP    DUB(8),PDSDI                                                     
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT138   NTR1                      Y-T-D TAXABLE EMP HEALTH WAGES               
         OC    EHTMAX,EHTMAX                                                    
         BZ    XIT                                                              
         MVC   P+6(L'LIT17),LIT17                                               
         LA    R1,YTDSDI                                                        
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT140   NTR1                      PERIOD NON-TAXABLE SUI WAGES                 
         MVC   P+6(L'LIT6),LIT6                                                 
         LA    R1,SUIMAX                                                        
         BAS   RE,EDITF30                                                       
         LA    R1,PDSUI                                                         
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT150   NTR1                      Y-T-D NON-TAXABLE SUI WAGES                  
         MVC   P+6(L'LIT6),LIT6                                                 
         LA    R1,SUIMAX                                                        
         BAS   RE,EDITF30                                                       
         ZAP   DUB(8),YTDEARN                                                   
         SP    DUB(8),YTDSUI                                                    
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT160   NTR1                      PERIOD TAXABLE SUI WAGES                     
         MVC   P+6(L'LIT7),LIT7                                                 
         ZAP   DUB(8),PDEARN                                                    
         SP    DUB(8),PDSUI                                                     
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT170   NTR1                      Y-T-D TAXABLE SUI WAGES                      
         MVC   P+6(L'LIT7),LIT7                                                 
         LA    R1,YTDSUI                                                        
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT180   NTR1                                                                   
         MVC   P+6(L'LIT8),LIT8    N'PEOPLE                                     
         LA    R1,NPEOPLE                                                       
         BAS   RE,EDITCP56                                                      
         BAS   RE,PRINTIT          PRINT THIS LINE                              
         CP    NMONTH1,=P'0'                                                    
*        BE    OUT182                                                           
         MVC   P+6(L'LIT8A),LIT8A  N'PEOPLE IN MONTH 1                          
         LA    R1,NMONTH1                                                       
         BAS   RE,EDITCP56                                                      
         BAS   RE,PRINTIT          PRINT THIS LINE                              
OUT182   CP    NMONTH2,=P'0'                                                    
*        BE    OUT184                                                           
         MVC   P+6(L'LIT8B),LIT8B  N'PEOPLE IN MONTH 2                          
         LA    R1,NMONTH2                                                       
         BAS   RE,EDITCP56                                                      
         BAS   RE,PRINTIT          PRINT THIS LINE                              
OUT184   CP    NMONTH3,=P'0'                                                    
*        BE    XIT                                                              
         MVC   P+6(L'LIT8C),LIT8C  N'PEOPLE IN MONTH 3                          
         LA    R1,NMONTH3                                                       
         BAS   RE,EDITCP56                                                      
         B     OUTX                                                             
*                                                                               
OUT190   NTR1                                                                   
         MVC   P+6(L'LIT9A),LIT9A  N'PEOPLE OVER SUI MAX FOR PERIOD             
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT                                                       
         MVC   P+6(L'LIT9B),LIT9B                                               
         LA    R1,SUIMAX                                                        
         BAS   RE,EDITF15                                                       
         LR    R1,R0                                                            
         LA    R1,P+15+1(R1)                                                    
         MVC   0(L'LIT9C,R1),LIT9C                                              
         LA    R1,NOVERSUI                                                      
         BAS   RE,EDITCP56                                                      
         B     OUTX                                                             
*                                                                               
OUT200   NTR1                      PERIOD NON-TAXABLE FUI WAGES                 
         MVC   P+6(L'LIT10),LIT10                                               
         LA    R1,FUIMAX                                                        
         BAS   RE,EDITF33                                                       
         LA    R1,PDFUI                                                         
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT210   NTR1                      Y-T-D NON-TAXABLE FUI WAGES                  
         MVC   P+6(L'LIT10),LIT10                                               
         LA    R1,FUIMAX                                                        
         BAS   RE,EDITF33                                                       
         ZAP   DUB(8),YTDEARN                                                   
         SP    DUB(8),YTDFUI                                                    
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT220   NTR1                      PERIOD TAXABLE FUI WAGES                     
         MVC   P+6(L'LIT11),LIT11                                               
         ZAP   DUB(8),PDEARN                                                    
         SP    DUB(8),PDFUI                                                     
         LA    R1,DUB                                                           
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT230   NTR1                      Y-T-D TAXABLE FUI WAGES                      
         MVC   P+6(L'LIT11),LIT11                                               
         LA    R1,YTDFUI                                                        
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT240   NTR1                      Y-T-D TOTALS                                 
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT                                                       
         MVC   P+6(L'LIT14),LIT14                                               
         B     OUTX                                                             
         EJECT                                                                  
*                                                                               
OUT260   NTR1                      PERIOD TAX WITHHELD                          
         MVC   P+6(L'LIT15),LIT15                                               
         LA    R1,PDTAX                                                         
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUT270   NTR1                      Y-T-D TAX WITHHELD                           
         MVC   P+6(L'LIT15),LIT15                                               
         LA    R1,YTDTAX                                                        
         BAS   RE,EDITACC                                                       
         B     OUTX                                                             
*                                                                               
OUTX     BAS   RE,PRINTIT          PRINT THIS LINE                              
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
EDIT11   DS    0H                                                               
         EDIT  (P8,0(R1)),(11,(RF)),2,FLOAT=-                                   
         BR    RE                                                               
*                                                                               
EDITACC  DS    0H                  WAGE TOTALS                                  
         EDIT  (P8,0(R1)),(17,P+50),2,COMMAS=YES,CR=YES                         
         BR    RE                                                               
*                                                                               
EDITF15  DS    0H                  WAGE BASES                                   
         LA    R2,P+15                                                          
         B     FULLEDIT                                                         
*                                                                               
EDITF23  DS    0H                                                               
         LA    R2,P+23                                                          
         B     FULLEDIT                                                         
*                                                                               
EDITF30  DS    0H                                                               
         LA    R2,P+30                                                          
         B     FULLEDIT                                                         
*                                                                               
EDITF33  DS    0H                                                               
         LA    R2,P+33                                                          
*                                                                               
FULLEDIT EDIT  (4,0(R1)),(14,0(R2)),2,COMMAS=YES,ALIGN=LEFT,FLOAT=-             
         BR    RE                                                               
*                                                                               
         SPACE 1                                                                
EDITCP56 DS    0H                  COUNTS                                       
         LA    R2,P+57                                                          
         B     CNTEDIT                                                          
*                                                                               
EDITCNT  DS    0H                                                               
         LA    R2,P+21                                                          
*                                                                               
CNTEDIT  EDIT  (P3,0(R1)),(8,0(R2)),COMMAS=YES                                  
         BR    RE                                                               
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DO INITIALIZE                                               
*                                                                               
INIT     NTR1                                                                   
         BAS   RE,SETPAGE                                                       
*                                                                               
         LA    R2,LIMAREA                                                       
         USING TMD,R2                                                           
         MVI   MAXLINES,62                                                      
         MVI   FULLPAGE,PAGELNQ                                                 
         ZAP   NPEOPLE,=P'0'                                                    
         ZAP   NMONTH1,=P'0'                                                    
         ZAP   NMONTH2,=P'0'                                                    
         ZAP   NMONTH3,=P'0'                                                    
         ZAP   NOVERSUI,=P'0'                                                   
*                                                                               
         LA    R1,NLEVELS          N'LEVELS                                     
         LA    R3,ACCUMS           LEVEL OF ACCUMULATORS                        
         BAS   RE,CLRACCS                                                       
         BCT   R1,*-4                                                           
*                                                                               
         XC    NHRSWORK,NHRSWORK   CLEAR NUMBER OF HOURS WORKED                 
         ZAP   REPTOT,=P'0'        CLEAR PAGE AND REPORT TOTALS                 
         ZAP   PGTOT,=P'0'                                                      
         ZAP   PGTOT2,=P'0'                                                     
         ZAP   PGTOT3,=P'0'                                                     
*                                                                               
         XC    SUIMAX,SUIMAX                                                    
         XC    SDIMAX,SDIMAX                                                    
*                                                                               
         BRAS  RE,SETLIM           SET INTERFACE FOR TALIM                      
         GOTO1 =V(TALIM),DMCB,LIMAREA                                           
         BNE   INX                                                              
         MVC   SUIMAX,TMBSUI       SET RETURNED AMOUNT                          
         MVC   SDIMAX,TMBSDI                                                    
         MVC   SUIRATE,TMRSUI                                                   
*                                                                               
INX      B     XIT                                                              
         EJECT                                                                  
*                                                                               
*              ROUTINE CLEARS A LEVEL OF ACCUMULATORS                           
*                                  R3=A(ACCUMS)                                 
CLRACCS  DS    0H                                                               
         LA    R0,NACCS                                                         
*                                                                               
CLA10    ZAP   0(L'ACCS,R3),=P'0'                                               
         LA    R3,L'ACCS(R3)                                                    
         BCT   R0,CLA10                                                         
         BR    RE                                                               
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PROCESS HEADER RECORD                                       
*                                                                               
PROCHED  NTR1                                                                   
         LH    RF,=AL2(NEGTLNQ)                                                 
         L     R1,ANEGTAB                                                       
         XCEFL 0(R1)                                                            
*                                                                               
         L     R3,ASORTREC                                                      
         USING UCRD,R3                                                          
         GOTO1 TAXVAL,DMCB,(3,UCRSTATE)    UPDATE TGTANUM=STATE CODE            
         MVI   HEADNAME,44         LENGTH OF FIELD & HEADER                     
         MVC   FDID,SPACES         FEDERAL EMPLOYER ID                          
         MVC   TGEMP,UCREMP                                                     
         CLC   RYEAR,=C'2004'                                                   
         BNL   PCH05                                                            
         CLC   TGEMP,=C'TP '                                                    
         BNE   PCH05                                                            
         MVC   TGEMP,=C'TP1'                                                    
*                                                                               
PCH05    GOTO1 RECVAL,DMCB,TLEMCDQ,(X'A8',0),HEADNAME                           
         CLC   RYEAR,=C'2004'                                                   
         BNL   PCH05B                                                           
         CLC   TGEMP,=C'TP1'                                                    
         BNE   PCH05X                                                           
         MVC   TGEMP,=C'TP '                                                    
         B     PCH05X                                                           
*                                                                               
PCH05B   CLC   TGEMP,=C'TP '                                                    
         BNE   PCH05X                                                           
         MVI   HEADNAME+5,35                                                    
         MVC   HEADNAME+8(35),=C'TALENT PARTNERS COMMERCIAL SERVICES'           
*                                                                               
PCH05X   OC    NAMEFLD,SPACES      PAD NAME WITH SPACES                         
         USING TATID,R4                                                         
         MVI   ELCODE,TATIELQ                                                   
         MVI   WORK,TATITYUN       ELEMENT TYPE                                 
         MVC   WORK+1(3),=C'FD '                                                
         GOTO1 GETL,DMCB,(4,WORK)                                               
         BNE   PCH10                                                            
         MVI   BYTE,C'R'           RIGHT PAD WITH ZEROES                        
*        BAS   RE,SETID            TAKE OUT ALL BLANKS AND DASHES               
         GOTOR SETID,DMCB,(L'FDID,FDID)                                         
*                                                                               
PCH10    DS    0H                                                               
         MVC   PRINTID,SPACES                                                   
         MVC   WORK+1(3),UCRSTATE                                               
         GOTO1 GETL,DMCB,(4,WORK)                                               
         BNE   PCH20                                                            
         L     R4,TGELEM                                                        
         MVC   PRINTID,TATIID      PRINT ID                                     
         LA    R1,SVID                                                          
         MVC   SVID,LTZERO         SET WITH ZEROES                              
         BAS   RE,BLNKPAD          OR SPACES                                    
         BNE    *+10                                                            
         MVC   SVID,SPACES                                                      
         MVI   BYTE,C'R'           RIGHT PAD WITH ZEROES                        
         BAS   RE,LEFTPAD                                                       
         BNE    *+8                                                             
         MVI   BYTE,C'L'           LEFT PAD WITH ZEROES                         
*        BAS   RE,SETID            TAKE OUT ALL BLANKS AND DASHES               
         GOTOR SETID,DMCB,(L'SVID,SVID)                                         
         BRAS  RE,SET15ID          15 CHARACTER FIELD ID FIELDS                 
*                                                                               
PCH20    L     R4,AIO                                                           
         USING TAADD,R4                                                         
         MVI   ELCODE,TAADELQ                                                   
         BAS   RE,GETEL                                                         
         BNE   PCHX                                                             
         ZIC   R1,TAADLNES         N'ADDRESS LINES                              
         MH    R1,=H'30'                                                        
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   ADDRESS(0),TAADADD                                               
*                                                                               
         BRAS  RE,GETADD                                                        
         MVC   EMPADDR,BLOCK      STREET ADDRESS                                
         MVC   EMPCITY,BLOCK+90   CITY                                          
         MVC   EMPSTATE,DUB       STATE                                         
         MVC   EMPZIP,WORK                                                      
*                                                                               
PCHX     B     XIT                                                              
         EJECT                                                                  
*        LIST OF STATE ID'S THAT ARE ZERO PADDED ON LEFT                        
*                                                                               
         USING UCRD,R3                                                          
LEFTPAD  NTR1                                                                   
         USING LEFTD,R1                                                         
         LA    R1,LEFTTAB          TABLE OF EMP/STATES WHOSE ID ARE             
*                                  PADDED ON THE LEFT WITH ZEROES               
LP10     CLI   0(R1),X'FF'                                                      
         BE    NO                  END OF TABLE                                 
         CLC   LEFTEMP,UCREMP                                                   
         BNE   LP20                SAME EMPLOYER                                
         CLC   LEFTST,UCRSTATE                                                  
         BE    YES                 & STATE - EXIT                               
*                                                                               
LP20     LA    R1,LEFTLNQ(R1)      BUMP TABLE                                   
         B     LP10                                                             
         SPACE 2                                                                
*                                                                               
*        LIST OF STATE ID'S THAT ARE SPACES PADDED                              
*                                                                               
         USING UCRD,R3                                                          
BLNKPAD  NTR1                                                                   
         USING BLNKD,R1                                                         
         LA    R1,BLNKTAB          TABLE OF EMP/STATES WHOSE ID ARE             
*                                  SPACE PADDED                                 
BP10     CLI   0(R1),X'FF'                                                      
         BE    NO                  END OF TABLE                                 
         CLC   BLNKEMP,UCREMP                                                   
         BNE   BP20                SAME EMPLOYER                                
         CLC   BLNKST,UCRSTATE                                                  
         BE    YES                 & STATE - EXIT                               
*                                                                               
BP20     LA    R1,BLNKLNQ(R1)      BUMP TABLE                                   
         B     BP10                                                             
         EJECT                                                                  
*                                                                               
*        PRINT HEADLINES                                                        
*                                                                               
PRHEAD   NTR1                                                                   
         LA    R2,P                                                             
         USING LHEAD,R2                                                         
         MVC   LLINE(L'NAMEFLD),NAMEFLD                                         
         GOTO1 DATCON,DMCB,(1,THISEND),(5,LDATE)                                
         EDIT  (B2,PAGE),(3,LPAGE)                                              
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   LLINE(L'NAMEFLD),NAMEFLD                                         
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   LLINE(L'ADDR1),ADDR1                                             
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   LLINE(L'ADDR2),ADDR2                                             
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   LLINE(L'ADDR3),ADDR3                                             
         GOTO1 TAXVAL,DMCB,(3,UCRSTATE)                                         
         BNE   PH15                                                             
         MVC   LUNIT,LTUNIT                                                     
         MVC   LPAGE(L'TGTANAME),TGTANAME                                       
*                                                                               
PH15     BAS   RE,PRINTIT                                                       
         CLI   NEGFLAG,C'Y'                                                     
         BNE   PH25                                                             
         MVC   LLINE(9),=C'NEGATIVES'                                           
         B     PH30                                                             
*                                                                               
PH25     CLC   PRINTID,SPACES                                                   
         BNH   PH30                                                             
         MVC   LLINE(L'LTACNO),LTACNO                                           
         MVC   LLINE+9(L'PRINTID),PRINTID                                       
*                                                                               
PH30     BAS   RE,PRINTIT                                                       
         MVC   LLINE(L'LTFEIN),LTFEIN                                           
         MVC   LLINE+9(L'FDID),FDID              EMPLOYER ID                    
         BAS   RE,PRINTIT                                                       
         MVI   SPACING,4                                                        
         BAS   RE,PRINTIT                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        COMPARE AMOUNTS TO ENSURE NOT NEGATIVE                                 
*                                                                               
NEGAMTS  NTR1                                                                   
         CP    UCRSUIWQ,=P'0'                                                   
         BL    YES                                                              
         B     NO                                                               
         SPACE 2                                                                
*                                                                               
*        PRINT OUT PERFORMERS WITH NEGATIVE AMOUNTS                             
*                                                                               
PROCNEG  NTR1                                                                   
         L     R4,ANEGTAB                                                       
         USING NEGTABD,R4                                                       
         OC    0(NEGLNQ,R4),0(R4) ANYTHING TO PRINT                             
         BZ    PNX                                                              
         MVI   NEGFLAG,C'Y'                                                     
         BAS   RE,SETPAGE                                                       
         MVI   MAXLINES,62                                                      
         MVI   FULLPAGE,PAGELNQ                                                 
         BAS   RE,PRHEAD                                                        
         LA    R2,P                PUT INFO TO PRINT LINE                       
*                                                                               
PN10     OC    0(NEGLNQ,R4),0(R4) ANYTHING TO PRINT                             
         BZ    PNX                                                              
         MVC   0(NEGLNQ1,R2),0(R4)                                              
         BAS   RE,PRINTIT                                                       
         LA    R4,NEGLNQ(R4)       BUMP TABLE                                   
         B     PN10                                                             
*                                                                               
PNX      MVI   NEGFLAG,C'N'                                                     
         BAS   RE,SETPAGE                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DO SET TOTAL AMOUNTS FROM TRAILER RECORD                    
*                                                                               
SETTOT   NTR1                                                                   
         L     R3,ASORTREC                                                      
         USING UCRD,R3                                                          
         LA    R4,UNTACCS                                                       
         USING ACCUMD,R4                                                        
         ZAP   YTDEARN,UCRGROSY    YTD TOTAL EARNINGS                           
         ZAP   YTDFUI,UCRFUIWY                                                  
         ZAP   YTDSUI,UCRSUIWY                                                  
         ZAP   YTDSDI,UCRSDIWY     IF MASS THIS IS E.H.T                        
         ZAP   YTDFICA,UCRFICWY                                                 
         ZAP   YTDMED,UCRMEDWY                                                  
         ZAP   YTDTAX,UCRTAXY                                                   
*&&DO                                                                           
         ZAP   NMONTH1,UCRNMTH1                                                 
         ZAP   NMONTH2,UCRNMTH2                                                 
         ZAP   NMONTH3,UCRNMTH3                                                 
*&&                                                                             
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PROCESS A TAPE                                              
*                                                                               
PRTAPE   DS    0H                                                               
         L     R3,ASORTREC                                                      
         USING UCRD,R3                                                          
         BAS   RE,PRREPTL          PRINT LINE INFORMATION                       
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF THIS IS A HEADER RECORD                   
         BNE   PRT10                                                            
*                                                                               
         MVC   SVDCB(UCLNQ),UCTAPE SAVE DCB BEFORE CHANGING                     
         LA    R2,UCTAPE           R2=A(DCB) FOR UCTAPE OR UCDISK               
*                                                                               
         CLI   ACTEQU,ACTDOWN      ARE WE DOWNLOADING?                          
         BNE   *+14                NO                                           
         MVC   SVDCB(TALNQ),TADOWN YES, USE TEMPORARY DATASET                   
         LA    R2,TADOWN                                                        
*                                                                               
         BAS   RE,CHGDCB           CHANGE THE RECL & BLKSZ ON DCB               
         CLI   WRITAPE,C'N'        IF WRITING TO TAPE                           
         BE    PRT10                                                            
*                                                                               
         CLI   RECNUM,UCDISK       IF UCDISK REPORT                             
         BE    PRT5                JCL SPECIFIES THE DSN STATEMENT              
*                                  ELSE SET IT AND GENERATE STATEMENT           
         MVC   WORK(20),=CL20'TALTAPE.TA0U   1'                                 
         MVC   WORK+12(1),UCREMP   SET 1ST LETTER OF EMPLOYER                   
         MVC   WORK+13(2),UCRSTATE     AND SET STATE                            
         GOTO1 DYNALLOC,DMCB,(0,=CL8'UCTAPE'),(0,WORK)                          
*                                                                               
PRT5     OPEN  ((2),OUTPUT)        OPEN IT                                      
*                                                                               
PRT10    SR    RF,RF                                                            
         ICM   RF,7,DSPRTN         DISP TO ROUTINE TO PROCESS TAPE              
         AR    RF,RB               A(ROUTINE)                                   
         BASR  RE,RF                                                            
*                                                                               
PRT20    CLI   UCRTYPE,UCRTRAIL    IF THIS IS A TRAILER RECORD                  
         BNE   PRTX                                                             
         CLI   WRITAPE,C'N'        IF OK TO WRITE TAPE                          
         BE    PRT30                                                            
         CLI   ACTEQU,ACTDOWN      ARE WE DOWNLOADING?                          
         BNE   PRT25                                                            
         BRAS  RE,PRTDOWN          YES, PRINT DOWNLOAD REPORT                   
         B     PRTX                                                             
*                                                                               
PRT25    LA    R2,UCTAPE           R2=A(DCB) FOR UCTAPE OR UCDISK               
         CLOSE ((2))               CLOSE IT                                     
*                                                                               
PRT30    MVC   UCTAPE(UCLNQ),SVDCB RESTORE DCB                                  
         B     PRTX                                                             
*                                                                               
*                                                                               
PRTX     B     XIT                                                              
         EJECT                                                                  
*                                                                               
*&&DO                                                                           
         USING DLCBD,R3                                                         
NOMORE   CLOSE ((2))               CLOSE THE DATASET                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
         CLI   ACTNUM,ACTDOWN                                                   
         BE    NOMORE2                                                          
         L     R1,ALOGO            NO-OP SO DON'T END AGAIN                     
         MVC   0(2,R1),=X'07FE'                                                 
         B     XIT                                                              
NOMORE2  MVI   DLCBACT,DLCBEOR                                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         B     XIT                                                              
         DROP  R3                                                               
*&&                                                                             
         EJECT                                                                  
*                                                                               
*------------------------------------*                                          
*                                                                               
*        ROUTINE TO SOME USEFUL INFO USED ON TAPES                              
*                                                                               
         USING UCRD,R3                                                          
SETINFO  NTR1                                                                   
         LA    R2,RPTMMYR          SET REPORTING MMYY                           
         BRAS  RE,SETMTH                                                        
         MVC   RPTMMYR+2(2),UCRRYR                                              
*                                                                               
         MVC   RPTMMYR4(2),RPTMMYR SET REPORTING MMCCYY                         
         MVC   RPTMMYR4+2(4),RYEAR                                              
*                                                                               
         MVC   W4FRST,SPACES                                                    
         LA    R1,W4FRST           SET FIRST NAME (CHARACTER ONLY)              
         LA    R2,UCRFRST                                                       
         LA    R0,L'UCRFRST                                                     
         MVI   BYTE,0                                                           
         BAS   RE,SETNAME                                                       
*                                                                               
         MVC   W4LAST,SPACES                                                    
         LA    R1,W4LAST           SET LAST NAME (CHARACTER ONLY)               
         LA    R2,UCRLAST                                                       
         LA    R0,L'UCRLAST                                                     
         MVI   BYTE,0                                                           
         BAS   RE,SETNAME                                                       
*                                                                               
         MVC   W4MID,UCRMID                                                     
*                                                                               
         MVC   W4LASTNB,SPACES                                                  
         LA    R1,W4LASTNB         SET LAST NAME (CHAR ONLY/NO BLANKS)          
         LA    R2,UCRLAST                                                       
         LA    R0,L'UCRLAST                                                     
         MVI   BYTE,C'B'                                                        
         BAS   RE,SETNAME                                                       
         B     XIT                                                              
         EJECT                                                                  
         SPACE 2                                                                
*              ROUTINE TO WEED OUT ASTERISKS FROM NAME                          
*                                  R0=L'INPUT,R2=A(INPUT),R1=A(OUTPUT)          
*                                  BYTE=B - SKIP BLANKS                         
         SPACE 1                                                                
SETNAME  DS    0H                                                               
*                                                                               
SETNAME5 CLI   0(R2),C'*'          SKIP ASTERISKS (CHANGED 10/24 -CHK           
         BE    SETNAME8                            WAS C'A'/BL )                
         CLI   BYTE,C'B'           IF SKIPPING BLANKS TOO                       
         BNE   *+12                                                             
         CLI   0(R2),C' '          CHECK CHARACTER IS A BLANK                   
         BE    SETNAME9                                                         
         MVC   0(1,R1),0(R2)                                                    
*                                                                               
SETNAME8 LA    R1,1(R1)                                                         
SETNAME9 LA    R2,1(R2)                                                         
         BCT   R0,SETNAME5                                                      
         BR    RE                                                               
         EJECT                                                                  
*                                                                               
*        ROUTINE TO CALCULATE NUMBER OF PAGES IN THE REPORT                     
*              R1 - N'PEOPLE PER PAGE                                           
*                                                                               
         USING UCRD,R3                                                          
PAGES    NTR1                                                                   
         L     R3,ASORTREC                                                      
         XR    R2,R2                                                            
         ZAP   DUB,UCRNSSN                                                      
         DROP  R3                                                               
         CVB   R3,DUB                                                           
         DR    R2,R1                                                            
         LTR   R2,R2                                                            
         BZ    PG10                                                             
         LA    R3,1(R3)                                                         
*                                                                               
PG10     ST    R3,NUMPG                                                         
PGX      B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DO TP/HI SPECIAL FORMS REPORT                               
*                                                                               
         USING UCRD,R3                                                          
         USING HILINED,R2                                                       
PRTPHI   NTR1                                                                   
         LA    R2,P                PUT INFO TO PRINT LINE                       
         L     R3,ASORTREC                                                      
         CLI   UCRTYPE,UCRTHEAD    HEADER RECORD                                
         BNE   TPHI10                                                           
         LA    R1,HISSPP           N'SSN'S PER PAGE                             
         BAS   RE,PAGES            CALC HOW MANY PGS WILL BE PRINTED            
         BAS   RE,TPHIHEAD                                                      
         B     TPHIX                                                            
*                                  THIS IS AN INDIVIDUAL'S RECORD               
TPHI10   CLI   UCRTYPE,UCRTDET     DETAIL RECORD                                
         BNE   TPHITRL                                                          
         CLI   UCRSIGN,C'N'        IS THIS A NEGATIVE SUI                       
         BNE   TPHI15                                                           
         BRAS  RE,ADDNEG           PUT INFO IN TABLE TO PRINT LATER             
         B     TPHIX               & SKIP THIS RECORD                           
*                                                                               
TPHI15   CLI   COUNTER,HISSPP      IF REACHED END OF PAGE                       
         BL    TPHI20                                                           
         EDIT  (P8,PGTOT),(12,HILSSWGP),2   PAGE TOTALS                         
         BAS   RE,PRINTIT                                                       
         BAS   RE,SETSKIP          SKIP TO NEXT PAGE                            
         BAS   RE,PRINTIT                                                       
         XC    COUNTER,COUNTER                                                  
         ZAP   PGTOT,=P'0'                                                      
         BAS   RE,TPHIHEAD         & PRINT HEADINGS AGAIN                       
*                                                                               
TPHI20   MVC   HILSSN,UCRSSN       SS NUMBER                                    
         MVC   HILFIRST,W4FRST     FIRST INITIAL                                
         MVC   HILLAST(L'W4LAST),W4LAST      LAST NAME                          
         EDIT  (P8,UCRGROSQ),(10,HILSSWG),2   GROSS EARNINGS FOR QTR            
         BAS   RE,PRINTIT                                                       
         ZIC   R1,COUNTER         N'LINES PRINTED                               
         LA    R1,1(R1)                                                         
         STC   R1,COUNTER                                                       
*                                                                               
         CLI   OMNTHS,C'Y'                                                      
         BNE   TPHI30                                                           
         MVC   P+80(3),UCRMTH1                                                  
         OC    P+80(3),=C'000'                                                  
*                                                                               
TPHI30   BAS   RE,PRINTIT                                                       
         BRAS  RE,PRTOT            KEEP TOTALS                                  
         B     TPHIX                                                            
*                                                                               
TPHITRL  CLI   UCRTYPE,UCRTRAIL    TRAILER RECORD                               
         BNE   TPHIX                                                            
         CLI   COUNTER,HISSPP      IF DIDN'T REACH END OF PAGE                  
         BNL   TPHI40                                                           
         ZIC   R3,COUNTER                                                       
         LA    R1,HISSPP                                                        
         SR    R1,R3                                                            
         MH    R1,=H'2'                                                         
         STC   R1,SPACING                                                       
         BAS   RE,PRINTIT          N'LINES LEFT TO SKIP                         
*                                                                               
TPHI40   EDIT  (P8,PGTOT),(12,HILSSWGP),2   PAGE TOTALS                         
         BAS   RE,PRINTIT                                                       
         BAS   RE,SETSKIP          SKIP TO NEXT PAGE                            
         BAS   RE,PROCNEG          PRINT OUT PERFORMERS WITH NEG SUI            
*                                                                               
TPHIX    B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PRINT HEADER                                                
*                                                                               
TPHIHEAD NTR1                                                                   
         MVI   SPACING,10                                                       
         BAS   RE,PRINTIT                                                       
         MVC   HILEMPN(L'NAMEFLD),NAMEFLD      EMPLOYER NAME                    
         MVC   HILFMID,FDID        FEDERAL ID                                   
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   HILADDR(L'EMPADDR),EMPADDR    ADDRESS                            
         MVC   HILEMID,PRINTID     EMPLOYER ID                                  
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   HILADDR(L'EMPCITY),EMPCITY    CITY, STATE ZIP                    
         MVI   HILADDR+L'EMPCITY,C','                                           
         MVC   HILADDR+L'EMPCITY+1(L'EMPSTATE),EMPSTATE                         
         MVC   HILADDR+L'EMPCITY+L'EMPSTATE+2(L'EMPZIP),EMPZIP                  
         BAS   RE,PRINTIT                                                       
*                                                                               
         LA    R1,HILQEDTE         QUARTER END DATE                             
         BAS   RE,SETEDTE                                                       
         MVC   6(2,R1),UCRRYR                                                   
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT          SKIP TO FIRST LINE                           
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DO TP/UT SPECIAL FORMS REPORT                               
*                                                                               
         USING UCRD,R3                                                          
         USING UTLINED,R2                                                       
PRTPUT   NTR1                                                                   
         LA    R2,P                PUT INFO TO PRINT LINE                       
         L     R3,ASORTREC                                                      
         CLI   UCRTYPE,UCRTHEAD    HEADER RECORD                                
         BNE   TPUT10                                                           
         BAS   RE,SETSKIP          SKIP TO NEXT PAGE                            
         BAS   RE,PRINTIT                                                       
         LA    R1,UTSSPP           N'PEOPLE PER PAGE                            
         BAS   RE,PAGES            CALC HOW MANY PGS WILL BE PRINTED            
         XC    THPAGE,THPAGE                                                    
         MVC   REPTOT,UCRGROSQ     SAVE TOTAL OF ENTIRE REPORT                  
         BAS   RE,TPUTHEAD                                                      
         B     TPUTX                                                            
*                                  THIS IS AN INDIVIDUAL'S                      
TPUT10   CLI   UCRTYPE,UCRTDET     DETAIL RECORD                                
         BNE   TPUTTRL                                                          
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BE    TPUTX                                                            
**NO-OP  BNE   TPUT15                                                           
**JUN06  BRAS  RE,ADDNEG           PUT INFO IN TABLE TO PRINT LATER             
**NO-OP  B     TPUTX                                                            
*                                                                               
TPUT15   CLI   COUNTER,UTSSPP      IF REACHED END OF PAGE                       
         BL    TPUT20                                                           
         LH    R1,THPAGE                  INCREMENT PAGE NUMBER                 
         LA    R1,1(R1)                                                         
         STH   R1,THPAGE                                                        
         EDIT  (P8,PGTOT),(12,UTLSSWG),2  PRINT PAGE TOTALS                     
         BAS   RE,PRINTIT                                                       
         EDIT  THPAGE,(6,UTLPAGES)              PAGE NUMBER                     
         BAS   RE,PRINTIT                                                       
         XC    COUNTER,COUNTER            CLEAR PAGE ACCUMULATORS               
         ZAP   PGTOT,=P'0'                                                      
         BAS   RE,SETSKIP                 SKIP TO NEXT PAGE                     
         BAS   RE,PRINTIT                                                       
         BAS   RE,TPUTHEAD                & PRINT HEADINGS AGAIN                
*                                                                               
TPUT20   MVC   UTLSSN1,UCRSSN       SS NUMBER                                   
         MVC   UTLSSN2,UCRSSN+3                                                 
         MVC   UTLSSN3,UCRSSN+5                                                 
*                                                                               
         MVC   UTLFIRST,W4FRST     FIRST INITIAL                                
         MVC   UTLLAST(L'W4LAST),W4LAST       LAST NAME                         
         EDIT  (P8,UCRGROSQ),(12,UTLSSWG),2   GROSS EARNINGS FOR QTR            
         MVI   SPACING,2                                                        
*                                                                               
         CLI   OMNTHS,C'Y'                                                      
         BNE   TPUT30                                                           
         MVC   P+80(3),UCRMTH1                                                  
         OC    P+80(3),=C'000'                                                  
*                                                                               
TPUT30   BAS   RE,PRINTIT                                                       
         BRAS  RE,PRTOT            KEEP TOTALS                                  
         ZIC   R1,COUNTER          N'LINES PRINTED                              
         LA    R1,1(R1)                                                         
         STC   R1,COUNTER                                                       
         B     TPUTX                                                            
*                                  THIS IS AN INDIVIDUAL'S RECORD               
TPUTTRL  CLI   UCRTYPE,UCRTRAIL    TRAILER RECORD                               
         BNE   TPUTX                                                            
         CLI   COUNTER,UTSSPP      IF DIDN'T REACH END OF PAGE                  
         BNL   TPUT40                                                           
         ZIC   R3,COUNTER                                                       
         LA    R1,UTSSPP                                                        
         SR    R1,R3                                                            
         MH    R1,=H'2'                                                         
         STC   R1,SPACING                                                       
         BAS   RE,PRINTIT          N'LINES LEFT TO SKIP                         
*                                                                               
TPUT40   EDIT  (P8,PGTOT),(12,UTLSSWG),2   PAGE TOTALS                          
         BAS   RE,PRINTIT                                                       
         LH    R1,THPAGE                   INCREMENT PAGE NUMBER                
         LA    R1,1(R1)                                                         
         STH   R1,THPAGE                                                        
         EDIT  THPAGE,(6,UTLPAGES)         PAGE NUMBER                          
         MVI   SPACING,3                                                        
         BAS   RE,PRINTIT                                                       
         BAS   RE,SETSKIP          SKIP TO NEXT PAGE                            
         BAS   RE,SETTOT                                                        
         BAS   RE,UNTPRT                                                        
         BAS   RE,SETSKIP          SKIP TO NEXT PAGE                            
         BAS   RE,PROCNEG          PRINT OUT PERFORMERS WITH NEG SUI            
*                                                                               
TPUTX    B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PRINT HEADER                                                
*                                                                               
TPUTHEAD NTR1                                                                   
         MVC   TGTANAME,SPACES                                                  
         MVC   TGTANAME(4),=C'UTAH' SET UNIT NAME                               
         MVI   SPACING,5                                                        
         BAS   RE,PRINTIT                                                       
         MVC   UTLEMPN(L'NAMEFLD),NAMEFLD      EMPLOYER NAME                    
         MVC   UTLEMID,PRINTID     EMPLOYER ID                                  
         MVI   SPACING,3                                                        
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   UTLADDR(L'EMPADDR),EMPADDR    ADDRESS                            
         LA    R1,UTLQEDTE         QUARTER END DATE                             
         BAS   RE,SETEDTE                                                       
         MVC   6(2,R1),UCRRYR                                                   
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   UTLADDR(L'EMPCITY),EMPCITY    CITY, STATE                        
         MVI   UTLADDR+L'EMPCITY,C','                                           
         MVC   UTLADDR+L'EMPCITY+2(L'EMPSTATE),EMPSTATE                         
         BAS   RE,PRINTIT                                                       
         MVC   UTLADDR(L'EMPZIP),EMPZIP      ZIP CODE                           
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT                                                       
*                                                                               
         EDIT  (P8,REPTOT),(14,UTLTOTW),2  GRS EARNINGS ****QTR                 
         EDIT  NUMPG,(6,UTLPAGES)            N'PAGES                            
         BAS   RE,PRINTIT                                                       
         MVI   SPACING,3                                                        
         BAS   RE,PRINTIT          SKIP TO FIRST LINE                           
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DO TP/WI SPECIAL FORMS REPORT                               
*                                                                               
         USING UCRD,R3                                                          
         USING WILINED,R2                                                       
PRTPWI   NTR1                                                                   
         LA    R2,P                PUT INFO TO PRINT LINE                       
         L     R3,ASORTREC                                                      
         CLI   UCRTYPE,UCRTHEAD    HEADER RECORD                                
         BNE   TPWI10                                                           
         BAS   RE,INITWI           INITIALIZE                                   
         BAS   RE,TPWIHEAD         PROCESS HEADER                               
         B     TPWIX                                                            
*                                  THIS IS AN INDIVIDUAL'S                      
TPWI10   CLI   UCRTYPE,UCRTDET     DETAIL RECORD                                
         BNE   TPWITRL                                                          
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   TPWI15                                                           
         CLI   RECNUM,UCDISK       IF NOT UCDISK REPORT                         
         BE    TPWIX                                                            
         BRAS  RE,ADDNEG           PUT INFO IN TABLE TO PRINT LATER             
         B     TPWIX                                                            
*                                                                               
TPWI15   CLI   COUNTER,WISSPP      IF REACHED END OF PAGE                       
         BL    TPWI20                                                           
         LH    R1,THPAGE                  INCREMENT PAGE NUMBER                 
         LA    R1,1(R1)                                                         
         STH   R1,THPAGE                                                        
         EDIT  (P8,REPTOT),(12,WILLAST),2   REPORT TOTALS                       
         EDIT  (P8,PGTOT),(12,WILSSWG),2    PRINT PAGE TOTALS                   
         MVI   SPACING,3                                                        
         BAS   RE,PRINTIT                                                       
         EDIT  THPAGE,(6,WILPAGES)              PAGE XX                         
         EDIT  NUMPG,(6,WILTOTPG)                    OF                         
         BAS   RE,PRINTIT                                                       
         XC    COUNTER,COUNTER            CLEAR PAGE ACCUMULATORS               
         ZAP   PGTOT,=P'0'                                                      
         BAS   RE,SETSKIP                 SKIP TO NEXT PAGE                     
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT                                                       
         BAS   RE,TPWIHEAD                & PRINT HEADINGS AGAIN                
*                                                                               
TPWI20   MVC   WILSSN1,UCRSSN       SS NUMBER                                   
         MVC   WILSSN2,UCRSSN+3                                                 
         MVC   WILSSN3,UCRSSN+5                                                 
         MVC   WILLAST(L'W4LAST),W4LAST     LAST NAME                           
         MVC   WILFIRST,W4FRST              FIRST                               
         EDIT  (P8,UCRGROSQ),(12,WILSSWG),2   GROSS EARNINGS FOR QTR            
         MVI   SPACING,2                                                        
*                                                                               
         CLI   OMNTHS,C'Y'                                                      
         BNE   TPWI30                                                           
         MVC   P+80(3),UCRMTH1                                                  
         OC    P+80(3),=C'000'                                                  
*                                                                               
TPWI30   BAS   RE,PRINTIT                                                       
         BRAS  RE,PRTOT            KEEP TOTALS                                  
         ZIC   R1,COUNTER          N'LINES PRINTED                              
         LA    R1,1(R1)                                                         
         STC   R1,COUNTER                                                       
         B     TPWIX                                                            
*                                  THIS IS AN INDIVIDUAL'S RECORD               
TPWITRL  CLI   UCRTYPE,UCRTRAIL    TRAILER RECORD                               
         BNE   TPWIX                                                            
         CLI   COUNTER,WISSPP      IF DIDN'T REACH END OF PAGE                  
         BNL   TPWI40                                                           
         ZIC   R3,COUNTER                                                       
         LA    R1,WISSPP                                                        
         SR    R1,R3                                                            
         MH    R1,=H'2'                                                         
         STC   R1,SPACING                                                       
         BAS   RE,PRINTIT          N'LINES LEFT TO SKIP                         
*                                                                               
TPWI40   EDIT  (P8,REPTOT),(12,WILLAST),2   REPORT TOTALS                       
         EDIT  (P8,PGTOT),(12,WILSSWG),2    PAGE TOTALS                         
         MVI   SPACING,3                                                        
         BAS   RE,PRINTIT                                                       
         LH    R1,THPAGE                    INCREMENT PAGE NUMBER               
         LA    R1,1(R1)                                                         
         STH   R1,THPAGE                                                        
         EDIT  THPAGE,(6,WILPAGES)          PAGE XX                             
         EDIT  NUMPG,(6,WILTOTPG)                OF                             
         MVI   SPACING,3                                                        
         BAS   RE,PRINTIT                                                       
         BAS   RE,SETSKIP          SKIP TO NEXT PAGE                            
         BAS   RE,SETTOT                                                        
         BAS   RE,UNTPRT                                                        
         BAS   RE,SETSKIP          SKIP TO NEXT PAGE                            
         BAS   RE,PROCNEG          PRINT OUT PERFORMERS WITH NEG SUI            
*                                                                               
TPWIX    B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PRINT HEADER                                                
*                                                                               
TPWIHEAD NTR1                                                                   
         BAS   RE,PRINTIT                                                       
         MVC   WILACC,PRINTID      UC ACCOUNT                                   
         LA    R2,WILQTR           QUARTER                                      
         BAS   RE,SETQNO                                                        
         LA    R2,P                                                             
         MVC   WILYEAR,RYEAR       REPORTING YEAR CCYY                          
         MVI   SPACING,3                                                        
         BAS   RE,PRINTIT                                                       
*                                                                               
         MVC   TGTANAME,SPACES                                                  
         MVC   TGTANAME(9),LTWISC        SET UNIT NAME                          
         MVC   WILFEIN,FDID              FEDERAL EMPLOYER NUMBER                
         MVC   WILEMPNM(L'NAMEFLD),NAMEFLD                                      
         MVI   SPACING,3                                                        
         BAS   RE,PRINTIT                                                       
         MVI   SPACING,2                                                        
         BAS   RE,PRINTIT                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DO INITIALIZE                                               
*                                                                               
INITWI   NTR1                                                                   
         BAS   RE,SETSKIP                                                       
         LA    R1,NLEVELS          N'LEVELS                                     
         LA    R3,ACCUMS           LEVEL OF ACCUMULATORS                        
         BAS   RE,CLRACCS                                                       
         BCT   R1,*-4                                                           
*                                                                               
         USING UCRD,R3                                                          
         L     R3,ASORTREC                                                      
         LA    R1,WISSPP           N'PEOPLE PER PAGE                            
         BAS   RE,PAGES            CALC HOW MANY PGS WILL BE PRINTED            
         XC    THPAGE,THPAGE                                                    
         MVC   REPTOT,UCRGROSQ     SAVE TOTAL OF ENTIRE REPORT                  
         B     XIT                                                              
         EJECT                                                                  
*        ROUTINE TO DO TP/NJ TAPE                                               
*                                                                               
         USING UCRD,R3                                                          
         USING TUNJTPD,R4                                                       
PRTPNJ   NTR1                                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPACE                                                      
         CLI   UCRTYPE,UCRTHEAD    HEADER RECORD                                
         BE    TPNJHEAD                                                         
         CLI   UCRTYPE,UCRTDET     DETAIL RECORD                                
         BNE   TPNJX                                                            
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   TPNJ3                                                            
         BRAS  RE,ADDNEG                                                        
         B     TPNJX               DON'T PUT TO TAPE                            
*                                                                               
TPNJ3    MVI   TUNJID,TUNJIDB      RECORD TYPE                                  
         MVC   TUNJSSN,UCRSSN      SS NUMBER                                    
         MVC   TUNJSSNM(L'W4LAST),W4LAST     LAST NAME                          
         LA    R1,TUNJSSNM+L'TUNJSSNM                                           
         BAS   RE,SHUFFLE          SHUFFLE BACK TO NON BLANK                    
         MVC   0(L'W4FRST,R1),W4FRST          FIRST NAME                        
         UNPK  TUNJSSWG,UCRGROSQ              GROSS WAGES                       
         OI    TUNJSSWG+L'TUNJSSWG-1,X'F0'                                      
         EDIT  (B1,UCRWEEK),(2,TUNJWKS),FILL=0,ZERO=NOBLANK  WKS WORKED         
         B     TPNJPUT                                                          
*                                                                               
TPNJHEAD MVI   TUNJID,TUNJIDX      RECORD TYPE                                  
         LA    R2,TUNJQTRX                                                      
         BAS   RE,SETQNO           SET QUARTER NUMBER                           
         MVC   TUNJYRX,UCRRYR+1    REPORTING YEAR'S LAST DIGIT                  
         MVC   TUNJAUTH,=C'0280'                                                
         BRAS  RE,PUTTAPE          1ST RECORD ON TAPE                           
*                                                                               
         BRAS  RE,MVCSPACE                                                      
         MVI   TUNJID,TUNJIDM      RECORD TYPE                                  
         MVC   TUNJREG,FDID                    EMPLOYER STATE ID                
         MVC   TUNJREG+9(3),=C'000'                                             
         MVC   TUNJEMNM(L'NAMEFLD),NAMEFLD              NAME                    
         MVC   TUNJEMAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUNJEMCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUNJEMST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUNJEMZP(L'TUNJEMZP),EMPZIP              ZIP CODE                
         LA    R2,TUNJQTRA                                                      
         BAS   RE,SETQNO           SET QUARTER NUMBER                           
         MVC   TUNJYRX,UCRRYR+1    YEAR                                         
         UNPK  TUNJNEMP,UCRNSSN    COUNT                                        
         OI    TUNJNEMP+L'TUNJNEMP-1,X'F0'                                      
         UNPK  TUNJTOTW,UCRGROSQ   TOTAL WAGES                                  
         OI    TUNJTOTW+L'TUNJTOTW-1,X'F0'                                      
         MVC   TUNJEMID,FDID       EMPLOYER (TP) ID                             
*                                                                               
TPNJPUT  BRAS  RE,PUTTAPE                                                       
*                                                                               
TPNJX    B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DO TP/OH TAPE                                               
*                                                                               
         USING TUOHTPD,R4                                                       
         USING UCRD,R3                                                          
PRTPOH   NTR1                                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPACE                                                      
         CLI   UCRTYPE,UCRTHEAD    HEADER RECORD                                
         BE    TPOHHEAD                                                         
         CLI   UCRTYPE,UCRTRAIL    TRAILER RECORD                               
         BE    TPOHTRAL                                                         
*                                  THIS IS AN INDIVIDUAL'S RECORD               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   TPOH3               DON'T PUT RECORD TO TAPE                     
         BRAS  RE,ADDNEG                                                        
         B     TPOHX               DON'T PUT RECORD TO TAPE                     
*                                                                               
TPOH3    MVI   TUOTID,TUOTIDW      DETAIL RECORD                                
         MVC   TUOTSSN,UCRSSN      SS NUMBER                                    
         MVC   TUOTSSNM(L'W4LAST),W4LAST    LAST NAME                           
         LA    R1,TUOTSSNM+L'TUOTSSNM                                           
         BAS   RE,SHUFFLE                   SHUFFLE BACK TO NON BLANK           
         MVC   0(L'W4FRST,R1),W4FRST        FIRST NAME                          
         EDIT  (P8,UCRGROSQ),(9,TUOTWAGE),FILL=0      GRS FOR QTR               
         EDIT  (B1,UCRWEEK),(2,TUOTWKS),FILL=0        WEEKS WORKED              
         B     TPOHPUT                                                          
*                                                                               
TPOHHEAD DS    0H                                                               
         MVI   TUOTID,TUOTIDE      FIRST RECORD ON TAPE                         
         MVC   TUOTEMID,FDID       EMPLOYER ID                                  
         LA    R2,TUOTQTRE                                                      
         BAS   RE,SETQNO           SET QUARTER NUMBER                           
         MVC   TUOTYRE,UCRRYR      REPORTING YEAR                               
         MVC   TUOTFZR,LTZERO                                                   
         MVC   TUOTEMNM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         MVC   TUOTEMAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUOTEMCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUOTEMST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUOTZIP(L'TUOTZIP),EMPZIP                 ZIP CODE               
         MVI   TUOTNMCD,TUOTNCDS   NAME CODE                                    
         MVC   TUOTBFCT,=C'25'     BLOCKING FACTOR                              
         MVC   TUOTSTCD,TGTANUM    STATE CODE                                   
         MVC   TUOTSTAC,SV15IDZ    STATE ACCOUNT NUMBER                         
         B     TPOHPUT                                                          
*                                                                               
TPOHTRAL DS    0H                                                               
         MVI   TUOTID,TUOTIDT      LAST RECORD ON TAPE                          
         EDIT  (P4,UCRNSSN),(7,TUOTECNT)      TOTAL PERFORMERS ON TAPE          
         EDIT  (P8,UCRGROSQ),(13,TUOTWGT),FILL=0 GROSS EARNINGS FOR QTR         
         B     TPOHPUT                                                          
*                                                                               
TPOHPUT  BRAS  RE,PUTTAPE                                                       
TPOHX    B     XIT                                                              
         EJECT                                                                  
*&&DO                                                                           
*        ROUTINE TO DO TP/FL TAPE                                               
*                                                                               
         USING TUFLTPD,R4                                                       
         USING UCRD,R3                                                          
PRTPFL   NTR1                                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPACE                                                      
         CLI   UCRTYPE,UCRTHEAD    HEADER RECORD                                
         BE    TPFLHEAD                                                         
         CLI   UCRTYPE,UCRTRAIL    TRAILER RECORD                               
         BE    TPFLTRAL                                                         
*                                  THIS IS AN INDIVIDUAL'S RECORD               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   TPFL3               DON'T PUT RECORD TO TAPE                     
         BRAS  RE,ADDNEG                                                        
         B     TPFLX               DON'T PUT RECORD TO TAPE                     
*                                                                               
TPFL3    BRAS  RE,MVCSPACE                                                      
         MVI   TUFTID,TUFTIDW      BYPASS                                       
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         MVI   TUFTID,TUFTIDS      DETAIL RECORD                                
         MVC   TUFTSSN,UCRSSN      SS NUMBER                                    
         MVC   TUFTSSNM(L'W4LAST),W4LAST    LAST NAME                           
         LA    R1,TUFTSSNM+L'TUFTSSNM                                           
         BAS   RE,SHUFFLE                   SHUFFLE BACK TO NON BLANK           
         MVC   0(L'W4FRST,R1),W4FRST        FIRST NAME                          
         MVC   TUFTSTCD,=C'12'     ACCOUNT NUMBER                               
         EDIT  (P8,UCRGROSQ),(9,TUFTWAGE),FILL=0      GRS FOR QTR               
         EDIT  (B1,UCRWEEK),(2,TUFTWKS),FILL=0        WEEKS WORKED              
         MVC   TUFTACCT,SVID       ACCOUNT NUMBER                               
         MVI   TUFTTXTY,TUFTTXTB   EMPLOYMENT SECURITY                          
         MVC   TUFTSQTR(L'RPTMMYR),RPTMMYR QTR ENDING MTH/YEAR                  
         B     TPFLPUT                                                          
*                                                                               
TPFLHEAD MVI   TUFTID,TUFTIDA      FIRST RECORD ON TAPE                         
         BRAS  RE,PUTTAPE                                                       
         BRAS  RE,MVCSPACE                                                      
         MVI   TUFTID,TUFTIDB      BYPASS RECORD                                
         BRAS  RE,PUTTAPE                                                       
         BRAS  RE,MVCSPACE                                                      
         MVI   TUFTID,TUFTIDE      FIRST RECORD ON TAPE                         
         MVI   TUFTENCD,TUFTENCS   NAME CODE                                    
         BRAS  RE,PUTTAPE                                                       
         BRAS  RE,MVCSPACE                                                      
         MVI   TUFTID,TUFTIDW      BYPASS                                       
         B     TPFLPUT                                                          
*                                                                               
TPFLTRAL MVI   TUFTID,TUFTIDT      LAST RECORDS ON TAPE                         
         BRAS  RE,PUTTAPE                                                       
         BRAS  RE,MVCSPACE                                                      
         MVI   TUFTID,TUFTIDF                                                   
         B     TPFLPUT                                                          
*                                                                               
TPFLPUT  BRAS  RE,PUTTAPE                                                       
TPFLX    B     XIT                                                              
         EJECT                                                                  
*&&                                                                             
*                                                                               
*        ROUTINE TO DO VERSION ONE TAPE                                         
*        CURRENTLY FOR TEXAS/TP AND OREGON/TP                                   
*                                                                               
         USING TUVER1D,R4                                                       
         USING UCRD,R3                                                          
PRVER1   NTR1                                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPACE                                                      
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BAS   RE,PRV1HEAD         PROCESS A,B AND E RECORDS                    
         B     XIT                                                              
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   *+12                                                             
         BAS   RE,PRV1TRAL         PROCESS T AND F RECORDS                      
         B     XIT                                                              
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   XIT                                                              
         BAS   RE,PRV1DET          PROCESS S RECORDS                            
         B     XIT                                                              
         SPACE 2                                                                
*        ROUTINE TO PUT FIRST, SECOND AND THIRD RECORDS ON TAPE                 
         SPACE                                                                  
PRV1HEAD NTR1                                                                   
         CLC   =C'NE ',UCRSTATE    IF NEBRASKA                                  
         BE    *+10                                                             
         CLC   =C'OR ',UCRSTATE    IF OREGON                                    
         BE    *+10                                                             
         CLC   =C'CT ',UCRSTATE    IF CONNECTICUT                               
         BE    *+10                                                             
         CLC   =C'UT ',UCRSTATE    IF UTAH                                      
         BE    *+10                                                             
         CLC   =C'WI ',UCRSTATE    IF WISCONSIN                                 
         BE    PRV1HEDE            ONLY DO EMPLOYER                             
*                                                                               
         BAS   RE,PRV1AREC         PUT A RECORD TO TAPE                         
         CLC   =C'HI ',UCRSTATE    IF NOT HAWAII                                
         BE    *+10                                                             
         CLC   =C'FL ',UCRSTATE    IF NOT FLORIDA                               
         BE    *+10                                                             
         CLC   =C'WI ',UCRSTATE    IF NOT WISCONSIN                             
         BE    *+8                                                              
         BAS   RE,PRV1BREC         PUT B RECORD TO TAPE                         
         CLC   =C'DC ',UCRSTATE    DC DONT HAVE E RECORD                        
         BE    XIT                                                              
PRV1HEDE GOTOR PRV1EREC            PUT E RECORD TO TAPE                         
         BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         EJECT                                                                  
*        ROUTINE TO PUT FIRST RECORD ON TAPE                                    
         SPACE                                                                  
PRV1AREC NTR1                                                                   
         CLC   =C'DC ',UCRSTATE    IF DC                                        
         BNE   PRV1AR06                                                         
         GOTOR EFW2RA              EFW2, RA RECORD                              
         B     PRV1ARX                                                          
*                                                                               
PRV1AR06 CLC   =C'FL ',UCRSTATE    IF FLORIDA                                   
         BNE   PRV1AR10                                                         
         GOTOR MMREFRA             MMREF, RA RECORD                             
         B     PRV1ARX                                                          
*                                                                               
*                                                                               
PRV1AR10 MVI   TUV1ID,TUV1IDA         A - 1ST RECORD ON TAPE                    
         MVC   TUV1EMID(L'FDID),FDID  EMPLOYER #                                
         MVC   TUV1YEAR,RYEAR         REPORTING YEAR - CCYY                     
         CLC   =C'HI ',UCRSTATE    IF NOT HAWAII                                
         BE    *+10                                                             
         MVC   TUV1MM(L'RPTMMYR),RPTMMYR QTR ENDING MTH/REPORTING YR            
*                                                                               
PRV1AR20 MVC   TUV1EMNM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         MVC   TUV1EMAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUV1EMCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUV1EMST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUV1ZIP(L'EMPZIP),EMPZIP                 ZIP CODE                
         CLC   =C'HI ',UCRSTATE                                                 
         BE    *+10                                                             
         MVC   TUV1ZIP2,LTXEXZIP                        EXTENDED ZIP            
*                                                                               
PRV1ARX  BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         SPACE 2                                                                
*        ROUTINE TO PUT SECOND RECORD ON TAPE                                   
         SPACE                                                                  
PRV1BREC NTR1                                                                   
         CLC   =C'DC ',UCRSTATE    DC                                           
         BE    XIT                                                              
         BRAS  RE,MVCSPACE                                                      
         MVI   TUV1ID,TUV1IDB         B - 2ND RECORD ON TAPE                    
         MVC   TUV1YEAR,RYEAR         REPORTING YEAR - CCYY                     
         MVC   TUV1EMID(L'FDID),FDID  EMPLOYER #                                
         MVC   TUV1BCMP(3),=C'IBM'                                              
         MVC   TUV1BLBL,=C'SL'                                                  
         MVI   TUV1BPAR,C'O'                                                    
         MVC   TUV1BDEN,=C'62'                                                  
         MVC   TUV1BRCD,=C'EBC'                                                 
         MVI   TUV1BTRK,C'9'                                                    
*                                                                               
         MVC   TUV1BCNM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         MVC   TUV1BCAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUV1BCCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUV1BCST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUV1BCZP(L'EMPZIP),EMPZIP                ZIP CODE                
         MVC   TUV1BCZ2,LTXEXZIP                        EXTENDED ZIP            
*                                                                               
         MVC   TUV1BRNM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         MVC   TUV1BRAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUV1BRCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUV1BRST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUV1BRZP(L'EMPZIP),EMPZIP                ZIP CODE                
         MVC   TUV1BRZ2,LTXEXZIP                        EXTENDED ZIP            
PRV1BRX  BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         EJECT                                                                  
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
PRV1DET  NTR1                                                                   
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   PRV1DET1            DON'T PUT RECORD TO TAPE                     
         BRAS  RE,ADDNEG                                                        
         B     XIT                 DON'T PUT RECORD TO TAPE                     
*                                                                               
PRV1DET1 CLC   =C'DC ',UCRSTATE    IF DC                                        
         BNE   PRV1DET2                                                         
         GOTOR EFW2RS                                                           
         B     PRV1DETX                                                         
PRV1DET2 CLC   =C'OR ',UCRSTATE    IF OREGON                                    
         BE    *+10                                                             
         CLC   =C'FL ',UCRSTATE    IF FLORIDA                                   
         BNE   PRV1DET3                                                         
         GOTOR MMREFRS             MMREF, RS RECORD                             
         B     PRV1DETX                                                         
*                                                                               
PRV1DET3 MVI   TUV1ID,TUV1IDS      S - INDIVIDUAL RECORDS                       
         MVC   TUV1SSSN,UCRSSN     SS NUMBER                                    
*                                                                               
         MVC   TUV1SNME(L'W4LAST),W4LAST  LAST NAME                             
         LA    R1,TUV1SNME+L'TUV1SNME                                           
         BAS   RE,SHUFFLE                 SHUFFLE BACK TO NON BLANK             
         MVC   0(L'W4FRST,R1),W4FRST      FIRST NAME                            
*                                                                               
         MVC   TUV1SSTC,TGTANUM    STATE CODE                                   
*                                                                               
         CLC   =C'NE ',UCRSTATE    NEBRASKA NEEDS PERIOD                        
         BE    *+10                                                             
         CLC   =C'UT ',UCRSTATE    UTAH NEEDS PERIOD                            
         BNE   PRV1DT3A                                                         
         MVC   TUV1SPER(4),RPTMMYR                                              
         B     PRV1DET4                                                         
PRV1DT3A CLC   =C'CT ',UCRSTATE    CONNETICUT ONLY WANTS ADDRESS                
         BNE   PRV1DET5                                                         
*                                                                               
         MVC   AIO,AIO2                                                         
         MVC   TGSSN,UCRSSN                                                     
         BAS   RE,GETW4                                                         
         MVC   TUV1SADD,BLOCK                                                   
         MVC   TUV1SCTY,BLOCK+90                                                
         MVC   TUV1SSTA(2),DUB                                                  
         MVC   TUV1SZIP,WORK                                                    
         MVC   TUV1SZPX,WORK+5                                                  
         MVI   TUV1SZPX,C'-'                                                    
         MVC   AIO,AIO1                                                         
PRV1DET4 EDIT  (P8,UCRSUIWQ),(9,TUV1TXWG),FILL=0  TAXABLE ERNGS                 
         B     PRV1DET6                                                         
*                                                                               
PRV1DET5 CLC   =C'WI ',UCRSTATE                                                 
         BNE   *+10                                                             
         MVC   TUV1SRCC,=C'01'                                                  
         MVC   TUV1SPER(L'RPTMMYR),RPTMMYR QTR END MTH/YEAR                     
PRV1DET6 EDIT  (P8,UCRGROSQ),(9,TUV1SWG),FILL=0 GRS EARNINGS FOR QTR            
*                                                                               
         CLC   =C'NE ',UCRSTATE    NEBRASKA NEEDS STATE ABBREVIATION            
         BNE   PRV1DETX                                                         
         MVC   TUV1STAB,UCRSTATE                                                
         B     PRV1DETX                                                         
*                                                                               
PRV1DT20 DS    0H                  MASS. ONLY                                   
         EDIT  (P8,UCRGROSQ),(9,TUV1STGW),FILL=0 GRS EARNINGS FOR QTR           
*                                                                               
PRV1DETX BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         EJECT                                                                  
*        ROUTINE TO PUT TRAILER RECORDS ON TAPE (T AND F)                       
*                                                                               
         USING TUVER1D,R4                                                       
PRV1TRAL NTR1                                                                   
*                                                                               
         CLC   =C'DC ',UCRSTATE    DC                                           
         BNE   PRV1TR2                                                          
         GOTOR EFW2RV              EMPLOYER TOTAL                               
         BRAS  RE,PUTTAPE                                                       
         GOTOR EFW2RF              FILE TOTALS                                  
         BRAS  RE,PUTTAPE                                                       
         B     PRV1TRX                                                          
*                                                                               
PRV1TR2  CLC   =C'FL ',UCRSTATE    OR FLORIDA                                   
         BNE   PRV1TR3                                                          
         GOTOR MMREFRT                                                          
         BRAS  RE,PUTTAPE                                                       
         BRAS  RE,PUTXMLX          XML RECORD NEEDED FOR FL                     
         B     PRV1TRC9                                                         
*                                                                               
PRV1TR3  CLC   =C'HI ',UCRSTATE    IF NOT HAWAII                                
         BE    PRV1TRX                                                          
         CLC   =C'OR ',UCRSTATE    OR OREGON                                    
         BE    PRV1TRX                                                          
         CLC   =C'WI ',UCRSTATE    OR WISCONSIN                                 
         BE    PRV1TRX                                                          
         CLC   =C'CT ',UCRSTATE    CT, NO T RECORD NEEDED                       
         BE    PRV1TRC                                                          
         MVI   TUV1ID,TUV1IDT      2ND TO LAST RECORD ON TAPE                   
         EDIT  (P4,UCRNSSN),(7,TUV1TCNT),FILL=0  TOTAL PERFS ON TAPE            
         LA    RE,TUV1TWG                                                       
         CLC   =C'NE ',UCRSTATE    NE, DIFFERENT TOTAL RECORD                   
         BE    PRV1TR5                                                          
         CLC   =C'UT ',UCRSTATE    UT, DIFFERENT TOTAL RECORD                   
         BE    PRV1TR5                                                          
PRV1TR5  LA    RE,TUV1TWG2                                                      
*                                                                               
PRV1TR8  EDIT  (P8,UCRGROSQ),(13,(RE)),FILL=0    GROSS EARNINGS FOR QTR         
PRV1TR9  BRAS  RE,PUTTAPE                                                       
*                                                                               
PRV1TRC  BRAS  RE,MVCSPACE                                                      
         CLC   =C'NE ',UCRSTATE    NE, NO F RECORD                              
         BE    PRV1TRX                                                          
         MVI   TUV1ID,TUV1IDF      LAST RECORD ON TAPE                          
         EDIT  (P4,UCRNSSN),(7,TUV1FCNT),FILL=0   PERFORMERS ON TAPE            
         CLC   =C'CT ',UCRSTATE    CT, MORE TO THE F RECORD                     
         BNE   PRV1TRC9                                                         
*                                                                               
         EDIT  (P8,UCRSUIWQ),(16,TUV1FTXW),FILL=0 TAXABLE WAGES                 
         EDIT  (P8,UCRGROSQ),(16,TUV1FGWG),FILL=0 GROSS WAGES                   
         ZAP   DUB,UCRGROSQ                                                     
         SP    DUB,UCRSUIWQ                                                     
         EDIT  (P8,DUB),(16,TUV1FXWG),FILL=0      GROSS - TAXABLE               
         MVC   TUV1FREM,LTZERO                    REMITTANCE                    
         EDIT  (P4,UCRNMTH1),(5,TUV1FM1C),FILL=0                                
         EDIT  (P4,UCRNMTH2),(5,TUV1FM2C),FILL=0                                
         EDIT  (P4,UCRNMTH3),(5,TUV1FM3C),FILL=0                                
         B     PRV1TRC9                                                         
*                                                                               
PRV1TRC7 EDIT  (P4,UCRNSSN),(10,TUV1FCWK),FILL=0   PERFORMERS ON TAPE           
         MVC   TUV1FCEM,=CL10'0000000001'                                       
         MVC   TUV1FTTY,=C'UTAX'                                                
         EDIT  (P8,UCRGROSQ),(15,TUV1FGRW),FILL=0  GROSS WAGES                  
*                                                                               
PRV1TRC9 BRAS  RE,PUTTAPE                                                       
*                                                                               
PRV1TRX  B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO VERSION 3 TAPE                                           
*        FOR MINNESOTA ONLY!                                                    
*======================================================================         
PRVER3   NTR1                                                                   
         BRAS  RE,VERSION3                                                      
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO VERSION FOUR TAPE (ICESA FORMAT)                         
*======================================================================         
         USING TUVER4D,R4                                                       
         USING UCRD,R3                                                          
PRVER4   NTR1                                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPACE         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLC   =C'MA ',UCRSTATE    IF MASS                                      
         BE    PRVER4D                ONLY WANT DETAIL                          
                                                                                
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BAS   RE,PRV4HEAD         PROCESS A,B AND E RECORDS                    
         B     XIT                                                              
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   *+12                                                             
         BAS   RE,PRV4TRAL         PROCESS T AND F RECORDS                      
         B     XIT                                                              
*                                                                               
PRVER4D  CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   XIT                                                              
         BAS   RE,PRV4DET          PROCESS S RECORDS                            
         B     XIT                                                              
*                                                                               
*        ROUTINE TO PUT FIRST, SECOND AND THIRD RECORDS ON TAPE                 
*                                                                               
PRV4HEAD NTR1                                                                   
*                                                                               
         CLC   =C'MS ',UCRSTATE    IF MISSIPPI                                  
         BE    PRV4HEDX               SKIP HEADERS                              
         CLC   =C'NM ',UCRSTATE    IF NEW MEXICO                                
         BE    PRV4HEDX               SKIP HEADERS                              
*                                                                               
         CLC   =C'CA ',UCRSTATE    IF CALIFORNIA                                
         BE    PRV4HEDE               ONLY DO EMPLOYER                          
         CLC   =C'OK ',UCRSTATE    IF OKLAHOMA                                  
         BE    PRV4HEDE               ONLY DO EMPLOYER                          
         CLC   =C'ND ',UCRSTATE    IF NORTH DAKOTA                              
         BE    PRV4HEDE               ONLY DO EMPLOYER                          
*                                                                               
         BAS   RE,PRV4AREC         PUT A RECORD TO TAPE                         
*                                                                               
         CLC   =C'CO ',UCRSTATE    IF COLORADO                                  
         BE    PRV4HEDX            SKIP B AND E RECORDS                         
*                                                                               
         CLC   =C'AL ',UCRSTATE    IF ALABAMA                                   
         BE    *+10                SKIP B RECORD                                
         CLC   =C'ND ',UCRSTATE    IF NORTH DAKOTA                              
         BE    *+8                 SKIP B RECORD                                
         BAS   RE,PRV4BREC         PUT B RECORD TO TAPE                         
*                                                                               
PRV4HEDE BAS   RE,PRV4EREC         PUT E RECORD TO TAPE                         
*                                                                               
PRV4HEDX DS    0H                                                               
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT FIRST RECORD ON TAPE                                    
*                                                                               
PRV4AREC NTR1                                                                   
*                                                                               
         MVI   TUV4ID,TUV4IDA      A - 1ST RECORD ON TAPE                       
         CLC   =C'CO ',UCRSTATE    IF COLORADO, SKIP                            
         BE    *+10                                                             
         MVC   TUV4EMID,FDID       FEDERAL EMPLOYER #                           
*                                                                               
         CLC   =C'AL',UCRSTATE     IF ALABAMA                                   
         BE    PRV4AR02            SKIP YEAR                                    
         CLC   =C'KS',UCRSTATE     IF KANSAS                                    
         BE    *+16                  SKIP YEAR                                  
         MVC   TUV4YEAR,RYEAR      REPORTING YEAR - CCYY                        
PRV4AR02 MVC   TUV4LIT,=C'UTAX'    CONSTANT 'UTAX'                              
*                                                                               
         MVC   TUV4EMNM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         CLC   =C'AL',UCRSTATE     IF ALABAMA, DONE                             
         BE    PRV4AR15                                                         
         MVC   TUV4EMAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUV4EMCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUV4EMST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUV4ZIP(L'EMPZIP),EMPZIP                 ZIP CODE                
                                                                                
         CLC   =C'OH',UCRSTATE     IF OHIO                                      
         BNE   PRV4AR04                                                         
         MVC   TUV4SEAN,PRINTID                                                 
                                                                                
PRV4AR04 CLC   =C'KS',UCRSTATE     IF KANSAS                                    
         BNE   PRV4AR05                                                         
         CLC   TUV4ZIP2,SPACES      -DO ZIP THIS WAY                            
         BNH   PRV4AR05                                                         
         MVC   WORK(L'TUV4ZIP2),TUV4ZIP2                                        
         MVC   TUV4ZIP2+1(4),WORK                                               
         MVI   TUV4ZIP2,C'-'                                                    
**NO-OP* MVC   TUV4ZIP2,LTXEXZIP               (NOT RIGHT FOR ALL EMPS)         
*                                                                               
PRV4AR05 CLC   =C'CO ',UCRSTATE    IF COLORADO,                                 
         BNE   PRV4AR07                                                         
         MVC   TUV4EMN2,=CL30'DANIELLE KOSCHIL TAX MANAGER'                     
         MVC   TUV4CEML,=CL50'DKOSCHIL@TALENTPARTNERS.COM'  EMAIL               
         B     PRV4AR11                                                         
*                                                                               
PRV4AR07 CLC   =C'ME ',UCRSTATE    IF MAINE,                                    
         BE    *+14                                                             
         CLC   =C'KS',UCRSTATE     IF KANSAS                                    
         BNE   PRV4AR10                                                         
         MVC   TUV4EMN2,=CL30'DANIELLE KOSCHIL'                                 
         B     *+10                                                             
*                                                                               
PRV4AR10 MVC   TUV4EMN2,=CL30'SR TAX MANAGER'                                   
PRV4AR11 MVC   TUV4TEL,=C'3129237900'          TELEPHONE NUMBER                 
         CLC   =C'KS ',UCRSTATE     IF KANSAS                                   
         BE    PRV4AR15              DONE                                       
         CLC   =C'CO ',UCRSTATE     IF COLORADO                                 
         BE    PRV4AR15              DONE                                       
         GOTO1 DATCON,DMCB,(0,TGTODAY0),(20,WORK)                               
         MVC   TUV4TDAY(4),WORK+4              CREATION DATE - MMDDYYYY         
         MVC   TUV4TDAY+4(4),WORK                                               
         CLC   =C'IL',UCRSTATE     IF ILLINOIS                                  
         BE    PRV4AR15              DONE                                       
         MVC   TUV4CPER,=CL30'DANIELLE KOSCHIL' TP CONTACT PERSON               
         CLC   =C'OH',UCRSTATE     IF OHIO                                      
         BNE   PRV4AR15              DONE                                       
         MVC   TUV4OHTR,=CL10'0000000000'                                       
PRV4AR15 BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         SPACE 2                                                                
*        ROUTINE TO PUT SECOND RECORD ON TAPE                                   
         SPACE                                                                  
PRV4BREC NTR1                                                                   
         BRAS  RE,MVCSPACE         PRESET TAPE AREA TO SPACES                   
         MVI   TUV4ID,TUV4IDB      B - 2ND RECORD ON TAPE                       
         CLC   =C'KS',UCRSTATE     IF KANSAS                                    
         BE    PRV4BR25                                                         
         MVC   TUV4YEAR,RYEAR      REPORTING YEAR - CCYY                        
         MVC   TUV4EMID,FDID       FEDERAL EMPLOYER #                           
*                                                                               
         CLC   =C'IL ',UCRSTATE    IF ILLINOIS,                                 
         BE    PRV4BR05                                                         
*                                                                               
         MVC   TUV4BCMP(3),=C'IBM' COMPUTER                                     
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE,                                    
         BNE   PRV4BR10                                                         
PRV4BR05 MVC   TUV4BRCD,=C'ASC'    ASCII                                        
         B     PRV4BR20                                                         
*                                                                               
PRV4BR10 MVC   TUV4BLBL,=C'SL'     INTERNAL LABEL                               
         MVC   TUV4BDEN,=C'62'     REEL TAPE                                    
         MVC   TUV4BRCD,=C'EBC'    EBCDIC                                       
         MVC   TUV4BTRK,=C'09'     N'TRACKS                                     
         MVC   TUV4BFCT,=C'25'     BLOCKING FACTOR                              
PRV4BR20 MVC   TUV4BLIT,=C'UTAX'   CONSTANT 'UTAX'                              
*                                                                               
         CLC   =C'IL ',UCRSTATE    IF ILLINOIS, SKIP CONTACT NAME               
         BE    *+10                                                             
         MVC   TUV4BNM,=CL50'DANIELLE KOSCHIL' CONTACT NAME                     
PRV4BR25 MVC   TUV4BRNM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE,                                    
         BE    PRV4BR30            LEAVE ADDRESS BLANK                          
         MVC   TUV4BRAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUV4BRCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUV4BRST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUV4BRZP(L'EMPZIP),EMPZIP                ZIP CODE                
         CLC   =C'KS',UCRSTATE     IF KANSAS                                    
         BNE   PRV4BR28                                                         
         CLC   TUV4BRZ2,SPACES      -DO ZIP THIS WAY                            
         BNH   PRV4BR30                                                         
         MVC   WORK(L'TUV4BRZ2),TUV4BRZ2                                        
         MVC   TUV4BRZ2+1(4),WORK                                               
         MVI   TUV4BRZ2,C'-'                                                    
         B     PRV4BR30                                                         
**NO-OP* MVC   TUV4BRZ2,LTXEXZIP               (NOT RIGHT FOR ALL EMPS)         
*                                                                               
PRV4BR28 MVC   TUV4BFT,=C'MC'      MAGNETIC CARTRIDGE                           
         CLC   =C'IL ',UCRSTATE    IF ILLINOIS,                                 
         BNE   PRV4BR30                                                         
         MVC   TUV4BFT,=C'D3'      3 1/2 DISKETTE                               
PRV4BR30 BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT THIRD RECORD ON TAPE                                    
*                                                                               
PRV4EREC NTR1                                                                   
*                                                                               
         CLC   =C'CA ',UCRSTATE                                                 
         BNE   PRV4ER0                                                          
*                                                                               
         GOTOR MMREFRE             MMREF, RE RECORD                             
*                                                                               
         B     PRV4ERX                                                          
*                                                                               
PRV4ER0  BRAS  RE,MVCSPACE         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVI   TUV4ID,TUV4IDE      E - 3RD RECORD ON TAPE                       
*                                                                               
         CLC   =C'OH',UCRSTATE     SKIP IF OHIO                                 
         BNE   *+8                                                              
         MVI   TUV4EOSW,C'Y'       OUT OF STATE WAGES                           
                                                                                
         CLC   =C'KS',UCRSTATE     SKIP IF KANSAS                               
         BE    *+10                                                             
         MVC   TUV4YEAR,RYEAR      REPORTING YEAR - CCYY                        
*                                                                               
         MVC   TUV4EMID,FDID       FEDERAL EMPLOYER #                           
*                                                                               
         MVC   TUV4EENM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
*                                                                               
         CLC   =C'ND',UCRSTATE     SKIP IF NOT NORTH DAKOTA                     
         BNE   PRV4ER01                                                         
*                                                                               
         MVC   TUV4ESTC,TGTANUM    STATE CODE                                   
         MVC   TUV4ESAC,=CL15'000000001002210' ACC #                            
         CLC   =C'P+',TGEMP                                                     
         BNE   *+10                                                             
         MVC   TUV4ESAC,=CL15'000000001247980' ACC #                            
*                                                                               
         B     PRV4ER15                                                         
*                                                                               
PRV4ER01 DS    0H                                                               
*                                                                               
         CLC   =C'OK',UCRSTATE     IF OKLAHOMA                                  
         BE    PRV4ER05               SKIP                                      
*                                                                               
         CLC   =C'AL',UCRSTATE     IF ALABAMA                                   
         BNE   PRV4ER03                                                         
*                                                                               
         MVC   TUV4EEST(L'EMPSTATE),TGTANUM    STATE CODE                       
         MVC   TUV4ELIT,=C'UTAX'   CONSTANT 'UTAX'                              
*                                                                               
         B     PRV4ER10                                                         
*                                                                               
PRV4ER03 MVC   TUV4EEAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUV4EECT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUV4EEST(L'EMPSTATE),EMPSTATE            STATE                   
**NO-OP* MVC   TUV4EZP2,LTXEXZIP               (NOT RIGHT FOR ALL EMPS)         
         MVC   TUV4EZIP(L'EMPZIP),EMPZIP                ZIP CODE                
*                                                                               
         CLC   =C'KS',UCRSTATE     IF KANSAS                                    
         BNE   PRV4ER05                                                         
*                                                                               
         MVC   TUV4EZP2+1(4),EMPZIP+5                                           
         MVC   TUV4EZIP,EMPZIP                                                  
         MVC   TUV4ESAC,SV15IDB    ACCOUNT # (STATE UI FOR EMPLOYER)            
         B     PRV4ERX                                                          
*                                                                               
PRV4ER05 CLC   =C'IL',UCRSTATE     IF ILLINOIS, SKIP                            
         BE    PRV4ER08                                                         
*                                                                               
         MVI   TUV4TYEM,TUV4EMTR   TYPE OF EMPLOYMENT                           
*                                                                               
         CLC   =C'OK',UCRSTATE     SKIP IF OKLAHOMA                             
         BE    *+10                                                             
         MVC   TUV4EBF,=C'25'      BLOCKING FACTOR                              
*                                                                               
PRV4ER08 MVC   TUV4ELIT,=C'UTAX'   CONSTANT 'UTAX'                              
         MVC   TUV4ESTC,TGTANUM    STATE CODE                                   
*                                                                               
         CLC   =C'IL ',UCRSTATE     IF ILLINIOS,                                
         BNE   PRV4ER09             ONLY NEED 7 DIGIT ACCOUNT #                 
         MVC   TUV4ESAC(7),SV15IDB  ACCOUNT # (STATE UI FOR EMPLOYER)           
         B     PRV4ER11                                                         
*                                                                               
PRV4ER09 CLC   =C'KY ',UCRSTATE     IF KENTUCKY,                                
         BNE   PRV4ER10             ONLY NEED 9 DIGIT ACCOUNT #                 
*                                                                               
         MVC   TUV4ESAC(9),SV15IDB  ACCOUNT # (STATE UI FOR EMPLOYER)           
         B     *+10                                                             
PRV4ER10 MVC   TUV4ESAC,SV15IDB    ACCOUNT # (STATE UI FOR EMPLOYER)            
*                                                                               
PRV4ER11 CLC   =C'WV ',UCRSTATE    IF WEST VIRGINIA,                            
         BNE   *+10                                                             
         MVC   TUV4ESAC,SV15IDZ    ACCOUNT # (LEFT PADDED WITH ZEROS)           
*                                                                               
PRV4ER15 DS    0H                                                               
*                                                                               
         MVC   TUV4EPER,RPTMMYR    QTR ENDING MONTH                             
*                                                                               
         CLC   =C'AL',UCRSTATE     IF ALABAMA, DONE                             
         BE    PRV4ERX                                                          
*                                                                               
         CLC   =C'ND',UCRSTATE     IF NORTH DAKOTA, DONE                        
         BE    PRV4ERX                                                          
*                                                                               
         MVI   TUV4EWRK,C'0'       SET NO S RECORDS                             
*                                                                               
         CP    UCRNSSN,=P'0'       IF SSN COUNT                                 
         BE    *+8                                                              
         MVI   TUV4EWRK,C'1'       SET S RECORDS TO FOLLOW                      
*                                                                               
         CLC   =C'OK',UCRSTATE     IF OKLAHOMA, DONE                            
         BE    PRV4ERX                                                          
*                                                                               
         MVI   TUV4ETAX,C'T'       TAXABLE EMPLOYER                             
*                                                                               
         CLC   =C'NC ',UCRSTATE    IF NORTH CAROLINA                            
         BNE   *+10                                                             
         MVC   TUV4ERET,=CL7'010403 ' SET REMITTER NUMBER                       
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE                                     
         BNE   PRV4ERX                                                          
         MVC   TUV4EEIN,LTZERO                                                  
         MVC   TUV4EPLC,LTZERO                                                  
         EDIT  (P4,UCRNSSN),(4,TUV4EEMP),FILL=0   TOTAL PERFS ON TAPE           
         BRAS  RE,GETEMTAX                                                      
         MVC   TUV4EWID,SVEMTAX                                                 
*                                                                               
PRV4ERX  BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
*                                                                               
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*                                                                               
PRV4DET  NTR1                                                                   
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   PRV4DET3               DON'T PUT RECORD TO TAPE                  
*                                                                               
         BRAS  RE,ADDNEG                                                        
*                                                                               
         B     XIT                 DON'T PUT RECORD TO TAPE                     
*                                                                               
PRV4DET3 CLC   =C'CA ',UCRSTATE                                                 
         BNE   PRV4DET5                                                         
*                                                                               
         GOTOR MMREFRS             MMREF, RS RECORD                             
*                                                                               
         B     PRV4DETX                                                         
*                                                                               
PRV4DET5 BRAS  RE,APRV4DET                                                      
*                                                                               
PRV4DETX BRAS  RE,PUTTAPE                                                       
*                                                                               
         B     XIT                                                              
*                                                                               
*        ROUTINE TO PUT TRAILER RECORDS ON TAPE (T AND F)                       
*                                                                               
         SPACE                                                                  
PRV4TRAL NTR1                                                                   
*                                                                               
         CLC   =C'MS ',UCRSTATE                                                 
         BE    PRV4TRLQ            NO TRL RECORDS FOR MISSISSIPPI               
         CLC   =C'KS ',UCRSTATE                                                 
         BE    PRV4TRLQ            NO TRL RECORDS FOR KANSAS                    
         CLC   =C'CO ',UCRSTATE                                                 
         BE    PRV4TRLQ            NO TRL RECORDS FOR COLORADO                  
         CLC   =C'NM ',UCRSTATE                                                 
         BE    PRV4TRLQ            NO TRL RECORDS FOR NEW MEXICO                
*                                                                               
         CLC   =C'CA ',UCRSTATE    IF CALIFORNIA                                
         BNE   PRV4TRL1                                                         
*                                                                               
         GOTOR MMREFRST            MMREF, RST RECORD                            
         BNE   PRV4TRLZ                                                         
*                                                                               
PRV4TRL1 MVI   TUV4ID,TUV4IDT      2ND TO LAST RECORD ON TAPE                   
*                                                                               
         EDIT  (P4,UCRNSSN),(7,TUV4TCNT),FILL=0   TOTAL PERFS ON TAPE           
*                                                                               
         CLC   =C'ND ',UCRSTATE    IF NORTH DAKOTA, SKIP UTAX                   
         BE    *+10                                                             
         CLC   =C'AL ',UCRSTATE    IF ALABAMA, SKIP UTAX                        
         BE    *+10                                                             
         MVC   TUV4TLIT,=C'UTAX'                  CONSTANT 'UTAX'               
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE                                     
         BNE   *+14                                                             
         MVC   TUV4TEAN,SV15IDZ       EMPLOYER ACCOUNT NUMBER                   
         B     PRV4TRL2                                                         
*                                                                               
         CLC   =C'OK ',UCRSTATE    IF OKLAHOMA, SKIP                            
         BE     PRV4TRL2                                                        
         CLC   =C'ND ',UCRSTATE    IF NORTH DAKOTA, SKIP                        
         BE     PRV4TRL2                                                        
         CLC   =C'IL ',UCRSTATE    IF ILLINOIS, SKIP                            
         BE     PRV4TRL2                                                        
*                                                                               
         EDIT  (P8,UCRGROSQ),(14,TUV4TWG2),FILL=0 SAME AS TUV4TWG               
*                                                                               
         CLC   =C'AL ',UCRSTATE    IF ALABAMA, DONE                             
         BE    PRV4TRLX                                                         
*                                                                               
PRV4TRL2 EDIT  (P8,UCRGROSQ),(14,TUV4TWG),FILL=0  GROSS EARN FOR QTR            
*                                                                               
         CLC   =C'OK ',UCRSTATE    IF OKLAHOMA, SKIP                            
         BE     PRV4TR2A                                                        
*                                                                               
         ZAP   DUB,UCRGROSQ                       GROSS LESS                    
         SP    DUB(8),UCRSUIWQ                    SUI EQUALS                    
         EDIT  (P8,DUB),(14,TUV4TNSU),FILL=0      NON TAX SUI FOR QTR           
*                                                                               
PRV4TR2A EDIT  (P8,UCRSUIWQ),(14,TUV4TSUI),FILL=0 TAX SUI FOR QTR               
*                                                                               
         CLC   =C'OK ',UCRSTATE    IF OKLAHOMA                                  
         BNE   PRV4TR2B                                                         
*                                                                               
         L     RF,SUIRATE          MAKE 6 DECIMALS                              
         MHI   RF,10                                                            
*                                                                               
         EDIT  (RF),(6,TUV4TERT),FILL=0       EMPLOYER TAX RATE                 
*                                                                               
         B     PRV4TRL3                                                         
*                                                                               
PRV4TR2B DS    0H                                                               
*                                                                               
         CLC   =C'ND ',UCRSTATE    SKIP IF NORTH DAKOTA                         
         BE    PRV4TRL8                                                         
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE                                     
         BE    PRV4TRL3                                                         
*                                                                               
         EDIT  SUIRATE,(6,TUV4TERT),5,FILL=0       EMPLOYER TAX RATE            
*                                                                               
         CLC   =C'TX ',UCRSTATE    IF TEXAS                                     
         BNE   *+14                                                             
         MVC   TUV4TCTY,=C'225'    COUNTY CODE FOR HOUSTON                      
         B     PRV4TRL5            REST IS BLANKS                               
*                                                                               
         MVC   TUV4TTIP,LTZERO                    TIP INCOME-NOT USED           
*&&DO                                                                           
         CLC   =C'CA ',UCRSTATE                    FOR CA ONLY                  
         BNE   PRV4TRL3                                                         
         EDIT  (P8,UCRGROSQ),(14,TUV4TPIT),FILL=0  QTR PIT WAGES                
         EDIT  (P8,UCRTAXQ),(14,TUV4TPTW),FILL=0   PER INC TAX W/HELD           
*&&                                                                             
PRV4TRL3 CLC   =C'PA ',UCRSTATE                    FOR PA ONLY                  
         BNE   PRV4TR40                                                         
         MVC   TUV4TART,=C'0011'                   EMP'E ASSSESMENT RT          
         MVC   FULL,=F'110'                        ASSESS RATE TIMES            
         ZAP   DUB,UCRGROSQ                        TOTAL WAGES                  
         BRAS  RE,CALCDUE                          = EMP'EE ASSESSMENT          
         EDIT  (P8,DUB),(11,TUV4TASS),FILL=0       AMT RETURNED                 
*                                                                               
PRV4TR40 CLC   =C'KY ',UCRSTATE    IF KENTUCKY, SURCHARGE                       
         BNE   PRV4TRL5                                                         
         BRAS  RE,KYSURCHG                                                      
                                                                                
PRV4TRL5 CLC   =C'ME ',UCRSTATE    IF MAINE, NEED TO ADJUST CONT RATE           
         BNE   PRV4TRL6                                                         
         MVC   TUV4TASR,=C'0060'                   EMP'E ASSSESMENT RT          
         MVC   FULL,=F'60'                         ASSESS RATE TIMES            
         ZAP   DUB,UCRSUIWQ                        TOTAL WAGES                  
         BRAS  RE,CALCDUE                          = EMP'EE ASSESSMENT          
         EDIT  (P8,DUB),(11,TUV4TPRV),FILL=0       AMT RETURNED                 
         MVC   DUB3,DUB                            SAVE CSSF ASSESSMENT         
*                                                                               
         L     RE,SUIRATE       DEDUCT ASSESS RATE FROM CONT RATE               
         S     RE,FULL                                                          
         EDIT  (RE),(4,TUV4TCRT),5,FILL=0          CONTRIBUTION RATE            
         ST    RE,FULL                             EMPLOYER TAX TIMES           
         ZAP   DUB,UCRSUIWQ                        TAX SUI FOR QTR              
         B     PRV4TRL7                                                         
*                                                                               
PRV4TRL6 MVC   FULL,SUIRATE                        EMPLOYER TAX TIMES           
         ZAP   DUB,UCRSUIWQ                        TAX SUI FOR QTR              
PRV4TRL7 BRAS  RE,CALCDUE                          =TAXES DUE                   
         EDIT  (P8,DUB),(13,TUV4TDUE),FILL=0       TOTAL PAYMENT DUE            
*                                                                               
         CLC   =C'TX ',UCRSTATE    IF TEXAS                                     
         BE    PRV4TRL8                                                         
*                                                                               
         CLC   =C'OK ',UCRSTATE    IF OKLAHOMA                                  
         BE    PRV4TRL8                                                         
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE                                     
         BNE   PRV4TR7A                                                         
         AP    DUB,UCRTAXQ         AMOUNT DUE = UC CONT. + TAX WITHHELD         
         AP    DUB,DUB3            + CSSF ASSESSMENT                            
*                                                                               
PRV4TR7A EDIT  (P8,DUB),(11,TUV4TPAY),FILL=0                                    
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE, DON'T FILL ZEROS                   
         BE    *+10                                                             
         MVC   TUV4TPRV,LTZERO                                                  
*                                                                               
         MVC   TUV4TINT,LTZERO                                                  
         MVC   TUV4TPEN,LTZERO                                                  
         MVC   TUV4TCRD,LTZERO                                                  
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE                                     
         BNE   PRV4TRL8                                                         
         MVC   TUV4TREM,MYSPACES                   AMOUNT REMITTED              
         MVC   TUV4TPIT,MYSPACES                                                
***      EDIT  (P8,UCRGROSQ),(14,TUV4TPIT),FILL=0  QTR PIT WAGES                
         EDIT  (P8,UCRTAXQ),(14,TUV4TPTW),FILL=0   PER INC TAX W/HELD           
         EDIT  (P8,UCRTAXQ),(11,TUV4TPEN),FILL=0   PER INC TAX W/HELD           
*                                                                               
PRV4TRL8 DS    0H                                                               
*                                                                               
         CLC   =C'OK ',UCRSTATE    IF OKLAHOMA                                  
         BE    *+10                                                             
         CLC   =C'ND ',UCRSTATE    IF NORTH DAKOTA                              
         BE    *+10                                                             
         CLC   =C'NC ',UCRSTATE    IF NORTH CAROLINA                            
         BNE    PRV4TR81                                                        
*                                                                               
         EDIT  (P3,NMONTH1),(7,TUV4TMN1),FILL=0   PERFS FOR MONTH 1             
         EDIT  (P3,NMONTH2),(7,TUV4TMN2),FILL=0   PERFS FOR MONTH 2             
         EDIT  (P3,NMONTH3),(7,TUV4TMN3),FILL=0   PERFS FOR MONTH 3             
*                                                                               
         CLC   =C'NC ',UCRSTATE    IF NORTH CAROLINA                            
         BE     PRV4TR82                                                        
*                                                                               
         B     PRV4TRLX               REST IS BLANKS                            
*                                                                               
PRV4TR81 EDIT  (P4,UCRNMTH1),(7,TUV4TMN1),FILL=0   PERFS FOR MONTH 1            
         EDIT  (P4,UCRNMTH2),(7,TUV4TMN2),FILL=0   PERFS FOR MONTH 2            
         EDIT  (P4,UCRNMTH3),(7,TUV4TMN3),FILL=0   PERFS FOR MONTH 3            
*                                                                               
PRV4TR82 DS    0H                                                               
*                                                                               
         CLC   =C'OK ',UCRSTATE    IF OKLAHOMA                                  
         BE    PRV4TRLX               REST IS BLANKS                            
*                                                                               
         CLC   =C'TX ',UCRSTATE    IF TEXAS                                     
         BE    PRV4TRLX               REST IS BLANKS                            
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE                                     
         BNE   PRV4TRL9                                                         
*                                                                               
         EDIT  (P4,UCRNFMT1),(7,TUV4TFM1),FILL=0   FEMALES - MONTH 1            
         EDIT  (P4,UCRNFMT2),(7,TUV4TFM2),FILL=0   FEMALES - MONTH 2            
         EDIT  (P4,UCRNFMT3),(7,TUV4TFM3),FILL=0   FEMALES - MONTH 3            
         B     PRV4TRLX                                                         
*                                                                               
PRV4TRL9 CLC   =C'IL ',UCRSTATE    IF ILLINOIS                                  
         BNE   PRV4TR10                                                         
         MVC   TUV4TQTR,RPTMMYR4   SET MMCCYY OF REPORTING PERIOD               
         MVC   TUV4CNT2,LTZERO     FILL WITH ZEROS                              
         MVI   TUV4CNT2+9,C'1'     CONTROL NUMBER                               
         MVC   TUV4TACC,SV15IDZ    STATE UNEMP INS ACCT NUMBER                  
         MVC   TUV4TWG2,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4TASR(11),LTZERO FILL WITH ZEROS                              
         MVC   TUV4TASS,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4TREM,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4TPIT,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4TPTW,LTZERO     FILL WITH ZEROS                              
         B     PRV4TRLX                                                         
*                                                                               
PRV4TR10 MVC   TUV4CNTL,LTZERO                     CONTROL NUMBER               
         MVI   TUV4CNTL+8,C'1'                                                  
*                                                                               
PRV4TRLX BRAS  RE,PUTTAPE                                                       
*                                                                               
         CLC   =C'OK ',UCRSTATE    SKIP IF OKLAHOMA                             
         BE    *+10                                                             
         CLC   =C'ND ',UCRSTATE    SKIP IF NORTH DAKOTA                         
         BE    PRV4TRLQ                                                         
*                                                                               
         BRAS  RE,MVCSPACE         PRECLEAR TAPE AREA TO SPACES                 
*                                                                               
         MVI   TUV4ID,TUV4IDF      LAST RECORD ON TAPE                          
*                                                                               
         EDIT  (P4,UCRNSSN),(10,TUV4FCNT),FILL=0  TOTAL 'S' RECORDS             
*                                                                               
         CLC   =C'AL ',UCRSTATE    IF ALABAMA, DONE                             
         BE    PRV4TRLZ                                                         
*                                                                               
         MVC   TUV4FCN2,LTZERO     TOTAL 'E' RECORDS ON TAPE                    
         MVI   TUV4FCN2+9,C'1'                                                  
         MVC   TUV4FLIT,=C'UTAX'   CONSTANT 'UTAX'                              
*                                                                               
         CLC   =C'IL ',UCRSTATE    IF ILLINOIS, SKIP                            
         BNE   PRV4TRF1                                                         
*                                                                               
         MVC   TUV4FWG2,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4FZER,LTZERO     FILL WITH ZEROS                              
*                                                                               
         B     PRV4TRF2                                                         
*                                                                               
PRV4TRF1 EDIT  (P8,UCRGROSQ),(15,TUV4FWG2),FILL=0 SAME AS TUV4FWG               
PRV4TRF2 EDIT  (P8,UCRGROSQ),(15,TUV4FWG),FILL=0  GROSS EARN FOR QTR            
         EDIT  (P8,UCRSUIWQ),(15,TUV4FSUI),FILL=0 TAX SUI FOR QTR               
         ZAP   DUB,UCRGROSQ                       GROSS LESS                    
         SP    DUB(8),UCRSUIWQ                    SUI EQUALS                    
         EDIT  (P8,DUB),(15,TUV4FNSU),FILL=0      NON TAX SUI FOR QTR           
*                                                                               
         CLC   =C'IL ',UCRSTATE    IF ILLINOIS, SKIP                            
         BE     PRV4TRLZ                                                        
*                                                                               
         MVC   TUV4FTIP,LTZERO                    TIP INCOME-NOT USED           
*                                                                               
         CLC   =C'NC ',UCRSTATE    IF NORTH CAROLINA                            
         BNE    PRV4TRLY                                                        
*                                                                               
         EDIT  (P3,NMONTH1),(8,TUV4FMN1),FILL=0   PERFS FOR MONTH 1             
         EDIT  (P3,NMONTH2),(8,TUV4FMN2),FILL=0   PERFS FOR MONTH 2             
         EDIT  (P3,NMONTH3),(8,TUV4FMN3),FILL=0   PERFS FOR MONTH 3             
*                                                                               
         B     PRV4TRLZ               REST IS BLANKS                            
*                                                                               
PRV4TRLY DS    0H                                                               
*                                                                               
         EDIT  (P4,UCRNMTH1),(8,TUV4FMN1),FILL=0  PERFS FOR MONTH 1             
         EDIT  (P4,UCRNMTH2),(8,TUV4FMN2),FILL=0  PERFS FOR MONTH 2             
         EDIT  (P4,UCRNMTH3),(8,TUV4FMN3),FILL=0  PERFS FOR MONTH 3             
*                                                                               
PRV4TRLZ BRAS  RE,PUTTAPE                                                       
PRV4TRLQ B     XIT                                                              
         EJECT                                                                  
*              ROUTINE TO DO VERSION FIVE TAPE                                  
*              CURRENTLY FOR MICHIGAN ONLY                                      
*                                                                               
         USING TUVER5D,R4                                                       
         USING UCRD,R3                                                          
PRVER5   NTR1                                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPACE         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BAS   RE,PRV5EREC         PROCESS E RECORD                             
         B     XIT                                                              
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   XIT                                                              
         BAS   RE,PRV5DET          PROCESS S RECORDS                            
         B     XIT                                                              
         SPACE 2                                                                
*              ROUTINE TO PUT FIRST RECORD ON TAPE                              
         SPACE                                                                  
PRV5EREC NTR1                                                                   
         MVI   TUV5ID,TUV5IDE      E - 1ST RECORD ON TAPE                       
*                                                                               
         MVC   TUV5EUAC,SVID       (STATE) ACCOUNT NUMBER                       
         MVC   TUV5EUMU,SVID+L'TUV5EUAC    MULTI=UNIT NUMBER                    
         MVC   TUV5EYR,RYEAR               YEAR (CCYY)                          
         EDIT  QQUART,TUV5EQTR             QUARTER                              
         EDIT  (P4,UCRNSSN),(7,TUV5ENOE),FILL=0   TOTAL PERFS ON TAPE           
         EDIT  (P8,UCRGROSQ),(13,TUV5EWGS),FILL=0  GROSS EARN FOR QTR           
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         SPACE 2                                                                
*              ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                           
         SPACE                                                                  
PRV5DET  NTR1                                                                   
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   PRV5DET3            DON'T PUT RECORD TO TAPE                     
         BRAS  RE,ADDNEG                                                        
         B     XIT                 DON'T PUT RECORD TO TAPE                     
*                                                                               
PRV5DET3 MVI   TUV5ID,TUV5IDS      S - INDIVIDUAL RECORDS                       
*                                                                               
         MVC   TUV5SEAC,SVID       (STATE) ACCOUNT NUMBER                       
         MVC   TUV5SEMU,SVID+L'TUV5EUAC    MULTI=UNIT NUMBER                    
         MVC   TUV5SSSN,UCRSSN     SS NUMBER                                    
         MVC   TUV5SNML,W4LAST     LAST NAME                                    
         MVC   TUV5SNMF,W4FRST     FIRST NAME                                   
         MVC   TUV5SNMM,W4MID      MIDDLE NAME                                  
*                                                                               
         MVC   TUV5SYR,RYEAR       YEAR                                         
         EDIT  QQUART,TUV5EQTR     QUARTER                                      
         EDIT  (P8,UCRGROSQ),TUV5SGRS,FILL=0 GRS EARNINGS FOR QTR               
         MVI   TUV5SSTA,C' '       EMPLOYEE STATUS LEFT BLANK                   
                                                                                
         BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO VERSION 6 TAPE                                           
*        CURRENTLY FOR WASHINGTON ONLY                                          
*======================================================================         
PRVER6   NTR1                                                                   
         BRAS  RE,VERSION6                                                      
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO VERSION 7 TAPE                                           
*        FOR PUERTO RICO ONLY!                                                  
*======================================================================         
PRVER7   NTR1                                                                   
         BRAS  RE,VERSION7                                                      
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO VERSION 8 TAPE                                           
*        FOR GEORGIA ONLY!                                                      
*======================================================================         
PRVER8   NTR1                                                                   
         BRAS  RE,VERSION8                                                      
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO VERSION 9 TAPE                                           
*        FOR TENNESSEE ONLY!                                                    
*======================================================================         
PRVER9   NTR1                                                                   
         BRAS  RE,VERSION9                                                      
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO VERSION 10 TAPE                                          
*        FOR TENNESSEE ONLY!                                                    
*======================================================================         
*&&DO                                                                           
PRVER10  NTR1                                                                   
         BRAS  RE,VERXN10                                                       
         B     XIT                                                              
         EJECT                                                                  
*&&                                                                             
*======================================================================         
*        ROUTINE TO DO TAPE FOR MAINE                                           
*======================================================================         
PRVRME   NTR1                                                                   
         BRAS  RE,VERMETP                                                       
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO TAPE FOR ILLINOIS                                        
*======================================================================         
PRVRIL   NTR1                                                                   
         BRAS  RE,VERILTP                                                       
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO TAPE FOR NEW MEXICO                                      
*======================================================================         
PRVRNM   NTR1                                                                   
         BRAS  RE,VERNMTP                                                       
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO TAPE FOR FLORIDA                                         
*======================================================================         
PRVRFL   NTR1                                                                   
         BRAS  RE,VERFLTP                                                       
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO TAPE FOR HAWAII                                          
*======================================================================         
PRVRHI   NTR1                                                                   
         BRAS  RE,VERHITP                                                       
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO TAPE FOR RHODE ISLAND                                    
*======================================================================         
PRVRRI   NTR1                                                                   
         BRAS  RE,VERRITP                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO TAPE FOR PENNSYLVANIA                                    
*======================================================================         
PRVRPA   NTR1                                                                   
         BRAS  RE,VERPATP                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO TAPE FOR ALASKA                                          
*======================================================================         
PRVRAK   NTR1                                                                   
         BRAS  RE,VERAKTP                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO TAPE FOR IDAHO                                           
*======================================================================         
PRVRID   NTR1                                                                   
         BRAS  RE,VERIDTP                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO MMREF FORMAT TAPE                                        
*======================================================================         
PRVERM   NTR1                                                                   
         BRAS  RE,VERMMREF                                                      
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO ICESA FORMAT TAPE                                        
*======================================================================         
PRVERICE NTR1                                                                   
         BRAS  RE,VERICESA                                                      
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*              ROUTINE TO DO PG TO DISK (SEE PGDSKTAB IN TAREP1BE               
*                                        FOR VALID UNITS)                       
*======================================================================         
         USING UCRD,R3                                                          
         USING TUPGDSKD,R4                                                      
PRPGDISK NTR1                                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPACE                                                      
*                                                                               
         CLI   UCRTYPE,UCRTDET     DETAIL RECORD                                
         BNE   PGDISKX                                                          
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   PGDISK3             DON'T PUT TO TAPE                            
         BRAS  RE,ADDNEG                                                        
         B     PGDISKX             DON'T PUT TO TAPE                            
*                                                                               
PGDISK3  MVC   TUDPGCD,=C'44'      RECORD CODE                                  
         MVC   TUDPGCO,=C'7 '      PG CODE                                      
         MVC   TUDPGST,TGTANUM     STATE CODE                                   
         EDIT  (B1,UCRWEEK),(2,TUDPGWKS),ZERO=NOBLANK  WEEKS WORKED             
         MVC   TUDPGSSN,UCRSSN     SS NUMBER                                    
         MVC   TUDPGFIN,W4FRST     FIRST NAME INITIAL                           
         MVC   TUDPGNAM(L'W4LAST),W4LAST LAST NAME                              
*                                                                               
         LA    R1,6                6 FIELDS OF CHARACTER ZEROES                 
         LA    R2,TUDPGZER                                                      
PGDISK5  MVC   0(L'TUDPGZER,R2),=9C'0'                                          
         LA    R2,L'TUDPGZER(R2)                                                
         BCT   R1,PGDISK5                                                       
         EDIT  (P8,UCRGROSQ),(9,TUDPGWAG),FILL=0                                
         MVC   TUDPGFD,FDID        FEDERAL ID NUMBER                            
         BRAS  RE,PUTTAPE                                                       
*                                                                               
PGDISKX  B     XIT                                                              
         EJECT                                                                  
*              ROUTINE TO DO DISK FOR CA (ALL EMPLOYERS)                        
*                                                                               
         USING UCRD,R3                                                          
         USING TUCADSKD,R4                                                      
PRCADISK NTR1                                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPACE                                                      
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BAS   RE,PRCAHEAD         PROCESS 1A,2A,1E,2E RCORDS                   
         B     PRCADSKX                                                         
         SPACE 1                                                                
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   *+12                                                             
         BAS   RE,PRCADET          PROCESS 1S,2S RECORDS                        
         B     PRCADSKX                                                         
         SPACE 1                                                                
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   PRCADSKX                                                         
         BAS   RE,PRCATRAL         PROCESS 1ST RECORDS                          
*                                                                               
PRCADSKX B     XIT                                                              
         EJECT                                                                  
*              HEADER RECORDS FOR CA TO DISK (1A,2A,1E,2E)                      
         SPACE 1                                                                
PRCAHEAD NTR1                                                                   
         MVI   TUCAID,TUCAID1Q     1A                                           
         MVI   TUCAID2,TUCAIDAQ                                                 
         MVC   TUCATRNM(L'NAMEFLD),NAMEFLD     TRANSMITTER NAME                 
         MVC   TUCATRAD(L'EMPADDR),EMPADDR              ADDRESS                 
         BRAS  RE,PUTTAPE                                                       
         SPACE 2                                                                
         BRAS  RE,MVCSPACE                                                      
         MVI   TUCAID,TUCAID2Q     2A                                           
         MVI   TUCAID2,TUCAIDAQ                                                 
         MVC   TUCATRCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUCATRST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUCATZIP(L'TUCAEZIP),EMPZIP              ZIP CODE                
         BRAS  RE,PUTTAPE                                                       
         SPACE 2                                                                
         BRAS  RE,MVCSPACE                                                      
         MVI   TUCAID,TUCAID1Q     1E                                           
         MVI   TUCAID2,TUCAIDEQ                                                 
         MVC   TUCAEMNM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         MVC   TUCAEMAD(L'EMPADDR),EMPADDR              ADDRESS                 
         BRAS  RE,PUTTAPE                                                       
         SPACE 2                                                                
         BRAS  RE,MVCSPACE                                                      
         MVI   TUCAID,TUCAID2Q     2E                                           
         MVI   TUCAID2,TUCAIDEQ                                                 
         MVC   TUCAEMCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUCAEMST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUCAEZIP(L'TUCAEZIP),EMPZIP              ZIP CODE                
         MVI   TUCANMCD,TUCANMCS                        NAME CODE               
         BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         EJECT                                                                  
*              DETAIL RECORDS FOR CA TO DISK (1S AND 2S)                        
         SPACE 1                                                                
PRCADET  NTR1                                                                   
         CLI   UCRSIGN,C'N'               SKIP NEGATIVE AMOUNTS                 
         BNE   PRCADET3                                                         
         BRAS  RE,ADDNEG                                                        
         B     XIT                                                              
*                                                                               
PRCADET3 MVI   TUCAID,TUCAID1Q            1S                                    
         MVI   TUCAID2,TUCAIDSQ                                                 
*                                                                               
         MVC   TUCASSSN,UCRSSN            SS NUMBER                             
         MVC   TUCASNME(L'W4LASTNB),W4LASTNB  LAST NAME NO BLANKS               
         LA    R1,TUCASNME+L'TUCASNME                                           
         BAS   RE,SHUFFLE                 SHUFFLE BACK TO NON BLANK             
         MVC   0(L'W4FRST,R1),W4FRST      FIRST NAME                            
         MVC   TUCASCD,TGTANUM            STATE CODE                            
         MVI   TUCASWGP,TUCASWGS          WAGE PLAN 'S'                         
         BRAS  RE,PUTTAPE                                                       
         SPACE 2                                                                
         BRAS  RE,MVCSPACE                                                      
         MVI   TUCAID,TUCAID2Q            2S                                    
         MVI   TUCAID2,TUCAIDSQ                                                 
         MVC   TUCASSAC,SVID              ACCOUNT NUMBER                        
         MVC   TUCASZRO,LTZERO                                                  
         MVC   TUCASMM(L'RPTMMYR),RPTMMYR          QTR ENDING MTH/YR            
         EDIT  (P8,UCRGROSQ),(9,TUCASWG),FILL=0    GROSS EARN FOR QTR           
         EDIT  (P8,UCRGROSQ),(9,TUCASWG2),FILL=0   STATE TAX WAGES-PIT          
         EDIT  (P8,UCRTAXQ),(8,TUCASSTX),FILL=0    PER INC TAX W/HELD           
         BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         EJECT                                                                  
*        TRAILER RECORDS FOR CA TO DISK (1ST)                                   
         SPACE                                                                  
PRCATRAL NTR1                                                                   
         MVI   TUCAID,TUCAID1Q                    1ST                           
         MVI   TUCAID2,TUCAIDSQ                                                 
         MVI   TUCAID3,TUCAIDTQ                                                 
*                                                                               
         EDIT  (P4,UCRNSSN),(7,TUCASTCT),FILL=0   TOTAL PERFS ON TAPE           
         MVC   TUCASTCD,TGTANUM                   STATE CODE                    
         EDIT  (P8,UCRGROSQ),(14,TUCASTWG),FILL=0 GRS EARN FOR QTR              
         EDIT  (P8,UCRTAXQ),(14,TUCASTTX),FILL=0  PER INC TAX W/HELD            
         EDIT  (P4,UCRNMTH1),(7,TUCASTM1),FILL=0  PERFS FOR MONTH 1             
         EDIT  (P4,UCRNMTH2),(7,TUCASTM2),FILL=0  PERFS FOR MONTH 2             
         EDIT  (P4,UCRNMTH3),(7,TUCASTM3),FILL=0  PERFS FOR MONTH 3             
         EDIT  (P8,UCRGROSQ),(14,TUCASTW2),FILL=0 QTR PIT WAGES                 
         BRAS  RE,PUTTAPE                                                       
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*              PROCESS XML FILE                                                 
*                                                                               
PRXML    NTR1                                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPACE         PRESET TAPE AREA TO SPACES                   
                                                                                
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   PRXML2                                                           
         GOTO1 =A(PRXMLPRC),DMCB,(1,0)   PROCESS HEADER TAGS                    
         J     XIT                                                              
                                                                                
PRXML2   CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   PRXML3                                                           
         GOTO1 =A(PRXMLPRC),DMCB,(2,0)   PROCESS EMPLOYEES                      
         J     XIT                                                              
                                                                                
PRXML3   CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   XIT                                                              
         GOTO1 =A(PRXMLPRC),DMCB,(3,0)   PROCESS TRAILER TAGS                   
                                                                                
         J     XIT                                                              
         EJECT                                                                  
*                                                                               
*        SET QUARTER NUMBER                                                     
*                                                                               
SETQNO   NTR1                                                                   
         MVI   0(R2),C'1'          QUARTER NUMBER                               
         CLI   QQUART,1                                                         
         BNH   SQXIT                                                            
         MVI   0(R2),C'2'                                                       
         CLI   QQUART,2                                                         
         BNH   SQXIT                                                            
         MVI   0(R2),C'3'                                                       
         CLI   QQUART,3                                                         
         BNH   SQXIT                                                            
         MVI   0(R2),C'4'                                                       
*                                                                               
SQXIT    B     XIT                                                              
         SPACE 2                                                                
*                                                                               
*        SET QUARTER ENDING DATE                                                
*                                                                               
SETEDTE  NTR1                                                                   
         MVC   0(6,R1),=C'MAR31/'  QUARTER ENDING MONTH                         
         CLI   QQUART,1                                                         
         BE    SEXIT                                                            
         MVC   0(6,R1),=C'JUN30/'                                               
         CLI   QQUART,2                                                         
         BE    SEXIT                                                            
         MVC   0(6,R1),=C'SEP30/'                                               
         CLI   QQUART,3                                                         
         BE    SEXIT                                                            
         MVC   0(6,R1),=C'DEC31/'                                               
*                                                                               
SEXIT    B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        GET W4 RECORD & GET PERFORMER'S ADDRESS                                
*        RETURN BLOCK(120)    - STREET ADDRESS                                  
*               BLOCK+90(30) - CITY                                             
*                                                                               
GETW4    NTR1                                                                   
         GOTO1 RECVAL,DMCB,TLW4CDQ,(X'A4',0)                                    
         BNE   GWX                                                              
         L     R4,AIO              IF NEW ADDRESS ELEMENT FOUND                 
         USING TAA2D,R4                                                         
         MVI   ELCODE,TAA2ELQ      USE IT                                       
         BAS   RE,GETEL                                                         
         BNE   GW10                                                             
         MVC   BLOCK(L'TAA2ADDR),TAA2ADDR        STREET ADDRESS                 
         GOTO1 SQUASHER,DMCB,BLOCK,90                                           
         OC    BLOCK(L'TAA2ADDR),SPACES                                         
         MVC   BLOCK+90(L'TAA2CITY),TAA2CITY     CITY                           
         OC    BLOCK+90(L'TAA2CITY),SPACES                                      
         MVC   DUB(L'TAA2ST),TAA2ST              STATE                          
         OC    DUB(L'TAA2ST),SPACES                                             
         MVC   WORK(L'TAA2ZIP),TAA2ZIP           ZIP CODE                       
         OC    WORK(L'TAA2ZIP),SPACES                                           
         B     GWX                                                              
*                                                                               
GW10     L     R4,AIO                                                           
         USING TAADD,R4                                                         
         MVI   ELCODE,TAADELQ                                                   
         BAS   RE,GETEL                                                         
         BNE   GWX                                                              
         BRAS  RE,GETADD           GET ADDRESS                                  
*                                                                               
GWX      B     XIT                                                              
         SPACE 3                                                                
*                                                                               
*        SHUFFLE BACK TO 1ST NON BLANK                                          
*                ENTRY - R1 = END OF DATA                                       
*                EXIT  - R1 = 1ST NON BLANK + 1                                 
*                                                                               
         SPACE 1                                                                
SHUFFLE  CLI   0(R1),C' '          STOP AFTER 1ST BLANK                         
         BH    SHX                                                              
         BCT   R1,SHUFFLE          BUMP TO NEXT CHAR                            
*                                                                               
SHX      LA    R1,2(R1)            LEAVE 1 BLANK                                
         BR    RE                                                               
         SPACE 2                                                                
*                                                                               
*        ROUTINE TO CHANGE THE DCB ACCORDING TO EMP/STATE                       
*        R2 = A(DCB)                                                            
*                                                                               
CHGDCB   NTR1                                                                   
         MVC   62(2,R2),DCBBSZ     SET BLOCK SIZE                               
         MVC   82(2,R2),DCBRLN     SET LRECL                                    
         B     XIT                                                              
         SPACE 3                                                                
*              ODD ROUTINES                                                     
         SPACE 1                                                                
SETSKIP  NTR1                                                                   
         MVI   FORCEHED,C'Y'                                                    
         B     XIT                                                              
         SPACE 2                                                                
SETPAGE  NTR1                                                                   
         MVI   FORCEHED,C'Y'                                                    
         MVC   PAGE,=H'1'                                                       
         B     XIT                                                              
         EJECT                                                                  
PRINTIT  NTR1                                                                   
*        CLI   ACTEQU,ACTDOWN                                                   
*        BE    XIT                                                              
         GOTO1 SPOOL,DMCB,(R8)                                                  
         MVC   P,SPACES                                                         
         MVI   SPACING,1                                                        
         B     XIT                                                              
         GETEL R4,DATADISP,ELCODE                                               
         SPACE 2                                                                
YES      SR    RC,RC                                                            
NO       LTR   RC,RC                                                            
*                                                                               
XIT      XIT1                                                                   
         EJECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
FIRSTIME DC    C'Y'                                                             
ANEGTAB  DS    A                                                                
*                                                                               
         DS    0D                                                               
FORMTAB  DS    0CL(FORMLNQ)                                                     
         DC    C'TP UT ',AL3(PRTPUT-TA2BUC)                                     
         DC    C'TP WI ',AL3(PRTPWI-TA2BUC)                                     
         DC    X'FF'                                                            
         SPACE 2                                                                
         DS    0D                                                               
LEFTTAB  DS    0CL(LEFTLNQ)                                                     
         DC    C'TP OH '                                                        
         DC    C'TP WV '                                                        
         DC    C'TP DC '                                                        
         DC    C'P+ DC '                                                        
         DC    C'PP DC '                                                        
         DC    X'FF'                                                            
         SPACE 2                                                                
         DS    0D                                                               
BLNKTAB  DS    0CL(BLNKLNQ)                                                     
         DC    C'TP FL '                                                        
         DC    C'TP PA '                                                        
         DC    X'FF'                                                            
         SPACE 2                                                                
LTXEXZIP DC    C'-4103'                                                         
LTXEXZP2 DC    C'-4104'                                                         
LTWISC   DC    C'WISCONSIN'                                                     
LTZERO   DC    C'0000000000000000'                                              
LTUNIT   DC    C'UNIT'                                                          
LTFEIN   DC    C'FEIN:'                                                         
LTACNO   DC    C'ACCT #:'                                                       
         EJECT                                                                  
*              DCB FOR UC TO TAPE OR DISK (PRTAPE ADJ. LRECL & BLKSIZE)         
         SPACE 1                                                                
UCTAPE   DCB   DDNAME=UCTAPE,DSORG=PS,MACRF=(PM),                      X        
               RECFM=FB,LRECL=275,BUFNO=2,BLKSIZE=6875                          
UCLNQ    EQU   *-UCTAPE                                                         
*                                                                               
*              DCB FOR UCDISK DOWN (ADJUST LRECL & BLKSIZE)                     
*                                                                               
TADOWN   DCB   DDNAME=TADOWN,DSORG=PS,MACRF=(GM,PM),                   X        
               RECFM=FB,LRECL=304,BUFNO=2,BLKSIZE=7600,EODAD=NOMORE             
TALNQ    EQU   *-TADOWN                                                         
         EJECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
UTSSPP   EQU   20                  UTAH - 20 PEOPLE PER PAGE                    
WISSPP   EQU   23                  WISCONSIN - 23 PEOPLE PER PAGE               
HISSPP   EQU   14                  HAWAII - 14 PEOPLE PER PAGE                  
*                                                                               
NUMPG    DS    F                   N'PAGES ON THE REPORT                        
THPAGE   DS    H                   THIS PAGE                                    
*                                                                               
REPTOT   DS    PL8                 REPORT TOTAL                                 
PGTOT    DS    PL8                 THIS PAGES TOTALS                            
PGTOT2   DS    PL8                 " " " - SUI OR NON-TAX SUI WAGES             
PGTOT3   DS    PL8                 " " " - SDI                                  
*                                                                               
         DS    0D                                                               
DUB2     DS    PL8                                                              
TOT      DS    PL16                PACKED TOTAL                                 
         ORG   TOT                                                              
QUOTIENT DS    PL8                                                              
REMAIND  DS    PL8                                                              
*                                                                               
NPEOPLE  DS    PL3                 N'PERFORMERS                                 
NMONTH1  DS    PL3                 N'PERFORMERS IN MONTH 1                      
NMONTH2  DS    PL3                 N'PERFORMERS IN MONTH 2                      
NMONTH3  DS    PL3                 N'PERFORMERS IN MONTH 3                      
NOVERSUI DS    PL3                 N'PERFORMERS WHO EXCEEDED SUI MAX            
*                                                                               
NEGFLAG  DS    C                   FLAG - PROCESSING NEGATIVES                  
SKIPNEG  DS    C                   FLAG - SKIP ADDNEG RTN (DISK/TAPE)           
*                                                                               
COUNTER  DS    X                   NUMBER OF PEOPLE PER PAGE                    
FULLPAGE DS    X                                                                
PAGELNQ  EQU   42                  6 LINES PER INCH                             
*                                                                               
RPTMMYR  DS    CL4                 REPORTING MMYY                               
RPTMMYR4 DS    CL6                 REPORTING MMCCYY                             
*                                                                               
W4LAST   DS    CL(L'UCRLAST)       LAST NAME (CHARACTER ONLY)                   
W4LASTNB DS    CL(L'UCRLAST)       LAST NAME (CHARACTER ONLY NO BLANKS)         
W4FRST   DS    CL(L'UCRFRST)       FIRST NAME (CHARACTER ONLY)                  
W4MID    DS    CL1                 MIDDLE INITIAL                               
*                                                                               
FDID     DS    CL9                 FEDERAL EMPLOYER ID                          
SVID     DS    CL14                SAVED ID NUMBER                              
PRINTID  DS    CL14                SAVED ID NUM FOR PRINTING                    
SV15IDZ  DS    CL15                SAVED ID NUM -15 CHARS ZERO PADDED           
SV15IDB  DS    CL15                SAVED ID NUM -15 CHARS BLANK PADDED          
*                                                                               
SVEMTAX  DS    CL15                SAVED WITHHOLDING ACCOUNT ID #               
*                                                                               
EMPADDR  DS    CL30                EMPLOYER STREET ADDRESS                      
EMPCITY  DS    CL30                         CITY                                
EMPSTATE DS    CL2                          STATE                               
EMPZIP   DS    CL9                          ZIP                                 
*                                                                               
QUO      DS    XL1                                                              
REM      DS    XL1                                                              
*                                                                               
DCBRLN   DS    H                   RECORD LENGTH FOR DCB                        
DCBBSZ   DS    H                   BLOCK SIZE FOR DCB                           
DSPRTN   DS    AL3                 DISP TO TAPE ROUTINE                         
SVDCB    DS    CL100               SAVE DCB                                     
*                                                                               
HEADNAME DS    CL8                 FAKE HEADER FOR NAME                         
NAMEFLD  DS    CL36                NAME                                         
ADDRESS  DS    0CL90               ADDRESS                                      
ADDR1    DS    CL30                ADDRESS                                      
ADDR2    DS    CL30                                                             
ADDR3    DS    CL30                                                             
*                                                                               
NHRSWORK DS    XL2                 NUMBER OF HOURS WORKED                       
*                                                                               
DUB3     DS    PL8                                                              
*                                                                               
ACCUMS   DS    0H                                                               
UNTACCS  DS    CL(ACCLNQ)                                                       
NLEVELS  EQU   (*-ACCUMS)/ACCLNQ                                                
*                                                                               
DLBLOCK  DS    CL(DLCBXLX)                                                      
TAPEREC  DS    CL283                                                            
*                                                                               
         EJECT                                                                  
         DS    0H                                                               
*                                                                               
         DS    0D                                                               
         DC    C'*NEGTAB*'                                                      
NEGTAB   DS    200CL(NEGLNQ)                                                    
NEGTABX  EQU   *                                                                
NEGTLNQ  EQU   *-NEGTAB                                                         
         EJECT                                                                  
*              LITERALS FOR UNIT TOTALS                                         
*                                                                               
         SPACE 1                                                                
LITTAB   DS    0C                                                               
         DC    C'TOTAL WAGES PAID'                                              
         DC    C'NON-TAXABLE OVER'                                              
         DC    C'TAXABLE WAGES'                                                 
         DC    C'S.D.I. NON-TAXABLE OVER'                                       
         DC    C'S.D.I. TAXABLE WAGES'                                          
         DC    C'S.U.I. NON-TAXABLE OVER'                                       
         DC    C'S.U.I. TAXABLE WAGES'                                          
         DC    C'TOTAL NUMBER OF EMPLOYEES WITH REPORTED INCOME'                
         DC    C'TOTAL NUMBER OF EMPLOYEES IN FIRST MONTH'                      
         DC    C'TOTAL NUMBER OF EMPLOYEES IN SECOND MONTH'                     
         DC    C'TOTAL NUMBER OF EMPLOYEES IN THIRD MONTH'                      
         DC    C'NUMBER OF EMPLOYEES IN QUARTER THAT'                           
         DC    C'EXCEEDED'                                                      
         DC    C'FOR THE YEAR'                                                  
         DC    C'FED. U.I. NON-TAXABLE OVER'                                    
         DC    C'FED. U.I. TAXABLE WAGES'                                       
         DC    C'* CURRENT PERIOD'                                              
         DC    C'* YEAR TO DATE'                                                
         DC    C'TAX WITHHELD'                                                  
         DC    C'E.H.T. NON-TAXABLE OVER'                                       
         DC    C'E.H.T. TAXABLE WAGES'                                          
         EJECT                                                                  
*                                                                               
*              ROUTINE TO SET 15 CHARACTERS ON THE LEFT                         
*                                                                               
         USING UCRD,R3                                                          
         USING TUVER4D,R4                                                       
KYSURCHG NTR1  BASE=*,LABEL=*                                                   
         MVC   TUV4TCRT,LTZERO                                                  
         MVC   TUV4TSCH,LTZERO                                                  
                                                                                
         LA    RF,SCYRTAB                                                       
KYSCH10  CLI   0(RF),X'FF'                                                      
         JE    XIT                                                              
         CLC   RYEAR,0(RF)                                                      
         JE    KYSCH20                                                          
         AHI   RF,6                                                             
         J     KYSCH10                                                          
                                                                                
KYSCH20  XR    R2,R2                                                            
         ICM   R2,3,4(RF)          SURCHARGE RATE                               
         EDIT  (R2),(4,TUV4TCRT),0,FILL=0                                       
                                                                                
         ZAP   TOT,UCRSUIWQ        TAX SUI FOR QTR *                            
         CVD   R2,DUB2             SURCHARGE RATE                               
         MP    TOT,DUB2                                                         
         SRP   TOT,64-4,5                                                       
         ZAP   DUB,TOT+8(8)                                                     
                                                                                
         EDIT  (P8,DUB),(11,TUV4TSCH),FILL=0       TOTAL SURCHARGE DUE          
         J     XIT                                                              
*                                                                               
SCYRTAB  DS    0H                                                               
         DC    C'2013',AL2(0)                                                   
         DC    C'2014',AL2(22)     0.22%                                        
         DC    C'2015',AL2(21)     0.21%                                        
         DC    C'2016',AL2(21)                                                  
         DC    C'2017',AL2(20)     0.20%                                        
         DC    C'2018',AL2(20)                                                  
         DC    C'2019',AL2(19)     0.19%                                        
         DC    C'2020',AL2(19)                                                  
         DC    C'2021',AL2(18)     0.18%                                        
         DC    C'2022',AL2(18)                                                  
         DC    X'FF'                                                            
         DROP  R3,R4                                                            
         EJECT                                                                  
*                                                                               
*        MOVE SPACES TO RECORD (R4 POINTS TO RECORD)                            
*        (MAX - ONLY NEED 300 BYTES)                                            
MVCSPACE NTR1  BASE=*,LABEL=*                                                   
         LA    R4,TAPEIO                                                        
         MVC   0(132,R4),MYSPACES                                               
         MVC   132(132,R4),MYSPACES                                             
         MVC   264(132,R4),MYSPACES                                             
         J     XIT                                                              
         EJECT                                                                  
*              ROUTINE TO SET 15 CHARACTERS ON THE LEFT                         
         SPACE                                                                  
SET15ID  NTR1  BASE=*,LABEL=*                                                   
         MVC   SV15IDZ,LTZERO                                                   
*        MVI   BYTE,C'R'                                                        
         LA    R1,SV15IDZ                                                       
*        BAS   RE,SETID                                                         
         GOTOR SETID,DMCB,(L'SV15IDZ,SV15IDZ)                                   
*                                                                               
         MVC   SV15IDB,SPACES                                                   
*        MVI   BYTE,C'R'                                                        
         LA    R1,SV15IDB                                                       
*        BAS   RE,SETID                                                         
         GOTOR SETID,DMCB,(L'SV15IDB,SV15IDB)                                   
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DO KEEP TRACK OF TOTALS                                     
*                                                                               
PRTOT    NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC                                                      
         USING UCRD,R3                                                          
         LA    R4,UNTACCS                                                       
         USING ACCUMD,R4                                                        
         AP    NPEOPLE,=P'1'       INCREMENT N'PERFORMERS                       
         CLI   UCRMTH1,0                                                        
         BZ    *+10                                                             
         AP    NMONTH1,=P'1'                                                    
         CLI   UCRMTH2,0                                                        
         BZ    *+10                                                             
         AP    NMONTH2,=P'1'                                                    
         CLI   UCRMTH3,0                                                        
         BZ    *+10                                                             
         AP    NMONTH3,=P'1'                                                    
*        AP    NMONTH2,UCRNMTH2                                                 
*        AP    NMONTH3,UCRNMTH3                                                 
         AP    PGTOT,UCRGROSQ      THIS PAGE'S TOTAL                            
         AP    PDEARN,UCRGROSQ     TOTAL EARNINGS                               
         AP    PDTAX,UCRTAXQ       TAXES WITHHELD                               
*                                                                               
         ZAP   DUB,UCRGROSQ        GROSS EARNINGS LESS                          
         SP    DUB(8),UCRSUIWQ     SUI WAGES OR EHT WAGES                       
         AP    PDSUI,DUB           IS NON TAXABLE SUI/EHT EARNINGS              
         CLI   EXCESS,C'Y'         IF EXCESS OPTION                             
         BNE   *+10                                                             
         AP    PGTOT2,DUB          THIS PAGE'S TOTAL 2                          
*                                                                               
         ZAP   DUB,UCRGROSQ        GROSS EARNINGS LESS                          
         SP    DUB(8),UCRSDIWQ     SDI WAGES OR EHT WAGES(MASS)                 
         AP    PDSDI,DUB           IS YTD NON TAXABLE SDI/EHT EARNINGS          
*                                                                               
         CLI   SSSUI,C'Y'          OPTION TO PRINT SUI WAGES                    
         BNE   PRTOT10                                                          
         AP    PGTOT2,UCRSUIWQ     THIS PAGE'S TOTAL 2                          
         AP    PGTOT3,UCRSDIWQ     AND TOTAL 3                                  
*                                                                               
PRTOT10  ZAP   DUB,UCRGROSQ        GROSS EARNINGS LESS                          
         SP    DUB(8),UCRFUIWQ     FUI WAGES                                    
         AP    PDFUI,DUB           IS YTD NON TAXABLE FUI EARNINGS              
*                                                                               
         ZAP   DUB,UCRGROSQ        GROSS EARNINGS LESS                          
         SP    DUB(8),UCRFICWQ     FICA WAGES                                   
         AP    PDFICA,DUB          IS YTD NON TAXABLE FICA EARNINGS             
*                                                                               
         ZAP   DUB,UCRGROSQ        GROSS EARNINGS LESS                          
         SP    DUB(8),UCRMEDWQ     MEDICARE WAGES                               
         AP    PDMED,DUB           IS YTD NON TAXABLE MED EARNINGS              
*                                                                               
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RE,3,UCRHRSWK       HOURS WORKED                                 
         ICM   RF,3,NHRSWORK       TOTAL NUMBER OF HOURS                        
         AR    RF,RE                                                            
         STCM  RF,3,NHRSWORK                                                    
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        SET QUARTER ENDING MONTH                                               
*                                                                               
SETMTH   NTR1  BASE=*,LABEL=*                                                   
         ZIC   R1,QQUART                                                        
         MVC   0(2,R2),=C'03'      QUARTER ENDING MONTH                         
         CLI   QQUART,1                                                         
         BE    SMXIT                                                            
         MVC   0(2,R2),=C'06'                                                   
         CLI   QQUART,2                                                         
         BE    SMXIT                                                            
         MVC   0(2,R2),=C'09'                                                   
         CLI   QQUART,3                                                         
         BE    SMXIT                                                            
         MVC   0(2,R2),=C'12'                                                   
SMXIT    XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        SET DAY OF QUARTER ENDING MONTH                                        
*                                                                               
SETDAY   NTR1  BASE=*,LABEL=*                                                   
         MVC   0(2,R2),=C'31'                                                   
         CLI   QQUART,1                                                         
         BE    SDAYX                                                            
         CLI   QQUART,4                                                         
         BE    SDAYX                                                            
         MVC   0(2,R2),=C'30'                                                   
         B     SDAYX                                                            
SDAYX    XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        SET TALIM BLOCK                                                        
*                                                                               
SETLIM   NTR1  BASE=*,LABEL=*                                                   
         LA    R2,LIMAREA                                                       
         USING TMD,R2                                                           
         L     R3,ASORTREC                                                      
         USING UCRD,R3                                                          
*                                                                               
***      XC    0(TMLNQ,R2),0(R2)   CLEAR BLOCK                                  
         LR    RE,R2                                                            
         LH    RF,=AL2(TMLNQ)                                                   
         XCEFL                                                                  
*                                                                               
         ST    RC,TMRC             GENCON                                       
         MVC   TMEFDTE0,TGTODAY0   SET EBCDIC DATE                              
         MVC   TMEMP,UCREMP                                                     
         MVC   TMUNIT,UCRSTATE     TAX UNIT - STATE OF WORK                     
         OI    TMSTAT,TMSBSRT+TMSCHK     ONLY GET WAGE BASE/RATES               
         XIT1                                                                   
         DROP  R2                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        REMOVE BLANKS & DASHES FROM TAX ID                                     
*              BYTE   = R(IGHT)/L(EFT) PAD WITH ZEROES                          
*              TGELEM = TATI ELEMENT                                            
*              R1     = SAVED ID AREA                                           
*                                                                               
SETID    NTR1  BASE=*,LABEL=*                                                   
         L     R3,0(R1)                                                         
         XR    RF,RF                                                            
         IC    RF,0(R1)                                                         
*                                                                               
         USING TATID,R4                                                         
         L     R4,TGELEM                                                        
         LA    R1,L'TATIID                                                      
         LA    R2,TATIID                                                        
         CLI   BYTE,C'R'           IF PADDING IS ON LEFT                        
         BE    SID10                                                            
         LA    R2,L'TATIID-1(R2)     START FROM END OF ID                       
         BCTR  RF,0                                                             
         AR    R3,RF                                                            
*                                                                               
SID10    CLI   0(R2),C' '          IGNORE BLANKS                                
         BNH   SID30                                                            
         CLI   0(R2),C'-'          AND DASHES                                   
         BE    SID30                                                            
         MVC   0(1,R3),0(R2)                                                    
         CLI   BYTE,C'R'           IF PADDING IS ON RIGHT                       
         BNE   SID20                                                            
         LA    R3,1(R3)                                                         
         B     SID30                                                            
*                                                                               
SID20    BCTR  R3,0                                                             
*                                                                               
SID30    CLI   BYTE,C'R'           IF PADDING IS ON RIGHT                       
         BNE   SID40                                                            
         LA    R2,1(R2)            BUMP FORWARD                                 
         B     SID50                                                            
*                                                                               
SID40    BCTR  R2,0                ELSE BUMP BACK                               
*                                                                               
SID50    BCT   R1,SID10                                                         
*                                                                               
SIDX     XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        GET ADDRESS                                                            
*        INPUT  R4           - A(ADDRESS ELEMENT)                               
*        RETURN BLOCK        - STREET ADDRESS                                   
*               BLOCK+90     - CITY                                             
*               DUB          - STATE                                            
*               WORK         - ZIP CODE                                         
*                                                                               
         USING TAADD,R4                                                         
GETADD   NTR1  BASE=*,LABEL=*                                                   
         MVC   BLOCK(120),SPACES                                                
         MVC   WORK,SPACES                                                      
         MVC   DUB,SPACES                                                       
         LA    R3,TAADADD          A(ADDRESS)                                   
         ZIC   R2,2(R4)            N'LINES                                      
         BCTR  R2,0                                                             
         MH    R2,=H'30'                                                        
*                                                                               
         LA    R1,BLOCK                                                         
         MVC   0(30,R1),0(R3)      STREET ADDRESS                               
         LA    R1,30(R1)                                                        
         ST    R1,TGFULL                                                        
*                                                                               
GA10     LA    R4,30(R3)           NEXT LINE                                    
         GOTO1 =V(ADSCAN),DMCB,((R2),0(R4)),(30,BLOCK+90),DUB,(9,WORK)          
         CLI   0(R1),0             2 ACCEPTABLE RETURN CODES                    
         BE    GA20                                                             
         CLI   0(R1),2                                                          
         BNE   GWX                                                              
*                                                                               
GA20     CLC   BLOCK+90(30),SPACES     DID WE FIND CITY                         
         BH    GA30                                                             
         SH    R2,=H'30'           LESS 1 LINE                                  
         BNP   GA30                                                             
         LA    R3,30(R3)                                                        
         L     R1,TGFULL                                                        
         MVC   0(30,R1),0(R3)      STREET ADDRESS                               
         LA    R1,30(R1)                                                        
         ST    R1,TGFULL                                                        
         B     GA10                                                             
*                                                                               
GA30     GOTO1 SQUASHER,DMCB,BLOCK,90                                           
*                                                                               
GETADDX  XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ADD PERFORMER TO TABLE OF NEGATIVES                                    
*                                                                               
         USING UCRD,R3                                                          
ADDNEG   NTR1  BASE=*,LABEL=*                                                   
         L     R4,ANEGTAB                                                       
         USING NEGTABD,R4                                                       
         L     R1,=A(NEGTABX)                                                   
*                                                                               
AN10     OC    0(NEGLNQ,R4),0(R4)  OPEN ENTRY                                   
         BZ    AN20                                                             
         LA    R4,NEGLNQ(R4)       BUMP TABLE                                   
         CR    R4,R1                                                            
         BNH   AN10                                                             
*                                                                               
AN20     MVC   0(NEGLNQ,R4),SPACES                                              
         MVC   NSSN1,UCRSSN        SS NUMBER (FIRST 3 DIGITS)                   
         MVC   NSSN2,UCRSSN+3                 SECOND 2 DIGITS                   
         MVC   NSSN3,UCRSSN+5                 LAST 4 DIGITS                     
         MVC   NEGFIRST,UCRFRST    FIRST NAME                                   
         LA    R1,NEGLAST                                                       
         BAS   RE,SHUFFLE          SHUFFLE BACK TO NON BLANK                    
         MVC   0(16,R1),UCRLAST    LAST NAME                                    
         EDIT  (P8,UCRGROSQ),(11,NEGWAGES),2,FLOAT=-                            
         MVC   NEGAMT,UCRGROSQ     SAVE AMOUNT AS PACKED TOO                    
*                                                                               
         CLI   SSSUI,C'Y'          OPTION TO PRINT SUI WAGES                    
         BNE   *+12                                                             
         LA    R1,UCRSUIWQ                                                      
         B     AN30                                                             
         CLI   EXCESS,C'Y'         OPTION TO PRINT EXCESS (NON-TAX SUI)         
         BNE   ANX                                                              
         ZAP   DUB,UCRGROSQ                                                     
         SP    DUB,UCRSUIWQ                                                     
         LA    R1,DUB                                                           
AN30     LA    RF,NEGSUI           SAVE SUI/NON TAXABLE SUI WAGES               
         EDIT  (P8,0(R1)),(11,(RF)),2,FLOAT=-                                   
*                                                                               
ANX      XIT1                                                                   
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO DECIDE IF THIS STATE PROCESSES A TAPE/DISK                  
*        OR 941 REPORT                                                          
*                                                                               
DOTAPE   NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         USING UCRD,R3                                                          
*                                                                               
         CLI   RECNUM,UCDISK       IF UCDISK                                    
         BNE   DT70                                                             
         MVC   DSPRTN,=AL3(PRPGDISK-TA2BUC) SET APPROPRIATE DISK ROUT.          
         MVC   DCBRLN,=H'0200'                                                  
         MVC   DCBBSZ,=H'23400'                                                 
*                                                                               
         USING TAPED,R4                                                         
         LA    R4,DISKTAB          R4=A(STATES TABLE)                           
DT02A    CLI   0(R4),X'FF'         IF WE REACHED END OF TABLE                   
         BE    DTNO                THIS IS NOT A DISK                           
         MVC   DCBRLN,TAPRLN       ELSE SAVE LRECL & BLOCK SIZE                 
         MVC   DCBBSZ,TAPBSZ                                                    
         MVC   DSPRTN,TAPRTN       SET TAPE ROUTINE                             
***      CLC   TAPEMP,UCREMP       IF MATCH ON EMPLOYER                         
***      BNE   DT02B                                                            
         TM    STSTAT,STSTATIL     IF USING FL FORMAT FOR TN,                   
         BZ    DT02A3                                                           
         CLC   TAPST,=C'ILM'       LOOK FOR ILM IN TABLE FOR MONTHLY            
         BE    DTYES                                                            
         B     DT02B                                                            
DT02A3   TM    STSTAT,STSTATTN     IF USING FL FORMAT FOR TN,                   
         BZ    DT02AA                                                           
         CLC   TAPST,=C'FL '       LOOK FOR FL IN TABLE                         
         BE    DTYES                                                            
         B     DT02B                                                            
DT02AA   CLC   TAPST,UCRSTATE      AND STATE                                    
         BE    DTYES               DONE                                         
*                                                                               
DT02B    LA    R4,L'TAPETAB(R4)    ELSE, BUMP TO NEXT ENTRY IN TABLE            
         B     DT02A                                                            
*                                                                               
*        NO-OP JUNE/06 - USE DISKTAB                                            
*&&DO                                                                           
         CLC   =C'CA',UCRSTATE                                                  
         BNE   DT02                                                             
         MVC   DSPRTN,=AL3(PRVER4-TA2BUC)                                       
         MVC   DCBRLN,=H'0512'                                                  
         MVC   DCBBSZ,=H'23040'                                                 
         B     DTYES                                                            
*                                                                               
DT02     CLC   =C'FL',UCRSTATE                                                  
         BNE   DT03                                                             
         MVC   DSPRTN,=AL3(PRVER1-TA2BUC)                                       
         MVC   DCBRLN,=H'0512'                                                  
         MVC   DCBBSZ,=H'23040'                                                 
         B     DTYES                                                            
*                                                                               
DT03     CLC   =C'PR',UCRSTATE     PUERTO RICO                                  
         BNE   DT04                                                             
         MVC   DSPRTN,=AL3(PRVER7-TA2BUC)                                       
         MVC   DCBRLN,=H'80'                                                    
         MVC   DCBBSZ,=H'1600'                                                  
         B     DTYES                                                            
*                                                                               
DT04     CLC   =C'MA',UCRSTATE                                                  
         BNE   DT05                                                             
         MVC   DSPRTN,=AL3(PRVER1-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT05     CLC   =C'WA',UCRSTATE                                                  
         BNE   DT06                                                             
         MVC   DSPRTN,=AL3(PRVER6-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT06     CLC   =C'GA',UCRSTATE                                                  
         BNE   DT07                                                             
         MVC   DSPRTN,=AL3(PRVER8-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT07     CLC   =C'TN',UCRSTATE                                                  
         BNE   DT08                                                             
         MVC   DSPRTN,=AL3(PRVER9-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT08     CLC   =C'CO',UCRSTATE                                                  
         BNE   DT09                                                             
         MVC   DSPRTN,=AL3(PRVER10-TA2BUC)                                      
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT09     CLC   =C'MI',UCRSTATE                                                  
         BNE   DT10                                                             
         MVC   DSPRTN,=AL3(PRVER5-TA2BUC)                                       
         MVC   DCBRLN,=H'0072'                                                  
         MVC   DCBBSZ,=H'1440'                                                  
         B     DTYES                                                            
*                                                                               
DT10     CLC   =C'MN',UCRSTATE                                                  
         BNE   DT11                                                             
         MVC   DSPRTN,=AL3(PRVER3-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT11     CLC   =C'MD',UCRSTATE                                                  
         BNE   DT12                                                             
         MVC   DSPRTN,=AL3(PRVER4-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT12     CLC   =C'KY',UCRSTATE                                                  
         BNE   DT13                                                             
         MVC   DSPRTN,=AL3(PRVER4-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT13     CLC   =C'OR',UCRSTATE                                                  
         BNE   DT14                                                             
         MVC   DSPRTN,=AL3(PRVER1-TA2BUC)                                       
         MVC   DCBRLN,=H'0512'                                                  
         MVC   DCBBSZ,=H'23040'                                                 
         B     DTYES                                                            
*                                                                               
DT14     CLC   =C'NJ',UCRSTATE                                                  
         BNE   DT15                                                             
         MVC   DSPRTN,=AL3(PRTPNJ-TA2BUC)                                       
         MVC   DCBRLN,=H'0160'                                                  
         MVC   DCBBSZ,=H'8000'                                                  
         B     DTYES                                                            
*                                                                               
DT15     CLC   =C'WI',UCRSTATE                                                  
         BNE   DT16                                                             
         MVC   DSPRTN,=AL3(PRVER1-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT16     CLC   =C'OH',UCRSTATE                                                  
         BNE   DT17                                                             
         MVC   DSPRTN,=AL3(PRVER4-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT17     CLC   =C'UT',UCRSTATE                                                  
         BNE   DT18                                                             
         MVC   DSPRTN,=AL3(PRVER1-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*                                                                               
DT18     CLC   =C'NC',UCRSTATE                                                  
         BNE   DT19                                                             
         MVC   DSPRTN,=AL3(PRVER4-TA2BUC)                                       
         MVC   DCBRLN,=H'0276'                                                  
         MVC   DCBBSZ,=H'6900'                                                  
         B     DTYES                                                            
*                                                                               
DT19     CLC   =C'PA',UCRSTATE                                                  
         BNE   DT20                                                             
         MVC   DSPRTN,=AL3(PRVER4-TA2BUC)                                       
         MVC   DCBRLN,=H'0276'                                                  
         MVC   DCBBSZ,=H'6900'                                                  
         B     DTYES                                                            
*                                                                               
DT20     CLC   =C'NE',UCRSTATE                                                  
         BNE   DTNO                                                             
         MVC   DSPRTN,=AL3(PRVER1-TA2BUC)                                       
         MVC   DCBRLN,=H'0275'                                                  
         MVC   DCBBSZ,=H'6875'                                                  
         B     DTYES                                                            
*&&                                                                             
*                                                                               
         USING TAPED,R4                                                         
DT70     LA    R4,TAPETAB          R4=A(STATES TABLE)                           
DT80     CLI   0(R4),X'FF'         IF WE REACHED END OF TABLE                   
         BE    DTNO                THIS IS NOT A TAPE                           
         MVC   DCBRLN,TAPRLN       ELSE SAVE LRECL & BLOCK SIZE                 
         MVC   DCBBSZ,TAPBSZ                                                    
         MVC   DSPRTN,TAPRTN       SET TAPE ROUTINE                             
         CLC   TAPEMP,UCREMP       IF MATCH ON EMPLOYER                         
         BNE   DT90                                                             
         CLC   TAPST,UCRSTATE      AND STATE                                    
         BE    DTYES               DONE                                         
*                                                                               
DT90     LA    R4,L'TAPETAB(R4)    ELSE, BUMP TO NEXT ENTRY IN TABLE            
         B     DT80                                                             
*                                                                               
DTYES    CR    RB,RB                                                            
         B     DTXIT                                                            
DTNO     LTR   RB,RB                                                            
DTXIT    XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
         DS    0H                                                               
TAPETAB  DS    0CL(TAPLNQ)                                                      
*        DC    C'TP CA ',H'0512',H'23040',AL1(0),AL3(PRVER4-TA2BUC)             
*        DC    C'TP CT ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
*        DC    C'TP GA ',H'0275',H'6875',AL1(0),AL3(PRVER8-TA2BUC)              
*        DC    C'TP HI ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
*        DC    C'PP IL ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
*        DC    C'TP IL ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
*        DC    C'TP PA ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
*        DC    C'TP PR ',H'0080',H'1600',AL1(0),AL3(PRVER7-TA2BUC)              
*        DC    C'TP TX ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
*        DC    C'TP NC ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
*        DC    C'TP UT ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
*        DC    C'TP MA ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
*        DC    C'TP NJ ',H'0160',H'8000',AL1(0),AL3(PRTPNJ-TA2BUC)              
*        DC    C'PG NJ ',H'0160',H'8000',AL1(0),AL3(PRTPNJ-TA2BUC)              
*        DC    C'TP OH ',H'0275',H'6875',AL1(0),AL3(PRTPOH-TA2BUC)              
*        DC    C'TP OR ',H'0512',H'23040',AL1(0),AL3(PRVER1-TA2BUC)             
*        DC    C'TP WI ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
*   NOTE MD & MN CAN'T HANDLE 276/6900 YET (MAYBE IN THE YEAR 2000)             
*        DC    C'TP MD ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
*        DC    C'TP MN ',H'0275',H'6875',AL1(0),AL3(PRVER3-TA2BUC)              
*        DC    C'TP CO ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
*        DC    C'TP FL ',H'0512',H'23040',AL1(0),AL3(PRVER1-TA2BUC)             
*        DC    C'TP MI ',H'0072',H'1440',AL1(0),AL3(PRVER5-TA2BUC)              
*        DC    C'TP TN ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
*        DC    C'TP WA ',H'0275',H'6875',AL1(0),AL3(PRVER6-TA2BUC)              
         DC    X'FF'                                                            
         EJECT                                                                  
*        ROUTINE TO PUT THIRD RECORD ON TAPE                                    
         DS    0H                                                               
DISKTAB  DS    0CL(TAPLNQ)                                                      
         DC    C'TP AK ',H'0128',H'5120',AL1(0),AL3(PRVRAK-TA2BUC)              
         DC    C'TP ID ',H'0128',H'5120',AL1(0),AL3(PRVRID-TA2BUC)              
*        DC    C'TP CA ',H'0512',H'23040',AL1(0),AL3(PRVER4-TA2BUC)             
         DC    C'TP CA ',H'0132',H'1320',AL1(0),AL3(PRXML-TA2BUC)               
         DC    C'TP DC ',H'0512',H'23040',AL1(0),AL3(PRVER1-TA2BUC)             
*        DC    C'TP FL ',H'0275',H'6875',AL1(0),AL3(PRVRFL-TA2BUC)              
         DC    C'TP FL ',H'0304',H'7600',AL1(0),AL3(PRVRFL-TA2BUC)              
         DC    C'TP PR ',H'0150',H'7500',AL1(0),AL3(PRVER7-TA2BUC)              
*****    DC    C'TP MA ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
         DC    C'TP MA ',H'0274',H'6850',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP WA ',H'0275',H'6875',AL1(0),AL3(PRVER6-TA2BUC)              
         DC    C'TP GA ',H'0275',H'6875',AL1(0),AL3(PRVER8-TA2BUC)              
         DC    C'TP TN ',H'0058',H'6960',AL1(0),AL3(PRVERICE-TA2BUC)            
         DC    C'TP CO ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP MI ',H'0072',H'1440',AL1(0),AL3(PRVER5-TA2BUC)              
         DC    C'TP MN ',H'0275',H'6875',AL1(0),AL3(PRVER3-TA2BUC)              
         DC    C'TP MD ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP KY ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP OR ',H'0512',H'23040',AL1(0),AL3(PRVER1-TA2BUC)             
         DC    C'TP NJ ',H'0160',H'8000',AL1(0),AL3(PRTPNJ-TA2BUC)              
         DC    C'PG NJ ',H'0160',H'8000',AL1(0),AL3(PRTPNJ-TA2BUC)              
         DC    C'TP WI ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
         DC    C'TP OH ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP UT ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
         DC    C'TP NC ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
**OLD    DC    C'TP PA ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP PA ',H'0128',H'5120',AL1(0),AL3(PRVRPA-TA2BUC)              
         DC    C'TP NE ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
         DC    C'TP WV ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
****     DC    C'TP ME ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP ME ',H'0275',H'6875',AL1(0),AL3(PRVRME-TA2BUC)              
         DC    C'TP NM ',H'0274',H'6850',AL1(0),AL3(PRVER4-TA2BUC)              
**OLD    DC    C'TP NM ',H'0283',H'7075',AL1(0),AL3(PRVRNM-TA2BUC)              
         DC    C'TP TX ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP KS ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP LA ',H'0512',H'23040',AL1(0),AL3(PRVERM-TA2BUC)             
         DC    C'TP HI ',H'0275',H'6875',AL1(0),AL3(PRVRHI-TA2BUC)              
         DC    C'TP CT ',H'0275',H'6875',AL1(0),AL3(PRVER1-TA2BUC)              
         DC    C'PP IL ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP IL ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP ND ',H'0276',H'6900',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP RI ',H'0276',H'6900',AL1(0),AL3(PRVRRI-TA2BUC)              
         DC    C'TP AL ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP VA ',H'0512',H'23040',AL1(0),AL3(PRVERM-TA2BUC)             
         DC    C'TP MS ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP OK ',H'0275',H'6875',AL1(0),AL3(PRVER4-TA2BUC)              
         DC    C'TP SC ',H'0512',H'23040',AL1(0),AL3(PRVERM-TA2BUC)             
         DC    C'TP ILM',H'0058',H'6960',AL1(0),AL3(PRVRIL-TA2BUC)              
         DC    X'FF'                                                            
         EJECT                                                                  
*                                                                               
         USING TUVER1D,R4                                                       
         USING UCRD,R3                                                          
PRV1EREC NTR1  BASE=*,LABEL=*                                                   
         CLC   =C'FL ',UCRSTATE    IF FLORIDA                                   
         BE    *+10                                                             
         CLC   =C'OR ',UCRSTATE    IF OREGON                                    
         BNE   PRV1ER0                                                          
         GOTOR MMREFRE             MMREF, RE RECORD                             
         B     PRV1ERX                                                          
*                                                                               
PRV1ER0  BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
         MVI   TUV1ID,TUV1IDE      E - 3RD RECORD ON TAPE                       
         CLC   =C'WI ',UCRSTATE    IF WISCONSIN                                 
         BE    PRV1ER1                                                          
         CLC   =C'HI ',UCRSTATE    IF HAWAII                                    
         BE    *+10                                                             
         CLC   =C'UT ',UCRSTATE    IF UTAH                                      
         BE    *+10                                                             
         CLC   =C'WA ',UCRSTATE    IF WASHINGTON                                
         BNE   *+14                                                             
         MVC   TUV1EPER(L'RYEAR),RYEAR     SET REPORTING YEAR - CCYY            
         B     *+10                                                             
         MVC   TUV1EPER(L'RPTMMYR),RPTMMYR    ELSE, QTR MTH/RPT YR              
*                                                                               
PRV1ER1  MVC   TUV1EEID(L'FDID),FDID           EMPLOYER #                       
         CLC   =C'WI ',UCRSTATE                                                 
         BE    PRV1ER50                                                         
         CLC   =C'NE ',UCRSTATE                                                 
         BE    PRV1ER50                                                         
         MVC   TUV1EENM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         LA    R2,TUV1EQTR                     QUARTER                          
         BAS   RE,SETQNO                                                        
         MVC   TUV1EYR,TUV1EYY                 YEAR                             
*                                                                               
PRV1ER15 CLC   =C'HI ',UCRSTATE                                                 
         BE    PRV1ER50                                                         
         MVC   TUV1EEAD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUV1EECT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUV1EEST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUV1EZIP(L'EMPZIP),EMPZIP                ZIP CODE                
         MVC   TUV1EZP2,LTXEXZIP                        EXTENDED ZIP            
*                                                                               
PRV1ER16 CLC   UCRSTATE,=C'CT '    CONNETICUT WANTS ZIP REVERSED                
         BNE   PRV1ER30                                                         
         MVC   TUV1EZIP,LTXEXZIP                                                
         MVI   TUV1EZIP,C'-'                                                    
         MVC   TUV1EZP2,EMPZIP                                                  
         MVI   TUV1EEMT,C'R'                                                    
         MVC   TUV1EUCN,SVID                                                    
         B     PRV1ER30                                                         
*                                                                               
PRV1ER30 MVI   TUV1ENCD,C'S'       NAME CODE                                    
         MVC   TUV1EBF,=C'25'      BLOCKING FACTOR                              
         MVC   TUV1ESTC,TGTANUM    STATE CODE                                   
*                                                                               
         CLC   UCRSTATE,=C'UT '    UTAH ONLY WANTS ZIP IN ZIP EXT FLD           
         BNE   PRV1ER40                                                         
         MVC   TUV1EZIP,SPACES                                                  
         MVC   TUV1EZP2,EMPZIP                                                  
         MVI   TUV1EEMT,C'R'                                                    
         MVC   TUV1EUUT,SVID                                                    
         B     PRV1ERX                                                          
*                                                                               
PRV1ER40 CLC   =C'CT ',UCRSTATE                                                 
         BE    PRV1ERX                                                          
         MVC   TUV1EUNN,LTZERO                                                  
         MVC   TUV1ESAC,SVID       ACCOUNT #                                    
         MVC   TUV1EZER,LTZERO                                                  
         B     PRV1ERX                                                          
*                                                                               
PRV1ER50 MVI   TUV1ENCD,C'S'       NAME CODE                                    
         MVC   TUV1ESTC,TGTANUM    STATE CODE                                   
*                                                                               
         CLC   =C'NE ',UCRSTATE                                                 
         BNE   PRV1ER55                                                         
         MVC   TUV1EZR2,LTZERO                                                  
         MVC   TUV1ESA3,SVID       ACCOUNT # (FOR 10 LEFT ZEROS)                
         B     PRV1ER60                                                         
*                                                                               
PRV1ER55 MVC   TUV1ESA2,SVID       ACCOUNT # (FOR 10)                           
         CLC   =C'WI ',UCRSTATE                                                 
         BNE   PRV1ERX                                                          
         MVC   TUV1ERCC,=C'01'                                                  
PRV1ER60 MVI   TUV1ETTC,C'B'                                                    
*                                                                               
PRV1ERX  XIT1                                                                   
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT VERSION 3 RECORD ON TAPE                                
*======================================================================         
         USING TUVER3D,R4                                                       
         USING UCRD,R3                                                          
VERSION3 NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTDET     ONLY DETAIL RECORDS                          
         BNE   VER3X                                                            
         CLI   UCRSIGN,C'N'        DON'T SAVE NEGATIVES                         
         BNE   VER3A                                                            
         BRAS  RE,ADDNEG                                                        
         B     VER3X                                                            
*                                                                               
VER3A    MVI   TUV3ID,TUV4IDS      S - INDIVIDUAL RECORDS                       
         MVC   TUV3SSSN,UCRSSN     SS NUMBER                                    
         MVC   TUV3SNML(L'W4LAST),W4LAST LAST NAME                              
         MVC   TUV3SNMF(L'W4FRST),W4FRST FIRST NAME                             
         MVC   TUV3SSTC,TGTANUM    STATE CODE                                   
         EDIT  (P8,UCRGROSQ),(14,TUV3SWG),FILL=0 GRS EARNINGS FOR QTR           
         MVC   TUV3SLT2,=C'UTAX'   CONSTANT 'UTAX'                              
         MVC   TUV3SSA2,SV15IDB    UNEMPLOYMENT INSURANCE ACCT NUMBER           
         MVC   TUV3SPLN,=C'0000'   PLANT CODE                                   
         MVI   TUV3SOFF,C'0'       OFFICER CODE                                 
         MVC   TUV3SMN1(3),=C'000'                                              
         OC    TUV3SMN1,UCRMTH1    WORKED IN MONTH INDICATOR                    
         OC    TUV3SMN2,UCRMTH2    WORKED IN MONTH INDICATOR                    
         OC    TUV3SMN3,UCRMTH3    WORKED IN MONTH INDICATOR                    
         MVC   TUV3SQTR,RPTMMYR4   QTR END MTH/YEAR                             
*                                                                               
         EDIT  UCRHRSWK,(3,TUV3SHRS),0,ZERO=NOBLANK,FILL=0    HOURS             
         MVI   TUV3EOL,C'X'        EOL INDICATOR                                
         BRAS  RE,PUTTAPE                                                       
*                                                                               
VER3X    XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        DETAIL RECORD                                                          
*======================================================================         
         USING TUVER4D,R4                                                       
         USING UCRD,R3                                                          
APRV4DET NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVI   TUV4ID,TUV4IDS      S - INDIVIDUAL RECORDS                       
         MVC   TUV4SSSN,UCRSSN     SS NUMBER                                    
         MVC   TUV4SNML(L'W4LAST),W4LAST LAST NAME                              
         MVC   TUV4SNMF,W4FRST     FIRST NAME                                   
*                                                                               
         CLC   =C'AL ',UCRSTATE    IF ALABAMA                                   
         BE    APR4DT5                                                          
         CLC   =C'ND ',UCRSTATE    IF NORTH DAKOTA                              
         BE    APR4DT5                                                          
         CLC   =C'KS ',UCRSTATE    IF KANSAS                                    
         BE    APR4DT5                                                          
         CLC   =C'MA ',UCRSTATE    IF MASSACHUSETTS                             
         BE    APR4DT5                                                          
         CLC   =C'MS ',UCRSTATE    IF MISSISSIPPI                               
         BE    APR4DT5                                                          
         CLC   =C'OK ',UCRSTATE    IF OKLAHOMA                                  
         BNE   APR4DT8                                                          
*                                                                               
APR4DT5  MVC   TUV4SNMM,W4MID      MIDDLE INITIAL                               
*                                                                               
         CLC   =C'KS ',UCRSTATE    SKIP IF KANSAS                               
         BE    APR4DT10                                                         
*                                                                               
APR4DT8  DS    0H                                                               
*                                                                               
         CLC   =C'MA ',UCRSTATE    SKIP IF MASSACHUSETTS                        
         BE    *+10                                                             
         MVC   TUV4SSTC,TGTANUM    STATE CODE                                   
*                                                                               
         CLC   =C'NM ',UCRSTATE    IF NEW MEXICO, OR                            
         BE    *+14                                                             
         CLC   =C'MA ',UCRSTATE    IF MASSACHUSETTS                             
         BNE   *+8                                                              
         MVI   TUV4SARC,C'0'       ADJUSTMENT REASON CODE - ORIGINAL            
*                                                                               
         CLC   =C'ND ',UCRSTATE    SKIP IF NORTH DAKOTA                         
         BE    *+10                                                             
         CLC   =C'CO ',UCRSTATE    SKIP IF COLORADO                             
         BE    *+10                                                             
         CLC   =C'MA ',UCRSTATE    SKIP IF MASSACHUSETTS                        
         BE    *+10                                                             
         CLC   =C'NM ',UCRSTATE    SKIP IF NEW MEXICO                           
         BE    *+10                                                             
         CLC   =C'IL ',UCRSTATE    SKIP IF ILLINOIS                             
         BE    *+10                                                             
         CLC   =C'MD ',UCRSTATE    SKIP IF MARYLAND                             
         BE    *+10                                                             
         CLC   =C'MS ',UCRSTATE    SKIP IF MISSISSIPPI                          
         BE    *+10                                                             
         CLC   =C'OK ',UCRSTATE    SKIP IF OKLAHOMA                             
         BE    *+10                                                             
         MVC   TUV4SPER(L'RPTMMYR),RPTMMYR QTR END MTH/YEAR                     
*                                                                               
         CLC   =C'ME ',UCRSTATE    IF MAINE                                     
         BNE   *+14                USE 4 CHARACTER YEAR                         
         MVC   TUV4SPER(L'RPTMMYR4),RPTMMYR4                                    
         B     APR4DT10                                                         
*                                                                               
         CLC   =C'ND ',UCRSTATE    SKIP IF NORTH DAKOTA                         
         BE    APR4DT10                                                         
*                                                                               
         CLC   =C'OK ',UCRSTATE    SKIP IF OKLAHOMA                             
         BE    APR4DT10                                                         
*                                                                               
         CLC   =C'MS ',UCRSTATE    SKIP IF MISSISSIPPI                          
         BE    APR4DT8A                                                         
*                                                                               
         CLC   =C'CO ',UCRSTATE    SKIP IF COLORADO                             
         BE    APR4DT9                                                          
*                                                                               
         CLC   =C'IL ',UCRSTATE    IF ILLINOIS,                                 
         BNE   APR4DT8A                                                         
*                                                                               
         MVC   TUV4SWG2,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4SNSU,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4SSUI,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4SZR1,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4SZR2,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4SPIT,LTZERO     FILL WITH ZEROS                              
         MVC   TUV4SPTW,LTZERO     FILL WITH ZEROS                              
         B     APR4DT9                                                          
*                                                                               
APR4DT8A EDIT  (P8,UCRGROSQ),(14,TUV4SWG2),FILL=0 GRS EARNINGS FOR QTR          
*                                                                               
         CLC   =C'MS ',UCRSTATE     IF MISSISSIPPI, SKIP                        
         BE     APR4DT32                                                        
*                                                                               
APR4DT9  CLC   =C'AL ',UCRSTATE     SKIP IF ALABAMA                             
         BE    APR4DT30                                                         
         CLC   =C'MA ',UCRSTATE     SKIP IF MASSACHUSETTS                       
         BE    APR4DT30                                                         
         CLC   =C'NM ',UCRSTATE     SKIP IF NEW MEXICO                          
         BE    APR4DT30                                                         
*                                                                               
APR4DT10 EDIT  (P8,UCRGROSQ),(14,TUV4SWG),FILL=0 GRS EARNINGS FOR QTR           
*                                                                               
         CLC   =C'ND ',UCRSTATE    DONE IF NORTH DAKOTA                         
         BE    APR4DETX                                                         
*                                                                               
         CLC   =C'IL ',UCRSTATE     IF ILLINOIS, SKIP                           
         BE     APR4DT20                                                        
         CLC   =C'CO ',UCRSTATE     IF COLORADO, SKIP                           
         BE     APR4DT20                                                        
         CLC   =C'KS ',UCRSTATE     IF KANSAS                                   
         BE    APR4DT15                                                         
*                                                                               
         EDIT  (P8,UCRSUIWQ),(14,TUV4SSUI),FILL=0 TAX SUI FOR QTR               
*                                                                               
         CLC   =C'OK ',UCRSTATE     IF OKLAHOMA, SKIP                           
         BE     APR4DT20                                                        
*                                                                               
APR4DT15 ZAP   DUB,UCRGROSQ                       GRS LESS SUI =                
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(14,TUV4SNSU),FILL=0      NON TAX SUI FOR QTR           
*                                                                               
**NO-OP  CLC   =C'IL ',UCRSTATE    FOR ALL STATES OTHER THAN IL                 
**11/08  BE    APR4DT70                                                         
         CLC   =C'KS ',UCRSTATE     SKIP IF KANSAS                              
         BE    APR4DT30                                                         
*                                                                               
         EDIT  (B1,UCRWEEK),(2,TUV4SWKS),FILL=0,ZERO=NOBLANK  WKS WRKD          
*                                                                               
APR4DT20 MVC   TUV4SLT2,=C'UTAX'   CONSTANT 'UTAX'                              
*                                                                               
         CLC   =C'IL ',UCRSTATE     IF ILLINOIS,                                
         BNE   APR4DT30                                                         
         MVC   TUV4SSA2(7),SV15IDB                                              
         B     APR4DT60                                                         
*                                                                               
APR4DT30 DS    0H                                                               
*                                                                               
         CLC   =C'MA ',UCRSTATE     IF MASS                                     
         BNE   APR4DT31                                                         
*                                                                               
         EDIT  (B2,UCRHRSWK),(3,TUV4SHRS),0,FILL=0,ZERO=NOBLANK HRSWRKD         
*                                                                               
APR4DT31 DS    0H                                                               
*                                                                               
         CLC   =C'MA ',UCRSTATE     IF MASS                                     
         BNE   APR4DT32                                                         
         MVC   TUV4SSA2(8),SV15IDB     ONLY 8 DIGIT STATE ACCOUNT NBR           
         MVC   TUV4SPLN,=4C'0'     SET 0000 FOR PLANT CODE                      
         B     APR4DT35                                                         
*                                                                               
APR4DT32 CLC   =C'NM ',UCRSTATE     IF NEW MEXICO,                              
         BNE   APR4DT33                                                         
         MVC   TUV4SSA2,SV15IDB                                                 
         MVC   TUV4SSA2+L'TUV4SSA2-1(5),=C'00001'                               
*        MVC   TUV4SPLN,LTZERO      SET 0000 FOR PLANT CODE                     
         EDIT  (P8,UCRTAXQ),(14,TUV4SPIT),FILL=0  PER INC TAX W/HELD            
         MVC   TUV4SPTW,LTZERO    WORKERS COMP - FILL WITH ZEROS                
         TM    UCRINDS,UCRISESS   IF SESSION WAGES, APPLY WORKERS COMP          
         BNO   *+10                                                             
         MVC   TUV4SPTW,=C'00000000000430'  WORKERS COMP - $4.30                
         MVC   TUV4SYR2,RYEAR     SET YYYY OF REPORTING PERIOD                  
         EDIT  QQUART,TUV4SQT2,FILL=0      SET QUARTER (QQ)                     
         MVI   TUV4SOFF,C'N'       OFFICER CODE                                 
         B     APR4DT90                                                         
*                                                                               
APR4DT33 MVC   TUV4SSA2,SV15IDB                                                 
*                                                                               
         CLC   =C'OK ',UCRSTATE     IF OKLAHOMA, SKIP                           
         BE     APR4DT60                                                        
*                                                                               
         CLC   =C'MS ',UCRSTATE     IF MISSISSIPPI, SKIP                        
         BE     APR4DT60                                                        
*                                                                               
         CLC   =C'AL ',UCRSTATE     IF ALABAMA, DONE                            
         BE    APR4DETX                                                         
*                                                                               
         CLC   =C'KS ',UCRSTATE     SKIP IF KANSAS                              
         BE    APR4DT50                                                         
*                                                                               
         CLC   =C'CO ',UCRSTATE     SKIP IF COLORADO                            
         BNE   *+14                                                             
         MVC   TUV4SPLN(3),=3C'0'    SET 000                                    
         B     APR4DT60                                                         
*                                                                               
         CLC   =C'WV ',UCRSTATE    IF WEST VIRGINIA,                            
         BNE   *+10                                                             
         MVC   TUV4SSA2,SV15IDZ    ACCOUNT # (LEFT PADDED WITH ZEROS)           
*                                                                               
         MVI   TUV4SOFF,C'0'       OFFICER CODE                                 
*                                                                               
         CLC   =C'MN ',UCRSTATE    FOR MN ONLY                                  
         BNE   *+10                                                             
         MVC   TUV4SPLN,=4C'0'     SET 000                                      
*&&DO                                                                           
         CLC   =C'CA ',UCRSTATE    FOR CALIFORNIA ONLY                          
         BNE   APR4DT40                                                         
         EDIT  (P8,UCRGROSQ),(14,TUV4SPIT),FILL=0 STATE TAX WAGES-PIT           
         EDIT  (P8,UCRTAXQ),(14,TUV4SPTW),FILL=0  PER INC TAX W/HELD            
         MVI   TUV4SWGP,TUV4SWGS                  WAGE PLAN 'S'                 
*&&                                                                             
APR4DT35 DS    0H                                                               
*                                                                               
         CLC   =C'MA ',UCRSTATE     IF MASS                                     
         BNE   APR4DT50                                                         
*                                                                               
         EDIT  (P8,UCRGROSQ),(14,TUV4SPIT),FILL=0 STATE TAX WAGES-PIT           
         EDIT  (P8,UCRTAXQ),(14,TUV4SPTW),FILL=0  PER INC TAX W/HELD            
*                                                                               
         MVI   TUV4SOFF,C'0'       OFFICER CODE                                 
*                                                                               
         B     APR4DT50                                                         
*                                                                               
APR4DT40 CLC   =C'TX ',UCRSTATE    IF TEXAS                                     
         BE    APR4DT60            SKIP SETTING MONTH1/2/3 EMPLOYMENT           
*                                                                               
APR4DT50 MVI   TUV4SMN1,C'0'                                                    
         MVI   TUV4SMN2,C'0'                                                    
         MVI   TUV4SMN3,C'0'                                                    
*                                                                               
APR4DT60 MVC   TUV4SQTR,RPTMMYR4   SET MMCCYY OF REPORTING PERIOD               
*                                                                               
         CLC   =C'MS ',UCRSTATE     IF MISSISSIPPI                              
         BE    APR4DETX               DONE                                      
*                                                                               
         CLC   =C'OK ',UCRSTATE     IF OKLAHOMA                                 
         BE    APR4DETX               DONE                                      
*                                                                               
         CLC   =C'MA ',UCRSTATE     IF MASS                                     
         BE    APR4DT90                                                         
         CLC   =C'IL ',UCRSTATE     IF ILLINOIS, DONE                           
         BE    APR4DETX                                                         
         CLC   =C'KS ',UCRSTATE     FOR KS ONLY                                 
         BNE   APR4DT80                                                         
*                                                                               
         CP    UCRGROSQ,=P'0'                                                   
         BNE   APR4DT80                                                         
         MVI   TUV4ZWGE,C'1'       1=ZERO WAGES                                 
         B     APR4DT80                                                         
*&&DO                                                                           
APREDT70 MVC   TUV4SLIT,=C'UTAX'   CONSTANT 'UTAX'                              
         MVC   TUV4SSAC,SV15IDB    STATE ACCT CODE                              
*&&                                                                             
*                                                                               
APR4DT80 CLC   =C'KS ',UCRSTATE     FOR KS ONLY                                 
         BE    APR4DT90                                                         
         CLC   =C'ME ',UCRSTATE    FOR ME ONLY                                  
         BNE   APR4DETX                                                         
*                                                                               
         EDIT  (P8,UCRGROSQ),(14,TUV4SPIT),FILL=0 STATE TAX WAGES-PIT           
         EDIT  (P8,UCRTAXQ),(14,TUV4SPTW),FILL=0  PER INC TAX W/HELD            
         MVI   TUV4SSNL,TUV4SSNN   SEASONAL CODE NO                             
         MVI   TUV4SWGP,C'0'       WAGE PLAN                                    
APR4DT90 EDIT  UCRMTH1,TUV4SMN1,FILL=0    1 = WORKED IN MONTH 1                 
         EDIT  UCRMTH2,TUV4SMN2,FILL=0    1 = WORKED IN MONTH 2                 
         EDIT  UCRMTH3,TUV4SMN3,FILL=0    1 = WORKED IN MONTH 3                 
         CLC   =C'MA ',UCRSTATE     IF MASS                                     
         BE    APR4DETX                                                         
         CLC   =C'KS ',UCRSTATE     IF KANSAS                                   
         BE    APR4DETX                                                         
         CLC   =C'NM ',UCRSTATE     IF NEW MEXICO                               
         BE    APR4DETX                                                         
*                                                                               
         MVC   TUV4SWAN,SVEMTAX    WITHHOLDING ACCT. ID NO                      
         MVI   TUV4SFEM,C'0'       0 = MALE, 1=FEMALE                           
         CLI   UCRSEX,C'F'                                                      
         BNE   *+8                                                              
         MVI   TUV4SFEM,C'1'                                                    
         MVC   TUV4SSPS,LTZERO     SEASONAL PERIOD START                        
         MVC   TUV4SSPE,LTZERO     SEASONAL PERIOD END                          
*                                                                               
APR4DETX XIT1                                                                   
         DROP  R4                                                               
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO VERSION 6 TAPE                                           
*        CURRENTLY FOR WASHINGTON ONLY                                          
*======================================================================         
         USING TUVER6D,R4                                                       
         USING UCRD,R3                                                          
VERSION6 NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BRAS  RE,PRV6HEAD         PROCESS E RECORDS                            
         B     PRVER6X                                                          
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   PRVER6T                                                          
         CLI   UCRSIGN,C'N'        NO NEGATIVE WAGES                            
         BNE   PRVER6J                                                          
         BRAS  RE,ADDNEG                                                        
         J     XIT                                                              
*                                                                               
PRVER6J  BRAS  RE,PRV6DET          PROCESS S RECORDS                            
         B     PRVER6X                                                          
*                                                                               
PRVER6T  CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         JNE   XIT                                                              
         BRAS  RE,PRV6TOT          PROCESS T RECORD                             
         BRAS  RE,PUTTAPE                                                       
         BRAS  RE,MVCSPACE                                                      
         BRAS  RE,PRV6FIN          PROCESS F RECORD                             
         B     PRVER6X                                                          
*                                                                               
PRVER6X  BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT EMPLOYER RECORD ON TAPE                                 
*======================================================================         
         USING TUVER6D,R4                                                       
         USING UCRD,R3                                                          
PRV6HEAD NTR1  BASE=*,LABEL=*                                                   
         MVI   TUV6ID,TUV6IDE      PUT E RECORD TO TAPE                         
         MVC   TUV6YEAR,RYEAR      TAX YEAR                                     
         MVC   TUV6EMID,FDID       FEIN                                         
**NO-OP  MVC   TUV6ERFN,=C'25358800'                                            
**04/13  MVI   TUV6ECKD,C'7'                                                    
         MVC   TUV6ERID,SVID       EMPLOYER ID                                  
*                                                                               
         MVC   TUV6EMNM(L'NAMEFLD),NAMEFLD                                      
         MVC   TUV6EMAD(L'EMPADDR),EMPADDR                                      
         MVC   TUV6EMCT(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUV6EMST(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUV6EZIP(L'EMPZIP),EMPZIP                ZIP CODE                
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*======================================================================         
         USING TUVER6D,R4                                                       
         USING UCRD,R3                                                          
PRV6DET  NTR1  BASE=*,LABEL=*                                                   
         MVI   TUV6ID,TUV6IDS      S - INDIVIDUAL RECORDS                       
         MVC   TUV6SSSN,UCRSSN     SS NUMBER                                    
         MVC   TUV6SNML(L'W4LAST),W4LAST LAST NAME                              
         MVC   TUV6SNMF(L'W4FRST),W4FRST FIRST NAME                             
         MVC   TUV6SNMM,W4MID            MIDDLE INITIAL                         
         MVC   TUV6SSTC,TGTANUM    STATE CODE                                   
*                                                                               
         EDIT  (P8,UCRGROSQ),(14,TUV6SWG),FILL=0 GRS EARNINGS FOR QTR           
*                                                                               
         OC    UCRGROSQ,UCRGROSQ     IF ANY GROSS EARNINGS,                     
         BNZ   PRV6D10                                                          
         MVC   TUV6SHRS,=CL4'0000'                                              
         B     PRV6D20                                                          
PRV6D10  ZAP   DUB,UCRGROSQ      CALCULATE # OF HOURS WORKED                    
         XR    R0,R0                                                            
         CVB   R1,DUB                                                           
         D     R0,=F'932'        DIVIDE GROSS BY MINIMUM WAGE                   
         LTR   R0,R0             IF THERE IS A REMAINDER,                       
         BZ    *+8                                                              
         AHI   R1,1              ROUND UP                                       
         CHI   R1,520            IF NUMBER OF HOURS WORKED > 520                
         BNH   *+8                                                              
         LHI   R1,520            USE MAXIMUM OF 520                             
         EDIT  (R1),(4,TUV6SHRS),FILL=0                                         
*                                                                               
**NO-OP  MVC   TUV6SERF(9),=C'253588007'                                        
PRV6D20  MVC   TUV6SEID,SVID      EMPLOYER ID                                   
         EDIT  QMONTH,(2,TUV6SRPR),FILL=0                                       
         MVC   TUV6SRPR+2(4),RYEAR   SET MMCCYY OF REPORTING PERIOD             
*                                                                               
         XIT1                                                                   
         DROP  R4                                                               
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT TOTAL RECORD ON TAPE                                    
*======================================================================         
         USING TUVER6D,R4                                                       
         USING UCRD,R3                                                          
PRV6TOT  NTR1  BASE=*,LABEL=*                                                   
         MVI   TUV6ID,TUV6IDT      T - TOTAL RECORDS                            
         MVC   TUV6TENT,=C'UTAX'                                                
         EDIT  (P8,UCRGROSQ),(14,TUV6TGWG),FILL=0                               
         EDIT  (P8,UCRSUIWQ),(14,TUV6TTWG),FILL=0                               
         ZAP   DUB,UCRGROSQ                                                     
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(14,TUV6TXWG),FILL=0                                    
         EDIT  SUIRATE,(6,TUV6TRTE),FILL=0                                      
         MVC   FULL,SUIRATE                                                     
         ZAP   DUB,UCRSUIWQ                                                     
         BRAS  RE,CALCDUE                                                       
         EDIT  (P8,DUB),(13,TUV6TQTD),FILL=0                                    
         MVC   TUV6TINT,LTZERO                                                  
         MVC   TUV6TPNL,LTZERO                                                  
         MVC   TUV6TCRD,LTZERO                                                  
         MVC   TUV6TEAF,LTZERO                                                  
         MVI   TUV6TEAF+3,C'3'                                                  
         MVC   TUV6TEAA,LTZERO                                                  
         MVC   TUV6TNCO,LTZERO                                                  
         MVC   TUV6TCOE,LTZERO                                                  
         MVC   TUV6TTPD,LTZERO                                                  
*                                                                               
         MVC   TUV6TRYQ,RYEAR      SET MMCCYY OF REPORTING PERIOD               
         MVC   TUV6TRYQ+4(1),QQUART                                             
         OI    TUV6TRYQ+4,X'F0'    MAKE SURE IT IS A CHARACTER                  
         EDIT  (P4,UCRNMTH1),(7,TUV6TM1C),FILL=0                                
         EDIT  (P4,UCRNMTH2),(7,TUV6TM2C),FILL=0                                
         EDIT  (P4,UCRNMTH3),(7,TUV6TM3C),FILL=0                                
**NO-OP  MVC   TUV6TRFN(9),=C'253588007'                                        
         MVC   TUV6TEID,SVID       EMPLOYER ID                                  
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT FINAL RECORD ON TAPE                                    
*======================================================================         
         USING TUVER6D,R4                                                       
         USING UCRD,R3                                                          
PRV6FIN  NTR1  BASE=*,LABEL=*                                                   
         MVI   TUV6ID,TUV6IDF      F - TOTAL RECORDS                            
         EDIT  (P4,UCRNSSN),(10,TUV6FSCT),FILL=0   PERFORMERS ON TAPE           
         MVC   TUV6FECT,LTZERO     NUMBER OF EMPLOYERS ON TAPE                  
         MVI   TUV6FECT+9,C'1'                                                  
         MVC   TUV6FENT,=C'UTAX'                                                
         EDIT  (P8,UCRGROSQ),(15,TUV6FGWG),FILL=0 GROSS WAGES                   
         MVC   TUV6FVER,=C'07172001'                                            
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT VERSION 7 RECORD ON TAPE                                
*======================================================================         
         USING TUVER7D,R4                                                       
         USING UCRD,R3                                                          
VERSION7 NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTDET     ONLY DETAIL RECORDS                          
         BNE   VER7X                                                            
         CLI   UCRSIGN,C'N'                                                     
         BNE   VER7C                                                            
         BRAS  RE,ADDNEG                                                        
         B     VER7X                                                            
*                                                                               
VER7C    MVC   TUV7SSNO,UCRSSN     SS#                                          
         MVC   TUV7TRAN,=C'W4'     TRANSACTION = W4                             
         MVC   TUV7LST4,W4LAST     LAST NAME, FIRST 4 CHARS                     
         MVC   TUV7OPER,=C'12345678'  OPERATOR                                  
         MVC   TUV7TERM,=C'$WCA'   TERMINAL                                     
*                                                                               
         GOTO1 DATCON,DMCB,(5,0),(20,WORK)    TODAY'S DATE                      
         MVC   TUV7DATE,WORK+2     YYMMDD                                       
         MVC   TUV7DAT2,WORK+2     YYMMDD                                       
         LA    R2,WORK                                                          
         BRAS  RE,GETTMSTP         SET TIME STAMP IN WORK                       
         MVC   TUV7TIME(2),11(R2)   HH                                          
         MVC   TUV7TIME+2(2),14(R2) MM                                          
         MVC   TUV7TIME+4(2),17(R2) SS                                          
         MVC   TUV7YEAR,RYEAR+2    YEAR, LAST 2 DIGITS                          
         EDIT  QQUART,TUV7QTR      QUARTER NUMBER                               
*                                                                               
         MVI   TUV7CODE,TUV7COD2   CODE = 2                                     
         EDIT  (P8,UCRGROSQ),(7,TUV7EARN),FILL=0                                
         MVC   TUV7STAC,SVID       STATE ACCOUNT NUMBER                         
         MVC   TUV7ZERO,=C'00000000'                                            
         MVI   TUV7IND,TUV7IND1    INDICATOR = 1                                
         MVC   TUV7ZER2,=C'000000'                                              
         MVC   TUV7ZER3,=C'000000'                                              
         MVC   TUV7ORIG,=C'04'     ORIGINATION CODE FOR CD                      
         MVC   TUV7EMNM,W4FRST     FIRST NAME                                   
         MVC   TUV7EMN2,W4MID      MIDDLE INITIAL                               
         BAS   RE,VER7LSTN         PROCESS 1ST AND 2ND LAST NAMES               
         MVI   TUV7PWIN,C'N'       PARTIAL WAGE INDICATOR                       
*                                                                               
         BRAS  RE,PUTTAPE                                                       
VER7X    XIT1                                                                   
         EJECT                                                                  
VER7LSTN NTR1                                                                   
         LHI   R0,L'W4LAST                                                      
         LA    R1,W4LAST                                                        
         LA    RF,TUV7EMN3         START WITH PATERNAL LAST NAME                
V7LSTN30 CLI   0(R1),C'-'                                                       
         BNE   V7LSTN50                                                         
         LA    RF,TUV7EMN4         NOW START WITH MATERNAL LAST NAME            
         B     V7LSTN80                                                         
                                                                                
V7LSTN50 MVC   0(1,RF),0(R1)                                                    
         AHI   RF,1                                                             
V7LSTN80 AHI   R1,1                                                             
         BCT   R0,V7LSTN30                                                      
         J     VER7X                                                            
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT VERSION 8 RECORD ON TAPE                                
*======================================================================         
         USING TUVER8D,R4                                                       
         USING UCRD,R3                                                          
VERSION8 NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTDET     ONLY DETAIL RECORDS                          
         BNE   VER8X                                                            
         CLI   UCRSIGN,C'N'                                                     
         BNE   VER8C                                                            
         BRAS  RE,ADDNEG                                                        
         B     VER8X                                                            
*                                                                               
VER8C    MVI   TUV8ID,TUV8IDS      'S' - SUPPLEMENTAL RECORD                    
         MVC   TUV8SSNO,UCRSSN     SS#                                          
         MVC   TUV8LST(L'W4LAST),W4LAST  LAST NAME                              
         MVC   TUV8FST,W4FRST      FIRST NAME                                   
         MVC   TUV8MID,W4MID       MIDDLE INITIAL                               
         MVC   TUV8STAC,=C'13'     GEORGIA STATE CODE                           
         MVC   TUV8MM(6),RPTMMYR4  MONTH AND LAST 4 DIGITS OF YEAR              
         EDIT  (P8,UCRGROSQ),(9,TUV8WAGE),FILL=0                                
         MVC   TUV8EMPA,SVID       STATE ACCOUNT NUMBER                         
         BRAS  RE,PUTTAPE                                                       
VER8X    XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT VERSION 9 RECORD ON TAPE                                
*======================================================================         
         USING TUVER9D,R4                                                       
         USING UCRD,R3                                                          
VERSION9 NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTDET     ONLY DETAIL RECORDS                          
         BNE   VER9X                                                            
         CLI   UCRSIGN,C'N'                                                     
         BNE   VER9C                                                            
         BRAS  RE,ADDNEG                                                        
         B     VER9X                                                            
*                                                                               
VER9C    MVC   TUV9SSNO,UCRSSN     SS#                                          
         MVC   BLOCK(120),SPACES                                                
         MVC   BLOCK(L'W4LAST),W4LAST      LAST NAME                            
         MVC   BLOCK+L'W4LAST+1(L'W4FRST),W4FRST                                
         MVC   BLOCK+L'W4LAST+L'W4FRST+2(1),W4MID                               
         GOTO1 SQUASHER,DMCB,BLOCK,L'W4LAST+L'W4FRST+L'W4MID+2                  
         MVC   TUV9NAME,BLOCK                                                   
         EDIT  (P8,UCRGROSQ),(9,TUV9WAGE),0,FILL=0                              
         LA    R2,TUV9QYR          QUARTER + LAST 2 DIGITS OF YEAR              
         BAS   RE,SETQNO                                                        
         MVC   TUV9QYR+1(2),RPTMMYR+2                                           
         MVC   TUV9ACCT,=C'552808'  STATE ACCOUNT NUMBER                        
         BRAS  RE,PUTTAPE                                                       
VER9X    XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO PUT VERSION 10 RECORD ON TAPE                               
*======================================================================         
*&&DO                                                                           
         USING TUVR10D,R4                                                       
         USING UCRD,R3                                                          
VERXN10  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC                                                      
         LA    R4,TAPEIO                                                        
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTDET     ONLY DETAIL RECORDS                          
         BNE   VR10X                                                            
         CLI   UCRSIGN,C'N'                                                     
         BNE   VERXN10C                                                         
         BRAS  RE,ADDNEG                                                        
         B     VR10X                                                            
*                                                                               
VERXN10C MVC   TUV10SSN,UCRSSN     SS#                                          
         MVC   TUV10LNM(L'W4LAST),W4LAST                                        
         MVC   TUV10FNM,W4FRST                                                  
         MVC   TUV10MID,W4MID                                                   
         MVC   TUV10QYR,RPTMMYR    QUARTER AND YEAR                             
         EDIT  (P8,UCRGROSQ),(15,TUV10GWG),2,FILL=0        WAGES                
         MVC   TUV10EAC,SVID       EMPLOYER ACCT NUMBER                         
         MVI   TUV10S1,C'\'        ADD THE DELIMETERS                           
         MVI   TUV10S2,C'\'                                                     
         MVI   TUV10S3,C'\'                                                     
         MVI   TUV10S4,C'\'                                                     
         MVI   TUV10S5,C'\'                                                     
         MVI   TUV10S6,C'\'                                                     
         MVI   TUV10S7,C'\'                                                     
         BRAS  RE,PUTTAPE                                                       
VR10X    XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*&&                                                                             
*======================================================================         
*        ROUTINE TO DO NEW ILLINOIS VERSION TAPE                                
*======================================================================         
         USING TUILDSKD,R4                                                      
         USING UCRD,R3                                                          
VERILTP  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    EMPLOYER RECORD                              
         BNE   *+12                                                             
         BRAS  RE,PRILEREC                                                      
         B     VERILX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERILX                                                           
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE POSITIVE,                     
         BE    VERIL10                                                          
         BRAS  RE,PRILDET          PROCESS S RECORDS                            
         B     VERILX                                                           
*                                                                               
VERIL10  BRAS  RE,ADDNEG           SKIP IF NEGATIVE                             
*                                                                               
VERILX   XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYER RECORD ON TAPE                                 
*                                                                               
         USING UCRD,R3                                                          
         USING TUILDSKD,R4                                                      
PRILEREC NTR1  BASE=*,LABEL=*                                                   
         LR    R0,R4                                                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVI   TUILID,TUILIDEQ                                                  
*                                                                               
         MVC   TUILEFID,FDID                                                    
         MVC   TUILEUIA,SVID                                                    
* THE UCRGROSQ SHOULD BE CORRECT FOR CURRENT MONTH TO DATE                      
         EDIT  (P8,UCRGROSQ),(11,TUILETWP),2,ALIGN=LEFT,TRAIL=C' '              
         MVI   TUILEWNA,C'0'                                                    
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*                                                                               
         USING UCRD,R3                                                          
         USING TUILDSKD,R4                                                      
PRILDET  NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVI   TUILID,TUILIDSQ                                                  
         MVC   TUILSSSN(3),UCRSSN                                               
         MVI   TUILSSSN+3,C'-'                                                  
         MVC   TUILSSSN+4(2),UCRSSN+3                                           
         MVI   TUILSSSN+6,C'-'                                                  
         MVC   TUILSSSN+7(4),UCRSSN+5                                           
         MVC   TUILSFNM(L'W4FRST),W4FRST     FIRST NAME                         
         MVC   TUILSLNM(L'W4LAST),W4LAST     LAST NAME                          
         EDIT  (P8,UCRGROSQ),(14,TUILSWGS),2,ALIGN=LEFT,TRAIL=C' '              
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO NEW MEXICO VERSION TAPE                                  
*======================================================================         
         USING TUNMDSKD,R4                                                      
         USING UCRD,R3                                                          
VERNMTP  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BRAS  RE,PRNMHEAD         PROCESS D,H AND E RECORDS                    
         B     VERNMX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   *+12                                                             
         BRAS  RE,PRNMTRAL         PROCESS T RECORD                             
         B     VERNMX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERNMX                                                           
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE POSITIVE,                     
         BE    VERNM10                                                          
         BRAS  RE,PRNMDET          PROCESS S RECORDS                            
         B     VERNMX                                                           
*                                                                               
VERNM10  BRAS  RE,ADDNEG           SKIP IF NEGATIVE                             
*                                                                               
VERNMX   XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT FIRST, SECOND AND THIRD RECORDS ON TAPE                 
*                                                                               
PRNMHEAD NTR1                                                                   
         BRAS  RE,PRNMDREC         PUT D RECORD TO TAPE                         
         BRAS  RE,PRNMHREC         PUT H RECORD TO TAPE                         
         BRAS  RE,PRNMEREC         PUT E RECORD TO TAPE                         
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT FIRST RECORD ON TAPE                                    
*                                                                               
         USING TUNMDSKD,R4                                                      
PRNMDREC NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         GOTO1 DATCON,DMCB,(0,TGTODAY0),(20,WORK)                               
         MVC   TUNMDOCN,WORK       DOCUMENT NUMBER - YYYYMMDD                   
         MVC   TUNMREP,=C'DOL_903' REPORT                                       
         MVC   TUNMVER,=C'1.0'     VERSION                                      
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT SECOND RECORD ON TAPE                                   
*                                                                               
         USING TUNMDSKD,R4                                                      
PRNMHREC NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUNMROWH,=C'ES_903_Header'   ROW TYPE                            
         MVC   TUNMEAN,SV15IDZ              EMPLOYER ACCT #                     
         MVC   TUNMFEIN,FDID                FEIN                                
         MVC   TUNMQTR(4),RYEAR             QUARTER ENDING - YYYYMMDD           
         MVC   TUNMQTR+4(2),RPTMMYR         MONTH                               
         BRAS  RE,SETDAY2                   SET DAY OF QUARTER END              
         MVC   TUNMQTR+6(2),HALF            DAY - 30 OR 31                      
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYER RECORD ON TAPE                                 
*                                                                               
         USING TUNMDSKD,R4                                                      
PRNMEREC NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUNMROWE,=C'ES_903_Employer' ROW TYPE                            
*                                                                               
         BRAS  RE,GETEMTAX                                                      
         MVC   TUNMCRS,SVEMTAX              COMBINED REPORTING SYS#             
*                                                                               
         MVC   TUNMENAM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         MVC   TUNMEADD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUNMECTY(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUNMESTA(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUNMEZIP(L'EMPZIP),EMPZIP                ZIP CODE                
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*                                                                               
         USING UCRD,R3                                                          
         USING TUNMDSKD,R4                                                      
PRNMDET  NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUNMROWS,=C'ES_903_Employees' ROW TYPE                           
         MVC   TUNMSSN,UCRSSN     SS NUMBER                                     
*                                                                               
         MVC   BLOCK(120),MYSPACES                                              
         MVC   BLOCK(L'W4LAST),W4LAST               LAST NAME                   
         MVC   BLOCK+L'W4LAST+1(L'W4FRST),W4FRST    FIRST NAME                  
         GOTO1 SQUASHER,DMCB,BLOCK,L'W4LAST+L'W4FRST                            
         MVC   TUNMSNAM,BLOCK  LAST NAME FOLLOWED BY FIRST NAME                 
*                                                                               
         EDIT  (P8,UCRGROSQ),(11,TUNMSGRO),2,FILL=0 GRS EARNS FOR QTR           
         ZAP   DUB,UCRGROSQ                       GRS LESS SUI =                
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(11,TUNMSEXC),2,FILL=0    EXCESS WAGES(NON-TAX)         
         EDIT  (P8,UCRTAXQ),(7,TUNMSWTH),2,FILL=0 INC TAX W/HELD                
*                                                                               
         MVC   TUNMSWRK,=C'0000'  WORKERS COMP                                  
         TM    UCRINDS,UCRISESS   IF SESSION WAGES, APPLY WORKERS COMP          
         BNO   *+10                                                             
         MVC   TUNMSWRK,=C'4.30'  WORKERS COMP - $4.30                          
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT TOTAL RECORD ON TAPE                                    
*                                                                               
         USING UCRD,R3                                                          
         USING TUNMDSKD,R4                                                      
PRNMTRAL NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUNMROWE(6),=C'TOTALS' ROW TYPE                                  
*                                                                               
         XR    R0,R0                                                            
         L     R1,SUIRATE          CONTRIBUTION RATE                            
         MVC   FULL,=F'10'         DIVIDE BY 10                                 
         D     R0,FULL                                                          
         EDIT  (R1),(4,TUNMTXRT),2,FILL=0      CONTRIBUTION RATE                
*                                                                               
         EDIT  (P8,UCRGROSQ),(12,TUNMTWAG),2,FILL=0 GROSS EARN FOR QTR          
         EDIT  (P8,UCRSUIWQ),(12,TUNMTAXW),2,FILL=0 TAX SUI FOR QTR             
         ZAP   DUB,UCRGROSQ                       GROSS LESS                    
         SP    DUB(8),UCRSUIWQ                    SUI EQUALS                    
         EDIT  (P8,DUB),(12,TUNMEXCW),2,FILL=0    NON TAX SUI FOR QTR           
*                                                                               
         MVC   FULL,SUIRATE                        EMPLOYER TAX TIMES           
         ZAP   DUB,UCRSUIWQ                        TAX SUI FOR QTR              
         BRAS  RE,CALCDUE                          =TAXES DUE                   
         EDIT  (P8,DUB),(12,TUNMTAXD),2,FILL=0     TAX DUE                      
         EDIT  (P8,DUB),(14,TUNMPAYA),2,FILL=0     PAYMENT AMOUNT               
*                                                                               
         MVC   TUNMINTD,LTZERO2                                                 
         MVC   TUNMRPEN,LTZERO2                                                 
         MVC   TUNMPPEN,LTZERO2                                                 
*                                                                               
         EDIT  (P4,UCRNMTH1),(7,TUNMMTH1),FILL=0   PERFS FOR MONTH 1            
         EDIT  (P4,UCRNMTH2),(7,TUNMMTH2),FILL=0   PERFS FOR MONTH 2            
         EDIT  (P4,UCRNMTH3),(7,TUNMMTH3),FILL=0   PERFS FOR MONTH 3            
*                                                                               
         EDIT  (P8,UCRTAXQ),(12,TUNMTOTW),2,FILL=0 PER INC TAX W/HELD           
*                                                                               
         MVC   FULL,NMWKCMP      WORKER'S COMP RATE                             
         ZAP   DUB,UCRNSESS      TOTAL EMPLOYEES WITH SESSION WAGES             
         BRAS  RE,CALCWRK        =TOTAL WORKER'S COMP                           
         EDIT  (P8,DUB),(12,TUNMWORK),2,FILL=0  TOTAL WORKERS COMP              
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R3,R4                                                            
LTZERO2  DC    C'0000000000000000'                                              
NMWKCMP  DC    F'430'                                                           
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO MAINE VERSION TAPE                                       
*======================================================================         
         USING WHMEWHD,R4                                                       
         USING UCRD,R3                                                          
VERMETP  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BRAS  RE,PRMEHEAD         PROCESS A E RECORDS                          
         B     VERMEX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   *+12                                                             
         BRAS  RE,PRMETRAL         PROCESS T AND F RECORD                       
         B     VERMEX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERMEX                                                           
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE POSITIVE,                     
         BE    VERME10                                                          
         BRAS  RE,PRMEDET          PROCESS S RECORDS                            
         B     VERMEX                                                           
*                                                                               
VERME10  BRAS  RE,ADDNEG           SKIP IF NEGATIVE                             
*                                                                               
VERMEX   XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT FIRST, SECOND AND THIRD RECORDS ON TAPE                 
*                                                                               
PRMEHEAD NTR1                                                                   
         BRAS  RE,PRMEAREC         PUT A WITHHOLDING RECORD TO TAPE             
         BRAS  RE,PRMEEREC         PUT E WITHHOLDING RECORD TO TAPE             
*                                                                               
*                                                                               
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT FIRST RECORD ON TAPE                                    
*                                                                               
         USING WHMEWHD,R4                                                       
         USING UCRD,R3                                                          
PRMEAREC NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
* OUTPUT WITHHOLDIN RECORD                                                      
         MVI   WHRECTYP,WHRECWITH                                               
         MVI   WHMEWID,WHMEWIDAQ                                                
         MVC   WHMEWYEAR,RYEAR                                                  
         MVC   WHMEAFEI,FDID                                                    
         MVC   WHMEAENT,=C'WITH'                                                
         MVC   WHMEANAM(L'NAMEFLD),NAMEFLD                                      
                                                                                
         MVC   WHMEAADD(L'EMPADDR),EMPADDR                                      
         MVC   WHMEACTY(L'EMPCITY),EMPCITY                                      
         MVC   WHMEASTA(L'EMPSTATE),EMPSTATE                                    
                                                                                
         MVC   WHMEAZIP(L'EMPZIP),EMPZIP                                        
         MVC   WHMEAZPX(L'LTXEXZP2),LTXEXZP2                                    
         MVC   WHMEACON(27),=CL27'DANIELLE KOSCHIL' CONTACT NAME                
         MVC   WHMEAPHO,=CL10'3129237900'       CONTACT PHONE                   
         MVC   WHMEAEXT,=CL5'7903'          CONTACT PHONE EXTENSION             
         BRAS  RE,PUTTAPE                                                       
*                                                                               
* OUTPUT UNEMPLOYMENT RECORD                                                    
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
         USING UNMEWHD,R4                                                       
         MVI   UNRECTYP,UNRECUNEM                                               
         MVI   UNMEWID,UNMEWIDAQ                                                
         MVC   UNMEWYEAR,RYEAR                                                  
         MVC   UNMEAFEI,FDID                                                    
         MVC   UNMEAENT,=C'WAGE'                                                
         MVC   UNMEANAM(L'NAMEFLD),NAMEFLD                                      
         MVC   UNMEAADD(L'EMPADDR),EMPADDR                                      
         MVC   UNMEACTY(L'EMPCITY),EMPCITY                                      
         MVC   UNMEASTA(L'EMPSTATE),EMPSTATE                                    
         MVC   UNMEAZIP(L'EMPZIP),EMPZIP                                        
         MVC   UNMEAZPX(L'LTXEXZP2),LTXEXZP2                                    
         MVC   UNMEACON(27),=CL27'DANIELLE KOSCHIL' CONTACT NAME                
         MVC   UNMEAPHO,=CL10'3129237900'       CONTACT PHONE                   
         MVC   UNMEAEXT,=CL5'7903'          CONTACT PHONE EXTENSION             
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT SECOND RECORD ON TAPE                                   
*                                                                               
         USING WHMEWHD,R4                                                       
         USING UCRD,R3                                                          
PRMEEREC NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
         MVI   WHMEWID,WHMEWIDEQ                                                
         MVI   WHRECTYP,WHRECWITH                                               
         MVC   WHMEWYEAR,RYEAR                                                  
         MVC   WHMEEFEI,FDID                                                    
         MVC   WHMEENAM(L'NAMEFLD),NAMEFLD                                      
         MVC   WHMEEADD(L'EMPADDR),EMPADDR                                      
         MVC   WHMEECTY(L'EMPCITY),EMPCITY                                      
****     MVC   WHMEESTA(2),=C'23'                                               
         MVC   WHMEASTA(L'EMPSTATE),EMPSTATE                                    
         MVC   WHMEEZIP(L'EMPZIP),EMPZIP                                        
         MVC   WHMEEZPX(L'LTXEXZP2),LTXEXZP2                                    
         MVC   WHMEEENT,=C'WITH'                                                
         MVC   WHMEESID(2),=C'23'                                               
         MVC   WHMEEPER,RPTMMYR                                                 
         MVI   WHMEENOW,C'0'                                                    
         OC    UCRNSSN,UCRNSSN                                                  
         BZ    *+8                                                              
         MVI   WHMEENOW,C'1'                                                    
         MVC   WHMEEPRP,LTZERO  OLD MAINE FORMAT =ZERO                          
         MVC   WHMEELIC,LTZERO  OLD MAINE FORMAT =ZERO                          
         EDIT  (P4,UCRNSSN),(4,WHMEENME),FILL=0   NUMBER OF EMPLOYEES           
         MVC   WHMEEWAI,FDID                                                    
         MVC   WHMEEWAI+9(2),LTZERO                                             
         BRAS  RE,PUTTAPE                                                       
*                                                                               
* OUTPUT UNEMPLOYMENT RECORD                                                    
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
         USING UNMEWHD,R4                                                       
         MVI   UNRECTYP,UNRECUNEM                                               
         MVC   UNMEWYEAR,RYEAR                                                  
         MVI   UNMEWID,UNMEWIDEQ                                                
         MVC   UNMEEFEI,FDID                                                    
         MVC   UNMEENAM(L'NAMEFLD),NAMEFLD                                      
         MVC   UNMEEADD(L'EMPADDR),EMPADDR                                      
         MVC   UNMEECTY(L'EMPCITY),EMPCITY                                      
         MVC   UNMEESTA(L'EMPSTATE),EMPSTATE                                    
         MVC   UNMEEZIP(L'EMPZIP),EMPZIP                                        
         MVC   UNMEEZPX(L'LTXEXZP2),LTXEXZP2                                    
         MVC   UNMEEENT,=C'WAGE'                                                
         MVC   UNMEESID,=C'23'                                                  
****     MVC   UNMEEUCA,FDID                                                    
         MVC   UNMEEUCA,SV15IDZ    STATE ACCOUNT NUMBER                         
         MVC   UNMEEPER,RPTMMYR                                                 
*                                                                               
         MVI   UNMEENOW,C'0'                                                    
         OC    UCRNSSN,UCRNSSN                                                  
         BZ    *+8                                                              
         MVI   UNMEENOW,C'1'                                                    
*                                                                               
         MVC   UNMEEPRP,LTZERO  OLD MAINE FORMAT =ZERO                          
         MVC   UNMEELIC,LTZERO  OLD MAINE FORMAT =ZERO                          
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*                                                                               
         USING UCRD,R3                                                          
         USING WHMEWHD,R4                                                       
PRMEDET  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
         MVC   WHMEWYEAR,RYEAR                                                  
         MVI   WHMEWID,WHMEWIDSQ                                                
         MVI   WHRECTYP,WHRECWITH                                               
         MVC   WHMESSSN,UCRSSN                                                  
         MVC   WHMESLNM(16),W4LASTNB   LAST NAME                                
         MVC   WHMESFNM(15),W4FRST     FIRST NAME                               
         MVC   WHMESMNM(1),W4MID   MIDDLE INITIAL                               
         MVC   WHMESSTA(2),=C'23'                                               
         MVC   WHMESQYR(L'RPTMMYR),RPTMMYR                                      
         MVC   WHMESQYR+2(L'RYEAR),RYEAR                                        
         MVC   WHMESTEN,=C'WITH'                                                
         EDIT  (P8,UCRTAXQ),(14,WHMESQTX),FILL=0 PER INC TAX WITHHELD           
         MVC   WHMESACT,FDID                                                    
         MVC   WHMESACT+9(2),LTZERO                                             
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*  EMPLOYEES RECORD UNEMPLOYMENT                                                
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
         USING UNMEWHD,R4                                                       
         MVI   UNRECTYP,UNRECUNEM                                               
         MVI   UNMEWID,UNMEWIDSQ                                                
         MVC   UNMESSSN,UCRSSN                                                  
         MVC   UNMESLNM(16),W4LASTNB                                            
         MVC   UNMESFNM(15),W4FRST     FIRST NAME                               
         MVC   UNMESMNM(1),W4MID   MIDDLE INITIAL                               
         MVC   UNMESSTA(2),=C'23'                                               
         MVC   UNMESQYR(L'RPTMMYR),RPTMMYR                                      
         MVC   UNMESQYR+2(L'RYEAR),RYEAR                                        
         EDIT  (P8,UCRGROSQ),(14,UNMESTWA),FILL=0 GRS QTR EARNINGS              
         ZAP   DUB,UCRGROSQ                  GROSS LESS SUI =                   
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(14,UNMESEXW),FILL=0  EXCESS WAGES (NON-TAX)            
                                                                                
         EDIT  (P8,UCRSUIWQ),(14,UNMESUTW),FILL=0 TAX SUI FOR QTR               
         MVC   UNMESTEN,=C'WAGE'                                                
         MVC   UNMESUCA,PRINTID                                                 
                                                                                
         MVI   UNMESSEA,TUV4SSNN   SEASONAL CODE NO                             
         MVI   UNMESWPC,C'0'       WAGE PLAN                                    
         MVC   UNMESMN1(3),=C'000'                                              
         OC    UNMESMN1,UCRMTH1    WORKED IN MONTH INDICATOR                    
         OC    UNMESMN2,UCRMTH2    WORKED IN MONTH INDICATOR                    
         OC    UNMESMN3,UCRMTH3    WORKED IN MONTH INDICATOR                    
         MVI   UNMESFEM,C'0'       0 = MALE, 1=FEMALE                           
         CLI   UCRSEX,C'F'                                                      
         BNE   *+8                                                              
         MVI   UNMESFEM,C'1'                                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         XIT1                                                                   
*                                                                               
*        ROUTINE TO TRAILER RECORDS                                             
*                                                                               
PRMETRAL NTR1                                                                   
         BRAS  RE,PRMETREC         PUT T RECORD TO TAPE                         
         BRAS  RE,PRMEFREC         PUT F RECORD TO TAPE                         
         XIT1                                                                   
         LTORG                                                                  
*        ROUTINE TO PUT TOTAL RECORD ON TAPE                                    
*                                                                               
         USING WHMEWHD,R4                                                       
PRMETREC NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
* TOTALS RECORD - WITHHOLDING                                                   
         MVI   WHMEWID,WHMEWIDTQ                                                
         MVI   WHRECTYP,WHRECWITH                                               
         MVC   WHMEWYEAR,RYEAR                                                  
         EDIT  (P4,UCRNSSN),(7,WHMETSNM),FILL=0   NUMBER OF EMPLOYEES           
         MVC   WHMETTEN,=C'WITH'                                                
         MVC   WHMETVPY,LTZERO             VOUCHER PAYMENTS                     
*                                                                               
         MVC   FULL,SUIRATE                        EMPLOYER TAX TIMES           
         ZAP   DUB,UCRSUIWQ                        TAX SUI FOR QTR              
         BRAS  RE,CALCDUE                          =TAXES DUE                   
         EDIT  (P8,DUB),(11,WHMETITD),FILL=0       INCOME TAX DUE               
*                                                                               
         EDIT  (P8,UCRTAXQ),(14,WHMETQTW),FILL=0 PER INC TAX WITHHELD           
*WHMETITD = WHMETQTW-WHMETVPY.  WHMETVPY ALWAYS ZERO SO - = WHMETQTW            
         EDIT  (P8,UCRTAXQ),(11,WHMETITD),FILL=0 PER INC TAX WITHHELD           
*&&DO                                                                           
*  TOTAL AMOUNT DUE                                                             
         MVC   FULL,SUIRATE                        EMPLOYER TAX TIMES           
         ZAP   DUB,UCRSUIWQ                        TAX SUI FOR QTR              
         BRAS  RE,CALCDUE                          =TAXES DUE                   
         EDIT  (P8,DUB),(11,WHMETTAD),FILL=0       TOTAL PAYMENT DUE            
*&&                                                                             
* TOTAL AMOUNT DUE IS SAME AS COLS 123-133 (WHMETITD) AS PER EILEEN             
         MVC   WHMETTAD,WHMETITD                                                
         BRAS  RE,PUTTAPE                                                       
*                                                                               
* TOTALS RECORD - UNEMPLOYMENT                                                  
         USING UNMEWHD,R4                                                       
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
         MVI   UNRECTYP,UNRECUNEM                                               
         MVI   UNMEWID,UNMEWIDTQ                                                
         EDIT  (P4,UCRNSSN),(7,UNMETSNM),FILL=0   NUMBER OF EMPLOYEES           
         MVC   UNMETTEN,=C'WAGE'                                                
         MVC   UNMETUCA,PRINTID                                                 
         EDIT  (P8,UCRGROSQ),(14,UNMETTWG),FILL=0   GRS EARNS FOR QTR           
         ZAP   DUB,UCRGROSQ                  GROSS LESS SUI =                   
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(14,UNMETEXW),FILL=0  EXCESS WAGES (NON-TAX)            
         EDIT  (P8,UCRSUIWQ),(14,UNMETTTW),FILL=0 TAX SUI FOR QTR               
*                                                                               
***      MVC   FULL,SUIRATE                        EMPLOYER TAX TIMES           
         MVC   FULL,=F'870'    CONTRIBUTION RATE TP   .87%                      
         CLC   TGEMP,=C'PP '                                                    
         BNE   *+10                                                             
         MVC   FULL,=F'2600'    CONTRIBUTION RATE PP   2.60%                    
         CLC   TGEMP,=C'P+ '                                                    
         BNE   *+10                                                             
         MVC   FULL,=F'2600'    CONTRIBUTION RATE P+   2.60%                    
         EDIT  FULL,(4,UNMETUCR),FILL=0            CONTRIBUTION RATE            
*                                                                               
         ZAP   DUB,UCRSUIWQ                        TAX SUI FOR QTR              
         BRAS  RE,CALCDUE                          CPNTRIBUTION RATE*           
         MVC   DUB3,DUB                            TAXABLE SUI WAGES =          
         EDIT  (P8,DUB),(13,UNMETUCD),FILL=0   UC CONTRIBUTION DUE              
*                                                                               
         MVC   FULL,=F'60'                         CSSF ASSESSMENT RATE         
         EDIT  FULL,(4,UNMETCSR),FILL=0                                         
         ZAP   DUB,UCRSUIWQ                        TAXABLE SUI                  
         BRAS  RE,CALCDUE                          =TAXES DUE                   
         EDIT  (P8,DUB),(11,UNMETCSS),FILL=0     CSSF ASSESSMENT DUE            
                                                                                
         AP    DUB,DUB3              UNMETUCD+UCMETCSS                          
         EDIT  (P8,DUB),(11,UNMETCSD),FILL=0     TOTAL PAYMENT DUE              
*                                                                               
         EDIT  (P4,UCRNMTH1),(7,UNMETMN1),FILL=0                                
         EDIT  (P4,UCRNMTH2),(7,UNMETMN2),FILL=0                                
         EDIT  (P4,UCRNMTH3),(7,UNMETMN3),FILL=0                                
         EDIT  (P4,UCRNFMT1),(7,UNMETFM1),FILL=0   FEMALES - MONTH 1            
         EDIT  (P4,UCRNFMT2),(7,UNMETFM2),FILL=0   FEMALES - MONTH 2            
         EDIT  (P4,UCRNFMT3),(7,UNMETFM3),FILL=0   FEMALES - MONTH 3            
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT FINAL RECORD ON TAPE                                    
*                                                                               
         USING WHMEWHD,R4                                                       
PRMEFREC NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
         MVI   WHMEWID,WHMEWIDFQ                                                
         MVC   WHMEWYEAR,RYEAR                                                  
         MVI   WHRECTYP,WHRECWITH                                               
         EDIT  (P4,UCRNSSN),(10,WHMEFSNM),FILL=0   NUMBER OF EMPLOYEES          
         MVC   WHMEFENM,=C'0000000001'                                          
         MVC   WHMEFTEN,=C'WITH'                                                
         EDIT  (P8,UCRTAXQ),(15,WHMEFQWT),FILL=0 PER INC TAX WITHHELD           
*                                                                               
         BRAS  RE,PUTTAPE                                                       
* FINAL RECORD - UNEMPLOYMENT                                                   
         USING UNMEWHD,R4                                                       
         MVI   UNRECTYP,UNRECUNEM                                               
         MVI   UNMEWID,UNMEWIDFQ                                                
         EDIT  (P4,UCRNSSN),(10,UNMEFSNM),FILL=0 NUMBER OF EMPLOYEES            
         MVC   UNMEFENM,=C'0000000001'                                          
         MVC   UNMEFTEN,=C'WAGE'                                                
                                                                                
         EDIT  (P8,UCRGROSQ),(15,UNMEFTGW),FILL=0   GRS EARNS FOR QTR           
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO RHODE ISLAND VERSION TAPE                                
*======================================================================         
         USING TURIDSKD,R4                                                      
         USING UCRD,R3                                                          
VERRITP  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   *+12                                                             
         BRAS  RE,PRRITRAL         PROCESS T RECORD                             
         B     VERRIX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERRIX                                                           
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE POSITIVE,                     
         BE    VERRI10                                                          
         BRAS  RE,PRRIDET          PROCESS S RECORDS                            
         B     VERRIX                                                           
*                                                                               
VERRI10  BRAS  RE,ADDNEG           SKIP IF NEGATIVE                             
*                                                                               
VERRIX   XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*                                                                               
         USING UCRD,R3                                                          
         USING TURIDSKD,R4                                                      
PRRIDET  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVI   TURIID,TURIIDWQ     WAGE RECORD                                  
         MVC   TURIMAG,=C'CDFILEWGR'  MICROFILM INDEX NUMBER                    
         MVC   TURISSN,UCRSSN      SOCIAL SECURITY NUMBER                       
         MVC   TURIEMP,PRINTID     EMPLOYER NUMBER                              
         MVC   TURILNAM,W4LAST     LAST NAME                                    
         MVC   TURIFRIN,W4FRST     FIRST INITIAL                                
*                                                                               
         EDIT  (P8,UCRGROSQ),(12,TURIWAGE),FILL=0   GRS EARNS FOR QTR           
         MVC   TURIYEAR,RYEAR+2    YEAR BEING REPORTED                          
         EDIT  QQUART,TURIQRT      FILING QUARTER 1,2,3,4                       
         MVC   TURIEMPN,NAMEFLD    EMPLOYER NAME                                
         EDIT  (B1,UCRWEEK),(2,TURIWKS),ZERO=NOBLANK,FILL=0  WEEKS WRKD         
         EDIT  UCRHRSWK,(4,TURIHRS),0,ZERO=NOBLANK,FILL=0    HOURS              
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT TOTAL RECORD ON TAPE                                    
*                                                                               
         USING UCRD,R3                                                          
         USING TURIDSKD,R4                                                      
PRRITRAL NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVI   TURIID,TURIIDTQ     TOTAL RECORD                                 
         EDIT  (P8,UCRGROSQ),(12,TURIQWAG),FILL=0 GROSS EARN FOR QTR            
         EDIT  (P8,UCRGROSQ),(12,TURITWAG),FILL=0 GROSS EARN FOR QTR            
*                                                                               
         MVC   TURIMAG,=C'CDFILEWGR'  MAGNETIC TAPE RECORDER CODE               
         MVC   TURIEMP,PRINTID     EMPLOYER NUMBER                              
         MVC   TURIYEAR,RYEAR+2    YEAR BEING REPORTED                          
         EDIT  QQUART,TURIQRT      FILING QUARTER 1,2,3,4                       
         MVC   TURIEMPN,NAMEFLD    EMPLOYER NAME                                
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO PENNSYLVANIA VERSION DATASET                             
*======================================================================         
*                                                                               
VERPATP  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         USING UCRD,R3             ESTABLISH SORT RECORD                        
*                                                                               
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         USING TUPAD,R4            ESTABLISH PA RECORDS                         
*                                                                               
*        HEADER RECORD                                                          
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER  RECORD                            
         BNE   *+12                                                             
         BRAS  RE,PRPAHD              PROCESS HEADER RECORD                     
         B     VERPAX                                                           
*                                                                               
*        DETAIL RECORD                                                          
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERPADTN                                                         
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE POSITIVE,                     
         BE    VERPADT1                                                         
*                                                                               
         BRAS  RE,PRPADET             PROCESS S RECORDS                         
*                                                                               
         B     VERPAX                                                           
*                                                                               
VERPADT1 BRAS  RE,ADDNEG           SKIP IF NEGATIVE                             
*                                                                               
         B     VERPAX                                                           
*                                                                               
VERPADTN DS    0H                                                               
*                                                                               
*        TRAILER RECORD                                                         
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   VERPATRN                                                         
*                                                                               
         BRAS  RE,PRPAEMP             PROCESS HEADER   RECORD                   
*                                                                               
         B     VERPAX                                                           
*                                                                               
VERPATRN DS    0H                                                               
*                                                                               
VERPAX   XIT1                                                                   
*                                                                               
         DROP  R3,R4                                                            
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT HEADER   RECORD ON TAPE                                 
*                                                                               
PRPAHD   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         USING UCRD,R3             ESTABLISH SORT RECORD                        
         USING TUPAD,R4            ESTABLISH PA RECORDS                         
*                                                                               
         MVC   TUPAREC(TUPARECL),SPACES SET OUTPUT AREA TO SPACES               
*                                                                               
         MVI   TUPAID,TUPAIDAQ     HEADER   RECORD                              
*                                                                               
         MVI   TUPAATYP,TUPAORGQ   ORIGINAL REPORT                              
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*                                                                               
PRPAHDX  DS    0H                                                               
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
         DROP  R3,R4                                                            
*                                                                               
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*                                                                               
PRPADET  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         USING UCRD,R3             ESTABLISH SORT RECORD                        
         USING TUPAD,R4            ESTABLISH PA RECORDS                         
*                                                                               
         MVC   TUPAREC(TUPARECL),SPACES SET OUTPUT AREA TO SPACES               
*                                                                               
         MVI   TUPAID,TUPAIDSQ     EMPLOYEE RECORD                              
         MVC   TUPASEIN,SV15IDB    ZERO PADDED STATE EMPLOYER ID                
         MVC   TUPASSN,UCRSSN      EMPLOYEE SOCIAL SECURITY NUMBER              
         MVC   TUPALNAM(16),W4LASTNB   LAST NAME                                
         MVC   TUPAFNAM,W4FRST     FIRST NAME                                   
         MVC   TUPAMNAM(1),W4MID   MIDDLE INITIAL                               
*                                                                               
         EDIT  (P8,UCRGROSQ),(11,TUPAEGRS),0,ZERO=NOBLANK,FILL=0                
         MVC   TUPAETAX,=CL11'00000000000'                                      
         EDIT  (B1,UCRWEEK),(2,TUPACRWK),0,ZERO=NOBLANK,FILL=0 WKS WRKD         
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
         DROP  R3,R4                                                            
*                                                                               
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYER RECORD ON TAPE                                 
*                                                                               
PRPAEMP  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         USING UCRD,R3             ESTABLISH SORT RECORD                        
         USING TUPAD,R4            ESTABLISH PA RECORDS                         
*                                                                               
         MVC   TUPAREC(TUPARECL),SPACES SET OUTPUT AREA TO SPACES               
*                                                                               
         MVI   TUPAID,TUPAIDEQ     EMPLOYER RECORD                              
         MVC   TUPASEIN,SV15IDB    ZERO PADDED STATE EMPLOYER ID                
*                                                                               
*        FORMAT FILING PERIOD AS QYYYY                                          
*                                                                               
         MVC   TUPAPER(1),QQUART   QUARTER                                      
         OI    TUPAPER,X'F0'       MAKE SURE IT IS A CHARACTER                  
         MVC   TUPAPER+1(4),RYEAR  YEAR                                         
*                                                                               
*        NUMBER OF EMPLOYEES PER MONTH                                          
*                                                                               
         EDIT  (P4,UCRNMTH1),(5,TUPA#EM1),FILL=0                                
         EDIT  (P4,UCRNMTH2),(5,TUPA#EM2),FILL=0                                
         EDIT  (P4,UCRNMTH3),(5,TUPA#EM3),FILL=0                                
*                                                                               
         EDIT  (P8,UCRGROSQ),(13,TUPAGRST),0,FILL=0 GROSS EARN QTR              
*                                                                               
*        EMPLOYEE WITHHOLDING FOR UC DUE                                        
*                                                                               
         MVC   FULL,=F'070'                        ASSESS RATE TIMES            
         ZAP   DUB,UCRGROSQ                        TOTAL WAGES                  
         BRAS  RE,CALCDUE                          = EMP'EE ASSESSMENT          
         EDIT  (P8,DUB),(13,TUPATWHD),0,FILL=0     AMT RETURNED                 
*                                                                               
******   EDIT  (P8,UCRTAXQ),(13,TUPATWHD),0,FILL=0  L .AWITHHELD                
*                                                                               
         EDIT  (P8,UCRSUIWQ),(13,TUPATTXW),0,FILL=0 TXBLE EARN QTR              
*                                                                               
*        EMPLOYER CONTRIBUTIONS                                                 
*                                                                               
         MVC   FULL,SUIRATE                        EMPLOYER TAX TIMES           
         ZAP   DUB,UCRSUIWQ                        TAX SUI FOR QTR              
         BRAS  RE,CALCDUE                          =TAXES DUE                   
         EDIT  (P8,DUB),(13,TUPATECN),FILL=0       TOTAL PAYMENT DUE            
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*                                                                               
PRPAEMPX DS    0H                                                               
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
         DROP  R3,R4                                                            
*                                                                               
         EJECT                                                                  
*                                                                               
*                                                                               
*======================================================================         
*        ROUTINE TO DO ALASKA DATASET                                           
*======================================================================         
*                                                                               
VERAKTP  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         USING UCRD,R3             ESTABLISH SORT RECORD                        
*                                                                               
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         USING TUAKDSKD,R4         ESTABLISH PA RECORDS                         
*                                                                               
*        HEADER RECORD                                                          
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER  RECORD                            
         BE    VERAKX              NO REAL HEADER RECORD                        
*                                                                               
*        DETAIL RECORD                                                          
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERAKDTN                                                         
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE POSITIVE,                     
         BE    VERAKDT1                                                         
*                                                                               
         BRAS  RE,PRAKDET             PROCESS S RECORDS                         
*                                                                               
         B     VERAKX                                                           
*                                                                               
VERAKDT1 BRAS  RE,ADDNEG           SKIP IF NEGATIVE                             
*                                                                               
         B     VERAKX                                                           
*                                                                               
VERAKDTN DS    0H    PUT OUT HEADER AT END TO GET MONTH TOTALS                  
         BRAS  RE,PRAKHD                                                        
*                                                                               
*        TRAILER RECORD                                                         
*                                                                               
*                                                                               
VERAKTRN DS    0H                                                               
*                                                                               
VERAKX   XIT1                                                                   
*                                                                               
*        ROUTINE TO PUT HEADER   RECORD ON TAPE                                 
*                                                                               
PRAKHD   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         USING UCRD,R3             ESTABLISH SORT RECORD                        
         USING TUAKDSKD,R4         ESTABLISH AK RECORDS                         
*                                                                               
         MVC   TUAKREC(TUAKRECL),SPACES SET OUTPUT AREA TO SPACES               
*                                                                               
*                                                                               
         MVI   TUAKRID,TUAKEHDQ                                                 
*                                                                               
         MVC   TUAKEACC,PRINTID+3                                               
         MVC   TUAKRPYR,RYEAR                                                   
         EDIT  QQUART,TUAKRPQT,0,FILL=0,ZERO=NOBLANK  FILING QUARTER            
         MVI   TUAKZERO,C'N'                                                    
         MVI   TUAKWOST,C'N'                                                    
****           TUAKLEXW  EXCESS WAGES ON EMPLOYER LEVEL?                        
         ZAP   DUB,UCRGROSQ                  GROSS LESS SUI =                   
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(11,TUAKLEXW),2,FILL=0  EXCESS WAGES (NON-TAX)          
                                                                                
         EDIT  (P3,NMONTH1),(6,TUAKMON1),FILL=0  PERFS FOR MONTH 1              
         EDIT  (P3,NMONTH2),(6,TUAKMON2),FILL=0  PERFS FOR MONTH 2              
         EDIT  (P3,NMONTH3),(6,TUAKMON3),FILL=0  PERFS FOR MONTH 3              
*                                                                               
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*                                                                               
PRAKHDX  DS    0H                                                               
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
         DROP  R3,R4                                                            
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*                                                                               
PRAKDET  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         USING UCRD,R3             ESTABLISH SORT RECORD                        
         USING TUAKDSKD,R4         ESTABLISH AK RECORDS                         
         MVC   TUAKREC(TUAKRECL),SPACES SET OUTPUT AREA TO SPACES               
*                                                                               
         MVI   TUAKRID,TUAKDETQ                                                 
****     MVC   TUAKEACC,PRINTID+3                                               
         MVC   TUAKEACC,PRINTID                                                 
         MVC   TUAKRPYR,RYEAR                                                   
         EDIT  QQUART,TUAKRPQT,0,FILL=0,ZERO=NOBLANK  FILING QUARTER            
         MVC   TUAKSSN,UCRSSN                                                   
         MVC   TUAKLNAM(16),W4LASTNB   LAST NAME                                
         MVC   TUAKFNAM(15),W4FRST     FIRST NAME                               
         MVC   TUAKMNAM(1),W4MID   MIDDLE INITIAL                               
*                                                                               
         EDIT  (P8,UCRGROSQ),(9,TUAKWAGE),2,FILL=0                              
                                                                                
                                                                                
         MVC   TUAKOCOD(7),=C'27-2011'                                          
         MVC   TUAKGCOD,=C'62'                                                  
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         XIT1                                                                   
         LTORG                                                                  
         DROP  R3,R4                                                            
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO IDAHO DATASET                                            
*======================================================================         
*                                                                               
VERIDTP  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         USING UCRD,R3             ESTABLISH SORT RECORD                        
*                                                                               
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         USING TUIDDSKD,R4         ESTABLISH PA RECORDS                         
*                                                                               
*        DETAIL RECORD                                                          
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERIDDTN                                                         
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE POSITIVE,                     
         BE    VERIDDT1                                                         
*                                                                               
         BRAS  RE,PRIDDET             PROCESS S RECORDS                         
*                                                                               
         B     VERIDX                                                           
*                                                                               
VERIDDT1 BRAS  RE,ADDNEG           SKIP IF NEGATIVE                             
VERIDDTN DS    0H                                                               
*                                                                               
         B     VERIDX                                                           
*                                                                               
*                                                                               
*        TRAILER RECORD                                                         
*                                                                               
*                                                                               
VERIDTRN DS    0H                                                               
*                                                                               
VERIDX   XIT1                                                                   
*                                                                               
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                                 
*                                                                               
PRIDDET  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         USING UCRD,R3             ESTABLISH SORT RECORD                        
         USING TUIDDSKD,R4         ESTABLISH ID RECORDS                         
         MVC   TUIDREC(TUIDRECL),SPACES SET OUTPUT AREA TO SPACES               
*                                                                               
***      MVC   TUIDEACC,PRINTID+3                                               
         MVC   TUIDEACC,PRINTID                                                 
         MVC   TUIDEMPN(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
         MVC   TUIDYEAR,RYEAR                                                   
         EDIT  QQUART,TUIDRPQT,0,FILL=0,ZERO=NOBLANK  FILING QUARTER            
         MVC   TUIDSSN,UCRSSN                                                   
         MVC   TUIDLNAM(16),W4LASTNB   LAST NAME                                
         MVC   TUIDFNAM(15),W4FRST     FIRST NAME                               
         MVC   TUIDMNAM(1),W4MID   MIDDLE INITIAL                               
*                                                                               
         EDIT  (P8,UCRGROSQ),(9,TUIDWAGE),2,ALIGN=LEFT                          
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
         DROP  R3,R4                                                            
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*                                                                               
*======================================================================         
*        ROUTINE TO DO FLORIDA VERSION TAPE                                     
*======================================================================         
*                                                                               
         USING UCRD,R3                                                          
*                                                                               
VERFLTP  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BRAS  RE,PRFLHEAD         PROCESS A AND E RECORDS                      
         B     VERFLX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   *+12                                                             
         BRAS  RE,PRFLTRAL         PROCESS T AND P RECORDS                      
         B     VERFLX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERFLX                                                           
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE NEGATIVE                      
         BNE   VRFLTP10            DON'T PUT RECORD TO TAPE                     
*                                                                               
         BRAS  RE,ADDNEG                                                        
*                                                                               
         B     VERFLX              DON'T PUT RECORD TO TAPE                     
*                                                                               
VRFLTP10 BRAS  RE,PRFLDET          PROCESS S RECORDS                            
*                                                                               
         B     VERFLX                                                           
*                                                                               
VERFLX   XIT1                                                                   
*                                                                               
         DROP  R3                                                               
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT FIRST AND SECOND RECORDS ON TAPE              *         
*                                                                     *         
*======================================================================         
         SPACE 2                                                                
PRFLHEAD NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BRAS  RE,PRFLAREC         PUT A RECORD TO TAPE                         
*                                                                               
         BRAS  RE,PRFLEREC         PUT E RECORD TO TAPE                         
*                                                                               
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                       *         
*                                                                     *         
*======================================================================         
         SPACE 2                                                                
PRFLDET  NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,PRFLSREC         PUT S RECORD TO TAPE                         
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT LAST RECORDS ON TAPE                          *         
*                                                                     *         
*======================================================================         
         SPACE 2                                                                
PRFLTRAL NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BRAS  RE,PRFLTREC         PUT T RECORD TO TAPE                         
*                                                                               
         BRAS  RE,PRFLXREC         PUT X RECORD TO TAPE                         
*                                                                               
         BRAS  RE,PRFLPREC         PUT P RECORD TO TAPE                         
*                                                                               
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT FIRST RECORD ON TAPE                          *         
*                                                                     *         
*======================================================================         
         SPACE 2                                                                
         USING TUFLDSKD,R4                                                      
*                                                                               
PRFLAREC NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUFLID,=C'00'       RECORD   ID                                  
         MVC   TUFLEIN,FDID        FEDERAL  ID NUMBER                           
         MVC   TUFLEID,PRINTID     EMPLOYER UT #                                
*                                                                               
         BRAS  RE,PUTTAPE          WRITE RECORD TO TAPE                         
*                                                                               
         XIT1                                                                   
*                                                                               
         DROP  R4                                                               
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT EMPLOYER RECORD ON TAPE                       *         
*                                                                     *         
*======================================================================         
*                                                                               
         USING TUFLDSKD,R4                                                      
*                                                                               
PRFLEREC NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUFLID,=C'01'                   RECORD ID                        
         MVC   TUFLFEIN,FDID                   EIN FROM EMTAX REC               
         MVC   TUFLEID2,PRINTID                EMPLOYER ID#                     
*                                                                               
         MVC   TUFLENAM(L'NAMEFLD),NAMEFLD     EMPLOYER NAME                    
*                                                                               
         MVC   TUFLEADD(L'EMPADDR),EMPADDR              ADDRESS                 
         MVC   TUFLECTY(L'EMPCITY),EMPCITY              CITY                    
         MVC   TUFLESTA(L'EMPSTATE),EMPSTATE            STATE                   
         MVC   TUFLEZIP(L'EMPZIP),EMPZIP                ZIP CODE                
*                                                                               
         CLC   TUFLEZIP+5(4),=C'    '  IF NON EXTENDED ZIP                      
         BH    *+10                                                             
         MVC   TUFLEZIP+5(4),=C'9999'     FILL WITH 9'S                         
*                                                                               
         MVC   TUFLYEAR,RYEAR                   FILING YEAR                     
         EDIT  QQUART,TUFLQRTR,0,FILL=0,ZERO=NOBLANK  FILING QUARTER            
*                                                                               
         BRAS  RE,PUTTAPE          PUT RECORD TO TAPE                           
*                                                                               
         XIT1                                                                   
*                                                                               
         DROP  R4                                                               
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT EMPLOYEE RECORD ON TAPE                       *         
*                                                                     *         
*======================================================================         
*                                                                               
         USING UCRD,R3                                                          
*                                                                               
         USING TUFLDSKD,R4                                                      
*                                                                               
PRFLSREC NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUFLID,=C'02'       SET RECORD ID                                
*                                                                               
         MVC   TUFLSSN,UCRSSN         SSN                                       
*                                                                               
         MVC   TUFLFNAM,UCRFRST       FIRST NAME                                
         GOTOR SPCCHAR,DMCB,(L'TUFLFNAM,TUFLFNAM)  HANDLE SPEC CHS              
*                                                                               
         MVC   TUFLMNAM,UCRMID        MIDDLE                                    
*                                                                               
         MVC   TUFLLNAM,SPACES        LAST                                      
         MVC   TUFLLNAM(L'UCRLAST),UCRLAST                                      
         LA    R0,X'80'+L'TUFLLNAM   SPACE IS SPECIAL CHARACTER                 
*                                                                               
         GOTOR SPCCHAR,DMCB,((R0),TUFLLNAM)  HANDLE SPEC CHS                    
*                                                                               
PRFLS20  EDIT  (P8,UCRGROSQ),(11,TUFLGROS),0,FILL=0 GRS QTR EARNINGS            
         EDIT  (P8,UCRSUIWQ),(11,TUFLTAXW),0,FILL=0 STATE TAX WAGES             
*                                                                               
*                                                   OUT OF STATE                
         EDIT  (P8,UCROOSGW),(11,TUFLOUTW),0,FILL=0 GROSS WAGES                 
         EDIT  (P8,UCROOSTW),(11,TUFLOUTT),0,FILL=0 TAXABLE WAGES               
         MVC   TUFLTST,UCROOSST       OUT OF STATE TAX STATE                    
         MVC   TUFLCEIW,=11C'0'       CONTRACTED TO EDUCATIONAL                 
*                                     INSTITUTIONAL WAGES                       
*                                                                               
***      MVC   TUFLOUTW,=11C'0'       OUT OF STATE WAGES                        
***      MVC   TUFLOUTT,=11C'0'       OUT OF STATE TAXABLE WAGES                
***      MVC   TUFLTST,=C'  '         OUT OF STATE TAX STATE                    
*                                                                               
         BRAS  RE,PUTTAPE          WRITE RECORD TO FILE                         
*                                                                               
         XIT1                                                                   
*                                                                               
         DROP  R3,R4                                                            
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO STRIP SPECIAL CHARACTERS FROM A FIELD             *         
*                                                                     *         
* PARM0+0     X'80'  STRIP INTERNAL SPACES                            *         
*                    LENGTH OF INPUT                                  *         
* PARM0+1(3)  A(INPUT)                                                *         
*                                                                     *         
*        NOTE - USES WORKAREA WORK                                    *         
*                                                                     *         
*======================================================================         
*                                                                               
         USING UCRD,R3                                                          
*                                                                               
         USING TUFLDSKD,R4                                                      
*                                                                               
SPCCHAR  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVC   SCHLEN,0(R1)        SAVE LENGTH/OPTION BYTE                      
         NI    SCHLEN,X'FF'-X'80'  TURN OFF SPACE OPTION TO LEAVE LEN           
*                                                                               
         CLI   SCHLEN,0            SKIP IF NO INPUT                             
         BE    SPCCHARX                                                         
*                                                                               
         LLC   RF,SCHLEN           GET INPUT LENGTH                             
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
         L     RE,0(R1)            POINT TO INPUT                               
*                                                                               
         EX    RF,*+8                                                           
         B     *+10                                                             
         TR    0(0,RE),CHARTAB     GET RID OF SPECIAL CHARACTERS                
*                                                                               
         B     SPCCHARX            WE AREN'T STRIPPING SPECIAL                  
*                                     CHARACTERS AT THE MOMENT                  
*                                                                               
         MVC   WORK,SPACES         INIT WORKAREA                                
         LLC   R0,SCHLEN           GET FIELD LENGTH                             
         L     RE,0(R1)            POINT TO START OF INPUT                      
         LA    RF,WORK             POINT TO WORKAREA                            
*                                                                               
SCHLOOP  DS    0H                  MOVE ACCEPTABLE CHARS TO WORK                
*                                                                               
         CLI   0(RE),0             SKIP IF SPECIAL CHARACTER                    
         BE    SCHCONT                                                          
*                                                                               
         TM    0(R1),X'80'         IF C' ' IS SPECIAL                           
         BNO   *+12                                                             
         CLI   0(RE),C' '             SKIP SPACES                               
         BE    SCHCONT                                                          
*                                                                               
         MVC   0(1,RF),0(RE)       MOVE CHARACTER TO WORKAREA                   
*                                                                               
         LA    RF,1(RF)            BUMP WORKAREA POINTER                        
*                                                                               
SCHCONT  DS    0H                                                               
         LA    RE,1(RE)            BUMP INPUT POINTER                           
         BCT   R0,SCHLOOP                                                       
*                                                                               
SCHDONE  DS    0H                                                               
*                                                                               
         LLC   RF,SCHLEN           GET INPUT LENGTH                             
         L     RE,0(R1)            GET INPUT ADDRESS                            
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
*                                                                               
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),SPACES      INIT INPUT FIELD                             
*                                                                               
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),WORK        REPLACE INPUT FIELD                          
*                                                                               
SPCCHARX DS    0H                                                               
         XIT1                                                                   
*                                                                               
SCHLEN   DS    XL1                 INPUT LENGTH                                 
*                                                                               
         LTORG                                                                  
*                                                                               
*        THIS TABLE TRANSLATES ALL SPECIAL CHARACTERS TO BLANKS                 
*        IF BASE VALUE IN DEFINITION IS X'00' THEN YOU                          
*        CAN ACTIVATE THE CODE THAT STRIPS OUT SPECIAL CHARACTERS               
*                                                                               
CHARTAB  DS    0D                  TABLE OF ALLOWABLE CHARACTERS                
         DC    256C' '                                                          
         ORG   CHARTAB+C' '                                                     
         DC    C' '                                                             
         ORG   CHARTAB+C'A'                                                     
         DC    C'ABCDEFGHI'                                                     
         ORG   CHARTAB+C'J'                                                     
         DC    C'JKLMNOPQR'                                                     
         ORG   CHARTAB+C'S'                                                     
         DC    C'STUVWXYZ'                                                      
         ORG                                                                    
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT TOTAL RECORD ON TAPE                          *         
*                                                                     *         
*======================================================================         
*                                                                               
         USING UCRD,R3                                                          
*                                                                               
         USING TUFLDSKD,R4                                                      
*                                                                               
PRFLTREC NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUFLID,=C'03'       TOTAL RECORD ID                              
*                                                 COVERED WORKERS               
         EDIT  (P4,UCRNMTH1),(7,TUFLMTH1),0,ZERO=NOBLANK,FILL=0 MTH1            
         EDIT  (P4,UCRNMTH2),(7,TUFLMTH2),0,ZERO=NOBLANK,FILL=0 MTH2            
         EDIT  (P4,UCRNMTH3),(7,TUFLMTH3),0,ZERO=NOBLANK,FILL=0 MTH3            
*                                                                               
         BRAS  RE,PUTTAPE          PUT TOTAL RECORD TO FILE                     
*                                                                               
         XIT1                                                                   
*                                                                               
         DROP  R3,R4                                                            
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT EXTRA TOTAL RECORD ON TAPE                    *         
*                                                                     *         
*======================================================================         
         SPACE 2                                                                
*                                                                               
         USING UCRD,R3                                                          
*                                                                               
         USING TUFLDSKD,R4                                                      
*                                                                               
PRFLXREC NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUFLID,=C'RX'                                                    
*                                                                               
         EDIT  (P8,UCRGROSQ),(15,TUFLTGRS),0,FILL=0 TOTAL GROSS WAGES           
         EDIT  (P8,UCRSUIWQ),(15,TUFLTTAX),0,FILL=0 TOTAL TAX SUI               
*                                                                               
         ZAP   DUB,UCRGROSQ                  GROSS LESS SUI =                   
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(11,TUFLEXCW),0,FILL=0  EXCESS WAGES (NON-TAX)          
*                                                                               
         MVC   FULL,SUIRATE                 EMPLOYER TAX TIMES                  
         ZAP   DUB,UCRSUIWQ                 TAX SUI FOR QTR                     
         BRAS  RE,CALCDUE                   =TAXES DUE                          
         EDIT  (P8,DUB),(11,TUFLTAXD),0,FILL=0  TAX DUE                         
*                                                                               
         AP    DUB,UCRTAXQ                  UC CONT. + TAX WITHHELD             
         EDIT  (P8,DUB),(11,TUFLPAYA),0,FILL=0  =TOTAL DUE                      
*                                                                               
         MVC   TUFLINT,=9C'0'                                                   
         MVC   TUFLPEN,=9C'0'                                                   
*                                                                               
         MVC   TUFLCNAM,=CL27'DANIELLE KOSCHIL' CONTACT NAME                    
         MVC   TUFLCPHN,=CL10'3129237900'       CONTACT PHONE                   
         MVC   TUFLCEML,=CL50'DKOSCHIL@TALENTPARTNERS.COM'  EMAIL               
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         XIT1                                                                   
*                                                                               
         DROP  R3,R4                                                            
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*                                                                     *         
*        ROUTINE TO PUT FINAL RECORD ON TAPE                          *         
*                                                                     *         
*======================================================================         
         SPACE 2                                                                
         USING UCRD,R3                                                          
         USING TUFLDSKD,R4                                                      
*                                                                               
PRFLPREC NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUFLID,=C'99'                                                    
*                                                                               
         GOTOR DATCON,DMCB,(5,0),(X'34',TUFLSBDT)  SUBMISSION DATE              
*                                                                               
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         XIT1                                                                   
*                                                                               
         DROP  R3,R4                                                            
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO HAWAII VERSION TAPE                                      
*======================================================================         
         USING UCRD,R3                                                          
VERHITP  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BRAS  RE,PRHIHEAD         PROCESS E RECORD                             
         B     VERHIX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   *+12                                                             
         BRAS  RE,PRHITRAL         PROCESS T RECORD                             
         B     VERHIX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERHIX                                                           
         LH    RE,HICOUNT          KEEP RUNNING TOTALS FOR 14 PEOPLE            
         AHI   RE,1                INCREMENT HICOUNT                            
         CHI   RE,14               IF HICOUNT > 14,                             
         BNH   VRHI10                                                           
         LHI   RE,1                RESET HICOUNT TO 1                           
         ZAP   HITOT14,=P'0'       RESET HAWAII TOTAL 14 TO ZERO                
VRHI10   STH   RE,HICOUNT                                                       
         BRAS  RE,PRHIDET          PROCESS S RECORDS                            
         B     VERHIX                                                           
*                                                                               
VERHIX   XIT1                                                                   
         DROP  R3                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT FIRST RECORD ON TAPE                                    
*                                                                               
         USING TUHIDSKD,R4                                                      
PRHIHEAD NTR1  BASE=*,LABEL=*                                                   
         ZAP   HITOT14,=P'0'       SET HAWAII TOTAL 14 TO ZERO                  
*                                                                               
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUHIID,=C'RE'                                                    
         MVC   TUHIBAT,LTZEROHI    BATCH NUMBER - ZEROS                         
         MVC   TUHIEID,PRINTID     EMPLOYER ID NUMBER                           
         MVC   TUHIQDTE(2),RPTMMYR MONTH                                        
         BRAS  RE,SETDAY2          SET DAY OF QUARTER END                       
         MVC   TUHIQDTE+2(2),HALF  DAY - 30 OR 31                               
         MVC   TUHIQDTE+4(2),RYEAR+2  QUARTER ENDING - MMDDYY                   
         MVC   TUHIDLQ,LTZEROHI    DELINQENT DATE - ZEROS                       
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R4                                                               
LTZEROHI DC    C'000000000000000000000000'                                      
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT DETAIL RECORD ON TAPE                                   
*                                                                               
         USING UCRD,R3                                                          
         USING TUHIDSKD,R4                                                      
PRHIDET  NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUHIID,=C'RS'                                                    
         MVC   TUHISSN,UCRSSN         SSN                                       
*                                                                               
         BAS   RE,SETHINM             SET NAME IN BLOCK LAST, FIRST MI          
         MVC   TUHINAME,BLOCK                                                   
         OC    TUHINAME,MYSPACES                                                
*                                                                               
         EDIT  (P8,UCRGROSQ),(13,TUHIGROS),2,FILL=0 GRS QTR EARNINGS            
         AP    HITOT14,UCRGROSQ              UPDATE RUNNING TOTAL               
         EDIT  (P8,HITOT14),(15,TUHIRTOT),2,FILL=0   RUNNING TOT 14 PPL         
*                                                                               
         GOTO1 DATCON,DMCB,(5,0),(20,WORK)          TODAY'S DATE                
         MVC   TUHIDATE(4),WORK+4                   MMDDYY                      
         MVC   TUHIDATE+4(2),WORK+2                                             
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         DROP  R3,R4                                                            
*                                                                               
*        SET NAME IN BLOCK - LAST NAME, FIRST NAME MI                           
*                                                                               
         USING UCRD,R3                                                          
SETHINM  NTR1                                                                   
         MVC   BLOCK(120),MYSPACES                                              
         MVC   BLOCK(L'UCRLAST),UCRLAST                                         
         LA    RE,BLOCK               RE --> BLOCK                              
         LA    RF,BLOCK                                                         
         AHI   RF,L'UCRLAST           RF --> END OF LAST NAME                   
PRHID10  CR    RE,RF                                                            
         BNH   *+6                                                              
         DC    H'00'                                                            
         CLI   0(RE),C' '             LOOK FOR FIRST SPACE                      
         BNH   PRHID20                                                          
         AHI   RE,1                                                             
         B     PRHID10                                                          
PRHID20  MVI   0(RE),C','             PUT COMMA AFTER LAST NAME                 
*                                                                               
         MVC   BLOCK+L'UCRLAST+2(L'UCRFRST),UCRFRST                             
         MVC   BLOCK+L'UCRLAST+L'UCRFRST+3(1),UCRMID                            
         GOTO1 SQUASHER,DMCB,BLOCK,120                                          
         XIT1                                                                   
         DROP  R3                                                               
*                                                                               
MYTOTAL  DS    PL8                                                              
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT TRAILER RECORD ON TAPE                                  
*                                                                               
         USING TUHIDSKD,R4                                                      
PRHITRAL NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         MVC   TUHIID,=C'RT'                                                    
         EDIT  (P8,HITOT14),(15,TUHIRTOT),2,FILL=0 TOTAL UP TO 14 PPL           
*                                                                               
         GOTO1 DATCON,DMCB,(5,0),(20,WORK)          TODAY'S DATE                
         MVC   TUHIDATE(4),WORK+4                   MMDDYY                      
         MVC   TUHIDATE+4(2),WORK+2                                             
*                                                                               
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
*======================================================================         
*        ROUTINE TO DO MMREF VERSION TAPE                                       
*======================================================================         
         USING UCRD,R3                                                          
VERMMREF NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPCE2         PRESET TAPE AREA TO SPACES                   
*                                                                               
         CLI   UCRTYPE,UCRTHEAD    IF HEADER RECORD                             
         BNE   *+12                                                             
         BRAS  RE,PRMMHEAD         PROCESS A AND E RECORDS                      
         B     VERMMX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTRAIL    IF TRAILER RECORD                            
         BNE   *+12                                                             
         BRAS  RE,PRMMTRAL         PROCESS F RECORD                             
         B     VERMMX                                                           
*                                                                               
         CLI   UCRTYPE,UCRTDET     IF DETAIL RECORD                             
         BNE   VERMMX                                                           
*                                                                               
         CLI   UCRSIGN,C'N'        IF AMOUNTS ARE POSITIVE,                     
         BE    VERMM10                                                          
*                                                                               
         BRAS  RE,PRMMDET             PROCESS RECORDS                           
*                                                                               
         B     VERMMX                                                           
*                                                                               
VERMM10  BRAS  RE,ADDNEG           SKIP IF NEGATIVE                             
*                                                                               
VERMMX   XIT1                                                                   
         DROP  R3                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT FIRST AND SECOND RECORDS ON TAPE                        
*                                                                               
PRMMHEAD NTR1                                                                   
*                                                                               
         USING UCRD,R3                                                          
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
*                                                                               
         CLC   =C'VA ',UCRSTATE    SKIP IF VIRGINIA                             
         BE    *+12                                                             
         BRAS  RE,MMREFRA          PUT A RECORD TO TAPE                         
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         BRAS  RE,MMREFRE          PUT E RECORD TO TAPE                         
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         XIT1                                                                   
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT THIRD RECORD ON TAPE                                    
*                                                                               
PRMMDET  NTR1                                                                   
         BRAS  RE,MMREFRS          PUT S RECORD TO TAPE                         
         BRAS  RE,PUTTAPE                                                       
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        ROUTINE TO PUT LAST RECORD ON TAPE                                     
*                                                                               
PRMMTRAL NTR1                                                                   
*                                                                               
         CLC   =C'SC ',UCRSTATE    IF SOUTH CAROLINA                            
         BNE   *+12                                                             
         BRAS  RE,MMREFRT          PUT T RECORD TO TAPE                         
         BRAS  RE,PUTTAPE                                                       
*                                                                               
         BRAS  RE,MMREFRF          PUT F RECORD TO TAPE                         
         BRAS  RE,PUTTAPE                                                       
*                                                                               
PRMMTRAX DS    0H                                                               
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*====================================================================           
*        MOVE SPACES TO RECORD (R4 POINTS TO RECORD)                            
*        (MAX - ONLY NEED 300 BYTES)                                            
*====================================================================           
MVCSPCE2 NTR1  BASE=*,LABEL=*                                                   
         LA    R4,TAPEIO                                                        
         MVC   0(132,R4),MYSPACES                                               
         MVC   132(132,R4),MYSPACES                                             
         MVC   264(132,R4),MYSPACES                                             
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*====================================================================           
*        SET DAY OF QUARTER ENDING MONTH                                        
*====================================================================           
SETDAY2  NTR1  BASE=*,LABEL=*                                                   
         MVC   HALF,=C'31'                                                      
         CLI   QQUART,1                                                         
         BE    SDAY2X                                                           
         CLI   QQUART,4                                                         
         BE    SDAY2X                                                           
         MVC   HALF,=C'30'                                                      
SDAY2X   XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*====================================================================           
*        GET EMTAX RECORD TO FIND WITHHOLDING ACCOUNT NUMBER                    
*====================================================================           
         USING UCRD,R3                                                          
GETEMTAX NTR1  BASE=*,LABEL=*                                                   
         MVC   SVEMTAX,MYSPACES                                                 
*                                                                               
         MVC   AIO,AIO2                                                         
         GOTO1 RECVAL,DMCB,TLEXCDQ,(X'A4',0)  READ EMTAX RECORD                 
         BNE   GEMTAXX                                                          
*                                                                               
         L     R4,AIO                                                           
         MVI   ELCODE,TATIELQ                                                   
         MVI   WORK,TATITYTX                                                    
         MVC   WORK+1(L'UCRSTATE),UCRSTATE                                      
         GOTO1 GETL,DMCB,(4,WORK)                                               
         BNE   GEMTAXX                                                          
*                                                                               
         MVI   BYTE,C'R'      RIGHT PAD WITH ZEROS                              
         GOTOR SETID,DMCB,(L'SVEMTAX,SVEMTAX)                                   
*                                                                               
GEMTAXX  MVC   AIO,AIO1                                                         
         XIT1                                                                   
         DROP  R3                                                               
         LTORG                                                                  
         EJECT                                                                  
*====================================================================           
*        EFW2 FORMAT, RA RECORD                                                 
*====================================================================           
         USING UCRD,R3                                                          
         USING DRADSECT,R4                                                      
EFW2RA   NTR1  BASE=*,LABEL=*                                                   
         LA    R0,DRA                                                           
         LHI   R1,512                                                           
         XR    RE,RE                                                            
         XR    RF,RF                                                            
         LA    RF,X'40'                                                         
         SLL   RF,24                                                            
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
         MVC   DRAID,=C'RA'                                                     
                                                                                
         MVC   DRAFEIN,FDID                                                     
                                                                                
         MVI   DRARESUB,C'0'                                                    
         MVC   DRACPNAM(L'NAMEFLD),NAMEFLD                                      
                                                                                
         MVC   DRAMADD(21),=C'400 N MICHIGAN AVENUE'                            
         MVC   DRAMCTY,EMPCITY                                                  
         MVC   DRAMSTA,EMPSTATE                                                 
         MVC   DRAMZIP,EMPZIP                                                   
         MVC   DRAMZIPX,EMPZIP+5                                                
         MVC   DRAMATTN(10),=C'14TH FLOOR'                                      
                                                                                
                                                                                
         MVC   DRASBNAM(L'NAMEFLD),NAMEFLD     SUBMITTER                        
         MVC   DRALADD(10),=C'14TH FLOOR'                                       
         MVC   DRADADD(21),=C'400 N MICHIGAN AVENUE'                            
         MVC   DRACITY,EMPCITY                                                  
         MVC   DRASTAT,EMPSTATE                                                 
         MVC   DRAZIP,EMPZIP                                                    
         MVC   DRAZIPX,EMPZIP+5                                                 
                                                                                
         MVC   DRACNAM,=CL27'DANIELLE KOSCHIL'                                  
         MVC   DRACPH3,=CL15'3129237900'    CONTACT PHONE NUMBER                
         MVC   DRACPHX,=CL5'7903'          CONTACT PHONE EXTENSION              
         MVC   DRACEML,=CL40'DKOSCHIL@TALENTPARTNERS.COM'                       
         MVC   DRACFAX,=CL10'3129237983'    CONTACT FAX                         
                                                                                
*                                                                               
EFW2RAX  XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        EFW2 FORMAT, RV RECORD          EMPLOYER TOTALS                        
*====================================================================           
         USING UCRD,R3                                                          
         USING DRVDSECT,R4                                                      
EFW2RV   NTR1  BASE=*,LABEL=*                                                   
         LA    R0,DRV                                                           
         LHI   R1,512                                                           
         XR    RE,RE                                                            
         XR    RF,RF                                                            
         LA    RF,X'40'                                                         
         SLL   RF,24                                                            
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
                                                                                
         MVC   DRVID,=C'RV'                                                     
                                                                                
*                                                                               
         EDIT  (C15,SV15IDB),(15,DRVACTNM),ALIGN=RIGHT,FILL=0                   
*                                                                               
         MVC   DRVREPD(2),RPTMMYR  REPORTING PERIOD                             
         MVC   DRVREPD+2(4),RYEAR                                               
                                                                                
         MVC   DRVGWAGE(L'LTZERO),LTZERO                                        
         MVC   DRVTXWAG(L'LTZERO),LTZERO                                        
         MVC   DRVEXNTW(L'LTZERO),LTZERO                                        
         EDIT  (P8,UCRGROSQ),(15,DRVGWAGE+5),FILL=0,ALIGN=RIGHT                 
         EDIT  (P8,UCRSUIWQ),(15,DRVTXWAG+5),FILL=0,ALIGN=RIGHT                 
         ZAP   DUB,UCRGROSQ                  GROSS LESS SUI =                   
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(15,DRVEXNTW+5),FILL=0  EXCESS WAGES                    
         EDIT  (P3,NMONTH1),(5,DRVEMON1),FILL=0  PERFS FOR MONTH 1              
         EDIT  (P3,NMONTH2),(5,DRVEMON2),FILL=0  PERFS FOR MONTH 2              
         EDIT  (P3,NMONTH3),(5,DRVEMON3),FILL=0  PERFS FOR MONTH 3              
                                                                                
                                                                                
*                                                                               
EFW2RVX  XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        EFW2 FORMAT, RS RECORD          EMPLOYEE WAGE RECORD                   
*====================================================================           
         USING UCRD,R3                                                          
         USING DRSDSECT,R4                                                      
EFW2RS   NTR1  BASE=*,LABEL=*                                                   
         LA    R0,DRS                                                           
         LHI   R1,512                                                           
         XR    RE,RE                                                            
         XR    RF,RF                                                            
         LA    RF,X'40'                                                         
         SLL   RF,24                                                            
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         MVC   DRSID,=C'RS'                                                     
                                                                                
         MVC   DRSSSN,UCRSSN                                                    
         MVC   DRSFNAM,UCRFRST                                                  
         MVC   DRSMNAM,UCRMID                                                   
         MVC   DRSLNAM(L'UCRLAST),UCRLAST                                       
         MVC   DRSADJR,=C'00'      ADJUSTMENT REASON CODE - ORIGINAL            
         MVC   DRSRPER(2),RPTMMYR    REPORTING PERIOD                           
         MVC   DRSRPER+2(4),RYEAR                                               
         EDIT  (P8,UCRGROSQ),(11,DRSGWAGE),FILL=0 GRS QTR EARNINGS              
                                                                                
         MVI   DRSOREL,C'0'                                                     
         EDIT  UCRHRSWK,(3,DRSHRSWK),0,ZERO=NOBLANK,FILL=0    HOURS             
                                                                                
         MVC   DRSEACTN+5(L'SV15IDB),SV15IDB    STATE ACCOUNT NUMBER            
                                                                                
*                                                                               
EFW2RSX  XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        EFW2 FORMAT, RF RECORD          EMPLOYEE WAGE RECORD                   
*====================================================================           
         USING UCRD,R3                                                          
         USING DRFDSECT,R4                                                      
EFW2RF   NTR1  BASE=*,LABEL=*                                                   
         LA    R0,DRF                                                           
         LHI   R1,512                                                           
         XR    RE,RE                                                            
         XR    RF,RF                                                            
         LA    RF,X'40'                                                         
         SLL   RF,24                                                            
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         MVC   DRFID,=C'RF'                                                     
                                                                                
         MVC   DRFTOTW(L'LTZERO),LTZERO                                         
         EDIT  (P4,UCRNSSN),(9,DRFNMRS),ALIGN=RIGHT,FILL=0  # OF RS REC         
***      EDIT  (P8,UCRGROSQ),(14,DRFTOTW),FILL=0 GRS EARNINGS FOR QTR           
         EDIT  (P8,UCRGROSQ),(15,DRFTOTW+5),FILL=0 GRS EARNINGS FOR QTR         
                                                                                
*                                                                               
EFW2RFX  XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        MMREF FORMAT, RA RECORD                                                
*====================================================================           
         USING UCRD,R3                                                          
         USING FRADSECT,R4                                                      
MMREFRA  NTR1  BASE=*,LABEL=*                                                   
         MVI   FRA,C' '                                                         
         MVC   FRA+1(255),FRA                                                   
         MVC   FRA+256(256),FRA                                                 
*                                                                               
         MVC   FRAID,=C'RA'                                                     
*                                                                               
         CLC   =C'SC ',UCRSTATE    SOUTH CAROLINA?                              
         BE    MMRA10                                                           
         CLC   =C'LA ',UCRSTATE    LOUISIANA?                                   
         BE    MMRA20                                                           
*                                                                               
         MVC   FRAEIN,FDID         EMPLOYER ID #                                
         MVI   FRAAGTID,C'E'                                                    
         MVC   FRAAGTID+1(7),PRINTID                                            
         MVC   FRAENAM(L'NAMEFLD),NAMEFLD                                       
         MVC   FRACNAME,=CL27'DANIELLE KOSCHIL'                                 
         MVC   FRACPHN,=CL15'3129237900'    CONTACT PHONE NUMBER                
         MVC   FRACPHNX,=CL5'7903'          CONTACT PHONE EXTENSION             
         MVC   FRACEMAL,=CL40'DKOSCHIL@TALENTPARTNERS.COM'                      
         MVC   FRACFAX,=CL10'3129237983'    CONTACT FAX                         
         B     MMREFRAX                                                         
*                                                                               
MMRA10   MVC   FRASOFTC,=C'98'     SOFTWARE CODE                                
MMRA20   MVC   FRAENAM2(L'NAMEFLD),NAMEFLD    SUBMITTER NAME                    
         MVC   FRALADD,EMPADDR     LOCATION ADDRESS                             
         MVC   FRADADD,EMPADDR     DELIVERY ADDRESS                             
         MVC   FRACITY,EMPCITY                                                  
         MVC   FRASTAT,EMPSTATE                                                 
         MVC   FRAZIP,EMPZIP                                                    
         MVC   FRACNAM2,=CL27'DANIELLE KOSCHIL'                                 
         MVC   FRACPH2,=CL15'3129237900'    CONTACT PHONE NUMBER                
         CLC   =C'SC ',UCRSTATE    SOUTH CAROLINA?                              
         BE    MMRA200                                                          
         MVC   FRACPHX2,=CL5'7903'          CONTACT PHONE EXTENSION             
         MVC   FRACFAX2,=CL10'3129237983'   CONTACT FAX                         
         B     MMREFRAX                                                         
*                                                                               
MMRA200  MVI   FRAPREPC,C'L'       PREPARED - SELF PREPARED                     
*                                                                               
MMREFRAX XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        MMREF FORMAT, RE RECORD                                                
*====================================================================           
         USING FREDSECT,R4                                                      
MMREFRE  NTR1  BASE=*,LABEL=*                                                   
         MVI   FRE,C' '                                                         
         MVC   FRE+1(255),FRE                                                   
         MVC   FRE+256(256),FRE                                                 
*                                                                               
         MVC   FREID,=C'RE'                                                     
         MVC   FREENAM(L'NAMEFLD),NAMEFLD                                       
         MVC   FREDADD,EMPADDR                                                  
         MVC   FRECITY,EMPCITY                                                  
         MVC   FRESTAT,EMPSTATE                                                 
         MVC   FREZIP,EMPZIP                                                    
*                                                                               
         CLC   =C'SC ',UCRSTATE    IF SOUTH CAROLINA                            
         BNE   MMRE10                                                           
         MVC   FREYEAR,RYEAR       REPORT YEAR                                  
         MVC   FRELADD,EMPADDR     LOCATION ADDRESS                             
         MVI   FREEMPCD,C'R'       EMPLOYMENT CODE = REGULAR                    
         B     MMREFREX                                                         
*                                                                               
MMRE10   CLC   =C'FL ',UCRSTATE    IF FLORIDA                                   
         BNE   MMRE20                                                           
         MVC   FREFEIN,FDID                                                     
         B     MMREFREX                                                         
*                                                                               
MMRE20   CLC   =C'LA ',UCRSTATE    IF LOUISIANA                                 
         BE    *+10                                                             
         CLC   =C'VA ',UCRSTATE    OR VIRGINIA                                  
         BNE   MMREFREX                                                         
*                                                                               
         MVC   FREYEAR,RYEAR       REPORT YEAR                                  
         MVC   FREFEIN,FDID        FED EIN                                      
         MVI   FRETRMB,C'0'        TERMINATING BUSINESS INDICATOR               
         MVC   FRELADD,EMPADDR     LOCATION ADDRESS                             
*                                                                               
         CLC   =C'VA ',UCRSTATE    IF VIRGINIA                                  
         BNE   MMRE22                                                           
*                                                                               
         MVI   FREEMPCD,C'R'       EMPLOYMENT CODE - REGULAR                    
         MVI   FRESCKPY,C'0'       SICK PAY INDICATOR                           
*                                                                               
         B     MMREFREX                                                         
*                                                                               
MMRE22   DS    0H                                                               
*                                                                               
         MVI   FRETXTP,C'B'        TAX TYPE                                     
         MVC   FRESTCD,TGTANUM     STATE CODE                                   
         MVC   FRERTPD(2),RPTMMYR  REPORTING PERIOD                             
         MVC   FRERTPD+2(4),RYEAR                                               
         MVC   FREBLK,=C'25'       BLOCKING FACTOR                              
         MVC   FRESUI,SVID         STATE ACCOUNT NUMBER                         
         MVC   FREZERO,=C'000'     ZEROS                                        
         MVI   FREELCF,C'1'        ELECTRONIC FUNDS TRANSFER INDICATOR          
*                                                                               
MMREFREX XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        MMREF FORMAT, RS RECORD                                                
*====================================================================           
         USING FRSDSECT,R4                                                      
MMREFRS  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVI   FRS,C' '            INIT RECORD                                  
         MVC   FRS+1(255),FRS                                                   
         MVC   FRS+256(256),FRS                                                 
*                                                                               
         MVC   FRSID,=C'RS'        RECORD TYPE                                  
         MVC   FRSSCODE,TGTANUM       STATE CODE                                
*                                                                               
         CLC   =C'VA ',UCRSTATE       IF VIRGINIA                               
         BNE   *+8                                                              
         MVI   FRSTAXCD,C'B'             TAXING ENTITY CODE                     
*                                                                               
         MVC   FRSSS,UCRSSN           SSN                                       
*                                                                               
         CLC   =C'SC ',UCRSTATE       IF SOUTH CAROLINA                         
         BNE   MMREFRS0                                                         
         GOTOR NOSPCLCH,DMCB,UCRLAST     REMOVE AND CONCAT SPECIAL CHR          
         GOTOR NOSPCLCH,DMCB,UCRFRST     REMOVE AND CONCAT SPECIAL CHR          
         GOTOR NOSPCLCH,DMCB,UCRMID      REMOVE AND CONCAT SPECIAL CHR          
*                                                                               
MMREFRS0 CLC   =C'LA ',UCRSTATE       IF LOUISIANA                              
         BNE   MMREFRS1                                                         
*                                                                               
         MVC   FRSELNM2,SPACES        LAST NAME                                 
         MVC   FRSELNM2(L'UCRLAST),UCRLAST                                      
         MVC   FRSEFNM2,UCRFRST       FIRST NAME                                
         MVC   FRSEMDN2,UCRMID        MIDDLE                                    
         B     MMREFRS2                                                         
*                                                                               
MMREFRS1 MVC   FRSEFNAM,UCRFRST       FIRST NAME                                
         MVC   FRSEMIDN,UCRMID        MIDDLE                                    
         MVC   FRSELNAM,SPACES        LAST                                      
         MVC   FRSELNAM(L'UCRLAST),UCRLAST                                      
*                                                                               
MMREFRS2 CLC   =C'FL ',UCRSTATE       SKIP IF FLORIDA                           
         BE    MMREFRS3                                                         
         CLC   =C'SC ',UCRSTATE       SKIP IF SOUTH CAROLINA                    
         BE    MMREFRS3                                                         
*                                                                               
         CLC   =C'VA ',UCRSTATE       SKIP IF VIRGINIA                          
         BE    *+10                                                             
         MVC   FRSEADD,UCRADDR        ADDRESS                                   
*                                                                               
         MVC   FRSCITY,UCRCITY        CITY                                      
         MVC   FRSSTAT,UCRASTAT       STATE                                     
         MVC   FRSZIP,UCRZIP          ZIP                                       
         MVC   FRSZIPX,UCRZIPX        ZIP EXTENSION                             
*                                                                               
         CLC   =C'CA ',UCRSTATE                                                 
         BNE   *+8                                                              
         MVI   FRSWGPLC,C'S'          CALIFORNIA ONLY                           
*                                                                               
MMREFRS3 MVC   FRSRPTPD(2),RPTMMYR    REPORTING PERIOD                          
         MVC   FRSRPTPD+2(4),RYEAR                                              
*                                                                               
         CLC   =C'VA ',UCRSTATE       SKIP IF VIRGINIA                          
         BE    MMREFRS7                                                         
*                                                                               
         CLC   =C'SC ',UCRSTATE       IF SOUTH CAROLINA                         
         BNE   MMREFRS4                                                         
         MVC   FRSEMPAC(6),SVID       EMPLOYER ACCT NUMBER                      
         EDIT  (P8,UCRGROSQ),(11,FRSQTOTW),0,FILL=0 GRS QTR EARNINGS            
         EDIT  (P8,UCRSUIWQ),(11,FRSQTAXW),0,FILL=0 STATE TAX WAGES             
         B     MMREFRSX                                                         
*                                                                               
MMREFRS4 MVC   FRSEMPAC,SVID          EMPLOYER ACCT NUMBER                      
         CLC   =C'OR ',UCRSTATE       IF OREGON                                 
         BNE   *+10                                                             
         MVC   FRSEMPAC+7(4),SPACES   PAD WITH SPACES                           
*                                                                               
         CLC   =C'FL ',UCRSTATE       IF FLORIDA                                
         BE    *+10                                                             
         CLC   =C'SC ',UCRSTATE       IF SOUTH CAROLINA                         
         BNE   MMREFRS7                                                         
*                                                                               
         EDIT  (P8,UCRGROSQ),(11,FRSQTOTW),2,FILL=0 GRS QTR EARNINGS            
         EDIT  (P8,UCRSUIWQ),(11,FRSQTAXW),2,FILL=0 STATE TAX WAGES             
         B     MMREFRSX                                                         
*                                                                               
MMREFRS7 EDIT  (P8,UCRGROSQ),(11,FRSQTOTW),FILL=0 GRS EARNINGS FOR QTR          
*                                                                               
         CLC   =C'VA ',UCRSTATE       SKIP IF NOT VIRGINIA                      
         BNE   MMREFRS8                                                         
*                                                                               
         MVC   FRSVEC#(10),=10C'0' VA ACCOUNT NUMBER                            
         MVC   FRSVEC#+10(10),SVID                                              
*                                                                               
         MVI   FRSTXCD2,C'B'       TAXING ENTITY CODE                           
*                                                                               
         B     MMREFRSX            VIRGINIA IS DONE                             
*                                                                               
MMREFRS8 DS    0H                                                               
*                                                                               
         EDIT  (P8,UCRGROSQ),(11,FRSQSTTW),FILL=0 STATE TAX WAGES               
*                                                                               
         CLC   =C'LA ',UCRSTATE       IF LOUISIANA,                             
         BNE   MMREFRS9                                                         
*                                                                               
         ZAP   DUB,UCRGROSQ           QTRLY WAGES TO NEAREST WHOLE              
         SRP   DUB,62,5                                                         
         MP    DUB,=P'100'                                                      
         EDIT  (P8,DUB),(11,FRSQTOTW),FILL=0 STATE TAX WAGES                    
         MVC   FRSSCOD2,TGTANUM       STATE CODE                                
*                                                                               
         ZAP   DUB,UCRGROSQ                  GROSS LESS SUI =                   
         SP    DUB(8),UCRSUIWQ                                                  
         SRP   DUB,62,5               NEAREST WHOLE DOLLAR                      
         MP    DUB,=P'100'                                                      
         EDIT  (P8,DUB),(10,FRSEWAG),FILL=0  EXCESS WAGES (NON-TAX)             
*                                                                               
         EDIT  UCRMTH1,FRSMTH1,FILL=0         1 = WORKED IN MONTH 1             
         EDIT  UCRMTH2,FRSMTH2,FILL=0         1 = WORKED IN MONTH 2             
         EDIT  UCRMTH3,FRSMTH3,FILL=0         1 = WORKED IN MONTH 3             
         B     MMREFRSX                                                         
*                                                                               
MMREFRS9 EDIT  (P8,UCRTAXQ),(11,FRSQSTTX),FILL=0 PER INC TAX WITHHELD           
*                                                                               
         ZIC   R1,UCRWEEK          WEEKS * 8 IS HOURS (APPROXIMATELY)           
         MH    R1,=H'8'                                                         
         EDIT  (R1),(3,FRSHRSWK),FILL=0                                         
*                                                                               
MMREFRSX XIT1                                                                   
         EJECT                                                                  
*======================================================================         
*        ROUTINE TO DO ICESA VERSION TAPE                                       
*======================================================================         
*                                                                               
*              CURRENTLY FOR TENNESSEE ONLY                                     
*                                                                               
         USING TUVERICD,R4                                                      
         USING UCRD,R3                                                          
VERICESA NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASORTREC         R3=A(SORT RECORD)                            
         CP    UCRGROSQ,=PL8'0'                                                 
         BL    VERICEX                                                          
*                                                                               
         LA    R4,TAPEIO           R4=A(TAPE RECORD)                            
         BRAS  RE,MVCSPACE         PRESET TAPE AREA TO SPACES                   
*                                                                               
         OC    UCRSSN,UCRSSN       TEST ANY SSN                                 
         BZ    VERICEX                                                          
         MVC   TUVICSSN,UCRSSN     SOCIAL SECURITY                              
*                                                                               
         LA    RE,TUVICEMP                                                      
         LA    RF,UCRLAST          LAST NAME                                    
         LA    R1,L'UCRLAST                                                     
VERICE02 CLI   0(RF),C' '          STOP AFTER 1ST BLANK                         
         BE    VERICE04                                                         
         MVC   0(1,RE),0(RF)       MOVE IN CHARACTER                            
         AHI   RF,1                                                             
         AHI   RE,1                                                             
         BCT   R1,VERICE02                                                      
*                                                                               
VERICE04 AHI   RE,1                                                             
         LA    RF,UCRFRST          FIRST NAME                                   
         LA    R1,L'UCRFRST                                                     
VERICE06 CLI   0(RF),C' '          STOP AFTER 1ST BLANK                         
         BE    VERICE08                                                         
         MVC   0(1,RE),0(RF)       MOVE IN CHARACTER                            
         AHI   RF,1                                                             
         AHI   RE,1                                                             
         BCT   R1,VERICE06                                                      
*                                                                               
VERICE08 MVC   1(1,RE),UCRMID      MIDDLE INITIAL                               
*                                                                               
         EDIT  (P8,UCRGROSQ),(11,TUVICWAG),0,FILL=0 TOTAL WAGES                 
         EDIT  QQUART,TUVICQTR     QUARTER                                      
         MVC   TUVICYR,UCRRYR      YEAR                                         
         MVC   TUVICACC,=CL8'05528080'    ACCOUNT NUMBER                        
*                                                                               
         BRAS  RE,PUTTAPE                                                       
VERICEX  XIT1                                                                   
         LTORG                                                                  
*---------------------------------------------------------------------          
NOSPCLCH NTR1  BASE=*,LABEL=*                                                   
         L     R4,0(R1)                                                         
         MVC   NAMESTR,SPACES                                                   
         MVC   NAMESTR(16),0(R4)                                                
         LA    R4,NAMESTR                                                       
         LA    RF,16                                                            
                                                                                
NOSPCL10 CLI   0(R4),C' '          SPACE AND ALPHANUMERIC                       
         BE    NOSPCL90            LEAVE IT ALONE                               
         CLI   0(R4),C'\'                                                       
         BE    NOSPCL20                                                         
         CLI   0(R4),C'{'                                                       
         BE    NOSPCL20                                                         
         CLI   0(R4),C'}'                                                       
         BE    NOSPCL20                                                         
         CLI   0(R4),C'A'                                                       
         BNL   NOSPCL90                                                         
                                                                                
NOSPCL20 LR    R3,RF               ELSE REMOVE AND CONCATENATE                  
         AHI   R3,-1                                                            
                                                                                
         EX    R3,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),1(R4)                                                    
                                                                                
NOSPCL90 AHI   R4,1                                                             
         BCT   RF,NOSPCL10                                                      
                                                                                
         L     R4,0(R1)                                                         
         MVC   0(16,R4),NAMESTR                                                 
         J     MMREFRSX                                                         
                                                                                
NAMESTR  DS    CL17                                                             
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*====================================================================           
*        MMREF FORMAT, RST RECORD                                               
*====================================================================           
         USING FRSTDSCT,R4                                                      
MMREFRST NTR1  BASE=*,LABEL=*                                                   
         MVI   FRST,C' '                                                        
         MVC   FRST+1(255),FRST                                                 
         MVC   FRST+256(256),FRST                                               
*                                                                               
         MVC   FRSTID,=C'RST'                                                   
         EDIT  (P4,UCRNSSN),(7,FRSTNEMP),FILL=0   NUMBER OF EMPLOYEES           
         MVC   FRSTSTCD,TGTANUM    STATE CODE                                   
         EDIT  (P8,UCRGROSQ),(14,FRSTQTWG),FILL=0 GRS EARNINGS FOR QTR          
         EDIT  (P8,UCRGROSQ),(14,FRSTQTW),FILL=0 STATE TAX WAGES                
         EDIT  (P8,UCRTAXQ),(14,FRSTQTXW),FILL=0 PER INC TAX WITHHELD           
*                                                                               
**NO-OP  EDIT  (P4,UCRNMTH1),(7,FRSTMTH1),FILL=0  PERFS FOR MONTH 1             
**05/06  EDIT  (P4,UCRNMTH2),(7,FRSTMTH2),FILL=0  PERFS FOR MONTH 2             
**NO-OP  EDIT  (P4,UCRNMTH3),(7,FRSTMTH3),FILL=0  PERFS FOR MONTH 3             
*                                                                               
         EDIT  (P3,NMONTH1),(7,FRSTMTH1),FILL=0  PERFS FOR MONTH 1              
         EDIT  (P3,NMONTH2),(7,FRSTMTH2),FILL=0  PERFS FOR MONTH 2              
         EDIT  (P3,NMONTH3),(7,FRSTMTH3),FILL=0  PERFS FOR MONTH 3              
*                                                                               
         XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        MMREF FORMAT, RT RECORD                                                
*====================================================================           
         USING FRTDSECT,R4                                                      
MMREFRT  NTR1  BASE=*,LABEL=*                                                   
         MVI   FRT,C' '                                                         
         MVC   FRT+1(255),FRT                                                   
         MVC   FRT+256(256),FRT                                                 
*                                                                               
         MVC   FRTID,=C'RT'                                                     
*                                                                               
         CLC   =C'FL ',UCRSTATE       IF FLORIDA, NEED DECIMAL                  
         BNE   MMRT10                                                           
         EDIT  (P8,UCRGROSQ),(15,FRTGROSS),2,FILL=0                             
         B     MMRT30                                                           
*                                                                               
MMRT10   CLC   =C'SC ',UCRSTATE       IF SOUTH CAROLINA                         
         BNE   MMRT20                                                           
         EDIT  (P4,UCRNSSN),(7,FRTNUMRS),FILL=0     NUMBER OF RS                
         B     MMREFRTX                                                         
*                                                                               
MMRT20   EDIT  (P8,UCRGROSQ),(15,FRTGROSS),FILL=0                               
MMRT30   EDIT  (P8,UCRTAXQ),(11,FRTTAXD),FILL=0                                 
         EDIT  (P4,UCRNMTH1),(7,FRTCW1ST),FILL=0                                
         EDIT  (P4,UCRNMTH2),(7,FRTCW2ND),FILL=0                                
         EDIT  (P4,UCRNMTH3),(7,FRTCW3RD),FILL=0                                
*                                                                               
MMREFRTX XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        MMREF FORMAT, RF RECORD                                                
*====================================================================           
         USING FRFDSECT,R4                                                      
MMREFRF  NTR1  BASE=*,LABEL=*                                                   
         MVI   FRF,C' '                                                         
         MVC   FRF+1(255),FRF                                                   
         MVC   FRF+256(256),FRF                                                 
*                                                                               
         MVC   FRFID,=C'RF'                                                     
*                                                                               
         CLC   =C'SC ',UCRSTATE       IF SOUTH CAROLINA                         
         BNE   MMRF10                                                           
         EDIT  (P4,UCRNSSN),(7,FRFNUMRS),FILL=0     NUMBER OF RS                
         B     MMREFRFX                                                         
*                                                                               
MMRF10   CLC   =C'VA ',UCRSTATE       IF NOT VIFGINIA                           
         BNE   *+10                                                             
         MVC   FRFTOTRW,=9C'0'           # OF RW RECORDS ON FILE                
*                                                                               
MMREFRFX XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
*====================================================================           
*        RX RECORD - EXTRA DETAILS FOR XML FILE (FL ONLY)                       
*====================================================================           
         USING FRXDSECT,R4                                                      
PUTXMLX  NTR1  BASE=*,LABEL=*                                                   
         MVI   FRX,C' '                                                         
         MVC   FRX+1(255),FRX                                                   
         MVC   FRX+256(256),FRX                                                 
*                                                                               
         MVC   FRXID,=C'RX'                                                     
*                                                                               
***      MVC   FRXPROC,PROCOPT              PROCESS TYPE (T OR P)               
         MVI   FRXORCT,C'1'                 ORIGIN MANIFEST COUNT               
*                                                                               
         LA    R2,FRXTIME                   DAY/TIME STAMP                      
         BRAS  RE,GETTMSTP                  GET TIMESTAMP                       
*                                                                               
         MVC   FRXDTYP,=C'Form'             DOCUMENT TYPE                       
         MVC   FRXDNAM,=CL12'FSET StateUI'  DOCUMENT NAME                       
         MVC   FRXDID,=C'UCT-6'             DOCUMENT ID                         
*                                                                               
         EDIT  QQUART,FRXQRT                QUARTER NUMBER                      
*&&DO                                                                           
         MVC   FRXDID(4),RYEAR              DOCUMENT ID = YYYYFLQ#              
         MVC   FRXDID+4(2),UCRSTATE                                             
         MVI   FRXDID+6,C'Q'                                                    
         MVC   FRXDID+7(1),FRXQRT                                               
*&&                                                                             
*                                                                               
         MVC   FRXYEAR,RYEAR                TAX YEAR                            
         MVC   FRXRET,=C'StateUI'           RETURN TYPE                         
         MVC   FRXACT,=CL12'Original'       ACTION                              
         MVC   FRXTTIN,=C'FEIN'             TYPE TIN                            
         MVC   FRXTSEIN,=CL11'UIAccountNo'  TYPE STATE EIN                      
         MVC   FRXSCOD,UCRSTATE             STATE CODE                          
         MVC   FRXSNAME,=C'Florida'         STATE NAME                          
         EDIT  (P4,UCRNSSN),(7,FRXTNUM),FILL=0   NUMBER OF EMPLOYEES            
         MVI   FRXRCNT,C'1'                 RETURN DATA DOC COUNT               
*                                                                               
         EDIT  SUIRATE,(6,FRXCRATE),5,FILL=0  CONTRIBUTION RATE                 
*                                                                               
         EDIT  (P8,UCRSUIWQ),(14,FRXTTAX),2,FILL=0  TOTAL TAX SUI               
*                                                                               
         MVC   FULL,SUIRATE                 EMPLOYER TAX TIMES                  
         ZAP   DUB,UCRSUIWQ                 TAX SUI FOR QTR                     
         BRAS  RE,CALCDUE                   =TAXES DUE                          
         EDIT  (P8,DUB),(10,FRXCDUE),2,FILL=0  CONTRIBUTION DUE                 
         EDIT  (P8,DUB),(14,FRXAMTP),2,FILL=0  AMOUNT PAID                      
*                                                                               
         AP    DUB,UCRTAXQ                  UC CONT. + TAX WITHHELD             
         EDIT  (P8,DUB),(14,FRXTOTD),2,FILL=0  =TOTAL DUE                       
*                                                                               
         ZAP   DUB,UCRGROSQ                  GROSS LESS SUI =                   
         SP    DUB(8),UCRSUIWQ                                                  
         EDIT  (P8,DUB),(14,FRXTEXC),2,FILL=0  EXCESS WAGES (NON-TAX)           
         XIT1                                                                   
*                                                                               
         DROP  R4                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        GET DATE AND TIME STAMP                                                
*        RETURNS THE TIMESTAMP AT 0(R2)                                         
*                                                                               
         USING FRXDSECT,R4                                                      
GETTMSTP NTR1  BASE=*,LABEL=*                                                   
         GOTO1 DATCON,DMCB,(5,0),(23,0(R2))                                     
         LA    R2,10(R2)                                                        
         MVC   0(9,R2),=C'THH:MM:00'                                            
         LA    R2,1(R2)                                                         
         THMS  DDSTIME=YES                                                      
         STCM  R0,15,TMPTIME                                                    
         ST    R1,FULL                                                          
         AP    TMPTIME(4),FULL                                                  
         CP    TMPTIME(4),=P'240000'                                            
         BL    *+10                                                             
         SP    TMPTIME(4),=P'240000'                                            
         ICM   R1,15,TMPTIME      ALIGN IT                                      
         SLL   R1,4                                                             
         STCM  R1,15,TMPTIME                                                    
*                                                                               
         GOTO1 HEXOUT,DMCB,TMPTHRS,0(R2),1                                      
         LA    R2,3(R2)                                                         
         GOTO1 HEXOUT,DMCB,TMPTMIN,0(R2),1                                      
         LA    R2,3(R2)                                                         
         GOTO1 HEXOUT,DMCB,TMPTSEC,0(R2),1                                      
*                                                                               
         XIT1                                                                   
         DROP  R4                                                               
*                                                                               
TMPTIME  DS    0F                                                               
TMPTHRS  DS    X                                                                
TMPTMIN  DS    X                                                                
TMPTSEC  DS    X                                                                
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
CALCDUE  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
**NO-OP**L     R1,FULL             RATE (EMP TAX OR EMP'E ASSESSMENT)           
*        CVB   RF,DUB              TAX SUI OR TOTAL WAGES                       
*        XR    RE,RE                                                            
*        MR    RE,R1                                                            
*        D     RE,=F'50000'                                                     
*        LTR   RF,RF               RF = QUOTIENT                                
*        BM    *+8                                                              
*        AH    RF,=H'1'            ROUND                                        
*        SRA   RF,1                                                             
**NO-OP**ST    RF,FULL             RETURN CALCULATED AMOUNT IN FULL             
*                                                                               
         ZAP   TOT,DUB(8)          TAX SUI OR TOTAL WAGES                       
         L     R0,FULL             X RATE                                       
         CVD   R0,DUB2                                                          
         MP    TOT,DUB2                                                         
*                                                                               
         SRP   TOT,64-5,5          DIVIDE BY AND ROUND                          
         ZAP   DUB,TOT+8(8)                                                     
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        CALCULATE WORKERS COMP                                                 
*                                                                               
CALCWRK  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         ZAP   TOT,DUB(8)          TOTAL EMPLOYEES WITH WORKERS COMP            
         L     R0,FULL             X WORKERS COMP RATE                          
         CVD   R0,DUB2                                                          
         MP    TOT,DUB2                                                         
*                                                                               
         ZAP   DUB,TOT+8(8)                                                     
         XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
*        CLOSE OLD PRINT JOB & OPEN A NEW ONE                                   
*                                                                               
NEWPRTQ  NTR1  BASE=*,LABEL=*                                                   
         L     R1,ATWA                                                          
         USING T703FFD,R1                                                       
         L     R1,TWAMASTC         MASTC                                        
         USING MASTD,R1                                                         
         L     R1,MCVREMOT                                                      
         USING REMOTED,R1                                                       
         OC    REMOTKEY,REMOTKEY   IF NOT GOING TO PQ - EXIT                    
         BZ    NPRTQX                                                           
         MVC   REMOTKEY(11),SPACES                                              
         CLI   UCRFTYPE,UCRFTYS    IF SPECIAL FORM                              
         BNE   NPRTQ10                                                          
         MVC   REMOTSYS(3),UCREMP   REPORT NAME WILL BE EMPLOYER                
         MVC   REMOTFRM(3),UCRSTATE     AND STATE                               
         B     NPRTQX                                                           
*                                                                               
NPRTQ10  MVC   REMOTSYS(3),TIFEMP    ELSE NAME WILL BE REQUESTED                
         OC    REMOTSYS(3),REMOTSYS  EMPLOYER (IF DEFINED)                      
         BNZ   *+10                                                             
         MVC   REMOTSYS(3),=C'ALL'                                              
         MVC   REMOTFRM(3),TIFUNIT   AND REQUESTED STATE (IF DEFINED)           
         OC    REMOTFRM(3),REMOTFRM                                             
         BNZ   *+10                                                             
         MVC   REMOTFRM(3),=C'ALL'                                              
*                                                                               
NPRTQX   XIT1                                                                   
         DROP R1                                                                
         EJECT                                                                  
*                                                                               
         LTORG                                                                  
*        PRINT DOWNLOAD REPORT FROM DATASET                                     
*                                                                               
PRTDOWN  NTR1  BASE=*,LABEL=*                                                   
         LA    R2,TADOWN           USE TEMPORARY DATASET FOR DOWN               
         CLOSE ((2))               CLOSE IT                                     
         MVC   SVSTATE,UCRSTATE                                                 
*  ALASKA                                                                       
PRTDWNAK CLC   =C'AK ',UCRSTATE                                                 
         BNE   PRTDWNID                                                         
         BAS   RE,PREPIL                                                        
         B     PRTDWN20                                                         
* IDAHO                                                                         
PRTDWNID CLC   =C'ID ',UCRSTATE                                                 
         BNE   PRTDWNIL                                                         
         BAS   RE,PREPIL           DO SPECIAL DOWNLOAD REPORT FOR IL            
         B     PRTDWN20                                                         
*                                                                               
PRTDWNIL TM    STSTAT,STSTATIL     IF USING FL FORMAT FOR TN,                   
         BZ    PRTDWNPA                                                         
         CLC   =C'IL ',UCRSTATE                                                 
         BNE   PRTDWNPA                                                         
         BAS   RE,PREPIL           DO SPECIAL DOWNLOAD REPORT FOR IL            
         B     PRTDWN20                                                         
*                                                                               
PRTDWNPA CLC   =C'PA ',UCRSTATE    IF PENNSYLVANIA                              
         BNE   PDWNPAN                                                          
*                                                                               
         BAS   RE,PREPPA           DO SPECIAL DOWNLOAD REPORT FOR PA            
*                                                                               
PRTDWN20 MVC   TADOWN(TALNQ),SVDCB RESTORE DCB                                  
*                                                                               
         B     PDWNX                                                            
*                                                                               
PDWNPAN  DS    0H                                                               
*                                                                               
*&&DO                                                                           
**NO-OP                                                                         
**JAN13                                                                         
         CLC   =C'NM ',UCRSTATE    IF NEW MEXICO                                
         BNE   PDWN50                                                           
         BAS   RE,PREPNM           DO SPECIAL DOWNLOAD REPORT FOR NM            
         MVC   TADOWN(TALNQ),SVDCB RESTORE DCB                                  
         B     PDWNX                                                            
*&&                                                                             
*                                                                               
PDWN50   CLC   =C'FL ',UCRSTATE    IF FLORIDA                                   
         BNE   PDWN60                                                           
         BAS   RE,PREPFL           DO SPECIAL DOWNLOAD REPORT FOR FL            
         MVC   TADOWN(TALNQ),SVDCB RESTORE DCB                                  
         B     PDWNX                                                            
*                                                                               
PDWN60   CLC   =C'HI ',UCRSTATE    IF HAWAII                                    
         BNE   PDWN70                                                           
         BAS   RE,PREPHI           DO SPECIAL DOWNLOAD REPORT FOR HI            
         MVC   TADOWN(TALNQ),SVDCB RESTORE DCB                                  
         B     PDWNX                                                            
*                                                                               
PDWN70   CLC   =C'RI ',UCRSTATE    IF RHODE ISLAND                              
         BNE   PDWN76                                                           
         BAS   RE,PREPRI           DO SPECIAL DOWNLOAD REPORT FOR RI            
         MVC   TADOWN(TALNQ),SVDCB RESTORE DCB                                  
         B     PDWNX                                                            
*                                                                               
PDWN76   CLC   =C'ME ',UCRSTATE    IF MAINE                                     
         BNE   PDWNRIN                                                          
         BRAS  RE,PREPRI                                                        
         MVC   TADOWN(TALNQ),SVDCB RESTORE DCB                                  
         B     PDWNX                                                            
*                                                                               
PDWNRIN  DS    0H                                                               
*                                                                               
         CLC   =C'NC ',UCRSTATE    IF NORTH CAROLINA                            
         BNE   PDWNNCN                                                          
*                                                                               
         BAS   RE,PREPNC           DO SPECIAL DOWNLOAD REPORT FOR nc            
*                                                                               
         MVC   TADOWN(TALNQ),SVDCB RESTORE DCB                                  
*                                                                               
         B     PDWNX                                                            
*                                                                               
PDWNNCN  DS    0H                                                               
*                                                                               
PDWN80   BAS   RE,PREP2            DO DOWNLOAD REPORT NOW                       
         MVC   TADOWN(TALNQ),SVDCB RESTORE DCB                                  
PDWNX    J     XIT                                                              
*                                                                               
*              ROUTINE TO GET FROM DATASET AND PRINT SECOND REPORT              
*                                                                               
PREP2    NTR1                                                                   
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
         MVI   FORCEHED,C'Y'                                                    
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
         DROP  R2                                                               
*                                                                               
         L     R2,=A(TADOWN)                                                    
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK                                                       
         USING DLCBD,R3                                                         
         BAS   RE,INITDWN                                                       
*                                                                               
PREP22   GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
         LA    R4,TAPEREC                                                       
*                                                                               
         SR    R0,R0                                                            
         LH    R1,DCBRLN           RECORD LENGTH IN DCBRLN                      
         D     R0,=F'40'           R1  = # OF 40 BYTE CHUNKS                    
         STC   R0,REM              REM = LEFT OVER BYTES                        
*                                                                               
         LTR   R1,R1                                                            
         BZ    PREP24                                                           
*                                                                               
PREP23   STC   R1,QUO                                                           
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
*                                                                               
         MVI   DLCBLEN,40                                                       
         MVC   DLCBFLD(40),0(R4)    PASS DATA                                   
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R4,40(R4)           BUMP TO NEXT TAPE FIELD                      
         ZIC   R1,QUO                                                           
         BCT   R1,PREP23                                                        
*                                                                               
PREP24   CLI   REM,0                                                            
         BE    PREP25                                                           
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBLEN,REM                                                      
         ZIC   RE,REM                                                           
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PREP25   MVI   DLCBACT,DLCBEOL     END OF LINE                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         B     PREP22                                                           
*                                                                               
         EJECT                                                                  
*                                                                               
*                                                                               
*        ROUTINE TO GET DATA FROM PENNSYLVANIA DATASET & PRINT 2ND RPT          
*        FIRST GETS EMPLOYER RECORD AND SAVES                                   
*        THEN GOES THROUGH DATASET AGAIN AND PRINTS IN ORDER                    
*                                                                               
PREPPA   NTR1                                                                   
         L     R2,=A(TADOWN)       OPEN DATASET                                 
         OPEN  ((2),INPUT)                                                      
*                                                                               
         LTR   RF,RF               NO ERRORS TOLERATED                          
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
*        FIND EMPLOYER RECORD IN DATASET                                        
*                                                                               
PRPA10   GET   (R2),TAPEREC        GET FROM DISK                                
*                                                                               
         USING TUPAD,R4            ESTABLISH PENN RECORD                        
         LA    R4,TAPEREC                                                       
*                                                                               
         CLI   TUPAID,TUPAIDEQ     FIND EMPLOYER RECORD                         
         BNE   PRPA10                                                           
*                                                                               
         MVC   BLOCK(TUPARECL),TUPAREC    SAVE RECOPRD FOR LATER                
*                                                                               
         DROP  R4                                                               
*                                                                               
         CLOSE ((2))               CLOSE THE DATASET                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
*                                                                               
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
*                                                                               
         MVI   FORCEHED,C'Y'       FORCE NEW PAGE                               
*                                                                               
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
*                                                                               
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
*                                                                               
         DROP  R2                                                               
*                                                                               
PRPA20   L     R2,=A(TADOWN)       RE-OPEN DATASET                              
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK          INIT DOWN FACILITY                           
         USING DLCBD,R3                                                         
*                                                                               
         BAS   RE,INITDWN                                                       
*                                                                               
*        SEND RECORDS TO PQ AS COMMA DELIMITED RECORDS                          
*                                                                               
PRPARDLP DS    0H                                                               
*                                                                               
         L     R2,=A(TADOWN)                                                    
         GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
*                                                                               
         USING TUPAD,R4            ESTABLISH RECORD                             
         LA    R4,TAPEREC                                                       
*                                                                               
         CLI   TUPAID,TUPAIDEQ     IGNORE EMPLOYER RECORD                       
         BE    PRPARDCN                                                         
*                                                                               
PRPARD10 DS    0H                                                               
*                                                                               
         LA    R2,PRPATAB          POINT TO TABLE OF FIELD LENGTHS              
         LA    R0,3                3 RECORD TYPES                               
*                                                                               
         CLC   TUPAID,0(R2)        MATCH RECORD ID TO TABLE ENTRY               
         BE    PRPARD20                                                         
         LLC   RF,1(R2)            GET NUMBER OF FIELDS IN RECORD               
         LA    R2,2(RF,R2)         BUMP TO NEXT TABLE ENTRY                     
         BCT   R0,*-20                                                          
         DC    H'0'                EOT                                          
*                                                                               
*        STRIP OUT TRAILING SPACES AND ADD COMMAS                               
*                                                                               
PRPARD20 MVI   BYTE,C'N'                                                        
         CLI   TUPAID,TUPAIDEQ                                                  
         BE    *+8                                                              
         CLI   TUPAID,TUPAIDSQ                                                  
         BNE   *+8                                                              
         MVI   BYTE,C'Y'                                                        
                                                                                
         LLC   R0,1(R2)            NUMBER OF FIELDS IN RECORD                   
         LA    R2,2(R2)            START OF FIELD LENGTHS                       
         LA    RE,ELEM             WORK AREA                                    
         MVC   ELEM(L'SPACES),SPACES INIT WORKAREA                              
*                                                                               
PRPASPLP DS    0H                                                               
*                                                                               
         LLC   RF,0(R2)            GET FIELD LENGTH                             
*                                                                               
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),0(R4)       MOVE TO WORKAREA                             
*                                                                               
         LA    R4,1(RF,R4)         POINT TO NEXT FIELD                          
*                                                                               
         LA    RE,0(RF,RE)         LAST BYTE OF FIELD IN WORK                   
         CLI   BYTE,C'Y'                                                        
         BNE   PRPARD30                                                         
         CHI   R0,10                                                            
         BE    PRPARD50                                                         
*                                                                               
PRPARD30 AHI   RF,1                RESTORE LENGTH COUNTER                       
*                                                                               
         CLI   0(RE),C' '          DROP TRAILING SPACES                         
         BH    *+10                                                             
         BCTR  RE,0                BACKUP A BYTE                                
         BCT   RF,*-10             REPEAT                                       
*                                                                               
         CHI   R0,1                SKIP IF LAST FIELD IN RECORD                 
         BE    *+12                                                             
PRPARD50 MVI   1(RE),C','             SET COMMA                                 
         LA    RE,1(RE)               BUMP POINTER                              
*                                                                               
PRPASPCN DS    0H                                                               
*                                                                               
         LA    R2,1(R2)            BUMP FIELD LENGTHS PTR                       
         LA    RE,1(RE)            NEXT AVAILABLE BYTE                          
         BCT   R0,PRPASPLP         NEXT FIELD                                   
*                                                                               
PRPASPDN DS    0H                                                               
*                                                                               
*        PRINT WORK RECORD - 40 BYTES AT A TIME                                 
*                                                                               
         LR    R0,RE                                                            
         LA    RF,ELEM                                                          
         SR    R0,RF               WOPRKAREA LENGTH                             
*                                                                               
         LA    R4,ELEM             POINT TO WORKAREA                            
*                                                                               
PRPAPRLP DS    0H                                                               
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBFLD,SPACES      INIT FIELD                                   
*                                                                               
         LA    RF,40               MAX FIELD LENGTH                             
*                                                                               
         CR    RF,R0               IF LESS THAN 40 LEFT                         
         BNH   *+6                                                              
         LR    RF,R0                  SET TO REMAINDER                          
*                                                                               
         STC   RF,DLCBLEN          SET FIELD LENGTH                             
*                                                                               
         SR    R0,RF               REMAINING LENGTH                             
*                                                                               
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
*                                                                               
         LA    R4,1(RF,R4)         BUMP TO NEXT WORK SECTION                    
*                                                                               
         GOTO1 =V(DLFLD),DLCBD     PRINT                                        
*                                                                               
PRPAPRCN DS    0H                                                               
*                                                                               
         LTR   R0,R0               SKIP IF NO REMAINING LENGTH                  
         BP    PRPAPRLP                                                         
*                                                                               
         MVI   DLCBACT,DLCBEOL     END OF LINE                                  
*                                                                               
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PRPARDCN DS    0H                                                               
*                                                                               
         CLI   TAPEREC,TUPAIDAQ    IF HEADER RECORD                             
         BNE   *+16                                                             
         MVI   TAPEREC,0              ERASE ID                                  
         LA    R4,BLOCK               PUT OUT EMPLOYER RECORD                   
         B     PRPARD10                                                         
*                                                                               
         B     PRPARDLP            PROCESS NEXT RECORD                          
*                                                                               
*                                                                               
*********************************************************                       
*       ROUTINE TO GET DATA FROM IL                                             
*       READS DATASET AGAIN AND PRINTS IN ORDER                                 
*                                                                               
PREPIL   NTR1                                                                   
         L     R2,=A(TADOWN)       OPEN DATASET                                 
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
*                                                                               
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
*                                                                               
         MVI   FORCEHED,C'Y'       FORCE NEW PAGE                               
*                                                                               
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
*                                                                               
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
*                                                                               
         DROP  R2                                                               
*                                                                               
PRIL20   L     R2,=A(TADOWN)       RE-OPEN DATASET                              
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK          INIT DOWN FACILITY                           
         USING DLCBD,R3                                                         
*                                                                               
         BAS   RE,INITDWN                                                       
*                                                                               
*        SEND RECORDS TO PQ AS COMMA DELIMITED RECORDS                          
*                                                                               
PRILRDLP DS    0H                                                               
*                                                                               
         L     R2,=A(TADOWN)                                                    
         GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
*                                                                               
*                                                                               
         USING TUILDSKD,R4         ESTABLISH PENN RECORD                        
         LA    R4,TAPEREC                                                       
*  ALASKA FILE                                                                  
         USING UCRD,RE                                                          
         L     RE,ASORTREC         R3=A(SORT RECORD)                            
         CLC   =C'AK ',UCRSTATE    ALASKA                                       
         BNE   PRPILD10                                                         
         DROP  RE                                                               
*                                                                               
         CLI   0(R4),TUAKDETQ      we only care about employee detail           
         BNE   PRILRDLP                                                         
         LA    R2,PRAKTABD         POINT TO TABLE OF FIELD LENGTHS              
*                                                                               
PRPILD08 LLC   R0,0(R2)            NUMBER OF FIELDS IN RECORD                   
         LA    R2,1(R2)            START OF FIELD LENGTHS                       
         LA    RE,ELEM             WORK AREA                                    
         MVC   ELEM(L'SPACES),SPACES INIT WORKAREA                              
         AHI   R4,L'TUAKRID        SKIP PASS TEMP REC ID                        
         B     PRILSPLP                                                         
*  IDAHO FILE                                                                   
PRPILD10 DS    0H                                                               
*                                                                               
         LA    R2,PRILTAB          POINT TO TABLE OF FIELD LENGTHS              
         USING UCRD,RE                                                          
         L     RE,ASORTREC         R3=A(SORT RECORD)                            
         CLC   =C'ID ',UCRSTATE    IDAHO                                        
         BNE   PRPILD12                                                         
         LA    R2,PRIDTAB          POINT TO TABLE OF FIELD LENGTHS              
         LLC   R0,0(R2)            NUMBER OF FIELDS IN RECORD                   
         LA    R2,1(R2)            START OF FIELD LENGTHS                       
         LA    RE,ELEM             WORK AREA                                    
         MVC   ELEM(L'SPACES),SPACES INIT WORKAREA                              
         B     PRILSPLP                                                         
         DROP  RE                                                               
*                                                                               
PRPILD12 LA    R0,3                3 RECORD TYPES                               
*                                                                               
         CLC   TUILID,0(R2)        MATCH RECORD ID TO TABLE ENTRY               
         BE    *+20                                                             
         LLC   RF,1(R2)            GET NUMBER OF FIELDS IN RECORD               
         LA    R2,2(RF,R2)         BUMP TO NEXT TABLE ENTRY                     
         BCT   R0,*-20                                                          
         DC    H'0'                EOT                                          
*                                                                               
*        STRIP OUT TRAILING SPACES AND ADD COMMAS                               
*                                                                               
PRPILD14 LLC   R0,1(R2)            NUMBER OF FIELDS IN RECORD                   
         LA    R2,2(R2)            START OF FIELD LENGTHS                       
         LA    RE,ELEM             WORK AREA                                    
         MVC   ELEM(L'SPACES),SPACES INIT WORKAREA                              
*                                                                               
PRILSPLP DS    0H                                                               
*                                                                               
         LLC   RF,0(R2)            GET FIELD LENGTH                             
*                                                                               
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),0(R4)       MOVE TO WORKAREA                             
*                                                                               
         LA    R4,1(RF,R4)         POINT TO NEXT FIELD                          
*                                                                               
         LA    RE,0(RF,RE)         LAST BYTE OF FIELD IN WORK                   
*                                                                               
         AHI   RF,1                RESTORE LENGTH COUNTER                       
*                                                                               
         CLI   0(RE),C' '          DROP TRAILING SPACES                         
         BH    *+10                                                             
         BCTR  RE,0                BACKUP A BYTE                                
         BCT   RF,*-10             REPEAT                                       
*                                                                               
         CHI   R0,1                SKIP IF LAST FIELD IN RECORD                 
         BE    *+12                                                             
         MVI   1(RE),C','             SET COMMA                                 
         LA    RE,1(RE)               BUMP POINTER                              
*                                                                               
PRILSPCN DS    0H                                                               
*                                                                               
         LA    R2,1(R2)            BUMP FIELD LENGTHS PTR                       
         LA    RE,1(RE)            NEXT AVAILABLE BYTE                          
         BCT   R0,PRILSPLP         NEXT FIELD                                   
*                                                                               
PRILSPDN DS    0H                                                               
*                                                                               
*        PRINT WORK RECORD - 40 BYTES AT A TIME                                 
*                                                                               
         LR    R0,RE                                                            
         LA    RF,ELEM                                                          
         SR    R0,RF               WOPRKAREA LENGTH                             
*                                                                               
         LA    R4,ELEM             POINT TO WORKAREA                            
*                                                                               
PRILPRLP DS    0H                                                               
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBFLD,SPACES      INIT FIELD                                   
*                                                                               
         LA    RF,40               MAX FIELD LENGTH                             
*                                                                               
         CR    RF,R0               IF LESS THAN 40 LEFT                         
         BNH   *+6                                                              
         LR    RF,R0                  SET TO REMAINDER                          
*                                                                               
         STC   RF,DLCBLEN          SET FIELD LENGTH                             
*                                                                               
         SR    R0,RF               REMAINING LENGTH                             
*                                                                               
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
*                                                                               
         LA    R4,1(RF,R4)         BUMP TO NEXT WORK SECTION                    
*                                                                               
         GOTO1 =V(DLFLD),DLCBD     PRINT                                        
*                                                                               
PRILPRCN DS    0H                                                               
*                                                                               
         LTR   R0,R0               SKIP IF NO REMAINING LENGTH                  
         BP    PRILPRLP                                                         
*                                                                               
         MVI   DLCBACT,DLCBEOL     END OF LINE                                  
*                                                                               
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PRILRDCN DS    0H                                                               
         B     PRILRDLP            PROCESS NEXT RECORD                          
AKRECID  DS    C                                                                
AKMODE   DS    C                                                                
AKHDMOD  EQU   1                   PROCESS HEADER RECORD                        
AKDETMOD EQU   2                   PROCESS DETAIL RECORD                        
*&&DO                                                                           
                                                                                
*********************************************************                       
*       ROUTINE TO GET DATA FROM ID                                             
*       READS DATASET AGAIN AND PRINTS IN ORDER                                 
*                                                                               
PREPID   NTR1                                                                   
         L     R2,=A(TADOWN)       OPEN DATASET                                 
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
*                                                                               
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
*                                                                               
         MVI   FORCEHED,C'Y'       FORCE NEW PAGE                               
*                                                                               
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
*                                                                               
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
*                                                                               
         DROP  R2                                                               
*                                                                               
PRID20   L     R2,=A(TADOWN)       RE-OPEN DATASET                              
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK          INIT DOWN FACILITY                           
         USING DLCBD,R3                                                         
*                                                                               
         BAS   RE,INITDWN                                                       
*                                                                               
*        SEND RECORDS TO PQ AS COMMA DELIMITED RECORDS                          
*                                                                               
PRIDRDLP DS    0H                                                               
*                                                                               
         L     R2,=A(TADOWN)                                                    
         GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
*                                                                               
         USING TUILDSKD,R4         ESTABLISH PENN RECORD                        
         LA    R4,TAPEREC                                                       
*                                                                               
PRPIDD10 DS    0H                                                               
*                                                                               
         LA    R2,PRIDTAB          POINT TO TABLE OF FIELD LENGTHS              
         LA    R0,3                3 RECORD TYPES                               
*                                                                               
*        STRIP OUT TRAILING SPACES AND ADD COMMAS                               
*                                                                               
         LLC   R0,1(R2)            NUMBER OF FIELDS IN RECORD                   
         LA    R2,2(R2)            START OF FIELD LENGTHS                       
         LA    RE,ELEM             WORK AREA                                    
         MVC   ELEM(L'SPACES),SPACES INIT WORKAREA                              
*                                                                               
PRIDSPLP DS    0H                                                               
*                                                                               
         LLC   RF,0(R2)            GET FIELD LENGTH                             
*                                                                               
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),0(R4)       MOVE TO WORKAREA                             
*                                                                               
         LA    R4,1(RF,R4)         POINT TO NEXT FIELD                          
*                                                                               
         LA    RE,0(RF,RE)         LAST BYTE OF FIELD IN WORK                   
*                                                                               
         AHI   RF,1                RESTORE LENGTH COUNTER                       
*                                                                               
         CLI   0(RE),C' '          DROP TRAILING SPACES                         
         BH    *+10                                                             
         BCTR  RE,0                BACKUP A BYTE                                
         BCT   RF,*-10             REPEAT                                       
*                                                                               
         CHI   R0,1                SKIP IF LAST FIELD IN RECORD                 
         BE    *+12                                                             
         MVI   1(RE),C','             SET COMMA                                 
         LA    RE,1(RE)               BUMP POINTER                              
*                                                                               
PRIDSPCN DS    0H                                                               
*                                                                               
         LA    R2,1(R2)            BUMP FIELD LENGTHS PTR                       
         LA    RE,1(RE)            NEXT AVAILABLE BYTE                          
         BCT   R0,PRIDSPLP         NEXT FIELD                                   
*                                                                               
PRIDSPDN DS    0H                                                               
*                                                                               
*        PRINT WORK RECORD - 40 BYTES AT A TIME                                 
*                                                                               
         LR    R0,RE                                                            
         LA    RF,ELEM                                                          
         SR    R0,RF               WOPRKAREA LENGTH                             
*                                                                               
         LA    R4,ELEM             POINT TO WORKAREA                            
*                                                                               
PRIDPRLP DS    0H                                                               
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBFLD,SPACES      INIT FIELD                                   
*                                                                               
         LA    RF,40               MAX FIELD LENGTH                             
*                                                                               
         CR    RF,R0               IF LESS THAN 40 LEFT                         
         BNH   *+6                                                              
         LR    RF,R0                  SET TO REMAINDER                          
*                                                                               
         STC   RF,DLCBLEN          SET FIELD LENGTH                             
*                                                                               
         SR    R0,RF               REMAINING LENGTH                             
*                                                                               
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
*                                                                               
         LA    R4,1(RF,R4)         BUMP TO NEXT WORK SECTION                    
*                                                                               
         GOTO1 =V(DLFLD),DLCBD     PRINT                                        
*                                                                               
PRIDPRCN DS    0H                                                               
*                                                                               
         LTR   R0,R0               SKIP IF NO REMAINING LENGTH                  
         BP    PRIDPRLP                                                         
*                                                                               
         MVI   DLCBACT,DLCBEOL     END OF LINE                                  
*                                                                               
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PRIDRDCN DS    0H                                                               
         B     PRIDRDLP            PROCESS NEXT RECORD                          
*&&                                                                             
*********************************************************                       
                                                                                
*        TABLE OF FIELD LENGTHS IN PA RECORDS                                   
*        DS    AL1(RECID),AL1(# OF FLDS),AL1(L FLD1,L'FLD2,,,,)                 
*                                                                               
PRPATAB  DS    0D                                                               
         DC    C'A',AL1(11)        HEADER RECORD                                
         DC    AL1(L'TUPAID)                                                    
         DC    AL1(L'TUPAATYP)                                                  
         DC    AL1(L'TUPAFIL1)                                                  
         DC    AL1(L'TUPAFIL2)                                                  
         DC    AL1(L'TUPAFIL3)                                                  
         DC    AL1(L'TUPAFIL4)                                                  
         DC    AL1(L'TUPAFIL5)                                                  
         DC    AL1(L'TUPAFIL6)                                                  
         DC    AL1(L'TUPAFIL7)                                                  
         DC    AL1(L'TUPAFIL8)                                                  
         DC    AL1(L'TUPAFIL9)                                                  
*                                                                               
         DC    C'E',AL1(11)        EMPLOYER RECORD                              
         DC    AL1(L'TUPAID)                                                    
         DC    AL1(L'TUPASEIN)                                                  
         DC    AL1(L'TUPACKDG)                                                  
         DC    AL1(L'TUPAPER)                                                   
         DC    AL1(L'TUPA#EM1)                                                  
         DC    AL1(L'TUPA#EM2)                                                  
         DC    AL1(L'TUPA#EM3)                                                  
         DC    AL1(L'TUPAGRST)                                                  
         DC    AL1(L'TUPATWHD)                                                  
         DC    AL1(L'TUPATTXW)                                                  
         DC    AL1(L'TUPATECN)                                                  
*                                                                               
         DC    C'S',AL1(11)        EMPLOYEE RECORD                              
         DC    AL1(L'TUPAID)                                                    
         DC    AL1(L'TUPASEIN)                                                  
         DC    AL1(L'TUPASSN)                                                   
         DC    AL1(L'TUPALNAM)                                                  
         DC    AL1(L'TUPAFNAM)                                                  
         DC    AL1(L'TUPAMNAM)                                                  
         DC    AL1(L'TUPAEGRS)                                                  
         DC    AL1(L'TUPAETAX)                                                  
         DC    AL1(L'TUPACRWK)                                                  
         DC    AL1(L'TUPAEFL1)                                                  
         DC    AL1(L'TUPAEFL2)                                                  
*                                                                               
         DC    X'FF'               EOT                                          
*                                                                               
PRILTAB  DS    0D                                                               
*                                                                               
         DC    C'E',AL1(5)         EMPLOYER RECORD                              
         DC    AL1(L'TUILID)                                                    
         DC    AL1(L'TUILEFID)                                                  
         DC    AL1(L'TUILEUIA)                                                  
         DC    AL1(L'TUILETWP)                                                  
         DC    AL1(L'TUILEWNA)                                                  
*                                                                               
         DC    C'S',AL1(5)         EMPLOYEE RECORD                              
         DC    AL1(L'TUILID)                                                    
         DC    AL1(L'TUILSFNM)                                                  
         DC    AL1(L'TUILSLNM)                                                  
         DC    AL1(L'TUILSSSN)                                                  
         DC    AL1(L'TUILSWGS)                                                  
*                                                                               
         DC    X'FF'               EOT                                          
         DROP  R4                                                               
PRIDTAB  DS    0D                                                               
*                                                                               
         DC    AL1(9)                                                           
         DC    AL1(L'TUIDEACC)                                                  
         DC    AL1(L'TUIDSSN)                                                   
         DC    AL1(L'TUIDEMPN)                                                  
         DC    AL1(L'TUIDFNAM)                                                  
         DC    AL1(L'TUIDMNAM)                                                  
         DC    AL1(L'TUIDLNAM)                                                  
         DC    AL1(L'TUIDRPQT)                                                  
         DC    AL1(L'TUIDYEAR)                                                  
         DC    AL1(L'TUIDWAGE)                                                  
*                                                                               
         DC    X'FF'               EOT                                          
PRAKTABH DS    0D                  ALASKA EMPLOYER HEADER                       
*                                                                               
         DC    AL1(11)                                                          
         DC    AL1(L'TUAKEACC)                                                  
         DC    AL1(L'TUAKRPYR)                                                  
         DC    AL1(L'TUAKRPQT)                                                  
         DC    AL1(L'TUAKZERO)                                                  
         DC    AL1(L'TUAKWOST)                                                  
         DC    AL1(L'TUAKLEXW)                                                  
         DC    AL1(11)                                                          
         DC    AL1(L'TUAKREMT)                                                  
         DC    AL1(L'TUAKMON1)                                                  
         DC    AL1(L'TUAKMON2)                                                  
         DC    AL1(L'TUAKMON3)                                                  
         DC    X'FF'               EOT                                          
*                                                                               
PRAKTABD DS    0D                  ALASKA EMPLOYEE DETAILS                      
         DC    AL1(12)                                                          
         DC    AL1(L'TUAKEACC)                                                  
         DC    AL1(L'TUAKRPYR)                                                  
         DC    AL1(L'TUAKRPQT)                                                  
         DC    AL1(L'TUAKSSN)                                                   
         DC    AL1(L'TUAKLNAM)                                                  
         DC    AL1(L'TUAKFNAM)                                                  
         DC    AL1(L'TUAKMNAM)                                                  
         DC    AL1(L'TUAKWAGE)                                                  
         DC    AL1(1)                                                           
         DC    AL1(20)                                                          
         DC    AL1(L'TUAKOCOD)                                                  
         DC    AL1(L'TUAKGCOD)                                                  
         DC    X'FF'               EOT                                          
*&&DO                                                                           
*                                                                               
*        ROUTINE TO GET FROM NEW MEXICO DATASET AND PRINT 2ND REPORT            
*        FIRST GETS TOTAL RECORD AND SAVES TOTALS IN BLOCK                      
*        THEN GOES THROUGH DATASET AGAIN AND COMBINES TOTALS WITH               
*        EMPLOYER RECORD                                                        
*                                                                               
PREPNM   NTR1                                                                   
         L     R2,=A(TADOWN)                                                    
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
PRNM10   GET   (R2),TAPEREC        GET FROM DISK                                
         USING TUNMDSKD,R4                                                      
         LA    R4,TAPEREC                                                       
         CLC   TUNMROWE(6),=C'TOTALS'  FIND TOTAL RECORD                        
         BNE   PRNM10                                                           
         MVC   BLOCK(L'TUNMETOT),TUNMETOT   SAVE TOTALS FOR LATER               
         DROP  R4                                                               
*                                                                               
         CLOSE ((2))               CLOSE THE DATASET                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
         MVI   FORCEHED,C'Y'                                                    
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
         DROP  R2                                                               
*                                                                               
PRNM20   L     R2,=A(TADOWN)                                                    
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK                                                       
         USING DLCBD,R3                                                         
         BAS   RE,INITDWN                                                       
*                                                                               
PRNM22   GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
         USING TUNMDSKD,R4                                                      
         LA    R4,TAPEREC                                                       
*                                                                               
         CLC   TUNMROWE(6),=C'TOTALS'   IGNORE TOTAL RECORD                     
         BE    PRNM22                                                           
*                                                                               
         CLC   TUNMREP,=C'DOL_903'                                              
         BNE   PRNM23                                                           
         LHI   R1,120              RECORD LENGTH OF DATA HEADER                 
         B     PRNM27                                                           
*                                                                               
PRNM23   CLC   TUNMROWH,=C'ES_903_Header'                                       
         BNE   PRNM24                                                           
         LHI   R1,40               RECORD LENGTH OF HEADER                      
         B     PRNM27                                                           
*                                                                               
PRNM24   CLC   TUNMROWE,=C'ES_903_Employer'                                     
         BNE   PRNM25                                                           
         MVC   TUNMETOT,BLOCK      ADD TOTALS TO END OF EMPLOYER REC            
         LH    R1,DCBRLN           RECORD LENGTH IN DCBRLN                      
         B     PRNM27                                                           
*                                                                               
PRNM25   LHI   R1,85               RECORD LENGTH OF EMPLOYEE RECORD             
*                                                                               
PRNM27   SR    R0,R0                                                            
         D     R0,=F'40'           R1  = # OF 40 BYTE CHUNKS                    
         STC   R0,REM              REM = LEFT OVER BYTES                        
*                                                                               
         LTR   R1,R1                                                            
         BZ    PRNM40                                                           
*                                                                               
PRNM30   STC   R1,QUO                                                           
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
*                                                                               
         MVI   DLCBLEN,40                                                       
         MVC   DLCBFLD(40),0(R4)    PASS DATA                                   
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R4,40(R4)           BUMP TO NEXT TAPE FIELD                      
         ZIC   R1,QUO                                                           
         BCT   R1,PRNM30                                                        
*                                                                               
PRNM40   CLI   REM,0                                                            
         BE    PRNM50                                                           
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBLEN,REM                                                      
         ZIC   RE,REM                                                           
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PRNM50   MVI   DLCBACT,DLCBEOL     END OF LINE                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         B     PRNM22                                                           
         DROP  R4                                                               
         EJECT                                                                  
*&&                                                                             
*======================================================================         
*                                                                     *         
*        ROUTINE TO GET FROM FLORIDA DATASET AND PRINT 2ND REPORT     *         
*        FIRST GETS TOTAL RECORD AND SAVES TOTALS IN BLOCK            *         
*        THEN GOES THROUGH DATASET AGAIN AND COMBINES TOTALS WITH     *         
*        EMPLOYER RECORD                                              *         
*                                                                     *         
*======================================================================         
         SPACE 2                                                                
*                                                                               
PREPFL   NTR1                                                                   
*                                                                               
         L     R2,=A(TADOWN)       OPEN FLORIDA DATASET                         
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
PRFL10   GET   (R2),TAPEREC        GET FROM DISK                                
*                                                                               
         USING TUFLDSKD,R4                                                      
*                                                                               
         LA    R4,TAPEREC                                                       
*                                                                               
         CLC   TUFLID,=C'RX'       FIND EXTRA TOTAL RECORD                      
         BNE   PRFL10                                                           
*                                                                               
         XC    BLOCK,BLOCK                                                      
         MVC   BLOCK(TUFLRXLN),TUFLTGRS   SAVE TOTALS FOR LATER                 
         DROP  R4                                                               
*                                                                               
         CLOSE ((2))               CLOSE THE DATASET                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
*                                                                               
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
*                                                                               
         MVI   FORCEHED,C'Y'                                                    
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
*                                                                               
         DROP  R2                                                               
*                                                                               
PRFL20   L     R2,=A(TADOWN)       REOPEN FLORIDA DATASET                       
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK                                                       
         USING DLCBD,R3                                                         
*                                                                               
         BAS   RE,INITDWN                                                       
*                                                                               
PRFL25   GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
*                                                                               
         USING TUFLDSKD,R4                                                      
         LA    R4,TAPEREC                                                       
*                                                                               
         CLC   TUFLID,=C'RX'       SKIP RX RECORD                               
         BE    PRFL25                                                           
*                                                                               
         CLC   TUFLID,=C'01'       NEED TO ADD TOTALS TO 01 RECORD              
         BNE   PRFL30                                                           
*                                                                               
         MVC   TUFLTOTS(TUFLRXLN),BLOCK    ADD TOTALS TO 01 RECORD              
*                                                                               
PRFL30   SR    R0,R0                                                            
****     LH    R1,DCBRLN           RECORD LENGTH IN DCBRLN                      
         CLC   TUFLID,=C'00'       CHECK FOR HEADER RECORD                      
         BNE   *+12                                                             
         LA    R1,TUFL00LQ            SET RECORD LENGTH                         
         B     PRFL35                                                           
*                                                                               
         CLC   TUFLID,=C'01'       CHECK FOR EMPLOYER RECORD                    
         BNE   *+12                                                             
         LA    R1,TUFL01LQ            SET RECORD LENGTH                         
         B     PRFL35                                                           
*                                                                               
         CLC   TUFLID,=C'02'       CHECK FOR EMPLOYEE RECORD                    
         BNE   *+12                                                             
         LA    R1,TUFL02LQ            SET RECORD LENGTH                         
         B     PRFL35                                                           
*                                                                               
         CLC   TUFLID,=C'03'       CHECK FOR TOTAL RECORD                       
         BNE   *+12                                                             
         LA    R1,TUFL03LQ            SET RECORD LENGTH                         
         B     PRFL35                                                           
*                                                                               
         CLC   TUFLID,=C'99'       CHECK FOR FINAL RECORD                       
         BNE   *+12                                                             
         LA    R1,TUFL99LQ            SET RECORD LENGTH                         
         B     PRFL35                                                           
*                                                                               
         B     PRFL55                                                           
*                                                                               
PRFL35   DS    0H                                                               
*                                                                               
         D     R0,=F'40'           R1 = # OF 40 BYTE CHUNCKS                    
         STC   R0,REM              REM = LEFT OVER BYTES                        
*                                                                               
         LTR   R1,R1                                                            
         BZ    PRFL40                                                           
*                                                                               
PRFL37   STC   R1,QUO                                                           
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
*                                                                               
         MVI   DLCBLEN,40                                                       
         MVC   DLCBFLD(40),0(R4)    PASS DATA                                   
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R4,40(R4)           BUMP TO NEXT TAPE FIELD                      
         ZIC   R1,QUO                                                           
         BCT   R1,PRFL37                                                        
*                                                                               
PRFL40   CLI   REM,0                                                            
         BE    PRFL50                                                           
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBLEN,REM                                                      
         ZIC   RE,REM                                                           
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PRFL50   DS    0H                                                               
*                                                                               
         MVI   DLCBACT,DLCBEOL     END OF LINE                                  
*                                                                               
******   CLC   TUFLID,=C'01'       IF EMPLOYER RECORD                           
******   BE    PRFL55                 SKIP EOL                                  
*                                                                               
******   CLC   TUFLID,=C'99'       IF FINAL  RECORDRD                           
******   BNE   *+8                                                              
******   MVI   DLCBACT,DLCBWRT        WRITE LINE W/O EOL                        
*                                                                               
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PRFL55   DS    0H                                                               
*                                                                               
         B     PRFL25                                                           
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
*        ROUTINE TO GET FROM HAWAII DATASET AND PRINT 2ND REPORT                
*        FIRST GETS EMPLOYER REC AND SAVES IN BLOCK, THEN                       
*        COMBINES 14 EMPLOYEES WITH EMPLOYER RECORD.  THEN REPEATS              
*        FOR NEXT 14 EMPLOYEES, ETC.                                            
*                                                                               
PREPHI   NTR1                                                                   
         XC    HICOUNT,HICOUNT      RESET HAWAII COUNTER                        
         BRAS  RE,CLRAIO2           CLEAR AIO2                                  
*                                                                               
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
         MVI   FORCEHED,C'Y'                                                    
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
         DROP  R2                                                               
*                                                                               
         L     R2,=A(TADOWN)                                                    
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK                                                       
         USING DLCBD,R3                                                         
         BAS   RE,INITDWN                                                       
         L     R4,AIO2             CREATE RECORD HERE                           
*                                                                               
PRHI20   GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
         USING TUHIDSKD,R1                                                      
         LA    R1,TAPEREC                                                       
*                                                                               
         CLC   TUHIID,=C'RE'                                                    
         BNE   PRHI23                                                           
         XC    BLOCK,BLOCK                                                      
         MVC   BLOCK(TUHIELNQ),TUHIBAT    SAVE EMPLOYER DETAILS                 
         MVC   0(TUHIELNQ,R4),BLOCK                                             
         AHI   R4,TUHIELNQ                                                      
         B     PRHI20                                                           
*                                                                               
PRHI23   CLC   TUHIID,=C'RT'       TRAILER RECORD                               
         BNE   PRHI25                                                           
         CLC   HICOUNT,=H'14'                                                   
         BNH   *+6                                                              
         DC    H'00'                                                            
         LHI   R0,14                                                            
         SH    R0,HICOUNT          CALCULATE HOW MANY PEOPLE TO BUMP            
         MHI   R0,TUHISLNQ         EMPLOYEE DETAILS LENGTH                      
         AR    R4,R0               BUMP TO END OF 14 PEOPLE                     
         MVC   0(TUHIS2LN,R4),TUHIRTOT    TOTAL WAGES OF LAST 14 PEOPLE         
         L     R4,AIO2             R4 --> RECORD TO PUT TO DOWNLOAD             
         B     PRHI30                                                           
*                                                                               
PRHI25   CLC   TUHIID,=C'RS'       EMPLOYEE RECORDS                             
         BE    *+6                                                              
         DC    H'00'               SHOULDN'T BE ANY OTHER TYPE OF RECS          
*                                                                               
         LH    R0,HICOUNT                                                       
         AHI   R0,1                INCREMENT SSN COUNTER                        
         STH   R0,HICOUNT                                                       
*                                                                               
         MVC   0(TUHISLNQ,R4),TUHISSN   SSN, NAME, WAGES                        
         AHI   R4,TUHISLNQ                                                      
         CLC   HICOUNT,=H'14'                                                   
         BL    PRHI20                                                           
         XC    HICOUNT,HICOUNT     RESET SSN COUNTER                            
         MVC   0(TUHIS2LN,R4),TUHIRTOT   WAGES OF 14, TODAY'S DATE              
         L     R4,AIO2             R4 --> RECORD TO PUT TO DOWNLOAD             
         DROP  R1                                                               
*                                                                               
PRHI30   SR    R0,R0                                                            
         LHI   R1,739              RECORD LENGTH                                
         D     R0,=F'40'           R1 = # OF 40 BYTE CHUNCKS                    
         STC   R0,REM              REM = LEFT OVER BYTES                        
*                                                                               
         LTR   R1,R1                                                            
         BZ    PRHI40                                                           
*                                                                               
PRHI35   STC   R1,QUO                                                           
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
*                                                                               
         MVI   DLCBLEN,40                                                       
         MVC   DLCBFLD(40),0(R4)    PASS DATA FROM AIO2                         
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R4,40(R4)           BUMP TO NEXT TAPE FIELD                      
         ZIC   R1,QUO                                                           
         BCT   R1,PRHI35                                                        
*                                                                               
PRHI40   CLI   REM,0                                                            
         BE    PRHI50                                                           
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBLEN,REM                                                      
         ZIC   RE,REM                                                           
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PRHI50   MVI   DLCBACT,DLCBEOL     END OF LINE                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         BRAS  RE,CLRAIO2          CLEAR AIO2                                   
         L     R4,AIO2             CREATE RECORD HERE                           
         MVC   0(TUHIELNQ,R4),BLOCK   EMPLOYER INFORMATION                      
         AHI   R4,TUHIELNQ                                                      
         B     PRHI20                                                           
         EJECT                                                                  
*                                                                               
*        ROUTINE TO GET FROM RHODE ISLAND DATASET AND PRINT 2ND REPORT          
*        FIRST GETS TOTAL RECORD AND THEN GETS EMPLOYEE RECORDS                 
*                                                                               
PREPRI   NTR1                                                                   
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
         MVI   FORCEHED,C'Y'                                                    
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         LA    R3,DLBLOCK                                                       
         USING DLCBD,R3                                                         
         BAS   RE,INITDWN                                                       
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
         DROP  R2                                                               
         L     R2,=A(TADOWN)                                                    
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
PRRI10   GET   (R2),TAPEREC        GET FROM DISK                                
* PROCESS MAINE                                                                 
         CLC   =C'ME ',SVSTATE                                                  
         BNE   PRRI18                                                           
         USING WHMEWHD,R4                                                       
*                                                                               
         LA    R4,TAPEREC                                                       
         TM    STSTAT,STSTATM2     MAINE WITH FILE OPTION?                      
         BNO   PRRI19                                                           
         CLI   WHRECTYP,WHRECWITH  PROCESS WITHHOLDING RECORDS                  
         BNE   PRRI10                                                           
         AHI   R4,1                SKIP FIRST BYTE OF RECORD                    
***      BAS   RE,PUTRI            PUT ITEM TO PRINT LINE                       
         BRAS  RE,PUTRI            PUT ITEM TO PRINT LINE                       
         CLI   0(R4),WHMEWIDFQ     DID WE PROCESS FINAL RECORD FOR WITH         
         BE    PRRI19              THEN CLOSE DATASET                           
         B     PRRI10              GET NEXT RECORD                              
*                                                                               
         USING TURIDSKD,R4                                                      
PRRI18   LA    R4,TAPEREC                                                       
         CLI   TURIID,C'T'         FIND TOTAL RECORD                            
         BNE   PRRI10                                                           
****     BAS   RE,PUTRI            PUT ITEM TO PRINT LINE                       
         BRAS  RE,PUTRI            PUT ITEM TO PRINT LINE                       
         DROP  R4                                                               
*                                                                               
PRRI19   CLOSE ((2))               CLOSE THE DATASET                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*&&DO                                                                           
* SET UP NEW PRINT QUEUE REPORT FOR MAINE                                       
* TO PROCESS UNEMPLOYMENT WAGE RECORDS                                          
         CLC   =C'ME ',SVSTATE                                                  
         BNE   PRRI20                                                           
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
*                                                                               
         MVI   FORCEHED,C'Y'       FORCE NEW PAGE                               
*                                                                               
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
*                                                                               
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
*                                                                               
         DROP  R2                                                               
*                                                                               
*&&                                                                             
PRRI20   L     R2,=A(TADOWN)                                                    
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
PRRI25   GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
                                                                                
         CLC   =C'ME ',SVSTATE                                                  
         BNE   PRRI28                                                           
         TM    STSTAT,STSTATM1     MAINE WAGE FILE OPTION?                      
         BNO   PRRI25                                                           
         USING UNMEWHD,R4                                                       
*                                                                               
         LA    R4,TAPEREC                                                       
         CLI   UNRECTYP,UNRECUNEM  SKIP UNEMPLOYEMENT WAGE RECORDS              
         BNE   PRRI25                                                           
         AHI   R4,1                SKIP FIRST BYTE OF RECORD                    
****     BAS   RE,PUTRI            PUT ITEM TO PRINT LINE                       
         BRAS  RE,PUTRI            PUT ITEM TO PRINT LINE                       
         B     PRRI25              GET NEXT RECORD                              
*                                                                               
         USING TURIDSKD,R4                                                      
PRRI28   LA    R4,TAPEREC                                                       
*                                                                               
         CLC   TURIID,=C'T'        SKIP TOTAL RECORD                            
         BE    PRRI25                                                           
*                                                                               
**PRRI30   BAS   RE,PUTRI            PUT ITEM TO PRINT LINE                     
PRRI30   BRAS  RE,PUTRI            PUT ITEM TO PRINT LINE                       
         B     PRRI25              GET NEXT RECORD                              
         DROP  R4                                                               
*                                                                               
* MOVED TO ITS OWN BASE REGISTER                                                
*&&DO                                                                           
*        PUT ITEM TO PRINT LINE FOR RHODE ISLAND                                
*                                                                               
PUTRI    NTR1                                                                   
         SR    R0,R0                                                            
         LH    R1,DCBRLN           RECORD LENGTH IN DCBRLN                      
         D     R0,=F'40'           R1 = # OF 40 BYTE CHUNCKS                    
         STC   R0,REM              REM = LEFT OVER BYTES                        
*                                                                               
         LTR   R1,R1                                                            
         BZ    PTRI40                                                           
*                                                                               
PTRI35   STC   R1,QUO                                                           
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
*                                                                               
         MVI   DLCBLEN,40                                                       
         MVC   DLCBFLD(40),0(R4)    PASS DATA                                   
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R4,40(R4)           BUMP TO NEXT TAPE FIELD                      
         ZIC   R1,QUO                                                           
         BCT   R1,PTRI35                                                        
*                                                                               
PTRI40   CLI   REM,0                                                            
         BE    PTRI50                                                           
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBLEN,REM                                                      
         ZIC   RE,REM                                                           
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PTRI50   MVI   DLCBACT,DLCBEOL     END OF LINE                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         J     XIT                                                              
         EJECT                                                                  
*&&                                                                             
***********************************************************************         
*                                                                     *         
*        ROUTINE TO GET FROM NC DATASET AND PRINT 2ND REPORT          *         
*        FIRST GETS FINAL RECORD AND CREATES AND WRITES 'N' RECORD    *         
*        THEN GOES THROUGH DATASET AGAIN AND WRITES ALL               *         
*                                                                     *         
***********************************************************************         
*                                                                               
PREPNC   NTR1                                                                   
         L     R2,=A(TADOWN)       OPEN WORK DATASET                            
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
PRNC10   GET   (R2),TAPEREC        GET FROM DISK                                
*                                                                               
         USING TUVER4D,R4          ESTABLISH WORK RECORD                        
         LA    R4,TAPEREC                                                       
*                                                                               
         CLI   TUV4ID,C'F'         FIND FINAL RECORD                            
         BNE   PRNC10                                                           
*                                                                               
         MVC   BLOCK(250),TUV4ID     SAVE FINAL RECORD FOR LATER                
         MVC   BLOCK(25),TUV4ID+250                                             
*                                                                               
         DROP  R4                                                               
*                                                                               
         CLOSE ((2))               CLOSE THE DATASET                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
*        BUILD 'N' RECORD                                                       
*                                                                               
         LA    R4,TAPEREC          POINT TO TAPE WORKAREA                       
         USING TUVER4D,R4          ESTABLISH WORK RECORD                        
*                                                                               
         MVC   0(132,R4),SPACES    INIT TO SPACES                               
         MVC   132(132,R4),SPACES                                               
         MVC   264(11,R4),SPACES                                                
*                                                                               
         MVI   TUV4ID,C'N'         SET RECORD ID                                
         MVC   TUV4NAC#,PRINTID    EMPLOYER ID NUMBER                           
         EDIT  QQUART,TUV4NQTR     FILING QUARTER 1,2,3,4                       
         MVC   TUV4NYR,RYEAR       YEAR - CCYY                                  
*                                                                               
         MVC   TUV4NMN1,TUV4FMN1+3-TUVER4D+BLOCK # IN 1ST MON                   
         MVC   TUV4NMN2,TUV4FMN2+3-TUVER4D+BLOCK # IN 2ND MON                   
         MVC   TUV4NMN3,TUV4FMN3+3-TUVER4D+BLOCK # IN 3RD MON                   
*                                                                               
         MVC   TUV4NWG,TUV4FWG+4-TUVER4D+BLOCK   TOTAL WAGES                    
         MVC   TUV4NNSU,TUV4FNSU+4-TUVER4D+BLOCK NON-TAX SUI                    
         MVC   TUV4NSUI,TUV4FSUI+4-TUVER4D+BLOCK TAXABLE SUI                    
*                                                                               
         MVC   TUV4NRMR,=CL6'010403' REMITTER NUMBER                            
*                                                                               
         MVI   TUV4NFRM,C'I'       FORMAT ID                                    
*                                                                               
         BRAS  RE,NEWPRTQ2          SET NEW PRINT QUEUE REPORT                  
*                                                                               
         GOTO1 REQTWA,DMCB,(3,ATWA),,VPRINT,(C'B',ABOX)                         
         CLI   DMCB+8,0                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
         MVI   FORCEHED,C'Y'                                                    
         GOTO1 SPOOL,DMCB,(R8)                                                  
*                                                                               
         L     R2,AMASTD         DO NOT PRINT LOGOS                             
         USING MASTD,R2                                                         
         NI    MCPRTIND,X'FF'-MCPRTINL                                          
         DROP  R2                                                               
*                                                                               
PRNC20   L     R2,=A(TADOWN)       RE-OPEN WORK DATASET                         
         OPEN  ((2),INPUT)                                                      
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LA    R3,DLBLOCK          INITIALIZE DOWNLOAD                          
         USING DLCBD,R3                                                         
         BAS   RE,INITDWN                                                       
*                                                                               
         B     PRNC25              PUT 'N' RECORD TO PRINT                      
*                                                                               
PRNC22   GET   (R2),TAPEREC        GET FROM DISK AND PRINT                      
         USING TUVER4D,R4          ESTABLISH WORK RECORD                        
*                                                                               
PRNC25   DS    0H                                                               
*                                                                               
         LA    R4,TAPEREC                                                       
*                                                                               
         CLI   TUV4ID,C'A'         IGNORE FIRST RECORD                          
         BE    PRNC22                                                           
*                                                                               
         CLI   TUV4ID,C'B'         IGNORE SECOND RECORD                         
         BE    PRNC22                                                           
*                                                                               
         CLI   TUV4ID,C'T'         IGNORE TOTAL RECORD                          
         BE    PRNC22                                                           
*                                                                               
         CLI   TUV4ID,C'F'         IGNORE FINAL RECORD                          
         BE    PRNC22                                                           
*                                                                               
         LHI   R1,275              RECORD LENGTH                                
*                                                                               
PRNC27   SR    R0,R0                                                            
         D     R0,=F'40'           R1  = # OF 40 BYTE CHUNKS                    
         STC   R0,REM              REM = LEFT OVER BYTES                        
*                                                                               
         LTR   R1,R1                                                            
         BZ    PRNC40                                                           
*                                                                               
PRNC30   STC   R1,QUO                                                           
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
*                                                                               
         MVI   DLCBLEN,40                                                       
         MVC   DLCBFLD(40),0(R4)    PASS DATA                                   
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R4,40(R4)           BUMP TO NEXT TAPE FIELD                      
         ZIC   R1,QUO                                                           
         BCT   R1,PRNC30                                                        
*                                                                               
PRNC40   CLI   REM,0                                                            
         BE    PRNC50                                                           
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBLEN,REM                                                      
         ZIC   RE,REM                                                           
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PRNC50   MVI   DLCBACT,DLCBEOL     END OF LINE                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         B     PRNC22                                                           
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
NOMORE   CLOSE ((2))               CLOSE THE DATASET                            
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
         CLI   ACTNUM,ACTDOWN                                                   
         BE    NOMORE2                                                          
         L     R1,ALOGO            NO-OP SO DON'T END AGAIN                     
         MVC   0(2,R1),=X'07FE'                                                 
         J     XIT                                                              
NOMORE2  MVI   DLCBACT,DLCBEOR                                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         J     XIT                                                              
*          DATA SET TAREP2BNYA AT LEVEL 063 AS OF 03/20/00                      
*              ROUTINE TO SET UP SECOND REPORT ON QUEUE                         
*                                                                               
         USING DLCBD,R3                                                         
INITDWN  NTR1                                                                   
         XC    DLCBD(DLCBXLX),DLCBD                                             
         MVI   DLCBACT,DLCBINIT    INITIALIZE FOR DOWNLOAD                      
         LA    R1,SPLATDWN         A(HOOK ROUTINE FOR PRINTING)                 
         ST    R1,DLCBAPR                                                       
         LA    R1,P                A(PRINT LINE)                                
         MVC   P,SPACES                                                         
         ST    R1,DLCBAPL                                                       
         MVC   DLCBAED,EDITOR                                                   
         MVC   DLCXMAXL,=Y(L'P)    MAXIMUM LENGTH OF PRINT LINE                 
         MVI   DLCXDELC,C' '       DELIMITER                                    
         MVI   DLCXEOTC,C'"'       TEXT DELIMITER                               
         MVI   DLCXEOTA,C''''      TEXT DELIMITER ALTERNATE                     
         MVI   DLCXEOLC,X'5E'      SEMI-COLON FOR END OF LINE                   
         MVI   DLCXEORC,C':'       END OF REPORT                                
         OI    DLCBFLG1,DLCBFXTN                                                
         GOTO1 =V(DLFLD),DLCBD                                                  
         J     XIT                                                              
         DROP  R3                                                               
         EJECT                                                                  
*                                                                               
*              USER SUPPLIED PRINT ROUTINE - DOWNLOAD                           
         SPACE 1                                                                
SPLATDWN NTR1                                                                   
         MVI   LINE,1              PREVENT PAGE BREAK                           
         GOTO1 SPOOL,DMCB,(R8)                                                  
         J     XIT                                                              
         EJECT                                                                  
         LTORG                                                                  
SVSTATE  DS    CL3                                                              
         EJECT                                                                  
*****************************************************************               
*        PUT ITEM TO PRINT LINE FOR RHODE ISLAND                                
*****************************************************************               
*                                                                               
PUTRI    NTR1  BASE=*,LABEL=*                                                   
         LA    R3,DLBLOCK                                                       
         USING DLCBD,R3                                                         
         SR    R0,R0                                                            
         LH    R1,DCBRLN           RECORD LENGTH IN DCBRLN                      
         D     R0,=F'40'           R1 = # OF 40 BYTE CHUNCKS                    
         STC   R0,REM              REM = LEFT OVER BYTES                        
*                                                                               
         LTR   R1,R1                                                            
         BZ    PTRI40                                                           
*                                                                               
PTRI35   STC   R1,QUO                                                           
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
*                                                                               
         MVI   DLCBLEN,40                                                       
         MVC   DLCBFLD(40),0(R4)    PASS DATA                                   
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
         LA    R4,40(R4)           BUMP TO NEXT TAPE FIELD                      
         ZIC   R1,QUO                                                           
         BCT   R1,PTRI35                                                        
*                                                                               
PTRI40   CLI   REM,0                                                            
         BE    PTRI50                                                           
*                                                                               
         MVI   DLCBACT,DLCBPUT     PUT ITEM TO PRINT LINE                       
         MVI   DLCBTYP,DLCBTXT     DATA TYPE IS TEXT                            
         MVC   DLCBLEN,REM                                                      
         ZIC   RE,REM                                                           
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLD(0),0(R4)    PASS DATA                                    
         GOTO1 =V(DLFLD),DLCBD                                                  
*                                                                               
PTRI50   MVI   DLCBACT,DLCBEOL     END OF LINE                                  
         GOTO1 =V(DLFLD),DLCBD                                                  
         J     XIT                                                              
         DROP  R3                                                               
         LTORG                                                                  
*                                                                               
*              ROUTINE TO CLEAR AIO2                                            
*                                                                               
CLRAIO2  NTR1  BASE=*,LABEL=*                                                   
         LA    RE,3                                                             
         L     R5,AIO2                                                          
CLRIO10  XC    0(250,R5),0(R5)                                                  
         LA    R5,250(R5)                                                       
         BCT   RE,CLRIO10                                                       
         XIT1                                                                   
*                                                                               
*              ROUTINE TO SET UP SECOND REPORT ON QUEUE                         
*                                                                               
NEWPRTQ2 NTR1  BASE=*,LABEL=*                                                   
         L     R2,ALOGOC                                                        
         USING LOGOD,R2                                                         
         MVI   LOGOTYPE,C'E'                                                    
         GOTO1 ALOGO,DMCB,(R2)     END REPORT LOGOS                             
*                                                                               
         TM    WHEN,X'20'          SOON?                                        
         BO    NPRT10                                                           
         GOTO1 VPRINT,DMCB,=C'CLOSE'                                            
*                                                                               
NPRT10   XC    SPECS,SPECS         CLEAR SPECS                                  
         XC    HEADHOOK,HEADHOOK   AND HEADLINE HOOK                            
         L     R2,ABOX                                                          
         USING BOXD,R2                                                          
         LA    RE,132                                                           
         ST    RE,BOXWIDTH         SET LENGTH OF PRINT LINE                     
*                                                                               
         L     RF,AMASTD                                                        
         USING MASTD,RF                                                         
         L     R2,AREMOT                                                        
         USING REMOTED,R2                                                       
         TM    WHEN,X'20'          SOON?                                        
         BZ    NPRT20                                                           
         XC    MCREMPQK,MCREMPQK                                                
         B     NPRT30                                                           
*                                                                               
NPRT20   MVC   REMOTABF,MCVPQBUF                                                
         MVC   REMOTADM,MCVDMGR                                                 
         MVC   REMOTAOP,MCVPQOPN                                                
         MVC   REMOTDST,MCDESTID                                                
         XC    MCALTREF,MCALTREF                                                
         MVI   REMOTCPY,C'1'                                                    
         MVI   REMOTCLS,C'Q'                                                    
         MVC   REMOTJID,=C'TKD'                                                 
NPRT30   MVC   REMOTKEY(11),SPACES                                              
         MVC   REMOTSYS(6),=C'UCDATA'                                           
         MVC   REMOTFRM(4),=C'DATA'                                             
         XIT1                                                                   
         DROP  R2,RF                                                            
         EJECT                                                                  
*        PUT RECORD TO TAPE                                                     
*                                                                               
         USING UCRD,R3                                                          
PUTTAPE  NTR1  BASE=*,LABEL=*                                                   
         BAS   RE,TRACEM           TRACE RECORD IF NECESSARY                    
         CLI   WRITAPE,C'N'        IF WRITING TO TAPE                           
         BE    XIT                                                              
*                                                                               
         LA    R1,UCTAPE           R1=A(DCB) FOR UCTAPE OR UCDISK               
         CLI   ACTEQU,ACTDOWN      ARE WE DOWNLOADING?                          
         BNE   *+8                 NO                                           
         LA    R1,TADOWN           YES, USE TEMPORARY DATASET                   
         LA    R0,TAPEIO                                                        
*                                                                               
         PUT   (1),(0)             PUT THE RECORD TO TAPE                       
                                                                                
         CLC   UCRSTATE(2),=C'CA'                                               
         BNE   XIT                                                              
         MVC   TAPEIO(L'MYSPACES),MYSPACES                                      
         LA    R4,TAPEIO                                                        
                                                                                
         XIT1  REGS=(R4)                                                        
         EJECT                                                                  
TRACEM   NTR1                                                                   
         CLI   UTRACE,C'Y'                                                      
         BNE   XIT                                                              
         MVI   P,X'BF'                                                          
         MVC   P+1(131),P                                                       
         MVC   P+60(16),RECTYPE                                                 
         BAS   RE,SPLAT                                                         
         LA    R2,TAPEIO                                                        
         LA    R1,3                                                             
         SPACE 1                                                                
TRACE2   MVC   P(100),0(R2)                                                     
         BAS   RE,PRINTIT2                                                      
         LA    R2,100(R2)                                                       
         BCT   R1,TRACE2                                                        
         BAS   RE,PRINTIT2                                                      
         B     XIT                                                              
         SPACE 2                                                                
         SPACE 1                                                                
SPLAT    NTR1                                                                   
         MVC   P,MYP                                                            
         MVC   P2,MYP2                                                          
         MVC   P3,MYP3                                                          
         MVC   P4,MYP4                                                          
         BAS   RE,PRINTIT2                                                      
         BAS   RE,MYCLEAR                                                       
         B     XIT                                                              
         SPACE 2                                                                
*                                                                               
PRINTIT2 NTR1                                                                   
*        CLI   ACTEQU,ACTDOWN                                                   
*        BE    XIT                                                              
         GOTO1 SPOOL,DMCB,(R8)                                                  
         MVC   P,SPACES                                                         
         MVI   SPACING,1                                                        
         B     XIT                                                              
*                                                                               
         SPACE 2                                                                
MYCLEAR  NTR1                                                                   
         MVI   MYP,C' '                                                         
         MVC   MYP+1(131),MYP                                                   
         MVC   MYP2,MYP                                                         
         MVC   MYP3,MYP                                                         
         MVC   MYP4,MYP                                                         
         MVC   MYSPACES,MYP                                                     
         B     XIT                                                              
         EJECT                                                                  
                                                                                
PRXMLPRC NTR1  BASE=*,LABEL=*                                                   
         CLI   DMCB,1                                                           
         JNE   PRXMLP2                                                          
         BAS   RE,PRXMLHD                                                       
         J     XIT                                                              
PRXMLP2  CLI   DMCB,2                                                           
         JNE   PRXMLP3                                                          
         BAS   RE,PRXMLDET                                                      
         J     XIT                                                              
PRXMLP3  CLI   DMCB,3                                                           
         JNE   XIT                                                              
         BAS   RE,PRXMLTR                                                       
         J     XIT                                                              
         EJECT                                                                  
*======================================================================         
PRXMLDET NTR1                                                                   
         CP    UCRGROSQ,=P'0'          DONT INCLUDE EMPLOYEES WITH NEG          
         BL    XIT                     WAGES OR TAXES                           
         CP    UCRTAXQ,=P'0'                                                    
         BL    XIT                                                              
         CP    UCRGROSQ,=P'0'          DONT INCLUDE EMPLOYEES WITH              
         BNE   PRXMLD06                POSITIVE TAXES AND ZERO WAGE             
         CP    UCRTAXQ,=P'0'                                                    
         BH    XIT                                                              
*                                                                               
PRXMLD06 GOTO1 =A(TAGIT),DMCB,(L'TEMPY,TEMPY)                                   
         BRAS  RE,PUTTAPE                                                       
                                                                                
         MVC   TSSN+25(9),UCRSSN                                                
         GOTO1 =A(TAGIT),DMCB,(L'TSSN,TSSN)                                     
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TEMPY2,TEMPY2)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TFNAME,TFNAME)                                 
         GOTO1 (RF),DMCB,(L'UCRFRST,UCRFRST)                                    
         GOTO1 (RF),DMCB,(L'TFNAMEX,TFNAMEX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         CLI   UCRMID,C' '         ANY MIDDLE INITIAL?                          
         BNH   PRXMLD10                                                         
         GOTO1 =A(TAGIT),DMCB,(L'TMNAME,TMNAME)                                 
         GOTO1 (RF),DMCB,(1,UCRMID)                                             
         GOTO1 (RF),DMCB,(L'TMNAMEX,TMNAMEX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
PRXMLD10 GOTO1 =A(TAGIT),DMCB,(L'TLNAME,TLNAME)                                 
         GOTO1 (RF),DMCB,(L'UCRLAST,UCRLAST)                                    
         GOTO1 (RF),DMCB,(L'TLNAMEX,TLNAMEX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TEMPY2X,TEMPY2X)                               
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TEWAGE,TEWAGE)                                 
         GOTO1 =A(TAGAMT),DMCB,UCRGROSQ                                         
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TEWAGEX,TEWAGEX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TETAXWG,TETAXWG)                               
***      GOTO1 =A(TAGAMT),DMCB,UCRSUIWQ                                         
         GOTO1 =A(TAGAMT),DMCB,UCRGROSQ                                         
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TETAXWGX,TETAXWGX)                                  
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TETAXWH,TETAXWH)                               
         GOTO1 =A(TAGAMT),DMCB,UCRTAXQ                                          
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TETAXWHX,TETAXWHX)                                  
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TWGPLN,TWGPLN)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TEMPYX,TEMPYX)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         J     XIT                                                              
         EJECT                                                                  
*======================================================================         
PRXMLTR  NTR1                                                                   
         GOTO1 =A(TAGIT),DMCB,(L'TPYRLX,TPYRLX)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 (RF),DMCB,(L'TMNTH1,TMNTH1)                                      
         MVC   TITLE,MYSPACES                                                   
         EDIT  (P3,NMONTH1),(7,TITLE),0,ALIGN=LEFT,ZERO=NOBLANK                 
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TMNTH1X,TMNTH1X)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 (RF),DMCB,(L'TMNTH2,TMNTH2)                                      
         MVC   TITLE,MYSPACES                                                   
         EDIT  (P3,NMONTH2),(7,TITLE),0,ALIGN=LEFT,ZERO=NOBLANK                 
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TMNTH2X,TMNTH2X)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 (RF),DMCB,(L'TMNTH3,TMNTH3)                                      
         MVC   TITLE,MYSPACES                                                   
         EDIT  (P3,NMONTH3),(7,TITLE),0,ALIGN=LEFT,ZERO=NOBLANK                 
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TMNTH3X,TMNTH3X)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 (RF),DMCB,(L'TSTCMBX,TSTCMBX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 (RF),DMCB,(L'TSTRTNX,TSTRTNX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 (RF),DMCB,(L'TDOCSTX,TDOCSTX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         J     XIT                                                              
         EJECT                                                                  
TMPTGAMT DS    PL8                                                              
         EJECT                                                                  
         LTORG                                                                  
TEMPY    DC    C'                <Employee>'                                    
TSSN     DC    C'                    <SSN>123456789</SSN>'                      
TEMPY2   DC    C'                    <Employee>'                                
TFNAME   DC    C'                        <FirstName>'                           
TFNAMEX  DC    C'</FirstName>'                                                  
TMNAME   DC    C'                        <MiddleName>'                          
TMNAMEX  DC    C'</MiddleName>'                                                 
TLNAME   DC    C'                        <LastName>'                            
TLNAMEX  DC    C'</LastName>'                                                   
TEMPY2X  DC    C'                    </Employee>'                               
TEWAGE   DC    C'                   <TotalWages>'                               
TEWAGEX  DC    C'</TotalWages>'                                                 
TETAXWG  DC    C'                   <TaxableWages>'                             
TETAXWGX DC    C'</TaxableWages>'                                               
TETAXWH  DC    C'                   <TaxWithheld>'                              
TETAXWHX DC    C'</TaxWithheld>'                                                
TWGPLN   DC    C'                   <WagePlan>S</WagePlan>'                     
TEMPYX   DC    C'                </Employee>'                                   
TPYRLX   DC    C'            </PayRoll>'                                        
TMNTH1   DC    C'            <Month1Employees>'                                 
TMNTH1X  DC    C'</Month1Employees>'                                            
TMNTH2   DC    C'            <Month2Employees>'                                 
TMNTH2X  DC    C'</Month2Employees>'                                            
TMNTH3   DC    C'            <Month3Employees>'                                 
TMNTH3X  DC    C'</Month3Employees>'                                            
TSTCMBX  DC    C'        </StateCombined>'                                      
TSTRTNX  DC    C'    </StateReturn>'                                            
TDOCSTX  DC    C'</ReturnData>'                                                 
         EJECT                                                                  
*======================================================================         
PRXMLHD  NTR1  BASE=*,LABEL=*                                                   
         GOTO1 =A(TAGIT),DMCB,(L'TXMLHD,TXMLHD)       <?xml>                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TDOCST,TDOCST)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TDOCS1,TDOCS1)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TDOCS2,TDOCS2)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TDOCS3,TDOCS3)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TCNTLOC,TCNTLOC)                               
         MVC   WORK,MYSPACES                                                    
         MVC   WORK(13),=C'TPCS200467282'                                       
         CLC   TGEMP,=C'TP '                                                    
         BE    PRXMLHD5                                                         
         MVC   WORK(13),=C'PPS363866282 '                                       
         CLC   TGEMP,=C'PP '                                                    
         BE    PRXMLHD5                                                         
         MVC   WORK(13),=C'TPPS454724371'                                       
PRXMLHD5 GOTO1 (RF),DMCB,(13,WORK)                                              
         GOTO1 (RF),DMCB,(L'TCNTLOCX,TCNTLOCX)                                  
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TRTNHDR,TRTNHDR)                               
         BRAS  RE,PUTTAPE                                                       
                                                                                
         MVC   TRTNQTR+23(1),QQUART                                             
         OI    TRTNQTR+23,X'F0'                                                 
         GOTO1 =A(TAGIT),DMCB,(L'TRTNQTR,TRTNQTR)                               
         BRAS  RE,PUTTAPE                                                       
                                                                                
         MVC   TTAXYR+17(4),RYEAR                                               
         GOTO1 =A(TAGIT),DMCB,(L'TTAXYR,TTAXYR)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TRTNTYPE,TRTNTYPE)                             
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TFLGACT,TFLGACT)                               
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TACTION,TACTION)                               
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TFLGACTX,TFLGACTX)                             
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TSTEIN,TSTEIN)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TTYPSTAT,TTYPSTAT)                             
         BRAS  RE,PUTTAPE                                                       
                                                                                
         BRAS  RE,GETEMTAX                                                      
         GOTO1 =A(TAGIT),DMCB,(L'TEINVAL,TEINVAL)                               
         GOTO1 (RF),DMCB,(L'SVEMTAX,SVEMTAX)                                    
         GOTO1 (RF),DMCB,(L'TEINVALX,TEINVALX)                                  
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TSTEINX,TSTEINX)                               
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TSTATECD,TSTATECD)                             
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TBUSADD,TBUSADD)                               
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TBUSNAM,TBUSNAM)                               
         GOTO1 (RF),DMCB,(L'NAMEFLD,NAMEFLD)                                    
         GOTO1 (RF),DMCB,(L'TBUSNAMX,TBUSNAMX)                                  
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TADDLIN,TADDLIN)                               
         GOTO1 (RF),DMCB,(L'EMPADDR,EMPADDR)                                    
         GOTO1 (RF),DMCB,(L'TADDLINX,TADDLINX)                                  
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TCITY,TCITY)                                   
         GOTO1 (RF),DMCB,(L'EMPCITY,EMPCITY)                                    
         GOTO1 (RF),DMCB,(L'TCITYX,TCITYX)                                      
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TSTATE,TSTATE)                                 
         GOTO1 (RF),DMCB,(L'EMPSTATE,EMPSTATE)                                  
         GOTO1 (RF),DMCB,(L'TSTATEX,TSTATEX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TZIPCD,TZIPCD)                                 
         GOTO1 (RF),DMCB,(L'EMPZIP,EMPZIP)                                      
         GOTO1 (RF),DMCB,(L'TZIPCDX,TZIPCDX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TBUSADDX,TBUSADDX)                             
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TRTNHDRX,TRTNHDRX)                             
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TSTRTN,TSTRTN)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TSTCMB,TSTCMB)                                 
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TNUMEM,TNUMEM)                                 
         MVC   TITLE,MYSPACES                                                   
         EDIT  (P4,UCRNSSN),(7,TITLE),0,ALIGN=LEFT,ZERO=NOBLANK                 
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TNUMEMX,TNUMEMX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TTOTWG,TTOTWG)                                 
         GOTO1 =A(TAGAMT),DMCB,UCRGROSQ                                         
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TTOTWGX,TTOTWGX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TTOTINT,TTOTINT)                               
         GOTO1 =A(TAGAMT),DMCB,UCRTAXQ                                          
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TTOTINTX,TTOTINTX)                                  
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TTAXWG,TTAXWG)                                 
         GOTO1 =A(TAGAMT),DMCB,UCRGROSQ                                         
         GOTO1 =A(TAGIT),DMCB,(L'TITLE,TITLE)                                   
         GOTO1 (RF),DMCB,(L'TTAXWGX,TTAXWGX)                                    
         BRAS  RE,PUTTAPE                                                       
                                                                                
         GOTO1 =A(TAGIT),DMCB,(L'TPYRL,TPYRL)                                   
         BRAS  RE,PUTTAPE                                                       
                                                                                
         J     XIT                                                              
         LTORG                                                                  
TXMLHD   DC    C'<?xml version="1.0" encoding="UTF-8"?>'                        
TDOCST   DC    C'<ReturnData documentCount="2"'                                 
TDOCS1   DC    C'xsi:schemaLocation="http://www.irs.gov/efile ReturnDatX        
               aState.xsd"'                                                     
TDOCS2   DC    C'xmlns="http://www.irs.gov/efile"'                              
TDOCS3   DC    C'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">X        
               '                                                                
TCNTLOC  DC    C'    <ContentLocation>'                                         
TCNTLOCX DC    C'</ContentLocation>'                                            
TRTNHDR  DC    C'    <ReturnHeaderState documentId="A">'                        
TRTNQTR  DC    C'        <ReturnQuarter>9</ReturnQuarter>'                      
TTAXYR   DC    C'        <Taxyear>9999</Taxyear>'                               
TRTNTYPE DC    C'        <ReturnType>StateCombined</ReturnType>'                
TFLGACT  DC    C'        <FilingAction>'                                        
TFLGACTX DC    C'        </FilingAction>'                                       
TACTION  DC    C'            <Action>Original</Action>'                         
TSTEIN   DC    C'        <StateEIN>'                                            
TSTEINX  DC    C'        </StateEIN>'                                           
TTYPSTAT DC    C'            <TypeStateEIN>WithholdingAccountNo</TypeStX        
               ateEIN>'                                                         
TEINVAL  DC    C'        <StateEINValue>'                                       
TEINVALX DC    C'</StateEINValue>'                                              
TSTATECD DC    C'            <StateCode>CA</StateCode>'                         
TBUSADD  DC    C'        <BusinessAddress>'                                     
TBUSNAM  DC    C'            <BusinessName>'                                    
TBUSNAMX DC    C'</BusinessName>'                                               
TADDLIN  DC    C'            <AddressLine>'                                     
TADDLINX DC    C'</AddressLine>'                                                
TCITY    DC    C'            <City>'                                            
TCITYX   DC    C'</City>'                                                       
TSTATE   DC    C'            <StateOrProvince>'                                 
TSTATEX  DC    C'</StateOrProvince>'                                            
TZIPCD   DC    C'            <ZipCode>'                                         
TZIPCDX  DC    C'</ZipCode>'                                                    
TBUSADDX DC    C'        </BusinessAddress>'                                    
TRTNHDRX DC    C'    </ReturnHeaderState>'                                      
TSTRTN   DC    C'    <StateReturn>'                                             
TSTCMB   DC    C'        <StateCombined documentId="-">'                        
TNUMEM   DC    C'            <NumberOfEmployees>'                               
TNUMEMX  DC    C'</NumberOfEmployees>'                                          
TTOTWG   DC    C'            <WHTotalWages>'                                    
TTOTWGX  DC    C'</WHTotalWages>'                                               
TTOTINT  DC    C'            <TotalIncomeTaxWithheld>'                          
TTOTINTX DC    C'</TotalIncomeTaxWithheld>'                                     
TTAXWG   DC    C'            <WHTaxableWages>'                                  
TTAXWGX  DC    C'</WHTaxableWages>'                                             
TPYRL    DC    C'            <PayRoll>'                                         
         EJECT                                                                  
*======================================================================         
TAGAMT   NTR1  BASE=*,LABEL=*                                                   
         MVC   TITLE,MYSPACES                                                   
         LA    R3,TITLE                                                         
         L     R2,DMCB                                                          
         CP    0(8,R2),=P'0'                                                    
         BNE   TAGAMT10                                                         
         MVC   TITLE(4),=C'0.00'                                                
         J     XIT                                                              
TAGAMT10 CP    0(8,R2),=P'99'      IF LESS THAN 1.00                            
         JH    TAGAMT50                                                         
         MVI   TITLE,C'0'          PUT LEADING ZERO                             
         AHI   R3,1                                                             
TAGAMT50 EDIT  (P8,(R2)),(12,(R3)),2,ALIGN=LEFT                                 
         J     XIT                                                              
         SPACE 1                                                                
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*              THIS ROUTINE PUTS THE XML TAGS WHERE R4 IS                       
*                   R4 IS ALSO UPDATED                                          
*              P1 = (TAG LENGTH, TAG)                                           
*======================================================================         
TAGIT    NTR1  BASE=*,LABEL=*                                                   
         L     R1,DMCB             A(XML TAG)                                   
         SR    R2,R2                                                            
         IC    R2,DMCB                                                          
         AHI   R2,-1                                                            
         EX    R2,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),0(R1)                                                    
                                                                                
         AR    R4,R2               TO LAST CHAR                                 
                                                                                
TAGIT3   CLI   0(R4),C' '          TRIMS OFF TRAILING SPACES                    
         BH    TAGIT9                                                           
         AHI   R4,-1                                                            
         B     TAGIT3                                                           
                                                                                
TAGIT9   AHI   R4,1                                                             
                                                                                
         XIT1  REGS=(R4)                                                        
         EJECT                                                                  
*              DSECT TO COVER TABLE OF LITERALS                                 
LITTABD  DSECT                                                                  
LIT1     DS    CL16                                                             
LIT2     DS    CL16                                                             
LIT3     DS    CL13                                                             
LIT4     DS    CL23                                                             
LIT5     DS    CL20                                                             
LIT6     DS    CL23                                                             
LIT7     DS    CL20                                                             
LIT8     DS    CL46                                                             
LIT8A    DS    CL40                                                             
LIT8B    DS    CL41                                                             
LIT8C    DS    CL40                                                             
LIT9A    DS    CL35                                                             
LIT9B    DS    CL8                                                              
LIT9C    DS    CL12                                                             
LIT10    DS    CL26                                                             
LIT11    DS    CL23                                                             
LIT13    DS    CL16                                                             
LIT14    DS    CL14                                                             
LIT15    DS    CL12                                                             
LIT16    DS    CL23                                                             
LIT17    DS    CL20                                                             
         EJECT                                                                  
*                                                                               
*        DSECT TO COVER TABLE OF STATES REQUIRING TAPES                         
*                                                                               
TAPED    DSECT                                                                  
TAPEMP   DS    CL3                 EMPLOYER                                     
TAPST    DS    CL3                 STATE                                        
TAPRLN   DS    H                   RECORD LENGTH                                
TAPBSZ   DS    H                   BLOCK SIZE                                   
         DS    AL1                 SPARE                                        
TAPRTN   DS    AL3                 DISP TO TAPE ROUTINE                         
TAPLNQ   EQU   *-TAPED                                                          
         SPACE 3                                                                
*        DSECT TO COVER TABLE OF STATES REQUIRING SPECIAL FORMS                 
*                                                                               
FORMD    DSECT                                                                  
FORMEMP  DS    CL3                 EMPLOYER                                     
FORMST   DS    CL3                 STATE                                        
FORMRTN  DS    AL3                 DISP TO ROUTINE TO PROCESS THE TAPE          
FORMLNQ  EQU   *-FORMD                                                          
         SPACE 3                                                                
*                                                                               
*        DSECT TO COVER TABLE OF STATES WHOSE ID'S ARE PADDED ON LEFT           
*              WITH ZEROES                                                      
*                                                                               
LEFTD    DSECT                                                                  
LEFTEMP  DS    CL3                 EMPLOYER                                     
LEFTST   DS    CL3                 STATE                                        
LEFTLNQ  EQU   *-LEFTD                                                          
         SPACE 3                                                                
*                                                                               
*        DSECT TO COVER TABLE OF STATES WHOSE ID'S ARE SPACE PADDED             
*                                                                               
BLNKD    DSECT                                                                  
BLNKEMP  DS    CL3                 EMPLOYER                                     
BLNKST   DS    CL3                 STATE                                        
BLNKLNQ  EQU   *-BLNKD                                                          
         SPACE 3                                                                
*                                                                               
*              DSECT TO COVER ACCUMULATORS                                      
         SPACE 1                                                                
ACCUMD   DSECT                                                                  
ACCS     DS    0PL8                                                             
PDEARN   DS    PL8                 PERIOD EARNINGS                              
PDFICA   DS    PL8                 PERIOD NON-TAXABLE FICA EARNINGS             
PDMED    DS    PL8                 PERIOD NON-TAXABLE MEDICARE EARNINGS         
PDSUI    DS    PL8                 PERIOD NON-TAXABLE SUI EARNINGS              
PDFUI    DS    PL8                 PERIOD NON-TAXABLE FUI EARNINGS              
PDSDI    DS    PL8                 PERIOD NON-TAXABLE SDI EARNINGS              
         ORG   PDSDI                                                            
PDEHT    DS    PL8                 PERIOD NON-TAXABLE EHT EARNINGS              
PDTAX    DS    PL8                 PERIOD TAX WITHHELD                          
*                                                                               
YTDEARN  DS    PL8                 YTD EARNINGS                                 
YTDFICA  DS    PL8                 YTD NON-TAXABLE FICA EARNINGS                
YTDMED   DS    PL8                 YTD NON-TAXABLE MEDICARE EARNINGS            
YTDSUI   DS    PL8                 YTD NON-TAXABLE SUI EARNINGS                 
YTDFUI   DS    PL8                 YTD NON-TAXABLE FUI EARNINGS                 
YTDSDI   DS    PL8                 YTD NON-TAXABLE SDI EARNINGS                 
         ORG   YTDSDI                                                           
YTDEHT   DS    PL8                 YTD NON-TAXABLE EHT EARNINGS                 
YTDTAX   DS    PL8                 YTD TAX WITHHELD                             
ACCLNQ   EQU   *-ACCUMD                                                         
NACCS    EQU   ACCLNQ/L'ACCS                                                    
         EJECT                                                                  
*                                                                               
*        DSECT TO COVER LINE OF PRINTING ON 941 REPORT                          
*                                                                               
LHEAD    DSECT                                                                  
         DS    CL2                                                              
LLINE    DS    CL36                EMPLOYER NAME                                
         DS    CL12                                                             
LDATE    DS    CL8                 DATE QUARTER ENDED                           
         DS    CL9                                                              
LUNIT    DS    CL4                                                              
         DS    CL1                                                              
LPAGE    DS    CL3                 PAGE NUMBER                                  
         SPACE 2                                                                
*                                                                               
*        DSECT TO COVER LINE OF PRINTING ON 941 FORMS                           
*                                                                               
LINED    DSECT                                                                  
LSSN1    DS    CL3                 SS NUMBER                                    
         DS    CL1                                                              
LSSN2    DS    CL2                                                              
         DS    CL1                                                              
LSSN3    DS    CL4                                                              
         DS    CL2                                                              
LFNAME   DS    CL10                FIRST NAME                                   
LLNAME   DS    CL11                LAST NAME                                    
LWAGES   DS    CL10                WAGES PAID THIS QUARTER                      
         DS    CL3                                                              
LSUI     DS    CL11                SUI WAGES                                    
         DS    CL5                                                              
LSDI     DS    CL11                SDI WAGES                                    
         DS    CL6                                                              
LWKS     DS    CL2                 WEEKS WORKED                                 
         EJECT                                                                  
*                                                                               
*        DSECT TO COVER TABLE OF PERFORMERS WITH NEGATIVE AMOUNTS               
*                                                                               
NEGTABD  DSECT                                                                  
NSSN1    DS    CL3                 SS NUMBER                                    
         DS    CL1                                                              
NSSN2    DS    CL2                                                              
         DS    CL1                                                              
NSSN3    DS    CL4                                                              
         DS    CL2                                                              
NEGFIRST DS    CL10                FIRST NAME                                   
NEGLAST  DS    CL11                LAST NAME                                    
NEGWAGES DS    CL10                WAGES                                        
         DS    CL3                                                              
NEGSUI   DS    CL11                SUI WAGES OR NON-TAX SUI WAGES               
NEGLNQ1  EQU   *-NSSN1                                                          
NEGAMT   DS    PL8                 PACKED WAGES                                 
NEGLNQ   EQU   *-NSSN1                                                          
         EJECT                                                                  
*                                                                               
*        DSECT TO COVER LINE OF PRINTING ON UTAH SPECIAL FORMS                  
*                                                                               
UTLINED  DSECT                                                                  
         DS    CL14                                                             
UTLEMPN  DS    CL29                EMPLOYER NAME                                
         DS    CL17                                                             
UTLEMID  DS    CL12                EMPLOYER ID                                  
         ORG   UTLINED                                                          
         DS    CL9                                                              
UTLADDR  DS    CL27                ADDRESS                                      
         DS    CL24                                                             
UTLQEDTE DS    CL8                 QUARTER END DATE                             
         ORG   UTLINED                                                          
         DS    CL50                                                             
UTLTOTW  DS    CL14                TOTAL WAGES                                  
         DS    CL4                                                              
UTLPAGES DS    CL6                 TOTAL PAGES                                  
         ORG   UTLINED                                                          
         DS    CL1                                                              
UTLSSN1  DS    CL3                 SS NUMBER                                    
         DS    CL1                                                              
UTLSSN2  DS    CL2                                                              
         DS    CL1                                                              
UTLSSN3  DS    CL4                                                              
         DS    CL5                                                              
UTLFIRST DS    CL1                 FIRST INITIAL                                
         DS    CL7                                                              
UTLLAST  DS    CL16                LAST NAME                                    
         DS    CL6                                                              
UTLSSWG  DS    CL12                QUARTER WAGES                                
         EJECT                                                                  
*                                                                               
*        DSECT TO COVER LINE OF PRINTING ON WISCONSIN SPECIAL FORMS             
*                                                                               
WILINED  DSECT                                                                  
WILACC   DS    CL12                UC ACCOUNT NUMBER                            
         DS    CL5                                                              
WILQTR   DS    CL2                 QUARTER                                      
         DS    CL3                                                              
WILYEAR  DS    CL4                 YEAR                                         
         ORG   WILINED                                                          
         DS    CL1                                                              
WILRDDTE DS    CL8                 REPORT DUE DATE                              
         DS    CL6                                                              
WILFEIN  DS    CL9                 FEDERAL EMPLOYER NUMBER                      
         DS    CL4                                                              
WILEMPNM DS    CL36                EMPLOYER NAME                                
         ORG   WILINED                                                          
         DS    CL7                                                              
WILSSN1  DS    CL3                 SS NUMBER                                    
         DS    CL1                                                              
WILSSN2  DS    CL2                                                              
         DS    CL1                                                              
WILSSN3  DS    CL4                                                              
         DS    CL7                                                              
WILLAST  DS    CL16                LAST NAME                                    
WILFIRST DS    CL16                FIRST NAME                                   
         DS    CL3                                                              
WILSSWG  DS    CL12                QUARTER WAGES                                
         ORG   WILINED                                                          
         DS    CL62                                                             
WILPAGES DS    CL6                 PAGE                                         
WILTOTPG DS    CL6                 OF PAGES                                     
         EJECT                                                                  
*                                                                               
*        DSECT TO COVER LINE OF PRINTING ON HAWAII SPECIAL FORMS                
*                                                                               
HILINED  DSECT                                                                  
         DS    CL70                                                             
HILPG    DS    CL3                 PAGE                                         
         DS    CL7                 OF                                           
HILTOTPG DS    CL3                 XXX                                          
         ORG   HILINED                                                          
         DS    CL22                                                             
HILEMPN  DS    CL30                EMPLOYER NAME                                
         DS    CL16                                                             
HILFMID  DS    CL9                 FEDERAL ID                                   
         ORG   HILEMPN                                                          
HILADDR  DS    CL30                ADDRESS                                      
         DS    CL14                                                             
HILEMID  DS    CL10                EMPLOYER ID                                  
         ORG   HILEMPN                                                          
         DS    CL62                                                             
HILQEDTE DS    CL8                 QUARTER END DATE                             
         ORG   HILINED                                                          
         DS    CL5                                                              
HILSSN   DS    CL9                 SS NUMBER                                    
         DS    CL1                                                              
HILLAST  DS    CL16                LAST NAME                                    
         DS    CL1                                                              
HILFIRST DS    CL9                 FIRST NAME                                   
         DS    CL1                                                              
HILSSWG  DS    CL10                QUARTER WAGES                                
         ORG   HILINED                                                          
         DS    CL38                                                             
HILSSWGP DS    CL12                THIS PAGES QUARTER WAGES                     
         EJECT                                                                  
*=====================================================================          
*        MMREF - RA RECORD LAYOUT                                               
*=====================================================================          
FRADSECT DSECT                                                                  
FRA      DS    0CL512                                                           
FRAID    DC    CL2'RA'             RECORD IDENTIFER  'RA'                       
FRAEIN   DS    CL9                 EIN                                          
FRAAGTID DS    CL8                 AGENT ID NUMBER                              
         DC    CL16' '                                                          
FRASOFTC DS    CL2                 SOFTWARE CODE                                
*                                                                               
FRAENAM  DS    CL57                EMPLOYER NAME                                
         DC    301C' '                                                          
FRACNAME DS    CL27                CONTACT NAME                                 
FRACPHN  DS    CL15                CONTACT PHONE #                              
FRACPHNX DS    CL5                 CONTACT PHONE EXTENSION                      
         DC    CL3' '                                                           
FRACEMAL DS    CL40                CONTACT EMAIL                                
         DC    CL3' '                                                           
FRACFAX  DS    CL10                CONTACT FAX                                  
*                                                                               
         DC    14C' '              BLANK                                        
*                                                                               
         ORG   FRAEIN                                                           
         DS    CL214               BLANK                                        
FRAENAM2 DS    CL57                EMPLOYER NAME                                
FRALADD  DS    CL22                LOCATION ADDRESS                             
FRADADD  DS    CL22                DELIVERY ADDRESS                             
FRACITY  DS    CL22                CITY                                         
FRASTAT  DS    CL2                 STATE ABBREVIATION                           
FRAZIP   DS    CL5                 ZIP CODE                                     
FRAZIPX  DS    CL4                 ZIP CODE EXTENSION                           
         DS    CL45                BLANK                                        
FRACNAM2 DS    CL27                CONTACT NAME                                 
FRACPH2  DS    CL15                CONTACT PHONE #                              
FRACPHX2 DS    CL5                 CONTACT PHONE EXTENSION                      
         DS    CL46                BLANK                                        
FRACFAX2 DS    CL10                CONTACT FAX                                  
         DS    CL1                 BLANK                                        
FRAPREPC DS    CL1                 PREPARED CODE                                
         DS    CL12                BLANK                                        
FRALNQ   EQU   *-FRA                                                            
         EJECT                                                                  
*=====================================================================          
*        MMREF - RE RECORD LAYOUT                                               
*=====================================================================          
FREDSECT DSECT                                                                  
FRE      DS    0CL512                                                           
FREID    DC    CL2'RE'             RECORD IDENTIFER  'RE'                       
FREBLNK1 DC    CL5' '                                                           
         ORG   FREBLNK1                                                         
FREYEAR  DS    CL4                 REPORT YEAR                                  
         DS    CL1                                                              
FREFEIN  DS    CL9                 FEDERAL EIN NUMBER                           
FREOTHR  DC    CL23' '             TAX YEAR - OTHER EIN, NOT REQUIRED           
         ORG   FREOTHR                                                          
         DS    CL9                                                              
FRETRMB  DS    CL1                 TERMINATING BUSINESS INDICATOR               
         ORG                                                                    
*                                                                               
FREENAM  DS    CL57                EMPLOYER NAME                                
FRELADD  DS    CL22                LOCATION ADDRESS                             
FREDADD  DS    CL22                DELIVERY ADDRESS                             
FRECITY  DS    CL22                CITY                                         
FRESTAT  DS    CL2                 STATE ABBREVIATION                           
FREZIP   DS    CL5                 ZIP CODE                                     
FREZIPX  DS    CL4                 ZIP CODE EXTENSION                           
*                                                                               
         DC    CL47' '             NOT REQUIRED                                 
FREBLNK2 DC    292C' '             BLANK                                        
         ORG   FREBLNK2                                                         
FRETXTP  DS    CL1                 TAX TYPE                                     
FRESTCD  DS    CL2                 STATE CODE                                   
FRERTPD  DS    CL6                 REPORT PERIOD                                
FREBLK   DS    CL2                 BLOCKING FACTOR                              
         DS    CL3                                                              
FRESUI   DS    CL7                 STATE UI EMPLOYER NUMBER                     
         DS    CL8                                                              
FREZERO  DS    CL3                 ZEROS                                        
FREELCF  DS    CL1                 ELECTRONIC FUNDS TRANSFER INDICATOR          
         DS    CL259                                                            
FRELNQ   EQU   *-FRE                                                            
         ORG   FRE+218                                                          
FREEMPCD DS    CL1                 EMPLOYMENT CODE                              
         DS    CL1                 SPARE                                        
FRESCKPY DS    CL1                 SICK PAY INDICATOR                           
         ORG                                                                    
         EJECT                                                                  
*=====================================================================          
*        MMREF - RS RECORD LAYOUT                                               
*=====================================================================          
FRSDSECT DSECT                                                                  
FRS      DS    0CL512                                                           
FRSID    DC    CL2'RS'             RECORD IDENTIFIER 'RS'                       
FRSSCODE DS    CL2'  '             STATE CODE (C'41' FOR OREGON)                
*                                             (C'06' FOR CALIFORNIA)            
*                                             (C'12' FOR FLORIDA)               
FRSTAXCD DC    CL5' '              TAXING ENTITY CODE                           
FRSSS    DS    CL9                 SOCIAL SECURITY NUMBER                       
*                                                                               
FRSEFNAM DS    CL15                EMPLOYEE FIRST NAME                          
FRSEMIDN DS    CL15                EMPLOYEE MIDDLE NAME (INITIAL)               
FRSELNAM DS    CL20                EMPLOYEE LAST NAME                           
         ORG   FRSEFNAM                                                         
FRSELNM2 DS    CL20                EMPLOYEE LAST NAME                           
FRSEFNM2 DS    CL15                EMPLOYEE FIRST NAME                          
FRSEMDN2 DS    CL15                EMPLOYEE MIDDLE NAME (INITIAL)               
*                                                                               
         DS    CL4' '              SUFFIX                                       
*                                                                               
         DS    CL22' '             LOCATION ADDRESS                             
FRSEADD  DS    CL22                EMPLOYEE ADDRESS                             
FRSCITY  DS    CL22                CITY                                         
FRSSTAT  DS    CL2                 STATE ABBREVIATION                           
FRSZIP   DS    CL5                 ZIP CODE                                     
FRSZIPX  DS    CL4                 ZIP CODE EXTENSION                           
*                                                                               
         DC    CL45' '                                                          
*                                                                               
FRSWGPLC DS    CL1                 WAGE PLAN CODE (CA, C'S')                    
         DC    C' '                                                             
*                                                                               
FRSRPTPD DS    CL6                 REPORTING PERIOD                             
FRSQTOTW DS    CL11                QTRLY UNEMPLYMNT INS TOTAL WAGES             
FRSQTAXW DS    CL11                QTRLY TAXABLE WAGES (FLORIDA)                
         DS    CL23' '                                                          
FRSEMPAC DS    CL11                STATE EMPLOYER ACCOUNT NUMBER                
FRSBLNK  DC    CL17' '                                                          
         ORG   FRSEMPAC                                                         
FRSVEC#  DS    CL20                VA VEC EMPLOYER ACCOUNT NUMBER               
         ORG                                                                    
         ORG   FRSBLNK                                                          
         DS    CL15                                                             
FRSSCOD2 DS    CL2                 STATE CODE                                   
FRSQSTTW DS    CL11                QTRLY INCOME TAX WAGES                       
FRSQSTTX DS    CL11                QTRLY INCOME TAX WITHHELD                    
*                                                                               
FRSBLNK1 DC    CL40' '                                                          
         ORG   FRSBLNK1                                                         
FRSEWAG  DS    CL10                STATE EXCESS WAGES                           
         DS    CL30                                                             
*                                                                               
FRSHRSWK DS    CL3                 HOURS WORKED                                 
*                                                                               
FRSSUP1  DS    CL72' '             SUPPLEMENTAL DATA 1                          
         ORG   FRSSUP1                                                          
         DS    CL16                                                             
FRSMTH1  DS    CL1                 MONTH 1 EMPLOYMENT                           
FRSMTH2  DS    CL1                 MONTH 2 EMPLOYMENT                           
FRSMTH3  DS    CL1                 MONTH 3 EMPLOYMENT                           
         DS    CL53                                                             
*                                                                               
FRSSUP2  DS    CL75' '             SUPPLEMENTAL DATA 2                          
         DC    CL25' '             BLANK                                        
FRSLNQ   EQU   *-FRS                                                            
*                                                                               
         ORG   FRS+307                                                          
FRSTXCD2 DS    XL1                 TAXING ENTITY CODE (VA)                      
*                                                                               
         EJECT                                                                  
*=====================================================================          
*        MMREF - RST RECORD LAYOUT                                              
*=====================================================================          
FRSTDSCT DSECT                                                                  
FRST     DS    0CL512                                                           
FRSTID   DC    CL3'RST'            RECORD IDENTIFIER 'RST'                      
FRSTNEMP DS    CL7                 NUMBER OF EMPLOYEES                          
         DC    C' '                                                             
FRSTSTCD DS    CL2                 STATE CODE                                   
         DC    C' '                                                             
FRSTQTWG DS    CL14                QUARTERLY TOTAL WAGES                        
         DC    C' '                                                             
FRSTQTW  DS    CL14                QUARTERLY TAXABLE WAGES                      
         DC    C' '                                                             
FRSTQTXW DS    CL14                QUARTERLY TAX WITHHELD                       
         DC    C' '                                                             
FRSTMTH1 DS    CL7                 MONTH 1 EMPLOYMENT FOR EMPLOYER              
         DC    C' '                                                             
FRSTMTH2 DS    CL7                 MONTH 2 EMPLOYMENT FOR EMPLOYER              
         DC    C' '                                                             
FRSTMTH3 DS    CL7                 MONTH 3 EMPLOYMENT FOR EMPLOYER              
         DC    430C' '                                                          
         EJECT                                                                  
*=====================================================================          
*        MMREF - RT RECORD LAYOUT                                               
*=====================================================================          
FRTDSECT DSECT                                                                  
FRT      DS    0CL512                                                           
FRTID    DC    CL2'RT'             RECORD IDENTIFER  'RT'                       
FRTNUMRS DS    CL7                 NUMBER OF RS RECORDS                         
FRTGROSS DS    CL15                GROSS WAGES PAID THIS QUARTER                
         DC    456C' '                                                          
FRTTAXD  DS    CL11                TAX PAYMENT DUE                              
FRTCW1ST DS    CL7                 COVERED WORKERS, 1ST MONTH                   
FRTCW2ND DS    CL7                 COVERED WORKERS, 2ND MONTH                   
FRTCW3RD DS    CL7                 COVERED WORKERS, 3RD MONTH                   
*                                                                               
FRTLNQ   EQU   *-FRT                                                            
         EJECT                                                                  
*=====================================================================          
*        MMREF - RF RECORD LAYOUT                                               
*=====================================================================          
FRFDSECT DSECT                                                                  
FRF      DS    0CL512                                                           
FRFID    DC    CL2'RF'             RECORD IDENTIFER  'RF'                       
FRFNUMRS DS    CL7                 NUMBER OF RS RECORDS                         
         DC    503C' '                                                          
*                                                                               
FRFLNQ   EQU   *-FRF                                                            
*                                                                               
         ORG   FRF+7               VIRGINIA                                     
FRFTOTRW DS    CL9                 TOTAL NUMBER OF RW RECORDS                   
*                                                                               
         ORG                                                                    
*                                                                               
         EJECT                                                                  
*=====================================================================          
*        FLORIDA - RX RECORD LAYOUT - EXTRA DETAILS FOR XML FILE                
*=====================================================================          
FRXDSECT DSECT                                                                  
FRX      DS    0CL512                                                           
FRXID    DC    CL2'RX'             RECORD IDENTIFER  'RX'                       
         DS    CL5                                                              
FRXTIME  DS    CL22                TIMESTAMP                                    
FRXPROC  DS    CL1                 PROCESS TYPE - T (TEST) OR P (PROD)          
FRXORCT  DS    CL1                 ORIGIN MANIFEST ITEM COUNT                   
FRXDTYP  DS    CL4                 DOCUMENT TYPE = FORM                         
FRXDID   DS    CL5                 DOCUMENT ID - UCT-6                          
         DS    CL3                                                              
FRXDNAM  DS    CL12                DOCUMENT NAME - FSET StateUI                 
FRXQRT   DS    CL1                 QUARTER NUMBER                               
FRXYEAR  DS    CL4                 TAX YEAR                                     
FRXRET   DS    CL7                 RETURN TYPE - StateUI                        
FRXACT   DS    CL12                ACTION - ORIGINAL, AMENDED OR SUPP           
FRXTTIN  DS    CL4                 TYPE TIN - FEIN                              
FRXTSEIN DS    CL11                TYPE STATE EIN - UIAccountNo                 
FRXSCOD  DS    CL2                 STATE CODE - FL                              
FRXSNAME DS    CL7                 STATE NAME - FLORIDA                         
FRXTNUM  DS    CL7                 TOTAL NUMBER OF EMPLOYEES                    
FRXRCNT  DS    CL1                 RETURN DATA DOCUMENT COUNT - 1               
FRXCRATE DS    CL6                 CONTRIBUTION RATE .XXXXX                     
FRXTTAX  DS    CL14                TOTAL TAXABLE WAGES                          
FRXCDUE  DS    CL10                CONTRIBUTION DUE                             
FRXAMTP  DS    CL14                AMOUNT PAID                                  
FRXTOTD  DS    CL14                TOTAL DUE                                    
FRXTEXC  DS    CL14                TOTAL EXCESS WAGES                           
         DC    329C' '                                                          
FRXLNQ   EQU   *-FRX                                                            
         EJECT                                                                  
         DSECT                                                                  
       ++INCLUDE DDDLCB                                                         
         EJECT                                                                  
       ++INCLUDE TALIMD                                                         
         EJECT                                                                  
       ++INCLUDE TAREP2BMY                                                      
       ++INCLUDE TAREP2BUCR                                                     
         EJECT                                                                  
       ++INCLUDE TAUCDSECT                                                      
*              OTHER DSECTS ARE HIDDEN IN HERE                                  
         SPACE 3                                                                
*TAREPWORKD                                                                     
*DDSPOOLD                                                                       
*DDSPLWORKD                                                                     
*TAGENFILE                                                                      
*DMPRTQL                                                                        
*TAREPFFD                                                                       
*DDGENTWA                                                                       
*DDMASTD                                                                        
*DDREMOTED                                                                      
*DDBIGBOX                                                                       
*DDLOGOD                                                                        
         PRINT OFF                                                              
       ++INCLUDE TAREPWORKD                                                     
         PRINT OFF                                                              
       ++INCLUDE DDSPOOLD                                                       
         PRINT OFF                                                              
       ++INCLUDE DDSPLWORKD                                                     
       ++INCLUDE TAGENFILE                                                      
       ++INCLUDE DMPRTQL                                                        
       ++INCLUDE TAREPFFD                                                       
       ++INCLUDE DDGENTWA                                                       
       ++INCLUDE DDMASTD                                                        
       ++INCLUDE DDREMOTED                                                      
       ++INCLUDE DDBIGBOX                                                       
       ++INCLUDE DDLOGOD                                                        
         PRINT ON                                                               
         SPACE 1                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'164TAREP2BUC 03/12/15'                                      
         END                                                                    
*                                                                               
INX      B     XIT                                                              
         EJECT                                                                  
