*          DATA SET REPRRGENS  AT LEVEL 187 AS OF 05/29/03                      
*CATALP RRGEN                                                                   
         TITLE 'RRGEN - REPPAK REPORT PROGRAM GENERATOR'                        
***********************************************************************         
*  HISTORY OF CHANGES                                                 *         
***********************************************************************         
*  AUG12/91 (BU ) --- ADD NEW KEYWORDS FOR 2-YR PRIOR, NEXT YEAR,     *         
*                     BOOKED FOR ALL YEARS, BLANK COLUMN, THIS        *         
*                     WEEK/LAST WEEK ESTIMATE, FORCE ROW              *         
*                                                                     *         
*  MAR10/92 (BU ) --- ADD NEW KEYWORDS FOR BUDGET, SHARE GOAL, FORE-  *         
*                     CAST, COMMENT, SHARE GOAL*MARKET $, MARKET $    *         
*                                                                     *         
*  MAR19/92 (BU ) --- ADD REPORT SPEC 'PENDING' TO SERVE AS REPORT-   *         
*                     TIME FLAG.                                      *         
*                                                                     *         
*  APR13/92 (BU ) --- ONLY PERMIT 11 ROWS:  RRG ABORTS IF ROWS > 11.  *         
*                                                                     *         
*  MAY14/92 (BU ) --- ADD 'STAGGER BIT'                               *         
*                                                                     *         
*  MAY29/92 (BU ) --- CHANGE NUMBER OF ROWS TEST, DISPLAY WIDTH CAL-  *         
*                     CULATED WHEN TOO WIDE.                          *         
*                                                                     *         
*  JUN01/92 (BU ) --- ADD 'AGGREG' SPEC, TO PERMIT PASSING VALUES     *         
*                     BETWEEN REPORT SPECS                            *         
*                                                                     *         
*  JUN04/92 (BU ) --- ADD 'AGGBAS' SPEC, TO PERMIT PASSING VALUES     *         
*                     BETWEEN REPORT SPECS                            *         
*                                                                     *         
*  OCT15/92 (TS ) --- ADD CLASS TO LIST OF VALID ROW CODES FOR THE    *         
*                     ONLINE SPEC                                     *         
*                                                                     *         
*  APR23/93 (BU ) --- ADD 'COMMENT' SPEC, TO INDICATE DISPLAY OF      *         
*                     CONTRACT COMMENTS.                              *         
*                                                                     *         
*  JUL27/93 (BU ) --- ADD SPL AS-RUN COLUMN TYPES, 'AGGSPL' REPORT    *         
*                     TYPE                                            *         
*                                                                     *         
*  SEP08/93 (BU ) --- COLCOMP:  IF 'COLUMN' IS > 100, 'COLUMN' IS A   *         
*                     CONSTANT.  TREAT APPROPRIATELY.                 *         
*                                                                     *         
*  SEP21/93 (BU ) --- ADD 'BKCN'/'BKPN' : BOOKED CURR/PRIOR, NO AS-AT *         
*                     DATE (TAKEN FROM TOTAL ORDERED FOR PERIOD).     *         
*                                                                     *         
*  OCT04/93 (BU ) --- ADD 'AGGTAB' SPEC FOR 'SALESPERSON' SITUATION   *         
*                                                                     *         
*  OCT26/93 (BU ) --- ADD 'CMKT'/'PMKT' : CFOR/PFOR DIVIDED BY THE    *         
*                     CONTRACT SHARE GOAL, --> MKT $$ FOR PERIOD      *         
*                                                                     *         
*  NOV12/93 (BU ) --- ADD 'ESTT': ESTIMATED TOTAL:  'CMKT' + 'BKC'    *         
*                     AND 'FEST' COLUMN (FORCE EST TOTAL COLUMN)      *         
*                                                                     *         
*  DEC09/93 (BU ) --- ADD 'BCUM': CURRENT BILLING CUME COLUMN         *         
*                     AND '%CUM': CURRENT BILLING CUME PERCENT COLUMN *         
*                                                                     *         
*  DEC14/93 (BU ) --- ADD 'SPLT' (SPL-THIS WEEK) COLUMN               *         
*                                                                     *         
*  DEC23/93 (BU ) --- ADD 'SPLE' (SPL-ESTIMATED) COLUMN               *         
*                                                                     *         
*  DEC29/93 (BU ) --- ADD 'SPLITPND' REPORT COMMAND                   *         
*                                                                     *         
*  JAN10/94 (BU ) --- ADD 'PURE FORECAST $$' AND 'PURE PENDING $$'    *         
*                     COLUMNS                                         *         
*                                                                     *         
*  JAN13/94 (BU ) --- ADD 'BUDPAS' ROW SPEC TO INTEGRATE BUDGETS      *         
*                                                                     *         
*  FEB07/94 (BU ) --- ADD ROWS FOR DEVELOPMENTAL S/P + CONTYPE        *         
*                                                                     *         
*  MAR01/94 (BU ) --- CREATE 'RECAPA' SPEC WITH THREE PARAMS.         *         
*                                                                     *         
*  MAR23/94 (BU ) --- MAKE MULTI-CLAUSE 'IF' STATEMENT: 'AND' ONLY    *         
*                                                                     *         
*  APR19/94 (BU ) --- ADD 'FORCE/REPLACE (FORR)' COLUMN TYPE          *         
*                                                                     *         
*  APR28/94 (BU ) --- ADD MKT$ CALCULATION FROM TRUE FORE/PEND $$     *         
*                                                                     *         
*  MAY05/94 (BU ) --- 'PENDING' SPEC: ADD 'TRUE' FLAG                 *         
*                                                                     *         
*  MAY12/94 (BU ) --- 'THIS WEEK PRIOR YEAR' COLUMN                   *         
*                                                                     *         
*  JUN21/94 (BU ) --- ADD 'THIS WEEK PRIOR YEAR SPL AS-RUN' COLUMN    *         
*                                                                     *         
*  AUG01/94 (BU ) --- ADD 'NOFORE' TO PENDING SPEC TO SKIP FORECAST   *         
*                     DATA COMPLETELY                                 *         
*                                                                     *         
*  AUG23/94 (BU ) --- ADD COLUMN SPL REP'D STATION PERCENT            *         
*                                                                     *         
*  SEP06/94 (BU ) --- ADD SPEC 'REPFLAGS'                             *         
*                                                                     *         
*  SEP14/94 (BU ) --- ADD FINDABLE FLAG TO ERROR MESSAGE DISPLAY      *         
*                                                                     *         
*  NOV01/94 (BU ) --- EXPAND MISCELLANEOUS FLAGS FIELD + ADD 'EMPTY'  *         
*                     ROW FOR PLACE-HOLDING                           *         
*                                                                     *         
*  NOV21/94 (BU ) --- ADD COLUMN FOR 'SPL STATION DOLLARS'            *         
*                                                                     *         
*  NOV29/94 (BU ) --- MAKE COLUMN SPEC PROVISION FOR OPTIONAL DECIMAL *         
*                     POINT PLACEMENT                                 *         
*                                                                     *         
*  JUN09/95 (BG ) --- ADD CLASS TO LIST OF VALID ROW CODES FOR THE    *         
*                     ONLINE SPEC                                     *         
*  JUN09/95 (BG ) --- ADD ADV & AGY/OFFC TO LIST OF VALID ROW CODES   *         
*                     FOR THE ONLINE SPEC                             *         
*  DEC07/95 (BU ) --- ADD BUDP AND BUD2 TO VALID COL CODES            *         
*                                                                     *         
*  MAY24/96 (BU ) --- FIX 'STAGGER' FOR 2ND THRU NTH REPORTS          *         
*                                                                     *         
*  OCT15/96 (BU ) --- ADD 'SP* ' COLUMNS (SPL IN SAME CARD)           *         
*                                                                     *         
*  DEC26/96 (BG ) 162 ADD DEVCONTY TO LIST OF VAL ROW CDS ONLINE      *         
*                                                                     *         
*  OCT01/97 (BG ) 163 CHANGE DEFAULT  OBJ PHASE TO @@ FROM PP         *         
*                                                                     *         
*  OCT02/97 (BU )     ADD KEYWORD 'AGENCY' - NO OFFICE                *         
*                                                                     *         
*  OCT31/97 (BU ) --- NEW COLUMNS:  CONFIRMED/UNCONF, DIRECT          *         
*                                                                     *         
*  DEC22/97 (BU ) --- NEW COLUMN:  CONFIRMED/THIS WEEK                *         
*                                                                     *         
*  JAN08/98 (BU ) --- NEW COLUMN:  CONFIRMED/PRIOR ACTUAL             *         
*                                                                     *         
*  MAR02/98 (BG ) 169 ADD SP(SALESPER) TO LIST OF VAL ROW CDS ONLINE  *         
*                                                                     *         
*  APR14/98 (BU ) --- ADD NEW 'NEXT YEAR' COLUMNS                     *         
*                                                                     *         
*  NOV14/98 (BU ) --- ADD DUMMY FORCE COLUMN FOR ROW OUTPUT           *         
*                                                                     *         
*  MAY15/00 (BU ) --- ADD TRADE PROCESSING                            *         
*                                                                     *         
*  AUG28/00 (BU ) --- PANAPT ADJUSTMENTS TO SPEC                      *         
*                                                                     *         
*  OCT04/01 (BU ) --- BUYLINE CODE ROW SPEC                           *         
*                                                                     *         
*  OCT09/01 (BU ) --- BUYLINE CODE/ATTRIBUTE 1 AND 2 ROW SPEC         *         
*                                                                     *         
*  DEC13/01 (BU ) --- ADD COMPENSATION S/P ROW SPEC                   *         
*                                                                     *         
*  JAN24/02 (BU ) --- ADD CONTRACT END DATE AND JOIN DATE ROW SPECS   *         
*                                                                     *         
*  MAY29/03 (BU ) --- ADD COLUMNS FOR CURR/PRI/2YR SPOT COUNT         *         
*                                                                     *         
*                                                                     *         
*                                                                     *         
*                     **  END TOMBSTONE  **                           *         
***********************************************************************         
         PRINT NOGEN                                                            
RRGEN    CSECT                                                                  
         NBASE 0,**RRGEN*,=V(REGSAVE),R9,R8,R7                                  
         GOTO1 =V(STXITER),DMCB,A(DUMPLIST)                                     
         L     RA,=V(CPRINT)                                                    
         USING DPRINT,RA                                                        
         MVC   TITLE(20),=C'RRGEN SOURCE LISTING'                               
         MVC   SUB1(12),=C'SOURCE CARDS'                                        
         MVC   SUB2(12),=C'------------'                                        
         MVC   SUB1+72(8),=C'SEQ  LVL'                                          
         MVC   SUB2+72(8),=C'NO.  ---'                                          
         MVC   SUB1+85(15),=C'DETECTED ERRORS'                                  
         MVC   SUB2+85(15),=C'---------------'                                  
*                                                                               
         OPEN  (ASMFIL,OUTPUT)                                                  
         OPEN  (LNKFIL,OUTPUT)                                                  
*                                                                               
*   SET ADDRESSABILITY TO ROWSPEC/ONLINE ROW TABLES, KEYLIST                    
*                                                                               
         L     RF,=A(ROWSPECS)                                                  
         ST    RF,AROWSPEC         A(ROWSPEC TABLE)                             
*                                                                               
         L     RF,=A(ONLROWS)                                                   
         ST    RF,AONLROW          A(ONLINE ROW TABLE)                          
*                                                                               
         L     RF,=A(KEYLIST)                                                   
         ST    RF,AKEYLIST         A(KEYLIST)                                   
*                                                                               
         L     RF,=A(ERRMSGS)                                                   
         ST    RF,AERRMSGS         A(ERROR MESSAGE TABLE)                       
*                                                                               
         EJECT                                                                  
*              MAIN LOGIC FLOW                                                  
*                                                                               
RE010    GOTO1 =V(CARDS),DMCB,P,=C'RE00'                                        
         CLC   P(2),=C'/*'         TEST FOR END OF FILE                         
         BE    RE900                                                            
         MVI   NEXTREP,1                                                        
         MVI   NEXTROW,1                                                        
         MVI   NEXTCOL,1                                                        
         MVI   ERSW,C'0'                                                        
         MVI   CTRTSPEC,C'N'       CONTRACT SPEC PRESENT FLAG                   
         MVI   STATSPEC,C'N'       STATION  SPEC PRESENT FLAG                   
         XC    SPL$FLGS(2),SPL$FLGS  CLEAR ALL SPL$ FLAGS                       
         CLC   P(4),=C'PAN='       DID USER SPECIFY A PAN BOOK                  
         BNE   RE040                                                            
         MVC   BOMB,P+79           SAVE TEST IND                                
         MVC   PANNAME,P+4                                                      
         GOTO1 =V(PANIC),DMCB,(X'80',=C'READ'),=C'PAN',PANNAME,C                
         TM    DMCB+8,X'10'                                                     
         BNO   RE020                                                            
         MVC   P+85(23),=C'PAN-NAME NOT IN LIBRARY'                             
         GOTO1 =V(PRINTER)                                                      
         B     RE010                                                            
*                                                                               
RE020    MVC   P(80),C                                                          
*                                                                               
RE030    BAS   RE,DATA             LOOP ROUND PAN BOOK                          
         GOTO1 =V(PRINTER)                                                      
         GOTO1 =V(PANIC),DMCB,(X'80',=C'READ'),=C'PAN',PANNAME,P                
         CLC   P(2),=C'/*'                                                      
         BNE   RE030                                                            
         B     RE100                                                            
*                                                                               
RE040    BAS   RE,DATA             DATA CARDS SUBMITTED DIRECT                  
         GOTO1 =V(PRINTER)                                                      
         B     RE010                                                            
*                                                                               
*  MAKE SURE PRINTLINE FROM LAST REQUEST ISN'T TOO LONG                         
*                                                                               
RE100    EQU   *                                                                
         BAS   RE,REPTEND                                                       
         XC    SAVROW#,SAVROW#     CLEAR SAVE ROW # FIELD                       
         B     RE010               GO BACK FOR NEXT CARD                        
*                                                                               
RE900    EQU   *                                                                
         LA    R2,ENDSTACK         WRAP UP                                      
         CLI   ERSW,C'1'                                                        
         BNE   NOER                                                             
         MVC   P(2),=C'  '                                                      
         GOTO1 =V(PRINTER)                                                      
         MVC   P(23),=C'*** ERROR(S) FOUND *** '                                
         GOTO1 =V(PRINTER)                                                      
         GOTO1 =V(PRINT),DMCB,=C'CLOSE'                                         
         LA    R6,16                                                            
         XBASE RC=(R6)                                                          
*                                                                               
NOER     BAS   RE,MULTI                                                         
         GOTO1 =V(PRINT),DMCB,=C'CLOSE'                                         
         PUT   LNKFIL,BEGPH                                                     
         CLOSE (ASMFIL)                                                         
         CLOSE (LNKFIL)                                                         
         XBASE                                                                  
         EJECT                                                                  
*                                                                               
*   REPTEND:  WHEN A NEW REPORT IS ENCOUNTERED, OR AT THE END OF                
*        ALL INPUT, THE LENGTH OF THE CONSTRUCTED LINE AND OTHER                
*        CONSTRAINTS ARE CHECKED.                                               
*                                                                               
REPTEND  NTR1                                                                   
         OC    IFTOTWD,IFTOTWD     IF LAST ROW HAD IF OPTION,                   
         BZ    REPT110                                                          
         L     R3,TOTWIDTH         ADD WIDTH INTO TOTAL WIDTH                   
         L     R5,IFTOTWD                                                       
         AR    R3,R5                                                            
         A     R3,=F'1'            PLUS 1 FOR SPACE BETWEEN ROWS                
         ST    R3,TOTWIDTH                                                      
*                                                                               
REPT110  L     R3,TOTWIDTH                                                      
         S     R3,=F'1'                                                         
         C     R3,=F'132'                                                       
         BNH   REPT120                                                          
         MVC   SAVEP,P             SAVE CURRENT PRINTLINE                       
         MVC   P,SPACES            CLEAR PRINTLINE                              
         MVC   P+85(38),=C'LINE WIDTH XXX: EXCEEDS 132 CHARACTERS'              
         EDIT  (R3),(3,P+96)                                                    
         GOTO1 =V(PRINTER)                                                      
         MVI   ERSW,C'1'                                                        
         MVC   P,SAVEP             RESTORE PRINTLINE                            
REPT120  EQU   *                                                                
         CLI   SPL$FLAG,0          ANY SPL$ COLUMNS?                            
         BE    REPT140             NO                                           
         CLI   SPL$FLAG,3          BOTH COLUMNS PRESENT?                        
         BE    REPT140             YES                                          
         MVC   SAVEP,P             SAVE CURRENT PRINTLINE                       
         MVC   P,SPACES            CLEAR PRINTLINE                              
         MVC   P+85(37),=C'BOTH SPL$/SPL MKT $ COLUMNS REQUIRED!'               
         GOTO1 =V(PRINTER)                                                      
         MVI   ERSW,C'1'           SET ERROR SWITCH TO ON                       
         MVC   P,SAVEP             RESTORE PRINTLINE                            
REPT140  EQU   *                                                                
         CLI   GSPL$FLG,0          ANY GROSS SPL$ COLUMNS?                      
         BE    REPT160             NO                                           
         CLI   GSPL$FLG,3          BOTH COLUMNS PRESENT?                        
         BE    REPT160             YES                                          
         MVC   SAVEP,P             SAVE CURRENT PRINTLINE                       
         MVC   P,SPACES            CLEAR PRINTLINE                              
         MVC   P+85(42),=C'BOTH GROSS SPL$/SPL MKT$ COLUMNS REQUIRED!'          
         GOTO1 =V(PRINTER)                                                      
         MVI   ERSW,C'1'           SET ERROR SWITCH TO ON                       
         MVC   P,SAVEP             RESTORE PRINTLINE                            
REPT160  EQU   *                                                                
         XIT1                                                                   
         EJECT                                                                  
*                                                                               
*        CONTROL THE DATA VALIDATION - SPECIAL CARDS                            
*                                                                               
DATA     NTR1                                                                   
         LA    R6,P+9                                                           
         ST    R6,NEXTFLD                                                       
         CLI   P,C'*'                                  COMMENT                  
         BE    XIT                                                              
         CLC   P(15),=C'         TITLE '               TITLE                    
         BNE   DT010                                                            
         MVC   TITLE,SPACES                                                     
         MVC   TITLE(50),P+15                                                   
         MVC   P,SPACES                                                         
         B     XIT                                                              
*                                                                               
DT010    CLC   P(15),=C'         SPACE '               SPACE N                  
         BNE   DT030                                                            
         ZIC   R2,P+15                                                          
         SLL   R2,28                                                            
         SRL   R2,28                                                            
         MVC   P,SPACES                                                         
         BCT   R2,DT020                                                         
         B     XIT                                                              
*                                                                               
DT020    GOTO1 =V(PRINTER)                                                      
         BCT   R2,DT020                                                         
         B     XIT                                                              
*                                                                               
DT030    CLC   P(15),=C'         EJECT '               EJECT                    
         BNE   DT040                                                            
         MVC   P,SPACES                                                         
         ZAP   LINE,=P'75'                                                      
         B     XIT                                                              
*                                                                               
DT040    CLC   P(9),=C'TRACE=YES'                                               
         BNE   DT050                                                            
         MVI   TRACOPT,C'Y'                                                     
         B     XIT                                                              
         EJECT                                                                  
*        THE CARD IS REPORT DATA                                                
*                                                                               
DT050    LA    R2,COMTABLE         SCAN FOR RECOGNIZED COMMAND                  
         LA    R3,OUTTAB                                                        
*                                                                               
DT060    CLC   P(8),0(R2)          LOOK FOR COMMAND IN TABLE                    
         BE    DT070                                                            
         LA    R2,12(R2)                                                        
         LA    R3,60(R3)                                                        
         CLI   0(R2),X'FF'                                                      
         BNE   DT060                                                            
         B     ER2                                                              
*                                                                               
DT070    MVC   D(132),SPACES       FILL IN PRELIMINARY CARD                     
         MVC   DOUT(80),SPACES                                                  
         MVC   D+9(10),=C'DC    AL1('                                           
         MVC   D+19(60),0(R3)                                                   
         L     RF,8(R2)            AND LOCATE SPECIAL ROUTINE                   
         C     RF,=A(DATA40)       COLUMN SPEC?                                 
         BNE   DT075               NO  -                                        
         BAS   RE,CHKCOMNT         YES - CHECK 'COMMENT+CONTRACT' NEED          
DT075    EQU   *                                                                
         L     RF,8(R2)            RELOCATE SPECIAL ROUTINE                     
*                                                                               
*                                  PERFORM SPEC SEQUENCE CHECKS                 
         CLI   LSTSPC31,C'Y'                                                    
         BNE   DT080               ROWFILT ONLY AFTER ROWCODE. . .              
         MVI   SPC36VAL,C' '                                                    
         MVI   OKSPEC36,C'Y'                                                    
         MVI   SPC33VAL,C' '       RANK ONLY AFTER ROWCODE. . .                 
         MVI   OKSPEC33,C'Y'                                                    
         B     DT100                                                            
DT080    CLI   LSTSPC36,C'Y'                                                    
         BNE   DT090                                                            
         MVI   OKSPEC36,C'Y'                                                    
         B     DT100                                                            
DT090    CLI   LSTSPC33,C'Y'                                                    
         BNE   DT100                                                            
         MVI   OKSPEC33,C'Y'                                                    
DT100    MVI   LSTSPC31,C'N'                                                    
         MVI   LSTSPC36,C'N'                                                    
         CLI   FIRSTSPC,C'Y'                                                    
         BNE   DT105                                                            
         MVI   FIRSTSPC,C'N'                                                    
         C     RF,=A(DATA01)       FIRST SPEC MUST BE PHASE COMMAND             
         BNE   ER30                                                             
         BR    RF                                                               
DT105    OC    IFTOTWD,IFTOTWD     IF LAST ROW HAD IF OPTION                    
         BZ    DT110                                                            
         C     RF,=A(DATA10)                                                    
         BNE   DT110                                                            
         L     R3,TOTWIDTH         ADD WIDTH INTO TOTAL WIDTH                   
         L     R5,IFTOTWD                                                       
         AR    R3,R5                                                            
         A     R3,=F'1'            ADD 1 FOR SPACE BTWN ROWS                    
         ST    R3,TOTWIDTH                                                      
         XC    IFTOTWD,IFTOTWD                                                  
         SPACE 1                                                                
DT110    CLI   HADSPC10,C'Y'                                                    
         BNE   DT120                                                            
         C     RF,=A(DATA06)       TOTDEF ALLOWED ONLY BEFORE REPORT            
         BE    ER32                                                             
         C     RF,=A(DATA10)                                                    
         BNE   DT130                                                            
         MVI   HADSPC30,C'N'       A NEW REPORT                                 
         MVI   HADSPC32,C'N'                                                    
         MVI   HADSPC40,C'N'                                                    
         MVI   HADSPC42,C'N'                                                    
         MVI   HADSPC16,C'N'                                                    
         MVI   HADMONSP,C'N'                                                    
         L     R3,TOTWIDTH         MAKE SURE PRINTLINE ISN'T TOO LONG           
         S     R3,=F'1'                                                         
         C     R3,=F'132'                                                       
         BNH   DT115               NOT TOO WIDE                                 
         BAS   RE,REPTEND                                                       
         XC    SAVROW#,SAVROW#                                                  
         B     XIT                                                              
DT115    EQU   *                                                                
         XC    SAVROW#,SAVROW#                                                  
         XC    TOTWIDTH,TOTWIDTH                                                
         XC    IFTOTWD,IFTOTWD                                                  
         MVI   ROWPREV,0                                                        
         BR    RF                                                               
DT120    C     RF,=A(DATA02)                                                    
         BER   RF                                                               
         C     RF,=A(DATA06)                                                    
         BER   RF                                                               
         C     RF,=A(DATA10)                                                    
         BNE   ER34                                                             
         MVI   HADSPC10,C'Y'       A NEW REPORT                                 
         MVI   HADSPC30,C'N'                                                    
         MVI   HADSPC32,C'N'                                                    
         MVI   HADSPC40,C'N'                                                    
         MVI   HADSPC42,C'N'                                                    
         MVI   HADSPC16,C'N'                                                    
         MVI   HADMONSP,C'N'                                                    
         L     R3,TOTWIDTH         MAKE SURE PRINTLINE ISN'T TOO LONG           
         S     R3,=F'1'                                                         
         C     R3,=F'132'                                                       
         BH    ER42                                                             
         XC    TOTWIDTH,TOTWIDTH                                                
         XC    IFTOTWD,IFTOTWD                                                  
         MVI   ROWPREV,0                                                        
         BR    RF                                                               
DT130    CLI   LSTSPC30,C'Y'       ROWNAME,CODE,BOTH MUST FOLLOW ROW            
         BNE   DT140                                                            
         MVI   LSTSPC30,C'N'                                                    
         C     RF,=A(DATA31)                                                    
         BNE   ER28                                                             
         BR    RF                                                               
DT140    C     RF,=A(DATA31)       COLNAME MUST FOLLOW COL                      
         BE    ER28                                                             
         CLI   LSTSPC40,C'Y'                                                    
         BNE   DT150                                                            
         MVI   LSTSPC40,C'N'                                                    
         C     RF,=A(DATA41)                                                    
         BNE   ER24                                                             
         BR    RF                                                               
DT150    C     RF,=A(DATA41)       COLCOMP ONLY AFTER COLNAME                   
         BE    ER24                                                             
         C     RF,=A(DATA43)                                                    
         BNE   DT160                                                            
         CLI   LSTSPC41,C'Y'                                                    
         BNE   ER24                                                             
DT160    MVI   LSTSPC41,C'N'                                                    
         BR    RF                                                               
*                                                                               
DATAPUT  BAS   RE,PUT                                                           
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*   IF COMMENT SPEC IS PRESENT, CONTRACT SPEC MUST ALSO BE PRESENT.             
*   THIS IS CHECKED WHEN ALL ROWS HAVE BEEN PROCESSED:  WHEN THE                
*   COLUMNS ARE BEING DONE.  THE 'CMMTSPEC' ACTS AS A ONE-TIME                  
*   SWITCH.                                                                     
CHKCOMNT NTR1                                                                   
         CLI   CMMTSPEC,C'Y'       COMMENT SPEC ENTERED?                        
         BNE   DA400010            NO                                           
         MVI   CMMTSPEC,C'N'       YES - RESET IT                               
         CLI   CTRTSPEC,C'Y'       CONTRACT ROW SPEC ENTERED?                   
         BNE   ER83                NO  - ERROR                                  
DA400010 EQU   *                                                                
         XIT1                                                                   
         EJECT                                                                  
*              TABLE OF COMMANDS, ADDRESSES                                     
*                                                                               
COMTABLE DS    0D                                                               
         DC    C'PHASE   ',A(DATA01)        SYSTEM COMMANDS                     
         DC    C'PRINT   ',A(DATA02)                                            
         DC    C'TOTDEF  ',A(DATA06)                                            
*                                           REPORT COMMANDS                     
         DC    C'PENDING ',A(DATA07)                                            
         DC    C'COMMENT ',A(DATA08)                                            
         DC    C'SPLITPND',A(DATA09)                                            
         DC    C'REPORT  ',A(DATA10)                                            
         DC    C'RPTCODE ',A(DATA11)                                            
         DC    C'RPTNAME ',A(DATAMSC)                                           
         DC    C'RPTRIGHT',A(DATA13)                                            
         DC    C'COPIES  ',A(DATA14)                                            
         DC    C'REMPRINT',A(DATA15)                                            
         DC    C'MONEY   ',A(DATA16)                                            
         DC    C'REMCOPY ',A(DATA17)                                            
         DC    C'ONLINE  ',A(DATA18)                                            
         DC    C'RPTTYPE ',A(DATA19)                                            
         DC    C'RPTFILT ',A(DATA20)                                            
         DC    C'RPTFLAGS',A(DATA21)                                            
*                                                                               
         DC    C'AGGBAS  ',A(DATA24)                                            
         DC    C'AGGREG  ',A(DATA25)                                            
         DC    C'RECAP   ',A(DATA26)                                            
         DC    C'RECAPA  ',A(DATA26A)                                           
         DC    C'AGGSPL  ',A(DATA27)                                            
         DC    C'AGGTAB  ',A(DATA28)                                            
         DC    C'BUDPAS  ',A(DATA29)                                            
*                                                                               
         DC    C'ROW     ',A(DATA30)        ROWS                                
         DC    C'ROWNAME ',A(DATA31)                                            
         DC    C'ROWCODE ',A(DATA31)                                            
         DC    C'ROWBOTH ',A(DATA31)                                            
         DC    C'ROWEQU  ',A(DATA32)                                            
         DC    C'RANK    ',A(DATA33)                                            
         DC    C'NOTOT   ',A(DATA35)                                            
         DC    C'ROWFILT ',A(DATA36)                                            
*                                                                               
         DC    C'COL     ',A(DATA40)       COLUMNS                              
         DC    C'COLNAME ',A(DATA41)                                            
         DC    C'COLEQU  ',A(DATA42)                                            
         DC    C'COLCOMP ',A(DATA43)                                            
         DC    C'CHUNK   ',A(DATA44)                                            
         DC    C'COLFOOT ',A(DATA45)                                            
*                                                                               
         DC    C'TOTPRNT ',A(DATA51)       TOTALS                               
         DC    C'TOTROW  ',A(DATAMSC)                                           
         DC    C'TOTDIFF ',A(DATAMSC)                                           
         DC    C'TOTPCT  ',A(DATAMSC)                                           
         DC    C'TOTSAME ',A(DATAMSC)                                           
*                                                                               
         DC    C'IF      ',A(DATA60)       MISCELLANEOUS                        
*                                                                               
         DC    X'FF'                                                            
         EJECT                                                                  
*              TABLE OF CARD DATA (COMES AFTER DC   AL01(..)                    
*                                                                               
OUTTAB   DS    0D                                                               
         DC    CL60'01,04),C''@@'''                    PHASE                    
         DC    CL60'02,03,00)'                         PRINT                    
         DC    CL60'06,05,00,00,000)'                  TOTDEF                   
         DC    CL60'07,03,00)'                         PENDING                  
         DC    CL60'08,02)'                            COMMENT                  
         DC    CL60'09,02)'                            SPLITPND                 
*                                                                               
         DC    CL60'10,04,NN,00)'                      REPORT                   
         DC    CL60'11,04),C''XX'''                    RPTCODE                  
         DC    CL60'12,NN),C'' '                       RPTNAME                  
         DC    CL60'13,NN'                             RPTRIGHT                 
         DC    CL60'14,03,NN)'                         COPIES                   
         DC    CL60'15,03,RW)'                         REMPRINT                 
         DC    CL60'16,03,NN)'                         MONEY                    
         DC    CL60'17,05,NN),C''XX'''                 REMCOPY                  
         DC    CL60'18,05,NN,00,00)'                   ONLINE                   
         DC    CL60'19,05),C''SAL'''                   RPTTYPE                  
         DC    CL60'20,NN,DC,P/M),C''  '               RPTFILT                  
*                                                                               
         DC    CL60'21,10,00,00,00,00,00,00,00,00)'    MISC FLAGS               
         DC    CL60'24,05,RP,#R,TR)'                   AGGBAS                   
         DC    CL60'25,05,RP,#R,TR)'                   AGGREG                   
         DC    CL60'26,04,NN,MM)'                      RECAP                    
         DC    CL60'26,05,NN,MM,RR)'                   RECAPA                   
         DC    CL60'27,05,RP,#R,TR)'                   AGGSPL                   
         DC    CL60'28,04,RP,#R)'                      AGGTAB                   
         DC    CL60'29,04,RP,#R)'                      BUDPAS                   
*                                                                               
         DC    CL60'30,07,RW,RC,WD,000,00)'            ROW                      
         DC    CL60'31,NN,01,MM,LI,CL,NL)'             ROWNAME                  
         DC    CL60'31,NN,02,MM,LI,CL,NL)'             ROWCODE                  
         DC    CL60'31,NN,03,MM,LI,CL,NL)'             ROWBOTH                  
         DC    CL60'32,03,NN)'                         ROWEQU                   
         DC    CL60'33,05,NN,00,00)'                   RANK                     
         DC    CL60'35,NN'                             NOTOT                    
         DC    CL60'36,NN,DC,P/M),C''  '               ROWFILT                  
*                                                                               
         DC    CL60'40,10,CL,00,00,00,000,00,00,WD)'   COL                      
         DC    CL60'41,NN),C''  '                      COLNAME                  
         DC    CL60'42,03,NN)'                         COLEQU                   
         DC    CL60'43,NN'                             COLCOMP                  
         DC    CL60'44,NN,CL,CL),C''  '                CHUNK                    
         DC    CL60'45,NN),C''  '                      COLFOOT                  
*                                                                               
         DC    CL60'51,06,RW,00,00,000)'               TOTPRNT                  
         DC    CL60'52,NN),C''  '                      TOTROW                   
         DC    CL60'53,NN),C''  '                      TOTDIFF                  
         DC    CL60'54,NN),C''  '                      TOTPCT                   
         DC    CL60'55,NN),C''  '                      TOTSAME                  
*                                                                               
         DC    CL60'60,NN,NN,NN,NNN),C''  '            IF                       
         EJECT                                                                  
*                                                                               
*              PHASE                                                            
*                                                                               
DATA01   MVC   BEGPH+13(3),P+9     COMPLETE PHASE STATEMENT                     
         MVC   BEGCS+4(3),P+9      COMPLETE CSECT STATEMENT                     
         LA    R2,BEGSTACK                                                      
         BAS   RE,MULTI                                                         
         B     XIT                                                              
         EJECT                                                                  
*                                                                               
*              PRINT                                                            
*                                                                               
DATA02   L     R2,NEXTFLD                                                       
         CLC   0(3,R2),=C'OFF'                                                  
         BE    DATAPUT                                                          
         MVI   D+26,C'2'                                                        
         CLC   0(6,R2),=C'ONLINE'                                               
         BE    DATAPUT                                                          
         MVI   D+26,C'1'                                                        
         CLC   0(2,R2),=C'ON'                                                   
         BE    DATAPUT                                                          
         B     ER78                                                             
         EJECT                                                                  
*              TOTDEF                                                           
*                                                                               
DATA06   L     R2,NEXTFLD          REQUIRED FIRST KEYWORD                       
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    ER48                IF NONE, THEN ERROR                          
*                                                                               
         L     R6,AROWSPEC         FIND DATACODE                                
D0610    EX    R3,SRCHKEY                                                       
         BE    D0620                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER10                                                             
         LA    R6,36(R6)                                                        
         B     D0610                                                            
D0620    EDIT  (1,10(R6)),(2,D+25),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          OPTIONAL SECOND KEYWORD                      
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    DATAPUT             IF NONE, THEN DONE                           
*                                                                               
         L     R6,AROWSPEC         FIND DATACODE                                
D0630    EX    R3,SRCHKEY                                                       
         BE    D0640                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER10                                                             
         LA    R6,36(R6)                                                        
         B     D0630                                                            
D0640    EDIT  (1,10(R6)),(2,D+28),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          OPTIONAL THIRD KEYWORD                       
         CLI   0(R2),C' '                                                       
         BE    DATAPUT                                                          
         CLC   0(6,R2),=C'MONTHS'                                               
         BNE   ER10                                                             
         MVI   NUMBER,X'80'                                                     
         EDIT  (1,NUMBER),(3,D+31)                                              
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              PENDING:                                                         
DATA07   L     R2,NEXTFLD                                                       
         CLC   0(3,R2),=C'ALL'                                                  
         BE    DATAPUT                                                          
         MVI   D+26,C'1'                                                        
         CLC   0(8,R2),=C'FORECAST'                                             
         BE    DATAPUT                                                          
         MVI   D+26,C'2'                                                        
         CLC   0(7,R2),=C'PENDING'                                              
         BE    DATAPUT                                                          
         MVI   D+26,C'3'                                                        
         CLC   0(6,R2),=C'NOFORE'                                               
         BE    DATAPUT                                                          
         B     ER84                                                             
         SPACE 5                                                                
*                                                                               
*              COMMENT:   NO ADDITIONAL DATA                                    
DATA08   EQU   *                                                                
         MVI   CMMTSPEC,C'Y'       SET 'COMMENT SPEC PRESENT'                   
         B     DATAPUT                                                          
         SPACE 5                                                                
*                                                                               
*              SPLITPND:  NO ADDITIONAL DATA                                    
DATA09   B     DATAPUT                                                          
         SPACE 5                                                                
*                                                                               
*              REPORT                                                           
*                                                                               
DATA10   EQU   *                                                                
         MVI   CTRTSPEC,C'N'       TURN OFF 'CONTRACT' FLAG                     
         MVI   STATSPEC,C'N'       CONTRACT SPEC PRESENT FLAG                   
         XC    SPL$FLGS(2),SPL$FLGS  CLEAR ALL SPL FLAGS                        
         XC    STAGFLAG(L'STAGFLAG),STAGFLAG    SET STAGGER ARRAY               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         MVI   NEXTROW,1                                                        
         MVI   NEXTCOL,1                                                        
         MVC   THISREP,NUMBER                                                   
*                                                                               
         L     R2,NEXTFLD          TEST FOR IF                                  
         BAS   RE,ISOOPT                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    D1010               NO OPTIONS-TEST CONSECUTIVE RPT NO.          
*                                                                               
         CLC   0(2,R2),=C'IF'                                                   
         BNE   ER6                 OPTION NOT RECOGNIZED                        
         L     R2,NEXTFLD          GET IF NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                 NOT NUMERIC                                  
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
         MVC   THISRPIF,NUMBER                                                  
         LA    R4,D+30             FOR MULTI-CLAUSE 'IF'S                       
DTEN0010 EQU   *                   CHECK FOR MULTI-CLAUSE 'IF'                  
         L     RE,NEXTFLD          A(NEXT FIELD IN OPTION)                      
         BCTR  RE,0                BACK UP 1 POSITION                           
         CLI   0(RE),C'+'          MULTI-OPTION INDICATOR?                      
         BNE   DATAPUT             NO  - FINISHED                               
         L     R2,NEXTFLD          YES - GET NEXT 'IF' NUMBER                   
         BAS   RE,VALNUM                                                        
         BNE   ER8                 NOT NUMERIC                                  
         MVI   0(R4),C','          INSERT SEPARATOR                             
         EDIT  (1,NUMBER),(2,1(R4)),FILL=0                                      
         MVI   3(R4),C')'          MOVE CLOSE-PAREN DOWN                        
         PACK  DUB,D+22(2)                                                      
         CVB   RF,DUB                                                           
         LA    RF,1(RF)                                                         
         EDIT  (RF),(2,D+22),FILL=0                                             
         LA    R4,3(R4)            BUMP MULTI-CLAUSE ADDR                       
         B     DTEN0010            GO BACK AND CHECK NEXT                       
         B     DATAPUT                                                          
         SPACE 2                                                                
* WHEN NO 'IF' OPTION ON REPORT SPEC, REPORT NUMBERS MUST BE                    
* CONSECUTIVE.  WHEN 'IF' OPTION IS USED, THIS TEST MUST BE SKIPPED             
*                                                                               
D1010    CLC   NUMBER,NEXTREP                                                   
         BNE   ER20                                                             
*                                                                               
         ZIC   R3,NEXTREP          NEXT REPORT NUMBER MUST BE ONE MORE          
         LA    R3,1(R3)                                                         
         STC   R3,NEXTREP                                                       
         MVI   THISRPIF,0                                                       
         B     DATAPUT                                                          
*                                                                               
         EJECT                                                                  
*              RPTCODE                                                          
*                                                                               
DATA11   MVC   D+28(2),P+9                                                      
         B     DATAPUT                                                          
         EJECT                                                                  
*              RPTRIGHT                                                         
*                                                                               
DATA13   L     R2,NEXTFLD          SEE IF OPERAND IS STRING OR KEYWORD          
         CLI   0(R2),C''''                                                      
         BE    D1350                                                            
*                                                                               
         BAS   RE,ISOKEY           GET KEYWORD                                  
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    ER70                                                             
*                                                                               
         L     R6,AROWSPEC         LOOK UP KEYWORD IN TABLE                     
D1310    EX    R3,SRCHKEY                                                       
         BE    D1320                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER70                                                             
         LA    R6,36(R6)                                                        
         B     D1310                                                            
*                                                                               
D1320    MVC   D+24(11),=C',255,DC),C'''   EDIT DATACODE INTO COMMAND           
         EDIT  (1,10(R6)),(2,D+29),FILL=0                                       
         LA    R3,13(R6)           GET STRING FROM TABLE                        
         LA    R4,D+35                                                          
         MVC   NUMBER,11(R6)       LENGTH OF STRING                             
         ZIC   R6,NUMBER                                                        
         LR    R5,R6                                                            
         LA    R5,4(R5)            LENGTH OF SPEC                               
*                                                                               
D1340    MVC   0(1,R4),0(R3)                                                    
         LA    R4,1(R4)                                                         
         LA    R3,1(R3)                                                         
         BCT   R6,D1340                                                         
*                                                                               
         MVI   0(R4),C''''                                                      
         EDIT  (R5),(2,D+22),FILL=0                                             
         B     DATAPUT                                                          
*                                                                               
D1350    MVC   D+24(4),=C'),C'''   GET LITERAL                                  
         LA    R3,D+28                                                          
         LA    R4,2                                                             
         BAS   RE,DATALIT                                                       
         L     R5,LITWIDTH         MAKE SURE WIDTH ISN'T TOO GREAT              
         C     R5,=F'36'                                                        
         BH    ER46                                                             
         B     DATAPUT                                                          
         EJECT                                                                  
*              COPIES                                                           
*                                                                               
DATA14   L     R2,NEXTFLD          NUMBER OF COPIES                             
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              REMPRINT                                                         
*                                                                               
DATA15   L     R2,NEXTFLD          ROW NUMBER                                   
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*              MONEY                                                            
*                                                                               
DATA16   CLI   HADSPC16,C'Y'                                                    
         BE    ER72                                                             
         MVI   HADSPC16,C'Y'                                                    
*                                                                               
         L     R2,NEXTFLD          GET OPTION                                   
         CLC   =C'DOLLARS',0(R2)                                                
         BNE   D1610                                                            
         MVI   NUMBER,X'01'                                                     
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         B     DATAPUT                                                          
*                                                                               
D1610    CLC   =C'ROUNDOLL',0(R2)                                               
         BNE   ER14                                                             
         MVI   NUMBER,X'02'                                                     
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              REMCOPY                                                          
*                                                                               
DATA17   L     R2,NEXTFLD                                                       
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         LA    R3,D+31                                                          
         LA    R4,3                                                             
         BAS   RE,DATALIT                                                       
         L     R5,LITWIDTH         EXACTLY TWO ALPHANUMERIC CHARS               
         C     R5,=F'2'                                                         
         BNE   ER74                                                             
         B     DATAPUT                                                          
         EJECT                                                                  
*              ONLINE                                                           
*                                                                               
DATA18   LA    R1,3                                                             
         LA    RF,D+25                                                          
*                                                                               
D1810    L     R2,NEXTFLD          FIND KEYWORD                                 
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BNM   *+16                                                             
         CH    R1,=H'3'            NOT FOUND-                                   
         BL    DATAPUT              ALREADY ONE FOUND, OK                       
         B     ER48                 NONE, ERROR                                 
         L     R6,AONLROW                                                       
*                                                                               
D1820    EX    R3,SRCHKEY          FIND ONLINE ROW CODE                         
         BE    D1830                                                            
         LA    R6,9(R6)                                                         
         CLI   0(R6),X'FF'                                                      
         BE    ER76                                                             
         B     D1820                                                            
*                                                                               
D1830    EDIT  (1,8(R6)),(2,0(RF)),FILL=0                                       
         LA    RF,3(RF)                                                         
         BCT   R1,D1810            MAX 3 ROW CODES                              
*                                                                               
         L     R2,NEXTFLD                                                       
         BCTR  R2,0                                                             
         CLI   0(R2),C' '                                                       
         BNE   ER76                MORE THAN 3 KEYWORDS                         
         B     DATAPUT                                                          
         EJECT                                                                  
*              REPTYPE                                                          
*                                                                               
DATA19   L     R2,NEXTFLD                                                       
         CLC   0(3,R2),=C'AVL'                                                  
         BE    *+18                                                             
         CLC   0(3,R2),=C'SAL'                                                  
         BE    DATAPUT                                                          
         B     ER78                                                             
         MVC   D+28(3),0(R2)                                                    
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              RPTFILT SPEC                                                     
*                                                                               
         SPACE                                                                  
DATA20   L     R2,NEXTFLD          KEYWORD                                      
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    ER10                                                             
*                                                                               
         L     R6,AROWSPEC         FIND DATACODE                                
D2020    EX    R3,SRCHKEY                                                       
         BE    D2040                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER10                                                             
         LA    R6,36(R6)                                                        
         B     D2020                                                            
*                                                                               
D2040    EDIT  (1,10(R6)),(2,D+25),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD                                                       
         CLC   =C'INCLUDE',0(R2)                                                
         BE    D2060                                                            
         CLC   =C'EXCLUDE',0(R2)                                                
         BNE   ER14                                                             
         CLI   SPC20VAL,C'+'                                                    
         BE    ER40                                                             
         MVI   SPC20VAL,C'-'                                                    
         MVI   NUMBER,X'60'                    EXCLUDE -- MINUS                 
         B     D2080                                                            
*                                                                               
D2060    CLI   SPC20VAL,C'-'                   INCLUDE -- PLUS                  
         BE    ER40                                                             
         MVI   SPC20VAL,C'+'                                                    
         MVI   NUMBER,X'4E'                                                     
*                                                                               
D2080    EDIT  (1,NUMBER),(3,D+28),FILL=0                                       
*                                                                               
         LA    R3,D+35                         GET LITERAL                      
         LA    R2,8(R2)                                                         
         ST    R2,NEXTFLD                                                       
         LA    R4,4                                                             
         BAS   RE,DATALIT                                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*    SET UP REPORT FLAGS:  MISCELL REPORT PARAMETERS/SWITCHES                   
*                                                                               
DATA21   EQU   *                                                                
         L     R2,NEXTFLD          FLAG # 1                                     
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
*                                                                               
         L     R2,NEXTFLD          FLAG # 2                                     
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          FLAG # 3                                     
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          FLAG # 4                                     
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+34),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          FLAG # 5                                     
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+37),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          FLAG # 6                                     
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+40),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          FLAG # 7                                     
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+43),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          FLAG # 8                                     
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+46),FILL=0                                       
*                                                                               
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*          ALIGN BASE FOR AGGREGATE REPORT N FOR X COLUMNS                      
*                                                                               
DATA24   CLI   HADSPC30,C'Y'       OK ONLY BEFORE ROW SPECS                     
         BE    ER38                                                             
         CLI   HADSPC32,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC40,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER38                                                             
*                                                                               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
*                                                                               
         L     R2,NEXTFLD          NUMBER OF ROWS FOR COMPARISON                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          TOTAL NUMBER OF ROWS                         
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
*                                                                               
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*          AGGREGATE REPORT N FOR X COLUMNS                                     
*                                                                               
DATA25   CLI   HADSPC30,C'Y'       OK ONLY BEFORE ROW SPECS                     
         BE    ER38                                                             
         CLI   HADSPC32,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC40,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER38                                                             
*                                                                               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
*                                                                               
         L     R2,NEXTFLD          NUMBER OF ROWS FOR COMPARISON                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          TOTAL NUMBER OF ROWS                         
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
*                                                                               
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              RECAP REPORT N AT LEVEL M                                        
*                                                                               
DATA26   CLI   HADSPC30,C'Y'       OK ONLY BEFORE ROW SPECS                     
         BE    ER38                                                             
         CLI   HADSPC32,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC40,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER38                                                             
*                                                                               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          ROW NUMBER                                   
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              RECAP REPORT N AT LEVEL M, ALTERNATE REPORT R                    
*                                                                               
DATA26A  CLI   HADSPC30,C'Y'       OK ONLY BEFORE ROW SPECS                     
         BE    ER38                                                             
         CLI   HADSPC32,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC40,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER38                                                             
*                                                                               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          ROW NUMBER                                   
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          ALTERNATE REPORT NUMBER                      
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*          AGGREGATE REPORT N FOR X COLUMNS FOR SPL CALCULATIONS                
*                                                                               
DATA27   CLI   HADSPC30,C'Y'       OK ONLY BEFORE ROW SPECS                     
         BE    ER38                                                             
         CLI   HADSPC32,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC40,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER38                                                             
*                                                                               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
*                                                                               
         L     R2,NEXTFLD          NUMBER OF ROWS FOR COMPARISON                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          TOTAL NUMBER OF ROWS                         
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
*                                                                               
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*          AGGREGATE REPORT N FOR X COLUMNS FOR TABLE STUFFING                  
*                                                                               
DATA28   CLI   HADSPC30,C'Y'       OK ONLY BEFORE ROW SPECS                     
         BE    ER38                                                             
         CLI   HADSPC32,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC40,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER38                                                             
*                                                                               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
*                                                                               
         L     R2,NEXTFLD          NUMBER OF ROWS FOR COMPARISON                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
*    IN EVENT TOTAL NUMBER OF ROWS IS NEEDED, CODE IS COMMENTED                 
*       OUT, BUT NOT DELETED                                                    
*                                                                               
***      L     R2,NEXTFLD          TOTAL NUMBER OF ROWS                         
***      BAS   RE,VALNUM                                                        
***      BNE   ER8                                                              
***      EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
*                                                                               
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*          BUDGET DATA INTEGRATION:  REPORT #, ONLY SCAN #ROWS                  
*                                                                               
DATA29   CLI   HADSPC30,C'Y'       OK ONLY BEFORE ROW SPECS                     
         BE    ER38                                                             
         CLI   HADSPC32,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC40,C'Y'                                                    
         BE    ER38                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER38                                                             
*                                                                               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
*                                                                               
         L     R2,NEXTFLD          NUMBER OF ROWS FOR SCAN                      
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
         B     DATAPUT                                                          
         EJECT                                                                  
*              ROW                                                              
*                                                                               
DATA30   CLI   HADSPC40,C'Y'       OK ONLY BEFORE COLUMN SPECS                  
         BE    ER36                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER36                                                             
         CLI   HADSPC32,C'Y'       OK ONLY IF NO ROWEQU SPEC                    
         BE    ER28                                                             
*********CLI   HADMONSP,C'Y'                                                    
*********BE    ER44                                                             
         MVI   HADSPC30,C'Y'                                                    
         MVI   LSTSPC30,C'Y'                                                    
         MVI   HADIFOP,C'N'                                                     
         MVC   ROWPREV,ROWNUM      SAVE PREVIOUS ROW NUMBER                     
*                                                                               
         L     R2,NEXTFLD          ROW NUMBER                                   
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         CLI   NUMBER,15           IS ROW NUMBER 15 OR LESS?                    
         BH    ER9                 NO  - ERROR                                  
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
         MVC   ROWNUM,NUMBER                                                    
*                                                                               
*********CLC   ROWNUM,NEXTROW      MAKE SURE THIS IS NEXT ROW NUMBER            
*********BNE   ER50                                                             
         ZIC   R3,NEXTROW                                                       
         LA    R3,1(R3)                                                         
         STC   R3,NEXTROW                                                       
*                                                                               
         L     R2,NEXTFLD          KEYWORD                                      
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    ER10                                                             
*                                                                               
         L     R6,AROWSPEC         FIND DATACODE                                
D3020    EX    R3,SRCHKEY                                                       
         BE    D3040                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER10                                                             
         LA    R6,36(R6)                                                        
         B     D3020                                                            
D3040    EDIT  (1,10(R6)),(2,D+28),FILL=0                                       
         CLC   0(8,R2),=C'CONTRACT' IS CONTRACT ROW SPEC PRESENT?               
         BNE   D3041                                                            
         MVI   CTRTSPEC,C'Y'       SET FLAG TO YES                              
D3041    EQU   *                                                                
*                                                                               
         CLC   0(7,R2),=C'STATION' IS STATION ROW SPEC PRESENT?                 
         BNE   D3042                                                            
         MVI   STATSPEC,C'Y'       SET FLAG TO YES                              
D3042    EQU   *                                                                
*                                                                               
         CLC   0(6,R2),=C'STAMKT'  IS STA/MKT  ROW SPEC PRESENT?                
         BNE   D3043                                                            
         MVI   STATSPEC,C'Y'       SET FLAG TO YES                              
D3043    EQU   *                                                                
*                                                                               
         MVC   CODLENSV,8(R6)      SAVE ROW DATA FOR OUTPUT LATER               
         MVC   NAMLENSV,9(R6)                                                   
         MVC   DATCODSV,10(R6)                                                  
         MVC   LITLENSV,11(R6)                                                  
         MVC   LITWIDSV,12(R6)                                                  
         MVC   DATNAMSV,13(R6)                                                  
*                                                                               
         CLI   DATCODSV,17         ROW MAY NOT FOLLOW MONTH SPEC                
         BE    D3060                                                            
         CLI   DATCODSV,18         ROW MAY NOT FOLLOW CURMONTH SPEC             
         BE    D3060                                                            
         CLI   DATCODSV,19         ROW MAY NOT FOLLOW ALLMONTH SPEC             
         BE    D3060                                                            
         CLI   DATCODSV,20         ROW MAY NOT FOLLOW QTR SPEC                  
         BE    D3060                                                            
         B     D3080                                                            
D3060    MVI   HADMONSP,C'Y'                                                    
*                                                                               
D3080    L     R2,NEXTFLD          LOOK FOR OPTIONS                             
         BAS   RE,ISOOPT                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    DATAPUT             NO (MORE) OPTIONS                            
*                                                                               
         LA    R6,ROWOPTS          SEARCH FOR OPTION IN TABLE                   
D30A0    EX    R3,SRCHKEY                                                       
         BE    D30B0                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER60                                                             
         LA    R6,8(R6)                                                         
         B     D30A0                                                            
*                                                                               
D30B0    L     R5,4(R6)            GET ADDRESS OF ROUTINE FOR OPTION            
         BR    R5                                                               
*                                                                               
ACHOP    L     R2,NEXTFLD          CHOP OPTION                                  
         BAS   RE,VALNUM           GET WIDTH                                    
         BNE   ER8                                                              
         MVC   FORCEWD,NUMBER                                                   
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
         B     D3080               GO BACK FOR MORE OPTIONS                     
*                                                                               
AFOLD    L     R2,NEXTFLD          FOLD OPTION                                  
         BAS   RE,VALNUM           GET WIDTH                                    
         BNE   ER8                                                              
         MVC   FORCEWD,NUMBER                                                   
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
         PACK  MYDUB,D+34(3)       GET EXISTING OPTIONS BYTE                    
         CVB   R5,MYDUB                                                         
         A     R5,=F'1'            TURN ON FOLD BIT                             
         EDIT  (R5),(3,D+34),FILL=0                                             
         B     D3080               GO BACK FOR MORE OPTIONS                     
*                                                                               
AZERO    L     R2,NEXTFLD          ZERO OPTION: FOR AGGREGATES ONLY             
         BAS   RE,VALNUM           GET WIDTH                                    
         BNE   ER8                                                              
         MVC   FORCEWD,NUMBER                                                   
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
         PACK  MYDUB,D+34(3)       GET EXISTING OPTIONS BYTE                    
         CVB   R5,MYDUB                                                         
         A     R5,=F'4'            TURN ON ZERO BIT                             
         EDIT  (R5),(3,D+34),FILL=0                                             
         B     D3080               GO BACK FOR MORE OPTIONS                     
*                                                                               
APAGE    L     R2,NEXTFLD          PAGE=1 OPTION                                
         BAS   RE,VALNUM           GET NUMBER                                   
         BNE   ER8                                                              
         CLI   NUMBER,1            MUST BE "1"                                  
         BNE   ER60                                                             
         PACK  MYDUB,D+34(3)       GET EXISTING OPTIONS BYTE                    
         CVB   R5,MYDUB                                                         
         A     R5,=F'2'            TURN ON PAGE BIT                             
         EDIT  (R5),(3,D+34),FILL=0                                             
         B     D3080               GO BACK FOR MORE OPTIONS                     
*                                                                               
AIF      L     R2,NEXTFLD          IF OPTION                                    
         BAS   RE,VALNUM           'IF' NUMBER                                  
         BNE   ER8                                                              
         MVI   HADIFOP,C'Y'        THIS ROW HAS IF OPTION                       
         EDIT  (1,NUMBER),(2,D+38),FILL=0                                       
         B     D3080               GO BACK FOR MORE OPTIONS                     
*                                                                               
ASTAG    L     R2,NEXTFLD          STAGGER OPTION                               
         BAS   RE,VALNUM           'STAGGER' NUMBER - MEANS NOTHING             
         BNE   ER8                                                              
         PACK  MYDUB,D+34(3)       GET EXISTING OPTIONS BYTE                    
         CVB   R5,MYDUB                                                         
         A     R5,=F'128'          SET X'80' BIT ON                             
         EDIT  (R5),(3,D+34),FILL=0                                             
         B     D3080               GO BACK FOR MORE OPTIONS                     
*                                                                               
*                                                                               
ROWOPTS  DS    0D                                                               
         DC    C'CHOP',A(ACHOP)                                                 
         DC    C'FOLD',A(AFOLD)                                                 
         DC    C'PAGE',A(APAGE)                                                 
         DC    C'IF  ',A(AIF)                                                   
         DC    C'STAG',A(ASTAG)                                                 
         DC    C'ZERO',A(AZERO)                                                 
         DC    X'FF'                                                            
         EJECT                                                                  
*              ROWNAME / ROWCODE / ROWBOTH                                      
*                                                                               
DATA31   MVI   LSTSPC31,C'Y'       OK ONLY AFTER ROW                            
*                                                                               
         EDIT  (1,CODLENSV),(2,D+34),FILL=0     SAVED DATA FROM TABLE           
         EDIT  (1,NAMLENSV),(2,D+37),FILL=0                                     
*                                                                               
         L     R2,NEXTFLD          ROW DESCRIPTION (H,M,P)                      
         CLI   0(R2),C'H'          HEADLINE                                     
         BNE   D3120                                                            
         MVC   D+28(2),=C'01'                                                   
         B     D3140                                                            
D3120    CLI   0(R2),C'M'          MIDLINE                                      
         BNE   D3130                                                            
         MVC   D+28(2),=C'02'                                                   
         B     D3140                                                            
D3130    CLI   0(R2),C'P'          PRINTLINE                                    
         BNE   ER10                                                             
         MVC   D+28(2),=C'03'                                                   
         OC    SAVROW#,SAVROW#     FIRST PRINTLINE ROW?                         
         BNZ   D3140               NO                                           
         MVC   SAVROW#,ROWNUM      YES - SAVE ITS NUMBER                        
*                                                                               
D3140    L     R2,NEXTFLD          LOOK FOR OVERRIDE LITERAL                    
         LA    R2,2(R2)                                                         
         CLI   0(R2),C' '                                                       
         BNE   D3170                                                            
*                                                                               
         LA    R5,0                GET LITERAL FROM TABLE                       
         LA    R3,DATNAMSV                                                      
         LA    R4,D+43                                                          
         ZIC   R6,LITLENSV                                                      
         LTR   R6,R6                                                            
         BZ    D3160                                                            
         MVC   D+40(4),=C',C'' '                                                
*                                                                               
D3150    MVC   0(1,R4),0(R3)                                                    
         LA    R3,1(R3)                                                         
         LA    R4,1(R4)                                                         
         LA    R5,1(R5)                                                         
         BCT   R6,D3150                                                         
*                                                                               
         MVI   0(R4),C''''                                                      
D3160    EDIT  (R5),(2,D+31),FILL=0    LENGTH OF LITERAL                        
         LA    R5,7(R5)                                                         
         EDIT  (R5),(2,D+22),FILL=0    LENGTH OF ENTIRE COMMAND                 
         ZIC   R5,LITWIDSV                                                      
         B     D3180                                                            
*                                                                               
D3170    MVC   D+40(4),=C',C'' '                                                
         ST    R2,NEXTFLD          GET OVERRIDE LITERAL                         
         LA    R4,7                                                             
         LA    R3,D+43                                                          
         BAS   RE,DATALIT                                                       
         L     R5,LITLEN                                                        
         EDIT  (R5),(2,D+31),FILL=0                                             
         L     R5,LITWIDTH                                                      
*                                                                               
D3180    CLC   ROWSV+31(2),=C'WD'  IF NOT SUPPLIED, COMPUTE WIDTH               
         BE    D3185                                                            
         ZIC   R4,FORCEWD          CHOP OR FOLD FORCED WIDTH                    
         B     D31A5                                                            
*                                                                               
D3185    ZIC   R4,NAMLENSV                                                      
         ZIC   R6,CODLENSV                                                      
         CLC   =C'NAME',P+3        ROWNAME -- NAME LENGTH ONLY                  
         BE    D31A0                                                            
         CLC   =C'CODE',P+3        ROWCODE -- CODE LENGTH ONLY                  
         BE    D3190                                                            
         AR    R4,R6               ROWBOTH -- NAME + CODE + 1                   
         A     R4,=F'1'                                                         
         B     D31A0                                                            
D3190    LR    R4,R6                                                            
D31A0    CR    R4,R5                                                            
         BH    D31A5                                                            
         LR    R4,R5         R4=WIDTH=MAX OF COMPUTED OR TITLE                  
*                               OR FORCED WIDTH FROM CHOP OR FOLD               
D31A5    EQU   *                                                                
         ZIC   RF,ROWNUM           SAVE ROW WIDTH IN STAGGER TABLE              
         BCTR  RF,0                MAKE ROW # ZERO RELATIVE                     
         SLL   RF,1                DOUBLE IT FOR DISPLACEMENT                   
         LA    RE,STAGFLAG         A(STAGGER FLAG ARRAY)                        
         AR    RE,RF               ADDR + DISPLACEMENT                          
         STC   R4,1(RE)            SAVE WIDTH OF CURRENT ROW                    
*                                                                               
         PACK  MYDUB,ROWSV+34(3)   GET EXISTING OPTION BYTE                     
         CVB   R0,MYDUB                                                         
         SRL   R0,7                ISOLATE 'STAGGER' OPTION BIT                 
         LTR   R0,R0                                                            
         BZ    D31A6               NOT 'STAGGER' - PROCEED                      
*                                                                               
*  APPLY 'STAGGER' TESTING.                                                     
*        CAN'T STAGGER HEADLINE OR MIDLINE ROWS                                 
*        1ST PRINT ROW CAN'T BE STAGGERED                                       
*        TWO ENTRIES IN A ROW CAN'T BE STAGGERED                                
*        STAGGERED ENTRY ASSUMES LENGTH OF PRECEDING ENTRY                      
*                                                                               
         CLC   =C'03',D+28         IS LINE A PRINTLINE?                         
         BNE   ER15                NO - THEN IT'S AN ERROR                      
         CLC   SAVROW#,ROWNUM      IS IT FIRST PRINT ROW?                       
         BE    ER11                YES - CAN'T STAGGER 1ST ROW                  
         ZIC   RF,ROWNUM           NO  - CHECK PREVIOUS ROW                     
         BCTR  RF,0                DECREMENT ROW NUMBER                         
         BCTR  RF,0                MAKE ZERO RELATIVE                           
         SLL   RF,1                DOUBLE IT FOR DISPLACEMENT                   
         LA    RE,STAGFLAG         A(STAGGER FLAG ARRAY)                        
         AR    RE,RF               ADDR + DISPLACEMENT                          
         TM    0(RE),X'80'         IS PREVIOUS ROW STAGGERED?                   
         BO    ER13                YES - CAN'T STAGGER 2 ROWS IN A ROW          
         ZIC   R4,1(RE)            GET L(PREV ROW)                              
         LA    RE,2(RE)            SAVE IT IN CURRENT ROW                       
         BCTR  R4,0                SUBTRACT 2 FOR STAGGER WIDTH                 
         BCTR  R4,0                                                             
         STC   R4,1(RE)            ...PUT IT BACK                               
         OI    0(RE),X'80'         TURN ON CURRENT ROW STAGGER                  
         EDIT  (R4),(2,ROWSV+31),FILL=0                                         
         SR    R4,R4               DON'T ADD STAGGER TO TOTAL WIDTH             
         B     D31A6A                                                           
D31A6    EQU   *                                                                
         EDIT  (R4),(2,ROWSV+31),FILL=0                                         
D31A6A   EQU   *                                                                
         CLC   D+28(2),=C'03'      ONLY CARE ABOUT TOTWIDTH                     
         BNE   D31E0               FOR PRINT ROWS                               
*                                                                               
         CLI   DATCODSV,2          IF STATION                                   
         BE    D31A7                                                            
         CLI   DATCODSV,32         OR STAMKT                                    
         BNE   D31A9                                                            
D31A7    CLC   =C'BOTH',P+3        AND ROWBOTH                                  
         BNE   D31A9                                                            
         CH    R4,=H'28'           AND WIDTH IS 28, THEN                        
         BNE   D31A9                                                            
         LA    R4,7                FORCE WIDTH TO 7                             
         SPACE 1                                                                
D31A9    CLC   ROWPREV,ROWNUM      FOR ROWS WITH IF OPTION,                     
         BE    D31B0               ONLY COUNT MAX ROW, NOT ALL ROWS             
         OC    IFTOTWD,IFTOTWD                                                  
         BZ    D31B0                                                            
         L     R3,TOTWIDTH                                                      
         L     R5,IFTOTWD                                                       
         AR    R3,R5               ADD IN TO TOTAL                              
         A     R3,=F'1'            ADD ROOM FOR SPACE BETWEEN ROWS              
         ST    R3,TOTWIDTH                                                      
         XC    IFTOTWD,IFTOTWD                                                  
*                                                                               
D31B0    CLI   HADIFOP,C'Y'                                                     
         BNE   D31B5                                                            
         L     R3,IFTOTWD     R3=LARGEST WIDTH AMONG IF ROWS SO FAR             
         CR    R3,R4               IF THIS ROW IS BIGGER,                       
         BH    *+8                                                              
         ST    R4,IFTOTWD          USE IT INSTEAD                               
         B     D31E0                                                            
*                                                                               
D31B5    LTR   R4,R4               IF NO WIDTH (CHOP=0)                         
         BZ    D31E0               DON'T ADD SPACE BTWN ROWS                    
         SPACE 1                                                                
         L     R3,TOTWIDTH                                                      
         AR    R3,R4               ADD WIDTH TO TOTAL PRINTLINE WIDTH           
         A     R3,=F'1'            ADD ROOM FOR SPACE BETWEEN ROWS              
         ST    R3,TOTWIDTH                                                      
*                                                                               
D31E0    B     DATAPUT                                                          
         EJECT                                                                  
*              ROWEQU                                                           
*                                                                               
DATA32   CLI   HADSPC40,C'Y'       ONLY BEFORE COLUMN SPECS                     
         BE    ER36                                                             
         CLI   HADSPC42,C'Y'                                                    
         BE    ER36                                                             
*                                                                               
         L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         MVI   HADSPC32,C'Y'       OK ONLY IF NO OTHER ROW SPECS                
         CLI   HADSPC30,C'N'                                                    
         BE    DATAPUT                                                          
         B     ER26                                                             
         EJECT                                                                  
*              RANK                                                             
*                                                                               
DATA33   CLI   OKSPEC33,C'Y'       MUST FOLLOW ROWCODE,BOTH, OR NAME            
         BNE   ER28                                                             
         MVI   LSTSPC33,C'Y'                                                    
         MVI   OKSPEC33,C'N'                                                    
*                                                                               
         L     R2,NEXTFLD          COLUMN NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          CHECK FOR OPTION                             
         BAS   RE,ISOOPT                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BNM   D3310                                                            
         CLI   SPC33VAL,C' '       SEE IF "IF" HAS BEEN SEEN BEFORE             
         BNE   ER68                IF SO, THEN ERROR                            
         MVI   SPC33VAL,C'0'                                                    
         B     DATAPUT             NO OPTIONS                                   
*                                                                               
D3310    CLC   0(2,R2),=C'IF'      CHECK FOR "IF" OPTION                        
         BNE   D3320                                                            
         CLI   SPC33VAL,C'0'       SEE IF "IF" HAS BEEN SEEN BEFORE             
         BE    ER66                                                             
         MVI   SPC33VAL,C'1'                                                    
         L     R2,NEXTFLD          GET "IF NUMBER"                              
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          CHECK FOR NEXT OPTION                        
         BAS   RE,ISOOPT                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    DATAPUT             NO MORE OPTIONS                              
*                                                                               
D3320    CLC   0(6,R2),=C'WITHIN'                                               
         BNE   ER62                                                             
         L     R2,NEXTFLD          GET ROW NUMBER                               
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+31),FILL=0                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*              NOTOT                                                            
*                                                                               
DATA35   LA    R3,D+24             GET COLUMN NUMBERS                           
         LA    R6,2                                                             
D3510    L     R2,NEXTFLD                                                       
         CLI   0(R2),C' '          UNTIL THERE ARE NO MORE                      
         BE    D3520               NOTCOL                                       
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         MVI   0(R3),C','                                                       
         EDIT  (1,NUMBER),(2,1(R3)),FILL=0                                      
         LA    R3,3(R3)                                                         
         LA    R6,1(R6)                                                         
         B     D3510               NEXTCOL                                      
D3520    MVI   0(R3),C')'                                                       
         EDIT  (R6),(2,D+22),FILL=0    LENGTH OF INSTRUCTION                    
         B     DATAPUT                                                          
         EJECT                                                                  
*              ROWFILT                                                          
*                                                                               
DATA36   CLI   OKSPEC36,C'Y'                   MUST FOLLOW ROWCODE              
         BNE   ER28                                                             
         MVI   LSTSPC36,C'Y'                                                    
         MVI   OKSPEC36,C'N'                                                    
*                                                                               
         EDIT  (1,DATCODSV),(2,D+25),FILL=0    DATACODE FROM ROW                
*                                                                               
         L     R2,NEXTFLD                                                       
         CLC   =C'INCLUDE',0(R2)                                                
         BE    D3610                                                            
         CLC   =C'EXCLUDE',0(R2)                                                
         BNE   ER14                                                             
         CLI   SPC36VAL,C'+'                                                    
         BE    ER40                                                             
         MVI   SPC36VAL,C'-'                                                    
         MVI   NUMBER,X'60'                    EXCLUDE -- MINUS                 
         B     D3620                                                            
D3610    CLI   SPC36VAL,C'-'                   INCLUDE -- PLUS                  
         BE    ER40                                                             
         MVI   SPC36VAL,C'+'                                                    
         MVI   NUMBER,X'4E'                                                     
D3620    EDIT  (1,NUMBER),(3,D+28),FILL=0                                       
*                                                                               
         LA    R3,D+35                         GET LITERAL                      
         LA    R2,8(R2)                                                         
         ST    R2,NEXTFLD                                                       
         LA    R4,4                                                             
         BAS   RE,DATALIT                                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*              COL                                                              
*                                                                               
DATA40   EQU   *                                                                
         MVI   HADSPC40,C'Y'       OK ONLY IF NO COLEQU                         
         CLI   HADSPC42,C'Y'                                                    
         BE    ER24                                                             
         MVI   LSTSPC40,C'Y'                                                    
*                                                                               
         L     R2,NEXTFLD          COLUMN NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         CLC   NUMBER,NEXTCOL      MAKE SURE THIS IS NEXT COLUMN NO.            
         BNE   ER52                                                             
         ZIC   R3,NEXTCOL                                                       
         LA    R3,1(R3)                                                         
         STC   R3,NEXTCOL                                                       
*                                                                               
         L     R2,NEXTFLD          COLUMN WIDTH                                 
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+47),FILL=0                                       
*                                                                               
         ZIC   R3,NUMBER           ADD COLUMN WIDTH TO PRINTLINE WIDTH          
         A     R3,TOTWIDTH                                                      
         A     R3,=F'1'                                                         
         ST    R3,TOTWIDTH                                                      
*                                                                               
         LA    R6,COLEQLST         SAVE COL WIDTH FOR COLEQU WIDTH              
DA400020 CLI   0(R6),0                                                          
         BE    DA400060                                                         
         CLC   0(1,R6),THISREP                                                  
         BNE   DA400040                                                         
         CLC   1(1,R6),THISRPIF                                                 
         BE    DA400080                                                         
         CLI   1(R6),0                                                          
         BE    DA400060                                                         
DA400040 CLI   0(R6),X'FF'                                                      
         BE    ER80                TOO MANY SETS OF DIFFERENT COLUMNS           
         LA    R6,6(R6)                                                         
         B     DA400020                                                         
*                                                                               
DA400060 MVC   0(1,R6),THISREP                                                  
         MVC   1(1,R6),THISRPIF                                                 
DA400080 ZIC   R3,NUMBER           THIS COLUMN WIDTH                            
         A     R3,=F'1'            PLUS 1 SPACE BTWN COLS                       
         L     R4,2(R6)            COL WIDTH SO FAR                             
         AR    R4,R3                                                            
         ST    R4,2(R6)                                                         
*                                                                               
         L     R2,NEXTFLD          OPTIONAL PERIOD (KEY 1)                      
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    DATAPUT                                                          
*                                                                               
         LA    R6,SPECPER                                                       
DA400100 EX    R3,SRCHKEY                                                       
         BE    DA400120                                                         
         CLI   0(R6),X'FF'                                                      
         BE    ER14                                                             
         LA    R6,5(R6)                                                         
         B     DA400100                                                         
DA400120 EDIT  (1,3(R6)),(2,D+28),FILL=0                                        
         EDIT  (1,4(R6)),(2,D+31),FILL=0                                        
*                                                                               
         L     R2,NEXTFLD          KEY 2                                        
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BNM   DA400130            NEXT FIELD FOUND:  CHECK IT                  
*                                  NEXT FIELD MISSING:  WAS LAST                
*                                     'NO PERIOD/DECIMAL OPTION'?               
         CLI   3(R6),0             SPECPER ENTRY FOUND = ZERO?                  
         BE    DATAPUT             YES - FINISHED                               
         B     ER48                NO  - ERROR ENCOUNTERED                      
*                                                                               
DA400130 EQU   *                                                                
         L     R6,AKEYLIST                                                      
DA400140 EX    R3,SRCHKEY                                                       
         BE    DA400160                                                         
         CLI   0(R6),X'FF'                                                      
         BE    ER14                                                             
         LA    R6,6(R6)                                                         
         B     DA400140                                                         
DA400160 EDIT  (1,4(R6)),(2,D+34),FILL=0                                        
         EDIT  (1,5(R6)),(3,D+37),FILL=0                                        
*                                                                               
*   IF COLUMN SPEC IS FOR 'SHRG'(SHARE GOAL) OR 'CMMT'(COMMENT)                 
*      A ROW SPEC FOR 'CONTRACT' MUST HAVE BEEN SPECIFIED                       
*                                                                               
         CLC   0(4,R2),=C'SHRG'    SHARE GOAL COLUMN?                           
         BE    DA400180            YES - CHECK 'CONTRACT' ROW                   
         CLC   0(4,R2),=C'CMMT'    COMMENT COLUMN                               
         BNE   DA400200            NO                                           
DA400180 EQU   *                                                                
         CLI   CTRTSPEC,C'Y'       ROW SPEC FOR 'CONTRACT'?                     
         BNE   ER82                NO  - ERROR ON LINE                          
DA400200 EQU   *                                                                
*                                                                               
*   IF COLUMN SPEC IS FOR 'SPL$'(SPL DOLLARS) OR 'SPLM'(SPL MKT$)               
*   OR 'SPLD'(GROSS SPL DOLLARS) OR 'SPLG'(GROSS SPL MKT$)                      
*      A ROW SPEC FOR 'STATION' OR 'STAMKT' MUST HAVE BEEN SPECIFIED            
*                                                                               
         CLC   0(4,R2),=C'SPL$'    SPL DOLLARS COLUMN?                          
         BNE   DA400205            NO                                           
         OI    SPL$FLAG,1          YES - TURN ON '1' IN FLAG                    
         B     DA400220                                                         
DA400205 EQU   *                                                                
         CLC   0(4,R2),=C'SPLM'    SPL MKT DOLLARS COLUMN?                      
         BNE   DA400210            NO                                           
         OI    SPL$FLAG,2          YES - TURN ON '2' IN FLAG                    
         B     DA400220                                                         
DA400210 EQU   *                                                                
         CLC   0(4,R2),=C'SPLD'    GROSS SPL DOLLARS COLUMN?                    
         BNE   DA400215            NO                                           
         OI    GSPL$FLG,1          YES - TURN ON '1' IN FLAG                    
         B     DA400220            YES                                          
DA400215 EQU   *                                                                
         CLC   0(4,R2),=C'SPLG'    GROSS SPL MKT DOLLARS COLUMN?                
         BNE   DA400240            NO                                           
         OI    GSPL$FLG,2          YES - TURN ON '2' IN FLAG                    
*                                                                               
DA400220 EQU   *                                                                
         CLI   STATSPEC,C'Y'       ROW SPEC FOR 'STATION'?                      
         BNE   ER85                NO  - ERROR ON LINE                          
DA400240 EQU   *                                                                
         L     R2,NEXTFLD          OPTIONAL KEY 3                               
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    DATAPUT                                                          
         LA    R6,KEY3LIST                                                      
DA400260 EX    R3,SRCHKEY                                                       
         BE    DA400280                                                         
         CLI   0(R6),X'FF'                                                      
         BE    ER14                                                             
         LA    R6,5(R6)                                                         
         B     DA400260                                                         
DA400280 EDIT  (1,3(R6)),(2,D+41),FILL=0                                        
         EDIT  (1,4(R6)),(2,D+44),FILL=0                                        
         B     DATAPUT                                                          
         EJECT                                                                  
         SPACE 2                                                                
KEY3LIST DS    0D                                                               
         DC    C'COM',AL1(1,0)     COMMISSION                                   
         DC    X'FF'                                                            
         EJECT                                                                  
SPECPER  DS    0D                                                               
*                                  AS-AT APPLIES (GENERALLY)                    
         DC    C'PER',AL1(1,0)     PERIOD:                                      
         DC    C'YTD',AL1(2,0)     YTD:                                         
         DC    C'WKS',AL1(3,0)     WKS                                          
         DC    C'PE1',AL1(1,1)     PERIOD:  1 DECIMAL PLACE                     
         DC    C'YT1',AL1(2,1)     YTD:     1 DECIMAL PLACE                     
         DC    C'WK1',AL1(3,1)     WKS      1 DECIMAL PLACE                     
         DC    C'PE2',AL1(1,2)     PERIOD:  2 DECIMAL PLACES                    
         DC    C'YT2',AL1(2,2)     YTD:     2 DECIMAL PLACES                    
         DC    C'WK2',AL1(3,2)     WKS      2 DECIMAL PLACES                    
         DC    C'NO1',AL1(0,1)     COLCOMP: 1 DECIMAL PLACE                     
         DC    C'NO2',AL1(0,2)     COLCOMP: 1 DECIMAL PLACE                     
         DC    X'FF'                                                            
         EJECT                                                                  
*                                                                               
*              COLNAME                                                          
*                                                                               
DATA41   MVI   LSTSPC41,C'Y'       MUST FOLLOW COL SPEC                         
*                                                                               
         LA    R3,D+28             GET LITERAL                                  
         LA    R4,2                                                             
         BAS   RE,DATALIT                                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              COLEQU                                                           
*                                                                               
DATA42   L     R2,NEXTFLD          REPORT NUMBER                                
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         MVI   HADSPC42,C'Y'       OK ONLY IF NO OTHER COLUMN SPECS             
         CLI   HADSPC40,C'N'                                                    
         BNE   ER26                                                             
*                                                                               
         SR    R4,R4               FIND COL WIDTH & ADD TO TOTWIDTH             
         LA    R3,COLEQLST            FOR REPORTS WITH IFS,                     
D4210    CLC   0(1,R3),NUMBER         USE LARGEST COLUMN WIDTH                  
         BE    D4215                                                            
         CLI   0(R3),X'FF'                                                      
         BE    D4220                                                            
D4214    LA    R3,6(R3)                                                         
         B     D4210                                                            
*                                                                               
D4215    LTR   R4,R4                                                            
         BZ    D4216                                                            
         C     R4,2(R3)                                                         
         BH    D4214                                                            
D4216    L     R4,2(R3)                                                         
         B     D4214                                                            
*                                                                               
D4220    LTR   R4,R4                                                            
         BNZ   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         L     R5,TOTWIDTH         WIDTH OF ROWS                                
         AR    R5,R4               WIDTH OF COLS                                
         ST    R5,TOTWIDTH                                                      
         B     DATAPUT                                                          
         SPACE 4                                                                
COLEQLST DS    0D        PROVIDE FOR X DIFF. SETS OF COLUMNS                    
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    AL2(0),F'0'                                                      
         DC    X'FF'                                                            
         EJECT                                                                  
*              COLCOMP                                                          
*                                                                               
DATA43   LA    R5,2                FIRST COLUMN                                 
         LA    R4,D+24                                                          
         L     R2,NEXTFLD                                                       
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         MVI   0(R4),C','                                                       
         EDIT  (1,NUMBER),(2,1(R4)),FILL=0                                      
*                                                                               
         LA    R4,3(R4)            OPERAND                                      
         LA    R5,1(R5)                                                         
D4310    L     R2,NEXTFLD                                                       
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    ER18                                                             
*                                                                               
         LA    R6,OPLIST                                                        
D4320    EX    R3,SRCHKEY                                                       
         BE    D4340                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER18                                                             
         LA    R6,7(R6)                                                         
         B     D4320                                                            
D4340    MVI   0(R4),C','                                                       
         EDIT  (1,6(R6)),(2,1(R4)),FILL=0                                       
*                                                                               
         LA    R4,3(R4)            SECOND COLUMN                                
         LA    R5,1(R5)                                                         
         L     R2,NEXTFLD                                                       
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         MVI   0(R4),C','                                                       
         CLI   NUMBER,100          COLUMN NUMBER?                               
         BL    D4350               YES                                          
*                                  NO  - INSERT VALUE AS THREE CHARS            
*                                                                               
         EDIT  (1,NUMBER),(3,1(R4)),FILL=0                                      
         LA    R4,4(R4)            BUMP 4 TO NEXT POS                           
         B     D4360                                                            
D4350    EQU   *                                                                
         EDIT  (1,NUMBER),(2,1(R4)),FILL=0                                      
         LA    R4,3(R4)            BUMP 3 TO NEXT POS                           
D4360    EQU   *                                                                
         LA    R5,1(R5)            INCREMENT NUMBER OF FIELDS                   
         L     R2,NEXTFLD                                                       
         CLI   0(R2),C' '          SEE IF THERE IS MORE                         
         BNE   D4310                                                            
         MVI   0(R4),C')'                                                       
         EDIT  (R5),(2,D+22),FILL=0                                             
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
OPLIST   DS    0D                                                               
         DC    C'+     ',AL1(1)                                                 
         DC    C'-     ',AL1(2)                                                 
         DC    C'X     ',AL1(3)                                                 
         DC    C'/     ',AL1(4)                                                 
         DC    C'PCT   ',AL1(5)                                                 
         DC    C'PCTCHG',AL1(6)                                                 
         DC    C'PCTADJ',AL1(7)                                                 
         DC    X'FF'                                                            
         EJECT                                                                  
*                                                                               
*              CHUNK                                                            
*                                                                               
DATA44   L     R2,NEXTFLD          FIRST COLUMN                                 
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          SECOND COLUMN                                
         BAS   RE,VALNUM                                                        
         BNE   ER16                                                             
         EDIT  (1,NUMBER),(2,D+28),FILL=0                                       
*                                                                               
         LA    R3,D+34             LITERAL                                      
         LA    R4,4                                                             
         BAS   RE,DATALIT                                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*                                                                               
*              COLFOOT                                                          
*                                                                               
DATA45   LA    R3,D+28             GET STRING                                   
         LA    R4,2                                                             
         BAS   RE,DATALIT                                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*              TOTPRNT                                                          
*                                                                               
DATA51   L     R2,NEXTFLD          ROW NUMBER                                   
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          REQUIRED KEYWORD                             
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    ER48                IF NONE, THEN ERROR                          
*                                                                               
         L     R6,AROWSPEC                                                      
D5110    EX    R3,SRCHKEY                                                       
         BE    D5120                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER10                                                             
         LA    R6,36(R6)                                                        
         B     D5110                                                            
D5120    EDIT  (1,10(R6)),(2,D+28),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          OPTIONAL KEYWORD                             
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    DATAPUT                                                          
*                                                                               
         L     R6,AROWSPEC                                                      
D5130    EX    R3,SRCHKEY                                                       
         BE    D5140                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER10                                                             
         LA    R6,36(R6)                                                        
         B     D5130                                                            
D5140    EDIT  (1,10(R6)),(2,D+31),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD          OPTIONAL KEYWORD                             
         CLI   0(R2),C' '                                                       
         BE    DATAPUT                                                          
         CLC   0(6,R2),=C'MONTHS'                                               
         BNE   ER10                                                             
         MVI   NUMBER,X'80'                                                     
         EDIT  (1,NUMBER),(3,D+34)                                              
         B     DATAPUT                                                          
         EJECT                                                                  
*              IF                                                               
*                                                                               
DATA60   CLI   HADSPC40,C'Y'           MAKE SURE ROW SPECS ARE OVER             
         BE    D6010                                                            
         CLI   HADSPC42,C'Y'                                                    
         BE    D6010                                                            
         B     ER64                                                             
*                                                                               
D6010    L     R2,NEXTFLD              "IF" NUMBER                              
         BAS   RE,VALNUM                                                        
         BNE   ER8                                                              
         EDIT  (1,NUMBER),(2,D+25),FILL=0                                       
*                                                                               
         L     R2,NEXTFLD              OPTION KEYWORD                           
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    ER48                                                             
*                                                                               
         LA    R6,IFOPTLST                                                      
D6020    EX    R3,SRCHKEY                                                       
         BE    D6030                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER14                                                             
         LA    R6,8(R6)                                                         
         B     D6020                                                            
D6030    EDIT  (1,7(R6)),(2,D+28),FILL=0                                        
*                                                                               
         L     R2,NEXTFLD              CONDITIONAL OPERAND                      
         BAS   RE,ISOKEY                                                        
         L     R3,KEYLEN                                                        
         LTR   R3,R3                                                            
         BM    ER48                                                             
*                                                                               
         LA    R6,CONDOP                                                        
D6040    EX    R3,SRCHKEY                                                       
         BE    D6050                                                            
         CLI   0(R6),X'FF'                                                      
         BE    ER14                                                             
         LA    R6,3(R6)                                                         
         B     D6040                                                            
D6050    EDIT  (1,2(R6)),(3,D+31),FILL=0                                        
*                                                                               
         LA    R3,D+38                 GET LITERAL                              
         LA    R2,NEXTFLD                                                       
         LA    R4,5                                                             
         BAS   RE,DATALIT                                                       
         B     DATAPUT                                                          
*                                                                               
IFOPTLST DS    0D                                                               
         DC    C'OPTION1',AL1(1)                                                
         DC    C'OPTION2',AL1(2)                                                
         DC    C'OPTION3',AL1(3)                                                
         DC    C'OPTION4',AL1(4)                                                
         DC    C'SEQ    ',AL1(5)                                                
         DC    C'SBGROUP',AL1(6)                                                
         DC    C'ACCOPT ',AL1(7)                                                
         DC    C'REP    ',AL1(8)                                                
         DC    X'FF'                                                            
*                                                                               
CONDOP   DS    0D                                                               
         DC    C'EQ',X'80'                                                      
         DC    C'NE',X'70'                                                      
         DC    C'GT',X'20'                                                      
         DC    C'LT',X'40'                                                      
         DC    C'GE',X'B0'                                                      
         DC    C'LE',X'D0'                                                      
         DC    X'FF'                                                            
         EJECT                                                                  
*                                                                               
*                                                                               
*                                                                               
*              RPTNAME / TOTROW / TOTDIFF / TOTPCT / TOTSAME                    
*                                                                               
DATAMSC  LA    R3,D+28             GET STRING                                   
         LA    R4,2                                                             
         BAS   RE,DATALIT                                                       
         B     DATAPUT                                                          
         EJECT                                                                  
*              COMPLETE LITERALS                                                
*                                                                               
DATALIT  NTR1                                                                   
         XC    LITLEN,LITLEN       LENGTH OF LITERAL                            
         L     R2,NEXTFLD          POSITION R2 TO START OF LITERAL              
         CLI   0(R2),C''''         LITERAL MUST BEGIN WITH QUOTE                
         BNE   ER22                                                             
         LA    R2,1(R2)            FIRST LITERAL CHARACTER                      
         LA    R6,0                WIDTH OF LITERAL                             
         L     R5,=F'-2'                                                        
*                                                                               
DLIT10   CLI     0(R2),C'&&'         AMPERSANDS ARE DOUBLED                     
         BNE   DLIT20                                                           
         MVI   0(R3),C'&&'                                                      
         LA    R3,1(R3)                                                         
*                                                                               
DLIT20   CLI   0(R2),C'?'          QUESTION MARKS BECOME DINKS                  
         BNE   DLIT30                                                           
         MVI   0(R2),C''''                                                      
         MVI   0(R3),C''''                                                      
         LA    R3,1(R3)                                                         
*                                                                               
DLIT30   CLI   0(R2),C','          SPLIT STRING UP INTO ROWS                    
         BNE   DLIT50                                                           
         CR    R6,R5                                                            
         BL    DLIT40                                                           
         LR    R5,R6                                                            
DLIT40   L     R6,=F'-1'                                                        
*                                                                               
DLIT50   MVC   0(1,R3),0(R2)                                                    
         LA    R2,1(R2)            BUMP INPUT                                   
         LA    R3,1(R3)                 OUTPUT                                  
         LA    R4,1(R4)                 COMMAND LENGTH                          
         AF    LITLEN,1                 LITERAL LENGTH                          
         LA    R6,1(R6)                 LITERAL WIDTH                           
         CLI   0(R2),C''''         TEST FOR END OF LITERAL                      
         BNE   DLIT10                                                           
         MVC   0(1,R3),0(R2)       FINAL QUOTE                                  
         EDIT  (R4),(2,D+22),FILL=0         ADD LENGTH                          
*                                                                               
         CR    R6,R5                                                            
         BL    DLIT60                                                           
         LR    R5,R6                                                            
DLIT60   ST    R5,LITWIDTH         SAVE LONGEST LITERAL WIDTH                   
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE NUMERIC FIELD                                           
*                                                                               
VALNUM   NTR1                                                                   
         LR    R6,R2               START OF FIELD                               
         SR    R3,R3               CHECK LENGTH                                 
         CLI   1(R2),C' '                                                       
         BE    ADD2                                                             
         CLI   1(R2),C','                                                       
         BE    ADD2                                                             
         CLI   1(R2),C'+'          FOR MULTI-CLAUSE 'IF' STATEMENT              
         BE    ADD2                                                             
         LA    R3,1                                                             
         CLI   2(R2),C' '                                                       
         BE    ADD3                                                             
         CLI   2(R2),C','                                                       
         BE    ADD3                                                             
         CLI   2(R2),C'+'                                                       
         BE    ADD3                                                             
         LA    R3,2                                                             
         CLI   3(R2),C' '                                                       
         BE    ADD4                                                             
         CLI   3(R2),C','                                                       
         BE    ADD4                                                             
         CLI   3(R2),C'+'                                                       
         BNE   NO                                                               
*                                                                               
ADD4     LA    R6,1(R6)                                                         
ADD3     LA    R6,1(R6)                                                         
ADD2     LA    R6,2(R6)                                                         
         ST    R6,NEXTFLD                                                       
         MVC   WORK(3),=C'000'                                                  
         EX    R3,NUMZONE                                                       
         EX    R3,NUMCOMP                                                       
         BNE   NO                                                               
         EX    R3,NUMPACK                                                       
         CVB   R1,DUB                                                           
         CH    R1,=H'256'                                                       
         BH    NO                                                               
         STC   R1,NUMBER                                                        
         B     YES                                                              
*                                                                               
NUMZONE  MVZ   WORK(0),0(R2)                                                    
NUMCOMP  CLC   WORK(0),=C'000'                                                  
NUMPACK  PACK  DUB,0(0,R2)                                                      
*                                                                               
YES      SR    R0,R0                                                            
         B     *+8                                                              
*                                                                               
NO       LA    R0,1                                                             
         LTR   R0,R0                                                            
         B     XIT                                                              
BOMB     DC    C' '                                                             
         EJECT                                                                  
*              ISOLATE KEYWORDS                                                 
*                                                                               
ISOKEY   NTR1                                                                   
         L     R3,=F'-1'           LENGTH MINUS ONE FOR EX STATEMENT            
         CLI   0(R2),C' '          SEE IF THERE IS A KEYWORD                    
         BE    ISONONE                                                          
*                                                                               
ISO1     LA    R2,1(R2)                                                         
         LA    R3,1(R3)                                                         
         CLI   0(R2),C' '                                                       
         BE    ISODONE                                                          
         CLI   0(R2),C','                                                       
         BNE   ISO1                                                             
*                                                                               
ISODONE  LA    R2,1(R2)            POINT TO START OF NEXT FIELD                 
         ST    R2,NEXTFLD                                                       
ISONONE  ST    R3,KEYLEN           SAVE LENGTH OF KEY                           
         B     XIT                                                              
*                                                                               
*              ISOLATE OPTIONS                                                  
*                                                                               
ISOOPT   NTR1                                                                   
         L     R3,=F'-1'           LENGTH MINUS ONE FOR EX STATEMENT            
         CLI   0(R2),C' '          SEE IF THERE IS AN OPTION                    
         BE    OPTNONE                                                          
*                                                                               
OPT1     LA    R2,1(R2)                                                         
         LA    R3,1(R3)                                                         
         CLI   0(R2),C'='          OPTIONS END WITH EQUALS SIGN                 
         BNE   OPT1                                                             
*                                                                               
         LA    R2,1(R2)            POINT TO START OF NEXT FIELD                 
         ST    R2,NEXTFLD                                                       
OPTNONE  ST    R3,KEYLEN           SAVE LENGTH OF KEY                           
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE REPORT NUMBER                                           
*                                                                               
VALIREP  NTR1                                                                   
         ZIC   R3,NUMBER                                                        
         LTR   R3,R3                                                            
         BNP   NO                                                               
         CLC   NUMBER,NEXTREP                                                   
         BNL   NO                                                               
         B     YES                                                              
*                                                                               
*              VALIDATE ROW NUMBER                                              
*                                                                               
VALIROW  NTR1                                                                   
         ZIC   R3,NUMBER                                                        
         LTR   R3,R3                                                            
         BNP   NO                                                               
         CLC   NUMBER,NEXTROW                                                   
         BNL   NO                                                               
         B     YES                                                              
*                                                                               
*              VALIDATE COLUMN NUMBER                                           
*                                                                               
VALICOL  NTR1                                                                   
         ZIC   R3,NUMBER                                                        
         LTR   R3,R3                                                            
         BNP   NO                                                               
         CLC   NUMBER,NEXTCOL                                                   
         BNL   NO                                                               
         B     YES                                                              
         EJECT                                                                  
*              ERROR XITS                                                       
*                                                                               
ER2      LA    RF,1                                                             
         B     ERRSET                                                           
ER4      LA    RF,2                                                             
         B     ERRSET                                                           
ER6      LA    RF,3                                                             
         B     ERRSET                                                           
ER8      LA    RF,4                                                             
         B     ERRSET                                                           
ER9      LA    RF,5                                                             
         B     ERRSET                                                           
ER10     LA    RF,6                                                             
         B     ERRSET                                                           
ER11     LA    RF,7                                                             
         B     ERRSET                                                           
ER12     LA    RF,8                                                             
         B     ERRSET                                                           
ER13     LA    RF,9                                                             
         B     ERRSET                                                           
ER14     LA    RF,10                                                            
         B     ERRSET                                                           
ER15     LA    RF,11                                                            
         B     ERRSET                                                           
ER16     LA    RF,12                                                            
         B     ERRSET                                                           
ER18     LA    RF,13                                                            
         B     ERRSET                                                           
ER20     LA    RF,14                                                            
         B     ERRSET                                                           
ER22     LA    RF,15                                                            
         B     ERRSET                                                           
ER24     LA    RF,16                                                            
         B     ERRSET                                                           
ER26     LA    RF,17                                                            
         B     ERRSET                                                           
ER28     LA    RF,18                                                            
         B     ERRSET                                                           
ER30     LA    RF,19                                                            
         B     ERRSET                                                           
ER32     LA    RF,20                                                            
         B     ERRSET                                                           
ER34     LA    RF,21                                                            
         B     ERRSET                                                           
ER36     LA    RF,22                                                            
         B     ERRSET                                                           
ER38     LA    RF,23                                                            
         B     ERRSET                                                           
ER40     LA    RF,24                                                            
         B     ERRSET                                                           
ER42     LA    RF,25                                                            
         B     ERRSET                                                           
ER44     LA    RF,26                                                            
         B     ERRSET                                                           
ER46     LA    RF,27                                                            
         B     ERRSET                                                           
ER48     LA    RF,28                                                            
         B     ERRSET                                                           
ER50     LA    RF,29                                                            
         B     ERRSET                                                           
ER52     LA    RF,30                                                            
         B     ERRSET                                                           
ER54     LA    RF,31                                                            
         B     ERRSET                                                           
ER56     LA    RF,32                                                            
         B     ERRSET                                                           
ER58     LA    RF,33                                                            
         B     ERRSET                                                           
ER60     LA    RF,34                                                            
         B     ERRSET                                                           
ER62     LA    RF,35                                                            
         B     ERRSET                                                           
ER64     LA    RF,36                                                            
         B     ERRSET                                                           
ER66     LA    RF,37                                                            
         B     ERRSET                                                           
ER68     LA    RF,38                                                            
         B     ERRSET                                                           
ER70     LA    RF,39                                                            
         B     ERRSET                                                           
ER72     LA    RF,40                                                            
         B     ERRSET                                                           
ER74     LA    RF,41                                                            
         B     ERRSET                                                           
ER76     LA    RF,42                                                            
         B     ERRSET                                                           
ER78     LA    RF,43                                                            
         B     ERRSET                                                           
ER80     LA    RF,44                                                            
         B     ERRSET                                                           
ER82     LA    RF,45                                                            
         B     ERRSET                                                           
ER83     LA    RF,46                                                            
         B     ERRSET                                                           
ER84     LA    RF,47                                                            
         B     ERRSET                                                           
ER85     LA    RF,48                                                            
         B     ERRSET                                                           
ERRSET   EQU   *                                                                
         LR    R1,RF               SAVE ERROR NUMBER                            
         BCTR  RF,0                MAKE ZERO RELATIVE                           
         SR    RE,RE               CLEAR SECOND REGISTER                        
         M     RE,=F'38'           MULTIPLY BY LEN OF MESSAGE                   
         A     RF,AERRMSGS         ADD A(ERROR MESSAGE TABLE)                   
         MVC   P+85(38),0(RF)      MOVE MESSAGE TO PRINT LINE                   
         C     R1,=F'25'           ERROR MESSAGE # 25?                          
         BNE   ERRS0020            NO                                           
         EDIT  (R3),(3,P+96)       YES - INSERT NUMBER IN MESSAGE               
ERRS0020 EQU   *                                                                
         MVI   ERSW,C'1'                                                        
         CLI   BOMB,C'T'                                                        
         BNE   *+6                                                              
         DC    H'0'                                                             
         MVC   P+81(3),=C'==>'                                                  
         B     XIT                                                              
ERSW     DC    C'0'                                                             
         EJECT                                                                  
*              ROUTINES TO HANDLE OUTPUT                                        
*                                                                               
PUT      NTR1                                                                   
         CLI   LSTSPC30,C'Y'       SEE IF LAST SPEC WAS ROW                     
         BNE   PUT10                                                            
         MVC   ROWSV,D             IF SO, SAVE UNTIL NEXT COMMAND               
         B     XIT                                                              
*                                                                               
PUT10    CLI   LSTSPC31,C'Y'       SEE IF LAST SPEC WAS ROWCODE...ETC.          
         BNE   PUT30                                                            
         CLI   TRACOPT,C'Y'        IF SO, FIRST WRITE ROW CARD                  
         BNE   PUT20                                                            
         MVC   P(80),ROWSV                                                      
         GOTO1 =V(PRINTER)                                                      
PUT20    PUT   ASMFIL,ROWSV                                                     
*                                                                               
PUT30    CLI   TRACOPT,C'Y'        NOW WRITE NEW CARD                           
         BNE   PUT40                                                            
         MVC   P(80),D                                                          
         GOTO1 =V(PRINTER)                                                      
*                                                                               
PUT40    MVC   DOUT(71),D          SEE IF CONTINUATION CARD IS NEEDED           
         CLC   D+71(61),SPACES                                                  
         BE    PUT50               NO CONTINUATION CARD                         
*                                                                               
         MVI   DOUT+71,C'+'                                                     
         PUT   ASMFIL,DOUT                                                      
         MVC   DOUT(80),SPACES                                                  
         MVC   DOUT+15(56),D+71                                                 
*                                                                               
PUT50    PUT   ASMFIL,DOUT                                                      
         B     XIT                                                              
         EJECT                                                                  
*              ROUTINE TO HANDLE MULTI-OUTPUT                                   
*                                                                               
MULTI    NTR1                                                                   
MULTI2   MVC   D,0(R2)                                                          
         BAS   RE,PUT                                                           
         LA    R2,80(R2)                                                        
         CLI   0(R2),X'FF'                                                      
         BNE   MULTI2                                                           
XIT      XIT1                                                                   
*                                                                               
*              STACKS                                                           
*                                                                               
BEGSTACK DS    0D                                                               
         DC    CL80'         TITLE ''USER GENERATED RRGEN REPORT'''             
BEGCS    DC    CL80'RERG@@   CSECT'                                             
         DC    CL80'         SPACE 2'                                           
         DC    X'FF'                                                            
ENDSTACK DS    0D                                                               
         DC    CL80'         DC    X''00'''                                     
         DC    CL80'         SPACE 2'                                           
         DC    CL80'         END'                                               
         DC    X'FF'                                                            
BEGPH    DC    CL80'   NAME  RERG@@ (R)'                                        
         DC    X'FF'                                                            
*                                                                               
*                                                                               
ASMFIL   DCB   DDNAME=ASMFIL,DSORG=PS,RECFM=FB,LRECL=80,BLKSIZE=0,     +        
               MACRF=PM                                                         
LNKFIL   DCB   DDNAME=LNKFIL,DSORG=PS,RECFM=FB,LRECL=80,BLKSIZE=0,     +        
               MACRF=PM                                                         
*                                                                               
*                                                                               
SRCHKEY  CLC   0(0,R6),0(R2)       EX INSTRUCTION BASE                          
         EJECT                                                                  
*        WORKING STORAGE AND CONSTANTS                                          
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
DUMPLIST DS    0F                                                               
         DC    A(RRGEN,65000)                                                   
         ORG   *-4                                                              
         DC    X'80'                                                            
         ORG                                                                    
DUB      DS    D                                                                
WORK     DS    CL32                                                             
MYDUB    DS    D                                                                
DMCB     DS    6F                                                               
PANNAME  DC    CL10' '                                                          
NUMBER   DC    AL1(0)                                                           
ROWPREV  DC    AL1(0)                                                           
NEXTFLD  DS    A                                                                
KEYLEN   DS    F                                                                
LITLEN   DS    F                                                                
TOTWIDTH DC    F'0'                                                             
LITWIDTH DS    F                                                                
SGN      DS    CL1                                                              
D        DS    CL80                                                             
         DS    CL52                                                             
DOUT     DS    CL72                                                             
         DS    CL8                                                              
C        DS    CL80                                                             
ROWSV    DS    CL80                                                             
SAVEP    DS    CL132                                                            
TRACOPT  DC    C'N'                                                             
LSTSPC30 DC    C'N'                                                             
LSTSPC31 DC    C'N'                                                             
LSTSPC36 DC    C'N'                                                             
LSTSPC33 DC    C'N'                                                             
LSTSPC40 DC    C'N'                                                             
LSTSPC41 DC    C'N'                                                             
HADSPC10 DC    C'N'                                                             
HADSPC30 DC    C'N'                                                             
HADSPC32 DC    C'N'                                                             
HADSPC40 DC    C'N'                                                             
HADSPC42 DC    C'N'                                                             
FIRSTSPC DC    C'Y'                                                             
HADMONSP DC    C'N'                                                             
HADSPC16 DC    C'N'                                                             
OKSPEC36 DC    C'N'                                                             
SPC20VAL DC    C' '                                                             
SPC36VAL DC    C' '                                                             
OKSPEC33 DC    C'N'                                                             
SPC33VAL DC    C' '                                                             
ROWNUM   DS    AL1                                                              
DATCODSV DS    AL1                                                              
CODLENSV DS    AL1                                                              
NAMLENSV DS    AL1                                                              
LITLENSV DS    AL1                                                              
LITWIDSV DS    AL1                                                              
NEXTREP  DC    AL1(1)                                                           
NEXTROW  DC    AL1(1)                                                           
NEXTCOL  DC    AL1(1)                                                           
DATNAMSV DS    CL23                                                             
HADIFOP  DC    C'N'                                                             
IFTOTWD  DC    F'0'                                                             
FORCEWD  DS    AL1                                                              
THISREP  DC    AL1(0)                                                           
THISRPIF DC    AL1(0)              REPORT IF NUMBER                             
CTRTSPEC DS    C'N'                CONTRACT ROW SPEC PRESENT                    
STATSPEC DS    C'N'                STATION  ROW SPEC PRESENT                    
CMMTSPEC DS    C'N'                COMMENT      SPEC PRESENT                    
SPL$FLGS DS    0XL2                SPL$/SPL MKT$ COL FLAGS                      
SPL$FLAG DS    XL1                 SPL$/SPL MKT $$                              
GSPL$FLG DS    XL1                 GROSS SPL$/MKT $$                            
         DS    0H                  HALF-WORD BOUNDARIES                         
         DC    C'**STAG**'                                                      
STAGFLAG DS    XL64                STAGGER FLAG ARRAY                           
*                                  32 2-BYTE ENTRIES                            
*                                  X'80' INDICATES ITEM IS 'STAGGER'            
*                                  X'EF' INDICATES LENGTH OF ITEM               
SAVROW#  DC    X'00'               SAVE AREA: 1ST PRINTLINE ROW#                
AROWSPEC DS    A                   A(ROWSPECS TABLE)                            
AKEYLIST DS    A                                                                
AONLROW  DS    A                   A(ONLINE ROWS TABLE)                         
AERRMSGS DS    A                   A(ERROR MESSAGE TABLE)                       
         EJECT                                                                  
         CSECT                                                                  
         NMOD1 0,*KEYS*                                                         
*                                                                               
KEYLIST  DS    0D                                                               
         DC    C'EST ',AL1(09,21)                                               
         DC    C'-EST',AL1(09,22)                                               
         DC    C'ACT ',AL1(09,23)                                               
         DC    C'-ACT',AL1(09,24)                                               
         DC    C'BUD ',AL1(09,25)                                               
         DC    C'AVL ',AL1(09,26)                                               
         DC    C'-AVL',AL1(09,27)                                               
         DC    C'REV ',AL1(09,28)                                               
         DC    C'2EST',AL1(09,29)              2 YEAR PRIOR ESTIMATE            
         DC    C'2ACT',AL1(09,30)              2 YEAR PRIOR ACTUAL              
         DC    C'NEX ',AL1(09,31)              NEXT YEAR ESTIMATE               
*                                                                               
*  DEFINITION OF BOOKED:  TOTAL ORDERED FOR MONTH, AS AT DATE ENTERED           
*                                                                               
         DC    C'BKC ',AL1(09,32)              BOOKED:  CURRENT YEAR            
         DC    C'BKP ',AL1(09,33)              BOOKED:  PRIOR YEAR              
         DC    C'BK2 ',AL1(09,34)              BOOKED:  2 YEARS PRIOR           
         DC    C'BLNK',AL1(09,35)              BLANK COLUMN                     
         DC    C'THWK',AL1(09,36)              THIS WEEK ESTIMATE               
         DC    C'LAWK',AL1(09,37)              LAST WEEK ESTIMATE               
         DC    C'BILC',AL1(09,38)              BILLING:  CURRENT                
         DC    C'BILP',AL1(09,39)              BILLING:  PRIOR                  
         DC    C'BIL2',AL1(09,40)              BILLING:  2 YRS PRIOR            
         DC    C'FORC',AL1(09,41)              FORCE ROW COLUMN                 
         DC    C'BDGT',AL1(09,42)              BUDGET:     FROM SAR ELT         
         DC    C'SHRG',AL1(09,43)              SHARE GOAL: NEEDS CNTRCT         
         DC    C'CFOR',AL1(09,44)              FCST+PNDG $: CURRENT             
         DC    C'PFOR',AL1(09,45)              FCST+PNDG $: PRIOR               
         DC    C'2FOR',AL1(09,46)              FCST+PNDG $: 2 YRS PRI           
         DC    C'NFOR',AL1(09,47)              FORECAST $: NEXT                 
         DC    C'CMMT',AL1(09,48)              COMMENT: NEEDS CONTRACT          
         DC    C'SHR$',AL1(09,49)              SHARE GOAL*MKT DOLLARS           
         DC    C'MKT$',AL1(09,50)              MARKET DOLLARS                   
         DC    C'DELM',AL1(09,51)              FORCE ROW COL DELIMITER          
         DC    C'SPLC',AL1(09,52)              SPL AS-RUN CURRENT YEAR          
         DC    C'SPLP',AL1(09,53)              SPL AS-RUN PRIOR   YEAR          
         DC    C'BKCN',AL1(09,54)              BOOKED:  CURNT YEAR              
*                                                 NO AS-AT DATE                 
         DC    C'BKPN',AL1(09,55)              BOOKED:  PRIOR YEAR              
*                                                 NO AS-AT DATE                 
         DC    C'CMKT',AL1(09,56)              FORECAST $: CURR YEAR            
*                                                 MARKET DOLLARS                
         DC    C'PMKT',AL1(09,57)              FORECAST $: PRIOR YR             
*                                                 MARKET DOLLARS                
         DC    C'ESTT',AL1(09,58)              ESTIMATED TOTAL $$               
         DC    C'FEST',AL1(09,59)              FORCE ROW FOR                    
*                                                 ESTIMATED TOTAL $$            
         DC    C'BCUM',AL1(09,60)              CURR BILLING CUME                
         DC    C'%CUM',AL1(09,61)              CURR BILLING % CUME              
         DC    C'SPLT',AL1(09,62)              SPL AS-RUN THIS WEEK             
         DC    C'SPLE',AL1(09,63)              SPL AS-RUN ESTIMATED             
         DC    C'CPEN',AL1(09,64)              CURRENT PENDING ONLY             
         DC    C'PPEN',AL1(09,65)              PRIOR   PENDING ONLY             
         DC    C'2PEN',AL1(09,66)              2YR PRI PENDING ONLY             
         DC    C'CFCS',AL1(09,67)              CURRENT FORECST ONLY             
         DC    C'PFCS',AL1(09,68)              PRIOR   FORECST ONLY             
         DC    C'2FCS',AL1(09,69)              2YR PRI FORECST ONLY             
         DC    C'FORR',AL1(09,70)              FORCE/REPLACE ROW COL            
         DC    C'CPMK',AL1(09,71)              CURR  PEND (TRUE) MKT$           
         DC    C'PPMK',AL1(09,72)              PRIOR PEND (TRUE) MKT$           
         DC    C'CFMK',AL1(09,73)              CURR  FORE (TRUE) MKT$           
         DC    C'PFMK',AL1(09,74)              PRIOR FORE (TRUE) MKT$           
         DC    C'THWP',AL1(09,75)              THIS WEEK PRIOR YEAR             
         DC    C'SPLL',AL1(09,76)              SPL THS WEEK, LAST YR            
         DC    C'SPL%',AL1(09,77)              SPL %, REP'D STATION             
         DC    C'SPL-',AL1(09,78)              SPL LOSS, REP'D STATION          
         DC    C'SPL$',AL1(09,79)              SPL $$ FROM SPL ELT              
         DC    C'SPLM',AL1(09,80)              SPL MKT $$ FROM SPL ELT          
         DC    C'SPLD',AL1(09,81)              GROSS SPL $$ (ORDER)             
         DC    C'SPLG',AL1(09,82)              GROSS SPL MKT $$                 
         DC    C'BUDP',AL1(09,83)              PRIOR YEAR BUDGET                
         DC    C'BUD2',AL1(09,84)              2YR PRIOR BUDGET                 
         DC    C'SP*C',AL1(09,85)              SPL AS-RUN CURRENT YEAR          
*                                                 BASE CARD DEVELOPMENT         
         DC    C'SP*P',AL1(09,86)              SPL AS-RUN PRIOR   YEAR          
*                                                 BASE CARD DEVELOPMENT         
         DC    C'SP*T',AL1(09,87)              SPL AS-RUN PRIOR   YEAR          
*                                                 BASE CARD DEVELOPMENT         
         DC    C'CONF',AL1(09,88)              BEST DOLLAR/CONFIRMED            
         DC    C'UNCF',AL1(09,89)              BEST DOLLAR/UNCONFIRMED          
         DC    C'DIRE',AL1(09,90)              UPCOMING DIRECT RESP             
         DC    C'THWC',AL1(09,91)              THIS WEEK/CONFIRMED              
         DC    C'-ACC',AL1(09,92)              PRIOR ACT/CONFIRMED              
         DC    C'NACT',AL1(09,93)              NEXT YEAR ACTUALS                
         DC    C'BKN ',AL1(09,94)              BOOKED:  NEXT YEAR               
         DC    C'BILN',AL1(09,95)              BILLING: NEXT YEAR               
         DC    C'THW2',AL1(09,96)              THIS WEEK 2YEAR PRIOR            
         DC    C'FPRT',AL1(09,97)              FORCE ROW PRIINT                 
*                                                                               
*   TRADE BUCKETS                                                               
*                                                                               
         DC    C'TEST',AL1(09,98)              TRADE CURR ESTIMATE              
         DC    C'TPES',AL1(09,99)              TRADE PRI  ESTIMATE              
         DC    C'TACT',AL1(09,100)             TRADE CURRENT ACTUAL             
         DC    C'TPAC',AL1(09,101)             TRADE PRIOR ACTUAL               
*                                                                               
         DC    C'TBKC',AL1(09,102)             TRADE CURR BOOKED                
         DC    C'TBKP',AL1(09,103)             TRADE PRIOR BOOKED               
         DC    C'TTHW',AL1(09,104)             TRADE THIS WEEK                  
         DC    C'TLSW',AL1(09,105)             TRADE LAST WEEK                  
*                                                                               
         DC    C'TBLC',AL1(09,106)             TRADE CURR BILLED                
         DC    C'TBLP',AL1(09,107)             TRADE PRIOR BILLED               
         DC    C'TBCN',AL1(09,108)             TRADE CURR BILL NO ASAT          
         DC    C'TBPN',AL1(09,109)             TRADE PRI  BILL NO ASAT          
*                                                                               
         DC    C'TCNF',AL1(09,110)             TRADE BEST $ CONFIRMED           
         DC    C'TUCF',AL1(09,111)             TRADE BEST $ UNCONFIRM           
         DC    C'TTWC',AL1(09,112)             TRADE THIS WEEK/CONF             
         DC    C'TAPC',AL1(09,113)             TRADE PRIOR ACT CONF             
*                                                                               
         DC    C'SPCR',AL1(09,114)             SPOTS:  CURRENT                  
         DC    C'SPPR',AL1(09,115)             SPOTS:  PRIOR                    
         DC    C'SP2P',AL1(09,116)             SPOTS:  2YRS PRIOR               
*                                                                               
         DC    C'TOT ',AL1(01,255)                                              
         DC    C'W00 ',AL1(01,00)                                               
         DC    C'W01 ',AL1(01,01)                                               
         DC    C'W02 ',AL1(01,02)                                               
         DC    C'W03 ',AL1(01,03)                                               
         DC    C'W04 ',AL1(01,04)                                               
         DC    C'W05 ',AL1(01,05)                                               
         DC    C'W06 ',AL1(01,06)                                               
         DC    C'W07 ',AL1(01,07)                                               
         DC    C'W08 ',AL1(01,08)                                               
         DC    C'W09 ',AL1(01,09)                                               
         DC    C'W10 ',AL1(01,10)                                               
         DC    C'W11 ',AL1(01,11)                                               
         DC    C'W12 ',AL1(01,12)                                               
         DC    C'W99 ',AL1(01,99)                                               
         DC    X'FF'                                                            
         EJECT                                                                  
         NMOD1 0,*ROWS*                                                         
ROWSPECS DS    0D                                                               
*                                                                               
*  SPECIFICATION DEFINITIONS:                                                   
*     CL   =  COLUMN LENGTH                                                     
*     NL   =  NAME LENGTH                                                       
*     DC   =  DATA CODE                                                         
*     LL   =  LINE LENGTH                                                       
*     LW   =  LINE WIDTH                                                        
*                                                                               
*                KEYWORD       CL NL DC LL LW                                   
*                                                                               
         DC    C'REP     ',AL1(02,33,01,03,03)                                  
         DC    C'REP                    '                                       
         DC    C'STATION ',AL1(07,20,02,07,07)                                  
         DC    C'STATION                '                                       
         DC    C'REGION  ',AL1(02,20,03,06,06)                                  
         DC    C'REGION                 '                                       
         DC    C'OFFICE  ',AL1(02,20,04,06,06)                                  
         DC    C'OFFICE                 '                                       
         DC    C'TEAM    ',AL1(02,10,05,04,04)                                  
         DC    C'TEAM                   '                                       
         DC    C'SP      ',AL1(03,20,06,11,11)                                  
         DC    C'SALESPERSON            '                                       
         DC    C'GROUP   ',AL1(02,21,07,05,05)                                  
         DC    C'GROUP                  '                                       
         DC    C'ADV     ',AL1(04,20,08,10,10)                                  
         DC    C'ADVERTISER             '                                       
         DC    C'PRODUCT ',AL1(03,20,09,07,07)                                  
         DC    C'PRODUCT                '                                       
         DC    C'AGY/OFFC',AL1(06,20,10,06,06)                                  
         DC    C'AGENCY                 '                                       
         DC    C'AGENCY  ',AL1(04,20,47,06,06)                                  
         DC    C'AGENCY                 '                                       
         DC    C'AFFIL   ',AL1(03,03,11,05,05)                                  
         DC    C'AFFIL                  '                                       
         DC    C'CONTRACT',AL1(04,08,12,08,08)                                  
         DC    C'CONTRACT               '                                       
         DC    C'CLASS   ',AL1(02,30,13,05,05)                                  
         DC    C'CLASS                  '                                       
         DC    C'OFFC    ',AL1(02,20,14,06,06)                                  
         DC    C'OFFICE                 '                                       
         DC    C'CTGY    ',AL1(02,30,15,08,08)                                  
         DC    C'CATEGORY               '                                       
         DC    C'RANK    ',AL1(04,05,16,04,04)                                  
         DC    C'RANK                   '                                       
         DC    C'MONTH   ',AL1(02,11,17,23,11)                                  
         DC    C'        P/C,PERIOD  WKS'                                       
         DC    C'CURMONTH',AL1(00,00,18,00,00)                                  
         DC    C'                       '                                       
         DC    C'ALLMONTH',AL1(00,00,19,00,00)                                  
         DC    C'                       '                                       
         DC    C'QTR     ',AL1(02,06,20,06,06)                                  
         DC    C'PERIOD                 '                                       
         DC    C'STNTYPE ',AL1(01,20,22,00,00)                                  
         DC    C'                       '                                       
         DC    C'TVB     ',AL1(02,18,23,05,05)                                  
         DC    C' TVB                   '                                       
         DC    C'OWNER   ',AL1(03,20,24,05,05)                                  
         DC    C'OWNER                  '                                       
         DC    C'GRGRP   ',AL1(01,10,25,05,05)                                  
         DC    C'GROUP                  '                                       
         DC    C'GRSUBGRP',AL1(02,10,26,08,08)                                  
         DC    C'SUBGROUP               '                                       
         DC    C'ADVNAME ',AL1(04,20,27,10,10)                                  
         DC    C'ADVERTISER             '                                       
         DC    C'AGYNAME ',AL1(06,20,28,06,06)                                  
         DC    C'AGENCY                 '                                       
         DC    C'SERVICE ',AL1(01,03,29,07,07)                                  
         DC    C'SERVICE                '                                       
         DC    C'MKTRANK ',AL1(01,01,30,05,05)                                  
         DC    C'RANK                   '                                       
         DC    C'AVLPACE ',AL1(1,16,31,0,0)                                     
         DC    C'                       '                                       
         DC    C'STAMKT  ',AL1(07,20,32,07,07)                                  
         DC    C'STATION                '                                       
         DC    C'CONTYPE ',AL1(02,20,33,13,13)                                  
         DC    C'CONTRACT TYPE          '                                       
         DC    C'PTPERSON',AL1(06,20,34,12,12)                                  
         DC    C'POINT PERSON           '                                       
         DC    C'NETCON  ',AL1(08,08,35,13,13)                                  
         DC    C'NTWK CONTRACT          '                                       
         DC    C'BOOK    ',AL1(06,06,36,04,06)                                  
         DC    C'BOOK                   '                                       
         DC    C'DAYPART ',AL1(03,03,37,07,07)                                  
         DC    C'DAYPART                '                                       
         DC    C'DEMO    ',AL1(07,07,38,04,07)                                  
         DC    C'DEMO                   '                                       
         DC    C'MARKET  ',AL1(04,20,39,06,06)                                  
         DC    C'MARKET                 '                                       
         DC    C'COMPANY ',AL1(02,20,40,07,07)                                  
         DC    C'COMPANY                '                                       
         DC    C'DAYPRTS ',AL1(06,00,41,07,07)                                  
         DC    C'DAYPARTS               '                                       
         DC    C'FLIGHT  ',AL1(17,00,42,17,17)                                  
         DC    C'FLIGHT                 '                                       
         DC    C'BUYER   ',AL1(01,20,43,11,11)                                  
         DC    C'BUYER                  '                                       
         DC    C'DEVSAL  ',AL1(03,20,44,13,13)                                  
         DC    C'DEV SLSPERSON          '                                       
         DC    C'DEVCONTY',AL1(01,20,45,13,13)                                  
         DC    C'DEV CONT TYPE          '                                       
         DC    C'EMPTYROW',AL1(01,20,46,13,13)                                  
         DC    C'EMPTY ROW              '                                       
         DC    C'BUYCODE ',AL1(07,20,48,07,07)                                  
         DC    C'BUYCODE                '                                       
         DC    C'BUYATTR1',AL1(02,20,49,07,07)                                  
         DC    C'ATTRIB1                '                                       
         DC    C'BUYATTR2',AL1(02,20,50,07,07)                                  
         DC    C'ATTRIB2                '                                       
         DC    C'COMPSP  ',AL1(06,20,51,08,08)                                  
         DC    C'COMP S/P               '                                       
         DC    C'CONENDTE',AL1(07,20,52,13,13)                                  
         DC    C'CONTRACT LEFT          '                                       
         DC    C'JOINDATE',AL1(08,20,53,09,09)                                  
         DC    C'JOIN DATE              '                                       
         DC    X'FF'                                                            
         SPACE 2                                                                
ONLROWS  DC    C'STATION ',AL1(02)                                              
         DC    C'REGION  ',AL1(03)                                              
         DC    C'OFFICE  ',AL1(04)                                              
         DC    C'TEAM    ',AL1(05)                                              
         DC    C'SP      ',AL1(06)                                              
         DC    C'GROUP   ',AL1(07)                                              
         DC    C'ADV     ',AL1(08)                                              
         DC    C'AGY/OFFC',AL1(10)                                              
         DC    C'AFFIL   ',AL1(11)                                              
         DC    C'CLASS   ',AL1(13)                                              
         DC    C'CTGY    ',AL1(15)                                              
         DC    C'STNTYPE ',AL1(22)                                              
         DC    C'TVB     ',AL1(23)                                              
         DC    C'OWNER   ',AL1(24)                                              
         DC    C'GRGRP   ',AL1(25)                                              
         DC    C'GRSUBGRP',AL1(26)                                              
         DC    C'MKTRANK ',AL1(30)                                              
         DC    C'CONTYPE ',AL1(33)                                              
         DC    C'MARKET  ',AL1(39)                                              
         DC    C'COMPANY ',AL1(40)                                              
         DC    C'DEVCONTY',AL1(45)                                              
         DC    C'AGENCY  ',AL1(47)                                              
         DC    X'FF'                                                            
         EJECT                                                                  
         NMOD1 0,*ROWS*                                                         
ERRMSGS  DS    0D                                                               
*                                                                               
*                         1         2         3         4                       
*                1.3.5.7.9.1.3.5.7.9.1.3.5.7.9.1.3.5.7.9.                       
ER2MSG   DC    C'COMMAND NOT RECOGNIZED                '                        
ER4MSG   DC    C'INVALID CONDITION CODE                '                        
ER6MSG   DC    C'OPTION NOT RECOGNIZED                 '                        
ER8MSG   DC    C'NOT NUMERIC                           '                        
ER9MSG   DC    C'ROW NUMBER TOO HIGH:  15 IS MAX       '                        
ER10MSG  DC    C'INVALID ROW SPEC                      '                        
ER11MSG  DC    C'STAGGER ON 1ST ROW INVALID            '                        
ER12MSG  DC    C'INVALID LINE CODE                     '                        
ER13MSG  DC    C'2ND STAGGER IN A ROW INVALID          '                        
ER14MSG  DC    C'KEYWORD NOT RECOGNIZED                '                        
ER15MSG  DC    C'HEAD/MID LINES MAY NOT BE STAGGERED   '                        
ER16MSG  DC    C'CHUNKS NEED 2 COLUMNS                 '                        
ER18MSG  DC    C'INVALID COLCOMP EXPRESSION            '                        
ER20MSG  DC    C'NOT THE NEXT REPORT NUMBER            '                        
ER22MSG  DC    C'SINGLE QUOTES MUST SURROUND LITERAL   '                        
ER24MSG  DC    C'INVALID COLUMN SPECIFICATION SEQUENCE '                        
ER26MSG  DC    C'INVALID ROWEQU OR COLEQU SPECIFICATION'                        
ER28MSG  DC    C'INVALID ROW SPECIFICATION SEQUENCE    '                        
ER30MSG  DC    C'FIRST CARD MUST BE PHASE COMMAND      '                        
ER32MSG  DC    C'TOTDEF MUST APPEAR BEFORE REPORT SPEC '                        
ER34MSG  DC    C'REPORT SPEC MUST APPEAR BEFORE THIS   '                        
ER36MSG  DC    C'ROW SPECS MUST PRECEDE COLUMN SPECS   '                        
ER38MSG  DC    C'RECAP SPEC MUST PRECEDE ROW SPECS     '                        
ER40MSG  DC    C'MAY NOT MIX INCLUDES AND EXCLUDES     '                        
ER42MSG  DC    C'LINE WIDTH XXX: EXCEEDS 132 CHARACTERS'                        
ER44MSG  DC    C'THIS ROW MAY NOT FOLLOW PREVIOUS ROW  '                        
ER46MSG  DC    C'RPTRIGHT WIDTH EXCEEDS 36 CHARACTERS  '                        
ER48MSG  DC    C'REQUIRED KEYWORD ABSENT               '                        
ER50MSG  DC    C'NOT NEXT ROW NUMBER                   '                        
ER52MSG  DC    C'NOT NEXT COLUMN NUMBER                '                        
ER54MSG  DC    C'UNDEFINED REPORT NUMBER               '                        
ER56MSG  DC    C'UNDEFINED ROW NUMBER                  '                        
ER58MSG  DC    C'UNDEFINED COLUMN NUMBER               '                        
ER60MSG  DC    C'UNRECOGNIZED ROW OPTION               '                        
ER62MSG  DC    C'UNRECOGNIZED RANK OPTION              '                        
ER64MSG  DC    C'IF SPEC MUST FOLLOW ROW SPECS         '                        
ER66MSG  DC    C'MAY NOT MIX IFS WITH NO IFS           '                        
ER68MSG  DC    C'ONLY ONE RANK SPEC ALLOWED WITH NO IF '                        
ER70MSG  DC    C'INVALID RPTRIGHT OPERAND              '                        
ER72MSG  DC    C'ONLY ONE MONEY SPEC PER REPORT        '                        
ER74MSG  DC    C'NEED EXACTLY TWO CHARACTERS           '                        
ER76MSG  DC    C'INVALID ONLINE ROW SPEC               '                        
ER78MSG  DC    C'INVALID OUTPUT PHASE NAME             '                        
ER80MSG  DC    C'TOO MANY SETS OF DIFFERENT COLUMNS    '                        
ER82MSG  DC    C'REQUIRES ROW SPEC FOR CONTRACT NUMBER '                        
ER83MSG  DC    C'PREVIOUS "COMMENT" NEEDS CONTRACT #   '                        
ER84MSG  DC    C'PARAM MUST BE "ALL/FORECAST/PENDING"  '                        
ER85MSG  DC    C'REQUIRES ROW SPEC FOR STATION/STAMKT  '                        
*                                                                               
         EJECT                                                                  
       ++INCLUDE DDDPRINT                                                       
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'187REPRRGENS 05/29/03'                                      
         END                                                                    
