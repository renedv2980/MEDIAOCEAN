*          DATA SET DDREQRFP   AT LEVEL 018 AS OF 06/15/20                      
*CATALP REQRFP                                                                  
REQRFP   TITLE '- FORMAT REQUEST DETAILS FOR RFP DISPLAY'                       
REQRFP   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 WORKX-WORKD,**RRFP**,RA,CLEAR=YES                                
                                                                                
         USING WORKD,RC            RC=A(LOCAL WORKING STORAGE)                  
         LR    R2,R1               R2=A(PARAMETER LIST)                         
         USING PLISTD,R2                                                        
         TM    PLINDS,PLINDRES     TEST RESOLVING SOFT DATES                    
         BZ    *+8                                                              
         NI    PLINDS,PLINDSPR+PLINDRES+PLINDRUN                                
                                                                                
         L     R8,PLAREQ                                                        
         USING RQHD,R8             R8=A(REQUEST CARDS)                          
         L     R9,PLACOM                                                        
         USING COMFACSD,R9         R9=A(COMFACS)                                
                                                                                
         LA    R1,SYSTAB                                                        
         USING SYSTABD,R1                                                       
REQ02    CLI   SYSTABD,SYSTEOTQ    TEST END OF TABLE                            
         BE    EXIT                                                             
         CLC   SYSTDATE,PLSYST     MATCH TO SYSTEM NUMBER                       
         BE    *+10                                                             
         CLC   SYSTLET,PLSYST      OR SYSTEM LETTER                             
         BE    *+12                                                             
         AHI   R1,SYSTABL          NO MATCH - BUMP TO NEXT TABLE ENTRY          
         B     REQ02                                                            
                                                                                
         MVC   SYSDATE,SYSTDATE    SET SYSTEM VALUES                            
         MVC   SYSDICT,SYSTDICT                                                 
         MVC   SYSLET,SYSTLET                                                   
         MVC   SYSLIT,SYSTLIT                                                   
         MVC   SYSWSCR,SYSTWSCR                                                 
         MVC   SYSWSFN,SYSTWSFN                                                 
         LA    RE,REQRFP                                                        
         SR    RF,RF                                                            
         ICM   RF,3,SYSTADIC       RESOLVE A(DICTIONARY LIST)                   
         AR    RF,RE                                                            
         ST    RF,ADICLST                                                       
         SR    RF,RF                                                            
         ICM   RF,3,SYSTAPRG       RESOLVE A(PROGRAM TABLE)                     
         BZ    *+6                                                              
         AR    RF,RE                                                            
         ST    RF,APRGTAB                                                       
         SR    RF,RF                                                            
         ICM   RF,3,SYSTAREQ       RESOLVE A(REQUEST TABLE)                     
         BZ    *+6                                                              
         AR    RF,RE                                                            
         ST    RF,AREQTAB                                                       
         SR    RF,RF               RESOLVE A(SYSTEM INITIALIZATION)             
         ICM   RF,3,SYSTAINI                                                    
         BZ    *+10                                                             
         AR    RF,RE                                                            
         ST    RF,ASYSINI                                                       
         SR    RF,RF               RESOLVE A(SYSTEM FILTER)                     
         ICM   RF,3,SYSTAFLT                                                    
         BZ    *+10                                                             
         AR    RF,RE                                                            
         ST    RF,ASYSFLT                                                       
         MVC   CNTLET,SYSTCHAR     EXTRACT REQUEST CONTINUATION VALUES          
         MVC   CNTTAB+0(1),SYSTCOL1                                             
         MVC   CNTTAB+1(1),SYSTCOL2                                             
         MVC   CNTTAB+2(L'CNTTAB-2),CNTTAB+1                                    
         DROP  R1                                                               
                                                                                
         TM    PLINDS,PLINDSPR+PLINDRES+PLINDRUN                                
         BNZ   REQ08                                                            
         LA    RF,KEYWORDS                                                      
         ST    RF,AKEYWRDS         POINT TO LOCAL LOOKUP-LIST                   
         LA    RF,SOFBUFF                                                       
         ST    RF,ASOFBUFF         POINT TO LOCAL OPTIMIZATION BUFFER           
                                                                                
         CLI   PLBINDS,PLBIABUF    TEST A(OPTIMIZATION BUFFER) PASSED           
         BNE   REQ04                                                            
         ICM   RF,7,PLABUF+1       RF=A(CALL'S OPTIMIZATION BUFFER)             
         MVC   LASTS,0(RF)         EXTRACT SAVED KEY                            
         AHI   RF,LASTSL                                                        
         ST    RF,AKEYWRDS         POINT TO CALLER STORAGE FOR LOOKUP           
         AHI   RF,KEYWORDL                                                      
         ST    RF,ASOFBUFF         POINT TO CALLER STORAGE FOR BUFFER           
                                                                                
         CLC   LASTSYSN,SYSDICT    TEST CHANGE OF KEY                           
         BNE   REQ04                                                            
         CLC   LASTLANG,PLLANG                                                  
         BNE   REQ04                                                            
         OC    0(L'KEYWORD,RF),0(RF)                                            
         BNZ   REQ08                                                            
                                                                                
REQ04    LA    R1,DMCB             GET REPORT LITERALS                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNL                                                   
         MVI   DDRETN,DDCASEL                                                   
         MVC   DDSYS,SYSDICT                                                    
         MVC   DDLANG,PLLANG                                                    
         MVC   DDIADR,ADICLST+1                                                 
         MVC   DDOADR,AKEYWRDS+1                                                
         GOTOR CDICTATE            RESOLVE DICTIONARY WORDS                     
         MVC   LASTSYSN,SYSDICT                                                 
         MVC   LASTLANG,PLLANG                                                  
         CLI   PLBINDS,PLBIABUF    TEST A(OPTIMIZATION BUFFER) PASSED           
         BNE   REQ08                                                            
         ICM   RF,7,PLABUF+1       SAVE LOOKUP KEY IN USER'S BUFFER             
         MVC   0(LASTSL,RF),LASTS                                               
                                                                                
REQ08    TM    PLINDS,PLINDRUN     EXIT IF RUNNER REQUEST                       
         BNZ   EXIT                                                             
                                                                                
         MVI   SPACES,SPACE                                                     
         MVC   SPACES+1(L'SPACES-1),SPACES                                      
                                                                                
         LA    R0,OUTPUT           CLEAR OUTPUT AREA TO SPACES                  
         LHI   R1,OUTPUTL                                                       
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE                                                            
                                                                                
         LHI   R0,L'FLDH+L'FLD     CREATE FIELD HEADER FOR SOFDAT CALLS         
         STC   R0,FLDH                                                          
                                                                                
         SR    RE,RE                                                            
         IC    RE,PLLANG                                                        
         SLL   RE,2                                                             
         LA    RE,CHRTAB(RE)                                                    
         MVC   CHARS,0(RE)         SET LANGUAGE BASED CHARACTERS                
                                                                                
         TM    PLINDS,PLINDSPR     TEST SPOOF REQUEST                           
         BNZ   REQ50                                                            
                                                                                
         LA    RE,CNTTAB           RE=DISPLACEMENTS TO CONTINUATION             
         LHI   R0,L'CNTTAB         R0=N'ENTRIES IN TABLE                        
         LHI   RF,1                RF=N'REQUEST CARDS                           
         LA    R3,RQHCARD                                                       
                                                                                
REQ10    SR    R1,R1                                                            
         ICM   R1,1,0(RE)          R1=DISPLACEMENT TO CONTINUE COLUMN           
         BZ    REQ12                                                            
         AR    R1,R3                                                            
         CLC   CNTLET,0(R1)        TEST CONINUATION SET                         
         BNE   REQ12                                                            
         AHI   RE,1                YES - BUMP TO NEXT TABLE ENTRY               
         AHI   R3,L'RQHCARD        AND TO NEXT REQUEST CARD                     
         AHI   RF,1                AND NUMBER OF REQUEST CARDS                  
         BCT   R0,REQ10                                                         
                                                                                
REQ12    STC   RF,NUMREQ           SET NUMBER OF REQUEST CARDS                  
         MHI   RF,L'RQHCARD                                                     
         STCM  RF,3,MAXDSP         AND MAXIMUM DISPLACEMENTS                    
                                                                                
         ICM   R3,15,APRGTAB       LOOK UP PROGRAM IN TABLE                     
         BZ    EXIT                                                             
         USING PRGTABD,R3          R3=A(PROGRAM TABLE)                          
REQ14    CLC   PRGTPRG,=Y(PRGTDEFQ)                                             
         BE    REQ16                                                            
         CLC   PRGTPRG,RQPROG      MATCH PROGRAM CODE                           
         BE    REQ16                                                            
         AHI   R3,PRGTABL          NO MATCH - BUMP TO NEXT TABLE ENTRY          
         B     REQ14                                                            
REQ16    MVC   PRGIND,PRGTIND      EXTRACT PROGRAM INDICATOR                    
         DROP  R3                                                               
                                                                                
         ICM   RF,15,ASYSINI       INITIALIZE FOR THIS SYSTEM                   
         BZ    REQ18                                                            
         BASR  RE,RF               CALL SYSTEM INITIALIZATION ROUTINE           
                                                                                
REQ18    L     R3,AREQTAB          R3=A(REQUEST FIELD TABLE)                    
         USING REQTABD,R3                                                       
         LA    R4,OUTPUT           R4=A(NEXT OUTPUT AREA)                       
         TM    PLINDS,PLINDTWA     TEST CREATING A SCREEN                       
         BZ    REQ20                                                            
         GOTOR BLDTWA              YES - BUILD SCREEN                           
         L     R4,PLAOUT           AND POINT TO FIRST OUTPUT HEADER             
                                                                                
REQ20    CLI   REQTABD,REQTEOTQ    TEST END OF TABLE                            
         BE    REQEXIT                                                          
                                                                                
         TM    PLINDS,PLINDRES     TEST RESOLVING SOFT DATES                    
         BZ    *+16                                                             
         TM    REQTIND1,REQTIDAT   YES - ONLY WANT DATE FIELDS                  
         BZ    REQ26                                                            
         B     REQ22                                                            
                                                                                
         TM    REQTIND1,REQTINOT+REQTITWA                                       
         BZ    REQ22                                                            
         TM    PLINDS,PLINDTWA     TEST TWA BUILDING                            
         BZ    *+16                                                             
         TM    REQTIND1,REQTITWA   TEST ONLY FOR TWA BUILD                      
         BZ    REQ26                                                            
         B     REQ22                                                            
         TM    REQTIND1,REQTITWA                                                
         BNZ   REQ26                                                            
                                                                                
REQ22    MVC   WORK(L'REQTDSP),REQTDSP                                          
         NI    WORK,ALLBITS-(REQTDWRK)                                          
         SR    RF,RF                                                            
         ICM   RF,3,WORK                                                        
         TM    REQTDSP,REQTDWRK    TEST SPECIAL DISPLACEMENT                    
         BZ    *+12                                                             
         LA    RF,WORKD(RF)        YES - INDEX INTO WORKD                       
         B     REQ24                                                            
         CLC   REQTDSP,MAXDSP      TEST CARD PRESENT                            
         BNL   REQ26                                                            
         LA    RF,RQHCARD(RF)      YES - POINT TO REQUEST DATA FIELD            
                                                                                
REQ24    SR    RE,RE                                                            
         IC    RE,REQTLEN                                                       
         BCTR  RE,0                                                             
         EX    RE,*+8              TEST FIELD IS SPACES                         
         BNE   REQ28                                                            
         CLC   0(0,RF),SPACES                                                   
                                                                                
REQ26    AHI   R3,REQTABL          BUMP TO NEXT REQTAB ENTRY                    
         B     REQ20                                                            
                                                                                
REQ28    TM    REQTIND1,REQTIPRG   TEST IF TO CHECK PRGIND FOR VALUE            
         BZ    *+14                                                             
         CLC   PRGIND,REQTIND2     YES - NEXT IF NO MATCH                       
         BNE   REQ26                                                            
                                                                                
         MVC   DATA,SPACES         EXTRACT DATA FROM REQUEST CARD               
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   DATA(0),0(RF)                                                    
         ST    RF,ADATA                                                         
                                                                                
         ICM   RF,15,ASYSFLT       APPLY ANY SYSTEM FILTERS                     
         BZ    *+10                                                             
         BASR  RE,RF                                                            
         BNE   REQ26                                                            
                                                                                
         SR    RE,RE                                                            
         ICM   RE,3,REQTNAM                                                     
         A     RE,AKEYWRDS                                                      
         MVC   KEYWORD,SPACES                                                   
         SR    RF,RF                                                            
         ICM   RF,1,REQTNAML       RF=L'KEYWORD                                 
         BZ    *+20                                                             
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   KEYWORD(0),0(RE)    EXTRACT KEYWORD FROM LIST                    
                                                                                
         SR    RE,RE                                                            
         IC    RE,REQTFRM          GO TO FORMAT ROUTINE                         
         SLL   RE,2                                                             
         B     *(RE)                                                            
                                                                                
         B     REQADDF             GENERAL ALPHA FIELD (XXX=YYY)                
         B     REQREPT             REPORT=ACNN                                  
         B     REQDATS             XXXX DATE=EXPRESSION                         
         B     REQULAC             UNIT/LEDGER/ACCOUNT=U(L(A))                  
         B     REQCAUL             CONTRA UNIT/LEDGER=XX                        
         B     REQSELS             SELECTIVE FIELD         (US SPECIAL)         
         B     REQTTYP             TRANSACTION TYPE FILTER (US SPECIAL)         
         B     REQBDAY             DUE DATE DAYS           (US SPECIAL)         
         B     REQSCRD             SCRIBE DATE FILTERS                          
         B     REQSCRO             SCRIBE OTHER FILTERS/OPTIONS                 
                                                                                
REQREPT  MVC   DATA+L'SYSLIT(L'SYSLIT),DATA                                     
         MVC   DATA(L'SYSLIT),SYSLIT                                            
         B     REQADDF                                                          
                                                                                
REQDATS  CLI   DATA,X'F0'          IS THIS A REAL DATE                          
         BNL   *+12                YES                                          
         TM    DATA,X'C0'          IS IT ALPHANUMERIC                           
         BO    REQADDF             YES - OUTPUT WHAT'S IN THE FIELD             
                                                                                
         LA    R1,SOFBLOCK                                                      
         USING SOFDATD,R1                                                       
         MVC   SOFITYPE,REQTIND3                                                
         MVC   SOFIINDS,REQTIND4                                                
         CLI   SOFITYPE,SOFITSD2   TEST YYMMDD                                  
         BNE   REQDATS2                                                         
         CLC   DATA+4(2),SPACES    YES - TEST YYMM ONLY                         
         BNE   REQDATS2                                                         
         MVI   SOFITYPE,SOFITSD1   YES - SET PROPER INPUT TYPE                  
                                                                                
REQDATS2 MVI   SOFOTYPE,SOFOTPRT+SOFOTMIX                                       
         LA    R0,DATA                                                          
         ST    R0,SOFAINP                                                       
         LA    R0,FLDH                                                          
         ST    R0,SOFAOUT                                                       
         MVC   SOFACOM,PLACOM                                                   
         MVC   SOFLANG,PLLANG                                                   
         MVC   SOFSYSN,SYSDATE                                                  
         MVC   SOFABUFF,ASOFBUFF                                                
         TM    PLINDS,PLINDRES     TEST RESOLVING SOFT DATES                    
         BZ    REQDATS4                                                         
         CLI   DATA,DD#ESCL2       TEST FOR RFP ESCAPE SEQUENCE                 
         BL    *+12                                                             
         CLI   DATA,DD#ESUS                                                     
         BNH   REQ26                                                            
         MVC   SOFOTYPE,SOFITYPE                                                
         MVC   SOFAINP,ADATA                                                    
         XC    SOFAOUT,SOFAOUT                                                  
         ICM   RE,15,PLARUN                                                     
         BNZ   *+6                                                              
         DC    H'0'                                                             
         MVC   SOFTODAY,0(RE)                                                   
                                                                                
REQDATS4 OI    SOFITYPE,SOFITXTN                                                
         GOTOR CSOFDAT                                                          
         TM    PLINDS,PLINDRES     TEST RESOLVING SOFT DATES                    
         BNZ   REQ26                                                            
         MVC   DATA,FLD                                                         
         B     REQADDF                                                          
         DROP  R1                                                               
                                                                                
ULA      USING ACQD,RQHCARD                                                     
REQULAC  CLI   ULA.ACQLDG,SPACE    UNIT/LEDGER/ACCOUNT                          
         BE    REQADDF                                                          
         MVC   KEYWORD,SPACES                                                   
         LHI   RE,AC@LGR-KEYWORDS                                               
         A     RE,AKEYWRDS                                                      
         MVC   KEYWORD(L'AC@LGR),0(RE)                                          
         CLI   ULA.ACQACT,SPACE                                                 
         BE    REQADDF                                                          
         MVC   KEYWORD,SPACES                                                   
         LHI   RE,AC@ACC-KEYWORDS                                               
         A     RE,AKEYWRDS                                                      
         MVC   KEYWORD(L'AC@ACC),0(RE)                                          
         B     REQADDF                                                          
         DROP  ULA                                                              
                                                                                
REQCAUL  CLC   ACCLFLIT,DATA       CONTRA UNIT/LEDGER FILTER                    
         BNE   REQ26                                                            
         MVC   DATA(L'DATA-L'ACCLFLIT),DATA+L'ACCLFLIT                          
         MVC   DATA+L'DATA-L'ACCLFLIT(L'ACCLFLIT),SPACES                        
         B     REQADDF                                                          
                                                                                
REQSELS  CLC   ACTYPLIT,DATA       SELECTIVE FIELD         (US SPECIAL)         
         BE    REQ26                                                            
         B     REQADDF                                                          
                                                                                
REQTTYP  CLC   ACTYPLIT,DATA       TRANSACTION TYPE FILTER (US SPECIAL)         
         BNE   REQ26                                                            
         MVC   DATA(L'DATA-L'ACTYPLIT),DATA+L'ACTYPLIT                          
         MVC   DATA+L'DATA-L'ACTYPLIT(L'ACTYPLIT),SPACES                        
         CLI   DATA,C'E'                                                        
         BNE   REQADDF                                                          
         MVC   DATA(L'DATA-1),DATA+1                                            
         MVC   DATA+L'DATA-1(1),SPACES                                          
         B     REQADDF                                                          
                                                                                
REQBDAY  TM    DATA,ALLBITS        DUE DATE DAYS                                
         BNM   REQ26                                                            
         SR    R0,R0                                                            
         IC    R0,DATA                                                          
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,DIGIT                                                
         UNPK  DATA(2),DUB                                                      
         B     REQADDF                                                          
                                                                                
REQSCRD  MVC   WORK(L'DATA),DATA   HANDLE SCRIBE DATE FILTERS                   
DAT      USING ACQTYP1,WORK                                                     
         CLI   DAT.ACQTYP1,ACQDATE TEST THIS IS A DATE                          
         BNE   REQ26                                                            
         SR    R5,R5               LOOK UP DATE TYPE IN TABLE                   
         ICM   R5,3,REQTNAM                                                     
         LA    R5,REQRFP(R5)                                                    
         USING ACDTABD,R5                                                       
REQSCRD2 CLI   ACDTTYP,ACDTEOTQ    TEST END OF TABLE                            
         BE    REQ26                                                            
         CLC   ACDTTYP,DAT.ACQDTTYP MATCH TYPE TO REQUEST                       
         BE    *+12                                                             
         AHI   R5,ACDTABL          BUMP TO NEXT TABLE ENTRY                     
         B     REQSCRD2                                                         
                                                                                
         SR    RE,RE               EXTRACT START DATE KEYWORD                   
         ICM   RE,3,ACDTNAM1                                                    
         A     RE,AKEYWRDS                                                      
         SR    RF,RF                                                            
         IC    RF,ACDTLEN1                                                      
         BCTR  RF,0                                                             
         MVC   KEYWORD,SPACES                                                   
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   KEYWORD(0),0(RE)                                                 
                                                                                
         LA    R1,SOFBLOCK                                                      
         USING SOFDATD,R1          INTIALISE SOFDAT CONTROL BLOCK               
         XC    SOFDATD(SOFXTNL),SOFDATD                                         
         MVC   SOFACOM,PLACOM                                                   
         MVC   SOFLANG,PLLANG                                                   
         MVC   SOFSYSN,SYSDATE                                                  
         MVI   SOFIINDS,SOFIIONE                                                
                                                                                
         MVI   SOFITYPE,SOFITSD2   HANDLE START DATE                            
         CLC   DAT.ACQDTSTR+4(2),SPACES                                         
         BNE   *+8                                                              
         MVI   SOFITYPE,SOFITSD1                                                
         MVI   SOFOTYPE,SOFOTPRT+SOFOTMIX                                       
         LA    R0,DAT.ACQDTSTR                                                  
         ST    R0,SOFAINP                                                       
         LA    R0,FLDH                                                          
         ST    R0,SOFAOUT                                                       
                                                                                
         CLC   DAT.ACQDTSTR,SPACES                                              
         BE    REQSCRD6                                                         
         MVC   SOFABUFF,ASOFBUFF                                                
         TM    PLINDS,PLINDRES     TEST RESOLVING SOFT DATES                    
         BZ    REQSCRD4                                                         
         L     RF,ADATA                                                         
         LA    RF,ACQDTSTR-ACQDTTYP(RF)                                         
         CLI   0(RF),DD#ESCL2      TEST FOR RFP ESCAPE SEQUENCE                 
         BL    *+12                                                             
         CLI   0(RF),DD#ESUS                                                    
         BNH   REQSCRD6                                                         
         ST    RF,SOFAINP                                                       
         MVC   SOFOTYPE,SOFITYPE                                                
         XC    SOFAOUT,SOFAOUT                                                  
         ICM   RE,15,PLARUN                                                     
         BNZ   *+6                                                              
         DC    H'0'                                                             
         MVC   SOFTODAY,0(RE)                                                   
                                                                                
REQSCRD4 OI    SOFITYPE,SOFITXTN                                                
         GOTOR CSOFDAT                                                          
         TM    PLINDS,PLINDRES     TEST RESOLVING SOFT DATES                    
         BNZ   REQSCRD6                                                         
         MVC   DATA,FLD                                                         
         GOTOR ADDOUT              ADD START DATE TO OUTPUT                     
                                                                                
REQSCRD6 CLC   DAT.ACQDTEND,SPACES HANDLE END DATE                              
         BE    REQ26                                                            
         SR    RE,RE               EXTRACT END DATE KEYWORD                     
         ICM   RE,3,ACDTNAM2       ZERO MEANS NO END DATE                       
         BZ    REQ26                                                            
         A     RE,AKEYWRDS                                                      
         SR    RF,RF                                                            
         IC    RF,ACDTLEN2                                                      
         BCTR  RF,0                                                             
         MVC   KEYWORD,SPACES                                                   
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   KEYWORD(0),0(RE)                                                 
         LA    R1,SOFBLOCK                                                      
         MVI   SOFITYPE,SOFITSD2                                                
         CLC   DAT.ACQDTEND+4(2),SPACES                                         
         BNE   *+8                                                              
         MVI   SOFITYPE,SOFITSD1                                                
         MVI   SOFOTYPE,SOFOTPRT+SOFOTMIX                                       
         LA    R0,DAT.ACQDTEND                                                  
         ST    R0,SOFAINP                                                       
         MVC   SOFABUFF,ASOFBUFF                                                
         TM    PLINDS,PLINDRES     TEST RESOLVING SOFT DATES                    
         BZ    REQSCRD8                                                         
         L     RF,ADATA                                                         
         LA    RF,ACQDTEND-ACQDTTYP(RF)                                         
         CLI   0(RF),DD#ESCL2      TEST FOR RFP ESCAPE SEQUENCE                 
         BL    *+12                                                             
         CLI   0(RF),DD#ESUS                                                    
         BNH   REQ26                                                            
         MVC   SOFOTYPE,SOFITYPE                                                
         ST    RF,SOFAINP                                                       
         XC    SOFAOUT,SOFAOUT                                                  
         ICM   RE,15,PLARUN                                                     
         BNZ   *+6                                                              
         DC    H'0'                                                             
         MVC   SOFTODAY,0(RE)                                                   
                                                                                
REQSCRD8 OI    SOFITYPE,SOFITXTN                                                
         GOTOR CSOFDAT                                                          
         TM    PLINDS,PLINDRES     TEST RESOLVING SOFT DATES                    
         BNZ   REQ26                                                            
         MVC   DATA,FLD                                                         
         GOTOR ADDOUT              ADD END DATE TO OUTPUT                       
         B     REQ26                                                            
         DROP  DAT,R1,R5                                                        
                                                                                
REQSCRO  MVC   WORK(L'DATA),DATA   HANDLE SCRIBE OTHER FILTERS                  
OTH      USING ACQTYP1,WORK                                                     
         CLI   OTH.ACQTYP1,ACQDATE TEST THIS IS A DATE                          
         BNE   REQ26                                                            
         SR    R5,R5               LOOK UP DATA TYPE IN TABLE                   
         ICM   R5,3,REQTNAM                                                     
         LA    R5,REQRFP(R5)                                                    
         USING ACOTABD,R5                                                       
REQSCRO2 CLI   ACOTTYP,ACOTEOTQ    TEST END OF TABLE                            
         BE    REQ26                                                            
         CLC   ACOTTYP,OTH.ACQTYP1 MATCH TYPE TO REQUEST                        
         BE    *+12                                                             
         AHI   R5,ACOTABL          BUMP TO NEXT TABLE ENTRY                     
         B     REQSCRO2                                                         
                                                                                
         SR    RE,RE               EXTRACT START DATE KEYWORD                   
         ICM   RE,3,ACOTNAM                                                     
         A     RE,AKEYWRDS                                                      
         SR    RF,RF                                                            
         IC    RF,ACOTLEN                                                       
         BCTR  RF,0                                                             
         MVC   KEYWORD,SPACES                                                   
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   KEYWORD(0),0(RE)                                                 
         MVC   DATA(L'DATA-L'ACQTYP1),DATA+L'ACQTYP1                            
         MVC   DATA+L'DATA-L'ACQTYP1(L'ACQTYP1),SPACES                          
         B     REQADDF                                                          
         DROP  OTH,R5                                                           
         EJECT                                                                  
***********************************************************************         
* ADD KEYWORD AND DATA TO OUTPUT STRING                               *         
* NTRY - KEYWORD=DATA KEYWORD                                         *         
*        DATA=DATA VALUE (1ST BYTE X'40' OFF INDICATES 'ALL EXCEPT')  *         
*        R4=A(NEXT OUTPUT AREA)                                       *         
***********************************************************************         
                                                                                
REQADDF  GOTOR ADDOUT                                                           
         B     REQ26                                                            
                                                                                
ADDOUT   TM    PLINDS,PLINDTWA     TEST CREATING A SCREEN                       
         BNZ   ADDOUT2                                                          
         MVC   0(L'KEYWORD,R4),KEYWORD                                          
         AHI   R4,L'KEYWORD-1                                                   
         CLI   0(R4),SPACE                                                      
         BH    *+8                                                              
         BCT   R4,*-8                                                           
         MVC   1(L'EQUAL,R4),EQUAL                                              
         TM    DATA,SPACE          TEST 'ALL EXCEPT'                            
         BNZ   *+16                                                             
         OI    DATA,SPACE                                                       
         MVI   1+L'EQUAL(R4),ALLXCEPT                                           
         AHI   R4,1                                                             
         MVC   1+L'EQUAL(L'DATA,R4),DATA                                        
         AHI   R4,1+L'EQUAL+L'DATA-1                                            
         CLI   0(R4),SPACE                                                      
         BH    *+8                                                              
         BCT   R4,*-8                                                           
         MVC   1(L'COMMA,R4),COMMA                                              
         AHI   R4,1+L'COMMA                                                     
         BR    RE                                                               
                                                                                
         USING FLDHDRD,R4                                                       
ADDOUT2  SR    R1,R1               BUMP N'TWA LINES USED                        
         IC    R1,ULINES                                                        
         AHI   R1,1                                                             
         CLM   R1,1,NLINES         TEST END OF TWA                              
         BNH   ADDOUT4                                                          
         TM    INDS,INDSRGHT       HAVE I USED RHS COLUMN                       
         BNZR  RE                  YES - ALL USED                               
         OI    INDS,INDSRGHT                                                    
         L     R4,PLAOUT           POINT TO RHS COLUMN                          
         AHI   R4,TLEN                                                          
         MVI   ULINES,0            RESET N'LINES USED                           
         B     ADDOUT2             AND FILL RHS SIDE OF SCREEN                  
                                                                                
ADDOUT4  STC   R1,ULINES           SET N'LINES USED SO FAR                      
         MVC   FLDDATA(L'KEYWORD),KEYWORD                                       
         AHI   R4,KLEN                                                          
         MVC   FLDDATA(L'DATA),DATA                                             
         TM    DATA,SPACE          TEST 'ALL EXCEPT'                            
         BNZ   ADDOUT6                                                          
         MVI   FLDDATA,ALLXCEPT                                                 
         MVC   FLDDATA+1(L'DATA-1),DATA                                         
         OI    FLDDATA+1,SPACE                                                  
                                                                                
ADDOUT6  AHI   R4,DLEN+TLEN        BUMP TO NEXT LHS/RHS COLUMN                  
         BR    RE                                                               
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* HANDLE SPOOF REQUESTS                                               *         
***********************************************************************         
                                                                                
REQ50    TM    PLINDS,PLINDTWA     TEST CREATING A TWA                          
         BZ    *+12                                                             
         GOTOR BLDTWA                                                           
         BNE   EXIT                                                             
                                                                                
         LA    R7,RQHCARD          R7=A(FIRST REQUEST CARD)                     
         LA    R4,OUTPUT           R4=A(OUTPUT STRING)                          
         LHI   R0,MAXREQS          R0=MAXIMUM N'REQUEST CARDS                   
                                                                                
REQ52    LA    R3,SPRDISP(R7)      START OF SPOOF DATA IN REQUEST CARD          
         LHI   R6,L'RQHCARD-SPRDISP                                             
                                                                                
REQ54    XC    WORK(2),WORK                                                     
         MVZ   WORK(2),2(R3)                                                    
         CLC   WORK(2),=C'00'      DONE IF LENGTH NOT NUMERIC                   
         BNE   REQ64                                                            
                                                                                
         PACK  DUB,2(2,R3)         FIELD LENGTH                                 
         CVB   R5,DUB                                                           
         BCTR  R5,0                DECREMENT FOR EXECUTE                        
         CLC   =C'02',0(R3)        PRINT RECORD FIELD FROM SCREEN               
         BE    REQ56                                                            
         CLI   0(R3),C'0'          TEST FIELD NUMBER PRESENT                    
         BL    REQ56                                                            
         CLI   1(R3),C'0'          TEST FIELD INDEX PRESENT                     
         BL    REQ56                                                            
         CLC   =C'09',0(R3)        ELSE SKIP REST OF HEADER FIELDS              
         BH    REQ62                                                            
                                                                                
REQ56    CLC   SAVFLDID,0(R3)      IF SAME FIELD AS LAST TIME                   
         BNE   *+6                                                              
         BCTR  R4,0                BACK UP A BYTE                               
         MVC   SAVFLDID,0(R3)      SAVE FIELD ID                                
         EX    R5,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),4(R3)       MOVE OUT THE DATA                            
                                                                                
         CLI   0(R4),DD#ESCL2      TEST FOR RFP ESCAPE SEQUENCE                 
         BL    REQ60                                                            
         CLI   0(R4),DD#ESUS                                                    
         BH    REQ60                                                            
         MVC   WORK,SPACES                                                      
         MVI   WORK,DD#ESCL                                                     
         MVC   WORK+1(2),1(R4)                                                  
         LA    RF,1(R5)                                                         
         STC   RF,WORK+3                                                        
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNS      ISSUE SINGLE UPPER TRANSLATE                 
         MVI   DDRETN,DDCASEU                                                   
         MVC   DDSYS,SYSDATE                                                    
         MVC   DDLANG,PLLANG                                                    
         LA    RF,WORK                                                          
         STCM  RF,7,DDIADR                                                      
         STCM  RF,7,DDOADR                                                      
         GOTOR CDICTATE            RESOLVE RFP SYMBOL                           
         EX    R5,*+8                                                           
         B     REQ60                                                            
         MVC   0(0,R4),WORK                                                     
                                                                                
REQ60    LA    R4,0(R5,R4)         POINT TO END OF STRING                       
         CLI   0(R4),SPACE                                                      
         BH    *+8                                                              
         BCT   R4,*-8                                                           
         AHI   R4,1                POINT TO NEXT OUTPUT CHARACTER               
         MVC   0(1,R4),SLASH                                                    
         AHI   R4,1                                                             
                                                                                
REQ62    LA    R3,5(R5,R3)         BUMP PAST SPOOF FIELD                        
         CLI   0(R3),C'*'          TEST END OF INPUT                            
         BE    REQ66                                                            
                                                                                
         AHI   R3,1                BUMP TO NEXT DATA COLUMN                     
         SR    R6,R5               DECREMENT REQUEST CARD SPACE CTR             
         SHI   R6,6                FIELD ID AND LENGTH                          
         CHI   R6,4                                                             
         BH    REQ54                                                            
                                                                                
REQ64    AHI   R7,L'RQHCARD        BUMP TO NEXT REQUEST CARD                    
         BCT   R0,REQ52                                                         
                                                                                
REQ66    TM    PLINDS,PLINDTWA     TEST CREATING A TWA                          
         BNZ   REQ68                                                            
         MVC   COMMA,SLASH         LOOK FOR SLASHES                             
         B     REQEXIT                                                          
                                                                                
REQ68    L     R4,PLAOUT                                                        
         USING FLDHDRD,R4                                                       
         LA    RF,OUTPUT                                                        
REQ70    CLI   FLDLEN,0            TEST END OF SCREEN                           
         BE    EXIT                                                             
         LA    RE,SPRLINEL-1(RF)                                                
         CLC   0(L'SLASH,RE),SLASH LOCATE SLASH AT END OF INPUT STRING          
         BE    *+8                                                              
         BCT   RE,*-10                                                          
         SR    RE,RF                                                            
         SHI   RE,L'SLASH                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   FLDDATA(0),0(RF)                                                 
         AHI   R4,FLDHDRL+SPRLINEL                                              
         LA    RF,1+L'SLASH(RE,RF)                                              
         CLI   0(RF),SPACE                                                      
         BNE   REQ70                                                            
         B     EXIT                                                             
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* MOVE OUTPUT STRING TO CALLER'S INPUT AREA                           *         
***********************************************************************         
                                                                                
REQEXIT  TM    PLINDS,PLINDTWA+PLINDRES                                         
         BNZ   EXIT                                                             
                                                                                
         LHI   R3,L'RQHCARD-2      ASSUME 78 BYTE WIDTH                         
         CLI   PLWOUT,0                                                         
         BE    *+8                                                              
         IC    R3,PLWOUT           UNLESS OVERRIDDEN BY CALLER                  
                                                                                
         LA    RF,OUTPUT                                                        
         ST    RF,PLAOUT           RETURN A(OUTPUT) TO CALLER                   
         CLI   PLNOUT,0                                                         
         BE    EXIT                                                             
                                                                                
         LA    R0,RQHCARD          RETURN STRING IN CALLER'S AREA               
         LHI   R1,RQRL                                                          
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE                                                            
                                                                                
         LA    RF,OUTPUT                                                        
         LA    R1,RQHCARD          R1=OUTPUT AREA                               
         SR    R0,R0                                                            
         IC    R0,PLNOUT           R0=MAXIMUM N'OUTPUT LINES                    
                                                                                
REQEXIT2 LA    RE,0(R3,RF)                                                      
         CLC   0(L'COMMA,RE),COMMA LOCATE COMMA AT END OF INPUT STRING          
         BE    *+8                                                              
         BCT   RE,*-10                                                          
         SR    RE,RF                                                            
         SHI   RE,L'COMMA                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),0(RF)                                                    
         AHI   R1,L'RQHCARD                                                     
         LA    RF,1+L'COMMA(RE,RF)                                              
         CLI   0(RF),SPACE                                                      
         BE    EXIT                                                             
         BCT   R0,REQEXIT2                                                      
         B     EXIT                                                             
                                                                                
EXIT     XIT1  ,                                                                
         EJECT                                                                  
***********************************************************************         
* BUILD SCREEN FIELDS FOR TWA OUTPUT OPTION                           *         
***********************************************************************         
                                                                                
BLDTWA   NTR1  ,                                                                
         LM    RE,RF,PLAOUT        RE=A(1ST FIELD HDR), RF=A(TWA)               
         LA    RE,0(RE)            CLEAR HOB                                    
         AHI   RF,64                                                            
         USING FLDHDRD,RF          RF=A(FIRST TWA FIELD HEADER)                 
         SR    R0,R0                                                            
         SR    R1,R1                                                            
BLDTWA02 AR    RF,R0               BUMP TO NEXT TWA FIELD                       
         CR    RF,RE                                                            
         BNH   *+6                                                              
         DC    H'0'                                                             
         BE    BLDTWA04                                                         
         OI    FLDOIND,FOUTTRN                                                  
         LR    R1,RF               SAVE A(LAST TWA FIELD)                       
         IC    R0,FLDLEN           LENGTH TO NEXT TWA FIELD                     
         B     BLDTWA02                                                         
                                                                                
BLDTWA04 LTR   RF,R1               CAN'T BUILD FROM START OF TWA                
         BNZ   *+6                                                              
         DC    H'0'                                                             
                                                                                
         SR    R1,R1                                                            
         ICM   R1,3,FLDADR                                                      
         SR    R0,R0                                                            
         D     R0,=A(COLS)                                                      
         AHI   R1,3                LEAVE ONE LINE GAP                           
         LR    RE,R1               SET NEXT LINE NUMBER                         
         BCTR  RE,0                                                             
         MHI   RE,COLS             RE=ABSOLUTE ADDRESS OF START OF LINE         
         L     RF,PLAOUT           RF=A(WHERE TO BUILD SCREEN)                  
         LA    RF,0(RF)                                                         
         LA    R0,MAXTWA(RF)                                                    
         ST    R0,DUB              SAVE A(END OF TWA)                           
                                                                                
BLDTWA06 TM    PLINDS,PLINDSPR     TEST SPOOF REQUEST                           
         BNZ   BLDTWA08                                                         
                                                                                
         XC    FLDHDRD(FLDHDRL),FLDHDRD                                         
         MVI   FLDLEN,KLEN                                                      
         MVI   FLDATB,FATBPROT+FATBLC+FATBHIGH                                  
         LA    R0,KEYCOL1(RE)                                                   
         STCM  R0,3,FLDADR                                                      
         MVI   FLDOIND,FOUTTRN                                                  
         MVC   FLDDATA(L'KEYWORD),SPACES                                        
         AHI   RF,KLEN                                                          
                                                                                
         XC    FLDHDRD(FLDHDRL),FLDHDRD                                         
         MVI   FLDLEN,DLEN                                                      
         MVI   FLDATB,FATBPROT+FATBLC                                           
         LA    R0,DATCOL1(RE)                                                   
         STCM  R0,3,FLDADR                                                      
         MVI   FLDOIND,FOUTTRN                                                  
         MVC   FLDDATA(L'DATA),SPACES                                           
         AHI   RF,DLEN                                                          
                                                                                
         XC    FLDHDRD(FLDHDRL),FLDHDRD                                         
         MVI   FLDLEN,KLEN                                                      
         MVI   FLDATB,FATBPROT+FATBLC+FATBHIGH                                  
         LA    R0,KEYCOL2(RE)                                                   
         STCM  R0,3,FLDADR                                                      
         MVI   FLDOIND,FOUTTRN                                                  
         MVC   FLDDATA(L'KEYWORD),SPACES                                        
         AHI   RF,KLEN                                                          
                                                                                
         XC    FLDHDRD(FLDHDRL),FLDHDRD                                         
         MVI   FLDLEN,DLEN                                                      
         MVI   FLDATB,FATBPROT+FATBLC                                           
         LA    R0,DATCOL2(RE)                                                   
         STCM  R0,3,FLDADR                                                      
         MVI   FLDOIND,FOUTTRN                                                  
         MVC   FLDDATA(L'DATA),SPACES                                           
         AHI   RF,DLEN                                                          
         B     BLDTWA18                                                         
                                                                                
BLDTWA08 STM   RE,RF,SAVEREGS                                                   
                                                                                
         CLC   =C'00',RQHCARD+12   TEST SCREEN PRESENT ON REQUEST CARD          
         BNE   BLDTWA12                                                         
         MVC   WORK(5),RQHCARD+17  EXTRACT SPPOO                                
         LA    R1,WORK+4                                                        
         LHI   R0,5                                                             
         SR    RE,RE                                                            
         SR    RF,RF                                                            
BLDTWA10 MVC   BYTE,0(R1)                                                       
         NI    BYTE,X'0F'                                                       
         IC    RE,BYTE                                                          
         TM    0(R1),X'F0'                                                      
         BO    *+8                                                              
         AHI   RE,9                                                             
         SRDL  RE,4                                                             
         BCTR  R1,0                                                             
         BCT   R0,BLDTWA10                                                      
         SRL   RF,4                                                             
         STCM  RF,14,SYSWSCR                                                    
BLDTWA12 OC    SYSWSCR,SYSWSCR     TEST WRITER SCREEN RESOLVED                  
         BZ    BLDTWA16                                                         
         XC    DMCB(16),DMCB                                                    
         MVC   DMCB+1(3),SAVEREGS+5                                             
         MVI   DMCB+4,C'R'                                                      
         MVC   DMCB+5(L'SYSWSCR),SYSWSCR                                        
         GOTOR CCALLOV,DMCB                                                     
         CLI   4(R1),ALLBITS       IF SCREEN LOADED GO AND FILL IT              
         BNE   *+14                                                             
         XC    SYSWSCR,SYSWSCR     TRY ONLY ONCE                                
         B     BLDTWA16                                                         
                                                                                
         XC    DMCB(16),DMCB       LOAD FF SCREEN INTO W/S                      
         MVI   DMCB+4,C'R'                                                      
         MVC   DMCB+5(2),SYSWSCR                                                
         MVI   DMCB+7,X'FF'                                                     
         GOTOR (RF),(R1),FFSCREEN                                               
         CLI   4(R1),ALLBITS       IF SCREEN LOADED GO AND FILL IT              
         BNE   *+6                                                              
         DC    H'0'                                                             
                                                                                
         LA    RF,PHSTAB           LOOK UP ENTRY IN PHASE TABLE                 
         USING PHSTABD,RF                                                       
         LHI   R0,PHSTABN                                                       
         BASR  RE,0                                                             
         CLC   PHSTPN,SYSWSCR      MATCH PHASE NUMBER                           
         BE    *+14                                                             
         AHI   RF,PHSTABL                                                       
         BCTR  R0,RE                                                            
         B     BLDTWA14                                                         
         MVC   SYSWSFN,PHSTFN      SET FIRST FIELD NUMBER                       
         MVC   SYSWSF#,PHSTF#      SET N'FIELD TO PROCESS ON FF                 
                                                                                
BLDTWA14 GOTOR RESFLD              RESOLVE FF SCREEN FIELD NUMBERS              
         B     BLDTWA22                                                         
                                                                                
BLDTWA16 LM    RE,RF,SAVEREGS                                                   
         USING FLDHDRD,RF          RF=A(FIRST TWA FIELD HEADER)                 
         XC    FLDHDRD(FLDHDRL),FLDHDRD                                         
         MVI   FLDLEN,FLDHDRL+SPRLINEL                                          
         MVI   FLDATB,FATBPROT+FATBLC                                           
         LA    R0,SPRCOL1(RE)                                                   
         STCM  R0,3,FLDADR                                                      
         MVI   FLDOIND,FOUTTRN                                                  
         MVC   FLDDATA(SPRLINEL),SPACES                                         
         AHI   RF,FLDHDRL+SPRLINEL                                              
                                                                                
BLDTWA18 SR    R0,R0               INCREMENT N'LINES USED                       
         IC    R0,NLINES                                                        
         AHI   R0,1                                                             
         STC   R0,NLINES                                                        
                                                                                
         C     RF,DUB              TEST TWA SIZE EXCEEDED                       
         BNL   BLDTWA20                                                         
         AHI   RE,COLS             BUMP ABSOLUTE ADDRESS                        
         AHI   R1,1                BUMP LINE NUMBER                             
         CHI   R1,MAXROWS                                                       
         BNH   BLDTWA06                                                         
                                                                                
BLDTWA20 MVI   0(RF),0             SET END OF TWA                               
         MVI   1(RF),1                                                          
         MVI   2(RF),1                                                          
         CLI   *+1,0               SET CC=EQUAL TO CARRY ON FILLING             
         B     EXIT                                                             
         DROP  RF                                                               
                                                                                
BLDTWA22 LA    R7,RQHCARD          A(REQUEST CARD)                              
         ST    R7,ACARD            SAVE A(CURRENT REQUEST CARD)                 
         MVC   CARD,0(R7)          EXTRACT FIRST REQUEST CARD                   
         MVC   CARDSPAC,SPACES     SET SPACES AT END                            
         LA    R7,CARD+12          POINT TO FIRST FIELD ON CARD                 
                                                                                
BLDTWA24 TM    1(R7),X'F0'                                                      
         BO    BLDTWA26                                                         
         MVC   THISFLD,0(R7)                                                    
         CLI   THISFLD,0                                                        
         BNE   *+8                                                              
         MVI   THISFLD,64                                                       
         SR    R1,R1                                                            
         IC    R1,THISFLD                                                       
         LA    R1,FFFIELDS(R1)                                                  
         SR    R0,R0                                                            
         IC    R0,0(R1)                                                         
         SR    R1,R1                                                            
         IC    R1,1(R7)                                                         
         SR    R1,R0                                                            
         STC   R1,THISNDX                                                       
         B     BLDTWA28                                                         
                                                                                
BLDTWA26 PACK  DUB,0(2,R7)                                                      
         CVB   R0,DUB                                                           
         STC   R0,THISFLD                                                       
         MVI   THISNDX,0                                                        
                                                                                
BLDTWA28 L     R3,PLAOUT           R3=A(TWA)                                    
         USING FLDHDRD,R3                                                       
         SR    R5,R5                                                            
         ICM   R5,1,SYSWSFN                                                     
         BCTR  R5,0                                                             
         SR    R0,R0                                                            
                                                                                
         CLC   THISFLD,FLDNUM      DOES FIELD NUMBER MATCH PREVIOUS?            
         BNE   BLDTWA38            NO                                           
         CLC   THISNDX,FLDNDX      DOES FIELD INDEX MATCH PREVIOUS?             
         BNE   BLDTWA38            NO                                           
         CLC   THISFLD,SYSWSFN     TEST DATA BEFORE SCREEN START                
         BL    BLDTWA36                                                         
         CLI   THISNDX,0           TEST FIELD INDEX PRESENT                     
         BE    BLDTWA32                                                         
                                                                                
         SR    R5,R5               LOCATE FIELD USING FIELD NUMBER              
         IC    R5,THISNDX                                                       
         BASR  RE,0                                                             
         ICM   R0,1,FLDLEN                                                      
         BNZ   *+6                                                              
         DC    H'0'                                                             
         TM    FLDATB,FATBPROT     IGNORE PROTECTED FIELDS                      
         BNZ   BLDTWA30                                                         
         TM    FLDATB,FATBXHDR     AND THOSE WITHOUT EXTENDED HEADERS           
         BZ    BLDTWA30                                                         
         LR    R1,R0                                                            
         SHI   R1,FLDDATA-FLDHDRD                                               
         LA    R1,FLDHDRD(R1)                                                   
         CLC   THISFLD,0(R1)       MATCH FIELD NUMBER                           
         BNE   BLDTWA30                                                         
         BCT   R5,BLDTWA30         DO UNTIL INDEX SATISFIED                     
         B     BLDTWA36                                                         
BLDTWA30 AR    R3,R0               BUMP TO NEXT TWA FIELD                       
         BR    RE                                                               
                                                                                
BLDTWA32 ICM   R0,1,FLDLEN         LOCATE FIELD IN TWA                          
         BNZ   *+6                                                              
         DC    H'0'                                                             
         TM    FLDATB,FATBPROT                                                  
         BNZ   BLDTWA34                                                         
         AHI   R5,1                                                             
         CLM   R5,1,THISFLD                                                     
         BE    BLDTWA36            GOT FIELD WE WANT                            
BLDTWA34 AR    R3,R0                                                            
         B     BLDTWA32                                                         
                                                                                
BLDTWA36 SR    RE,RE                                                            
         IC    RE,FLDILEN          RE=PARTIAL INPUT LENGTH                      
         LR    R0,RE                                                            
         PACK  DUB,2(2,R7)         LENGTH                                       
         CVB   R6,DUB                                                           
         AR    R0,R6                                                            
         LA    RE,FLDDATA(RE)                                                   
         CLC   THISFLD,SYSWSFN     TEST BEFORE START OF OVERLAY SCREEN          
         BL    BLDTWA60                                                         
         BCTR  R6,0                                                             
         STC   R0,FLDILEN          NEW INPUT LENGTH                             
         EX    R6,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),4(R7)                                                    
         AHI   R6,1                                                             
         B     BLDTWA60                                                         
                                                                                
BLDTWA38 CLC   =C'**',2(R7)        TEST FOR SOFT LENGTH '**'                    
         BNE   BLDTWA46            NO                                           
                                                                                
         LA    R6,4(R7)            A(1ST DATA CHARACTER)                        
BLDTWA40 CLC   =C'* ',0(R6)        TEST END OF DATA                             
         BE    BLDTWA44            YES                                          
         CLI   0(R6),SPACE         TEST END OF CARD                             
         BNE   BLDTWA42                                                         
         CLI   1(R6),C'0'          ONLY ACCEPT ALPHA                            
         BNL   BLDTWA44                                                         
         CLI   1(R6),C' '          INCLUDING MIXED CASE                         
         BL    BLDTWA44                                                         
BLDTWA42 AHI   R6,1                INCREMENT INPUT LENGTH                       
         B     BLDTWA40                                                         
                                                                                
BLDTWA44 SR    R6,R7                                                            
         AHI   R6,-4               R6 = INPUT LENGTH                            
         BNZ   BLDTWA48            YES                                          
         DC    H'0'                NO - INPUT LENGTH OF 0 NOT ALLOWED           
                                                                                
BLDTWA46 PACK  DUB,2(2,R7)         LENGTH                                       
         CVB   R6,DUB                                                           
                                                                                
BLDTWA48 CLI   THISNDX,0           TEST FIELD INDEX PRESENT                     
         BE    BLDTWA52                                                         
         SR    R5,R5                                                            
         IC    R5,THISFLD                                                       
         LA    RE,FFFIELDS(R5)                                                  
         CLC   1(1,R7),0(RE)       IGNORE FIELDS ON FF SCREEN                   
         BNH   BLDTWA60                                                         
         IC    R5,THISNDX                                                       
         BASR  RE,0                                                             
         ICM   R0,1,FLDLEN                                                      
         BNZ   *+6                                                              
         DC    H'0'                                                             
         TM    FLDATB,FATBPROT     IGNORE PROTECTED FIELDS                      
         BNZ   BLDTWA50                                                         
         TM    FLDATB,FATBXHDR     AND THOSE WITHOUT EXTENDED HEADERS           
         BZ    BLDTWA50                                                         
         LR    R1,R0                                                            
         SHI   R1,FLDDATA-FLDHDRD                                               
         LA    R1,FLDHDRD(R1)                                                   
         CLC   THISFLD,0(R1)       MATCH FIELD NUMBER                           
         BNE   BLDTWA50                                                         
         BCT   R5,BLDTWA30         DO UNTIL INDEX SATISFIED                     
         B     BLDTWA58                                                         
BLDTWA50 AR    R3,R0               BUMP TO NEXT TWA FIELD                       
         BR    RE                                                               
                                                                                
BLDTWA52 CLC   THISFLD,SYSWSFN     TEST DATA BEFORE SCREEN START                
         BL    BLDTWA60                                                         
BLDTWA54 ICM   R0,1,FLDLEN         LOCATE FIELD IN TWA                          
         BNZ   *+6                                                              
         DC    H'0'                                                             
         TM    FLDATB,FATBPROT     IGNORE PROTECTED FIELDS                      
         BNZ   BLDTWA56                                                         
         AHI   R5,1                BUMP IF UNPROTECTED                          
         CLM   R5,1,THISFLD                                                     
         BE    BLDTWA58            GOT THE ONE WE WERE LOOKING FOR              
BLDTWA56 AR    R3,R0               BUMP TO NEXT INPUT FIELD                     
         B     BLDTWA54                                                         
                                                                                
BLDTWA58 MVC   FLDNUM,THISFLD      SAVE FIELD NUMBER                            
         MVC   FLDNDX,THISNDX      SAVE FIELD INDEX NUMBER                      
                                                                                
         SR    R1,R1                                                            
         IC    R1,FLDLEN           CHECK LENGTH NOT GREATER                     
         SHI   R1,FLDHDRL          THAN MAXIMUM LENGTH                          
         TM    FLDATB,FATBXHDR     TEST EXTENDED HEADER                         
         BZ    *+8                                                              
         SHI   R1,FLDHDRL                                                       
         CR    R6,R1               ENSURE DATA FITS IN FIELD                    
         BNH   *+6                                                              
         LR    R6,R1                                                            
         BCTR  R6,0                                                             
         EX    R6,*+8                                                           
         B     *+10                                                             
         MVC   FLDDATA(0),4(R7)    SET IN INPUT DATA                            
         AHI   R6,1                                                             
         STC   R6,FLDILEN          SET INPUT LENGTH                             
                                                                                
BLDTWA60 LA    R7,4(R6,R7)         POINT TO NEXT FIELD IN CARD                  
         CLI   0(R7),C'*'          TEST ALL CARDS PROCESSED                     
         BE    BLDTWA64                                                         
                                                                                
         AHI   R7,1                                                             
         CLI   0(R7),SPACE         TEST THIS CARD DONE WITH                     
         BNE   BLDTWA24                                                         
                                                                                
BLDTWA62 L     R7,ACARD            BUMP TO NEXT INPUT CARD                      
         AHI   R7,L'RQHCARD                                                     
         ST    R7,ACARD                                                         
         MVC   CARD,0(R7)          EXTRACT REQUEST CARD                         
         LA    R7,CARD+12                                                       
         B     BLDTWA24                                                         
                                                                                
BLDTWA64 L     R3,PLAOUT           NOW TRANSMIT THE TWA                         
         SR    R0,R0                                                            
BLDTWA66 ICM   R0,1,FLDLEN         TEST END OF TWA                              
         BZ    BLDTWA72                                                         
         OI    FLDOIND,FOUTTRN     TRANSMIT ALL FIELDS                          
         CLM   R3,7,PLAOUT                                                      
         BL    BLDTWA70                                                         
         CLI   FLDDATA,DD#ESCL2    TEST FOR ESCAPE SEQUENCE                     
         BL    BLDTWA68                                                         
         CLI   FLDDATA,DD#ESCS                                                  
         BH    BLDTWA68                                                         
         LA    R1,DMCB                                                          
         USING DICTATED,R1                                                      
         MVI   DDACTN,DDACTNS      ISSUE SINGLE UPPER TRANSLATE                 
         MVI   DDRETN,DDCASEL                                                   
         TM    FLDATB,FATBLC                                                    
         BNZ   *+8                                                              
         MVI   DDRETN,DDCASEU                                                   
         MVC   DDSYS,SYSDATE                                                    
         MVC   DDLANG,PLLANG                                                    
         LA    RF,FLDDATA                                                       
         STCM  RF,7,DDIADR                                                      
         STCM  RF,7,DDOADR                                                      
         GOTOR CDICTATE            RESOLVE DICTIONARY WORD                      
         DROP  R1                                                               
                                                                                
BLDTWA68 OI    FLDATB,FATBHIGH                                                  
         TM    FLDATB,FATBPROT     TEST PROTECTED FIELD                         
         BNZ   BLDTWA70                                                         
         OI    FLDATB,FATBPROT                                                  
         NI    FLDATB,ALLBITS-(FATBHIGH)                                        
                                                                                
BLDTWA70 AR    R3,R0                                                            
         B     BLDTWA66                                                         
                                                                                
BLDTWA72 MVI   1(R3),1             SET CLEAR BEFORE/AFTER INDICATORS            
         MVI   2(R3),1                                                          
         CLI   *+0,0               SET CC=NOT EQUAL TO INDICATE FILLED          
         B     EXIT                                                             
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* COUNT OCCURRENCES OF INPUT FIELDS THAT HAVE EXTENDED FIELD NUMBERS  *         
* IN THE FF (VIRGIN) SCREEN                                           *         
***********************************************************************         
                                                                                
RESFLD   STM   RE,RC,12(RD)                                                     
         LA    RF,FFSCREEN                                                      
         USING FLDHDRD,RF                                                       
         SR    R0,R0                                                            
         SR    R2,R2                                                            
         ICM   R2,1,SYSWSF#                                                     
         BNZ   *+8                                                              
         IC    R2,SYSWSFN                                                       
RESFLD02 CLI   FLDLEN,0                                                         
         BE    RESFLDX                                                          
         TM    FLDATB,FATBPROT                                                  
         BNZ   RESFLD06                                                         
         TM    FLDATB,FATBXHDR                                                  
         BZ    RESFLD04                                                         
         SR    R1,R1                                                            
         IC    R1,FLDLEN                                                        
         LA    R1,FLDHDRD(R1)                                                   
         SHI   R1,FLDDATA-FLDHDRD                                               
         IC    R0,0(R1)                                                         
         LTR   R1,R0                                                            
         BZ    RESFLD04                                                         
         LA    R1,FFFIELDS(R1)                                                  
         IC    R0,0(R1)                                                         
         AHI   R0,1                                                             
         STC   R0,0(R1)                                                         
RESFLD04 BCT   R2,RESFLD06                                                      
         B     RESFLDX                                                          
RESFLD06 IC    R0,FLDLEN                                                        
         AR    RF,R0                                                            
         B     RESFLD02                                                         
RESFLDX  LM    RE,RC,12(RD)                                                     
         BR    RE                                                               
         DROP  RF                                                               
         EJECT                                                                  
***********************************************************************         
* ACCPAK SYSTEM INITIALIZATION                                        *         
*                                                                     *         
* MOVE OPTIONS TO CONTIGUOUS AREA OF STORAGE SO THAT THEY CAN ALL BE  *         
* REFERENCED AS A SINGLE FIELD                                        *         
***********************************************************************         
                                                                                
         USING ACQD,RQHCARD                                                     
ACCINI   MVC   ACCOPTS(ACCOPTSL),SPACES                                         
         MVC   ACCOPT1,ACQOPT1     MOVE OPTIONS TO WORKING STORAGE              
         MVC   ACCOPT2,ACQOPT2                                                  
         MVC   ACCOPT3,ACQOPT3                                                  
         MVC   ACCOPT4,ACQOPT4                                                  
         MVC   ACCOPT5,ACQOPT5                                                  
         MVC   ACCOPT6,ACQOPT6                                                  
         MVC   ACCOPT7,ACQOPT7                                                  
         CLI   NUMREQ,1            OPTIONS 8-12 ARE ON CARD 2                   
         BE    REQ18                                                            
         MVC   ACCOPT8,ACQOPT8                                                  
         MVC   ACCOPT9,ACQOPT9                                                  
         MVC   ACCOPT10,ACQOPT10                                                
*&&UK                                                                           
         MVC   ACCOPT11,ACQOPT11                                                
         MVC   ACCOPT12,ACQOPT12                                                
*&&                                                                             
ACCINIX  BR    RE                                                               
                                                                                
                                                                                
***********************************************************************         
* APPLY ACCPAK SYSTEM REQUEST TABLE FILTERS                           *         
***********************************************************************         
                                                                                
         USING REQTABD,R3                                                       
ACCFLT   TM    REQTIND1,REQTIAPF   TEST IF TO CHECK ACQAPFLG FOR VALUE          
         BZ    *+10                                                             
         CLC   ACQAPFLG,REQTIND2   YES - SET CC FOR RETURN                      
         BR    RE                                                               
         DROP  R3                                                               
                                                                                
ACCLFLIT DC    C'CL='                                                           
ACTYPLIT DC    C'TYP'                                                           
         EJECT                                                                  
KLEN     EQU   FLDHDRL+L'KEYWORD   L'TWA FIELDS FOR KEYWORD                     
DLEN     EQU   FLDHDRL+L'DATA      L'TWA FIELDS FOR DATA                        
TLEN     EQU   KLEN+DLEN           L'TWA FIELDS FOR KEY & DATA                  
                                                                                
MAXREQS  EQU   8                   MAXIMUM N'REQUEST CARDS                      
INWS     EQU   REQTDWRK*256        REQUEST FIELD IS IN LOCAL W/S                
KEYLONG  EQU   20                  L'LONG KEYWORD ENTRY                         
KEYSHORT EQU   10                  L'SHORT KEYWORD ENTRY                        
MAXROWS  EQU   22                  N'ROWS TO USE ON SCREEN                      
MAXTWA   EQU   2304-(L'KEYWORD*2)-(L'DATA*2)-(FLDHDRL*4)-1                      
COLS     EQU   80                  N'COLUMNS ON SCREEN                          
FLDHDRL  EQU   FLDDATA-FLDHDRD     L'TWA FIELD HEADER                           
SPRLINEL EQU   79                  WIDTH OF SPOOF DISPLAY LINE                  
SPRDISP  EQU   12                  DISPLACEMENT TO FIRST REQUEST COLUMN         
SPRCOL1  EQU   01                  SPOOF STARTING COLUMN                        
KEYCOL1  EQU   01                  KEYWORD 1 TWA OUTPUT COLUMN                  
DATCOL1  EQU   22                  DATA 1 TWA OUTPUT COLUMN                     
KEYCOL2  EQU   41                  KEYWORD 2 TWA OUTPUT COLUMN                  
DATCOL2  EQU   62                  DATA 2 TWA OUTPUT COLUMN                     
                                                                                
SPACE    EQU   C' '                                                             
ALLXCEPT EQU   C'*'                                                             
ALLBITS  EQU   X'FF'                                                            
NUMERIC  EQU   X'F0'                                                            
DIGIT    EQU   X'0F'                                                            
                                                                                
         LTORG                                                                  
                                                                                
CHRTAB   DS    0CL4                ** LANGUAGE DEPENDENT CHARACTERS **          
         DC    C',=| '                                                          
         DC    C',=| '                                                          
         DC    C',=| '                                                          
         DC    C'#=| '                                                          
         DC    C',=| '                                                          
         DC    C',=| '                                                          
         DC    C',=| '                                                          
         DC    C',=| '                                                          
         DC    C',=| '                                                          
         DC    C',=| '                                                          
         DC    C',=| '                                                          
                                                                                
PHSTAB   DS    0X                  ** PHASE TABLE **                            
         DC    X'031E',AL1(8,0)                                                 
         DC    X'0703',AL1(9,8)                                                 
PHSTABN  EQU   (*-PHSTAB)/PHSTABL                                               
         EJECT                                                                  
SYSTAB   DS    0H                  ** SYSTEM TABLE                              
                                                                                
*                                 ** ACCPAK SYSTEM **                           
         DC    AL1(RFPFSAPL),AL1(RFPFSAPN,RFPFSAPN)                             
         DC    C'AC'                                                            
         DC    AL2(ACDICLST-REQRFP)                                             
         DC    AL2(ACPRGTAB-REQRFP)                                             
         DC    AL2(ACREQTAB-REQRFP)                                             
         DC    AL2(ACCINI-REQRFP)                                               
         DC    AL2(ACCFLT-REQRFP)                                               
         DC    AL1(ACQCONTQ)                                                    
         DC    AL1(ACQCONT1-ACQCARD1,ACQCONT2-ACQCARD2)                         
         DC    AL1(0)                                                           
         DC    X'0614F1'                                                        
         DC    AL1(9)                                                           
*&&US                                                                           
*                                  ** SPOTPAK SYSTEM **                         
         DC    AL1(RFPFSSPL),AL1(RFPFSSPN,RFPFSSPN)                             
         DC    C'SP'                                                            
         DC    AL2(SPDICLST-REQRFP)                                             
         DC    AL2(SPPRGTAB-REQRFP)                                             
         DC    AL2(SPREQTAB-REQRFP)                                             
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL1(SPQCONTQ)                                                    
         DC    AL1(SPQCONT1-SPQCARD1,0)                                         
         DC    AL1(0)                                                           
         DC    X'000000'                                                        
         DC    AL1(9)                                                           
*                                  ** NETPAK SYSTEM **                          
         DC    AL1(RFPFSNEL),AL1(RFPFSNEN,RFPFSSPN)                             
         DC    C'NE'                                                            
         DC    AL2(SPDICLST-REQRFP)                                             
         DC    AL2(SPPRGTAB-REQRFP)                                             
         DC    AL2(SPREQTAB-REQRFP)                                             
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL1(SPQCONTQ)                                                    
         DC    AL1(SPQCONT1-SPQCARD1,0)                                         
         DC    AL1(0)                                                           
         DC    X'000000'                                                        
         DC    AL1(9)                                                           
                                                                                
*                                  ** PRINTPAK SYSTEM **                        
         DC    AL1(RFPFSPPL),AL1(RFPFSPPN,RFPFSPPN)                             
         DC    C'PP'                                                            
         DC    AL2(PPDICLST-REQRFP)                                             
         DC    AL2(PPPRGTAB-REQRFP)                                             
         DC    AL2(PPREQTAB-REQRFP)                                             
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL1(PPQCONTQ)                                                    
         DC    AL1(PPQCONT1-PPQD,PPQCONT2-PPQD)                                 
         DC    AL1(0)                                                           
         DC    X'000000'                                                        
         DC    AL1(9)                                                           
*                                  ** REPPAK SYSTEM **                          
         DC    AL1(RFPFSRPL),AL1(RFPFSRPN,RFPFSRPN)                             
         DC    C'RE'                                                            
         DC    AL2(SPDICLST-REQRFP)                                             
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    C'*'                                                             
         DC    AL1(79,0)                                                        
         DC    AL1(0)                                                           
         DC    X'000000'                                                        
         DC    AL1(9)                                                           
*                                  ** TALENT SYSTEM **                          
         DC    AL1(RFPFSTPL),AL1(RFPFSTPN,RFPFSTPN)                             
         DC    C'TA'                                                            
         DC    AL2(SPDICLST-REQRFP)                                             
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    C'*'                                                             
         DC    AL1(79,0)                                                        
         DC    AL1(0)                                                           
         DC    X'000000'                                                        
         DC    AL1(9)                                                           
*                                  ** TRAFFIC SYSTEM **                         
         DC    AL1(RFPFSSTL),AL1(RFPFSSTN,RFPFSSTN)                             
         DC    C'ST'                                                            
         DC    AL2(SPDICLST-REQRFP)                                             
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    C'*'                                                             
         DC    AL1(79,0)                                                        
         DC    AL1(0)                                                           
         DC    X'000000'                                                        
         DC    AL1(9)                                                           
*&&                                                                             
SYSTABX  DC    AL1(SYSTEOTQ)                                                    
         EJECT                                                                  
ACDICLST DS    0X                  ** ACCPAK DICTIONARY LIST **                 
                                                                                
         DCDDL AC#REQR,L'AC@REQR   REQUESTOR NAME                               
         DCDDL AC#RPT,L'AC@RPT     REPORT                                       
         DCDDL AC#OPTS,L'AC@OPTS   OPTIONS                                      
         DCDDL AC#OPT#1,L'AC@OPT#1 OPTION#1                                     
         DCDDL AC#OPT#2,L'AC@OPT#2 OPTION#2                                     
         DCDDL AC#OPT#3,L'AC@OPT#3 OPTION#3                                     
         DCDDL AC#OPT#4,L'AC@OPT#4 OPTION#4                                     
         DCDDL AC#OPT#5,L'AC@OPT#5 OPTION#5                                     
         DCDDL AC#OPT#6,L'AC@OPT#6 OPTION#6                                     
         DCDDL AC#OPT#7,L'AC@OPT#7 OPTION#7                                     
         DCDDL AC#OPT#8,L'AC@OPT#8 OPTION#8                                     
         DCDDL AC#OPT#9,L'AC@OPT#9 OPTION#9                                     
         DCDDL AC#OPT#A,L'AC@OPT#A OPTION#10                                    
         DCDDL AC#OPT#B,L'AC@OPT#B OPTION#11                                    
         DCDDL AC#OPT#C,L'AC@OPT#C OPTION#12                                    
         DCDDL AC#STRDT,L'AC@STRDT START DATE                                   
         DCDDL AC#ENDDT,L'AC@ENDDT END DATE                                     
         DCDDL AC#MOARA,L'AC@MOARA MOA RANGE                                    
         DCDDL AC#UNIT,L'AC@UNIT   UNIT                                         
         DCDDL AC#LGR,L'AC@LGR     LEDGER                                       
         DCDDL AC#ACC,L'AC@ACC     ACCOUNT                                      
         DCDDL AC#OFF,L'AC@OFF     OFFICE                                       
         DCDDL AC#ANOFF,L'AC@ANOFF ANALYSIS OFFICE                              
         DCDDL AC#CTRFL,L'AC@CTRFL CONTRA ACCOUNT FILTER                        
         DCDDL AC#DUEST,L'AC@DUEST DUE DATE START                               
         DCDDL AC#DUEND,L'AC@DUEND DUE DATE END                                 
         DCDDL AC#CTRUL,L'AC@CTRUL CONTRA UNIT/LEDGER                           
         DCDDL AC#SELFL,L'AC@SELFL SELECTIVE FIELD                              
         DCDDL AC#TRNTF,L'AC@TRNTF TRANSACTION TYPE FILTER                      
         DCDDL AC#OFFGP,L'AC@OFFGP OFFICE GROUP                                 
         DCDDL AC#TRNFL,L'AC@TRNFL TRANSACTION CODE FILTER                      
         DCDDL AC#WCLST,L'AC@WCLST WORK CODE LIST                               
         DCDDL AC#BLGGP,L'AC@BLGGP BILLING GROUP                                
         DCDDL AC#FLT1,L'AC@FLT1   ACCOUNT FILTER 1                             
         DCDDL AC#FLT2,L'AC@FLT2   ACCOUNT FILTER 2                             
         DCDDL AC#FLT3,L'AC@FLT3   ACCOUNT FILTER 3                             
         DCDDL AC#FLT4,L'AC@FLT4   ACCOUNT FILTER 4                             
         DCDDL AC#FLT5,L'AC@FLT5   ACCOUNT FILTER 5                             
         DCDDL AC#CTRF1,L'AC@CTRF1 CONTRA ACCOUNT FILTER 1                      
         DCDDL AC#CTRF2,L'AC@CTRF2 CONTRA ACCOUNT FILTER 2                      
         DCDDL AC#CTRF3,L'AC@CTRF3 CONTRA ACCOUNT FILTER 3                      
         DCDDL AC#CTRF4,L'AC@CTRF4 CONTRA ACCOUNT FILTER 4                      
         DCDDL AC#CTRF5,L'AC@CTRF5 CONTRA ACCOUNT FILTER 5                      
         DCDDL AC#MEDFL,L'AC@MEDFL MEDIA FILTER                                 
         DCDDL AC#MEDGP,L'AC@MEDGP MEDIA GROUP                                  
         DCDDL AC#BLGTY,L'AC@BLGTY BILLING TYPE                                 
         DCDDL AC#WCGRP,L'AC@WCGRP WORK CODE GROUP                              
         DCDDL AC#SRTOP,L'AC@SRTOP SORT OPTION                                  
         DCDDL AC#CTR,L'AC@CTR     CONTRA ACCOUNT                               
         DCDDL AC#DRFOP,L'AC@DRFOP DRAFT OPTION                                 
         DCDDL AC#SEQ,L'AC@SEQ     SEQUENCE                                     
         DCDDL AC#ACTST,L'AC@ACTST ACTIVITY START DATE                          
         DCDDL AC#ACTND,L'AC@ACTND ACTIVITY END DATE                            
         DCDDL AC#ALMHD,L'AC@ALMHD ALLOCATION METHOD                            
         DCDDL AC#RVROP,L'AC@RVROP REVERSE OPTION                               
         DCDDL AC#RSLST,L'AC@RSLST LOCATION STATUS                              
         DCDDL AC#BLDST,L'AC@BLDST BILLED START DATE                            
         DCDDL AC#BLDEN,L'AC@BLDEN BILLED END DATE                              
         DCDDL AC#CHKST,L'AC@CHKST CHEQUE START DATE                            
         DCDDL AC#CHKEN,L'AC@CHKEN CHEQUE END DATE                              
         DCDDL AC#DEPST,L'AC@DEPST DEPOSIT START DATE                           
         DCDDL AC#DEPEN,L'AC@DEPEN DEPOSIT END DATE                             
         DCDDL AC#HREDT,L'AC@HREDT HIRE DATE                                    
         DCDDL AC#TRMDT,L'AC@TRMDT TERMINATION DATE                             
         DCDDL AC#ITFST,L'AC@ITFST INTERFACE START DATE                         
         DCDDL AC#ITFEN,L'AC@ITFEN INTERFACE END DATE                           
         DCDDL AC#CALST,L'AC@CALST CALENDAR START MONTH                         
         DCDDL AC#CALEN,L'AC@CALEN CALENDAR END MONTH                           
         DCDDL AC#TITSD,L'AC@TITSD TITLE START DATE                             
         DCDDL AC#TITED,L'AC@TITED TITLE END DATE                               
         DCDDL AC#UDATE,L'AC@UDATE UTILISED DATE                                
         DCDDL AC#SELAC,L'AC@SELAC SELECTED ACCOUNTS                            
         DCDDL AC#RSPID,L'AC@RSPID PERSON ID                                    
         DCDDL AC#COVER,L'AC@COVER OVERHEAD                                     
         DCDDL AC#FRMAT,L'AC@FRMAT FORMAT (SCRIBE)                              
*&&US                                                                           
         DCDDL AC#STT,L'AC@STT     STATUS                                       
         DCDDL AC#XJBOP,L'AC@XJBOP EXPENSE JOB OPTION                           
         DCDDL AC#DUEDD,L'AC@DUEDD DUE DATE DAYS                                
         DCDDL AC#RSUSF,L'AC@RSUSF USER FIELD                                   
         DCDDL AC#STUTY,L'AC@STUTY STUDIO TYPE                                  
         DCDDL AC#CLSST,L'AC@CLSST JOB CLOSE START DATE                         
         DCDDL AC#CLSEN,L'AC@CLSEN JOB CLOSE END DATE                           
         DCDDL AC#OPNST,L'AC@OPNST JOB OPEN START DATE                          
         DCDDL AC#OPNEN,L'AC@OPNEN JOB OPEN END DATE                            
         DCDDL AC#PRSNC,L'AC@PRSNC PERSON CODE                                  
         DCDDL AC#UTLST,L'AC@UTLST UTILIZED START DATE                          
         DCDDL AC#UTLEN,L'AC@UTLEN UTILIZED END DATE                            
*&&                                                                             
*&&UK                                                                           
         DCDDL AC#OCLOS,L'AC@OCLOS CLOSED OPTION                                
         DCDDL AC#OLOCK,L'AC@OLOCK LOCKED OPTION                                
         DCDDL AC#RCURR,L'AC@RCURR REPORT CURRENCY                              
*&&                                                                             
                                                                                
ACDICXXX DC    X'00'                                                            
                                                                                
ACPRGTAB DS    0X                  ** ACCPAK PROGRAM TABLE **                   
         DC    C'RL',AL1(PRGTSCRQ)                                              
         DC    C'RP',AL1(PRGTSCRQ)                                              
         DC    C'IL',AL1(PRGTSCRQ)                                              
         DC    C'IP',AL1(PRGTSCRQ)                                              
         DC    C'PL',AL1(PRGTSCRQ)                                              
         DC    C'PP',AL1(PRGTSCRQ)                                              
         DC    C'XL',AL1(PRGTSCRQ)                                              
         DC    C'XP',AL1(PRGTSCRQ)                                              
         DC    C'VL',AL1(PRGTSCRQ)                                              
         DC    C'VP',AL1(PRGTSCRQ)                                              
         DC    C'1L',AL1(PRGTSCRQ)                                              
         DC    C'1P',AL1(PRGTSCRQ)                                              
         DC    C'2L',AL1(PRGTSCRQ)                                              
         DC    C'2P',AL1(PRGTSCRQ)                                              
         DC    C'BL',AL1(PRGTSCRQ)                                              
         DC    C'BP',AL1(PRGTSCRQ)                                              
         DC    C'GL',AL1(PRGTSCRQ)                                              
         DC    C'GP',AL1(PRGTSCRQ)                                              
ACPRGXXX DC    AL2(PRGTDEFQ),AL1(0)                                             
                                                                                
ACREQTAB DS    0X                  ** ACCPAK REQUEST FIELD TABLE **             
                                                                                
         DC    AL2(ACQESTOR-ACQD,AC@REQR-KEYWORDS),AL1(L'AC@REQR)               
         DC    AL1(L'ACQESTOR,REQTALPH,REQTITWA,0,0,0)                          
                                                                                
         DC    AL2(ACQPROG-ACQD,AC@RPT-KEYWORDS),AL1(L'AC@RPT)                  
         DC    AL1(L'ACQPROG,REQTREPT,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQAPPL-ACQD,AC@FRMAT-KEYWORDS),AL1(L'AC@FRMAT)              
         DC    AL1(L'ACQAPPL-4,REQTALPH,REQTIPRG,PRGTSCRQ,0,0)                  
                                                                                
         DC    AL2(ACQUNT-ACQD,AC@UNIT-KEYWORDS),AL1(L'AC@UNIT)                 
         DC    AL1(L'ACQUNT+L'ACQLDG+L'ACQACT,REQTULAC,0,0,0,0)                 
                                                                                
         DC    AL2(ACQSTART-ACQD,AC@STRDT-KEYWORDS),AL1(L'AC@STRDT)             
         DC    AL1(L'ACQSTART,REQTDATE)                                         
         DC    AL1(REQTIDAT,0,SOFITSD2,SOFIIONE)                                
                                                                                
         DC    AL2(ACQEND-ACQD,AC@ENDDT-KEYWORDS),AL1(L'AC@ENDDT)               
         DC    AL1(L'ACQEND,REQTDATE)                                           
         DC    AL1(REQTIDAT,0,SOFITSD2,SOFIIONE)                                
                                                                                
         DC    AL2(ACQDUEST-ACQD,AC@DUEST-KEYWORDS),AL1(L'AC@DUEST)             
         DC    AL1(L'ACQDUEST,REQTDATE,REQTIDAT+REQTIAPF,ACQAPFDD)              
         DC    AL1(SOFITSD2,SOFIIONE)                                           
                                                                                
         DC    AL2(ACQDUEND-ACQD,AC@DUEND-KEYWORDS),AL1(L'AC@DUEND)             
         DC    AL1(L'ACQDUEND,REQTDATE,REQTIDAT+REQTIAPF,ACQAPFDD)              
         DC    AL1(SOFITSD2,SOFIIONE)                                           
                                                                                
         DC    AL2(ACQACTST-ACQD,AC@ACTST-KEYWORDS),AL1(L'AC@ACTST)             
         DC    AL1(L'ACQACTST,REQTDATE,REQTIDAT,0)                              
         DC    AL1(SOFITSD2,SOFIIONE)                                           
                                                                                
         DC    AL2(ACQACTND-ACQD,AC@ACTND-KEYWORDS),AL1(L'AC@ACTND)             
         DC    AL1(L'ACQACTND,REQTDATE,REQTIDAT,0)                              
         DC    AL1(SOFITSD2,SOFIIONE)                                           
                                                                                
         DC    AL2(ACQMOSPD-ACQD,AC@MOARA-KEYWORDS),AL1(L'AC@MOARA)             
         DC    AL1(L'ACQMOSPD,REQTDATE)                                         
         DC    AL1(REQTIDAT,0,SOFITSD1,0)                                       
                                                                                
         DC    AL2(ACCOPTS-WORKD+INWS,AC@OPTS-KEYWORDS),AL1(L'AC@OPTS)          
         DC    AL1(ACCOPTSL,REQTALPH,REQTINOT,0,0,0)                            
                                                                                
         DC    AL2(ACCOPT1-WORKD+INWS,AC@OPT#1-KEYWORDS)                        
         DC    AL1(L'AC@OPT#1,L'ACCOPT1,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT2-WORKD+INWS,AC@OPT#2-KEYWORDS)                        
         DC    AL1(L'AC@OPT#2,L'ACCOPT2,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT3-WORKD+INWS,AC@OPT#3-KEYWORDS)                        
         DC    AL1(L'AC@OPT#3,L'ACCOPT3,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT4-WORKD+INWS,AC@OPT#4-KEYWORDS)                        
         DC    AL1(L'AC@OPT#4,L'ACCOPT4,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT5-WORKD+INWS,AC@OPT#5-KEYWORDS)                        
         DC    AL1(L'AC@OPT#5,L'ACCOPT5,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT6-WORKD+INWS,AC@OPT#6-KEYWORDS)                        
         DC    AL1(L'AC@OPT#6,L'ACCOPT6,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT7-WORKD+INWS,AC@OPT#7-KEYWORDS)                        
         DC    AL1(L'AC@OPT#7,L'ACCOPT7,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT8-WORKD+INWS,AC@OPT#8-KEYWORDS)                        
         DC    AL1(L'AC@OPT#8,L'ACCOPT8,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT9-WORKD+INWS,AC@OPT#9-KEYWORDS)                        
         DC    AL1(L'AC@OPT#9,L'ACCOPT9,REQTALPH,REQTITWA,0,0,0)                
                                                                                
         DC    AL2(ACCOPT10-WORKD+INWS,AC@OPT#A-KEYWORDS)                       
         DC    AL1(L'AC@OPT#A,L'ACCOPT10,REQTALPH,REQTITWA,0,0,0)               
                                                                                
*&&UK*&& DC    AL2(ACCOPT11-WORKD+INWS,AC@OPT#B-KEYWORDS)                       
*&&UK*&& DC    AL1(L'AC@OPT#B,L'ACCOPT11,REQTALPH,REQTITWA,0,0,0)               
                                                                                
*&&UK*&& DC    AL2(ACCOPT12-WORKD+INWS,AC@OPT#C-KEYWORDS)                       
*&&UK*&& DC    AL1(L'AC@OPT#C,L'ACCOPT12,REQTALPH,REQTITWA,0,0,0)               
                                                                                
         DC    AL2(ACQOFGRP-ACQD,AC@OFFGP-KEYWORDS),AL1(L'AC@OFFGP)             
         DC    AL1(L'ACQOFGRP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQOFFFL-ACQD,AC@OFF-KEYWORDS),AL1(L'AC@OFF)                 
         DC    AL1(L'ACQOFFFL,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQANOF-ACQD,AC@ANOFF-KEYWORDS),AL1(L'AC@ANOFF)              
         DC    AL1(L'ACQANOF,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQAPPL-ACQD,AC@CTRFL-KEYWORDS),AL1(L'AC@CTRFL)              
         DC    AL1(L'ACQAPPL,REQTALPH,REQTIAPF,ACQAPFCA,0,0)                    
                                                                                
*&&UK*&& DC    AL2(ACQSRTAR-ACQD,AC@CTRUL-KEYWORDS),AL1(L'AC@CTRUL)             
*&&UK*&& DC    AL1(L'ACQSRTAR-2,REQTCAUL,0,0,0,0)                               
                                                                                
*&&UK*&& DC    AL2(ACQSEL-ACQD,AC@SELFL-KEYWORDS),AL1(L'AC@SELFL)               
*&&UK*&& DC    AL1(L'ACQSEL,REQTALPH,0,0,0,0)                                   
                                                                                
*&&US*&& DC    AL2(ACQSEL-ACQD,AC@SELFL-KEYWORDS),AL1(L'AC@SELFL)               
*&&US*&& DC    AL1(L'ACQSEL,REQTSELS,0,0,0,0)                                   
                                                                                
*&&US*&& DC    AL2(ACQSEL-ACQD,AC@TRNTF-KEYWORDS),AL1(L'AC@TRNTF)               
*&&US*&& DC    AL1(L'ACQSEL,REQTTTYP,0,0,0,0)                                   
                                                                                
         DC    AL2(ACQTRNF-ACQD,AC@TRNFL-KEYWORDS),AL1(L'AC@TRNFL)              
         DC    AL1(L'ACQTRNF,REQTALPH,0,0,0,0)                                  
                                                                                
*&&UK*&& DC    AL2(ACQCACUL-ACQD,AC@CTRFL-KEYWORDS),AL1(L'AC@CTRFL)             
*&&UK*&& DC    AL1(L'ACQCACUL,REQTALPH,0,0,0,0)                                 
                                                                                
*&&UK*&& DC    AL2(ACQTTYPE-ACQD,AC@TRNTF-KEYWORDS),AL1(L'AC@TRNTF)             
*&&UK*&& DC    AL1(L'ACQTTYPE,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQWRKLS-ACQD,AC@WCLST-KEYWORDS),AL1(L'AC@WCLST)             
         DC    AL1(L'ACQWRKLS,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQBILGP-ACQD,AC@BLGGP-KEYWORDS),AL1(L'AC@BLGGP)             
         DC    AL1(L'ACQBILGP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF1-ACQD,AC@FLT1-KEYWORDS),AL1(L'AC@FLT1)               
         DC    AL1(L'ACQACTF1,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF2-ACQD,AC@FLT2-KEYWORDS),AL1(L'AC@FLT2)               
         DC    AL1(L'ACQACTF2,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF3-ACQD,AC@FLT3-KEYWORDS),AL1(L'AC@FLT3)               
         DC    AL1(L'ACQACTF3,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF4-ACQD,AC@FLT4-KEYWORDS),AL1(L'AC@FLT4)               
         DC    AL1(L'ACQACTF4,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQACTF5-ACQD,AC@FLT5-KEYWORDS),AL1(L'AC@FLT5)               
         DC    AL1(L'ACQACTF5,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT1-ACQD,AC@CTRF1-KEYWORDS),AL1(L'AC@CTRF1)             
         DC    AL1(L'ACQCFLT1,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT2-ACQD,AC@CTRF2-KEYWORDS),AL1(L'AC@CTRF2)             
         DC    AL1(L'ACQCFLT2,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT3-ACQD,AC@CTRF3-KEYWORDS),AL1(L'AC@CTRF3)             
         DC    AL1(L'ACQCFLT3,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT4-ACQD,AC@CTRF4-KEYWORDS),AL1(L'AC@CTRF4)             
         DC    AL1(L'ACQCFLT4,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQCFLT5-ACQD,AC@CTRF5-KEYWORDS),AL1(L'AC@CTRF5)             
         DC    AL1(L'ACQCFLT5,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQMEDFL-ACQD,AC@MEDFL-KEYWORDS),AL1(L'AC@MEDFL)             
         DC    AL1(L'ACQMEDFL,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQMEDGP-ACQD,AC@MEDGP-KEYWORDS),AL1(L'AC@MEDGP)             
         DC    AL1(L'ACQMEDGP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQBILTY-ACQD,AC@BLGTY-KEYWORDS),AL1(L'AC@BLGTY)             
         DC    AL1(L'ACQBILTY,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQWCGRP-ACQD,AC@WCGRP-KEYWORDS),AL1(L'AC@WCGRP)             
         DC    AL1(L'ACQWCGRP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQSORT-ACQD,AC@SRTOP-KEYWORDS),AL1(L'AC@SRTOP)              
         DC    AL1(L'ACQSORT,REQTALPH,0,0,0,0)                                  
                                                                                
*&&US*&& DC    AL2(ACQCACUL-ACQD,AC@CTRUL-KEYWORDS),AL1(L'AC@CTRUL)             
*&&US*&& DC    AL1(L'ACQCACUL,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQCACT-ACQD,AC@CTR-KEYWORDS),AL1(L'AC@CTR)                  
*&&US*&& DC    AL1(L'ACQCACT,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQDRFOP-ACQD,AC@DRFOP-KEYWORDS),AL1(L'AC@DRFOP)             
         DC    AL1(L'ACQDRFOP,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQREPSQ-ACQD,AC@SEQ-KEYWORDS),AL1(L'AC@SEQ)                 
         DC    AL1(L'ACQREPSQ,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQTRNST-ACQD,AC@STT-KEYWORDS),AL1(L'AC@STT)                 
*&&US*&& DC    AL1(L'ACQTRNST,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQXJOB-ACQD,AC@XJBOP-KEYWORDS),AL1(L'AC@XJBOP)              
*&&US*&& DC    AL1(L'ACQXJOB,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQMTHD-ACQD,AC@ALMHD-KEYWORDS),AL1(L'AC@ALMHD)              
         DC    AL1(L'ACQMTHD,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQREVOP-ACQD,AC@RVROP-KEYWORDS),AL1(L'AC@RVROP)             
         DC    AL1(L'ACQREVOP,REQTALPH,0,0,0,0)                                 
                                                                                
*&&UK*&& DC    AL2(ACQACLOS-ACQD,AC@OCLOS-KEYWORDS),AL1(L'AC@OCLOS)             
*&&UK*&& DC    AL1(L'ACQACLOS,REQTALPH,0,0,0,0)                                 
                                                                                
*&&UK*&& DC    AL2(ACQALOCK-ACQD,AC@OLOCK-KEYWORDS),AL1(L'AC@OLOCK)             
*&&UK*&& DC    AL1(L'ACQALOCK,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQBDAY-ACQD,AC@DUEDD-KEYWORDS),AL1(L'AC@DUEDD)              
*&&US*&& DC    AL1(L'ACQBDAY,REQTBDAY,0,0,0,0)                                  
                                                                                
*&&US*&& DC    AL2(ACQUSFLD-ACQD,AC@RSUSF-KEYWORDS),AL1(L'AC@RSUSF)             
*&&US*&& DC    AL1(L'ACQUSFLD,REQTALPH,0,0,0,0)                                 
                                                                                
*&&US*&& DC    AL2(ACQSTUTY-ACQD,AC@STUTY-KEYWORDS),AL1(L'AC@STUTY)             
*&&US*&& DC    AL1(L'ACQSTUTY,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(ACQLOCS-ACQD,AC@RSLST-KEYWORDS),AL1(L'AC@RSLST)              
         DC    AL1(L'ACQLOCS,REQTALPH,0,0,0,0)                                  
                                                                                
*&&UK*&& DC    AL2(ACQCURR-ACQD,AC@RCURR-KEYWORDS),AL1(L'AC@RCURR)              
*&&UK*&& DC    AL1(L'ACQCURR,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(ACQTYP1-ACQD,ACDATTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP1+L'ACQFLT1,REQTSCRD,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP1-ACQD,ACOTHTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP1+L'ACQFLT1,REQTSCRO,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP2-ACQD,ACDATTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP2+L'ACQFLT2,REQTSCRD,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP2-ACQD,ACOTHTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP2+L'ACQFLT2,REQTSCRO,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP3-ACQD,ACDATTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP3+L'ACQFLT3,REQTSCRD,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP3-ACQD,ACOTHTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP3+L'ACQFLT3,REQTSCRO,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP4-ACQD,ACDATTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP4+L'ACQFLT4,REQTSCRD,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP4-ACQD,ACOTHTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP4+L'ACQFLT4,REQTSCRO,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP5-ACQD,ACDATTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP5+L'ACQFLT5,REQTSCRD,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP5-ACQD,ACOTHTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP5+L'ACQFLT5,REQTSCRO,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP6-ACQD,ACDATTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP6+L'ACQFLT6,REQTSCRD,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP6-ACQD,ACOTHTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP6+L'ACQFLT6,REQTSCRO,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP7-ACQD,ACDATTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP7+L'ACQFLT7,REQTSCRD,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP7-ACQD,ACOTHTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP7+L'ACQFLT7,REQTSCRO,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP8-ACQD,ACDATTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP8+L'ACQFLT8,REQTSCRD,0,0,0,0)                        
                                                                                
         DC    AL2(ACQTYP8-ACQD,ACOTHTAB-REQRFP),AL1(0)                         
         DC    AL1(L'ACQTYP8+L'ACQFLT8,REQTSCRO,0,0,0,0)                        
                                                                                
ACREQXXX DC    AL1(REQTEOTQ)                                                    
                                                                                
ACDATTAB DS    0XL(ACDTABL)        ** SCRIBE DATE TABLE **                      
                                                                                
         DC    AL1(ACQDTBIL)                                                    
         DC    AL1(L'AC@BLDST),AL2(AC@BLDST-KEYWORDS)                           
         DC    AL1(L'AC@BLDEN),AL2(AC@BLDEN-KEYWORDS)                           
                                                                                
         DC    AL1(ACQDTCHK)                                                    
         DC    AL1(L'AC@CHKST),AL2(AC@CHKST-KEYWORDS)                           
         DC    AL1(L'AC@CHKEN),AL2(AC@CHKEN-KEYWORDS)                           
                                                                                
         DC    AL1(ACQDTDEP)                                                    
         DC    AL1(L'AC@DEPST),AL2(AC@DEPST-KEYWORDS)                           
         DC    AL1(L'AC@DEPEN),AL2(AC@DEPEN-KEYWORDS)                           
                                                                                
         DC    AL1(ACQDTTRM)                                                    
         DC    AL1(L'AC@TRMDT),AL2(AC@TRMDT-KEYWORDS)                           
         DC    AL1(0),AL2(0)                                                    
                                                                                
         DC    AL1(ACQDTHIR)                                                    
         DC    AL1(L'AC@HREDT),AL2(AC@HREDT-KEYWORDS)                           
         DC    AL1(0),AL2(0)                                                    
                                                                                
         DC    AL1(ACQDTITF)                                                    
         DC    AL1(L'AC@ITFST),AL2(AC@ITFST-KEYWORDS)                           
         DC    AL1(L'AC@ITFEN),AL2(AC@ITFEN-KEYWORDS)                           
                                                                                
*&&US*&& DC    AL1(ACQDTCLS)                                                    
*&&US*&& DC    AL1(L'AC@CLSST),AL2(AC@CLSST-KEYWORDS)                           
*&&US*&& DC    AL1(L'AC@CLSEN),AL2(AC@CLSEN-KEYWORDS)                           
                                                                                
*&&US*&& DC    AL1(ACQDTOPN)                                                    
*&&US*&& DC    AL1(L'AC@OPNST),AL2(AC@OPNST-KEYWORDS)                           
*&&US*&& DC    AL1(L'AC@OPNEN),AL2(AC@OPNEN-KEYWORDS)                           
                                                                                
         DC    AL1(ACQDTPER)                                                    
         DC    AL1(L'AC@CALST),AL2(AC@CALST-KEYWORDS)                           
         DC    AL1(L'AC@CALEN),AL2(AC@CALEN-KEYWORDS)                           
                                                                                
         DC    AL1(ACQDTTIT)                                                    
         DC    AL1(L'AC@TITSD),AL2(AC@TITSD-KEYWORDS)                           
         DC    AL1(L'AC@TITED),AL2(AC@TITED-KEYWORDS)                           
                                                                                
         DC    AL1(ACQDTUTL)                                                    
         DC    AL1(L'AC@UTLST),AL2(AC@UTLST-KEYWORDS)                           
         DC    AL1(L'AC@UTLEN),AL2(AC@UTLEN-KEYWORDS)                           
*        DC    AL1(L'AC@UDATE),AL2(AC@UDATE-KEYWORDS)                           
*        DC    AL1(0),AL2(0)                                                    
                                                                                
         DC    AL1(ACQDTDUE)                                                    
         DC    AL1(L'AC@DUEST),AL2(AC@DUEST-KEYWORDS)                           
         DC    AL1(L'AC@DUEND),AL2(AC@DUEND-KEYWORDS)                           
                                                                                
         DC    AL1(ACQDTMOS)                                                    
         DC    AL1(L'AC@STRDT),AL2(AC@STRDT-KEYWORDS)                           
         DC    AL1(L'AC@ENDDT),AL2(AC@ENDDT-KEYWORDS)                           
                                                                                
ACDATXXX DC    AL1(ACDTEOTQ)                                                    
                                                                                
ACOTHTAB DS    0XL(ACOTABL)        ** SCRIBE OTHER TABLE **                     
                                                                                
         DC    AL1(ACQANAL),AL2(AC@SELAC-KEYWORDS),AL1(L'AC@SELAC)              
                                                                                
         DC    AL1(ACQCNTR),AL2(AC@CTR-KEYWORDS),AL1(L'AC@CTR)                  
                                                                                
         DC    AL1(ACQPID),AL2(AC@RSPID-KEYWORDS),AL1(L'AC@RSPID)               
                                                                                
         DC    AL1(ACQOVHD),AL2(AC@COVER-KEYWORDS),AL1(L'AC@COVER)              
                                                                                
*&&US*&& DC    AL1(ACQPRSN),AL2(AC@PRSNC-KEYWORDS),AL1(L'AC@PRSNC)              
                                                                                
ACOTHXXX DC    AL1(ACOTEOTQ)                                                    
         EJECT                                                                  
*&&US                                                                           
SPDICLST DS    0X                  ** SPOTPAK DICTIONARY LIST **                
                                                                                
         DCDDL SP#RQSTR,L'SP@RQSTR REQUESTOR NAME                               
         DCDDL SP#RPT,L'SP@RPT     REPORT                                       
         DCDDL SP#MED,L'SP@MED     MEDIA CODE                                   
         DCDDL SP#CLI,L'SP@CLI     CLIENT CODE                                  
         DCDDL SP#PRO,L'SP@PRO     PRODUCT CODE                                 
         DCDDL SP#MKT,L'SP@MKT     MARKET                                       
         DCDDL SP#STA,L'SP@STA     STATION                                      
         DCDDL SP#EST,L'SP@EST     ESTIMATE                                     
         DCDDL SP#STDT,L'SP@STDT   START DATE                                   
         DCDDL SP#ENDT,L'SP@STDT   END DATE                                     
         DCDDL SP#OPTNS,L'SP@OPTNS OPTIONS                                      
         DCDDL SP#OPT1,L'SP@OPT1   OPTION#1                                     
         DCDDL SP#OPT2,L'SP@OPT2   OPTION#2                                     
         DCDDL SP#OPT3,L'SP@OPT3   OPTION#3                                     
         DCDDL SP#OPT4,L'SP@OPT4   OPTION#4                                     
         DCDDL SP#OPT5,L'SP@OPT5   OPTION#5                                     
                                                                                
SPDICXXX DC    X'00'                                                            
                                                                                
PPDICLST DS    0X                  ** PRINTPAK DICTIONARY LIST **               
                                                                                
         DCDDL PP#RQSTR,L'PP@RQSTR REQUESTOR NAME                               
         DCDDL PP#RPT,L'PP@RPT     REPORT                                       
         DCDDL PP#MED,L'PP@MED     MEDIA CODE                                   
         DCDDL PP#CLTC,L'PP@CLTC   CLIENT CODE                                  
         DCDDL PP#DIVSN,L'PP@DIVSN DIVISION                                     
         DCDDL PP#PRDC,L'PP@PRDC   PRODUCT CODE                                 
         DCDDL PP#REGON,L'PP@REGON REGION                                       
         DCDDL PP#DSTCT,L'PP@DSTCT DISTRICT                                     
         DCDDL PP#EST,L'PP@EST     ESTIMATE                                     
         DCDDL PP#SCEST,L'PP@SCEST SECOND ESTIMATE                              
         DCDDL PP#PUBL,L'PP@PUBL   PUBLICATION                                  
         DCDDL PP#STDAT,L'PP@STDAT START DATE                                   
         DCDDL PP#ENDAT,L'PP@ENDAT END DATE                                     
         DCDDL PP#OPTNS,L'PP@OPTNS OPTIONS                                      
                                                                                
PPDICXXX DC    X'00'                                                            
                                                                                
SPPRGTAB DS    0X                  ** SPOTPAK PROGRAM TABLE **                  
                                                                                
SPPRGXXX DC    AL2(PRGTDEFQ),AL1(0)                                             
                                                                                
SPREQTAB DS    0X                  ** SPOTPAK REQUEST FIELD TABLE **            
                                                                                
         DC    AL2(SPQESTOR-SPQD,SP@RQSTR-KEYWORDS),AL1(L'SP@RQSTR)             
         DC    AL1(L'SPQESTOR,REQTALPH,REQTITWA,0,0,0)                          
                                                                                
         DC    AL2(SPQPROG-SPQD,SP@RPT-KEYWORDS),AL1(L'SP@RPT)                  
         DC    AL1(L'SPQPROG,REQTREPT,0,0,0,0)                                  
                                                                                
         DC    AL2(SPQMED-SPQD,SP@MED-KEYWORDS),AL1(L'SP@MED)                   
         DC    AL1(L'SPQMED,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(SPQCLT-SPQD,SP@CLI-KEYWORDS),AL1(L'SP@CLI)                   
         DC    AL1(L'SPQCLT,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(SPQPRD-SPQD,SP@PRO-KEYWORDS),AL1(L'SP@PRO)                   
         DC    AL1(L'SPQPRD,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(SPQMKT-SPQD,SP@MKT-KEYWORDS),AL1(L'SP@MKT)                   
         DC    AL1(L'SPQMKT,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(SPQSTA-SPQD,SP@STA-KEYWORDS),AL1(L'SP@STA)                   
         DC    AL1(L'SPQSTA,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(SPQEST-SPQD,SP@EST-KEYWORDS),AL1(L'SP@EST)                   
         DC    AL1(L'SPQEST,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(SPQSTART-SPQD,SP@STDT-KEYWORDS),AL1(L'SP@STDT)               
         DC    AL1(L'SPQSTART,REQTDATE)                                         
         DC    AL1(REQTIDAT,0,SOFITSD2,SOFIIONE)                                
                                                                                
         DC    AL2(SPQEND-SPQD,SP@ENDT-KEYWORDS),AL1(L'SP@ENDT)                 
         DC    AL1(L'SPQEND,REQTDATE)                                           
         DC    AL1(REQTIDAT,0,SOFITSD2,SOFIIONE)                                
                                                                                
         DC    AL2(SPQOPT1-SPQD,SP@OPTNS-KEYWORDS),AL1(L'SP@OPTNS)              
         DC    AL1(5,REQTALPH,REQTINOT,0,0,0)                                   
                                                                                
         DC    AL2(SPQOPT1-SPQD,SP@OPT1-KEYWORDS),AL1(L'SP@OPT1)                
         DC    AL1(L'SPQOPT1,REQTALPH,REQTITWA,0,0,0)                           
                                                                                
         DC    AL2(SPQOPT2-SPQD,SP@OPT2-KEYWORDS),AL1(L'SP@OPT2)                
         DC    AL1(L'SPQOPT2,REQTALPH,REQTITWA,0,0,0)                           
                                                                                
         DC    AL2(SPQOPT3-SPQD,SP@OPT3-KEYWORDS),AL1(L'SP@OPT3)                
         DC    AL1(L'SPQOPT3,REQTALPH,REQTITWA,0,0,0)                           
                                                                                
         DC    AL2(SPQOPT4-SPQD,SP@OPT4-KEYWORDS),AL1(L'SP@OPT4)                
         DC    AL1(L'SPQOPT4,REQTALPH,REQTITWA,0,0,0)                           
                                                                                
         DC    AL2(SPQOPT5-SPQD,SP@OPT5-KEYWORDS),AL1(L'SP@OPT5)                
         DC    AL1(L'SPQOPT5,REQTALPH,REQTITWA,0,0,0)                           
                                                                                
SPREQXXX DC    AL1(REQTEOTQ)                                                    
                                                                                
PPPRGTAB DS    0X                  ** PRINTPAK PROGRAM TABLE **                 
                                                                                
PPPRGXXX DC    AL2(PRGTDEFQ),AL1(0)                                             
                                                                                
PPREQTAB DS    0X                  ** PRINTPAK REQUEST FIELD TABLE **           
                                                                                
         DC    AL2(PPQESTOR-PPQD,PP@RQSTR-KEYWORDS),AL1(L'PP@RQSTR)             
         DC    AL1(L'PPQESTOR,REQTALPH,REQTITWA,0,0,0)                          
                                                                                
         DC    AL2(PPQPROG-PPQD,PP@RPT-KEYWORDS),AL1(L'PP@RPT)                  
         DC    AL1(L'PPQPROG,REQTREPT,0,0,0,0)                                  
                                                                                
         DC    AL2(PPQMED-PPQD,PP@MED-KEYWORDS),AL1(L'PP@MED)                   
         DC    AL1(L'PPQMED,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(PPQCLT-PPQD,PP@CLTC-KEYWORDS),AL1(L'PP@CLTC)                 
         DC    AL1(L'PPQCLT,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(PPQDIV-PPQD,PP@DIVSN-KEYWORDS),AL1(L'PP@DIVSN)               
         DC    AL1(L'PPQDIV,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(PPQPRD-PPQD,PP@PRDC-KEYWORDS),AL1(L'PP@PRDC)                 
         DC    AL1(L'PPQPRD,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(PPQRGN-PPQD,PP@REGON-KEYWORDS),AL1(L'PP@REGON)               
         DC    AL1(L'PPQRGN,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(PPQDIST-PPQD,PP@DSTCT-KEYWORDS),AL1(L'PP@DSTCT)              
         DC    AL1(L'PPQDIST,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(PPQEST-PPQD,PP@EST-KEYWORDS),AL1(L'PP@EST)                   
         DC    AL1(L'PPQEST,REQTALPH,0,0,0,0)                                   
                                                                                
         DC    AL2(PPQESTND-PPQD,PP@SCEST-KEYWORDS),AL1(L'PP@SCEST)             
         DC    AL1(L'PPQESTND,REQTALPH,0,0,0,0)                                 
                                                                                
         DC    AL2(PPQPUBA-PPQD,PP@PUBL-KEYWORDS),AL1(L'PP@PUBL)                
         DC    AL1(L'PPQPUBA,REQTALPH,0,0,0,0)                                  
                                                                                
         DC    AL2(PPQSTDT-PPQD,PP@STDAT-KEYWORDS),AL1(L'PP@STDAT)              
         DC    AL1(L'PPQSTDT,REQTDATE)                                          
         DC    AL1(REQTIDAT,0,SOFITSD2,SOFIIONE)                                
                                                                                
         DC    AL2(PPQENDT-PPQD,PP@ENDAT-KEYWORDS),AL1(L'PP@ENDAT)              
         DC    AL1(L'PPQENDT,REQTDATE)                                          
         DC    AL1(REQTIDAT,0,SOFITSD2,SOFIIONE)                                
                                                                                
         DC    AL2(PPQOPTS1-PPQD,PP@OPTNS-KEYWORDS),AL1(L'PP@OPTNS)             
         DC    AL1(L'PPQOPTS1,REQTALPH,0,0,0,0)                                 
                                                                                
PPREQXXX DC    AL1(REQTEOTQ)                                                    
*&&                                                                             
         EJECT                                                                  
PLISTD   DSECT                     ** INPUT PARAMETER LIST **                   
PLINDS   DS    0X                  INDICATORS                                   
PLINDTWA EQU   X'80'               CREATE A TWA                                 
PLINDSPR EQU   X'40'               INPUT IS A SPOOF REQUEST                     
PLINDRES EQU   X'20'               RESOLVE SOFT DATES                           
PLINDRUN EQU   X'10'               INPUT IS A RUNNER REQUEST                    
PLAREQ   DS    A                   A(80 BYTE REQUEST HEADER) FOLLOWED           
*                                  BY REQUEST CARDS                             
PLSYST   DS    0X                  SYSTEM NUMBER/LETTER                         
PLACOM   DS    A                   A(COMFACS)                                   
PLLANG   DS    0X                  LANGUAGE CODE                                
PLAOUT   DS    A                   A(OUTPUT BLOCK OR FIRST TWA FIELD)           
         ORG   *-1                                                              
PLWOUT   DS    X                   WIDTH OF OUTPUT BLOCK                        
PLNOUT   DS    0X                  MAXIMUM N'OUTPUT LINES                       
PLATWA   DS    A                   A(TWA)                                       
PLBINDS  DS    0X                  BUFFER INDICATOR BYTE                        
PLBIABUF EQU   X'FF'               X'FF' INDICATES A(BUFFER) PASSED             
PLABUF   DS    A                   A(OPTIMIZATION BUFFER) (SOFBUFFL*2)          
PLARUN   DS    A                   A(RUN DATE - YYMMDD EBCDIC) - MUST           
*                                  BE PRESENT FOR PLINDS=PLINDRES CALLS         
PLISTL   EQU   *-PLISTD                                                         
                                                                                
WORKD    DSECT                     ** LOCAL WORKING STORAGE **                  
DUB      DS    D                                                                
DMCB     DS    6F                                                               
WORK     DS    XL64                                                             
SPACES   DS    CL80                                                             
                                                                                
ADICLST  DS    A                   A(DICTIONARY LOOKUP LIST)                    
APRGTAB  DS    A                   A(PROGRAM ATTRIBUTES TABLE)                  
AREQTAB  DS    A                   A(REQUEST TABLE)                             
ASYSINI  DS    A                   A(SYSTEM INITIALIZATION)                     
ASYSFLT  DS    A                   A(SYSTEM REQUEST FILTER)                     
AKEYWRDS DS    A                   A(KEYWORD LIST)                              
ASOFBUFF DS    A                   A(SOFDAT OPTIMIZATION BUFFER)                
                                                                                
SAVEREGS DS    2F                  LOAD POINT FOR CALLOV                        
                                                                                
ADATA    DS    A                   A(CURRENT DATA FIELD IN REQUEST)             
ACARD    DS    A                   A(CURRENT SPOOF REQUEST CARD)                
CARD     DS    CL(L'RQHCARD)       EXTRACTED SPOOF REQUEST CARD                 
CARDSPAC DS    CL3                                                              
                                                                                
CHARS    DS    0CL(L'CHRTAB)       ** LANGUAGE BASED CHARACTERS **              
COMMA    DS    C                   COMMA CHARACTER                              
EQUAL    DS    C                   EQUALS CHARACTER                             
SLASH    DS    C                   SLASH CHARACTER                              
         ORG   CHARS+L'CHARS                                                    
                                                                                
BYTE     DS    C                   WORK BYTE                                    
CNTLET   DS    C                   CONTINUATION LETTER                          
CNTTAB   DS    XL7                 CONTINUATION COLUMNS                         
NUMREQ   DS    X                   ACTUAL NUMBER OF REQUEST CARDS               
NLINES   DS    X                   N'LINES TWA LINES BUILT                      
ULINES   DS    X                   N'LINES TWA LINES USED                       
INDS     DS    X                   INDICATORS                                   
INDSRGHT EQU   X'80'               USING RHS OF TWA                             
                                                                                
LASTS    DS    0X                  ** LAST TIME KEY **                          
LASTSYSN DS    X                   LAST TIME SYSTEM                             
LASTLANG DS    X                   LAST TIME LANGUAGE                           
LASTSL   EQU   *-LASTS                                                          
                                                                                
SYSDATE  DS    XL(L'SYSTDATE)      SYSTEM NUMBER FOR DATE CALLS                 
SYSDICT  DS    XL(L'SYSTDICT)      SYSTEM NUMBER FOR REQUEST WORDS              
SYSLET   DS    CL(L'SYSTLET)       SYSTEM LETTER                                
SYSLIT   DS    CL(L'SYSTLIT)       SYSTEM REPORT ID                             
SYSWSCR  DS    XL(L'SYSTWSCR)      SYSTEM WRITER SCREEN NUMBER                  
SYSWSFN  DS    XL(L'SYSTWSFN)      SYSTEM WRITER SCREEN FIRST FIELD             
SYSWSF#  DS    XL(L'PHSTF#)        SYSTEM WRITER SCREEN FF FIELDS               
                                                                                
THISFLD  DS    X                   CURRENT FIELD NUMBER                         
THISNDX  DS    X                   CURRENT FIELD INDEX NUMBER                   
                                                                                
FLDNUM   DS    X                   SAVED TWA FIELD NUMBER                       
FLDNDX   DS    X                   SAVED TWA FIELD INDEX NUMBER                 
                                                                                
PRGIND   DS    X                   PROGRAM INDICATOR BYTE (SEE PRGTABD)         
                                                                                
MAXDSP   DS    XL2                 MAXIMUM REQUEST CARD DISPLACEMENT            
                                                                                
SAVFLDID DS    XL2                 SAVED FIELD NUMBER                           
                                                                                
SOFBLOCK DS    (SOFXTNL)X          SOFDAT PARAMETER BLOCK                       
                                                                                
ACCOPTS  DS    0C                  ** EXTRACTED OPTIONS **                      
ACCOPT1  DS    CL(L'ACQOPT1)                                                    
ACCOPT2  DS    CL(L'ACQOPT2)                                                    
ACCOPT3  DS    CL(L'ACQOPT3)                                                    
ACCOPT4  DS    CL(L'ACQOPT4)                                                    
ACCOPT5  DS    CL(L'ACQOPT5)                                                    
ACCOPT6  DS    CL(L'ACQOPT6)                                                    
ACCOPT7  DS    CL(L'ACQOPT7)                                                    
ACCOPT8  DS    CL(L'ACQOPT8)                                                    
ACCOPT9  DS    CL(L'ACQOPT9)                                                    
ACCOPT10 DS    CL(L'ACQOPT10)                                                   
*&&UK                                                                           
ACCOPT11 DS    CL(L'ACQOPT11)                                                   
ACCOPT12 DS    CL(L'ACQOPT12)                                                   
*&&                                                                             
ACCOPTSL EQU   *-ACCOPTS                                                        
                                                                                
KEYWORD  DS    CL(KEYLONG)         CURRENT DATA KEYWORD                         
DATA     DS    CL18                CURRENT DATA FIELD                           
                                                                                
FLDH     DS    XL8                 FIELD HEADER (FOR SOFDAT)                    
FLD      DS    CL(L'DATA)          FIELD DATA                                   
                                                                                
OUTPUT   DS    CL512               FULL OUTPUT STRING                           
OUTPUTL  EQU   *-OUTPUT                                                         
                                                                                
KEYWORDS DS    1536C               ** TRANSLATED DICTIONARY WORDS **            
KEYWORDL EQU   *-KEYWORDS                                                       
         ORG   KEYWORDS                                                         
                                                                                
AC@REQR  DS    CL(KEYLONG)         REQUESTOR NAME                               
AC@RPT   DS    CL(KEYLONG)         REPORT                                       
AC@OPTS  DS    CL(KEYLONG)         OPTIONS                                      
AC@OPT#1 DS    CL(KEYSHORT)        OPTION#1                                     
AC@OPT#2 DS    CL(KEYSHORT)        OPTION#2                                     
AC@OPT#3 DS    CL(KEYSHORT)        OPTION#3                                     
AC@OPT#4 DS    CL(KEYSHORT)        OPTION#4                                     
AC@OPT#5 DS    CL(KEYSHORT)        OPTION#5                                     
AC@OPT#6 DS    CL(KEYSHORT)        OPTION#6                                     
AC@OPT#7 DS    CL(KEYSHORT)        OPTION#7                                     
AC@OPT#8 DS    CL(KEYSHORT)        OPTION#8                                     
AC@OPT#9 DS    CL(KEYSHORT)        OPTION#9                                     
AC@OPT#A DS    CL(KEYSHORT)        OPTION#A                                     
AC@OPT#B DS    CL(KEYSHORT)        OPTION#B                                     
AC@OPT#C DS    CL(KEYSHORT)        OPTION#C                                     
AC@STRDT DS    CL(KEYLONG)         START DATE                                   
AC@ENDDT DS    CL(KEYLONG)         END DATE                                     
AC@MOARA DS    CL(KEYLONG)         MOA RANGE                                    
AC@UNIT  DS    CL(KEYLONG)         UNIT                                         
AC@LGR   DS    CL(KEYLONG)         LEDGER                                       
AC@ACC   DS    CL(KEYSHORT)        ACCOUNT                                      
AC@OFF   DS    CL(KEYLONG)         OFFICE                                       
AC@ANOFF DS    CL(KEYLONG)         ANALYSIS OFFICE                              
AC@CTRFL DS    CL(KEYSHORT)        CONTRA ACCOUNT FILTER                        
AC@DUEST DS    CL(KEYLONG)         DUE DATE START                               
AC@DUEND DS    CL(KEYLONG)         DUE DATE END                                 
AC@CTRUL DS    CL(KEYSHORT)        CONTRA UNIT/LEDGER                           
AC@SELFL DS    CL(KEYLONG)         SELECTIVE FIELD                              
AC@TRNTF DS    CL(KEYLONG)         TRANSACTION TYPE FILTER                      
AC@OFFGP DS    CL(KEYLONG)         OFFICE GROUP                                 
AC@TRNFL DS    CL(KEYLONG)         TRANSACTION CODE FILTER                      
AC@WCLST DS    CL(KEYLONG)         WORK CODE LIST                               
AC@BLGGP DS    CL(KEYLONG)         BILLING GROUP                                
AC@FLT1  DS    CL(KEYSHORT)        ACCOUNT FILTER 1                             
AC@FLT2  DS    CL(KEYSHORT)        ACCOUNT FILTER 2                             
AC@FLT3  DS    CL(KEYSHORT)        ACCOUNT FILTER 3                             
AC@FLT4  DS    CL(KEYSHORT)        ACCOUNT FILTER 4                             
AC@FLT5  DS    CL(KEYSHORT)        ACCOUNT FILTER 5                             
AC@CTRF1 DS    CL(KEYSHORT)        CONTRA ACCOUNT FILTER 1                      
AC@CTRF2 DS    CL(KEYSHORT)        CONTRA ACCOUNT FILTER 2                      
AC@CTRF3 DS    CL(KEYSHORT)        CONTRA ACCOUNT FILTER 3                      
AC@CTRF4 DS    CL(KEYSHORT)        CONTRA ACCOUNT FILTER 4                      
AC@CTRF5 DS    CL(KEYSHORT)        CONTRA ACCOUNT FILTER 5                      
AC@MEDFL DS    CL(KEYLONG)         MEDIA FILTER                                 
AC@MEDGP DS    CL(KEYLONG)         MEDIA GROUP                                  
AC@BLGTY DS    CL(KEYLONG)         BILLING TYPE                                 
AC@WCGRP DS    CL(KEYLONG)         WORK CODE GROUP                              
AC@SRTOP DS    CL(KEYLONG)         SORT OPTION                                  
AC@CTR   DS    CL(KEYLONG)         CONTRA ACCOUNT                               
AC@DRFOP DS    CL(KEYLONG)         DRAFT OPTION                                 
AC@SEQ   DS    CL(KEYLONG)         SEQUENCE                                     
AC@ACTST DS    CL(KEYLONG)         ACTIVITY START DATE                          
AC@ACTND DS    CL(KEYLONG)         ACTIVITY END DATE                            
AC@ALMHD DS    CL(KEYLONG)         ALLOCATION METHOD                            
AC@RVROP DS    CL(KEYLONG)         REVERSE OPTION                               
AC@RSLST DS    CL(KEYLONG)         LOCATION STATUS                              
AC@BLDST DS    CL(KEYLONG)         BILLED START DATE                            
AC@BLDEN DS    CL(KEYLONG)         BILLED END DATE                              
AC@CHKST DS    CL(KEYLONG)         CHEQUE START DATE                            
AC@CHKEN DS    CL(KEYLONG)         CHEQUE END DATE                              
AC@DEPST DS    CL(KEYLONG)         DEPOSIT START DATE                           
AC@DEPEN DS    CL(KEYLONG)         DEPOSIT END DATE                             
AC@HREDT DS    CL(KEYLONG)         HIRE DATE                                    
AC@TRMDT DS    CL(KEYLONG)         TERMINATION DATE                             
AC@ITFST DS    CL(KEYLONG)         INTERFACE START DATE                         
AC@ITFEN DS    CL(KEYLONG)         INTERFACE END DATE                           
AC@CALST DS    CL(KEYLONG)         CALENDAR START MONTH                         
AC@CALEN DS    CL(KEYLONG)         CALENDAR END MONTH                           
AC@TITSD DS    CL(KEYLONG)         TITLE START DATE                             
AC@TITED DS    CL(KEYLONG)         TITLE END DATE                               
AC@UDATE DS    CL(KEYLONG)         UTILISED DATE                                
AC@SELAC DS    CL(KEYLONG)         SELECTED ACCOUNTS                            
AC@RSPID DS    CL(KEYLONG)         PERSON ID                                    
AC@COVER DS    CL(KEYLONG)         OVERHEAD                                     
AC@FRMAT DS    CL(KEYLONG)         FORMAT (SCRIBE)                              
*&&US                                                                           
AC@STT   DS    CL(KEYLONG)         STATUS                                       
AC@XJBOP DS    CL(KEYLONG)         EXPENSE JOB OPTION                           
AC@DUEDD DS    CL(KEYLONG)         DUE DATE DAYS                                
AC@RSUSF DS    CL(KEYLONG)         USER FIELD                                   
AC@STUTY DS    CL(KEYLONG)         STUDIO TYPE                                  
AC@CLSST DS    CL(KEYLONG)         JOB CLOSE START DATE                         
AC@CLSEN DS    CL(KEYLONG)         JOB CLOSE END DATE                           
AC@OPNST DS    CL(KEYLONG)         JOB OPEN START DATE                          
AC@OPNEN DS    CL(KEYLONG)         JOB OPEN END DATE                            
AC@PRSNC DS    CL(KEYLONG)         PERSON CODE                                  
AC@UTLST DS    CL(KEYLONG)         UTILIZED START DATE                          
AC@UTLEN DS    CL(KEYLONG)         UTILIZED END DATE                            
*&&                                                                             
*&&UK                                                                           
AC@OCLOS DS    CL(KEYLONG)         CLOSED OPTION                                
AC@OLOCK DS    CL(KEYLONG)         LOCKED OPTION                                
AC@RCURR DS    CL(KEYLONG)         REPORT CURRENCY                              
         ORG                                                                    
*&&                                                                             
*&&US                                                                           
         ORG   KEYWORDS                                                         
SP@RQSTR DS    CL(KEYLONG)         REQUESTOR                                    
SP@RPT   DS    CL(KEYLONG)         REPORT                                       
SP@MED   DS    CL(KEYLONG)         MEDIA CODE                                   
SP@CLI   DS    CL(KEYLONG)         CLIENT CODE                                  
SP@PRO   DS    CL(KEYLONG)         PRODUCT CODE                                 
SP@MKT   DS    CL(KEYLONG)         MARKET                                       
SP@STA   DS    CL(KEYLONG)         STATION                                      
SP@EST   DS    CL(KEYLONG)         ESTIMATE                                     
SP@STDT  DS    CL(KEYLONG)         START DATE                                   
SP@ENDT  DS    CL(KEYLONG)         END DATE                                     
SP@OPTNS DS    CL(KEYLONG)         OPTIONS                                      
SP@OPT1  DS    CL(KEYSHORT)        OPTION#1                                     
SP@OPT2  DS    CL(KEYSHORT)        OPTION#2                                     
SP@OPT3  DS    CL(KEYSHORT)        OPTION#3                                     
SP@OPT4  DS    CL(KEYSHORT)        OPTION#4                                     
SP@OPT5  DS    CL(KEYSHORT)        OPTION#5                                     
         ORG   KEYWORDS                                                         
PP@RQSTR DS    CL(KEYLONG)         REQUESTOR                                    
PP@RPT   DS    CL(KEYLONG)         REPORT                                       
PP@MED   DS    CL(KEYLONG)         MEDIA CODE                                   
PP@CLTC  DS    CL(KEYLONG)         CLIENT CODE                                  
PP@DIVSN DS    CL(KEYLONG)         DIVISION                                     
PP@PRDC  DS    CL(KEYLONG)         PRODUCT CODE                                 
PP@REGON DS    CL(KEYLONG)         REGION                                       
PP@DSTCT DS    CL(KEYLONG)         DISTRICT                                     
PP@EST   DS    CL(KEYLONG)         ESTIMATE                                     
PP@SCEST DS    CL(KEYLONG)         SECOND ESTIMATE                              
PP@PUBL  DS    CL(KEYLONG)         PUBLICATION                                  
PP@STDAT DS    CL(KEYLONG)         START DATE                                   
PP@ENDAT DS    CL(KEYLONG)         END DATE                                     
PP@OPTNS DS    CL(KEYLONG)         OPTIONS                                      
         ORG                                                                    
*&&                                                                             
                                                                                
SOFBUFF  DS    (SOFBUFFL)X         SOFDAT OPTIMIZATION BUFFER                   
                                                                                
FFFIELDS DS    XL256                                                            
FFSCREEN DS    XL4096                                                           
                                                                                
WORKX    EQU   *                                                                
         EJECT                                                                  
SYSTABD  DSECT                     ** SYSTEM TABLE **                           
SYSTEOTQ EQU   0                   END OF TABLE INDICATOR                       
SYSTLET  DS    C                   SYSTEM LETTER                                
SYSTDATE DS    X                   SYSTEM NUMBER FOR DATE CALLS                 
SYSTDICT DS    X                   SYSTEM NUMBER FOR DICTATE CALLS              
SYSTLIT  DS    CL2                 REPORT ID                                    
SYSTADIC DS    AL2                 DISPALCEMENT TO DICTIONARY LIST              
SYSTAPRG DS    AL2                 DISPLACEMENT TO PROGRAM TABLE                
SYSTAREQ DS    AL2                 DISPLACEMENT TO REQUEST TABLE                
SYSTAINI DS    AL2                 DISPLACEMENT TO INITIALISATION CODE          
SYSTAFLT DS    AL2                 DISPLACEMENT TO SYSTEM FILTER CODE           
SYSTCHAR DS    C                   CONTINUATION CHARACTER                       
SYSTCOL1 DS    X                   CONTINUATION COLUMN CARD 1                   
SYSTCOL2 DS    X                   CONTINUATION COLUMN CARDS 2 THRU N           
SYSTINDS DS    X                   SYSTEM INDICATORS                            
SYSTWSCR DS    XL3                 WRITER SCREEN OVERLAY NUMBER                 
SYSTWSFN DS    X                   WRITER SCREEN FIRST FIELD NUMBER             
SYSTABL  EQU   *-SYSTABD           LENGTH OF TABLE ENTRY                        
                                                                                
PHSTABD  DSECT                     ** PHASE TABLE **                            
PHSTPN   DS    XL2                 PHASE NUMBER                                 
PHSTFN   DS    X                   FIRST FIELD NUMBER                           
PHSTF#   DS    X                   N'FIELDS TO PROCESS ON FF SCREEN             
PHSTABL  EQU   *-PHSTABD           LENGTH OF TABLE ENTRY                        
                                                                                
PRGTABD  DSECT                     ** PROGRAM TABLE **                          
PRGTDEFQ EQU   0                                                                
PRGTPRG  DS    CL(L'ACQPROG)       PROGRAM CODE                                 
PRGTIND  DS    X                   PROGRAM INDICATOR                            
PRGTSCRQ EQU   X'80'               SCRIBE REQUEST                               
PRGTABL  EQU   *-PRGTABD           LENGTH OF TABLE ENTRY                        
                                                                                
REQTABD  DSECT                     ** REQUEST TABLE **                          
REQTEOTQ EQU   X'FF'               END OF TABLE INDICATOR                       
REQTDWRK EQU   X'80'               DATA IS IN WORKD NOT ACQD                    
REQTDSP  DS    AL2                 DISPLACEMENT TO REQUEST FIELD                
REQTNAM  DS    AL2                 DISPLACEMENT TO KEYWORD                      
REQTNAML DS    AL1                 LENGTH OF KEYWORD                            
REQTLEN  DS    AL1                 LENGTH OF REQUEST FIELD                      
REQTFRM  DS    AL1                 FORMAT ROUTINE NUMBER                        
REQTALPH EQU   01                  ALPHA (MVC)                                  
REQTREPT EQU   02                  REPORT=ACNN                                  
REQTDATE EQU   03                  DATE TYPE=EXPRESSION                         
REQTULAC EQU   04                  UNIT/LEDGER/ACCOUNT=U(L(A))                  
REQTCAUL EQU   05                  CONTRAL UNIT/LEDGER                          
REQTSELS EQU   06                  SELECTIVE FIELD         (US ROUTINE)         
REQTTTYP EQU   07                  TRANSACTION TYPE FILTER (US ROUTINE)         
REQTBDAY EQU   08                  DUE DATE DAYS           (US ROUTINE)         
REQTSCRD EQU   09                  SCRIBE DATE FILTERS                          
REQTSCRO EQU   10                  SCRIBE OTHER FILTERS/OPTIONS                 
REQTIND1 DS    X                   FIELD INDICATORS BYTE 1                      
REQTIPRG EQU   X'80'               CHECK PRGIND   FOR VALUE IN REQTIND2         
REQTIAPF EQU   X'40'               CHECK ACQAPFLG FOR VALUE IN REQTIND2         
REQTINOT EQU   X'20'               DON'T PROCESS IF TWA MODE                    
REQTITWA EQU   X'10'               ONLY PROCESS IF TWA MODE                     
REQTIDAT EQU   X'08'               THIS IS A DATE FIELD                         
REQTIND2 DS    X                   FIELD INDICATORS BYTE 2                      
REQTIND3 DS    X                   FIELD INDICATORS BYTE 3                      
REQTIND4 DS    X                   FIELD INDICATORS BYTE 4                      
REQTABL  EQU   *-REQTABD           LENGTH OF TABLE ENTRY                        
                                                                                
ACDTABD  DSECT                     ** SCRIBE DATE KEYWORD TABLE **              
ACDTEOTQ EQU   X'00'                                                            
ACDTTYP  DS    CL(L'ACQDTTYP)      DATE/PERIOD TYPE                             
ACDTLEN1 DS    AL1                 LENGTH OF START DATE NAME                    
ACDTNAM1 DS    AL2                 DISPLACEMENT TO START DATE NAME              
ACDTLEN2 DS    AL1                 LENGTH OF END DATE NAME                      
ACDTNAM2 DS    AL2                 DISPLACEMENT TO END DATE NAME (OR 0)         
ACDTABL  EQU   *-ACDTABD           LENGTH OF TABLE ENTRY                        
                                                                                
ACOTABD  DSECT                     ** SCRIBE OTHER KEYWORD TABLE **             
ACOTEOTQ EQU   X'00'                                                            
ACOTTYP  DS    CL(L'ACQDTTYP)      FILTER/OPTION TYPE                           
ACOTNAM  DS    AL2                 DISPLACEMENT TO DATA NAME                    
ACOTLEN  DS    AL1                 LENGTH OF DATA NAME                          
ACOTABL  EQU   *-ACOTABD           LENGTH OF TABLE ENTRY                        
         EJECT                                                                  
* ACQD                                                                          
         PRINT OFF                                                              
       ++INCLUDE ACQD                                                           
         PRINT ON                                                               
                                                                                
* ACDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE ACDDEQUS                                                       
         PRINT ON                                                               
                                                                                
*&&US                                                                           
* SPQD                                                                          
         PRINT OFF                                                              
       ++INCLUDE SPQD                                                           
         PRINT ON                                                               
                                                                                
* SPDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE SPDDEQUS                                                       
         PRINT ON                                                               
* PPQD                                                                          
         PRINT OFF                                                              
       ++INCLUDE PPQD                                                           
         PRINT ON                                                               
                                                                                
* PPDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE PPDDEQUS                                                       
         PRINT ON                                                               
*&&                                                                             
                                                                                
* DDDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDDDEQUS                                                       
         PRINT ON                                                               
                                                                                
* DDCOMFACS                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDCOMFACS                                                      
         PRINT ON                                                               
                                                                                
* DDSOFDATD                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDSOFDATD                                                      
         PRINT ON                                                               
                                                                                
* DDDICTATED                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDDICTATED                                                     
DICTATEL EQU   *-DICTATED                                                       
         PRINT ON                                                               
                                                                                
* DDFLDHDR                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDFLDHDR                                                       
         PRINT ON                                                               
                                                                                
* GERFPIOD                                                                      
         PRINT OFF                                                              
       ++INCLUDE GERFPIOD                                                       
         PRINT ON                                                               
                                                                                
* DMREQHDRA                                                                     
         PRINT OFF                                                              
RQHD     DSECT                                                                  
       ++INCLUDE DMREQHDRA                                                      
         ORG   RQHCARD                                                          
         DS    (MAXREQS)CL(L'RQHCARD)                                           
RQRL     EQU   *-RQHCARD                                                        
         ORG   RQHCARD                                                          
RQPROG   DS    CL2                                                              
         ORG                                                                    
         PRINT ON                                                               
                                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'018DDREQRFP  06/15/20'                                      
         END                                                                    
