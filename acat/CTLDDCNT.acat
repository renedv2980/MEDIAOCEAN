*          DATA SET CTLDDCNT   AT LEVEL 003 AS OF 06/08/20                      
*CATALP CTLDDCNT                                                                
         TITLE 'LDCOUNT - CTFILE - REC TYPE COUNT/PRINT'                        
*                                                                               
*        XL1   COUNT/PRINT  X'01'=COUNT  X'81'=COUNT DELETED PASSIVE            
*                           X'FF'=PRINT                                         
*        AL3   A(RECORD)                                                        
*        XL1   FILE NUMBER                                                      
*                                                                               
         PRINT NOGEN                                                            
LDCOUNT  CSECT                                                                  
         ENTRY CTRECT                                                           
         ENTRY CTRECT10            PROGRAM PROFILE                              
         ENTRY CTRECT40            AUTH CODE                                    
         ENTRY CTRECT41            AUTH PASSIVE                                 
         ENTRY CTRECT51            RADIO RECORD                                 
         ENTRY CTRECT52            RADIO PASSIVE                                
         NMOD1 WRKX-WRKD,CTLDDCNT                                               
         USING WRKD,RC                                                          
         MVC   ACONREC,=A(CTRECL)                                               
*                                                                               
         CLI   4(R1),X'A1'         EXIT IF NOT CTFILE                           
         BNE   LDCOUNTX                                                         
         CLI   0(R1),X'01'         TEST COUNT ACTION                            
         BE    LDCNT                                                            
         CLI   0(R1),X'FF'         TEST PRINT ACTION                            
         BE    LDPRT                                                            
*                                                                               
LDCOUNTX XMOD1 1                                                                
*                                                                               
* SEARCH RECORD TYPE TABLE TO LOCATE RECORD AND TO UPDATE COUNTERS              
*                                                                               
LDCNT    XC    ADESCEL,ADESCEL     SEARCH RECORD TYPE TABLE                     
         XR    R2,R2                                                            
         ICM   R2,7,1(R1)          R2=A(RECORD)                                 
         LA    R3,CTRECT           R3=A(RECORD TYPE TABLE)                      
         USING RDESD,R3                                                         
*                                                                               
LDCNT2   CLI   RDNUM,0             LAST ENTRY FOR UNKNOWN RECORD                
         BE    LDCNT4                                                           
         CLC   RDTYPE,0(R2)        RECORD TYPE MATCH?                           
         BNE   LDCNT3              NO: NEXT ENTRY                               
*                                                                               
         TM    RDINDI,RDISUB       IS THERE A SUBTYPE?                          
         BZ    LDCNT2A             NO: NO NEED TO CHECK SUBTYPE                 
         CLC   RDSUB,1(R2)         RECORD SUBTYPE MATCH?                        
         BNE   LDCNT3              YES: RECORD MATCH                            
*                                                                               
LDCNT2A  TM    RDINDI,RDIPAD       IS THERE A DESIGNATED # OF ZEROS?            
         BZ    LDCNT4              NO: NO NEED TO CHECK                         
         XR    RF,RF                                                            
         ICM   RF,1,RDZPAD         NUMBER OF ZEROS                              
         BZ    LDCNT4              ZERO: DON'T CHECK, PROCESS RECORD            
         AHI   RF,-1                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         OC    1(0,R2),1(R2)                                                    
         BZ    LDCNT4              CORRECT NUMBER OF ZEROS: PROCESS             
*                                                                               
LDCNT3   LA    R3,RDESLQ(R3)       NEXT ENTRY                                   
         B     LDCNT2                                                           
*                                                                               
LDCNT4   MVC   RECNUM,RDNUM        EXTRACT RECORD NUMBER                        
         TM    RDINDI,RDIPASS      TEST IF RECORD HAS A PASSIVE COPY            
         BZ    LDCNT6                                                           
         CLI   RECNUM,QTERM                                                     
         BE    LDCNT10                                                          
         CLI   RECNUM,QUSERID                                                   
         BE    LDCNT12                                                          
         CLI   RECNUM,QAUTHNAM                                                  
         BE    LDCNT14                                                          
*                                                                               
LDCNT6   MVI   BOOK,C'N'           TEST/SET IF A BOOK RECORD                    
         TM    RDINDI,RDIBOOK                                                   
         BZ    *+8                                                              
         MVI   BOOK,C'Y'                                                        
         LA    RE,28(R2)           RE=A(FIRST ELEMENT)                          
         SR    RF,RF                                                            
*                                                                               
LDCNT8   CLI   0(RE),0             FIND DESCRIPTION ELEMENT                     
         BE    LDCNT20                                                          
         CLI   0(RE),X'02'                                                      
         BH    LDCNT20                                                          
         BNE   *+12                                                             
         ST    RE,ADESCEL          SAVE A(DESCRIPTION ELEMENT)                  
         B     LDCNT20                                                          
         IC    RF,1(RE)                                                         
         AR    RE,RF                                                            
         B     LDCNT8                                                           
*                                                                               
LDCNT10  OC    7(8,R2),7(R2)       TERMINAL LUID ENTRY                          
         BNZ   LDCNT6                                                           
         LA    R3,RDESLQ(R3)       TERMINAL NUMBER PASSIVE ENTRY                
         MVC   RECNUM,RDNUM                                                     
         B     LDCNT6                                                           
*                                                                               
LDCNT12  OC    15(8,R2),15(R2)     USERID NAME ENTRY                            
         BNZ   LDCNT6                                                           
         LA    R3,RDESLQ(R3)       USERID NUMBER PASSIVE                        
         MVC   RECNUM,RDNUM                                                     
         B     LDCNT6                                                           
*                                                                               
LDCNT14  OC    3(12,R2),3(R2)      AUTH NAME ENTRY                              
         BNZ   LDCNT6                                                           
         LA    R3,RDESLQ(R3)       AUTH CODE ENTRY                              
         OC    3(20,R2),3(R2)                                                   
         BNZ   *+8                                                              
         LA    R3,RDESLQ(R3)       AUTH PASSIVE ENTRY                           
         MVC   RECNUM,RDNUM                                                     
         B     LDCNT6                                                           
*                                                                               
LDCNT20  L     RF,RDCOUNT          BUMP RECORD COUNTER                          
         AHI   RF,1                                                             
         ST    RF,RDCOUNT                                                       
*                                                                               
         TM    27(R2),X'80'                                                     
         BZ    LDCNT22                                                          
         L     RF,RDDELS           BUMP DELETED RECORD COUNTER                  
         AHI   RF,1                                                             
         ST    RF,RDDELS                                                        
*                                                                               
LDCNT22  LLC   RF,RDTYPE           BUMP RECORD TYPE TOTAL BYTES                 
         SLL   RF,3                                                             
         A     RF,ACONREC          INDEX INTO TABLE BY RECORD TYPE              
         XGR   GR0,GR0                                                          
         ICM   R0,3,25(R2)         GR0=RECORD LENGTH                            
         LG    GR1,0(RF)                                                        
         AGR   GR1,GR0                                                          
         STG   GR1,0(RF)                                                        
*                                                                               
         CLI   RDNUM,0             UNKNOWN RECORD                               
         BNE   LDCNTX                                                           
         L     RA,=V(CPRINT)       PRINT HEADING                                
         USING DPRINT,RA                                                        
         GOTO1 =V(HEXOUT),PLIST,0(R2),P+20,25                                   
         MVC   P(20),=CL20'UNKNOW RECORD KEY='                                  
         GOTO1 =V(PRINTER)                                                      
*                                                                               
LDCNTX   B     LDCOUNTX                                                         
                                                                                
*----------------------------------------------------------------------         
* SEARCH RECORD TYPE TABLE AND PRINT ALL NON-ZERO RECORD COUNTERS               
*----------------------------------------------------------------------         
LDPRT    L     RA,=V(CPRINT)       PRINT HEADING                                
         USING DPRINT,RA                                                        
         USING PLINED,P                                                         
         GOTO1 =V(PRINTER)                                                      
         MVC   P(MYMID1Q),MYMID1                                                
         GOTO1 =V(PRINTER)                                                      
         MVC   P(MYMID2Q),MYMID2                                                
         GOTO1 =V(PRINTER)                                                      
         LA    R3,CTRECT           R3=A(RECORD TYPE TABLE ENTRY)                
         XR    R4,R4               R4=TOTAL RECORDS                             
         XR    R5,R5               R5=DELETED RECORDS                           
         XGR   GR6,GR6             GR6=TOTAL BYTES                              
         MVI   LASTRT,X'FF'                                                     
*                                                                               
LDPRT1   CLI   RDNUM,X'FF'         TEST END OF TABLE                            
         BE    LDPRT10                                                          
         MVC   PLNAME,RDNAME                                                    
         MVC   PLDNAME(L'RDDSECT),RDDSECT                                       
         MVC   PLPAN,RDPAN                                                      
*                                                                               
LDPRT2   L     R0,RDCOUNT          GET RECORD COUNTER                           
         AR    R4,R0                                                            
         LTR   R0,R0                                                            
         BNZ   *+14                                                             
         MVC   PLCOUNT,=9C'.'                                                   
         B     LDPRT3                                                           
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  PLCOUNT,DUB                                                      
*                                                                               
LDPRT3   L     R0,RDDELS           GET DELETED COUNTER                          
         AR    R5,R0                                                            
         LTR   R0,R0                                                            
         BNZ   *+14                                                             
         MVC   PLDELS,=9C'.'                                                    
         B     LDPRT4                                                           
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  PLDELS,DUB                                                       
         TM    RDFLAG,RDFPURGE     TEST IF UPDATED BY V(LDPURGE)                
         BZ    LDPRT4                                                           
         MVI   PLDELF,C'*'                                                      
*                                                                               
LDPRT4   CLI   PLCOUNT,C'.'        TEST IF ZERO COUNTER                         
         BE    LDPRT8                                                           
         MVC   PLTOT,=9C'.'                                                     
         GOTO1 =V(HEXOUT),PLIST,RDTYPE,PLTHEX,1,(24,0)                          
         MVI   PLTCHR,C'.'                                                      
         CLI   RDTYPE,C'A'                                                      
         BL    *+10                                                             
         MVC   PLTCHR,RDTYPE                                                    
*                                                                               
         TM    RDINDI,RDISUB                                                    
         BZ    LDPRT4A                                                          
         GOTO1 =V(HEXOUT),PLIST,RDSUB,PLSUB,1,(24,0)                            
*                                                                               
LDPRT4A  CLC   LASTRT,RDTYPE       NO BYTE COUNT IF SAME RECORD TYPE            
         BE    LDPRT7                                                           
         MVC   LASTRT,RDTYPE                                                    
*                                                                               
LDPRT5   LLC   RF,RDTYPE           GET BYTE COUNT                               
         SLL   RF,3                                                             
         A     RF,ACONREC          INDEX INTO TABLE BY RECORD TYPE              
         LG    GR1,0(RF)                                                        
         AGR   GR6,GR1                                                          
         DSG   GR0,=FD'1024'       CONVERT TO KILOBYTES                         
         LTGR  GR1,GR1                                                          
         BNZ   *+14                                                             
         MVC   PLTOT,=9C'.'                                                     
         B     LDPRT7                                                           
         CVDG  GR1,GRUB                                                         
         OC    GRUB(8),GRUB        TEST FOR OVERFLOW                            
         BZ    *+8                                                              
         MVI   P+38,C'?'                                                        
         OI    GRUB+15,X'0F'                                                    
         UNPK  PLTOT,GRUB+8(8)                                                  
*                                                                               
LDPRT7   GOTO1 =V(PRINTER)                                                      
*                                                                               
LDPRT8   LA    R3,RDESLQ(R3)       BUMP TO NEXT CTRECT TABLE ENTRY              
         B     LDPRT1                                                           
*                                                                               
LDPRT10  MVC   P(MYMID2Q),MYMID2  SET UP TO PRINT TOTALS                        
         GOTO1 =V(PRINTER)                                                      
         MVC   P(5),=C'TOTAL'                                                   
*                                                                               
LDPRT12  LTR   R0,R4               R4=TOTAL RECORDS                             
         BNZ   *+14                                                             
         MVC   PLCOUNT,=9C'.'                                                   
         B     LDPRT14                                                          
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  PLCOUNT,DUB                                                      
*                                                                               
LDPRT14  LTR   R0,R5               R5=TOTAL DELETED RECORDS                     
         BNZ   *+14                                                             
         MVC   PLDELS,=9C'.'                                                    
         B     LDPRT16                                                          
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  PLDELS,DUB                                                       
*                                                                               
LDPRT16  LGR   GR1,GR6             GR6=TOTAL BYTES                              
         XGR   GR0,GR0                                                          
         DSG   GR0,=FD'1024'       CONVERT TO KILOBYTES                         
         LTGR  GR1,GR1                                                          
         BNZ   *+14                                                             
         MVC   PLTOT,=9C'.'                                                     
         B     LDPRT18                                                          
         CVDG  GR1,GRUB                                                         
         OC    GRUB(8),GRUB        TEST FOR OVERFLOW                            
         BZ    *+8                                                              
         MVI   P+38,C'?'                                                        
         OI    GRUB+15,X'0F'                                                    
         UNPK  PLTOT,GRUB+8(8)                                                  
*                                                                               
LDPRT18  GOTO1 =V(PRINTER)         PRINT TOTAL LINE                             
         MVC   P(MYMID2Q),MYMID2                                                
         GOTO1 =V(PRINTER)                                                      
         B     LDCOUNTX                                                         
         LTORG                                                                  
*                                                                               
MYMID1   DC    CL48'RECORD TYPE      COUNT      DELETED    KILOBYTES'           
         DC    CL48'    KEY      DSECT NAME  PAN MEMBER             '           
MYMID1Q  EQU   *-MYMID1                                                         
MYMID2   DC    CL48'---------------  ---------  ---------  ---------'           
         DC    CL48'  - -- --    ----------  ----------             '           
MYMID2Q  EQU   *-MYMID2                                                         
                                                                                
***********************************************************************         
* CTFILE RECORD TYPE TABLE. HAS ENTRY POINTS FOR CTLDPRGE ROUTINE.    *         
*        COVERED BY RDESD DSECT DEFINED BELOW                         *         
***********************************************************************         
         DS    0D                                                               
         DC    CL8'*CTRECT*'                                                    
*                                                                               
CTRECT   DC    X'00',AL1(01),X'0000',C'HEADER          ',2F'0'                  
         DC    X'00',AL1(00),CL8' ',CL10' '                                     
*                                                                               
         DC    X'01',AL1(25),X'0000',C'PROGRAM SAVE    ',2F'0'                  
         DC    X'00',AL1(00),C'CT01RECD',C'CTGENPGREC'                          
*                                                                               
         DC    X'02',AL1(42),X'0000',C'USER            ',2F'0'                  
         DC    X'00',AL1(00),C'CT02REC ',C'CTGENUSER '                          
*                                                                               
         DC    X'03',AL1(44),X'0000',C'DATE SCHEMES    ',2F'0'                  
         DC    X'00',AL1(00),C'CTDSREC ',C'CTGENFILE '                          
*                                                                               
         DC    X'04',AL1(48),X'0000',C'EDR PUB         ',2F'0'                  
         DC    X'00',AL1(00),C'CEPREC  ',C'CTEDRREC  '                          
*                                                                               
         DC    X'05',AL1(43),X'2000',C'PHASE           ',2F'0'                  
         DC    X'01',AL1(00),C'CTPHRECD',C'CTGENPHASE'                          
         DC    X'05',AL1(57),X'2000',C'LOAD            ',2F'0'                  
         DC    X'02',AL1(00),C'CTLDRECD',C'CTGENLOAD '                          
         DC    X'05',AL1(58),X'2000',C'ESCAPE SEQUENCE ',2F'0'                  
         DC    X'03',AL1(00),C'ESCKEYD ',C'CTGENESC  '                          
         DC    X'05',AL1(59),X'2000',C'ADDS DIRECTORY  ',2F'0'                  
         DC    X'04',AL1(00),C'DIRKEYD ',C'CTGENADDIR'                          
         DC    X'05',AL1(60),X'2000',C'ADDS STATION    ',2F'0'                  
         DC    X'06',AL1(00),C'STTNRECD',C'CTGENADSTA'                          
         DC    X'05',AL1(64),X'2000',C'ADDS STATION   P',2F'0'                  
         DC    X'86',AL1(00),C'STTNRECD',C'CTGENADSTA'                          
         DC    X'05',AL1(61),X'2000',C'EDICT           ',2F'0'                  
         DC    X'07',AL1(00),C'EDIKEYD ',C'CTGENEDICT'                          
         DC    X'05',AL1(62),X'2000',C'DARE SERVICE    ',2F'0'                  
         DC    X'08',AL1(00),C'CTDARREC',C'CTGENDARE '                          
         DC    X'05',AL1(62),X'2000',C'ZENITH CLIENT   ',2F'0'                  
         DC    X'09',AL1(00),C'ZENRECD ',C'CTGENZEN  '                          
         DC    X'05',AL1(62),X'2000',C'ZENITH PAYEE    ',2F'0'                  
         DC    X'0A',AL1(00),C'ZENRECD ',C'CTGENZEN  '                          
         DC    X'05',AL1(63),X'2000',C'OFFICE CODE     ',2F'0'                  
         DC    X'0B',AL1(00),C'COCREC  ',C'CTGENOFC  '                          
*                                                                               
         DC    X'06',AL1(46),X'0000',C'BATCH TYPE      ',2F'0'                  
         DC    X'00',AL1(00),C'BTYREC  ',C'CTGENBTY  '                          
*                                                                               
         DC    X'07',AL1(49),X'0000',C'PROVER          ',2F'0'                  
         DC    X'00',AL1(00),C'CTPRREC ',C'CTGENPROV '                          
*                                                                               
         DC    X'08',AL1(50),X'0000',C'PNAME           ',2F'0'                  
         DC    X'00',AL1(00),C'CTPNREC ',C'CTGENPNM  '                          
*                                                                               
         DC    X'09',AL1(53),X'0000',C'NOTIFY          ',2F'0'                  
         DC    X'00',AL1(00),C'CTDEREC ',C'CTGENFILE '                          
*                                                                               
         DC    X'97',AL1(55),X'0000',C'PROF DOC TYPE   ',2F'0'                  
         DC    X'00',AL1(00),C'CTPDREC ',C'CTGENFILE '                          
*                                                                               
CTRECT51 DC    X'99',AL1(51),X'0000',C'RADIO UPLOAD    ',2F'0'                  
         DC    X'00',AL1(00),C'CT99RECD',C'CTGENRAD  '                          
*                                                                               
CTRECT52 DC    X'9A',AL1(52),X'0000',C'RADIO PASSIVE  P',2F'0'                  
         DC    X'00',AL1(00),C'CT9ARECD',C'CTGENRAD  '                          
*                                                                               
         DC    X'9B',AL1(54),X'0000',C'AGY/UID# PASV  P',2F'0'                  
         DC    X'00',AL1(00),C'CT9BREC ',C'CTGENFILE '                          
*                                                                               
         DC    C'A',AL1(27),X'0000',C'TWX LIST        ',2F'0'                   
         DC    X'00',AL1(00),C'CTAREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'B',AL1(32),X'0000',C'DEMO BOOK       ',2F'0'                   
         DC    X'00',AL1(00),C'CTBREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'C',AL1(16),X'4000',C'COMMENT         ',2F'0'                   
         DC    X'00',AL1(00),C'CTCREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'D',AL1(33),X'2000',C'DEMO NAME       ',2F'0'                   
         DC    X'00',AL1(00),C'CTDREC  ',C'CTGENFILE '                          
         DC    C'D',AL1(65),X'2000',C'PROGRAM NO EQU  ',2F'0'                   
         DC    C'P',AL1(00),C'CTDPREC ',C'CTGENFILE '                           
         DC    C'D',AL1(66),X'2000',C'ALPHA MARKET    ',2F'0'                   
         DC    C'M',AL1(00),C'CTDMREC ',C'CTGENFILE '                           
         DC    C'D',AL1(67),X'2000',C'DEMO UPDATE     ',2F'0'                   
         DC    C'U',AL1(00),C'CTDUREC ',C'CTGENFILE '                           
*                                                                               
         DC    C'E',AL1(05),X'0000',C'ERROR MESSAGE   ',2F'0'                   
         DC    X'00',AL1(00),C'CTEREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'F',AL1(06),X'2000',C'SEC/PROGRAM     ',2F'0'                   
         DC    X'10',AL1(00),C'SAPGREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/ACTION      ',2F'0'                   
         DC    X'11',AL1(00),C'SAACREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/RECORD      ',2F'0'                   
         DC    X'12',AL1(00),C'SARCREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/FIELD       ',2F'0'                   
         DC    X'13',AL1(00),C'SAFDREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/OPTIONS     ',2F'0'                   
         DC    X'14',AL1(00),C'SAOPREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/ACCESS      ',2F'0'                   
         DC    X'15',AL1(00),C'SAASREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/FCONTROL    ',2F'0'                   
         DC    X'16',AL1(00),C'SAFCREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/OCONTROL    ',2F'0'                   
         DC    X'17',AL1(00),C'SAOCREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/OFFICE      ',2F'0'                   
         DC    X'02',AL1(00),C'SAOFREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/DEPARTMENT  ',2F'0'                   
         DC    X'03',AL1(00),C'SADPREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/PERSON      ',2F'0'                   
         DC    X'04',AL1(00),C'SAPEREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/GROUP       ',2F'0'                   
         DC    X'05',AL1(00),C'SAAGREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/LIMIT ACC   ',2F'0'                   
         DC    X'18',AL1(00),C'SALAREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/LIMIT LIST  ',2F'0'                   
         DC    X'19',AL1(00),C'SALMREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/TIMESH APPR ',2F'0'                   
         DC    X'20',AL1(00),C'SAAPREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'2000',C'SEC/TEXT LAL    ',2F'0'                   
         DC    X'21',AL1(00),C'SATLREC ',C'SEACSFILE '                          
         DC    C'F',AL1(06),X'0000',C'UNKOWN F RECS   ',2F'0'                   
         DC    X'00',AL1(00),C'SECURITY',C'          '                          
*                                                                               
         DC    C'G',AL1(34),X'0000',C'DEMO FORMULA    ',2F'0'                   
         DC    X'00',AL1(00),C'CTGREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'H',AL1(19),X'0000',C'HUT             ',2F'0'                   
         DC    X'00',AL1(00),C'CTHREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'I',AL1(08),X'8000',C'USER ID         ',2F'0'                   
         DC    X'00',AL1(00),C'SAIREC  ',C'SEACSFILE '                          
         DC    C'I',AL1(16),X'0000',C'USER ID PASV   P',2F'0'                   
         DC    X'00',AL1(00),C'CTIREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'J',AL1(22),X'4000',C'JCL BOOK        ',2F'0'                   
         DC    X'00',AL1(00),C'CTJREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'K',AL1(29),X'0000',C'MARKET AUTH     ',2F'0'                   
         DC    X'00',AL1(00),C'CTKREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'L',AL1(21),X'4000',C'LIBRARY BOOK    ',2F'0'                   
         DC    X'00',AL1(00),C'CTLREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'M',AL1(30),X'0000',C'SCREEN MAP      ',2F'0'                   
         DC    X'00',AL1(00),C'CTMREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'N',AL1(35),X'0000',C'DEMO CODE       ',2F'0'                   
         DC    X'00',AL1(00),C'CTNREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'O',AL1(09),X'0000',C'OUTPUT TYPE     ',2F'0'                   
         DC    X'00',AL1(00),C'CTOREC  ',C'CTGENFILE '                          
*                                                                               
CTRECT10 DC    C'P',AL1(10),X'0000',C'PROGRAM PROFILE ',2F'0'                   
         DC    X'00',AL1(00),C'CTPREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'Q',AL1(36),X'0000',C'DEMO ADJUST     ',2F'0'                   
         DC    X'00',AL1(00),C'CTQREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'R',AL1(37),X'0000',C'DEMO CONTROL    ',2F'0'                   
         DC    X'00',AL1(00),C'CTRREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'S',AL1(56),X'0000',C'STATION CALL LT ',2F'0'                   
         DC    X'00',AL1(00),C'CTSREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'T',AL1(14),X'8000',C'TERMINAL LUID   ',2F'0'                   
         DC    X'00',AL1(00),C'CTTREC  ',C'CTGENFILE '                          
         DC    C'T',AL1(15),X'0000',C'TERMINAL PASV  P',2F'0'                   
         DC    X'00',AL1(00),C'CTTREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'U',AL1(17),X'0000',C'USER PROFILE    ',2F'0'                   
         DC    X'00',AL1(00),C'CTUREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'V',AL1(26),X'0000',C'VALUE           ',2F'0'                   
         DC    X'00',AL1(00),C'CTVREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'W',AL1(29),X'0000',C'SYSTEM LIST     ',2F'0'                   
         DC    X'00',AL1(00),C'SAWREC  ',C'SEACSFILE '                          
*        DC    C'W',AL1(29),X'0000',C'SYSTEM LIST     ',2F'0'                   
*        DC    X'00',AL1(00),C'CTWREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'X',AL1(03),X'0000',C'EXTRACT RULE    ',2F'0'                   
         DC    X'00',AL1(00),C'CTXREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'Y',AL1(18),X'0000',C'FORMULA         ',2F'0'                   
         DC    X'00',AL1(00),C'CTYREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'Z',AL1(31),X'0000',C'TAPE CONTROL    ',2F'0'                   
         DC    X'00',AL1(00),C'CTZREC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'0',AL1(39),X'8000',C'SEC/PER AUTH    ',2F'0'                   
         DC    X'00',AL1(00),C'SA0REC  ',C'SEACSFILE '                          
CTRECT40 DC    C'0',AL1(40),X'0000',C'SEC/AUTH CODE   ',2F'0'                   
         DC    X'00',AL1(00),C'SA0REC  ',C'SEACSFILE '                          
CTRECT41 DC    C'0',AL1(41),X'0000',C'SEC/AUTH PASS  P',2F'0'                   
         DC    X'00',AL1(00),C'CT0REC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'1',AL1(23),X'0000',C'COUNTRY NAME    ',2F'0'                   
         DC    X'00',AL1(00),C'CTEREC ?',C'CTGENFILE '                          
*                                                                               
         DC    C'2',AL1(24),X'0000',C'COUNTRY CODE    ',2F'0'                   
         DC    X'00',AL1(00),C'CTEREC ?',C'CTGENFILE '                          
*                                                                               
         DC    C'3',AL1(68),X'2000',C'IP SUBNET ID    ',2F'0'                   
         DC    C'I',AL1(00),C'CTIPREC ',C'CTGENFILE '                           
         DC    C'3',AL1(07),X'0000',C'FACPAK TABLE    ',2F'0'                   
         DC    X'00',AL1(00),C'CT3REC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'4',AL1(04),X'0000',C'MESSAGE TEXT    ',2F'0'                   
         DC    X'00',AL1(00),C'CBCREC  ',C'CTGENBCREC'                          
*                                                                               
         DC    C'5',AL1(13),X'0000',C'ACCESS          ',2F'0'                   
         DC    X'00',AL1(00),C'CT5REC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'6',AL1(12),X'0000',C'TRAFFIC TWX     ',2F'0'                   
         DC    X'00',AL1(00),C'CSTREC  ',C'CTGENSTTWX'                          
*                                                                               
         DC    C'7',AL1(11),X'1000',C'EXCHANGE RATE   ',2F'0'                   
         DC    X'00',AL1(16),C'CTRTREC ',C'CTGENFILE '                          
         DC    C'7',AL1(11),X'1000',C'SCRIPT OBJECT   ',2F'0'                   
         DC    X'00',AL1(14),C'CT7REC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'8',AL1(45),X'0000',C'LOCKET          ',2F'0'                   
         DC    X'00',AL1(00),C'CT8REC  ',C'CTGENFILE '                          
*                                                                               
         DC    C'9',AL1(47),X'1000',C'ADV-AGENCY     ',2F'0'                    
         DC    X'00',AL1(15),C'CT9REC  ',C'CTGENADV  '                          
         DC    C'9',AL1(47),X'1000',C'FAX             ',2F'0'                   
         DC    X'00',AL1(01),C'CTFXREC ',C'CTGENFAX  '                          
*                                                                               
         DC    X'FF',AL1(02),X'0000',C'TRAILER         ',2F'0'                  
         DC    X'00',AL1(00),CL8' ',CL10' '                                     
*                                                                               
         DC    X'00',AL1(00),X'0000',C'UNKNOWN         ',2F'0'                  
         DC    X'00',AL1(00),CL8' ',CL10' '                                     
*                                                                               
         DC    X'FF',XL1'FF',X'FF00',CL16' ',2F'0'                              
         DC    X'00',AL1(00),CL8' ',CL10' '                                     
*                                                                               
*----------------------------------------------------------------------         
* INTERNAL NUMBER EQUATES                                                       
*----------------------------------------------------------------------         
*              00  -----        UNKNOWN                                         
*              01  X'00'        HEADER                                          
*              02  X'FF'        TRAILER                                         
*              03  X'E7'        EXTRACT RULE                                    
*              04  X'F4'        MESSAGE TEXT                                    
*              05  C'E'         ERROR MESSAGE                                   
*              06  X'C6'                                                        
*              07  X'F3'        HELP TEXT                                       
QUSERID  EQU   08  X'C9'        USER ID                                         
*              09  X'D6'                                                        
QPROFILE EQU   10  X'D7'        PROGRAM PROFILE                                 
*              11  X'F7'        EXCHANGE RATE                                   
*              12  X'F6'        TRAFFIC TWX                                     
*              13  X'F5'        ACCESS                                          
QTERM    EQU   14  X'E3'        TERMINAL LUID                                   
*              15  X'E3'        TERMINAL PASSIVE                                
*              16  X'C3'        ?????                                           
*              16  X'C9'        ?????                                           
*              17  X'E4'        USER PROFILE                                    
*              18  X'E8'        FORMULA                                         
*              19  X'C8'                                                        
*              20  NOT USED                                                     
*              21  X'D3'                                                        
*              22  X'D1'                                                        
*              23  X'F1'        COUNTRY NAME                                    
*              24  X'F2'        COUNTRY CODE                                    
*              25  X'01'        PROGRAM SAVE                                    
*              26  X'E5'        VALUE                                           
*              27  C'A'                                                         
*              29  X'D2'        ?????                                           
*              29  X'E6'        SYSTEM LIST                                     
*              30  X'D4'                                                        
*              31  X'E9'        TAPE CONTROL                                    
*              32  C'B'                                                         
*              33  C'D'                                                         
*              34  X'C7'                                                        
*              35  X'D5'                                                        
*              36  X'D8'        DEMO ADJUST                                     
*              37  X'D9'                                                        
*              38  X'E2'        DEMO STATION                                    
QAUTHNAM EQU   39  C'0'         AUTH NAME                                       
QAUTHCOD EQU   40  C'0'         AUTH CODE                                       
QAUTHPAS EQU   41  C'0'         AUTH PASSIVE                                    
*              42  X'02'                                                        
*              43  X'05' X'01'  PHASE                                           
*              44  X'03'                                                        
*              45  X'F8'        LOCKET                                          
*              46  X'06'                                                        
*              47  X'F9'        FAX                                             
*              48  X'04'        EDR PUB                                         
*              49  X'07'        PROVER                                          
*              50  X'08'        PNAME                                           
QRADIO   EQU   51  X'99'        RADIO UPLOAD                                    
QRADPAS  EQU   52  X'9A'        RADIO PASSIVE                                   
*              53  X'09'        NOTIFY                                          
*              54  X'9B'        AGY/UID# PASSIVE                                
*              55  X'97'                                                        
*              56  X'E2'                                                        
*              57  X'05' X'02'  LOAD                                            
*              58  X'05' X'03'  ESCAPE SEQUENCE                                 
*              59  X'05' X'04'  ADDS DIRECTORY                                  
*              60  X'05' X'05'  ADDS STATION                                    
*              61  X'05' X'06'  EDICT                                           
*              62  X'05' X'07'  DARE SERVICE                                    
*              63  X'05' X'08'  OFFICE CODE                                     
*              64  X'05' X'86'  ADDS STATION PASSIVE                            
*              65  C'D'  C'M'                                                   
*              66  C'D'  C'P'                                                   
*              67  C'D'  C'U'                                                   
*              68  C'3'  C'I'   IP SUBNET ID                                    
*              255              END OF TABLE                                    
*                                                                               
         DS    0D                                                               
         DC    C'*CTRECL*'                                                      
CTRECL   DC    256D'0'                                                          
                                                                                
***********************************************************************         
* WORKING STORAGE                                                               
***********************************************************************         
WRKD     DSECT                                                                  
GRUB     DS    L                                                                
DUB      DS    D                                                                
PLIST    DS    6F                                                               
BYTE     DS    X                                                                
RECNUM   DS    X                                                                
BOOK     DS    C                                                                
LASTRT   DS    X                                                                
ACONREC  DS    A                                                                
ADESCEL  DS    A                                                                
WRKX     EQU   *                                                                
                                                                                
***********************************************************************         
* RECORD DESCRIPTION DSECT                                                      
* XL1    RECORD TYPE IN FIRST BYTE OF KEY                             *         
* AL1    RECORD NUMBER INTERNAL VALUE                                 *         
* XL1    X'80'=RECORD HAS A PASSIVE, X'40'=BOOK RECORD                *         
*        X'20'=RECORD HAS A SUBTYPE, X'10'=MUST CHECK ZEROS IN KEY    *         
* XL1    X'80'=RECORD WAS PURGED ON LOAD BY V(LDPURGE)                *         
* CL16   RECORD NAME                                                  *         
* F      RECORD COUNT                                                 *         
* F      RECORD DELETED COUNT                                         *         
* XL1    RECORD SUBTYPE (IF X'20' SET ON INDICATOR)                             
* XL1    BINARY ZEROS UNTIL FIRST SIGNIFICANT BYTE (IF X'10' SET)               
* CL8    RECORD DSECT NAME                                            *         
* CL10   RECORD DSECT PANVALET MEMBER                                           
***********************************************************************         
RDESD    DSECT                                                                  
RDTYPE   DS    XL1     RECORD TYPE                                              
RDNUM    DS    AL1     INTERNAL RECORD NUMBER                                   
RDINDI   DS    XL1     RECORD INIDICATOR                                        
RDIPASS  EQU   X'80'   . RECORD HAS A PASSIVE                                   
RDIBOOK  EQU   X'40'   . BOOK RECORD                                            
RDISUB   EQU   X'20'   . RECORD HAS A SUBTYPE                                   
RDIPAD   EQU   X'10'   . RECORD HAS SPECIFIC NUMBER OF PADDED ZEROS             
RDFLAG   DS    XL1     RECORD FLAG                                              
RDFPURGE EQU   X'80'   . RECORD WAS PURGED ON LOAD BY V(LDPURGE)                
RDNAME   DS    CL16    RECORD NAME                                              
RDCOUNT  DS    F       ACTIVE RECORD COUNT                                      
RDDELS   DS    F       DELETED RECORD COUNT                                     
RDSUB    DS    X       RECORD SUBTYPE                                           
RDZPAD   DS    AL1     NUMBER OF PADDED ZEROS                                   
RDDSECT  DS    CL8     RECORD DSECT NAME                                        
RDPAN    DS    CL10    PANVALET MEMBER                                          
RDESLQ   EQU   *-RDESD                                                          
                                                                                
***********************************************************************         
* COUNT PRINT LINE                                                              
***********************************************************************         
PLINED   DSECT                                                                  
PLNAME   DS    CL16    RECORD NAME                                              
         DS    CL1                                                              
PLCOUNT  DS    CL9     ACTIVE RECORD COUNT                                      
         DS    CL1                                                              
PLDELF   DS    CL1     DELETED FLAG                                             
PLDELS   DS    CL9     DELETED RECORD COUNT                                     
         DS    CL2                                                              
PLTOT    DS    CL9     TOTAL RECORD COUNT                                       
         DS    CL2                                                              
PLTCHR   DS    CL1     RECORD TYPE (CHARACTER)                                  
         DS    CL1                                                              
PLTHEX   DS    CL2     RECORD TYPE (HEX)                                        
         DS    CL1                                                              
PLSUB    DS    CL2     RECORD SUBTYPE (HEX)                                     
         DS    CL4                                                              
PLDNAME  DS    CL10    RECORD DSECT                                             
         DS    CL2                                                              
PLPAN    DS    CL10    PANVALET MEMBER                                          
                                                                                
***********************************************************************         
* OTHER DSECTS                                                                  
***********************************************************************         
*DDDPRINT                                                                       
         PRINT OFF                                                              
       ++INCLUDE DDDPRINT                                                       
         PRINT ON                                                               
                                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'003CTLDDCNT  06/08/20'                                      
         END                                                                    
