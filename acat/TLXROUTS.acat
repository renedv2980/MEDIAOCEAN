*          DATA SET TLXROUTS   AT LEVEL 007 AS OF 03/15/18                      
*CATALP LXROUTS                                                                 
         TITLE 'EXTRACT ROUTINES FOR TLXTRACT'                                  
*---------------------------------------------------------------------*         
* GHOA 007 15MAR18 SPSUG-1239  ELIM NEED AGENCY STATUSES: NX, SX, CX  *         
*---------------------------------------------------------------------*         
         PRINT NOGEN                                                            
TLXROUTS CSECT                                                                  
         ENTRY TLXAGYC             5300 - AGENCY CODE RECORD                    
*                                  5301 - LIMITED NETWORK USERID                
*                                                                               
         ENTRY TLXAGGC             5302 - AGENCY GROUP RECORD                   
*                                                                               
         ENTRY TLXW4RC             5303 - W-4 RECORD                            
*                                  5321 - PID RECORD                            
*                                                                               
         ENTRY TLXAGTC             5304 - AGENT RECORD                          
         ENTRY TLXCLIC             5305 - CLIENT RECORD                         
         ENTRY TLXPRDC             5306 - PRODUCT RECORD                        
*                                                                               
         ENTRY TLXCSTC             5307 - CAST RECORD                           
*                                  5308 - OVERSCALE AMOUNT RECORD               
*                                  5309 - OVERSCALE PERCENT RECORD              
*                                  5310 - CAST ERROR RECORD                     
*                                  5317 - EPISODE RECORD                        
*                                  5322 - HOLDING FEE DOC ID RECORD             
*                                                                               
         ENTRY TLXCOMC             5311 - COMMERCIAL RECORD                     
*                                  5312 - AFM RECORD                            
*                                  5318 - COMMERCIAL VERSION RECORD             
*                                  5319 - MUSIC CODE RECORD                     
*                                  5320 - COMMERCIAL PRODUCT RECORD             
*                                                                               
*                                                                               
         ENTRY TLXSTFC             5313 - STAFF RECORD                          
*                                  5314 - LIMITED AGENCY                        
*                                  5315 - LIMITED CLIENT                        
*                                                                               
         ENTRY TLXGRTC             5316 - GUARANTEE RECORD                      
*                                                                               
EXIT     XMOD1                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXAGYC - EXTRACT AGENCY RECORDS - 5300                             *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(AGENCY RECORD)                                                *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
* AL4 A(PKCNTS) - RECORD ACCUMULATORS                                 *         
***********************************************************************         
         SPACE 1                                                                
TLXAGYC  NMOD1 WORKX-WORKD,*TLXAGY*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXAGYLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         MVC   APKCNTS,16(R1)                                                   
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLAYD,R3            R3=A(AGENCY RECORD)                          
         USING SXDTABD,R4          R4=A(SXDXTAB)                                
*                                                                               
         CLI   8(R1),1                                                          
         JL    TLXAGKIL            BUILD K RECORD                               
         JE    TLXAGBLD            BUILD COMMERCIAL AND SUBSET RECS             
         JH    TLXAGNXT            OUTPUT NEXT RECORD                           
*                                                                               
TLXAGYCC DC    A(BUFFER1)          AGENCY SAVE AREA                             
TLXAGYLT DC    A(LITERAL)                                                       
       EJECT                                                                    
***********************************************************************         
* BUILD 'K' RECORD AND EXIT                                           *         
***********************************************************************         
TLXAGKIL DS    0H                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* GET NEXT RECORD AND PASS IT BACK                                    *         
***********************************************************************         
         SPACE 1                                                                
TLXAGNXT L     RE,ANEXT                                                         
         OC    0(8,RE),0(RE)                                                    
         JNZ   *+12                                                             
         MVI   8(R1),X'FF'         NO MORE RECORDS                              
         J     EXIT                                                             
*                                                                               
         L     RE,ANEXT            MOVE IN NEXT RECORD                          
         LA    R0,TLXRECD                                                       
         LH    RF,=Y(TX00LEN)                                                   
         LR    R1,RF                                                            
         MVCL  R0,RE                                                            
*                                                                               
         LH    RF,=Y(TX00LEN)      UPDATE POINTER                               
         L     RE,ANEXT                                                         
         AR    RE,RF                                                            
         ST    RE,ANEXT                                                         
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* BUILD SERIES OF RECORDS FOR THIS RECORD                             *         
***********************************************************************         
         SPACE 1                                                                
TLXAGBLD MVC   SVACT,TLXREACT      SAVE ACTION                                  
         MVC   SVDAT,TLXREDAT      SAVE DATE                                    
         MVC   SVTIM,TLXRETIM      SAVE TIME                                    
*                                                                               
         BAS   RE,TLXAGYR          BUILD AGENCY RECORD                          
         BAS   RE,TLXNETR          BUILD LIMITED NETWORK USERID RECS            
*                                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXAGYR -  - EXTRACT AGENCY RECORDS - 5300                          *         
***********************************************************************         
         SPACE 1                                                                
TLXAGYR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK00CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX00LEN)                                          
         MVC   TLXRETYP,TLXAGYQ                                                 
*                                                                               
         MVI   TX00AGY-1,MXTRTQ                                                 
         MVI   TX00NAME-1,MXTRTQ                                                
         MVI   TX00SNME-1,MXTRTQ                                                
         MVI   TX00ADD1-1,MXTRTQ                                                
         MVI   TX00ADD2-1,MXTRTQ                                                
         MVI   TX00ADD3-1,MXTRTQ                                                
         MVI   TX00ADD4-1,MXTRTQ                                                
         MVI   TX00ATTN-1,MXTRTQ                                                
         MVI   TX00TEL-1,MXTRTQ                                                 
         MVI   TX00EMAL-1,MXTRTQ                                                
         MVI   TX00FAX-1,MXTRTQ                                                 
         MVI   TX00OFFC-1,MXTRTQ                                                
         MVI   TX00RCV-1,MXTRTQ                                                 
         MVI   TX00BTYP-1,MXTRTQ                                                
         MVI   TX00HFEQ-1,MXTRTQ                                                
         MVI   TX00MFEQ-1,MXTRTQ                                                
         MVI   TX00NO2N-1,MXTRTQ                                                
         MVI   TX00CTOT-1,MXTRTQ                                                
         MVI   TX00ANYN-1,MXTRTQ                                                
         MVI   TX00HLDS-1,MXTRTQ                                                
         MVI   TX00FIL1-1,MXTRTQ                                                
         MVI   TX00FIL2-1,MXTRTQ                                                
         MVI   TX00FIL3-1,MXTRTQ                                                
         MVI   TX00FIL4-1,MXTRTQ                                                
         MVI   TX00BCOP-1,MXTRTQ                                                
         MVI   TX00TPCU-1,MXTRTQ                                                
         MVI   TX00STFF-1,MXTRTQ                                                
         MVI   TX00BDUE-1,MXTRTQ                                                
         MVI   TX00ESET-1,MXTRTQ                                                
         MVI   TX00AGRP-1,MXTRTQ                                                
         MVI   TX00RINV-1,MXTRTQ                                                
         MVI   TX00NINV-1,MXTRTQ                                                
         MVI   TX00PINV-1,MXTRTQ                                                
         MVI   TX00RADV-1,MXTRTQ                                                
         MVI   TX00NADV-1,MXTRTQ                                                
         MVI   TX00LBOX-1,MXTRTQ                                                
         MVI   TX00SIGN-1,MXTRTQ                                                
         MVI   TX00COMT-1,MXTRTQ                                                
         MVI   TX00GRUL-1,MXTRTQ                                                
         MVI   TX00GRAT-1,MXTRTQ                                                
         MVI   TX00GLMT-1,MXTRTQ                                                
         MVI   TX00FUTA-1,MXTRTQ                                                
         MVI   TX00SUTA-1,MXTRTQ                                                
         MVI   TX00FICA-1,MXTRTQ                                                
         MVI   TX00OFIC-1,MXTRTQ                                                
         MVI   TX00WCOR-1,MXTRTQ                                                
         MVI   TX00CORR-1,MXTRTQ                                                
         MVI   TX00HFR-1,MXTRTQ                                                 
         MVI   TX00CHFR-1,MXTRTQ                                                
         MVI   TX00COD-1,MXTRTQ                                                 
         MVI   TX00APO-1,MXTRTQ                                                 
         MVI   TX0013W-1,MXTRTQ                                                 
         MVI   TX00CTX-1,MXTRTQ                                                 
         MVI   TX00CTXU-1,MXTRTQ                                                
         MVI   TX00FTRK-1,MXTRTQ                                                
         MVI   TX00EREQ-1,MXTRTQ                                                
         MVI   TX00SHUT-1,MXTRTQ                                                
         MVI   TX00DEFT-1,MXTRTQ                                                
         MVI   TX00FULL-1,MXTRTQ                                                
         MVI   TX00RETR-1,MXTRTQ                                                
         MVI   TX00HAND-1,MXTRTQ                                                
         MVI   TX00MAIL-1,MXTRTQ                                                
         MVI   TX00PCH-1,MXTRTQ                                                 
         MVI   TX00OVER-1,MXTRTQ                                                
         MVI   TX00MCHI-1,MXTRTQ                                                
         MVI   TX00LOCK-1,MXTRTQ                                                
         MVI   TX00PRIM-1,MXTRTQ                                                
         MVI   TX00SOAP-1,MXTRTQ                                                
         MVI   TX0030M-1,MXTRTQ                                                 
         MVI   TX00NOSD-1,MXTRTQ                                                
         MVI   TX00CAST-1,MXTRTQ                                                
         MVI   TX00TNX-1,MXTRTQ                                                 
         MVI   TX00AADV-1,MXTRTQ                                                
         MVI   TX00GTRK-1,MXTRTQ                                                
         MVI   TX00CLPO-1,MXTRTQ                                                
         MVI   TX00LATE-1,MXTRTQ                                                
         MVI   TX00NHAN-1,MXTRTQ                                                
         MVI   TX00CODP-1,MXTRTQ                                                
         MVI   TX00CLER-1,MXTRTQ                                                
         MVI   TX00ADSX-1,MXTRTQ                                                
         MVI   TX00VPON-1,MXTRTQ                                                
         MVI   TX00SPTI-1,MXTRTQ                                                
         MVI   TX00NETI-1,MXTRTQ                                                
         MVI   TX00NWRK-1,MXTRTQ                                                
         MVI   TX00STDR-1,MXTRTQ                                                
         MVI   TX00PINT-1,MXTRTQ                                                
         MVI   TX00CPIN-1,MXTRTQ                                                
         MVI   TX00QRTR-1,MXTRTQ                                                
         MVI   TX0075K-1,MXTRTQ                                                 
         MVI   TX00OEMP-1,MXTRTQ                                                
         MVI   TX00VEND-1,MXTRTQ                                                
         MVI   TX00COFF-1,MXTRTQ                                                
         MVI   TX00SFEE-1,MXTRTQ                                                
         MVI   TX00CAMT-1,MXTRTQ                                                
         MVI   TX00X,MXTRTQ                                                     
         MVI   TX00X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX00AGY,TLAYAGY     AGENCY                                       
*                                                                               
         LH    RF,=Y(TX00LEN)                                                   
         STH   RF,RECLEN                                                        
         L     R2,TLXAGYCC         WHERE RECORDS TO BE BUILT                    
         XC    0(8,R2),0(R2)                                                    
         ST    R2,ANEXT            FOR NEXT TIME IN                             
*                                                                               
         L     RE,TXREC            BLANK RECORD HERE                            
         LR    R0,R2                                                            
         LH    RF,RECLEN                                                        
         LR    R1,RF                                                            
         MVCL  R0,RE               COPY IN A BLANK RECORD                       
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           FOR NEXT ROUTINE                             
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         LA    R5,TLAYELEM         R5=A(FIRST ELEMENT)                          
TLXAG10  CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXAGYXX                                                         
         CLI   0(R5),TANAELQ       NAME ELEMENT X'20'                           
         JE    TLXAG30                                                          
         CLI   0(R5),TASNELQ       SHORT NAME ELEMENT X'21'                     
         JE    TLXAG40                                                          
         CLI   0(R5),TAADELQ       ADDRESS ELEMENT X'22'                        
         JE    TLXAG50                                                          
         CLI   0(R5),TANUELQ       FREE FORM ELEMENT X'25'                      
         JE    TLXAG60                                                          
         CLI   0(R5),TAFNELQ       FREE FORM NAME ELEMENT X'26'                 
         JE    TLXAG70                                                          
         CLI   0(R5),TAAYELQ       AGENCY ELEMENT X'2A'                         
         JE    TLXAG80                                                          
         CLI   0(R5),TABRELQ       BILLING RULES ELEMENT X'2B'                  
         JE    TLXAG90                                                          
         CLI   0(R5),TAFLELQ       FILTERS ELEMENT X'30'                        
         JE    TLXAG100                                                         
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXAG110                                                         
         CLI   0(R5),TAGHELQ       GUARANTEE HANDLING ELEMENT X'FA'             
         JE    TLXAG120                                                         
*                                                                               
TLXAG20  SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXAG10                                                          
*                                                                               
         USING TANAD,R5                                                         
TLXAG30  SR    RF,RF               NAME                                         
         IC    RF,TANALEN                                                       
         SHI   RF,3                                                             
         JM    TLXAG20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX00NAME(0),TANANAME                                             
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TASND,R5                                                         
TLXAG40  MVC   TX00SNME,TASNAME    SHORT NAME                                   
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAADD,R5                                                         
TLXAG50  SR    R0,R0               ADDRESS                                      
         ICM   R0,1,TAADLNES       NUMBER OF ADDRESS LINES                      
         JZ    TLXAG20                                                          
         LA    RF,TAADADD          POINT TO 1ST ELEMENT LINE                    
         LA    RE,TX00ADD1         POINT TO FIRST TABLE LINE                    
*                                                                               
TLXAG52  MVC   0(L'TX00ADD1,RE),0(RF)   MOVE IN CURRENT LINE                    
         OC    0(L'TX00ADD1,RE),SPACES                                          
         LA    RE,TX00ADDQ(RE)     SKIP TO NEXT LINE IN TAB                     
         LA    RF,L'TAADADD(RF)    SKIP TO NEXT LINE IN ELM                     
         JCT   R0,TLXAG52                                                       
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TANUD,R5                                                         
TLXAG60  SR    RF,RF               FREE FORM ELEMENT                            
         IC    RF,TANULEN                                                       
         SHI   RF,4                                                             
         JM    TLXAG20                                                          
*                                                                               
         LA    RE,TX00SIGN                                                      
         CLI   TANUTYPE,TANUTSIG   SIGNATORY?                                   
         JE    TLXAG62                                                          
         LA    RE,TX00COFF                                                      
         CLI   TANUTYPE,TANUTCO    COMPANY AND OFFICE?                          
         JE    TLXAG62                                                          
         LA    RE,TX00FAX                                                       
         CLI   TANUTYPE,TANUTFAX   FAX?                                         
         JE    TLXAG62                                                          
         LA    RE,TX00ESET                                                      
         CLI   TANUTYPE,TANUTJOB   ESTIMATE SETUP?                              
         JE    TLXAG62                                                          
         LA    RE,TX00VEND                                                      
         CLI   TANUTYPE,TANUTVND   VENDOR?                                      
         JE    TLXAG62                                                          
         LA    RE,TX00SFEE                                                      
         CLI   TANUTYPE,TANUTSGN   SIGNATORY FEE?                               
         JE    TLXAG62                                                          
         LA    RE,TX00CAMT                                                      
         CLI   TANUTYPE,TANUTSCP   CAP AMOUNT?                                  
         JNE   TLXAG20                                                          
*                                                                               
TLXAG62  EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   0(0,RE),TANUMBER                                                 
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAFND,R5                                                         
TLXAG70  CLI   TAFNTYPE,TAFNTATT   ATTENTION                                    
         JNE   TLXAG20                                                          
         SR    RF,RF                                                            
         IC    RF,TAFNLEN                                                       
         SHI   RF,4                                                             
         JM    TLXAG20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX00ATTN(0),TAFNNAME                                             
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAAYD,R5                                                         
TLXAG80  MVC   TX00TEL,TAAYTEL     TELEPHONE                                    
         MVC   TX00OFFC,TAAYTPOF   OFFICE                                       
*                                                                               
         MVI   TX00MFEQ,C'N'       MONTHLY HOLDING FEE NOTICE                   
         TM    TAAYHLD,X'80'                                                    
         JZ    *+8                                                              
         MVI   TX00MFEQ,C'Y'                                                    
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TAAYHLD        HOLDING FEE FREQUENCY                        
         N     R0,=XL4'0000007F'                                                
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00HFEQ,DUB                                                     
*                                                                               
         MVI   TX00NO2N,C'N'       AGENCY DOESN'T WANT 2ND NOTICE               
         TM    TAAYHLDS,TAAYHS2D                                                
         JZ    *+8                                                              
         MVI   TX00NO2N,C'Y'                                                    
*                                                                               
         MVI   TX00CTOT,C'N'       AGENCY COMM ON TOTAL                         
         TM    TAAYHLDS,TAAYHSCO                                                
         JZ    *+8                                                              
         MVI   TX00CTOT,C'Y'                                                    
*                                                                               
         MVI   TX00ANYN,C'N'       AGENCY DOESN'T WANT ANY NOTICES              
         TM    TAAYHLDS,TAAYHSNO                                                
         JZ    *+8                                                              
         MVI   TX00ANYN,C'Y'                                                    
*                                                                               
         MVI   TX00HLDS,C'P'       GENERATE HOLDING FEE ON PAPER ONLY?          
         TM    TAAYHLDS,TAAYHSNC                                                
         JO    TLXAG82                                                          
*                                                                               
         MVI   TX00HLDS,C'E'       NO, ELECTRONIC ONLY?                         
         TM    TAAYHLDS,TAAYHSEL                                                
         JO    TLXAG82                                                          
*                                                                               
         MVI   TX00HLDS,C'B'       NO, BOTH?                                    
         TM    TAAYHLDS,TAAYHSPE                                                
         JO    TLXAG82                                                          
         MVI   TX00HLDS,C' '       NO, LEAVE BLANK                              
*                                                                               
TLXAG82  SR    R0,R0                                                            
         ICM   R0,1,TAAYNBIL       BILLING COPIES                               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00BCOP,DUB                                                     
*                                                                               
         GOTOR GETUSER,TAAYTID                                                  
         MVC   TX00TPCU,WORK       TPC USERID                                   
*                                                                               
         MVC   TX00STFF,TAAYTPC    STAFF ID                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TAAYDAYS       BILLING DUE DAYS                             
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00BDUE,DUB                                                     
*                                                                               
         MVC   TX00AGRP,TAAYAGG    AGENCY GROUP                                 
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TAAYRINV       RESET INVOICE NUMBER                         
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00RINV,DUB                                                     
*                                                                               
         GOTO1 VHEXOUT,DMCB,TAAYNINV,TX00NINV,L'TAAYNINV,0,L'TX00NINV           
*                                  PRINTED INVOICE NUMBER                       
         GOTO1 TINVCON,DMCB,TAAYNINV,TX00PINV,DATCON                            
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TAAYRADV       RESET ADVICE NUMBER                          
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00RADV,DUB                                                     
*                                                                               
         MVC   TX00NADV,TAAYNADV   NEXT ADVICE NUMBER                           
         MVC   TX00LBOX,TAAYLBOX   LOCK BOX CODE                                
*                                                                               
         MVI   TX00COD,C'N'        COD AGENCY                                   
         TM    TAAYSTAT,TAAYSCOD                                                
         JZ    *+8                                                              
         MVI   TX00COD,C'Y'                                                     
*                                                                               
         MVI   TX00APO,C'N'        AUTH/PO REQUIRED                             
         TM    TAAYSTAT,TAAYSAPO                                                
         JZ    *+8                                                              
         MVI   TX00APO,C'Y'                                                     
*                                                                               
         MVI   TX0013W,C'N'        13 WEEK CYCLES                               
         TM    TAAYSTAT,TAAYS13W                                                
         JZ    *+8                                                              
         MVI   TX0013W,C'Y'                                                     
*                                                                               
         MVI   TX00CTX,C'N'        CANADIAN TAX WITHHELD                        
         TM    TAAYSTAT,TAAYSCTX                                                
         JZ    *+8                                                              
         MVI   TX00CTX,C'Y'                                                     
*                                                                               
         MVI   TX00CTXU,C'N'       CANADIAN TAX WITHHELD ON US$                 
         TM    TAAYSTAT,TAAYSATX                                                
         JZ    *+8                                                              
         MVI   TX00CTXU,C'Y'                                                    
*                                                                               
         MVI   TX00FTRK,C'N'       NO FTRACK REPORTS                            
         TM    TAAYSTAT,TAAYSNFT                                                
         JZ    *+8                                                              
         MVI   TX00FTRK,C'Y'                                                    
*                                                                               
         MVI   TX00EREQ,C'N'       ESTIMATE REQUIRED                            
         TM    TAAYSTAT,TAAYSEST                                                
         JZ    *+8                                                              
         MVI   TX00EREQ,C'Y'                                                    
*                                                                               
         MVI   TX00SHUT,C'N'       PRINT ON AGENCY SHUTTLE                      
         TM    TAAYSTAT,TAAYSPAC                                                
         JZ    *+8                                                              
         MVI   TX00SHUT,C'Y'                                                    
*                                                                               
         MVI   TX00DEFT,C'N'       NO DEFAULT JOBS ALLOWED                      
         TM    TAAYSTA2,TAAYSNDF                                                
         JZ    *+8                                                              
         MVI   TX00DEFT,C'Y'                                                    
*                                                                               
         MVI   TX00FULL,C'N'       FULL GTRACK & FTRACK REPORTS                 
         TM    TAAYSTA2,TAAYSTRK                                                
         JZ    *+8                                                              
         MVI   TX00FULL,C'Y'                                                    
*                                                                               
         MVI   TX00RETR,C'N'       RETRO INVOICES GENERATED                     
         TM    TAAYSTA2,TAAYSRET                                                
         JZ    *+8                                                              
         MVI   TX00RETR,C'Y'                                                    
*                                                                               
         MVI   TX00HAND,C'N'       HAND DELIVERY                                
         TM    TAAYSTA2,TAAYSHND                                                
         JZ    *+8                                                              
         MVI   TX00HAND,C'Y'                                                    
*                                                                               
         MVI   TX00MAIL,C'N'       MAIL DELIVERY                                
         TM    TAAYSTA2,TAAYSMAL                                                
         JZ    *+8                                                              
         MVI   TX00MAIL,C'Y'                                                    
*                                                                               
         MVI   TX00PCH,C'N'        POUCH SHIPMENT TO CHICAGO                    
         TM    TAAYSTA2,TAAYSPCH                                                
         JZ    *+8                                                              
         MVI   TX00PCH,C'Y'                                                     
*                                                                               
         MVI   TX00OVER,C'N'       OVERNIGHT DELIVERY                           
         TM    TAAYSTA2,TAAYSOVN                                                
         JZ    *+8                                                              
         MVI   TX00OVER,C'Y'                                                    
*                                                                               
         MVI   TX00MCHI,C'N'       MAILED FROM CHICAGO                          
         TM    TAAYSTA2,TAAYSCHI                                                
         JZ    *+8                                                              
         MVI   TX00MCHI,C'Y'                                                    
*                                                                               
         MVI   TX00LOCK,C'N'       AGENCY IS LOCKED                             
         TM    TAAYSTA3,TAAYSLCK                                                
         JZ    *+8                                                              
         MVI   TX00LOCK,C'Y'                                                    
*                                                                               
         MVI   TX00PRIM,C'N'       PRIORITY MAIL                                
         TM    TAAYSTA3,TAAYSPRI                                                
         JZ    *+8                                                              
         MVI   TX00PRIM,C'Y'                                                    
*                                                                               
         MVI   TX00SOAP,C'N'       SOAP RESIDUAL AGENCY                         
         TM    TAAYSTA3,TAAYSRES                                                
         JZ    *+8                                                              
         MVI   TX00SOAP,C'Y'                                                    
*                                                                               
         MVI   TX0030M,C'N'        30 MINUTE SOAP SERIAL                        
         TM    TAAYSTA3,TAAYS30M                                                
         JZ    *+8                                                              
         MVI   TX0030M,C'Y'                                                     
*                                                                               
         MVI   TX00NOSD,C'N'       NO SENDING OF GENERATED ADVICES              
         TM    TAAYSTA3,TAAYSNSD                                                
         JZ    *+8                                                              
         MVI   TX00NOSD,C'Y'                                                    
*                                                                               
         MVI   TX00CAST,C'N'       CAST SUPPRESSED WHEN ADDING ADVICES          
         TM    TAAYSTA3,TAAYSNCS                                                
         JZ    *+8                                                              
         MVI   TX00CAST,C'Y'                                                    
*                                                                               
         MVI   TX00TNX,C'N'        TNX/TAG PRINT AT AGENCY                      
         TM    TAAYSTA3,TAAYSPNX                                                
         JZ    *+8                                                              
         MVI   TX00TNX,C'Y'                                                     
*                                                                               
         MVI   TX00AADV,C'N'       AUTO NUMBERED ADVICES                        
         TM    TAAYSTA3,TAAYSADV                                                
         JZ    *+8                                                              
         MVI   TX00AADV,C'Y'                                                    
*                                                                               
         MVI   TX00GTRK,C'N'       NO GTRACK REPORTS                            
         TM    TAAYSTA4,TAAYSNGT                                                
         JZ    *+8                                                              
         MVI   TX00GTRK,C'Y'                                                    
*                                                                               
         MVI   TX00CLPO,C'N'       CLOSE THE PO                                 
         TM    TAAYSTA4,TAAYSCPO                                                
         JZ    *+8                                                              
         MVI   TX00CLPO,C'Y'                                                    
*                                                                               
         MVI   TX00LATE,C'N'       LATE NIGHT USES                              
         TM    TAAYSTA4,TAAYSLN                                                 
         JZ    *+8                                                              
         MVI   TX00LATE,C'Y'                                                    
*                                                                               
         MVI   TX00NHAN,C'N'       NO HANDLING ON PRINT AGENCY CHECKS           
         TM    TAAYSTA4,TAAYSNHD                                                
         JZ    *+8                                                              
         MVI   TX00NHAN,C'Y'                                                    
*                                                                               
         MVI   TX00CODP,C'N'       COD AGENCY ON PROD INT                       
         TM    TAAYSTA4,TAAYINTC                                                
         JZ    *+8                                                              
         MVI   TX00CODP,C'Y'                                                    
*                                                                               
         MVI   TX00CLER,C'N'       DO NOT CLEAR EST# ON ADVICE                  
         TM    TAAYSTA4,TAAYDCAE                                                
         JZ    *+8                                                              
         MVI   TX00CLER,C'Y'                                                    
*                                                                               
         MVI   TX00ADSX,C'N'       ADVICE SESSIONS PULL EXTRAS                  
         TM    TAAYSTA4,TAAYAEXT                                                
         JZ    *+8                                                              
         MVI   TX00ADSX,C'Y'                                                    
*                                                                               
         MVI   TX00VPON,C'N'       VALIDATE PO NUMBER                           
         TM    TAAYSTA4,TAAYPOV                                                 
         JZ    *+8                                                              
         MVI   TX00VPON,C'Y'                                                    
*&&DO                              SPSUG-1239                                   
         MVI   TX00SPTI,C'N'       CAN USE SPOT INTERFACE                       
         TM    TAAYSTA5,TAAYSPTI                                                
         JZ    *+8                                                              
*&&                                                                             
         MVI   TX00SPTI,C'Y'                                                    
*&&DO                              SPSUG-1239                                   
         MVI   TX00NETI,C'N'       CAN USE NET INTERFACE                        
         TM    TAAYSTA4,TAAYNETI                                                
         JZ    *+8                                                              
*&&                                                                             
         MVI   TX00NETI,C'Y'                                                    
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TABRD,R5                                                         
TLXAG90  MVC   TX00RCV,TABRRECV    RECEIVABLE ACCOUNT                           
         MVC   TX00GRUL,TABRHRLS   APPLIED GRT HANDLING RULE                    
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TABRTYPE       BILLING TYPE                                 
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00BTYP,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRFUTA       FUTA RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00FUTA,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRSUTA       SUTA RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00SUTA,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRFICA       FICA RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00FICA,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABROVER       OVER FICA RATE                               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00OFIC,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRWCRP       WC CORP RATE                                 
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00WCOR,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRCORP       CORP RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00CORR,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRHAND       HANDLING FEE RATE                            
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00HFR,DUB                                                      
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRCAN        CANADIAN HANDLING FEE RATE                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00CHFR,DUB                                                     
*                                                                               
         MVI   TX00NWRK,C'N'       NETWORK REQUIRED FOR CLA USES                
         TM    TABRSTAT,TABRSNWK                                                
         JZ    *+8                                                              
         MVI   TX00NWRK,C'Y'                                                    
*                                                                               
         MVI   TX00STDR,C'N'       USE STANDARD RATE CARD                       
         TM    TABRSTAT,TABRSSRC                                                
         JZ    *+8                                                              
         MVI   TX00STDR,C'Y'                                                    
*                                                                               
         MVI   TX00PINT,C'N'       ON PRODUCTION INTERFACE                      
         TM    TABRSTAT,TABRSINT                                                
         JZ    *+8                                                              
         MVI   TX00PINT,C'Y'                                                    
*                                                                               
         MVI   TX00CPIN,C'N'       CLIENT LEVEL PRODUCTION INTERFACE            
         TM    TABRSTAT,TABRSCIN                                                
         JZ    *+8                                                              
         MVI   TX00CPIN,C'Y'                                                    
*                                                                               
         MVI   TX00QRTR,C'N'       EST PERIOD = QUARTERS                        
         TM    TABRSTAT,TABRSQTR                                                
         JZ    *+8                                                              
         MVI   TX00QRTR,C'Y'                                                    
*                                                                               
         MVI   TX0075K,C'N'        NO CHARGE ABOVE $75000                       
         TM    TABRSTAT,TABRS75K                                                
         JZ    *+8                                                              
         MVI   TX0075K,C'Y'                                                     
*                                                                               
         MVC   TX00OEMP,TABROEOR   OVERRIDE EMPLOYER                            
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAFLD,R5                                                         
TLXAG100 MVC   TX00FIL1,TAFLFLT1   FILTER 1                                     
         MVC   TX00FIL2,TAFLFLT2   FILTER 2                                     
         MVC   TX00FIL3,TAFLFLT3   FILTER 3                                     
         MVC   TX00FIL4,TAFLFLT4   FILTER 4                                     
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACMD,R5                                                         
TLXAG110 SR    RF,RF               COMMENT ELEMENT                              
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXAG20                                                          
*                                                                               
         LA    RE,TX00EMAL                                                      
         CLI   TACMTYPE,TACMTYPI   EMAIL?                                       
         JE    TLXAG112                                                         
         LA    RE,TX00COMT                                                      
         CLI   TACMTYPE,TACMTYPG   GENERAL COMMENT?                             
         JNE   TLXAG20                                                          
*                                                                               
TLXAG112 EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   0(0,RE),TACMCOMM                                                 
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAGHD,R5                                                         
TLXAG120 SR    R0,R0                                                            
         ICM   R0,3,TAGHHDL        GUARANTEE HANDLING RATE                      
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00GRAT,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,7,TAGHLIM        GUARANTEE LIMIT                              
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX00GLMT,DUB                                                     
         J     TLXAG20                                                          
         DROP  R5                                                               
*                                                                               
TLXAGYXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXNETR - EXTRACT LIMITED NETWORK ID RECORDS - 5301                 *         
***********************************************************************         
         SPACE 1                                                                
TLXNETR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK01CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX01LEN)                                          
         MVC   TLXRETYP,TLXNETQ                                                 
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TX01AGY-1,MXTRTQ                                                 
         MVI   TX01LUID-1,MXTRTQ                                                
         MVI   TX01X,MXTRTQ                                                     
         MVI   TX01X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX01AGY,TLAYAGY     AGENCY                                       
*                                                                               
         LA    R5,TLAYELEM         R5=A(FIRST ELEMENT)                          
TLXNET10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXNETXX                                                         
         CLI   0(R5),TANLELQ       NETWORK USERID LIMIT ELEMENT X'16'           
         JE    TLXNET30                                                         
*                                                                               
TLXNET20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXNET10                                                         
*                                                                               
* NEED TO CREATE RECORD FOR EACH USER ID                                        
*                                                                               
         USING TANLD,R5                                                         
TLXNET30 SR    R0,R0                                                            
         ICM   R0,1,TANLNUID       NUMBER OF LIMITED NETWORK USERIDS            
         N     R0,=XL4'0000007F'                                                
*                                                                               
         SR    RF,RF               NETWORK USERIDS                              
         IC    RF,TANLLEN                                                       
         SHI   RF,4                                                             
         JM    TLXNET20                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX01LUID(0),TANLXID                                              
         J     TLXNET20                                                         
         DROP  R5                                                               
*                                                                               
TLXNETXX J     EXIT                                                             
         DROP  R2,R3,R4                                                         
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXAGGC - EXTRACT AGENCY GROUP RECORDS - 5302                       *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(AGENCY GROUP RECORD)                                          *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
TLXAGGC  NMOD1 WORKX-WORKD,*TLXAGG*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXAGGLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLAGD,R3            R3=A(AGENCY GROUP RECORD)                    
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         SR    R0,R0               INITIALIZE TLXRECD TO SPACES                 
         SR    R1,R1                                                            
         ICM   R1,8,SPACES                                                      
         LR    RE,R2                                                            
         AHI   RE,TLXREHDL                                                      
         LA    RF,TX02LEN                                                       
         SHI   RF,TLXREHDL                                                      
         MVCL  RE,R0                                                            
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX02LEN)                                          
         MVC   TLXRETYP,TLXAGGQ                                                 
*                                                                               
         MVI   TX02AGG-1,MXTRTQ                                                 
         MVI   TX02NAME-1,MXTRTQ                                                
         MVI   TX02SNME-1,MXTRTQ                                                
         MVI   TX02X,MXTRTQ                                                     
         MVI   TX02X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX02AGG,TLAGAGG     AGENCY GROUP                                 
*                                                                               
         LA    R5,TLAGELEM         R5=A(FIRST ELEMENT)                          
TLXAGG10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXAGGXX                                                         
         CLI   0(R5),TANAELQ       NAME ELEMENT X'20'                           
         JE    TLXAGG30                                                         
         CLI   0(R5),TASNELQ       SHORT NAME ELEMENT X'21'                     
         JE    TLXAGG40                                                         
*                                                                               
TLXAGG20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXAGG10                                                         
*                                                                               
         USING TANAD,R5                                                         
TLXAGG30 SR    RF,RF               NAME                                         
         IC    RF,TANALEN                                                       
         SHI   RF,3                                                             
         JM    TLXAGGXX                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX02NAME(0),TANANAME                                             
         J     TLXAGG20                                                         
         DROP  R5                                                               
*                                                                               
         USING TASND,R5                                                         
TLXAGG40 MVC   TX02SNME,TASNAME    SHORT NAME                                   
         J     TLXAGG20                                                         
         DROP  R5                                                               
*                                                                               
TLXAGGXX J     EXIT                                                             
         DROP  R2,R3,R4                                                         
*                                                                               
TLXAGGLT DC    A(LITERAL)                                                       
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXW4RC - EXTRACT W-R RECORDS - 5303                                *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(W4 RECORD)                                                    *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
* AL4 A(PKCNTS) - RECORD ACCUMULATORS                                 *         
***********************************************************************         
         SPACE 1                                                                
TLXW4RC  NMOD1 WORKX-WORKD,*TLXW4R*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXW4RLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         MVC   APKCNTS,16(R1)                                                   
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLW4D,R3            R3=A(W4 RECORD)                              
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         CLI   8(R1),1                                                          
         JL    TLXW4KIL            BUILD K RECORD                               
         JE    TLXW4BLD            BUILD COMMERCIAL AND SUBSET RECS             
         JH    TLXW4NXT            OUTPUT NEXT RECORD                           
*                                                                               
TLXW4RCC DC    A(BUFFER1)          AGENCY SAVE AREA                             
TLXW4RLT DC    A(LITERAL)                                                       
         EJECT                                                                  
***********************************************************************         
* BUILD 'K' RECORD AND EXIT                                           *         
***********************************************************************         
TLXW4KIL DS    0H                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* GET NEXT RECORD AND PASS IT BACK                                    *         
***********************************************************************         
         SPACE 1                                                                
TLXW4NXT L     RE,ANEXT                                                         
         OC    0(8,RE),0(RE)                                                    
         JNZ   *+12                                                             
         MVI   8(R1),X'FF'         NO MORE RECORDS                              
         J     EXIT                                                             
*                                                                               
         L     RE,ANEXT            MOVE IN NEXT RECORD                          
         LA    R0,TLXRECD                                                       
         LH    RF,=Y(TX03LEN)                                                   
         LR    R1,RF                                                            
         MVCL  R0,RE                                                            
*                                                                               
         LH    RF,=Y(TX03LEN)      UPDATE POINTER                               
         L     RE,ANEXT                                                         
         AR    RE,RF                                                            
         ST    RE,ANEXT                                                         
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* BUILD SERIES OF RECORDS FOR THIS RECORD                             *         
***********************************************************************         
         SPACE 1                                                                
TLXW4BLD MVC   SVACT,TLXREACT      SAVE ACTION                                  
         MVC   SVDAT,TLXREDAT      SAVE DATE                                    
         MVC   SVTIM,TLXRETIM      SAVE TIME                                    
*                                                                               
         BAS   RE,TLXW4RR          BUILD W-4 RECORD                             
         BAS   RE,TLXPIDR          BUILD PID RECORD                             
*                                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXW4RR - EXTRACT W-R RECORDS - 5303                                *         
***********************************************************************         
         SPACE 1                                                                
TLXW4RR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK03CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX03LEN)                                          
         MVC   TLXRETYP,TLXW4Q                                                  
*                                                                               
         MVI   TX03SSN-1,MXTRTQ                                                 
         MVI   TX03FNME-1,MXTRTQ                                                
         MVI   TX03MNME-1,MXTRTQ                                                
         MVI   TX03LNME-1,MXTRTQ                                                
         MVI   TX03SUFF-1,MXTRTQ                                                
         MVI   TX03TEL-1,MXTRTQ                                                 
         MVI   TX03AKAF-1,MXTRTQ                                                
         MVI   TX03AKAL-1,MXTRTQ                                                
         MVI   TX03CNME-1,MXTRTQ                                                
         MVI   TX03ADD1-1,MXTRTQ                                                
         MVI   TX03ADD2-1,MXTRTQ                                                
         MVI   TX03ADD3-1,MXTRTQ                                                
         MVI   TX03CITY-1,MXTRTQ                                                
         MVI   TX03STAT-1,MXTRTQ                                                
         MVI   TX03ZIP-1,MXTRTQ                                                 
         MVI   TX03SEX-1,MXTRTQ                                                 
         MVI   TX03TID-1,MXTRTQ                                                 
         MVI   TX03TUNT-1,MXTRTQ                                                
         MVI   TX03CNUM-1,MXTRTQ                                                
         MVI   TX03CID-1,MXTRTQ                                                 
         MVI   TX03INDD-1,MXTRTQ                                                
         MVI   TX03AFML-1,MXTRTQ                                                
         MVI   TX03ACTR-1,MXTRTQ                                                
         MVI   TX03TYPE-1,MXTRTQ                                                
         MVI   TX03NYTD-1,MXTRTQ                                                
         MVI   TX03DUE-1,MXTRTQ                                                 
         MVI   TX03LIEN-1,MXTRTQ                                                
         MVI   TX03SIRS-1,MXTRTQ                                                
         MVI   TX03NCHG-1,MXTRTQ                                                
         MVI   TX03NWIT-1,MXTRTQ                                                
         MVI   TX03GRTS-1,MXTRTQ                                                
         MVI   TX03SCHK-1,MXTRTQ                                                
         MVI   TX03NPEN-1,MXTRTQ                                                
         MVI   TX03NDUE-1,MXTRTQ                                                
         MVI   TX03DIRD-1,MXTRTQ                                                
         MVI   TX03WIRE-1,MXTRTQ                                                
         MVI   TX03FADD-1,MXTRTQ                                                
         MVI   TX03LOCK-1,MXTRTQ                                                
         MVI   TX03IRSL-1,MXTRTQ                                                
         MVI   TX03NFIC-1,MXTRTQ                                                
         MVI   TX03SLET-1,MXTRTQ                                                
         MVI   TX03EMPL-1,MXTRTQ                                                
         MVI   TX03FARA-1,MXTRTQ                                                
         MVI   TX03SARA-1,MXTRTQ                                                
         MVI   TX03CARA-1,MXTRTQ                                                
         MVI   TX03FMAR-1,MXTRTQ                                                
         MVI   TX03SMAR-1,MXTRTQ                                                
         MVI   TX03CMAR-1,MXTRTQ                                                
         MVI   TX03FEXP-1,MXTRTQ                                                
         MVI   TX03SEXP-1,MXTRTQ                                                
         MVI   TX03CEXP-1,MXTRTQ                                                
         MVI   TX03FFIX-1,MXTRTQ                                                
         MVI   TX03SFIX-1,MXTRTQ                                                
         MVI   TX03CFIX-1,MXTRTQ                                                
         MVI   TX03RSTE-1,MXTRTQ                                                
         MVI   TX03RACE-1,MXTRTQ                                                
         MVI   TX03FEQW-1,MXTRTQ                                                
         MVI   TX03DOB-1,MXTRTQ                                                 
         MVI   TX03DED-1,MXTRTQ                                                 
         MVI   TX03TRUS-1,MXTRTQ                                                
         MVI   TX03MLIF-1,MXTRTQ                                                
         MVI   TX03ATP-1,MXTRTQ                                                 
         MVI   TX03APG-1,MXTRTQ                                                 
         MVI   TX03APP-1,MXTRTQ                                                 
         MVI   TX03OTYP-1,MXTRTQ                                                
         MVI   TX03MOTN-1,MXTRTQ                                                
         MVI   TX03PCHR-1,MXTRTQ                                                
         MVI   TX03GSTN-1,MXTRTQ                                                
         MVI   TX03COMT-1,MXTRTQ                                                
         MVI   TX03FIL1-1,MXTRTQ                                                
         MVI   TX03FIL2-1,MXTRTQ                                                
         MVI   TX03FIL3-1,MXTRTQ                                                
         MVI   TX03FIL4-1,MXTRTQ                                                
         MVI   TX03PNME-1,MXTRTQ                                                
         MVI   TX03PAD1-1,MXTRTQ                                                
         MVI   TX03PAD2-1,MXTRTQ                                                
         MVI   TX03PAD3-1,MXTRTQ                                                
         MVI   TX03PAD4-1,MXTRTQ                                                
         MVI   TX03PEXD-1,MXTRTQ                                                
         MVI   TX03X,MXTRTQ                                                     
         MVI   TX03X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX03SSN,TLW4SSN     SOCIAL SECURITY NUMBER                       
*                                                                               
         LH    RF,=Y(TX03LEN)                                                   
         STH   RF,RECLEN                                                        
         L     R2,TLXW4RCC         WHERE RECORDS TO BE BUILT                    
         XC    0(8,R2),0(R2)                                                    
         ST    R2,ANEXT            FOR NEXT TIME IN                             
*                                                                               
         L     RE,TXREC            BLANK RECORD HERE                            
         LR    R0,R2                                                            
         LH    RF,RECLEN                                                        
         LR    R1,RF                                                            
         MVCL  R0,RE               COPY IN A BLANK RECORD                       
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           FOR NEXT ROUTINE                             
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         LA    R5,TLW4ELEM         R5=A(FIRST ELEMENT)                          
TLXW410  CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXW4RXX                                                         
         CLI   0(R5),TAA2ELQ       2ND ADDRESS ELEMENT X'23'                    
         JE    TLXW430                                                          
         CLI   0(R5),TANUELQ       FREE FORM ELEMENT X'25'                      
         JE    TLXW440                                                          
         CLI   0(R5),TAFLELQ       FILTER ELEMENT X'30'                         
         JE    TLXW450                                                          
         CLI   0(R5),TATIELQ       TAX ID ELEMENT X'76'                         
         JE    TLXW460                                                          
         CLI   0(R5),TAW4ELQ       W4 DETAILS ELEMENT X'78'                     
         JE    TLXW470                                                          
         CLI   0(R5),TAAKELQ       AKA NAME ELEMENT X'79'                       
         JE    TLXW480                                                          
         CLI   0(R5),TAWHELQ       WITHHOLDING DETAIL ELEMENT X'7A'             
         JE    TLXW490                                                          
         CLI   0(R5),TAOWELQ       OTHER WITHHOLDING ELEMENT X'7B'              
         JE    TLXW4100                                                         
         CLI   0(R5),TAPEELQ       PAYEE ELEMENT X'7C'                          
         JE    TLXW4110                                                         
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXW4120                                                         
         CLI   0(R5),TAWXELQ       EXTRA DETAILS ELEMENT X'F8'                  
         JE    TLXW4130                                                         
*                                                                               
TLXW420  SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXW410                                                          
*                                                                               
         USING TAA2D,R5                                                         
TLXW430  MVC   TX03ADD1,TAA2ADD1   ADDRESS 1                                    
         MVC   TX03ADD2,TAA2ADD2   ADDRESS 2                                    
         MVC   TX03ADD3,TAA2ADD3   ADDRESS 2                                    
         MVC   TX03CITY,TAA2CITY   CITY                                         
         MVC   TX03STAT,TAA2ST     STATE                                        
         MVC   TX03ZIP,TAA2ZIP     ZIP                                          
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TANUD,R5                                                         
TLXW440  DS    0H                  FREE FORM ELEMENT                            
         SR    RF,RF                                                            
         IC    RF,TANULEN                                                       
         SHI   RF,4                                                             
         JM    TLXW420                                                          
*                                                                               
         LA    RE,TX03TEL                                                       
         CLI   TANUTYPE,TANUTPHN   TELEPHONE?                                   
         JE    TLXW442                                                          
         LA    RE,TX03ACTR                                                      
         CLI   TANUTYPE,TANUTMEM   ACTRA MEMBERSHIP?                            
         JE    TLXW442                                                          
         LA    RE,TX03GSTN                                                      
         CLI   TANUTYPE,TANUTGST   GST TAX NUMBER?                              
         JNE   TLXW420                                                          
*                                                                               
TLXW442  EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   0(0,RE),TANUMBER                                                 
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TAFLD,R5                                                         
TLXW450  MVC   TX03FIL1,TAFLFLT1   FILTER 1                                     
         MVC   TX03FIL2,TAFLFLT2   FILTER 2                                     
         MVC   TX03FIL3,TAFLFLT3   FILTER 3                                     
         MVC   TX03FIL4,TAFLFLT4   FILTER 4                                     
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TATID,R5                                                         
TLXW460  MVC   TX03TID,TATITYPE    TAX ID TYPE                                  
         MVC   TX03TUNT,TATIUNIT   TAX UNIT                                     
         OC    TX03TUNT,SPACES      IN CASE OF BINARY ZEROS                     
         MVC   TX03CNUM,TATICRPN   CORPORATE NUMBER                             
         MVC   TX03CID,TATIID      CORPORATE FEDERAL TAX ID                     
         OC    TX03CID,SPACES      CHANGE ZEROS TO SPACES                       
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TAW4D,R5                                                         
TLXW470  CLI   TAW4TYPE,TAW4TYCO   DONT DO F/M/L NAMES FOR CORP                 
         BE    TLXW472                                                          
         MVC   TX03FNME,TAW4NAM1   FIRST NAME                                   
         MVC   TX03MNME,TAW4MIDN   MIDDLE NAME                                  
         MVC   TX03LNME,TAW4NAM2   LAST NAME                                    
*                                                                               
         CLC   =CL16'NULL',TAW4NAM2    IS LAST NAME NULL?                       
         BNE   *+10                                                             
         MVC   TX03LNME,=CL16'"NULLS"' PUT LAST NAME IN QUOTES                  
*                                                                               
TLXW472  MVC   TX03SUFF,TAW4SUFF   SUFFIX                                       
         CLI   TAW4TYPE,TAW4TYCO   IS THIS AN CORPORATION?                      
         BNE   *+10                                                             
         MVC   TX03CNME,TAW4CRPN   CORPORATION NAME                             
         MVC   TX03SEX,TAW4SEX     SEX                                          
         OC    TAW4INDT,TAW4INDT   INDEMNIFICATION DATE                         
         JZ    TLXW474                                                          
         GOTO1 DATCON,DMCB,(X'01',TAW4INDT),(10,TX03INDD)                       
*                                                                               
TLXW474  MVC   TX03AFML,TAW4LOCL   AFM LOCAL CHAPTER                            
         MVC   TX03TYPE,TAW4TYPE   TYPE                                         
*                                                                               
         MVI   TX03NYTD,C'N'       NO YTD ON CHECKS (Y/N)                       
         TM    TAW4STAT,TAW4STNY                                                
         JZ    *+8                                                              
         MVI   TX03NYTD,C'Y'                                                    
*                                                                               
         MVI   TX03DUE,C'N'        DUE COMPANY RECORDDS PRESENT (Y/N)           
         TM    TAW4STAT,TAW4STDU                                                
         JZ    *+8                                                              
         MVI   TX03DUE,C'Y'                                                     
*                                                                               
         MVI   TX03LIEN,C'N'       LIEN RECORDS PRESENT (Y/N)                   
         TM    TAW4STAT,TAW4STLN                                                
         JZ    *+8                                                              
         MVI   TX03LIEN,C'Y'                                                    
*                                                                               
         MVI   TX03SIRS,C'N'       SENT TO IRS FOR >10 EXEMPTS (Y/N)            
         TM    TAW4STAT,TAW4STIR                                                
         JZ    *+8                                                              
         MVI   TX03SIRS,C'Y'                                                    
*                                                                               
         MVI   TX03NCHG,C'N'       CAN'T CHANGE # EMEXPTIONS (Y/N)              
         TM    TAW4STAT,TAW4STMX                                                
         JZ    *+8                                                              
         MVI   TX03NCHG,C'Y'                                                    
*                                                                               
         MVI   TX03NWIT,C'N'       NO WITHHOLDING YET (Y/N)                     
         TM    TAW4STAT,TAW4STNW                                                
         JZ    *+8                                                              
         MVI   TX03NWIT,C'Y'                                                    
*                                                                               
         MVI   TX03GRTS,C'N'       GUARANTEES PRESENT (Y/N)                     
         TM    TAW4STAT,TAW4STGU                                                
         JZ    *+8                                                              
         MVI   TX03GRTS,C'Y'                                                    
*                                                                               
         MVI   TX03SCHK,C'N'       SORT CHECKS FIRST (Y/N)                      
         TM    TAW4STAT,TAW4SCKF                                                
         JZ    *+8                                                              
         MVI   TX03SCHK,C'Y'                                                    
*                                                                               
         MVI   TX03NPEN,C'N'       NO PENSION (Y/N)                             
         TM    TAW4STA2,TAW4SNPE                                                
         JZ    *+8                                                              
         MVI   TX03NPEN,C'Y'                                                    
*                                                                               
         MVI   TX03NDUE,C'N'       NO DUE COMPANY WITHHELD (Y/N)                
         TM    TAW4STA2,TAW4SNDU                                                
         JZ    *+8                                                              
         MVI   TX03NDUE,C'Y'                                                    
*                                                                               
         MVI   TX03DIRD,C'N'       DIRECT DEPOSIT CHECKS (Y/N)                  
         TM    TAW4STA2,TAW4SDD                                                 
         JZ    *+8                                                              
         MVI   TX03DIRD,C'Y'                                                    
*                                                                               
         MVI   TX03WIRE,C'N'       WIRE TRANSFER CHECKS (Y/N)                   
         TM    TAW4STA2,TAW4SWIR                                                
         JZ    *+8                                                              
         MVI   TX03WIRE,C'Y'                                                    
*                                                                               
         MVI   TX03FADD,C'N'       FOREIGN ADDRESS (Y/N)                        
         TM    TAW4STA2,TAW4SFGN                                                
         JZ    *+8                                                              
         MVI   TX03FADD,C'Y'                                                    
*                                                                               
         MVI   TX03LOCK,C'N'       LOCKED (Y/N)                                 
         TM    TAW4STA2,TAW4SLCK                                                
         JZ    *+8                                                              
         MVI   TX03LOCK,C'Y'                                                    
*                                                                               
         MVI   TX03IRSL,C'N'       IRS LOCKED ON FED WITHHOLDING (Y/N)          
         TM    TAW4STA2,TAW4SIRS                                                
         JZ    *+8                                                              
         MVI   TX03IRSL,C'Y'                                                    
*                                                                               
         MVI   TX03NFIC,C'N'       NO FICA WITHHOLDING (Y/N)                    
         TM    TAW4STA2,TAW4SNFI                                                
         JZ    *+8                                                              
         MVI   TX03NFIC,C'Y'                                                    
*                                                                               
         MVI   TX03SLET,C'N'       SPECIAL LETTER ON FILE (Y/N)                 
         TM    TAW4STA3,TAW4SSPL                                                
         JZ    *+8                                                              
         MVI   TX03SLET,C'Y'                                                    
*                                                                               
         MVC   TX03RSTE,TAW4RECP   RECIPROCAL STATE                             
         MVC   TX03RACE,TAW4RACE   RACE                                         
         OC    TX03RACE,SPACES      IN CASE OF BINARY ZEROS                     
         MVC   TX03FEQW,TAW4FREQ   FREQUENCY OF WITHHOLDING                     
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TAAKD,R5                                                         
TLXW480  MVC   TX03AKAF,TAAKNAM1   AKA FIRST NAME                               
         MVC   TX03AKAL,TAAKNAM2   AKA LAST NAME                                
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TAWHD,R5                                                         
TLXW490  MVC   TX03EMPL,TAWHEMP    EMPLOYER                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TAWHEXS        EXEMPTIONS                                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAWHFLAT      FLAT RATE                                    
         CVD   R0,DUB2                                                          
         OI    DUB2+L'DUB2-1,X'0F'                                              
*                                                                               
         CLC   TAWHUNIT,=C'FD '    FEDERAL?                                     
         JNE   TLXW492                                                          
         MVC   TX03FARA,TAWHUNIT   FEDERAL AREA                                 
         MVC   TX03FMAR,TAWHSTAT   MARTIAL STATUS                               
         UNPK  TX03FEXP,DUB        EXEMPTIONS                                   
         UNPK  TX03FFIX,DUB2       FIXED RATE                                   
         J     TLXW420                                                          
*                                                                               
TLXW492  CLI   TAWHUNIT+2,X'40'    STATE?                                       
         JH    TLXW494                                                          
         MVC   TX03SARA,TAWHUNIT   STATE AREA                                   
         MVC   TX03SMAR,TAWHSTAT   MARTIAL STATUS                               
         UNPK  TX03SEXP,DUB        EXEMPTIONS                                   
         UNPK  TX03SFIX,DUB2       FIXED RATE                                   
         J     TLXW420                                                          
*                                                                               
TLXW494  MVC   TX03CARA,TAWHUNIT   CITYE AREA                                   
         MVC   TX03CMAR,TAWHSTAT   MARTIAL STATUS                               
         UNPK  TX03CEXP,DUB        EXEMPTIONS                                   
         UNPK  TX03CFIX,DUB2       FIXED RATE                                   
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TAOWD,R5                                                         
TLXW4100 MVC   TX03OTYP,TAOWTYPE   OTHER WITHHOLDING TYPE                       
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAOWFLAT      FLAT RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
*                                                                               
         CLI   TAOWTYPE,TAOWTMPF   MOTION PICTURE FUND                          
         JNE   TLXW4102                                                         
         UNPK  TX03MOTN,DUB                                                     
         J     TLXW420                                                          
*                                                                               
TLXW4102 CLI   TAOWTYPE,TAOWTCHA   PERMANENT CHARITY                            
         JNE   TLXW420                                                          
         UNPK  TX03PCHR,DUB                                                     
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TAPED,R5                                                         
TLXW4110 MVC   TX03PNME,TAPENAME   PAYEE NAME                                   
         MVC   TX03PAD1,TAPEADD1   PAYEE ADDRESS 1                              
         MVC   TX03PAD2,TAPEADD2   PAYEE ADDRESS 2                              
         MVC   TX03PAD3,TAPEADD3   PAYEE ADDRESS 3                              
         MVC   TX03PAD4,TAPEADD4   PAYEE ADDRESS 4                              
*                                                                               
         OC    TAPEEXP,TAPEEXP     PAYEE EXPIRY DATE                            
         JZ    TLXW420                                                          
         GOTO1 DATCON,DMCB,(X'01',TAPEEXP),(10,TX03PEXD)                        
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TACMD,R5                                                         
TLXW4120 CLI   TACMTYPE,TACMTYPG   GENERAL COMMENT                              
         JNE   TLXW420                                                          
*                                                                               
         SR    RF,RF                                                            
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXW420                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX03COMT(0),TACMCOMM                                             
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
         USING TAWXD,R5                                                         
TLXW4130 OC    TAWXDOB,TAWXDOB     DATE OF BIRTH                                
         JZ    TLXW4132                                                         
         GOTO1 DATCON,DMCB,(X'01',TAWXDOB),(10,TX03DOB)                         
*                                                                               
TLXW4132 SR    R0,R0                                                            
         ICM   R0,15,TAWXPCT       DEDUCT %                                     
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX03DED,DUB                                                      
*                                                                               
         MVC   TX03TRUS,TAWXTSSN   TRUSTEE SSN                                  
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAWXMERN      MINOR LIFETIME EARNINGS                      
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX03MLIF,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAWXHTP       AMOUNT COLLECTED & HELP FOR TP               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX03ATP,DUB                                                      
*                                                                               
         SR    R0,R0                                                            
*        ICM   R0,15,TAWXHPG       AMOUNT COLLECTED & HELP FOR PG               
         ICM   R0,15,TAWXHPPL      AMOUNT COLLECTED & HELP FOR P+               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX03APG,DUB                                                      
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAWXHPP       AMOUNT COLLECTED & HELP FOR PP               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX03APP,DUB                                                      
         J     TLXW420                                                          
         DROP  R5                                                               
*                                                                               
TLXW4RXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXPIDR - EXTRACT PID RECORD - 5321                                 *         
***********************************************************************         
         SPACE 1                                                                
TLXPIDR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK21CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX21LEN)                                          
         MVC   TLXRETYP,TLXPIDQ                                                 
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVC   TX21SSN,TLW4SSN     SOCIAL SECURITY NUMBER                       
*                                                                               
         LA    R5,TLW4ELEM         R5=A(FIRST ELEMENT)                          
TLXPID10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXPIDX                                                          
         CLI   0(R5),TANUELQ       FREE FORM ELEMENT X'25'                      
         JE    TLXPID30                                                         
*                                                                               
TLXPID20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXPID10                                                         
*                                                                               
         USING TANUD,R5                                                         
TLXPID30 DS    0H                  FREE FORM ELEMENT                            
         SR    RF,RF                                                            
         IC    RF,TANULEN                                                       
         SHI   RF,4                                                             
         JM    TLXPID20                                                         
*                                                                               
         CLI   TANUTYPE,TANUPIDN   PID NUMBER                                   
         JNE   TLXPID20                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX21PID(0),TANUMBER                                              
         OC    TX21PID,SPACES                                                   
         J     TLXPID20                                                         
         DROP  R5                                                               
*                                                                               
TLXPIDX  J     EXIT                                                             
         DROP  R2,R3,R4                                                         
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXAGTC - EXTRACT AGENT RECORDS - 5304                              *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(AGENT RECORD)                                                 *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
TLXAGTC  NMOD1 WORKX-WORKD,*TLXAGT*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXAGTLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLAND,R3            R3=A(AGENT RECORD)                           
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         SR    R0,R0               INITIALIZE TLXRECD TO SPACES                 
         SR    R1,R1                                                            
         ICM   R1,8,SPACES                                                      
         LR    RE,R2                                                            
         AHI   RE,TLXREHDL                                                      
         LA    RF,TX04LEN                                                       
         SHI   RF,TLXREHDL                                                      
         MVCL  RE,R0                                                            
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX04LEN)                                          
         MVC   TLXRETYP,TLXAGTQ                                                 
*                                                                               
         MVI   TX04AGT-1,MXTRTQ                                                 
         MVI   TX04NAME-1,MXTRTQ                                                
         MVI   TX04SNME-1,MXTRTQ                                                
         MVI   TX04ADD1-1,MXTRTQ                                                
         MVI   TX04ADD2-1,MXTRTQ                                                
         MVI   TX04ADD3-1,MXTRTQ                                                
         MVI   TX04ADD4-1,MXTRTQ                                                
         MVI   TX04EMAL-1,MXTRTQ                                                
         MVI   TX04ATTN-1,MXTRTQ                                                
         MVI   TX04SSN-1,MXTRTQ                                                 
         MVI   TX04TEL-1,MXTRTQ                                                 
         MVI   TX04FAX-1,MXTRTQ                                                 
         MVI   TX04ISAG-1,MXTRTQ                                                
         MVI   TX04OVER-1,MXTRTQ                                                
         MVI   TX04OTRC-1,MXTRTQ                                                
         MVI   TX04X,MXTRTQ                                                     
         MVI   TX04X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX04AGT,TLANAGT     AGENT                                        
*                                                                               
         LA    R5,TLANELEM         R5=A(FIRST ELEMENT)                          
TLXAGT10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXAGTXX                                                         
         CLI   0(R5),TANAELQ       NAME ELEMENT X'20'                           
         JE    TLXAGT30                                                         
         CLI   0(R5),TASNELQ       SHORT NAME ELEMENT X'21'                     
         JE    TLXAGT40                                                         
         CLI   0(R5),TAADELQ       ADDRESS ELEMENT X'22'                        
         JE    TLXAGT50                                                         
         CLI   0(R5),TANUELQ       FREE FORM ELEMENT X'25'                      
         JE    TLXAGT60                                                         
         CLI   0(R5),TAFNELQ       FREE FORM NAME ELEMENT X'26'                 
         JE    TLXAGT70                                                         
         CLI   0(R5),TAANELQ       AGENT ELEMENT X'64'                          
         JE    TLXAGT80                                                         
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXAGT90                                                         
*                                                                               
TLXAGT20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXAGT10                                                         
*                                                                               
         USING TANAD,R5                                                         
TLXAGT30 SR    RF,RF               NAME                                         
         IC    RF,TANALEN                                                       
         SHI   RF,3                                                             
         JM    TLXAGTXX                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX04NAME(0),TANANAME                                             
         J     TLXAGT20                                                         
         DROP  R5                                                               
*                                                                               
         USING TASND,R5                                                         
TLXAGT40 MVC   TX04SNME,TASNAME    SHORT NAME                                   
         J     TLXAGT20                                                         
         DROP  R5                                                               
*                                                                               
         USING TAADD,R5                                                         
TLXAGT50 SR    R0,R0               ADDRESS                                      
         ICM   R0,1,TAADLNES       NUMBER OF ADDRESS LINES                      
         JZ    TLXAGT20                                                         
         LA    RF,TAADADD          POINT TO 1ST ELEMENT LINE                    
         LA    RE,TX04ADD1         POINT TO FIRST TABLE LINE                    
*                                                                               
TLXAGT52 MVC   0(L'TX04ADD1,RE),0(RF)   MOVE IN CURRENT LINE                    
         OC    0(L'TX04ADD1,RE),SPACES                                          
         LA    RE,TX04ADDQ(RE)     SKIP TO NEXT LINE IN TAB                     
         LA    RF,L'TAADADD(RF)    SKIP TO NEXT LINE IN ELM                     
         JCT   R0,TLXAGT52                                                      
         J     TLXAGT20                                                         
         DROP  R5                                                               
*                                                                               
         USING TANUD,R5                                                         
TLXAGT60 CLI   TANUTYPE,TANUTFAX   FAX                                          
         JNE   TLXAGT20                                                         
         SR    RF,RF                                                            
         IC    RF,TANULEN                                                       
         SHI   RF,3                                                             
         JM    TLXAGT20                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX04FAX(0),TANUMBER                                              
         J     TLXAGT20                                                         
         DROP  R5                                                               
*                                                                               
         USING TAFND,R5                                                         
TLXAGT70 CLI   TAFNTYPE,TAFNTATT   ATTENTION                                    
         JNE   TLXAGT20                                                         
         SR    RF,RF                                                            
         IC    RF,TAFNLEN                                                       
         SHI   RF,4                                                             
         JM    TLXAGT20                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX04ATTN(0),TAFNNAME                                             
         J     TLXAGT20                                                         
         DROP  R5                                                               
*                                                                               
         USING TAAND,R5                                                         
TLXAGT80 MVC   TX04SSN,TAANSSN     SSN                                          
         MVC   TX04TEL,TAANTEL     TELEPHONE                                    
         OC    TX04TEL,SPACES       IN CASE OF BINARY ZEROS                     
*                                                                               
         MVI   TX04ISAG,C'N'       IGNORE ON SAG CHECKS (Y/N)                   
         TM    TAANSTAT,TAANSNCK                                                
         JZ    *+8                                                              
         MVI   TX04ISAG,C'Y'                                                    
*                                                                               
         MVI   TX04OVER,C'N'       ALLOWABLE OVERRIDE (Y/N)                     
         TM    TAANSTAT,TAANSOVR                                                
         JZ    *+8                                                              
         MVI   TX04OVER,C'Y'                                                    
*                                                                               
         MVC   TX04OTRC,TAANTNR    OLD TALENT & RESIDUAL CODE                   
         J     TLXAGT20                                                         
         DROP  R5                                                               
*                                                                               
         USING TACMD,R5                                                         
TLXAGT90 CLI   TACMTYPE,TACMTYPI   EMAIL                                        
         JNE   TLXAGT20                                                         
*                                                                               
         SR    RF,RF                                                            
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXAGT20                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX04EMAL(0),TACMCOMM                                             
         J     TLXAGT20                                                         
         DROP  R5                                                               
*                                                                               
TLXAGTXX J     EXIT                                                             
         DROP  R2,R3,R4                                                         
*                                                                               
TLXAGTLT DC    A(LITERAL)                                                       
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXCLIC - EXTRACT CLIENT RECORDS - 5305                             *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(CLIENT RECORD)                                                *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
TLXCLIC  NMOD1 WORKX-WORKD,*TLXCLI*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXCLILT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLCLD,R3            R3=A(CLIENT RECORD)                          
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         SR    R0,R0               INITIALIZE TLXRECD TO SPACES                 
         SR    R1,R1                                                            
         ICM   R1,8,SPACES                                                      
         LR    RE,R2                                                            
         AHI   RE,TLXREHDL                                                      
         LA    RF,TX05LEN                                                       
         SHI   RF,TLXREHDL                                                      
         MVCL  RE,R0                                                            
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX05LEN)                                          
         MVC   TLXRETYP,TLXCLIQ                                                 
*                                                                               
         MVI   TX05AGY-1,MXTRTQ                                                 
         MVI   TX05CLI-1,MXTRTQ                                                 
         MVI   TX05NAME-1,MXTRTQ                                                
         MVI   TX05SNME-1,MXTRTQ                                                
         MVI   TX05ADD1-1,MXTRTQ                                                
         MVI   TX05ADD2-1,MXTRTQ                                                
         MVI   TX05ADD3-1,MXTRTQ                                                
         MVI   TX05ADD4-1,MXTRTQ                                                
         MVI   TX05ATTN-1,MXTRTQ                                                
         MVI   TX05EMAL-1,MXTRTQ                                                
         MVI   TX05SIGN-1,MXTRTQ                                                
         MVI   TX05CGRP-1,MXTRTQ                                                
         MVI   TX05LOCK-1,MXTRTQ                                                
         MVI   TX05CODC-1,MXTRTQ                                                
         MVI   TX05CLER-1,MXTRTQ                                                
         MVI   TX05HLDS-1,MXTRTQ                                                
         MVI   TX05BTYP-1,MXTRTQ                                                
         MVI   TX05NWRK-1,MXTRTQ                                                
         MVI   TX05STDR-1,MXTRTQ                                                
         MVI   TX05PINT-1,MXTRTQ                                                
         MVI   TX05NPIN-1,MXTRTQ                                                
         MVI   TX05QRTR-1,MXTRTQ                                                
         MVI   TX0575K-1,MXTRTQ                                                 
         MVI   TX05OEMP-1,MXTRTQ                                                
         MVI   TX05FUTA-1,MXTRTQ                                                
         MVI   TX05SUTA-1,MXTRTQ                                                
         MVI   TX05FICA-1,MXTRTQ                                                
         MVI   TX05OFIC-1,MXTRTQ                                                
         MVI   TX05WCOR-1,MXTRTQ                                                
         MVI   TX05CORR-1,MXTRTQ                                                
         MVI   TX05HFR-1,MXTRTQ                                                 
         MVI   TX05CHFR-1,MXTRTQ                                                
         MVI   TX05GRUL-1,MXTRTQ                                                
         MVI   TX05PCLI-1,MXTRTQ                                                
         MVI   TX05X,MXTRTQ                                                     
         MVI   TX05X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX05AGY,TLCLAGY     AGENCY                                       
         MVC   TX05CLI,TLCLCLI     CLIENT                                       
*                                                                               
         LA    R5,TLCLELEM         R5=A(FIRST ELEMENT)                          
TLXCL10  CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXCLIXX                                                         
         CLI   0(R5),TANAELQ       NAME ELEMENT X'20'                           
         JE    TLXCL30                                                          
         CLI   0(R5),TASNELQ       SHORT NAME ELEMENT X'21'                     
         JE    TLXCL40                                                          
         CLI   0(R5),TAADELQ       ADDRESS ELEMENT X'22'                        
         JE    TLXCL50                                                          
         CLI   0(R5),TANUELQ       FREE FORM ELEMENT X'25'                      
         JE    TLXCL60                                                          
         CLI   0(R5),TAFNELQ       FREE FORM NAME ELEMENT X'26'                 
         JE    TLXCL70                                                          
         CLI   0(R5),TABRELQ       BILLING RULES ELEMENT X'2B'                  
         JE    TLXCL80                                                          
         CLI   0(R5),TACIELQ       CLIENT INFORMATION ELEMENT X'2C'             
         JE    TLXCL90                                                          
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXCL100                                                         
         CLI   0(R5),TAISELQ       PRODUCTION INTERFACE SUB X'B2'               
         JE    TLXCL110                                                         
*                                                                               
TLXCL20  SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXCL10                                                          
*                                                                               
         USING TANAD,R5                                                         
TLXCL30  SR    RF,RF               NAME                                         
         IC    RF,TANALEN                                                       
         SHI   RF,3                                                             
         JM    TLXCLIXX                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX05NAME(0),TANANAME                                             
         J     TLXCL20                                                          
         DROP  R5                                                               
*                                                                               
         USING TASND,R5                                                         
TLXCL40  MVC   TX05SNME,TASNAME    SHORT NAME                                   
         J     TLXCL20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAADD,R5                                                         
TLXCL50  SR    R0,R0               ADDRESS                                      
         ICM   R0,1,TAADLNES       NUMBER OF ADDRESS LINES                      
         JZ    TLXCL20                                                          
         LA    RF,TAADADD          POINT TO 1ST ELEMENT LINE                    
         LA    RE,TX05ADD1         POINT TO FIRST TABLE LINE                    
*                                                                               
TLXCL52  MVC   0(L'TX05ADD1,RE),0(RF)   MOVE IN CURRENT LINE                    
         LA    RE,TX05ADDQ(RE)     SKIP TO NEXT LINE IN TAB                     
         LA    RF,L'TAADADD(RF)    SKIP TO NEXT LINE IN ELM                     
         JCT   R0,TLXCL52                                                       
         J     TLXCL20                                                          
         DROP  R5                                                               
*                                                                               
         USING TANUD,R5                                                         
TLXCL60  CLI   TANUTYPE,TANUTSIG   SIGNATORY                                    
         JNE   TLXCL20                                                          
         SR    RF,RF                                                            
         IC    RF,TANULEN                                                       
         SHI   RF,3                                                             
         JM    TLXCL20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX05SIGN(0),TANUMBER                                             
         J     TLXCL20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAFND,R5                                                         
TLXCL70  CLI   TAFNTYPE,TAFNTATT   ATTENTION                                    
         JNE   TLXCL20                                                          
         SR    RF,RF                                                            
         IC    RF,TAFNLEN                                                       
         SHI   RF,4                                                             
         JM    TLXCL20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX05ATTN(0),TAFNNAME                                             
         J     TLXCL20                                                          
         DROP  R5                                                               
*                                                                               
         USING TABRD,R5                                                         
TLXCL80  SR    R0,R0                                                            
         ICM   R0,1,TABRTYPE       BILLING TYPE                                 
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05BTYP,DUB                                                     
*                                                                               
         MVI   TX05NWRK,C'N'       NETWORK REQUIRED FOR CLA USES (Y/N)          
         TM    TABRSTAT,TABRSNWK                                                
         JZ    *+8                                                              
         MVI   TX05NWRK,C'Y'                                                    
*                                                                               
         MVI   TX05STDR,C'N'       USE STANDARD RATE CARD (Y/N)                 
         TM    TABRSTAT,TABRSSRC                                                
         JZ    *+8                                                              
         MVI   TX05STDR,C'Y'                                                    
*                                                                               
         MVI   TX05PINT,C'N'       ON PRODUCTION INTERFACE (Y/N)                
         TM    TABRSTAT,TABRSINT                                                
         JZ    *+8                                                              
         MVI   TX05PINT,C'Y'                                                    
*                                                                               
         MVI   TX05NPIN,C'N'       EXCLUDE FROM CLIENT INTERFACE (Y/N)          
         TM    TABRSTAT,TABRSNIN                                                
         JZ    *+8                                                              
         MVI   TX05NPIN,C'Y'                                                    
*                                                                               
         MVI   TX05QRTR,C'N'       EST PERIOD = QUARTERS (Y/N)                  
         TM    TABRSTAT,TABRSQTR                                                
         JZ    *+8                                                              
         MVI   TX05QRTR,C'Y'                                                    
*                                                                               
         MVI   TX0575K,C'N'        NO CHARGE ABOVE $75000 (Y/N)                 
         TM    TABRSTAT,TABRS75K                                                
         JZ    *+8                                                              
         MVI   TX0575K,C'Y'                                                     
*                                                                               
         MVC   TX05OEMP,TABROEOR   OVERRIDE EMPLOYER                            
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRFUTA       FUTA RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05FUTA,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRSUTA       SUTA RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05SUTA,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRFICA       FICA RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05FICA,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABROVER       OVER FICA RATE                               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05OFIC,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRWCRP       WC CORP RATE                                 
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05WCOR,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRCORP       CORP RATE                                    
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05CORR,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRHAND       HANDLING FEE RATE                            
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05HFR,DUB                                                      
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TABRCAN        CANADIAN HANDLING FEE RATE                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX05CHFR,DUB                                                     
*                                                                               
         MVC   TX05GRUL,TABRHRLS   APPLIED GRT HANDLING RULE                    
         J     TLXCL20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACID,R5                                                         
TLXCL90  MVC   TX05CGRP,TACICLG    CLIENT GROUP                                 
*                                                                               
         MVI   TX05LOCK,C'Y'       LOCKED (Y/N)                                 
         TM    TACISTAT,TACISLCK                                                
         JZ    *+8                                                              
         MVI   TX05LOCK,C'Y'                                                    
*                                                                               
         MVI   TX05CODC,C'Y'        COD CODE (Y/N)                              
         TM    TACISTAT,TACISCOD                                                
         JZ    *+8                                                              
         MVI   TX05CODC,C'Y'                                                    
*                                                                               
         MVI   TX05CLER,C'Y'       DO NOT CLEAR EST# ON ADVICE (Y/N)            
         TM    TACISTAT,TACIDCAE                                                
         JZ    *+8                                                              
         MVI   TX05CLER,C'Y'                                                    
*                                                                               
         MVI   TX05HLDS,C'P'       GENERATE HOLDING FEE ON PAPER ONLY?          
         TM    TACISTAT,TACIHSNC                                                
         JO    TLXCL20                                                          
*                                                                               
         MVI   TX05HLDS,C'E'       NO, ELECTRONIC ONLY?                         
         TM    TACISTAT,TACIHSEL                                                
         JO    TLXCL20                                                          
*                                                                               
         MVI   TX05HLDS,C'B'       NO, BOTH?                                    
         TM    TACISTAT,TACIHSPE                                                
         JO    TLXCL20                                                          
         MVI   TX00HLDS,C' '       NO, LEAVE BLANK                              
         J     TLXCL20                                                          
*                                                                               
         USING TACMD,R5                                                         
TLXCL100 CLI   TACMTYPE,TACMTYPI   EMAIL                                        
         JNE   TLXCL20                                                          
*                                                                               
         SR    RF,RF                                                            
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXCL20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX05EMAL(0),TACMCOMM                                             
         J     TLXCL20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAISD,R5                                                         
TLXCL110 MVC   TX05PCLI,TAISCDE    PRODUCTION CLIENT CODE                       
         J     TLXCL20                                                          
*                                                                               
TLXCLIXX J     EXIT                                                             
         DROP  R2,R3,R4                                                         
*                                                                               
TLXCLILT DC    A(LITERAL)                                                       
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXPRDC - EXTRACT PRODUCT RECORDS - 5306                            *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(PRODUCT RECORD)                                               *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
TLXPRDC  NMOD1 WORKX-WORKD,*TLXPRD*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXPRDLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLPRD,R3            R3=A(PRODUCT RECORD)                         
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         SR    R0,R0               INITIALIZE TLXRECD TO SPACES                 
         SR    R1,R1                                                            
         ICM   R1,8,SPACES                                                      
         LR    RE,R2                                                            
         AHI   RE,TLXREHDL                                                      
         LA    RF,TX06LEN                                                       
         SHI   RF,TLXREHDL                                                      
         MVCL  RE,R0                                                            
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX06LEN)                                          
         MVC   TLXRETYP,TLXPRDQ                                                 
*                                                                               
         MVI   TX06AGY-1,MXTRTQ                                                 
         MVI   TX06CLI-1,MXTRTQ                                                 
         MVI   TX06PRD-1,MXTRTQ                                                 
         MVI   TX06BRND-1,MXTRTQ                                                
         MVI   TX06NAME-1,MXTRTQ                                                
         MVI   TX06SNME-1,MXTRTQ                                                
         MVI   TX06CGRP-1,MXTRTQ                                                
         MVI   TX06PGRP-1,MXTRTQ                                                
         MVI   TX06OACR-1,MXTRTQ                                                
         MVI   TX06PTYP-1,MXTRTQ                                                
         MVI   TX06ADD1-1,MXTRTQ                                                
         MVI   TX06ADD2-1,MXTRTQ                                                
         MVI   TX06ADD3-1,MXTRTQ                                                
         MVI   TX06ADD4-1,MXTRTQ                                                
         MVI   TX06ATTN-1,MXTRTQ                                                
         MVI   TX06EMAL-1,MXTRTQ                                                
         MVI   TX06PPRD-1,MXTRTQ                                                
         MVI   TX06X,MXTRTQ                                                     
         MVI   TX06X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX06AGY,TLPRAGY     AGENCY                                       
         MVC   TX06CLI,TLPRCLI     CLIENT                                       
         MVC   TX06PRD,TLPRPRD     PRODUCT                                      
*                                                                               
         MVI   TX06BRND,C'N'       BRAND PRODUCT                                
         TM    TLPRSTAT,TLPRSBRD                                                
         JZ    *+8                                                              
         MVI   TX06BRND,C'Y'                                                    
*                                                                               
         LA    R5,TLPRELEM         R5=A(FIRST ELEMENT)                          
TLXPR10  CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXPRDXX                                                         
         CLI   0(R5),TANAELQ       NAME ELEMENT X'20'                           
         JE    TLXPR30                                                          
         CLI   0(R5),TASNELQ       SHORT NAME ELEMENT X'21'                     
         JE    TLXPR40                                                          
         CLI   0(R5),TAADELQ       ADDRESS ELEMENT X'22'                        
         JE    TLXPR50                                                          
         CLI   0(R5),TAFNELQ       FREE FORM NAME ELEMENT X'26'                 
         JE    TLXPR70                                                          
         CLI   0(R5),TAPIELQ       PRODUCT INFORMATION ELEMENT X'2D'            
         JE    TLXPR80                                                          
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXPR90                                                          
         CLI   0(R5),TAISELQ       PRODUCTION INTERFACE SUB X'B2'               
         JE    TLXPR100                                                         
         CLI   0(R5),TANUELQ       FREE FORM NUMBER ELEMENT X'25'               
         JE    TLXPR110                                                         
*                                                                               
TLXPR20  SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXPR10                                                          
*                                                                               
         USING TANAD,R5                                                         
TLXPR30  SR    RF,RF               NAME                                         
         IC    RF,TANALEN                                                       
         SHI   RF,3                                                             
         JM    TLXPRDXX                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX06NAME(0),TANANAME                                             
         J     TLXPR20                                                          
         DROP  R5                                                               
*                                                                               
         USING TASND,R5                                                         
TLXPR40  MVC   TX06SNME,TASNAME    SHORT NAME                                   
         J     TLXPR20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAADD,R5                                                         
TLXPR50  SR    R0,R0               ADDRESS                                      
         ICM   R0,1,TAADLNES       NUMBER OF ADDRESS LINES                      
         JZ    TLXPR20                                                          
         LA    RF,TAADADD          POINT TO 1ST ELEMENT LINE                    
         LA    RE,TX06ADD1         POINT TO FIRST TABLE LINE                    
*                                                                               
TLXPR60  MVC   0(L'TX06ADD1,RE),0(RF)   MOVE IN CURRENT LINE                    
         LA    RE,TX06ADDQ(RE)     SKIP TO NEXT LINE IN TAB                     
         LA    RF,L'TAADADD(RF)    SKIP TO NEXT LINE IN ELM                     
         JCT   R0,TLXPR60                                                       
         J     TLXPR20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAFND,R5                                                         
TLXPR70  CLI   TAFNTYPE,TAFNTATT   ATTENTION                                    
         JNE   TLXPR20                                                          
         SR    RF,RF                                                            
         IC    RF,TAFNLEN                                                       
         SHI   RF,4                                                             
         JM    TLXPR20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX06ATTN(0),TAFNNAME                                             
         J     TLXPR20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAPID,R5                                                         
TLXPR80  MVC   TX06CGRP,TAPICLG    CLIENT GROUP                                 
         MVC   TX06PGRP,TAPIPRG    PRODUCT GROUP                                
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TAPIAC         OVERRIDE AGENCY COMMISSION RATE              
         CLM   R0,3,=X'FFFF'                                                    
         JNE   *+6                                                              
         SR    R0,R0                                                            
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX06OACR,DUB                                                     
*                                                                               
         CLI   TAPILEN,TAPILNQ                                                  
         JNH   TLXPR20                                                          
         MVC   TX06PTYP,TAPIPTYP   PRODUCT TYPE                                 
         J     TLXPR20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACMD,R5                                                         
TLXPR90  CLI   TACMTYPE,TACMTYPI   EMAIL                                        
         JNE   TLXPR20                                                          
*                                                                               
         SR    RF,RF                                                            
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXPR20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX06EMAL(0),TACMCOMM                                             
         J     TLXPR20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAISD,R5                                                         
TLXPR100 MVC   TX06PPRD,TAISCDE    PRODUCTION PRODUCT CODE                      
         J     TLXPR20                                                          
         DROP  R5                                                               
*                                                                               
         USING TANUD,R5                                                         
TLXPR110 SR    RF,RF               FREE FORM NUMBER ELEMENT                     
*        IC    RF,TANULEN                                                       
*        SHI   RF,4                                                             
*        JM    TLXPR20                                                          
*                                                                               
*        LA    RE,TX06MCDE                                                      
*        CLI   TANUTYPE,TANUTMAT   W - MATERIAL CODE                            
*        JE    TLXPR120                                                         
*                                                                               
*        LA    RE,TX06CSTC                                                      
*        CLI   TANUTYPE,TANUTCTR   X - COST CENTER                              
*        JNE   TLXPR20                                                          
*                                                                               
*LXPR120 EX    RF,*+8                                                           
*        J     *+10                                                             
*        MVC   0(0,RE),TANUMBER                                                 
         J     TLXPR20                                                          
         DROP  R5                                                               
*                                                                               
TLXPRDXX DS    0H                                                               
         J     EXIT                                                             
         DROP  R2,R3,R4                                                         
*                                                                               
TLXPRDLT DC    A(LITERAL)                                                       
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXCSTC - EXTRACT CAST RECORDS AND SUBSET RECORDS                   *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(CAST RECORD)                                                  *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
* AL4 A(PKCNTS) - RECORD ACCUMULATORS                                 *         
* AL4 A(WORK) - BUFFERIN ADDRESS                                      *         
*                        - ADDRESS OF BUFFER                          *         
*                        - ADDRESS OF BUFFERIN                        *         
*                        - ADDRESS OF COMFACS                         *         
***********************************************************************         
         SPACE 1                                                                
TLXCSTC  NMOD1 WORKX-WORKD,*TLXCST*,R9,RR=RA                                    
         USING WORKD,RC                                                         
         L     RA,TLXCSTLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         MVC   APKCNTS,16(R1)                                                   
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXBADD,RE                                                       
         L     RE,20(R1)           BUFFERIN ADDRESSES                           
         MVC   AHIDBUF,TLXABUF     HOLDING FEE ID BUFFER                        
         MVC   ABUFFRIN,TLXBUFFN   BUFFERIN ADDRESS                             
         MVC   ACOMFACS,TLXCFAC    ADDRESS OF COMFACS                           
         DROP  RE                                                               
*                                                                               
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLCAD,R3            R3=A(CAST RECORD)                            
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         CLI   8(R1),1                                                          
         JL    TLXCSKIL            BUILD K RECORD                               
         JE    TLXCSBLD            BUILD CAST AND SUBSET RECS                   
         JH    TLXCSNXT            OUTPUT NEXT RECORD                           
*                                                                               
TLXCSTCC DC    A(BUFFER1)          JOB SAVE AREA                                
TLXCSTLT DC    A(LITERAL)                                                       
         EJECT                                                                  
***********************************************************************         
* BUILD 'K' RECORD AND EXIT                                           *         
***********************************************************************         
TLXCSKIL DS    0H                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* GET NEXT RECORD AND PASS IT BACK                                    *         
***********************************************************************         
         SPACE 1                                                                
TLXCSNXT L     RE,ANEXT                                                         
         OC    0(8,RE),0(RE)                                                    
         JNZ   *+12                                                             
         MVI   8(R1),X'FF'         NO MORE RECORDS                              
         J     EXIT                                                             
*                                                                               
         L     RE,ANEXT            MOVE IN NEXT RECORD                          
         LA    R0,TLXRECD                                                       
         LH    RF,=Y(TX07LEN)                                                   
         LR    R1,RF                                                            
         MVCL  R0,RE                                                            
*                                                                               
         LH    RF,=Y(TX07LEN)      UPDATE POINTER                               
         L     RE,ANEXT                                                         
         AR    RE,RF                                                            
         ST    RE,ANEXT                                                         
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* BUILD SERIES OF RECORDS FOR THIS RECORD                             *         
***********************************************************************         
         SPACE 1                                                                
TLXCSBLD MVC   SVACT,TLXREACT      SAVE ACTION                                  
         MVC   SVDAT,TLXREDAT      SAVE DATE                                    
         MVC   SVTIM,TLXRETIM      SAVE TIME                                    
*                                                                               
         BAS   RE,TLXCSTR          BUILD CAST RECORD                            
         BAS   RE,TLXOVAR          BUILD OVERSCALE AMOUNT RECORDS               
         BAS   RE,TLXOVPR          BUILD OVERSCALE PERCENT RECORDS              
         BAS   RE,TLXCERR          BUILD CAST ERROR RECORD                      
         BAS   RE,TLXEPSR          BUILD EPISODE RECORD                         
         BAS   RE,TLXHIDR          HOLDING FEE DOCUMENT ID                      
                                                                                
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXCSTR - EXTRACT CAST RECORD - 5307                                *         
***********************************************************************         
         SPACE 1                                                                
TLXCSTR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK07CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX07LEN)                                          
         MVC   TLXRETYP,TLXCSTQ                                                 
*                                                                               
         MVI   TX07AGTC-1,MXTRTQ                                                
         MVI   TX07SSN-1,MXTRTQ                                                 
         MVI   TX07ICOM-1,MXTRTQ                                                
         MVI   TX07CAT-1,MXTRTQ                                                 
         MVI   TX07SEQ-1,MXTRTQ                                                 
         MVI   TX07MUS-1,MXTRTQ                                                 
         MVI   TX07S40-1,MXTRTQ                                                 
         MVI   TX07EXT-1,MXTRTQ                                                 
         MVI   TX07S10-1,MXTRTQ                                                 
         MVI   TX07CAM-1,MXTRTQ                                                 
         MVI   TX07S04-1,MXTRTQ                                                 
         MVI   TX07GRT-1,MXTRTQ                                                 
         MVI   TX07S01-1,MXTRTQ                                                 
         MVI   TX07SORT-1,MXTRTQ                                                
         MVI   TX07AGR-1,MXTRTQ                                                 
         MVI   TX07OCAM-1,MXTRTQ                                                
         MVI   TX07UNCO-1,MXTRTQ                                                
         MVI   TX07LOCL-1,MXTRTQ                                                
         MVI   TX07CTYR-1,MXTRTQ                                                
         MVI   TX07FSER-1,MXTRTQ                                                
         MVI   TX07LSER-1,MXTRTQ                                                
         MVI   TX07EXP-1,MXTRTQ                                                 
         MVI   TX07SHDT-1,MXTRTQ                                                
         MVI   TX07CNUM-1,MXTRTQ                                                
         MVI   TX07TUNT-1,MXTRTQ                                                
         MVI   TX07OVRT-1,MXTRTQ                                                
         MVI   TX07NDUB-1,MXTRTQ                                                
         MVI   TX07ONLF-1,MXTRTQ                                                
         MVI   TX07OOLF-1,MXTRTQ                                                
         MVI   TX07CHKA-1,MXTRTQ                                                
         MVI   TX07DCBL-1,MXTRTQ                                                
         MVI   TX07DPAX-1,MXTRTQ                                                
         MVI   TX07DTRK-1,MXTRTQ                                                
         MVI   TX07AOFP-1,MXTRTQ                                                
         MVI   TX07PCAN-1,MXTRTQ                                                
         MVI   TX07DCAN-1,MXTRTQ                                                
         MVI   TX07CELE-1,MXTRTQ                                                
         MVI   TX07NFOR-1,MXTRTQ                                                
         MVI   TX07NIND-1,MXTRTQ                                                
         MVI   TX07NINT-1,MXTRTQ                                                
         MVI   TX07PAYC-1,MXTRTQ                                                
         MVI   TX07EDTB-1,MXTRTQ                                                
         MVI   TX07FCYC-1,MXTRTQ                                                
         MVI   TX07GRTC-1,MXTRTQ                                                
         MVI   TX07LFRM-1,MXTRTQ                                                
         MVI   TX07DSHF-1,MXTRTQ                                                
         MVI   TX07CSDH-1,MXTRTQ                                                
         MVI   TX07DFHF-1,MXTRTQ                                                
         MVI   TX07D2HF-1,MXTRTQ                                                
         MVI   TX07SCSD-1,MXTRTQ                                                
         MVI   TX07RDES-1,MXTRTQ                                                
         MVI   TX07TRKS-1,MXTRTQ                                                
         MVI   TX07VERS-1,MXTRTQ                                                
         MVI   TX07RESN-1,MXTRTQ                                                
         MVI   TX07REDN-1,MXTRTQ                                                
         MVI   TX07RESP-1,MXTRTQ                                                
         MVI   TX07REDP-1,MXTRTQ                                                
         MVI   TX07EFF-1,MXTRTQ                                                 
         MVI   TX07COMT-1,MXTRTQ                                                
         MVI   TX07CSTR-1,MXTRTQ                                                
         MVI   TX07CEND-1,MXTRTQ                                                
         MVI   TX07SAMT-1,MXTRTQ                                                
         MVI   TX07AAPP-1,MXTRTQ                                                
         MVI   TX07BAL-1,MXTRTQ                                                 
         MVI   TX07LPAG-1,MXTRTQ                                                
         MVI   TX07TRKE-1,MXTRTQ                                                
         MVI   TX07ISGR-1,MXTRTQ                                                
         MVI   TX07SEAC-1,MXTRTQ                                                
         MVI   TX07USEC-1,MXTRTQ                                                
         MVI   TX07INVN-1,MXTRTQ                                                
         MVI   TX07TYPU-1,MXTRTQ                                                
         MVI   TX07AREA-1,MXTRTQ                                                
         MVI   TX07USE-1,MXTRTQ                                                 
         MVI   TX07DEAL-1,MXTRTQ                                                
         MVI   TX07AGR2-1,MXTRTQ                                                
         MVI   TX07TERM-1,MXTRTQ                                                
         MVI   TX07PUBD-1,MXTRTQ                                                
         MVI   TX07EXP2-1,MXTRTQ                                                
         MVI   TX07CCOM-1,MXTRTQ                                                
         MVI   TX07X,MXTRTQ                                                     
         MVI   TX07X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX07SSN,TLCASSN     SOCIAL SECURITY NUMBER                       
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCACOM,TX07ICOM,L'TLCACOM,0                        
*                                                                               
         MVC   TX07CAT,TLCACAT     CATEGORY                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TLCASEQ        INPUT SEQUENCE NUMBER                        
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07SEQ,DUB                                                      
*                                                                               
         MVI   TX07MUS,C'N'        MEMBER IS A MUSICIAN (Y/N)                   
         TM    TLCASORT,X'80'                                                   
         JZ    *+8                                                              
         MVI   TX07MUS,C'Y'                                                     
*                                                                               
         MVI   TX07S40,C'N'        SPARE X'40' BIT ON (Y/N)                     
         TM    TLCASORT,X'40'                                                   
         JZ    *+8                                                              
         MVI   TX07S40,C'Y'                                                     
*                                                                               
         MVI   TX07EXT,C'N'        MEMBER IS AN EXTRA (Y/N)                     
         TM    TLCASORT,X'20'                                                   
         JZ    *+8                                                              
         MVI   TX07EXT,C'Y'                                                     
*                                                                               
         MVI   TX07S10,C'N'        SPARE X'10' BIT ON (Y/N)                     
         TM    TLCASORT,X'10'                                                   
         JZ    *+8                                                              
         MVI   TX07S10,C'Y'                                                     
*                                                                               
         MVI   TX07CAM,C'N'        MEMBER IS OFF CAMERA (Y/N)                   
         TM    TLCASORT,X'08'                                                   
         JZ    *+8                                                              
         MVI   TX07CAM,C'Y'                                                     
*                                                                               
         MVI   TX07S04,C'N'        SPARE X'04' BIT ON (Y/N)                     
         TM    TLCASORT,X'04'                                                   
         JZ    *+8                                                              
         MVI   TX07S04,C'Y'                                                     
*                                                                               
         MVI   TX07GRT,C'N'        MEMBER IS NOT A GUAR (Y/N)                   
         TM    TLCASORT,X'02'                                                   
         JZ    *+8                                                              
         MVI   TX07GRT,C'Y'                                                     
*                                                                               
         MVI   TX07S01,C'N'        SPARE X'01' BIT ON (Y/N)                     
         TM    TLCASORT,X'01'                                                   
         JZ    *+8                                                              
         MVI   TX07S01,C'Y'                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,7,TLCASORT+1     SORT KEY                                     
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07SORT,DUB                                                     
*                                                                               
         LH    RF,=Y(TX07LEN)                                                   
         STH   RF,RECLEN                                                        
         L     R2,TLXCSTCC         WHERE RECORDS TO BE BUILT                    
         XC    0(8,R2),0(R2)                                                    
         ST    R2,ANEXT            FOR NEXT TIME IN                             
*                                                                               
         L     RE,TXREC            BLANK RECORD HERE                            
         LR    R0,R2                                                            
         LH    RF,RECLEN                                                        
         LR    R1,RF                                                            
         MVCL  R0,RE               COPY IN A BLANK RECORD                       
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           FOR NEXT ROUTINE                             
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         LA    R5,TLCAELEM         R5=A(FIRST ELEMENT)                          
TLXCS10  CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXCSTXX                                                         
         CLI   0(R5),TAFNELQ       FREE FORM NAME ELEMENT X'26'                 
         JE    TLXCS30                                                          
         CLI   0(R5),TAHFELQ       HOLDING FEE NOTIFICATION X'58'               
         JE    TLXCS40                                                          
         CLI   0(R5),TACRELQ       APPLIED CREDIT HISTORY ELEMENT X'68'         
         JE    TLXCS50                                                          
         CLI   0(R5),TACAELQ       CAST DETAIL ELEMENT X'74'                    
         JE    TLXCS60                                                          
         CLI   0(R5),TADLELQ       DEAL ELEMENT X'77'                           
         JE    TLXCS70                                                          
         CLI   0(R5),TARLELQ       CAST RELEASE STATUS ELEMENT X'81'            
         JE    TLXCS80                                                          
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXCS90                                                          
*                                                                               
TLXCS20  SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXCS10                                                          
*                                                                               
         USING TAFND,R5                                                         
TLXCS30  SR    RF,RF               FREE FORM NAME ELEMENT                       
         IC    RF,TAFNLEN                                                       
         SHI   RF,4                                                             
         JM    TLXCS20                                                          
*                                                                               
         LA    RE,TX07TRKS                                                      
         CLI   TAFNTYPE,TAFNTTRK   TRACKS A CAST MEMBER IS ON                   
         JE    TLXCS32                                                          
         LA    RE,TX07VERS                                                      
         CLI   TAFNTYPE,TAFNTVER   VERSION A CAST MEMBER IS ON                  
******** JNE   TLXCS20 *********** TEMPORARILY DISABLE VERSIONS                 
         J     TLXCS20                                                          
*                                                                               
TLXCS32  EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   0(0,RE),TAFNNAME                                                 
         J     TLXCS20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAHFD,R5                                                         
TLXCS40  MVI   TX07DSHF,C'N'       DON'T SEND HF NOTICE FOR CAST Y(N)           
         TM    TAHFSTAT,TAHFSNO                                                 
         JZ    *+8                                                              
         MVI   TX07DSHF,C'Y'                                                    
*                                                                               
         OC    TAHFNXTS,TAHFNXTS   CYCLE START DATE OF LAST HF                  
         JZ    TLXCS42                                                          
         GOTO1 DATCON,DMCB,(X'01',TAHFNXTS),(10,TX07CSDH)                       
*                                                                               
TLXCS42  OC    TAHFMDTE,TAHFMDTE   DATE FIRST HF NOTICE SENT                    
         JZ    TLXCS44                                                          
         GOTO1 DATCON,DMCB,(X'01',TAHFMDTE),(10,TX07DFHF)                       
*                                                                               
TLXCS44  OC    TAHF2DTE,TAHF2DTE   DATE SECOND HF NOTICE SENT                   
         JZ    TLXCS46                                                          
         GOTO1 DATCON,DMCB,(X'01',TAHF2DTE),(10,TX07D2HF)                       
*                                                                               
TLXCS46  OC    TAHFHDTE,TAHFHDTE   SEASONAL CYCLE START DATE                    
         JZ    TLXCS20                                                          
         GOTO1 DATCON,DMCB,(X'01',TAHFHDTE),(10,TX07SCSD)                       
         J     TLXCS20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACRD,R5                                                         
TLXCS50  OC    TACRSTRT,TACRSTRT   CYCLE START DATE                             
         JZ    TLXCS52                                                          
         GOTO1 DATCON,DMCB,(X'01',TACRSTRT),(10,TX07CSTR)                       
*                                                                               
TLXCS52  OC    TACREND,TACREND     CYCLE END DATE                               
         JZ    TLXCS54                                                          
         GOTO1 DATCON,DMCB,(X'01',TACREND),(10,TX07CEND)                        
*                                                                               
TLXCS54  SR    R0,R0                                                            
         ICM   R0,15,TACRSCAL      SCALE AMOUNT                                 
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07SAMT,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TACRAPPL      AMOUNT TO BE APPLIED                         
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07AAPP,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TACRBAL       BALANCE                                      
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07BAL,DUB                                                      
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACRLPG        LAST PAGE PRINTED                            
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07LPAG,DUB                                                     
*                                                                               
         MVI   TX07TRKE,C'N'       TRACKING ENABLED (Y/N)                       
         TM    TACRSTAT,TACRSTRK                                                
         JZ    *+8                                                              
         MVI   TX07TRKE,C'Y'                                                    
*                                                                               
         MVI   TX07ISGR,C'N'       IS A GUARANTEE (Y/N)                         
         TM    TACRSTAT,TACRSGUA                                                
         JZ    *+8                                                              
         MVI   TX07ISGR,C'Y'                                                    
*                                                                               
         MVI   TX07SEAC,C'N'       SEASONAL COMMERCIAL (Y/N)                    
         TM    TACRSTAT,TACRSSEA                                                
         JZ    *+8                                                              
         MVI   TX07SEAC,C'Y'                                                    
*                                                                               
         MVC   TX07USEC,TACRUSE    USE CODE                                     
         GOTO1 VHEXOUT,DMCB,TACRINV,TX07INVN,L'TACRINV,0,L'TX07INVN             
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACRTYPE       TYPE OF PAYMENT FOR USE                      
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07TYPU,DUB                                                     
         J     TLXCS20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACAD,R5                                                         
TLXCS60  SR    R0,R0                                                            
         ICM   R0,3,TACANCDE       AGENT CODE                                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07AGTC,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TACARATE       AGENT COMMISSION RATE                        
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07AGR,DUB                                                      
*                                                                               
         MVC   TX07OCAM,TACAONOF    ON/OFF CAMERA                               
         MVC   TX07UNCO,TACAUN     UNION CODE                                   
         MVC   TX07LOCL,TACALOCL   LOCAL                                        
         MVC   TX07CTYR,TACAYEAR   CONTRACT YEAR                                
*                                                                               
         OC    TACAFRST,TACAFRST   FIRST SERVICES DATE                          
         JZ    TLXCS62                                                          
         GOTO1 DATCON,DMCB,(X'01',TACAFRST),(10,TX07FSER)                       
*                                                                               
TLXCS62  OC    TACALAST,TACALAST   LAST SERVICES DATE                           
         JZ    TLXCS64                                                          
         GOTO1 DATCON,DMCB,(X'01',TACALAST),(10,TX07LSER)                       
*                                                                               
TLXCS64  OC    TACAEXP,TACAEXP     EXPIRATION DATE                              
         JZ    TLXCS66                                                          
         GOTO1 DATCON,DMCB,(X'01',TACAEXP),(10,TX07EXP)                         
*                                                                               
TLXCS66  OC    TACASDTE,TACASDTE   SHOOT DATE                                   
         JZ    TLXCS68                                                          
         GOTO1 DATCON,DMCB,(X'01',TACASDTE),(10,TX07SHDT)                       
*                                                                               
TLXCS68  MVC   TX07CNUM,TACACORP   CORPORATION NUMBER                           
         MVC   TX07TUNT,TACAUNIT   TAX UNIT CODE                                
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TACAOV2       2ND OVERSCALE RATE FIELD                     
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07OVRT,DUB                                                     
*                                                                               
         MVC   TX07NDUB,TACADBL    NUMBER OF DOUBLES                            
*                                                                               
         MVI   TX07ONLF,C'N'       ON LIFT Y(N)                                 
         TM    TACASTAT,TACASTLF                                                
         JZ    *+8                                                              
         MVI   TX07ONLF,C'Y'                                                    
*                                                                               
         MVI   TX07OOLF,C'N'       ONLY ON LIFT Y(N)                            
         TM    TACASTAT,TACASTLO                                                
         JZ    *+8                                                              
         MVI   TX07OOLF,C'Y'                                                    
*                                                                               
         MVI   TX07CHKA,C'N'       CHECKS SHOLD GO TO AGENT Y(N)                
         TM    TACASTAT,TACASTAG                                                
         JZ    *+8                                                              
         MVI   TX07CHKA,C'Y'                                                    
*                                                                               
         MVI   TX07DCBL,C'N'       DON'T APPLY FIXED CYCLE CBL (Y/N)            
         TM    TACASTAT,TACASXAC                                                
         JZ    *+8                                                              
         MVI   TX07DCBL,C'Y'                                                    
*                                                                               
         MVI   TX07DPAX,C'N'       DON'T APPLY FIXED CYCLE PAX (Y/N)            
         TM    TACASTAT,TACASXAP                                                
         JZ    *+8                                                              
         MVI   TX07DPAX,C'Y'                                                    
*                                                                               
         MVI   TX07DTRK,C'N'       DON'T WANT FIXED CYC TRACKING (Y/N)          
         TM    TACASTAT,TACASTNF                                                
         JZ    *+8                                                              
         MVI   TX07DTRK,C'Y'                                                    
*                                                                               
         MVI   TX07AOFP,C'N'       AGENT OVERRIDE FROM PAY (Y/N)                
         TM    TACASTAT,TACASTAO                                                
         JZ    *+8                                                              
         MVI   TX07AOFP,C'Y'                                                    
*                                                                               
         MVI   TX07PCAN,C'N'       PAY CANADIAN RATES (Y/N)                     
         TM    TACASTA2,TACASTCR                                                
         JZ    *+8                                                              
         MVI   TX07PCAN,C'Y'                                                    
*                                                                               
         MVI   TX07DCAN,C'N'       DON'T PAY CANADIAN RATES (Y/N)               
         TM    TACASTA2,TACASTDP                                                
         JZ    *+8                                                              
         MVI   TX07DCAN,C'Y'                                                    
*                                                                               
         MVI   TX07CELE,C'N'       CELEBRITY (Y/N)                              
         TM    TACASTA2,TACASCLB                                                
         JZ    *+8                                                              
         MVI   TX07CELE,C'Y'                                                    
*                                                                               
         MVI   TX07NFOR,C'N'       NO FOREIGN USE (Y/N)                         
         TM    TACASTA2,TACASFGR                                                
         JZ    *+8                                                              
         MVI   TX07NFOR,C'Y'                                                    
*                                                                               
         MVI   TX07NIND,C'N'       NO INDUSTRIAL USE (Y/N)                      
         TM    TACASTA2,TACASINR                                                
         JZ    *+8                                                              
         MVI   TX07NIND,C'Y'                                                    
*                                                                               
         MVI   TX07NINT,C'N'       NO INTERACTIVE USE (Y/N)                     
         TM    TACASTA2,TACASINA                                                
         JZ    *+8                                                              
         MVI   TX07NINT,C'Y'                                                    
*                                                                               
         MVC   TX07PAYC,TACAPAYE   PAYEE CODE                                   
         MVC   TX07EDTB,TACAEBAS   EXPIRATION DATE BASIS                        
         MVC   TX07GRTC,TACAGUA    GUARANTEE CODE                               
         MVC   TX07LFRM,TACALFTF   LIFTED FROM                                  
*                                                                               
         OC    TACAFCYC,TACAFCYC   FIRST FIXED CYCLE DATE                       
         JZ    TLXCS20                                                          
         GOTO1 DATCON,DMCB,(X'01',TACAFCYC),(10,TX07FCYC)                       
         J     TLXCS20                                                          
         DROP  R5                                                               
*                                                                               
         USING TADLD,R5                                                         
TLXCS70  MVC   TX07AREA,TADLAREA   AREA                                         
         MVC   TX07USE,TADLUSE     USE                                          
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TADLAMT       DEAL AMOUNT                                  
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07DEAL,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TADLRATE       AGENT COMMISSION RATE                        
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07AGR2,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TADLTERM       TERM                                         
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX07TERM,DUB                                                     
*                                                                               
         OC    TADLPUB,TADLPUB     PUBLICATION DATE                             
         JZ    TLXCS72                                                          
         GOTO1 DATCON,DMCB,(X'01',TADLPUB),(10,TX07PUBD)                        
*                                                                               
TLXCS72  OC    TADLEXP,TADLEXP     EXPIRATION DATE                              
         JZ    TLXCS20                                                          
         GOTO1 DATCON,DMCB,(X'01',TADLPUB),(10,TX07PUBD)                        
         J     TLXCS20                                                          
         DROP  R5                                                               
*                                                                               
         USING TARLD,R5                                                         
TLXCS80  MVC   TX07RESN,TARLSTAT   RELEASED STATUS - NEW                        
         OC    TARLDATE,TARLDATE   RELEASED DATE - NEW                          
         JZ    TLXCS82                                                          
         GOTO1 DATCON,DMCB,(X'01',TARLDATE),(10,TX07REDN)                       
*                                                                               
TLXCS82  MVC   TX07RESP,TARLSTAP   RELEASED STATUS - PREVIOUS                   
         OC    TARLDATP,TARLDATP   RELEASED DATE - PREVIOUS                     
         JZ    TLXCS84                                                          
         GOTO1 DATCON,DMCB,(X'01',TARLDATP),(10,TX07REDP)                       
*                                                                               
TLXCS84  OC    TARLEFDT,TARLEFDT   EFFECTIVE DATE                               
         JZ    TLXCS20                                                          
         GOTO1 DATCON,DMCB,(X'01',TARLEFDT),(10,TX07EFF)                        
         J     TLXCS20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACMD,R5                                                         
TLXCS90  SR    RF,RF               COMMENT ELEMENT                              
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXCS20                                                          
*                                                                               
         LA    RE,TX07RDES                                                      
         CLI   TACMTYPE,TACMTYPD   ROLE DESCRIPTION?                            
         JE    TLXCS92                                                          
         LA    RE,TX07COMT                                                      
         CLI   TACMTYPE,TACMTYPG   GENERAL COMMENT?                             
         JE    TLXCS92                                                          
         LA    RE,TX07CCOM                                                      
         CLI   TACMTYPE,TACMTYPC   CHECK COMMENT?                               
         JNE   TLXCS20                                                          
*                                                                               
TLXCS92  EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   0(0,RE),TACMCOMM                                                 
         J     TLXCS20                                                          
         DROP  R5                                                               
*                                                                               
TLXCSTXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXOVAR - EXTRACT OVERSCALE AMOUNT RECORDS - 5308                   *         
***********************************************************************         
         SPACE 1                                                                
TLXOVAR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK08CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX08LEN)                                          
         MVC   TLXRETYP,TLXOVAQ                                                 
*                                                                               
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX08AGTC-1,MXTRTQ                                                
         MVI   TX08SSN-1,MXTRTQ                                                 
         MVI   TX08ICOM-1,MXTRTQ                                                
         MVI   TX08CAT-1,MXTRTQ                                                 
         MVI   TX08SEQ-1,MXTRTQ                                                 
         MVI   TX08USE-1,MXTRTQ                                                 
         MVI   TX08AMT-1,MXTRTQ                                                 
         MVI   TX08X,MXTRTQ                                                     
         MVI   TX08X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX08SSN,TLCASSN     SOCIAL SECURITY NUMBER                       
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCACOM,TX08ICOM,L'TLCACOM,0                        
*                                                                               
         MVC   TX08CAT,TLCACAT     CATEGORY                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TLCASEQ        INPUT SEQUENCE NUMBER                        
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX08SEQ,DUB                                                      
*                                                                               
         LA    R5,TLCAELEM         R5=A(FIRST ELEMENT)                          
TLXOVA10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXOVAXX                                                         
         CLI   0(R5),TAOAELQ       CAST OVERSCALE AMOUNT ELEMENT X'67'          
         JE    TLXOVA30                                                         
         CLI   0(R5),TACAELQ       CAST DETAIL ELEMENT X'74'                    
         JE    TLXOVA40                                                         
*                                                                               
TLXOVA20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXOVA10                                                         
*                                                                               
*MULTIPLE RECORD - ONE FOR EACH ELEMENT                                         
*                                                                               
         USING TAOAD,R5                                                         
TLXOVA30 MVC   TX08USE,TAOAUSE     USE CODE                                     
         SR    R0,R0                                                            
         ICM   R0,15,TAOAAMT       OVERSCALE AMOUNT                             
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX08AMT,DUB                                                      
         J     TLXOVA20                                                         
         DROP  R5                                                               
*                                                                               
         USING TACAD,R5                                                         
TLXOVA40 SR    R0,R0                                                            
         ICM   R0,3,TACANCDE       AGENT CODE                                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX08AGTC,DUB                                                     
         J     TLXOVA20                                                         
         DROP  R5                                                               
*                                                                               
TLXOVAXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXOVPR - EXTRACT OVERSCALE PERCENT RECORDS - 5309                  *         
***********************************************************************         
         SPACE 1                                                                
TLXOVPR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK09CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX09LEN)                                          
         MVC   TLXRETYP,TLXOVPQ                                                 
*                                                                               
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX09AGTC-1,MXTRTQ                                                
         MVI   TX09SSN-1,MXTRTQ                                                 
         MVI   TX09ICOM-1,MXTRTQ                                                
         MVI   TX09CAT-1,MXTRTQ                                                 
         MVI   TX09SEQ-1,MXTRTQ                                                 
         MVI   TX09USE-1,MXTRTQ                                                 
         MVI   TX09PCT-1,MXTRTQ                                                 
         MVI   TX09X,MXTRTQ                                                     
         MVI   TX09X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX09SSN,TLCASSN     SOCIAL SECURITY NUMBER                       
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCACOM,TX09ICOM,L'TLCACOM,0                        
*                                                                               
         MVC   TX09CAT,TLCACAT     CATEGORY                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TLCASEQ        INPUT SEQUENCE NUMBER                        
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX09SEQ,DUB                                                      
*                                                                               
         LA    R5,TLCAELEM         R5=A(FIRST ELEMENT)                          
TLXOVP10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXOVPXX                                                         
         CLI   0(R5),TAOPELQ       CAST OVERSCALE PERCENT ELELEMT X'66'         
         JE    TLXOVP30                                                         
         CLI   0(R5),TACAELQ       CAST DETAIL ELEMENT X'74'                    
         JE    TLXOVP40                                                         
*                                                                               
TLXOVP20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXOVP10                                                         
*                                                                               
*MULTIPLE RECORD - ONE FOR EACH ELEMENT                                         
*                                                                               
         USING TAOPD,R5                                                         
TLXOVP30 MVC   TX09USE,TAOPUSE      USE CODE                                    
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAOPPCT       OVERSCALE PERCENT                            
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX09PCT,DUB                                                      
         J     TLXOVP20                                                         
         DROP  R5                                                               
*                                                                               
         USING TACAD,R5                                                         
TLXOVP40 SR    R0,R0                                                            
         ICM   R0,3,TACANCDE       AGENT CODE                                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX09AGTC,DUB                                                     
         J     TLXOVP20                                                         
         DROP  R5                                                               
*                                                                               
TLXOVPXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXCERR - EXTRACT CAST ERROR RECORDS - 5310                         *         
***********************************************************************         
         SPACE 1                                                                
TLXCERR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK10CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX10LEN)                                          
         MVC   TLXRETYP,TLXCERQ                                                 
*                                                                               
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX10AGTC-1,MXTRTQ                                                
         MVI   TX10SSN-1,MXTRTQ                                                 
         MVI   TX10ICOM-1,MXTRTQ                                                
         MVI   TX10CAT-1,MXTRTQ                                                 
         MVI   TX10SEQ-1,MXTRTQ                                                 
         MVI   TX10DTER-1,MXTRTQ                                                
         MVI   TX10CSTR-1,MXTRTQ                                                
         MVI   TX10CEND-1,MXTRTQ                                                
         MVI   TX10INVN-1,MXTRTQ                                                
         MVI   TX10USEE-1,MXTRTQ                                                
         MVI   TX10ESUB-1,MXTRTQ                                                
         MVI   TX10X,MXTRTQ                                                     
         MVI   TX10X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX10SSN,TLCASSN     SOCIAL SECURITY NUMBER                       
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCACOM,TX10ICOM,L'TLCACOM,0                        
*                                                                               
         MVC   TX10CAT,TLCACAT     CATEGORY                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TLCASEQ        INPUT SEQUENCE NUMBER                        
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX10SEQ,DUB                                                      
*                                                                               
         LA    R5,TLCAELEM         R5=A(FIRST ELEMENT)                          
TLXCER10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXCERXX                                                         
         CLI   0(R5),TACAELQ       CAST DETAIL ELEMENT X'74'                    
         JE    TLXCER30                                                         
         CLI   0(R5),TACEELQ       CAST ERROR ELEMENT X'F7'                     
         JE    TLXCER40                                                         
*                                                                               
TLXCER20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXCER10                                                         
*                                                                               
         USING TACAD,R5                                                         
TLXCER30 SR    R0,R0                                                            
         ICM   R0,3,TACANCDE       AGENT CODE                                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX10AGTC,DUB                                                     
         J     TLXCER20                                                         
         DROP  R5                                                               
*                                                                               
*                                                                               
* MULTIPLE ELEMENTS                                                             
         USING TACED,R5                                                         
TLXCER40 OC    TACEDATE,TACEDATE   DATE OF ERROR                                
         JZ    TLXCER42                                                         
         GOTO1 DATCON,DMCB,(X'01',TACEDATE),(20,TX10DERR)                       
*                                                                               
         MVO   DUB,TACETIME                                                     
         OI    DUB+7,X'0F'                                                      
         UNPK  TX10TERR,DUB        TIME OF ERROR                                
*                                                                               
TLXCER42 OC    TACECYCS,TACECYCS   CYCLE START DATE                             
         JZ    TLXCER44                                                         
         GOTO1 DATCON,DMCB,(X'01',TACECYCS),(10,TX10CSTR)                       
*                                                                               
TLXCER44 OC    TACECYCE,TACECYCE   CYCLE END DATE                               
         JZ    TLXCER46                                                         
         GOTO1 DATCON,DMCB,(X'01',TACECYCE),(10,TX10CEND)                       
*                                                                               
TLXCER46 GOTO1 VHEXOUT,DMCB,TACEINV,TX10INVN,L'TACEINV,0,L'TX10INVN             
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACEUSEQ       USE CODE EQUATE                              
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX10USEE,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACEERR        ERROR CODE SUB-ELEMENT                       
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX10ESUB,DUB                                                     
         J     TLXCER20                                                         
         DROP  R5                                                               
*                                                                               
TLXCERXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXEPSR - EXTRACT EPISODE RECORDS - 5317                            *         
***********************************************************************         
         SPACE 1                                                                
TLXEPSR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK17CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX17LEN)                                          
         MVC   TLXRETYP,TLXEPSQ                                                 
*                                                                               
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX17AGTC-1,MXTRTQ                                                
         MVI   TX17SSN-1,MXTRTQ                                                 
         MVI   TX17ICOM-1,MXTRTQ                                                
         MVI   TX17CAT-1,MXTRTQ                                                 
         MVI   TX17SEQ-1,MXTRTQ                                                 
         MVI   TX17EPI-1,MXTRTQ                                                 
         MVI   TX17HEAD-1,MXTRTQ                                                
         MVI   TX17SCRT-1,MXTRTQ                                                
         MVI   TX17BRAK-1,MXTRTQ                                                
         MVI   TX17PHAP-1,MXTRTQ                                                
         MVI   TX17PAYA-1,MXTRTQ                                                
         MVI   TX17ACRD-1,MXTRTQ                                                
*                                                                               
         MVC   TX17SSN,TLCASSN     SOCIAL SECURITY NUMBER                       
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCACOM,TX17ICOM,L'TLCACOM,0                        
*                                                                               
         MVC   TX17CAT,TLCACAT     CATEGORY                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TLCASEQ        INPUT SEQUENCE NUMBER                        
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX17SEQ,DUB                                                      
*                                                                               
         LA    R5,TLCAELEM         R5=A(FIRST ELEMENT)                          
TLXEPS10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXEPSXX                                                         
         CLI   0(R5),TASOELQ       EPISODE NUMBERS ELEMENT X'6F'                
         JE    TLXEPS30                                                         
         CLI   0(R5),TACAELQ       CAST DETAIL ELEMENT X'74'                    
         JE    TLXEPS40                                                         
*                                                                               
TLXEPS20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXEPS10                                                         
*                                                                               
* MULTIPLE ELEMENTS                                                             
         USING TASOD,R5                                                         
TLXEPS30 MVI   TX17HEAD,C'N'       HEAD WRITER (Y/N)                            
         TM    TASOSTAT,TASOSH                                                  
         JZ    *+8                                                              
         MVI   TX17HEAD,C'Y'                                                    
*                                                                               
         MVI   TX17SCRT,C'N'       SCRIPT WRITER (Y/N)                          
         TM    TASOSTAT,TASOSS                                                  
         JZ    *+8                                                              
         MVI   TX17SCRT,C'Y'                                                    
*                                                                               
         MVI   TX17BRAK,C'N'       BREAKDOWN WRITER (Y/N)                       
         TM    TASOSTAT,TASOSB                                                  
         JZ    *+8                                                              
         MVI   TX17BRAK,C'Y'                                                    
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TASOEPI        EPISODE NUMBER                               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX17EPI,DUB                                                      
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TASOPNH        P&H AMOUNT PAID                              
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX17PHAP,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,7,TASOPAY        APPLIED PAYMENTS                             
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX17PAYA,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,7,TASOAPPL       APPLIED CREDITS                              
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX17ACRD,DUB                                                     
         J     TLXEPS20                                                         
         DROP  R5                                                               
*                                                                               
         USING TACAD,R5                                                         
TLXEPS40 SR    R0,R0                                                            
         ICM   R0,3,TACANCDE       AGENT CODE                                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX17AGTC,DUB                                                     
         J     TLXEPS20                                                         
         DROP  R5                                                               
*                                                                               
TLXEPSXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXHIDR - EXTRACT HOLDING FEE DOCUMENT ID - 05322                   *         
***********************************************************************         
         SPACE 1                                                                
TLXHIDR  NTR1                                                                   
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCACOM,HIDICOM,L'TLCACOM,0                         
*                                                                               
         LA    R5,TLCAELEM         R5=A(FIRST ELEMENT)                          
TLXHID10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXHIDXX                                                         
         CLI   0(R5),TAHFELQ       HOLDING FEE NOTIFICATION X'58'               
         JE    TLXHID30                                                         
*                                                                               
TLXHID20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXHID10                                                         
*                                                                               
         USING TAHFD,R5                                                         
TLXHID30 OC    TAHFNXTS,TAHFNXTS   CYCLE START DATE OF LAST HF                  
         JZ    TLXHID20                                                         
         GOTO1 DATCON,DMCB,(X'01',TAHFNXTS),(20,WORK)                           
         MVC   HIDFCDTE,WORK                                                    
         MVC   WORK(L'HIDREC),HIDREC                                            
*                                                                               
         GOTO1 ABUFFRIN,DMCB,('BUFFAGET',AHIDBUF),(0,HIDREC),ACOMFACS           
         MVC   BUFFRET,BUFFERRS-BUFFPARM(R1)                                    
         TM    BUFFRET,BUFFERNF                                                 
         BNO   TLXHIDXX                                                         
*                                                                               
         MVC   HIDREC,WORK                                                      
         GOTO1 ABUFFRIN,DMCB,('BUFFAPUT',AHIDBUF),(0,HIDREC),ACOMFACS           
         MVC   BUFFRET,BUFFERRS-BUFFPARM(R1)                                    
         CLI   BUFFRET,0                                                        
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK22CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX22LEN)                                          
         MVC   TLXRETYP,TLXHFIQ                                                 
*                                                                               
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX22HFID-1,MXTRTQ                                                
*                                                                               
         MVC   TX22HFID,HIDREC                                                  
*                                                                               
TLXHIDXX J     EXIT                                                             
         DROP  R2,R3,R4                                                         
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXCOMC - EXTRACT COMMERCIAL RECORDS AND SUBSET RECORDS             *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(COMMERCIAL RECORD)                                            *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
* AL4 A(PKCNTS) - RECORD ACCUMULATORS                                 *         
***********************************************************************         
         SPACE 1                                                                
TLXCOMC  NMOD1 WORKX-WORKD,*TLXCOM*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXCOMLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         MVC   APKCNTS,16(R1)                                                   
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLCOD,R3            R3=A(COMMERCIAL RECORD)                      
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         CLI   8(R1),1                                                          
         JL    TLXCMKIL            BUILD K RECORD                               
         JE    TLXCMBLD            BUILD COMMERCIAL AND SUBSET RECS             
         JH    TLXCMNXT            OUTPUT NEXT RECORD                           
*                                                                               
TLXCOMCC DC    A(BUFFER1)          JOB SAVE AREA                                
TLXCOMLT DC    A(LITERAL)                                                       
         EJECT                                                                  
***********************************************************************         
* BUILD 'K' RECORD AND EXIT                                           *         
***********************************************************************         
TLXCMKIL DS    0H                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* GET NEXT RECORD AND PASS IT BACK                                    *         
***********************************************************************         
         SPACE 1                                                                
TLXCMNXT L     RE,ANEXT                                                         
         OC    0(8,RE),0(RE)                                                    
         JNZ   *+12                                                             
         MVI   8(R1),X'FF'         NO MORE RECORDS                              
         J     EXIT                                                             
*                                                                               
         L     RE,ANEXT            MOVE IN NEXT RECORD                          
         LA    R0,TLXRECD                                                       
         LH    RF,=Y(TX11LEN)                                                   
         LR    R1,RF                                                            
         MVCL  R0,RE                                                            
*                                                                               
         LH    RF,=Y(TX11LEN)      UPDATE POINTER                               
         L     RE,ANEXT                                                         
         AR    RE,RF                                                            
         ST    RE,ANEXT                                                         
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* BUILD SERIES OF RECORDS FOR THIS RECORD                             *         
***********************************************************************         
         SPACE 1                                                                
TLXCMBLD MVC   SVACT,TLXREACT      SAVE ACTION                                  
         MVC   SVDAT,TLXREDAT      SAVE DATE                                    
         MVC   SVTIM,TLXRETIM      SAVE TIME                                    
*                                                                               
         BAS   RE,TLXCOMR          BUILD COMMERCIAL RECORD                      
         BAS   RE,TLXAFMR          BUILD AFM RECORD                             
         BAS   RE,TLXCMVR          BUILD COMMERCIAL VERSION RECORD              
         BAS   RE,TLXMCDR          BUILD COMMERCIAL MUSIC CODE RECORD           
         BAS   RE,TLXCMPR          BUILD COMMERCIAL PRODUCT RECORD              
*                                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXCOMR - EXTRACT COMMERCIAL RECORDS - 5311                         *         
***********************************************************************         
         SPACE 1                                                                
TLXCOMR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK11CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX11LEN)                                          
         MVC   TLXRETYP,TLXCOMQ                                                 
*                                                                               
         MVI   TX11AGY-1,MXTRTQ                                                 
         MVI   TX11CLI-1,MXTRTQ                                                 
         MVI   TX11PRD-1,MXTRTQ                                                 
         MVI   TX11CID-1,MXTRTQ                                                 
         MVI   TX11ICOM-1,MXTRTQ                                                
         MVI   TX11FCYC-1,MXTRTQ                                                
         MVI   TX11FAIR-1,MXTRTQ                                                
         MVI   TX11EXPD-1,MXTRTQ                                                
         MVI   TX11VDAT-1,MXTRTQ                                                
         MVI   TX11VID-1,MXTRTQ                                                 
         MVI   TX11VSID-1,MXTRTQ                                                
         MVI   TX11DUBD-1,MXTRTQ                                                
         MVI   TX11UNCO-1,MXTRTQ                                                
         MVI   TX11UNMU-1,MXTRTQ                                                
         MVI   TX11UNNM-1,MXTRTQ                                                
         MVI   TX11VONE-1,MXTRTQ                                                
         MVI   TX11SCYC-1,MXTRTQ                                                
         MVI   TX11STYP-1,MXTRTQ                                                
         MVI   TX11CGRP-1,MXTRTQ                                                
         MVI   TX11MED-1,MXTRTQ                                                 
         MVI   TX11LSEC-1,MXTRTQ                                                
         MVI   TX11CTYP-1,MXTRTQ                                                
         MVI   TX11ANON-1,MXTRTQ                                                
         MVI   TX11SCOL-1,MXTRTQ                                                
         MVI   TX11CCHG-1,MXTRTQ                                                
         MVI   TX11LPAY-1,MXTRTQ                                                
         MVI   TX11FDT2-1,MXTRTQ                                                
         MVI   TX11TRKI-1,MXTRTQ                                                
         MVI   TX11TRKL-1,MXTRTQ                                                
         MVI   TX11ARTE-1,MXTRTQ                                                
         MVI   TX11ATTC-1,MXTRTQ                                                
         MVI   TX11LOCK-1,MXTRTQ                                                
         MVI   TX11NFEE-1,MXTRTQ                                                
         MVI   TX11RELD-1,MXTRTQ                                                
         MVI   TX11CAND-1,MXTRTQ                                                
         MVI   TX11CANR-1,MXTRTQ                                                
         MVI   TX11WDTE-1,MXTRTQ                                                
         MVI   TX11SOAP-1,MXTRTQ                                                
         MVI   TX11ETYP-1,MXTRTQ                                                
         MVI   TX11ADTE-1,MXTRTQ                                                
         MVI   TX11IDTE-1,MXTRTQ                                                
         MVI   TX11BRND-1,MXTRTQ                                                
         MVI   TX11COGR-1,MXTRTQ                                                
         MVI   TX11ETYR-1,MXTRTQ                                                
         MVI   TX11AUSE-1,MXTRTQ                                                
         MVI   TX11FUSE-1,MXTRTQ                                                
         MVI   TX11LFID-1,MXTRTQ                                                
         MVI   TX11LFSC-1,MXTRTQ                                                
         MVI   TX11CSTY-1,MXTRTQ                                                
         MVI   TX11FDTE-1,MXTRTQ                                                
         MVI   TX11FSTU-1,MXTRTQ                                                
         MVI   TX11FCTY-1,MXTRTQ                                                
         MVI   TX11COMT-1,MXTRTQ                                                
         MVI   TX11CTIT-1,MXTRTQ                                                
         MVI   TX11ATIT-1,MXTRTQ                                                
         MVI   TX11PNME-1,MXTRTQ                                                
         MVI   TX11ATYP-1,MXTRTQ                                                
         MVI   TX11FIL1-1,MXTRTQ                                                
         MVI   TX11FIL2-1,MXTRTQ                                                
         MVI   TX11FIL3-1,MXTRTQ                                                
         MVI   TX11FIL4-1,MXTRTQ                                                
         MVI   TX11OEFD-1,MXTRTQ                                                
         MVI   TX11OAGY-1,MXTRTQ                                                
         MVI   TX11OCID-1,MXTRTQ                                                
         MVI   TX11OCOM-1,MXTRTQ                                                
         MVI   TX11COPT-1,MXTRTQ                                                
         MVI   TX11COPF-1,MXTRTQ                                                
         MVI   TX11PHID-1,MXTRTQ                                                
         MVI   TX11PHNM-1,MXTRTQ                                                
         MVI   TX11SAGC-1,MXTRTQ                                                
         MVI   TX11SAGN-1,MXTRTQ                                                
         MVI   TX11X,MXTRTQ                                                     
         MVI   TX11X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX11AGY,TLCOAGY     AGENCY                                       
         MVC   TX11CLI,TLCOCLI     CLIENT                                       
         MVC   TX11PRD,TLCOPRD     PRODUCT                                      
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCOCOM,TX11ICOM,L'TLCOCOM,0                        
*                                                                               
         LH    RF,=Y(TX11LEN)                                                   
         STH   RF,RECLEN                                                        
         L     R2,TLXCOMCC         WHERE RECORDS TO BE BUILT                    
         XC    0(8,R2),0(R2)                                                    
         ST    R2,ANEXT            FOR NEXT TIME IN                             
*                                                                               
         L     RE,TXREC            BLANK RECORD HERE                            
         LR    R0,R2                                                            
         LH    RF,RECLEN                                                        
         LR    R1,RF                                                            
         MVCL  R0,RE               COPY IN A BLANK RECORD                       
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           FOR NEXT ROUTINE                             
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         LA    R5,TLCOELEM         R5=A(FIRST ELEMENT)                          
TLXCO10  CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXCOMXX                                                         
         CLI   0(R5),TANAELQ       NAME ELEMENT X'20'                           
         JE    TLXCO30                                                          
         CLI   0(R5),TAOCELQ       OLD AGENCY ELEMENT X'24'                     
         JE    TLXCO40                                                          
         CLI   0(R5),TANUELQ       FREE FORM NUMBER ELEMENT X'25'               
         JE    TLXCO50                                                          
         CLI   0(R5),TAFNELQ       FREE FORM NAME ELEMENT X'26'                 
         JE    TLXCO60                                                          
         CLI   0(R5),TAFLELQ       FILTERS ELEMENT X'30'                        
         JE    TLXCO70                                                          
         CLI   0(R5),TALFELQ       LIFT DETAIL ELEMENT X'71'                    
         JE    TLXCO80                                                          
         CLI   0(R5),TACOELQ       COMMERCIAL DETAILS ELEMENT X'72'             
         JE    TLXCO90                                                          
         CLI   0(R5),TACSELQ       COMMERCIAL STUDIO ELEMENT X'73'              
         JE    TLXCO100                                                         
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXCO110                                                         
*                                                                               
TLXCO20  SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXCO10                                                          
*                                                                               
         USING TANAD,R5                                                         
TLXCO30  SR    RF,RF               NAME                                         
         IC    RF,TANALEN                                                       
         SHI   RF,3                                                             
         JM    TLXCO20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX11CTIT(0),TANANAME                                             
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAOCD,R5                                                         
TLXCO40  OC    TAOCDTE,TAOCDTE     OLD AGENCY EFFECTIVE DATE                    
         JZ    TLXCO42                                                          
         XC    TAOCDTE,HEXFFS      UNCOMPLEMENT IT                              
         GOTO1 DATCON,DMCB,(X'01',TAOCDTE),(10,TX11OEFD)                        
*                                                                               
TLXCO42  MVC   TX11OAGY,TAOCAGY    OLD TO/FROM AGENCY                           
         MVC   TX11OCOM,TAOCCOM    OLD TO/FROM COMM ID                          
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAOCCOM       OLD TO/FROM INTERNAL COMMERCIAL              
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX11OCID,DUB                                                     
*                                                                               
         MVI   TX11COPF,C'N'       COPIED FROM (Y/N)                            
         TM    TAOCSTAT,TAOCSFRO                                                
         JZ    *+8                                                              
         MVI   TX11COPF,C'Y'                                                    
*                                                                               
         MVI   TX11COPT,C'N'       COPIED TO (Y/N)                              
         TM    TAOCSTAT,TAOCSTO                                                 
         JZ    *+8                                                              
         MVI   TX11COPT,C'Y'                                                    
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
         USING TANUD,R5                                                         
TLXCO50  SR    RF,RF               FREE FORM NUMBER ELEMENT                     
         IC    RF,TANULEN                                                       
         SHI   RF,4                                                             
         JM    TLXCO20                                                          
*                                                                               
         LA    RE,TX11PHID                                                      
         CLI   TANUTYPE,TANUTPHO   PHOTOGRAPHER ID                              
         JE    TLXCO52                                                          
*                                                                               
         LA    RE,TX11SAGN                                                      
         CLI   TANUTYPE,TANUTSVC   SERVICES FOR AGENCY CODE                     
         JNE   TLXCO20                                                          
*                                                                               
TLXCO52  EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   0(0,RE),TANUMBER                                                 
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAFND,R5                                                         
TLXCO60  SR    RF,RF               FREE FORM NAME ELEMENT                       
         IC    RF,TAFNLEN                                                       
         SHI   RF,4                                                             
         JM    TLXCO20                                                          
*                                                                               
         LA    RE,TX11ATIT                                                      
         CLI   TAFNTYPE,TAFNTMUS   AFM TITLE                                    
         JE    TLXCO62                                                          
*                                                                               
         LA    RE,TX11PNME                                                      
         CLI   TAFNTYPE,TAFNTPRD   PRODUCT NAME                                 
         JE    TLXCO62                                                          
*                                                                               
         LA    RE,TX11PHNM                                                      
         CLI   TAFNTYPE,TAFNTPHO   PHOTOGRAPHER NAME                            
         JE    TLXCO62                                                          
*                                                                               
         LA    RE,TX11SAGN                                                      
         CLI   TAFNTYPE,TAFNTSVC   SERVICES FOR AGENCY NAME                     
         JNE   TLXCO20                                                          
*                                                                               
TLXCO62  EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   0(0,RE),TAFNNAME                                                 
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
         USING TAFLD,R5                                                         
TLXCO70  MVC   TX11FIL1,TAFLFLT1   FILTER 1                                     
         MVC   TX11FIL2,TAFLFLT2   FILTER 2                                     
         MVC   TX11FIL3,TAFLFLT3   FILTER 3                                     
         MVC   TX11FIL4,TAFLFLT4   FILTER 4                                     
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
         USING TALFD,R5                                                         
TLXCO80  MVC   TX11LFID,TALFLID    LIFE ID                                      
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TALFSEC        LIFT LENGTH IN SECONDS                       
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX11LFSC,DUB                                                     
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACOD,R5                                                         
TLXCO90  MVC   TX11CID,TACOCID     COMMERCIAL ID                                
*                                                                               
         OC    TACOFCYC,TACOFCYC   FIRST FIXED CYCLE                            
         JZ    TLXCO91                                                          
         GOTO1 DATCON,DMCB,(X'01',TACOFCYC),(10,TX11FCYC)                       
*                                                                               
TLXCO91  OC    TACOAIR,TACOAIR     FIRST AIR DATE                               
         JZ    TLXCO92                                                          
         GOTO1 DATCON,DMCB,(X'01',TACOAIR),(10,TX11FAIR)                        
*                                                                               
TLXCO92  OC    TACOEXP,TACOEXP     EXPIRATION DATE                              
         JZ    TLXCO93                                                          
         GOTO1 DATCON,DMCB,(X'01',TACOEXP),(10,TX11EXPD)                        
*                                                                               
TLXCO93  OC    TACOVDTE,TACOVDTE   CAST VERIFICATION DATE                       
         JZ    TLXCO94                                                          
         GOTO1 DATCON,DMCB,(X'01',TACOVDTE),(10,TX11VDAT)                       
*                                                                               
TLXCO94  GOTOR GETUSER,TACOVSTU                                                 
         MVC   TX11VID,WORK        USER ID OF CAST VERIFIER                     
*                                                                               
         MVC   TX11VSID,TACOVST    CAST VERIFIER STAFF IF                       
*                                                                               
         OC    TACODUB,TACODUB     DUB DATE                                     
         JZ    TLXCO95                                                          
         GOTO1 DATCON,DMCB,(X'01',TACODUB),(10,TX11DUBD)                        
*                                                                               
TLXCO95  MVI   TX11UNCO,C'N'       UNVERIFIED BY COMMERCIAL (Y/N)               
         TM    TACOUVST,TACOUVCO                                                
         JZ    *+8                                                              
         MVI   TX11UNCO,C'Y'                                                    
*                                                                               
         MVI   TX11UNMU,C'N'       UNVERIFIED BY MUSICIAN (Y/N)                 
         TM    TACOUVST,TACOUVMU                                                
         JZ    *+8                                                              
         MVI   TX11UNMU,C'Y'                                                    
*                                                                               
         MVI   TX11UNNM,C'N'       UNVERIFIED BY NON-MUSICIAN (Y/N)             
         TM    TACOUVST,TACOUVNM                                                
         JZ    *+8                                                              
         MVI   TX11UNNM,C'Y'                                                    
*                                                                               
         MVI   TX11VONE,C'N'       COMMERCIAL WAS VERIFIED ONCE (Y/N)           
         TM    TACOUVST,TACOUVER                                                
         JZ    *+8                                                              
         MVI   TX11VONE,C'Y'                                                    
*                                                                               
         MVC   TX11SCYC,TACOSPCY   SPLIT CYCLES?                                
         MVC   TX11STYP,TACOSES    SESSION TYPE                                 
         MVC   TX11CGRP,TACOCLG    CLIENT GROUP                                 
         MVC   TX11MED,TACOMED     MEDIA                                        
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACOSEC        LENGTH IN SECONDS                            
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX11LSEC,DUB                                                     
*                                                                               
         MVC   TX11CTYP,TACOTYPE   COMMERCIAL TYPE                              
*                                                                               
         MVI   TX11ANON,C'N'       ANNOUNCER IS ONLY NON-MUS (Y/N)              
         TM    TACOSTA2,TACOSANO                                                
         JZ    *+8                                                              
         MVI   TX11ANON,C'Y'                                                    
*                                                                               
         MVI   TX11SCOL,C'N'       SOME CAST MEMBER ON THE LIFT (Y/N)           
         TM    TACOSTA2,TACOSLFT                                                
         JZ    *+8                                                              
         MVI   TX11SCOL,C'Y'                                                    
*                                                                               
         MVI   TX11CCHG,C'N'       COMM/CAST CHGED SINCE LAST HF Y/N)           
         TM    TACOSTA2,TACOCHHF                                                
         JZ    *+8                                                              
         MVI   TX11CCHG,C'Y'                                                    
*                                                                               
         OC    TACOPDTE,TACOPDTE   LAST PAID DATE                               
         J     TLXCO96                                                          
*        JZ    TLXCO96                                                          
         GOTO1 DATCON,DMCB,(X'01',TACOPDTE),(10,TX11LPAY)                       
*                                                                               
TLXCO96  OC    TACOSAIR,TACOSAIR   2ND SEASON FIRST AIR DATE                    
         JZ    TLXCO97                                                          
         GOTO1 DATCON,DMCB,(X'01',TACOSAIR),(10,TX11FDT2)                       
*                                                                               
TLXCO97  MVC   TX11TRKI,TACOTID    TRACK ID                                     
         OC    TX11TRKI,SPACES      SOME HAVE BINARY ZEROS IN THEM              
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACOTLN        TRACK LENGTH                                 
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX11TRKL,DUB                                                     
*                                                                               
         MVC   TX11ARTE,TACOAFM    AFM RATE                                     
         MVC   TX11ATTC,TACOATT    ATTENTION CODE                               
*                                                                               
         MVI   TX11LOCK,C'N'       LOCKED (Y/N)                                 
         TM    TACOSTAT,TACOSTLO                                                
         JZ    *+8                                                              
         MVI   TX11LOCK,C'Y'                                                    
*                                                                               
         MVI   TX11NFEE,C'N'       NO HOLDING FEE (Y/N)                         
         TM    TACOSTAT,TACOSTNO                                                
         JZ    *+8                                                              
         MVI   TX11NFEE,C'Y'                                                    
*                                                                               
         MVI   TX11RELD,C'N'       RELEASED (Y/N0                               
         TM    TACOSTAT,TACOSTRL                                                
         JZ    *+8                                                              
         MVI   TX11RELD,C'Y'                                                    
*                                                                               
         MVI   TX11CAND,C'N'       CANADIAN DOLLARS (Y/N)                       
         TM    TACOSTAT,TACOSCAN                                                
         JZ    *+8                                                              
         MVI   TX11CAND,C'Y'                                                    
*                                                                               
         MVI   TX11CANR,C'N'       CANADIAN RATES (Y/N)                         
         TM    TACOSTAT,TACOSCRT                                                
         JZ    *+8                                                              
         MVI   TX11CANR,C'Y'                                                    
*                                                                               
         MVI   TX11WDTE,C'N'       WORK DATE ON CHECKS (Y/N)                    
         TM    TACOSTAT,TACOSWDT                                                
         JZ    *+8                                                              
         MVI   TX11WDTE,C'Y'                                                    
*                                                                               
         MVI   TX11SOAP,C'N'       SOAP RESIDUALS (Y/N)                         
         TM    TACOSTAT,TACOSRES                                                
         JZ    *+8                                                              
         MVI   TX11SOAP,C'Y'                                                    
*                                                                               
         CLI   TACOLEN,TACOLNQ     IS THE ELEMENT LONG ENOUGH?                  
         BNH   TLXCO20             NO                                           
*                                                                               
         MVC   TX11ETYP,TACOEDT    EDIT TYPE                                    
*                                                                               
         OC    TACOACT,TACOACT     ACTIVE DATE                                  
         JZ    TLXCO98                                                          
         GOTO1 DATCON,DMCB,(X'01',TACOACT),(10,TX11ADTE)                        
*                                                                               
TLXCO98  OC    TACOINAC,TACOINAC   INACTIVE DATE                                
         JZ    TLXCO99                                                          
         GOTO1 DATCON,DMCB,(X'01',TACOINAC),(10,TX11IDTE)                       
*                                                                               
TLXCO99  MVC   TX11BRND,TACOBPRD   BRAND PRODUCT                                
         MVC   TX11COGR,TACOCGRP   COMMERCIAL GROUP                             
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACOEDYR       EDIT TYPE YEAR                               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX11ETYR,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACOAUSE       ALLOWABLE USES                               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX11AUSE,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACORUSE       REMAINING FREE USES                          
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX11FUSE,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TACOCTYP       ACTRA TYPE                                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX11ATYP,DUB                                                     
*                                                                               
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACSD,R5                                                         
TLXCO100 MVC   TX11CSTY,TACSTYPE   COMMERCIAL STUDIO TYPE                       
*                                                                               
         OC    TACSDATE,TACSDATE   FILM SHOOT DATE                              
         JZ    TLXCO102                                                         
         GOTO1 DATCON,DMCB,(X'01',TACSDATE),(10,TX11FDTE)                       
*                                                                               
TLXCO102 MVC   TX11FSTU,TACSSTUD   FILM SHOOT STUDIO                            
         MVC   TX11FCTY,TACSCITY   FILM SHOOT CITY                              
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
         USING TACMD,R5                                                         
TLXCO110 CLI   TACMTYPE,TACMTYPG   COMMENT                                      
         JNE   TLXCO20                                                          
*                                                                               
         SR    RF,RF                                                            
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXCO20                                                          
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX11COMT(0),TACMCOMM                                             
         J     TLXCO20                                                          
         DROP  R5                                                               
*                                                                               
TLXCOMXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXAFMR - EXTRACT AFM RECORDS - 5312                                *         
***********************************************************************         
         SPACE 1                                                                
TLXAFMR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK12CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX12LEN)                                          
         MVC   TLXRETYP,TLXAFMQ                                                 
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX12AGY-1,MXTRTQ                                                 
         MVI   TX12CLI-1,MXTRTQ                                                 
         MVI   TX12PRD-1,MXTRTQ                                                 
         MVI   TX12CID-1,MXTRTQ                                                 
         MVI   TX12ICOM-1,MXTRTQ                                                
         MVI   TX12AFMN-1,MXTRTQ                                                
         MVI   TX12AFMC-1,MXTRTQ                                                
         MVI   TX12TRA-1,MXTRTQ                                                 
         MVI   TX12LFT-1,MXTRTQ                                                 
         MVI   TX12LENG-1,MXTRTQ                                                
         MVI   TX12UNIT-1,MXTRTQ                                                
         MVI   TX12BASC-1,MXTRTQ                                                
         MVI   TX12TTIT-1,MXTRTQ                                                
         MVI   TX12MTYP-1,MXTRTQ                                                
         MVI   TX12X,MXTRTQ                                                     
         MVI   TX12X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX12AGY,TLCOAGY     AGENCY                                       
         MVC   TX12CLI,TLCOCLI     CLIENT                                       
         MVC   TX12PRD,TLCOPRD     PRODUCT                                      
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCOCOM,TX12ICOM,L'TLCOCOM,0                        
*                                                                               
         LA    R5,TLCOELEM         R5=A(FIRST ELEMENT)                          
TLXAFM10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXAFMXX                                                         
         CLI   0(R5),TAMCELQ       MUSIC CONTRACT DETAILS ELEMENT X'43'         
         JE    TLXAFM30                                                         
         CLI   0(R5),TACOELQ       COMMERCIAL DETAILS ELEMENT X'72'             
         JE    TLXAFM40                                                         
*                                                                               
TLXAFM20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXAFM10                                                         
*                                                                               
         USING TAMCD,R5                                                         
TLXAFM30 SR    R0,R0                                                            
*        ICM   R0,1,               AFM NUMBER                                   
*        CVD   R0,DUB                                                           
*        OI    DUB+L'DUB-1,X'0F'                                                
*        UNPK  TX12AFMN,DUB                                                     
*                                                                               
         MVC   TX12AFMC,TAMCCON    AFM CONTRACT                                 
         MVC   TX12TRA,TAMCTRK     TRACK                                        
         MVC   TX12LFT,TAMCLFT     LIFT                                         
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TAMCLLEN       LENGTH                                       
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX12LENG,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,7,TAMCUNIT       UNITS                                        
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX12UNIT,DUB                                                     
*                                                                               
         MVC   TX12BASC,TAMCBAS    BASIC                                        
         OC    TX12BASC,SPACES                                                  
*                                                                               
         MVC   TX12MTYP,TAMCTYP    MUSIC TYPE                                   
*                                                                               
         CLI   TAMCLEN,TAMCLNQ     IS THERE A TRK TITLE?                        
         BE    TLXAFM20            NO                                           
         SR    RF,RF                                                            
         IC    RF,TAMCLEN          GET LENGTH OF ELEMENT                        
         SHI   RF,TAMCLNQ          LESS LENGTH W/O TITLE                        
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   TX12TTIT(0),TAMCTRKT  MOVE TRACK TITLE IN                        
         J     TLXAFM20                                                         
         DROP  R5                                                               
*                                                                               
         USING TACOD,R5                                                         
TLXAFM40 MVC   TX12CID,TACOCID     COMMERCIAL ID                                
         J     TLXAFM20                                                         
         DROP  R5                                                               
*                                                                               
TLXAFMXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXCMVR - EXTRACT COMMERCIAL VERSION RECORDS - 5318                 *         
***********************************************************************         
         SPACE 1                                                                
TLXCMVR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK18CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX18LEN)                                          
         MVC   TLXRETYP,TLXCMVQ                                                 
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX18AGY-1,MXTRTQ                                                 
         MVI   TX18CLI-1,MXTRTQ                                                 
         MVI   TX18PRD-1,MXTRTQ                                                 
         MVI   TX18CID-1,MXTRTQ                                                 
         MVI   TX18ICOM-1,MXTRTQ                                                
         MVI   TX18VER-1,MXTRTQ                                                 
         MVI   TX18VERI-1,MXTRTQ                                                
         MVI   TX18VERL-1,MXTRTQ                                                
         MVI   TX18X,MXTRTQ                                                     
         MVI   TX18X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX18AGY,TLCOAGY     AGENCY                                       
         MVC   TX18CLI,TLCOCLI     CLIENT                                       
         MVC   TX18PRD,TLCOPRD     PRODUCT                                      
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCOCOM,TX18ICOM,L'TLCOCOM,0                        
*                                                                               
         LA    R5,TLCOELEM         R5=A(FIRST ELEMENT)                          
TLXCMV10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXCMVXX                                                         
         CLI   0(R5),TACOELQ       COMMERCIAL DETAILS ELEMENT X'72'             
         JE    TLXCMV30                                                         
         CLI   0(R5),TAVRELQ       VERSIONS ELEMENT X'7F'                       
         JE    TLXCMV40                                                         
*                                                                               
TLXCMV20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXCMV10                                                         
*                                                                               
         USING TACOD,R5                                                         
TLXCMV30 MVC   TX18CID,TACOCID     COMMERCIAL ID                                
         J     TLXCMV20                                                         
         DROP  R5                                                               
*                                                                               
* MULTIPLE ELEMENTS                                                             
*                                                                               
         USING TAVRD,R5                                                         
******** MVC   TX18VER,TAVRVERS ** TEMPORARILY DISABLE VERSIONS                 
TLXCMV40 MVC   TX18VERI,TAVRCID    VERSION ID                                   
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,1,TAVRSEC        VERSION LENGTH                               
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX18VERL,DUB                                                     
         J     TLXCMV20                                                         
         DROP  R5                                                               
*                                                                               
TLXCMVXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXMCDR - EXTRACT MUSIC CODE RECORDS - 5319                         *         
***********************************************************************         
         SPACE 1                                                                
TLXMCDR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK19CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX19LEN)                                          
         MVC   TLXRETYP,TLXMCDQ                                                 
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX19AGY-1,MXTRTQ                                                 
         MVI   TX19CLI-1,MXTRTQ                                                 
         MVI   TX19PRD-1,MXTRTQ                                                 
         MVI   TX19CID-1,MXTRTQ                                                 
         MVI   TX19ICOM-1,MXTRTQ                                                
         MVI   TX19MUSN-1,MXTRTQ                                                
         MVI   TX19MUSC-1,MXTRTQ                                                
         MVI   TX19X,MXTRTQ                                                     
         MVI   TX19X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX19AGY,TLCOAGY     AGENCY                                       
         MVC   TX19CLI,TLCOCLI     CLIENT                                       
         MVC   TX19PRD,TLCOPRD     PRODUCT                                      
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCOCOM,TX19ICOM,L'TLCOCOM,0                        
*                                                                               
         LA    R5,TLCOELEM         R5=A(FIRST ELEMENT)                          
TLXMCD10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXMCDXX                                                         
         CLI   0(R5),TACOELQ       COMMERCIAL DETAILS ELEMENT X'72'             
         JE    TLXMCD30                                                         
         CLI   0(R5),TACPELQ       COMMERCIAL MUSIC ELEMENT X'7E'               
         JE    TLXMCD40                                                         
*                                                                               
TLXMCD20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXMCD10                                                         
*                                                                               
         USING TACOD,R5                                                         
TLXMCD30 MVC   TX19CID,TACOCID     COMMERCIAL ID                                
         J     TLXMCD20                                                         
         DROP  R5                                                               
*                                                                               
* MULTIPLE ELEMENTS                                                             
*                                                                               
         USING TACPD,R5                                                         
TLXMCD40 SR    R0,R0                                                            
*        ICM   R0,1,               MUSIC CODE NUMBER                            
*        CVD   R0,DUB                                                           
*        OI    DUB+L'DUB-1,X'0F'                                                
*        UNPK  TX19MUSN,DUB                                                     
*                                                                               
         MVC   TX19MUSC,TACPMUS    MUSIC CODE                                   
         J     TLXMCD20                                                         
         DROP  R5                                                               
*                                                                               
TLXMCDXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXCMPR - COMMERCIAL PRODUCT RECORDS - 5320                         *         
***********************************************************************         
         SPACE 1                                                                
TLXCMPR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK20CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX20LEN)                                          
         MVC   TLXRETYP,TLXCMPQ                                                 
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TLXREACT-1,MXTRTQ                                                
         MVI   TLXREDAT-1,MXTRTQ                                                
         MVI   TLXRETIM-1,MXTRTQ                                                
*                                                                               
         MVI   TX20AGY-1,MXTRTQ                                                 
         MVI   TX20CLI-1,MXTRTQ                                                 
         MVI   TX20PRD-1,MXTRTQ                                                 
         MVI   TX20CID-1,MXTRTQ                                                 
         MVI   TX20ICOM-1,MXTRTQ                                                
         MVI   TX20PRDC-1,MXTRTQ                                                
         MVI   TX20X,MXTRTQ                                                     
         MVI   TX20X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX20AGY,TLCOAGY     AGENCY                                       
         MVC   TX20CLI,TLCOCLI     CLIENT                                       
         MVC   TX20PRD,TLCOPRD     PRODUCT                                      
*                                                                               
         GOTO1 VHEXOUT,DMCB,TLCOCOM,TX20ICOM,L'TLCOCOM,0                        
*                                                                               
         LA    R5,TLCOELEM         R5=A(FIRST ELEMENT)                          
TLXCMP10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXCMPXX                                                         
         CLI   0(R5),TAPRELQ       PRODUCT ELEMENT X'38'                        
         JE    TLXCMP30                                                         
         CLI   0(R5),TACOELQ       COMMERCIAL DETAILS ELEMENT X'72'             
         JE    TLXCMP40                                                         
*                                                                               
TLXCMP20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXCMP10                                                         
*                                                                               
* CAN HAVE MULTIPLE PRODUCTS (ELEMENTS OR ON SAME ELEMENT?)                     
*                                                                               
         USING TAPRD,R5                                                         
TLXCMP30 MVC   TX20PRDC,TAPRPRD    PRODUCT                                      
         J     TLXCMP20                                                         
         DROP  R5                                                               
*                                                                               
         USING TACOD,R5                                                         
TLXCMP40 MVC   TX20CID,TACOCID     COMMERCIAL ID                                
         J     TLXCMP20                                                         
         DROP  R5                                                               
*                                                                               
TLXCMPXX J     EXIT                                                             
         DROP  R2,R3,R4                                                         
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXSTFC - EXTRACT STAFF RECORDS AND SUBSETS                         *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(STAFF RECORD)                                                 *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
* AL4 A(PKCNTS) - RECORD ACCUMULATORS                                 *         
***********************************************************************         
         SPACE 1                                                                
TLXSTFC  NMOD1 WORKX-WORKD,*TLXSTF*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXSTFLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         MVC   APKCNTS,16(R1)                                                   
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLSTD,R3            R3=A(STAFF RECORD)                           
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         CLI   8(R1),1                                                          
         JL    TLXSTKIL            BUILD K RECORD                               
         JE    TLXSTBLD            BUILD COMMERCIAL AND SUBSET RECS             
         JH    TLXSTNXT            OUTPUT NEXT RECORD                           
*                                                                               
TLXSTFCC DC    A(BUFFER1)          STAFF SAVE AREA                              
TLXSTFLT DC    A(LITERAL)                                                       
         EJECT                                                                  
***********************************************************************         
* BUILD 'K' RECORD AND EXIT                                           *         
***********************************************************************         
TLXSTKIL DS    0H                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* GET NEXT RECORD AND PASS IT BACK                                    *         
***********************************************************************         
         SPACE 1                                                                
TLXSTNXT L     RE,ANEXT                                                         
         OC    0(8,RE),0(RE)                                                    
         JNZ   *+12                                                             
         MVI   8(R1),X'FF'         NO MORE RECORDS                              
         J     EXIT                                                             
*                                                                               
         L     RE,ANEXT            MOVE IN NEXT RECORD                          
         LA    R0,TLXRECD                                                       
         LH    RF,=Y(TX13LEN)                                                   
         LR    R1,RF                                                            
         MVCL  R0,RE                                                            
*                                                                               
         LH    RF,=Y(TX13LEN)      UPDATE POINTER                               
         L     RE,ANEXT                                                         
         AR    RE,RF                                                            
         ST    RE,ANEXT                                                         
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* BUILD SERIES OF RECORDS FOR THIS RECORD                             *         
***********************************************************************         
         SPACE 1                                                                
TLXSTBLD MVC   SVACT,TLXREACT      SAVE ACTION                                  
         MVC   SVDAT,TLXREDAT      SAVE DATE                                    
         MVC   SVTIM,TLXRETIM      SAVE TIME                                    
*                                                                               
         BAS   RE,TLXSTFR          BUILD STAFF RECORD                           
*        BAS   RE,TLXLAGR          BUILD LIMITED AGENCY RECORD                  
*        BAS   RE,TLXLCLR          BUILD LIMITED CLIENT RECORD                  
*                                                                               
         J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXSTFC - EXTRACT STAFF RECORDS - 5313                              *         
***********************************************************************         
         SPACE 1                                                                
TLXSTFR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK13CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX13LEN)                                          
         MVC   TLXRETYP,TLXSTFQ                                                 
*                                                                               
         MVI   TX13USER-1,MXTRTQ                                                
         MVI   TX13SID-1,MXTRTQ                                                 
         MVI   TX13FNME-1,MXTRTQ                                                
         MVI   TX13LNME-1,MXTRTQ                                                
         MVI   TX13TYPE-1,MXTRTQ                                                
         MVI   TX13MANG-1,MXTRTQ                                                
         MVI   TX13TEL-1,MXTRTQ                                                 
         MVI   TX13CGRP-1,MXTRTQ                                                
         MVI   TX13SNME-1,MXTRTQ                                                
         MVI   TX13EMAL-1,MXTRTQ                                                
         MVI   TX13PSW-1,MXTRTQ                                                 
         MVI   TX13X,MXTRTQ                                                     
         MVI   TX13X+1,MXTRTQ                                                   
*                                                                               
         GOTOR GETUSER,TLSTUSER                                                 
         MVC   TX13USER,WORK       USERID                                       
*                                                                               
         MVC   TX13SID,TLSTSTAF    STAFF ID                                     
*                                                                               
         LH    RF,=Y(TX13LEN)                                                   
         STH   RF,RECLEN                                                        
         L     R2,TLXSTFCC         WHERE RECORDS TO BE BUILT                    
         XC    0(8,R2),0(R2)                                                    
         ST    R2,ANEXT            FOR NEXT TIME IN                             
*                                                                               
         L     RE,TXREC            BLANK RECORD HERE                            
         LR    R0,R2                                                            
         LH    RF,RECLEN                                                        
         LR    R1,RF                                                            
         MVCL  R0,RE               COPY IN A BLANK RECORD                       
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           FOR NEXT ROUTINE                             
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         LA    R5,TLSTELEM         R5=A(FIRST ELEMENT)                          
TLXSTF10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXSTF40                                                         
         CLI   0(R5),TAPWELQ       PASSWORD ELEMENT X'13'                       
         JE    TLXSTF30                                                         
TLXSTF20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXSTF10                                                         
*                                                                               
         USING TAPWD,R5                                                         
TLXSTF30 MVC   TX13PSW,TAPWPWD     PASSWORD                                     
         ICM   RF,15,AENCKEY       DO WE HAVE AN ENCRYPTION KEY                 
         JZ    TLXSTF40                                                         
         LA    R6,TX13PSW                                                       
         GOTO1 VCRYPT,DMCB,L'TX13PSW,(R6),(RF)                                  
         DROP  R5                                                               
*                                                                               
TLXSTF40 LA    R5,TLSTELEM         R5=A(FIRST ELEMENT)                          
TLXSTF50 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXSTFXX                                                         
         CLI   0(R5),TASTELQ       STAFF ELEMENT X'12'                          
         JE    TLXSTF70                                                         
         CLI   0(R5),TASNELQ       SHORT NAME ELEMENT X'21'                     
         JE    TLXSTF80                                                         
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXSTF90                                                         
TLXSTF60 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXSTF50                                                         
*                                                                               
         USING TASTD,R5                                                         
TLXSTF70 MVC   TX13FNME,TASTFST    FIRST NAME                                   
         MVC   TX13LNME,TASTLST    LAST NAME                                    
         MVC   TX13TYPE,TASTTYPE   TYPE                                         
         MVC   TX13MANG,TASTMGR    MANAGER                                      
         MVC   TX13TEL,TASTTEL     TELEPHONE                                    
         MVC   TX13CGRP,TASTCLG    CLIENT GROUP ACCESS                          
         J     TLXSTF60                                                         
         DROP  R5                                                               
*                                                                               
         USING TASND,R5                                                         
TLXSTF80 MVC   TX13SNME,TASNAME    SHORT NAME                                   
         J     TLXSTF60                                                         
         DROP  R5                                                               
*                                                                               
         USING TACMD,R5                                                         
TLXSTF90 CLI   TACMTYPE,TACMTYPI   EMAIL                                        
         JNE   TLXSTF60                                                         
*                                                                               
         SR    RF,RF                                                            
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXSTF60                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX13EMAL(0),TACMCOMM                                             
         J     TLXSTF60                                                         
         DROP  R5                                                               
*                                                                               
TLXSTFXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
*&&DO                                                                           
*      15MAR18 GHOA - TAALD AND TACLD NO LONGER EXIST                           
***********************************************************************         
* TLXLAGR - EXTRACT LIMITED AGENCY RECORDS - 5314                     *         
***********************************************************************         
         SPACE 1                                                                
TLXLAGR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK14CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX14LEN)                                          
         MVC   TLXRETYP,TLXLAGQ                                                 
*                                                                               
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TX14USER-1,MXTRTQ                                                
         MVI   TX14SID-1,MXTRTQ                                                 
         MVI   TX14LAGY-1,MXTRTQ                                                
         MVI   TX14X,MXTRTQ                                                     
         MVI   TX14X+1,MXTRTQ                                                   
*                                                                               
         GOTOR GETUSER,TLSTUSER                                                 
         MVC   TX14USER,WORK       USERID                                       
*                                                                               
         MVC   TX14SID,TLSTSTAF    STAFF ID                                     
*                                                                               
         LA    R5,TLSTELEM         R5=A(FIRST ELEMENT)                          
TLXLAG10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXLAGXX                                                         
         CLI   0(R5),TAALELQ       AGENCY LIMIT ELEMENT X'14'                   
         JE    TLXLAG30                                                         
*                                                                               
TLXLAG20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXLAG10                                                         
*                                                                               
* NEED TO BUILD MULTIPLE RECORDS                                                
         USING TAALD,R5                                                         
TLXLAG30 SR    R0,R0                                                            
         ICM   R0,1,TAALNOFF       NUMBER OF LIMITED AGENCIES                   
*                                                                               
         SR    RF,RF               LIMITED AGENCIES                             
         IC    RF,TAALLEN                                                       
         SHI   RF,4                                                             
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX14LAGY(0),TAALOFF                                              
         J     TLXLAG20                                                         
         DROP  R5                                                               
*                                                                               
TLXLAGXX J     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* TLXLCLR - EXTRACT LIMITED CLIENT RECORDS - 5315                     *         
***********************************************************************         
         SPACE 1                                                                
TLXLCLR  NTR1                                                                   
*                                                                               
         USING PKCNTS,RE                                                        
         L     RE,APKCNTS                                                       
         LTR   RE,RE               DO WE HAVE ANYTHING TO ADD?                  
         BZ    *+10                                                             
         AP    PK15CNT,=P'1'                                                    
         DROP  RE                                                               
*                                                                               
         L     R2,ANEXT2           WHERE RECORDS TO BE BUILT                    
*                                                                               
         LR    R0,R2               R0=A(OUTPUT RECORD)                          
         LH    R1,RECLEN                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,8,SPACES                                                      
         MVCL  R0,RE               SET RECORD TO ALL SPACES                     
*                                                                               
         LH    RF,RECLEN                                                        
         AR    RF,R2                                                            
         ST    RF,ANEXT2           SET NEXT SLOT FOR NEXT ROUTINE               
         XC    0(8,RF),0(RF)       CLEAR START OF NEXT DATA SPACE               
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX15LEN)                                          
         MVC   TLXRETYP,TLXLCLQ                                                 
*                                                                               
         MVC   TLXREACT,SVACT      ACTION                                       
         MVC   TLXREDAT,SVDAT      DATE                                         
         MVC   TLXRETIM,SVTIM      TIME                                         
*                                                                               
         MVI   TX15USER-1,MXTRTQ                                                
         MVI   TX15SID-1,MXTRTQ                                                 
         MVI   TX15LCLI-1,MXTRTQ                                                
         MVI   TX15LAGY-1,MXTRTQ                                                
         MVI   TX15X,MXTRTQ                                                     
         MVI   TX15X+1,MXTRTQ                                                   
*                                                                               
         GOTOR GETUSER,TLSTUSER                                                 
         MVC   TX15USER,WORK       USERID                                       
*                                                                               
         MVC   TX15SID,TLSTSTAF    STAFF ID                                     
*                                                                               
         LA    R5,TLSTELEM         R5=A(FIRST ELEMENT)                          
TLXLCL10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXLCLXX                                                         
         CLI   0(R5),TAALELQ       AGENCY LIMIT ELEMENT X'14'                   
         JE    TLXLCL30                                                         
         CLI   0(R5),TACLELQ       CLIENT LIMIT ELEMENT X'15'                   
         JE    TLXLCL40                                                         
*                                                                               
TLXLCL20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXLCL10                                                         
*                                                                               
* NEED TO BUILD MULTIPLE RECORDS                                                
         USING TAALD,R5                                                         
TLXLCL30 SR    R0,R0                                                            
         ICM   R0,1,TAALNOFF       NUMBER OF LIMITED AGENCIES                   
*                                                                               
         SR    RF,RF               LIMITED AGENCIES                             
         IC    RF,TAALLEN                                                       
         SHI   RF,4                                                             
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX15LAGY(0),TAALOFF                                              
         J     TLXLCL20                                                         
         DROP  R5                                                               
*                                                                               
* NEED TO BUILD MULTIPLE RECORDS                                                
         USING TACLD,R5                                                         
TLXLCL40 SR    R0,R0                                                            
         ICM   R0,1,TACLNCLI       NUMBER OF LIMITED CLIENTS                    
*                                                                               
         SR    RF,RF               LIMITED CLIENTS                              
         IC    RF,TACLLEN                                                       
         SHI   RF,4                                                             
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX15LCLI(0),TACLCLI                                              
         J     TLXLCL20                                                         
         DROP  R5                                                               
*                                                                               
TLXLCLXX J     EXIT                                                             
         DROP  R2,R3,R4                                                         
*                                                                               
TLXLCLLT DC    A(LITERAL)                                                       
*&&                                                                             
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* TLXGRTC - EXTRACT GUARANTEE RECORDS - 5316                          *         
*                                                                     *         
* AL4 A(EXTRACT RECORD)                                               *         
* AL4 A(GUARANTEE RECORD)                                             *         
* AL4 0=TALFILE-TO-EXTRACT                                            *         
* AL4 A(SXDTABD)                                                      *         
***********************************************************************         
         SPACE 1                                                                
TLXGRTC  NMOD1 WORKX-WORKD,*TLXGRT*,RR=RA                                       
         USING WORKD,RC                                                         
         L     RA,TLXGRTLT                                                      
         USING LITERAL,RA                                                       
         ST    R1,APARM                                                         
         MVC   PARM,0(R1)          EXTRACT PARAMETER LIST                       
         LM    R2,R3,0(R1)                                                      
         L     R4,12(R1)                                                        
         USING TLXRECD,R2          R2=A(EXTRACT RECORD)                         
         USING TLGUD,R3            R3=A(GUARANTEE RECORD)                       
         USING SXDTABD,R4          R4=A(SXDXTABD)                               
*                                                                               
         SR    R0,R0               INITIALIZE TLXRECD TO SPACES                 
         SR    R1,R1                                                            
         ICM   R1,8,SPACES                                                      
         LR    RE,R2                                                            
         AHI   RE,TLXREHDL                                                      
         LA    RF,TX16LEN                                                       
         SHI   RF,TLXREHDL                                                      
         MVCL  RE,R0                                                            
*                                                                               
         XC    TLXRELEN,TLXRELEN   RECORD LENGTH/TYPE/ENDOFREC                  
         MVC   TLXRELEN(2),=Y(TX16LEN)                                          
         MVC   TLXRETYP,TLXGRTQ                                                 
*                                                                               
         MVI   TX16SSN-1,MXTRTQ                                                 
         MVI   TX16GRT-1,MXTRTQ                                                 
         MVI   TX16AGY-1,MXTRTQ                                                 
         MVI   TX16CLI-1,MXTRTQ                                                 
         MVI   TX16SDAT-1,MXTRTQ                                                
         MVI   TX16EDAT-1,MXTRTQ                                                
         MVI   TX16ATTC-1,MXTRTQ                                                
         MVI   TX16CORC-1,MXTRTQ                                                
         MVI   TX16DBAL-1,MXTRTQ                                                
         MVI   TX16PPH-1,MXTRTQ                                                 
         MVI   TX16POVR-1,MXTRTQ                                                
         MVI   TX16ADDP-1,MXTRTQ                                                
         MVI   TX16INSP-1,MXTRTQ                                                
         MVI   TX16NOG-1,MXTRTQ                                                 
         MVI   TX16REFG-1,MXTRTQ                                                
         MVI   TX16LOKG-1,MXTRTQ                                                
         MVI   TX16TPAY-1,MXTRTQ                                                
         MVI   TX16BAL-1,MXTRTQ                                                 
         MVI   TX16IOVR-1,MXTRTQ                                                
         MVI   TX16LPAG-1,MXTRTQ                                                
         MVI   TX16PIAM-1,MXTRTQ                                                
         MVI   TX16ICOM-1,MXTRTQ                                                
         MVI   TX16IGRT-1,MXTRTQ                                                
         MVI   TX16GPST-1,MXTRTQ                                                
         MVI   TX16GPEN-1,MXTRTQ                                                
         MVI   TX16GTOT-1,MXTRTQ                                                
         MVI   TX16GBAL-1,MXTRTQ                                                
         MVI   TX16COMT-1,MXTRTQ                                                
         MVI   TX16X,MXTRTQ                                                     
         MVI   TX16X+1,MXTRTQ                                                   
*                                                                               
         MVC   TX16SSN,TLGUSSN     SOCIAL SECURITY NUMBER                       
         MVC   TX16GRT,TLGUGUA     GUARANTEE CODE                               
         XC    TX16GRT,HEXFFS      UNCOMPLEMENT IT                              
*                                                                               
         LA    R5,TLGUELEM         R5=A(FIRST ELEMENT)                          
TLXGRT10 CLI   0(R5),0             GET ELEMENT FROM RECORD                      
         JE    TLXGRTXX                                                         
         CLI   0(R5),TAGUELQ       GUARANTEE DETAILS ELEMENT X'61'              
         JE    TLXGRT30                                                         
         CLI   0(R5),TAGCELQ       GUARANTEE CYCLE ELEMENT X'61'                
         JE    TLXGRT40                                                         
         CLI   0(R5),TACMELQ       COMMENT ELEMENT X'8D'                        
         JE    TLXGRT50                                                         
*                                                                               
TLXGRT20 SR    RF,RF                                                            
         IC    RF,1(R5)                                                         
         AR    R5,RF                                                            
         J     TLXGRT10                                                         
*                                                                               
         USING TAGUD,R5                                                         
TLXGRT30 MVC   TX16AGY,TAGUAGY     AGENCY                                       
         MVC   TX16CLI,TAGUCLI     CLIENT                                       
*                                                                               
         GOTO1 DATCON,DMCB,(X'11',TAGUSTRT),(10,TX16SDAT)                       
*                                                                               
         MVC   TX16ATTC,TAGUATT    ATTENTION CODE                               
         MVC   TX16CORC,TAGUCRP    CORPORATE CODE                               
*                                                                               
         MVI   TX16DBAL,C'N'       DESCENDING BALANCE                           
         TM    TAGUSTAT,TAGUSDES                                                
         JZ    *+8                                                              
         MVI   TX16DBAL,C'Y'                                                    
*                                                                               
         MVI   TX16PPH,C'N'        PAY P&H                                      
         TM    TAGUSTAT,TAGUSPNH                                                
         JZ    *+8                                                              
         MVI   TX16PPH,C'Y'                                                     
*                                                                               
         MVI   TX16POVR,C'N'       PAY OVERAGE                                  
         TM    TAGUSTAT,TAGUSOVR                                                
         JZ    *+8                                                              
         MVI   TX16POVR,C'Y'                                                    
*                                                                               
         MVI   TX16ADDP,C'N'       ADDED TO PAY PROGRAM                         
         TM    TAGUSTAT,TAGUSPAY                                                
         JZ    *+8                                                              
         MVI   TX16ADDP,C'Y'                                                    
*                                                                               
         MVI   TX16INSP,C'N'       INSTALLMENT PAYMENT PAID                     
         TM    TAGUSTAT,TAGUSINS                                                
         JZ    *+8                                                              
         MVI   TX16INSP,C'Y'                                                    
*                                                                               
         MVI   TX16NOG,C'N'        DON'T APPLY GRT                              
         TM    TAGUSTAT,TAGUSNO                                                 
         JZ    *+8                                                              
         MVI   TX16NOG,C'Y'                                                     
*                                                                               
         MVI   TX16REFG,C'N'       GRT BALANCE WAS REFRESHED                    
         TM    TAGUSTAT,TAGUSREF                                                
         JZ    *+8                                                              
         MVI   TX16REFG,C'Y'                                                    
*                                                                               
         MVI   TX16LOKG,C'N'       GRT RECORD IS LOCKED                         
         TM    TAGUSTAT,TAGUSLCK                                                
         JZ    *+8                                                              
         MVI   TX16LOKG,C'Y'                                                    
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAGUAMT       TOTAL GUARANTEE PAYMENT                      
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX16TPAY,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAGUBAL       BALANCE                                      
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX16BAL,DUB                                                      
*                                                                               
         MVI   TX16IOVR,C'N'       IGNORE OVERAGE ON ESTIMATING                 
         TM    TAGUSTA2,TAGUSIGP                                                
         JZ    *+8                                                              
         MVI   TX16IOVR,C'Y'                                                    
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,3,TAGULPG        LAST PAGE NUMBER PRINTED                     
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX16LPAG,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAGUPAY       PAYMENT INSTALLMENT AMOUNT                   
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX16PIAM,DUB                                                     
*                                                                               
         GOTO1 VHEXOUT,DMCB,TAGUCOM,TX16ICOM,L'TAGUCOM,0                        
*                                                                               
         GOTO1 VHEXOUT,DMCB,TAGUINV,TX16IGRT,L'TAGUINV,0,L'TX16IGRT             
         J     TLXGRT20                                                         
         DROP  R5                                                               
*                                                                               
         USING TAGCD,R5                                                         
TLXGRT40 OC    TAGCSTRT,TAGCSTRT   GRT CYCLE PERIOD START DATE                  
         JZ    TLXGRT42                                                         
         LA    R1,DMCB                                                          
         LA    RF,TAGCSTRT                                                      
         ST    RF,0(R1)                                                         
         MVI   0(R1),X'01'                                                      
         OC    TAGCEND,TAGCEND                                                  
         JZ    *+8                                                              
         OI    0(R1),X'10'                                                      
         GOTO1 DATCON,DMCB,,(10,TX16GPST)                                       
*                                                                               
TLXGRT42 SR    R0,R0                                                            
         ICM   R0,15,TAGCAMT       GRT CYCLE TOTAL GUARANTEE AMOUNT             
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX16GTOT,DUB                                                     
*                                                                               
         SR    R0,R0                                                            
         ICM   R0,15,TAGCBAL       GRT CYCLE BALANCE                            
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  TX16GBAL,DUB                                                     
         J     TLXGRT20                                                         
*                                                                               
         USING TACMD,R5                                                         
TLXGRT50 CLI   TACMTYPE,TACMTYPG   GENERAL COMMENT                              
         JNE   TLXGRT20                                                         
*                                                                               
         SR    RF,RF                                                            
         IC    RF,TACMLEN                                                       
         SHI   RF,4                                                             
         JM    TLXGRT20                                                         
         EX    RF,*+8                                                           
         J     *+10                                                             
         MVC   TX16COMT(0),TACMCOMM                                             
         J     TLXGRT20                                                         
         DROP  R5                                                               
*                                                                               
TLXGRTXX J     EXIT                                                             
         DROP  R2,R3,R4                                                         
*                                                                               
TLXGRTLT DC    A(LITERAL)                                                       
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
         LTORG                                                                  
         EJECT                                                                  
**********************************************************************          
* COMMON ROUTINES                                                    *          
**********************************************************************          
         SPACE 1                                                                
GETUSER  NTR1  BASE=*,LABEL=*                                                   
         MVC   WORK,SPACES                                                      
         USING CTIREC,IOAREA                                                    
         XC    CTIKEY,CTIKEY                                                    
         MVI   CTIKTYP,CTIKTYPQ                                                 
         MVC   CTIKNUM,0(R1)                                                    
         OC    CTIKNUM,CTIKNUM     MAY NOT BE PRESENT                           
         BZ    GETUX                                                            
         GOTO1 DATAMGR,DMCB,DMREAD,CTFILE,CTIKEY,CTIKEY                         
         BNE   GETUX                                                            
         LA    R2,CTIDATA                                                       
         SR    R0,R0                                                            
*                                                                               
         USING CTDSCD,R2                                                        
GETU10   CLI   CTDSCEL,0                                                        
         JE    GETUX                                                            
         CLI   CTDSCEL,CTDSCELQ                                                 
         JE    GETU20                                                           
         IC    R0,CTDSCLEN                                                      
         AR    R2,R0                                                            
         J     GETU10                                                           
*                                                                               
GETU20   MVC   WORK(10),CTDSC                                                   
*                                                                               
GETUX    J     EXIT                                                             
         EJECT                                                                  
**********************************************************************          
* COMMON UTILITIES                                                   *          
**********************************************************************          
         SPACE 1                                                                
LITERAL  DS    0D                                                               
ANEXT    DC    F'0'                                                             
ANEXT2   DC    F'0'                                                             
*                                                                               
SVACT    DS    CL1                 SAVED ACTION FROM PREVIOUS REC               
SVDAT    DS    CL8                 SAVED DATE   FROM PREVIOUS REC               
SVTIM    DS    CL6                 SAVED TIME   FROM PREVIOUS REC               
*                                                                               
DMREAD   DC    C'DMREAD '                                                       
CTFILE   DC    C'CTFILE '                                                       
*                                                                               
DATCON   DC    V(DATCON)                                                        
TINVCON  DC    V(TINVCON)                                                       
DATAMGR  DC    V(DATAMGR)                                                       
VHEXOUT  DC    V(HEXOUT)                                                        
VCRYPT   DC    V(CRYPT)                                                         
*                                                                               
SPACES   DC    CL200' '                                                         
HEXFFS   DC    80X'FF'                                                          
ZEROS    DC    10C'0'                                                           
         EJECT                                                                  
**********************************************************************          
* INCLUDES AND BUFFERS                                               *          
**********************************************************************          
         SPACE 1                                                                
*MXTRT                                                                          
       ++INCLUDE MXTRT                                                          
         EJECT                                                                  
*TLXRECID                                                                       
       ++INCLUDE TLXRECID                                                       
         EJECT                                                                  
       ++INCLUDE FALANGTAB                                                      
         EJECT                                                                  
*                                                                               
         DC    CL8'BUFFER01'                                                    
BUFFER1  DC    3000XL8'00'         HOLDS RECORDS FOR WRITING TO FILE            
BUFFER1L EQU   *-BUFFER1                                                        
         DC    8X'FF'                                                           
*                                                                               
         DC    CL8'BUFFER02'                                                    
BUFFER2  DC    3000XL8'00'         HOLDS RECORDS FOR WRITING TO FILE            
BUFFER2L EQU   *-BUFFER2                                                        
         DC    8X'FF'                                                           
*                                                                               
WORKD    DSECT                                                                  
PARM     DS    0XL24               PARAMETER LIST                               
TXREC    DS    A                   A(EXTRACT RECORD)                            
TFREC    DS    A                   A(ACCFILE RECORD)                            
         DS    A                                                                
         DS    A                                                                
         DS    A                                                                
AENCKEY  DS    A                   ONLY FOR TLXSTFC                             
         ORG   AENCKEY                                                          
         DS    A                   FOR ALL ELSE (TLXCSTC)                       
*                                                                               
DUB      DS    D                                                                
DUB2     DS    D                                                                
WORK     DS    XL20                                                             
APARM    DS    A                   A(PARAMETER LIST)                            
DMWORK   DS    12D                                                              
RELO     DS    A                                                                
APKCNTS  DS    A                   RECORD ACCUMULATORS                          
AHIDBUF  DS    A                                                                
ABUFFRIN DS    A                                                                
ACOMFACS DS    A                                                                
DMCB     DS    6F                                                               
HALF     DS    H                                                                
RECLEN   DS    H                                                                
LASTLEN  DS    H                                                                
LASTLEN1 DS    H                                                                
BYTE     DS    XL1                                                              
ACCADDR  DS    XL4                                                              
IOKEY    DS    CL64                                                             
*                                                                               
BUFFRET  DS    XL1                                                              
HIDREC   DS    0CL(L'TX22HFID)                                                  
HIDICOM  DS    CL8                 INTERNAL COMMERCIAL NUMBER                   
HIDFCDTE DS    CL8                 1ST CYCLE DATE OF LAST HOLDING FEE           
*                                                                               
IOAREA   DS    2048X                                                            
*                                                                               
WORKX    EQU   *                                                                
         EJECT                                                                  
PKCNTS   DSECT                                                                  
PK00CNT  DS    PL8                 05300 REC COUNT (AGENCY)                     
PK01CNT  DS    PL8                 05301 REC COUNT (LIMITED NETWORK)            
PK02CNT  DS    PL8                 05302 REC COUNT (AGENCY GROUP)               
PK03CNT  DS    PL8                 05303 REC COUNT (W-4)                        
PK04CNT  DS    PL8                 05304 REC COUNT (AGENT)                      
PK05CNT  DS    PL8                 05305 REC COUNT (CLIENT)                     
PK06CNT  DS    PL8                 05306 REC COUNT (PRODUCT)                    
PK07CNT  DS    PL8                 05307 REC COUNT (CAST)                       
PK08CNT  DS    PL8                 05308 REC COUNT (OVERSCALE AMOUNT)           
PK09CNT  DS    PL8                 05309 REC COUNT (OVERSCALE PERCENT)          
PK10CNT  DS    PL8                 05310 REC COUNT (CAST ERRORD)                
PK11CNT  DS    PL8                 05311 REC COUNT (COMMERCIAL)                 
PK12CNT  DS    PL8                 05312 REC COUNT (AFM)                        
PK13CNT  DS    PL8                 05313 REC COUNT (STAFF)                      
PK14CNT  DS    PL8                 05314 REC COUNT (LIMITED AGENCY)             
PK15CNT  DS    PL8                 05315 REC COUNT (LIMITED CLIENT)             
PK16CNT  DS    PL8                 05316 REC COUNT (GUARANTEE)                  
PK17CNT  DS    PL8                 05317 REC COUNT (EPISODE)                    
PK18CNT  DS    PL8                 05318 REC COUNT (COMMERCIAL VERSION)         
PK19CNT  DS    PL8                 05319 REC COUNT (MUSIC CODE)                 
PK20CNT  DS    PL8                 05320 REC COUNT (COMMERCIAL PRODUCT)         
PK21CNT  DS    PL8                 05321 REC COUNT (PID)                        
PK22CNT  DS    PL8                 05322 REC COUNT (HOLDING FEES ID)            
* DXDSECTS                                                                      
       ++INCLUDE DXDSECTS                                                       
         EJECT                                                                  
* TLXRECD                                                                       
       ++INCLUDE TLXRECD                                                        
         EJECT                                                                  
* TAGENFILE                                                                     
         PRINT OFF                                                              
       ++INCLUDE TAGENFILE                                                      
         PRINT ON                                                               
* CTGENFILE                                                                     
         PRINT OFF                                                              
       ++INCLUDE CTGENFILE                                                      
         PRINT ON                                                               
* DDBUFFD                                                                       
         PRINT OFF                                                              
       ++INCLUDE DDBUFFD                                                        
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'007TLXROUTS  03/15/18'                                      
         END                                                                    
