*          DATA SET SPREPA2TP  AT LEVEL 008 AS OF 05/01/02                      
*CATALP SPA2TP                                                                  
         TITLE 'SPA2TP - TAPE INTERFACES FOR SPA2 REPORT'                       
SPA2TP   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 0,SPA2TP                                                         
         L     RA,0(R1)                                                         
         USING SPWORKD,RA,R9                                                    
         LA    R9,2048(RA)                                                      
         LA    R9,2048(R9)                                                      
*                                                                               
         L     R7,MEDBUFF                                                       
         USING MEDBLOCK,R7                                                      
*                                                                               
         MVC   SVAPRREC,4(R1)      SAVE PRREC ADDRESS                           
*                                                                               
         CLI   0(R1),C'D'          BUY DETAIL                                   
         BE    DTL                                                              
         CLI   0(R1),C'S'          STATION TOTAL                                
         BE    STAT                                                             
         CLI   0(R1),C'P'          PRD TOTAL                                    
         BE    HDR                                                              
         CLI   0(R1),C'I'          BILL REC                                     
         BE    INV                                                              
         CLI   0(R1),C'X'                                                       
         BE    CLS                                                              
         DC    H'0'                                                             
EXIT     XIT1                                                                   
         EJECT                                                                  
DTL      DS    0H                                                               
         CLC   =CL2'BJ',AGY         IS THIS A BJ OR JWT REQUEST?                
         BE    EXIT                 BJ                                          
*                                   JWT                                         
         LA    R4,MEDMON01                                                      
         L     R5,MEDNUMMO                                                      
         LA    R2,JWSPOTS                                                       
*                                                                               
DTL2     OC    0(2,R4),0(R4)                                                    
         BZ    DTL10                                                            
         L     R1,4(R4)                                                         
         USING MEDDATA,R1                                                       
         L     R0,MEDBYGRS                                                      
         CVD   R0,DUB                                                           
         AP    104(8,R2),DUB       GROSS DOLLARS                                
         L     R0,MEDBYNET                                                      
         CVD   R0,DUB                                                           
         AP    208(8,R2),DUB       NET                                          
         L     R0,MEDBYSPT                                                      
         CVD   R0,DUB                                                           
         AP    0(8,R2),DUB         SPOTS                                        
* NEXT MONTH                                                                    
DTL10    LA    R2,8(R2)                                                         
         LA    R4,12(R4)                                                        
         BCT   R5,DTL2                                                          
*                                                                               
         B     EXIT                                                             
         EJECT                                                                  
STAT     DS    0H                                                               
         CLC   =CL2'BJ',AGY        IS THIS A JWT OR A BJ REQUEST?               
         BE    STA20                BJ                                          
*                                                                               
         CLC   =C'FDT',QUESTOR                                                  
         BE    STAFD                                                            
*                                   JWT                                         
* ROLL TO PRD TOTALS                                                            
         LA    R0,39                                                            
         LA    R1,JWSPOTS                                                       
         LA    R2,TJWSPOTS                                                      
STA2     AP    0(8,R2),0(8,R1)                                                  
         LA    R1,8(R1)                                                         
         LA    R2,8(R2)                                                         
         BCT   R0,STA2                                                          
* BUILD EST DTL REC                                                             
         BAS   RE,BLDHDR                                                        
         MVC   EDSTA,STA                                                        
         CLI   EDSTA+4,C' '                                                     
         BNE   *+8                                                              
         MVI   EDSTA+4,C'T'                                                     
*                                                                               
         LA    R4,MEDMON01                                                      
         L     R5,MEDNUMMO                                                      
         LA    R2,JWSPOTS                                                       
*                                                                               
STA10    OC    0(2,R4),0(R4)                                                    
         BZ    STA12                                                            
*                                                                               
         GOTO1 DATCON,DMCB,(2,2(R4)),WORK                                       
         MVC   EDMONSVC,WORK                                                    
*                                                                               
*                                                                               
         CP    0(8,R2),=P'0'                                                    
         BNE   STA11                                                            
         CP    104(8,R2),=P'0'                                                  
         BNE   STA11                                                            
         CP    208(8,R2),=P'0'                                                  
         BNE   STA11                                                            
         B     STA12                                                            
*                                                                               
STA11    OI    7(R2),X'0F'                                                      
         OI    104+7(R2),X'0F'                                                  
         OI    208+7(R2),X'0F'                                                  
         UNPK  EDSPOTS,0(8,R2)                                                  
         UNPK  EDGROSS,104(8,R2)                                                
         UNPK  EDNET,208(8,R2)                                                  
*                                                                               
         ZAP   DUB,104(8,R2)                                                    
         SP    DUB,208(8,R2)                                                    
         OI    DUB+7,X'0F'                                                      
         UNPK  EDCOMM,DUB                                                       
*                                                                               
         BAS   RE,PUTEK                                                         
         EJECT                                                                  
STA12    LA    R2,8(R2)                                                         
         LA    R4,12(R4)                                                        
         BCT   R5,STA10                                                         
         B     STACLR                                                           
         EJECT                                                                  
* BUILD FORD DEALER INTERFACE RECORD *                                          
         SPACE 1                                                                
STAFD    MVC   FDREC,SPACES                                                     
         MVC   FDMED,QMED                                                       
         MVC   FDCLT,QCLT                                                       
         MVC   FDPRD,PRD                                                        
         ZIC   R0,BEST                                                          
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  FDEST,DUB                                                        
*                                                                               
         L     R6,ADEST                                                         
         USING ESTHDRD,R6                                                       
         MVC   FDSTART(12),ESTART                                               
         DROP  R6                                                               
*                                                                               
         MVC   FDOFFC,MGR1                                                      
*                                                                               
         L     R6,SVAPRREC                                                      
         USING PRREC,R6                                                         
         MVC   DUB(5),PRKMKT                                                    
         DROP  R6                                                               
*                                                                               
         GOTO1 MSUNPK,DMCB,DUB,FDMKT,FDSTA                                      
         CLI   FDSTA+4,C' '                                                     
         BNE   *+8                                                              
         MVI   FDSTA+4,C'T'                                                     
         SPACE 1                                                                
* SUM ACCUMULATORS *                                                            
         SPACE 1                                                                
         ZAP   TOTSPOTS,=P'0'                                                   
         ZAP   TOTGROSS,=P'0'                                                   
         ZAP   TOTNET,=P'0'                                                     
         LA    R0,13                                                            
         LA    R2,JWSPOTS                                                       
STAFD2   AP    TOTSPOTS,0(8,R2)                                                 
         AP    TOTGROSS,104(8,R2)                                               
         AP    TOTNET,208(8,R2)                                                 
         LA    R2,8(R2)                                                         
         BCT   R0,STAFD2                                                        
*                                                                               
         CP    TOTSPOTS,=P'0'                                                   
         BL    *+8                                                              
         OI    TOTSPOTS+7,X'0F'                                                 
         UNPK  FDSPOTS,TOTSPOTS                                                 
*                                                                               
         CP    TOTGROSS,=P'0'                                                   
         BL    *+8                                                              
         OI    TOTGROSS+7,X'0F'                                                 
         UNPK  FDGROSS,TOTGROSS                                                 
*                                                                               
         CP    TOTNET,=P'0'                                                     
         BL    *+8                                                              
         OI    TOTNET+7,X'0F'                                                   
         UNPK  FDNET,TOTNET                                                     
*                                                                               
STAFDBR  BC    0,STAFDPUT                                                       
         OI    *-3,X'F0'                                                        
         LA    R2,FDTAPE                                                        
         OPEN  ((R2),OUTPUT)                                                    
*                                                                               
STAFDPUT LA    R1,FDTAPE                                                        
         LA    R0,FDREC                                                         
         PUT   (1),(0)                                                          
         SPACE 2                                                                
* CLEAR ACCUMS *                                                                
         SPACE 1                                                                
STACLR   LA    R0,39                                                            
         LA    R1,JWSPOTS                                                       
         ZAP   0(8,R1),=P'0'                                                    
         LA    R1,8(R1)                                                         
         BCT   R0,*-10                                                          
*                                                                               
         B     EXIT                                                             
         SPACE 1                                                                
TOTSPOTS DC    PL8'0'                                                           
TOTGROSS DC    PL8'0'                                                           
TOTNET   DC    PL8'0'                                                           
         EJECT                                                                  
* THIS SECTION CREATES THE BOZELL & JACOBS INTERFACE TAPE *                     
         SPACE 1                                                                
STA20    DC    0H'0'                                                            
         L     R6,4(R1)                                                         
         USING PRREC,R6                                                         
         MVC   BJREC(132),SPACES                                                
         MVC   BJREC+132(118),SPACES                                            
         L     R0,MEDNUMMO         R0 = NUMBER OF MONTHS TO DO                  
         LA    R2,MEDMON01         R2 POINTS TO 1ST MONTH IN MEDBLOCK           
         LA    R4,PRDATA+8         R4 POINTS TO 1ST STATION TOTAL               
         CLC   QCLT,=C'AMR'        IS THIS TAPE FOR AMERICAN AIRLINES           
         BE    STA25                YES.                                        
         SPACE 1                                                                
* BUILD KEY FOR B&J/SCC *                                                       
         SPACE 1                                                                
         MVC   BJMED,QMED          MEDIA                                        
         MVC   BJCLT,CLT           CLIENT                                       
         MVC   BJPRD,PRD           PRODUCT                                      
         MVC   BJREG(4),MGR2+1     REGION/DISTRICT                              
         CLC   MGR2LEN,MGR3LEN     IS THIS A 3 LEVEL MKT GRP?                   
         BE    *+10                 NO.                                         
         MVC   BJREG(4),MGR3+1      YES.                                        
         MVC   DUB(5),PRKMKT                                                    
         GOTO1 MSUNPK,DMCB,DUB,WORK,BJSTA                                       
         LA    R3,BJDAT1           R3 POINTS TO 1ST MONTH IN BJRECORD           
         B     STA30                                                            
         SPACE 1                                                                
* BUILD KEY FOR B&J/AMR *                                                       
         SPACE 1                                                                
STA25    DS    0H                                                               
         MVC   BJAMED,QMED         MEDIA                                        
         MVC   BJACLT,CLT          CLIENT                                       
         MVC   BJAPRD,PRD          PRODUCT                                      
         ZIC   RF,BEST             ESTIMATE NUMBER                              
         CVD   RF,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  BJAEST,DUB                                                       
         MVC   BJADESC,ESTNM       ESTIMATE DESCRIPTION                         
         MVC   DUB(5),PRKMKT       MKT/STA                                      
         GOTO1 MSUNPK,DMCB,DUB,BJAMKT,BJASTA                                    
         LA    R3,BJADAT1          R3 POINTS TO 1ST MONTH IN BJAREC             
         SPACE 1                                                                
         SPACE 1                                                                
STA30    MVC   HALF,2(R2)                                                       
         GOTO1 DATCON,DMCB,(2,HALF),(0,WORK)                                    
         MVC   0(4,R3),WORK        BJDAT HAS YYMM                               
         MVC   DUB,0(R4)                                                        
         CP    DUB,=P'0'                                                        
         BL    STA40                                                            
         OI    DUB+7,X'0F'                                                      
STA40    UNPK  4(10,R3),DUB        GET THE DOLLARS                              
         LA    R3,14(R3)                                                        
         LA    R4,8(R4)                                                         
STA50    LA    R2,12(R2)                                                        
         C     R2,MEDALAST         IS THIS THE END OF THE MEDBUFF?              
         BH    STA60                YES.                                        
         OC    0(4,R2),0(R2)       ANY ACTIVITY THIS MONTH?                     
         BZ    STA50                NO.                                         
         BCT   R0,STA30                                                         
         SPACE 1                                                                
STA60    DS    0H                                                               
         CLC   QCLT,=C'AMR'        IS THIS TAPE FOR AMERICAN AIRLINES?          
         BNE   STA70                NO.                                         
         BAS   RE,PUTBJ2                                                        
         B     EXIT                                                             
         SPACE 1                                                                
STA70    DS    0H                                                               
         BAS   RE,PUTBJ                                                         
         B     EXIT                                                             
         EJECT                                                                  
HDR      DS    0H                                                               
         CLC   =CL2'BJ',AGY        IS THIS A BJ OR JWT REQUEST?                 
         BE    EXIT                 BJ                                          
*                                                                               
         CLC   =C'FDT',QUESTOR                                                  
         BE    EXIT                                                             
*                                   JWT                                         
         BAS   RE,BLDHDR                                                        
         MVC   EHTYPE,=C'EH'                                                    
*                                                                               
         L     R6,ADEST                                                         
         USING ESTHDRD,R6                                                       
         MVC   EHESTST(12),ESTART                                               
*                                                                               
         LA    R0,13                                                            
         LA    R1,TJWGROSS                                                      
         ZAP   DUB,=P'0'                                                        
         AP    DUB,0(8,R1)                                                      
         LA    R1,8(R1)                                                         
         BCT   R0,*-10                                                          
         OI    DUB+7,X'0F'                                                      
         UNPK  EHGROSS,DUB                                                      
         ZAP   WORK(8),DUB                                                      
*                                                                               
         LA    R0,13                                                            
         LA    R1,TJWNET                                                        
         ZAP   DUB,=P'0'                                                        
         AP    DUB,0(8,R1)                                                      
         LA    R1,8(R1)                                                         
         BCT   R0,*-10                                                          
         OI    DUB+7,X'0F'                                                      
         UNPK  EHNET,DUB                                                        
*                                                                               
         ZAP   WORK+8(8),DUB                                                    
         ZAP   DUB,WORK(8)                                                      
         SP    DUB,WORK+8(8)                                                    
         OI    DUB+7,X'0F'                                                      
         UNPK  EHCOMM,DUB                                                       
*                                                                               
         BAS   RE,PUTEK                                                         
*                                                                               
         LA    R0,39                                                            
         LA    R1,TJWSPOTS                                                      
         ZAP   0(8,R1),=P'0'                                                    
         LA    R1,8(R1)                                                         
         BCT   R0,*-10                                                          
*                                                                               
         B     EXIT                                                             
         EJECT                                                                  
INV      DS    0H                                                               
         CLC   =CL2'BJ',AGY        IS THIS A BJ OR JWT REQUEST?                 
         BE    EXIT                 BJ                                          
*                                                                               
         CLC   =C'FDT',QUESTOR                                                  
         BE    EXIT                                                             
*                                   JWT                                         
         BAS   RE,BLDHDR                                                        
         MVC   IHTYPE,=C'IH'                                                    
*                                                                               
         L     R6,ADBILL                                                        
         USING BILLRECD,R6                                                      
*                                                                               
         MVC   IHMONSVC,BMONSERV                                                
         MVC   IHINVNO,BINVNO                                                   
         MVI   IHINVTYP,C'S'                                                    
         CLI   BTYPE,4                                                          
         BNE   *+8                                                              
         MVI   IHINVTYP,C'D'                                                    
*                                                                               
         MVC   IHINVDT,BQDATE                                                   
         GOTO1 DATCON,DMCB,(3,BDUEDATE),IHDUEDT                                 
*                                                                               
         PACK  DUB,BAMT                                                         
         OI    DUB+7,X'0F'                                                      
         UNPK  IHGROSS,DUB                                                      
         MVC   DUB(4),BNET                                                      
         L     R0,DUB                                                           
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  IHNET,DUB                                                        
         ZAP   WORK(8),DUB                                                      
         PACK  DUB,BAMT                                                         
         SP    DUB,WORK(8)                                                      
         OI    DUB+7,X'0F'                                                      
         UNPK  IHCOMM,DUB                                                       
*                                                                               
         BAS   RE,PUTEK                                                         
*                                                                               
         B     EXIT                                                             
         EJECT                                                                  
CLS      DS    0H                                                               
         CLC   =CL2'BJ',AGY        IS THIS A JWT OR A BJ REQUEST?               
         BE    CLS10                BJ                                          
*                                   JWT                                         
         CLI   STAFDBR+1,0         TEST FDTAPE OPEN                             
         BE    CLS5                                                             
         LA    R2,FDTAPE                                                        
         CLOSE (2)                                                              
*                                                                               
CLS5     CLI   PUTEKBR+1,0         TEST TAPE OPEN                               
         BE    EXIT                NO                                           
         LA    R2,EKTAPE                                                        
         CLOSE (2)                                                              
         B     EXIT                                                             
         SPACE 1                                                                
CLS10    DS    0H                                                               
         CLI   PUTBJ10+1,0         HAS THE TAPE BEEN OPENED?                    
         BE    CLS20                NO.                                         
         LA    R2,BJTAPE                                                        
         CLOSE (2)                                                              
         SPACE 1                                                                
CLS20    DS    0H                                                               
         CLI   PUTBJ30+1,0         HAS THE TAPE BEEN OPENED?                    
         BE    EXIT                 NO.                                         
         LA    R2,BJTAPE2                                                       
         CLOSE (2)                                                              
         B     EXIT                                                             
         SPACE 1                                                                
BLDHDR   NTR1                                                                   
         MVC   EKREC,SPACES                                                     
         MVC   EDTYPE,=C'ED'                                                    
         MVC   EDMED,QMED                                                       
         MVC   EDCLT,CLT                                                        
         MVC   EDPRD,PRD                                                        
         MVC   EDEST,EST                                                        
*                                                                               
         L     R6,ADCLT                                                         
         USING CLTHDRD,R6                                                       
         MVC   DUB(2),CCLTINTR                                                  
         LH    R0,DUB                                                           
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  EDJWCLT,DUB                                                      
*                                                                               
         L     R6,ADPRD                                                         
         USING PRDHDRD,R6                                                       
         MVC   EDJWPRD,PACCT                                                    
*                                                                               
         B     EXIT                                                             
         EJECT                                                                  
PUTEK    NTR1                                                                   
PUTEKBR  BC    0,PUT2                                                           
         OI    *-3,X'F0'                                                        
         LA    R2,EKTAPE                                                        
         OPEN  ((2),OUTPUT)                                                     
*                                                                               
PUT2     LA    R1,EKTAPE                                                        
         LA    R0,EKREC                                                         
         PUT   (1),(0)                                                          
*                                                                               
         B     EXIT                                                             
         SPACE 2                                                                
JWSPOTS  DC    13PL8'0'                                                         
JWGROSS  DC    13PL8'0'                                                         
JWNET    DC    13PL8'0'                                                         
TJWSPOTS DC    13PL8'0'                                                         
TJWGROSS DC    13PL8'0'                                                         
TJWNET   DC    13PL8'0'                                                         
         SPACE 2                                                                
PUTBJ    NTR1                                                                   
PUTBJ10  BC    0,PUTBJ20                                                        
         OI    *-3,X'F0'                                                        
         LA    R2,BJTAPE                                                        
         GOTO1 DYNALLOC,DMCB,DDBJ,DSNBJ                                         
         OPEN  ((2),OUTPUT)                                                     
         B     PUTBJ20                                                          
DDBJ     DC    CL8'BJTAPE2'                                                     
DSNBJ    DC    CL20'SPTTAPE.SP0A2BJ1'                                           
         SPACE 1                                                                
PUTBJ20  LA    R1,BJTAPE                                                        
         LA    R0,BJREC                                                         
         PUT   (1),(0)                                                          
         B     EXIT                                                             
         SPACE 1                                                                
PUTBJ2   NTR1                                                                   
PUTBJ30  BC    0,PUTBJ40                                                        
         OI    *-3,X'F0'                                                        
         LA    R2,BJTAPE2                                                       
         OPEN  ((2),OUTPUT)                                                     
         SPACE 1                                                                
PUTBJ40  DS    0H                                                               
         LA    R1,BJTAPE2                                                       
         LA    R0,BJREC                                                         
         PUT   (1),(0)                                                          
         B     EXIT                                                             
         EJECT                                                                  
SVAPRREC DS    A                                                                
*                                                                               
         DS    0D                                                               
EKREC    DS    CL80                                                             
         SPACE 2                                                                
         ORG EKREC                                                              
FDREC    DS    0CL80               ***** FORD INTERFACE RECORD *****            
*                                                                               
FDMED    DS    CL1       A           MEDIA CODE                                 
FDCLT    DS    CL3       AAA         CLIENT CODE                                
FDPRD    DS    CL3       AAA         PRODUCT CODE                               
FDEST    DS    CL3       NNN         ESTIMATE NUMBER                            
FDSTART  DS    CL6       YYMMDD      EST START DATE                             
FDEND    DS    CL6       YYMMDD      EST END   DATE                             
FDOFFC   DS    CL3      (ANN)        JWT OFFICE CODE                            
FDMKT    DS    CL4       NNNN        MARKET CODE                                
FDSTA    DS    CL5       AAAAA       (CALL LETTERS + A/F/T)                     
FDSPOTS  DS    CL6       NNNNNN      NUMBER OF SPOTS                            
FDGROSS  DS    CL10      NNNNNNNNNN  GROSS DOLLARS (IN PENNIES)                 
FDNET    DS    CL10      NNNNNNNNNN  NET DOLLARS   (IN PENNIES)                 
         SPACE 2                                                                
         ORG   EKREC                                                            
EDRECD   DS    0CL80               ** ESTIMATE DETAIL RECORD DSECT **           
*                                                                               
EDTYPE   DS    CL2'ED'  A          RECORD TYPE                                  
EDMED    DS    CL1       A         MEDIA CODE                                   
EDCLT    DS    CL3       A         DDS CLIENT CODE                              
EDPRD    DS    CL3       A         DDS PRODUCT CODE                             
EDEST    DS    CL3       N         ESTIMATE NUMBER                              
EDJWCLT  DS    CL3       N         JWT CLIENT CODE                              
EDJWPRD  DS    CL4       N         JWT PRODUCT CODE                             
*                                                                               
EDMONSVC DS    CL4       N         MONTH OF SERVICE (YYMM)                      
EDSTA    DS    CL5      A          STATION (+ A/F/T)                            
         DS    CL18                SPARE                                        
EDSPOTS  DS    CL4                 SPOTS                                        
EDGROSS  DS    CL10      N         GROSS DOLLARS (2 DEC)                        
EDNET    DS    CL10      N         NET DOLLARS                                  
EDCOMM   DS    CL10      N         COMMISSION                                   
         SPACE 2                                                                
         ORG   EKREC                                                            
EHRECD   DS    0CL80               ** ESTIMATE HEADER RECORD DSECT **           
EHTYPE   DS    CL2'EH'   A         RECORD TYPE                                  
EHMED    DS    CL1       A         MEDIA CODE                                   
EHCLT    DS    CL3       A         DDS CLIENT CODE                              
EHPRD    DS    CL3       A         DDS PRODUCT CODE                             
EHEST    DS    CL3       N         ESTIMATE NUMBER                              
EHJWCLT  DS    CL3       N         JWT CLIENT CODE                              
EHJWPRD  DS    CL4       N         JWT PRODUCT CODE                             
*                                                                               
EHESTST  DS    CL6       N         ESTIMATE START DATE (YYMMDD)                 
EHESTND  DS    CL6       N         ESTIMATE  END  DATE  (YYMMDD)                
         DS    CL19                                                             
EHGROSS  DS    CL10      N         GROSS DOLLARS (2 DEC)                        
EHNET    DS    CL10      N         NET DOLLARS                                  
EHCOMM   DS    CL10      N         COMMISSION                                   
         SPACE 2                                                                
         ORG   EKREC                                                            
IHRECD   DS    0CL80               ** INVOICE HEADER RECORD DSECT **            
*                                                                               
IHTYPE   DS    CL2'IH'   A         RECORD TYPE                                  
IHMED    DS    CL1       A         MEDIA CODE                                   
IHCLT    DS    CL3       A         DDS CLIENT CODE                              
IHPRD    DS    CL3       A         DDS PRODUCT CODE                             
IHEST    DS    CL3       N         ESTIMATE NUMBER                              
IHJWCLT  DS    CL3       N         JWT CLIENT CODE                              
IHJWPRD  DS    CL4       N         JWT PRODUCT CODE                             
*                                                                               
IHMONSVC DS    CL4       N         MONTH OF SERVICE (YYMM)                      
IHINVNO  DS    CL6       N         INVOICE NUMBER                               
IHINVTYP DS    CL1       A         INVOICE TYPE (S=SUMM/D=DETAIL)               
IHINVDT  DS    CL6       N         INVOICE DATE (YYMMDD)                        
IHDUEDT  DS    CL6       N         DUE DATE (YYMMDD)                            
         DS    CL8                                                              
IHGROSS  DS    CL10      N         GROSS DOLLARS (2 DEC)                        
IHNET    DS    CL10      N         NET DOLLARS                                  
IHCOMM   DS    CL10      N         COMMISSION                                   
         ORG                                                                    
         SPACE 2                                                                
* BOZELL & JACOBS INTERFACE TAPE RECORD LAYOUT AND WORK AREA *                  
         SPACE 1                                                                
BJREC    DS    CL250               WORK AREA                                    
         SPACE 1                                                                
         ORG   BJREC                                                            
BJKEY    DS    0CL18                                                            
BJMED    DS    CL1                 MEDIA                                        
BJCLT    DS    CL3                 CLIENT                                       
BJPRD    DS    CL3                 PRODUCT                                      
BJREG    DS    CL2                 REGION                                       
BJDIST   DS    CL2                 DISTRICT                                     
BJSTA    DS    CL5                 STATION                                      
         DS    CL2                 SPARE                                        
*                                                                               
BJDATA   DS    0CL232              DATA AREA                                    
BJDAT1   DS    CL4                 YYMM                                         
BJBKT1   DS    CL10                 DOLLARS                                     
BJDAT2   DS    CL4                 YYMM                                         
BJBKT2   DS    CL10                 DOLLARS                                     
BJDAT3   DS    CL4                 YYMM                                         
BJBKT3   DS    CL10                 DOLLARS                                     
BJDAT4   DS    CL4                 YYMM                                         
BJBKT4   DS    CL10                 DOLLARS                                     
BJDAT5   DS    CL4                 YYMM                                         
BJBKT5   DS    CL10                 DOLLARS                                     
BJDAT6   DS    CL4                 YYMM                                         
BJBKT6   DS    CL10                 DOLLARS                                     
BJDAT7   DS    CL4                 YYMM                                         
BJBKT7   DS    CL10                 DOLLARS                                     
BJDAT8   DS    CL4                 YYMM                                         
BJBKT8   DS    CL10                 DOLLARS                                     
BJDAT9   DS    CL4                 YYMM                                         
BJBKT9   DS    CL10                 DOLLARS                                     
BJDAT10  DS    CL4                 YYMM                                         
BJBKT10  DS    CL10                 DOLLARS                                     
BJDAT11  DS    CL4                 YYMM                                         
BJBKT11  DS    CL10                 DOLLARS                                     
BJDAT12  DS    CL4                 YYMM                                         
BJBKT12  DS    CL10                 DOLLARS                                     
BJDAT13  DS    CL4                 YYMM                                         
BJBKT13  DS    CL10                 DOLLARS                                     
         DS    CL50                SPARE                                        
         EJECT                                                                  
         ORG   BJREC                                                            
BJAKEY   DS    0CL40                                                            
BJAMED   DS    CL1                 MEDIA                                        
BJACLT   DS    CL3                 CLIENT                                       
BJAPRD   DS    CL3                 PRODUCT                                      
BJAEST   DS    CL3                 ESTIMATE NUMBER                              
BJADESC  DS    CL20                ESTIMATE NAME                                
BJAMKT   DS    CL4                 MARKET                                       
BJASTA   DS    CL5                 STATION                                      
         DS    CL1                 SPARE                                        
         SPACE 1                                                                
BJADATA  DS    0CL210              DATA AREA                                    
BJADAT1  DS    CL4                 YYMM                                         
BJABKT1  DS    CL10                 DOLLARS                                     
BJADAT2  DS    CL4                 YYMM                                         
BJABKT2  DS    CL10                 DOLLARS                                     
BJADAT3  DS    CL4                 YYMM                                         
BJABKT3  DS    CL10                 DOLLARS                                     
BJADAT4  DS    CL4                 YYMM                                         
BJABKT4  DS    CL10                 DOLLARS                                     
BJADAT5  DS    CL4                 YYMM                                         
BJABKT5  DS    CL10                 DOLLARS                                     
BJADAT6  DS    CL4                 YYMM                                         
BJABKT6  DS    CL10                 DOLLARS                                     
BJADAT7  DS    CL4                 YYMM                                         
BJABKT7  DS    CL10                 DOLLARS                                     
BJADAT8  DS    CL4                 YYMM                                         
BJABKT8  DS    CL10                 DOLLARS                                     
BJADAT9  DS    CL4                 YYMM                                         
BJABKT9  DS    CL10                 DOLLARS                                     
BJADAT10 DS    CL4                 YYMM                                         
BJABKT10 DS    CL10                 DOLLARS                                     
BJADAT11 DS    CL4                 YYMM                                         
BJABKT11 DS    CL10                 DOLLARS                                     
BJADAT12 DS    CL4                 YYMM                                         
BJABKT12 DS    CL10                 DOLLARS                                     
BJADAT13 DS    CL4                 YYMM                                         
BJABKT13 DS    CL10                 DOLLARS                                     
         DS    CL28                SPARE                                        
         SPACE 1                                                                
         ORG                                                                    
         LTORG                                                                  
         PRINT ON                                                               
*&&DO                                                                           
EKTAPE   DTFMT BLKSIZE=800,DEVADDR=SYS016,FILABL=NO,IOAREA1=EKBLK,     X        
               RECFORM=FIXBLK,RECSIZE=80,REWIND=UNLOAD,                X        
               TYPEFLE=OUTPUT,WORKA=YES                                         
         SPACE 1                                                                
EKBLK    DS    100D                                                             
         SPACE 2                                                                
BJTAPE   DTFMT BLKSIZE=200,DEVADDR=SYS016,FILABL=STD,IOAREA1=BJBLK,    X        
               RECFORM=FIXUNB,REWIND=UNLOAD,TYPEFLE=OUTPUT,WORKA=YES            
         SPACE 1                                                                
BJBLK    DS    CL200                                                            
         SPACE 2                                                                
BJTAPE2  DTFMT BLKSIZE=250,DEVADDR=SYS016,FILABL=STD,IOAREA1=BJBLK2,   X        
               RECFORM=FIXUNB,REWIND=UNLOAD,TYPEFLE=OUTPUT,WORKA=YES            
         SPACE 1                                                                
BJBLK2   DS    CL250                                                            
*&&                                                                             
*&&OS                                                                           
BJTAPE   DCB   DDNAME=BJTAPE,BLKSIZE=200,RECFM=F,MACRF=PM,DSORG=PS              
BJTAPE2  DCB   DDNAME=BJTAPE2,BLKSIZE=250,RECFM=F,MACRF=PM,DSORG=PS             
FDTAPE   DCB   DDNAME=FDTAPE,BLKSIZE=800,LRECL=80,RECFM=FB,MACRF=PM,   X        
               DSORG=PS                                                         
EKTAPE   DCB   DDNAME=EKTAPE,BLKSIZE=800,LRECL=80,RECFM=FB,MACRF=PM,   X        
               DSORG=PS                                                         
*&&                                                                             
         EJECT                                                                  
PRRECD   DSECT                                                                  
* SPA202 BUFFALO RECORD DSECT *                                                 
         SPACE 1                                                                
         DS    0D                                                               
PRREC    DS    0CL128                                                           
*                                                                               
PRKEY    DS    0XL12                                                            
PRKTYP   DS    CL1                 TYPE                                         
*                                  X'11' = MGR1TOT WITHIN PRD                   
*                                  X'12' = MGR2TOT WITHIN MGR1                  
*                                  X'13' = MGR3TOT WITHIN MGR2                  
*                                  X'20' = PRD TOT WITHIN CLT                   
*                                  X'21' = PRD TOT WITHIN PGR1                  
*                                  X'22' = PRD TOT WITHIN PGR2                  
*                                  X'31' = PGR1TOT WITHIN CLT                   
*                                  X'32' = PGR2TOT WITHIN PGR1                  
PRKPGR   DS    CL5                                                              
PRKPRD   DS    CL3                                                              
         ORG   PRKPGR                                                           
PRKMGR   DS    CL5                                                              
         ORG   PRKPGR                                                           
PRKREP   DS    CL2                                                              
PRKMKT   DS    CL2                                                              
PRKSTA   DS    CL3                                                              
*                                                                               
         ORG   PRKEY+12                                                         
PRCODE   DS    CL8                                                              
PRNAME   DS    CL24                                                             
PRDATA   DS    XL128                                                            
*                                                                               
PRBLPER  DS    304C                                                             
*                                                                               
         DS    0D                  ALIGNMENT                                    
* DETAIL ACCUMULATORS -                                                         
*                                                                               
PRTOTSTA DS    CL128                SPOTS/MON1/MON2/.../MON12/MON13             
         EJECT                                                                  
CLTHDRD  DSECT                                                                  
       ++INCLUDE SPGENCLT                                                       
         EJECT                                                                  
PRDHDRD  DSECT                                                                  
       ++INCLUDE SPGENPRD                                                       
         EJECT                                                                  
ESTHDRD  DSECT                                                                  
       ++INCLUDE SPGENEST                                                       
         EJECT                                                                  
BILLRECD DSECT                                                                  
       ++INCLUDE SPGENBILL                                                      
*NOP*    PRINT OFF                                                              
       ++INCLUDE SPREPWORKD                                                     
       ++INCLUDE SPMEDBLOCK                                                     
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'008SPREPA2TP 05/01/02'                                      
         END                                                                    
