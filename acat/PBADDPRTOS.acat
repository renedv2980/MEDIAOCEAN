*          DATA SET PBADDPRTOS AT LEVEL 008 AS OF 05/01/02                      
*CATALP ADDPRINT                                                                
         PRINT GEN                                                              
         SPACE 1                                                                
ADDPRINT CSECT                                                                  
         NBASE 0,**ADDP**,=V(REGSAVE),R9                                        
         L     RA,=V(CPRINT)                                                    
         USING DPRINT,RA                                                        
         USING BOOKLIST,R7                                                      
         USING ADDRLIST,R8                                                      
         USING ADDRTNES,R5                                                      
         SPACE 1                                                                
*                   READ RUN-DECK CONTROL CARD(S)                               
         SPACE 1                                                                
         MVC   FIRSTLN,=C'09'                                                   
         MVI   MODE,X'08'                                                       
         MVC   OFFSET,=H'14'       12-PITCH                                     
         GOTO1 =V(CARDS),PARA2,C,=C'RE00'                                       
         CLC   C(2),=C'/*'                                                      
         BE    ERROR1                                                           
         SPACE 1                                                                
         CLC   C(8),=C'FLASH=NO'         SUPPRESS 'FLASH' MSGS                  
         BNE   OFFCARD                   (FOR TEST RUNS W/O FORMS)              
         MVC   FLASH,=C'N'               (ADDED 5/81 - PD)                      
         GOTO1 =V(CARDS),PARA2                                                  
         SPACE 2                                                                
OFFCARD  CLC   C(8),=C'OFFSET=0'         OFFSET=0 OPTION                        
         BNE   DIRTCARD                  ADDED 11/85 - PD                       
         MVC   OFFSET,=H'00'             FOR ONLINE PREVIEWING                  
         MVI   ULCFLAG,C'Y'                                                     
         GOTO1 =V(CARDS),PARA2                                                  
         B     ADDRCARD                                                         
*                                                                               
DIRTCARD CLC   C(7),=C'DIRECT='                                                 
         BNE   ADDRCARD                                                         
         MVC   OFFSET,=H'01'                                                    
         MVI   ULCFLAG,C'Y'                                                     
         CLI   C+28,C'U'        CLASS U = U/LC ALLOWED                          
         BE    *+8                                                              
         MVI   ULCFLAG,C'N'                                                     
         L     R3,=V(REMOTEC)                                                   
         USING REMOTED,R3                                                       
         MVC   REMOTSYS(3),C+7                                                  
         MVC   REMOTFRM,C+11                                                    
         MVC   REMOTJID,REMOTSYS                                                
         PACK  DUB,C+16(5)                                                      
         CVB   R1,DUB                                                           
         STH   R1,DUB                                                           
         MVC   REMOTDST,DUB                                                     
         CLC   C+21(6),=C',PRINT'                                               
         BNE   *+8                                                              
         MVI   REMOTPRT,1                                                       
         MVC   REMOTCLS,C+28                                                    
         MVC   REMOTCPY,C+32                                                    
         MVC   REMOTABF,=V(PQBUFF)                                              
         MVC   REMOTADM,=V(DATAMGR)                                             
         MVC   REMOTAOP,=V(PQOPEN)                                              
         GOTO1 =V(CARDS),PARA2                                                  
         EJECT                                                                  
         SPACE 2                                                                
ADDRCARD CLC   C(9),=C'ADDRLIST='                                               
         BNE   ERROR2                                                           
         SPACE 1                                                                
         MVC   ADLISTNM(10),C+9                                                 
         MVC   C+12(8),C                                                        
         MVC   C(12),ADLISTNM                                                   
         GOTO1 =V(PANIC),PARA,=C'READ',=C'DIRECTORY',ADLISTNM,SAVEDIR           
         MVI   PANOPEN,C'Y'                                                     
         TM    PARA+8,X'10'                                                     
         BO    ERROR3                                                           
         SPACE 1                                                                
         MVC   FIRSTLN,=C'07'      6 LPI                                        
         ZAP   MAXLINE,=P'50'                                                   
         SPACE 1                                                                
         CLI   C+20,C' '           NO POSITION CODE                             
         BNE   *+8                                                              
         MVI   C+20,C'B'             YES - SET BOTTOM AS DEFAULT                
         MVC   ADDRPOSN,C+20       CC21                                         
         SPACE 1                                                                
         CLC   C+21(3),SPACES      ANY CHANGES FOR PITCH OR LPI                 
         BE    CARD1                 NO                                         
         SPACE 1                                                                
         CLI   C+21,C'8'                                                        
         BNE   CHKPITCH                                                         
         SPACE 1                                                                
         MVC   FIRSTLN,=C'09'                                                   
         MVC   CENTLINE,=C'31'                                                  
         ZAP   MAXLINE,=P'68'                                                   
         ZAP   BOTMLIM,=P'66'                                                   
         ZAP   BOTMLINE,=P'68'                                                  
         SPACE 1                                                                
CHKPITCH CLC   C+22(2),=C'10'                                                   
         BNE   CARD2                                                            
         TITLE 'PRINT PAN DOCUMENTS W/PAN-STORED ADDRESSES'                     
SET10    MVC   OFFSET,=H'10'                                                    
         MVC   CENTPOSN,=H'15'                                                  
         MVC   BOTMPOSN,=H'35'                                                  
         B     CARD2                                                            
         SPACE 1                                                                
CARD1    TRT   C+20(20),INTERTRT   = SIGN                                       
         BZ    CARD2                                                            
         CLC   1(3,R1),=C'ALL'     'ALLCAP' (CANADIAN)                          
         BNE   CARD2                                                            
         MVI   ULCFLAG,C'N'                                                     
         B     SET10                                                            
CARD2    GOTO1 =V(CARDS),PARA2                                                  
         CLC   C(2),=C'/*'                                                      
         BE    ERROR4                                                           
         SPACE 1                                                                
         L     R7,=A(BOOKLIST)                                                  
         LA    R6,0                                                             
         SPACE 1                                                                
         CLC   C(2),=C'F='                                                      
         BNE   ERROR5                                                           
         SPACE 1                                                                
FILTCARD CLC   C+2(50),SPACES                                                   
         BE    ERROR6                                                           
         SPACE 1                                                                
         MVC   FILTERB,C+2         STACK BOOK FILTERS                           
         GOTO1 =V(CARDS),PARA2                                                  
         CLC   C(2),=C'/*'                                                      
         BE    ERROR7                                                           
         SPACE 1                                                                
         GOTO1 =V(PANIC),PARA,=C'READ',=C'DIRECTORY',C,SAVEDIR                  
         TM    PARA+8,X'10'                                                     
         BO    ERROR8                                                           
         SPACE 1                                                                
         MVC   BOOKNAME,C                                                       
         OC    FILTERS,FILTERB                                                  
         LA    R7,62(R7)                                                        
         LA    R6,1(R6)                                                         
         CH    R6,=H'20'           BOOKLIST FILLED                              
         BH    BKLSTEND              YES                                        
         SPACE 1                                                                
NEXTCARD GOTO1 =V(CARDS),PARA2       NO                                         
         CLC   C(2),=C'/*'                                                      
         BE    BKLSTEND                                                         
         SPACE 1                                                                
         CLC   C(2),=C'F='                                                      
         BE    FILTCARD                                                         
         B     NEXTCARD                                                         
         SPACE 1                                                                
BKLSTEND LTR   R6,R6                                                            
         BZ    ERROR9                                                           
         SPACE 1                                                                
         STH   R6,LOFBKLST         SAVE # OF BOOKS                              
         L     R8,=A(ADDRLIST)                                                  
         LA    R7,0                                                             
         GOTO1 READADDR,PARA,(X'80',=C'READ'),=C'PAN',ADLISTNM,C                
         EJECT                                                                  
ERROR1   MVC   P(22),=C'** NO CARDS IN DECK **'                                 
         GOTO1 =V(PRINTER)                                                      
         B     ENDJOB                                                           
         SPACE 1                                                                
ERROR2   MVC   P(36),=C'** ADDRLIST= CARD NOT 1ST IN DECK **'                   
         GOTO1 =V(PRINTER)                                                      
         B     RUNITOUT                                                         
         SPACE 1                                                                
ERROR3   MVC   P(41),=C'** ADDRLIST=            BOOK NOT FOUND **'              
         MVC   P+12(10),ADLISTNM                                                
         GOTO1 =V(PRINTER)                                                      
         B     RUNITOUT                                                         
         SPACE 1                                                                
ERROR4   MVC   P(37),=C'** NO F= OR BOOKNAME CARDS IN DECK **'                  
         GOTO1 =V(PRINTER)                                                      
         B     ENDJOB                                                           
         SPACE 1                                                                
ERROR5   MVC   P(34),=C'** F= CARD EXPECTED - NOT FOUND **'                     
         GOTO1 =V(PRINTER)                                                      
         MVC   P(80),C                                                          
         GOTO1 =V(PRINTER)                                                      
         B     NEXTCARD                                                         
         SPACE 1                                                                
ERROR6   MVC   P(33),=C'** F= CARD HAS NO FILTER CODES **'                      
         GOTO1 =V(PRINTER)                                                      
         B     NEXTCARD                                                         
         SPACE 1                                                                
ERROR7   MVC   P(41),=C'** NO BOOKNAME CARD AFTER LAST F= CARD **'              
         GOTO1 =V(PRINTER)                                                      
         B     BKLSTEND                                                         
         SPACE 1                                                                
ERROR8   MVC   P(36),=C'** TEXT BOOK           NOT FOUND **'                    
         MVC   P+13(10),C                                                       
         GOTO1 =V(PRINTER)                                                      
         B     NEXTCARD                                                         
         SPACE 1                                                                
ERROR9   MVC   P(43),=C'** NO VALID F= OR BOOKNAME CARDS IN DECK **'            
         GOTO1 =V(PRINTER)                                                      
         B     ENDJOB                                                           
         EJECT                                                                  
READADDR GOTO1 =V(PANIC),PARA                                                   
         TM    PARA+8,X'80'                                                     
         BO    ENDADLST                                                         
         SPACE 1                                                                
         CLI   C,C'*'                                                           
         BNE   READADDR                                                         
         SPACE 1                                                                
         MVC   FILTERA,C+2         STOW FILTER LINE                             
         GOTO1 =V(PANIC),PARA                                                   
         TM    PARA+8,X'80'                                                     
         BO    ENDADLST                                                         
         SPACE 1                                                                
         MVC   ADDRLN1,C           STOW 1ST ADDR LINE                           
         GOTO1 =V(PANIC),PARA                                                   
         TM    PARA+8,X'80'                                                     
         BO    ENDADLST                                                         
         SPACE 1                                                                
         MVC   ADDRLN2,C           STOW 2ND ADDR LINE                           
         LA    R2,FILTERS                                                       
         LA    R3,FILTERA                                                       
         LA    R4,50                                                            
         SPACE 1                                                                
STOWCHK  CLI   0(R3),C' '                                                       
         BE    BUMPIT                                                           
         CLI   0(R2),C' '                                                       
         BNE   STOWIT                                                           
         SPACE 1                                                                
BUMPIT   LA    R2,1(R2)                                                         
         LA    R3,1(R3)                                                         
         BCT   R4,STOWCHK                                                       
         SPACE 1                                                                
         XC    0(114,R8),0(R8)                                                  
         B     READADDR                                                         
         SPACE 1                                                                
STOWIT   LA    R8,114(R8)          BUMP ADDR STACK POINTER                      
         LA    R7,1(R7)            BUMP COUNT                                   
         CH    R7,=H'1500'         STACK FULL                                   
         BL    READADDR              NO                                         
         SPACE 1                                                                
         MVC   P(43),=C'** ADDRESS LIST FILLED - LAST ADDRESSEE IS '            
         SH    R8,=H'114'                                                       
         MVC   P+43(32),ADDRLN1                                                 
         GOTO1 =V(PRINTER)                                                      
         B     RUNITOUT            IF ADDRLIST IS FULL, QUIT                    
         SPACE 1                                                                
ENDADLST STH   R7,LOFADLST         SAVE # OF ADDRESSES                          
         EJECT                                                                  
NEXTADDR L     R8,=A(ADDRLIST)                                                  
         LH    R6,CURADDR                                                       
         MH    R6,=H'114'                                                       
         AR    R8,R6                                                            
         MVI   ADDRESS,C'Y'                                                     
         MVC   CURBOOK,=H'0'                                                    
         SPACE 1                                                                
FILTCHK  LR    R2,R8               POINTER TO FILTERA FOR MATCH                 
         L     R7,=A(BOOKLIST)                                                  
         LH    R3,CURBOOK                                                       
         MH    R3,=H'62'                                                        
         AR    R7,R3                                                            
         LR    R3,R7               POINTER TO FILTERB FOR SEARCH                
         LA    R4,50               SEARCH LENGTH                                
         SPACE 1                                                                
FILTCHK1 CLI   0(R3),C' '          ANY FILTER HERE                              
         BE    BUMPEM                NO                                         
         CLC   0(1,R2),0(R3)         YES - MATCHED                              
         BE    SETBOOK                       YES                                
         SPACE 1                                                                
BUMPEM   LA    R2,1(R2)                                                         
         LA    R3,1(R3)                                                         
         BCT   R4,FILTCHK1                                                      
         SPACE 1                                                                
         LH    R4,CURBOOK                                                       
         LA    R4,1(R4)                                                         
         STH   R4,CURBOOK                                                       
         CH    R4,LOFBKLST                                                      
         BL    FILTCHK                                                          
         LH    R4,CURADDR                                                       
         LA    R4,1(R4)                                                         
         STH   R4,CURADDR                                                       
         CH    R4,LOFADLST                                                      
         BNH   NEXTADDR                                                         
         B     ENDJOB                                                           
         EJECT                                                                  
SETBOOK  MVC   C(10),BOOKNAME                                                   
         LH    R1,BOOKCNT                                                       
         LA    R1,1(R1)                                                         
         STH   R1,BOOKCNT                                                       
         MVC   C+10(70),SPACES                                                  
         MVC   COLHEADS,SPACES                                                  
         MVC   TITLE,SPACES                                                     
         MVC   LOFTITLE,=H'1'                                                   
         MVC   P,SPACES                                                         
         NI    FIRSTSW,X'0F'                                                    
         ZAP   FIGNO,=P'0'                                                      
         ZAP   PAGE,=P'1'                                                       
         ZAP   LINE,=P'0'                                                       
         MVI   MODE,X'08'                                                       
         MVI   XERTEXT,C' '                                                     
         CLI   NOFLASH,C'Y'                                                     
         BNE   ADDRTEST                                                         
         SPACE 1                                                                
         MVI   NOFLASH,C' '                                                     
         LA    R3,512                                                           
         ST    R3,0(RD)                                                         
*&&DO*&& SETPRT SYSLST,FLASH=#YUP,WORKA=(RD)                                    
*&&OS*&& L     R2,=V(PRNTER)                                                    
*&&OS*&& SETPRT (2),FLASH=#YUP                                                  
         ZAP   MAXLINE,SVMAXLIN                                                 
         MVC   FIRSTLN,SVLIN1                                                   
         EJECT                                                                  
ADDRTEST CLI   ADDRPOSN,C'B'       BOTTOM ADDRESS                               
         BE    SETREAD0              YES                                        
         SPACE 1                                                                
         CLI   ADDRPOSN,C'T'       TOP ADDRESS                                  
         BNE   CENTADDR              NO                                         
         SPACE 1                                                                
         MVC   P(5),=X'E3967A4040'                                              
         MVC   P+5(32),ADDRLN1                                                  
         GOTO1 =V(PRINTER)                                                      
         MVI   SPACING+3,C'3'                                                   
         MVC   P+5(32),ADDRLN2                                                  
         GOTO1 =V(PRINTER)                                                      
         MVI   SPACING+3,C'1'                                                   
         B     SETREAD                                                          
         SPACE 1                                                                
CENTADDR CLI   ADDRESS,C'Y'                                                     
         BNE   SETREAD                                                          
         MVC   SPACING+2(2),CENTLINE                                            
         GOTO1 =V(PRINTER)                                                      
         MVC   SPACING+2(2),=C'01'                                              
         LA    R4,P                                                             
         AH    R4,CENTPOSN                                                      
         MVC   0(5,R4),=X'E3967A4040'                                           
         LA    R4,5(R4)                                                         
         MVC   0(32,R4),ADDRLN1                                                 
         GOTO1 =V(PRINTER)                                                      
         MVC   0(32,R4),ADDRLN2                                                 
         GOTO1 =V(PRINTER)                                                      
         OI    MODE,X'0A'                                                       
         GOTO1 =V(PRINTER)                                                      
         MVI   ADDRESS,C' '                                                     
         B     SETREAD                                                          
         SPACE 1                                                                
SETREAD0 MVI   ADDRESS,C'Y'                                                     
SETREAD  GOTO1 READ,PARA,(X'80',=C'READ'),=C'PAN',C,P                           
         EJECT                                                                  
*                   COMMON READ ROUTINE                                         
         SPACE 1                                                                
READ     CLI   SAVEFLAG,C'Y'                                                    
         BNE   READNEXT                                                         
         MVI   SAVEFLAG,C' '                                                    
         MVC   P(80),SAVEDIR                                                    
         B     TRYBIG                                                           
         SPACE 1                                                                
READNEXT GOTO1 =V(PANIC),PARA                                                   
         TM    PARA+8,X'80'                                                     
         BO    ENDBOOK                                                          
         SPACE 1                                                                
*                   FIRST READ ONLY                                             
         SPACE 1                                                                
         NOP   TRYBIG                                                           
FIRSTSW  EQU   *-3                                                              
         OI    FIRSTSW,X'F0'                                                    
         CLC   P(19),=C'*          DATA SET'                                    
         BE    READ                                                             
         B     TRYBIG                                                           
         SPACE 1                                                                
ENDBOOK  CLC   ADDRESS(2),=C'YB'   BOTTOM ADDRESS                               
         BNE   *+14                                                             
         MVC   P(2),SPACES         BLANK /*                                     
         BAS   R6,BOTADDR                                                       
         SPACE 1                                                                
         BAS   R6,ENDOLDPG                                                      
         LH    R4,CURBOOK                                                       
         LA    R4,1(R4)                                                         
         STH   R4,CURBOOK                                                       
         CH    R4,LOFBKLST                                                      
         BNH   FILTCHK                                                          
         B     NEXTADDR                                                         
         SPACE 1                                                                
BOTADDR  AP    MAXLINE,=P'4'                                                    
         ZAP   DUB(2),BOTMLINE                                                  
         SP    DUB(2),LINE                                                      
         CP    DUB(2),=P'0'                                                     
         BNH   *+16                                                             
         UNPK  SPACING+2(2),DUB(2)                                              
         MVC   P,SPACES                                                         
         GOTO1 =V(PRINTER)                                                      
         MVC   SPACING+2(2),=C'01'                                              
         LA    R4,P                                                             
         AH    R4,BOTMPOSN                                                      
         MVC   0(5,R4),=X'E3967A4040'                                           
         LA    R4,5(R4)                                                         
         MVC   0(32,R4),ADDRLN1                                                 
         GOTO1 =V(PRINTER)                                                      
         MVC   0(32,R4),ADDRLN2                                                 
         GOTO1 =V(PRINTER)                                                      
         MVI   ADDRESS,C' '                                                     
         SP    MAXLINE,=P'4'                                                    
         BR    R6                                                               
         EJECT                                                                  
TRYBIG   CLC   P(4),=C'BIG='                                                    
         BNE   *+12                                                             
         OI    MODE,X'08'                                                       
         B     READ                                                             
         SPACE 1                                                                
         CLC   P(8),=C'REVERSE='                                                
         BE    READ                                                             
         SPACE 1                                                                
         CLC   P(14),=C'         INDEX'                                         
         BE    READ                                                             
         SPACE 1                                                                
         CLC   P(9),=C'WIDELINE='                                               
         BE    READ                                                             
         SPACE 1                                                                
         CLC   P(9),=C'COPYRIGHT'                                               
         BE    READ                                                             
         SPACE 1                                                                
         L     R5,=A(ADDRTNES)                                                  
         CLC   P(7),=C'UPDATE='                                                 
         BE    UPDATING                                                         
         SPACE 1                                                                
         CLC   P(6),=C'NOTXER'                                                  
         BNE   *+12                                                             
         MVI   XERTEXT,C' '                                                     
         B     READ                                                             
         SPACE 1                                                                
         CLI   P,X'2B'             FMT - START OF TAB RACK                      
         BNE   TESTWIDE              NO                                         
         SPACE 1                                                                
         CLC   P+1(2),=C'00'       XERTOPAN TEXT                                
         BE    READ                                                             
         CLC   P+1(2),P+3                                                       
         BE    READ                                                             
         MVI   XERTEXT,C'Y'          YES                                        
         XC    TABRACK,TABRACK                                                  
         LA    R3,P+1                                                           
         LA    R4,TABRACK                                                       
         LA    R5,18               L(TABRACK) IN H'S                            
         SPACE 1                                                                
TABRKLP  CLI   0(R3),X'2B'         END OF TAB RACK                              
         BE    READ                                                             
         SPACE 1                                                                
         PACK  WORK(2),0(2,R3)                                                  
         LH    R1,WORK                                                          
         SRA   R1,4                                                             
         TM    1(R3),X'F0'         LOW-ORDER NUMERIC                            
         BO    *+8                   YES                                        
         AH    R1,=H'9'                                                         
         STH   R1,0(R4)                                                         
         LA    R4,2(R4)                                                         
         LA    R3,2(R3)                                                         
         BCT   R5,TABRKLP          MORE ROOM IN RACK                            
         B     READ                  NO                                         
         EJECT                                                                  
TESTWIDE CLC   P(10),=C'PAGE=START'                                             
         BNE   TESTSCAN                                                         
         SPACE 1                                                                
         CLC   P+11(10),SPACES                                                  
         BE    *+10                                                             
         AP    FIGNO,=P'1'                                                      
         MVC   P,SPACES                                                         
         BAS   R6,ENDOLDPG                                                      
         MVC   P(26),=C'REPORT-SAMPLE PAGE OMITTED'                             
         GOTO1 =V(PRINTER)                                                      
         OI    MODE,X'0A'                                                       
         SPACE 1                                                                
WIDELP   GOTO1 =V(PANIC),PARA      SKIP ALL WIDE-LINE PAGES                     
         TM    PARA+8,X'80'                                                     
         BO    ENDBOOK                                                          
         SPACE 1                                                                
         CLC   P(10),=C'PAGE=START'                                             
         BE    TESTWIDE+10                                                      
         CLC   P(8),=C'PAGE=END'                                                
         BNE   WIDELP                                                           
         B     READ                                                             
         EJECT                                                                  
TESTSCAN CLC   P(8),=8C' '         POSSIBLE CC-10 CONTROL LINE                  
         BNE   NOTSCAN               NO                                         
         LA    R2,P+8                                                           
         LA    R3,3                                                             
         CLI   0(R2),C' '                                                       
         BNE   *+16                                                             
         LA    R2,1(R2)                                                         
         BCT   R3,*-12                                                          
         B     BADSCAN                                                          
         SPACE 1                                                                
         MVC   SCANWORD(7),0(R2)                                                
         CLC   SCANWORD(6),=C'SPACE '                                           
         BE    SPACESLN                                                         
         SPACE 1                                                                
         CLC   SCANWORD(4),=C'HEAD'                                             
         BE    HEAD                                                             
         SPACE 1                                                                
         CLC   SCANWORD(7),=C'FIGURE '                                          
         BE    FIGURE                                                           
         SPACE 1                                                                
         CLC   SCANWORD(5),=C'EJECT'                                            
         BE    EJECTRTN                                                         
         SPACE 1                                                                
         CLC   SCANWORD(7),=C'TITLE '''                                         
         BE    TITLELN                                                          
         SPACE 1                                                                
         CLC   SCANWORD(7),=C'SUPER '''                                         
         BE    TITLELN                                                          
         SPACE 1                                                                
         CLC   SCANWORD(6),=C'FRONT='                                           
         BE    READ                                                             
         SPACE 1                                                                
BADSCAN  MVC   SCANWORD(7),SPACES                                               
         B     NOTSCAN                                                          
         EJECT                                                                  
EJECTRTN CLC   ADDRESS(2),=C'YB'   1ST ADDRESSED BOOK ON BOTTOM                 
         BNE   EJECT                 NO                                         
         SPACE 1                                                                
         BAS   R6,BOTADDR                                                       
         SPACE 1                                                                
EJECT    BAS   R6,ENDOLDPG                                                      
         MVI   NOSCREEN,C' '                                                    
         B     READ                                                             
         SPACE 3                                                                
SPACESLN CLI   SCANWORD+6,C'1'                                                  
         BL    READ                                                             
         CLI   SCANWORD+6,C'9'                                                  
         BH    READ                                                             
         MVI   NOSCREEN,C' '                                                    
         SPACE 1                                                                
         CLC   10(3,R2),SPACES                                                  
         BE    *+8                                                              
         MVI   NOSCREEN,C'Y'                                                    
         SPACE 1                                                                
         MVC   P(30),SPACES                                                     
         MVC   SPACING+3(1),SCANWORD+6                                          
         CLC   ADDRESS(2),=C'YB'   1ST ADDRESSED BOOK ON BOTTOM                 
         BE    TRYBOTLM                                                         
         SPACE 1                                                                
NOTBOTLM GOTO1 =V(PRINTER)                                                      
         MVI   SPACING+3,C'1'                                                   
         B     READ                                                             
         SPACE 1                                                                
TRYBOTLM PACK  DUB(2),SPACING+2(2)                                              
         AP    DUB(2),LINE                                                      
         CP    DUB(2),BOTMLIM                                                   
         BL    NOTBOTLM                                                         
         BAS   R6,BOTADDR                                                       
         B     EJECT                                                            
        EJECT                                                                   
FIGURE   CLI   7(R2),X'7D'         APOSTROPHE                                   
         BNE   BADSCAN               NO                                         
         BAS   RE,SCANFIG            YES                                        
         CLI   ALPHA,C'F'          FIRST ON PAGE                                
         BE    FIGURSET                                                         
         MVI   SPACING+3,C'2'                                                   
         GOTO1 =V(PRINTER)                                                      
         SPACE 1                                                                
FIGURSET MVC   SAVEDIR,SPACES                                                   
         MVC   SAVEDIR(6),=X'C68987A49985'   U/LC FIGURE                        
         LA    R1,SAVEDIR+7                                                     
         CLI   FIGPTNUM,C'Y'                                                    
         BNE   *+18                                                             
         SPACE 1                                                                
         MVC   0(8,R1),SVFIGNO                                                  
         AH    R1,SVFNOLEN                                                      
         B     SETFIGNO                                                         
         SPACE 1                                                                
         CLI   SECTNUM,C' '        PGNO. PREFIX                                 
         BE    SETFIGNO              NO                                         
         SPACE 1                                                                
         BAS   RE,DOSUPNUM                                                      
         SPACE 1                                                                
SETFIGNO EDIT  (P2,FIGNO),(3,(R1)),ALIGN=LEFT                                   
         LA    R1,1(R1)                                                         
         CLI   0(R1),C' '          FIND END OF FIGNO                            
         BNE   *-8                   NO                                         
         MVI   0(R1),C'.'            YES                                        
         MVC   3(58,R1),INDEX                                                   
         LA    R1,SAVEDIR+79                                                    
         L     R5,=A(ADDRTNES)                                                  
         BAS   R7,CENTERER                                                      
         SPACE 1                                                                
         CLI   ALPHA,C'L'          FIGURE AT PAGE BOTTOM                        
         BNE   *+12                  NO                                         
         MVI   SPACING+3,C'1'        YES                                        
         B     *+8                                                              
         MVI   SPACING+3,C'3'                                                   
         SPACE 1                                                                
         GOTO1 =V(PRINTER)                                                      
         CLI   ALPHA,C'L'          LAST ON PAGE                                 
         BNE   *+8                   NO                                         
         BAS   R6,ENDOLDPG           YES - FORCE END                            
         MVI   ALPHA,C' '                                                       
         CLI   REPFLAG,C'Y'                                                     
         BNE   READ                                                             
         CP    FIGNO,LASTFIG                                                    
         BL    READ                                                             
         LA    R7,READ                                                          
         L     R5,=A(ADDRTNES)                                                  
         B     FIGNOSET                                                         
         EJECT                                                                  
HEAD     TM    SCANWORD+4,X'F0'    IS LEVEL NUMERIC                             
         BNO   BADSCAN               NO                                         
         BAS   RE,SCANHEAD           YES - SET HEAD                             
         CLI   ALPHA,C'F'          FIRST LINE ON PAGE                           
         BNE   *+12                                                             
         OI    MODE,X'80'            MAKE HEAD 1ST LINE                         
         B     *+8                                                              
         OI    MODE,X'40'          PUT HEAD WITHIN PAGE BODY                    
         SR    R6,R6                                                            
         NI    SCANWORD+4,X'0F'    LEVEL NUMBER                                 
         IC    R6,SCANWORD+4                                                    
         SLA   R6,1                                                             
         LA    R3,P(R6)                                                         
         MVC   0(58,R3),INDEX                                                   
         GOTO1 =V(PRINTER)                                                      
         MVI   ALPHA,C' '                                                       
         B     READ                                                             
         SPACE 3                                                                
TITLELN  BAS   RE,SCANTITL         SET TITLE                                    
         B     READ                                                             
         SPACE 1                                                                
SCANFIG  ST    RE,RETADDR          FIGURE CAPTION                               
         LA    R2,1(R2)            GET PAST LEADING '                           
         ZAP   ROOM,=P'7'                                                       
         MVC   COLHEADS,SPACES                                                  
         AP    FIGNO,=P'1'                                                      
         BAS   R6,TESTROOM         ROOM FOR FIGURE ON THIS PAGE                 
         CP    WORK(2),=P'3'         NO  - TEST FOR END-OF-PAGE FIT             
         MVI   ALPHA,C'L'                                                       
         BNL   SCAN3                         YES                                
         B     SCAN2A                        NO                                 
         SPACE 1                                                                
SCANHEAD ST    RE,RETADDR          PARAGRAPH HEAD                               
         MVC   COLHEADS,SPACES                                                  
         TM    MODE,X'08'          PAGE START PENDING                           
         BO    SCAN2A                YES - SKIP TEST FOR SPACE                  
         SPACE 1                                                                
         ZAP   ROOM,NHLINES                                                     
         LA    R6,SCAN2A           ROOM FOR HEAD ON THIS PAGE                   
TESTROOM ZAP   WORK(2),MAXLINE                                                  
         SP    WORK(2),LINE                                                     
         CP    WORK(2),ROOM                                                     
         BNL   SCAN3                 YES                                        
         BR    R6                                                               
         SPACE 1                                                                
SCAN2A   MVI   ALPHA,C'F'            NO                                         
         BAS   R6,ENDOLDPG         START NEW PAGE                               
         SPACE 1                                                                
SCAN3    MVC   INDEX,SPACES                                                     
         LA    R3,INDEX                                                         
         B     SCAN5                                                            
         EJECT                                                                  
SCANTITL ST    RE,RETADDR          TITLE                                        
         BAS   R6,ENDOLDPG                                                      
         MVC   TITLE,SPACES                                                     
         MVC   LOFTITLE,=H'0'                                                   
         MVC   COLHEADS,SPACES                                                  
         LA    R3,TITLE                                                         
         SPACE 1                                                                
SCAN5    LA    R2,7(R2)            SET MOVE START                               
         LA    R4,60(R2)           SET END-SEARCH START                         
         LA    R5,60               SET SEARCH LIMIT                             
SCANLP   CLI   0(R4),C' '          1ST NON-BLANK TRAILER                        
         BNE   SCAN6                 YES                                        
         BCTR  R4,0                                                             
         BCT   R5,SCANLP                                                        
         B     BADSCAN             NO TEXT FOUND                                
         SPACE 1                                                                
SCAN6    CLI   0(R4),X'7D'         APOSTROPHE                                   
         BE    *+8                   YES                                        
         LA    R4,1(R4)              NO  - INCLUDE IT                           
         SR    R4,R2                                                            
         BNP   BADSCAN                                                          
         CH    R4,=H'58'                                                        
         BNH   *+8                                                              
         BCT   R4,*-8                                                           
         CLC   SCANWORD,=C'SUPER '''                                            
         BNE   *+8                                                              
         STH   R4,LOFTITLE                                                      
         BCTR  R4,0                                                             
         EX    R4,SCANMOVE                                                      
         MVC   P,SPACES                                                         
         L     RE,RETADDR                                                       
         BR    RE                                                               
         SPACE 1                                                                
SCANMOVE MVC   0(0,R3),0(R2)                                                    
         SPACE 1                                                                
DOSUPNUM NTR1                                                                   
         TM    SECTNUM,X'F0'       NUMERIC                                      
         BO    ONEDIGIT              YES                                        
         MVC   WORK(1),SECTNUM       NO                                         
         NI    WORK,X'0F'                                                       
         ZIC   R2,WORK                                                          
         BCTR  R2,0                                                             
         SLA   R2,1                                                             
         LA    R2,DIGTAB(R2)                                                    
         MVC   0(2,R1),0(R2)                                                    
         LA    R1,2(R1)                                                         
         B     DASHED                                                           
         SPACE 1                                                                
ONEDIGIT MVC   0(1,R1),SECTNUM                                                  
         LA    R1,1(R1)                                                         
DASHED   MVI   0(R1),C'-'                                                       
         LA    R1,1(R1)                                                         
         XIT1  REGS=(R1)                                                        
         EJECT                                                                  
*                   COLUMN HEADINGS LINE                                        
         SPACE 1                                                                
NOTSCAN  CLC   P(2),=X'6E6E'       TWO GREATER-THAN'S                           
         BNE   TRYFORM               NO                                         
         SPACE 1                                                                
         CLI   P+2,C' '                                                         
         BL    *+14                XERSTORE LINE END                            
         CLC   P+2(78),SPACES      NULL LINE                                    
         BNE   *+14                  NO                                         
         MVC   COLHEADS,SPACES       YES                                        
         B     READ                                                             
         SPACE 1                                                                
         CLI   XERTEXT,C'Y'                                                     
         BNE   *+16                                                             
         LA    R4,P                                                             
         LA    R7,79                                                            
         BAS   RE,TRYTABRT                                                      
         MVC   COLHEADS(78),P+2    PUT TEXT INTO COLHEADS                       
         OI    MODE,X'10'          SET NEW COLHEADS BIT                         
         GOTO1 =V(PRINTER)                                                      
         B     READ                                                             
         SPACE 1                                                                
TRYFORM  CLI   XERTEXT,C'Y'                                                     
         BE    XERLINE                                                          
         SPACE 1                                                                
*                   U'SCORE FOR ORDINARY-PAGE TEXT LINE                         
         SPACE 1                                                                
NOTXERLN TRT   P(80),USCORE        USCORE CHAR                                  
         BZ    SCREENLN              NO                                         
         SPACE 1                                                                
         TRT   P(80),SEPUSC                                                     
         BNZ   SCREENLN                                                         
         SPACE 1                                                                
         CLI   ULCFLAG,C'Y'        PRINTABLE                                    
         BNE   READ                  NO                                         
         MVI   SPACING+3,C'0'                                                   
         GOTO1 =V(PRINTER)                                                      
         B     READ                                                             
         EJECT                                                                  
XERLINE  TRT   P(80),LINEENDS                                                   
         BNZ   WHOLELIN                                                         
         SPACE 1                                                                
         LA    R4,SAVEDIR                                                       
         ST    R4,PARA+12                                                       
         GOTO1 =V(PANIC),PARA      GET REST OF LINE                             
         TM    PARA+8,X'80'                                                     
         BO    ENDBOOK                                                          
         SPACE 1                                                                
         LA    R4,P                                                             
         ST    R4,PARA+12                                                       
         TRT   SAVEDIR(10),LINEENDS                                             
         BNZ   XERLINE1                                                         
         MVI   SAVEFLAG,C'Y'                                                    
         MVI   XERTEXT,C' '        NOT XER                                      
         B     NOTXERLN                                                         
XERLINE1 LA    R4,SAVEDIR                                                       
         MVC   P+80(10),SAVEDIR                                                 
         LA    R1,0(R1)                                                         
         SR    R1,R4                                                            
         EX    R1,SHY                                                           
         LA    R1,P+80(R1)                                                      
         SPACE 1                                                                
WHOLELIN MVI   0(R1),C' '          BLANK LINE-END CHAR                          
         TR    P(80),TRTABLE                                                    
         LA    R7,0(R1)                                                         
         LA    R4,P                                                             
         SR    R7,R4                                                            
         BNP   READ                                                             
         BCTR  R7,0                                                             
         BAS   RE,TRYTABRT                                                      
         B     SCREENLN                                                         
         SPACE 1                                                                
SHY      TR    P+80(0),TRTABLE                                                  
         SPACE 1                                                                
TABTEST  TRT   0(0,R4),TABCHECK                                                 
         SPACE 1                                                                
TABOUT   MVC   REBUILD(0),1(R1)    EXCLUDE TAB FROM SAVE                        
         SPACE 1                                                                
SPACEIN  MVC   0(0,R1),SPACES      BLANK TAB AND ONWARD                         
         SPACE 1                                                                
TABBACK  MVC   0(0,R1),REBUILD                                                  
         EJECT                                                                  
*                  LOOK FOR TABS USCORES IN XERSTORE'D TEXT                     
         SPACE 1                                                                
TRYTABRT NTR1                                                                   
         SR    R1,R1                                                            
         ST    R4,LINESTRT                                                      
         MVC   USCOFFST,=H'0'                                                   
         SPACE 1                                                                
OTHERTAB EX    R7,TABTEST                                                       
         BZ    NOTABS                                                           
         SPACE 1                                                                
         BCTR  R4,0                                                             
         LR    R5,R1                                                            
         SR    R5,R4               TAB DISP + 1                                 
         SH    R5,USCOFFST                                                      
         ST    R1,RETADDR                                                       
         LR    R6,R1                                                            
         SH    R6,=H'4'                                                         
         CR    R6,R4                                                            
         BNH   TABLOOP0                                                         
         TRT   0(4,R6),USCORES                                                  
         BZ    TABLOOP0                                                         
         SPACE 1                                                                
         L     R1,RETADDR                                                       
         LH    R4,USCOFFST                                                      
         AH    R4,=H'2'                                                         
         STH   R4,USCOFFST                                                      
         SH    R5,=H'2'                                                         
         SPACE 1                                                                
TABLOOP0 LA    R6,TABRACK                                                       
         LA    R3,18                                                            
TABLOOP1 CLC   0(2,R6),=H'0'                                                    
         BE    TABERROR                                                         
         CH    R5,0(R6)                                                         
         BL    TABMOVE             NEXT TAB FOUND                               
         LA    R6,2(R6)              NO - SET FOR NEXT TRY                      
         BCT   R3,TABLOOP1                                                      
         B     TABERROR                                                         
         SPACE 1                                                                
TABMOVE  L     R2,LINESTRT                                                      
         LA    R2,0(R7,R2)         PTR TO LAST TEXT CHAR                        
         SR    R2,R1               L'TEXT' AFTER TAB - 1                        
         EX    R2,TABOUT           SAVE WHAT'S AFTER TAB                        
         LA    R2,1(R2)                                                         
         EX    R2,SPACEIN          BLANK TAB AND ONWARD                         
         BCTR  R2,0                                                             
         L     R1,LINESTRT                                                      
         BCTR  R1,0                                                             
         AH    R1,0(R6)                                                         
         AH    R1,USCOFFST                                                      
         EX    R2,TABBACK          RESTORE FROM SAVE                            
         LA    R7,0(R1,R2)                                                      
         L     R4,LINESTRT                                                      
         SR    R7,R4                                                            
         B     OTHERTAB                                                         
         EJECT                                                                  
TABERROR MVI   0(R1),C' '                                                       
         EX    R7,TABTEST                                                       
         BNZ   *-8                                                              
         SPACE 1                                                                
NOTABS   L     R3,LINESTRT                                                      
         SR    R1,R1                                                            
         EX    R7,TRTREST          ANY USCORES                                  
         BZ    TABUSCEX                                                         
         SPACE 1                                                                
         EX    R7,SAVETEXT                                                      
         STC   R7,LINELEN                                                       
         MVC   P,SPACES                                                         
         SR    R1,R3               DISP TO SUSC IN TEXT LINE                    
         LA    R3,USCORSAV+1(R1)   PTR PAST SUSC IN USCORSAV                    
         LA    R5,P(R1)            PTR TO SUSC LOC IN PRINT LINE                
         SR    R7,R1               REDUCE SEARCH LENGTH                         
         B     USCORELP                                                         
         SPACE 1                                                                
TRTREST  TRT   0(0,R3),USCORES                                                  
         SPACE 1                                                                
SAVETEXT MVC   USCORSAV(0),0(R3)                                                
         SPACE 1                                                                
USCORELP EX    R7,TRTREST          LOOK FOR EUSC                                
         SPACE 1                                                                
         LR    R6,R1                                                            
         BCTR  R6,0                                                             
         SR    R6,R3                                                            
         EX    R6,USAVE1                                                        
         LA    R2,REBUILD+1(R6)                                                 
         LA    R4,0(R7)                                                         
         SR    R4,R6                                                            
         BM    DOUSTORE                                                         
         EX    R4,USAVE2                                                        
         LA    R4,1(R4)                                                         
         EX    R4,SPACEIN                                                       
DOUSTORE BCTR  R7,0                                                             
         BCTR  R3,0                TO SUSC                                      
         EX    R7,USTORE                                                        
         ZIC   R7,LINELEN                                                       
         SH    R7,=H'2'                                                         
         STC   R7,LINELEN                                                       
         EJECT                                                                  
         MVI   0(R5),X'6D'         USCORE CHAR                                  
         LA    R4,0(R6)                                                         
         BCTR  R4,0                                                             
         LTR   R4,R4                                                            
         BM    MOREUSC                                                          
         EX    R4,UEXTEND                                                       
         SPACE 1                                                                
MOREUSC  LA    R3,1(R6,R3)                                                      
         LA    R5,1(R6,R5)         PTR PAST USCORES IN PRINT LINE               
         LA    R7,USCORSAV(R7)                                                  
         SR    R7,R3                                                            
         BNP   EUSCORE                                                          
         SPACE 1                                                                
         EX    R7,TRTREST                                                       
         BZ    EUSCORE                                                          
         SR    R1,R3               DISP TO SUSC                                 
         LA    R3,1(R1,R3)         POINT PAST IT                                
         SR    R7,R1               LENGTH FOR EUSC SEARCH                       
         LA    R5,0(R1,R5)         PTR IN PRINT LINE                            
         B     USCORELP                                                         
         SPACE 1                                                                
EUSCORE  CLI   ULCFLAG,C'Y'                                                     
         BNE   EUSCOREX                                                         
         SPACE 1                                                                
         MVI   SPACING+3,C'0'                                                   
         GOTO1 =V(PRINTER)                                                      
         MVI   SPACING+3,C'1'                                                   
         SPACE 1                                                                
EUSCOREX L     R1,LINESTRT                                                      
         MVC   0(132,R1),SPACES                                                 
         ZIC   R7,LINELEN                                                       
         EX    R7,RETNTEXT                                                      
TABUSCEX XIT1                                                                   
         SPACE 1                                                                
RETNTEXT MVC   0(0,R1),USCORSAV                                                 
         SPACE 1                                                                
UEXTEND  MVC   1(0,R5),0(R5)                                                    
         SPACE 1                                                                
USAVE1   MVC   REBUILD(0),0(R3)                                                 
         SPACE 1                                                                
USAVE2   MVC   0(0,R2),1(R1)                                                    
         SPACE 1                                                                
USTORE   MVC   0(0,R3),REBUILD                                                  
         EJECT                                                                  
*                   SCREEN FIELD FORMATTING                                     
         SPACE 1                                                                
SCREENLN CLI   NOSCREEN,C'Y'                                                    
         BE    PRINTOUT                                                         
         CLI   ULCFLAG,C'N'                                                     
         BE    PRINTOUT                                                         
         SPACE 1                                                                
         LA    R1,P                                                             
         LA    R2,P+79                                                          
         LA    R3,10               LIMIT FOR 1ST *                              
         SPACE 1                                                                
         CLI   0(R1),C'*'                                                       
         BE    TWOSTARS                                                         
         LA    R1,1(R1)                                                         
         BCT   R3,*-12                                                          
         B     PRINTOUT            NO STARTING *                                
         SPACE 1                                                                
TWOSTARS CLC   1(69,R1),0(R1)      LINE OF *S                                   
         BE    SCRSTEND              YES                                        
         CLI   SCRNFLAG,C'Y'         NO  - SCREEN LINE                          
         BNE   PRINTOUT                      NO                                 
         SPACE 1                                                                
         LA    R3,10               LIMIT FOR LAST *                             
         CLI   0(R2),C'*'            NO  - FIND END *                           
         BE    FIELDER                                                          
         BCTR  R2,0                                                             
         BCT   R3,*-10             TRY AGAIN                                    
         B     PRINTOUT              NO * IN LAST 10 COLUMNS                    
         SPACE 1                                                                
FIELDER  MVI   0(R1),X'4F'         VERTICAL                                     
         MVI   0(R2),X'4F'                                                      
         LA    R1,1(R1)                                                         
         CR    R1,R2                                                            
         BNL   PRINTOUT                                                         
         CLI   0(R1),X'7A'         START OF FIELD                               
         BNE   FIELDER+8                                                        
         CLI   1(R1),C'-'                                                       
         BNE   FIELDER+8                                                        
         OI    1(R1),X'0D'                                                      
         LA    R1,1(R1)                                                         
         B     *-16                                                             
         SPACE 1                                                                
SCRSTEND CLI   SCRNFLAG,C'Y'                                                    
         BE    SCRNEND                                                          
         MVI   SCRNFLAG,C'Y'                                                    
         MVI   0(R1),X'AC'         TOP LEFT CORNER                              
         LA    R1,1(R1)                                                         
         MVI   0(R1),X'BF'                                                      
         BAS   R6,LINEEND                                                       
         MVI   0(R2),X'BC'         TOP RIGHT CORNER                             
         B     EXTEND                                                           
         EJECT                                                                  
LINEEND  CLI   0(R2),C' '                                                       
         BNER  R6                                                               
         BCT   R2,LINEEND                                                       
         SPACE 1                                                                
EXTEND   SR    R2,R1                                                            
         SH    R2,=H'2'                                                         
         EX    R2,EXTENDIT                                                      
         B     PRINTOUT                                                         
         SPACE 1                                                                
EXTENDIT MVC   1(0,R1),0(R1)                                                    
         SPACE 1                                                                
SCRNEND  MVI   SCRNFLAG,C' '                                                    
         MVI   0(R1),X'AB'         BOTTOM LEFT CORNER                           
         LA    R1,1(R1)                                                         
         MVI   0(R1),X'BF'                                                      
         BAS   R6,LINEEND                                                       
         MVI   0(R2),X'BB'         BOTTOM RIGHT CORNER                          
         B     EXTEND                                                           
         SPACE 1                                                                
PRINTOUT MVI   SPACING+3,C'1'                                                   
         CLC   P(2),=C'*-'                                                      
         BNE   *+8                                                              
         MVI   P,C'-'                                                           
         GOTO1 =V(PRINTER)                                                      
         CLC   ADDRESS(2),=C'YB'   1ST ADDRESSED BOOK ON BOTTOM                 
         BNE   READ                  NO                                         
         SPACE 1                                                                
         CP    LINE,BOTMLIM          YES - LIMIT REACHED                        
         BNH   READ                          NO                                 
         BAS   R6,BOTADDR                                                       
         B     EJECT                                                            
         EJECT                                                                  
ADDRTNES CSECT                                                                  
ENDPRIOR ST    R6,RETADDR                                                       
         BAS   R6,ENDOLDPG                                                      
         MVI   SECTNUM,C' '                                                     
         ZAP   SVNUM,=P'0'                                                      
         ZAP   FIGNO,=P'0'                                                      
         XC    UPERRNUM,UPERRNUM                                                
         MVI   REPFLAG,C' '                                                     
         MVI   POINTNUM,C' '                                                    
         MVI   FIGPTNUM,C' '                                                    
         ZAP   LASTFIG,=P'0'                                                    
         ZAP   LASTPG,=P'0'                                                     
         MVC   REVDATE,SPACES                                                   
         MVC   TITLE,SPACES                                                     
         MVC   LOFTITLE,=H'0'                                                   
         MVC   COLHEADS,SPACES                                                  
         CLC   P+7(3),=C'END'      END OF UPDATE                                
         BE    ENDPRX                                                           
         ZAP   PAGE,=P'999'                                                     
         LA    R3,P+10                                                          
         LA    R4,69                                                            
         LA    R0,P+79                                                          
         EX    R4,TERMSCAN                                                      
ENDPRX   L     R6,RETADDR                                                       
         BR    R6                                                               
         SPACE 1                                                                
TERMSCAN TRT   0(0,R3),TERMTRT                                                  
         SPACE 1                                                                
TERMFIND LA    R3,1(R1)            FIND NEXT COMMA OR BLANK                     
         LR    R4,R0                                                            
         SR    R4,R3                                                            
         EX    R4,TERMSCAN                                                      
         BR    R6                                                               
         SPACE 1                                                                
INTERSET LA    R3,1(R1)            FIND NEXT = OR -                             
         LR    R4,R0                                                            
         SR    R4,R3                                                            
         EX    R4,TRTINTER                                                      
         BR    R6                                                               
         SPACE 1                                                                
TRTINTER TRT   0(0,R3),INTERTRT                                                 
         SPACE 1                                                                
TERMTRT  DS    0CL256                                                           
         DC    64X'00'                                                          
         DC    X'40'     SPACE                                                  
         DC    42X'00'                                                          
         DC    X'6B'     COMMA                                                  
         DC    148X'00'                                                         
         EJECT                                                                  
*                   UPDATING MAIN LINE                                          
         SPACE 1                                                                
UPDATING CLC   P+7(3),=C'REP'      REPLACE PAGES                                
         BE    REPSTART              YES                                        
         SPACE 1                                                                
         CLC   P+7(3),=C'INS'      INSERT PAGES                                 
         BE    INSSTART                                                         
         SPACE 1                                                                
         CLC   P+7(3),=C'END'      END OF UPDATE                                
         BE    ENDUPDAT                                                         
         SPACE 1                                                                
         MVC   UPERRNUM,=H'1'        NO  - FLUSH UPDATE SERIES                  
         B     UPFLUSH                                                          
         SPACE 3                                                                
*                   REPLACE MAIN LINE                                           
         SPACE 1                                                                
REPSTART BAS   R6,ENDPRIOR                                                      
         BZ    UPFLUSH                                                          
         MVI   REPFLAG,C'Y'                                                     
         SPACE 1                                                                
REPSCLP  BAS   R6,INTERSET                                                      
         BZ    ENDREPST                                                         
         SPACE 1                                                                
         CLC   0(2,R3),=C'CH'      CHAP=                                        
         BE    REPCHAP                                                          
         CLC   0(2,R3),=C'PA'      PAGES=                                       
         BE    REPPGNOS                                                         
         CLC   0(2,R3),=C'FI'      FIGURES=                                     
         BE    REPFIGS                                                          
         CLC   0(2,R3),=C'LA'      LASTFIG=                                     
         BE    REPLFIG                                                          
         CLC   0(2,R3),=C'RE'      REVISED=                                     
         BE    REPREV                                                           
         MVC   UPERRNUM,=H'2'                                                   
         B     UPFLUSH                                                          
         SPACE 1                                                                
ENDREPST CP    PAGE,=P'999'                                                     
         BNE   UPCOMTST                                                         
         MVC   UPERRNUM,=H'8'                                                   
         B     UPFLUSH                                                          
         EJECT                                                                  
UPCOMTST GOTO1 =V(PANIC),PARA      READ NEXT LINE                               
         TM    PARA+8,X'80'                                                     
         BO    ENDBOOK             END OF BOOK                                  
         SPACE 1                                                                
         CLI   ULCFLAG,C'Y'                                                     
         BE    *+14                                                             
         MVC   UPERRNUM,=H'11'                                                  
         B     UPFLUSH                                                          
         SPACE 1                                                                
         MVI   NOFLASH,C'Y'                                                     
         MVC   SVLIN1,FIRSTLN                                                   
         ZAP   SVMAXLIN,MAXLINE                                                 
         MVC   FIRSTLN,=C'00'                                                   
         ZAP   MAXLINE,=P'54'                                                   
         LA    R3,512                                                           
         ST    R3,0(RD)                                                         
         CLC   FLASH,=C'N'                                                      
         BE    NOFLMSG                                                          
*&&DO*&& SETPRT SYSLST,FLASH=(#YUP,0),WORKA=(RD)                                
*&&OS*&& L     R2,=V(PRNTER)                                                    
*&&OS*&& SETPRT (2),FLASH=(#YUP,0)                                              
         SPACE 1                                                                
NOFLMSG  LA    R2,P+9                                                           
         MVC   SCANWORD(7),0(R2)                                                
         SPACE 1                                                                
         CLC   SCANWORD(7),=C'TITLE '''                                         
         BE    TITLELN                                                          
         SPACE 1                                                                
         CLC   SCANWORD(7),=C'SUPER '''                                         
         BE    SUPER                                                            
         SPACE 1                                                                
         CLC   SCANWORD(7),=C'RFOOT '''                                         
         BE    RFOOTRTN                                                         
         SPACE 1                                                                
         MVC   UPERRNUM,=H'9'                                                   
         B     UPFLUSH                                                          
         SPACE 1                                                                
RFOOTRTN LA    RE,READ                                                          
         ST    RE,RETADDR                                                       
         MVC   SCANWORD(5),=C'SUPER '''                                         
         LA    R3,TITLE                                                         
         B     SCAN5                                                            
         SPACE 1                                                                
ENDUPDAT BAS   R6,ENDPRIOR                                                      
         CLI   NOFLASH,C'Y'                                                     
         BNE   READ                                                             
         MVI   NOFLASH,C' '                                                     
         LA    R3,512                                                           
         ST    R3,0(RD)                                                         
         ZAP   MAXLINE,SVMAXLIN                                                 
         MVC   FIRSTLN,SVLIN1                                                   
         ZAP   PAGE,=P'1'                                                       
         CLC   FLASH,=C'N'                                                      
         BE    READ                                                             
*&&DO*&& SETPRT SYSLST,FLASH=#YUP,WORKA=(RD)                                    
*&&OS*&& L     R2,=V(PRNTER)                                                    
*&&OS*&& SETPRT (2),FLASH=#YUP                                                  
         B     READ                                                             
         EJECT                                                                  
REPCHAP  BAS   R7,UPCHAP                                                        
         B     REPSCLP                                                          
         SPACE 1                                                                
REPPGNOS BAS   R7,TWONUMS                                                       
         TM    NUM1+1,X'10'        ODD NUMBER                                   
         BO    *+14                  YES                                        
         MVC   UPERRNUM,=H'4'        NO                                         
         B     UPFLUSH                                                          
         SPACE 1                                                                
         TM    NUM+1,X'10'                                                      
         BNO   *+14                                                             
         MVC   UPERRNUM,=H'5'                                                   
         B     UPFLUSH                                                          
         SPACE 1                                                                
         CP    NUM1,NUM                                                         
         BL    *+14                                                             
         MVC   UPERRNUM,=H'6'                                                   
         B     UPFLUSH                                                          
         SPACE 1                                                                
         ZAP   PAGE,NUM1                                                        
         ZAP   LASTPG,NUM                                                       
         B     REPSCLP                                                          
         SPACE 1                                                                
REPFIGS  BAS   R7,TWONUMS                                                       
         CP    NUM,NUM1                                                         
         BNL   *+14                                                             
         MVC   UPERRNUM,=H'7'                                                   
         B     UPFLUSH                                                          
         SPACE 1                                                                
         ZAP   FIGNO,NUM1                                                       
         SP    FIGNO,=P'1'                                                      
         ZAP   LASTFIG,NUM                                                      
         B     REPSCLP                                                          
         SPACE 1                                                                
REPLFIG  BAS   R7,UPLFIG                                                        
         B     REPSCLP                                                          
         SPACE 1                                                                
REPREV   BAS   R7,UPREV                                                         
         B     REPSCLP                                                          
         EJECT                                                                  
*                   INSERT MAIN LINE                                            
         SPACE 1                                                                
INSSTART BAS   R6,ENDPRIOR                                                      
         BZ    UPFLUSH                                                          
         SPACE 1                                                                
INSSCLP  BAS   R6,INTERSET                                                      
         BZ    ENDINSST                                                         
         SPACE 1                                                                
         CLC   0(2,R3),=C'CH'      CHAP=                                        
         BE    INSCHAP                                                          
         CLC   0(2,R3),=C'AF'      AFTERPG=                                     
         BE    INSPAGE                                                          
         CLC   0(2,R3),=C'LA'      LASTFIG=                                     
         BE    INSLFIG                                                          
         CLC   0(2,R3),=C'RE'      REVISED=                                     
         BE    INSREV                                                           
         MVC   UPERRNUM,=H'2'                                                   
         B     UPFLUSH                                                          
         SPACE 1                                                                
ENDINSST CP    PAGE,=P'999'                                                     
         BNE   *+14                                                             
         MVC   UPERRNUM,=H'10'                                                  
         B     UPFLUSH                                                          
         SPACE 1                                                                
         LA    R1,PGNOWORK                                                      
         CLI   SECTNUM,C' '        SECTION NUMBER                               
         BE    *+8                                                              
         BAS   RE,DOSUPNUM                                                      
         EDIT  (P2,SVNUM),(3,(R1)),ALIGN=LEFT                                   
         LA    R1,1(R1)                                                         
         CLI   0(R1),C' '                                                       
         BNE   *-8                                                              
         LA    R2,PGNOWORK                                                      
         SR    R1,R2                                                            
         STH   R1,SVPNOLEN                                                      
         MVI   POINTNUM,C'Y'                                                    
         B     UPCOMTST                                                         
         EJECT                                                                  
INSCHAP  BAS   R7,UPCHAP                                                        
         B     INSSCLP                                                          
         SPACE 1                                                                
INSPAGE  BAS   R6,TERMFIND                                                      
         BAS   R6,GETNUM                                                        
         TM    NUM+1,X'10'         EVEN                                         
         BZ    *+10                  YES                                        
         AP    NUM,=P'1'             NO - MAKE IT EVEN                          
         ZAP   PAGE,=P'1'                                                       
         MVI   POINTNUM,C'Y'                                                    
         ZAP   SVNUM,NUM                                                        
         B     INSSCLP                                                          
         SPACE 1                                                                
INSLFIG  BAS   R7,UPLFIG                                                        
         B     INSSCLP                                                          
         SPACE 1                                                                
INSREV   BAS   R7,UPREV                                                         
         B     INSSCLP                                                          
         SPACE 1                                                                
*                   PRESET .NUMBERING FOR FIGURES                               
         SPACE 1                                                                
FIGNOSET LA    R1,SVFIGNO                                                       
         CLI   SECTNUM,C' '        SECTION NUMBER                               
         BE    *+8                                                              
         BAS   RE,DOSUPNUM                                                      
         EDIT  (P2,FIGNO),(3,(R1)),ALIGN=LEFT                                   
         LA    R1,1(R1)                                                         
         CLI   0(R1),C' '          FIND END OF FIGNO                            
         BNE   *-8                   NO                                         
         MVI   0(R1),C'.'                                                       
         LA    R0,SVFIGNO-1                                                     
         SR    R1,R0                                                            
         STH   R1,SVFNOLEN                                                      
         MVI   FIGPTNUM,C'Y'                                                    
         ZAP   FIGNO,=P'0'                                                      
         BR    R7                                                               
         EJECT                                                                  
UPCHAP   BAS   R6,TERMFIND                                                      
         TM    0(R3),X'F0'         1ST OR ONLY NUMERIC                          
         BO    UPCHAPN               YES                                        
         SPACE 1                                                                
UPCHAPX  MVC   SECTNUM,0(R3)         NO - ASSUME ALPHA A-H                      
         BR    R7                                                               
         SPACE 1                                                                
UPCHAPN  TM    1(R3),X'F0'         2ND NUMERIC                                  
         BNO   UPCHAPX               NO                                         
         NI    1(R3),X'0F'           YES                                        
         IC    R2,1(R3)                                                         
         LA    R2,1(R2)                                                         
         STC   R2,SECTNUM                                                       
         OI    SECTNUM,X'C0'                                                    
         BR    R7                                                               
         SPACE 1                                                                
TWONUMS  BAS   R6,INTERSET                                                      
         BAS   R6,GETNUM                                                        
         MVC   NUM1,NUM                                                         
         BAS   R6,TERMFIND                                                      
         BAS   R6,GETNUM                                                        
         BR    R7                                                               
         SPACE 1                                                                
UPREV    LA    R3,1(R1)                                                         
         LA    R4,10(R3)                                                        
         CLI   0(R4),C' '                                                       
         BE    REVOUT                                                           
REVLP    CLI   0(R4),C','                                                       
         BE    REVOUT                                                           
         BCTR  R4,0                                                             
         CR    R4,R3                                                            
         BH    REVLP                                                            
         B     UPFLUSH                                                          
         SPACE 1                                                                
REVOUT   LR    R1,R4                                                            
         BCTR  R4,0                                                             
         SR    R4,R3                                                            
         LA    R2,REVDATE                                                       
         EX    R4,MOVEREV                                                       
         BR    R7                                                               
         SPACE 1                                                                
MOVEREV  MVC   0(0,R2),0(R3)                                                    
         SPACE 1                                                                
UPLFIG   BAS   R6,TERMFIND                                                      
         BAS   R6,GETNUM                                                        
         ZAP   FIGNO,NUM                                                        
         B     FIGNOSET            RETURN VIA R7                                
         EJECT                                                                  
GETNUM   LA    R4,0(R3)                                                         
GETNUMLP TM    0(R4),X'F0'         NUMERIC                                      
         BO    MORENUM               YES                                        
         SPACE 1                                                                
         MVC   UPERRNUM,=H'3'        NO                                         
         B     UPFLUSH                                                          
         SPACE 1                                                                
MORENUM  LA    R4,1(R4)                                                         
         CR    R4,R1                                                            
         BL    GETNUMLP                                                         
         SPACE 1                                                                
         BCTR  R4,0                                                             
         SR    R4,R3                                                            
         EX    R4,PACKNUM                                                       
         BR    R6                                                               
         SPACE 1                                                                
PACKNUM  PACK  NUM,0(0,R3)                                                      
         SPACE 1                                                                
NUM      DC    PL2'0'                                                           
NUM1     DC    PL2'0'                                                           
SVNUM    DC    PL2'0'                                                           
         SPACE 2                                                                
UPFLUSH  MVC   SAVEDIR,P                                                        
         LH    R3,UPERRNUM                                                      
         MH    R3,=H'48'           L(ERRMSG)                                    
         LA    R3,UPERMSGS(R3)                                                  
         MVC   P(48),0(R3)                                                      
         MVC   P+48(30),=C' SKIPPING REST OF "UPDATE." **'                      
         GOTO1 =V(PRINTER)                                                      
         MVC   P(80),SAVEDIR                                                    
         GOTO1 =V(PRINTER)                                                      
UPFLLOOP GOTO1 =V(PANIC),PARA                                                   
         TM    PARA+8,X'80'                                                     
         BO    ENDBOOK                                                          
         SPACE 1                                                                
         CLC   P(7),=C'UPDATE='                                                 
         BE    UPDATING                                                         
         B     UPFLLOOP                                                         
         SPACE 1                                                                
UPERMSGS DC    CL48'?? NO FIELD TERMINATOR ??'                                  
         DC    CL48'** NO "REP", "INS", OR "END"'                               
         DC    CL48'** INVALID KEYWORD'                                         
         DC    CL48'** INVALID NUMBER'                                          
         DC    CL48'** 1ST "REP" PAGES= NO NOT ODD'                             
         DC    CL48'** 2ND "REP" PAGES= NO NOT EVEN'                            
         DC    CL48'** 2ND "REP" PAGES= NO NOT GREATER THAN 1ST'                
         DC    CL48'** 2ND "REP" FIGURES= NO LESS THAN 1ST'                     
         DC    CL48'** NO PAGES= ENTRY IN "REP" LINE'                           
         DC    CL48'** NO RFOOT, TITLE, OR SUPER AFTER UPDATE= LINE'            
         DC    CL48'** NO AFTERPG= ENTRY IN "INS" LINE'                         
         DC    CL48'** CAN''T PRINT INS OR REP PAGES FOR CANADA'                
         SPACE 1                                                                
UPERRNUM DC    H'0'                                                             
         EJECT                                                                  
SUPER    BAS   RE,SCANSUP          TEST AND SET SUPER                           
         CLI   SECTNUM,C' '        IS CHAPNUM GIVEN                             
         BE    DEMOTE                NO                                         
         SPACE 1                                                                
         MVC   SAVEDIR,SPACES                                                   
         MVC   SAVEDIR(7),=C'CHAPTER'                                           
         LA    R1,SAVEDIR+8                                                     
         BAS   RE,DOSUPNUM                                                      
         BAS   R7,CENTERER                                                      
         EX    R1,UPITALL          CAP THE CENTERED TEXT                        
         OI    MODE,X'40'          CHAP ON 3RD PAGE LINE                        
         GOTO1 =V(PRINTER)                                                      
         GOTO1 =V(PRINTER)                                                      
         MVC   SAVEDIR(58),INDEX                                                
         LA    R1,SAVEDIR+59                                                    
         BAS   R7,CENTERER                                                      
         EX    R1,UPITALL          CAP THE CENTERED TEXT                        
         STH   R1,LOFTITLE                                                      
         OI    MODE,X'80'                                                       
         GOTO1 =V(PRINTER)                                                      
         GOTO1 =V(PRINTER)                                                      
         ZAP   LINE,=P'10'                                                      
         B     TITLESET                                                         
         SPACE 1                                                                
DEMOTE   MVC   LOFTITLE,=H'0'      DEMOTE SUPER TO NEW TITLE                    
TITLESET MVC   TITLE(58),INDEX     SET SUPER TEXT FOR TITLE USAGE               
         B     READ                                                             
         SPACE 1                                                                
UPITALL  OC    0(0,R2),SPACES                                                   
         SPACE 1                                                                
SCANSUP  ST    RE,RETADDR                                                       
         B     SCAN3                                                            
         EJECT                                                                  
*              CENTERER FOR SUPER OR FIGURE                                     
         SPACE 1                                                                
CENTERER LA    R0,76               LINE WIDTH                                   
         LA    R2,P                PRINT LINE START                             
CENTLP   CLI   0(R1),C' '                                                       
         BNE   *+8                 RIGHT END FOUND                              
         BCT   R1,CENTLP                                                        
         LA    R3,SAVEDIR-1                                                     
         SR    R1,R3               LENGTH OF LINE TO CENTER                     
         SR    R0,R1               SPACES TO SPLIT EVENLY                       
         SRA   R0,1                DIVIDE BY 2                                  
         AR    R2,R0               SET START ON LINE                            
         EX    R1,CENTMOVE                                                      
         BR    R7                                                               
         SPACE 1                                                                
CENTMOVE MVC   0(0,R2),SAVEDIR                                                  
         SPACE 1                                                                
ADDPRINT CSECT                                                                  
ENDOLDPG TM    MODE,X'02'          END-PAGE PENDING                             
         BO    *+14                  YES - GO DO IT                             
         TM    MODE,X'08'            NO  - START-PAGE PENDING                   
         BOR   R6                            YES - GET OUT                      
         SPACE 1                                                                
         OI    MODE,X'0A'                    NO  - END OLD, SET START           
         GOTO1 =V(PRINTER)                                                      
         BR    R6                                                               
         EJECT                                                                  
RUNITOUT GOTO1 =V(CARDS),PARA2                                                  
         CLC   C(2),=C'/*'                                                      
         BNE   RUNITOUT                                                         
         SPACE 1                                                                
ENDJOB   CLI   PANOPEN,C'Y'                                                     
         BNE   CLOSEPR                                                          
         CLC   LOFBKLST,=H'0'                                                   
         BE    CLOSEPAN                                                         
         OI    MODE,X'0A'                                                       
         MVC   P(2),SPACES                                                      
         MVC   P+30(10),=C'OUTPUT LOG'                                          
         MVI   SPACING+3,C'2'                                                   
         GOTO1 =V(PRINTER)                                                      
         MVC   P(6),=C'FILTER'                                                  
         MVC   P+50(8),=C'BOOKNAME'                                             
         MVC   P+62(10),=C'ADDRESSEES'                                          
         GOTO1 =V(PRINTER)                                                      
         BAS   R8,SCALE                                                         
         L     R7,=A(BOOKLIST)                                                  
         LH    R3,LOFBKLST                                                      
LOGLOOP  MVC   P(60),FILTERB                                                    
         LH    R2,BOOKCNT                                                       
         CVD   R2,DUB                                                           
         EDIT  (P2,DUB+6),(3,P+64)                                              
         GOTO1 =V(PRINTER)                                                      
         LA    R7,62(R7)                                                        
         BCT   R3,LOGLOOP                                                       
         BAS   R8,SCALE                                                         
         SPACE 1                                                                
CLOSEPAN GOTO1 =V(PANIC),PARA,=C'CLOSE'                                         
CLOSEPR  GOTO1 =V(PRINT),PARA,=C'CLOSE'                                         
         XBASE                                                                  
         SPACE 1                                                                
SCALE    MVC   P(46),=C'3.5....10...5....20...5....30...5....40...5...'         
         MVC   P+46(3),=C'.50'                                                  
         GOTO1 =V(PRINTER)                                                      
         BR    R8                                                               
         EJECT                                                                  
*              WORK SPACE                                                       
         SPACE 1                                                                
DUB      DS    D                                                                
WORK     DS    CL32                                                             
PARA     DS    4F                                                               
PARA2    DS    4F                                                               
RETADDR  DS    F                                                                
LINESTRT DS    F                                                                
TABRACK  DS    XL36                                                             
REBUILD  DC    CL160' '                                                         
USCORSAV DC    CL160' '                                                         
SVFIGNO  DC    CL8' '                                                           
SVFNOLEN DC    PL2'0'                                                           
LASTFIG  DC    PL2'0'                                                           
FIGNO    DC    PL2'0'                                                           
BOTMLIM  DC    PL2'48'                                                          
BOTMLINE DC    PL2'50'                                                          
BOTMPOSN DC    H'40'                                                            
CENTLINE DC    C'23'                                                            
CENTPOSN DC    H'20'                                                            
LOFBKLST DC    H'0'                                                             
LOFADLST DC    H'0'                                                             
CURBOOK  DC    H'0'                                                             
CURADDR  DC    H'0'                                                             
USCOFFST DC    H'0'                                                             
SVLIN1   DC    C'00'                                                            
SVMAXLIN DC    PL2'0'                                                           
C        DS    CL80                                                             
SAVEDIR  DS    CL80                                                             
INDEX    DS    CL60                                                             
FILTERS  DS    CL50                                                             
ADLISTNM DC    CL12' '                                                          
SCANWORD DS    CL5                                                              
         DS    CL2                                                              
ALPHA    DC    C' '                                                             
PANOPEN  DC    C' '                                                             
ADDRESS  DC    C' '                                                             
ADDRPOSN DC    C' '                                                             
SCRNFLAG DC    C' '                                                             
NOSCREEN DC    C' '                                                             
LINELEN  DC    X'00'                                                            
XERTEXT  DC    C' '                                                             
ROOM     DC    PL1'0'                                                           
FIGPTNUM DC    C' '                                                             
FLASH    DC    C'Y'          N=SUPPRESS SETPRT COMMAND                          
NOFLASH  DC    C' '                                                             
SAVEFLAG DC    C' '                                                             
         SPACE 1                                                                
         DS    0D                                                               
USCORE   DS    0CL256                                                           
         DC    109X'00'                                                         
         DC    X'FF'               USCORE X'6D'                                 
         DC    146X'00'                                                         
         EJECT                                                                  
SEPUSC   DS    0CL256                                                           
         DC    64X'01'                                                          
         DC    X'00'          40                                                
         DC    44X'01'                                                          
         DC    X'00'          6D                                                
         DC    146X'01'                                                         
         SPACE 1                                                                
LINEENDS DS    0CL256                                                           
         DC    6X'00'                                                           
         DC    X'06'          RCR - 06                                          
         DC    23X'00'                                                          
         DC    X'1E'          CRE - 1E                                          
         DC    225X'00'                                                         
         SPACE 1                                                                
TABCHECK DS    0CL256                                                           
         DC    5X'00'                                                           
         DC    X'05'          HT  - 05  XEROX PTB                               
         DC    51X'00'                                                          
         DC    X'39'          IT  - 39  XEROX TAB                               
         DC    198X'00'                                                         
         SPACE 1                                                                
USCORES  DS    0CL256                                                           
         DC    34X'00'                                                          
         DC    X'22'          BUS - 22                                          
         DC    X'23'          WUS - 23                                          
         DC    220X'00'                                                         
         SPACE 1                                                                
INTERTRT DS    0CL256                                                           
         DC    96X'00'                                                          
         DC    X'60'     DASH                                                   
         DC    29X'00'                                                          
         DC    X'7E'     EQUAL SIGN                                             
         DC    129X'00'                                                         
         SPACE 1                                                                
TRTABLE  DS    0CL256                                                           
         DC    X'000102030405060708090A0B0C0D0E0F'                              
         DC    X'101112131415161718191A1B1C1D1E1F'                              
         DC    X'202122232425262728292A2B2C2D2E2F'                              
         DC    X'303132333435363738393A3B3C3D3E3F'                              
         DC    X'404042434445464748494A4B4C4D4E4F'                              
         DC    X'505152535455565758595A5B5C5D5E40'                              
         DC    X'60616263646566676869406B6C6D6E6F'                              
         DC    X'707172737475767778797A7B7C7D7E7F'                              
         DC    X'808182838485868788898A8B8C8D8E8F'                              
         DC    X'909192939495969798999A9B9C9D9E9F'                              
         DC    X'A0A1A2A3A4A5A6A7A8A9AAABA60DAEAF'                              
         DC    X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'                              
         DC    X'C0C1C2C3C4C5C6C7C8C960CBCCCDCECF'                              
         DC    X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDE40'                              
         DC    X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'                              
         DC    X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'                              
         EJECT                                                                  
         LTORG                                                                  
         EJECT                                                                  
       ++INCLUDE DDDADDPRNT                                                     
         EJECT                                                                  
       ++INCLUDE DDREMOTED                                                      
         EJECT                                                                  
ADDRLIST CSECT                                                                  
         DS    1500CL114                                                        
         ORG   ADDRLIST                                                         
FILTERA  DS    CL50      ADDRESSEE FILTER LINE                                  
ADDRLN1  DS    CL32                                                             
ADDRLN2  DS    CL32                                                             
UTL      CSECT                                                                  
         DC    F'0'                                                             
         DC    X'0A'                                                            
         DC    X'000000'                                                        
         SPACE 2                                                                
         SPACE 1                                                                
BOOKLIST CSECT                                                                  
         DS    20CL62                                                           
         ORG   BOOKLIST                                                         
FILTERB  DS    CL50      BOOK FILTER LINE                                       
BOOKNAME DS    CL10                                                             
BOOKCNT  DS    H                                                                
         SPACE 1                                                                
REGSAVE  CSECT                                                                  
         DS    12000C                                                           
         SPACE 1                                                                
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'008PBADDPRTOS05/01/02'                                      
         END                                                                    
