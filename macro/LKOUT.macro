*          DATA SET MCLKOUT    AT LEVEL 014 AS OF 03/17/09                      
         MACRO                                                                  
&LABEL   LKOUT &MACTYPE,                                               +        
               &PARM1,                                                 +        
               &PARM2,                                                 +        
               &PARM3,                                                 +        
               &PARM4,                                                 +        
               &NEWEL=,                                                +        
               &MULTIROW=,                                             +        
               &SEQUENCE=,                                             +        
               &EOT=,                                                  +        
               &LEN=,                                                  +        
               &NROWS=,                                                +        
               &ROWNAME=,                                              +        
               &ROWID=,                                                +        
               &ROWWIDTH=,                                             +        
               &COLCOUNT=,                                             +        
               &FILTROUT=,                                             +        
               &SETFILT=,                                              +        
               &TESTFILT=,                                             +        
               &SKIPCOLS=,                                             +        
               &SENDONCE=,                                             +        
               &MAPONLY=,                                              +        
               &SENDCHAR=,                                             +        
               &NULLDATA=,                                             +        
               &SENDONERROR=,                                          +        
               &ND=,                                                   +        
               &OLIST=,                                                +        
               &SETEL=,                                                +        
               &PZERO=,                                                +        
               &CCLOW=,                                                +        
               &MAPMOD=,                                               +        
               &MAPMOD1=,                                              +        
               &MAPMOD2=,                                              +        
               &PCVERSION=                                                      
.*                                                                              
         GBLA  &TYPNUM                                                          
         GBLB  &FIRST_OUTPUT_DEFINITION                                         
         GBLB  &TABLE_IS_OPEN                                                   
         GBLB  &SERVER_NATIVE                                                   
         GBLB  &SERVER_BIG                                                      
         GBLB  &OARRAY_IS_OPEN                                                  
         GBLC  &SERVER_NAME                                                     
         GBLC  &CURRENT_TABLE_NAME                                              
         GBLC  &CURRENT_RECORD_NAME                                             
         GBLC  &CURRENT_ROW_NAME                                                
         GBLC  &BLOCK_LABEL                                                     
         LCLA  &COUNT                                                           
         LCLB  &EXTEND                                                          
         LCLB  &SWITCH                                                          
         LCLB  &PARENT                                                          
         LCLB  &VARROWS                                                         
         LCLC  &I1,&I2,&I3,&I4,&I5,&I6,&I7,&I8,&INDS                            
         LCLC  &STRING                                                          
         LCLC  &STRING2                                                         
.*                                                                              
         AIF   (T'&MACTYPE EQ 'O').ERROR1                                       
         AIF   ('&MACTYPE'(1,1) EQ 'H').LKH                                     
         AIF   ('&MACTYPE'(1,1) EQ 'R').LKR                                     
         AIF   ('&MACTYPE'(1,1) EQ 'A').LKA                                     
         AIF   ('&MACTYPE'(1,1) EQ 'P').LKP                                     
         AIF   ('&MACTYPE'(1,1) EQ 'C').LKC                                     
         AIF   ('&MACTYPE'(1,1) EQ 'E').LKE                                     
         AIF   ('&MACTYPE'(1,1) EQ 'X').LKEND                                   
         AGO   .ERROR2                                                          
.*                                                                              
.**********************************************************************         
.* TABLE HEADER - FORMAT IS:-                                         *         
.*                                                                    *         
.* LABEL LKOUT H                                                      *         
.*                                                                    *         
.* GENERATES:-                                                        *         
.*                                                                    *         
.* LABEL DC    AL2(LABELX-LABEL)                                      *         
.*       DC    CL9'*LABEL)                                            *         
.**********************************************************************         
.*                                                                              
.LKH     ANOP  ,                                                                
         AIF   (&TABLE_IS_OPEN).ERROR3                                          
         AIF   (T'&LABEL EQ 'O').ERROR4                                         
         AIF   (K'&LABEL GT 8).ERROR4                                           
&FIRST_OUTPUT_DEFINITION           SETB  0                                      
&CURRENT_TABLE_NAME                SETC  '&LABEL'                               
&TABLE_IS_OPEN                     SETB  1                                      
&STRING  SETC  '&LABEL'.'X'                                                     
         AIF   (NOT &SERVER_BIG).LKH0010                                        
         DS    0H                                                               
.*                                                                              
.LKH0010 ANOP  ,                                                                
&LABEL   DC    AL2(&STRING-&LABEL)                                              
&STRING  SETC  '*'.'&LABEL'                                                     
         DC    CL9'&STRING'                                                     
*                                                                               
         MEXIT                                                                  
.*                                                                              
.**********************************************************************         
.* RECORD HEADER - FORMAT IS:-                                        *         
.*                                                                    *         
.* LABEL LKOUT R,MAPCODE                                              *         
.*                                                                    *         
.* GENERATES:- LE_D                                                   *         
.**********************************************************************         
.*                                                                              
.LKR     ANOP  ,                   LE_LN                                        
         AIF   (&FIRST_OUTPUT_DEFINITION).ERROR3                                
         AIF   (NOT &TABLE_IS_OPEN).ERROR3                                      
         AIF   (T'&LABEL EQ 'O').LKR02                                          
         AIF   (K'&LABEL GT 8).ERROR4                                           
&CURRENT_RECORD_NAME               SETC  '&LABEL'                               
&STRING  SETC  '&LABEL'.'X'                                                     
&LABEL   DC    AL2(&STRING-&LABEL)                                              
         LKARY A,&CURRENT_TABLE_NAME,&CURRENT_RECORD_NAME                       
         AGO   .LKR04                                                           
.*                                                                              
.LKR02   ANOP  ,                                                                
&CURRENT_RECORD_NAME               SETC  ' '                                    
&STRING  SETC  '&CURRENT_TABLE_NAME'.'X'                                        
         DC    AL2(&STRING-*)                                                   
.*                                                                              
.LKR04   ANOP  ,                   LE_CODE                                      
         AIF   (T'&PARM1 EQ 'O').ERROR5                                         
         DC    AL2(&PARM1)                                                      
.*                                 LE_ID                                        
         AIF   (T'&LABEL EQ 'O').LKR06                                          
&STRING  SETC  '*'.'&LABEL'(1,4)                                                
         DC    CL5'&STRING'                                                     
         AGO   .LKR08                                                           
.*                                                                              
.LKR06   ANOP  ,                                                                
         DC    XL5'00'                                                          
.*                                                                              
.LKR08   ANOP  ,                                                                
         DC    XL3'00'                                                          
         LKVER &PCVERSION                                                       
*                                                                               
         MEXIT                                                                  
.*                                                                              
.**********************************************************************         
.* ARRAY HEADER DEFINITION                                            *         
.*                                                                    *         
.* LABEL LKOUT A,MAPCODE,INPUT(,OUTPUT)(,TYPE)(,OPTIONS)              *         
.*                                                                    *         
.* GENERATES:- LX_D                                                   *         
.**********************************************************************         
.*                                 LX_D                                         
.LKA     ANOP  ,                                                                
         AIF   (&FIRST_OUTPUT_DEFINITION).ERROR3                                
         AIF   (&TABLE_IS_OPEN).ERROR3                                          
         AIF   (T'&LABEL EQ 'O').ERROR4                                         
         AIF   (K'&LABEL GT 8).ERROR4                                           
.*                                                                              
         AIF   (N'&NROWS NE 1).LKA01                                            
&VARROWS                           SETB ('&NROWS'(1,1) EQ '*')                  
.*                                                                              
.LKA01   ANOP  ,                                                                
&PARENT                            SETB  ('&PARM1(1)'(1,1) EQ '*')              
         AIF   (&VARROWS AND NOT &PARENT).ERROR36                               
&CURRENT_ROW_NAME                  SETC  ''                                     
&CURRENT_TABLE_NAME                SETC  '&LABEL'                               
&OARRAY_IS_OPEN                    SETB  1                                      
&TABLE_IS_OPEN                     SETB  1                                      
.*                                                                              
         AIF   (&SERVER_BIG).LKA01A                                             
&LABEL   DS    0X                                                               
         AGO   .LKA01X                                                          
.*                                                                              
.LKA01A  ANOP  ,                                                                
&LABEL   DS    0H                                                               
.*                                                                              
.LKA01X  ANOP  ,                                                                
.*                                 LX_INDS1                                     
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&PARM1 EQ 'O').ERROR16                                        
         AIF   (N'&PARM1 GT 3).ERROR16                                          
         AIF   (&PARENT).LKA05                                                  
         AIF   (N'&PARM1 NE 2).LKA02                                            
         AIF   ('&PARM1(1)'(1,1) NE 'R').ERROR16                                
         LKARY R,&CURRENT_TABLE_NAME,&PARM1(2)                                  
&I2      SETC  '1'                 LX_IRTNQ                                     
.*                                                                              
         AIF   (T'&MULTIROW EQ 'O').LKA02                                       
         AIF   ('&MULTIROW'(1,1) NE 'Y').ERROR31                                
&I3      SETC  '1'                 LX_IRBRQ                                     
         AGO   .LKA04                                                           
.*                                                                              
.LKA02   ANOP  ,                                                                
         AIF   ('&PARM1(1)'(1,1) EQ 'R').LKA04                                  
         AIF   (N'&PARM1 NE 3).ERROR16                                          
         AIF   ('&PARM1(1)'(1,1) NE 'D' AND                            +        
                '&PARM1(1)'(1,1) NE 'I').ERROR16                                
         AIF   ('&PARM1(1)'(1,1) NE 'I').LKA04                                  
&I1      SETC  '1'                 LX_IADDQ                                     
         AGO   .LKA05                                                           
.*                                                                              
.LKA04   ANOP  ,                                                                
         AIF   ('&PARM1(1)'(1,1) NE 'D').LKA05                                  
         LKARY D,&CURRENT_TABLE_NAME,&PARM1(3)                                  
.*                                                                              
.LKA05   ANOP  ,                                                                
         AIF   (T'&NEWEL EQ 'O').LKA07                                          
         AIF   (T'&MULTIROW NE 'O').ERROR17                                     
         AIF   ('&NEWEL'(1,1) EQ 'B').LKA06                                     
         AIF   ('&NEWEL'(1,1) NE 'Y').LKA07                                     
.*                                                                              
.LKA06   ANOP  ,                                                                
&I4      SETC  '1'                 LX_INELQ                                     
.*                                                                              
.LKA07   ANOP  ,                                                                
         AIF   ('&PARM1(1)'(1,1) NE 'D' AND                            +        
                '&PARM1(1)'(1,1) NE 'I').LKA08                                  
.*                                                                              
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
&STRING  SETC  'AL1(B''&INDS'.'''+'.'&PARM1(2)'.')'                             
         DC    &STRING                                                          
         AGO   .LKA10                                                           
.*                                                                              
.LKA08   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
         DC    B'&INDS'                                                         
.*                                 LX_INDS2                                     
.LKA10   ANOP  ,                                                                
.*                                                                              
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&SEQUENCE EQ 'O').LKA12                                       
         AIF   ('&SEQUENCE'(1,1) NE 'C').ERROR18                                
         AIF   (T'&MULTIROW NE 'O').ERROR19                                     
&I1      SETC  '1'                 LX_ICOLQ                                     
.*                                                                              
.LKA12   ANOP  ,                                                                
         AIF   (T'&EOT EQ 'O').LKA14                                            
         AIF   (T'&MULTIROW NE 'O').ERROR20                                     
&I2      SETC  '1'                 LX_IEOTQ                                     
.*                                                                              
.LKA14   ANOP  ,                                                                
         AIF   (T'&NROWS EQ 'O').LKA15                                          
         AIF   (T'&EOT NE 'O').ERROR21                                          
         AIF   (N'&NROWS NE 2).LKA15                                            
&I3      SETC  '1'                 LX_IRADR                                     
.*                                                                              
.LKA15   ANOP  ,                                                                
         AIF   (NOT &VARROWS).LKA16                                             
&I4      SETC  '1'                 LX_IRVAR                                     
.*                                                                              
.LKA16   ANOP  ,                                                                
         AIF   (T'&ROWWIDTH EQ 'O').LKA22                                       
         AIF   (N'&ROWWIDTH EQ 1).LKA22                                         
         AIF   ('&ROWWIDTH(1)'(1,1) NE 'V').LKA22                               
         AIF   (N'&ROWWIDTH LT 3).LKA18                                         
         AIF   (T'&ROWWIDTH(3) NE 'N').LKA22                                    
         AIF   (&ROWWIDTH(3) NE 1).LKA20                                        
.*                                                                              
.LKA18   ANOP  ,                                                                
&I5      SETC '1'                  LX_IDW1Q                                     
         AGO   .LKA22                                                           
.*                                                                              
.LKA20   ANOP  ,                                                                
         AIF   (&ROWWIDTH(3) NE 2).ERROR22                                      
&I6      SETC '1'                  LX_IDW2Q                                     
.*                                                                              
.LKA22   ANOP  ,                                                                
         AIF   (T'&FILTROUT EQ 'O').LKA24                                       
&I7      SETC  '1'                 LX_IFTRQ                                     
.*                                                                              
.LKA24   ANOP  ,                                                                
         AIF   (T'&SENDONCE EQ 'O').LKA26                                       
         AIF   ('&SENDONCE'(1,1) NE 'Y').ERROR23                                
&I8      SETC  '1'                 LX_IXIFQ                                     
.*                                                                              
.LKA26   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
         DC    B'&INDS'                                                         
.*                                 LX_INDS3                                     
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&NEWEL EQ 'O').LKA30                                          
         AIF   ('&NEWEL'(1,1) EQ 'B').LKA27                                     
         AIF   ('&NEWEL'(1,1) NE 'R').LKA28                                     
.*                                                                              
.LKA27   ANOP  ,                                                                
&I1      SETC  '1'                 LX_INERQ                                     
.*                                                                              
.LKA28   ANOP  ,                                                                
         AIF   ('&NEWEL'(1,1) NE 'A').LKA30                                     
&I2      SETC  '1'                 LX_INEAQ                                     
.*                                                                              
.LKA30   ANOP  ,                                                                
         AIF   (T'&COLCOUNT EQ 'O').LKA32                                       
         AIF   ('&COLCOUNT'(1,1) NE '+').ERROR24                                
&I3      SETC  '1'                 LX_I2NCQ                                     
.*                                                                              
.LKA32   ANOP  ,                                                                
         AIF   (T'&SETFILT EQ 'O' AND                                  +        
                T'&TESTFILT EQ 'O'                                     +        
                AND NOT &PARENT).LKA34                                          
&I4      SETC  '1'                 LX_IXTNQ                                     
&EXTEND  SETB  1                                                                
.*                                                                              
.LKA34   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
.*                                                                              
         AIF   (T'&NROWS EQ 'O').LKA36                                          
         AIF   (N'&NROWS NE 2).LKA36                                            
&STRING  SETC  'AL1(B''&INDS'.'''+'.'&NROWS(1)'.')'                             
         DC    &STRING                                                          
         AGO   .LKA38                                                           
.*                                                                              
.LKA36   ANOP  ,                                                                
         DC    B'&INDS'                                                         
.*                                 LX_ADDR                                      
.LKA38   ANOP  ,                                                                
         AIF   ('&PARM1(1)'(1,1) NE 'R').LKA40                                  
         AIF   (&SERVER_BIG).LKA38A                                             
         DC    AL2(&PARM1(2)-&SERVER_NAME)                                      
         AGO   .LKA42                                                           
.*                                                                              
.LKA38A  ANOP  ,                                                                
         DC    AL2((&PARM1(2)-&SERVER_NAME)/2)                                  
         AGO   .LKA42                                                           
.*                                                                              
.LKA40   ANOP  ,                                                                
         AIF   (&PARENT).LKA402                                                 
         LKBLK &PARM1(2)                                                        
&CURRENT_ROW_NAME                  SETC  '&PARM1(3)'                            
         DC    AL2(&PARM1(3)-&BLOCK_LABEL)                                      
         AGO   .LKA42                                                           
.*                                                                              
.LKA402  ANOP  ,                                                                
         AIF   (N'&PARM1 GT 1).LKA404                                           
         DC    AL2(0)                                                           
         AGO   .LKA42                                                           
.*                                                                              
.LKA404  ANOP  ,                                                                
         AIF   (N'&PARM1 GT 2).ERROR6                                           
         AIF   (T'&ROWNAME EQ 'O').ERROR35                                      
         DC    AL2(&PARM1(2)-&ROWNAME)                                          
&CURRENT_ROW_NAME                  SETC  '&PARM1(2)'                            
.*                                 LX_NROWS                                     
.LKA42   ANOP  ,                                                                
         AIF   (T'&NROWS EQ 'O').LKA46                                          
         AIF   (N'&NROWS NE 2).LKA44                                            
         LKBLK &NROWS(1)                                                        
         DC    AL2(&NROWS(2)-&BLOCK_LABEL)                                      
         AGO   .LKA52                                                           
.*                                                                              
.LKA44   ANOP  ,                                                                
         AIF   (N'&NROWS NE 1).ERROR24                                          
         AIF   (&VARROWS).LKA45                                                 
         DC    AL2(&NROWS)                                                      
         AGO   .LKA52                                                           
.*                                                                              
.LKA45   ANOP  ,                                                                
         DC    AL2(0)                                                           
         AGO   .LKA52                                                           
.*                                 LX_EDSP/LX_EOTC                              
.LKA46   ANOP  ,                                                                
         AIF   (T'&EOT EQ 'O').LKA50                                            
         AIF   (N'&EOT NE 1).LKA48                                              
         DC    AL1(0)                                                           
         DC    AL1(&EOT)                                                        
         AGO   .LKA52                                                           
.*                                                                              
.LKA48   ANOP  ,                                                                
         AIF   (N'&EOT NE 2).ERROR25                                            
         AIF   ('&PARM1(1)'(1,1) NE 'D').ERROR24                                
         LKBLK &PARM1(2)                                                        
         DC    AL1(&EOT(1)-&BLOCK_LABEL)                                        
         DC    AL1(&EOT(2))                                                     
         AGO   .LKA52                                                           
.*                                                                              
.LKA50   ANOP  ,                                                                
         AIF   ('&PARM1(1)'(1,1) NE 'R' AND NOT &PARENT).LKA502                 
         AIF   (T'&MULTIROW NE 'O').LKA502                                      
         DC    AL2(1)                                                           
         AGO   .LKA52                                                           
.*                                                                              
.LKA502  ANOP  ,                                                                
         DC    AL1(0)                                                           
         DC    AL1(0)                                                           
.*                                 LX_WROW                                      
.LKA52   ANOP  ,                                                                
         AIF   (T'&COLCOUNT EQ 'O').LKA54                                       
&STRING  SETC  '&CURRENT_TABLE_NAME'.'#'                                        
         DC    AL2(&STRING)                                                     
         AGO   .LKA64                                                           
.*                                                                              
.LKA54   ANOP  ,                                                                
         AIF   (T'&ROWWIDTH EQ 'O').LKA58                                       
         AIF   (N'&ROWWIDTH NE 1).LKA56                                         
         DC    AL2(&ROWWIDTH)                                                   
         AGO   .LKA64                                                           
.*                                                                              
.LKA56   ANOP  ,                                                                
         AIF   ('&ROWWIDTH(1)'(1,1) NE 'V').LKA58                               
         AIF   (T'&ROWID EQ 'O').ERROR29                                        
&CURRENT_ROW_NAME                  SETC  '&ROWID(1)'                            
         DC    AL2(&ROWWIDTH(2)-&ROWID(1))                                      
         AGO   .LKA62                                                           
.*                                                                              
.LKA58   ANOP  ,                                                                
         AIF   ('&PARM1(1)'(1,1) NE 'D').LKA60                                  
         LKARY D,&CURRENT_TABLE_NAME,&PARM1(3)                                  
         DC    AL2(L'&PARM1(3))                                                 
         AGO   .LKA62                                                           
.*                                                                              
.LKA60   ANOP  ,                                                                
         DC    AL2(0)                                                           
.*                                 LX_FADDR                                     
.LKA62   ANOP  ,                                                                
         AIF   (T'&FILTROUT EQ 'O').LKA64                                       
         AIF   (T'&ROWID NE 'O').ERROR26                                        
         AIF   (&SERVER_BIG).LKA62A                                             
         DC    AL2(&FILTROUT-&SERVER_NAME)                                      
         AGO   .LKA70                                                           
.*                                                                              
.LKA62A  ANOP  ,                                                                
         DC    AL2((&FILTROUT-&SERVER_NAME)/2)                                  
         AGO   .LKA70                                                           
.*                                 LX_IFDSP/LX_IFCHR                            
.LKA64   ANOP  ,                                                                
         AIF   (T'&ROWID EQ 'O').LKA68                                          
         LKARY D,&CURRENT_TABLE_NAME,&ROWID(1)                                  
         AIF   (N'&ROWID NE 2).LKA66                                            
         DC    AL1(0)                                                           
         DC    AL1(&ROWID(2))                                                   
         AGO   .LKA70                                                           
.*                                                                              
.LKA66   ANOP  ,                                                                
         AIF   (N'&ROWID NE 3).ERROR27                                          
         DC    AL1(&ROWID(2)-&ROWID(1))                                         
         DC    AL1(&ROWID(3))                                                   
         AGO   .LKA70                                                           
.*                                                                              
.LKA68   ANOP  ,                                                                
         DC    AL2(0)                                                           
.*                                 LX_NCOLS                                     
.LKA70   ANOP  ,                                                                
         AIF   (T'&COLCOUNT EQ 'O').LKA72                                       
         DC    AL1(0)                                                           
         AGO   .LKA74                                                           
.*                                                                              
.LKA72   ANOP  ,                                                                
&STRING  SETC  '&CURRENT_TABLE_NAME'.'#'                                        
         DC    AL1(&STRING)                                                     
.*                                 LX_VRSN                                      
.LKA74   ANOP  ,                                                                
         LKVER &PCVERSION                                                       
.*                                                                              
         AIF   (NOT &EXTEND).LKA86                                              
.*                                 LX_INDS4                                     
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&SETFILT EQ 'O' AND                                  +        
                T'&TESTFILT EQ 'O').LKA78                                       
         AIF   (T'&ROWID EQ 'O').ERROR29                                        
         AIF   (T'&SETFILT EQ 'O').LKA76                                        
&I1      SETC  '1'                 LX_ISRFQ                                     
         AGO   .LKA78                                                           
.*                                                                              
.LKA76   ANOP  ,                                                                
         AIF   (T'&TESTFILT EQ 'O').LKA78                                       
&I2      SETC  '1'                 LX_ITRFQ                                     
.*                                                                              
.LKA78   ANOP  ,                                                                
         AIF   (NOT &PARENT).LKA782                                             
&I3      SETC  '1'                 LX_IUPRQ                                     
.*                                                                              
.LKA782  ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
         DC    B'&INDS'                                                         
.*                                 LX_DFILT/LX_LFILT                            
         AIF   (T'&SETFILT EQ 'O').LKA80                                        
         AIF   (N'&SETFILT NE 2).ERROR28                                        
         DC    AL1(&SETFILT(1)-&ROWID(1))                                       
         DC    AL1(&SETFILT(2))                                                 
         AGO   .LKA84                                                           
.*                                                                              
.LKA80   ANOP  ,                                                                
         AIF   (T'&TESTFILT EQ 'O').LKA82                                       
         AIF   (N'&TESTFILT NE 2).ERROR30                                       
         DC    AL1(&TESTFILT(1)-&ROWID(1))                                      
         DC    AL1(&TESTFILT(2))                                                
         AGO   .LKA84                                                           
.*                                                                              
.LKA82   ANOP  ,                                                                
         DC    AL1(0)                                                           
         DC    AL1(0)                                                           
.*                                 SPARE IN EXTENSION BLOCK                     
.LKA84   ANOP  ,                                                                
         DC    XL9'00'                                                          
.*                                                                              
.LKA86   ANOP  ,                                                                
.*                                                                              
         AIF   (&PARENT AND N'&PARM1 GT 1).LKA88                                
         AIF   (T'&ROWNAME EQ 'O').LKA88                                        
&CURRENT_ROW_NAME                  SETC  '&ROWNAME'                             
         LKARY D,&CURRENT_TABLE_NAME,&ROWNAME                                   
.*                                                                              
.LKA88   ANOP  ,                                                                
*                                                                               
&STRING  SETC  '&CURRENT_TABLE_NAME'.'$'                                        
&STRING  DS    0X                                                               
.*                                                                              
.LKA88X  ANOP  ,                                                                
*                                                                               
         MEXIT                                                                  
.*                                                                              
.**********************************************************************         
.* COLUMN DEFINITIONS                                                 *         
.**********************************************************************         
.*                                                                              
.LKC     ANOP  ,                                                                
         AIF   (NOT &SERVER_NATIVE).ERROR12                                     
         AIF   (&FIRST_OUTPUT_DEFINITION).ERROR3                                
         AIF   (NOT &TABLE_IS_OPEN).ERROR3                                      
         AIF   (&OARRAY_IS_OPEN).LKX                                            
.*                                                                              
.**********************************************************************         
.* REGULAR OUTPUT COLUMNS                                             *         
.*                                                                    *         
.* LABEL LKOUT C,MAPCODE,INPUT,OUTPUT(,OPTIONS)                       *         
.*                                                                    *         
.* GENERATES:- LO_D                                                   *         
.**********************************************************************         
.*                                 LO_D                                         
.LKO     ANOP  ,                   LO_CODE                                      
         AIF   (T'&PARM1 EQ 'O').ERROR5                                         
         DC    AL2(&PARM1)                                                      
.*                                                                              
         AIF   (T'&FILTROUT NE 'O' OR                                  +        
                T'&MAPONLY  NE 'O' OR                                  +        
                T'&SENDCHAR NE 'O' OR                                  +        
                T'&LABEL    EQ 'O').LKO02                                       
         DC    CL5'&LABEL'                                                      
         AGO   .LKO12                                                           
.*                                                                              
.LKO02   ANOP  ,                   LO_IDF/LO_FADDR                              
         DC    X'FF'                                                            
.*                                                                              
         AIF   (T'&FILTROUT EQ 'O').LKO04                                       
         AIF   (&SERVER_BIG).LKO02A                                             
         DC    AL2(&FILTROUT-&SERVER_NAME)                                      
         AGO   .LKO06                                                           
.*                                                                              
.LKO02A  ANOP  ,                                                                
         DC    AL2((&FILTROUT-&SERVER_NAME)/2)                                  
         AGO   .LKO06                                                           
.*                                                                              
.LKO04   ANOP  ,                   LO_FADDR                                     
         DC    AL2(0)                                                           
.*                                                                              
.LKO06   ANOP  ,                   LO_INDS4                                     
.*                                                                              
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&MAPONLY EQ 'O').LKO08                                        
         AIF   ('&MAPONLY'(1,1) NE 'Y').LKO08                                   
&I1      SETC  '1'                                                              
.*                                                                              
.LKO08   ANOP  ,                                                                
         AIF   (T'&SENDCHAR EQ 'O').LKO10                                       
         AIF   ('&SENDCHAR'(1,1) NE 'Y').LKO10                                  
&I2      SETC  '1'                                                              
.*                                                                              
.LKO10   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
         DC    B'&INDS'                                                         
.*                                                                              
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
         DC    B'&INDS'                                                         
.*                                                                              
.LKO12   ANOP  ,                   LO_INDS1                                     
.*                                                                              
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&PARM2 EQ 'O').ERROR6                                         
         AIF   (N'&PARM2 GT 3).ERROR14                                          
         AIF   ('&PARM2(1)'(1,1) NE 'I').LKO14                                  
&I1      SETC  '1'                                                              
         AGO   .LKO18                                                           
.*                                                                              
.LKO14   ANOP  ,                                                                
         AIF   ('&PARM2(1)'(1,1) EQ 'A').LKO16                                  
         AIF   (T'&PARM3 EQ 'O').ERROR15                                        
         AIF   (N'&PARM3 EQ 1).LKO16                                            
         AIF   ('&PARM3(1)'(1,1) NE 'R' AND                            +        
                '&PARM3(1)'(1,1) NE 'U').LKO16                                  
&I2      SETC  '1'                                                              
         AGO   .LKO18                                                           
.*                                                                              
.LKO16   ANOP  ,                                                                
         AIF   ('&PARM2(1)'(1,1) NE 'A').LKO18                                  
&I3      SETC  '1'                                                              
.*                                                                              
.LKO18   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
.*                                                                              
         AIF   (N'&PARM2 NE 3).LKO20                                            
&STRING  SETC  'AL1(B''&INDS'.'''+'.'&PARM2(2)'.')'                             
         DC    &STRING                                                          
         AGO   .LKO22                                                           
.*                                                                              
.LKO20   ANOP  ,                                                                
         DC    B'&INDS'                                                         
.*                                                                              
.LKO22   ANOP  ,                   LO_INDS2                                     
.*                                                                              
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&FILTROUT EQ 'O').LKO24                                       
&I1      SETC  '1'                                                              
.*                                                                              
.LKO24   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
         DC    B'&INDS'                                                         
.*                                 LO_INDS3                                     
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&NULLDATA EQ 'O').LKO26                                       
         AIF   ('&NULLDATA'(1,1) NE 'Y').LKO28                                  
&I1      SETC  '1'                                                              
         AGO   .LKO28                                                           
.*                                                                              
.LKO26   ANOP  ,                                                                
         AIF   (T'&ND EQ 'O').LKO28                                             
         AIF   ('&ND'(1,1) NE 'Y').LKO28                                        
&I1      SETC  '1'                                                              
.*                                                                              
.LKO28   ANOP  ,                                                                
         AIF   (T'&OLIST EQ 'O').LKO32                                          
         AIF   ('&OLIST'(1,1) NE 'Y').LKO30                                     
&I2      SETC  '1'                                                              
         AGO   .LKO32                                                           
.*                                                                              
.LKO30   ANOP  ,                                                                
         AIF   ('&OLIST'(1,1) NE 'C').ERROR8                                    
&I3      SETC  '1'                                                              
.*                                                                              
.LKO32   ANOP  ,                                                                
         AIF   (T'&SETEL EQ 'O').LKO34                                          
         AIF   ('&SETEL'(1,1) NE 'Y').ERROR9                                    
&I4      SETC  '1'                                                              
.*                                                                              
.LKO34   ANOP  ,                                                                
         AIF   (T'&PZERO EQ 'O').LKO36                                          
         AIF   ('&PZERO'(1,1) NE 'S').ERROR10                                   
&I5      SETC  '1'                                                              
.*                                                                              
.LKO36   ANOP  ,                                                                
         AIF   (T'&CCLOW EQ 'O').LKO38                                          
         AIF   ('&CCLOW'(1,3) NE 'NOS').ERROR11                                 
&I6      SETC  '1'                                                              
.*                                                                              
.LKO38   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
.*                                                                              
         AIF   ('&PARM2(1)'(1,1) EQ 'A').LKO40                                  
         AIF   (K'&PARM3(1) NE 1).LKO40                                         
         AIF   ('&PARM3(1)'(1,1) NE 'U').LKO40                                  
         AIF   (N'&PARM2 NE 3).ERROR6                                           
&STRING  SETC  'B''&INDS'.'''+'.'&PARM3(3)'                                     
         DC    AL1(&STRING)                                                     
         AGO   .LKO42                                                           
.*                                                                              
.LKO40   ANOP  ,                                                                
         DC    B'&INDS'                                                         
.*                                                                              
.LKO42   ANOP  ,                     LO_ADDR                                    
         AIF   ('&PARM2(1)'(1,1) NE 'I' AND                            +        
                '&PARM2(1)'(1,1) NE 'D').LKO44                                  
         AIF   (N'&PARM2 NE 3).ERROR14                                          
         LKBLK &PARM2(2)                                                        
         DC    AL2(&PARM2(3)-&BLOCK_LABEL)                                      
         AGO   .LKO46                                                           
.*                                                                              
.LKO44   ANOP  ,                                                                
         AIF   ('&PARM2(1)'(1,1) NE 'R' AND                            +        
                '&PARM2(1)'(1,1) NE 'A').ERROR32                                
         AIF   (N'&PARM2 NE 2).ERROR14                                          
         AIF   (&SERVER_BIG).LKO44A                                             
         DC    AL2(&PARM2(2)-&SERVER_NAME)                                      
         AGO   .LKO44X                                                          
.*                                                                              
.LKO44A  ANOP  ,                                                                
         DC    AL2((&PARM2(2)-&SERVER_NAME)/2)                                  
.*                                                                              
.LKO44X  ANOP  ,                                                                
         DC    AL1(0)                                                           
         AIF   ('&PARM2(1)'(1,1) NE 'A').LKO50                                  
         AIF   ('&CURRENT_RECORD_NAME'(1,1) NE ' ').LKO45                       
         LKARY A,&CURRENT_TABLE_NAME,&PARM2(2)                                  
         AGO   .LKO50                                                           
.*                                                                              
.LKO45   ANOP  ,                                                                
         LKARY A,&CURRENT_RECORD_NAME,&PARM2(2)                                 
         AGO   .LKO50                                                           
.*                                                                              
.LKO46   ANOP  ,                   LO_TYPE                                      
         AIF   ('&PARM2(1)'(1,1) NE 'I' AND                            +        
                '&PARM2(1)'(1,1) NE 'D').LKO54                                  
         AIF   (T'&PARM3 EQ 'O').ERROR15                                        
         AIF   (N'&PARM3 EQ 1).LKO48                                            
         AIF   (K'&PARM3(1) NE 1).LKO48                                         
         AIF   ('&PARM3(1)'(1,1) NE 'U').LKO48                                  
         AIF   (N'&PARM3 NE 3).ERROR32                                          
         DC    AL1(&PARM3(2))                                                   
         AGO   .LKO50                                                           
.*                                                                              
.LKO48   ANOP  ,                                                                
         LKTYP O,&PARM3                                                         
         DC    AL1(&TYPNUM)                                                     
.*                                                                              
.LKO50   ANOP  ,                   LO_DLEN                                      
         AIF   (T'&LEN NE 'O').LKO52                                            
         AIF   (N'&PARM2 LT 3).LKO54                                            
         DC    AL1(L'&PARM2(3))                                                 
         AGO   .LKO56                                                           
.*                                                                              
.LKO52   ANOP  ,                                                                
         DC    AL1(&LEN)                                                        
         AGO   .LKO56                                                           
.*                                                                              
.LKO54   ANOP  ,                                                                
         DC    AL1(0)                                                           
.*                                                                              
.LKO56   ANOP  ,                                                                
         LKVER &PCVERSION                                                       
*                                                                               
         MEXIT                                                                  
.*                                                                              
.**********************************************************************         
.* REGULAR OUTPUT COLUMNS                                             *         
.*                                                                    *         
.* LABEL LKOUT C,MAPCODE,INPUT,OUTPUT(,OPTIONS)                       *         
.*                                                                    *         
.* GENERATES:- LX_COLS                                                *         
.**********************************************************************         
.*                                 LX_COLS                                      
.LKX     ANOP  ,                                                                
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                 LX_CODE                                      
         AIF   (T'&PARM1 EQ 'O').ERROR5                                         
         DC    AL2(&PARM1)                                                      
.*                                                                              
         AIF   (T'&MAPONLY  NE 'O' OR                                  +        
                T'&SENDCHAR NE 'O' OR                                  +        
                T'&SKIPCOLS NE 'O' OR                                  +        
                T'&MAPMOD NE 'O' OR                                    +        
                T'&MAPMOD1 NE 'O' OR                                   +        
                T'&MAPMOD2 NE 'O' OR                                   +        
                T'&LABEL EQ 'O').LKX02                                          
         DC    CL5'&LABEL'                                                      
         AGO   .LKX08                                                           
.*                                                                              
.LKX02   ANOP  ,                   LX_IDF/SPARE                                 
         DC    X'FF'                                                            
         AIF   (T'&MAPMOD1 NE 'O').LKX0202                                      
         AIF   (T'&MAPMOD2 NE 'O').LKX0204                                      
         DC    AL2(0)                                                           
.*                                                                              
         AIF   (T'&MAPMOD EQ 'O').LKX0210                                       
         AIF   ('&MAPMOD'(1,1) NE '*').ERROR34                                  
&I3      SETC  '1'                                                              
&I4      SETC  '1'                                                              
         AGO   .LKX0210                                                         
.*                                                                              
.LKX0202 ANOP  ,                                                                
         AIF   (T'&MAPMOD NE 'O' OR                                    +        
                T'&MAPMOD2 NE 'O').ERROR33                                      
         DC    AL2(&MAPMOD1-&CURRENT_ROW_NAME)                                  
&I3      SETC  '1'                 LX_CMM1Q                                     
         AGO   .LKX0210                                                         
.*                                                                              
.LKX0204 ANOP  ,                                                                
         AIF   (T'&MAPMOD NE 'O' OR                                    +        
                T'&MAPMOD1 NE 'O').ERROR33                                      
         DC    AL2(&MAPMOD2-&CURRENT_ROW_NAME)                                  
&I4      SETC  '1'                 LX_CMM2Q                                     
         AGO   .LKX0210                                                         
.*                                                                              
.LKX0210 ANOP  ,                                                                
.*                                 LX_CIND4                                     
         AIF   (T'&MAPONLY EQ 'O').LKX04                                        
         AIF   ('&MAPONLY'(1,1) NE 'Y').LKX04                                   
&I1      SETC  '1'                 LX_CIMOQ                                     
.*                                                                              
.LKX04   ANOP  ,                                                                
         AIF   (T'&SENDCHAR EQ 'O').LKX06                                       
         AIF   ('&SENDCHAR'(1,1) NE 'Y').LKX06                                  
&I2      SETC  '1'                 LX_CICHQ                                     
.*                                                                              
.LKX06   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
         DC    B'&INDS'                                                         
.*                                 LX_CSCOL                                     
         AIF   (T'&SKIPCOLS EQ 'O').LKX062                                      
         DC    AL1(&SKIPCOLS)                                                   
         AGO   .LKX08                                                           
.*                                                                              
.LKX062  ANOP  ,                                                                
         DC    X'00'                                                            
.*                                 LX_CIND1                                     
.LKX08   ANOP  ,                                                                
         AIF   (T'&PARM1 EQ 'O').ERROR1                                         
.*                                                                              
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&PARM3 EQ 'O').LKX14                                          
         AIF   (K'&PARM3(1) NE 1).LKX14                                         
         AIF   ('&PARM3(1)'(1,1) EQ 'R' OR                             +        
                '&PARM3(1)'(1,1) EQ 'U').LKX10                                  
         AGO   .LKX14                                                           
.*                                                                              
.LKX10   ANOP  ,                                                                
         AIF   (N'&PARM3 LT 2).LKX14                                            
&I2      SETC  '1'                 LX_CIRTN                                     
.*                                                                              
.LKX14   ANOP  ,                                                                
         AIF   (T'&LEN EQ 'O').LKX16                                            
         AIF   ('&LEN'(1,1) NE 'V').LKX16                                       
&I4      SETC  '1'                 LX_CIVAR                                     
.*                                                                              
.LKX16   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
.*                                                                              
         AIF   (T'&PARM2(2) EQ 'O').LKX18                                       
         AIF   ('&PARM2(2)'(1,1) EQ '*').LKX18                                  
         AIF   ('&PARM2(1)'(1,1) EQ 'A').LKX18                                  
&STRING  SETC  'AL1(B''&INDS'.'''+'.'&PARM2(2)'.')'                             
         DC    &STRING                                                          
         AGO   .LKX20                                                           
.*                                                                              
.LKX18   ANOP  ,                                                                
         DC    B'&INDS'                                                         
.*                                                                              
.LKX20   ANOP  ,                                                                
.*                                 LX_CIND2                                     
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (N'&PARM2 EQ 1).LKX22                                            
         AIF   ('&PARM2(1)'(1,1) NE 'A').LKX22                                  
&I1      SETC  '1'                 LX_CIARR                                     
.*                                                                              
.LKX22   ANOP  ,                                                                
         AIF   (T'&FILTROUT EQ 'O').LKX24                                       
&I5      SETC  '1'                 LX_CFTRQ                                     
.*                                                                              
.LKX24   ANOP  ,                                                                
         AIF   (T'&SENDONERROR EQ 'O').LKX28                                    
         AIF   ('&SENDONERROR'(1,1) NE 'Y').LKX28                               
&I6      SETC  '1'                 LX_CSDEQ                                     
.*                                 LX_CIND3                                     
.LKX28   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
         DC    B'&INDS'                                                         
.*                                                                              
&I1      SETC  '0'                                                              
&I2      SETC  '0'                                                              
&I3      SETC  '0'                                                              
&I4      SETC  '0'                                                              
&I5      SETC  '0'                                                              
&I6      SETC  '0'                                                              
&I7      SETC  '0'                                                              
&I8      SETC  '0'                                                              
.*                                                                              
         AIF   (T'&NULLDATA EQ 'O').LKX30                                       
         AIF   ('&NULLDATA'(1,1) NE 'Y').LKX32                                  
&I1      SETC  '1'                 LX_IXNUQ                                     
         AGO   .LKX32                                                           
.*                                                                              
.LKX30   ANOP  ,                                                                
         AIF   (T'&ND EQ 'O').LKX32                                             
         AIF   ('&ND'(1,1) NE 'Y').LKX32                                        
&I1      SETC  '1'                 LX_IXNUQ                                     
.*                                                                              
.LKX32   ANOP  ,                                                                
         AIF   (T'&OLIST EQ 'O').LKX36                                          
         AIF   ('&OLIST'(1,1) NE 'Y').LKX34                                     
&I2      SETC  '1'                 LX_ISTRQ                                     
         AGO   .LKX36                                                           
.*                                                                              
.LKX34   ANOP  ,                                                                
         AIF   ('&OLIST'(1,1) NE 'C').ERROR8                                    
&I3      SETC  '1'                 LX_OSTRQ                                     
.*                                                                              
.LKX36   ANOP  ,                                                                
         AIF   (T'&PZERO EQ 'O').LKX40                                          
         AIF   ('&PZERO'(1,1) NE 'S').ERROR10                                   
&I5      SETC  '1'                  LX_IXZEQ                                    
.*                                                                              
.LKX40   ANOP  ,                                                                
         AIF   (T'&CCLOW EQ 'O').LKX42                                          
         AIF   ('&CCLOW'(1,3) NE 'NOS').ERROR11                                 
&I6      SETC  '1'                 LX_IXRLQ                                     
.*                                                                              
.LKX42   ANOP  ,                                                                
&INDS    SETC  '&I1'.'&I2'.'&I3'.'&I4'.'&I5'.'&I6'.'&I7'.'&I8'                  
.*                                                                              
         AIF   (K'&PARM3(1) NE 1).LKX44                                         
         AIF   ('&PARM3(1)'(1,1) NE 'U').LKX44                                  
         AIF   (N'&PARM3 NE 3).ERROR6                                           
&STRING  SETC  'AL1(B''&INDS'.'''+'.'&PARM3(3)'.')'                             
         DC    &STRING                                                          
         AGO   .LKX46                                                           
.*                                                                              
.LKX44   ANOP  ,                                                                
         DC    B'&INDS'                                                         
.*                                 LX_CDDSP                                     
.LKX46   ANOP  ,                                                                
         AIF   (N'&PARM2 NE 1).LKX462                                           
         DC    AL2(&PARM2-&CURRENT_ROW_NAME)                                    
         AGO   .LKX56                                                           
.*                                                                              
.LKX462  ANOP  ,                                                                
         AIF   ('&PARM2(1)'(1,1) NE 'I' AND                            +        
                '&PARM2(1)'(1,1) NE 'D').LKX48                                  
         AIF   (T'&PARM2(2) EQ 'O').LKX54                                       
         AIF   ('&PARM2(2)'(1,1) EQ '*').LKX54                                  
         AIF   (N'&PARM2 NE 3).ERROR14                                          
         LKBLK &PARM2(2)                                                        
         DC    AL2(&PARM2(3)-&BLOCK_LABEL)                                      
         AGO   .LKX56                                                           
.*                                                                              
.LKX48   ANOP  ,                                                                
         AIF   ('&PARM2(1)'(1,1) NE 'A').LKX50                                  
         AIF   (N'&PARM2 NE 2).ERROR14                                          
         DC    AL2(0)                                                           
         AGO   .LKX58                                                           
.*                                                                              
.LKX50   ANOP  ,                                                                
         AIF   (T'&PARM3 EQ 'O').ERROR15                                        
         AIF   (K'&PARM3(1) NE 1).LKX54                                         
         AIF   ('&PARM3(1)'(1,1) NE 'R').LKX52                                  
         AIF   (N'&PARM3 NE 2).ERROR32                                          
         AIF   (&SERVER_BIG).LKX50A                                             
         DC    AL2(&PARM3(2)-&SERVER_NAME)                                      
         AGO   .LKX56                                                           
.*                                                                              
.LKX50A  ANOP  ,                                                                
         DC    AL2((&PARM3(2)-&SERVER_NAME)/2)                                  
         AGO   .LKX56                                                           
.*                                                                              
.LKX52   ANOP  ,                                                                
         AIF   (K'&PARM3(1) NE 1).ERROR13                                       
         AIF   ('&PARM3(1)'(1,1) NE 'U').ERROR13                                
         AIF   (N'&PARM2 NE 3).ERROR14                                          
         DC    AL2(0)                                                           
         AGO   .LKX56                                                           
.*                                                                              
.LKX54   ANOP  ,                                                                
         AIF   (T'&PARM2(3) EQ 'O').ERROR6                                      
         DC    AL2(&PARM2(3)-&CURRENT_ROW_NAME)                                 
.*                                 LX_CDLEN                                     
.LKX56   ANOP  ,                                                                
         AIF   (T'&LEN EQ 'O').LKX58                                            
         AIF   ('&LEN'(1,1) EQ 'V').LKX602                                      
         DC    AL1(&LEN)                                                        
         AGO   .LKX62                                                           
.*                                                                              
.LKX58   ANOP  ,                                                                
         AIF   (N'&PARM2 NE 3).LKX60                                            
         AIF   ('&PARM2(1)'(1,1) NE 'D').LKX60                                  
         DC    AL1(L'&PARM2(3))                                                 
         AGO   .LKX62                                                           
.*                                                                              
.LKX60   ANOP  ,                                                                
         AIF   (N'&PARM2 NE 1).LKX602                                           
         DC    AL1(L'&PARM2)                                                    
         AGO   .LKX62                                                           
.*                                                                              
.LKX602  ANOP  ,                                                                
         DC    AL1(0)                                                           
.*                                 LX_CFADR                                     
.LKX62   ANOP  ,                                                                
         AIF   (T'&FILTROUT EQ 'O').LKX64                                       
         AIF   (&SERVER_BIG).LKX62A                                             
         DC    AL2(&FILTROUT-&SERVER_NAME)                                      
         AGO   .LKX70                                                           
.*                                                                              
.LKX62A  ANOP  ,                                                                
         DC    AL2((&FILTROUT-&SERVER_NAME)/2)                                  
         AGO   .LKX70                                                           
.*                                                                              
.LKX64   ANOP  ,                                                                
         AIF   (T'&ROWID EQ 'O').LKX68                                          
         AIF   (N'&ROWID NE 1).LKX66                                            
         DC    AL1(0)                                                           
         DC    AL1(&ROWID)                                                      
         AGO   .LKX70                                                           
.*                                                                              
.LKX66   ANOP  ,                                                                
         AIF   (N'&ROWID NE 2).ERROR27                                          
         DC    AL1(&ROWID(1)-&CURRENT_ROW_NAME)                                 
         DC    AL1(&ROWID(2))                                                   
         AGO   .LKX70                                                           
.*                                                                              
.LKX68   ANOP  ,                                                                
         DC    AL2(0)                                                           
.*                                                                              
.LKX70   ANOP  ,                   LX_CADDR                                     
         AIF   (N'&PARM2 NE 2).LKX72                                            
         AIF   ('&PARM2(1)'(1,1) NE 'A').LKX72                                  
         LKARY A,&CURRENT_TABLE_NAME,&PARM2(2)                                  
         AIF   (&SERVER_BIG).LKX70A                                             
         DC    AL2(&PARM2(2)-&SERVER_NAME)                                      
         AGO   .LKX80                                                           
.*                                                                              
.LKX70A  ANOP  ,                                                                
         DC    AL2((&PARM2(2)-&SERVER_NAME)/2)                                  
         AGO   .LKX80                                                           
.*                                                                              
.LKX72   ANOP  ,                                                                
         AIF   (T'&PARM3 EQ 'O').ERROR15                                        
         AIF   (K'&PARM3(1) NE 1).LKX76                                         
         AIF   ('&PARM3(1)'(1,1) NE 'R').LKX74                                  
         AIF   (N'&PARM3 NE 2).ERROR32                                          
         AIF   (&SERVER_BIG).LKX72A                                             
         DC    AL2(&PARM3(2)-&SERVER_NAME)                                      
         AGO   .LKX80                                                           
.*                                                                              
.LKX72A  ANOP  ,                                                                
         DC    AL2((&PARM3(2)-&SERVER_NAME)/2)                                  
         AGO   .LKX80                                                           
.*                                 LX_CENDX                                     
.LKX74   ANOP  ,                                                                
         AIF   (K'&PARM3(1) NE 1).LKX76                                         
         AIF   ('&PARM3(1)'(1,1) NE 'U').LKX76                                  
         DC    AL1(&PARM3(2))                                                   
         AGO   .LKX78                                                           
.*                                 LX_CTYPE                                     
.LKX76   ANOP  ,                                                                
         LKTYP O,&PARM3                                                         
         DC    AL1(&TYPNUM)                                                     
.*                                 LX_COIND                                     
.LKX78   ANOP  ,                                                                
         DC    X'00'                                                            
.*                                 LX_CVRSN                                     
.LKX80   ANOP  ,                                                                
         LKVER &PCVERSION                                                       
*                                                                               
         MEXIT                                                                  
.*                                                                              
.**********************************************************************         
.* PROCESSING ROUTINES                                                *         
.*                                                                    *         
.* FORMAT IS:-                                                        *         
.*                                                                    *         
.*       LKOUT P,(DATA ADDRESS),ROUTINE NAME(,PCVERSION=VERSION)      *         
.**********************************************************************         
.*                                                                              
.LKP     ANOP  ,                                                                
         AIF   (NOT &SERVER_NATIVE).ERROR12                                     
         AIF   (&FIRST_OUTPUT_DEFINITION).ERROR3                                
         AIF   (NOT &TABLE_IS_OPEN).ERROR3                                      
         AIF   (T'&PARM1 NE 'O' AND N'&PARM1 GT 2).ERROR6                       
         AIF   (T'&PARM2 EQ 'O' OR N'&PARM2 NE 1).ERROR15                       
         AIF   (&OARRAY_IS_OPEN).LKPX                                           
.*                                                                              
.LKPO    ANOP  ,                   LO_D                                         
.*                                 LO_CODE                                      
         DC    AL2(0)                                                           
.*                                 LO_IDF                                       
         DC    X'FF'                                                            
.*                                 LO_FADDR                                     
         AIF   (&SERVER_BIG).LKPOA                                              
         DC    AL2(&PARM2-&SERVER_NAME)                                         
         AGO   .LKPOX                                                           
.*                                                                              
.LKPOA   ANOP  ,                                                                
         DC    AL2((&PARM2-&SERVER_NAME)/2)                                     
.*                                                                              
.LKPOX   ANOP  ,                                                                
.*                                 LO_INDS4                                     
         DC    B'00000000'                                                      
.*                                 N/D                                          
         DC    B'00000000'                                                      
.*                                 LO_INDS1                                     
         AIF   (N'&PARM1 NE 2).LKPO002                                          
         DC    AL1(&PARM1(1))                                                   
         AGO   .LKPO004                                                         
.*                                                                              
.LKPO002 ANOP  ,                                                                
         DC    B'00000000'                                                      
.*                                                                              
.LKPO004 ANOP  ,                   LO_INDS2                                     
         DC    B'00000000'                                                      
.*                                 LO_INDS3                                     
         DC    B'00000000'                                                      
.*                                 LO_ADDR                                      
         AIF   (T'&PARM1 EQ 'O').LKPO008                                        
         AIF   (N'&PARM1 EQ 2).LKPO006                                          
         DC    AL2(&PARM1-&CURRENT_ROW_NAME)                                    
         AGO   .LKPO010                                                         
.*                                                                              
.LKPO006 ANOP  ,                                                                
         LKBLK &PARM1(1)                                                        
         DC    AL2(&PARM2(3)-&BLOCK_LABEL)                                      
         AGO   .LKPO010                                                         
.*                                                                              
.LKPO008 ANOP  ,                                                                
         DC    AL2(0)                                                           
.*                                                                              
.LKPO010 ANOP  ,                                                                
.*                                 LO_TYPE                                      
         DC    AL1(255)                                                         
.*                                 LO_DLEN                                      
         DC    AL1(1)                                                           
.*                                 LO_VRSN                                      
         LKVER &PCVERSION                                                       
.*                                                                              
         MEXIT                                                                  
.*                                                                              
.LKPX    ANOP  ,                   LX_COLS                                      
.*                                 LX_CODE                                      
         DC    AL2(0)                                                           
.*                                 LX_IDF                                       
         DC    X'FF'                                                            
.*                                 LX_CMMOD                                     
         AIF   (&SERVER_BIG).LKPXA                                              
         DC    AL2(&PARM2-&SERVER_NAME)                                         
         AGO   .LKPXX                                                           
.*                                                                              
.LKPXA   ANOP  ,                                                                
         DC    AL2((&PARM2-&SERVER_NAME)/2)                                     
.*                                                                              
.LKPXX   ANOP  ,                                                                
.*                                 LX_CIND4                                     
         DC    B'00000000'                                                      
.*                                 LX_CSCOL                                     
         DC    AL1(0)                                                           
.*                                 LX_CIND1                                     
         AIF   (N'&PARM1 NE 2).LKPX002                                          
         DC    AL1(&PARM1(1))                                                   
         AGO   .LKPX004                                                         
.*                                                                              
.LKPX002 ANOP  ,                                                                
         DC    B'00000000'                                                      
.*                                 LX_CIND2                                     
.LKPX004 ANOP  ,                                                                
         DC    B'00000000'                                                      
.*                                 LX_CIND3                                     
         DC    B'00000000'                                                      
.*                                 LX_CDDSP                                     
         AIF   (T'&PARM1 EQ 'O').LKPX008                                        
         AIF   (N'&PARM1 NE 2).LKPX006                                          
         LKBLK &PARM1(1)                                                        
         DC    AL2(&PARM1(2)-&BLOCK_LABEL)                                      
         AGO   .LKPX010                                                         
.*                                                                              
.LKPX006 ANOP  ,                                                                
         DC    AL2(&PARM1-&CURRENT_ROW_NAME)                                    
         AGO   .LKPX010                                                         
.*                                                                              
.LKPX008 ANOP  ,                                                                
         DC    AL2(0)                                                           
.*                                                                              
.LKPX010 ANOP  ,                                                                
.*                                 LX_CDLEN                                     
         DC    AL1(1)                                                           
.*                                 LX_CFADR                                     
         DC    AL2(0)                                                           
.*                                 LX_CTYPE                                     
         DC    AL1(255)                                                         
.*                                 LX_COIND                                     
         DC    B'00000000'                                                      
.*                                 LX_CVRSN                                     
         LKVER &PCVERSION                                                       
.*                                                                              
         MEXIT                                                                  
.*                                                                              
.**********************************************************************         
.* TABLE END - FORMAT IS:-                                            *         
.*                                                                    *         
.*       LKOUT E                                                      *         
.*                                                                    *         
.* GENERATES:-                                                        *         
.*                                                                    *         
.* LABEL DS    0X                        FOR PRIME OUTPUT TABLE       *         
.*                                                                    *         
.* LABEL EQU   (*-FIRSTCOLUMN)/LX_COLSL  FOR ARRAYS                   *         
.**********************************************************************         
.*                                                                              
.LKE     ANOP  ,                                                                
         AIF   (&OARRAY_IS_OPEN).LKE10                                          
         AIF   ('&CURRENT_RECORD_NAME'(1,1) NE ' ').LKE02                       
         MEXIT                                                                  
.*                                                                              
.LKE02   ANOP  ,                                                                
&STRING  SETC  '&CURRENT_RECORD_NAME'.'X'                                       
&STRING  DS    0X                                                               
*                                                                               
         MEXIT                                                                  
.*                                                                              
.LKE10   ANOP  ,                                                                
&OARRAY_IS_OPEN                    SETB  0                                      
*                                                                               
&STRING  SETC  '&CURRENT_TABLE_NAME'.'#'                                        
&STRING2 SETC  '&CURRENT_TABLE_NAME'.'$'                                        
&STRING  EQU   (*-&STRING2)/LX_COLSL                                            
.*                                                                              
.LKEND   ANOP  ,                                                                
*                                                                               
&STRING  SETC  '&CURRENT_TABLE_NAME'.'X'                                        
&STRING  DS    0X                                                               
&TABLE_IS_OPEN                     SETB  0                                      
         MEXIT                                                                  
.*                                                                              
.ERROR1  ANOP  ,                                                                
         MNOTE 12,'Type parameter missing'                                      
         MEXIT                                                                  
.*                                                                              
.ERROR2  ANOP  ,                                                                
         MNOTE 12,'Type parameter invalid - S,B,H,R,A,C,E OR X'                 
         MEXIT                                                                  
.*                                                                              
.ERROR3  ANOP  ,                                                                
         MNOTE 12,'Statement out of sequence'                                   
         MEXIT                                                                  
.*                                                                              
.ERROR4  ANOP  ,                                                                
         MNOTE 12,'Label missing or invalid'                                    
         MEXIT                                                                  
.*                                                                              
.ERROR5  ANOP  ,                                                                
         MNOTE 12,'Mapcode parameter missing or invalid (for type P)'           
         MEXIT                                                                  
.*                                                                              
.ERROR6  ANOP  ,                                                                
         MNOTE 12,'Input parameter missing or invalid'                          
         MEXIT                                                                  
.*                                                                              
.ERROR7  ANOP  ,                                                                
         MNOTE 12,'NULLDATA= and ND= are synonymous'                            
         MEXIT                                                                  
.*                                                                              
.ERROR8  ANOP  ,                                                                
         MNOTE 12,'OLIST= parameter invalid - S/B Y or C'                       
         MEXIT                                                                  
.*                                                                              
.ERROR9  ANOP  ,                                                                
         MNOTE 12,'SETEL= parameter invalid - S/B Y'                            
         MEXIT                                                                  
.*                                                                              
.ERROR10 ANOP  ,                                                                
         MNOTE 12,'PZERO= parameter invalid - S/B S'                            
         MEXIT                                                                  
.*                                                                              
.ERROR11 ANOP  ,                                                                
         MNOTE 12,'CCLOW= parameter invalid - S/B NOS(END)'                     
         MEXIT                                                                  
.*                                                                              
.ERROR12 ANOP  ,                                                                
         MNOTE 12,'Invalid server type S/B D or U'                              
         MEXIT                                                                  
.*                                                                              
.ERROR13 ANOP  ,                                                                
         MNOTE 12,'Invalid input data type S/B I,D,R,A or U'                    
         MEXIT                                                                  
.*                                                                              
.ERROR14 ANOP  ,                                                                
         MNOTE 12,'Invalid number of input parameters'                          
         MEXIT                                                                  
.*                                                                              
.ERROR15 ANOP  ,                                                                
         MNOTE 12,'Type parameter missing or invalid'                           
         MEXIT                                                                  
.*                                                                              
.ERROR16 ANOP  ,                                                                
         MNOTE 12,'Array type missing or invalid'                               
         MEXIT                                                                  
.*                                                                              
.ERROR17 ANOP  ,                                                                
         MNOTE 12,'MULTIROW= and NEWEL= cannot both be specified'               
         MEXIT                                                                  
.*                                                                              
.ERROR18 ANOP  ,                                                                
         MNOTE 12,'SEQUENCE= parameter invalid S/B C'                           
         MEXIT                                                                  
.*                                                                              
.ERROR19 ANOP  ,                                                                
         MNOTE 12,'SEQUENCE= keyword invalid if MULTIROW= specified'            
         MEXIT                                                                  
.*                                                                              
.ERROR20 ANOP  ,                                                                
         MNOTE 12,'EOT= keyword cannot be specified if MULTIROW= is'            
         MEXIT                                                                  
.*                                                                              
.ERROR21 ANOP  ,                                                                
         MNOTE 12,'NROWS= keyword cannot be specified if EOT= is'               
         MEXIT                                                                  
.*                                                                              
.ERROR22 ANOP  ,                                                                
         MNOTE 12,'ROWWIDTH= value must be 1 or 2'                              
         MEXIT                                                                  
.*                                                                              
.ERROR23 ANOP  ,                                                                
         MNOTE 12,'SENDONCE= parameter invalid S/B Y'                           
         MEXIT                                                                  
.*                                                                              
.ERROR24 ANOP  ,                                                                
         MNOTE 12,'NROWS= parameter invalid'                                    
         MEXIT                                                                  
.*                                                                              
.ERROR25 ANOP  ,                                                                
         MNOTE 12,'EOT= parameter invalid'                                      
         MEXIT                                                                  
.*                                                                              
.ERROR26 ANOP  ,                                                                
         MNOTE 12,'ROWID= and FILTROUT= cannot both be specified'               
         MEXIT                                                                  
.*                                                                              
.ERROR27 ANOP  ,                                                                
         MNOTE 12,'ROWID= parameter invalid'                                    
         MEXIT                                                                  
.*                                                                              
.ERROR28 ANOP  ,                                                                
         MNOTE 12,'SETFILT= parameter invalid'                                  
         MEXIT                                                                  
.*                                                                              
.ERROR29 ANOP  ,                                                                
         MNOTE 12,'ROWID= parameter missing'                                    
         MEXIT                                                                  
.*                                                                              
.ERROR30 ANOP  ,                                                                
         MNOTE 12,'TESTFILT= parameter missing'                                 
         MEXIT                                                                  
.*                                                                              
.ERROR31 ANOP  ,                                                                
         MNOTE 12,'Invalid MULTIROW= parameter S/B Y'                           
         MEXIT                                                                  
.*                                                                              
.ERROR32 ANOP  ,                                                                
         MNOTE 12,'Type parameter invalid'                                      
         MEXIT                                                                  
.*                                                                              
.ERROR33 ANOP  ,                                                                
         MNOTE 12,'Cannot specify MAPMOD and/or MAPMOD1 and/or MAPMOD2'         
         MEXIT                                                                  
.*                                                                              
.ERROR34 ANOP  ,                                                                
         MNOTE 12,'MAPMOD=* is the only expression supported'                   
         MEXIT                                                                  
.*                                                                              
.ERROR35 ANOP  ,                                                                
         MNOTE 12,'ROWNAME= must be specified if using parent row'              
         MEXIT                                                                  
.*                                                                              
.ERROR36 ANOP  ,                                                                
         MNOTE 12,'NROWS=* not valid if not a child row'                        
         MEXIT                                                                  
.*                                                                              
         MEND                                                                   
