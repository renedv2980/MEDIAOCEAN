*          DATA SET TALNKMUS   AT LEVEL 001 AS OF 04/12/12                      
***********************************************************************         
*        ROUTINE SAVES HIGHEST CAST SEQEUNCE NUMBER FOR COMMERCIAL    *         
*        ON ENTRY ... P1 = A(COMMERCIAL RECORD)                       *         
***********************************************************************         
                                                                                
SVNXTSEQ NTR1  BASE=*,LABEL=*                                                   
         USING TANUD,R4                                                         
         L     R4,0(R1)                                                         
         GOTOR (#GETELEM,AGETELEM),DMCB,('TANUELQ',(R4)),('TANUTSEQ',0)         
         JE    *+6                                                              
         DC    H'00'                                                            
         L     R4,AELEM                                                         
         MVC   SVNUNXTC,TANUNXTC   SAVE NEXT CAST SEQUENCE NUMBER               
         J     XIT                                                              
         DROP  R4                                                               
                                                                                
***********************************************************************         
*        LITERALS FOR SVNXTSEQ ROUTINE                                *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        VALIDATE PASSED AFM CONTRACT/TRACKS                          *         
*        ON ENTRY ... R3=A(IOKEY)                                     *         
***********************************************************************         
                                                                                
VALAFM   NTR1  BASE=*,LABEL=*                                                   
         MVI   ITTAB,X'FF'         INITIALIZE INPUT TRACK TABLE                 
                                                                                
         CLI   RQCOTYP,CTYMUS      IF COMMERCIAL TYPE IS MUSIC                  
         JNE   VAFM10                                                           
         BAS   RE,VACM             VALIDATE TRACK FOR AFM CONTRACT              
         J     XIT                                                              
                                                                                
VAFM10   GOTO1 VAC,DMCB,RQCOA1T,RQCOA1O,ERCOA1NF,ERCOT1NF,ERCOT1NM,    +        
               ERCOA1NM                                                         
         GOTO1 (RF),(R1),RQCOA2T,RQCOA2O,ERCOA2NF,ERCOT2NF,ERCOT2NM,   +        
               ERCOA2NM                                                         
         GOTO1 (RF),(R1),RQCOA3T,RQCOA3O,ERCOA3NF,ERCOT3NF,ERCOT3NM,   +        
               ERCOA3NM                                                         
         GOTO1 (RF),(R1),RQCOA4T,RQCOA4O,ERCOA4NF,ERCOT4NF,ERCOT4NM,   +        
               ERCOA4NM                                                         
         GOTO1 (RF),(R1),RQCOA5T,RQCOA5O,ERCOA5NF,ERCOT5NF,ERCOT5NM,   +        
               ERCOA5NM                                                         
         GOTO1 (RF),(R1),RQCOA6T,RQCOA6O,ERCOA6NF,ERCOT6NF,ERCOT6NM,   +        
               ERCOA6NM                                                         
         GOTO1 (RF),(R1),RQCOA7T,RQCOA7O,ERCOA7NF,ERCOT7NF,ERCOT7NM,   +        
               ERCOA7NM                                                         
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE VALIDATES TRACK FOR AFM CONTRACTS                    *         
***********************************************************************         
                                                                                
VACM     NTR1                                                                   
         DC    H'00'               NOT YET SUPPORTED                            
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE VALIDATES AFM CONTRACT/TRACK FOR COMMERCIALS         *         
*        ON ENTRY ... P1=A(TRACK LETTER)                              *         
*                     P2=A(AFM CONTRACT INTERNAL COMMERCIAL NUMBER)   *         
*                     P3=A(AFM CONTRACT NOT FOUND ERROR)              *         
*                     P4=A(TRACK NOT FOUND ERROR)                     *         
*                     P5=A(NO MUSICIANS ON TRACK ERROR)               *         
*                     P6=A(AFM CONTRACT DOES NOT MATCH COM ID ERROR)  *         
***********************************************************************         
                                                                                
VAC      NTR1                                                                   
         L     R2,0(R1)            R2=A(TRACK FIELD)                            
         CLI   0(R2),0             IF TRACK IS PROVIDED                         
         JE    XIT                                                              
                                                                                
         L     R5,4(R1)            R5=A(AFM CONTRACT INT COM NUM)               
         MVC   FULL1,8(R1)         FULL1=A(AFM CONTRACT NOT FOUND ERR)          
         L     R6,12(R1)           R6=A(TRACK NOT FOUND ERROR)                  
         L     R0,16(R1)           R0=A(NO MUSICIANS ON TRACK ERROR)            
         MVC   FULL2,20(R1)        FULL2=A(AFM CONT NO MATCH ID ERR)            
                                                                                
         USING TLCOPD,R3                                                        
         XC    TLCOPKEY,TLCOPKEY   ENSURE THAT AFM CONTRACT EXISTS              
         MVI   TLCOPCD,TLCOCCDQ                                                 
         MVC   TLCOCCOM,0(R5)                                                   
         GOTOR (#IOEXEC,AIOEXEC),'IORD+IODIR+IO3'                               
         JE    VAC10                                                            
         L     RF,FULL1                                                         
         GOTOR (#ADDERR,AADDERR),DMCB,0(RF)                                     
         J     XIT                                                              
         DROP  R3                                                               
                                                                                
VAC10    GOTOR (#IOEXEC,AIOEXEC),'IOGET+IOFIL+IO3'                              
                                                                                
         USING TACOD,R4                                                         
         L     R4,AIO3                                                          
         MVI   ELCODE,TACOELQ                                                   
         BRAS  RE,GETEL                                                         
         JE    *+6                                                              
         DC    H'00'                                                            
         CLI   TACOTYPE,CTYMUS                                                  
         JE    VAC20                                                            
         L     RF,FULL1                                                         
         GOTOR (#ADDERR,AADDERR),DMCB,0(RF)                                     
         J     XIT                                                              
         DROP  R4                                                               
                                                                                
         USING TAMCD,R4                                                         
VAC20    L     R4,AIO3                                                          
         MVI   ELCODE,TAMCELQ      ENSURE THAT TRACK EXISTS ON                  
         BRAS  RE,GETEL            AFM CONTRACT                                 
         JE    *+8                                                              
VAC30    BRAS  RE,NEXTEL                                                        
         JNE   VAC40                                                            
         CLC   TAMCTRK,0(R2)                                                    
         JE    VAC50                                                            
         J     VAC30                                                            
VAC40    GOTOR (#ADDERR,AADDERR),DMCB,0(R6)                                     
         J     XIT                                                              
                                                                                
VAC50    OC    TAMCCON,TAMCCON     ENSURE THAT AFM CONTRACT# MATCHES            
         JZ    VAC60               COMMERCIAL ID                                
         L     RF,FULL2                                                         
         GOTOR (#ADDERR,AADDERR),DMCB,0(RF)                                     
         DROP  R4                                                               
                                                                                
         USING TLCAD,R3                                                         
VAC60    XC    TLCAKEY,TLCAKEY     ENSURE THAT MUSICIAN IS ASSOCIATED           
         MVI   TLCACD,TLCACDQ      TO TRACK                                     
         MVC   TLCACOM,0(R5)                                                    
         OI    TLCASORT,X'80'                                                   
         GOTOR (#IOEXEC,AIOEXEC),'IOHI+IODIR+IO3'                               
         J     VAC80                                                            
VAC70    GOTOR (#IOEXEC,AIOEXEC),'IOSQ+IODIR+IO3'                               
VAC80    CLC   IOKEY(TLCASORT-TLCAD),IOKEYSAV                                   
         JE    VAC90                                                            
         LR    R6,R0                                                            
         GOTOR (#ADDERR,AADDERR),DMCB,0(R6)                                     
         J     XIT                                                              
VAC90    GOTOR (#IOEXEC,AIOEXEC),'IOGET+IOFIL+IO3'                              
         GOTOR ONTRK,DMCB,0(R2),AIO3                                            
         JNE   VAC70                                                            
         DROP  R3                                                               
                                                                                
         USING TLISTD,R1                                                        
         LA    R1,ITTAB                                                         
VAC100   CLI   0(R1),X'FF'                                                      
         JE    VAC110                                                           
         LA    R1,TLLNQ(R1)        ADD AFM CONTRACT INTERNAL                    
         J     VAC100              COMMERCIAL NUMBER AND TRACK                  
VAC110   MVC   TLCOM,0(R5)         TO INPUTTED TRACK TABLE                      
         MVC   TLTRK,0(R2)                                                      
         MVI   TLLNQ(R1),X'FF'                                                  
         J     XIT                                                              
         DROP  R1                                                               
                                                                                
***********************************************************************         
*        LITERALS FOR VALAFM ROUTINE                                  *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ERROR ENTRIES FOR VALAFM                                     *         
*        (LOOK AT ERRENTD FOR DSECT)                                  *         
***********************************************************************         
                                                                                
ERCOA1NF DC    AL1(ECOA1NFX-*),AL2(141),AL1(ERRCATY1),AL1(D#COA1O)              
         DC    C'AFM Contract does not exist'                                   
ECOA1NFX EQU   *                                                                
                                                                                
ERCOA2NF DC    AL1(ECOA2NFX-*),AL2(142),AL1(ERRCATY1),AL1(D#COA2O)              
         DC    C'AFM Contract does not exist'                                   
ECOA2NFX EQU   *                                                                
                                                                                
ERCOA3NF DC    AL1(ECOA3NFX-*),AL2(143),AL1(ERRCATY1),AL1(D#COA3O)              
         DC    C'AFM Contract does not exist'                                   
ECOA3NFX EQU   *                                                                
                                                                                
ERCOA4NF DC    AL1(ECOA4NFX-*),AL2(144),AL1(ERRCATY1),AL1(D#COA4O)              
         DC    C'AFM Contract does not exist'                                   
ECOA4NFX EQU   *                                                                
                                                                                
ERCOA5NF DC    AL1(ECOA5NFX-*),AL2(145),AL1(ERRCATY1),AL1(D#COA5O)              
         DC    C'AFM Contract does not exist'                                   
ECOA5NFX EQU   *                                                                
                                                                                
ERCOA6NF DC    AL1(ECOA6NFX-*),AL2(146),AL1(ERRCATY1),AL1(D#COA6O)              
         DC    C'AFM Contract does not exist'                                   
ECOA6NFX EQU   *                                                                
                                                                                
ERCOA7NF DC    AL1(ECOA7NFX-*),AL2(147),AL1(ERRCATY1),AL1(D#COA7O)              
         DC    C'AFM Contract does not exist'                                   
ECOA7NFX EQU   *                                                                
                                                                                
ERCOT1NF DC    AL1(ECOT1NFX-*),AL2(148),AL1(ERRCATY1),AL1(D#COA1T)              
         DC    C'Track does not exist'                                          
ECOT1NFX EQU   *                                                                
                                                                                
ERCOT2NF DC    AL1(ECOT2NFX-*),AL2(149),AL1(ERRCATY1),AL1(D#COA2T)              
         DC    C'Track does not exist'                                          
ECOT2NFX EQU   *                                                                
                                                                                
ERCOT3NF DC    AL1(ECOT3NFX-*),AL2(150),AL1(ERRCATY1),AL1(D#COA3T)              
         DC    C'Track does not exist'                                          
ECOT3NFX EQU   *                                                                
                                                                                
ERCOT4NF DC    AL1(ECOT4NFX-*),AL2(151),AL1(ERRCATY1),AL1(D#COA4T)              
         DC    C'Track does not exist'                                          
ECOT4NFX EQU   *                                                                
                                                                                
ERCOT5NF DC    AL1(ECOT5NFX-*),AL2(152),AL1(ERRCATY1),AL1(D#COA5T)              
         DC    C'Track does not exist'                                          
ECOT5NFX EQU   *                                                                
                                                                                
ERCOT6NF DC    AL1(ECOT6NFX-*),AL2(153),AL1(ERRCATY1),AL1(D#COA6T)              
         DC    C'Track does not exist'                                          
ECOT6NFX EQU   *                                                                
                                                                                
ERCOT7NF DC    AL1(ECOT7NFX-*),AL2(154),AL1(ERRCATY1),AL1(D#COA7T)              
         DC    C'Track does not exist'                                          
ECOT7NFX EQU   *                                                                
                                                                                
ERCOA1NM DC    AL1(ECOA1NMX-*),AL2(165),AL1(ERRCATY1),AL1(D#COA1T)              
         DC    C'AFM Contract does not match Commercial ID'                     
ECOA1NMX EQU   *                                                                
                                                                                
ERCOA2NM DC    AL1(ECOA2NMX-*),AL2(166),AL1(ERRCATY1),AL1(D#COA2T)              
         DC    C'AFM Contract does not match Commercial ID'                     
ECOA2NMX EQU   *                                                                
                                                                                
ERCOA3NM DC    AL1(ECOA3NMX-*),AL2(172),AL1(ERRCATY1),AL1(D#COA3T)              
         DC    C'AFM Contract does not match Commercial ID'                     
ECOA3NMX EQU   *                                                                
                                                                                
ERCOA4NM DC    AL1(ECOA4NMX-*),AL2(173),AL1(ERRCATY1),AL1(D#COA4T)              
         DC    C'AFM Contract does not match Commercial ID'                     
ECOA4NMX EQU   *                                                                
                                                                                
ERCOA5NM DC    AL1(ECOA5NMX-*),AL2(179),AL1(ERRCATY1),AL1(D#COA5T)              
         DC    C'AFM Contract does not match Commercial ID'                     
ECOA5NMX EQU   *                                                                
                                                                                
ERCOA6NM DC    AL1(ECOA6NMX-*),AL2(180),AL1(ERRCATY1),AL1(D#COA6T)              
         DC    C'AFM Contract does not match Commercial ID'                     
ECOA6NMX EQU   *                                                                
                                                                                
ERCOA7NM DC    AL1(ECOA7NMX-*),AL2(225),AL1(ERRCATY1),AL1(D#COA7T)              
         DC    C'AFM Contract does not match Commercial ID'                     
ECOA7NMX EQU   *                                                                
                                                                                
ERCOT1NM DC    AL1(ECOT1NMX-*),AL2(155),AL1(ERRCATY1),AL1(D#COA1T)              
         DC    C'Track does not have any associated musicians'                  
ECOT1NMX EQU   *                                                                
                                                                                
ERCOT2NM DC    AL1(ECOT2NMX-*),AL2(156),AL1(ERRCATY1),AL1(D#COA2T)              
         DC    C'Track does not have any associated musicians'                  
ECOT2NMX EQU   *                                                                
                                                                                
ERCOT3NM DC    AL1(ECOT3NMX-*),AL2(157),AL1(ERRCATY1),AL1(D#COA3T)              
         DC    C'Track does not have any associated musicians'                  
ECOT3NMX EQU   *                                                                
                                                                                
ERCOT4NM DC    AL1(ECOT4NMX-*),AL2(158),AL1(ERRCATY1),AL1(D#COA4T)              
         DC    C'Track does not have any associated musicians'                  
ECOT4NMX EQU   *                                                                
                                                                                
ERCOT5NM DC    AL1(ECOT5NMX-*),AL2(159),AL1(ERRCATY1),AL1(D#COA5T)              
         DC    C'Track does not have any associated musicians'                  
ECOT5NMX EQU   *                                                                
                                                                                
ERCOT6NM DC    AL1(ECOT6NMX-*),AL2(160),AL1(ERRCATY1),AL1(D#COA6T)              
         DC    C'Track does not have any associated musicians'                  
ECOT6NMX EQU   *                                                                
                                                                                
ERCOT7NM DC    AL1(ECOT7NMX-*),AL2(161),AL1(ERRCATY1),AL1(D#COA7T)              
         DC    C'Track does not have any associated musicians'                  
ECOT7NMX EQU   *                                                                
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT ELEMENT INTO REQUEST MAP       *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT DETAILS ELEMENT)          *         
***********************************************************************         
                                                                                
         USING TAMCD,R4                                                         
CPYTAMC  NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,CPY1TAMC                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TAMCELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY2TAMC                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TAMCELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY3TAMC                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TAMCELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY4TAMC                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TAMCELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY5TAMC                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TAMCELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY6TAMC                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TAMCELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY7TAMC                                                      
         J     XIT                                                              
         DROP  R4                                                               
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT DETAILS ELEMENT DID NOT EXIST ON RECORD    *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEWTAMC  NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,NEW1TAMC                                                      
         BRAS  RE,NEW2TAMC                                                      
         BRAS  RE,NEW3TAMC                                                      
         BRAS  RE,NEW4TAMC                                                      
         BRAS  RE,NEW5TAMC                                                      
         BRAS  RE,NEW6TAMC                                                      
         BRAS  RE,NEW7TAMC                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT/TRACK ELEMENT INTO REQUEST MAP *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK ELEMENT)            *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
CPYTATR  NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,CPY1TATR                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TATRELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY2TATR                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TATRELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY3TATR                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TATRELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY4TATR                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TATRELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY5TATR                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TATRELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY6TATR                                                      
                                                                                
         ZIC   R0,1(R4)                                                         
         AR    R4,R0                                                            
         CLI   0(R4),TATRELQ                                                    
         JNE   XIT                                                              
         BRAS  RE,CPY7TATR                                                      
         J     XIT                                                              
         DROP  R4                                                               
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT/TRACK ELEMENT DID NOT EXIST ON RECORD      *         
*        PREVIOUSLY AND MUSIC CONTRACT/TRACK ARE BEING ADDED NOW      *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEWTATR  NTR1  BASE=*,LABEL=*                                                   
         BRAS  RE,NEW1TATR                                                      
         BRAS  RE,NEW2TATR                                                      
         BRAS  RE,NEW3TATR                                                      
         BRAS  RE,NEW4TATR                                                      
         BRAS  RE,NEW5TATR                                                      
         BRAS  RE,NEW6TATR                                                      
         BRAS  RE,NEW7TATR                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT ELEMENT 1 INTO REQUEST MAP     *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT DETAILS 1 ELEMENT)        *         
***********************************************************************         
                                                                                
         USING TAMCD,R4                                                         
CPY1TAMC NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA1T,RQCOA1T),TAMCTRK,     +        
               ERCOA1T,0                                                        
         CLI   RQCOA1T,0                                                        
         JE    C1MC10                                                           
         GOTOR (RF),(R1),(L'RQCOA1L,RQCOA1L),TAMCLFT,ERCOA1L,0                  
         GOTOR (RF),(R1),(L'RQCOA1S,RQCOA1S),TAMCLLEN,ERCOA1S,0                 
         GOTOR (RF),(R1),(L'RQCOA1Y,RQCOA1Y),TAMCTYP,ERCOA1Y,0                  
         ZIC   R0,TAMCLEN                                                       
         CHI   R0,TAMCLNQ                                                       
         JNH   C1MC10                                                           
         SHI   R0,TAMCLNQ+1                                                     
         GOTOR (RF),(R1),((R0),RQCOA1I),TAMCTRKT,ERCOA1I,0                      
         DROP  R4                                                               
                                                                                
C1MC10   OI    CPYSTAT2,CPYTAMC1                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT DETAILS ELEMENT DID NOT EXIST ON RECORD    *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW1TAMC NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT2,CPYTAMC1   IF MUSIC CONTRACT 1 ELEMENT DID NOT          
         JO    XIT                 EXIST ON RECORD PREVIOUSLY                   
         OC    RQCOA1O,RQCOA1O     AND AFM CONTRACT INTERNAL COMMERCIAL         
         JNZ   XIT                 NUMBER 1 IS NOT PROVIDED ...                 
                                                                                
         CLI   RQCOA1T,0           IF AFM 1 TRACKS IS BEING ADDED NOW           
         JE    N1MC10              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA1T)                       
                                                                                
N1MC10   CLI   RQCOA1L,0           IF AFM 1 LIFT IS BEING ADDED NOW             
         JE    N1MC20              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA1L)                       
                                                                                
N1MC20   OC    RQCOA1S,RQCOA1S     IF AFM 1 LENGTH IS BEING ADDED NOW           
         JZ    N1MC30              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA1S)                       
                                                                                
N1MC30   OC    RQCOA1I,RQCOA1I     IF AFM 1 TITLE IS BEING ADDED NOW            
         JZ    N1MC40              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA1I)                       
                                                                                
N1MC40   CLI   RQCOA1Y,0           IF AFM 1 MUSIC TYPE IS BEING ADDED           
         JE    XIT                 NOW, RETURN PROMPT FOR VERIFICATION          
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA1Y)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT/TRACK ELEMENT 1 INTO REQUEST   *         
*        MAP                                                          *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK 1 ELEMENT)          *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
CPY1TATR NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA1O,RQCOA1O),TATRCOM,     +        
               ERCOA1O,0                                                        
         OC    RQCOA1O,RQCOA1O                                                  
         JZ    C1TR10                                                           
         GOTOR (RF),(R1),(L'RQCOA1T,RQCOA1T),TATRTRK,ERCOA1T,0                  
         DROP  R4                                                               
                                                                                
C1TR10   GOTOR ADDTTAB,DMCB,OTTAB                                               
                                                                                
         OI    CPYSTAT4,CPYTATR1                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT/TRACK ELEMENT DID NOT EXIST ON RECORD      *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW1TATR NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT4,CPYTATR1                                                
         JO    XIT                                                              
         OC    RQCOA1O,RQCOA1O                                                  
         JZ    XIT                                                              
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA1O)                       
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA1T)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ERROR ENTRIES FOR CPY1TAMC, NEW1TAMC, CPY1TATR AND NEW1TATR  *         
*        (LOOK AT ERRENTD FOR DSECT)                                  *         
***********************************************************************         
                                                                                
ERCOA1T  DC    AL1(ECOA1TX-*),AL2(75),AL1(ERRCATY2),AL1(D#COA1T)                
         DC    C'Review update to AFM Track'                                    
ECOA1TX  EQU   *                                                                
                                                                                
ERCOA1L  DC    AL1(ECOA1LX-*),AL2(76),AL1(ERRCATY2),AL1(D#COA1L)                
         DC    C'Review update to AFM Lift'                                     
ECOA1LX  EQU   *                                                                
                                                                                
ERCOA1S  DC    AL1(ECOA1SX-*),AL2(77),AL1(ERRCATY2),AL1(D#COA1S)                
         DC    C'Review update to AFM Length'                                   
ECOA1SX  EQU   *                                                                
                                                                                
ERCOA1I  DC    AL1(ECOA1IX-*),AL2(80),AL1(ERRCATY2),AL1(D#COA1I)                
         DC    C'Review update to AFM Track Title'                              
ECOA1IX  EQU   *                                                                
                                                                                
ERCOA1Y  DC    AL1(ECOA1YX-*),AL2(81),AL1(ERRCATY2),AL1(D#COA1Y)                
         DC    C'Review update to AFM Music Type'                               
ECOA1YX  EQU   *                                                                
                                                                                
ERCOA1O  DC    AL1(ECOA1OX-*),AL2(183),AL1(ERRCATY2),AL1(D#COA1O)               
         DC    C'Review update to AFM Contract'                                 
ECOA1OX  EQU   *                                                                
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT ELEMENT 2 INTO REQUEST MAP     *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT DETAILS 2 ELEMENT)        *         
***********************************************************************         
                                                                                
         USING TAMCD,R4                                                         
CPY2TAMC NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA2T,RQCOA2T),TAMCTRK,     +        
               ERCOA2T,0                                                        
         CLI   RQCOA2T,0                                                        
         JE    C2MC10                                                           
         GOTOR (RF),(R1),(L'RQCOA2L,RQCOA2L),TAMCLFT,ERCOA2L,0                  
         GOTOR (RF),(R1),(L'RQCOA2S,RQCOA2S),TAMCLLEN,ERCOA2S,0                 
         GOTOR (RF),(R1),(L'RQCOA2Y,RQCOA2Y),TAMCTYP,ERCOA2Y,0                  
         ZIC   R0,TAMCLEN                                                       
         CHI   R0,TAMCLNQ                                                       
         JNH   C2MC10                                                           
         SHI   R0,TAMCLNQ+1                                                     
         GOTOR (RF),(R1),((R0),RQCOA2I),TAMCTRKT,ERCOA2I,0                      
         DROP  R4                                                               
                                                                                
C2MC10   OI    CPYSTAT3,CPYTAMC2                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT DETAILS ELEMENT DID NOT EXIST ON RECORD    *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW2TAMC NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT3,CPYTAMC2   IF MUSIC CONTRACT 2 ELEMENT DID NOT          
         JO    XIT                 EXIST ON RECORD PREVIOUSLY                   
         OC    RQCOA2O,RQCOA2O     AND AFM CONTRACT INTERNAL COMMERCIAL         
         JNZ   XIT                 NUMBER 2 IS NOT PROVIDED ...                 
                                                                                
         CLI   RQCOA2T,0           IF AFM 2 TRACK IS BEING ADDED NOW            
         JE    N2MC10              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA2T)                       
                                                                                
N2MC10   CLI   RQCOA2L,0           IF AFM 2 LIFT IS BEING ADDED NOW             
         JE    N2MC20              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA2L)                       
                                                                                
N2MC20   OC    RQCOA2S,RQCOA2S     IF AFM 2 LENGTH IS BEING ADDED NOW           
         JZ    N2MC30              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA2S)                       
                                                                                
N2MC30   OC    RQCOA2I,RQCOA2I     IF AFM 2 TITLE IS BEING ADDED NOW            
         JZ    N2MC40              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA2I)                       
                                                                                
N2MC40   CLI   RQCOA2Y,0           IF AFM 2 MUSIC TYPE IS BEING ADDED           
         JE    XIT                 NOW, RETURN PROMPT FOR VERIFICATION          
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA2Y)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT/TRACK ELEMENT 2 INTO REQUEST   *         
*        MAP                                                          *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK 2 ELEMENT)          *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
CPY2TATR NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA2O,RQCOA2O),TATRCOM,     +        
               ERCOA2O,0                                                        
         OC    RQCOA2O,RQCOA2O                                                  
         JZ    C2TR10                                                           
         GOTOR (RF),(R1),(L'RQCOA2T,RQCOA2T),TATRTRK,ERCOA2T,0                  
         DROP  R4                                                               
                                                                                
C2TR10   GOTOR ADDTTAB,DMCB,OTTAB                                               
                                                                                
         OI    CPYSTAT4,CPYTATR2                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT/TRACK ELEMENT DID NOT EXIST ON RECORD      *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW2TATR NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT4,CPYTATR2                                                
         JO    XIT                                                              
         OC    RQCOA2O,RQCOA2O                                                  
         JZ    XIT                                                              
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA2O)                       
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA2T)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ERROR ENTRIES FOR CPY2TAMC, NEW2TAMC, CPY2TATR AND NEW2TATR  *         
*        (LOOK AT ERRENTD FOR DSECT)                                  *         
***********************************************************************         
                                                                                
ERCOA2T  DC    AL1(ECOA2TX-*),AL2(83),AL1(ERRCATY2),AL1(D#COA2T)                
         DC    C'Review update to AFM Track'                                    
ECOA2TX  EQU   *                                                                
                                                                                
ERCOA2L  DC    AL1(ECOA2LX-*),AL2(84),AL1(ERRCATY2),AL1(D#COA2L)                
         DC    C'Review update to AFM Lift'                                     
ECOA2LX  EQU   *                                                                
                                                                                
ERCOA2S  DC    AL1(ECOA2SX-*),AL2(85),AL1(ERRCATY2),AL1(D#COA2S)                
         DC    C'Review update to AFM Length'                                   
ECOA2SX  EQU   *                                                                
                                                                                
ERCOA2I  DC    AL1(ECOA2IX-*),AL2(88),AL1(ERRCATY2),AL1(D#COA2I)                
         DC    C'Review update to AFM Track Title'                              
ECOA2IX  EQU   *                                                                
                                                                                
ERCOA2Y  DC    AL1(ECOA2YX-*),AL2(89),AL1(ERRCATY2),AL1(D#COA2Y)                
         DC    C'Review update to AFM Music Type'                               
ECOA2YX  EQU   *                                                                
                                                                                
ERCOA2O  DC    AL1(ECOA2OX-*),AL2(184),AL1(ERRCATY2),AL1(D#COA2O)               
         DC    C'Review update to AFM Contract'                                 
ECOA2OX  EQU   *                                                                
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT ELEMENT 3 INTO REQUEST MAP     *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT DETAILS 3 ELEMENT)        *         
***********************************************************************         
                                                                                
         USING TAMCD,R4                                                         
CPY3TAMC NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA3T,RQCOA3T),TAMCTRK,     +        
               ERCOA3T,0                                                        
         CLI   RQCOA3T,0                                                        
         JE    C3MC10                                                           
         GOTOR (RF),(R1),(L'RQCOA3L,RQCOA3L),TAMCLFT,ERCOA3L,0                  
         GOTOR (RF),(R1),(L'RQCOA3S,RQCOA3S),TAMCLLEN,ERCOA3S,0                 
         GOTOR (RF),(R1),(L'RQCOA3Y,RQCOA3Y),TAMCTYP,ERCOA3Y,0                  
         ZIC   R0,TAMCLEN                                                       
         CHI   R0,TAMCLNQ                                                       
         JNH   C3MC10                                                           
         SHI   R0,TAMCLNQ+1                                                     
         GOTOR (RF),(R1),((R0),RQCOA3I),TAMCTRKT,ERCOA3I,0                      
         DROP  R4                                                               
                                                                                
C3MC10   OI    CPYSTAT3,CPYTAMC3                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT DETAILS ELEMENT DID NOT EXIST ON RECORD    *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW3TAMC NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT3,CPYTAMC3   IF MUSIC CONTRACT 3 ELEMENT DID NOT          
         JO    XIT                 EXIST ON RECORD PREVIOUSLY                   
         OC    RQCOA3O,RQCOA3O     AND AFM CONTRACT INTERNAL COMMERCIAL         
         JNZ   XIT                 NUMBER 3 IS NOT PROVIDED ...                 
                                                                                
         CLI   RQCOA3T,0           IF AFM 3 TRACKS IS BEING ADDED NOW           
         JE    N3MC10              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA3T)                       
                                                                                
N3MC10   CLI   RQCOA3L,0           IF AFM 3 LIFT IS BEING ADDED NOW             
         JE    N3MC20              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA3L)                       
                                                                                
N3MC20   OC    RQCOA3S,RQCOA3S     IF AFM 3 LENGTH IS BEING ADDED NOW           
         JZ    N3MC30              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA3S)                       
                                                                                
N3MC30   OC    RQCOA3I,RQCOA3I     IF AFM 3 TITLE IS BEING ADDED NOW            
         JZ    N3MC40              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA3I)                       
                                                                                
N3MC40   CLI   RQCOA3Y,0           IF AFM 3 MUSIC TYPE IS BEING ADDED           
         JE    XIT                 NOW, RETURN PROMPT FOR VERIFICATION          
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA3Y)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT/TRACK ELEMENT 3 INTO REQUEST   *         
*        MAP                                                          *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK 3 ELEMENT)          *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
CPY3TATR NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA3O,RQCOA3O),TATRCOM,     +        
               ERCOA3O,0                                                        
         OC    RQCOA3O,RQCOA3O                                                  
         JZ    C3TR10                                                           
         GOTOR (RF),(R1),(L'RQCOA3T,RQCOA3T),TATRTRK,ERCOA3T,0                  
         DROP  R4                                                               
                                                                                
C3TR10   GOTOR ADDTTAB,DMCB,OTTAB                                               
                                                                                
         OI    CPYSTAT4,CPYTATR3                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT/TRACK ELEMENT DID NOT EXIST ON RECORD      *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW3TATR NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT4,CPYTATR3                                                
         JO    XIT                                                              
         OC    RQCOA3O,RQCOA3O                                                  
         JZ    XIT                                                              
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA3O)                       
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA3T)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ERROR ENTRIES FOR CPY3TAMC, NEW3TAMC, CPY3TATR AND NEW3TATR  *         
*        (LOOK AT ERRENTD FOR DSECT)                                  *         
***********************************************************************         
                                                                                
ERCOA3T  DC    AL1(ECOA3TX-*),AL2(91),AL1(ERRCATY2),AL1(D#COA3T)                
         DC    C'Review update to AFM Track'                                    
ECOA3TX  EQU   *                                                                
                                                                                
ERCOA3L  DC    AL1(ECOA3LX-*),AL2(92),AL1(ERRCATY2),AL1(D#COA3L)                
         DC    C'Review update to AFM Lift'                                     
ECOA3LX  EQU   *                                                                
                                                                                
ERCOA3S  DC    AL1(ECOA3SX-*),AL2(93),AL1(ERRCATY2),AL1(D#COA3S)                
         DC    C'Review update to AFM Length'                                   
ECOA3SX  EQU   *                                                                
                                                                                
ERCOA3I  DC    AL1(ECOA3IX-*),AL2(96),AL1(ERRCATY2),AL1(D#COA3I)                
         DC    C'Review update to AFM Track Title'                              
ECOA3IX  EQU   *                                                                
                                                                                
ERCOA3Y  DC    AL1(ECOA3YX-*),AL2(97),AL1(ERRCATY2),AL1(D#COA3Y)                
         DC    C'Review update to AFM Music Type'                               
ECOA3YX  EQU   *                                                                
                                                                                
ERCOA3O  DC    AL1(ECOA3OX-*),AL2(185),AL1(ERRCATY2),AL1(D#COA3O)               
         DC    C'Review update to AFM Contract'                                 
ECOA3OX  EQU   *                                                                
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT ELEMENT 4 INTO REQUEST MAP     *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT DETAILS 4 ELEMENT)        *         
***********************************************************************         
                                                                                
         USING TAMCD,R4                                                         
CPY4TAMC NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA4T,RQCOA4T),TAMCTRK,     +        
               ERCOA4T,0                                                        
         CLI   RQCOA4T,0                                                        
         JE    C4MC10                                                           
         GOTOR (RF),(R1),(L'RQCOA4L,RQCOA4L),TAMCLFT,ERCOA4L,0                  
         GOTOR (RF),(R1),(L'RQCOA4S,RQCOA4S),TAMCLLEN,ERCOA4S,0                 
         GOTOR (RF),(R1),(L'RQCOA4Y,RQCOA4Y),TAMCTYP,ERCOA4Y,0                  
         ZIC   R0,TAMCLEN                                                       
         CHI   R0,TAMCLNQ                                                       
         JNH   C4MC10                                                           
         SHI   R0,TAMCLNQ+1                                                     
         GOTOR (RF),(R1),((R0),RQCOA4I),TAMCTRKT,ERCOA4I,0                      
         DROP  R4                                                               
                                                                                
C4MC10   OI    CPYSTAT3,CPYTAMC4                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT DETAILS ELEMENT DID NOT EXIST ON RECORD    *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW4TAMC NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT3,CPYTAMC4   IF MUSIC CONTRACT 4 ELEMENT DID NOT          
         JO    XIT                 EXIST ON RECORD PREVIOUSLY                   
         OC    RQCOA4O,RQCOA4O     AND AFM CONTRACT INTERNAL COMMERCIAL         
         JNZ   XIT                 NUMBER 4 IS NOT PROVIDED ...                 
                                                                                
         CLI   RQCOA4T,0           IF AFM 4 TRACKS IS BEING ADDED NOW           
         JE    N4MC10              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA4T)                       
                                                                                
N4MC10   CLI   RQCOA4L,0           IF AFM 4 LIFT IS BEING ADDED NOW             
         JE    N4MC20              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA4L)                       
                                                                                
N4MC20   OC    RQCOA4S,RQCOA4S     IF AFM 4 LENGTH IS BEING ADDED NOW           
         JZ    N4MC30              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA4S)                       
                                                                                
N4MC30   OC    RQCOA4I,RQCOA4I     IF AFM 4 TITLE IS BEING ADDED NOW            
         JZ    N4MC40              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA4I)                       
                                                                                
N4MC40   CLI   RQCOA4Y,0           IF AFM 4 MUSIC TYPE IS BEING ADDED           
         JE    XIT                 NOW, RETURN PROMPT FOR VERIFICATION          
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA4Y)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT/TRACK ELEMENT 4 INTO REQUEST   *         
*        MAP                                                          *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK 4 ELEMENT)          *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
CPY4TATR NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA4O,RQCOA4O),TATRCOM,     +        
               ERCOA4O,0                                                        
         OC    RQCOA4O,RQCOA4O                                                  
         JZ    C4TR10                                                           
         GOTOR (RF),(R1),(L'RQCOA4T,RQCOA4T),TATRTRK,ERCOA4T,0                  
         DROP  R4                                                               
                                                                                
C4TR10   GOTOR ADDTTAB,DMCB,OTTAB                                               
                                                                                
         OI    CPYSTAT4,CPYTATR4                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT/TRACK ELEMENT DID NOT EXIST ON RECORD      *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW4TATR NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT4,CPYTATR4                                                
         JO    XIT                                                              
         OC    RQCOA4O,RQCOA4O                                                  
         JZ    XIT                                                              
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA4O)                       
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA4T)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ERROR ENTRIES FOR CPY4TAMC, NEW4TAMC, CPY4TATR AND NEW4TATR  *         
*        (LOOK AT ERRENTD FOR DSECT)                                  *         
***********************************************************************         
                                                                                
ERCOA4T  DC    AL1(ECOA4TX-*),AL2(99),AL1(ERRCATY2),AL1(D#COA4T)                
         DC    C'Review update to AFM Track'                                    
ECOA4TX  EQU   *                                                                
                                                                                
ERCOA4L  DC    AL1(ECOA4LX-*),AL2(100),AL1(ERRCATY2),AL1(D#COA4L)               
         DC    C'Review update to AFM Lift'                                     
ECOA4LX  EQU   *                                                                
                                                                                
ERCOA4S  DC    AL1(ECOA4SX-*),AL2(101),AL1(ERRCATY2),AL1(D#COA4S)               
         DC    C'Review update to AFM Length'                                   
ECOA4SX  EQU   *                                                                
                                                                                
ERCOA4I  DC    AL1(ECOA4IX-*),AL2(104),AL1(ERRCATY2),AL1(D#COA4I)               
         DC    C'Review update to AFM Track Title'                              
ECOA4IX  EQU   *                                                                
                                                                                
ERCOA4Y  DC    AL1(ECOA4YX-*),AL2(105),AL1(ERRCATY2),AL1(D#COA4Y)               
         DC    C'Review update to AFM Music Type'                               
ECOA4YX  EQU   *                                                                
                                                                                
ERCOA4O  DC    AL1(ECOA4OX-*),AL2(186),AL1(ERRCATY2),AL1(D#COA4O)               
         DC    C'Review update to AFM Contract'                                 
ECOA4OX  EQU   *                                                                
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT ELEMENT 5 INTO REQUEST MAP     *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT DETAILS 5 ELEMENT)        *         
***********************************************************************         
                                                                                
         USING TAMCD,R4                                                         
CPY5TAMC NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA5T,RQCOA5T),TAMCTRK,     +        
               ERCOA5T,0                                                        
         CLI   RQCOA5T,0                                                        
         JE    C5MC10                                                           
         GOTOR (RF),(R1),(L'RQCOA5L,RQCOA5L),TAMCLFT,ERCOA5L,0                  
         GOTOR (RF),(R1),(L'RQCOA5S,RQCOA5S),TAMCLLEN,ERCOA5S,0                 
         GOTOR (RF),(R1),(L'RQCOA5Y,RQCOA5Y),TAMCTYP,ERCOA5Y,0                  
         ZIC   R0,TAMCLEN                                                       
         CHI   R0,TAMCLNQ                                                       
         JNH   C5MC10                                                           
         SHI   R0,TAMCLNQ+1                                                     
         GOTOR (RF),(R1),((R0),RQCOA5I),TAMCTRKT,ERCOA5I,0                      
         DROP  R4                                                               
                                                                                
C5MC10   OI    CPYSTAT3,CPYTAMC5                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT DETAILS ELEMENT DID NOT EXIST ON RECORD    *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW5TAMC NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT3,CPYTAMC5   IF MUSIC CONTRACT 5 ELEMENT DID NOT          
         JO    XIT                 EXIST ON RECORD PREVIOUSLY                   
         OC    RQCOA5O,RQCOA5O     AND AFM CONTRACT INTERNAL COMMERCIAL         
         JNZ   XIT                 NUMBER 5 IS NOT PROVIDED ...                 
                                                                                
         CLI   RQCOA5T,0           IF AFM 5 TRACKS IS BEING ADDED NOW           
         JE    N5MC10              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA5T)                       
                                                                                
N5MC10   CLI   RQCOA5L,0           IF AFM 5 LIFT IS BEING ADDED NOW             
         JE    N5MC20              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA5L)                       
                                                                                
N5MC20   OC    RQCOA5S,RQCOA5S     IF AFM 5 LENGTH IS BEING ADDED NOW           
         JZ    N5MC30              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA5S)                       
                                                                                
N5MC30   OC    RQCOA5I,RQCOA5I     IF AFM 5 TITLE IS BEING ADDED NOW            
         JZ    N5MC40              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA5I)                       
                                                                                
N5MC40   CLI   RQCOA5Y,0           IF AFM 5 MUSIC TYPE IS BEING ADDED           
         JE    XIT                 NOW, RETURN PROMPT FOR VERIFICATION          
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA5Y)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT/TRACK ELEMENT 5 INTO REQUEST   *         
*        MAP                                                          *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK 5 ELEMENT)          *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
CPY5TATR NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA5O,RQCOA5O),TATRCOM,     +        
               ERCOA5O,0                                                        
         OC    RQCOA5O,RQCOA5O                                                  
         JZ    C5TR10                                                           
         GOTOR (RF),(R1),(L'RQCOA5T,RQCOA5T),TATRTRK,ERCOA5T,0                  
         DROP  R4                                                               
                                                                                
C5TR10   GOTOR ADDTTAB,DMCB,OTTAB                                               
                                                                                
         OI    CPYSTAT4,CPYTATR5                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT/TRACK ELEMENT DID NOT EXIST ON RECORD      *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW5TATR NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT4,CPYTATR5                                                
         JO    XIT                                                              
         OC    RQCOA5O,RQCOA5O                                                  
         JZ    XIT                                                              
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA5O)                       
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA5T)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ERROR ENTRIES FOR CPY5TAMC, NEW5TAMC, CPY5TATR AND NEW5TATR  *         
*        (LOOK AT ERRENTD FOR DSECT)                                  *         
***********************************************************************         
                                                                                
ERCOA5T  DC    AL1(ECOA5TX-*),AL2(162),AL1(ERRCATY2),AL1(D#COA5T)               
         DC    C'Review update to AFM Track'                                    
ECOA5TX  EQU   *                                                                
                                                                                
ERCOA5L  DC    AL1(ECOA5LX-*),AL2(163),AL1(ERRCATY2),AL1(D#COA5L)               
         DC    C'Review update to AFM Lift'                                     
ECOA5LX  EQU   *                                                                
                                                                                
ERCOA5S  DC    AL1(ECOA5SX-*),AL2(164),AL1(ERRCATY2),AL1(D#COA5S)               
         DC    C'Review update to AFM Length'                                   
ECOA5SX  EQU   *                                                                
                                                                                
ERCOA5I  DC    AL1(ECOA5IX-*),AL2(167),AL1(ERRCATY2),AL1(D#COA5I)               
         DC    C'Review update to AFM Track Title'                              
ECOA5IX  EQU   *                                                                
                                                                                
ERCOA5Y  DC    AL1(ECOA5YX-*),AL2(168),AL1(ERRCATY2),AL1(D#COA5Y)               
         DC    C'Review update to AFM Music Type'                               
ECOA5YX  EQU   *                                                                
                                                                                
ERCOA5O  DC    AL1(ECOA5OX-*),AL2(187),AL1(ERRCATY2),AL1(D#COA5O)               
         DC    C'Review update to AFM Contract'                                 
ECOA5OX  EQU   *                                                                
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT ELEMENT 6 INTO REQUEST MAP     *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT DETAILS 6 ELEMENT)        *         
***********************************************************************         
                                                                                
         USING TAMCD,R4                                                         
CPY6TAMC NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA6T,RQCOA6T),TAMCTRK,     +        
               ERCOA6T,0                                                        
         CLI   RQCOA6T,0                                                        
         JE    C6MC10                                                           
         GOTOR (RF),(R1),(L'RQCOA6L,RQCOA6L),TAMCLFT,ERCOA6L,0                  
         GOTOR (RF),(R1),(L'RQCOA6S,RQCOA6S),TAMCLLEN,ERCOA6S,0                 
         GOTOR (RF),(R1),(L'RQCOA6Y,RQCOA6Y),TAMCTYP,ERCOA6Y,0                  
         ZIC   R0,TAMCLEN                                                       
         CHI   R0,TAMCLNQ                                                       
         JNH   C6MC10                                                           
         SHI   R0,TAMCLNQ+1                                                     
         GOTOR (RF),(R1),((R0),RQCOA6I),TAMCTRKT,ERCOA6I,0                      
         DROP  R4                                                               
                                                                                
C6MC10   OI    CPYSTAT4,CPYTAMC6                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT DETAILS ELEMENT DID NOT EXIST ON RECORD    *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW6TAMC NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT4,CPYTAMC6   IF MUSIC CONTRACT 6 ELEMENT DID NOT          
         JO    XIT                 EXIST ON RECORD PREVIOUSLY                   
         OC    RQCOA6O,RQCOA6O     AND AFM CONTRACT INTERNAL COMMERCIAL         
         JNZ   XIT                 NUMBER 6 IS NOT PROVIDED ...                 
                                                                                
         CLI   RQCOA6T,0           IF AFM 6 TRACKS IS BEING ADDED NOW           
         JE    N6MC10              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA6T)                       
                                                                                
N6MC10   CLI   RQCOA6L,0           IF AFM 6 LIFT IS BEING ADDED NOW             
         JE    N6MC20              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA6L)                       
                                                                                
N6MC20   OC    RQCOA6S,RQCOA6S     IF AFM 6 LENGTH IS BEING ADDED NOW           
         JZ    N6MC30              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA6S)                       
                                                                                
N6MC30   OC    RQCOA6I,RQCOA6I     IF AFM 6 TITLE IS BEING ADDED NOW            
         JZ    N6MC40              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA6I)                       
                                                                                
N6MC40   CLI   RQCOA6Y,0           IF AFM 6 MUSIC TYPE IS BEING ADDED           
         JE    XIT                 NOW, RETURN PROMPT FOR VERIFICATION          
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA6Y)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT/TRACK ELEMENT 6 INTO REQUEST   *         
*        MAP                                                          *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK 6 ELEMENT)          *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
CPY6TATR NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA6O,RQCOA6O),TATRCOM,     +        
               ERCOA6O,0                                                        
         OC    RQCOA6O,RQCOA6O                                                  
         JZ    C6TR10                                                           
         GOTOR (RF),(R1),(L'RQCOA6T,RQCOA6T),TATRTRK,ERCOA6T,0                  
         DROP  R4                                                               
                                                                                
C6TR10   GOTOR ADDTTAB,DMCB,OTTAB                                               
                                                                                
         OI    CPYSTAT4,CPYTATR6                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT/TRACK ELEMENT DID NOT EXIST ON RECORD      *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW6TATR NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT4,CPYTATR6                                                
         JO    XIT                                                              
         OC    RQCOA6O,RQCOA6O                                                  
         JZ    XIT                                                              
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA6O)                       
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA6T)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ERROR ENTRIES FOR CPY6TAMC, NEW6TAMC, CPY6TATR AND NEW6TATR  *         
*        (LOOK AT ERRENTD FOR DSECT)                                  *         
***********************************************************************         
                                                                                
ERCOA6T  DC    AL1(ECOA6TX-*),AL2(169),AL1(ERRCATY2),AL1(D#COA6T)               
         DC    C'Review update to AFM Track'                                    
ECOA6TX  EQU   *                                                                
                                                                                
ERCOA6L  DC    AL1(ECOA6LX-*),AL2(170),AL1(ERRCATY2),AL1(D#COA6L)               
         DC    C'Review update to AFM Lift'                                     
ECOA6LX  EQU   *                                                                
                                                                                
ERCOA6S  DC    AL1(ECOA6SX-*),AL2(171),AL1(ERRCATY2),AL1(D#COA6S)               
         DC    C'Review update to AFM Length'                                   
ECOA6SX  EQU   *                                                                
                                                                                
ERCOA6I  DC    AL1(ECOA6IX-*),AL2(174),AL1(ERRCATY2),AL1(D#COA6I)               
         DC    C'Review update to AFM Track Title'                              
ECOA6IX  EQU   *                                                                
                                                                                
ERCOA6Y  DC    AL1(ECOA6YX-*),AL2(175),AL1(ERRCATY2),AL1(D#COA6Y)               
         DC    C'Review update to AFM Music Type'                               
ECOA6YX  EQU   *                                                                
                                                                                
ERCOA6O  DC    AL1(ECOA6OX-*),AL2(188),AL1(ERRCATY2),AL1(D#COA6O)               
         DC    C'Review update to AFM Contract'                                 
ECOA6OX  EQU   *                                                                
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT ELEMENT 7 INTO REQUEST MAP     *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT DETAILS 7 ELEMENT)        *         
***********************************************************************         
                                                                                
         USING TAMCD,R4                                                         
CPY7TAMC NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA7T,RQCOA7T),TAMCTRK,     +        
               ERCOA7T,0                                                        
         CLI   RQCOA7T,0                                                        
         JE    C7MC10                                                           
         GOTOR (RF),(R1),(L'RQCOA7L,RQCOA7L),TAMCLFT,ERCOA7L,0                  
         GOTOR (RF),(R1),(L'RQCOA7S,RQCOA7S),TAMCLLEN,ERCOA7S,0                 
         GOTOR (RF),(R1),(L'RQCOA7Y,RQCOA7Y),TAMCTYP,ERCOA7Y,0                  
         ZIC   R0,TAMCLEN                                                       
         CHI   R0,TAMCLNQ                                                       
         JNH   C7MC10                                                           
         SHI   R0,TAMCLNQ+1                                                     
         GOTOR (RF),(R1),((R0),RQCOA7I),TAMCTRKT,ERCOA7I,0                      
         DROP  R4                                                               
                                                                                
C7MC10   OI    CPYSTAT4,CPYTAMC7                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT DETAILS ELEMENT DID NOT EXIST ON RECORD    *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW7TAMC NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT4,CPYTAMC7   IF MUSIC CONTRACT 7 ELEMENT DID NOT          
         JO    XIT                 EXIST ON RECORD PREVIOUSLY                   
         OC    RQCOA7O,RQCOA7O     AND AFM CONTRACT INTERNAL COMMERCIAL         
         JNZ   XIT                 NUMBER 7 IS NOT PROVIDED ...                 
                                                                                
         CLI   RQCOA7T,0           IF AFM 7 TRACKS IS BEING ADDED NOW           
         JE    N7MC10              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA7T)                       
                                                                                
N7MC10   CLI   RQCOA7L,0           IF AFM 7 LIFT IS BEING ADDED NOW             
         JE    N7MC20              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA7L)                       
                                                                                
N7MC20   OC    RQCOA7S,RQCOA7S     IF AFM 7 LENGTH IS BEING ADDED NOW           
         JZ    N7MC30              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA7S)                       
                                                                                
N7MC30   OC    RQCOA7I,RQCOA7I     IF AFM 7 TITLE IS BEING ADDED NOW            
         JZ    N7MC40              RETURN PROMPT FOR VERIFICATION               
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA7I)                       
                                                                                
N7MC40   CLI   RQCOA7Y,0           IF AFM 7 MUSIC TYPE IS BEING ADDED           
         JE    XIT                 NOW, RETURN PROMPT FOR VERIFICATION          
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA7Y)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE COPIES MUSIC CONTRACT/TRACK ELEMENT 7 INTO REQUEST   *         
*        MAP                                                          *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK 7 ELEMENT)          *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
CPY7TATR NTR1  BASE=*,LABEL=*                                                   
         GOTOR (#CHKFLD,ACHKFLD),DMCB,(L'RQCOA7O,RQCOA7O),TATRCOM,     +        
               ERCOA7O,0                                                        
         OC    RQCOA7O,RQCOA7O                                                  
         JZ    C7TR10                                                           
         GOTOR (RF),(R1),(L'RQCOA7T,RQCOA7T),TATRTRK,ERCOA7T,0                  
         DROP  R4                                                               
                                                                                
C7TR10   GOTOR ADDTTAB,DMCB,OTTAB                                               
                                                                                
         OI    CPYSTAT5,CPYTATR7                                                
         MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        IF MUSIC CONTRACT/TRACK ELEMENT DID NOT EXIST ON RECORD      *         
*        PREVIOUSLY AND MUSIC CONTRACT DETAILS ARE BEING ADDED NOW,   *         
*        ROUTINE PROCESSES THEM                                       *         
***********************************************************************         
                                                                                
NEW7TATR NTR1  BASE=*,LABEL=*                                                   
         TM    CPYSTAT5,CPYTATR7                                                
         JO    XIT                                                              
         OC    RQCOA7O,RQCOA7O                                                  
         JZ    XIT                                                              
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA7O)                       
         GOTOR (#ADDERR,AADDERR),DMCB,('ESREVIW',ERCOA7T)                       
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ERROR ENTRIES FOR CPY7TAMC, NEW7TAMC, CPY7TATR AND NEW7TATR  *         
*        (LOOK AT ERRENTD FOR DSECT)                                  *         
***********************************************************************         
                                                                                
ERCOA7T  DC    AL1(ECOA7TX-*),AL2(176),AL1(ERRCATY2),AL1(D#COA7T)               
         DC    C'Review update to AFM Track'                                    
ECOA7TX  EQU   *                                                                
                                                                                
ERCOA7L  DC    AL1(ECOA7LX-*),AL2(177),AL1(ERRCATY2),AL1(D#COA7L)               
         DC    C'Review update to AFM Lift'                                     
ECOA7LX  EQU   *                                                                
                                                                                
ERCOA7S  DC    AL1(ECOA7SX-*),AL2(178),AL1(ERRCATY2),AL1(D#COA7S)               
         DC    C'Review update to AFM Length'                                   
ECOA7SX  EQU   *                                                                
                                                                                
ERCOA7I  DC    AL1(ECOA7IX-*),AL2(181),AL1(ERRCATY2),AL1(D#COA7I)               
         DC    C'Review update to AFM Track Title'                              
ECOA7IX  EQU   *                                                                
                                                                                
ERCOA7Y  DC    AL1(ECOA7YX-*),AL2(182),AL1(ERRCATY2),AL1(D#COA7Y)               
         DC    C'Review update to AFM Music Type'                               
ECOA7YX  EQU   *                                                                
                                                                                
ERCOA7O  DC    AL1(ECOA7OX-*),AL2(189),AL1(ERRCATY2),AL1(D#COA7O)               
         DC    C'Review update to AFM Contract'                                 
ECOA7OX  EQU   *                                                                
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE COPIES INTERNAL COMMERCIAL NUMBER AND TRACK INTO     *         
*        TRACK TABLE                                                  *         
*        ON ENTRY ... P1 = A(TRACK TABLE)                             *         
*        ON ENTRY ... R4 = A(MUSIC CONTRACT/TRACK ELEMENT)            *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
ADDTTAB  NTR1  BASE=*,LABEL=*                                                   
         USING TLISTD,R1                                                        
         L     R1,0(R1)                                                         
ATT10    CLI   0(R1),X'FF'                                                      
         JE    ATT20                                                            
         LA    R1,TLLNQ(R1)        ADD AFM CONTRACT INTERNAL                    
         J     ATT10               COMMERCIAL NUMBER AND TRACK                  
ATT20    MVC   TLCOM,TATRCOM       TO TRACK TABLE                               
         MVC   TLTRK,TATRTRK                                                    
         MVI   TLLNQ(R1),X'FF'                                                  
         J     XIT                                                              
         DROP  R1,R4                                                            
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE DETERMINES IF MUSICIAN IS ON THE PROVIDED TRACK      *         
*        ON ENTRY ... P1=A(TRACK LETTER)                              *         
*                     P2=A(CAST RECORD)                                         
***********************************************************************         
                                                                                
ONTRK    NTR1  BASE=*,LABEL=*                                                   
         L     R2,0(R1)                                                         
         L     R3,4(R1)                                                         
                                                                                
         USING TAFND,R4                                                         
         GOTOR (#GETELEM,AGETELEM),DMCB,('TAFNELQ',(R3)),              +        
               ('TAFNTTRK',0)                                                   
         JNE   NO                                                               
         L     R4,AELEM                                                         
         CLI   TAFNNAME,C'*'                                                    
         JE    YES                                                              
         LA    R1,TAFNNAME                                                      
         ZIC   RE,TAFNLEN                                                       
         SHI   RE,3                                                             
OT10     CLC   0(1,R2),0(R1)                                                    
         JE    YES                                                              
         LA    R1,1(R1)                                                         
         BCT   RE,OT10                                                          
         J     NO                                                               
         DROP  R4                                                               
                                                                                
***********************************************************************         
*        LITERALS FOR ONTRK  ROUTINE                                  *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE BUILDS LIST OF TRACK THAT ARE IN P1 BUT NOT P2       *         
*        ON ENTRY ... P1 = A(TRACK LIST TO BUILD)                     *         
*                     P2 = A(FIRST TRACK LIST)                        *         
*                     P3 = A(SECOND TRACK LIST)                       *         
***********************************************************************         
                                                                                
BLDTLIST NTR1  BASE=*,LABEL=*                                                   
         L     R4,0(R1)            R4=A(TRACK LIST TO BUILD)                    
         L     R2,4(R1)            R2=A(FIRST TRACK LIST)                       
         L     RF,8(R1)            RF=A(SECOND TRACK LIST)                      
                                                                                
         USING TLISTD,R2                                                        
BTL10    CLI   0(R2),X'FF'                                                      
         JE    BTL60                                                            
                                                                                
         LR    R3,RF               R3=A(SECOND TRACK LIST)                      
                                                                                
BTL20    CLI   0(R3),X'FF'         IF TRACK IS NOT IN SECOND TRACK              
         JE    BTL40               LIST ...                                     
         CLC   TLCOM,0(R3)                                                      
         JNE   BTL30                                                            
         CLC   TLTRK,TLTRK-TLISTD(R3)                                           
         JE    BTL50                                                            
BTL30    LA    R3,TLLNQ(R3)        ... ADD IT TO TRACK LIST TO BUILD            
         J     BTL20                                                            
BTL40    MVC   0(L'TLCOM,R4),TLCOM                                              
         MVC   TLTRK-TLISTD(L'TLTRK,R4),TLTRK                                   
         LA    R4,TLLNQ(R4)                                                     
                                                                                
BTL50    LA    R2,TLLNQ(R2)                                                     
         J     BTL10                                                            
         DROP  R2                                                               
                                                                                
BTL60    MVI   0(R4),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ADD MUSIC CONTRACT/TRACK ELEMENTS                            *         
*        ON ENTRY ... R2=A(ELEM)                                      *         
*                     R4=A(COMMERCIAL RECORD)                         *         
***********************************************************************         
                                                                                
         USING TATRD,R2                                                         
ADDTATR  NTR1  BASE=*,LABEL=*                                                   
         OC    RQCOA1O,RQCOA1O                                                  
         JZ    ATR10               IF MUSIC CONTRACT/TRACK 1 INFO IS            
         XC    ELEM,ELEM           PRESENT, INITIALIZE ELEMENT                  
         MVI   TATREL,TATRELQ                                                   
         MVI   TATRLEN,TATRLNQ                                                  
         MVI   TATRSEQ,0           PUT SEQUENCE NUMBER                          
         MVC   TATRCOM,RQCOA1O     INTERNAL COMMERCIAL NUMBER                   
         MVC   TATRTRK,RQCOA1T     AND TRACK INTO ELEMENT                       
         GOTO1 VHELLO,DMCB,(C'P',=C'TALFIL'),(R4),(R2),0                        
                                                                                
ATR10    OC    RQCOA2O,RQCOA2O                                                  
         JZ    ATR20               IF MUSIC CONTRACT/TRACK 2 INFO IS            
         XC    ELEM,ELEM           PRESENT, INITIALIZE ELEMENT                  
         MVI   TATREL,TATRELQ                                                   
         MVI   TATRLEN,TATRLNQ                                                  
         MVI   TATRSEQ,1           PUT SEQUENCE NUMBER                          
         MVC   TATRCOM,RQCOA2O     INTERNAL COMMERCIAL NUMBER                   
         MVC   TATRTRK,RQCOA2T     AND TRACK INTO ELEMENT                       
         GOTO1 VHELLO,DMCB,(C'P',=C'TALFIL'),(R4),(R2),0                        
                                                                                
ATR20    OC    RQCOA3O,RQCOA3O                                                  
         JZ    ATR30               IF MUSIC CONTRACT/TRACK 3 INFO IS            
         XC    ELEM,ELEM           PRESENT, INITIALIZE ELEMENT                  
         MVI   TATREL,TATRELQ                                                   
         MVI   TATRLEN,TATRLNQ                                                  
         MVI   TATRSEQ,2           PUT SEQUENCE NUMBER                          
         MVC   TATRCOM,RQCOA3O     INTERNAL COMMERCIAL NUMBER                   
         MVC   TATRTRK,RQCOA3T     AND TRACK INTO ELEMENT                       
         GOTO1 VHELLO,DMCB,(C'P',=C'TALFIL'),(R4),(R2),0                        
                                                                                
ATR30    OC    RQCOA4O,RQCOA4O                                                  
         JZ    ATR40               IF MUSIC CONTRACT/TRACK 4 INFO IS            
         XC    ELEM,ELEM           PRESENT, INITIALIZE ELEMENT                  
         MVI   TATREL,TATRELQ                                                   
         MVI   TATRLEN,TATRLNQ                                                  
         MVI   TATRSEQ,3           PUT SEQUENCE NUMBER                          
         MVC   TATRCOM,RQCOA4O     INTERNAL COMMERCIAL NUMBER                   
         MVC   TATRTRK,RQCOA4T     AND TRACK INTO ELEMENT                       
         GOTO1 VHELLO,DMCB,(C'P',=C'TALFIL'),(R4),(R2),0                        
                                                                                
ATR40    OC    RQCOA5O,RQCOA5O                                                  
         JZ    ATR50               IF MUSIC CONTRACT/TRACK 5 INFO IS            
         XC    ELEM,ELEM           PRESENT, INITIALIZE ELEMENT                  
         MVI   TATREL,TATRELQ                                                   
         MVI   TATRLEN,TATRLNQ                                                  
         MVI   TATRSEQ,4           PUT SEQUENCE NUMBER                          
         MVC   TATRCOM,RQCOA5O     INTERNAL COMMERCIAL NUMBER                   
         MVC   TATRTRK,RQCOA5T     AND TRACK INTO ELEMENT                       
         GOTO1 VHELLO,DMCB,(C'P',=C'TALFIL'),(R4),(R2),0                        
                                                                                
ATR50    OC    RQCOA6O,RQCOA6O                                                  
         JZ    ATR60               IF MUSIC CONTRACT/TRACK 6 INFO IS            
         XC    ELEM,ELEM           PRESENT, INITIALIZE ELEMENT                  
         MVI   TATREL,TATRELQ                                                   
         MVI   TATRLEN,TATRLNQ                                                  
         MVI   TATRSEQ,5           PUT SEQUENCE NUMBER                          
         MVC   TATRCOM,RQCOA6O     INTERNAL COMMERCIAL NUMBER                   
         MVC   TATRTRK,RQCOA6T     AND TRACK INTO ELEMENT                       
         GOTO1 VHELLO,DMCB,(C'P',=C'TALFIL'),(R4),(R2),0                        
                                                                                
ATR60    OC    RQCOA7O,RQCOA7O                                                  
         JZ    XIT                 IF MUSIC CONTRACT/TRACK 7 INFO IS            
         XC    ELEM,ELEM           PRESENT, INITIALIZE ELEMENT                  
         MVI   TATREL,TATRELQ                                                   
         MVI   TATRLEN,TATRLNQ                                                  
         MVI   TATRSEQ,6           PUT SEQUENCE NUMBER                          
         MVC   TATRCOM,RQCOA7O     INTERNAL COMMERCIAL NUMBER                   
         MVC   TATRTRK,RQCOA7T     AND TRACK INTO ELEMENT                       
         GOTO1 VHELLO,DMCB,(C'P',=C'TALFIL'),(R4),(R2),0                        
         J     XIT                                                              
         DROP  R2                                                               
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE PROCESSES CAST RECORDS                               *         
*        ON ENTRY ... R3=A(IOKEY)                                     *         
***********************************************************************         
                                                                                
PROCST   NTR1  BASE=*,LABEL=*                                                   
         USING TLISTD,R2                                                        
         CLI   TRKALIST,X'FF'      IF ADDING ANY TRACKS ...                     
         JE    PCST50                                                           
         LA    R2,TRKALIST         R2=A(LIST OF TRACKS TO ADD)                  
                                                                                
         USING TLCAD,R3                                                         
PCST10   XC    TLCAKEY,TLCAKEY                                                  
         MVI   TLCACD,TLCACDQ      READ ALL MUSICIANS FOR THE                   
         MVC   TLCACOM,TLCOM       CURRENT ADDED TRACK'S CONTRACT               
         MVI   TLCASORT,X'80'                                                   
         GOTOR (#IOEXEC,AIOEXEC),'IOHI+IODIR+IO5'                               
         J     PCST30                                                           
PCST20   GOTOR (#IOEXEC,AIOEXEC),'IOSQ+IODIR+IO5'                               
PCST30   CLC   IOKEY(TLCASORT-TLCAD),IOKEYSAV                                   
         JNE   PCST40                                                           
         DROP  R3                                                               
                                                                                
         GOTOR (#IOEXEC,AIOEXEC),'IOGET+IOFIL+IO5'                              
                                                                                
         GOTOR ONTRK,DMCB,TLTRK,AIO5                                            
         JNE   PCST20              IF MUSICIAN IS ON TRACK BEING ADDED          
         BAS   RE,PCBCTAL          BUILD CAST-SPECIFIC TRACK ADD LIST           
         MVC   SVCAKEY,IOKEY                                                    
                                                                                
         BAS   RE,PCPROTRK         ADD/UPDATE CAST RECORD FOR COMM'L            
                                                                                
         MVC   IOKEY,SVCAKEY                                                    
         GOTOR (#IOEXEC,AIOEXEC),'IOHI+IODIR+IO5'                               
         J     PCST20                                                           
                                                                                
PCST40   LA    R2,TLLNQ(R2)        IF ADDING ANOTHER TRACK TO THE               
         CLI   0(R2),X'FF'         COMMERCIAL, GO PROCESS IT NOW                
         JNE   PCST10              IF DONE, UPDATE COMMERCIAL'S                 
         BAS   RE,UPNXTSEQ         NEXT CAST SEQUENCE NUMBER                    
                                                                                
***********************************************************************         
                                                                                
         USING TLCAD,R3                                                         
PCST50   XC    TLCAKEY,TLCAKEY     READ ALL CAST KEYS/RECORDS                   
         MVI   TLCACD,TLCACDQ                                                   
         MVC   TLCACOM,RQCOCOM                                                  
         GOTOR (#IOEXEC,AIOEXEC),'IOHI+IODIR+IO5'                               
         J     PCST70                                                           
PCST60   GOTOR (#IOEXEC,AIOEXEC),'IOSQ+IODIR+IO5'                               
PCST70   CLC   IOKEY(TLCASORT-TLCAD),IOKEYSAV                                   
         JNE   XIT                                                              
         DROP  R3                                                               
                                                                                
         GOTOR (#IOEXEC,AIOEXEC),'IOGETRUP+IOFIL+IO5'                           
                                                                                
         MVC   SVCAKEY,IOKEY                                                    
         GOTOR (#SAVPTRS,ASAVPTRS)                                              
                                                                                
         MVI   CASTSTAT,0          DEFAULT TO "UPDATE NOT NEEDED"               
                                                                                
         BAS   RE,PCDELTRK         IF ANY TRACK HAS BEEN REMOVED                
         JNE   PCST80              SET "UPDATE NEEDED"                          
         OI    CASTSTAT,CAUPDATE                                                
                                                                                
         USING TLCAD,R4                                                         
         L     R4,AIO5                                                          
         MVI   ELCODE,TATRELQ      IF ALL TRACKS HAVE BEEN REMOVED              
         BRAS  RE,GETEL            FROM CAST RECORD                             
         JE    PCST80              SET RECORD FOR DELETE                        
         L     R4,AIO5                                                          
         OI    TLCASTAT,TLCASDCG+TLCASDEL                                       
         DROP  R4                                                               
                                                                                
PCST80   BRAS  RE,UPDCST                                                        
                                                                                
         MVC   IOKEY,SVCAKEY                                                    
         GOTOR (#IOEXEC,AIOEXEC),'IOHI+IODIR+IO5'                               
         CLC   IOKEY(L'TLCAKEY),SVCAKEY                                         
         JE    PCST60                                                           
         J     PCST70                                                           
                                                                                
***********************************************************************         
*        ROUTINES BUILDS CAST-SPECIFIC TRACKS TO ADD LIST IN CTRKALST *         
*        ON ENTRY ... AIO5 = A(AFM CONTRACT CAST RECORD)              *         
*                     R2 = A(CURRENT ENTRY IN TRACK TO ADD LIST)      *         
***********************************************************************         
                                                                                
         USING TLISTD,R2                                                        
PCBCTAL  NTR1                                                                   
         MVC   FULL1,TLCOM         R2=A(LIST OF TRACKS TO ADD)                  
                                                                                
         LA    R3,CTRKALST         R3=A(CAST SPECIFIC TRKS TO ADD)              
                                                                                
PCBCTAL1 GOTOR ONTRK,DMCB,TLTRK,AIO5                                            
         JNE   PCBCTAL2            IF MUSICIAN IS ON TRACK BEING ADDED          
         MVC   0(TLLNQ,R3),TLCOM   ADD TO CAST-SPECIFIC TRACK ADD LIST          
         LA    R3,TLLNQ(R3)                                                     
                                                                                
PCBCTAL2 LA    R2,TLLNQ(R2)                                                     
         CLI   0(R2),X'FF'                                                      
         JE    PCBCTAL3                                                         
         CLC   FULL1,TLCOM                                                      
         JE    PCBCTAL1                                                         
         J     PCBCTAL2                                                         
         DROP  R2                                                               
                                                                                
PCBCTAL3 MVI   0(R3),X'FF'                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE CHECKS IF MUSICIAN ALREADY EXISTS ON THE COMMERCIAL  *         
*        IF IT DOES NOT, UPDATES IT WITH TRACKS TO ADD AND REMOVES    *         
*        TRACKS TO DELETE                                             *         
*        IF NOT, ADDS IT WITH TRACKS TO ADD                           *         
*        ON ENTRY ... R3=A(IOKEY)                                     *         
***********************************************************************         
                                                                                
PCPROTRK NTR1                                                                   
***********************************************************************         
*        IF MUSICIAN ALREADY EXISTS ON THIS COMMERCIAL, REMOVE ANY    *         
*        TRACKS THAT ARE BEING DELETED                                *         
***********************************************************************         
                                                                                
         USING TLISTD,R2                                                        
         LA    R2,CTRKALST                                                      
                                                                                
         USING TLCAPD,R3                                                        
         XC    TLCAPKEY,TLCAPKEY                                                
         MVI   TLCAPCD,TLCATCDQ                                                 
         MVC   TLCATMCO,TLCOM                                                   
         MVC   TLCATMCS,SVCAKEY+TLCASEQ-TLCAD                                   
         MVC   TLCATCOM,RQCOCOM                                                 
         GOTOR (#IOEXEC,AIOEXEC),'IOHI+IODIR+IO5'                               
         CLC   IOKEY(TLCATSEQ-TLCAPD),IOKEYSAV                                  
         JNE   PCPT30                                                           
                                                                                
         GOTOR (#IOEXEC,AIOEXEC),'IOGETRUP+IOFIL+IO5'                           
                                                                                
         GOTOR (#SAVPTRS,ASAVPTRS)                                              
                                                                                
         BAS   RE,PCDELTRK                                                      
         J     PCPT40                                                           
                                                                                
***********************************************************************         
*        IF MUSICIAN DOES NOT ALREADY EXIST ON COMMERCIAL,            *         
*        INITIALIZE CAST WITH MUSIC CONTRACT CAST'S DETAILS           *         
***********************************************************************         
                                                                                
PCPT30   L     RE,ASVPTRS                                                       
         XC    0(255,RE),0(RE)                                                  
                                                                                
         BAS   RE,PCCPYCST                                                      
                                                                                
***********************************************************************         
*        ADD THE TRACK ASSOCIATION                                    *         
***********************************************************************         
                                                                                
         USING TATRD,R4                                                         
PCPT40   L     R4,AIO5                                                          
         MVI   ELCODE,TATRELQ                                                   
         BRAS  RE,GETEL                                                         
         J     *+8                                                              
PCPT50   BRAS  RE,NEXTEL                                                        
         JNE   PCPT60                                                           
         CLC   TATRTRK,TLTRK                                                    
         JNE   PCPT50                                                           
         J     PCPT70                                                           
         DROP  R4                                                               
                                                                                
         USING TATRD,R4                                                         
PCPT60   LA    R4,ELEM                                                          
         XC    ELEM,ELEM                                                        
         MVI   TATREL,TATRELQ                                                   
         MVI   TATRLEN,TATRLNQ                                                  
         MVC   TATRCOM,TLCOM                                                    
         MVC   TATRCSQ,SVCAKEY+TLCASEQ-TLCAD                                    
         MVC   TATRTRK,TLTRK                                                    
         GOTO1 VHELLO,DMCB,(C'P',=C'TALFIL'),AIO5,(R4),0                        
         DROP  R3,R4                                                            
                                                                                
***********************************************************************         
*        IF ANY ADDITIONAL TRACKS ARE BEING ADDED, ADD THOSE          *         
*        TO THE CAST RECORD AS WELL                                   *         
***********************************************************************         
                                                                                
PCPT70   LA    R2,TLLNQ(R2)                                                     
         CLI   0(R2),X'FF'                                                      
         JNE   PCPT40                                                           
         DROP  R2                                                               
                                                                                
***********************************************************************         
*        NOW THAT ALL TRACK ASSOCIATIONS ARE PROCESSED,               *         
*        ADD OR PUT COMMERCIAL'S CAST RECORD                          *         
***********************************************************************         
                                                                                
         OI    CASTSTAT,CAUPDATE                                                
         BRAS  RE,UPDCST                                                        
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE UPDATES COMMERCIAL'S NEXT CAST SEQUENCE NUMBER       *         
*        ON ENTRY ... R3=A(IOKEY)                                     *         
***********************************************************************         
                                                                                
UPNXTSEQ NTR1                                                                   
         TM    CASTSTAT,CAADDED    IF ANY MUSICIANS WERE ADDED ...              
         JZ    XIT                                                              
                                                                                
         USING TLCOPD,R3                                                        
         XC    TLCOPKEY,TLCOPKEY                                                
         MVI   TLCOPCD,TLCOCCDQ    READ FOR COMMERCIAL KEY VIA                  
         MVC   TLCOCCOM,RQCOCOM    INTERNAL COMMERCIAL NUMBER                   
         GOTOR (#IOEXEC,AIOEXEC),'IORD+IODIR+IO5'                               
         JE    *+6                                                              
         DC    H'00'                                                            
         GOTOR (#IOEXEC,AIOEXEC),'IOGETRUP+IOFIL+IO5'                           
         DROP  R3                                                               
                                                                                
         USING TANUD,R4                                                         
         GOTOR (#GETELEM,AGETELEM),DMCB,('TANUELQ',AIO5),('TANUTSEQ',0)         
         JE    *+6                                                              
         DC    H'00'                                                            
         L     R4,AELEM                                                         
         MVC   TANUNXTC,SVNUNXTC   SET NEXT CAST SEQUENCE NUMBER                
         DROP  R4                                                               
                                                                                
         GOTOR (#IOEXEC,AIOEXEC),'IOPUTREC+IOFIL+IO5'                           
         J     XIT                                                              
                                                                                
***********************************************************************         
*        ROUTINE DELETES TRACKS FROM CAST RECORD                      *         
*        ON ENTRY ... AIO5 = A(CAST RECORD)                           *         
*                     R3 = A(IOKEY)                                   *         
***********************************************************************         
                                                                                
PCDELTRK NTR1                                                                   
         CLI   TRKDLIST,X'FF'      IF TRACKS ARE BEING DELETED                  
         JE    NO                                                               
                                                                                
         XR    R0,R0                                                            
                                                                                
         USING TATRD,R4                                                         
         L     R4,AIO5                                                          
         MVI   ELCODE,TATRELQ      READ THROUGH ALL TRACK ELEMENTS              
         BRAS  RE,GETEL                                                         
         J     *+8                                                              
PCDT10   BRAS  RE,NEXTEL                                                        
         JNE   PCDT70                                                           
                                                                                
         USING TLISTD,R2                                                        
         LA    R2,TRKDLIST                                                      
PCDT20   CLC   TATRCOM,TLCOM       IF TRACK IS BEING DELETED ...                
         JNE   PCDT60                                                           
         CLC   TATRTRK,TLTRK                                                    
         JNE   PCDT60                                                           
         DROP  R2                                                               
                                                                                
         USING TLCOPD,R3                                                        
         XC    IOKEY,IOKEY         ... AND IS NOT ON ANY ADDITIONAL             
         MVI   TLCOPCD,TLCOTCDQ    VERSIONS ...                                 
         MVC   TLCOTMCO,TATRCOM                                                 
         MVC   TLCOTTRK,TATRTRK                                                 
         MVC   TLCOTCOM,RQCOCOM                                                 
         GOTOR (#IOEXEC,AIOEXEC),'IOHI+IODIR+IO6'                               
         J     PCDT40                                                           
PCDT30   GOTOR (#IOEXEC,AIOEXEC),'IOSQ+IODIR+IO6'                               
PCDT40   CLC   IOKEY(TLCOTVER-TLCOPD),IOKEYSAV                                  
         JNE   PCDT50                                                           
         CLC   TLCOTVER,RQCOVER                                                 
         JE    PCDT30                                                           
         J     PCDT60                                                           
         DROP  R3                                                               
                                                                                
PCDT50   MVI   0(R4),X'FF'         MARK ELEMENT DELETED                         
         AHI   R0,1                                                             
         J     PCDT10                                                           
         DROP  R4                                                               
                                                                                
         USING TLISTD,R2                                                        
PCDT60   LA    R2,TLLNQ(R2)                                                     
         CLI   0(R2),X'FF'                                                      
         JE    PCDT10                                                           
         J     PCDT20                                                           
         DROP  R2                                                               
                                                                                
PCDT70   LTR   R0,R0                                                            
         JZ    NO                                                               
         GOTO1 VHELLO,DMCB,(C'D',=C'TALFIL'),(X'FF',AIO5),0                     
         OI    CASTSTAT,CAUPDATE                                                
         J     YES                                                              
                                                                                
***********************************************************************         
*        ROUTINE INITIALIZE CAST WITH MUSIC CONTRACT CAST'S DETAILS   *         
***********************************************************************         
                                                                                
PCCPYCST NTR1                                                                   
         L     RE,ASVPTRS                                                       
         XC    0(255,RE),0(RE)                                                  
                                                                                
         USING TLCAD,R4                                                         
         L     R4,AIO5                                                          
         MVC   TLCACOM,RQCOCOM                                                  
         MVC   TLCASEQ,SVNUNXTC                                                 
         ZICM  RE,SVNUNXTC,2                                                    
         AHI   RE,1                                                             
         STCM  RE,3,SVNUNXTC                                                    
         DROP  R4                                                               
                                                                                
         MVI   ELCODE,0                                                         
         BRAS  RE,GETEL                                                         
         J     *+8                                                              
PCCC10   BRAS  RE,NEXTEL                                                        
         JNE   PCCC30                                                           
         CLI   0(R4),TAOPELQ                                                    
         JE    PCCC10                                                           
         CLI   0(R4),TAOAELQ                                                    
         JE    PCCC10                                                           
         CLI   0(R4),TAO2ELQ                                                    
         JE    PCCC10                                                           
         CLI   0(R4),TACAELQ                                                    
         JE    PCCC10                                                           
         CLI   0(R4),TACMELQ                                                    
         JE    PCCC10                                                           
                                                                                
         USING TAFND,R4                                                         
         CLI   0(R4),TAFNELQ                                                    
         JNE   PCCC20                                                           
         CLI   TAFNTYPE,TAFNTTRK                                                
         JE    PCCC20                                                           
         CLI   TAFNTYPE,TAFNTVER                                                
         JNE   PCCC10                                                           
         DROP  R4                                                               
                                                                                
PCCC20   MVI   0(R4),X'FF'                                                      
         J     PCCC10                                                           
                                                                                
PCCC30   GOTO1 VHELLO,DMCB,(C'D',=C'TALFIL'),(X'FF',AIO5),0                     
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE SAVES CAST RECORD'S CAST SEQUENCE NUMBER INTO        *         
*        UPDATED CAST SEQUENCE NUMBER LIST                            *         
*        ON ENTRY ... AIO5 = A(CAST RECORD)                           *         
***********************************************************************         
                                                                                
ADDUCAST NTR1  BASE=*,LABEL=*                                                   
         USING UCSTTBLD,R2                                                      
         L     R2,AUCSTTBL                                                      
AUC10    CLI   0(R2),X'FF'                                                      
         JE    AUC20                                                            
         LA    R2,UCTLNQ(R2)                                                    
         J     AUC10                                                            
                                                                                
AUC20    XC    0(UCTLNQ,R2),0(R2)                                               
                                                                                
         USING TLCAD,R4                                                         
         L     R4,AIO5                                                          
         MVC   0(L'TLCASEQ,R2),TLCASEQ                                          
         DROP  R4                                                               
                                                                                
         USING TATRD,R4                                                         
         MVI   ELCODE,TATRELQ                                                   
         BRAS  RE,GETEL                                                         
         JNE   AUC30                                                            
         MVC   UCTTRCOM,TATRCOM                                                 
         MVC   UCTTRSEQ,TATRCSQ                                                 
         DROP  R4                                                               
                                                                                
AUC30    MVI   UCTLNQ(R2),X'FF'                                                 
         J     XIT                                                              
         DROP  R2                                                               
                                                                                
***********************************************************************         
*        LITERALS FOR ADDUCAST ROUTINE                                *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE OUTPUTS UPDATED CAST SEQUENCE NUMBERS                *         
***********************************************************************         
                                                                                
OUTUCAST NTR1  BASE=*,LABEL=*                                                   
         USING UCSTTBLD,R2                                                      
         L     R2,AUCSTTBL                                                      
OUC10    CLI   0(R2),X'FF'                                                      
         JE    XIT                                                              
         GOTOR VLINKIO,DMCB,('LIOAPUT',ALIOB),('LIOTMAP',O#COUCST)              
         GOTO1 VHEXOUT,DMCB,UCTSEQ,OUTPUT,L'UCTSEQ,0                            
         GOTOR VLINKIO,DMCB,('LIOAPUT',ALIOB),('LIOTRAW',1),           +        
               ('LD_CHARQ',OUTPUT),(4,0)                                        
         OC    UCTTRCOM,UCTTRCOM                                                
         JZ    UOC20                                                            
         GOTO1 VHEXOUT,DMCB,UCTTRCOM,OUTPUT,L'UCTTRCOM,0                        
         GOTOR VLINKIO,DMCB,('LIOAPUT',ALIOB),('LIOTRAW',2),           +        
               ('LD_CHARQ',OUTPUT),(8,0)                                        
         GOTO1 VHEXOUT,DMCB,UCTTRSEQ,OUTPUT,L'UCTTRSEQ,0                        
         GOTOR VLINKIO,DMCB,('LIOAPUT',ALIOB),('LIOTRAW',3),           +        
               ('LD_CHARQ',OUTPUT),(4,0)                                        
UOC20    LA    R2,UCTLNQ(R2)                                                    
         J     OUC10                                                            
                                                                                
***********************************************************************         
*        LITERALS FOR OUTUCAST ROUTINE                                *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
