*          DATA SET DEDEAN9009 AT LEVEL 230 AS OF 05/01/02                      
         CODE                                                                   
DEAN9009 TITLE '- DEMO CONVERSION - NTI POCKETPIECE'                            
* Y=RAW IMPRESSIONS Z=RAW PUTS(PROGRAM) W=RAW PUTS(TIME PERIOD)                 
* F=DISPLACEMENT FILLER B=GROSS AVERAGE AUDIENCE                                
* O=CALCULATED PUTS                                                             
NUMCATS  EQU   38                                                               
         EJECT                                                                  
DEAN9009 CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 0,DEAN9009,RR=RE                                                 
         LA    RA,2048(RB)         RA IS SECOND BASE                            
         LA    RA,2048(RA)                                                      
         USING DEAN9009+4096,RA                                                 
         LA    R4,2048(RA)         R4 IS THIRD BASE                             
         LA    R4,2048(R4)                                                      
         USING DEAN9009+4096*2,R4                                               
         USING DEMCOND,R8          R8 POINTS TO GLOBAL WORKING STORAGE          
         SPACE 1                                                                
         ST    RE,RELO                                                          
         L     RC,ARREC                                                         
         LA    RC,4(RC)            RC POINTS TO RATING SERVICE RECORD           
         SPACE 1                                                                
         L     R2,AIREC            R2 POINTS TO INTERIM RECORD - SORT           
         USING INTERD,R2           KEY, VALUES, AND DEMO VALUES                 
         SPACE 1                                                                
         B     *+4(R1)             ROUTINE HOOK                                 
         SPACE 1                                                                
         B     READ                PROCESS INPUT TAPE                           
         B     CNVWR               SORT RECORD HOOK                             
         B     MORET               E-O-F ON INPUT                               
         B     EXIT                                                             
         EJECT                                                                  
READ     DS    0H                                                               
         CLI   INTAPESW,1          TEST FOR OPENING INPUT TAPE                  
         BE    READ20                                                           
         MVI   NOTAVAL,0                                                        
         MVI   IPGAASW,C'N'                                                     
         MVI   BYPREAD,X'FF'       SET TO 1ST-TIME-THRU                         
         OPEN  (IN1,(INPUT))                                                    
         CLI   RELOFRST,1          TEST FOR RELOCATED DTF ADDRESS               
         BNE   READ20                                                           
         L     RE,VPUTBUFF         CLEAR THE HPT SAVE AREA                      
         L     RF,HPTSAVLN                                                      
         XCEF                                                                   
         MVI   RELOFRST,0                                                       
         SPACE 1                                                                
READ20   DS    0H                                                               
*              **************FOR NETWORK DATA**************                     
         CLI   BYPREAD,C'P'        PROGRAM RELEASE MODE                         
         BE    RELPROG                                                          
         CLI   BYPREAD,C'S'        SUMMARY RELEASE MODE                         
         BE    RELSUM                                                           
*              **************FOR HUT DATA**************                         
         CLI   BYPREAD,C'G'        PROGRAM RELEASE MODE                         
         BE    RLHPROG               (FUTURE USE)                               
         CLI   BYPREAD,C'H'        SUMMARY RELEASE MODE                         
         BE    RLHSUM                                                           
*                                                                               
         L     R3,ARREC                                                         
         XC    0(4,R3),0(R3)       INSERT VARIABLE LENGTH RECORD                
         MVC   0(2,R3),=H'241'     HEADER                                       
         LA    R3,4(R3)                                                         
         CLI   BYPREAD,1           TEST FOR BYPASSING INPUT READ                
         BE    READ40                                                           
RDTEST   GET   IN1,(R3)                                                         
         USING MIREC,RC                                                         
         CLI   240(R3),C'1'        BYPASS OPTIONAL RECORDS                      
         BE    RDTEST                                                           
         CLI   240(R3),C'3'        BYPASS OPTIONAL RECORDS                      
         BE    RDTEST                                                           
         CLC   MISEQ(2),=C'40'     NO CORRECTIONS FOR NOW                       
         BH    RDTEST                                                           
         B     RDTEST2                                                          
*                                                                               
         CLC   MISEQ(2),=C'40'                                                  
         BE    RDTEST                                                           
         CLC   MISEQ(2),=C'41'                                                  
         BE    RDTEST                                                           
         CLC   MISEQ(2),=C'42'                                                  
         BE    RDTEST                                                           
*                                                                               
RDTEST2  MVI   GAASW,C'N'                                                       
         CLC   MISEQ(2),=C'40'     CHECK GAA FOR DATA                           
         BNE   *+10                                                             
         CLC   MINET,=C'SYN'                                                    
         BNE   *+8                                                              
         CLI   MIESTYPE,C'2'                                                    
         BNE   *+8                                                              
         MVI   GAASW,C'Y'                                                       
*                                                                               
         CLI   BYPREAD,X'FF'       TEST FOR 1ST-TIME-THRU                       
         BNE   READ40                                                           
*                                                                               
READ30   CLI   MISEQ,C'0'          TEST FOR REPORT RECORD                       
         BE    *+6                                                              
         DC    H'0'                WRONG TAPE                                   
         CLI   MITYPE,C' '         DESCRIPTOR                                   
         BE    B0RTN                                                            
         DC    H'0'                WRONG TAPE                                   
*                                                                               
READ40   CLC   SAVEPNUM,MINUM+2    BREAK ON PROGRAM NUMBER                      
         BE    READ41                                                           
         MVC   SAVEPNUM,MINUM+2                                                 
         MVI   BYPASS01,0                                                       
         MVI   VARIOUS,0                                                        
         MVC   VARS,ZEROS                                                       
         MVC   DAYS,ZEROS                                                       
         XC    SAVVAR(49),SAVVAR                                                
*                                                                               
READ41   CLI   MISEQ,C'2'          TEST FOR PROGRAM HH EST RECORDS              
         BNE   READ42                                                           
*        CLI   MITYPE,C'H'         HALF HOUR DETAIL                             
*        BE    H2RTN                                                            
*        CLI   MITYPE,C'P'         PERSONS ESTIMATES                            
*        BE    P2RTN                                                            
         B     READ20                                                           
*                                                                               
READ42   CLI   MISEQ,C'1'          TEST FOR UNIVERSE RECORD                     
         BNE   READ44                                                           
         CLI   MITYPE,C'H'         HOUSEHOLD                                    
         BE    H1RTN                                                            
         CLI   MITYPE,C'P'         PERSONS                                      
         BE    P1RTN                                                            
         B     READ20                                                           
*                                                                               
READ44   CLI   BOOKTYPE,C'I'       TEST BOOKTYPE                                
         BNE   READ46                                                           
         CLI   MIVCR,C'1'          CONVERT NON-VCR (INTEGRATED (SIC))           
         B     READ47                                                           
READ46   CLI   MIVCR,C' '          CONVERT VCR (ASCRIBED)                       
READ47   BNE   READ20                                                           
         CLI   MISEQ,C'4'          TEST FOR PROGRAM HH EST RECORDS              
         BNE   READ70                                                           
*                                                                               
         CLI   BYPASS01,1          BYPASS SINGLE DAY AVERAGES                   
         BE    READ20                                                           
         CLI   MIORIG,C'0'         ***TEMP***                                   
         BE    READ48              *        *                                   
         CLI   MIORIG,C'1'         *        *                                   
         BNE   READ20              *        *                                   
         CLC   MINET,=C'XYZ'       *        *                                   
         NOP   READ20              *        *                                   
READ48   EQU   *                   ***TEMP***                                   
         CLI   MITYPE,C'D'         DESCRIPTOR                                   
         BE    D4RTN                                                            
         CLI   NOTAVAL,1           DATA NOT AVAILABLE                           
         BE    READ20              READ NEXT RECORD                             
         CLI   MITYPE,C'H'         HALF HOUR DETAIL                             
         BE    H4RTN                                                            
         CLI   MITYPE,C'P'         PERSONS ESTIMATES                            
         BE    P4RTN                                                            
         B     READ20                                                           
*                                                                               
READ70   CLI   MISEQ,C'3'          TEST FOR USAGE RECORDS                       
         BNE   READ80                                                           
*        B     READ20              BYPASS FOR NOW                               
         USING H3REC,RC                                                         
         CLC   H3NUMDW,=C'03'      ONLY 4 WKS OR MORE                           
         BL    READ20                                                           
         USING MIREC,RC                                                         
         CLI   MITYPE,C'H'         HOUSEHOLD                                    
         BE    H3RTN                                                            
         CLI   MITYPE,C'P'         PERSONS DEMOGRAPHICS                         
         BE    P3RTN                                                            
         B     READ20                                                           
*                                                                               
READ80   DS    0H                                                               
*                                                                               
READ90   MVI   BYPREAD,0                                                        
         MVI   INTAPESW,X'40'      DROP RECORD                                  
         B     EXIT                                                             
*                                                                               
         EJECT                                                                  
* PROCESS REPORT DESCRIPTOR RECORD                                              
*                                                                               
B0RTN    DS    0H                                                               
         USING B0REC,RC                                                         
*                                                                               
         CLC   =C'NTI NAD REPORT',B0REPORT                                      
         BNE   B0RTN1              WRONG RECORD (MAYBE SYND)                    
*                                                                               
         BAS   RE,DAYRTN           SET UP DAY TABLE                             
         MVC   HDAYTABS,HDAYTAB    SAVE DAY TABLE                               
         PACK  DUB,B0END+1(2)      CONVERT YEAR (YY)                            
         CVB   R0,DUB                                                           
         STC   R0,HALF                                                          
         PACK  DUB,B0END+3(2)      CONVERT YEAR (MO)                            
         CVB   R0,DUB                                                           
         STC   R0,HALF+1                                                        
*        GOTO1 VNETWEEK,DMCB,B0END+1,VGETDAY,VADDAY                             
*        MVC   HALF+1(1),8(R1)     WEEK (NETWORK)                               
         MVC   BOOK1,HALF          KEY BOOK ALLOWS BLACK WEEK                   
*        MVC   HALF+1(1),0(R1)     INTERNAL BOOK FORCES BLACK                   
         MVC   IBOOK1,HALF         WEEK TO PREVIOUS REGULAR WEEK                
         MVC   BOOK1S,BOOK1        SAVE BOOK1                                   
         MVC   IBOOK1S,IBOOK1      SAVE IBOOK1                                  
         MVI   BYPREAD,0           SET TO READ NEXT RECORD                      
*                                                                               
B0RTN1   MVI   INTAPESW,X'40'      DROP THIS RECORD                             
         CLI   RPRINT,0            TEST FOR PRINT OF RAT SER REC                
         BE    *+8                 NO                                           
         OI    INTAPESW,X'03'      YES-SET INDICATOR FOR CONTROLLER             
         B     EXIT                                                             
*                                                                               
         EJECT                                                                  
* PROCESS HOUSEHOLD UNIVERSE RECORD                                             
*                                                                               
H1RTN    DS    0H                                                               
         USING H1REC,RC                                                         
*                                                                               
         CLC   H1MKTBRK,=C'000'    BASIC CELL ONLY                              
         BNE   H1R10                                                            
         PACK  DUB,H1HHUNIV        UNIVERSE SAVED FOR CNVWR RTN                 
         CVB   RF,DUB                                                           
         ST    RF,SVHHUNIV         SAVE THE HOUSEHOLD UNIVERSE                  
*                                                                               
H1R10    MVI   INTAPESW,X'40'      DROP RECORD                                  
         MVI   BYPREAD,0           SET TO READ NEXT RECORD                      
         B     EXIT                                                             
*                                                                               
*        PROCESS PERSONS UNIVERSES                                              
P1RTN    DS    0H                  P1 AND P2 RECORDS HAVE SAME FORMAT           
         USING P1REC,RC                                                         
*                                                                               
* CONVERT AND SLOT THE DEMOS                                                    
         PACK  DUB,P1DEMGRP                                                     
         CVB   R1,DUB                                                           
         STH   R1,DMCB+2                                                        
         PACK  DUB,P1MKTBRK                                                     
         CVB   R1,DUB                                                           
         STH   R1,DMCB                                                          
         LA    R1,P1DCATS                                                       
         ST    R1,DMCB+4                                                        
         BAS   RE,PROCDEMS                                                      
         MVI   BYPREAD,0                                                        
         B     READ20                                                           
***************************************************************                 
*                                                                               
         EJECT                                                                  
* PROCESS HOUSEHOLD SAMPLE COUNTS RECORD                                        
*                                                                               
H2RTN    DS    0H                                                               
         USING H2REC,RC                                                         
         USING INTABD,R1                                                        
         CLC   H2MKTBRK,=C'000'    BASIC CELL ONLY                              
         BNE   H2R90                                                            
*                                                                               
         LA    R1,INTAB            R1 - INTAB COUNT TABLE                       
         LA    R0,INTABS           7 DAYS                                       
H2R10    OC    INTABDAT,INTABDAT                                                
         BZ    H2R20               NEXT AVAILABLE ENTRY IN TABLE                
         LA    R1,L'INTABTAB(R1)                                                
         BCT   R0,H2R10                                                         
         DC    H'0'                                                             
*                                                                               
H2R20    ST    R1,INTABADR         SAVE ADDRESS OF ENTRY FOR P2RTN              
         LA    RE,NETDAYTB                                                      
         LA    R6,H2DAYS                                                        
         LA    R0,L'H2DAYS         MON (X'40') THRU SUN (X'01')                 
H2R30    CLI   0(R6),C'1'                                                       
         BE    H2R40                                                            
         LA    R6,1(R6)                                                         
         LA    RE,L'NETDAYTB(RE)                                                
         BCT   R0,H2R30                                                         
         DC    H'0'                                                             
*                                                                               
H2R40    MVC   INTABDAY,0(RE)      DAY OF WEEK                                  
         LA    R6,INTABDAT                                                      
         GOTO1 VDATCON,DMCB,(0,H2START+1),(3,(R6))   DATE (YYMMDD)              
*                                                                               
H2R90    MVI   BYPREAD,0           FOR P2REC, SKIP PROCESSING AND               
         B     READ20              READ NEXT REC W/O GOING TO CONTRLLER         
*                                                                               
         EJECT                                                                  
* PROCESS PERSONS SAMPLE COUNTS RECORD                                          
*                                                                               
P2RTN    DS    0H                                                               
         USING P2REC,RC                                                         
         USING INTABD,R1                                                        
         L     R1,INTABADR         RESTORE INTAB ADDRESS (FROM H2RTN)           
*                                                                               
         L     R7,ARREC                                                         
         LA    R7,4(R7)                                                         
         LA    R6,INTABCNT                                                      
         LA    RE,INTACCS-INTRECLN                                              
         SR    R6,RE               DISPLACEMENT TO INTACCS                      
*                                                                               
         PACK  DUB,P2DEMGRP                                                     
         CVB   R1,DUB                                                           
         STH   R1,DMCB+2                                                        
         PACK  DUB,P2MKTBRK                                                     
         CVB   R1,DUB                                                           
         STH   R1,DMCB                                                          
         LA    R1,P2DCATS                                                       
         ST    R1,DMCB+4                                                        
         BAS   RE,PROCDEMS                                                      
         MVI   BYPREAD,0                                                        
         B     READ20                                                           
*                                                                               
         EJECT                                                                  
* PROCESS HOUSEHOLD USAGE RECORD                                                
*                                                                               
H3RTN    DS    0H                                                               
         USING H3REC,RC                                                         
         MVC   SVMPROJ,H3AVEHUT    MARKET BREAK HOMES                           
         CLC   H3MKTBRK,=C'000'                                                 
         BE    RLHPROG                                                          
H3RTN1   MVC   SVPROJ,H3AVEHUT     USA HOMES                                    
*                                                                               
         LA    RE,H3DAYTAB                                                      
H3DAY    CLI   0(RE),X'FF'                                                      
         BE    H3R28                                                            
         CLC   H3RCNT,0(RE)                                                     
         BE    H3R28                                                            
         LA    RE,2(RE)                                                         
         B     H3DAY                                                            
*                                                                               
H3R28    MVC   INTDYBIT,1(RE)      INTERNAL DAY CODE                            
         MVC   INTDAYWK,2(RE)                                                   
         MVI   INTRTYP,C'Q'                                                     
         MVI   INTDUR,30                                                        
         MVC   INTBOOK,BOOK1                                                    
         PACK  DUB,H3EVSHR(4)                                                   
         CVB   RF,DUB                                                           
         STCM  RF,3,INTSTIM                                                     
         CLC   H3EVSMIN,=C'30'     STARTS ON HALF HOUR                          
         BNE   *+8                                                              
         LA    RF,100(RF)          BUMP HOUR                                    
         CLC   H3EVSMIN,=C'00'     STARTS ON HOUR                               
         BNE   *+8                                                              
         LA    RF,30(RF)           BUMP MINUTES                                 
         STCM  RF,3,INTETIM                                                     
         MVC   INTIBOOK,IBOOK1                                                  
         MVC   INTSTA(5),=C'HUTDN'                                              
         MVI   INTADUR,30                                                       
         MVI   INTDUR,2                                                         
         MVI   INTDURM,30                                                       
         MVC   SAVEINT(L'SAVEINT),INTVALS                                       
         EJECT                                                                  
         B     READ20              READ NEXT REC W/O GOING TO CONTRLLER         
*                                                                               
         EJECT                                                                  
* PROCESS PERSONS DEMOGRAPHICS RECORD                                           
*                                                                               
P3RTN    DS    0H                                                               
         USING P3REC,RC                                                         
*                                                                               
         L     R7,ARREC                                                         
         LA    R7,4(R7)                                                         
         L     R6,AIREC                                                         
*                                                                               
         PACK  DUB,P3DEMGRP                                                     
         CVB   R1,DUB                                                           
         STH   R1,DMCB+2                                                        
         PACK  DUB,P3MKTBRK                                                     
         CVB   R1,DUB                                                           
         STH   R1,DMCB                                                          
         LA    R1,P3DCATS                                                       
         ST    R1,DMCB+4                                                        
         BAS   RE,PROCDEMS                                                      
         MVI   BYPREAD,0                                                        
         B     READ20                                                           
*                                                                               
         EJECT                                                                  
RELPROG  CLI   BYPREAD,C'P'        0 IF FIRST TIME                              
         BE    *+8                                                              
         BAS   RE,GENCATS          GENERATE MISSING BOOK CATAGORIES             
*                                                                               
         MVI   BYPREAD,C'P'                                                     
         MVC   INTVALS(L'SAVEINT),SAVEINT                                       
         L     R9,VCPRINT                                                       
         USING DPRINT,R9                                                        
         XC    P(132),P                                                         
         B     RELPROG2                                                         
RELPROG1 MVI   BYPREAD,C'S'                                                     
         MVI   RELSLOT,0                                                        
         MVI   SUMSLOT,0                                                        
         B     RELSUM                                                           
*        B     D4R01A                                                           
         SPACE 2                                                                
RELPROG2 L     RE,=A(CRCOTAB)                                                   
RELPROG3 CLI   0(RE),X'FF'                                                      
         BE    RELPROG1                                                         
         CLC   1(1,RE),RELSLOT                                                  
         BE    *+12                                                             
         LA    RE,5(RE)                                                         
         B     RELPROG3                                                         
         CLI   3(RE),0                                                          
         BNE   RELPROG4                                                         
         ZIC   RE,RELSLOT                                                       
         LA    RE,1(RE)                                                         
         STC   RE,RELSLOT                                                       
         B     RELPROG2                                                         
*                                                                               
RELPROG4 MVC   INTRSF,3(RE)                                                     
         MVC   INTBTYP,4(RE)                                                    
         ZIC   RE,INTRSF                                                        
         CVD   RE,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  P+10(3),DUB+6(2)                                                 
         MVC   P+60(60),INTPNAME                                                
         MVC   P+20(2),PDPT2                                                    
         MVC   P+23(1),PDPT                                                     
         TM    PWK1DTYP,X'04'                                                   
         BZ    *+10                                                             
         MVC   P+25(7),=C'SPECIAL'                                              
         MVC   P+34(2),PTYP                                                     
         ZIC   RE,PWK1DURM                                                      
         CVD   RE,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  P+37(3),DUB+6(2)                                                 
         DROP  R9                                                               
*        GOTO1 VPRINTER                <------TESTING                           
         ZIC   RE,RELSLOT                                                       
         MH    RE,SLOTLN                                                        
         LA    RE,DEMAREA(RE)                                                   
         LH    RF,SLOTLN                                                        
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   INTACCS(0),0(RE)                                                 
         ZIC   RE,RELSLOT                                                       
         LA    RE,1(RE)                                                         
         STC   RE,RELSLOT                                                       
         B     P4R40                                                            
         EJECT                                                                  
RELSUM   ZIC   RE,SUMSLOT                                                       
         LR    RF,RE                                                            
         MH    RE,=H'16'                                                        
         A     RE,=A(PTYPTAB)                                                   
         CLI   0(RE),X'FF'                                                      
         BE    RELSUMX                                                          
         MVC   INTVALS(L'SAVEINT),SAVEINT                                       
         MVC   BYTE,INTDTYP        TEST REG OR SPECIAL                          
         NC    BYTE,8(RE)                                                       
         CLI   BYTE,0                                                           
         BE    INCRSUM                                                          
         CLI   BYTE,SP                                                          
         BNE   *+12                                                             
         CLI   INTDURM,30          EXCLUDE DURATIONS OF UNDER 5 MIN             
         BL    INCRSUM                                                          
         CLI   PSHORT,C'Y'         AND SHORT DURATION PROGRAMS                  
         BE    INCRSUM                                                          
         CLC   0(2,RE),=C'  '      CHECK PROGRAM TYP                            
         BE    *+10                                                             
         CLC   0(2,RE),PTYP                                                     
         BNE   INCRSUM                                                          
         OC    2(2,RE),2(RE)       CHECK SPOT LENGTH                            
         BZ    RELSUM1                                                          
         CLC   INTDURM,2(RE)                                                    
         BL    INCRSUM                                                          
         CLC   INTDURM,3(RE)                                                    
         BH    INCRSUM                                                          
RELSUM1  CLC   11(3,RE),=C'   '    3 NET EXCLUDE FOX                            
         BNE   *+10                                                             
         CLC   PNET(3),=C'FOX'                                                  
         BE    INCRSUM                                                          
         CLC   11(3,RE),=C'   '    CHECK NETWORK                                
         BE    *+10                                                             
         CLC   11(3,RE),PNET                                                    
         BNE   INCRSUM                                                          
         LA    R1,4(RE)            CHECK DAYPART                                
RELSUM2  CLI   0(R1),C' '                                                       
         BE    INCRSUM                                                          
         CLC   0(1,R1),PDPT                                                     
         BE    *+12                                                             
         LA    R1,1(R1)                                                         
         B     RELSUM2                                                          
*                                                                               
         CLI   15(RE),C'Z'         SEND HUT ONLY                                
         BE    *+8                                                              
         CLI   11(RE),C' '                                                      
         BNE   *+10                                                             
         MVC   INTSTA,=C'HUTDN'    'T' FOR PROGRAM TYPES'HUTT                   
         MVI   INTSTA+3,C'T'                                                    
         CLI   0(RE),C' '                                                       
         BE    *+8                                                              
         MVI   INTSTA+3,C'T'                                                    
*                                                                               
         STC   RF,SUMSLOT                                                       
         SR    R1,R1                                                            
         ICM   R1,3,9(RE)                                                       
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         STCM  R1,3,INTPNUM        SET PROGRAM NUMBER AND NAME                  
         CLC   INTPNUM,=H'7500'    HANDLE SPECIAL INF                           
         BNE   RELSUM2B                                                         
         SR    RE,RE                                                            
         ZIC   R1,INTDYBIT         COUNT THE DAYS                               
         SR    R0,R0                                                            
         ZIC   R1,INTDYBIT                                                      
         SR    R0,R0                                                            
         SLL   R1,25                                                            
RELSUM2A SLDA  R0,1                                                             
         LTR   R0,R0                                                            
         BZ    *+8                                                              
         LA    RE,1(RE)            BUMP COUNT OF DAYS                           
         LTR   R1,R1                                                            
         BNZ   RELSUM2A                                                         
         CH    RE,=H'1'                                                         
         BE    *+10                                                             
         MVC   INTPNUM,=H'7600'    MAKE INTO MULTI DAY                          
         SPACE 2                                                                
RELSUM2B L     R9,=A(PTDPNAME)                                                  
         XC    INTPNAME,INTPNAME                                                
RELSUM3  CLC   INTPNUM,0(R9)                                                    
         BE    RELSUM3A                                                         
         LA    R9,27(R9)                                                        
         CLI   0(R9),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         B     RELSUM3                                                          
RELSUM3A MVC   INTPNAME(25),2(R9)                                               
         L     R9,=A(PTYTAB)                                                    
         USING PTYTABD,R9                                                       
RELSUM3B CLC   INTPNUM,0(R9)                                                    
         BE    RELSUM3C                                                         
         LA    R9,PTYLN(R9)                                                     
         CLI   0(R9),X'FF'                                                      
         BNE   RELSUM3B                                                         
RELSUM3C MVC   INTSTIM,PTYSTIM     BUILD THE CONTROL DATA                       
         MVC   INTETIM,PTYETIM                                                  
         MVC   INTDURM,PTYDUR                                                   
         ZIC   RF,INTDURM                                                       
         SR    RE,RE                                                            
         D     RE,=F'15'                                                        
         STC   RF,INTDUR                                                        
         MVC   INTDYBIT,PTYDYBIT                                                
         MVC   INTPTYP,PTYPTYP                                                  
         MVC   INTDTYP,PTYDTYP                                                  
         MVC   INTDAYWK,PTYDAYWK                                                
         GOTO1 VHRTOQH,DMCB,INTSTIM,INTSQH                                      
         GOTO1 VHRTOQH,DMCB,INTETIM,INTEQH                                      
         DROP  R9                                                               
*                                  RELEASE THE DEMOS                            
RELSUM4A L     RE,=A(CRCOTAB)                                                   
RELSUM4B CLI   0(RE),X'FF'                                                      
         BE    RELSUM4X                                                         
         CLC   1(1,RE),RELSLOT                                                  
         BE    *+12                                                             
         LA    RE,5(RE)                                                         
         B     RELSUM4B                                                         
         CLI   3(RE),0             DON'T OUTPUT SLOT                            
         BNE   RELSUM4D                                                         
         ZIC   RE,RELSLOT          TRY THE NEXT ONE                             
         LA    RE,1(RE)                                                         
         STC   RE,RELSLOT                                                       
         B     RELSUM4A                                                         
*                                                                               
RELSUM4D MVC   INTRSF,3(RE)        SET OUTPUT SLOT                              
         MVC   INTBTYP,4(RE)                                                    
         ZIC   RE,RELSLOT                                                       
         MH    RE,SLOTLN                                                        
         LA    RE,DEMAREA(RE)                                                   
         LH    RF,SLOTLN                                                        
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   INTACCS(0),0(RE)                                                 
         ZIC   RE,RELSLOT                                                       
         LA    RE,1(RE)                                                         
         STC   RE,RELSLOT                                                       
         B     RELSUM5                                                          
RELSUM4X ZIC   RF,SUMSLOT          NEXT SUMMARY BLOCK                           
         LA    RF,1(RF)                                                         
         STC   RF,SUMSLOT                                                       
         MVI   RELSLOT,0                                                        
*                                                                               
RELSUM5  L     R9,VCPRINT                                                       
         USING DPRINT,R9                                                        
         UNPK  P+9(4),DUB+5(3)                                                  
*        GOTO1 VPRINTER                                                         
         DROP  R9                                                               
         B     P4R40                                                            
*                                                                               
INCRSUM  LA    RF,1(RF)                                                         
         STC   RF,SUMSLOT                                                       
         B     RELSUM                                                           
*                                                                               
RELSUMX  MVI   BYPREAD,0                                                        
         MVI   SUMSLOT,0                                                        
         MVI   RELSLOT,0                                                        
         B     D4R01A                                                           
         EJECT                                                                  
RLHPROG  CLC   INTSTA(5),=C'HUTDN' VERY FIRST TIME                              
         BNE   H3RTN1                                                           
         CLI   BYPREAD,C'P'        0 IF FIRST TIME                              
         BE    *+8                                                              
         BAS   RE,GENCATS          GENERATE MISSING BOOK CATAGORIES             
*                                                                               
         MVI   BYPREAD,C'G'                                                     
         MVC   INTVALS(L'SAVEINT),SAVEINT                                       
RLHPROG1 MVI   BYPREAD,C'H'                                                     
         MVI   RELSLOT,0                                                        
         MVI   SUMSLOT,0                                                        
         B     RLHSUM                                                           
         SPACE 2                                                                
         EJECT                                                                  
RLHSUM   ZIC   RE,SUMSLOT                                                       
         LR    RF,RE                                                            
         MH    RE,=H'10'                                                        
         A     RE,=A(DPTTAB)                                                    
         CLI   0(RE),X'FF'                                                      
         BE    RLHSUMX                                                          
         MVC   INTVALS(L'SAVEINT),SAVEINT                                       
*                                                                               
         CLC   INTDYBIT,X'7C'      M-F IN                                       
         BNE   *+14                                                             
         CLC   INTDYBIT,8(RE)      M-F OUT                                      
         BE    RLHSUM0                                                          
*                                                                               
         CLI   8(RE),X'7C'         M-F GIVEN BY NTI                             
         BE    RLHISUM                                                          
         OC    INTDYBIT,8(RE)      ANY OVERLAP IN DAYS                          
         BZ    RLHISUM                                                          
RLHSUM0  CLC   INTSTIM(2),4(RE)                                                 
         BL    RLHISUM                                                          
         CLC   INTSTIM(2),6(RE)                                                 
         BH    RLHISUM                                                          
         STC   RF,SUMSLOT                                                       
         MVC   INTPNUM,0(RE)       SET DAYPART NUMBER                           
         SPACE 2                                                                
RLHSUM2B L     R9,=A(PTDPNAME)                                                  
         XC    INTPNAME,INTPNAME                                                
RLHSUM3  CLC   INTPNUM,0(R9)                                                    
         BE    RLHSUM3A                                                         
         LA    R9,27(R9)                                                        
         CLI   0(R9),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         B     RLHSUM3                                                          
RLHSUM3A MVC   INTPNAME(25),2(R9)                                               
         DROP  R9                                                               
*                                  RELEASE THE DEMOS                            
RLHSUM4A L     RE,=A(CRCOTAB)                                                   
RLHSUM4B CLI   0(RE),X'FF'                                                      
         BE    RLHSUM4X                                                         
         CLC   1(1,RE),RELSLOT                                                  
         BE    *+12                                                             
         LA    RE,5(RE)                                                         
         B     RLHSUM4B                                                         
         CLI   3(RE),0             DON'T OUTPUT SLOT                            
         BNE   RLHSUM4D                                                         
         ZIC   RE,RELSLOT          TRY THE NEXT ONE                             
         LA    RE,1(RE)                                                         
         STC   RE,RELSLOT                                                       
         B     RLHSUM4A                                                         
*                                                                               
RLHSUM4D MVC   INTRSF,3(RE)        SET OUTPUT SLOT                              
         MVC   INTBTYP,4(RE)                                                    
         ZIC   RE,RELSLOT                                                       
         MH    RE,SLOTLN                                                        
         LA    RE,DEMAREA(RE)                                                   
         LH    RF,SLOTLN                                                        
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   INTACCS(0),0(RE)                                                 
         ZIC   RE,RELSLOT                                                       
         LA    RE,1(RE)                                                         
         STC   RE,RELSLOT                                                       
         B     RLHSUM5                                                          
RLHSUM4X ZIC   RF,SUMSLOT          NEXT SUMMARY BLOCK                           
         LA    RF,1(RF)                                                         
         STC   RF,SUMSLOT                                                       
         MVI   RELSLOT,0                                                        
*                                                                               
RLHSUM5  L     R9,VCPRINT                                                       
         USING DPRINT,R9                                                        
         UNPK  P+9(4),DUB+5(3)                                                  
*        GOTO1 VPRINTER                                                         
         DROP  R9                                                               
         B     P4R40                                                            
*                                                                               
RLHISUM  LA    RF,1(RF)                                                         
         STC   RF,SUMSLOT                                                       
         B     RLHSUM                                                           
*                                                                               
RLHSUMX  MVI   BYPREAD,0                                                        
         MVI   SUMSLOT,0                                                        
         MVI   RELSLOT,0                                                        
         XC    INTSTA,INTSTA                                                    
         B     H3RTN1                                                           
         EJECT                                                                  
* PROCESS PROGRAM DESCRIPTOR RECORD                                             
*                                                                               
D4RTN    DS    0H                                                               
         USING D4REC,RC                                                         
*                                                                               
         MVC   SVMPROJ,D4AVEHUT                                                 
         CLC   D4MKTBRK,=C'000'    RESET AVAILABILITY ON PRIME REC              
         BNE   READ20                                                           
         MVI   NOTAVAL,0                                                        
         CLI   D4BREAK,C'1'        ZAP BREAKOUTS FOR NOW                        
         BE    *+14                                                             
         CLC   D4DYSWKS,=C'00'                                                  
         BE    OTO                                                              
         CLC   D4DYSWKS,=C'03'     ONLY 4 OR 5 WEEKS FOR NOW                    
         BH    *+8                                                              
         MVI   NOTAVAL,1                                                        
OTO      CLI   NOTAVAL,1           BYPASS EXTRA DESC. RECS                      
         BE    D4RX                WHICH MAY BE MISSING IND                     
         CLI   D4NAVAL,C'1'        N/A FLAG                                     
         BNE   *+12                                                             
         MVI   NOTAVAL,1                                                        
         B     D4RX                                                             
         MVC   SVPROJ,D4AVEHUT                                                  
*                                                                               
         XC    HWCAREA,HWCAREA                                                  
*                                                                               
         CLI   D4ORIG,C'0'         TEST CORRECTION RECORD                       
         BE    D4R01               NO                                           
         MVI   CORRSW,1            SET CORRECTION SWITCH                        
         MVC   INTPNO,BOOK1S       ORIGINATING BOOK FOR CORRECTIONS             
         BAS   RE,DAYRTN           SET UP DAY TABLE                             
         PACK  DUB,D4END+1(2)      ***TEMP*** CONVERT YEAR (YY)                 
         CVB   R0,DUB              ***TEMP***                                   
         STC   R0,HALF             ***TEMP***                                   
         PACK  DUB,D4END+3(2)      ***TEMP*** CONVERT YEAR (MM)                 
         CVB   R0,DUB              ***TEMP***                                   
         STC   R0,HALF+1           ***TEMP***                                   
*        GOTO1 VNETWEEK,DMCB,D4END+1,VGETDAY,VADDAY                             
*        MVC   HALF+0(1),4(R1)     YEAR                                         
*        MVC   HALF+1(1),8(R1)     WEEK (NETWORK)                               
         MVC   BOOK1,HALF          KEY BOOK ALLOWS BLACK WEEK                   
*        MVC   HALF+1(1),0(R1)     INTERNAL BOOK FORCES BLACK                   
         MVC   IBOOK1,HALF         WEEK TO PREVIOUS REGULAR WEEK                
*                                                                               
D4R01    CLI   PRVPRGSW,0                                                       
         BNE   RELPROG                                                          
*                                                                               
D4R01A   CLC   D4TOTDUR,=C'000000' ARE TOTAL FIELDS ON THIS RECORD              
         BE    *+10                                                             
         MVC   SVD4,D4STA          IF YES - SAVE POS.182-240                    
         MVC   D4STA(L'SVD4),SVD4  IF NOT - RESTORE FROM A PREVIOUS D4          
*                                                                               
         LA    RE,D4DAYS           SET UP SAVETIME TABLE FOR PDATA              
         XC    SAVETIME(56),SAVETIME                                            
         LA    RF,SAVETIME                                                      
         LA    R0,7                                                             
D4R02    CLI   0(RE),C'1'                                                       
         BNE   D4R03                                                            
         MVC   0(2,RF),D4EVSHR     START HOUR                                   
         MVC   2(2,RF),D4EVSMIN    START MINUTE                                 
         MVC   4(4,RF),D4DUR       DURATION IN MINUTES                          
D4R03    LA    RE,1(RE)                                                         
         LA    RF,L'SAVETIME(RF)                                                
         BCT   R0,D4R02                                                         
*                                                                               
         EJECT                                                                  
         CLC   D4DYSWKS,=C'01'     TEST AVERAGES                                
         BE    D4R06                                                            
         CLI   D4BREAK,C'1'        BREAKOUT                                     
         BE    D4R10                                                            
         LA    RE,D4DAYS                                                        
         LA    RF,DAYS             SET ON POINTERS FOR INDIVIDUAL DAYS          
         LA    R0,7                (NEEDED FOR PROCESSING VARIOUS)              
D4R05    CLI   0(RE),C'1'                                                       
         BNE   *+8                                                              
         MVI   0(RF),C'1'                                                       
         LA    RE,1(RE)                                                         
         LA    RF,1(RF)                                                         
         BCT   R0,D4R05                                                         
         B     D4R10                                                            
*                                                                               
D4R06    CLC   D4DAYS,=C'1111100'  M-F                                          
         BE    D4R10                                                            
         CLC   D4DAYS,=C'1111111'  M-S                                          
         BE    D4R10                                                            
         CLC   D4NET,=C'SYN'       SYND HAVE NO INDIV. DAY                      
         BNE   *+12                                                             
         MVI   VARIOUS,1           SO FUDGE IT HERE                             
         B     D4R07                                                            
*                                  VARIOUS                                      
         CLI   VARIOUS,1                                                        
         BE    D4R07                                                            
         MVI   VARIOUS,1                                                        
         MVC   VARS,ZEROS          1ST-TIME-THRU                                
         XC    VARSTIME(56),VARSTIME                                            
*                                                                               
         LA    RE,DAYS             TEST NUMBER OF DAYS IN AVERAGE               
         SR    RF,RF                                                            
         LA    R0,7                                                             
         CLI   0(RE),C'1'                                                       
         BNE   *+8                                                              
         LA    RF,1(RF)                                                         
         LA    RE,1(RE)                                                         
         BCT   R0,*-16                                                          
         CH    RF,=H'1'            BYPASS SINGLE DAY AVERAGES                   
         BH    D4R07                                                            
         MVI   VARIOUS,0                                                        
         OC    INTVAR(49),INTVAR   DO WE ALREADY HAVE A VAR                     
         BNZ   D4RX                                                             
         MVI   BYPASS01,1                                                       
         B     D4RX                                                             
*                                                                               
D4R07    LA    RE,D4DAYS                                                        
         LA    RF,VARS             SET ON POINTERS FOR VARIOUS DAYS             
         LA    R0,7                                                             
D4R08    CLI   0(RE),C'1'                                                       
         BNE   *+8                                                              
         MVI   0(RF),C'1'                                                       
         LA    RE,1(RE)                                                         
         LA    RF,1(RF)                                                         
         BCT   R0,D4R08                                                         
         CLC   D4NET,=C'SYN'       NO INDIV. DAYS FO SYND.                      
         BNE   *+10                                                             
         MVC   DAYS,VARS           SO FORCE THIS                                
*                                                                               
         EJECT                                                                  
D4R10    XC    PVALS,PVALS                                                      
         PACK  DUB,D4NUM+2(5)      PROGRAM NUMBER                               
         CVB   R0,DUB                                                           
         STCM  R0,3,PNUM                                                        
         PACK  DUB,D4TOTDUR                                                     
         CVB   R0,DUB                                                           
         STCM  R0,3,PTOTDUR                                                     
         MVC   PDPT,D4DPTLL        TYPE DAYPART                                 
         MVC   PDPT2,D4DPT                                                      
         MVC   PNET,D4NET          SET UP R/S CALL LETTERS                      
         MVI   PNET+3,C' '                                                      
         CLC   D4NET,=C'AGG'       NON NETWORK SOURCES                          
         BNE   *+10                                                             
         MVC   PNET+3(1),D4NUM+6                                                
         CLC   D4NET,=C'SYN'       SYNDICATION                                  
         BNE   *+10                                                             
         MVC   PNET(3),D4SYNID     SET SYNDICATION CALL LETTERS                 
         MVC   PNAME,D4NAME                                                     
         MVC   PTITLE,D4TITLE                                                   
         MVC   PTYP,D4ALPHA                                                     
         MVC   PPREM,D4PREM                                                     
         MVC   PSHORT,D4SHORT                                                   
*                                                                               
         MVC   INTMRKT,=H'200'     SET NAD MARKET TO 200                        
         L     RE,=A(NETTAB)                                                    
         LA    R0,NETWORKS                                                      
         CLC   PNET,0(RE)          GET CALL LETTERS FOR NETWORK                 
         BE    D4GSTA                                                           
         LA    RE,L'NETTAB(RE)                                                  
         BCT   R0,*-14                                                          
         CLC   D4NET,=C'SYN'                                                    
         BE    *+6                                                              
         DC    H'0'                                                             
         L     R9,VCPRINT                                                       
         USING DPRINT,R9                                                        
         MVC   P(4),D4SYNID                                                     
         MVC   P+5(10),=C'***BAD SYND***'                                       
         GOTO1 VPRINTER                                                         
         DROP  R9                                                               
         MVC   INTSTA(5),=C'    N'                                              
         MVC   INTSTA(3),D4SYNID                                                
         B     *+10                                                             
D4GSTA   MVC   INTSTA,4(RE)                                                     
         MVC   INTSTA+3(2),=C'PN'                                               
         CLC   D4NET,=C'SYN'                                                    
         BNE   *+8                                                              
         MVI   INTSTA+4,C'S'                                                    
*                                                                               
         PACK  DUB,D4PROJ          PROJECTION (XXX,XXX,XXX)                     
         CVB   R1,DUB                                                           
         SR    R0,R0                                                            
         AH    R1,=H'5000'         ROUND TO TEN THOUSANDS                       
         D     R0,=F'10000'                                                     
         STCM  R1,3,PWK1AUD        REACH                                        
*                                                                               
         PACK  DUB,D4STA                                                        
         CVB   R1,DUB                                                           
         STCM  R1,3,PWK1STAC       STATION COUNT                                
*                                                                               
         PACK  DUB,D4COV                                                        
         CVB   R1,DUB                                                           
         STCM  R1,3,PWK1COV        COVERAGE                                     
*                                                                               
         TM    D4AVEHUT+(L'D4AVEHUT-1),X'F0'                                    
         BO    *+10                                                             
         MVC   D4AVEHUT,=16C'0'                                                 
         PACK  DUB,D4AVEHUT                                                     
         CVB   RF,DUB                                                           
         ST    RF,SVAVGHI          SAVE AVG HOMES IMPS                          
*                                                                               
         LA    RE,TYPTAB           POINT RE AT TELECAST TYPE TABLE              
         LA    R0,TYPES            COUNTER                                      
D4R20    CLC   D4SPEC,0(RE)        0=REGULAR   1=SPECIAL                        
         BNE   *+14                                                             
         CLC   D4REPEAT,1(RE)      BLANK=ORIGINAL   Y=REPEAT                    
         BE    D4R30                                                            
         LA    RE,L'TYPTAB(RE)                                                  
         BCT   R0,D4R20                                                         
         DC    H'0'                BLOW UP IF TYPE IS NOT IN TABLE              
D4R30    MVC   PWK1DTYP,2(RE)      EXTRACT CORRESPONDING BIT SETTING            
*                                                                               
         CLI   INTSTA+4,C'S'       SYNDICATOR                                   
         BNE   D4R31                                                            
         CLI   D4TTYPE,C'C'                                                     
         BNE   *+8                                                              
         OI    PWK1DTYP,X'18'      ORIG+REPEAT PROGRAMMING                      
         CLI   D4TTYPE,C'M'                                                     
         BNE   *+8                                                              
         OI    PWK1DTYP,X'20'      MULTIPLE PROGRAMS                            
*                                                                               
D4R31    CLI   D4OPT,C'1'          TEST OPTIONAL DATA                           
         BNE   D4R34                                                            
* NOTE - EARLY TAPES OF SEP/87 HAVE ERROR FOR NON-VCR (INTEGRATED)              
         CLI   D4VCR,C' '          TEST VCR                                     
         BE    D4R33                                                            
         CLC   D4DYSWKS,=C'01'     TEST AVERAGES                                
         BE    D4R34                                                            
         CLI   D4MULTI,C' '        TEST MULTI-DAYS                              
         BE    D4R34                                                            
D4R33    OI    PWK1DTYP,X'80'      SET OPTIONAL BIT IN PHTDTYP                  
*                                                                               
D4R34    MVI   PWK1RSF,0                                                        
         CLI   D4BREAK,C'1'        TEST FOR REDUCED STATION                     
         BNE   *+8                                                              
         MVI   PWK1RSF,X'01'       REDUCED STATION INDICATOR                    
*                                                                               
         MVC   INTDPT,PDPT         PDPT IS ALWAYS ZERO                          
         MVC   INTDPT2,PDPT2                                                    
         MVC   INTPREM,PPREM                                                    
         MVC   INTPNUM,PNUM                                                     
         MVC   INTPTYP,PTYP                                                     
         MVC   INTPNAME,PNAME                                                   
         MVC   INTTITLE,PTITLE                                                  
         MVC   INTCOV,PTOTDUR                                                   
         MVI   INTSTYP,0           SET STATION TYPE TO PARENT                   
         MVI   INTMTYP,0           METRO A MARKET                               
*                                                                               
         MVC   INTBOOK,BOOK1       WEEK VALUES                                  
         MVC   INTIBOOK,IBOOK1                                                  
         MVC   INTAUD,PWK1AUD                                                   
         MVC   INTSTAC,PWK1STAC                                                 
*        MVC   INTCOV,PWK1COV                                                   
         MVC   INTDTYP,PWK1DTYP                                                 
         MVC   INTRSF,PWK1RSF                                                   
         MVI   PRVPRGSW,1                                                       
         L     R9,VCPRINT                                                       
         USING DPRINT,R9                                                        
         MVC   P(60),0(RC)                                                      
         MVC   P+60(60),INTPNAME                                                
         DROP  R9                                                               
*        GOTO1 VPRINTER                                                         
*                                                                               
         EJECT                                                                  
D4R40    LA    RE,D4DAYS           POINT TO DAY FIELDS                          
D4R42    LA    R0,7                COUNTER                                      
         LA    R5,X'40'            START AT MONDAY                              
         SR    RF,RF               CLEAR CUMULATIVE BITS                        
*                                                                               
D4R50    CLI   0(RE),C'0'          TEST FOR NO ACTIVITY                         
         BE    D4R60                                                            
         CLI   0(RE),C'1'          TEST FOR PROGRAM RAN                         
         BNE   D4R60                                                            
         OR    RF,R5               UPDATE CUMULATIVE BITS                       
*                                                                               
D4R60    LA    RE,1(RE)                                                         
         SRL   R5,1                NEXT DAY                                     
         BCT   R0,D4R50                                                         
*                                                                               
         STC   RF,INTDAYWK         SAVE BITS                                    
         MVI   BYTE,X'90'          SET INTERNAL DAY CODE TO VAR                 
         LA    RE,NETDAYTB                                                      
         LA    R0,NETDAYS                                                       
         CLC   INTDAYWK,0(RE)      TEST BITS VS. TABLE                          
         BE    *+16                                                             
         LA    RE,L'NETDAYTB(RE)                                                
         BCT   R0,*-14                                                          
         B     D4R70                                                            
         MVC   BYTE,1(RE)          INTERNAL DAY CODE                            
*                                                                               
D4R70    MVC   PDAY1,BYTE                                                       
         MVC   PDAY1BIT,INTDAYWK                                                
         CLI   D4W1,C'0'                                                        
         BE    *+8                                                              
         OI    PWKBIT,X'08'                                                     
         CLI   D4W2,C'0'                                                        
         BE    *+8                                                              
         OI    PWKBIT,X'04'                                                     
         CLI   D4W3,C'0'                                                        
         BE    *+8                                                              
         OI    PWKBIT,X'02'                                                     
         CLI   D4W4,C'0'                                                        
         BE    *+8                                                              
         OI    PWKBIT,X'01'                                                     
         OC    INTDAYWK,PWKBIT                                                  
*                                                                               
         GOTO1 PDATA,DMCB,SAVETIME,PDAY1BIT                                     
*                                                                               
         MVI   INTRTYP,PMCODEQU    -Q-                                          
         MVC   HALF,PWK1STIM                                                    
         MVC   INTSTIM,HALF        START TIME                                   
         MVC   INTDURM,PWK1DURM    DURATION IN MINUTES                          
         GOTO1 VHRTOQH,DMCB,HALF,INTSQH       START QH                          
*                                                                               
*        DEVELOP END QH (INTEQH) AND DURATION IN QH'S (INTDUR)                  
*                           INTDUR = 1 ( 1-22 MIN.)                             
*                                  = 2 (23-37 MIN.)                             
*                                  = 3 (38-52 MIN.)...ETC.                      
         ZIC   R0,INTSQH                                                        
         ZIC   RF,PWK1DURM         DURATION IN MINUTES                          
         LA    RF,8(RF)            ADD 8 BEFORE CNV TO QH                       
         SR    RE,RE                                                            
         D     RE,=F'15'                                                        
         CH    RF,=H'1'            TEST FOR DURATION OF AT LEAST ONE            
         BH    *+8                                                              
         LA    RF,1                                                             
         STC   RF,INTDUR           DURATION IN QH                               
         AR    R0,RF               SQH PLUS DUR                                 
*        BCTR  R0,0                LESS ONE GIVE END QH                         
         STC   R0,INTEQH                                                        
*                                                                               
         EJECT                                                                  
*              ADD DURATION IN MINUTES TO START TIME (MILITARY) TO              
*              GET END TIME                                                     
         SR    R0,R0                                                            
         LH    R1,HALF             START TIME                                   
         D     R0,=F'100'          MINUTES IN R0, HOURS IN R1                   
         ZIC   RF,INTDURM          DURATION IN MINUTES                          
         SR    RE,RE                                                            
         D     RE,=F'60'           MINUTES IN RE, HOURS IN RF                   
         AR    R0,RE               ADD MINUTES TOGETHER                         
         CH    R0,=H'60'           TEST IF SUM GT OR EQ TO 1 HOUR               
         BL    *+12                NO                                           
         SH    R0,=H'60'           SUBTRACT 60 MINUTES                          
         LA    RF,1(RF)            AND ADD 1 TO HOURS                           
         AR    R1,RF               ADD HOURS TOGETHER                           
         MH    R1,=H'100'          HOURS X 100 FOR MILITARY TIME                
         AR    R1,R0               ADD MINUTES TO HOURS                         
         CH    R1,=H'2400'         TEST FOR PAST MIDNIGHT                       
         BNH   *+8                                                              
         SH    R1,=H'2400'                                                      
         STCM  R1,3,INTETIM        END TIME                                     
*                                                                               
         CLC   D4NET,=C'SYN'       NO INDIV. DAY FOR SYNDS.                     
         BE    *+20                                                             
         CLC   D4DYSWKS,=C'01'     AVERAGES                                     
         BE    D4R77                                                            
         MVC   VARS,ZEROS                                                       
*                                  USE INDIVIDUAL DAY(S) FOR INTVAR             
         LA    RE,D4DAYS                                                        
         LA    RF,SAVVAR           SET UP START TIMES IN VAR SAVE AREA          
         LA    R0,7                                                             
D4R74    CLI   0(RE),C'1'                                                       
         BNE   D4R76                                                            
         MVC   0(1,RF),INTSQH      START QH                                     
         MVC   1(1,RF),INTEQH      END QH                                       
         PACK  DUB,D4DUR                                                        
         CVB   R1,DUB                                                           
         CH    R1,=H'240'          4-HOUR MAXIMUM SUPPORTED                     
         BNH   *+8                                                              
         LH    R1,=H'240'                                                       
         STC   R1,2(RF)            DURATION IN MINUTES                          
         MVC   3(2,RF),INTSTIM     START TIME                                   
         MVC   5(2,RF),INTETIM     END TIME                                     
D4R76    LA    RE,1(RE)                                                         
         LA    RF,7(RF)                                                         
         BCT   R0,D4R74                                                         
         CLC   D4NET,=C'SYN'       CAN BE VAR FOR SYND.                         
         BNE   D4R80                                                            
*                                                                               
         EJECT                                                                  
D4R77    CLI   VARIOUS,1           VARIOUS                                      
         BNE   D4R80                                                            
         LA    RE,SAVETIME         ACCUMULATE INDIVIDUAL VAR DAY(S)             
         LA    RF,VARSTIME             INTO VARSTIME                            
         LA    R0,7                                                             
D4R78    OC    0(8,RE),0(RE)                                                    
         BZ    *+10                                                             
         MVC   0(8,RF),0(RE)                                                    
         LA    RE,8(RE)                                                         
         LA    RF,8(RF)                                                         
         BCT   R0,D4R78                                                         
*                                                                               
         CLC   VARS,DAYS           HAVE ALL VARIOUS DAYS PROCESSED              
         BNE   D4R90                                                            
D4R79    MVI   VARIOUS,0           RESET                                        
         MVC   DAYS,ZEROS          RESET                                        
         MVC   INTVAR(49),SAVVAR                                                
         XC    SAVVAR(49),SAVVAR                                                
         MVC   SAVETIME(56),VARSTIME                                            
         XC    VARSTIME(56),VARSTIME                                            
         LA    RE,VARS             GENERATE VAR DATA USING                      
         B     D4R42                   ACCUMULATED DAYS                         
*                                                                               
D4R80    DS    0H                                                               
*                                                                               
D4R90    MVC   INTDAYWK,PDAY1                                                   
         OC    INTDAYWK,PWKBIT                                                  
         MVC   INTDYBIT,PDAY1BIT                                                
         MVC   SAVEINT,INTVALS     SAVE FOR H4RTN/P4RTN                         
*                                                                               
D4RX     MVI   BYPREAD,0           FOR P4REC, SKIP PROCESSING AND               
         B     READ20              READ NEXT REC W/O GOING TO CONTRLLER         
*                                                                               
         EJECT                                                                  
* PROCESS HALF HOUR DETAIL RECORD                                               
*                                                                               
H4RTN    DS    0H                                                               
         USING H4REC,RC                                                         
*                                                                               
         CLI   BYPASSH4,1          BYPASS ALL BUT 1ST H4 RECORD                 
         BE    READ20                                                           
         MVI   BYPASSH4,1                                                       
*                                                                               
         MVC   INTVALS(L'SAVEINT),SAVEINT   RESTORE FROM D4RTN                  
*                                                                               
*        CLC   H4PROJ,ZEROS        ARE TOTAL FIELDS ON THIS RECORD              
*        BE    *+22                                                             
*        MVC   SVPROJ,H4PROJ       IF YES - SAVE 3 FIELDS                       
*        MVC   SVRTG,H4RTG                                                      
*        MVC   SVSHR,H4SHR                                                      
*        MVC   H4PROJ,SVPROJ       IF NOT - RESTORE FROM A PREVIOUS H4          
*        MVC   H4RTG,SVRTG                                                      
*        MVC   H4SHR,SVSHR                                                      
*                                                                               
         MVI   INTRTYP,PRCODEQU    -P-                                          
         PACK  DUB,H4HALF          HALF HOUR CODE                               
         CVB   RF,DUB                                                           
         BCTR  RF,0                CONVERT TO QUARTER HOUR                      
         SLL   RF,1                                                             
*                                                                               
         SR    R1,R1               CLEAR ACCUM                                  
         PACK  DUB,H4DUR1          MINUTES IN FIRST QH                          
         PACK  DUB1,H4DUR2         MINUTES IN SECOND QH                         
         CP    DUB,=P'0'           TEST IF RAN IN FIRST QH                      
         BE    *+12                NO                                           
         LA    R1,1(R1)            YES-BUMP QH DURATION                         
         B     *+8                                                              
         LA    RF,1(RF)            BUMP START QH                                
         CP    DUB1,=P'0'                                                       
         BE    *+8                                                              
         LA    R1,1(R1)                                                         
         LTR   R1,R1               TEST IF PROGRAM RAN DURING HALF HOUR         
         BNZ   *+6                 YES                                          
         DC    H'0'                                                             
*        STC   RF,INTSQH           SET START QUARTER HOUR                       
*        STC   R1,INTDUR                                                        
*        AR    R1,RF               GET END QH                                   
*        BCTR  R1,0                                                             
*        STC   R1,INTEQH                                                        
*                                                                               
         MVC   SAVEINT,INTVALS     SAVE FOR P4RTN                               
*                                                                               
         MVI   BYPREAD,0           FOR P4REC, SKIP PROCESSING AND               
         B     READ20              READ NEXT REC W/O GOING TO CONTRLLER         
*                                                                               
         EJECT                                                                  
* PROCESS PERSONS ESTIMATES RECORD                                              
*                                                                               
P4RTN    DS    0H                                                               
         MVC   SVD4,ZEROS          RESET D4 RECORD'S SAVE AREA                  
         MVI   BYPASSH4,0          RESET H4 RECORD BYPASS SWITCH                
         USING P4REC,RC                                                         
         CLC   P4HALF,=C'00'                                                    
         BNE   READ20                                                           
*                                                                               
         MVC   INTVALS(L'SAVEINT),SAVEINT   RESTORE FROM D4RTN/H4RTN            
         MVI   INTRTYP,PMCODEQU                                                 
         MVC   SAVEINT(L'SAVEINT),INTVALS                                       
*                                                                               
* CONVERT AND SLOT THE DEMOS                                                    
         PACK  DUB,P4DEMGRP                                                     
         CVB   R1,DUB                                                           
         STH   R1,DMCB+2                                                        
         PACK  DUB,P4MKTBRK                                                     
         CVB   R1,DUB                                                           
         STH   R1,DMCB                                                          
         LA    R1,P4DCATS                                                       
         ST    R1,DMCB+4                                                        
         BAS   RE,PROCDEMS                                                      
         MVI   BYPREAD,0                                                        
         B     READ20                                                           
*                                                                               
         EJECT                                                                  
P4R40    CLI   INTRTYP,PMCODEQU    TEST FOR 'Q' RECORD                          
         BE    P4R70                                                            
*                                                                               
P4R60    LA    R7,INTKEY           BUILD PAV KEY                                
         USING PRKEY,R7                                                         
         MVI   PRCODE,PRCODEQU     -P-                                          
         MVI   PRMED,C'N'                                                       
         MVI   PRSRC,C'N'                                                       
         CLI   CORRSW,0            TEST CORRECTION RECORD                       
         BE    P4R64                                                            
         MVC   PRCODE(2),BOOK1     (BOOK FORCES PROPER SORT)                    
         MVI   PRSRC,PRCODEQU      -P-                                          
P4R64    MVC   PRSTAT,INTSTA                                                    
         MVC   PRBTYP,INTBTYP                                                   
         MVC   PRBOOK,INTBOOK                                                   
         MVC   PRSTIM,INTSQH                                                    
         MVC   PRDW,INTDAYWK                                                    
         MVC   PRDW+1(1),INTDUR    FORCE HIGHER DURATIONS FIRST                 
         XI    PRDW+1,X'FF'                                                     
*                                                                               
         B     P4RX                                                             
         DROP  R7                                                               
*                                                                               
P4R70    LA    R7,INTKEY           BUILD 'Q' RECORD KEY                         
         USING PMKEY,R7                                                         
         MVI   PMCODE,PMCODEQU     -Q-                                          
         MVI   PMMEDIA,C'N'                                                     
         MVI   PMSRC,C'N'                                                       
         CLI   CORRSW,0            TEST CORRECTION RECORD                       
         BE    P4R74                                                            
         MVC   PMCODE(2),BOOK1     (BOOK FORCES PROPER SORT)                    
         MVI   PMSRC,PMCODEQU      -Q-                                          
P4R74    MVC   PMBOOK,INTBOOK                                                   
         MVC   PMSTAT,INTSTA                                                    
         MVC   PMPNUM,INTPNUM                                                   
         MVC   PMBTYP,INTBTYP                                                   
         MVC   PMBTYP+1(2),INTPNUM                                              
         MVC   PMBTYP+3(1),INTRSF                                               
*                                                                               
         LA    RE,QSORTAB          SORT 'Q' RECORDS BY DAY...                   
         LA    R0,QSORTABS         M-S, M-F, VAR, MON...SUN                     
         MVC   PMRLEN(1),INTDAYWK                                               
         NI    PMRLEN,X'F0'                                                     
         CLC   PMRLEN(1),0(RE)                                                  
         BE    *+14                                                             
         LA    RE,L'QSORTAB(RE)                                                 
         BCT   R0,*-14                                                          
         DC    H'0'                                                             
         MVC   PMRLEN(1),1(RE)     USE FIELD FOLLOWING PMPNUM                   
         DROP  R7                                                               
*                                                                               
         EJECT                                                                  
P4RX     MVI   INTKEY+29,255                                                    
         CLI   GAASW,C'Y'                                                       
         BNE   EXIT                                                             
         MVI   INTKEY+29,C'G'                                                   
         B     EXIT                                                             
*                                                                               
         EJECT                                                                  
* SORT RECORD HOOK                                                              
* NON-NETWORK M-F ROTATORS EMITTED FROM INDIVIDUAL DAY RECORDS                  
* DUPLICATE HUT RECORDS DROPPED                                                 
*                                                                               
CNVWR    DS    0H                                                               
*                                                                               
CNVWR40  L     R2,ASREC            R2 - USES INTERD DSECT                       
*                                                                               
         LA    R0,NDEMS                                                         
         LA    R1,INTACCS                                                       
XXX1     L     RF,0(R1)                                                         
         SR    RE,RE                                                            
         D     RE,=F'100'                                                       
         ST    RF,0(R1)                                                         
         LA    R1,4(R1)                                                         
         BCT   R0,XXX1                                                          
*                                                                               
         XC    HALF,HALF           SET FOR WEIGHTING                            
         MVC   HALF(2),INTCOV                                                   
         LH    R1,HALF                                                          
         SR    R0,R0                                                            
         D     R0,=F'15'                                                        
         LTR   R1,R1                                                            
         BNZ   *+8                                                              
         LA    R1,1(R1)                                                         
         STH   R1,HALF                                                          
         LA    R0,NDEMS                                                         
         LA    RE,INTACCS                                                       
         L     RF,0(RE)                                                         
         MH    RF,HALF                                                          
         ST    RF,0(RE)                                                         
         LA    RE,4(RE)                                                         
         BCT   R0,*-16                                                          
*                                                                               
         L     R9,VCPRINT                                                       
         USING DPRINT,R9                                                        
         CLI   CNWR1ST,1                                                        
         BNE   CNVWR401                                                         
         XC    DEMAREA(NDEMS*4),DEMAREA                                         
         LA    RE,INTKEY           INITIALIZE SAVED RECORD                      
         LA    R1,2000                                                          
         L     RF,=A(SVHREC)                                                    
         MOVE  ((RF),(R1)),(RE)                                                 
         MVC   CURRDUR,HALF                                                     
*                                                                               
CNVWR401 MVI   CNWR1ST,0                                                        
         XC    P(132),P                                                         
*        MVC   P(6),=C'OUTPUT'                                                  
*        EDIT  (B1,INTRSF),(4,P+10)                                             
*        MVC   FULL,INTACCS                                                     
*        EDIT  (B4,FULL),(10,P+18)                                              
*        MVC   FULL,INTACCS+4                                                   
*        EDIT  (B4,FULL),(10,P+28)                                              
*        MVC   P+40(14),INTPNAME                                                
*        GOTO1 VPRINTER                                                         
         CLC   INTRSF,PRVRSF                                                    
         BNE   CNVWR41                                                          
*        MVC   P+3(3),=C'ADD'                                                   
         LH    RE,HALF                                                          
         AH    RE,CURRDUR                                                       
         STH   RE,CURRDUR                                                       
         LA    RE,DEMAREA                                                       
         LA    RF,INTACCS                                                       
         SR    R9,R9                                                            
         LA    R0,NDEMS                                                         
         L     R1,0(RE,R9)         SUM                                          
         A     R1,0(RF,R9)         CURRENT                                      
         ST    R1,0(RE,R9)                                                      
         LA    R9,4(R9)                                                         
         BCT   R0,*-16                                                          
*        L     R9,VCPRINT                                                       
*        MVC   FULL,DEMAREA+4                                                   
*        EDIT  (B4,FULL),(10,P+18)                                              
*        GOTO1 VPRINTER                                                         
         MVI   BYPSORT,X'80'                                                    
         MVI   INTRTYP,0                                                        
         B     EXIT                                                             
*                                                                               
CNVWR41  MVC   PRVRSF,INTRSF                                                    
         LA    RE,INTKEY           SAVE CURRENT RECORD                          
         LA    R1,2000                                                          
         L     RF,=A(SVIREC)                                                    
         MOVE  ((RF),(R1)),(RE)                                                 
         LA    RF,INTKEY           RESTORE ACCUMULATED RECORD                   
         LA    R1,2000                                                          
         L     RE,=A(SVHREC)                                                    
         MOVE  ((RF),(R1)),(RE)                                                 
         LA    RE,INTACCS                                                       
*        MVC   0(NDEMS*4,RE),DEMAREA                                            
         LA    RF,1000                                                          
         XCEF                                                                   
*                                                                               
         LA    RE,DEMAREA                                                       
         LA    R9,NDEMS                                                         
         LH    RF,CURRDUR                                                       
CNVWR42  L     R1,0(RE)                                                         
         SR    R0,R0                                                            
         SLDA  R0,1                                                             
         DR    R0,RF                                                            
         A     R1,=F'1'                                                         
         SRA   R1,1                                                             
         ST    R1,0(RE)                                                         
         LA    RE,4(RE)                                                         
         BCT   R9,CNVWR42                                                       
*                                                                               
         LA    RE,INTACCS                                                       
         MVC   0(4,RE),DEMAREA+4   AREA HOMES                                   
         MVC   16(4,RE),DEMAREA    USA HOMES                                    
*                                                                               
         L     RF,DEMAREA+RIWW1820*4                                            
         A     RF,DEMAREA+RIWW2124*4                                            
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIWW2534*4                                            
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIWW3544*4                                            
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIWW4549*4                                            
         A     RF,DEMAREA+RIWW1849*4                                            
         ST    RF,DEMAREA+RIWW1849*4                                            
*                                                                               
         L     RF,DEMAREA+RIWW50O*4                                             
         ST    RF,DEMAREA+RIWW50O*4                                             
*                                                                               
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIWW1849*4                                            
         ST    RF,ROWW18O*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF68*4                                               
         A     RF,DEMAREA+RIF911*4                                              
         A     RF,DEMAREA+RIF611*4                                              
         ST    RF,DEMAREA+RIF611*4                                              
*                                                                               
         L     RF,DEMAREA+RIM68*4                                               
         A     RF,DEMAREA+RIM911*4                                              
         A     RF,DEMAREA+RIM611*4                                              
         ST    RF,DEMAREA+RIM611*4                                              
*                                                                               
         L     RF,DEMAREA+RIF1214*4                                             
         A     RF,DEMAREA+RIF1517*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF1217*4                                             
         ST    RF,DEMAREA+RIF1217*4                                             
*                                                                               
         L     RF,DEMAREA+RIM1214*4                                             
         A     RF,DEMAREA+RIM1517*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM1217*4                                             
         ST    RF,DEMAREA+RIM1217*4                                             
*                                                                               
         L     RF,DEMAREA+RIF1217*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF1820*4                                             
         A     RF,DEMAREA+RIF2124*4                                             
         ST    RF,ROW1224*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF1217*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM1217*4                                             
         ST    RF,ROV1217*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF611*4                                              
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM611*4                                              
         ST    RF,ROV611*4(RE)                                                  
*                                                                               
         A     RF,DEMAREA+RIF25*4                                               
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM25*4                                               
         ST    RF,ROV211*4(RE)                                                  
*                                                                               
         L     RF,DEMAREA+RIF1820*4                                             
         BAS   R9,ADJINT                                                        
         ST    RF,ROW1820*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIM1820*4                                             
         BAS   R9,ADJINT                                                        
         ST    RF,ROM1820*4(RE)                                                 
*                                                                               
         CLI   INTRSF,1            NTI ROUNDS DIFFERENTLY FOR                   
         BE    ADJUSA              USA - BRILLIANT PEOPLE THEY ARE              
*                                                                               
         L     RF,DEMAREA+RIF1820*4  THIS IS THE NTI ROUNDING FOR               
         A     RF,DEMAREA+RIF2124*4  ALL OTHER CATAGORIES                       
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF2529*4                                             
         A     RF,DEMAREA+RIF3034*4                                             
         BAS   R9,ADJINT                                                        
         ST    RF,ROW1834*4(RE)                                                 
*                                                                               
         A     RF,DEMAREA+RIF3539*4                                             
         A     RF,DEMAREA+RIF4044*4                                             
         A     RF,DEMAREA+RIF4549*4                                             
         ST    RF,ROW1849*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF2529*4                                             
         A     RF,DEMAREA+RIF3034*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF3539*4                                             
         A     RF,DEMAREA+RIF4044*4                                             
         A     RF,DEMAREA+RIF4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5054*4                                             
         ST    RF,ROW2554*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF3539*4                                             
         A     RF,DEMAREA+RIF4044*4                                             
         A     RF,DEMAREA+RIF4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5054*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5564*4                                             
         ST    RF,ROW3564*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF5564*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF65O*4                                              
         ST    RF,ROW55O*4(RE)                                                  
*                                                                               
         L     RF,DEMAREA+RIM1820*4                                             
         A     RF,DEMAREA+RIM2124*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM2529*4                                             
         A     RF,DEMAREA+RIM3034*4                                             
         BAS   R9,ADJINT                                                        
         ST    RF,ROM1834*4(RE)                                                 
*                                                                               
         A     RF,DEMAREA+RIM3539*4                                             
         A     RF,DEMAREA+RIM4044*4                                             
         A     RF,DEMAREA+RIM4549*4                                             
         ST    RF,ROM1849*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIM2529*4                                             
         A     RF,DEMAREA+RIM3034*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM3539*4                                             
         A     RF,DEMAREA+RIM4044*4                                             
         A     RF,DEMAREA+RIM4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5054*4                                             
         ST    RF,ROM2554*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIM3539*4                                             
         A     RF,DEMAREA+RIM4044*4                                             
         A     RF,DEMAREA+RIM4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5054*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5564*4                                             
         ST    RF,ROM3564*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIM5564*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM65O*4                                              
         ST    RF,ROM55O*4(RE)                                                  
         L     RF,DEMAREA+RIF1820*4                                             
         A     RF,DEMAREA+RIF2124*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF2529*4                                             
         A     RF,DEMAREA+RIF3034*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF3539*4                                             
         A     RF,DEMAREA+RIF4044*4                                             
         A     RF,DEMAREA+RIF4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5054*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5564*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF65O*4                                              
         ST    RF,ROW18O*4(RE)                                                  
*                                                                               
         L     RF,DEMAREA+RIM1820*4                                             
         A     RF,DEMAREA+RIM2124*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM2529*4                                             
         A     RF,DEMAREA+RIM3034*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM3539*4                                             
         A     RF,DEMAREA+RIM4044*4                                             
         A     RF,DEMAREA+RIM4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5054*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5564*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM65O*4                                              
         ST    RF,ROM18O*4(RE)                                                  
*                                                                               
ADJUSAR  LA    RE,INTACCS                                                       
         LA    RF,21                                                            
ADJOUT   SR    R0,R0                                                            
         L     R1,0(RE)                                                         
         A     R1,=F'50'                                                        
         D     R0,=F'100'                                                       
         ST    R1,0(RE)                                                         
         LA    RE,4(RE)                                                         
         BCT   RF,ADJOUT                                                        
*                                                                               
         OC    INTACCS(21*4),INTACCS                                            
         BNZ   *+16                                                             
         MVI   BYPSORT,X'80'                                                    
         MVI   INTRTYP,0                                                        
         B     NOPRT                                                            
*                                                                               
         L     R9,VCPRINT                                                       
         MVC   FULL,INTACCS+4                                                   
         EDIT  (B4,FULL),(10,P+14)                                              
         MVC   FULL,INTACCS+8                                                   
         EDIT  (B4,FULL),(10,P+26)                                              
         MVC   FULL,INTACCS                                                     
         EDIT  (B4,FULL),(10,P+38)                                              
         MVC   P+50(20),INTPNAME                                                
         EDIT  (B2,CURRDUR),(6,P+72)                                            
         CLI   INTRSF,11                                                        
         BH    NOPRT                                                            
         GOTO1 VPRINTER                                                         
NOPRT    L     RF,=A(SVHREC)           NEW SAVE RECORD                          
         LA    R1,2000                                                          
         L     RE,=A(SVIREC)                                                    
         MOVE  ((RF),(R1)),(RE)                                                 
         L     RF,=A(SVHREC)           NEW SAVE RECORD                          
         LA    RE,INTACCS-INTKEY                                                
         LA    RE,0(RE,RF)                                                      
         MVC   DEMAREA(NDEMS*4),0(RE)                                           
         MVC   CURRDUR,HALF                                                     
         B     EXIT                                                             
         DROP  R9                                                               
*                                                                               
ADJUSA   L     RF,DEMAREA+RIF1820*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF2124*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF2529*4                                             
         A     RF,DEMAREA+RIF3034*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF3539*4                                             
         A     RF,DEMAREA+RIF4044*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5054*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5564*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF65O*4                                              
         ST    RF,ROW18O*4(RE)                                                  
*                                                                               
         L     RF,DEMAREA+RIM1820*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM2124*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM2529*4                                             
         A     RF,DEMAREA+RIM3034*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM3539*4                                             
         A     RF,DEMAREA+RIM4044*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5054*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5564*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM65O*4                                              
         ST    RF,ROM18O*4(RE)                                                  
*                                                                               
         L     RF,DEMAREA+RIF1820*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF2124*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF2529*4                                             
         A     RF,DEMAREA+RIF3034*4                                             
         BAS   R9,ADJINT                                                        
         ST    RF,ROW1834*4(RE)                                                 
*                                                                               
         A     RF,DEMAREA+RIF3539*4                                             
         A     RF,DEMAREA+RIF4044*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF4549*4                                             
         ST    RF,ROW1849*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF2529*4                                             
         A     RF,DEMAREA+RIF3034*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF3539*4                                             
         A     RF,DEMAREA+RIF4044*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5054*4                                             
         ST    RF,ROW2554*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF3539*4                                             
         A     RF,DEMAREA+RIF4044*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5054*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF5564*4                                             
         ST    RF,ROW3564*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIF5564*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIF65O*4                                              
         ST    RF,ROW55O*4(RE)                                                  
*                                                                               
         L     RF,DEMAREA+RIM1820*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM2124*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM2529*4                                             
         A     RF,DEMAREA+RIM3034*4                                             
         BAS   R9,ADJINT                                                        
         ST    RF,ROM1834*4(RE)                                                 
*                                                                               
         A     RF,DEMAREA+RIM3539*4                                             
         A     RF,DEMAREA+RIM4044*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM4549*4                                             
         ST    RF,ROM1849*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIM2529*4                                             
         A     RF,DEMAREA+RIM3034*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM3539*4                                             
         A     RF,DEMAREA+RIM4044*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5054*4                                             
         ST    RF,ROM2554*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIM3539*4                                             
         A     RF,DEMAREA+RIM4044*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM4549*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5054*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM5564*4                                             
         ST    RF,ROM3564*4(RE)                                                 
*                                                                               
         L     RF,DEMAREA+RIM5564*4                                             
         BAS   R9,ADJINT                                                        
         A     RF,DEMAREA+RIM65O*4                                              
         ST    RF,ROM55O*4(RE)                                                  
*                                                                               
         B     ADJUSAR                                                          
*                                                                               
         SPACE 2                                                                
ADJINT   SR    R0,R0               INTERIM ADJUST                               
         LR    R1,RF               FOR OLD BASIC CELLS                          
         A     R1,=F'50'                                                        
         D     R0,=F'100'                                                       
         M     R0,=F'100'                                                       
         LR    RF,R1                                                            
         BR    R9                                                               
         SPACE 2                                                                
*                                                                               
PRVRSF   DC    X'00'                                                            
CNWR1ST  DC    X'01'                                                            
CURRDUR  DC    H'0'                                                             
         DS    0H                                                               
         EJECT                                                                  
* ROUTINE TO SET UP DAYS (MON THRU FRI, M-F AND M-S)                            
*      OR TO SET UP A SINGLE DAY FOR A CORRECTION RECORD                        
*                                                                               
DAYRTN   NTR1                                                                   
         USING MIREC,RC                                                         
*                                                                               
         CLC   MISTART,MIEND       TEST SINGLE DAY CORRECTION RECORD            
         BNE   DAY10                                                            
*                                                                               
* SINGLE DAY - APPROPRIATE DAY IS ENTERED IN HDAYTAB                            
*              & REMAINDER OF HDAYTAB IS LEFT INTACT.                           
*                                                                               
         LA    R1,X'10'            MON                                          
         LA    RE,MIREC+(D4DAYS-D4REC)                                          
         LA    R0,7                                                             
DAY02    CLI   0(RE),C'1'          FIND APPROPRIATE DAY                         
         BE    DAY04                                                            
         AH    R1,=H'16'           INCREMENT TO NEXT DAY                        
         LA    RE,1(RE)                                                         
         BCT   R0,DAY02                                                         
         DC    H'0'                                                             
DAY04    STC   R1,BYTE             SAVE DAY CODE IN BYTE                        
*                                                                               
         LA    RE,HDAYTAB                                                       
         LA    R0,HDAYS                                                         
DAY06    CLC   BYTE,1(RE)          TEST DAY CODE                                
         BE    DAY08                                                            
         LA    RE,L'HDAYTAB(RE)                                                 
         BCT   R0,DAY06                                                         
         DC    H'0'                                                             
DAY08    MVC   2(7,RE),MISTART     2(7,RE) = START DAY                          
         MVC   9(7,RE),MIEND       9(7,RE) = END DAY                            
         B     EXIT                                                             
*                                                                               
         EJECT                                                                  
*                                                                               
DAY10    MVC   HDMON+2(7),MISTART  SET UP MONDAY FROM START                     
         MVC   HDMON+9(7),MISTART                                               
         MVC   HDSUN+2(7),MIEND    SET UP SUNDAY FROM END                       
         MVC   HDSUN+9(7),MIEND                                                 
*                                                                               
         XC    HDTUE+2(14),HDTUE+2 CLEAR REAINING DAYS IN TABLE                 
         XC    HDWED+2(14),HDWED+2                                              
         XC    HDTHU+2(14),HDTHU+2                                              
         XC    HDFRI+2(14),HDFRI+2                                              
         XC    HDSAT+2(14),HDSAT+2                                              
         XC    HDM#F+2(14),HDM#F+2                                              
         XC    HDM#S+2(14),HDM#S+2                                              
*                                                                               
         LA    R5,HDMON+3          FILL IN MISSING DATES                        
         LA    R7,HDTUE+3                                                       
         LA    R2,5                                                             
DAY20    GOTO1 VADDAY,DMCB,(R5),(R7),1                                          
         BCTR  R7,0                                                             
         MVC   0(1,R7),HDMON+2                                                  
         MVC   7(7,R7),0(R7)       FOR EQUAL START AND END                      
         LA    R7,1(R7)                                                         
         LA    R5,16(R5)           DO REST OF DAYS                              
         LA    R7,16(R7)                                                        
         BCT   R2,DAY20                                                         
         B     DAY80                                                            
*                                                                               
*                                                                               
DAY80    MVC   HDM#F+2(7),MISTART  SET UP MON-FRI                               
         MVC   HDM#F+9(7),HDFRI+9                                               
         MVC   HDM#S+2(7),MISTART  SET UP MON-SUN                               
         MVC   HDM#S+9(7),MIEND                                                 
*                                                                               
         B     EXIT                                                             
         EJECT                                                                  
* ROUTINE TO FIND ACTUAL RUN TIME AND AVERAGE DURATION                          
*              P1 =  A(SAVETIME)                                                
*              P2 =  A(DAY BITS FOR WEEK)                                       
PDATA    NTR1                                                                   
         L     R6,0(R1)            ADDRESS OF SAVETIME                          
         L     RE,4(R1)            ADDRESS OF DAY BITS                          
         MVC   BYTE,0(RE)          DAY BITS                                     
         XC    FULL,FULL           CLEAR DAY COUNT FOR DURATION                 
         LA    R3,X'40'            START AT MONDAY                              
         LA    R5,7                COUNTER                                      
         SR    R7,R7               CLEAR DURATION ACCUM                         
         XC    TIMTAB(7*L'TIMTAB),TIMTAB                                        
         XC    FULL1,FULL1         CLEAR TABLE ENTRY COUNT                      
*                                                                               
PDATA2   EX    R3,*+8              TEST IF PROGRAM RAN ON DAY                   
         B     *+8                                                              
         TM    BYTE,0                                                           
         BZ    PDATA4              NO                                           
         OC    0(8,R6),0(R6)       BYPASS IF NO TIMES                           
         BZ    PDATA4                                                           
*                                                                               
         PACK  DUB,0(2,R6)         START TIME                                   
         CVB   R1,DUB                                                           
         MH    R1,=H'100'          HOURS X 100                                  
         PACK  DUB,2(2,R6)         START MINUTE                                 
         CVB   R0,DUB              MINUTES                                      
         AR    R1,R0                                                            
         CH    R1,=H'2400'         TEST FOR PAST MIDNIGHT                       
         BNH   *+8                 BEFORE OR AT MIDNIGHT                        
         SH    R1,=H'2400'         SUBTRACT FOR MIL TIME                        
         STH   R1,HALF             SAVE MIL TIME                                
         PACK  DUB,4(4,R6)         DURATION IN MINUTES                          
         CVB   R0,DUB                                                           
         AR    R7,R0               UPDATE TOTAL DURATION                        
         L     RE,FULL                                                          
         LA    RE,1(RE)            UPDATE DAY COUNT                             
         ST    RE,FULL                                                          
         BAS   RE,UPTIME           UPDATE START TIME TABLE                      
*                                                                               
PDATA4   SRL   R3,1                NEXT DAY                                     
         LA    R6,L'SAVETIME(R6)   NEXT DAY'S TIME DATA                         
         BCT   R5,PDATA2                                                        
*                                                                               
PDATA6   SR    RE,RE               CALCULATE AVERAGE DURATION                   
         LR    RF,R7               DURATION                                     
         SLDA  RE,1                                                             
         D     RE,FULL                                                          
         LA    RF,1(RF)                                                         
         SRA   RF,1                                                             
         CH    RF,=H'240'          4-HOUR MAXIMUM DURATION SUPPORTED            
         BNH   *+8                                                              
         LH    RF,=H'240'                                                       
         STC   RF,PWK1DURM         RETURN AVE DURATION                          
*                                                                               
         EJECT                                                                  
*                                  SORT TIMES IN DESCENDING ORDER               
         L     R0,FULL1            NUMBER OF ENTRIES IN TABLE                   
         GOTO1 VXSORT,DMCB,(X'FF',TIMTAB),(R0),3,1,2                            
         MVC   PWK1STIM,TIMTAB     FIRST OR MOST FREQUENT TIME                  
*                                                                               
         B     EXIT                                                             
*                                                                               
         SPACE 3                                                                
* ROUTINE TO UPDATE RUN TIME TABLE                                              
*              HALF CONTAINS TIME                                               
*              FULL1 CONTAINS TABLE ENTRY COUNT                                 
*                                                                               
UPTIME   DS    0H                                                               
         LR    R0,RE                                                            
         LA    R1,7                COUNTER                                      
         LA    RE,TIMTAB                                                        
*                                                                               
UPTIME2  OC    0(L'TIMTAB,RE),0(RE)     TEST FOR E-O-T                          
         BZ    UPTIME4                  INSERT ENTRY                            
         CLC   HALF,0(RE)               TEST IF TIME IS IN TABLE                
         BE    *+12                     YES-BUMP FREQUENCY COUNT                
         LA    RE,L'TIMTAB(RE)                                                  
         BCT   R1,UPTIME2                                                       
*                                                                               
         ZIC   RF,2(RE)                                                         
         LA    RF,1(RF)                                                         
         STC   RF,2(RE)                                                         
         B     UPTIMEX                                                          
*                                                                               
UPTIME4  MVC   0(2,RE),HALF        ADD NEW ENTRY                                
         MVI   2(RE),1             SET FREQUENCY TO 1                           
         L     R1,FULL1                                                         
         LA    R1,1(R1)            INCREMENT TABLE ENTRY COUNT                  
         ST    R1,FULL1                                                         
*                                                                               
UPTIMEX  LR    RE,R0                                                            
         BR    RE                                                               
         EJECT                                                                  
*        ON ENTRY     DMCB(2) = MARKET BREAK NUMBER                             
*                     DMCB+2(2)= DEMO GROUP NUMBER                              
*                     DMCB+4(4)= INPUT DEMO ADDRESS                             
*                                                                               
PROCDEMS NTR1                                                                   
         L     R1,=A(CRCITAB)      GET THE CATAGORY INDEX                       
PROCDEM1 CLI   0(R1),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                MARKET BREAK NOT FOUND                       
         CLC   DMCB(2),0(R1)                                                    
         BE    *+12                                                             
         LA    R1,4(R1)                                                         
         B     PROCDEM1                                                         
*                                                                               
         LH    R7,2(R1)            FIND OVERALL SLOT                            
         MH    R7,SLOTLN                                                        
         LA    R7,DEMAREA(R7)      HAVE SLOT ADDRESS                            
         ST    R7,DMCB+8                                                        
         OC    SVPROJ,ZEROS                                                     
         PACK  DUB,SVPROJ                                                       
         CVB   R1,DUB                                                           
         ST    R1,0(R7)                                                         
         OC    SVMPROJ,ZEROS                                                    
         PACK  DUB,SVMPROJ                                                      
         CVB   R1,DUB                                                           
         ST    R1,4(R7)                                                         
         LA    R0,20                                                            
PROCDEM3 L     R1,=A(SLOTTAB)      FIND THE SLOT FOR DEMOS                      
PROCDEM4 CLI   0(R1),X'FF'         DEMO GROUP NOT FOUND                         
         BE    PROCDEM5              NEXT SLOT - SOME ARE OPEN                  
         CLC   DMCB+2(2),0(R1)                                                  
         BE    *+12                                                             
         LA    R1,4(R1)                                                         
         B     PROCDEM4                                                         
         SPACE 1                                                                
         LH    R7,2(R1)            GET THE DEMO SLOT                            
         SLL   R7,2                                                             
         A     R7,DMCB+8           NOW I HAVE AN OUTPUT SLOT                    
         L     RF,DMCB+4                                                        
         PACK  DUB,0(9,RF)                                                      
         CVB   R1,DUB                                                           
         STCM  R1,15,0(R7)         SAVE THE CONVERTED VALUE                     
PROCDEM5 LA    RF,9(RF)                                                         
         ST    RF,DMCB+4           UPDATE INPUT POINTER                         
         LH    R1,DMCB+2           UPDATE FIELD NUMBER                          
         LA    R1,1(R1)                                                         
         STH   R1,DMCB+2                                                        
         BCT   R0,PROCDEM3                                                      
         XIT1                                                                   
         EJECT                                                                  
GENCATS  NTR1                      GENERATE MISSING BOOK CATS                   
         L     R9,=A(CIGENTAB)                                                  
GENCATS2 CLI   0(R9),X'FF'                                                      
         BE    GENCATSX                                                         
         LH    R7,0(R9)                                                         
         MH    R7,SLOTLN                                                        
         LA    R7,DEMAREA(R7)                                                   
         XC    0(NDEMS*4,R7),0(R7)                                              
         LH    R1,2(R9)            SOURCE SLOTS                                 
         BAS   RE,SUMIT                                                         
         LH    R1,4(R9)                                                         
         BAS   RE,SUMIT                                                         
         LH    R1,6(R9)                                                         
         BAS   RE,SUMIT                                                         
         LH    R1,8(R9)                                                         
         BAS   RE,SUMIT                                                         
         LH    R1,10(R9)                                                        
         BAS   RE,SUMIT                                                         
         LA    R9,12(R9)                                                        
         B     GENCATS2                                                         
*                                                                               
GENCATSX XIT1                                                                   
         SPACE 2                                                                
SUMIT    LTR   R1,R1               NOT ACTIVE                                   
         BZR   RE                                                               
         LA    R3,0                                                             
         LA    R0,56                                                            
         MH    R1,SLOTLN                                                        
         LA    R1,DEMAREA(R1)                                                   
         L     RF,0(R1)            DON'T ADD HOMES                              
         ST    RF,0(R7)                                                         
         B     SUMIT2                                                           
*                                                                               
SUMIT1   L     RF,0(R7,R3)         ADD 2 CATS TOGETHER                          
         A     RF,0(R1,R3)                                                      
         ST    RF,0(R7,R3)                                                      
SUMIT2   LA    R3,4(R3)                                                         
         BCT   R0,SUMIT1                                                        
         BR    RE                                                               
         EJECT                                                                  
* READ ERROR - SET ERROR FLAG AND CLOSE FILE                                    
*                                                                               
IOERROR  DS    0H                                                               
         GOTO1 VLOGIO,DMCB,1,=C'***READ ERROR ON INPUT***'                      
         CLOSE (IN1,REWIND)                                                     
         MVI   INTAPESW,X'82'                                                   
         B     EXIT                                                             
         SPACE 2                                                                
* WRONG LENGTH RECORD ON INPUT                                                  
*                                                                               
WLR      DS    0H                                                               
         GOTO1 VLOGIO,DMCB,1,=C'WRONG LENGTH RECORD ON INPUT'                   
         CLOSE (IN1,REWIND)                                                     
         MVI   INTAPESW,X'82'                                                   
         B     EXIT                                                             
         SPACE 2                                                                
* EOF ON INPUT FILE                                                             
*                                                                               
MORET    DS    0H                                                               
ENDJOB   CLOSE (IN1,REWIND)                                                     
         MVI   INTAPESW,X'02'                                                   
         B     EXIT                                                             
         SPACE 2                                                                
EXIT     XMOD1 1                                                                
         EJECT                                                                  
*                                                                               
* LITERAL POOL                                                                  
*                                                                               
         LTORG                                                                  
*                                                                               
         EJECT                                                                  
* TABLE OF DAY BIT SETTINGS AND DAY CODES                                       
*                                                                               
NETDAYTB DS    0CL2                                                             
         DC    X'4010'             MON                                          
         DC    X'2020'             TUE                                          
         DC    X'1030'             WED                                          
         DC    X'0840'             THU                                          
         DC    X'0450'             FRI                                          
         DC    X'0260'             SAT                                          
         DC    X'0170'             SUN                                          
         DC    X'7C00'             M-F                                          
         DC    X'7F80'             M-SUN                                        
NETDAYS  EQU   (*-NETDAYTB)/L'NETDAYTB                                          
*                                                                               
H3DAYTAB DC    C'1',X'40',X'10'    H3 DAY CONVERSION TABLE                      
         DC    C'2',X'20',X'20'                                                 
         DC    C'3',X'10',X'30'                                                 
         DC    C'4',X'08',X'40'                                                 
         DC    C'5',X'04',X'50'                                                 
         DC    C'6',X'02',X'60'                                                 
         DC    C'7',X'01',X'70'                                                 
         DC    C'8',X'7C',X'00'                                                 
         DC    C'9',X'7F',X'80'                                                 
         DC    X'FF',X'7F',X'90'                                                
         SPACE 3                                                                
* HUT RECORD DAY CODE TABLE                                                     
*              BYTE 0 = NTI DAY CODE                                            
*              BYTE 1 = INTERNAL DAY CODE                                       
*              BYTES 3-9 = START DAY (CYYMMDD)                                  
*              BYTES 10-16 = END DAY (CYYMMDD)                                  
*                                                                               
HDAYTAB  DS    0CL16                                                            
HDM#S    DC    C'0',X'80',14X'00'  M-SUN                                        
HDMON    DC    C'2',X'10',14X'00'  MON                                          
HDTUE    DC    C'3',X'20',14X'00'  TUE                                          
HDWED    DC    C'4',X'30',14X'00'  WED                                          
HDTHU    DC    C'5',X'40',14X'00'  THU                                          
HDFRI    DC    C'6',X'50',14X'00'  FRI                                          
HDSAT    DC    C'7',X'60',14X'00'  SAT                                          
HDSUN    DC    C'8',X'70',14X'00'  SUN                                          
HDM#F    DC    C'9',X'00',14X'00'  M-FRI                                        
HDAYS    EQU   (*-HDAYTAB)/L'HDAYTAB                                            
*                                                                               
HDAYTABS DS    CL(L'HDAYTAB*HDAYS) SAVE AREA                                    
         SPACE 3                                                                
* INTAB COUNTS TABLE                                                            
*              BYTES 1-3 = DATE (YYMMDD)                                        
*              BYTE 4 = DAY (MON=X'40' - SUN=X'01')                             
*              BYTES 5-156 = COUNTS                                             
         DS    0F                                                               
INTAB    DS    0XL156                                                           
         DS    XL3,XL1,38F         MON                                          
         DS    XL3,XL1,38F         TUE                                          
         DS    XL3,XL1,38F         WED                                          
         DS    XL3,XL1,38F         THU                                          
         DS    XL3,XL1,38F         FRI                                          
         DS    XL3,XL1,38F         SAT                                          
         DS    XL3,XL1,38F         SUN                                          
INTABS   EQU   (*-INTAB)/L'INTAB                                                
         DC    XL3'00'                                                          
*                                                                               
         EJECT                                                                  
* TABLE OF DAY CODES AND SORT VALUES FOR 'Q' RECORDS                            
QSORTAB  DS    0XL2                                                             
         DC    X'8000'             M-S                                          
         DC    X'0001'             M-F                                          
         DC    X'9002'             VAR                                          
         DC    X'1003'             MON                                          
         DC    X'2004'             TUE                                          
         DC    X'3005'             WED                                          
         DC    X'4006'             THU                                          
         DC    X'5007'             FRI                                          
         DC    X'6008'             SAT                                          
         DC    X'7009'             SUN                                          
QSORTABS EQU   (*-QSORTAB)/L'QSORTAB                                            
*                                                                               
         SPACE 1                                                                
* TABLE OF TELECAST TYPES AND THEIR BIT SETTINGS USED FOR INTDTYP               
*                                                                               
TYPTAB   DS    0CL3                                                             
         DC    C'  ',X'09'         REGULAR - ORIGINAL (PROTECT)                 
         DC    C'0 ',X'09'         REGULAR - ORIGINAL                           
         DC    C' Y',X'11'         REGULAR - REPEAT   (PROTECT)                 
         DC    C'0Y',X'11'         REGULAR - REPEAT                             
         DC    C'1 ',X'0C'         SPECIAL - ORIGINAL                           
         DC    C'1Y',X'14'         SPECIAL - REPEAT                             
TYPES    EQU   (*-TYPTAB)/L'TYPTAB                                              
*                                                                               
         EJECT                                                                  
* WORKING STORAGE                                                               
*                                                                               
* GENERAL AREAS                                                                 
*                                                                               
         DS    0F                                                               
RELO     DS    A                                                                
*                                                                               
INTABADR DS    A                   INTAB TABLE ADDRESS                          
SVHHUNIV DS    F                   HOUSEHOLD UNIVERSE FROM H1 RECORD            
HPTPARA  DS    6F                                                               
HPTNOW   DS    F                                                                
HPTCNT   DC    H'0'                                                             
HPTGENSW DC    C'Y'                                                             
HPTFRST  DC    X'01'                                                            
*                                                                               
RELOFRST DC    X'01'                                                            
BYPREAD  DC    X'00'                                                            
BYPASSH4 DC    X'00'               BYPASS ALL BUT 1ST H4 RECORD                 
BYPASS01 DC    X'00'               BYPASS SINGLE DAY AVERAGES                   
CORRSW   DC    X'00'               CORRRECTION RECORD SWITCH                    
HUTSW    DC    X'00'               HUT RECORD GENERATION SWITCH                 
MTWTFSW  DC    X'00'               HUT RECORD (M-T-W-T-F USED)                  
PREVSTIM DC    X'FF'               HUT RECORD PREVIOUS START QTR HR             
*                                                                               
GAASW    DC    C'N'                GROSS AVG AUD SWITCH                         
HAVPP    DC    X'00'               HAVE PROGRAM PUTS                            
PRVPRGSW DC    X'00'               HAVE A PREVIOUS PROGRAM                      
RELSLOT  DC    X'00'               RELEASE SLOT                                 
SUMSLOT  DC    X'00'               SUMMARY SLOT                                 
QHSFRST  DS    C                                                                
QHRSW    DS    C                                                                
BYTE     DS    C                                                                
SWITCH   DS    C                                                                
CNVWRSW  DS    C                                                                
VARIOUS  DS    X                   1=VARIOUS                                    
VARS     DC    CL7'0000000'        USED FOR VARIOUS (AVERAGES)                  
DAYS     DC    CL7'0000000'        USED FOR VARIOUS (INDIVIDUAL DAYS)           
*                                                                               
ZEROS    DC    256C'0'             ZEROS - USE FOR A VARIETY OF THINGS          
*                                                                               
SAVETIME DS    7XL8                SAVE D4EVSHR, D4EVSMIN AND D4DUR             
VARSTIME DS    7XL8                SAVE D4EVSHR, D4EVSMIN AND D4DUR             
*                                                                               
SAVVAR   DS    7XL7                SAVE VAR INFO FROM INDIVIDUAL DAYS           
*                                                                               
THREE    DS    CL3                                                              
         DS    0F                                                               
SAVEINT  DS    CL(INTACCS-INTVALS) SAVE INTERIM RECORD                          
SAVEPNUM DS    CL5                 SAVE PROGRAM NUMBER                          
*                                                                               
TIMTAB   DS    7CL3                                                             
*                                                                               
         EJECT                                                                  
* REPORT DESCRIPTOR SAVE AREA (RESET FOR CORRECTION RECORDS)                    
*                                                                               
BOOK1    DS    XL2                 KEY BOOK                                     
IBOOK1   DS    XL2                 INTERNAL BOOK                                
*                                                                               
BOOK1S   DS    XL2                 KEY BOOK (SAVE AREA)                         
IBOOK1S  DS    XL2                 INTERNAL BOOK (SAVE AREA)                    
*                                                                               
* HOUSEHOLD USAGE SAVE AREA                                                     
*                                                                               
HUTSQH   DS    X                   NEXT QUARTER HOUR                            
HUTDUR   DS    X                                                                
HUTBOOK  DS    XL2                 KEY BOOK VALUE                               
HUTIBOOK DS    XL2                 INTERNAL BOOK VALUE                          
HUTSTA   DS    CL5                                                              
HUTDAYWK DS    X                                                                
*                                                                               
* PROGRAM DESCRIPTOR SAVE AREA                                                  
*                                                                               
PVALS    DS    0CL85                                                            
PNUM     DS    XL2                 PROGRAM NUMBER                               
PNET     DS    CL4                 NETWORK                                      
PDPT     DS    C                   NSI DAYPART (ALWAYS ZERO)                    
PDPT2    DS    CL2                 NTI DAYPART                                  
PTYP     DS    CL2                 PROGRAM TYPE                                 
PPREM    DS    C                   PREMIERE CODE                                
PSHORT   DS    C                   SHORT DURATION INDICATOR                     
PNAME    DS    CL25                PROGRAM NAME                                 
PTITLE   DS    CL32                EPISODE TITLE                                
*                                                                               
PWKBIT   DS    X                   WEEK BITS                                    
PDAY1    DS    X                   DAY CODE                                     
PDAY1BIT DS    X                   DAY BITS                                     
PTOTDUR  DS    XL2                 TOTAL DURATION                               
*                                                                               
PWK1STIM DS    XL2                 START TIME                                   
PWK1DURM DS    X                   DURATION IN MINUTES                          
PWK1AUD  DS    XL2                                                              
PWK1STAC DS    XL2                                                              
PWK1COV  DS    XL2                                                              
PWK1DTYP DS    X                                                                
PWK1RSF  DS    X                                                                
*                                                                               
         EJECT                                                                  
SVD4     DS    0CL59               SAVE D4 RCD'S POSITIONS 182-240              
*        THESE FIELDS ARE NOT REPORTED ON ALL D4 RECORDS                        
S4STA    DS    CL3        182-184  TOTAL PROGRAM STATION COUNT                  
S4COV    DS    CL2        185-186  TOTAL PROGRAM COVERAGE PERCENT               
         DS    CL3        187-189  (FILLER)                                     
S4TELE   DS    CL3        190-192  TELECASTS 01=DAY 02-07=AVERAGES              
S4TOTDUR DS    CL6        193-198  TOTAL DURATION                               
S4AVEHUT DS    CL9        199-207  PROGRAM AVERAGE PROJ. (XXX,XXX,XXX)          
S4AVERTG DS    CL3        208-210  PROGRAM AVERAGE RATING (XX.X)                
S4REPORT DS    CL1        211-211  REPORTABILITY IND. 0=REPORTABLE              
S4HUT    DS    CL9        212-220  PROGRAM HUT PROJ. (XXX,XXX,XXX)              
S4SHR    DS    CL2        221-222  PROGRAM SHARE (XX)                           
S4PROJ   DS    CL9        223-231  TOTAL AUDIENCE PROJ. (XXX,XXX,XXX)           
S4RTG    DS    CL3        232-234  TOTAL AUDIENCE RATING (XX.X)                 
         DS    CL6        235-240  (FILLER)                                     
*                                                                               
*        THESE FIELDS ARE NOT REPORTED ON ALL H4 RECORDS                        
SVPROJ   DS    CL9         92-100  HALF HOUR AUD. PROJ. (XXX,XXX,XXX)           
SVRTG    DS    CL3        101-103  HALF HOUR AUDIENCE RATING (XX.X)             
SVSHR    DS    CL2        114-115  HALF HOUR PROGRAM SHARE (XX)                 
*                                                                               
SVMPROJ  DS    CL9                 MKT BREAK AUD. PROJ. (XXX,XXX,XXX)           
SVRECLN  DS    F                   SAVE INTERIM RECORD'S LENGTH                 
SVNOACCS DS    F                   SAVE NUMBER OF INTACCS FULLWORDS             
*                                                                               
         EJECT                                                                  
* FILE DCB AND BUFFER AREA                                                      
*                                                                               
IN1      DCB   DDNAME=IN1,                                             X        
               DSORG=PS,                                               X        
               RECFM=FB,                                               X        
               LRECL=241,                                              X        
               BLKSIZE=10122,                                          X        
               MACRF=GM,                                               X        
               EODAD=MORET                                                      
*                                                                               
HPTADDR  DS    F                                                                
HPTSAVLN DC    A(HPTLN*48*9)                                                    
*                                                                               
SUMWGHT  DS    CL2                                                              
SUMDAY   DS    C                                                                
SUMSQH   DS    C                                                                
SUMEQH   DS    C                                                                
SUMSTIM  DS    CL2                                                              
SUMETIM  DS    CL2                                                              
         DS    0F                                                               
SUMHPT   DS    CL188                                                            
SVAVGHI  DS    F                   SAVE PROGRAM HH                              
HWCAREA  DS    0CL36               SAVE HH WITH CHILD DATA                      
HWCV18   DS    F                                                                
HWCV12   DS    F                                                                
HWCV06   DS    F                                                                
HWCR18   DS    F                                                                
HWCR12   DS    F                                                                
HWCR06   DS    F                                                                
HWCI18   DS    F                                                                
HWCI12   DS    F                                                                
HWCI06   DS    F                                                                
*                                                                               
*                                                                               
IPGAASW  DS    C                                                                
NOTAVAL  DS    C                   DATA NOT AVAILABLE                           
         DS    0F                                                               
SLOTLN   DC    AL2(NDEMS*4)                                                     
         DS    0F                                                               
DEMAREA  DS    (NDEMS*80*4)C                                                    
UNIVSAVE DS    (NDEMS*80*4)C       SAVE AREA FOR PER. UNIVERSES                 
SVHREC   DS    2000C               SAVE HUT RECORD                              
*                                                                               
*        THE NEXT 1500 BYTES USED FOR EITHER THE SORT OR INTERIM RECORD         
*                                                                               
SVSREC   EQU   *                   SAVE SORT RECORD                             
SVIREC   DS    2000C               SAVE INTERIM RECORD                          
SVGAIMP  DS    444C                                                             
         EJECT                                                                  
MSU      EQU   8                                                                
MFR      EQU   0                                                                
NDEMS    EQU   56                                                               
         EJECT                                                                  
* EQUATE DEMO SLOT NUMBERS                                                      
* RT = TOTAL SAMPLE RECORDS                                                     
* RG = DEMO GROUP RECORDS                                                       
* RI = INTERIM RECORD DEMOS                                                     
RIF25    EQU   2                                                                
RIM25    EQU   3                                                                
RIF68    EQU   4                                                                
RIM68    EQU   5                                                                
RIF911   EQU   6                                                                
RIM911   EQU   7                                                                
RIF611   EQU   8                                                                
RIM611   EQU   9                                                                
RIF1214  EQU   10                                                               
RIM1214  EQU   11                                                               
RIF1517  EQU   12                                                               
RIM1517  EQU   13                                                               
RIF1217  EQU   14                                                               
RIM1217  EQU   15                                                               
RIF1820  EQU   16                                                               
RIM1820  EQU   17                                                               
RIF2124  EQU   18                                                               
RIM2124  EQU   19                                                               
RIF2529  EQU   20                                                               
RIM2529  EQU   21                                                               
RIF3034  EQU   22                                                               
RIM3034  EQU   23                                                               
RIF3539  EQU   24                                                               
RIM3539  EQU   25                                                               
RIF4044  EQU   26                                                               
RIM4044  EQU   27                                                               
RIF4549  EQU   28                                                               
RIM4549  EQU   29                                                               
RIF5054  EQU   30                                                               
RIM5054  EQU   31                                                               
RIF5564  EQU   32                                                               
RIM5564  EQU   33                                                               
RIF65O   EQU   34                                                               
RIM65O   EQU   35                                                               
RILKU3   EQU   36                                                               
RIWW1820 EQU   37                                                               
RIWW2124 EQU   38                                                               
RIWW2534 EQU   39                                                               
RIWW3544 EQU   40                                                               
RIWW4549 EQU   41                                                               
RIWW1849 EQU   42                                                               
RIWW5054 EQU   43                                                               
RIWW55O  EQU   44                                                               
RIWW50O  EQU   45                                                               
RIPW1849 EQU   46                                                               
RIPW55O  EQU   47                                                               
RIL1824  EQU   48                                                               
RIL2534  EQU   49                                                               
RIL3544  EQU   50                                                               
RIL4549  EQU   51                                                               
RIL5054  EQU   52                                                               
RIL55O   EQU   53                                                               
RIL1849  EQU   54                                                               
RIL50O   EQU   55                                                               
* TOTAL SAMPLE DEMOS                                                            
RTF25    EQU   1                                                                
RTM25    EQU   16                                                               
RTF68    EQU   2                                                                
RTM68    EQU   17                                                               
RTF911   EQU   3                                                                
RTM911   EQU   18                                                               
RTF1214  EQU   4                                                                
RTM1214  EQU   19                                                               
RTF1517  EQU   5                                                                
RTM1517  EQU   20                                                               
RTF1820  EQU   6                                                                
RTM1820  EQU   21                                                               
RTF2124  EQU   7                                                                
RTM2124  EQU   22                                                               
RTF2529  EQU   8                                                                
RTM2529  EQU   23                                                               
RTF3034  EQU   9                                                                
RTM3034  EQU   24                                                               
RTF3539  EQU   10                                                               
RTM3539  EQU   25                                                               
RTF4044  EQU   11                                                               
RTM4044  EQU   26                                                               
RTF4549  EQU   12                                                               
RTM4549  EQU   27                                                               
RTF5054  EQU   13                                                               
RTM5054  EQU   28                                                               
RTF5564  EQU   14                                                               
RTM5564  EQU   29                                                               
RTF65O   EQU   15                                                               
RTM65O   EQU   30                                                               
RTLKU3   EQU   31                                                               
RTWW1820 EQU   33                                                               
RTWW2124 EQU   34                                                               
RTWW2534 EQU   35                                                               
RTWW3544 EQU   36                                                               
RTWW4549 EQU   37                                                               
RTWW5054 EQU   38                                                               
RTWW55O  EQU   39                                                               
RTPW1849 EQU   41                                                               
RTPW55O  EQU   42                                                               
RTL1824  EQU   43                                                               
RTL2534  EQU   44                                                               
RTL3544  EQU   45                                                               
RTL4549  EQU   46                                                               
RTL5054  EQU   47                                                               
RTL55O   EQU   48                                                               
* GROUP DEMO EQUATES                                                            
RGF25    EQU   501                                                              
RGM25    EQU   516                                                              
RGF611   EQU   502                                                              
RGM611   EQU   517                                                              
RGF1217  EQU   504                                                              
RGM1217  EQU   519                                                              
RGF1820  EQU   506                                                              
RGM1820  EQU   521                                                              
RGF2124  EQU   507                                                              
RGM2124  EQU   522                                                              
RGF2529  EQU   508                                                              
RGM2529  EQU   523                                                              
RGF3034  EQU   509                                                              
RGM3034  EQU   524                                                              
RGF3539  EQU   510                                                              
RGM3539  EQU   525                                                              
RGF4044  EQU   511                                                              
RGM4044  EQU   526                                                              
RGF4549  EQU   512                                                              
RGM4549  EQU   527                                                              
RGF5054  EQU   513                                                              
RGM5054  EQU   528                                                              
RGF5564  EQU   514                                                              
RGM5564  EQU   529                                                              
RGF65O   EQU   515                                                              
RGM65O   EQU   530                                                              
RGWW1849 EQU   533                                                              
RGWW50O  EQU   534                                                              
RGL1849  EQU   535                                                              
RGL50O   EQU   536                                                              
         SPACE 2                                                                
ROHOMES  EQU   0                                                                
ROW18O   EQU   1                                                                
ROM18O   EQU   2                                                                
ROWW18O  EQU   3                                                                
ROUSA    EQU   4                                                                
ROW1224  EQU   5                                                                
ROW1834  EQU   6                                                                
ROW1849  EQU   7                                                                
ROW2554  EQU   8                                                                
ROW3564  EQU   9                                                                
ROW55O   EQU   10                                                               
ROM1834  EQU   11                                                               
ROM1849  EQU   12                                                               
ROM2554  EQU   13                                                               
ROM3564  EQU   14                                                               
ROM55O   EQU   15                                                               
ROV1217  EQU   16                                                               
ROV211   EQU   17                                                               
ROV611   EQU   18                                                               
ROW1820  EQU   19                                                               
ROM1820  EQU   20                                                               
*        TRANSLATE INPUT DEMOS TO INTERIM SLOTS                                 
SLOTTAB  DS    0H                                                               
         DC    AL2(RTF25,RIF25)                                                 
         DC    AL2(RTM25,RIM25)                                                 
         DC    AL2(RTF68,RIF68)                                                 
         DC    AL2(RTM68,RIM68)                                                 
         DC    AL2(RTF911,RIF911)                                               
         DC    AL2(RTM911,RIM911)                                               
         DC    AL2(RTF1214,RIF1214)                                             
         DC    AL2(RTM1214,RIM1214)                                             
         DC    AL2(RTF1517,RIF1517)                                             
         DC    AL2(RTM1517,RIM1517)                                             
         DC    AL2(RTF1820,RIF1820)                                             
         DC    AL2(RTM1820,RIM1820)                                             
         DC    AL2(RTF2124,RIF2124)                                             
         DC    AL2(RTM2124,RIM2124)                                             
         DC    AL2(RTF2529,RIF2529)                                             
         DC    AL2(RTM2529,RIM2529)                                             
         DC    AL2(RTF3034,RIF3034)                                             
         DC    AL2(RTM3034,RIM3034)                                             
         DC    AL2(RTF3539,RIF3539)                                             
         DC    AL2(RTM3539,RIM3539)                                             
         DC    AL2(RTF4044,RIF4044)                                             
         DC    AL2(RTM4044,RIM4044)                                             
         DC    AL2(RTF4549,RIF4549)                                             
         DC    AL2(RTM4549,RIM4549)                                             
         DC    AL2(RTF5054,RIF5054)                                             
         DC    AL2(RTM5054,RIM5054)                                             
         DC    AL2(RTF5564,RIF5564)                                             
         DC    AL2(RTM5564,RIM5564)                                             
         DC    AL2(RTF65O,RIF65O)                                               
         DC    AL2(RTM65O,RIM65O)                                               
         DC    AL2(RTLKU3,RILKU3)                                               
         DC    AL2(RTWW1820,RIWW1820)                                           
         DC    AL2(RTWW2124,RIWW2124)                                           
         DC    AL2(RTWW2534,RIWW2534)                                           
         DC    AL2(RTWW3544,RIWW3544)                                           
         DC    AL2(RTWW4549,RIWW4549)                                           
         DC    AL2(RTWW5054,RIWW5054)                                           
         DC    AL2(RTWW55O,RIWW55O)                                             
         DC    AL2(RTPW1849,RIPW1849)                                           
         DC    AL2(RTPW55O,RIPW55O)                                             
         DC    AL2(RTL1824,RIL1824)                                             
         DC    AL2(RTL2534,RIL2534)                                             
         DC    AL2(RTL3544,RIL3544)                                             
         DC    AL2(RTL4549,RIL4549)                                             
         DC    AL2(RTL5054,RIL5054)                                             
         DC    AL2(RTL55O,RIL55O)                                               
         DC    AL2(RGF25,RIF25)                                                 
         DC    AL2(RGM25,RIM25)                                                 
         DC    AL2(RGF611,RIF611)                                               
         DC    AL2(RGM611,RIM611)                                               
         DC    AL2(RGF1217,RIF1217)                                             
         DC    AL2(RGM1217,RIM1217)                                             
         DC    AL2(RGF1820,RIF1820)                                             
         DC    AL2(RGM1820,RIM1820)                                             
         DC    AL2(RGF2124,RIF2124)                                             
         DC    AL2(RGM2124,RIM2124)                                             
         DC    AL2(RGF2529,RIF2529)                                             
         DC    AL2(RGM2529,RIM2529)                                             
         DC    AL2(RGF3034,RIF3034)                                             
         DC    AL2(RGM3034,RIM3034)                                             
         DC    AL2(RGF3539,RIF3539)                                             
         DC    AL2(RGM3539,RIM3539)                                             
         DC    AL2(RGF4044,RIF4044)                                             
         DC    AL2(RGM4044,RIM4044)                                             
         DC    AL2(RGF4549,RIF4549)                                             
         DC    AL2(RGM4549,RIM4549)                                             
         DC    AL2(RGF5054,RIF5054)                                             
         DC    AL2(RGM5054,RIM5054)                                             
         DC    AL2(RGF5564,RIF5564)                                             
         DC    AL2(RGM5564,RIM5564)                                             
         DC    AL2(RGF65O,RIF65O)                                               
         DC    AL2(RGM65O,RIM65O)                                               
         DC    AL2(RGWW1849,RIWW1849)                                           
         DC    AL2(RGWW50O,RIWW50O)                                             
         DC    AL2(RGL1849,RIL1849)                                             
         DC    AL2(RGL50O,RIL50O)                                               
         DC    X'FFFF',X'FFFF'                                                  
         EJECT                                                                  
* TABLE OF RATING SERVICE MARKET BREAK CODES                                    
CRUSA    EQU   0                  TOTAL USA                                     
*                                 TERRITORY                                     
CRNE     EQU   1                   NORTHEAST                                    
CREC     EQU   2                   EAST CENTRAL                                 
CRWC     EQU   3                   WEST CENTRAL                                 
CRSE     EQU   4                   SOUTHEAST                                    
CRSW     EQU   5                   SOUTHWEST                                    
CRPAC    EQU   6                   PACIFIC                                      
*                                 COUNTY SIZE                                   
CRCSA    EQU   20                  CS A                                         
CRCSB    EQU   21                  CS B                                         
CRCSCD   EQU   22                  CS C+D                                       
*                                 CABLE                                         
CRPCBL   EQU   60                  PAY CABLE                                    
CRBCBL   EQU   61                  BASIC CABLE                                  
CRNCBL   EQU   62                  NO CABLE                                     
*                                 HOUSEHOLD SIZE                                
CRHHS1   EQU   140                 1                                            
CRHHS2   EQU   141                 2                                            
CRHHS3   EQU   142                 3                                            
CRHHS4O  EQU   143                 4+                                           
*                                 INCOME                                        
CRIU20   EQU   240                 UNDER 20K                                    
CRIU30   EQU   241                 20-29,999                                    
CRIU40   EQU   242                 30-39,999                                    
CRIU50   EQU   243                 40-49,999                                    
CRIU60   EQU   244                 50-59,999                                    
CRIO60   EQU   245                 OVER  60K                                    
*                                 SELECTED UPPER DEMOS                          
CRIUDNA  EQU   260                 40K+ & NON-ADULTS                            
CRIUDPOM EQU   261                 40K+ & POM                                   
CRIUDCOL EQU   262                 40K+ & COLLEGE                               
*                                 PRESENCE OF NON-ADULTS                        
CRNAU18  EQU   350                 ANY UNDER 18                                 
CRNAU12  EQU   351                 ANY UNDER 12                                 
CRNAU06  EQU   352                 ANY UNDER 6                                  
CRNAU03  EQU   353                 ANY UNDER 3                                  
CRNA611  EQU   354                 ANY 6-11                                     
CRNA1217 EQU   355                 ANY 12-17                                    
*                                 TIME ZONE                                     
CRTZEAST EQU   40                  EASTERN                                      
CRTZCENT EQU   41                  CENTRAL                                      
CRTZMP   EQU   42                  MOUNTAIN AND PACIFIC                         
*                                                                               
CRVCR    EQU   80                  PRESENCE OF VCR                              
*                                                                               
CRREMOTE EQU   100                 PRESENCE OF REMOTE CONTROL                   
*                                 NUMBER OF TV SETS                             
CRTV1    EQU   120                 1                                            
CRTV2    EQU   121                 2                                            
CRTV3    EQU   122                 3                                            
CRTV4O   EQU   123                 4+                                           
*                                 AGE OF HOH                                    
CRHO25U  EQU   160                 UNDER 25                                     
CRHO2534 EQU   161                 25-34                                        
CRHO3554 EQU   162                 35-54                                        
CRHO5564 EQU   163                 55-64                                        
CRHO65O  EQU   164                 65+                                          
*                                 AGE OF HOH WITHIN HH SIZE                     
CRHO50U  EQU   180                 1-2 PERSONS, HOH UNDER 50                    
CRHO50O  EQU   181                 1-2 PERSONS, HOH 50+                         
*                                 EDUCATION OF HOH                              
CRED8U   EQU   200                 UNDER 8 YEARS                                
CRED12U  EQU   201                 1-3 YEARS HS                                 
CRED12   EQU   202                 4 YEARS HS                                   
CRED16U  EQU   203                 1-3 YEARS COL                                
CRED16O  EQU   204                 4+ YEARS COL                                 
*                                 OCCUPATION OF HOH                             
CROCWC   EQU   220                 WHITE COLLAR                                 
CROCBC   EQU   221                 BLUE COLLAR                                  
CROCNO   EQU   222                 NOT IN LABOR FORCE                           
*                                 RACE                                          
CRRACEB  EQU   320                 BLACK                                        
CRRACEW  EQU   321                 WHITE                                        
*                                 CAR OWNERSHIP                                 
CRCARANY EQU   400                 ANY OWNERS                                   
CRCAR1   EQU   401                 1 CAR                                        
CRCAR2O  EQU   402                 2+ CARS                                      
CRCARNEW EQU   403                 ANY CAR, NEW PROSPECT                        
*                                 TRUCK OWNERSHIP                               
CRTRKANY EQU   420                 ANY OWNERS                                   
CRTRK1   EQU   421                 1 TRUCK                                      
CRTRK2O  EQU   422                 2+ TRUCKS                                    
CRTRKNEW EQU   423                 ANY TRUCK, NEW PROSPECT                      
*                                 PET OWNERSHIP                                 
CRDOG    EQU   440                 DOG                                          
CRCAT    EQU   441                 CAT                                          
*                                                                               
CRDUAL   EQU   501                 DUAL INCOME HH 40K+                          
         SPACE 2                                                                
* TABLE OF INTERIM AREA SLOTS FOR MARKET BREAKS                                 
CIUSA    EQU   0                  TOTAL USA                                     
*                                 TERRITORY                                     
CINE     EQU   1                   NORTHEAST                                    
CIEC     EQU   2                   EAST CENTRAL                                 
CIWC     EQU   3                   WEST CENTRAL                                 
CISE     EQU   4                   SOUTHEAST                                    
CISW     EQU   5                   SOUTHWEST                                    
CIPAC    EQU   6                   PACIFIC                                      
*                                 COUNTY SIZE                                   
CICSA    EQU   7                   CS A                                         
CICSB    EQU   8                   CS B                                         
CICSCD   EQU   9                   CS C+D                                       
*                                 CABLE                                         
CIPCBL   EQU   13                  PAY CABLE                                    
CIBCBL   EQU   14                  BASIC CABLE                                  
CINCBL   EQU   15                  NO CABLE                                     
*                                 HOUSEHOLD SIZE                                
CIHHS1   EQU   16                  1                                            
CIHHS2   EQU   17                  2                                            
CIHHS3   EQU   18                  3                                            
CIHHS4O  EQU   19                  4+                                           
*                                 INCOME                                        
CIIU20   EQU   20                  UNDER 20K                                    
CIIU30   EQU   21                  20-29,999                                    
CIIU40   EQU   22                  30-39,999                                    
CIIU50   EQU   23                  40-49,999                                    
CIIU60   EQU   24                  50-59,999                                    
CIIO60   EQU   25                  OVER  60K                                    
*                                 SELECTED UPPER DEMOS                          
CIIUDNA  EQU   26                  40K+ & NON-ADULTS                            
CIIUDPOM EQU   27                  40K+ & POM                                   
CIIUDCOL EQU   28                  40K+ & COLLEGE                               
*                                 PRESENCE OF NON-ADULTS                        
CINAU18  EQU   30                  ANY UNDER 18                                 
CINAU12  EQU   31                  ANY UNDER 12                                 
CINAU06  EQU   32                  ANY UNDER 6                                  
CINAU03  EQU   33                  ANY UNDER 3                                  
CINA611  EQU   34                  ANY 6-11                                     
CINA1217 EQU   35                  ANY 12-17                                    
*                                 TIME ZONE                                     
CITZEAST EQU   10                  EASTERN                                      
CITZCENT EQU   11                  CENTRAL                                      
CITZMP   EQU   12                  MOUNTAIN AND PACIFIC                         
*                                                                               
CIVCR    EQU   36                  PRESENCE OF VCR                              
*                                                                               
CIREMOTE EQU   37                  PRESENCE OF REMOTE CONTROL                   
*                                 NUMBER OF TV SETS                             
CITV1    EQU   38                  1                                            
CITV2    EQU   39                  2                                            
CITV3    EQU   40                  3                                            
CITV4O   EQU   41                  4+                                           
*                                 AGE OF HOH                                    
CIHO25U  EQU   42                  UNDER 25                                     
CIHO2534 EQU   43                  25-34                                        
CIHO3554 EQU   44                  35-54                                        
CIHO5564 EQU   45                  55-64                                        
CIHO65O  EQU   46                  65+                                          
*                                 AGE OF HOH WITHIN HH SIZE                     
CIHO50U  EQU   47                  1-2 PERSONS, HOH UNDER 50                    
CIHO50O  EQU   48                  1-2 PERSONS, HOH 50+                         
*                                 EDUCATION OF HOH                              
CIED8U   EQU   49                  UNDER 8 YEARS                                
CIED12U  EQU   50                  1-3 YEARS HS                                 
CIED12   EQU   51                  4 YEARS HS                                   
CIED16U  EQU   52                  1-3 YEARS COL                                
CIED16O  EQU   53                  4+ YEARS COL                                 
*                                 OCCUPATION OF HOH                             
CIOCWC   EQU   54                  WHITE COLLAR                                 
CIOCBC   EQU   55                  BLUE COLLAR                                  
CIOCNO   EQU   56                  NOT IN LABOR FORCE                           
*                                 RACE                                          
CIRACEB  EQU   57                  BLACK                                        
CIRACEW  EQU   58                  WHITE                                        
*                                 CAR OWNERSHIP                                 
CICARANY EQU   59                  ANY OWNERS                                   
CICAR1   EQU   60                  1 CAR                                        
CICAR2O  EQU   61                  2+ CARS                                      
CICARNEW EQU   62                  ANY CAR, NEW PROSPECT                        
*                                 TRUCK OWNERSHIP                               
CITRKANY EQU   63                  ANY OWNERS                                   
CITRK1   EQU   64                  1 TRUCK                                      
CITRK2O  EQU   65                  2+ TRUCKS                                    
CITRKNEW EQU   66                  ANY TRUCK, NEW PROSPECT                      
*                                 PET OWNERSHIP                                 
CIDOG    EQU   67                  DOG                                          
CICAT    EQU   68                  CAT                                          
*                                                                               
CIDUAL   EQU   29                  DUAL INCOME HH 40K+                          
*                                                                               
*        GENERATED CELLS                                                        
CISO     EQU   69                  SOUTH                                        
CIACBL   EQU   70                  ANY CABLE                                    
CIIO20   EQU   71                  20K+                                         
CIIO30   EQU   72                  30K+                                         
CIIO40   EQU   73                  40K+                                         
CIIO50   EQU   74                  50K+                                         
CIIU30U  EQU   75                  30K-                                         
         SPACE 2                                                                
* TABLE OF OUTPUT SECTIONS FOR MARKET BREAKS                                    
COUSA    EQU   1                  TOTAL USA                                     
*                                 TERRITORY                                     
CONE     EQU   11                  NORTHEAST                                    
COEC     EQU   12                  EAST CENTRAL                                 
COWC     EQU   13                  WEST CENTRAL                                 
COSE     EQU   16   *              SOUTHEAST                                    
COSW     EQU   17   *              SOUTHWEST                                    
COPAC    EQU   15                  PACIFIC                                      
*                                 COUNTY SIZE                                   
COCSA    EQU   21                  CS A                                         
COCSB    EQU   22                  CS B                                         
COCSCD   EQU   23                  CS C+D                                       
*                                 CABLE                                         
COPCBL   EQU   32                  PAY CABLE                                    
COBCBL   EQU   33                  BASIC CABLE                                  
CONCBL   EQU   34                  NO CABLE                                     
*                                 HOUSEHOLD SIZE                                
COHHS1   EQU   41                  1                                            
COHHS2   EQU   42                  2                                            
COHHS3   EQU   43                  3                                            
COHHS4O  EQU   44                  4+                                           
*                                 INCOME                                        
COIU20   EQU   68                  UNDER 20K                                    
COIU30   EQU   80                  20-29,999                                    
COIU40   EQU   81                  30-39,999                                    
COIU50   EQU   82                  40-49,999                                    
COIU60   EQU   83                  50-59,999                                    
COIO60   EQU   66                  OVER  60K                                    
*                                 SELECTED UPPER DEMOS                          
COIUDNA  EQU   74                  40K+ & NON-ADULTS                            
COIUDPOM EQU   75                  40K+ & POM                                   
COIUDCOL EQU   76                  40K+ & COLLEGE                               
*                                 PRESENCE OF NON-ADULTS                        
CONAU18  EQU   51                  ANY UNDER 18                                 
CONAU12  EQU   52                  ANY UNDER 12                                 
CONAU06  EQU   53                  ANY UNDER 6                                  
CONAU03  EQU   54                  ANY UNDER 3                                  
CONA611  EQU   55                  ANY 6-11                                     
CONA1217 EQU   56                  ANY 12-17                                    
*                                 TIME ZONE                                     
COTZEAST EQU   91                  EASTERN                                      
COTZCENT EQU   92                  CENTRAL                                      
COTZMP   EQU   93                  MOUNTAIN AND PACIFIC                         
*                                                                               
COVCR    EQU   101                 PRESENCE OF VCR                              
*                                                                               
COREMOTE EQU   102                 PRESENCE OF REMOTE CONTROL                   
*                                 NUMBER OF TV SETS                             
COTV1    EQU   103                 1                                            
COTV2    EQU   104                 2                                            
COTV3    EQU   105                 3                                            
COTV4O   EQU   106                 4+                                           
*                                 AGE OF HOH                                    
COHO25U  EQU   111                 UNDER 25                                     
COHO2534 EQU   112                 25-34                                        
COHO3554 EQU   113                 35-54                                        
COHO5564 EQU   114                 55-64                                        
COHO65O  EQU   115                 65+                                          
*                                 AGE OF HOH WITHIN HH SIZE                     
COHO50U  EQU   118                 1-2 PERSONS, HOH UNDER 50                    
COHO50O  EQU   119                 1-2 PERSONS, HOH 50+                         
*                                 EDUCATION OF HOH                              
COED8U   EQU   121                 UNDER 8 YEARS                                
COED12U  EQU   122                 1-3 YEARS HS                                 
COED12   EQU   123                 4 YEARS HS                                   
COED16U  EQU   124                 1-3 YEARS COL                                
COED16O  EQU   125                 4+ YEARS COL                                 
*                                 OCCUPATION OF HOH                             
COOCWC   EQU   131                 WHITE COLLAR                                 
COOCBC   EQU   132                 BLUE COLLAR                                  
COOCNO   EQU   133                 NOT IN LABOR FORCE                           
*                                 RACE                                          
CORACEB  EQU   141                 BLACK                                        
CORACEW  EQU   142                 WHITE                                        
*                                 CAR OWNERSHIP                                 
COCARANY EQU   151                 ANY OWNERS                                   
COCAR1   EQU   152                 1 CAR                                        
COCAR2O  EQU   153                 2+ CARS                                      
COCARNEW EQU   154                 ANY CAR, NEW PROSPECT                        
*                                 TRUCK OWNERSHIP                               
COTRKANY EQU   156                 ANY OWNERS                                   
COTRK1   EQU   157                 1 TRUCK                                      
COTRK2O  EQU   158                 2+ TRUCKS                                    
COTRKNEW EQU   159                 ANY TRUCK, NEW PROSPECT                      
*                                 PET OWNERSHIP                                 
CODOG    EQU   161                 DOG                                          
COCAT    EQU   162                 CAT                                          
*                                                                               
CODUAL   EQU   77                  DUAL INCOME HH 40K+                          
*                                                                               
*        GENERATED CELLS                                                        
COSO     EQU   14                  SOUTH                                        
COACBL   EQU   31                  ANY CABLE                                    
COIO20   EQU   62                  20K+                                         
COIO30   EQU   63                  30K+                                         
COIO40   EQU   64                  40K+                                         
COIO50   EQU   65                  50K+                                         
COIU30U  EQU   67                  30K-                                         
         SPACE 2                                                                
* TABLE TO CONVERT MARKET BREAKS TO INTERNAL SLOTS                              
CRCITAB  DS    0H                                                               
         DC    AL2(CRUSA,CIUSA)    TOTAL USA                                    
*                                 TERRITORY                                     
         DC    AL2(CRNE,CINE)      NORTHEAST                                    
         DC    AL2(CREC,CIEC)      EAST CENTRAL                                 
         DC    AL2(CRWC,CIWC)      WEST CENTRAL                                 
         DC    AL2(CRSE,CISE)      SOUTHEAST                                    
         DC    AL2(CRSW,CISW)      SOUTHWEST                                    
         DC    AL2(CRPAC,CIPAC)    PACIFIC                                      
*                                 COUNTY SIZE                                   
         DC    AL2(CRCSA,CICSA)    CS A                                         
         DC    AL2(CRCSB,CICSB)    CS B                                         
         DC    AL2(CRCSCD,CICSCD)  CS C+D                                       
*                                 CABLE                                         
         DC    AL2(CRPCBL,CIPCBL)  PAY CABLE                                    
         DC    AL2(CRBCBL,CIBCBL)  BASIC CABLE                                  
         DC    AL2(CRNCBL,CINCBL)  NO CABLE                                     
*                                 HOUSEHOLD SIZE                                
         DC    AL2(CRHHS1,CIHHS1)  1                                            
         DC    AL2(CRHHS2,CIHHS2)  2                                            
         DC    AL2(CRHHS3,CIHHS3)  3                                            
         DC    AL2(CRHHS4O,CIHHS4O) 4+                                          
*                                 INCOME                                        
         DC    AL2(CRIU20,CIIU20)  UNDER 20K                                    
         DC    AL2(CRIU30,CIIU30)  20-29,999                                    
         DC    AL2(CRIU40,CIIU40)  30-39,999                                    
         DC    AL2(CRIU50,CIIU50)  40-49,999                                    
         DC    AL2(CRIU60,CIIU60)  50-59,999                                    
         DC    AL2(CRIO60,CIIO60)  OVER  60K                                    
*                                 SELECTED UPPER DEMOS                          
         DC    AL2(CRIUDNA,CIIUDNA) 40K+ & NON-ADULTS                           
         DC    AL2(CRIUDPOM,CIIUDPOM) 40K+ & POM                                
         DC    AL2(CRIUDCOL,CIIUDCOL) 40K+ & COLLEGE                            
*                                 PRESENCE OF NON-ADULTS                        
         DC    AL2(CRNAU18,CINAU18) ANY UNDER 18                                
         DC    AL2(CRNAU12,CINAU12) ANY UNDER 12                                
         DC    AL2(CRNAU06,CINAU06) ANY UNDER 6                                 
         DC    AL2(CRNAU03,CINAU03) ANY UNDER 3                                 
         DC    AL2(CRNA611,CINA611) ANY 6-11                                    
         DC    AL2(CRNA1217,CINA1217) ANY 12-17                                 
*                                 TIME ZONE                                     
         DC    AL2(CRTZEAST,CITZEAST) EASTERN                                   
         DC    AL2(CRTZCENT,CITZCENT) CENTRAL                                   
         DC    AL2(CRTZMP,CITZMP)  MOUNTAIN AND PACIFIC                         
*                                                                               
         DC    AL2(CRVCR,CIVCR)    PRESENCE OF VCR                              
*                                                                               
         DC    AL2(CRREMOTE,CIREMOTE) PRESENCE OF REMOTE CONTROL                
*                                 NUMBER OF TV SETS                             
         DC    AL2(CRTV1,CITV1)    1                                            
         DC    AL2(CRTV2,CITV2)    2                                            
         DC    AL2(CRTV3,CITV3)    3                                            
         DC    AL2(CRTV4O,CITV4O)  4+                                           
*                                 AGE OF HOH                                    
         DC    AL2(CRHO25U,CIHO25U) UNDER 25                                    
         DC    AL2(CRHO2534,CIHO2534) 25-34                                     
         DC    AL2(CRHO3554,CIHO3554) 35-54                                     
         DC    AL2(CRHO5564,CIHO5564) 55-64                                     
         DC    AL2(CRHO65O,CIHO65O) 65+                                         
*                                 AGE OF HOH WITHIN HH SIZE                     
         DC    AL2(CRHO50U,CIHO50U) 1-2 PERSONS, HOH UNDER 50                   
         DC    AL2(CRHO50O,CIHO50O) 1-2 PERSONS, HOH 50+                        
*                                 EDUCATION OF HOH                              
         DC    AL2(CRED8U,CIED8U)  UNDER 8 YEARS                                
         DC    AL2(CRED12U,CIED12U) 1-3 YEARS HS                                
         DC    AL2(CRED12,CIED12)  4 YEARS HS                                   
         DC    AL2(CRED16U,CIED16U) 1-3 YEARS COL                               
         DC    AL2(CRED16O,CIED16O) 4+ YEARS COL                                
*                                 OCCUPATION OF HOH                             
         DC    AL2(CROCWC,CIOCWC)  WHITE COLLAR                                 
         DC    AL2(CROCBC,CIOCBC)  BLUE COLLAR                                  
         DC    AL2(CROCNO,CIOCNO)  NOT IN LABOR FORCE                           
*                                 RACE                                          
         DC    AL2(CRRACEW,CIRACEW) WHITE                                       
         DC    AL2(CRRACEB,CIRACEB) BLACK                                       
*                                 CAR OWNERSHIP                                 
         DC    AL2(CRCARANY,CICARANY) ANY OWNERS                                
         DC    AL2(CRCAR1,CICAR1)  1 CAR                                        
         DC    AL2(CRCAR2O,CICAR2O) 2+ CARS                                     
         DC    AL2(CRCARNEW,CICARNEW) ANY CAR, NEW PROSPECT                     
*                                 TRUCK OWNERSHIP                               
         DC    AL2(CRTRKANY,CITRKANY) ANY OWNERS                                
         DC    AL2(CRTRK1,CITRK1)  1 TRUCK                                      
         DC    AL2(CRTRK2O,CITRK2O) 2+ TRUCKS                                   
         DC    AL2(CRTRKNEW,CITRKNEW) ANY TRUCK, NEW PROSPECT                   
*                                 PET OWNERSHIP                                 
         DC    AL2(CRDOG,CIDOG)    DOG                                          
         DC    AL2(CRCAT,CICAT)    CAT                                          
*                                                                               
         DC    AL2(CRDUAL,CIDUAL)  DUAL INCOME HH 40K+                          
         DC    X'FFFF',X'FFFF'                                                  
         SPACE 2                                                                
* TABLE TO CONVERT MARKET BREAKS TO OUTPUT SECTIONS                             
CRCOTAB  DS    0H                                                               
         DC    AL2(CIUSA,COUSA),X'00' TOTAL USA                                 
*                                 TERRITORY                                     
         DC    AL2(CINE,CONE),X'00' NORTHEAST                                   
         DC    AL2(CIEC,COEC),X'00' EAST CENTRAL                                
         DC    AL2(CIWC,COWC),X'00' WEST CENTRAL                                
         DC    AL2(CISE,COSE),X'00' SOUTHEAST                                   
         DC    AL2(CISW,COSW),X'00' SOUTHWEST                                   
         DC    AL2(CIPAC,COPAC),X'00' PACIFIC                                   
*                                 COUNTY SIZE                                   
         DC    AL2(CICSA,COCSA),X'01' CS A                                      
         DC    AL2(CICSB,COCSB),X'01' CS B                                      
         DC    AL2(CICSCD,COCSCD),X'01' CS C+D                                  
*                                 CABLE                                         
         DC    AL2(CIPCBL,COPCBL),X'00' PAY CABLE                               
         DC    AL2(CIBCBL,COBCBL),X'00' BASIC CABLE                             
         DC    AL2(CINCBL,CONCBL),X'00' NO CABLE                                
*                                 HOUSEHOLD SIZE                                
         DC    AL2(CIHHS1,COHHS1),X'00' 1                                       
         DC    AL2(CIHHS2,COHHS2),X'00' 2                                       
         DC    AL2(CIHHS3,COHHS3),X'00' 3                                       
         DC    AL2(CIHHS4O,COHHS4O),X'00' 4+                                    
*                                 INCOME                                        
         DC    AL2(CIIU20,COIU20),X'00' UNDER 20K                               
         DC    AL2(CIIU30,COIU30),X'00' 20-29,999                               
         DC    AL2(CIIU40,COIU40),X'00' 30-39,999                               
         DC    AL2(CIIU50,COIU50),X'00' 40-49,999                               
         DC    AL2(CIIU60,COIU60),X'00' 50-59,999                               
         DC    AL2(CIIO60,COIO60),X'00' OVER 60K                                
*                                 SELECTED UPPER DEMOS                          
         DC    AL2(CIIUDNA,COIUDNA),X'01' 40K+ & NON-ADULTS                     
         DC    AL2(CIIUDPOM,COIUDPOM),X'01' 40K+ & POM                          
         DC    AL2(CIIUDCOL,COIUDCOL),X'01' 40K+ & COLLEGE                      
*                                 PRESENCE OF NON-ADULTS                        
         DC    AL2(CINAU18,CONAU18),X'01' ANY UNDER 18                          
         DC    AL2(CINAU12,CONAU12),X'01' ANY UNDER 12                          
         DC    AL2(CINAU06,CONAU06),X'01' ANY UNDER 6                           
         DC    AL2(CINAU03,CONAU03),X'01' ANY UNDER 3                           
         DC    AL2(CINA611,CONA611),X'01' ANY 6-11                              
         DC    AL2(CINA1217,CONA1217),X'01' ANY 12-17                           
*                                 TIME ZONE                                     
         DC    AL2(CITZEAST,COTZEAST),C'O'  EASTERN                             
         DC    AL2(CITZCENT,COTZCENT),C'O'  CENTRAL                             
         DC    AL2(CITZMP,COTZMP),C'O'  MOUNTAIN AND PACIFIC                    
*                                                                               
         DC    AL2(CIVCR,COVCR),C'O'  PRESENCE OF VCR                           
*                                                                               
         DC    AL2(CIREMOTE,COREMOTE),C'O'  PRESENCE OF REMOTE CONTROL          
*                                 NUMBER OF TV SETS                             
         DC    AL2(CITV1,COTV1),C'O'  1                                         
         DC    AL2(CITV2,COTV2),C'O'  2                                         
         DC    AL2(CITV3,COTV3),C'O'  3                                         
         DC    AL2(CITV4O,COTV4O),C'O'  4+                                      
*                                 AGE OF HOH                                    
         DC    AL2(CIHO25U,COHO25U),C'O'  UNDER 25                              
         DC    AL2(CIHO2534,COHO2534),C'O'  25-34                               
         DC    AL2(CIHO3554,COHO3554),C'O'  35-54                               
         DC    AL2(CIHO5564,COHO5564),C'O'  55-64                               
         DC    AL2(CIHO65O,COHO65O),C'O'  65+                                   
*                                 AGE OF HOH WITHIN HH SIZE                     
         DC    AL2(CIHO50U,COHO50U),X'00' 1-2 PERSONS, HOH UNDER 50             
         DC    AL2(CIHO50O,COHO50O),X'00' 1-2 PERSONS, HOH 50+                  
*                                 EDUCATION OF HOH                              
         DC    AL2(CIED8U,COED8U),C'O'  UNDER 8 YEARS                           
         DC    AL2(CIED12U,COED12U),C'O'  1-3 YEARS HS                          
         DC    AL2(CIED12,COED12),C'O'  4 YEARS HS                              
         DC    AL2(CIED16U,COED16U),C'O'  1-3 YEARS COL                         
         DC    AL2(CIED16O,COED16O),C'O'  4+ YEARS COL                          
*                                 OCCUPATION OF HOH                             
         DC    AL2(CIOCWC,COOCWC),C'O'  WHITE COLLAR                            
         DC    AL2(CIOCBC,COOCBC),C'O'  BLUE COLLAR                             
         DC    AL2(CIOCNO,COOCNO),C'O'  NOT IN LABOR FORCE                      
*                                 RACE                                          
         DC    AL2(CIRACEW,CORACEW),C'O'  WHITE                                 
         DC    AL2(CIRACEB,CORACEB),C'O'  BLACK                                 
*                                 CAR OWNERSHIP                                 
         DC    AL2(CICARANY,COCARANY),C'O'  ANY OWNERS                          
         DC    AL2(CICAR1,COCAR1),C'O'  1 CAR                                   
         DC    AL2(CICAR2O,COCAR2O),C'O'  2+ CARS                               
         DC    AL2(CICARNEW,COCARNEW),C'O'  ANY CAR, NEW PROSPECT               
*                                 TRUCK OWNERSHIP                               
         DC    AL2(CITRKANY,COTRKANY),C'O'  ANY OWNERS                          
         DC    AL2(CITRK1,COTRK1),C'O'  1 TRUCK                                 
         DC    AL2(CITRK2O,COTRK2O),C'O'  2+ TRUCKS                             
         DC    AL2(CITRKNEW,COTRKNEW),C'O'  ANY TRUCK, NEW PROSPECT             
*                                 PET OWNERSHIP                                 
         DC    AL2(CIDOG,CODOG),C'O'  DOG                                       
         DC    AL2(CICAT,COCAT),C'O'  CAT                                       
*                                                                               
         DC    AL2(CIDUAL,CODUAL),C'O'  DUAL INCOME HH 40K+                     
* COMPUTED SLOTS                                                                
         DC    AL2(CISO,COSO),X'00' SOUTH                                       
         DC    AL2(CIACBL,COACBL),X'00' ANY CABLE                               
         DC    AL2(CIIO20,COIO20),X'00' OVER 20K                                
         DC    AL2(CIIO30,COIO30),X'00' OVER 30K                                
         DC    AL2(CIIO40,COIO40),X'00' OVER 30K                                
         DC    AL2(CIIO50,COIO50),X'00' OVER 50K                                
         DC    AL2(CIIU30U,COIU30U),X'00' UNDER 30                              
         DC    X'FFFF',X'FFFF',X'FF'                                            
         SPACE 2                                                                
CIGENTAB DS    0H                                                               
         DC    AL2(CISO,CISE,CISW,0,0,0)                                        
         DC    AL2(CIACBL,CIPCBL,CIBCBL,0,0,0)                                  
         DC    AL2(CIIO20,CIIU30,CIIU40,CIIU50,CIIU60,CIIO60)                   
         DC    AL2(CIIO30,CIIU40,CIIU50,CIIU60,CIIO60,0)                        
         DC    AL2(CIIO40,CIIU50,CIIU60,CIIO60,0,0)                             
         DC    AL2(CIIO50,CIIU60,CIIO60,0,0,0)                                  
         DC    AL2(CIIU30U,CIIU20,CIIU30,0,0,0)                                 
         DC    X'FFFF'                                                          
         SPACE 2                                                                
* TABLE OF NETWORK CODES AND THEIR CALL LETTERS                                 
*                                                                               
NETTAB   DS    0CL9                                                             
         DC    C'ABC ',CL5'ABC T'                                               
         DC    C'CBS ',CL5'CBS T'                                               
         DC    C'FOX ',CL5'FOX T'                                               
         DC    C'NBC ',CL5'NBC T'                                               
         DC    C'AGG1',CL5'IND T'                                               
         DC    C'AGG2',CL5'SUP T'                                               
         DC    C'AGG3',CL5'PBS T'                                               
         DC    C'AGG4',CL5'PAY T'                                               
         DC    C'AGG5',CL5'CAB T'                                               
NETWORKS EQU   (*-NETTAB)/L'NETTAB                                              
         EJECT                                                                  
* EQUATE PROGRAM TYPES/ DAYPARTS                                                
LFALL    EQU   1200                ALL LATE FRINGE                              
LF11A1   EQU   1220                ALL M-F 11:30P-1A                            
DYALL    EQU   7999                M-F 7A-4:30P                                 
DYDD     EQU   8000                DAYTIME DRAMA                                
DYQA     EQU   8400                QUIZ & AUD. PARTICIPATION                    
DYAD     EQU   8500                ADULT 7-10AM                                 
DY10A1   EQU   8600                ALL 10A-1P                                   
DY1P4    EQU   8700                ALL 1P-4:30P                                 
DY10A4AR EQU   8710                ALL 10A-4P ABC REG                           
DY10A4CR EQU   8720                ALL 10A-4P CBS REG                           
DY10A4NR EQU   8730                ALL 10A-4P NBC REG                           
DY10A4A  EQU   8740                ALL 10A-4P ABC REG+SPEC                      
DY10A4C  EQU   8750                ALL 10A-4P CBS REG+SPEC                      
DY10A4N  EQU   8760                ALL 10A-4P NBC REG+SPEC                      
DY10A4   EQU   8800                ALL 10A-4P (3NET)                            
WKALL    EQU   8999                ALL WEEKEND DAYTIME                          
WKCH     EQU   9000                WK CHILDRENS                                 
WKSPR    EQU   9500                SPORTS REGULAR                               
WKSPS    EQU   9600                SPORTS SPECIAL                               
WKSP     EQU   9700                SPORTS REGULAR+SPECIAL                       
EVALL    EQU   499                 EVENING 7-11P                                
EVGD     EQU   500                 GENERAL DRAMA                                
EVSM     EQU   1000                SUSPENSE & MYSTERY                           
EVSC     EQU   1500                SITUATON COMEDY                              
EVAD     EQU   1700                ADVENTURE                                    
EVPV     EQU   3500                PARTICIPATION VARIETY                        
EVFF     EQU   4500                FEATURE FILMS                                
EV30     EQU   5000                ALL 30 MINUTE                                
EV60     EQU   5500                ALL 60 MINUTE                                
EV7P9    EQU   6000                ALL 7-9PM                                    
EV9P11   EQU   6500                ALL 9-11P                                    
EV7P11AR EQU   6510                ALL 7-11P ABC(REG)                           
EV7P11CR EQU   6520                ALL 7-11P CBS(REG)                           
EV7P11NR EQU   6530                ALL 7-11P NBC(REG)                           
EV7P11FR EQU   6540                ALL 7-11P FOX(REG)                           
EV7P11R  EQU   7000                ALL 7-11P REG(3NET)                          
EV7P11AS EQU   7010                ALL 7-11P ABC(SPC)                           
EV7P11CS EQU   7020                ALL 7-11P CBS(SPC)                           
EV7P11NS EQU   7030                ALL 7-11P NBC(SPC)                           
EV7P11S  EQU   7200                ALL 7-11P SPC(3NET)                          
EV7P11A  EQU   7210                ALL 7-11P ABC(REG+SPC)                       
EV7P11C  EQU   7220                ALL 7-11P CBS(REG+SPC)                       
EV7P11N  EQU   7230                ALL 7-11P NBC(REG+SPC)                       
EV7P11   EQU   7300                ALL 7-11P REG+SPC(3NET)                      
EV7P114R EQU   7400                ALL 7-11P REG(4NET)                          
EV6P7I   EQU   7500                INFORMATIONAL ONE-A-WK                       
EV6P7IM  EQU   7600                INFORMATIONAL MULTI-WK                       
*                                                                               
* TIME DAYPARTS FOR HUT RECORDS                                                 
*                                                                               
DP1000   EQU   1000                                                             
DP1010   EQU   1010                                                             
DP1020   EQU   1020                                                             
DP1030   EQU   1030                                                             
DP1040   EQU   1040                                                             
DP1050   EQU   1050                                                             
DP1060   EQU   1060                                                             
DP1070   EQU   1070                                                             
DP1080   EQU   1080                                                             
DP1090   EQU   1090                                                             
DP1100   EQU   1100                                                             
DP1110   EQU   1110                                                             
DP1120   EQU   1120                                                             
DP1130   EQU   1130                                                             
DP1140   EQU   1140                                                             
DP1150   EQU   1150                                                             
DP1160   EQU   1160                                                             
DP1170   EQU   1170                                                             
DP1180   EQU   1180                                                             
DP1190   EQU   1190                                                             
DP1200   EQU   1200                                                             
DP1210   EQU   1210                                                             
DP1220   EQU   1220                                                             
DP1230   EQU   1230                                                             
DP1240   EQU   1240                                                             
DP1250   EQU   1250                                                             
DP1260   EQU   1260                                                             
DP1270   EQU   1270                                                             
DP1280   EQU   1280                                                             
DP1290   EQU   1290                                                             
DP1300   EQU   1300                                                             
DP1310   EQU   1310                                                             
DP1320   EQU   1320                                                             
DP1330   EQU   1330                                                             
DP1340   EQU   1340                                                             
DP1350   EQU   1350                                                             
DP1360   EQU   1360                                                             
DP1370   EQU   1370                                                             
DP1380   EQU   1380                                                             
DP1390   EQU   1390                                                             
*                                                                               
RG       EQU   X'01'               INCLUDE REGULAR PROGRAMS                     
SP       EQU   X'04'               INCLUDE SPECIAL PROGRAMS                     
*                                                                               
PTYPTAB  DC    C'GD',AL2(000),C'12  ',AL1(RG),AL2(EVGD),C'     '                
         DC    C'OP',AL2(000),C'12  ',AL1(RG),AL2(EVSM),C'     '                
         DC    C'PD',AL2(000),C'12  ',AL1(RG),AL2(EVSM),C'     '                
         DC    C'SM',AL2(000),C'12  ',AL1(RG),AL2(EVSM),C'     '                
         DC    C'CS',AL2(000),C'12  ',AL1(RG),AL2(EVSC),C'     '                
         DC    C'A ',AL2(000),C'12  ',AL1(RG),AL2(EVAD),C'     '                
         DC    C'PV',AL2(000),C'12  ',AL1(RG),AL2(EVPV),C'     '                
         DC    C'FF',AL2(000),C'12  ',AL1(RG),AL2(EVFF),C'     '                
         DC    C'  ',AL1(25,30),C'12  ',AL1(RG),AL2(EV30),C'     '              
         DC    C'  ',AL1(55,60),C'12  ',AL1(RG),AL2(EV60),C'     '              
         DC    C'  ',AL2(000),C'1   ',AL1(RG),AL2(EV7P9),C'     '               
         DC    C'  ',AL2(000),C'2   ',AL1(RG),AL2(EV9P11),C'     '              
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P11AR),C'ABC  '            
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P11CR),C'CBS  '            
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P11NR),C'NBC  '            
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P11R),C'ABC Z'             
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P11R),C'CBS Z'             
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P11R),C'NBC Z'             
         DC    C'  ',AL2(000),C'12  ',AL1(SP),AL2(EV7P11AS),C'ABC  '            
         DC    C'  ',AL2(000),C'12  ',AL1(SP),AL2(EV7P11CS),C'CBS  '            
         DC    C'  ',AL2(000),C'12  ',AL1(SP),AL2(EV7P11NS),C'NBC  '            
         DC    C'  ',AL2(000),C'12  ',AL1(SP),AL2(EV7P11S),C'ABC Z'             
         DC    C'  ',AL2(000),C'12  ',AL1(SP),AL2(EV7P11S),C'CBS Z'             
         DC    C'  ',AL2(000),C'12  ',AL1(SP),AL2(EV7P11S),C'NBC Z'             
         DC    C'  ',AL2(000),C'12  ',AL1(RG+SP),AL2(EV7P11A),C'ABC  '          
         DC    C'  ',AL2(000),C'12  ',AL1(RG+SP),AL2(EV7P11C),C'CBS  '          
         DC    C'  ',AL2(000),C'12  ',AL1(RG+SP),AL2(EV7P11N),C'NBC  '          
         DC    C'  ',AL2(000),C'12  ',AL1(RG+SP),AL2(EV7P11),C'ABC Z'           
         DC    C'  ',AL2(000),C'12  ',AL1(RG+SP),AL2(EV7P11),C'CBS Z'           
         DC    C'  ',AL2(000),C'12  ',AL1(RG+SP),AL2(EV7P11),C'NBC Z'           
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P114R),C'ABC Z'            
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P114R),C'CBS Z'            
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P114R),C'NBC Z'            
         DC    C'  ',AL2(000),C'12  ',AL1(RG),AL2(EV7P114R),C'FOX Z'            
         DC    C'CC',AL2(000),C'0   ',AL1(RG+SP),AL2(EV6P7I),C'     '           
         DC    C'DO',AL2(000),C'0   ',AL1(RG+SP),AL2(EV6P7I),C'     '           
         DC    C'DN',AL2(000),C'0   ',AL1(RG+SP),AL2(EV6P7I),C'     '           
         DC    C'N ',AL2(000),C'0   ',AL1(RG+SP),AL2(EV6P7I),C'     '           
         DC    C'IA',AL2(000),C'0   ',AL1(RG+SP),AL2(EV6P7I),C'     '           
*        DC    C'CC',AL2(000),C'0   ',AL1(RG),AL2(EV6P7IM),C'     '             
*        DC    C'DO',AL2(000),C'0   ',AL1(RG),AL2(EV6P7IM),C'     '             
*        DC    C'DN',AL2(000),C'0   ',AL1(RG),AL2(EV6P7IM),C'     '             
*        DC    C'N ',AL2(000),C'0   ',AL1(RG),AL2(EV6P7IM),C'     '             
*        DC    C'IA',AL2(000),C'0   ',AL1(RG),AL2(EV6P7IM),C'     '             
         DC    C'  ',AL2(000),C'B   ',AL1(RG),AL2(LF11A1),C'     '              
         DC    C'  ',AL2(000),C'E56 ',AL1(RG),AL2(DYALL),C'     '               
         DC    C'DD',AL2(000),C'E56 ',AL1(RG),AL2(DYDD),C'     '                
         DC    C'AP',AL2(000),C'E56 ',AL1(RG),AL2(DYQA),C'     '                
         DC    C'QG',AL2(000),C'E56 ',AL1(RG),AL2(DYQA),C'     '                
         DC    C'QP',AL2(000),C'E56 ',AL1(RG),AL2(DYQA),C'     '                
         DC    C'X1',AL2(000),C'E   ',AL1(RG),AL2(DYAD),C'     '                
         DC    C'  ',AL2(000),C'5   ',AL1(RG),AL2(DY10A1),C'     '              
         DC    C'  ',AL2(000),C'6   ',AL1(RG),AL2(DY1P4),C'     '               
         DC    C'  ',AL2(000),C'56  ',AL1(RG),AL2(DY10A4AR),C'ABC  '            
         DC    C'  ',AL2(000),C'56  ',AL1(RG),AL2(DY10A4CR),C'CBS  '            
         DC    C'  ',AL2(000),C'56  ',AL1(RG),AL2(DY10A4NR),C'NBC  '            
         DC    C'  ',AL2(000),C'56  ',AL1(RG+SP),AL2(DY10A4A),C'ABC  '          
         DC    C'  ',AL2(000),C'56  ',AL1(RG+SP),AL2(DY10A4C),C'CBS  '          
         DC    C'  ',AL2(000),C'56  ',AL1(RG+SP),AL2(DY10A4N),C'NBC  '          
         DC    C'  ',AL2(000),C'56  ',AL1(RG),AL2(DY10A4),C'     '              
*        DC    C'C ',AL2(000),C'8   ',AL1(RG),AL2(WKCH),C'     '                
         DC    C'CA',AL2(000),C'8   ',AL1(RG),AL2(WKCH),C'     '                
         DC    C'CN',AL2(000),C'8   ',AL1(RG),AL2(WKCH),C'     '                
         DC    C'CL',AL2(000),C'8   ',AL1(RG),AL2(WKCH),C'     '                
*        DC    C'SC',AL2(000),C'8   ',AL1(RG),AL2(WKSPR),C'     '               
         DC    C'SA',AL2(000),C'8   ',AL1(RG),AL2(WKSPR),C'     '               
         DC    C'SE',AL2(000),C'8   ',AL1(RG),AL2(WKSPR),C'     '               
*        DC    C'SC',AL2(000),C'8   ',AL1(SP),AL2(WKSPS),C'     '               
         DC    C'SA',AL2(000),C'8   ',AL1(SP),AL2(WKSPS),C'     '               
         DC    C'SE',AL2(000),C'8   ',AL1(SP),AL2(WKSPS),C'     '               
*        DC    C'SC',AL2(000),C'8   ',AL1(RG+SP),AL2(WKSP),C'     '             
         DC    C'SA',AL2(000),C'8   ',AL1(RG+SP),AL2(WKSP),C'     '             
         DC    C'SE',AL2(000),C'8   ',AL1(RG+SP),AL2(WKSP),C'     '             
         DC    X'FFFF'                                                          
* EXCLUDE LISTS                                                                 
XCLIST   DC    C'X1',C'C CA CN CL  '                                            
         DC    X'FFFF'                                                          
* PROGRAM TYPE/ DAYPART NAMES                                                   
PTDPNAME  DS   0C                                                               
          DC    AL2(LFALL),CL25'ALL LATE FRINGE'                                
          DC    AL2(LF11A1),CL25'ALL M-F 11:30P-1.00AM(4)'                      
          DC    AL2(DYALL),CL25'M-F 7.00AM-4:30PM'                              
          DC    AL2(DYDD),CL25'DAYTIME DRAMA'                                   
          DC    AL2(DYQA),CL25'QUIZ && AUD. PARTIC (1)'                         
          DC    AL2(DYAD),CL25'ADULT 7.00AM -10.00AM'                           
          DC    AL2(DY10A1),CL25'ALL 10.00AM-1.00PM'                            
          DC    AL2(DY1P4),CL25'ALL 1.00-4:30PM'                                
          DC    AL2(DY10A4AR),CL25'ALL 10A-4P ABC REG'                          
          DC    AL2(DY10A4CR),CL25'ALL 10A-4P CBS REG'                          
          DC    AL2(DY10A4NR),CL25'ALL 10A-4P NBC REG'                          
          DC    AL2(DY10A4A),CL25'ALL 10A-4P ABC REG+SPEC'                      
          DC    AL2(DY10A4C),CL25'ALL 10A-4P CBS REG+SPEC'                      
          DC    AL2(DY10A4N),CL25'ALL 10A-4P NBC REG+SPEC'                      
          DC    AL2(DY10A4),CL25'ALL 10A-4P (3NET)'                             
          DC    AL2(WKALL),CL25'ALL WEEKEND DAYTIME'                            
          DC    AL2(WKCH),CL25'CHILDREN''S (1)'                                 
          DC    AL2(WKSPR),CL25'SPORTS, REGULAR'                                
          DC    AL2(WKSPS),CL25'SPORTS, SPECIAL (3)'                            
          DC    AL2(WKSP),CL25'SPORTS, TOTAL (3)'                               
          DC    AL2(EVALL),CL25'ALL 7.00-11.00PM'                               
          DC    AL2(EVGD),CL25'GENERAL DRAMA'                                   
          DC    AL2(EVSM),CL25'SUSPENSE && MYST. DRAMA(1)'                      
          DC    AL2(EVSC),CL25'SITUATION COMEDY'                                
          DC    AL2(EVAD),CL25'ADVENTURE'                                       
          DC    AL2(EVPV),CL25'PARTICIPATION VARIETY'                           
          DC    AL2(EVFF),CL25'FEATURE FILMS'                                   
          DC    AL2(EV30),CL25'ALL 25-30 MINUTE'                                
          DC    AL2(EV60),CL25'ALL 55-60 MINUTE'                                
          DC    AL2(EV7P9),CL25'ALL 7.00-9.00PM'                                
          DC    AL2(EV9P11),CL25'ALL 9.00-11.00P'                               
          DC    AL2(EV7P11AR),CL25'ALL 7-11P ABC(REG)'                          
          DC    AL2(EV7P11CR),CL25'ALL 7-11P CBS(REG)'                          
          DC    AL2(EV7P11NR),CL25'ALL 7-11P NBC(REG)'                          
          DC    AL2(EV7P11FR),CL25'ALL 7-11P FOX(REG)'                          
          DC    AL2(EV7P11R),CL25'ALL 7-11P REG(3NET)'                          
          DC    AL2(EV7P11AS),CL25'ALL 7-11P ABC(SPC)'                          
          DC    AL2(EV7P11CS),CL25'ALL 7-11P CBS(SPC)'                          
          DC    AL2(EV7P11NS),CL25'ALL 7-11P NBC(SPC)'                          
          DC    AL2(EV7P11S),CL25'ALL 7-11P SPC(3NET)'                          
          DC    AL2(EV7P11A),CL25'ALL 7-11P ABC(REG+SPC)'                       
          DC    AL2(EV7P11C),CL25'ALL 7-11P CBS(REG+SPC)'                       
          DC    AL2(EV7P11N),CL25'ALL 7-11P NBC(REG+SPC)'                       
          DC    AL2(EV7P11),CL25'ALL 7-11P REG+SPC(3NET)'                       
          DC    AL2(EV7P114R),CL25'ALL 7-11P REG(4NET)'                         
          DC    AL2(EV6P7I),CL25'INFORMATIONAL ONE-A-WK(1)'                     
          DC    AL2(EV6P7IM),CL25'INFORMATIONAL MULTI-WK(1)'                    
*                                                                               
*         ***********DAYPART NAMES**********                                    
          DC    AL2(DP1000),CL25'MON-FRI 7.00AM - 10.00 AM'                     
          DC    AL2(DP1010),CL25'MON-FRI 10.00AM - 1.00 PM'                     
          DC    AL2(DP1020),CL25'MON-FRI 1.00PM - 4.30PM  '                     
          DC    AL2(DP1030),CL25'MON-FRI 4.30PM - 7.30PM  '                     
          DC    AL2(DP1040),CL25'MON-FRI 4.30PM - 6.00PM  '                     
          DC    AL2(DP1050),CL25'MON-FRI 6.00PM - 7.30PM  '                     
          DC    AL2(DP1060),CL25'SAT 7.00AM - 1.00PM      '                     
          DC    AL2(DP1070),CL25'SAT 1.00PM - 4.30PM      '                     
          DC    AL2(DP1080),CL25'SAT 4.30PM - 7.30PM      '                     
          DC    AL2(DP1090),CL25'SUN 7.00AM - 1.00PM      '                     
          DC    AL2(DP1100),CL25'SUN 1.00PM - 4.30PM      '                     
          DC    AL2(DP1110),CL25'SUN 4.30PM - 7.30PM      '                     
          DC    AL2(DP1120),CL25'SUN 4.30PM - 7.00PM      '                     
          DC    AL2(DP1130),CL25'MON-SUN 7.30PM - 8.00PM  '                     
          DC    AL2(DP1140),CL25'MON-SUN 8.00PM - 11.00PM '                     
          DC    AL2(DP1150),CL25'MON-SUN 11.00PM - 11.30PM'                     
          DC    AL2(DP1160),CL25'MON-SUN 11.30PM - 1.00AM '                     
          DC    AL2(DP1170),CL25'MON-SUN 1.00AM - 7.00AM  '                     
          DC    AL2(DP1180),CL25'MON-SUN 24 HOUR TOTAL    '                     
          DC    AL2(DP1190),CL25'MON-FRI 10.00AM - 4.30PM '                     
          DC    AL2(DP1200),CL25'MON-FRI 7.30PM - 8.00PM  '                     
          DC    AL2(DP1210),CL25'MON-FRI 11.00PM - 11.30PM'                     
          DC    AL2(DP1220),CL25'MON-FRI 11.30PM - 1.00AM '                     
          DC    AL2(DP1230),CL25'MON-FRI 1.00AM - 2.30AM  '                     
          DC    AL2(DP1240),CL25'SAT 8.00AM - 1.00PM      '                     
          DC    AL2(DP1250),CL25'SAT 7.30PM - 8.00PM      '                     
          DC    AL2(DP1260),CL25'MON-SUN 7.00PM - 8.00PM  '                     
          DC    AL2(DP1270),CL25'MON-SUN 8.00PM - 9.00PM  '                     
          DC    AL2(DP1280),CL25'MON-SUN 9.00PM - 10.00PM '                     
          DC    AL2(DP1290),CL25'MON-SUN 10.00PM - 11.00PM'                     
          DC    AL2(DP1300),CL25'MON-SUN 11.00PM - 12.00MD'                     
          DC    AL2(DP1310),CL25'MON-SUN 12.00MD - 1.00AM '                     
          DC    AL2(DP1320),CL25'MON 8.00PM - 11.00PM     '                     
          DC    AL2(DP1330),CL25'TUE 8.00PM - 11.00PM     '                     
          DC    AL2(DP1340),CL25'WED 8.00PM - 11.00PM     '                     
          DC    AL2(DP1350),CL25'THU 8.00PM - 11.00PM     '                     
          DC    AL2(DP1360),CL25'FRI 8.00PM - 11.00PM     '                     
          DC    AL2(DP1370),CL25'SAT 8.00PM - 11.00PM     '                     
          DC    AL2(DP1380),CL25'SUN 8.00PM - 11.00PM     '                     
          DC    AL2(DP1390),CL25'SUN 7.00PM - 11.00PM     '                     
          DC   X'FFFF'                                                          
*                                                                               
         EJECT                                                                  
*                                                                               
PTLNTAB  DS    0CL3                                                             
         DC    C'A ',AL1(060)      ADVENTURE                                    
         DC    C'AC',AL1(120)      AWARD CEREMONIES/PAGENTS                     
         DC    C'AP',AL1(30)       AUDIENCE PARTICIPATION                       
         DC    C'CA',AL1(30)       CHILD DAY - ANIMATION                        
         DC    C'CC',AL1(60)       CONVERSATIONS, COLLOQUIES                    
         DC    C'CE',AL1(30)       CHILD - EVENING                              
         DC    C'CL',AL1(30)       CHILD DAY - LIVE                             
         DC    C'CM',AL1(60)       CONCERT MUSIC                                
         DC    C'CN',AL1(30)       CHILDRENS NEWS AND INFO.                     
         DC    C'CS',AL1(30)       SITUATION - COMEDY                           
         DC    C'CV',AL1(30)       COMEDY - VARIETY                             
         DC    C'D ',AL1(30)       DEVOTIONAL                                   
         DC    C'DD',AL1(60)       DAYTIME DRAMA                                
         DC    C'DG',AL1(60)       DOCUMENTARY - GENERAL                        
         DC    C'DN',AL1(60)       DOCUMENTARY - NEWS                           
         DC    C'EA',AL1(30)       EVENING - ANIMATION                          
         DC    C'EW',AL1(30)       WESTERN DRAMA                                
         DC    C'FF',AL1(120)      FEATURE FILMS                                
         DC    C'FV',AL1(60)       FORMAT VARIES                                
         DC    C'GD',AL1(60)       GENERAL DRAMA                                
         DC    C'GV',AL1(60)       GENERAL VARIETY                              
         DC    C'IA',AL1(30)       INSTRUCTIONAL - ADVICE                       
         DC    C'MD',AL1(60)       MUSICAL DRAMA                                
         DC    C'N ',AL1(30)       NEWS                                         
         DC    C'OP',AL1(60)       OFFICIAL POLICE                              
         DC    C'PC',AL1(60)       POP MUSIC - CONTEMPORARY                     
         DC    C'PD',AL1(60)       PRIVATE DETECTIVE                            
         DC    C'PS',AL1(60)       POP MUSIC - STANDARD                         
         DC    C'PV',AL1(30)       PARTICIPATION VARIETY                        
         DC    C'QG',AL1(30)       QUIZ - GIVEAWAY                              
         DC    C'QP',AL1(30)       QUIZ - PANEL                                 
         DC    C'SA',AL1(30)       SPORTS - ANTHOLOGY                           
         DC    C'SC',AL1(30)       SPORTS - COMENTARY                           
         DC    C'SE',AL1(120)      SPORTS - EVENT                               
         DC    C'SM',AL1(30)       SUSPENSE/MYSTERY (OTHER THAN OP,PD)          
         DC    C'SN',AL1(30)       SPORTS NEWS                                  
         DC    C'U ',AL1(30)       UNCLASSIFIED                                 
         DC    AL3(0)                                                           
N1DPTAB  DS    0CL10               PRIMARY DAYPART TABLE                        
         DC    C'0',C'06000700P'                                                
         DC    C'1',C'07000900P'                                                
         DC    C'2',C'09001100P'                                                
         DC    C'3',C'11000545A'                                                
         DC    C'4',C'06001000A'                                                
         DC    C'5',C'10000100P'                                                
         DC    C'6',C'01000430P'                                                
         DC    C'7',C'04300600P'                                                
         DC    C'8',C'06010600P'                                                
         DC    X'FF'                                                            
*                                                                               
DPTTAB   DC    AL2(1000),AL1(1,5),AL2(0700,1000),B'01111100',X'00'              
         DC    AL2(1010),AL1(1,5),AL2(1000,1300),B'01111100',X'00'              
         DC    AL2(1020),AL1(1,5),AL2(1300,1630),B'01111100',X'00'              
         DC    AL2(1030),AL1(1,5),AL2(1630,1930),B'01111100',X'00'              
         DC    AL2(1040),AL1(1,5),AL2(1630,1800),B'01111100',X'00'              
         DC    AL2(1050),AL1(1,5),AL2(1800,1930),B'01111100',X'00'              
         DC    AL2(1060),AL1(6,6),AL2(0700,1300),B'00000010',X'60'              
         DC    AL2(1070),AL1(6,6),AL2(1300,1630),B'00000010',X'60'              
         DC    AL2(1080),AL1(6,6),AL2(1630,1930),B'00000010',X'60'              
         DC    AL2(1090),AL1(7,7),AL2(0700,1300),B'00000001',X'70'              
         DC    AL2(1100),AL1(7,7),AL2(1300,1630),B'00000001',X'70'              
         DC    AL2(1110),AL1(7,7),AL2(1630,1930),B'00000001',X'70'              
         DC    AL2(1120),AL1(7,7),AL2(1630,1900),B'00000001',X'70'              
         DC    AL2(1130),AL1(1,7),AL2(1930,2000),B'01111111',X'80'              
         DC    AL2(1140),AL1(1,7),AL2(2000,2300),B'01111111',X'80'              
         DC    AL2(1150),AL1(1,7),AL2(2300,2330),B'01111111',X'80'              
         DC    AL2(1160),AL1(1,7),AL2(2330,0100),B'01111111',X'80'              
         DC    AL2(1170),AL1(1,7),AL2(0100,0545),B'01111111',X'80'              
         DC    AL2(1180),AL1(1,7),AL2(0600,0530),B'01111111',X'80'              
         DC    AL2(1190),AL1(1,5),AL2(1000,1630),B'01111100',X'00'              
         DC    AL2(1200),AL1(1,5),AL2(1930,2000),B'01111100',X'00'              
         DC    AL2(1210),AL1(1,5),AL2(2300,2330),B'01111100',X'00'              
         DC    AL2(1220),AL1(1,5),AL2(2330,0100),B'01111100',X'00'              
         DC    AL2(1230),AL1(1,5),AL2(0100,0230),B'01111100',X'00'              
         DC    AL2(1240),AL1(6,6),AL2(0800,1300),B'00000010',X'60'              
         DC    AL2(1250),AL1(6,6),AL2(1930,2000),B'00000010',X'60'              
         DC    AL2(1260),AL1(1,7),AL2(1900,2000),B'01111111',X'80'              
         DC    AL2(1270),AL1(1,7),AL2(2000,2100),B'01111111',X'80'              
         DC    AL2(1280),AL1(1,7),AL2(2100,2200),B'01111111',X'80'              
         DC    AL2(1290),AL1(1,7),AL2(2200,2300),B'01111111',X'80'              
         DC    AL2(1300),AL1(1,7),AL2(2300,2400),B'01111111',X'80'              
         DC    AL2(1310),AL1(1,7),AL2(2400,0100),B'01111111',X'80'              
         DC    AL2(1320),AL1(1,1),AL2(2000,2300),B'01000000',X'10'              
         DC    AL2(1330),AL1(2,2),AL2(2000,2300),B'00100000',X'20'              
         DC    AL2(1340),AL1(3,3),AL2(2000,2300),B'00010000',X'30'              
         DC    AL2(1350),AL1(4,4),AL2(2000,2300),B'00001000',X'40'              
         DC    AL2(1360),AL1(5,5),AL2(2000,2300),B'00000100',X'50'              
         DC    AL2(1370),AL1(6,6),AL2(2000,2300),B'00000010',X'60'              
         DC    AL2(1380),AL1(7,7),AL2(2000,2300),B'00000001',X'70'              
         DC    AL2(1390),AL1(7,7),AL2(1900,2300),B'00000001',X'70'              
         DC    X'FF'                                                            
         SPACE 2                                                                
PTYTAB   DC    AL2(0500),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'GD',X'05'                                           
         DC    AL2(1000),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'SM',X'05'                                           
         DC    AL2(1500),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'CS',X'05'                                           
         DC    AL2(1700),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'A ',X'05'                                           
         DC    AL2(3500),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'PV',X'05'                                           
         DC    AL2(4500),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(120),CL2'FF',X'05'                                           
         DC    AL2(5000),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'25',X'05'                                           
         DC    AL2(5500),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(060),CL2'55',X'05'                                           
         DC    AL2(6000),AL1(MSU),AL2(1900,2100),B'01111111',X'80'              
         DC    AL1(030),CL2'79',X'05'                                           
         DC    AL2(6500),AL1(MSU),AL2(2100,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'91',X'05'                                           
         DC    AL2(6510),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'01'                                           
         DC    AL2(6520),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'01'                                           
         DC    AL2(6530),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'01'                                           
         DC    AL2(7000),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'01'                                           
         DC    AL2(7010),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'04'                                           
         DC    AL2(7020),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'04'                                           
         DC    AL2(7030),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'04'                                           
         DC    AL2(7200),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'04'                                           
         DC    AL2(7210),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'05'                                           
         DC    AL2(7220),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'04'                                           
         DC    AL2(7230),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'71',X'05'                                           
         DC    AL2(7300),AL1(MSU),AL2(1900,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'73',X'05'                                           
         DC    AL2(7500),AL1(MSU),AL2(0700,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'I1',X'05'                                           
         DC    AL2(7600),AL1(MSU),AL2(0700,2300),B'01111111',X'80'              
         DC    AL1(030),CL2'I4',X'05'                                           
         DC    AL2(7800),AL1(MSU),AL2(2330,0100),B'01111100',X'00'              
         DC    AL1(030),CL2'11',X'05'                                           
         DC    AL2(8000),AL1(MFR),AL2(1300,1630),B'01111100',X'00'              
         DC    AL1(030),CL2'DD',X'05'                                           
         DC    AL2(8400),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'Q+',X'05'                                           
         DC    AL2(8500),AL1(MSU),AL2(0700,1000),B'01111111',X'80'              
         DC    AL1(030),CL2'A7',X'05'                                           
         DC    AL2(8600),AL1(MSU),AL2(1000,1300),B'01111111',X'80'              
         DC    AL1(030),CL2'01',X'05'                                           
         DC    AL2(8700),AL1(MSU),AL2(1300,1630),B'01111111',X'80'              
         DC    AL1(030),CL2'14',X'05'                                           
         DC    AL2(8710),AL1(MSU),AL2(1000,1630),B'01111111',X'80'              
         DC    AL1(030),CL2'74',X'01'                                           
         DC    AL2(8720),AL1(MSU),AL2(1000,1630),B'01111111',X'80'              
         DC    AL1(030),CL2'74',X'01'                                           
         DC    AL2(8730),AL1(MSU),AL2(1000,1630),B'01111111',X'80'              
         DC    AL1(030),CL2'74',X'01'                                           
         DC    AL2(8740),AL1(MSU),AL2(1000,1630),B'01111111',X'80'              
         DC    AL1(030),CL2'74',X'05'                                           
         DC    AL2(8750),AL1(MSU),AL2(1000,1630),B'01111111',X'80'              
         DC    AL1(030),CL2'74',X'05'                                           
         DC    AL2(8760),AL1(MSU),AL2(1000,1630),B'01111111',X'80'              
         DC    AL1(030),CL2'74',X'05'                                           
         DC    AL2(8800),AL1(MSU),AL2(1000,1630),B'01111111',X'80'              
         DC    AL1(030),CL2'74',X'05'                                           
         DC    AL2(9000),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'C ',X'05'                                           
         DC    AL2(9500),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'S ',X'01'                                           
         DC    AL2(9600),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'S ',X'04'                                           
         DC    AL2(9700),AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'S ',X'05'                                           
         DC    XL2'FFFF',AL1(MSU),AL2(0700,2330),B'01111111',X'80'              
         DC    AL1(030),CL2'X ',X'05'                                           
         DC    X'FF'                                                            
         EJECT                                                                  
*NAREA   DS    CL10122                                                          
*                                                                               
         EJECT                                                                  
       ++INCLUDE DENNHPTD                                                       
         EJECT                                                                  
DPTTABD  DSECT                                                                  
DPTPROG  DS    XL2                                                              
DPTSDAY  DS    XL1                                                              
DPTEDAY  DS    CL1                                                              
DPTSTIM  DS    CL2                                                              
DPTETIM  DS    CL2                                                              
DPTDYBIT DS    CL1                                                              
DPTDAYWK DS    CL1                                                              
         SPACE 2                                                                
PTYTABD  DSECT                                                                  
PTYPROG  DS    XL2                                                              
PTYDAY   DS    CL1                                                              
PTYSTIM  DS    CL2                                                              
PTYETIM  DS    CL2                                                              
PTYDYBIT DS    CL1                                                              
PTYDAYWK DS    CL1                                                              
PTYDUR   DS    CL1                                                              
PTYPTYP  DS    CL2                 PROGRAM TYPE                                 
PTYDTYP  DS    CL1                 DATA TYPE                                    
*                                   X'01' = REGULAR                             
*                                   X'04' = SPECIAL                             
*                                   X'08' = ORIGINAL                            
*                                   X'10' = REPEAT                              
PTYLN    EQU   *-PTYTABD                                                        
         EJECT                                                                  
* DSECT TO COVER NIELSEN'S MEDIA INFORMATION TAPE (1ST 60 POSITIONS)            
*                                                                               
MIREC    DSECT                                                                  
MISEQ    DS    CL1          1-1    RECORD SEQUENCE CODE                         
MIORIG   DS    CL1          2-2    0=ORIGINAL 1=CORRECTION 2=DELETION           
MINET    DS    CL3          3-5    NETWORK (ABC, CBS, NBC, ETC.)                
*                                  OR - DATA TYPE CODE (TVU, INT, ETC.)         
MINUM    DS    CL7          6-12   PROGRAM/STATION/CATEGORY CODE                
MIBREAK  DS    CL1         13-13   0=NOT A BREAKOUT...1=BREAKOUT                
MISPEC   DS    CL1         14-14   0=NOT A SPECIAL....1=SPECIAL                 
MIESTYPE DS    CL1         15-15   AUDIENCE ESTIMATE TYPE                       
MISYNORG DS    CL1         16-16   SYNDICATORS ONLY - ORIG/REPEAT/COMB          
MISYNPRO DS    CL1         17-17   SYNDICATORS ONLY - PROGRAM SPOTS             
MIDYSWKS DS    CL2         18-19   NUMBER OF DAYS/WEEKS                         
MISTART  DS    CL7         20-26   CYYMMDD                                      
MIEND    DS    CL7         27-33   CYYMMDD                                      
MITELNUM DS    CL5         34-38   TELECAST NUMBER                              
MICOMNUM DS    CL3         39-41   COMPONENT NUMBER                             
MIMKTBRK DS    CL3         42-44   MARKET BREAK IDENTIFIER                      
MITPHH   DS    CL2         45-46   TOTAL PROGRAM/HALF HOUR IDENTIFIER           
MITYPE   DS    CL1         47-47   RECORD TYPE - D, H, P OR BLANK               
MIEVSHR  DS    CL2         48-49   EVENT START HOUR                             
MIEVSMIN DS    CL2         50-51   EVENT START MINUTE                           
MIDEMGRP DS    CL3         52-54   DEMOGRAPHIC GROUP START ID                   
MIDEMTYP DS    CL1         55-55   DEMOGRAPHIC RECORD TYPE                      
MIPPPV   DS    CL1         56-56   POCKETPIECE VS PRELIMINARY VARIANCE          
MIVCR    DS    CL1         57-57   VCR INDICATOR - BLANK=INCLUDES VCR           
*                                    1=EXCLUDES   2=INCLUDES PLAYBACK           
MINA     DS    CL1         58-58   NOT AVAILABLE FLAG - BLANK=OK                
*                                    1=NOT AVAILABLE                            
MIRCTR   DS    CL1         59-59   RECORD CTR - 0=UNIQUE RECORD IN 1-58         
*                                    1-9=MULTIPLE OCCURRENCES                   
         DS    CL1         60-60   (FILLER - ALWAYS BLANK)                      
*                                                                               
         EJECT                                                                  
* DSECT TO COVER REPORT DESCRIPTOR RECORD                                       
*                                                                               
B0REC    DSECT                                                                  
B0SEQ    DS    CL1          1-1    C'0' - REPORT DESCRIPTOR RECORD              
         DS    CL16         2-17                                                
B0NUMWKS DS    CL2         18-19   04-4WEEK 05-5WEEK                            
B0START  DS    CL7         20-26   CYYMMDD                                      
B0END    DS    CL7         27-33   CYYMMDD                                      
         DS    CL13        34-46                                                
B0TYPE   DS    CL1         47-47   C' ' - BLANK                                 
         DS    CL13        48-60                                                
B0REPORT DS    CL25        61-85   REPORT/FILE ID - "NTI NAD REPORT"            
*                                                                               
         SPACE 2                                                                
* DSECT TO COVER HOUSEHOLD UNIVERSE ESTIMATE RECORD                             
*                                                                               
H1REC    DSECT                                                                  
H1SEQ    DS    CL1          1-1    C'1' - UNIVERSE ESTIMATE RECORD              
H1ORIG   DS    CL1          2-2    0=ORIGINAL 1=CORRECTION 2=DELETION           
H1DTYP   DS    CL3          3-5    DATA TYPE "UES"                              
         DS    CL14         6-19                                                
H1START  DS    CL7         20-26   CYYMMDD                                      
H1END    DS    CL7         27-33   CYYMMDD                                      
         DS    CL8         34-41                                                
H1MKTBRK DS    CL3         42-44                                                
         DS    CL2         45-46                                                
H1TYPE   DS    CL1         47-47   C'H' - HOUSEHOLD DATA                        
         DS    CL44        48-91                                                
H1HHUNIV DS    CL9         92-100  HH UNIVERSE ESTIMATE (000,XXX,XX0)           
*                                    EXPRESSED AS THOUSANDS                     
         SPACE 2                                                                
* DSECT TO COVER PERSONS UNIVERSE ESTIMATE RECORD                               
*                                                                               
P1REC    DSECT                                                                  
P1SEQ    DS    CL1          1-1    C'1' - UNIVERSE ESTIMATE RECORD              
P1ORIG   DS    CL1          2-2    0=ORIGINAL 1=CORRECTION 2=DELETION           
P1DTYP   DS    CL3          3-5    DATA TYPE "UES"                              
         DS    CL14         6-19                                                
P1START  DS    CL7         20-26   CYYMMDD                                      
P1END    DS    CL7         27-33   CYYMMDD                                      
         DS    CL8         34-41                                                
P1MKTBRK DS    CL3         42-44   MARKET BREAK                                 
         DS    CL2         45-46                                                
P1TYPE   DS    CL1         47-47   C'P' - PERSONS DATA                          
         DS    CL4         48-51                                                
P1DEMGRP DS   CL3         52-54   DEMO START ID                                 
         DS    CL6                                                              
P1DCATS  DS    CL180               DEMO CATEGORIES                              
*                                                                               
         SPACE 2                                                                
* DSECT TO COVER HOUSEHOLD SAMPLE COUNTS RECORD                                 
*                                                                               
H2REC    DSECT                                                                  
H2SEQ    DS    CL1          1-1    C'2' - SAMPLE COUNTS RECORD                  
H2ORIG   DS    CL1          2-2    0=ORIGINAL 1=CORRECTION 2=DELETION           
H2DTYP   DS    CL3          3-5    DATA TYPE "INT"                              
         DS    CL14         6-19                                                
H2START  DS    CL7         20-26   CYYMMDD                                      
H2END    DS    CL7         27-33   CYYMMDD                                      
         DS    CL8         34-41                                                
H2MKTBRK DS    CL3         42-44   MARKET BREAK                                 
         DS    CL2         45-46                                                
H2TYPE   DS    CL1         47-47   C'H' - HOUSEHOLD                             
         DS    CL17        48-64                                                
H2DAYS   DS    0CL7       (65-71)  DAYS OF WEEK INDICATOR                       
H2MON    DS    CL1         65-65     MONDAY      (1 OR 0)                       
H2TUE    DS    CL1         66-66     TUESDAY     (1 OR 0)                       
H2WED    DS    CL1         67-67     WEDNESDAY   (1 OR 0)                       
H2THU    DS    CL1         68-68     THURSDAY    (1 OR 0)                       
H2FRI    DS    CL1         69-69     FRIDAY      (1 OR 0)                       
H2SAT    DS    CL1         70-70     SATURDAY    (1 OR 0)                       
H2SUN    DS    CL1         71-71     SUNDAY      (1 OR 0)                       
*                                                                               
H2WEEKS  DS    0CL5       (72-76)  WEEKS ACTIVE INDICATOR                       
H2W1     DS    CL1         72-72     WEEK 1      (1 OR 0)                       
H2W2     DS    CL1         73-73     WEEK 2      (1 OR 0)                       
H2W3     DS    CL1         74-74     WEEK 3      (1 OR 0)                       
H2W4     DS    CL1         75-75     WEEK 4      (1 OR 0)                       
H2W5     DS    CL1         76-76     WEEK 5      (1 OR 0)                       
         DS    CL6         77-82                                                
H2NUMDAY DS    CL3         83-85     NUMBER OF DAYS - 01                        
         DS    CL6         86-91                                                
H2HH     DS    CL9         92-100    INTAB HH COUNT                             
         SPACE 2                                                                
* DSECT TO COVER PERSONS SAMPLE COUNTS RECORD                                   
*                                                                               
P2REC    DSECT                                                                  
P2SEQ    DS    CL1          1-1    C'2' - SAMPLE COUNTS RECORD                  
P2ORIG   DS    CL1          2-2    0=ORIGINAL 1=CORRECTION 2=DELETION           
P2DTYP   DS    CL3          3-5    DATA TYPE "INT"                              
         DS    CL14         6-19                                                
P2START  DS    CL7         20-26   CYYMMDD                                      
P2END    DS    CL7         27-33   CYYMMDD                                      
         DS    CL8         34-41                                                
P2MKTBRK DS    CL3         42-44   MARKET BREAK                                 
         DS    CL2         45-46                                                
P2TYPE   DS    CL1         47-47   C'P' - PERSONS                               
         DS    CL4         48-51                                                
P2DEMGRP DS    CL3         52-54   DEMOGRAPHIC GROUP START ID                   
         DS    CL6         55-60                                                
P2DCATS  DS    CL180               DEMO CATEGORIES                              
*                                                                               
         SPACE 2                                                                
* DSECT TO COVER HOUSEHOLD USAGE RECORD                                         
*                                                                               
H3REC    DSECT                                                                  
H3SEQ    DS    CL1          1-1    C'3' - HOUSEHOLD USAGE RECORD                
H3ORIG   DS    CL1          2-2    0=ORIGINAL 1=CORRECTION 2=DELETION           
H3DTYP   DS    CL3          3-5    DATA TYPE "TVU"                              
         DS    CL12         6-17                                                
H3NUMDW  DS    CL2         18-19   4=4WEEK 5=5WEEK 0=SINGLE DAY                 
*                                    1=1 WEEK M-F/M-S AVG.                      
H3START  DS    CL7         20-26   CYYMMDD                                      
H3END    DS    CL7         27-33   CYYMMDD                                      
         DS    CL8         34-41                                                
H3MKTBRK DS    CL3         42-44   MARKET BREAK                                 
H3PHH    DS    CL2         45-46   TOTAL PROGRAM/HALF HOUR IDENTIFIER           
H3TYPE   DS    CL1         47-47   C'H' - HALF HOUR HOUSEHOLD DATA              
H3EVSHR  DS    CL2         48-49   EVENT START HOUR (06-29)                     
H3EVSMIN DS    CL2         50-51   EVENT START MINUTE (00 OR 30)                
         DS    CL5         52-56                                                
H3VCR    DS    CL1         57      2=INCLUDES VCR PLAYBACK                      
         DS    CL1         58                                                   
H3RCNT   DS    CL1         59      1-9 1=MON.......9=M-SU                       
         DS    CL5         60-64                                                
H3DAYS   DS    0CL7       (65-71)  DAYS OF WEEK INDICATOR                       
H3MON    DS    CL1         65-65     MONDAY      (1 OR 0)                       
H3TUE    DS    CL1         66-66     TUESDAY     (1 OR 0)                       
H3WED    DS    CL1         67-67     WEDNESDAY   (1 OR 0)                       
H3THU    DS    CL1         68-68     THURSDAY    (1 OR 0)                       
H3FRI    DS    CL1         69-69     FRIDAY      (1 OR 0)                       
H3SAT    DS    CL1         70-70     SATURDAY    (1 OR 0)                       
H3SUN    DS    CL1         71-71     SUNDAY      (1 OR 0)                       
*                                                                               
H3WEEKS  DS    0CL5       (72-76)  WEEKS ACTIVE INDICATOR                       
H3W1     DS    CL1         72-72     WEEK 1      (1 OR 0)                       
H3W2     DS    CL1         73-73     WEEK 2      (1 OR 0)                       
H3W3     DS    CL1         74-74     WEEK 3      (1 OR 0)                       
H3W4     DS    CL1         75-75     WEEK 4      (1 OR 0)                       
H3W5     DS    CL1         76-76     WEEK 5      (1 OR 0)                       
         DS    CL6         77-82                                                
H3AVEDAY DS    CL3         83-85   NUMBER OF TELECAST/DAYS                      
*                                  EXCLUDED DAYS ARE REFLECTED HERE             
*                                    01=INDIVIDUAL ADY                          
*                                    04 = 1 DAY/4 WEEK                          
*                                    05 = 1 DAY/5 WEEK OF M-F 1 WEEK            
*                                    07 = M-S 1 WEEK                            
*                                    20 = M-F 4 WEEK ...                        
H3AVEDUR DS    CL6         86-91   HALF-HOUR CONTIBUTING DURATION               
*                                  EXCLUDED DAYS ARE REFLECTED HERE             
*                                    30 - SINGLE DAY, 1 WEEK                    
*                                   120 - SINGLE DAY, 4 WEEK...                 
H3AVEHUT DS    CL9         92-100  AUDIENCE AVE HUT PROJ. (XXX,XXX,XXX)         
H3AVERTG DS    CL3        101-103  AUDIENCE AVE HUT RATING (XX.X)               
H3AVERPT DS    CL1        104-104  REPORTABLITY INDICATOR                       
         DS    CL27       105-131                                               
H3QH1DAY DS    CL3        132-134  QH1 NUMBER OF TELECAST/DAYS                  
*                                   TOTAL SAMPLE ONLY                           
H3QH1DUR DS    CL6        135-140  QH1 CONTIBUTING DURATION                     
*                                   TOTAL SAMPLE ONLY                           
H3QH1HUT DS    CL9        141-149  1ST QTR HR HUT PROJ (XXX,XXX,XXX)            
H3QH1RTG DS    CL3        150-152  1ST QTR HR HUT RATING (XX.X)                 
H3QH1RPT DS    CL1        153-153  1ST QTR HR REPORTABLITY INDICATOR            
H3QH2DAY DS    CL3        154-156  QH2 NUMBER OF TELECAST/DAYS                  
*                                   TOTAL SAMPLE ONLY                           
H3QH2DUR DS    CL6        157-162  QH2 CONTIBUTING DURATION                     
*                                   TOTAL SAMPLE ONLY                           
H3QH2HUT DS    CL9        163-171  2ND QTR HR HUT PROJ (XXX,XXX,XXX)            
H3QH2RTG DS    CL3        172-174  2ND QTR HR HUT RATING (XX.X)                 
H3QH2RPT DS    CL1        175-175  2ND QTR HR REPORTABLITY INDICATOR            
         DS    CL66       175-240                                               
H3OPT    DS    CL1        241-241  0=REGULAR DATA   1=OPTIONAL DATA             
*                                                                               
         SPACE 2                                                                
* DSECT TO COVER DEMO USAGE RECORD                                              
*                                                                               
P3REC    DSECT                                                                  
P3SEQ    DS    CL1          1-1    C'3' - DEMO USAGE RECORD                     
P3ORIG   DS    CL1          2-2    0=ORIGINAL 1=CORRECTION 2=DELETION           
P3DTYP   DS    CL3          3-5    DATA TYPE "TVU"                              
         DS    CL12         6-17                                                
P3NUMDW  DS    CL2         18-19   4=4WEEK 5=5WEEK 0=SINGLE DAY                 
*                                    1=1 WEEK M-F/M-S AVG.                      
P3START  DS    CL7         20-26   CYYMMDD                                      
P3END    DS    CL7         27-33   CYYMMDD                                      
         DS    CL8         34-41                                                
P3MKTBRK DS    CL3         42-44   MARKET BREAK                                 
P3PHH    DS    CL2         45-46   TOTAL PROGRAM/HALF HOUR IDENTIFIER           
P3TYPE   DS    CL1         47-47   C'P' - PERSONS                               
P3EVSHR  DS    CL2         48-49   EVENT START HOUR (06-29)                     
P3EVSMIN DS    CL2         50-51   EVENT START MINUTE (00 OR 30)                
P3DEMGRP DS    CL3         52-54   DEMOGRAPHIC GROUP START ID                   
         DS    CL2         55-56                                                
P3VCR    DS    CL1         57      2=INCLUDES VCR PLAYBACK                      
         DS    CL1         58                                                   
P3RCNT   DS    CL1         59      1-9 1=MON.......9=M-SU                       
         DS    CL1         60                                                   
P3DCATS  DS    CL180       61-240  DEMOGRAPHIC CATEGORIES (20CL9)               
P3OPT    DS    CL1        241-241  0=REGULAR DATA   1=OPTIONAL DATA             
*                                                                               
         EJECT                                                                  
* DSECT TO COVER PROGRAM DESCRIPTOR RECORD                                      
*                                                                               
D4REC    DSECT                                                                  
D4SEQ    DS    CL1          1-1    C'4' - PROGRAM DESCRIPTOR RECORD             
D4ORIG   DS    CL1          2-2    0=ORIGINAL.........1=CORRECTION              
D4NET    DS    CL3          3-5    NETWORK (ABC, CBS, NBC, FOX)                 
D4NUM    DS    CL7          6-12   PROGRAM/STATION/CATEGORY CODE                
D4BREAK  DS    CL1         13-13   0=NOT A BREAKOUT...1=BREAKOUT                
D4SPEC   DS    CL1         14-14   0=NOT A SPECIAL....1=SPECIAL                 
D4ESTTYP DS    CL1         15      1=AVERAGE AUDIENCE                           
D4TTYPE  DS    CL1         16      TELECAST TYPE (SYND)                         
*                                  O=ORIGINAL   R=REPEAT                        
*                                  C=COMBINED   M=MULTIPLE                      
D4PSI    DS    CL1         17      (SYND)PROGRAM SPOTS INDICATOR                
D4DYSWKS DS    CL2         18-19   NUMBER OF DAYS/WEEKS                         
D4START  DS    CL7         20-26   CYYMMDD                                      
D4END    DS    CL7         27-33   CYYMMDD                                      
D4TELNUM DS    CL5         34-38   TELECAST NUMBER FOR INDIV. DAY               
*                                   0 FOR AVG WITHOUT PREMIER                   
*                                   PREMIER'S T/C# IF AVG W/PREMIER             
         DS    CL3         39-41                                                
D4MKTBRK DS    CL3         42-44   MARKET BREAK                                 
D4PRGID  DS    CL2         45-46   TOTAL PROGRAM/HALF HOUR ID                   
*                                   00 = TOTAL PROGRAM                          
D4TYPE   DS    CL1         47-47   C'D' - PROGRAM DESCRIPTOR DATA               
D4EVSHR  DS    CL2         48-49   EVENT START HOUR (06-29)                     
D4EVSMIN DS    CL2         50-51   EVENT START MINUTE (00-59)                   
         DS    CL5         52-56                                                
D4VCR    DS    CL1         57-57   VCR INDICATOR - BLANK=INCLUDES VCR           
*                                    1=EXCLUDES   2=INCLUDES PLAYBACK           
D4NAVAL  DS    CL1         58-58   1 = DATA NOT AVAILABLE                       
         DS    CL2         59-60                                                
D4NAME   DS    CL25        61-85   PROGRAM NAME                                 
D4ALPHA  DS    CL2         86-87   PROGRAM TYPE (ALPHA)                         
         DS    CL3         88-90                                                
D4MULTI  DS    CL1         91-91   MULTI-DAY     Y=MULTIPLE TELECASTS           
D4REPEAT DS    CL1         92-92   REPEAT IND. Y=MAJORITY ARE REPEAT            
D4COMPLX DS    CL1         93-93   COMPLEX IND. Y=MAJORITY ARE COMPLEX          
D4SHORT  DS    CL1         94-94   SHORT DURATION IND. Y/BLANK                  
D4LIVE   DS    CL1         95-95   (SYND) LIVE FEED IND. Y/BLANK                
         DS    CL2         96-97                                                
D4VARIND DS    CL1         98-98    VARIOUS IND.                                
D4PREM   DS    CL1         99-99   PREMIER IND.  Y=PREMIER TELECAST             
D4GAP    DS    CL1        100-100  Y=1 OR MORE GAPPED TELECASTS                 
D4DPTLL  DS    CL1        101-101  LOW LEVEL DAYPART FOR PROG. TYPE             
*                                    0=6P-7P M-SU EVENING                       
*                                    1=7P-9P M-SU EVENING                       
*                                    2=9P-11P M-SU EVENING                      
*                                    A=11P-11:30P M-SU EVENING                  
*                                    B=11:30P-1A M-SU EVENING                   
*                                    C=1A-6A M-SU EVENING                       
*                                    D=6A-7A M-F DAYTIME                        
*                                    E=7A-10A M-F DAYTIME                       
*                                    5=10A-1P M-F DAYTIME                       
*                                    6=1P-4:30P M-F DAYTIME                     
*                                    7=4:30P-6P M-F DAYTIME                     
*                                    8=6A-6P M-F DAYTIME                        
         DS    CL15       102-116                                               
D4SYNID  DS    CL3        117-119  SYNDICATOR ID (SEE NETWORK TABLE)            
D4TITLE  DS    CL32       120-151  EPISODE TITLE                                
         DS    CL12       152-163                                               
D4DPT    DS    CL2        164-165  REPORTED DAYPART                             
*                                    PR=PRIME TIME   WM=WEEKDAY MORNING         
*                                    EF=EARLY FRINGE WD=WEEKDAY DAYTIME         
*                                    LF=LATE FRINGE  ED=WEEKEND DAYTIME         
D4DUR    DS    CL4        166-169  EVENT DURATION   0000-1440 MINUTES           
D4DAYS   DS    0CL7      (170-176) DAYS OF WEEK INDICATOR                       
D4MON    DS    CL1        170-170    MONDAY      (1 OR 0)                       
D4TUE    DS    CL1        171-171    TUESDAY     (1 OR 0)                       
D4WED    DS    CL1        172-172    WEDNESDAY   (1 OR 0)                       
D4THU    DS    CL1        173-173    THURSDAY    (1 OR 0)                       
D4FRI    DS    CL1        174-174    FRIDAY      (1 OR 0)                       
D4SAT    DS    CL1        175-175    SATURDAY    (1 OR 0)                       
D4SUN    DS    CL1        176-176    SUNDAY      (1 OR 0)                       
*                                                                               
D4WEEKS  DS    0CL5      (177-181) WEEKS ACTIVE INDICATOR                       
D4W1     DS    CL1        177-177    WEEK 1      (1 OR 0)                       
D4W2     DS    CL1        178-178    WEEK 2      (1 OR 0)                       
D4W3     DS    CL1        179-179    WEEK 3      (1 OR 0)                       
D4W4     DS    CL1        180-180    WEEK 4      (1 OR 0)                       
D4W5     DS    CL1        181-181    WEEK 5      (1 OR 0)                       
*                                                                               
         EJECT                                                                  
*        THESE FIELDS (182-240) ARE NOT REPORTED ON ALL D4 RECORDS              
D4STA    DS    CL3        182-184  TOTAL PROGRAM STATION COUNT                  
D4COV    DS    CL2        185-186  TOTAL PROGRAM COVERAGE PERCENT               
D4VARTIM DS    CL1        187-187  Y=VARYING START OR DURATION                  
         DS    CL2        188-189                                               
D4TELE   DS    CL3        190-192  TELECASTS 01=DAY 02-99=AVERAGES              
D4TOTDUR DS    CL6        193-198  TOTAL DURATION                               
D4AVEHUT DS    CL9        199-207  PROGRAM AVERAGE PROJ. (XXX,XXX,XXX)          
D4AVERTG DS    CL3        208-210  PROGRAM AVERAGE RATING (XX.X)                
D4REPORT DS    CL1        211-211  REPORTABILITY IND. 0=REPORTABLE              
***************TOTAL SAMPLE ONLY***************************                     
D4HUT    DS    CL9        212-220  PROGRAM HUT PROJ. (XXX,XXX,XXX)              
D4SHR    DS    CL2        221-222  PROGRAM SHARE (XX)                           
D4PROJ   DS    CL9        223-231  TOTAL AUDIENCE PROJ. (XXX,XXX,XXX)           
D4RTG    DS    CL3        232-234  TOTAL AUDIENCE RATING (XX.X)                 
************************************************************                    
         DS    CL6        235-240                                               
*                                                                               
D4OPT    DS    CL1        241-241  0=REGULAR DATA   1=OPTIONAL DATA             
*                                                                               
         EJECT                                                                  
* DSECT TO COVER HOUSEHOLD PROGRAM RECORD                                       
*                                                                               
H4REC    DSECT                                                                  
H4SEQ    DS    CL1          1-1    C'4' - HALF HOUR DETAIL RECORD               
H4ORIG   DS    CL1          2-2    0=ORIGINAL.........1=CORRECTION              
H4NET    DS    CL3          3-5    NETWORK (ABC, CBS OR NBC)                    
H4NUM    DS    CL7          6-12   PROGRAM/STATION/CATEGORY CODE                
H4BREAK  DS    CL1         13-13   0=NOT A BREAKOUT...1=BREAKOUT                
H4SPEC   DS    CL1         14-14   0=NOT A SPECIAL....1=SPECIAL                 
H4ESTTYP DS    CL1         15      1=AVERAGE AUDIENCE                           
H4TTYPE  DS    CL1         16      TELECAST TYPE (SYND)                         
*                                  O=ORIGINAL   R=REPEAT                        
*                                  C=COMBINED   M=MULTIPLE                      
H4PSI    DS    CL1         17      (SYND)PROGRAM SPOTS INDICATOR                
H4DYSWKS DS    CL2         18-19   NUMBER OF DAYS/WEEKS                         
H4START  DS    CL7         20-26   CYYMMDD                                      
H4END    DS    CL7         27-33   CYYMMDD                                      
         DS    CL11        34-44                                                
H4HALF   DS    CL2         45-46   HALF HOUR ID   01-48                         
H4TYPE   DS    CL1         47-47   C'H' - HALF HOUR HOUSEHOLD DATA              
H4EVSHR  DS    CL2         48-49   EVENT START HOUR                             
H4EVSMIN DS    CL2         50-51   EVENT START MINUTE                           
         DS    CL13        52-64                                                
H4DAYS   DS    0CL7       (65-71)  DAYS OF WEEK INDICATOR                       
H4MON    DS    CL1         65-65     MONDAY      (1 OR 0)                       
H4TUE    DS    CL1         66-66     TUESDAY     (1 OR 0)                       
H4WED    DS    CL1         67-67     WEDNESDAY   (1 OR 0)                       
H4THU    DS    CL1         68-68     THURSDAY    (1 OR 0)                       
H4FRI    DS    CL1         69-69     FRIDAY      (1 OR 0)                       
H4SAT    DS    CL1         70-70     SATURDAY    (1 OR 0)                       
H4SUN    DS    CL1         71-71     SUNDAY      (1 OR 0)                       
*                                                                               
H4WEEKS  DS    0CL5       (72-76)  WEEKS ACTIVE INDICATOR                       
H4W1     DS    CL1         72-72     WEEK 1      (1 OR 0)                       
H4W2     DS    CL1         73-73     WEEK 2      (1 OR 0)                       
H4W3     DS    CL1         74-74     WEEK 3      (1 OR 0)                       
H4W4     DS    CL1         75-75     WEEK 4      (1 OR 0)                       
H4W5     DS    CL1         76-76     WEEK 5      (1 OR 0)                       
*                                                                               
         DS    CL6         77-82                                                
H4TELE   DS    CL3         83-85   TELECASTS 01=DAY 02-99=AVERAGES              
H4TOTDUR DS    CL6         86-91   TOTAL DURATION                               
H4PROJ   DS    CL9         92-100  HALF HOUR AUD. PROJ. (XXX,XXX,XXX)           
H4RTG    DS    CL3        101-103  HALF HOUR AUDIENCE RATING (XX.X)             
H4REPORT DS    CL1        104-104  REPORTABILITY IND. 0=REPORTABLE              
H4HUT    DS    CL9        105-113  HALF HOUR PROGRAM HUT(XXX,XXX,XXX)           
H4SHR    DS    CL2        114-115  HALF HOUR PROGRAM SHARE (XX)                 
         DS    CL16       116-131                                               
H4QH1DAY DS    CL3        132-134  QH1 NUMBER OF TELECAST/DAYS                  
H4DUR1   DS    CL6        135-140  1ST QTR HOUR   1-15 MINS.-INDIV. DAY         
*                                    DURATION     2-75 MINS.-AVERAGES           
H4QH1PRJ DS    CL9        141-149  QH1 PROJECTIONS                              
H4QH1RTG DS    CL3        150-152  QH1 RATINGS                                  
H4QH1RPT DS    CL1        153-153  REPORTABILITY IND. 0=REPORTABLE              
H4QH2DAY DS    CL3        154-156  QH1 NUMBER OF TELECAST/DAYS                  
H4DUR2   DS    CL6        157-162  2ND QTR HOUR   0-15 MINS.-INDIV. DAY         
*                                    DURATION     2-75 MINS.-AVERAGES           
H4QH2PRJ DS    CL9        163-171  QH1 PROJECTIONS                              
H4QH2RTG DS    CL3        172-174  QH1 RATINGS                                  
H4QH2RPT DS    CL1        175-175  REPORTABILITY IND. 0=REPORTABLE              
         SPACE 2                                                                
* DSECT TO COVER DEMO PROGRAM RECORD                                            
*                                                                               
P4REC    DSECT                                                                  
P4SEQ    DS    CL1          1-1    C'4' - DEMO PROGRAM RECORD                   
P4ORIG   DS    CL1          2-2    0=ORIGINAL.........1=CORRECTION              
P4NET    DS    CL3          3-5    NETWORK (ABC, CBS OR NBC)                    
P4NUM    DS    CL7          6-12   PROGRAM/STATION/CATEGORY CODE                
P4BREAK  DS    CL1         13-13   0=NOT A BREAKOUT...1=BREAKOUT                
P4SPEC   DS    CL1         14-14   0=NOT A SPECIAL....1=SPECIAL                 
P4ESTTYP DS    CL1         15      1=AVERAGE AUDIENCE                           
P4TTYPE  DS    CL1         16      TELECAST TYPE (SYND)                         
*                                  O=ORIGINAL   R=REPEAT                        
*                                  C=COMBINED   M=MULTIPLE                      
P4PSI    DS    CL1         17      (SYND)PROGRAM SPOTS INDICATOR                
P4DYSWKS DS    CL2         18-19   NUMBER OF DAYS/WEEKS                         
P4START  DS    CL7         20-26   CYYMMDD                                      
P4END    DS    CL7         27-33   CYYMMDD                                      
P4TELNUM DS    CL5         34-38   TELECAST NUMBER FOR INDIV. DAY               
*                                   0 FOR AVG WITHOUT PREMIER                   
*                                   PREMIER'S T/C# IF AVG W/PREMIER             
         DS    CL3         39-41                                                
P4MKTBRK DS    CL3         42-44   MARKET BREAK                                 
P4HALF   DS    CL2         45-46   HALF HOUR ID   01-48                         
*                                   00 = TOTAL PROGRAM                          
P4TYPE   DS    CL1         47-47   C'P' - PERSONS                               
P4EVSHR  DS    CL2         48-49   EVENT START HOUR (06-29)                     
P4EVSMIN DS    CL2         50-51   EVENT START MINUTE (00-59)                   
P4DEMGRP DS    CL3         52-54   DEMOGRAPHIC GROUP START ID                   
P4DEMTYP DS    CL1         55-55   DEMOGRAPHIC RECORD TYPE                      
*                                    0=NOT PROGRAM PUTS  1=PROGRAM PUTS         
         DS    CL1         56-56                                                
P4VCR    DS    CL1         57-57   VCR INDICATOR - BLANK=INCLUDES VCR           
*                                    1=EXCLUDES   2=INCLUDES PLAYBACK           
         DS    CL3         58-60                                                
P4DCATS  DS    CL180       61-240  DEMOGRAPHIC CATEGORIES (20CL9)               
         EJECT                                                                  
*        DEINTD                                                                 
       ++INCLUDE DEINTD                                                         
         SPACE 1                                                                
*        DEINTNTID                                                              
       ++INCLUDE DEINTNT2D                                                      
         EJECT                                                                  
*        DECALVPHD                                                              
       ++INCLUDE DECALVPHD                                                      
         EJECT                                                                  
       ++INCLUDE DDDPRINT                                                       
         SPACE 2                                                                
         PRINT OFF                                                              
*        ENDCODE                                                                
*        TITLE '- DEMO CONVERSION - NTI POCKETPIECE'                            
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTIA                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTIB                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTIC                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTID                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTIE                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTIF                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTIG                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTIH                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTII                           
*        PROC  CONTROL=WRKD,ORDER=R/I/S/J,SUBORD=NTIJ                           
*        CODE                                                                   
*        DEDEMFILE                                                              
         PRINT OFF                                                              
       ++INCLUDE DEDEMFILE                                                      
         PRINT ON                                                               
         SPACE 2                                                                
*        DEDEMCNVD                                                              
         PRINT OFF                                                              
       ++INCLUDE DEDEMCNVD                                                      
         PRINT ON                                                               
         SPACE 2                                                                
         ENDCODE                                                                
