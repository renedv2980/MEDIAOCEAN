*          DATA SET SPWRIWORKD AT LEVEL 115 AS OF 02/22/21                      
*              WORKING STORAGE FOR SPOTPAK WRITER                               
         SPACE 3                                                                
* EQUATES FOR WORKING STORAGE                                                   
*                                                                               
LENSPOOL EQU   SPOOLEND-SPOOLD                                                  
LENGEND  EQU   IO-GEND                                                          
LENSYSD  EQU   SYSEND-SYSD                                                      
LENIOAS  EQU   NIOS*(LIOS+8)                                                    
LENWORK  EQU   LENSPOOL+LENGEND+LENSYSD+LENIOAS                                 
*                                                                               
NIOS     EQU   3                   3 IO AREAS                                   
LIOS     EQU   6000                6000 BYTE IO AREA                            
         SPACE 2                                                                
* WRITER PROGRAM WORKING STORAGE                                                
*                                                                               
SYSD     DSECT                                                                  
DUMPSYSD DS    D                   **SYSD** IN DUMP                             
ATIOB    DS    A                   A(TRANSLATOR BLOCK)                          
BASER7   DS    F                   2ND BASE FOR CONTROLLER                      
BASER6   DS    F                   2ND BASE FOR CONTROLLER                      
         SPACE 1                                                                
*                                  ADRESSES OF LINKED ROUTINES                  
SYSV     DS    0A                  EXTERNAL ADDRESSES                           
GETBROAD DS    V                   ** NOW CORERES **                            
EQVRD    DS    V                                                                
BINSRCH  DS    V                   ** NOW IN COMFACS **                         
DAYUNPK  DS    V                   ** NOW CORERES **                            
COVAIL   DS    V                                                                
DPTRD    DS    V                                                                
SPBVAL   DS    V                                                                
DUMMY    DS    V                                                                
NVTYPES  EQU   (*-SYSV)/4                                                       
         SPACE 1                                                                
COREFACS DS    0A                  CORE RESIDENT PHASES                         
DEMOVAL  DS    A                                                                
SPOTMKRK DS    A                                                                
STAPACK  DS    A                                                                
RCPACK   DS    A                                                                
DAYUNPK2 DS    A                                                                
GENCON   DS    A                                                                
DRONE    DS    A                                                                
SPOTIO   DS    A                                                                
SPOTBUY  DS    A                                                                
OFFICER  DS    A                                                                
CLPACK   DS    A                                                                
MOBILE   DS    A                                                                
CLUNPK   DS    A                                                                
SPOTGOAL DS    A                                                                
DEMOCON  DS    A                                                                
         DS    A                   SPARE (WAS SPWRIGEN)                         
UPVAL    DS    A                                                                
GETBROD2 DS    A                                                                
SPOTSTLK DS    A                                                                
GENPROG  DS    A                                                                
STAVAL   DS    A                                                                
NCORE    EQU   (*-COREFACS)/4                                                   
         SPACE 1                                                                
         EJECT                                                                  
* COMMON FACILITIES                                                             
*                                                                               
SYSCOMM  DS    0A                  SPWRI0C (T2040C) ROUTINES                    
VALUSER  DS    V                   FILLS IN USERNAME USERADD                    
VALMED   DS    V                   VALIDATE MEDIA                               
VALCLT   DS    V                   VALIDATE CLIENT                              
VALPRD   DS    V                   VALIDATE PRODUCT                             
VALEST   DS    V                   VALIDATE ESTIMATE                            
VALMKT   DS    V                   VALIDATE MARKET                              
VALSTAT  DS    V                   VALIDATE STATION                             
MSPACK   DS    V                   NEW INTERFACE TO STAPACK                     
MSUNPK   DS    V                                                                
         DS    2V                  SPARE ADCON                                  
VALFILT  DS    V                   VALIDATE FILTER                              
VALPER   DS    V                   VALIDATE PERIOD EXPRESSION                   
VALOPTS  DS    V                   VALIDATE OPTIONS                             
VALTITS  DS    V                   VALIDATE TITLES                              
VALOTHER DS    V                   VALIDATE OTHER OPTIONS                       
INITDRON DS    V                   INITIALIZE FOR DRONE                         
WRAPDRON DS    V                   WRAP UP DRONE                                
         DS    V                   SPARE ADCON                                  
VALHEAD  DS    V                   VALIDATE HEADERS (UP TO MAX)                 
VALMID   DS    V                   VALIDATE MID LINE                            
VALROWS  DS    V                   VALIDATE (UP TO MAX) ROWS                    
VALCOLS  DS    V                   VALIDATE (UP TO MAX) COLUMNS                 
NSYSCOMM EQU   (*-SYSCOMM)/4                                                    
         SPACE 1                                                                
*                                                                               
* EQUATES FOR MAX HEADS/MIDS/ROWS/COLS FOR STANDARD WRITER                      
MAXHEADS EQU   6                                                                
MAXMIDS  EQU   1                                                                
MAXROWS  EQU   6                                                                
MAXCOLS  EQU   14                                                               
*                                                                               
SYSCOMM2 DS    0A                  SPWRI0B (T2040B) ROUTINES                    
PUTCGRNM DS    V                                                                
PUTREPNM DS    V                                                                
GETREPNM DS    V                                                                
PUTCNTEL DS    V                                                                
GETCML   DS    V                                                                
PUTTOT   DS    V                   PUT OUTPUT TOTAL                             
PUTSGRNM DS    V                   PUT STATION GROUP DETAILS TO BUFFER          
GETSGRNM DS    V                   GET STA GROUP DETAILS FROM BUFFER            
PUTCSFLT DS    V                   PUT CHILD SPOT FLIGHT INFO TO BUFF           
GETCSFLT DS    V                   GET CHILD SPOT FLIGHT INFO FROM BUFF         
SETDPT   DS    V                   SET DAYPART DETAILS                          
PUTGENEL DS    V                   PUT A GENERALIZED ELEMENT                    
GETGENEL DS    V                   GET A GENERALIZED ELEMENT                    
GETXSPIL DS    V                   GET CANADIAN SPILL STATIONS                  
GETTOT   DS    V                   GET & CLEAR OUTPUT ACCUM                     
INITDRIV DS    V                   INITIALIZE FOR DRIVER                        
GETCGRNM DS    V                   GET CLIENT GROUP DETAILS FROM BUFFER         
GENHEAD  DS    V                   GENERAL HEADLINE HOOK                        
SETDATE  DS    V                   SET UP DATE TABLE                            
PUTCLTNM DS    V                   PUT CLIENT DETAILS IN BUFFER                 
PUTESTNM DS    V                   PUT ESTIMATE DETAILS IN BUFFER               
PUTMKTNM DS    V                   PUT MARKET DETAILS IN BUFFER                 
PUTMGRNM DS    V                   PUT MARKET GROUP DETAILS IN BUFFER           
PUTPGRNM DS    V                   PUT PRODUCT GROUP DETAILS IN BUFFER          
GETCLTNM DS    V                   GET CLIENT DETAILS FROM BUFFER               
GETESTNM DS    V                   GET ESTIMATE DETAILS FROM BUFFER             
GETMKTNM DS    V                   GET MARKET DETAILS FROM BUFFER               
GETMGRNM DS    V                   GET MARKET GROUP DETAILS FROM BUFFER         
GETPGRNM DS    V                   GET PRODUCT GROUP DETAILS FROM BUFF          
PUTCBLCT DS    V                   PUT/ADD TO CABLE SYSTEM COUNTER              
GETCBLCT DS    V                   GET COUNT OF SYSTEMS IN CABLE STA            
GETMKTWT DS    V                   GET MARKET WEIGHT                            
PUTOMBYR DS    V                   PUT OM BUYER AND CITY                        
GETOMBYR DS    V                   GET OM BUYER AND CITY                        
NSYSCOM2 EQU   (*-SYSCOMM2)/4                                                   
*                                                                               
PUTNINV  DS    V                   PUT OUT A NEW INVOICE RECORD                 
CURSERR  DS    V                   POSITION CURSOR AND EXIT (IN T00A52)         
*                                                                               
PWCALC   DS    A                   A(PWCALC) - CORRES                           
*                                                                               
VDDUCOM  DS    V                   USER COMMENT CODE                            
         EJECT                                                                  
*              ASSORTED AREAS                                                   
         SPACE 3                                                                
SUMNAME  DS    CL8                 SUMMARY NAME                                 
ASUMMARY DS    A                                                                
AMYAREA  DS    A                                                                
         ORG   ASUMMARY                                                         
AHYEARS  DS    A                   A(HALF YEARS TABLE)                          
HYEARLO  DS    XL1                 HALF YEARS LO AND HI                         
HYEARHI  DS    XL1                                                              
         ORG                                                                    
         SPACE 1                                                                
*                                  OPTIONS                                      
SPACOPT  DS    XL1                 SPACING (1-3)                                
BOXOPT   DS    CL1                 N=NO BOXES                                   
         ORG   BOXOPT                                                           
DOWNCHAR DS    CL1                 CHARACTER FOR TOTAL DOWNLOADING              
WIDTHOPT DS    XL1                 WIDTH OPTION  W=WIDE,N=NARROW                
LEFTOPT  DS    CL1                 Y=LEFT ALIGN                                 
         ORG   LEFTOPT                                                          
DOWNOPT2 DS    XL1                 DOWNLOAD OPTION 2 (GLDNWLD2)                 
DOWNOPT  DS    XL1                 OPTION TO DOWN LOAD                          
DOWNON   EQU   X'80'               DOWN LOADING TURNED ON                       
DOWNNOH  EQU   X'40'               NO HEADINGS FOR DOWNLOAD                     
*                                  OTHER EQUATES SAME AS FOR GLDOWNLD           
TRACEOPT DS    CL1                 OPTION TO TRACE DRIVER                       
WGTOPT   DS    CL1                 MARKET WEIGHTING OPTION (Y,N)                
DEMOPT   DS    CL1                 DEMO OPTION                                  
DEMOTGT  EQU   C'T'                TARGET DEMOS ONLY                            
DEMOSEC  EQU   C'S'                SECONDARY DEMOS ONLY                         
SVCOPT   DS    XL1                 0=NSI,1=ARB                                  
RPTOVLY  DS    XL1                 USER REPORT OVERLAY NUMBER                   
DPGFILE  DS    XL1                 USER REPORT DPG FILE NUMBER                  
DEMGRP   DS    CL1                 C'P'=DEMO GROUPING BY PRODUCT GROUP          
RPTSCRN  DS    XL1                 USER REPORT SCREEN NUMBER                    
MAXREC   DS    XL2                 MAX INPUT RECORD COUNT                       
         SPACE 1                                                                
*                                  TITLES FOR REPORT                            
TITLE    DS    CL63                MAIN REPORT TITLE (HEAD1)                    
         DS    CL1                 SPARE                                        
SUBTITLE DS    CL32                PERIOD SUBTITLE (HEAD3)                      
         DS    CL1                 SPARE                                        
         SPACE 1                                                                
*                                  PRINT ADDRESSES                              
PWIDTH   DS    F                   WIDTH OF PRINT LINES                         
AH1      DS    A                   A(HEAD1)                                     
AH4      DS    A                   A(HEAD4)                                     
AP1      DS    A                   A(P)                                         
ROWWIDS  DS    XL16                ROW WIDTHS FROM ROW2, ROW3, ETC              
         SPACE 1                                                                
PERLIST  DS    XL16                LIST OF PERIOD NUMBERS                       
DAYLO    DS    XL1                 DAYS LO AND HI                               
DAYHI    DS    XL1                                                              
WEKLO    DS    XL1                 WEEKS LO AND HI                              
WEKHI    DS    XL1                                                              
MONLO    DS    XL1                 MONTHS LO AND HI                             
MONHI    DS    XL1                                                              
QTRLO    DS    XL1                 QUARTERS LO AND HI                           
QTRHI    DS    XL1                                                              
         SPACE 1                                                                
STACKDEF DS    XL16                STACK DEFINITION                             
STSPACE  EQU   2                                                                
STDIFF   EQU   4                                                                
STNDX    EQU   6                                                                
STGOAL   EQU   10                                                               
STGCPP   EQU   12                                                               
STGDOL   EQU   14                                                               
STORD    EQU   20                                                               
STOCPP   EQU   22                                                               
STPUR    EQU   30                                                               
STPCPP   EQU   32                                                               
STGROSS  EQU   34                                                               
STNET    EQU   36                                                               
STSPOTS  EQU   38                                                               
STACH    EQU   40                                                               
STRCPP   EQU   42                                                               
STAFF    EQU   50                                                               
STACPP   EQU   52                                                               
STBUY    EQU   60                                                               
STPAID   EQU   62                                                               
STUNPD   EQU   64                                                               
STBIL    EQU   66                                                               
STBILBL  EQU   68                                                               
STRTG    EQU   70                                                               
STCPP    EQU   72                                                               
STIMP    EQU   74                                                               
STCPM    EQU   76                                                               
STPCPPN  EQU   80                                                               
STRCPPN  EQU   82                                                               
STACPPN  EQU   84                                                               
STCPPN   EQU   86                                                               
STCPMN   EQU   88                                                               
STAVPCH  EQU   90                                                               
STAVACH  EQU   92                                                               
STAVAFF  EQU   94                                                               
STGNDOL  EQU   96                                                               
STPWPCT  EQU   98                                                               
STSLDOL  EQU   100                                                              
*                                                                               
TGTDEM   DS    CL7                                                              
TGTDEM2  DS    CL7                                                              
*                                                                               
YEARLO   DS    XL1                 YEARS LO AND HI                              
YEARHI   DS    XL1                                                              
AYEARS   DS    A                   A(YEARS TABLE)                               
ABILMNTH DS    A                   A(BILLING MONTHS TABLE)                      
BILLGST  DS    F                   BILLD GST                                    
         SPACE 1                                                                
**DDSOFC   DS    CL1                 Y=DDS OFFICE                               
AGYSIGN  DS    CL12                SIGN ON ID                                   
AGYALPHA DS    CL2                 AGENCY ALPHA                                 
AGYNUM   DS    CL3                 LAST 3 NUMERIC OF SIGN OR X'FF'              
DDS      DS    C                   Y=DDS                                        
AUTH     DS    XL2                 AUTHORIZATION BITS                           
*              X'800F' = SINGLE EST REQ ONLY                                    
*                        & EST MUST HAVE REQ=Y IN POL EST HEADER                
*              X'400F' = ALLOW CHANGES TO HEADS,MIDS,ROWS,COLS                  
*                                                                               
TERM     DS    XL2                 TERMINAL NUMBER                              
USERID   DS    XL2                 USER ID NUMBER                               
FIELDERR DS    XL1                 USED FOR CURSOR POSITIONING                  
*                                                                               
BYDEMSTK DS    XL1                 BUY DEMO STACK BIT MAP                       
         SPACE 1                                                                
OPTIND2  DS    XL1                 OPTIONS INDICATOR 2                          
OPTISTR  EQU   X'80'               'RTG' IN STACK DEFINITION                    
OPTISTI  EQU   X'40'               'IMP' IN STACK DEFINITION                    
OPTITRUN EQU   X'20'               TRUNC OPTION                                 
OPTINOUP EQU   X'10'               WRITE=NO                                     
OPTIGENA EQU   X'08'               USE NON-CLT SPECIFIC AFFILIATES              
OPTIYMD  EQU   X'04'               PRINT DATES AS YYMMDD                        
OPTINOP  EQU   X'02'               DON'T VALIDATE PERIOD                        
OPTITITL EQU   X'01'               FORMAT PERIOD TO TITLE                       
         SPACE 1                                                                
LENSV    DS    XL1                 SAVED SPOT LENGTH                            
         EJECT                                                                  
*              OTHER STORAGE                                                    
         SPACE 3                                                                
*                                  DRIVER/DRONE RELATED INFO                    
AGLOBAL  DS    A                   A(DRIVER GLOBALS)                            
*                                                                               
* WHEN CHANGING GLOBALLN, RE-LINK SPWRI0B, SPWRI01, SPWRI20                     
* ** NOTE - SBASTANTS LENGTH IS SBUFMAX WHICH IS SUBJECT 2 CHANGE  **           
* ** NOTE - 31 BYTES PRECEDING SBASTANT (TSARKEYL) CAN ALSO CHANGE **           
*                                                                               
*  GLOBALLN IS  200016 DRIVER GLOBAL AREA (GLSIZE)                              
*               240000 SBAOFFBF OFFLINE BUFFER                                  
*                  256 ANETSIZE                                                 
*                  256 SBAMKEST                                                 
*                  624 AUCOMTAB (L'UCOMD)                                       
*                 7400 APURPTAB 200 ENTRIES * 37 BYTES                          
*                   32 SBALKXTD 32 BYTE SPLKXTND BLOCK                          
*                 4080 SBAFLTAB 255 * 16 FLIGHT ENTRIES                         
*                 4000 SBATSATB TSAR AIO AREA FOR READHIGHS                     
*                    2 TSAR RECORD LENGTH FOR SBASTANT                          
*                   31 (CAN CHANGE) MAX TSAR KEY LENGTH (TSARKEYL)              
*                  586 (CAN CHANGE) SBASTANT CURRENT STA BUFF ENTRY             
*                  268 (CAN CHANGE) GETBFRW WORK AREA + OPTKEY                  
*                  160 ACOMLSTG COMSCORE DEMO NAMES LIST FOR GOALS              
*               ------                                                          
*  TOTAL        457711                                                          
*                                                                               
GLOBALLN EQU   500000             .5 MEG                                        
*                                                                               
DRIVER   DS    A                   A(DRIVER)                                    
ALASTCOL DS    A                   A(LAST COLUMN VALIDATED)                     
MYPOSO   DS    0CL3                SAVED PRINT POSITION                         
MYLTYP   DS    CL1                       LINE TYPE (H/M/P)                      
MYLINE   DS    XL1                       LINE NUMBER                            
MYCOL    DS    XL1                       COLUMN NUMBER                          
MYOLEN   DS    XL1                 SAVED OUTPUT LENGTH                          
MYFIRSTH DS    XL1                 FIRST HEADING LINE                           
MYLABEL  DS    CL1                 (COLUMN) LABEL                               
TOTWIDTH DS    H                   USED FOR WIDTH CHECKING                      
ADRIVER  DS    A                   A(DRIVER CALLING ROUTINE IN T20401)          
ANYROWSW DS    CL1                 USED FOR CHECKING ROWS                       
ROW1WIDE DS    XL1                 ROW 1 WIDTH                                  
ROWWIDTH DS    XL1                 TOTAL ROW WIDTH                              
COLXTEND DS    XL1                 COLUMN EXTENSION INDICATOR                   
         SPACE 1                                                                
*                                  ADDRESSES OF BUFFERS                         
**ADBUFF DS    A     *** NOP ***   A(WORKING STORAGE BUFFER) - ONLINE           
AAORLK   DS    A                   A(AOR LOOKUP BLOCK)                          
ADAYS    DS    A                   A(DAYS TABLE)                                
GETNINV  DS    V                   GET A BUFFERED NEW INVOICE RECORD            
ADPGPROG DS    A                   A(DRONE GENERATED DPG PROGRAM)               
AWEEKS   DS    A                   A(WEEKS TABLE)                               
AMONTHS  DS    A                   A(MONTHS TABLE)                              
AQTRS    DS    A                   A(QUARTERS TABLE)                            
AMKTLST  DS    A                   A(MARKET LIST)                               
ADEMLST  DS    A                   A(DEMO LIST)                                 
*                                                                               
ARPTNTRY DS    A                   A(USER REPORT ENTRY POINT)                   
SAVERD01 DS    A                   SPWRI01 REG13 SAVE AREA                      
*                                                                               
*                                  DATE AREAS                                   
QPERTYPE DS    XL1                 0=YMD 2=YM                                   
QSTART   DS    CL6                 REQUESTED START DATE                         
QEND     DS    CL6                 REQUESTED END DATE                           
DATEFORM DS    CL1                 DATE FORM (2 = CALENDAR MONTHS)              
BILLST   DS    XL2                 BILLING PERIOD START MONTH                   
BILLEND  DS    XL2                 BILLING PERIOD END MONTH                     
PEROPT   DS    CL1                 PERIOD OPTION                                
PEROAB   EQU   C'A'                USE AB PROFILE                               
PEROB3   EQU   C'B'                USE B3 PROFILE                               
PERO00   EQU   C'0'                USE 00 PROFILE                               
PEROFF   EQU   C'F'                USE FISCAL FOLLIES                           
PEROCAL  EQU   C'C'                USE CALENDAR MONTHS                          
PEROBRD  EQU   C'R'                USE BROADCAST MONTHS                         
QBPERTYP DS    XL1                 0=YMD 2=YM  BILLING PERIOD                   
QPPERTYP DS    XL1                 0=YMD 2=YM  PAYING PERIOD                    
         SPACE 1                                                                
OUTAREA  DS    0CL65               OUTPUT AREAS                                 
LABLAREA DS    CL15                LABEL AREA                                   
         DS    CL1                                                              
CODENNAM DS    0CL49                                                            
CODEAREA DS    CL12                CODE                                         
         DS    CL1                                                              
NAMEAREA DS    CL36                NAME                                         
         SPACE 1                                                                
INDATA   DS    XL1                 INPUT COLUMN DATA SWITCH                     
LASTHEAD DS    XL1                 ROW NUMBER OF LAST HEADLINE                  
PRTSW    DS    XL1                 N=DON'T PRINT THIS DETAIL LINE               
DPTGRPSV DS    CL3                 SAVE DAYPART GROUP                           
MAXTOTLV DS    XL1                 DON'T PUT TOTAL RECORDS OUT TO               
*                                  SORT IF LEVEL IS LESS THAN THIS              
TOTMKT   DS    XL4                 NUMBER OF MARKETS FOR MKT WEIGHTING          
PRMYDEMO DS    XL3                 PRIMARY DEMO                                 
DRINDS   DS    XL1                 DRIVER'S INDICATOR                           
DRINDS2  DS    XL1                 DRIVER'S INDICATOR 2                         
REQIND   DS    XL1                 REQUEST INDICATOR                            
*REQISOON EQU   X'80'   UNUSED      LIMITED SOON REQUEST                        
REQITRAN EQU   X'40'               RECORD=TRANSMIT                              
*REQI1YR  EQU   X'20'   UNUSED      SOON REQ CAN BE 1 YEAR                      
*REQI21WK EQU   X'10'   UNUSED      SOON REQ CAN BE 21 WEEKS                    
*                                                                               
COMOPT   DS    CL1                 COMMENT OPTION                               
COMOAB   EQU   C'A'                AB COMMENT                                   
COMOA2   EQU   C'2'                A2 COMMENT                                   
COMOB1   EQU   C'1'                B1 COMMENT                                   
COMOMC   EQU   C'M'                MCOM COMMENT                                 
DEMOEQ   DS    XL4                 EQUIV DEMO VALUE                             
TOTWGT   DS    XL4                 TOTAL MARKET WEIGHT                          
EQBASE   DS    CL2                 EDITED EQUIVALENCE BASE                      
BYGROSS  DS    XL4                 BUY GROSS DOLLARS                            
BYEGROSS DS    XL4                 BUY EQUIV GROSS DOLLARS                      
NDEMOS   DS    XL1                 NUMBER OF BUY DEMOS                          
ESTSTART DS    XL1                 START ESTIMATE NUMBER                        
DEMNAMES DS    CL56                DEMO NAMES (8X7)                             
ACOMPIN  DS    XL4                 A(INPUT ENTRY FOR COMPUTE)                   
COLIND   DS    XL1                 COLUMN INDICATOR                             
COLIDEM1 EQU   X'80'               DEMO/CPP COLUMN(S) FOR PRIME DEMO            
COLIRND  EQU   X'40'               DOLLAR ROUNDING INDICATOR                    
COLIGDEM EQU   X'20'               GOAL DEMOS LINKED TO DEMO MENU               
COLINDR  EQU   X'10'               NO DEMO ROUNDING INDICATOR                   
COLISPT  EQU   X'08'               SPOTS COLUMN(S)                              
COLICPPT EQU   X'04'               NO TOTALS FOR CPP                            
COLIDEM2 EQU   X'02'               DEMO/CPP COLUMN(S) FOR SECOND DEMO           
COLIDEM3 EQU   X'01'               DEMO/CPP COLUMN(S) FOR OTHER DEMOS           
COLIDEM  EQU   COLIDEM1+COLIDEM2+COLIDEM3                                       
ROWIND   DS    XL1                 ROW INDICATOR                                
ROWIDPT  EQU   X'80'               DAYPART                                      
ROWIDPLN EQU   X'40'               DAYPART/LENGTH                               
ROWIPER  EQU   X'20'               PERIOD                                       
ROWICML  EQU   X'10'               COMMERCIAL                                   
ROWIMRTO EQU   X'08'               MARKET RANK TOTALS                           
ROWITGT  EQU   X'04'               TARGET/TARGET2                               
ROWIBYCM EQU   X'02'               BUYLINE COMMENTS                             
ROWINOMK EQU   X'01'               SUPPRESS MARKET DETAILS                      
MKTIND   DS    XL1                 C'O'  = ORIGINATING MARKET                   
*                                  C'S'  = SPILL MARKET                         
*                                  X'FF' = COMBINED                             
RPMODE   DS    XL1                 USER REPORT CALLING MODE                     
RPVAL    EQU   1                   VALIDATION                                   
RPINPUT  EQU   2                   INPUT                                        
RPINIT   EQU   3                   INITIALIZATION                               
RPFIRST  EQU   4                   REQUEST FIRST                                
RPRNFRST EQU   6                   RUNFRST FROM GENCON (AFTER VALREC!)          
RPDRHOOK EQU   10                  DRIVER HOOK                                  
RPSPHOOK EQU   11                  SPOT HOOK                                    
RPAFTOUT EQU   15                  AFTER DRIVER OUTPUT CALL                     
RPFINAL  EQU   20                  FINAL CALL                                   
RPRUNLST EQU   30                  RUNLAST                                      
RPSKIOHK EQU   254                 SKIP SPOTIO HK (RETURNED FROM OVLY)          
RPSTOP   EQU   255                 STOP PROCESSING (RETURNED FROM OVLY)         
*                                                                               
CURBOOK  DS    XL1                 CURRENT BOOK NUMBER (0,2,3)                  
PROGNAME DS    CL1                 PROGRAM NAME                                 
*                                                                               
DATAIND4 DS    XL1                 DATA INDICATOR 4                             
DIESTDT  EQU   X'80'               ESTIMATE DATES                               
DIDEMHED EQU   X'40'               DEMO NAMES IN HEADLINES                      
DISREP   EQU   X'20'               SPECIAL REP                                  
DINAMES  EQU   X'10'               BUYER/BILLER NAMES                           
DIBYTYPE EQU   X'08'               BUY TYPE (TRADE/CASH)                        
DIWEIGHT EQU   X'04'               MARKET WEIGHTING                             
DISLN    EQU   X'02'               SPOT LENGTH                                  
DIESTFLT EQU   X'01'               ESTIMATE FILTERS                             
*                                                                               
DATAIND3 DS    XL1                 DATA INDICATOR 3                             
DIPDEMN  EQU   X'80'               NON-ADJUSTED PURCHASED DEMO                  
DIESTNM  EQU   X'40'               ESTIMATE NAME                                
DIPBON   EQU   X'20'               BUY BONUS PURCHASED DEMOS                    
DIBOOK   EQU   X'10'               RATING BOOK                                  
DIDOLNDX EQU   X'08'               DOLLAR INDEX                                 
DICHAN   EQU   X'04'               STATION CHANNEL                              
DILOCKIN EQU   X'02'               LOCK-IN DATA                                 
DIREP    EQU   X'01'               STATION REP                                  
*                                                                               
DATAIND2 DS    XL1                 DATA INDICATOR 2                             
DIEFFCST EQU   X'80'               EFFECTIVE COST                               
DISTA    EQU   X'40'               STATION                                      
DIEST    EQU   X'20'               ESTIMATE                                     
DIPRD    EQU   X'10'               PRODUCT                                      
DIGLDEM  EQU   X'08'               GOAL DEMOS                                   
DIBYPAID EQU   X'04'               BUY PAID DOLLARS                             
DIAFFIL  EQU   X'02'               AFFILIATE                                    
DIPRDNM  EQU   X'01'               PRODUCT NAME                                 
*                                                                               
DATAIND  DS    XL1                 DATA INDICATOR                               
DIDPT    EQU   X'80'               DAYPART                                      
DICPP    EQU   X'40'               CPP                                          
DIDEMP   EQU   X'20'               BUY PURCHASED DEMO                           
DIDEMR   EQU   X'10'               BUY RERATE DEMO                              
DIDEMA   EQU   X'08'               BUY AFFID DEMO                               
DIBYDEM  EQU   DIDEMP+DIDEMR+DIDEMA                                             
DIMED    EQU   X'04'               MEDIA                                        
DIDEMNDX EQU   X'02'               DEMO INDEX                                   
DILEN    EQU   X'01'               SPOT LENGTH                                  
DIDPTLEN EQU   DIDPT+DILEN         DAYPART/LENGTH                               
DIDEMOS  EQU   DIBYDEM+DICPP+DIDEMNDX                                           
*                                                                               
OUTIND   DS    XL1                 OUTPUT INDICATOR                             
OUTICRDP EQU   X'80'               OUTPUTTING DPTLEN ACROSS DAYPARTS            
OUTIDTOT EQU   X'40'               OUTPUTTING DAYPART TOTAL                     
OUTICRMK EQU   X'20'               OUTPUTTING ACROSS MARKETS                    
OUTIMRTO EQU   X'10'               OUTPUTTING MARKET RANK TOTAL                 
OUTISUPM EQU   X'08'               SUPRESSING MARKET                            
OUTIHEAD EQU   X'04'               SHUFFLE EXTRA HEADLINE                       
*                                                                               
ININD    DS    XL1                 INPUT INDICATOR                              
INIEQUIV EQU   X'80'               DEMOS SHOULD BE EQUIVALENCED                 
INIBON   EQU   X'40'               PROCESSING BONUS DEMOS                       
INIDPTOT EQU   X'20'               PROCESSING DAYPART TOTALS                    
INIOWSDY EQU   X'10'               DATES SET FOR OUT OF WEEK ROTATION           
INISPILL EQU   X'08'               PROCESSING SPILL DATA                        
*                                                                               
*                                                                               
*LEVELS   DS    XL12                LEVELS                                      
GETSLP   DS    V                   GET SALESPERSON SPWRI0B                      
PUTSLP   DS    V                   PUT SALESPERSON SPWRI0B                      
GETSTABF DS    V                   GET A STATION BUFFER ENTRY                   
*                                                                               
MKTLEV   DS    XL1                 MARKET LEVEL                                 
DTTOTLEV DS    XL1                                                              
INDPTLEV DS    XL1                 LEVEL ABOVE DAYPART                          
LSTHEDLV DS    XL1                 LAST HEADLINE LEVEL                          
MIDLEV   DS    CL1                 MIDLINE LEVEL                                
COUNTLEV DS    XL1                 COUNT LEVEL                                  
COUNTLEN DS    XL1                 L'COUNTED ROW                                
MKRKLEV  DS    XL1                 MARKET RANK LEVEL                            
TOTLEVS  DS    XL2                 TOTAL LEVELS FOR COUNTING                    
*                                                                               
DATAIND5 DS    XL1                 DATA INDICATOR 5                             
DITARGET EQU   X'80'               TARGET                                       
DIBILLC  EQU   X'40'               BILLED COST                                  
DIPREP   EQU   X'20'               PAYING REP                                   
DICML    EQU   X'10'               COMMERCIAL                                   
DITREP   EQU   X'08'               TIME SHEET REP                               
DIMKTRNK EQU   X'04'               MARKET RANK                                  
DISUBMED EQU   X'02'               SUBMED                                       
DICLT    EQU   X'01'               CLIENT                                       
BILLCOST DS    XL4                 BILLED COST                                  
PFKEY    DS    XL1                 PF KEY                                       
RANKMAX  DS    XL2                 RANK MAXIMUM (TOP OPTION)                    
         SPACE 1                                                                
OPTIND   DS    XL1                 OPTIONS INDICATOR                            
OPTITOSK EQU   X'80'               TOTSKIP                                      
OPTIREP  EQU   X'40'               REP                                          
OPTISTGL EQU   X'20'               GOALS IN STACK                               
OPTISTBY EQU   X'10'               BUYS IN STACK                                
OPTINODF EQU   X'08'               NO DEMO FACTORING                            
OPTISTBL EQU   X'04'               BILLS IN STACK                               
OPTIACST EQU   X'02'               ACCOUNTING STACK                             
OPTIRERT EQU   X'01'               RERATE OR AFFID DEMOS IN STACK               
         SPACE 1                                                                
DATEOPT  DS    CL1                 DATE OPTION                                  
DOBILL   EQU   C'B'                BILLED DATES                                 
DOPAID   EQU   C'P'                PAID DATES                                   
COLIND2  DS    XL1                 COLUMN INDICATOR 2                           
COLIBLBL EQU   X'80'               ALL COLUMNS ARE BILLABLE COLUMNS             
COLIBLB0 EQU   X'40'               ALL BILLABLE COLUMNS ARE ZERO                
COLISDOL EQU   X'20'               MEDIA DOLLAR STACK                           
COLISDEM EQU   X'10'               MEDIA DEMO STACK                             
COLISACC EQU   X'08'               ACCOUNTING STACK                             
COLINOCT EQU   X'04'               NOCENTS                                      
COLIRERT EQU   X'02'               RERATE OR AFFID DEMO COLS                    
COLIMAT  EQU   X'01'               MATCHED/UNMATCHED FILTERS                    
COLISTAK EQU   COLISDOL+COLISDEM+COLISACC                                       
DEMFAC   DS    XL1                 DEMO ADJUSTMENT FACTOR                       
DATAIND6 DS    XL1                 DATA INDICATOR 6                             
DISTDEM  EQU   X'80'               DEMO STACK                                   
DIDATE   EQU   X'40'               AFFIDAVIT DATE                               
DITIME   EQU   X'20'               AFFIDAVIT TIME                               
DIDR     EQU   X'10'               DIRECT RESPONSES                             
DIDEMU   EQU   X'08'               BUY UPGRADE DEMO                             
DINETSTA EQU   X'04'               NETWORK/STATION ROW                          
DIAPROG  EQU   X'02'               AFFIDAVIT PROGRAM                            
DICHILD  EQU   X'01'               CHILD SPOT                                   
BYSPOTS  DS    XL1                 NUMBER OF BUYLINE SPOTS                      
CSDDOL   DS    XL4                 CHILD SPOT DELIVERED DOLLARS                 
*                                                                               
DATAIND7 DS    XL1                 DATA INDICATOR 7                             
DIFLIGHT EQU   X'80'               CHILD SPOT FLIGHTS                           
DIGSTI   EQU   X'40'               INPUT GST                                    
DIGSTO   EQU   X'20'               OUTPUT GST ON GROSS ORDERED                  
DIGSTB   EQU   X'10'               BILLED GST                                   
DISLDEM  EQU   X'08'               STATION LOCKIN DEMOS                         
DIAUTH   EQU   X'04'               AUTHORIZATION DOLLARS                        
DIDOWN   EQU   X'02'               DOWNLOAD ROWS/COLUMNS (DL PREFIX)            
DIRTLSCH EQU   X'01'               RETAIL SCHEME CODE                           
*                                                                               
*                                  COUNTERS                                     
COUNT    DS    XL2                                                              
DPTCNTR  DS    PL1                                                              
LENCNTR  DS    PL1                                                              
DLCNTR   DS    PL1                                                              
OMTYPE   DS    CL1                 CASH/TRADE FOR ORDER REC                     
GMBILTYP DS    CL1                 LMG / REG FOR BILL RECORD                    
GETACOM  DS    V                   GET ACOM RECORD FROM TSAR BUFFER             
ACOMREC  DS    V                   ACOM RECORD BUFFERED HERE                    
NINVREC  DS    V                   INVOICE RECORD BUFFERED HERE                 
OPTIND7  DS    XL1                 OPTION INDICATOR 6                           
OPT7NFLT EQU   X'80'               NOFLOAT OPTION                               
         DS    CL1                 SPARE                                        
         SPACE 1                                                                
OPTIND3  DS    XL1                 OPTION INDICATOR 3                           
OPTINORQ EQU   X'80'               NO REQUEST DETAILS                           
OPTIXSPL EQU   X'40'               CANADIAN SPILL LOOKUP                        
OPTICYMD EQU   X'20'               DATES IN CCYYMMDD FORMAT                     
OPTIFLEM EQU   X'10'               FLOAT=- FOR DOLLAR COLUMNS                   
OPTIBD   EQU   X'08'               BD= OPTION FOR BILLING DATES                 
OPTIMTOT EQU   X'04'               MATCHTOT OPTION                              
OPTINFB  EQU   X'02'               REPORT INFO DATA W/BUYS ONLY                 
OPTCFNT  EQU   X'01'               DON'T SET TOTAL RTN FOR CFMON                
         SPACE 1                                                                
DATAIND8 DS    XL1                 DATA INDICATOR 8                             
DISTANM  EQU   X'80'               STATION NAME                                 
DICBLNM  EQU   X'40'               CABLE SYSTEM MSO/INTERCONNECT NAMES          
DISIZE   EQU   X'20'               STATION SIZE                                 
DICMLCLS EQU   X'10'               COMMERCIAL CLASS NAME                        
DIFORMAT EQU   X'08'               STATION FORMAT                               
DIFAX    EQU   X'04'               STATION FAX                                  
DIRSPDT  EQU   X'02'               INFOMERCIAL RESPONSE DATE                    
DI2NDCOS EQU   X'01'               SECOND COST                                  
*                                                                               
*                                  PRINT FILTERS                                
XCLT     DS    CL3                 CLIENT                                       
         SPACE 1                                                                
OPTIND4  DS    XL1                 OPTION INDICATOR 4                           
OPTCMLBK EQU   X'80'               LEAVE CML BLANK IF UNKNOWN OR ZZZ            
OPTDISCL EQU   X'40'               PRINT DISCLAIMER                             
OPTIDR   EQU   X'20'   ***TEMP***  FILTER BUYS WITH NO IDR                      
OPTRPTDR EQU   X'10'               REPEAT DRIVIN CALL                           
OPTXFILE EQU   X'08'               CROSS FILE REPORTING OPTION (DDB)            
OPTPRDBY EQU   X'04'               REPORT PIGS AS ENTERED (NOT ALPHA)           
OPTCOLBD EQU   X'02'               COL PD FILTER IS BILL DATE                   
OPTXEST  EQU   X'01'               CROSS EST REPORTING FOR PW                   
         SPACE 1                                                                
BILLPST  DS    CL4                 BILLED PST                                   
*                                                                               
ASPWRI02 DS    A                   A(SPWRI02)                                   
*                                                                               
DATAIND9 DS    X                                                                
DIWIPW   EQU   X'80'               EXTRACT WESTERN PW                           
DIWIPWN  EQU   X'40'               EXTRACT WESTERN PW NET $                     
DICBLAGG EQU   X'20'               CABLE AGGREGATE                              
DICABLE  EQU   X'10'                                                            
DICPS    EQU   X'08'               TO FLAG SPOTBUY TO NOT CHUNK SPOTS           
DINSIZE  EQU   X'04'               NET STATION SIZE                             
DIUCOM   EQU   X'02'               USER COMMENT                                 
DIPURP   EQU   X'01'               PURPOSE CODE                                 
*                                                                               
DTAIND10 DS    X                                                                
DISQDA   EQU   X'80'               SQAD CPP - AVERAGE                           
DISQDH   EQU   X'40'               SQAD CPP - HIGH                              
DISQDL   EQU   X'20'               SQAD CPP - LOW                               
DISQD    EQU   DISQDA+DISQDH+DISQDL                                             
DIOMBYR  EQU   X'10'               READ BUYER REC FOR OM BUYER/CITY             
DIEBKTYP EQU   X'08'               ESTIMATE BOOK TYPE                           
DIPSTI   EQU   X'04'               INPUT PST                                    
DIPSTO   EQU   X'02'               OUTPUT PST ON GROSS ORDERED                  
DIPSTB   EQU   X'01'               BILLED PST                                   
*                                                                               
DTAIND11 DS    X                                                                
DIACOM   EQU   X'80'               DOING ACOM                                   
DIUCOM8  EQU   X'40'               DOING ESTIMATE UCOMMS 5-8                    
DIADID2  EQU   X'20'               DOING AD-IDCD2 FOR BUYS                      
DIPGSTC2 EQU   X'10'               HAVE COST2 GST/PST                           
DIOMKGD  EQU   X'08'               ORDER MAKEGOOD KEYWORD                       
DIDEMV   EQU   X'04'               DEMO UNIVERSE KEYWORD                        
*                                                                               
DTAIND12 DS    X                                                                
DISQDN   EQU   X'80'               SQAD CPM - TSA LOW (N)                       
DISQDC   EQU   X'40'               SQAD CPM - TSA AVERAGE (C)                   
DISQDJ   EQU   X'20'               SQAD CPM - TSA HIGH (J)                      
DISQDM   EQU   X'10'               SQAD CPM - DMA LOW (M)                       
DISQDB   EQU   X'08'               SQAD CPM - DMA AVERAGE (B)                   
DISQDI   EQU   X'04'               SQAD CPM - DMA HIGH (I)                      
DISQD2   EQU   DISQDN+DISQDC+DISQDJ+DISQDM+DISQDB+DISQDI                        
*                                                                               
PWLOCKDT DS    0XL8                PW LOCK ACTIVITY DATES                       
PWLKCLDT DS    XL2                 CLT LCK DATE                                 
PWLKSTDT DS    XL2                 STA LCK DATE                                 
PWLKBYDT DS    XL2                 BUY LCK DATE                                 
PWLKPWDT DS    XL2                 PW LCK DATE                                  
*                                                                               
FILTER   DS    CL4                 REPORT FILTER                                
*                                                                               
PWLOCKST DS    X                   PW LOCK STATUS                               
*                                                                               
COLIND3  DS    XL1                 COLUMN INDICATOR 3                           
COLIBLST EQU   X'80'               BILLST IS COL (RELAX BH PERIOD CK)           
COLICBAG EQU   X'40'               CABLE AGG IS COLUMN (CSPOTS)                 
COLIBIGD EQU   X'20'               THIS IS BIG DOWNLOAD FLD (>128 CHRS)         
COLIDEML EQU   X'10'               HAVE DEMO LOOKUPS                            
COLIUNIV EQU   X'08'               HAVE UNIVERSE KEYWORD IN COLUMNS             
*        EQU   X'04'               UNUSED                                       
*        EQU   X'02'               UNUSED                                       
*        EQU   X'01'               UNUSED                                       
*                                                                               
WEEKLEV  DS    XL1                 WEEK ROW LEVEL                               
*                                                                               
ROWIND2  DS    XL1                 ROW INDICATOR 2                              
ROWICLT  EQU   X'80'               CLT IS ROW                                   
ROWIPRD  EQU   X'40'               PRD IS ROW                                   
ROWIEST  EQU   X'20'               EST IS ROW                                   
ROWAPER  EQU   X'10'               PERIOD ROW IS AVGMON                         
ROWIRANK EQU   X'08'               RANK IS ROW                                  
ROWICLAS EQU   X'04'               NEED TO GET THE CML CLASS NAME               
ROWITGT2 EQU   X'02'               TARGET3/TARGET4                              
*        EQU   X'01'               UNUSED                                       
*                                                                               
*                                                                               
STAWORK  DS    XL32                STAPACK INTERFACE AREA                       
*                                                                               
PWAREA   DS    XL86                PW EXTRACT DATA AREA                         
*                                                                               
ATIMRNG  DS    XL4                 AFFIDAVIT TIME RANGE (FILTER)                
*                                                                               
AXTCOLS  DS    XL3                 A(EXTENDED COLUMN TABLE)                     
COLNUM   DS    X                   COL NUM (INDEX INTO XTCOLS)                  
*                                                                               
WLPROF   DS    XL16                WRITER LIMIT PROFILE                         
         SPACE 1                                                                
OPTIND5  DS    XL1                 OPTION INDICATOR 5                           
OPTRFPDT EQU   X'80'               USE STANDARD RFP DATE FORMATS                
OPTISO   EQU   X'40'               USE ISO DATE FORMAT                          
OPTPQIX  EQU   X'20'               OUTPUT PQIX DATA FOR TESTING                 
OPTRCAP  EQU   X'10'               RECAP ONLY OPTION                            
OPTNOWRN EQU   X'08'               NO POST REPORT WARNINGS (FOR DOWNLD)         
OPTNOTAX EQU   X'04'               NO TAX ON BUY $                              
OPTISTLK EQU   X'02'               STATION LOCKIN IN STACK                      
OPT5CONT EQU   X'01'               CONTINUED REPORT (MORE COLUMNS)              
         SPACE 1                                                                
OPTIND6  DS    XL1                 OPTION INDICATOR 6                           
OPT6MDY  EQU   X'80'               USE MMMDD/YY DATE FORMAT                     
OPT6NM0B EQU   X'40'               USE NWK MKT0 BUYS (CANADA)                   
OPT6RP2M EQU   X'20'               REPORT2M OPTION                              
OPT6FILE EQU   X'10'               SEND OUTPUT DATA TO FILE                     
OPT6BCST EQU   X'08'               REPORT TIMES BASED ON BROADCAST              
OPT6SCJE EQU   X'04'               SC JOHNSON ESTIMATE                          
OPT6SQAD EQU   X'02'               REPORT SQAD DATA FOR ALL SPOT LENS           
OPT6NREP EQU   X'01'               NEGATIVE INVOICE REP FILTER                  
         SPACE 1                                                                
ANETSIZE DS    A                   A(NETWORK SIZE TABLE)                        
*                                                                               
PWGROSS  DS    F                   CLT GROSS $$$ (FOR CPP)                      
PWNET    DS    F                   CLT NET   $$$ (FOR CPP)                      
*                                                                               
APQINDEX DS    F                   A(PQ INDEX INFO TABLE)                       
*                                                                               
AUCOMTAB DS    F                   A(USER COMMENT TABLE)                        
UCDP1LEN DS    XL1                 PRODUCT USER COMMENT LENGTH 1                
UCDP2LEN DS    XL1                 PRODUCT USER COMMENT LENGTH 2                
UCDP3LEN DS    XL1                 PRODUCT USER COMMENT LENGTH 3                
UCDP4LEN DS    XL1                 PRODUCT USER COMMENT LENGTH 4                
UCDE1LEN DS    XL1                 ESTIMATE USER COMMENT LENGTH 1               
UCDE2LEN DS    XL1                 ESTIMATE USER COMMENT LENGTH 2               
UCDE3LEN DS    XL1                 ESTIMATE USER COMMENT LENGTH 3               
UCDE4LEN DS    XL1                 ESTIMATE USER COMMENT LENGTH 4               
*                                                                               
UCDP1TYP DS    XL1                 PRODUCT USER COMMENT TYPE 1                  
UCDP2TYP DS    XL1                 PRODUCT USER COMMENT TYPE 2                  
UCDP3TYP DS    XL1                 PRODUCT USER COMMENT TYPE 3                  
UCDP4TYP DS    XL1                 PRODUCT USER COMMENT TYPE 4                  
UCDE1TYP DS    XL1                 ESTIMATE USER COMMENT TYPE 1                 
UCDE2TYP DS    XL1                 ESTIMATE USER COMMENT TYPE 2                 
UCDE3TYP DS    XL1                 ESTIMATE USER COMMENT TYPE 3                 
UCDE4TYP DS    XL1                 ESTIMATE USER COMMENT TYPE 4                 
*                                                                               
FLAGS    DS    X                   VARIOUS FLAGS                                
FLCOS2   EQU   X'80'               SINGLE EST REQ IS COS2 (FOR LOCKIN)          
FLEDAILY EQU   X'40'               DAILY ESTIMATE (FOR SL REPORT)               
FLMLOCK  EQU   X'20'               ADD OVERNIGHT ML REQUEST                     
FLGLOCK  EQU   X'10'               LOCK GOALS ON ML                             
FLGONLY  EQU   X'08'               LOCK ONLY GOALS ON ML                        
*        EQU   X'04'                                                            
*        EQU   X'02'                                                            
*        EQU   X'01'                                                            
*                                                                               
BILLPCT  DS    CL2                 BILLING PERCENTAGE FOR GM                    
ACOMLEV  DS    CL1                 ACOM LEVEL                                   
*                                                                               
APURPTAB DS    A                   A(PURPOSE CODE TABLE)                        
PURPTABL EQU   37                  L'PURPTAB ENTRY                              
PURPTABQ EQU   200                 # PURPTAB ENTRIES                            
*                                                                               
UCDM1LEN DS    XL1                 MARKET USER COMMENT LENGTH 1                 
UCDM2LEN DS    XL1                 MARKET USER COMMENT LENGTH 2                 
UCDM3LEN DS    XL1                 MARKET USER COMMENT LENGTH 3                 
UCDM4LEN DS    XL1                 MARKET USER COMMENT LENGTH 4                 
UCDM1TYP DS    XL1                 MARKET USER COMMENT TYPE 1                   
UCDM2TYP DS    XL1                 MARKET USER COMMENT TYPE 2                   
UCDM3TYP DS    XL1                 MARKET USER COMMENT TYPE 3                   
UCDM4TYP DS    XL1                 MARKET USER COMMENT TYPE 4                   
*                                                                               
* TSAR DATA - PROVIDED BY APPLICATION                                           
*                                                                               
ATSAROF  DS    A                   A(TSAROFF)                                   
ATSARBF  DS    A                   A(TSAR BUFFER)                               
TSAREA   DS    XL64                TSARD AREA                                   
ATSREC   DS    A                   A(REC AREA)                                  
*                                                                               
TSARBUFL EQU   4000000             4 MEG BUFFER (CAN BE INCREASED)              
TSARKEYL EQU   31                  MAX KEY LEN                                  
TSARRECL EQU   100+TSARKEYL        MAX REC LEN - CHANGE IF NECESSARY            
*                                                                               
DRSTBSV  DS    A                   SAVE DRSTBUF FOR FREEMAIN                    
RPT2ID   DS    CL8                 SECOND REPORT NAME                           
RPT2TIT  DS    CL63                SECOND REPORT TITLE                          
*                                                                               
BILCOSTP DS    PL6                 BILLED COST (PL6)                            
ECREATE  DS    XL2                 EST CREATION DATE                            
ACTBOOK  DS    XL1                 ACTUAL BOOK (1-255)                          
***                                                                             
* IF SPWRIWORKD EVER GETS RE-WORKED IT WOULD BE GREAT TO PUT THESE              
* ROUTINES AT THE END OF SYSCOMM2 AND CHANGE SPWRI00 AT SYS6A                   
***                                                                             
ESTETYPE DS    CL1                 ESTIMATE ETYPE                               
OMDEST   DS    CL1                 DESTINATION FILTER                           
OMBUYER  DS    CL3                 OM BUYER FILTER                              
OMOFFICE DS    CL2                 OM OFFICE FILTER                             
OMSTAT   DS    CL6                 OM STATUS FILTER                             
OMREP    DS    CL3                 OM REP FILTER                                
OMPERSON DS    CL1                 OM SALEPERSON/POINTPERSON                    
OMNC     DS    CL1                 REPORT BLANK ORDERS/BUYS FOR OM              
OMUND    DS    CL1                 REPORT NOTDARED ORDERS FOR OM                
THISSTAT DS    CL6                 OM STATUS                                    
*                                                                               
OMFLAGS  DS    X                   OM FLAGS (TO DETERMINE STATUS)               
MF1VAROR EQU   X'80'                - ORDER IS A VAR ORDER                      
MF1VARCF EQU   X'40'                - VAR ORDER NOW CONFIRMED                   
MF1REVOR EQU   X'20'                - ORDER IS A REVISED ORDER                  
MF1CNFCM EQU   X'10'                - CONFIRM WITH COMMENTS                     
MF1YES12 EQU   X'08'                - X'12' ELEMENT HAS BEEN FOUND              
MF1NOFST EQU   X'04'                - NOT THE FIRST PASS ANYMORE                
MF1ERROR EQU   X'02'                - ERROR STAT, NEED TO CLEAN REPID           
*                                                                               
LEVELS   DS    XL13                                                             
QMED     EQU   1                                                                
QCLT     EQU   2                                                                
QPRDGR1  EQU   3                                                                
QPRDGR2  EQU   4                                                                
QPRD     EQU   5                                                                
QEST     EQU   6                                                                
QMKTGR1  EQU   7                                                                
QMKTGR2  EQU   8                                                                
QMKTGR3  EQU   9                                                                
QMKT     EQU   10                                                               
QSTA     EQU   11                                                               
QAFFIL   EQU   12                                                               
QBOOK    EQU   13                                                               
QCHAN    EQU   14                                                               
QDPT     EQU   15                                                               
QPER     EQU   16                                                               
QCML     EQU   17                                                               
QMKTRNK  EQU   18                                                               
QSUBMED  EQU   19                                                               
QCLTNM   EQU   20                                                               
QPRDNM   EQU   21                                                               
QESTNM   EQU   22                                                               
QMKTNM   EQU   23                                                               
QCLTOFF  EQU   24                                                               
QBUY     EQU   25                                                               
QRPTSEQ  EQU   26                                                               
QBUYID   EQU   27                                                               
QSPCLREP EQU   28                                                               
QNAMES   EQU   29                                                               
QRANK    EQU   30                                                               
QBYTYPE  EQU   31                                                               
QPRDINT  EQU   32                                                               
QDPTLEN  EQU   33                                                               
QLEN     EQU   34                                                               
QESTFLT  EQU   35                                                               
QTARGET  EQU   36                                                               
QTARGET2 EQU   37                                                               
QSREP    EQU   38                                                               
QPREP    EQU   39                                                               
*                                 BILL HEADER EQUATES                           
QBHAORTP EQU   40                                                               
QBHCOMTP EQU   41                                                               
QBHINV   EQU   42                                                               
QBHRETL  EQU   43                                                               
QBHTYPE  EQU   44                                                               
QCLTACOF EQU   45                                                               
QCLTINT  EQU   46                                                               
QBPRDINT EQU   47                                                               
QSTATYP  EQU   48                                                               
QAORAGYN EQU   49                                                               
QAORINCA EQU   50                                                               
QAORPCT  EQU   51                                                               
QAORRPA  EQU   52                                                               
QAOREFDT EQU   53                                                               
QBHIMN   EQU   54                                                               
QBHDMN   EQU   55                                                               
QBHPMN   EQU   56                                                               
QBHRMN   EQU   57                                                               
QBHSDT   EQU   58                                                               
QBHSING  EQU   59                                                               
QBHRDT   EQU   60                                                               
QBHPDT   EQU   61                                                               
QBHIDT   EQU   62                                                               
QBHDDT   EQU   63                                                               
*                                                                               
QMKTR    EQU   70                                                               
QMKTRNM  EQU   71                                                               
QADJ     EQU   72                                                               
QDATE    EQU   73                                                               
QTIME    EQU   74                                                               
QTREP    EQU   75                                                               
QCLTGR1  EQU   76                                                               
QCLTGR2  EQU   77                                                               
QSTAGR1  EQU   78                                                               
QSTAGR2  EQU   79                                                               
QNETSTA  EQU   80                                                               
QCMLCLS  EQU   81                                                               
QPROG    EQU   82                                                               
QADAY    EQU   83                                                               
QAPROG   EQU   84                                                               
QTIMES   EQU   85                                                               
QROT     EQU   86                                                               
QTEXT    EQU   87                                                               
QDOWN    EQU   88                                                               
QRTLSCH  EQU   89                                                               
QCLRST   EQU   90                                                               
QSTANM   EQU   91                                                               
QSTACITY EQU   92                                                               
QSTAST   EQU   93                                                               
QSTAAD   EQU   94                                                               
QCOM     EQU   95                                                               
QLINE    EQU   96                                                               
QMSONM   EQU   97                                                               
QICNM    EQU   98                                                               
QSIZE    EQU   99                                                               
QUDEF    EQU   100                                                              
QCNET    EQU   101                                                              
QCMLCLNM EQU   102                                                              
QFORMAT  EQU   103                                                              
QSTAFAX  EQU   104                                                              
QIFSTAT  EQU   105                                                              
QIFTYPE  EQU   106                                                              
QIFDATE  EQU   107                                                              
QIFTIME  EQU   108                                                              
QESTLIN  EQU   109                                                              
QBYDATES EQU   110                                                              
QBYWKS   EQU   111                                                              
QEDATES  EQU   112                                                              
QIFRSPDT EQU   113                                                              
QIFRSPDW EQU   114                                                              
QIFRSPDM EQU   115                                                              
QCMLNUM  EQU   116                                                              
QIFBYCHK EQU   117                                                              
QATTCODE EQU   118                                                              
QADATER  EQU   119                                                              
QATIMEM  EQU   120                                                              
QMKTWT   EQU   121                                                              
QBYCDAT  EQU   122                                                              
QGLCDAT  EQU   123                                                              
QADATED  EQU   124                                                              
QSTAFFCH EQU   125                                                              
QINVNUM  EQU   126                                                              
QBYDOLR  EQU   127                                                              
QSTAADDR EQU   128                                                              
QESTPCT  EQU   129                                                              
QHDCML   EQU   130                                                              
QCLTPCT  EQU   131                                                              
QIDR     EQU   132                                                              
QCCNET   EQU   133                                                              
QINVNO   EQU   134                                                              
QINVDATE EQU   135                                                              
QAGYCODE EQU   136                                                              
QNWSCAMP EQU   137                                                              
QNWSBUY  EQU   138                                                              
QNWSDATE EQU   139                                                              
QCOST    EQU   140                                                              
QNETSIZE EQU   141                                                              
QSTAZIP  EQU   142                                                              
QMKTA    EQU   143                                                              
QNAME    EQU   144                                                              
QBHEDT   EQU   145                                                              
QPDREP   EQU   146                                                              
QSQDDPT  EQU   147                                                              
QBLIDATE EQU   148                                                              
QBLEDATE EQU   149                                                              
QUCOM    EQU   150                                                              
QRSM     EQU   151                                                              
QBYCOPY  EQU   152                                                              
QCMLBCOD EQU   153                                                              
QBONUS   EQU   154                                                              
QINVSTAT EQU   155                                                              
QBLANK   EQU   156                                                              
QINVSRC  EQU   157                                                              
QMSFORMT EQU   158                                                              
QMSFREQ  EQU   159                                                              
QMSOWNER EQU   160                                                              
QMSPARNT EQU   161                                                              
QMSSTATE EQU   162                                                              
QMSCHAN  EQU   163                                                              
QMSNET   EQU   164                                                              
QSHOW    EQU   165                                                              
QETYPE   EQU   166                                                              
QOMSTAT  EQU   167                                                              
QOMSTATD EQU   168                                                              
QOMORDN  EQU   169                                                              
QOMBYRIN EQU   170                                                              
QOMFLT   EQU   171                                                              
QOMSP    EQU   172                                                              
QOMPP    EQU   173                                                              
QOMBYRCT EQU   174                                                              
QOMBYRNM EQU   175                                                              
QOMROUTE EQU   176                                                              
QOMDEST  EQU   177                                                              
QOMREPCN EQU   178                                                              
QOMAGYID EQU   179                                                              
QOMREPID EQU   180                                                              
QADID    EQU   181                                                              
QINVDAYS EQU   182                                                              
QINVFDAT EQU   183                                                              
QINVFPER EQU   184                                                              
QINVLDAT EQU   185                                                              
QINVLPER EQU   186                                                              
QBYDMSRC EQU   187                                                              
QORBIT   EQU   188                                                              
QEQLEN   EQU   189                                                              
QERATE   EQU   190                                                              
QGKBDATE EQU   191                                                              
QGKGDATE EQU   192                                                              
QINVFLAG EQU   193                                                              
QOMLSTST EQU   194                                                              
QMSMOWN  EQU   195                                                              
QMSMCTRY EQU   196                                                              
QMSMCTY  EQU   197                                                              
QMSMSTA  EQU   198                                                              
QMSMST1  EQU   199                                                              
QMSMST2  EQU   200                                                              
QMSMZIP  EQU   201                                                              
QMSTCTRY EQU   202                                                              
QMSTCTY  EQU   203                                                              
QMSTSTA  EQU   204                                                              
QMSTST1  EQU   205                                                              
QMSTST2  EQU   206                                                              
QMSTZIP  EQU   207                                                              
QESTBKTP EQU   208                                                              
QBHINVM  EQU   209                                                              
QBHINVMN EQU   210                                                              
QHDEF    EQU   211                                                              
QCNTR    EQU   212                                                              
QFTYPE   EQU   213                                                              
QBUYBK   EQU   214                                                              
QOMFSNT  EQU   215                                                              
QMFID    EQU   216                                                              
QCLINV   EQU   217                                                              
QCLPRD   EQU   218                                                              
QCLEST   EQU   219                                                              
QRATETYP EQU   220                                                              
QCMLNM   EQU   221                                                              
QBUYBOOK EQU   222                                                              
QOMEMAIL EQU   223                                                              
QINVSREP EQU   224                                                              
QINVAID  EQU   225                                                              
QNTYPE   EQU   226                                                              
QINVCMAT EQU   227                                                              
QBLINVDT EQU   228                                                              
QBUYMGD  EQU   229                                                              
QMSRSENT EQU   230                                                              
QMSMFEM  EQU   231                                                              
QMSFMIN  EQU   232                                                              
QMSFFEM  EQU   233                                                              
QTARGET3 EQU   234                                                              
QTARGET4 EQU   235                                                              
QOMMGCD  EQU   236                                                              
QOMMGRD  EQU   237                                                              
QOMMGLS  EQU   238                                                              
QOMMGAM  EQU   239                                                              
QOMMGST  EQU   240                                                              
*                                                                               
ESTRATE  DS    XL1                                                              
*                                                                               
SLCNTRS  DS    0CL40                                                            
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
         DS    X                                                                
         DS    PL1                                                              
*                                                                               
OMREC    DS    A                   A(OM RECORD)                                 
ESTBKTYP DS    CL1                 ESTIMATE BOOK TYPE                           
LASTFLD  DS    CL12                LAST FIELD                                   
LASTSYS  DS    CL3                 LAST SYSCODE                                 
BILLHST  DS    CL4                 BILLED HST                                   
*                                                                               
ATSARBF2 DS    A                   A(2ND TSAR BUFFER) FOR CML ENTRIES           
TSAREA2  DS    XL64                TSARD AREA                                   
TSA2KEYL EQU   10                  MAX KEY LEN                                  
TSA2RECL EQU   240+TSA2KEYL        MAX REC LEN - CHANGE IF NECESSARY            
TSA2BUFL EQU   1000000             1 MEG BUFFER (CAN BE INCREASED)              
*                                                                               
CMLCODE  DS    CL12                COMMERCIAL CODE                              
CMLNAME  DS    CL15                COMMERCIAL NAME                              
CMLNAME2 DS    CL20                COMMERCIAL NAME 2                            
BYCOST2  DS    XL4                 BUY COST2 DOLLARS                            
BYNCOST2 DS    XL4                 BUY NET COST2 DOLLARS                        
         DS    CL2                 SPARE                                        
CMLCLAS  DS    CL4                 COMMERCIAL CLASS                             
CMLNUM   DS    CL20                CLIENT COMMERCIAL NUMBER                     
CMLBCODE DS    CL16                COMMERCIAL BASIC CODE (SAG/AFTRA)            
CMLCLSNM DS    CL24                COMMERCIAL CLASS NAME                        
CMLCNUM  DS    XL1                 NUMBER OF COMMERCIAL CLASSES                 
COMSEQ   DS    H                   BUY COMMENT SEQUENCE NUMBER                  
XBILLCST DS    F                   PROGRAM EXCHANGE BILLED COST                 
ACLRST01 DS    XL4                 A(CLRST X'01' ELEM)                          
ACLRST03 DS    XL4                 A(CLRST X'03'/X'05' PAIR)                    
LINECNT  DS    H                   LINE COUNT FOR SCJE DPG                      
PRINTH   DS    CL1                 HEADLINE PRINT FLAG                          
CMLNAME3 DS    CL20                COMMERCIAL NAME 3                            
INVSREP  DS    CL3                 INVOICE SPECIAL REP                          
INVQSREP DS    CL3                 INVOICE SPECIAL REP FILTER                   
MOFLOW   DS    CL1                 MONEYFLOW OPTION                             
         DS    CL16                SPARE                                        
COMDLIST DS    CL160               COMSCORE DEMO LIST (8*20)                    
TGTDEM3  DS    CL7                                                              
TGTDEM4  DS    CL7                                                              
*                                                                               
DMGKEY   DS    XL3                 DARE MAKEGOOD KEY                            
DMGENTRY DS    CL12                DARE MAKEGOOD ENTRY                          
*                                                                               
UNIVALS  DS    XL32                UNIVERSE VALUES FOR FIRST 8 DEMOS            
*                                                                               
         DS    CL61                SPARE                                        
         EJECT                                                                  
*              SPOTBLOCK                                                        
         SPACE 3                                                                
DUMPSPIO DS    D                   *SPOTIO* IN DUMP                             
         SPACE 1                                                                
       ++INCLUDE SPOTBLOCK                                                      
         EJECT                                                                  
*              DRONE BLOCK                                                      
         SPACE 3                                                                
SYSD     DSECT                                                                  
         ORG   SBLOCKX                                                          
       ++INCLUDE DRONEBLKD                                                      
         EJECT                                                                  
*              THE REST                                                         
         SPACE 3                                                                
STARTSV  DS    0F                  START OF SYSTEM SAVE AREA                    
         DS    D                   **WEEKS* IN DUMP                             
BUFF     DS    0C                                                               
         DS    CL(NWEEKS*4)                                                     
         DS    F                   MONS IN DUMP                                 
         DS    CL(NMONTHS*4)                                                    
         DS    F                   QTRS IN DUMP                                 
         DS    CL(NQTRS*4)                                                      
         DS    F                   DAYS IN DUMP                                 
         DS    CL(NDAYS*4)                                                      
         DS    F                   YEAR IN DUMP                                 
         DS    CL(NYEARS*4)                                                     
         DS    F                   BMON IN DUMP                                 
         DS    CL(NBILMNTH*6)                                                   
         DS    F                   HYRS IN DUMP                                 
         DS    CL(NHYEARS*4)                                                    
         ORG   BUFF+LDATES                                                      
         DS    D                   **BKLST* IN DUMP                             
*        DS    360C                                                             
*        DS    450C                                                             
         DS    954C                                                             
         DS    D                   **DPG*** IN DUMP                             
         DS    4000C                                                            
         DS    D                   **DPGIO* IN DUMP                             
         DS    1000C                                                            
*                                                                               
NDAYS    EQU   92                                                               
NWEEKS   EQU   60                                                               
NMONTHS  EQU   25                                                               
NBILMNTH EQU   27                                                               
NQTRS    EQU   8                                                                
NHYEARS  EQU   4                                                                
NYEARS   EQU   2                                                                
LDATES   EQU   952                 ENOUGH ROOM FOR ALL DATES BUFFERS            
         SPACE 1                                                                
SYSEND   DS    0C                  END OF SAVED STORAGE                         
         EJECT                                                                  
* ERROR MESSAGES FOR FILE MAINTENANCE (SYSTEM 24)                               
         SPACE 1                                                                
INVMGRP  EQU   60                                                               
INVMED   EQU   61                                                               
INVCLT   EQU   62                                                               
INVPROD  EQU   63                                                               
INVCGRP  EQU   64                                                               
INVSTA   EQU   66                                                               
INVMKT   EQU   67                                                               
INVSGRP  EQU   68                                                               
NOMKTACC EQU   69                                                               
INVPGRP  EQU   70                  INVALID PRODUCT GROUP                        
INVEST   EQU   71                  INVALID ESTIMATE NUMBER                      
INVPGCLT EQU   72                  INVALID PRDGRP/CLIENT COMBO                  
INVPRCLT EQU   73                  INVALID PRODUCT/CLIENT COMBO                 
INVPGFLT EQU   74                  INVALID PRDGRP FILTER                        
INVMGCLT EQU   75                  INVALID MKTGRP/CLIENT COMBO                  
INVMGFLT EQU   76                  INVALID MKTGRP FILTER                        
PERLONG  EQU   80                  PERIOD TOO LONG                              
         EJECT                                                                  
*                                                                               
* NEW ERROR MESSAGES FOR WRITER (600 & UP)                                      
*                                                                               
* (IT WAS A GOOD IDEA TO KEEP ALL THE WRITER ERRORS TOGETHER IN THE             
*  600 RANGE, BUT SOMEONE FOILED THAT PLAN).                                    
*                                                                               
INVUPGR  EQU   0063                INVALID UPGRADE EXPRESSION                   
ONEEST   EQU   0600                SINGLE EST ONLY FOR THIS ID                  
POLREQ   EQU   0601                POL EST MUST HAVE REQ=Y                      
NOREQDL  EQU   0602                OPT DOWN INCOMAPT W/NOREQDET                 
OPTERR   EQU   0603                INVALID OPTION                               
FILTERR  EQU   0604                INVALID FILTER                               
MENERR   EQU   0605                MENU OPTION MUST BE SET                      
NEED1ERR EQU   0606                MUST BE AT LEAST 1 ROW & 1 COL               
CBLERR   EQU   0607                CABLE NET NOT ON MASTER REC                  
ROWERR   EQU   0608                INVALID ROW EXPRESSION                       
DUPERR   EQU   0609                ONLY ONE SUMMARY IS ALLOWED                  
POSERR   EQU   0610                SUMMARY MUST BE IN HEADLINES                 
SUMERR   EQU   0611                SUMMARY REPORT NOT DEFINED                   
LRANKERR EQU   0612                NOT VALID TO RANK ON LAST ROW                
USRERR   EQU   0613                CAN'T FIND USER REC                          
COLERR   EQU   0614                INVALID COLUMN EXPRESSION                    
PEXERR   EQU   0615                PERIOD EXP INCONSISTENT W/REQ                
HOVERR   EQU   0616                HEADING OVERRIDE WIDER THAN COLUMN           
INCMPERR EQU   0617                DPT & ADJ FILTERS ARE INCOMPAT               
TOOWIDE  EQU   0618                REPORT HAS &1 CHARS - TOO WIDE               
EFILTMS  EQU   0619                FOUR CHAR FILT REQD                          
ENOFILMS EQU   0620                REPORT DOES NOT HAVE FILTER                  
ENODEMS  EQU   0621                DEMO KEYWORDS NOT ALLOWED 4 THIS PER         
ECGRPM   EQU   0622                MUST SPECIFY CLIENT GROUP                    
ESGRPM   EQU   0623                MUST SPECIFY STATION GROUP                   
EPOLSEPM EQU   0624                MUST HAVE POL=SEP                            
ENOBOOK  EQU   0625                BOOK OPTION IS MISSING                       
ENSSTAM  EQU   0626                NETSTA NOT VALID WITH STATION                
EFLTM    EQU   0627                CANNOT MIX PERIODS WITH FLIGHT               
EDPGM    EQU   0628                MENU OPTION & DEMOPGRP INVALID               
ENSMKTM  EQU   0629                NETSTA NOT VALID WITH MARKET                 
ETGTM    EQU   0630                MENU OPTION AND TARGET INVALID               
EDATM    EQU   0631                DATE OPTIONS ARE INCONSISTENT                
EPERLONG EQU   0632                PERIOD TOO LONG FOR KEYWORD                  
EPERM    EQU   0633                PERIOD ROW INVALID                           
EPGPBM   EQU   0634                PRDGRPS AND PBSPLIT=N INVALID                
EDPTMM   EQU   0635                INVALID DAYPART MENU                         
EDMENM   EQU   0636                INVALID DEMO MENU                            
EPGRPM   EQU   0637                MUST SPECIFY PROD GROUP                      
EMGRPM   EQU   0638                MUST SPECIFY MARKET GROUP                    
EDEMSM   EQU   0640                MENU OR DEMOS OPTION REQD                    
EDPTLENM EQU   0641                ONLY ONE OF ROWS, DPT, OR DPTLEN             
EDPTM    EQU   0642                DPT OPTION REQD                              
EBDATE   EQU   0643                BD OPTION INVALID - USE BHRDATE              
ECLPRDES EQU   0644                INFO DATA REQS CLT/PRD/EST                   
EMKTREQ  EQU   0647                MARKET REQ'D FOR CABLE AGG (US ONLY)         
EMKTNA   EQU   0648                MKT NOT ALLOWED 4 CBL AGG (CAN ONLY)         
ECNETREQ EQU   0649                CNET REQUIRED IN ROW FOR CABLE AGG           
ENOACT   EQU   0651                ACT TABLE NOT VALID FOR RADIO                
ENOHOV   EQU   0653                HEADING OVERRIDE INVALID                     
WKNDONLY EQU   0781                REPORT CAN ONLY RUN OVER WEEKEND             
SQDINVOP EQU   0792                INVALID   SQAD OPTION                        
SQDDUPOP EQU   0793                DUPLICATE SQAD OPTION                        
SQDNOOPT EQU   0794                NO SQAD OPTION ENTERED                       
MISUPGRD EQU   0798                MISSING UPGRADE FORMULA OR BOOK              
RLPLAST  EQU   0913                OPT W/RLP MUST BE LAST                       
RLPROOM  EQU   0914                NOT ENOUGH ROOM FOR RLP EXPANSION            
BADDATE  EQU   0915                INVALID DATE                                 
BADCONT  EQU   1188                CONT'D REP COLS INCONSISTENT W/RPT1          
PREVBOOK EQU   1189                MUST SET PREV BOOKS STARTING W/ BK1          
NOMSDATA EQU   1206                ACCESS REC DOESN'T ALLOW MSTREET             
NWKBYOP  EQU   1207                NWKBUYS OPT REQUIRED 'FOR DATA'              
NWKBYNWK EQU   1208                NWKBUYS OPT ONLY @ NETWORK=N LEVEL           
NWKBYOPX EQU   1210                NWKBUYS OPT INVALID 'FOR DATA'               
ADIDCML  EQU   1254                CAN'T MIX AD-ID W/COMMERCIAL KEYWORD         
INVOFFC  EQU   1273                OFFICE NOT ON FILE                           
INVBKTY  EQU   1298                INVALID BOOK TYPE                            
*                                                                               
* NEW INFO MESSAGES FOR WRITER (600 & UP)                                       
*                                                                               
INSMESS  EQU   0600                NEW FIELD INSERTED ON SCREEN                 
DELMESS  EQU   0601                FIELD DELETED ON SCREEN                      
*                                                                               
* EQUATES FOR TSAR ELEMENTS                                                     
*                                                                               
NPCLTCDQ EQU   1                                                                
NPESTCDQ EQU   2                                                                
NPMKTCDQ EQU   3                                                                
NPMGRCDQ EQU   4                                                                
NPPGRCDQ EQU   5                                                                
NPREPCDQ EQU   6                                                                
NPCGRCDQ EQU   7                                                                
NPSGRCDQ EQU   8                                                                
NPFLTCDQ EQU   9                                                                
NPCNTCDQ EQU   10                                                               
NPGENCDQ EQU   11                                                               
NPCBLCDQ EQU   13                  CABLE SYSTEM COUNTER                         
NPTOTCDQ EQU   14                  TOTAL ACCUMULATOR ELEM                       
NPOMBCDQ EQU   15                                                               
NPNINCDQ EQU   16                  INVOICE RECORD, VARIABLE LENGTH              
NPSTACDQ EQU   17                  STATION BUFFER, LEN=STABUFFL                 
NPSLPCDQ EQU   18                  SALESPERSON ELEMENT                          
NPOMRECQ EQU   19                  OM RECORD                                    
NPDMRECQ EQU   20                  DARE MAKEGOOD NOTICE RECORD                  
*                                                                               
* EQUATES FOR TSAR BUFFER 2 ELEMENTS (COMMERCIAL DATA)                          
*                                                                               
NPCMLCDQ EQU   1                   COMMERCIAL RECORD DATA                       
NPCCLCDQ EQU   2                   COMMERCIAL CLASS DATA                        
*                                                                               
         EJECT                                                                  
* USER COMMENT RECORD DSECT                                                     
UCOMD    DSECT                                                                  
UCDP1FLD DS    CL32                PRODUCT USER FIELD 1                         
UCDP2FLD DS    CL32                PRODUCT USER FIELD 2                         
UCDP3FLD DS    CL32                PRODUCT USER FIELD 3                         
UCDP4FLD DS    CL32                PRODUCT USER FIELD 4                         
UCDE1FLD DS    CL32                ESTIMATE USER FIELD 1                        
UCDE2FLD DS    CL32                ESTIMATE USER FIELD 2                        
UCDE3FLD DS    CL32                ESTIMATE USER FIELD 3                        
UCDE4FLD DS    CL32                ESTIMATE USER FIELD 4                        
UCDM1FLD DS    CL32                MARKET USER FIELD 1                          
UCDM2FLD DS    CL32                MARKET USER FIELD 2                          
UCDM3FLD DS    CL32                MARKET USER FIELD 3                          
UCDM4FLD DS    CL32                MARKET USER FIELD 4                          
*                                                                               
UCDP1DES DS    CL20                PRODUCT USER FIELD DESCRIPTION 1             
UCDP2DES DS    CL20                PRODUCT USER FIELD DESCRIPTION 2             
UCDP3DES DS    CL20                PRODUCT USER FIELD DESCRIPTION 3             
UCDP4DES DS    CL20                PRODUCT USER FIELD DESCRIPTION 4             
UCDE1DES DS    CL20                ESTIMATE USER FIELD DESCRIPTION 1            
UCDE2DES DS    CL20                ESTIMATE USER FIELD DESCRIPTION 2            
UCDE3DES DS    CL20                ESTIMATE USER FIELD DESCRIPTION 3            
UCDE4DES DS    CL20                ESTIMATE USER FIELD DESCRIPTION 4            
UCDM1DES DS    CL20                MARKET USER FIELD DESCRIPTION 1              
UCDM2DES DS    CL20                MARKET USER FIELD DESCRIPTION 2              
UCDM3DES DS    CL20                MARKET USER FIELD DESCRIPTION 3              
UCDM4DES DS    CL20                MARKET USER FIELD DESCRIPTION 4              
*                                                                               
UCOML    EQU   *-UCOMD                                                          
*                                                                               
         EJECT                                                                  
*           EXTENDED COLUMN FILTERS                                             
*  RELINK SPWRIGEN, SPWRI01 & SPSYSDRV1 WHEN CHANGING THIS DSECT                
EXTCOLSD DSECT                                                                  
EXTSLEN  DS    X                   SPOT LENGTH FILTER                           
EXTFLAG1 DS    X                   FLAG BYTE 1                                  
EXTORIG  EQU   X'80'                ORIGINAL DEMOS ONLY                         
EXTSPIL  EQU   X'40'                SPILL DEMOS ONLY                            
EXTCASH  EQU   X'20'                CASH FILTER                                 
EXTTRD   EQU   X'10'                TRADE FILTER                                
EXTLMG   EQU   X'08'                LMG BILLING FILTER                          
EXTREG   EQU   X'04'                REG BILLING FILTER                          
*        EQU   X'02'               *** UNUSED ***                               
*        EQU   X'01'               *** UNUSED ***                               
EXTSREP  DS    XL3                 SPECIAL REP FILTER                           
EXTPD    DS    XL4                 PERIOD S/E DATES (COMPRESSED)                
EXTEST   DS    X                   ESTIMATE FILTER                              
EXTCOLSL EQU   *-EXTCOLSD                                                       
         SPACE 2                                                                
*                                                                               
PQINDEX  DSECT                                                                  
PQKEYWRD DS    CL8                 KEYWORD                                      
PQAOUT   DS    F                   A(OUTPUT AREA)                               
PQSTATUS DS    X                   STATUS BYTE                                  
PQCHG    EQU   X'80'                DATA HAS CHANGED                            
*        EQU   X'40'               *** UNUSED ***                               
*        EQU   X'20'               *** UNUSED ***                               
*        EQU   X'10'               *** UNUSED ***                               
*        EQU   X'08'               *** UNUSED ***                               
*        EQU   X'04'               *** UNUSED ***                               
*        EQU   X'02'               *** UNUSED ***                               
*        EQU   X'01'               *** UNUSED ***                               
*                                                                               
PQOUTLEN DS    X                   OUTPUT LENGTH                                
PQPOSO   DS    C                   H=HEAD, M=MID, 0=ROW                         
         DS    X                   SPARE                                        
*                                                                               
PQHEAD1  DS    CL24                HEADLINE 1                                   
PQHEAD2  DS    CL24                HEADLINE 2                                   
PQHEAD3  DS    CL24                HEADLINE 3                                   
PQHEAD4  DS    CL24                HEADLINE 4                                   
*                                                                               
PQINDXEQ EQU   *-PQINDEX                                                        
         EJECT                                                                  
*                                                                               
MKTLSTD  DSECT                     ** MARKET LIST DSECT **                      
MLMKT    DS    XL2                 AGENCY MARKET                                
MLLEVS   DS    XL2                 LEVEL SWITCHES                               
MLRTGSVC DS    CL1                 RATING SERVICE (FOR WEIGHT)                  
MLDEMO   DS    XL3                 PRIMARY DEMO (FOR WEIGHT)                    
MLWGT    DS    XL4                 MARKET WEIGHT                                
MKTLSTL  EQU   *-MKTLSTD                                                        
MLNMKTS  EQU   1000                NUMBER OF ENTRIES                            
         SPACE 2                                                                
GLARGSD  DSECT                     ** DRIVER ARGUMENT LIST DSECT **             
*                                                                               
         DS    CL6                 INPUT ARGS                                   
GLINDEX  DS    CL1                 COLUMN NUMBER (COLS ONLY)                    
*                                                                               
GLISTA   DS    XL3                 STATION FILTER                               
         ORG   GLISTA                                                           
GLIPRD   DS    CL3                 PRODUCT FILTER (GLIIPRD SET)                 
GLIDPT   DS    CL1                 DAYPART FILTER (LOWER CASE=MASDPT)           
         ORG   GLIDPT                                                           
GLIADJ   DS    CL1                 ADJACENCY CODE FILTER (GLIIADJ SET)          
GLIIND   DS    XL1                 COLUMN INDICATOR                             
GLIIADJ  EQU   X'80'               GLIDPT HOLDS ADJ CODE                        
GLIIWGT  EQU   X'40'               WEIGHTED DEMO                                
GLIIPST  EQU   X'20'               INCLUDE PST IN GST,USE WITH X'04/02'         
GLIIMAT  EQU   X'10'               MATCHED SPOTS ONLY                           
GLIIUNM  EQU   X'08'               UNMATCHED SPOTS ONLY                         
GLIIGSTI EQU   X'04'               INCLUDE INPUT GST                            
GLIIGSTO EQU   X'02'               INCLUDE OUTPUT GST                           
GLIIPRD  EQU   X'01'               PRODUCT FILTER PRESENT                       
GLIPER   DS    XL4                 PERIOD FILTER START(2)/END(2)                
         ORG   GLARGSD                                                          
         DS    CL11                OUTPUT ARGS                                  
GLOIND   DS    XL1                 COLUMN INDICATOR                             
GLOIWGT  EQU   X'40'               WEIGHTED DEMO                                
GLOICUME EQU   X'20'               SPECIAL CUME                                 
GLOITITL EQU   X'10'               OUTPUT DATES TO TITLE                        
         DS    CL4                                                              
         ORG   GLARGSD                                                          
GLHDEMNO DS    XL1                 DEMO NUMBER                                  
GLHDEMTY DS    CL1                 DEMO TYPE P/R/A/G/O                          
         DS    CL2                                                              
GLHNONAD DS    CL1                 N=NON-ADJUSTED PURCH DEMO                    
         DS    CL6                 HEADLINE ARGS                                
GLHIND   DS    XL1                 COLUMN INDICATOR                             
GLHIWGT  EQU   X'40'               WEIGHTED DEMO                                
         DS    CL4                                                              
         SPACE 2                                                                
WRIRTBD  DSECT                     ** SYSDRIVER ROUTINE TABLE DSECT **          
*                                                                               
WRLABEL  DS    CL8                 ROUTINE LABEL                                
WROVLY   DS    XL1                 OVERLAY NUMBER                               
WRRNUM   DS    XL2                 ROUTINE NUMBER WITHIN OVERLAY                
         DS    XL1                                                              
WRINDS1  DS    XL1                 DATA INDICATORS                              
WRINDS2  DS    XL1                                                              
WRINDS3  DS    XL1                                                              
WRINDS4  DS    XL1                                                              
WRINDS5  DS    XL1                                                              
WRINDS6  DS    XL1                                                              
WRINDS7  DS    XL1                                                              
WRINDS8  DS    XL1                                                              
WRINDS9  DS    XL1                                                              
WRINDS10 DS    XL1                                                              
WRINDS11 DS    XL1                                                              
WRINDS12 DS    XL1                                                              
*                                                                               
WRIRTBL  EQU   *-WRIRTBD                                                        
         EJECT                                                                  
RSTACKD  DSECT                     ** DEMO STACK DSECT **                       
RSGDOLCP DS    XL4                 GOAL DOLLARS FOR CPP                         
RSGPENCP DS    XL4                 GOAL PENNIES FOR CPP                         
RSGDEM   DS    XL8                 GOAL DEMO                                    
RSGDEMCP DS    XL8                 GOAL DEMO FOR CPP                            
RSGDOL   DS    XL4                 GOAL DOLLARS                                 
RSGPEN   DS    XL4                 GOAL PENNIES                                 
RSGNDOL  DS    XL4                 GOAL NET DOLLARS                             
RSGNPEN  DS    XL4                 GOAL NET PENNIES                             
RSODOL   DS    XL4                 ORDERED DOLLARS                              
RSOPEN   DS    XL4                 ORDERED PENNIES                              
RSODEM   DS    XL8                 ORDERED DEMO                                 
RSODEMCP DS    XL8                 ORDERED DEMO FOR CPP                         
RSBDOL   DS    XL4                 BUY DOLLARS FOR CPP                          
RSBPEN   DS    XL4                 BUY PENNIES FOR CPP                          
RSPDEM   DS    XL8                 PURCHASED DEMO                               
RSPDEMCP DS    XL8                 PURCHASED DEMO FOR CPP                       
RSRDEM   DS    XL8                 ACHIEVED DEMO                                
RSRDEMCP DS    XL8                 ACHIEVED DEMO FOR CPP                        
RSADEM   DS    XL8                 AFFID DEMO                                   
RSADEMCP DS    XL8                 AFFID DEMO FOR CPP                           
RSSPOTS  DS    XL4                 SPOTS                                        
RSGRSDOL DS    XL4                 BUY GROSS DOLLARS                            
RSGRSPEN DS    XL4                 BUY GROSS PENNIES                            
RSNETDOL DS    XL4                 BUY NET DOLLARS                              
RSNETPEN DS    XL4                 BUY NET PENNIES                              
RSNCPDOL DS    XL4                 BUY NET DOLLARS FOR CPP                      
RSNCPPEN DS    XL4                 BUY NET PENNIES FOR CPP                      
RSTAX    DS    XL4                 BUY TAX DOLLARS                              
RSPWGRS  DS    XL4                 PW GROSS DOLLARS                             
RSSTDOL  DS    XL4                 STATION LOCKIN DOLLARS                       
RSSTPEN  DS    XL4                 STATION LOCKIN PENNIES                       
RSTACKL  EQU   *-RSTACKD                                                        
         SPACE 2                                                                
BSTACKD  DSECT                     ** BUY DEMO STACK DSECT **                   
BSDOL    DS    XL4                 DOLLARS FOR CPP                              
BSPEN    DS    XL4                 PENNIES FOR CPP                              
BSNCPDOL DS    XL4                 NET DOLLARS FOR CPP                          
BSNCPPEN DS    XL4                 NET PENNIES FOR CPP                          
BSRTG    DS    XL8                 RATING                                       
BSRTGCP  DS    XL8                 RATING FOR CPP                               
BSIMP    DS    XL4                 IMPS                                         
BSIMPCP  DS    XL4                 IMPS FOR CPM                                 
BSSPOTS  DS    XL4                 SPOTS                                        
BSGRSDOL DS    XL4                 GROSS DOLLARS                                
BSGRSPEN DS    XL4                 GROSS PENNIES                                
BSNETDOL DS    XL4                 NET DOLLARS                                  
BSNETPEN DS    XL4                 NET PENNIES                                  
BSTACKL  EQU   *-BSTACKD                                                        
         SPACE 2                                                                
DSTACKD  DSECT                     ** DOLLAR STACK DSECT **                     
DSGDOL   DS    XL4                 GOAL DOLLARS                                 
DSGPEN   DS    XL4                 GOAL PENNIES                                 
DSODOL   DS    XL4                 ORDERED DOLLARS                              
DSOPEN   DS    XL4                 ORDERED PENNIES                              
DSBDOL   DS    XL4                 PURCHASED DOLLARS                            
DSBPEN   DS    XL4                 PURCHASED PENNIES                            
DSSTDOL  DS    XL4                 STATION LOCKIN DOLLARS                       
DSSTPEN  DS    XL4                 STATION LOCKIN PENNIES                       
DSTACKL  EQU   *-DSTACKD                                                        
         SPACE 2                                                                
ASTACKD  DSECT                     ** ACCOUNTING STACK DSECT **                 
ASODOL   DS    XL4                 ORDERED DOLLARS                              
ASOPEN   DS    XL4                 PRDERED PENNIES                              
ASPDOL   DS    XL4                 PAID DOLLARS                                 
ASPPEN   DS    XL4                 PAID PENNIES                                 
ASUDOL   DS    XL4                 UNPAID DOLLARS                               
ASUPEN   DS    XL4                 UNPAID PENNIES                               
ASBDOL   DS    XL4                 BILLED DOLLARS                               
ASBPEN   DS    XL4                 BILLED PENNIES                               
ASTACKL  EQU   *-ASTACKD                                                        
*                                                                               
DAREMKGD DSECT                     DARE MAKEGOOD NOTICE DSECT                   
DMKGDRDT DS    XL5                 RECEIVED DATE/TIME                           
DMKGDLDT DS    XL5                 LAST STATUS DATE/TIME                        
DMKGDRVS DS    XL1                 TOTAL MAKEGOOD AMENDMENTS                    
DMKGDLST DS    XL1                 LAST STATUS                                  
DMKGDLEN EQU   *-DMKGDRDT          RECORD ENTRY LENGTH                          
*                                                                               
* SPSTAPACKD                                                                    
       ++INCLUDE SPSTAPACKD                                                     
