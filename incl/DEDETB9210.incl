*          DATA SET DEDETB9210 AT LEVEL 033 AS OF 05/01/02                      
         TITLE 'BBM POST NOV 1987 TAPE CONVERTER'                               
         PRINT NOGEN                                                            
DETB9210 CSECT                                                                  
         NMOD1 0,DETB9210                                                       
         LR    R3,RB                                                            
         LA    R3,2048(RB)                                                      
         LA    R3,2048(R3)                                                      
         USING DETB9210+4096,R3                                                 
         USING DEMCOND,R8                                                       
         L     RC,ARREC                                                         
         USING BBMCAD,RC                                                        
         L     R2,AIREC                                                         
         USING INTERD,R2                                                        
         B     *+4(R1)                                                          
         SPACE 2                                                                
         B     READ                GET INPUT (ARREC - INT )                     
         B     CNVWR               CONVERT TO OUTPUT (INT - WORK)               
         B     MORET               CLOSE INPUT                                  
         B     EXIT                                                             
         EJECT                                                                  
READ     CLI   INTAPESW,1                                                       
         BE    OPENOK                                                           
         OPEN  (IN1,(INPUT))                                                    
         CLI   RELOFRST,1                                                       
         BNE   OPENOK                                                           
         MVI   RELOFRST,0                                                       
OPENOK   CLI   BYPREAD,1           REPROCESS INPUT RECORD                       
         BE    OKCONV                                                           
         L     R4,ARREC                                                         
         LR    RE,R4                                                            
         L     RF,=F'400'                                                       
         XCEF                                                                   
         GET   IN1,(R4)                                                         
*                                                                               
         MVC   HALF,CAMRKT                                                      
         BAS   RE,FLTMKT           MARKET FILTERING                             
         CLI   PASSFLT,C'N'                                                     
         BE    OPENOK                                                           
*                                                                               
*                                                                               
         DROP  RC                                                               
         USING BBMDTAD,RC                                                       
CHSTAT   CLC   D8LINE,=H'1'        STATION RECORD                               
         BH    OKCONV                                                           
         DROP  RC                                                               
         USING BBMCAD,RC                                                        
         OC    CAID,CAID                                                        
         BNZ   OPENOK                                                           
         XC    HOMESTA,HOMESTA                                                  
         LA    RF,HOMESTA                                                       
         LA    RE,HOMEMKT                                                       
BLDHOME  CLI   0(RE),X'FF'                                                      
         BE    BLDHOMEX                                                         
         CLC   0(2,RE),CAMRKT                                                   
         BE    *+12                                                             
         LA    RE,7(RE)                                                         
         B     BLDHOME                                                          
         MVC   0(5,RF),2(RE)                                                    
         LA    RF,5(RF)                                                         
         LA    RE,7(RE)                                                         
         B     BLDHOME                                                          
BLDHOMEX DS    0H                                                               
         MVC   HALF,CAMRKT         PRINT THE MARKET NUMBER AND NAME             
         MVC   SAVUNIV,CAUNIV                                                   
         L     R9,VCPRINT                                                       
         USING DPRINT,R9                                                        
         EDIT  HALF,(4,P)                                                       
         MVC   P+5(18),CAMNAME                                                  
         GOTO1 VPRINTER                                                         
         XC    STALIST,STALIST                                                  
         B     OPENOK               NO - GET NEXT RECORD                        
         DROP  RC                                                               
*                                                                               
         USING BBMDTAD,RC                                                       
OKCONV   DS    0C                                                               
         CLI   BYPREAD,1           RESTORE STATION CALL LETTERS                 
         BNE   *+10                IF NOT ORIGINAL READ                         
         MVC   D8CALL(5),PREVSTAT                                               
         MVC   PREVSTAT,D8CALL                                                  
         MVC   INTSTA,D8CALL                                                    
         MVC   INTMRKT,D8MRKT                                                   
         CLC   D8CALL(3),=C'ALL'                                                
         BE    OPENOK                                                           
         CLC   D8CALL(5),=C'OTHER'                                              
         BE    OPENOK                                                           
         CLC   D8CALL(5),=C'CKPG+'                                              
         BNE   *+8                                                              
         MVI   D8CALL+3,C'Z'                                                    
         CLI   D8CALL+3,C'+'                                                    
         BNE   *+8                                                              
         MVI   D8CALL+3,C' '                                                    
         CLC   D8CALL(5),=C'R-CAN'                                              
         BNE   *+10                                                             
         MVC   D8CALL(4),=C'RCAN'                                               
         MVI   D8CALL+4,C'T'                                                    
         B     DUPCHKX             BYPASS BECAUSE WE NOW INCLUDE                
*                                   WEEKLY DATA                                 
         CLC   D8PNAM(7),=C'VARIOUS'    SET UP DUP CHECK                        
         BE    DUPSET                                                           
         CLC   D8PNAM(6),=C'DIVERS'                                             
         BNE   DUPCHK                                                           
DUPSET   MVC   SVEQH,D8EQH                                                      
         MVC   SVSTAT,D8CALL                                                    
         B     DUPCHKX                                                          
DUPCHK   CLC   SVSTAT,D8CALL           CHECK FOR DUPLICATE                      
         BNE   DUPCHKX                                                          
         CLI   BYPREAD,1           OK IF NO READ                                
         BE    DUPCHKX                                                          
         CLC   D8EQH,SVEQH                                                      
         BNH   OPENOK                                                           
         MVI   SVEQH,0             RESET DUPLICATE CHECKING                     
DUPCHKX  DS    0H                                                               
         MVI   INTSTYP,PARENTE                                                  
         CLI   GLOBAL,C'Y'                                                      
         BE    GETHOM2                                                          
         LA    RE,HOMESTA                                                       
GETHOME  CLC   INTSTA(5),0(RE)     CHECK ALL 5 CHAR                             
         BE    GETHOM2                                                          
* TAKEN OUT 96/01/04 BECAUSE I'M SICK OF BBM FUCK UPS ON FIFTH                  
* CHARACTER.                                                                    
*        CLI   4(RE),C' '          MAYBE ONLY 4 SIGNIFICANT                     
*        BNE   *+14                                                             
         CLC   INTSTA(4),0(RE)     ONLY CHECK 4                                 
         BE    GETHOM2                                                          
         LA    RE,5(RE)                                                         
         CLI   0(RE),0                                                          
         BNE   GETHOME                                                          
         OI    INTSTYP,OUTMARE                                                  
GETHOM2  DS    0H                                                               
         MVC   INTSTA,D8CALL                                                    
* CHECK FOR FIRST TIME FOR STATION                                              
         LA    R9,STALIST                                                       
CHKSTA   CLI   0(R9),0             END OF LIST                                  
         BNE   CHKSTA2              NO TRY NEXT                                 
         MVI   BYPREAD,1            YES - INSERT AND SEND 'M' RECORD            
         MVC   0(5,R9),INTSTA                                                   
         MVI   STASW,1                                                          
         BAS   RE,SETKEY                                                        
         B     EXIT                                                             
CHKSTA2  CLC   0(5,R9),INTSTA      STATION IN LIST                              
         BE    *+12                                                             
         LA    R9,5(R9)                                                         
         B     CHKSTA                                                           
         SPACE 2                                                                
         MVI   STASW,0             RESET CREAT 'M' RECORD SWITCHES              
         MVI   BYPREAD,0                                                        
         MVC   INTDAY,D8DAYS       COMPLETE DEMO RECORD CONVERSION              
         CLI   INTDAY,X'15'                                                     
         BNE   *+12                                                             
         OI    INTDAY,X'80'                                                     
         B     *+8                                                              
         NI    INTDAY,X'F0'                                                     
         ZIC   RE,D8SQH                                                         
         BCTR  RE,0                                                             
         STC   RE,INTSQH                                                        
         ZIC   RE,D8EQH                                                         
         BCTR  RE,0                                                             
         BCTR  RE,0                                                             
         STC   RE,INTEQH                                                        
         CLC   INTEQH,INTSQH       ENSURE END TIME VALID                        
         BNL   *+10                                                             
         MVC   INTEQH,INTSQH       FORCE END EQUAL TO START                     
         MVC   INTWEEKS,D8WEEK                                                  
         NI    INTWEEKS,X'0F'                                                   
         ZIC   RE,D8WEEK                                                        
         SRL   RE,4                                                             
         STC   RE,INTWEEKS                                                      
         MVC   INTPNAM,D8PNAM                                                   
         CLC   INTPNAM,=C'                '                                     
         BNE   *+10                                                             
         MVC   INTPNAM(9),=C'NOT GIVEN'                                         
         EJECT                                                                  
* CONVERT FIELDS INTO INTERNAL FORMAT                                           
         LA    R5,D8DATA                                                        
         USING DATAD,R5                                                         
         XC    SIREC(SIRECLN),SIREC                                             
         SR    R6,R6                                                            
         IC    R6,D8NOCOL+1                                                     
CNVDATA  ZIC   R7,D8COLNUM         GET COLUMN NUMBER                            
         CLI   D8COLNUM,50         CHECK FOR MAX                                
         BL    *+6                                                              
         DC    H'0'                                                             
         LTR   R7,R7                                                            
         BZ    EXIT                                                             
         BCTR  R7,0                                                             
         LTR   R7,R7                                                            
         BNM   *+6                                                              
         DC    H'0'                COL NUMBER WENT NEGATIVE                     
         SLL   R7,2                                                             
         LA    R7,COLLINK(R7)                                                   
         CLI   D8COLNUM,1                                                       
         BE    *+14                                                             
         OC    1(3,R7),1(R7)       BYPASS INDICATED                             
         BZ    CNVDATA2            YES - GET NEXT COLUMN                        
         MVC   FULL,D8COLNUM                                                    
         L     RE,FULL                                                          
         LA    RE,0(RE)                                                         
         L     RF,0(R7)                                                         
         LA    RF,0(RF)                                                         
         LA    RF,SIREC(RF)        SET TO FIXED SLOT                            
         TM    0(R7),X'80'                                                      
         BO    *+12                                                             
         ST    RE,0(RF)                                                         
         B     CNVDATA2                                                         
         MH    RE,=H'10'                                                        
         ST    RE,0(RF)                                                         
CNVDATA2 LA    R5,4(R5)                                                         
         BCT   R6,CNVDATA                                                       
         MVC   SIUNIVS,SAVUNIV                                                  
         MVC   INTACCS(SIRECLN),SIREC  SET DEMO DATA                            
         BAS   RE,SETKEY                                                        
         B     EXIT                                                             
         EJECT                                                                  
CNVWR    L     R2,ASREC            POINT TO SORT RECORD                         
         L     R6,ASREC                                                         
         LA    R6,4(R6)                                                         
         USING DRKEY,R6                                                         
         CLI   0(R6),C'R'          BYPASS IF NOT RATINGS RECORD                 
         BNE   EXIT                                                             
GOODREC  MVC   PREVSTYP,DRSTYP                                                  
         MVC   PREVSTAT,DRSTAT                                                  
         MVC   PREVQH,INTSQH                                                    
         CLC   INTSQH,PREVSQH      FORCE DIFFERENT PROG NAMES                   
         BNE   PNAMOK              IF NUMBER OF WEEKS DIFFERS                   
         CLC   INTPNAM,PREVPNAM                                                 
         BNE   PNAMOK                                                           
         MVC   INTPNAM+13(1),DRHIQHR+1                                          
         OI    INTPNAM+13,X'F0'                                                 
PNAMOK   MVC   PREVSQH,INTSQH                                                   
         MVC   PREVPNAM,INTPNAM                                                 
         CLI   DRHIQHR+1,2                                                      
         BL    *+8                                                              
         OI    INTWEEKS,B'00100000' SET TYPICAL                                 
         B     EXIT                                                             
         EJECT                                                                  
SETKEY   NTR1                                                                   
         L     R6,AIREC                                                         
         USING DRKEY,R6                                                         
         LA    R6,4(R6)                                                         
         MVI   INTRTYP,C'R'                                                     
         MVI   DRCODE,C'R'                                                      
         MVC   INTBOOK,FILTBOOK+1                                               
         MVC   DRBOOK,INTBOOK                                                   
         MVI   DRMEDIA,C'C'                                                     
         MVI   DRSRC,C'A'                                                       
         MVC   DRSTAT,INTSTA                                                    
         TM    INTSTYP,X'20'                                                    
         BZ    *+14                SET FOR SPILL STATION                        
         MVC   DRKMKT,INTMRKT                                                   
         MVI   INTSPILL,C'Y'                                                    
         MVC   DRSTYP,INTSTYP      SET STATYP IN KEY                            
         MVI   INTSTYP,0           SET STATYP TO ZERO FOR OUTPUT PHASE          
         MVC   DRBOOK,INTBOOK                                                   
         CLI   STASW,1             CREAT 'M' RECORD SWITCH                      
         BE    SETKEY3                                                          
         MVC   DRHIGHD,INTDAY                                                   
         MVC   DRHIQHR,INTSQH                                                   
         ZIC   RF,INTWEEKS                                                      
         SR    RE,RE                                                            
         SLL   RF,28                                                            
         LA    R0,4                                                             
         LA    R1,0                                                             
SETKEY2  SLDL  RE,1                                                             
         LTR   RE,RE                                                            
         BZ    *+10                                                             
         LA    R1,1(R1)                                                         
         SR    RE,RE               CLEAR WEEK INDICATOR                         
         BCT   R0,SETKEY2                                                       
         STC   R1,DRHIQHR+1                                                     
         MVC   DRHIQHR+6,INTWEEKS                                               
         MVC   DRHIQHR+2(4),SITOTVWR                                            
         B     SETKEYX                                                          
         SPACE 2                                                                
SETKEY3  MVI   DRCODE,C'M'                                                      
         MVI   INTRTYP,C'M'                                                     
         B     SETKEYX                                                          
SETKEYX  XIT1                                                                   
         EJECT                                                                  
FLTMKT   SR    RF,RF                                                            
         MVI   PASSFLT,C'Y'                                                     
         ICM   RF,1,FILTMRKT                                                    
         BZR   RE                                                               
         OC    HALF,HALF                                                        
         BZR   RE                                                               
         LA    R1,FILTMRKT+1                                                    
         CLC   HALF,0(R1)                                                       
         BER   RE                                                               
         LA    R1,L'INTMRKT(R1)                                                 
         BCT   RF,*-12                                                          
         MVI   PASSFLT,C'N'                                                     
         BR    RE                                                               
         EJECT                                                                  
*                                                                               
* ASK OPERATOR FOR MORE INPUT                                                   
*                                                                               
MORET    DS    0H'0'                                                            
ENDJOB   CLOSE (IN1,REWIND)                                                     
         MVI   INTAPESW,X'02'                                                   
EXIT     XMOD1 1                                                                
         LTORG                                                                  
         EJECT                                                                  
PS1E     EQU   1                                                                
PARENTE  EQU   2                                                                
PS2E     EQU   4                                                                
S1EQU    EQU   8                                                                
S2EQU    EQU   16                                                               
OUTMARE  EQU   32                                                               
CANMARE  EQU   64                                                               
METROA   EQU   1                                                                
METROB   EQU   2                                                                
GLOBIND  EQU   4                                                                
         EJECT                                                                  
PASSFLT  DC    X'00'                                                            
PREVQH   DC    X'00'                                                            
HAV2WH   DC    X'00'                                                            
NFRST    DC    X'01'                                                            
NPRES    DC    X'00'                                                            
FRST     DC    X'01'                                                            
RELOFRST DC    X'01'                                                            
BYPREAD  DC    X'00'                                                            
STASW    DC    X'00'                                                            
PREVSTYP DS    CL1                                                              
PREVSTAT DS    CL5                                                              
SVSTAT   DS    CL6                                                              
SVEQH    DS    CL1                                                              
PREVSQH  DS    CL1                                                              
PREVPNAM DS    CL14                                                             
         DS    0F                                                               
SIREC    DS    0C                                                               
SIRECST  DS    0C                                                               
SIRVO2   DS    F                  RV2+                                          
SISVO2   DS    F                  SV2+                                          
SIRVO18  DS    F                  RV18+                                         
SIRWTOT  DS    F                  RW18+                                         
SIRW1849 DS    F                  RW1849                                        
SIRW2554 DS    F                  RW2554                                        
SIRMTOT  DS    F                  RM18+                                         
SIRM1849 DS    F                  RM1849                                        
SIRM2554 DS    F                  RM2554                                        
SIRTNTOT DS    F                  RV1217                                        
SIRKTOT  DS    F                  RV211                                         
SITOTVWR DS    F                  V2+                                           
SIVO18   DS    F                  V18+                                          
SIV1849  DS    F                  V1849                                         
SIV2554  DS    F                  V2554                                         
SIWTOT   DS    F                  W18+                                          
SIW2554  DS    F                  W2554                                         
SIW1849  DS    F                  W1849                                         
SIW1834  DS    F                  W1834                                         
SIMTOT   DS    F                  M18+                                          
SIM2554  DS    F                  M2554                                         
SIM1849  DS    F                  M1849                                         
SIM1834  DS    F                  M1834                                         
SITNTOT  DS    F                  V1217                                         
SIKTOT   DS    F                  V211                                          
SIEVO2   DS    F                  REV2+                                         
SISEVO2  DS    F                  SEV2+                                         
SIEVO18  DS    F                  REV18+                                        
SIEV2554 DS    F                  REV2554                                       
SIEV1849 DS    F                  REV1849                                       
SIEV1834 DS    F                  REV1834                                       
SIEWO18  DS    F                  REW18+                                        
SIEW2554 DS    F                  REW2554                                       
SIEW1849 DS    F                  REW1849                                       
SIEW1834 DS    F                  REW1834                                       
SIEMO18  DS    F                  REM18+                                        
SIEM2554 DS    F                  REM2554                                       
SIEM1849 DS    F                  REM1849                                       
SIEM1834 DS    F                  REM1834                                       
SIEV1217 DS    F                  REV1217                                       
SIEV211  DS    F                  REV2-11                                       
SIUNIVS  DS    0CL(14*4)                                                        
SIUV211  DS    F                  UV2-11                                        
SIUV1217 DS    F                  UV1217                                        
SIUM1824 DS    F                  UM1824                                        
SIUM2534 DS    F                  UM2534                                        
SIUM3549 DS    F                  UM3549                                        
SIUM5054 DS    F                  UM5054                                        
SIUM5559 DS    F                  UM5559                                        
SIUMO60  DS    F                  UM60+                                         
SIUW1824 DS    F                  UW1824                                        
SIUW2534 DS    F                  UW2534                                        
SIUW3549 DS    F                  UW3549                                        
SIUW5054 DS    F                  UW5054                                        
SIUW5559 DS    F                  UW5559                                        
SIUWO60  DS    F                  UW60+                                         
SIRECEN  DS    0C                                                               
SIRECLN  EQU   SIRECEN-SIRECST                                                  
HOMESTA  DS    CL200                                                            
STALIST  DS    CL200                                                            
SAVUNIV  DS    CL(14*4)                                                         
         EJECT                                                                  
* COLUMN LINK TABLE                                                             
COLLINK  DC    X'81',AL3(SIRVO2-SIREC)       RV2+                               
         DC    X'82',AL3(SISVO2-SIREC)       SV2+                               
         DC    X'83',AL3(SIRVO18-SIREC)      RV18+                              
         DC    X'84',AL3(SIRWTOT-SIREC)      RW18+                              
         DC    X'85',AL3(SIRW1849-SIREC)     RW1849                             
         DC    X'86',AL3(SIRW2554-SIREC)     RW2554                             
         DC    X'87',AL3(SIRMTOT-SIREC)      RM18+                              
         DC    X'88',AL3(SIRM1849-SIREC)     RM1849                             
         DC    X'89',AL3(SIRM2554-SIREC)     RM2554                             
         DC    X'8A',AL3(SIRTNTOT-SIREC)     RV1217                             
         DC    X'8B',AL3(SIRKTOT-SIREC)      RV211                              
         DC    X'0C',AL3(SITOTVWR-SIREC)     V2+                                
         DC    X'0D',AL3(SIVO18-SIREC)       V18+                               
         DC    X'0E',AL3(SIV1849-SIREC)      V1849                              
         DC    X'0F',AL3(SIV2554-SIREC)      V2554                              
         DC    X'10',AL3(SIWTOT-SIREC)       W18+                               
         DC    X'11',AL3(SIW1834-SIREC)      W1834                              
         DC    X'12',AL3(SIW1849-SIREC)      W1849                              
         DC    X'13',AL3(SIW2554-SIREC)      W2554                              
         DC    X'14',AL3(SIMTOT-SIREC)       M18+                               
         DC    X'15',AL3(SIM1834-SIREC)      M1834                              
         DC    X'16',AL3(SIM1849-SIREC)      M1849                              
         DC    X'17',AL3(SIM2554-SIREC)      M2554                              
         DC    X'18',AL3(SITNTOT-SIREC)      V1217                              
         DC    X'19',AL3(SIKTOT-SIREC)       V211                               
         DC    X'1A',AL3(0)                  EM/TC RATIO (NOT USED)             
         DC    X'1B',AL3(0)                                                     
         DC    X'1C',AL3(0)                                                     
         DC    X'1D',AL3(0)                                                     
         DC    X'1E',AL3(0)                                                     
         DC    X'1F',AL3(0)                                                     
         DC    X'20',AL3(0)                                                     
         DC    X'A1',AL3(SIEVO2-SIREC)       REV2+                              
         DC    X'A2',AL3(SISEVO2-SIREC)      SEV2+                              
         DC    X'A3',AL3(SIEVO18-SIREC)      REV18+                             
         DC    X'A4',AL3(SIEV1834-SIREC)     REV1834                            
         DC    X'A5',AL3(SIEV1849-SIREC)     REV1849                            
         DC    X'A6',AL3(SIEV2554-SIREC)     REV2554                            
         DC    X'A7',AL3(SIEWO18-SIREC)      REW18+                             
         DC    X'A8',AL3(SIEW1834-SIREC)     REW1834                            
         DC    X'A9',AL3(SIEW1849-SIREC)     REW1849                            
         DC    X'AA',AL3(SIEW2554-SIREC)     REW2554                            
         DC    X'AB',AL3(SIEMO18-SIREC)      REM18+                             
         DC    X'AC',AL3(SIEM1834-SIREC)     REM1834                            
         DC    X'AD',AL3(SIEM1849-SIREC)     REM1849                            
         DC    X'AE',AL3(SIEM2554-SIREC)     REM2554                            
         DC    X'AF',AL3(SIEV1217-SIREC)     REV1217                            
         DC    X'B0',AL3(SIEV211-SIREC)      REV2-11                            
         DC    X'B1',AL3(0)                  IEV2+ (NOT USED)                   
         DC    100X'00'                                                         
         EJECT                                                                  
HOMEMKT  DS    0C                  HOME MARKET TABLE                            
         DC    AL2(0009),C'CBNT '  ST JOHNS CMA                                 
         DC    AL2(0009),C'CJON+'                                               
         DC    AL2(0009),C'CJON '                                               
         DC    AL2(0041),C'CBYT '  CORNRBR C.AREA                               
         DC    AL2(0041),C'CJWN '                                               
         DC    AL2(0060),C'CJCN '  CD6                                          
         DC    AL2(1021),C'CBCT '  CHARTWN C.AREA                               
         DC    AL2(1031),C'ASN  '  ATLANTIC                                     
         DC    AL2(1031),C'ATV+ '                                               
         DC    AL2(2009),C'CBIT '  SYD-GLAC,SYD-M **PR NOV/84**                 
         DC    AL2(2009),C'CJCB '                                               
         DC    AL2(2010),C'CBIT '  CAPE BRETON **EFF NOV/84**                   
         DC    AL2(2010),C'CJCB '                                               
         DC    AL2(2079),C'CJCH '  HALIFAX,CMA ** PR NOV/84**                   
         DC    AL2(2079),C'CBHT '                                               
         DC    AL2(2080),C'CJCH '  HALIFAX CO **EFF NOV/84**                    
         DC    AL2(2080),C'CBHT '                                               
         DC    AL2(2080),C'CIHF '                                               
         DC    AL2(3011),C'CBAF '  STJN-MON C.AREA                              
         DC    AL2(3011),C'CBAFT'                                               
         DC    AL2(3011),C'CBAT '                                               
         DC    AL2(3011),C'CHSJ '                                               
         DC    AL2(3011),C'CKCW '                                               
         DC    AL2(3011),C'WLBZ '                                               
         DC    AL2(3011),C'WVII '                                               
         DC    AL2(3111),C'CHAU '  CARLTON C.AREA                               
         DC    AL2(3111),C'CIVK '                                               
         DC    AL2(4041),C'CBGAT'  MATANE C.AREA                                
         DC    AL2(4041),C'CIVF '                                               
         DC    AL2(4061),C'R-CAN'  RIM+MAT C.AREA                               
         DC    AL2(4061),C'CFER '                                               
         DC    AL2(4061),C'CJBR '                                               
         DC    AL2(4061),C'CJBRT'                                               
         DC    AL2(4071),C'CIVB '  RIMOUSK C.AREA                               
         DC    AL2(4091),C'CBST ' SEPT ILES EM                                  
         DC    AL2(4091),C'CIVG '                                               
         DC    AL2(4101),C'CIMT '  RIVLOUP C.AREA                               
         DC    AL2(4101),C'CKRT '                                               
         DC    AL2(4101),C'CFTF '                                               
* ****   DC    AL2(4119),C'CKRS '  CHICOUTI-JONQU                               
*        DC    AL2(4119),C'CJMP '                                               
*        DC    AL2(4119),C'CJPM '                                               
* ****   DC    AL2(4119),C'CBJET'                                               
         DC    AL2(4120),C'CFRS '  CHICOUTI-JONQU                               
         DC    AL2(4120),C'CJPM '                                               
         DC    AL2(4120),C'CKRS '                                               
         DC    AL2(4120),C'CIVV '                                               
         DC    AL2(4119),C'CJPM '                                               
         DC    AL2(4119),C'CKRS '                                               
         DC    AL2(4199),C'CBVT '  QUEBEC CMA                                   
         DC    AL2(4199),C'CFCM '                                               
         DC    AL2(4199),C'CIVQ '                                               
         DC    AL2(4199),C'CKMI '                                               
         DC    AL2(4199),C'CFAP '                                               
         DC    AL2(4351),C'CFKS '  SHERBRK C.AREA                               
         DC    AL2(4351),C'CHLT '                                               
         DC    AL2(4351),C'CIVS '                                               
         DC    AL2(4351),C'CKSH '                                               
         DC    AL2(4479),C'CBFT+'  MONTREAL CMA                                 
         DC    AL2(4479),C'CBFT '                                               
         DC    AL2(4479),C'CBMT+'                                               
         DC    AL2(4479),C'CBMT '                                               
         DC    AL2(4479),C'CFAP '                                               
         DC    AL2(4479),C'CFCF '                                               
         DC    AL2(4479),C'CFJP '                                               
         DC    AL2(4479),C'CFJP+'                                               
         DC    AL2(4479),C'CFTM '                                               
         DC    AL2(4479),C'CIVM '                                               
         DC    AL2(4479),C'CJPC '                                               
         DC    AL2(4479),C'WCFE '                                               
         DC    AL2(4479),C'WETK '                                               
*        DC    AL2(4479),C'WCAX '                                               
         DC    AL2(9760),C'WCAX '  US MARKET                                    
*        DC    AL2(4479),C'WPTZ '                                               
         DC    AL2(9760),C'WPTZ '  US MARKET                                    
*        DC    AL2(4479),C'WVNY '                                               
         DC    AL2(9760),C'WVNY '  US MAREKT                                    
         DC    AL2(4661),C'CFKM '  TR RIV. C.AREA                               
         DC    AL2(4661),C'CHEM '                                               
         DC    AL2(4661),C'CIVC '                                               
         DC    AL2(4661),C'CKTM '                                               
         DC    AL2(4667),C'CHLT+'  SHER-TR RIV EM                               
         DC    AL2(4667),C'CKTM+'                                               
         DC    AL2(4667),C'R-QUE'                                               
         DC    AL2(4723),C'CFEM '  ROUYN EM                                     
         DC    AL2(4723),C'CFVS '                                               
         DC    AL2(4723),C'CIVN+'                                               
         DC    AL2(4723),C'CKRN '                                               
         DC    AL2(5069),C'CBOFT'  OTTAWA CMA                                   
         DC    AL2(5069),C'CBOT '                                               
         DC    AL2(5069),C'CFGS '                                               
         DC    AL2(5069),C'CHOT '                                               
         DC    AL2(5069),C'CIVO '                                               
         DC    AL2(5069),C'CJOH '                                               
         DC    AL2(5069),C'CHRO '                                               
*        DC    AL2(5075),C'     '  CKNC SPECIAL                                 
*        DC    AL2(5075),C'CHRO '                                               
         DC    AL2(5109),C'CKWS '  KINGSTON CA                                  
*        DC    AL2(5109),C'WWNY '                                               
         DC    AL2(5109),C'WWTI '                                               
         DC    AL2(5145),C'CECO '  EAST CENTRAL ONTARIO                         
         DC    AL2(5159),C'CHEX '  PETERBOROUGH CA                              
*        DC    AL2(5159),C'WHEC '                                               
         DC    AL2(9765),C'WHEC '  US MARKET                                    
*        DC    AL2(5159),C'WROC '                                               
         DC    AL2(5199),C'CBLFT'  TORONTO CMA                                  
         DC    AL2(5199),C'CBLT '                                               
         DC    AL2(5199),C'CFMT '                                               
         DC    AL2(5199),C'CFTO '                                               
         DC    AL2(5199),C'CHCH '                                               
         DC    AL2(5199),C'CICO '                                               
         DC    AL2(5199),C'CITY '                                               
         DC    AL2(5199),C'WGRZ '                                               
         DC    AL2(5199),C'WIVB '                                               
         DC    AL2(5199),C'WKBW '                                               
         DC    AL2(5199),C'WNED '                                               
*        DC    AL2(5199),C'WUTV '                                               
         DC    AL2(9762),C'WUTV '  US MARKET                                    
         DC    AL2(5243),C'CKVR '  BARRIE C.AREA                                
         DC    AL2(5269),C'     '  HAMILTON CMA                                 
*    **********************************************                             
*        DC    AL2(5336),C'CFPL '  KITCH-LONDON EM                              
*        DC    AL2(5336),C'CKCO '                                               
*        DC    AL2(5336),C'CKNX '                                               
*        DC    AL2(5336),C'WICU '                                               
*        DC    AL2(5336),C'WJET '                                               
*        DC    AL2(5336),C'WSEE '                                               
*    ***********************************************                            
         DC    AL2(5339),C'CKCO '  KITCHENER CMA                                
         DC    AL2(5369),C'CKNX '  LONDON CMA                                   
         DC    AL2(5369),C'CBLN '                                               
         DC    AL2(5369),C'CFPL '                                               
         DC    AL2(5369),C'CFPL+'                                               
         DC    AL2(5369),C'WICU '                                               
         DC    AL2(5369),C'WJET '                                               
         DC    AL2(5369),C'WSEE '                                               
         DC    AL2(5369),C'WUAB '                                               
         DC    AL2(5409),C'CBET '  WINDSOR CMA                                  
         DC    AL2(5409),C'CBEFT'                                               
         DC    AL2(5409),C'WDIV '                                               
         DC    AL2(5409),C'WJBK '                                               
         DC    AL2(5409),C'WKBD '                                               
         DC    AL2(5409),C'WXYZ '                                               
         DC    AL2(5409),C'WXON '                                               
         DC    AL2(5441),C'     '  WINGHAM C.AREA                               
*        DC    AL2(5461),C'CBFST'  SUD-TIMMIN-N B                               
*        DC    AL2(5461),C'CKSO+'                                               
*        DC    AL2(5461),C'MCTVS'                                               
*        DC    AL2(5461),C'CBLFT'                                               
         DC    AL2(5469),C'     '  NORTH BAY CA                                 
         DC    AL2(5479),C'CBFST'  SUDBURY 8011                                 
         DC    AL2(5479),C'CICI+'                                               
         DC    AL2(5479),C'CKNC+'                                               
         DC    AL2(5499),C'     '  TIMMINS C                                    
*        DC    AL2(5499),C'CKGN '                                               
         DC    AL2(5531),C'CHBX '  ALGOMA WEST                                  
         DC    AL2(5531),C'CJIC '                                               
         DC    AL2(5531),C'CKCY '                                               
         DC    AL2(5531),C'WJRT '                                               
         DC    AL2(5531),C'WKBD '                                               
         DC    AL2(5531),C'WNEM '                                               
         DC    AL2(5531),C'WWUP '                                               
         DC    AL2(5539),C'CHFD '  THUNDER BAY                                  
         DC    AL2(5539),C'CKPR '                                               
         DC    AL2(5539),C'KBJR '                                               
         DC    AL2(5539),C'KDLH '                                               
         DC    AL2(5539),C'WDIO '                                               
         DC    AL2(5565),C'CJBN '  KENORA                                       
         DC    AL2(6061),C'CKX  '  BRANDON C AREA                               
         DC    AL2(6119),C'CBWT '  WINNIPEG CMA                                 
         DC    AL2(6119),C'CBWFT'                                               
         DC    AL2(6119),C'CHMI '                                               
         DC    AL2(6119),C'CKND '                                               
         DC    AL2(6119),C'CKY  '                                               
*        DC    AL2(6119),C'KTHT '                                               
         DC    AL2(6119),C'KXJB '                                               
         DC    AL2(6119),C'WDAZ '                                               
         DC    AL2(6119),C'KTHI '                                               
         DC    AL2(7011),C'CICC '  YORKTON C.AREA                               
         DC    AL2(7011),C'CKOS '                                               
         DC    AL2(7045),C'CJFB '  CD4,CD8 (SWIFT CURRENT)                      
         DC    AL2(7071),C'CBKFT'  REG-MOOS CAREA                               
         DC    AL2(7071),C'CBKT '                                               
         DC    AL2(7071),C'CFRE '                                               
         DC    AL2(7071),C'CKCK '                                               
         DC    AL2(7071),C'KUMV '                                               
         DC    AL2(7109),C'CBKST'  SASKATOON CMA                                
         DC    AL2(7109),C'CFQC '                                               
         DC    AL2(7109),C'CFSK '                                               
         DC    AL2(7109),C'KXMD '                                               
         DC    AL2(7153),C'CKBI '  PR ALBER C.AREA                              
         DC    AL2(7153),C'CIPA '                                               
         DC    AL2(8010),C'CHAT '  MEDICINE HAT                                 
         DC    AL2(8010),C'KFBB '                                               
         DC    AL2(8020),C'CJOC '  CD2                                          
         DC    AL2(8069),C'CBRT '  CALGARY CMA                                  
         DC    AL2(8069),C'CFAC.'                                               
         DC    AL2(8069),C'CFAC '                                               
         DC    AL2(8069),C'CKKX ' ....NEW CFAC                                  
         DC    AL2(8069),C'CICT ' ....NEW CKKX                                  
         DC    AL2(8069),C'CFCN '                                               
         DC    AL2(8080),C'CKRD '  RED DEER                                     
         DC    AL2(8078),C'CKRD '  RED DEER 8011                                
         DC    AL2(8091),C'CITL '  LLOYDMIN C AREA                              
         DC    AL2(8091),C'CKSA '                                               
         DC    AL2(8119),C'CBXFT'  EDMONTON CMA                                 
         DC    AL2(8119),C'CBXT '                                               
         DC    AL2(8119),C'CFRN '                                               
         DC    AL2(8119),C'CITV '                                               
*        DC    AL2(8119),C'KHQ  '                                               
         DC    AL2(9763),C'KHQ  '                                               
         DC    AL2(8119),C'KREM '                                               
*        DC    AL2(8119),C'KXLY '  CHANGED TO 9763 MAR/96                       
         DC    AL2(9071),C'CHBC+'  OKAN-KAM CAREA                               
         DC    AL2(9071),C'CFJC+'                                               
         DC    AL2(9109),C'CBUT '  VANCOUVER CMA                                
         DC    AL2(9109),C'CBUFT'                                               
         DC    AL2(9109),C'CHAN '                                               
         DC    AL2(9109),C'CHEK '                                               
         DC    AL2(9109),C'CIVT '                                               
         DC    AL2(9109),C'CKVU '                                               
         DC    AL2(9109),C'KCPQ '                                               
         DC    AL2(9109),C'KCTS '                                               
         DC    AL2(9109),C'KOMO '                                               
         DC    AL2(9109),C'KSTW '                                               
         DC    AL2(9109),C'KVOS '                                               
         DC    AL2(9119),C'     '  VICTORIA CMA                                 
         DC    AL2(9119),C'KSTW '                                               
         DC    AL2(9301),C'CFTK '  TER-KIT C.AREA                               
         DC    AL2(9341),C'CKPG+'  PR G/TK C.AREA                               
         DC    AL2(9350),C'CKPG '  FRASER-FT GEOR                               
         DC    AL2(9350),C'KING '                                               
         DC    AL2(9350),C'KIRO '                                               
         DC    AL2(9351),C'CKPG '                                               
         DC    AL2(9351),C'KING '                                               
         DC    AL2(9351),C'KIRO '                                               
         DC    AL2(9363),C'CJDC '  DAWSON CREEK                                 
*>>960604DC    AL2(9710),C'CKBI '  BBS SASK. NETWORK RPT                        
         DC    AL2(9710),C'BBS  '                                               
         DC    AL2(9763),C'KAYU '  CALGARY US FC                                
         DC    AL2(9763),C'KXLY '  CALGARY US FC                                
         DC    AL2(9764),C'WWNY '  US MARKET                                    
         DC    AL2(9802),C'CBC  '  MARITIME                                     
         DC    X'FFFF'                                                          
         EJECT                                                                  
M2RECA   DS    424C                                                             
NSIBOOKY DS    CL1                                                              
NSIBOOKM DS    CL1                                                              
IREC     DS    424C                                                             
IN1      DCB   DDNAME=IN1,                                             X        
               DSORG=PS,                                               X        
               RECFM=VB,                                               X        
               LRECL=0424,                                             X        
               BLKSIZE=28000,                                          X        
               MACRF=GM,                                               X        
               EODAD=MORET                                                      
IN1A     DS    32000C                                                           
         DS    D                                                                
         EJECT                                                                  
       ++INCLUDE DEDEMCNVD                                                      
       ++INCLUDE DEINTD                                                         
       ++INCLUDE DEINTTPTD                                                      
       ++INCLUDE DEDEMFILE                                                      
* DDDPRINT                                                                      
       ++INCLUDE DDDPRINT                                                       
*                                                                               
* DMIDEMFILE                                                                    
       ++INCLUDE DMIDEMFILE                                                     
         EJECT                                                                  
         EJECT                                                                  
         TITLE                     'BBM TAPE FORMAT NOV/78'                     
BBMCAD   DSECT                                                                  
CAIOCS   DS    CL4                 IOCS - MARKET RECORD                         
CAMRKT   DS    CL2                 MARKET NUMBER                                
CAID     DS    CL4                 RECORD IDENTIFIER = 0                        
CAMNAME  DS    CL18                MARKET NAME                                  
CAID2    DS    CL4                 RECORD IDENTIFIER = 0                        
CAUNIV   DS    CL(14*4)                                                         
         SPACE 2                                                                
BBMCDD   DSECT                                                                  
CDIOCS   DS    CL4                 IOCS - CLUMN DESCRIPTIOR RECORD              
CDMRKT   DS    CL2                 MARKET NUMBER                                
CDID     DS    CL4                 RECORD IDENTIFIER - 1                        
CDCOL    DS    CL1                 COLUMN NUMBER                                
CDTYP    DS    CL1                 TYPE OF COLUMN                               
*                                   BIT 1 - AVERAGE QUATER HOUR COLUMN          
*                                   BIT 2 - DIVIDE BY ALL STATIONS              
*                                   BIT 3 - DIVIDE BY POPULATION                
*                                   BIT 4 - DIVIDE BY NO OF QH                  
*                                   BIT 5 - BASED ON IMP=1,REACH=0              
*                                   BIT 6 - IN-HOME                             
*                                   BIT 7 - OUT OF HOME                         
*                                   BIT 8 - 0=CENTRAL AREA COLUMN               
*                                           1=TOTAL SURVEY AREA COLUMN          
         DS    CL20                JUNK                                         
CDCA     DS    CL4                 CA POP IF STANDARD AUDIENCES                 
         SPACE 2                                                                
BBMDTAD  DSECT                                                                  
D8IOCS   DS    CL4                 IOCS - DATA RECORD                           
D8MRKT   DS    CL2                 MARKET NUMBER                                
D8SCODE  DS    CL2                 STATION CODE                                 
D8LINE   DS    CL2                 LINE NUMBER - GT. 1                          
D8GROUP  DS    CL2                 GROUP INDICATOR                              
D8REF    DS    CL2                 REFERENCE NUMBER                             
D8SREF   DS    CL1                 SUB-REFERENCE                                
D8STAN   DS    CL1                 STANDARD GROUP INDICATOR                     
D8WEEK   DS    CL1                 WEEK MASK                                    
D8DAYS   DS    CL1                 DAYS - MON=X'10'                             
D8SQH    DS    CL1                 START QUARTER HOUR                           
D8EQH    DS    CL1                 END QUARTER HOUR                             
D8PCOD   DS    CL2                 PROGRAM CODE                                 
D8PNAM   DS    CL16                PROGRAM NAME                                 
D8CALL   DS    CL6                 STATION CALL LETTERS                         
D8NOQH   DS    CL2                 NUMBER OF QHR  QH X DAY                      
D8NOCOL  DS    CL2                 NUMBER OF DATA COLUMNS                       
D8COLMSK DS    CL8                 COLUMN MASK                                  
D8DATA   DS    0C                  START OF DATA                                
         SPACE 2                                                                
DATAD    DSECT                                                                  
D8COLNUM DS    CL1                 COLUMN NUMBER                                
D8VALUE  DS    CL3                 DEMOGRAPHIC VALUE                            
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'033DEDETB921005/01/02'                                      
         END                                                                    
