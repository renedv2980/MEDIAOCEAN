*          DATA SET CTDFSEC    AT LEVEL 056 AS OF 07/24/19                      
*PHASE CTDSECA                                                                  
*INCLUDE BINSRCH2                                                               
*INCLUDE CARDS                                                                  
*INCLUDE CHOPPER                                                                
*&&US                                                                           
*INCLUDE CLUNPK                                                                 
*INCLUDE OFFICER                                                                
*&&                                                                             
*INCLUDE PQPROF                                                                 
*INCLUDE CUREDIT                                                                
*INCLUDE DATCON                                                                 
*INCLUDE GETDAY                                                                 
*INCLUDE DATVAL                                                                 
*INCLUDE DMDMGRL                                                                
*INCLUDE DMUTLCT                                                                
*INCLUDE DICTATE                                                                
*INCLUDE FAGETTXT                                                               
*INCLUDE FATABOFF                                                               
*INCLUDE HELEN                                                                  
*INCLUDE HELLO                                                                  
*INCLUDE HEXIN                                                                  
*INCLUDE HEXOUT                                                                 
*INCLUDE DMPRTQB                                                                
*INCLUDE DMPRTQB2                                                               
*INCLUDE PRINT                                                                  
*INCLUDE PRINTERL                                                               
*INCLUDE SCANNER                                                                
*INCLUDE SORTER                                                                 
*INCLUDE SQUASHER                                                               
*INCLUDE UNTIME                                                                 
*INCLUDE XSORT                                                                  
         EJECT                                                                  
         TITLE 'SECURITY DAILY ACTIVITY REPORT'                                 
         PRINT NOGEN                                                            
SECDFA   START                                                                  
         ENTRY SSB                                                              
         ENTRY MASTC                                                            
         NBASE WORKL,*SECDFA*,VREGSVE,CLEAR=YES                                 
         USING WORKD,RC            LOCAL W/S                                    
         L     RA,ACOMMON                                                       
         USING COMMON,RA                                                        
         L     R9,VCPRINT                                                       
         USING DPRINT,R9                                                        
         L     R8,VBOXAREA                                                      
         USING BOXD,R8                                                          
         ST    RD,SAVERD                                                        
         BRAS  RE,INIT             INITIALISE                                   
*                                                                               
         BRAS  RE,READFILE         READ INPUT FILE/FILTER/ADD TO SORT           
         BNE   MAIN02                                                           
         BRAS  RE,PROCRECS         PROCESS OUTPUT FROM SORT                     
*                                                                               
MAIN02   GOTO1 VSORTER,PLIST,END   END SORT                                     
         B     XBASE               THAT'S ALL FOLKS                             
*                                                                               
VREGSVE  DC    V(REGSAVE)                                                       
ACOMMON  DC    A(COMMON)                                                        
         EJECT                                                                  
***********************************************************************         
* INITIALISATION                                                      *         
***********************************************************************         
INIT     NTR1  BASE=*,LABEL=*                                                   
         MVI   GOTERR,C'N'                                                      
         OI    DDPDDCTL,BOXDDREQ+BOXDDLC                                        
         MVI   COLSMAX,132         SO WE MUST SET COLUMNS BACK TO 132           
         ZAP   MAXLINE,PPAGESIZ                                                 
         MVI   DDPSYS,10           CONTROL                                      
         MVI   DDPLANG,0           INITIALLY DEFAULT LANGUAGE                   
         ICM   RF,15,AMASTC                                                     
         MVC   MCLANG-MASTC(,RF),DDPLANG                                        
         MVC   MCSYSTEM-MASTC(,RF),=C'CT'                                       
*                                                                               
*&&US*&& OI    OUTTYPE,PPSAGNLY    US DEFAULTS TO PPS AGENCIES ONLY             
*                                                                               
         MVC   LODATTIM,EFFS                                                    
         XC    HIDATTIM,HIDATTIM                                                
*                                                                               
         LA    R0,PBLOCK           CLEAR PBLOCK TO SPACES                       
         L     R1,=A(PBLOCKL)                                                   
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
*                                                                               
         LHI   RF,ELADDS-WORKD     SET NON-ADDRESSABLES                         
         AR    RF,RC                                                            
         ST    RF,AELADDS                                                       
         LHI   RF,SCANTAB-WORKD                                                 
         AR    RF,RC                                                            
         ST    RF,ASCANTAB                                                      
         LHI   RF,ATAB-WORKD                                                    
         AR    RF,RC                                                            
         ST    RF,AATAB                                                         
*                                                                               
         MVC   TITLE,VCTITLE                                                    
         BRAS  RE,GETCARD          GET ALL INPUT CARDS INTO A BUFFER            
         BNE   XBASE                                                            
         BRAS  RE,VALCARD          VALIDATE INPUT CARDS FROM BUFFER             
         BNE   XBASE                                                            
*                                                                               
         BRAS  RE,OPENSYS          OPEN CONTROL FILE (IF REQUIRED)              
*                                                                               
         BRAS  RE,DICTATOR         RESOLVE TABLE DICTIONARY REFS                
*                                                                               
         TM    OUTTYPE,HARDONLY    IF PRINTING FOR USERS                        
         BO    *+8                                                              
         BRAS  RE,BLDPROFS         SETUP USER PROFILES                          
*                                                                               
         GOTO1 VSORTER,PLIST,SORTCARD,RECCARD,0                                 
         B     EXITOK                                                           
*                                                                               
VCTITLE  DC    CL(L'TITLE)'Input cards to security report'                      
         EJECT                                                                  
***********************************************************************         
* READ IN ALL INPUT CARDS                                             *         
* FORMAT INTO A SCANNER BLOCK AND SAVE FOR VALIDATION                 *         
***********************************************************************         
GETCARD  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ASCANTAB         SAVE IN SCANTAB FOR PROCESSING               
         USING SCANBLKD,R3                                                      
*                                                                               
GCD02    GOTO1 VCARDS,PLIST,CARDIO,=C'RE00'                                     
         CLI   CARDIO,C'*'         IGNORE COMMENTS                              
         BE    GCD02                                                            
         CLC   =C'/*',CARDIO       END OF CARDS?                                
         BE    EXITOK              YES                                          
*                                                                               
GCD04    GOTO1 VSCANNER,PLIST,(C'C',CARDIO),((R3))                              
         XR    RF,RF                                                            
         ICM   RF,1,4(R1)          RF=NUMBER OF INPUT PARAMETERS                
         BZ    GCD06                                                            
*                                                                               
         XR    R0,R0               INCREMENT NUMBER OF PARAMETERS               
         IC    R0,PARMCNT                                                       
         AR    R0,RF                                                            
         CHI   R0,PARMCNTQ                                                      
         BH    GCD06                                                            
         STC   R0,PARMCNT                                                       
*                                                                               
         MHI   RF,SCBLKLQ          GO TO NEXT FREE SLOT IN SCANTAB              
         AR    R3,RF                                                            
         B     GCD02                                                            
*                                                                               
GCD06    MVI   FERN,8              INVALID PARAMETER CARD                       
         BRAS  RE,ERRMSG                                                        
         B     EXITL                                                            
         EJECT                                                                  
***********************************************************************         
* VALIDATE PARAMETER CARDS IN SCANNER BLOCK (FROM GETCARD)            *         
***********************************************************************         
VALCARD  NTR1  BASE=*,LABEL=*                                                   
         XR    R2,R2                                                            
         ICM   R2,1,PARMCNT                                                     
         BNZ   VCD02                                                            
         MVI   OUTTYPE,DEFOUT      SET DEFAULT OUTPUT                           
         B     EXITOK                                                           
*                                                                               
VCD02    L     R3,ASCANTAB                                                      
         USING SCANBLKD,R3                                                      
*                                                                               
VCD04    XR    RF,RF               RECONSTRUCT INPUT PARAMETER                  
         IC    RF,SC1STLEN                                                      
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PBLOCK(0),SC1STFLD                                               
         LA    RE,PBLOCK+1(RF)                                                  
*                                                                               
         CLI   SC2NDLEN,0          ANY SECOND HALF TO PARAMETER                 
         BE    VCD06                                                            
         MVI   0(RE),C'='                                                       
         MVC   1(L'SC2NDFLD,RE),SC2NDFLD                                        
*                                                                               
VCD06    BRAS  RE,PRNT             PRINT RECONSTRUCTED PARAMETER                
*                                                                               
         L     R4,ACARDTAB         TABLE OF SUPPORTED PARAMETERS                
         USING CARDTABD,R4                                                      
         XR    RF,RF                                                            
         IC    RF,SC1STLEN         LENGTH OF PARAMETER                          
         BCTR  RF,0                                                             
*                                                                               
VCD08    CLI   0(R4),255           END OF TABLE?                                
         BNE   *+16                                                             
         MVI   FERN,13             FLAG UNKNOWN PARAMETER CARD                  
         BRAS  RE,ERRMSG                                                        
         B     VCD14                                                            
*                                                                               
         CLM   RF,1,CMIN           CHECK LENGTHS ARE OK                         
         BL    VCD10                                                            
         CLM   RF,1,CMAX                                                        
         BH    VCD10                                                            
         EX    RF,*+8              MATCH TEXT STRING                            
         BE    VCD12                                                            
         CLC   SC1STFLD(0),CARDTXT                                              
*                                                                               
VCD10    AHI   R4,CARDTABL         TRY NEXT ENTRY                               
         B     VCD08                                                            
*                                                                               
VCD12    ICM   RF,15,CARDVAL       GO AND VALIDATE THIS INPUT                   
         BASR  RE,RF                                                            
         BE    VCD14                                                            
         BRAS  RE,ERRMSG                                                        
*                                                                               
VCD14    AHI   R3,SCBLKLQ          NEXT LINE IN SCANTAB                         
         BCT   R2,VCD04            ANY MORE PARMS INPUT?                        
*                                                                               
         TM    OUTTYPE,ADDOUT+CHNGOUT+DELOUT+RESTOUT                            
         BNZ   *+8                                                              
         OI    OUTTYPE,DEFOUT      SET DEFAULT OUTPUT IF REQUIRED               
         ZAP   LINE,P99            FORCE PAGE THROW                             
*                                                                               
         CLI   RPTYPE,C'S'         IF NOT SECURITY REPORT                       
         BE    *+8                                                              
         CLI   RPTYPE,C'P'         AND NOT PROFILE REPORT                       
         BE    *+8                                                              
         OI    OUTTYPE,HARDONLY    FORCE NO USER COPIES                         
*                                                                               
         CLI   NULLDATE,0                                                       
         BNE   VCDX                                                             
         GOTO1 VDATCON,DMCB,(5,0),(0,NULLDATE),0                                
*                                                                               
VCDX     CLI   GOTERR,C'Y'         SET CC IN CASE OF ERROR                      
         BE    EXITL                                                            
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO PRINT ERROR MESSAGE                                      *         
***********************************************************************         
ERRMSG   NTR1  BASE=*,LABEL=*                                                   
         CLI   FERN,0                                                           
         BE    EXITOK                                                           
*                                                                               
         MVI   GOTERR,C'Y'         SET GOT AN ERROR                             
*                                                                               
         XR    RF,RF               INDEX INTO ERROR TABLE                       
         IC    RF,FERN                                                          
         BCTR  RF,0                                                             
         MHI   RF,EMSGL                                                         
         LA    RF,ERRTAB(RF)       RF = A(ERROR MESSAGE)                        
*                                                                               
         MVC   P,SPACES                                                         
         MVC   P(L'ERRHDR),ERRHDR                                               
         MVC   P+L'ERRHDR(EMSGL),0(RF)                                          
         GOTO1 VPRINTER                                                         
*                                                                               
         MVI   FERN,0              RESET ERROR NUMBER                           
         B     EXITOK                                                           
*                                                                               
ERRHDR   DC    C'*** ERROR - '                                                  
*                                                                               
EMSGL    EQU   50                  ERROR MESSAGE LENGTH                         
ERRTAB   DS    0X                                                               
ERR01    DC    CL(EMSGL)'Terminal Number Does Not Exist'                        
ERR02    DC    CL(EMSGL)'LUID Does Not Exist'                                   
ERR03    DC    CL(EMSGL)'User ID Does Not Exist'                                
ERR04    DC    CL(EMSGL)'Program Does Not Exist'                                
ERR05    DC    CL(EMSGL)'Invalid Record Type'                                   
ERR06    DC    CL(EMSGL)'Invalid Agency ID'                                     
ERR07    DC    CL(EMSGL)'Invalid Record Parameter'                              
ERR08    DC    CL(EMSGL)'Invalid Parameter Card'                                
ERR09    DC    CL(EMSGL)'Invalid Sort Card'                                     
ERR10    DC    CL(EMSGL)'Parameter Card Not Found'                              
ERR11    DC    CL(EMSGL)'User Name Not Found'                                   
ERR12    DC    CL(EMSGL)'Program Number is Not Valid'                           
ERR13    DC    CL(EMSGL)'Unknown Parameter Card'                                
ERR14    DC    CL(EMSGL)'Parameter has already been set'                        
ERR15    DC    CL(EMSGL)'User-Id must be a number'                              
ERR16    DC    CL(EMSGL)'Number entered is too big'                             
ERR17    DC    CL(EMSGL)'Terminal Number must be numeric'                       
ERR18    DC    CL(EMSGL)'Agency binary value must be numeric'                   
ERR19    DC    CL(EMSGL)'Record number is not valid'                            
ERR20    DC    CL(EMSGL)'Too many RECNUM cards'                                 
ERR21    DC    CL(EMSGL)'Invalid date'                                          
         EJECT                                                                  
***********************************************************************         
* OPEN FILES                                                          *         
***********************************************************************         
OPENSYS  NTR1  BASE=*,LABEL=*                                                   
         CLI   SYSOP,C'Y'          SYSOP FLAGS PRIOR OPEN                       
         BE    EXITOK                                                           
*                                                                               
         MVI   SYSOP,C'Y'                                                       
         GOTO1 VDMGR,DMCB,DMOPEN,DMSYS,DMFLIST                                  
         B     EXITOK                                                           
*                                                                               
DMFLIST  DC    C'NCTRCVR NCTFILE NGENDIR NGENFIL X'                             
         EJECT                                                                  
**********************************************************************          
* RESOLVE ALL DD REFERENCES FOR TABLES AS REQUIRED                   *          
**********************************************************************          
DICTATOR NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         ICM   R0,15,LLDICT                                                     
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,PLIST,(R0),ADCLIST,DSLISTL                              
*                                                                               
         L     R2,AADDTAB          FIRST RESOLVE RECORD TABLE                   
         USING ADDTABD,R2                                                       
DIC02    CLI   ADFILENM,255        END OF TABLE                                 
         BE    DIC06                                                            
         OC    ASUBDD,ASUBDD       DD REFERENCE DEFINED?                        
         BZ    DIC04               NO                                           
*                                                                               
         MVI   ADFILENM+0,DD#ESCL                                               
         MVC   ADFILENM+1(2),ASUBDD                                             
         MVI   ADFILENM+3,L'ADFILENM                                            
         ICM   R0,14,SLDD                                                       
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),ADFILENM,0                                    
*                                                                               
DIC04    AHI   R2,ADDTABLQ         NEXT                                         
         B     DIC02                                                            
         DROP  R2                                                               
*                                                                               
DIC06    L     R2,ACTELEMS         USE AL4 ELEMENT TABLE FOR A(HEADER)          
*                                                                               
DIC08    ICM   R3,15,0(R2)         A(NEXT ELEMENT HEADER)                       
         BZ    EXITOK              FINISHED                                     
         AHI   R3,CTFELEML                                                      
         USING CTESYS,R3           1ST IN V/L LISTS OF NAMES                    
*                                                                               
DIC10    OC    CTDDREF,CTDDREF     DD TO RESOLVE FOR THIS ENTRY?                
         BZ    DIC12                                                            
*                                                                               
         MVI   CTENAME+00,DD#ESCL                                               
         MVC   CTENAME+01(2),CTDDREF                                            
         MVI   CTENAME+03,L'CTENAME                                             
         ICM   R0,14,SLDD                                                       
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),CTENAME,0                                     
*                                                                               
DIC12    OC    CTESYS(2),CTESYS    LAST NAME FOR THIS ELEMENT                   
         BNZ   *+12                NO                                           
         LA    R2,4(R2)            A(NEXT ELEMENT)                              
         B     DIC08                                                            
         AHI   R3,CTFVARL          NEXT ENTRY IN ELEMENT                        
         B     DIC10                                                            
         DROP  R3                                                               
LLDICT   DC    CL2'LL',X'0A',C' '                                               
         EJECT                                                                  
**********************************************************************          
* VALIDATE LUID=XXXXXXXX PARAMETER                                   *          
* NTRY: R3     = A(SCANBLK)                                          *          
**********************************************************************          
         USING SCANBLKD,R3                                                      
VALUID   NTR1  BASE=*,LABEL=*                                                   
         MVC   V_LUID,SC2NDFLD     SAVE LUID INPUT                              
*                                                                               
         OC    V_TCODE,V_TCODE                                                  
         BZ    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         BRAS  RE,OPENSYS                                                       
*                                                                               
         L     R2,AIOTEMP                                                       
         USING CTTREC,R2                                                        
         XC    CTTKEY,CTTKEY                                                    
         MVI   CTTKTYP,CTTKTYPQ                                                 
         MVC   CTTKTID,SC2NDFLD                                                 
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,(R2),(R2)                               
         CLI   8(R1),0             TEST IF RECORD FOUND                         
         BE    *+12                                                             
         MVI   FERN,2              SET ERROR MESSAGE                            
         B     EXITL                                                            
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(3,(R2)),0,0,0,0                      
         CLI   12(R1),0                                                         
         BE    *+12                                                             
         MVI   FERN,2              SET ERROR MESSAGE                            
         B     EXITL                                                            
*                                                                               
         ICM   RF,15,12(R1)                                                     
         MVC   V_TCODE,2(RF)                                                    
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
**********************************************************************          
* VALIDATE TERMINAL=XXXX PARAMETER                                   *          
* NTRY: R3     = A(SCANBLK)                                          *          
**********************************************************************          
         USING SCANBLKD,R3                                                      
VALTRM   NTR1  BASE=*,LABEL=*                                                   
         OC    V_TCODE,V_TCODE                                                  
         BZ    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         TM    SC2NDVAL,SCNUMQ     NUMERIC?                                     
         BNZ   *+12                                                             
         MVI   FERN,17             PARAMETER MUST BE A NUMBER                   
         B     EXITL                                                            
*                                                                               
         ICM   R1,15,SC2NDNUM                                                   
         TMH   R1,X'FFFF'                                                       
         BZ    *+12                                                             
         MVI   FERN,16             NUMBER ENTERED IS TOO BIG                    
         B     EXITL                                                            
*                                                                               
         BRAS  RE,OPENSYS          OPEN CONTROL FILES IF REQUIRED               
*                                                                               
         L     R2,AIOTEMP                                                       
         USING CTTREC,R2                                                        
         XC    CTTKEY,CTTKEY                                                    
         MVI   CTTKTYP,CTTKTYPQ                                                 
         STH   R1,23(R2)                                                        
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,AIOTEMP,AIOTEMP                         
         CLI   8(R1),0             TEST RECORD FOUND                            
         BE    *+12                                                             
         MVI   FERN,1                                                           
         B     EXITL                                                            
*                                                                               
         MVC   V_TCODE,23(R2)      SAVE TERMINAL NUMBER TO FILTER               
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
**********************************************************************          
* VALIDATE DDSIO=                                                    *          
* NTRY: R3     = A(SCANBLK)                                          *          
**********************************************************************          
         USING SCANBLKD,R3                                                      
VALDDSIO NTR1  BASE=*,LABEL=*                                                   
         ICM   RF,15,VDDSIO                                                     
         MVC   0(8,RF),SC2NDFLD                                                 
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
**********************************************************************          
* VALIDATE RUN=                                                      *          
* NTRY: R3     = A(SCANBLK)                                          *          
**********************************************************************          
         USING SCANBLKD,R3                                                      
VALRUN   NTR1  BASE=*,LABEL=*                                                   
         MVC   RUNTYPE,SC2NDFLD                                                 
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
**********************************************************************          
* VALIDATE DSPACE=                                                   *          
* NTRY: R3     = A(SCANBLK)                                          *          
**********************************************************************          
         USING SCANBLKD,R3                                                      
VALDSPAC NTR1  BASE=*,LABEL=*                                                   
         ICM   RF,15,ASSB                                                       
         MVC   SSODSPAC-SSOOFF(L'SSODSPAC,RF),SC2NDFLD                          
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
**********************************************************************          
* VALIDATE USERNAME=XXXXXXXXXX PARAMETER                             *          
* NTRY: R3     = A(SCANBLK)                                          *          
**********************************************************************          
         USING SCANBLKD,R3                                                      
VALNID   NTR1  BASE=*,LABEL=*                                                   
         OC    V_USRID,V_USRID                                                  
         BZ    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         BRAS  RE,OPENSYS                                                       
*                                                                               
         L     R2,AIOTEMP                                                       
         USING CTIREC,R2                                                        
         XC    CTIKEY,CTIKEY                                                    
         MVI   CTIKTYP,CTIKTYPQ                                                 
         MVC   CTIKID,SC2NDFLD                                                  
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,AIOTEMP,AIOTEMP                         
         CLI   8(R1),0             TEST IF RECORD FOUND                         
         BE    *+12                                                             
         MVI   FERN,3                                                           
         B     EXITL                                                            
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(2,AIOTEMP),0,0,0,0                   
         CLI   12(R1),0            ELEMENT FOUND?                               
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         L     RF,12(R1)                                                        
         MVC   V_USRID,2(RF)                                                    
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
**********************************************************************          
* VALIDATE USERID = XXXX PARAMETER                                   *          
* NTRY: R3     = A(SCANBLK)                                          *          
**********************************************************************          
         USING SCANBLKD,R3                                                      
VALID    NTR1  BASE=*,LABEL=*                                                   
         OC    V_USRID,V_USRID                                                  
         BZ    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         TM    SC2NDVAL,SCNUMQ     NUMERIC?                                     
         BNZ   *+12                                                             
         MVI   FERN,15             PARAMETER MUST BE A NUMBER                   
         B     EXITL                                                            
*                                                                               
         ICM   R1,15,SC2NDNUM                                                   
         C     R1,=X'0000FFFF'                                                  
         BL    *+12                                                             
         MVI   FERN,16             NUMBER ENTERED IS TOO BIG                    
         B     EXITL                                                            
*                                                                               
         BRAS  RE,OPENSYS                                                       
*                                                                               
         L     R2,AIOTEMP                                                       
         USING CTIREC,R2                                                        
         XC    CTIKEY,CTIKEY                                                    
         MVI   CTIKTYP,CTIKTYPQ                                                 
         STCM  R1,3,CTIKNUM                                                     
         STCM  R1,3,V_USRID                                                     
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,AIOTEMP,AIOTEMP                         
         CLI   8(R1),0                                                          
         BE    EXITOK                                                           
         MVI   FERN,3              SET ERROR MESSAGE                            
         B     EXITL                                                            
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* VALIDATE AGYBIN = XX PARAMETER                                      *         
* NTRY: R3     = A(SCANBLK)                                           *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALAGYB  NTR1  BASE=*,LABEL=*                                                   
         OC    V_AGYID,V_AGYID                                                  
         BZ    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         TM    SC2NDVAL,SCNUMQ     NUMERIC?                                     
         BNZ   *+12                                                             
         MVI   FERN,18             PARAMETER MUST BE A NUMBER                   
         B     EXITL                                                            
*                                                                               
         ICM   R1,15,SC2NDNUM                                                   
         CHI   R1,255                                                           
         BNH   *+12                                                             
         MVI   FERN,16             NUMBER ENTERED IS TOO BIG                    
         B     EXITL                                                            
*                                                                               
         STC   R1,V_AGYID                                                       
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* VALIDATE AGENCY=XX PARAMETER                                        *         
* NTRY: R3     = A(SCANBLK)                                           *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALAGY   NTR1  BASE=*,LABEL=*                                                   
         OC    V_AGENCY,V_AGENCY                                                
         BZ    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         MVC   V_AGENCY,SC2NDFLD                                                
*                                                                               
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* VALIDATE START=DATE PARAMETER                                       *         
* NTRY: R3     = A(SCANBLK)                                           *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALSTA   NTR1  BASE=*,LABEL=*                                                   
         OC    V_START,V_START                                                  
         BZ    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         GOTO1 VDATVAL,DMCB,SC2NDFLD,DUB                                        
         OC    0(4,R1),0(R1)                                                    
         BNZ   *+12                                                             
         MVI   FERN,21             INVALID DATE                                 
         B     EXITL                                                            
*                                                                               
         GOTO1 VDATCON,DMCB,(0,DUB),(3,V_START),0                               
*                                                                               
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* VALIDATE END=DATE PARAMETER                                         *         
* NTRY: R3     = A(SCANBLK)                                           *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALEND   NTR1  BASE=*,LABEL=*                                                   
         OC    V_END,V_END                                                      
         BZ    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         GOTO1 VDATVAL,DMCB,SC2NDFLD,DUB                                        
         OC    0(4,R1),0(R1)                                                    
         BNZ   *+12                                                             
         MVI   FERN,21             INVALID DATE                                 
         B     EXITL                                                            
*                                                                               
         GOTO1 VDATCON,DMCB,(0,DUB),(3,V_END),0                                 
*                                                                               
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* VALIDATE PROGNAME=XXXXXXX PARAMETER                                 *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALPRG   NTR1  BASE=*,LABEL=*                                                   
         ICM   R5,15,APGMLST       JUST DO THIS ONCE                            
         BNZ   VPRG02                                                           
*                                                                               
         L     R5,VSELIST                                                       
         LH    RE,0(R5)                                                         
         L     RF,2(R5)                                                         
         LA    R5,6(R5)                                                         
         USING SELISTD,R5                                                       
         CLI   SESYS,X'0A'         GET CONTROL SYSTEM                           
         BE    *+10                                                             
         BXLE  R5,RE,*-8                                                        
         DC    H'0'                CONTROL SYSTEM NOT FOUND                     
         ICM   R5,15,SEPGMS                                                     
         ST    R5,APGMLST                                                       
*                                                                               
VPRG02   LH    RE,0(R5)                                                         
         L     RF,2(R5)                                                         
         AHI   R5,6                                                             
         USING PGMLSTD,R5                                                       
         XR    R1,R1                                                            
         ICM   R1,1,SC2NDLEN                                                    
         BNZ   *+12                                                             
         MVI   FERN,8                                                           
         B     EXITL                                                            
*                                                                               
         BCTR  R1,0                                                             
         EX    R1,VPRGCLC                                                       
         BE    VPRG04                                                           
         BXLE  R5,RE,*-8                                                        
         MVI   FERN,X'04'          INVALID PROGRAM                              
         B     EXIT                                                             
*                                                                               
VPRGCLC  CLC   PGMNAME(0),SC2NDFLD MATCH?                                       
*                                                                               
VPRG04   MVC   V_PRNUM,PGMNUM      SET NUMBER TO MATCH ON                       
         MVC   PROGRAM,PGMNAME     SAVE NAME                                    
         B     EXITOK                                                           
         DROP  R3,R5                                                            
         EJECT                                                                  
***********************************************************************         
* VALIDATES RECNUM=XXXX PARAMETER                                     *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALRCN   NTR1  BASE=*,LABEL=*                                                   
         TM    SC2NDVAL,SCNUMQ                                                  
         BZ    VRCNERR                                                          
         ICM   R1,15,SC2NDNUM                                                   
         BZ    VRCNERR                                                          
         CHI   R1,ADDTABMX                                                      
         BH    VRCNERR                                                          
*                                                                               
         LA    RE,V_RTYPE                                                       
         LA    R0,L'V_RTYPE                                                     
VRCN10   CLI   0(RE),0                                                          
         BE    VRCN20                                                           
         LA    RE,1(,RE)                                                        
         BCT   R0,VRCN10                                                        
         MVI   FERN,20                                                          
         B     EXITL                                                            
VRCN20   STC   R1,0(RE)                                                         
         MVI   RUNTYPE,C'T'        FORCE TEST RUN                               
         B     EXITOK                                                           
*                                                                               
VRCNERR  MVI   FERN,19                                                          
         B     EXITL                                                            
         EJECT                                                                  
***********************************************************************         
* VALIDATES REPORT=XXXX PARAMETER                                     *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALREP   NTR1  BASE=*,LABEL=*                                                   
         MVI   RPTYPE,C'S'         SECURITY (DEFAULT)                           
         CLC   STDREP,SC2NDFLD                                                  
         BNE   *+8                                                              
         MVI   RPTYPE,C'N'         STANDARD (NORMAL                             
         CLC   FULLREP,SC2NDFLD                                                 
         BNE   *+8                                                              
         MVI   RPTYPE,C'F'         FULL                                         
         CLC   PROFREP,SC2NDFLD                                                 
         BNE   *+8                                                              
         MVI   RPTYPE,C'P'         PROFILE                                      
         B     EXITOK                                                           
*                                                                               
SECREP   DC    CL3'SEC'            SECURITY REPORT (DEFUALT)                    
STDREP   DC    CL3'STD'            STANDARD CONTROL DFA                         
FULLREP  DC    CL4'FULL'           FULL REPORT (ALL RECORDS)                    
PROFREP  DC    CL4'PROF'           REPORT PROFILES ONLY                         
         EJECT                                                                  
***********************************************************************         
* VALIDATES PROGNUM=XXXX PARAMETER                                    *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALPGN   NTR1  BASE=*,LABEL=*                                                   
         TM    SC2NDVAL,SCNUMQ                                                  
         BO    *+12                                                             
         MVI   FERN,12                                                          
         B     EXITL                                                            
*                                                                               
         L     R1,SC2NDNUM                                                      
         STC   R1,V_PRNUM                                                       
         CHI   R1,256              MUST BE <255                                 
         BL    *+12                                                             
         MVI   FERN,12                                                          
         B     EXITL                                                            
*                                                                               
         ICM   R5,15,APGMLST       JUST DO THIS ONCE                            
         BNZ   VPGN02                                                           
*                                                                               
         L     R5,VSELIST                                                       
         LH    RE,0(R5)                                                         
         L     RF,2(R5)                                                         
         LA    R5,6(R5)                                                         
         USING SELISTD,R5                                                       
         CLI   SESYS,X'0A'         GET CONTROL SYSTEM                           
         BE    *+10                                                             
         BXLE  R5,RE,*-8                                                        
         DC    H'0'                CONTROL SYSTEM NOT FOUND                     
         ICM   R5,15,SEPGMS                                                     
         ST    R5,APGMLST                                                       
*                                                                               
VPGN02   LH    RE,0(R5)                                                         
         L     RF,2(R5)                                                         
         LA    R5,6(R5)                                                         
         USING PGMLSTD,R5                                                       
         CLC   V_PRNUM,PGMNUM      MATCH?                                       
         BE    VPGN04                                                           
         BXLE  R5,RE,*-10                                                       
         MVI   FERN,4              ERROR N.F.                                   
         XC    V_PRNUM,V_PRNUM                                                  
         B     EXITL                                                            
*                                                                               
VPGN04   MVC   PROGRAM,PGMNAME      GET NAME FOR LATER                          
         B     EXITOK                                                           
         DROP  R3,R5                                                            
         EJECT                                                                  
***********************************************************************         
* VALIDATES SHOW ADD RECORD COMMAND                                   *         
***********************************************************************         
VALADD   NTR1  BASE=*,LABEL=*                                                   
         NI    OUTTYPE,255-ADDOUT                                               
         BRAS  RE,VALTRUE                                                       
         BNE   EXITL                                                            
         OI    OUTTYPE,ADDOUT                                                   
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* VALIDATE SHOW CHANGE RECORD COMMAND                                 *         
***********************************************************************         
VALCHNG  NTR1  BASE=*,LABEL=*                                                   
         NI    OUTTYPE,255-CHNGOUT                                              
         BRAS  RE,VALTRUE                                                       
         BNE   EXITL                                                            
         OI    OUTTYPE,CHNGOUT                                                  
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* VALIDATE SHOW DELETE RECORD COMMAND                                 *         
***********************************************************************         
VALDEL   NTR1  BASE=*,LABEL=*                                                   
         NI    OUTTYPE,255-DELOUT                                               
         BRAS  RE,VALTRUE                                                       
         BNE   EXITL                                                            
         OI    OUTTYPE,DELOUT                                                   
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* VALIDATE SHOW RESTORE RECORD COMMAND                                *         
***********************************************************************         
VALREST  NTR1  BASE=*,LABEL=*                                                   
         NI    OUTTYPE,255-RESTOUT                                              
         BRAS  RE,VALTRUE                                                       
         BNE   EXITL                                                            
         OI    OUTTYPE,RESTOUT                                                  
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* VALIDATE SHOW FULL DETAIL COMMAND                                   *         
***********************************************************************         
VALDETL  NTR1  BASE=*,LABEL=*                                                   
         NI    OUTTYPE,255-DETLOUT                                              
         BRAS  RE,VALTRUE                                                       
         BNE   EXITL                                                            
         OI    OUTTYPE,DETLOUT                                                  
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* VALIDATE COPY COMMAND - DEFINES WHERE REPORT IS TO GO               *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALCOP   NTR1  BASE=*,LABEL=*                                                   
         NI    OUTTYPE,255-(HARDONLY+PPSAGNLY)                                  
         CLC   ALLCOPY,SC2NDFLD                                                 
         BE    EXITOK                                                           
         CLC   PPSCOPY,SC2NDFLD                                                 
         BNE   VCOP01                                                           
         OI    OUTTYPE,PPSAGNLY                                                 
         B     EXITOK                                                           
VCOP01   CLC   HARDCOPY,SC2NDFLD                                                
         BNE   VCOP02                                                           
         OI    OUTTYPE,HARDONLY                                                 
         B     EXITOK                                                           
VCOP02   MVI   FERN,8                                                           
         B     EXITL                                                            
         DROP  R3                                                               
*                                                                               
ALLCOPY  DC    CL4'ALL'            COPY=ALL  - HARDCOPY + ALL AGS TO PQ         
PPSCOPY  DC    CL4'PPS'            COPY=PPS  - HARDCOPY + PPS AGS TO PQ         
HARDCOPY DC    CL4'HARD'           COPY=HARD - HARDCOPY ONLY                    
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* VALIDATE NULL=DATE PARAMETER (DATE OF NULL FILE IF GIVEN)           *         
* NTRY: R3     = A(SCANBLK)                                           *         
***********************************************************************         
         USING SCANBLKD,R3                                                      
VALNULL  NTR1  BASE=*,LABEL=*                                                   
         CLI   NULLDATE,0                                                       
         BE    *+12                                                             
         MVI   FERN,14             PARAMETER ALREADY SET                        
         B     EXITL                                                            
*                                                                               
         GOTO1 VDATVAL,DMCB,SC2NDFLD,DUB                                        
         OC    0(4,R1),0(R1)                                                    
         BNZ   *+12                                                             
         MVI   FERN,21             INVALID DATE                                 
         B     EXITL                                                            
*                                                                               
         MVC   NULLDATE,DUB                                                     
*                                                                               
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
**********************************************************************          
* VALIDATE INPUT CARD IN SCANBLK FOR WORD 'TRUE'                     *          
* NTRY:  R3    = A(SCANBLK ENTRY)                                    *          
* EXIT:  CC    SET                                                   *          
**********************************************************************          
         USING SCANBLKD,R3         CHECK XXXXX=TRUE INPUT CARD                  
VALTRUE  NTR1  BASE=*,LABEL=*                                                   
         XR    RF,RF                                                            
         ICM   RF,1,SC2NDLEN                                                    
         BNZ   *+12                                                             
         MVI   FERN,8                                                           
         B     EXITL                                                            
*                                                                               
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     EXIT                                                             
         CLC   TRUE(0),SC2NDFLD                                                 
         DROP  R3,RB                                                            
         EJECT                                                                  
***********************************************************************         
* BUILD PROFILE TABLE                                                 *         
* ONLY IF USER REPORTS BEING PRODUCED (EITHER SECURITY OR PROFILE)    *         
* TAKE ONLY AGENCY ALPHA LEVEL PROFILES WITH NO LOW LEVEL KEY         *         
* THEN READ ACCESS RECORDS TO SET PPS FLAG AND COUNTRY                *         
***********************************************************************         
BLDPROFS NTR1  BASE=*,LABEL=*                                                   
         LA    R2,KEY                                                           
         USING CTUREC,R2           R2=A(PROFILE KEY)                            
         XC    CTUKEY,CTUKEY                                                    
         MVI   CTUKTYP,CTUKTYPQ                                                 
         MVI   CTUKSYS,C'C'        CONTROL                                      
         MVC   CTUKPROG+1(2),=C'SA' SA REPORT (SECURITY)                        
         CLI   RPTYPE,C'P'                                                      
         BNE   *+10                                                             
         MVC   CTUKPROG+1(2),=C'PA' PA REPORT (PROFILES)                        
         MVC   CTUKAGY,SPACES      IGNORE ANY USERID ENTRIES                    
*                                                                               
         L     R2,AIOTEMP                                                       
         MVC   CTUKEY,KEY          SET START                                    
         L     R3,APRFBLK                                                       
         XR    R4,R4               NUMBER OF PRFBLK ENTRIES                     
*                                                                               
         GOTO1 VDMGR,DMCB,DMRDHI,CTFILE,(R2),(R2)                               
         B     BPRF04                                                           
*                                                                               
BPRF02   GOTO1 VDMGR,DMCB,DMRSEQ,CTFILE,(R2),(R2)                               
*                                                                               
BPRF04   CLC   CTUKEY(CTUKAGY-CTUKEY),KEY                                       
         BNE   BPRF10                                                           
         OC    CTUKMED(L'CTUKEY-(CTUKMED-CTUKEY)),CTUKMED                       
         BNZ   BPRF02              IGNORE IF NOT AGENCY LEVEL                   
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'72',AIOTEMP),0,0,0,0               
         CLI   12(R1),0            CTPVD ELEMENT FOUND?                         
         BNE   BPRF02              IGNORE IF NOT                                
         L     RF,12(,R1)                                                       
         MVC   LSTPRFGP,CTUKAGY    COPY ALPHA ID                                
         MVI   LSTPRFPP,C' '       CLEAR PPS FLAG                               
         MVI   LSTPRFCY,0          CLEAR COUNTRY                                
         MVC   LSTPRF,CTPVALUE-CTPVD(RF) COPY PROFILE VALUES                    
         MVC   0(L'LSTPRFS,R3),LSTPRFS                                          
         LA    R3,L'LSTPRFS(,R3)   NEXT ENTRY                                   
         LA    R4,1(,R4)           COUNT ENTRIES                                
         C     R4,PRFPARMS+20      COMPARE WITH MAXIMUM                         
         BNH   BPRF02              GET NEXT                                     
         DC    H'0'                TABLE IS FULL                                
*                                                                               
BPRF10   ST    R4,PRFPARMS+8       PUT LENGTH INTO BINSRCH PARMS                
         DROP  R2                                                               
*                                                                               
* SCAN ACCESS RECORDS. SAVE SECURITY AGENCIES                                   
*                                                                               
BPRF20   LA    R2,KEY                                                           
         USING CT5REC,R2           R2=A(ACCESS KEY)                             
         XC    CT5KEY,CT5KEY                                                    
         MVI   CT5KTYP,CT5KTYPQ                                                 
*                                                                               
         L     R2,AIOTEMP                                                       
         MVC   CT5KEY,KEY          SET START                                    
*                                                                               
         GOTO1 VDMGR,DMCB,DMRDHI,CTFILE,(R2),(R2)                               
*                                                                               
BPRF22   CLC   CT5KEY(CT5KALPH-CT5KEY),KEY                                      
         BNE   BPRF30                                                           
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B8',AIOTEMP),0,0,0,0               
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   BPRF24              NO, SO THIS IS A SECURITY AGENCY             
         L     RF,12(R1)                                                        
         CLC   2(2,RF),SPACES      SECURITY AGENCY ALPHA ID                     
         BH    BPRF28              IF NOT BLANK, NOT A SECURITY AGENCY          
*                                                                               
BPRF24   MVC   LSTPRFGP,CT5KALPH   SET ALPHA ID                                 
         MVI   LSTPRFPP,C' '                                                    
         MVI   LSTPRFCY,0                                                       
         MVC   LSTPRF,SPACES                                                    
         GOTO1 VBINSRCH,PRFPARMS,(1,LSTPRFS) ADD ONLY IF NOT THERE              
         OC    1(3,R1),1(R1)                                                    
         BNZ   *+6                                                              
         DC    H'0'                TABLE IS FULL                                
         L     R4,0(,R1)           R4=A(NEW OR EXISTING ENTRY)                  
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B4',AIOTEMP),0,0,0,0               
         CLI   12(R1),0            CTAGDD ELEMENT FOUND?                        
         BNE   BPRF26                                                           
         L     RF,12(R1)                                                        
         USING CTAGDD,RF                                                        
         CLI   CTAGDLEN,CTAGDLNQ                                                
         BNH   *+10                                                             
         MVC   LSTPRFCY-LSTPRFS(,R4),CTAGDCTY GET COUNTRY                       
         DROP  RF                                                               
BPRF26   GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B9',AIOTEMP),0,0,0,0               
         CLI   12(R1),0            CTAADD ELEMENT FOUND?                        
         BNE   BPRF28                                                           
         L     RF,12(R1)                                                        
         USING CTAADD,RF                                                        
         TM    CTAADFLG,CTAADPRQ   AGENCY ON PPS?                               
         BZ    BPRF28              NO, SKIP                                     
         MVI   LSTPRFPP-LSTPRFS(R4),C'Y' MARK AS PPS AGENCY                     
         DROP  RF                                                               
*                                                                               
BPRF28   GOTO1 VDMGR,DMCB,DMRSEQ,CTFILE,(R2),(R2)                               
         B     BPRF22                                                           
         DROP  R2                                                               
*                                                                               
BPRF30   DS    0H                                                               
         B     EXITOK                                                           
                                                                                
***********************************************************************         
* READ DUMP OF RECOVERY FILE FILTER AND PASS TO SORT                  *         
***********************************************************************         
READFILE NTR1  BASE=*,LABEL=*                                                   
         OPEN  (TAPEIN,INPUT)                                                   
         LTR   RF,RF                                                            
         BZ    *+6                                                              
         DC    H'0'                                                             
*                                                                               
RFIL02   GET   TAPEIN              GET NEXT RECORD                              
         LR    R7,R1                                                            
         USING RECDS,R7                                                         
*                                                                               
         MVC   MYDATTIM(3),RDATE                                                
         MVC   MYDATTIM+3(4),RTIME                                              
         TM    RTIME,X'80'         NEW STYLE TIME?                              
         BZ    RFIL02A             NO                                           
         NI    MYDATTIM+3,X'3F'    SET NEW STYLE TO OLD STYLE                   
         MVI   MYDATTIM+6,X'C0'                                                 
         ICM   R1,15,MYDATTIM+3                                                 
         SRL   R1,4                                                             
         STCM  R1,15,MYDATTIM+3                                                 
RFIL02A  OC    RDATE,RDATE                                                      
         BZ    RFIL03                                                           
         CLC   LODATTIM,MYDATTIM   UPDATE LOWEST/HIGHEST DATE/TIME              
         BNH   *+10                                                             
         MVC   LODATTIM,MYDATTIM                                                
         CLC   HIDATTIM,MYDATTIM                                                
         BNL   *+10                                                             
         MVC   HIDATTIM,MYDATTIM                                                
*                                                                               
RFIL03   TM    RRECTY,X'80'        IGNORE POINTER COPY/CHANGES                  
         BO    RFIL02                                                           
*                                                                               
         CLI   RFILTY,CTFILEQ      ONLY CTFILE OR GENFILE PASSED                
         BE    RFIL04                                                           
         CLI   RFILTY,GENFILQ                                                   
         BE    RFIL04                                                           
         B     RFIL02                                                           
*                                                                               
RFIL04   L     R2,ACTFADD          CTFILE RECORD                                
         CLI   RFILTY,CTFILEQ                                                   
         BE    *+8                                                              
         L     R2,ACTGADD          GENFIL RECORD                                
         USING ADDTABD,R2                                                       
*                                                                               
RFIL06   CLI   0(R2),X'FF'         UNKNOWN RECORD - IGNORE IT                   
         BE    RFIL02                                                           
         CLC   RFILTY,ADFTYPE      MAKE SURE STILL IN SAME TYPE                 
         BNE   RFIL02                                                           
*                                                                               
         XR    RF,RF               LOOK FOR LIVE KEY                            
         ICM   RF,1,ADMTCHL                                                     
         BZ    RFIL10              AUTOMATIC MATCH                              
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         BNE   RFIL08              DOES NOT MATCH LIVE KEY                      
         CLC   ADMTCHC(0),RCVFRST                                               
*                                                                               
         XR    RF,RF                                                            
         ICM   RF,1,ADPASSL        PASSIVE KEY IN RECORD?                       
         BZ    RFIL10              NO - PUT TO SORT                             
         BCTR  RF,0                                                             
*                                                                               
         MVC   WORK(1),ADPASSF     SET FILL CHARACTER                           
         MVC   WORK+1(32),WORK                                                  
*                                                                               
         XR    R1,R1                                                            
         IC    R1,ADPASSD                                                       
         LA    R1,RCVFRST(R1)      R1=A(MATCH AREA IN RECORD)                   
         EX    RF,*+8                                                           
         BE    RFIL02              PASSIVE - IGNORE IT                          
         CLC   WORK(0),0(R1)                                                    
         B     RFIL10                                                           
*                                                                               
RFIL08   AHI   R2,ADDTABLQ         NEXT IN TABLE                                
         B     RFIL06                                                           
*                                                                               
RFIL10   ST    R2,AADDNTRY         SAVE A(ENTRY)                                
*                                                                               
         CLI   V_RTYPE,0           TEST FOR RECORD NUMBER FILTERS               
         BNE   RFIL20              YES, FILTER ONLY ON THAT                     
*                                                                               
         CLI   RPTYPE,C'F'         FULL REPORT?                                 
         BE    RFIL20              YES - PASS EVERYTHING                        
*                                                                               
         CLI   RPTYPE,C'S'         SECURITY REPORT?                             
         BNE   RFIL12              NO                                           
         TM    ADSTDREP,ADSTSECX   EXCLUDE FROM SECURITY REPORT?                
         BO    RFIL02                                                           
         CLI   RPRG,X'0D'          FROM CONTROL/SECURITY PROGRAM                
         BE    RFIL20                                                           
         TM    ADSTDREP,ADSTSEC    OR REQUIRED FOR SECURITY REPORT              
         BO    RFIL20                                                           
         B     RFIL02                                                           
*                                                                               
RFIL12   CLI   RPTYPE,C'N'         STANDARD REPORT?                             
         BNE   RFIL14              NO                                           
         TM    ADSTDREP,ADSTSTD    REQUIRED FOR STANDARD REPORT                 
         BO    RFIL20                                                           
         B     RFIL02              NO                                           
*                                                                               
RFIL14   CLI   RPTYPE,C'P'         PROFILE REPORT                               
         BNE   RFIL16              NO                                           
         TM    ADSTDREP,ADSTPRF    REQUIRED FOR PROFILE REPORT                  
         BO    RFIL20                                                           
         B     RFIL02              NO                                           
*                                                                               
RFIL16   DC    H'0'                NOT ANY SORT OF REPORT                       
*                                                                               
RFIL20   L     R2,ASRTBLK          NOW SET SORT BLOCK                           
         USING SRTBLKD,R2                                                       
         XC    SRTBLKD(SRTBLKLQ),SRTBLKD                                        
*                                                                               
         MVC   SRTUSER,RUSER       SET SORT PARAMETERS                          
         MVC   SRTPERS,RPERSON                                                  
         MVC   SRTDATE(7),MYDATTIM                                              
*                                                                               
         MVC   SRTPRG,RPRG         SET PROGRAM AND SIN                          
         MVC   SRTSIN,RSIN                                                      
         CLI   RTASKID,RBACKOUT    Was this backed out?                         
         BE    RFIL02              Yes so skip                                  
         MVI   RSIN,0              Don't care if x'FE'/x'FD'                    
*                                                                               
         LHI   RF,25-1             SAVE KEY TO SORT ON                          
         CLI   RFILTY,CTFILEQ                                                   
         BE    *+8                                                              
         LHI   RF,32-1                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   SRTKEY(0),RCVFRST                                                
*                                                                               
         TM    RTIME,X'40'         TRAILER RECORD ON THIS RECORD?               
         BZ    RFIL30              NO                                           
*                                                                               
         LH    RF,RECLN            POINT TO TRAILER RECORD                      
         LA    RF,RECDS(RF)                                                     
         BCTR  RF,0                                                             
         XR    R0,R0                                                            
         IC    R0,0(RF)                                                         
         AHI   RF,1                                                             
         SR    RF,R0                                                            
*                                                                               
         USING RECVEXT,RF                                                       
         MVC   SRTLUID,RLUID       SET SORT INFO FROM TRAILER                   
         MVC   SRTGRP,RAGYSEC                                                   
         MVI   OFFLINE,NO                                                       
         CLI   RSYSIX,0            If zero then off-line                        
         BNE   *+8                                                              
         MVI   OFFLINE,YES                                                      
         DROP  RF                                                               
*                                                                               
RFIL30   LH    RF,RECLN                                                         
         AHI   RF,SRTBLKLQ                                                      
         STH   RF,SRTLEN           SET LENGTH OF SORT RECORD                    
*                                                                               
         LA    R0,SRTRECH          MOVE IN RECORD TO BLOCK                      
         LH    R1,RECLN                                                         
         LA    RE,RECDS                                                         
         LH    RF,RECLN                                                         
         MVCL  R0,RE                                                            
*                                                                               
         CLI   RRECTY,X'03'        RECORD WAS AN ADD?                           
         BE    RFIL34              YES                                          
*                                                                               
         CLI   RRECTY,1            IF NOT IT BETTER BE A COPY                   
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         GET   TAPEIN              GET NEXT RECORD                              
         LR    R7,R1                                                            
*                                                                               
         CLI   RRECTY,2            AND IT HAD BETTER BE A CHANGE                
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         LHI   RF,25-1             CTFILE RECORD                                
         CLI   RFILTY,CTFILEQ                                                   
         BE    *+8                                                              
         LHI   RF,32-1             GENFIL RECORD                                
         EX    RF,*+8                                                           
         BE    RFIL32                                                           
         CLC   SRTKEY(0),RCVFRST   YOU BETTER HAVE MATCHING KEYS TOO            
         DC    H'0'                                                             
*                                                                               
RFIL32   LA    R0,SRTBLKD          ADD CHANGE AFTER COPY ON ONE RECORD          
         AH    R0,SRTLEN                                                        
         LH    R1,RECLN                                                         
         LA    RE,RECDS                                                         
         LH    RF,RECLN                                                         
         MVCL  R0,RE                                                            
*                                                                               
         LH    R0,SRTLEN           UPDATE LENGTH TO SHOW BOTH RECORDS           
         AH    R0,RECLN                                                         
         STH   R0,SRTLEN                                                        
*                                                                               
RFIL34   BRAS  RE,FILTER           FILTER ON PARAMETERS                         
         BNE   RFIL02              FAIL                                         
*                                                                               
         MVI   SRTSRT,SRTSDDS      ADD FOR DDS SORT                             
         MVI   SRTPWIND,1          UNUSED FOR DDS REPORT                        
         GOTO1 VSORTER,PLIST,PUT,SRTBLKD                                        
*                                                                               
         TM    OUTTYPE,HARDONLY    DDS REPORT AS HARDCOPY ONLY                  
         BO    RFIL02              YES - DONE                                   
*                                                                               
*        SEED USER REPORTS - PROFILES DEFINE WHETHER REQUIRED, AND SEQ          
*        FIRST SORT OUT RAW RECORDS SO MORE USER FRIENNDLY FOR CLIENTS          
*                                                                               
RFIL40   BRAS  RE,EFFDFIX          FIX ADD RESULTING FROM EFFECTIVE CHG         
*                                                                               
         BRAS  RE,VERKEYS          ENSURE KEY FIELDS ARE SAFE                   
*                                                                               
         CLC   LSTPRFGP,SRTGRP     DO WE HAVE A PROFILE FOR THIS GROUP?         
         BE    RFIL42                                                           
         MVC   LSTPRFGP,SRTGRP     NO, GO LOOK IT UP                            
         BRAS  RE,GETPRF                                                        
*                                                                               
RFIL42   CLI   RPTYPE,C'S'         TEST SECURITY REPORT                         
         BNE   RFIL44              NO, SKIP                                     
         CLI   SRTPWIND,0          TEST SELF PASSWORD CHANGE                    
         BNE   RFIL44              NO, SKIP                                     
         CLI   LSTPRF04,C'X'       EXCLUDE SELF PASSWORD CHANGES                
         BE    RFIL02              YES, SO EXCLUDE IT                           
         CLI   LSTPRF04,C'S'       SORT SELF PASSWORD CHANGES TO FRONT          
         BE    RFIL44              YES, FLAG SORTS TO FRONT                     
         MVI   SRTPWIND,1          RESET FLAG SO SORTS NORMALLY                 
*                                                                               
RFIL44   CLI   LSTPRFPP,C'Y'       IF PPS AGENCY,                               
         BE    RFIL46              ALWAYS REPORT                                
         TM    OUTTYPE,PPSAGNLY    IF ONLY DOING PPS AGENCIES                   
         BO    RFIL02              NO USER REPORT                               
*                                                                               
RFIL46   CLI   LSTPRF02,C'R'       TEST RECORD KEY SEQUENCE REQUIRED            
         BNE   *+10                NO, LEAVE AS DATE/TIME SORT                  
         MVC   SRTKEY2,SRTKEY      YES, SORT BY KEY BEFORE DATE/TIME            
*                                                                               
         CLI   LSTPRF01,C'B'       TEST BOTH LEVELS REQUIRED                    
         BE    *+12                                                             
         CLI   LSTPRF01,C'A'       OR SECURITY AGENCY (GROUP) LEVEL             
         BNE   RFIL48              NEITHER, SKIP THIS REPORT                    
         MVI   SRTSRT,SRTSGRP      ADD FOR AGY GROUP SORT                       
         ICM   R0,3,SRTUSER                                                     
         XC    SRTUSER,SRTUSER     CLEAR USER FROM SEQUENCE                     
         GOTO1 VSORTER,PLIST,PUT,SRTBLKD                                        
         STCM  R0,3,SRTUSER        RESTORE USER                                 
*                                                                               
RFIL48   DS    0H                                                               
         CLI   LSTPRF01,C'B'       TEST BOTH LEVELS REQUIRED                    
         BE    *+12                                                             
         CLI   LSTPRF01,C'U'       OR USERID LEVEL                              
         BNE   RFIL02              NEITHER, SKIP THIS REPORT                    
         MVI   SRTSRT,SRTSUSR      ADD FOR USERID SORT                          
         GOTO1 VSORTER,PLIST,PUT,SRTBLKD                                        
         B     RFIL02                                                           
         DROP  R2,R7                                                            
*                                                                               
TAPEEND  CLOSE (TAPEIN)            THAT'S ALL SHE WROTE                         
*                                                                               
         TM    OUTTYPE,HARDONLY    DDS REPORT AS HARDCOPY ONLY                  
         BO    EXITOK              YES - DONE                                   
*                                                                               
*        ADD DUMMY RECORDS TO FORCE EMPTY REPORTS IF NO DATE                    
*                                                                               
RFIL60   L     R2,ASRTBLK          NOW SET SORT BLOCK                           
         USING SRTBLKD,R2                                                       
*                                                                               
         XC    SRTBLKD(SRTBLKLQ),SRTBLKD SKELETON DUMMY GROUP RECORD            
         MVC   SRTLEN,=Y(350)      MINIMUM LENGTH FOR SORT                      
         MVI   SRTSRT,SRTSDDS      DDS SORT LEVEL                               
         XC    SRTRECH(L'RECLN),SRTRECH RECLEN=0 = DUMMY RECORD                 
         GOTO1 VSORTER,PLIST,PUT,SRTBLKD ADD DDS DUMMY RECORD                   
*                                                                               
         MVI   SRTSRT,SRTSGRP      AGY GROUP SORT LEVEL                         
         L     R3,APRFBLK                                                       
         LA    R4,1                PRFBLK ENTRY NUMBER                          
RFIL62   C     R4,PRFPARMS+8       TEST ALL DONE                                
         BH    EXITOK                                                           
         MVC   LSTPRFS,0(R3)                                                    
         BRAS  RE,SETPRF                                                        
         CLI   LSTPRF01,C'B'       TEST BOTH REPORT LEVELS RQD                  
         BE    *+12                                                             
         CLI   LSTPRF01,C'A'       OR AGENCY LEVEL RQD                          
         BNE   RFIL64              NO, SKIP                                     
         CLI   LSTPRF03,C'Y'       TEST EMPTY REPORT RQD IF NO DATA             
         BNE   RFIL64              NO, SKIP                                     
         OC    V_FILTS(V_FILTLQ),V_FILTS                                        
         BNZ   RFIL64              IGNORE THIS IF ANY FILTERS                   
         MVC   SRTGRP,LSTPRFGP     SET ALPHA ID                                 
         GOTO1 VSORTER,PLIST,PUT,SRTBLKD ADD DUMMY RECORD                       
RFIL64   LA    R3,L'LSTPRFS(,R3)   NEXT ENTRY                                   
         LA    R4,1(,R4)           NEXT ENTRY NUMBER                            
         B     RFIL62                                                           
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
* VALIDATE PARAMETERS BEFORE PASSING RECORD TO SORT                   *         
* NTRY: R2 = A(SRTBLK)                                                *         
***********************************************************************         
         USING SRTBLKD,R2                                                       
         USING RECDS,SRTRECH                                                    
FILTER   NTR1  BASE=*,LABEL=*                                                   
         TM    RTIME,X'40'         TRAILER RECORD ON THIS RECORD?               
         BNZ   VFLT02              YES, SO RTRM NOT USED                        
*                                                                               
         OC    V_TCODE,V_TCODE     TEST FOR TERMINAL #                          
         BZ    VFLT04                                                           
         CLC   V_TCODE,RTRM                                                     
         BNE   EXITL                                                            
*                                                                               
VFLT02   OC    V_LUID,V_LUID       TEST FOR LUID INSTEAD OF TERMINAL #          
         BZ    VFLT04                                                           
         CLC   V_LUID,SRTLUID                                                   
         BNE   EXITL                                                            
*                                                                               
VFLT04   OC    V_USRID,V_USRID     TEST FOR USER ID #                           
         BZ    VFLT06                                                           
         CLC   V_USRID,SRTUSER                                                  
         BNE   EXITL                                                            
*                                                                               
VFLT06   OC    V_AGYID,V_AGYID     TEST FOR AGENCY ID                           
         BZ    VFLT08                                                           
         CLC   V_AGYID,RAG                                                      
         BNE   EXITL                                                            
*                                                                               
VFLT08   CLI   V_RTYPE,0           TEST FOR RECORD NUMBER FILTERS               
         BE    VFLT10                                                           
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         LA    RE,V_RTYPE                                                       
         LA    R0,L'V_RTYPE                                                     
VFLT09   CLC   ADRECNUM,0(RE)                                                   
         BE    VFLT10                                                           
         CLI   0(RE),0                                                          
         BE    EXITL                                                            
         LA    RE,1(,RE)                                                        
         BCT   R0,VFLT09                                                        
         DROP  RF                                                               
         B     EXITL                                                            
*                                                                               
VFLT10   OC    V_AGENCY,V_AGENCY   TEST FOR AGENCY ALPHA                        
         BZ    VFLT12                                                           
         CLC   V_AGENCY,SRTGRP     RIGHT AGENCY?                                
         BNE   EXITL               NOPE                                         
*                                                                               
VFLT12   OC    V_START,V_START     TEST FOR START DATE                          
         BZ    VFLT14                                                           
         CLC   RDATE,V_START                                                    
         BL    EXITL                                                            
*                                                                               
VFLT14   OC    V_END,V_END         TEST FOR END DATE                            
         BZ    VFLT16                                                           
         CLC   RDATE,V_END                                                      
         BH    EXITL                                                            
*                                                                               
VFLT16   B     EXITOK                                                           
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
* IF ADD AND PRIOR EFFECTIVE DATE VERSION ON CTFILE, TREAT AS CHANGE  *         
*        THIS IS BECAUSE WHEN THE USER CHANGES SUCH A RECORD, IT ADDS *         
*        A NEW COPY WITH A NEW EFFECTIVE DATE                         *         
* NTRY: R2 = A(SRTBLK CONTAINING ADD IMAGE)                           *         
*       R7 = A(RECOVERY RECORD)                                       *         
***********************************************************************         
         USING SRTBLKD,R2                                                       
         USING RECDS,R7                                                         
EFFDFIX  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R1,AADDNTRY                                                      
         USING ADDTABD,R1                                                       
         CLI   ADRECNUM,25         TEST PERSON RECORD                           
         BE    EFFD05                                                           
         CLI   ADRECNUM,117        TEST TEXT LIMIT ACCESS LIST RECORD           
         BNE   EFFDX                                                            
         DROP  R1                                                               
EFFD05   CLI   RRECTY,X'03'        TEST ADD                                     
         BNE   EFFDX                                                            
*                                                                               
         L     R6,AIOTEMP          LOOK FOR PRIOR COPY (NOT DELETED)            
         USING SAPEREC,R6                                                       
         MVC   SAPEKEY,RCVFRST                                                  
         XR    R1,R1                                                            
         ICM   R1,3,SAPEEND-2      BY INCREMENTING END OF KEY                   
         LA    R1,1(,R1)                                                        
         STCM  R1,3,SAPEEND-2                                                   
         GOTO1 VDMGR,DMCB,(0,DMRDHI),CTFILE,(R6),(R6)                           
         CLI   8(R1),0                                                          
         BE    *+6                                                              
         DC    H'0'                DON'T TOLERATE IO ERRORS                     
         LA    R1,SAPEDEF-SAPEKEY-1                                             
         CLI   RCVFRST+(SAPESUB-SAPEKEY),SAPESUBQ                               
         BE    EFFD10                                                           
         LA    R1,SATLDEF-SATLKEY-1                                             
         CLI   RCVFRST+(SATLSUB-SATLKEY),SATLSUBQ                               
         BE    EFFD10                                                           
         DC    H'0'                                                             
EFFD10   EX    R1,*+8              SEE IF SAME BASE KEY                         
         BNE   EFFDX               DIFFERENT, SO NOT OLD VERSION                
         CLC   SAPEKEY(0),RCVFRST                                               
*                                                                               
         LA    R0,SRTRECH+RCVFRST-RECDS FILE REC BECOMES COPY REC               
         XR    R1,R1                                                            
         ICM   R1,3,SAPELEN        REPLACING ORIGINAL ADD RECORD                
         LR    RE,R6               BUT PRESERVING ITS RECOVERY HEADER           
         LR    RF,R1                                                            
         MVCL  R0,RE                                                            
*                                                                               
         MVI   SRTRECH+(RRECTY-RECDS),X'01' MAKE THE ADD INTO A COPY            
*                                                                               
         LR    R3,R0               SAVE SORT REC END ADDRESS                    
*                                                                               
         XR    RF,RF                                                            
         ICM   RF,3,SAPELEN                                                     
         AHI   RF,RCVFRST-RECDS                                                 
         STH   RF,SRTRECH+RECLN-RECDS LENGTH OF RECOVERY RECORD                 
         AHI   RF,SRTBLKLQ                                                      
         STH   RF,SRTLEN           SET LENGTH OF SORT RECORD                    
*                                                                               
         TM    RTIME,X'40'         TRAILER RECORD ON THIS RECORD?               
         BZ    EFFD50              NO                                           
*                                                                               
         LH    RF,RECLN            POINT TO TRAILER RECORD                      
         LA    RF,RECDS(RF)                                                     
         BCTR  RF,0                                                             
         XR    R1,R1                                                            
         IC    R1,0(RF)                                                         
         AHI   RF,1                                                             
         SR    RF,R1               RF=TRAILER, R1=LENGTH                        
*                                                                               
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R3),0(RF)       COPY TRAILER TO END OF SORT REC              
*                                                                               
         AHI   R1,1                                                             
         AR    R3,R1               NEW SORT REC END ADDRESS                     
         LH    RF,SRTLEN                                                        
         AR    RF,R1                                                            
         STH   RF,SRTLEN           SET NEW LENGTH OF SORT RECORD                
         LH    RF,SRTRECH+RECLN-RECDS                                           
         AR    RF,R1                                                            
         STH   RF,SRTRECH+RECLN-RECDS NEW LENGTH OF RECOVERY RECORD             
*                                                                               
EFFD50   LR    R0,R3               COPY ORIGINAL ADD RECORD AS CHANGE           
         LH    R1,RECLN            BEHIND NEW COPY RECORD                       
         LA    RE,RECDS                                                         
         LR    RF,R1                                                            
         MVCL  R0,RE                                                            
*                                                                               
         MVI   RRECTY-RECDS(R3),X'02' MAKE THE ADD INTO A CHANGE                
*                                                                               
         LH    R0,SRTLEN           UPDATE LENGTH TO SHOW BOTH RECORDS           
         AH    R0,RECLN                                                         
         STH   R0,SRTLEN                                                        
*                                                                               
EFFDX    B     EXITOK                                                           
         DROP  R2,R6,R7                                                         
         EJECT                                                                  
***********************************************************************         
* PROCESS RECORDS - AFTER YOU FINISH WITH THE INPUT FILE              *         
***********************************************************************         
PROCRECS NTR1  BASE=*,LABEL=*                                                   
         ZAP   PAGE,PONE                                                        
         ZAP   LINE,P99                                                         
         MVC   TITLE,NATITLE                                                    
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
*                                                                               
         MVI   BOXYORN,YES                                                      
         MVI   BOXOFF,NO                                                        
         MVI   BOXBLANK,NO                                                      
         MVC   BOXROWS,SPACES                                                   
         MVI   BOXROWS+2,C'T'                                                   
         MVI   BOXROWS+QMAXBOX,C'B' FORCES LINE AT END OF PAGE                  
*                                                                               
         MVI   LSTPNUM,255                                                      
         MVC   LSTAGY,EFFS         AGY CAN BE NULL, USE FF FOR 1ST              
         XC    LSTCTFRD,LSTCTFRD   CLEAR DOWN USER ID VARIABLE                  
*                                                                               
PRCR10   BRAS  RE,GETFRSRT         GET NEXT RECORD FROM SORT                    
         BNE   PRCRX               FINISHED                                     
*                                                                               
         L     R2,AIOSORT          GET A(CHANGE/ADD RECORD)                     
         USING RECDS,R2                                                         
         MVI   TRAILER,C'N'                                                     
*                                                                               
SVE      USING SRTBLKD,SRTSAVE                                                  
*                                                                               
         CLC   LSTSRT,SVE.SRTSRT   CHECK SAME SORT TYPE                         
         BNE   PRCR20              NEW SORT TYPE                                
         CLC   LSTGRP,SVE.SRTGRP   ELSE CHECK SAME GROUP                        
         BNE   PRCR20              NEW GROUP                                    
         CLC   LSTUSR,SVE.SRTUSER  ELSE CHECK SAME USER ID                      
         BE    PRCR30              SAME TYPE/GROUP/USER                         
         CLI   SVE.SRTSRT,SRTSGRP  AGENCY ALPHA REPORT?                         
         BNE   PRCR20              NO, SO NEW USER                              
         MVC   LSTUSR,SVE.SRTUSER  ELSE IGNORE CHANGE OF USER                   
         B     PRCR30                                                           
*                                                                               
*        REPORT BREAK - TYPE, GROUP OR USER CHANGED.                            
*                     - END CURRENT REPORT AND START NEW ONE                    
*                                                                               
PRCR20   MVC   LSTSRT,SVE.SRTSRT                                                
         MVC   LSTGRP,SVE.SRTGRP                                                
         MVC   LSTUSR,SVE.SRTUSER                                               
*                                                                               
         CLI   LSTSRT,SRTSDDS      DDS REPORT?                                  
         BE    PRCR22              YES, THAT'S FIRST, SO NOTHING TO END         
*                                                                               
         MVC   SVBXCOLS,BOXCOLS    NEW TYPE, GROUP OR USER ID                   
         BRAS  RE,SORTTOT          PRINT AND RESET LAST TOTALS                  
         MVC   BOXCOLS,SVBXCOLS    RESET BOXES TO DETAIL REPORT                 
*                                                                               
         BRAS  RE,CLSREMOT         CLOSE PQ REPORT                              
*                                                                               
         ZAP   PAGE,PONE           RESET PAGE COUNT AND FORCE THROW             
         ZAP   LINE,P99                                                         
*                                                                               
PRCR22   MVC   HALF,LSTGRP         START NEW REPORT                             
         BRAS  RE,GETAGYID                                                      
         OC    SVE.SRTUSER,SVE.SRTUSER SKIP IF DESTINATION USER SET             
         BNZ   PRCR24              WON'T BE IF GROUP REPORT                     
         MVC   SVE.SRTUSER,WORK    IF NOT, SEND REPORT TO PRINCIPLE ID          
         OC    WORK+14(2),WORK+14  BUT IF AGY HAS SECURITY AGY                  
         BZ    PRCR24                                                           
         MVC   HALF,WORK+14        GET PRINCIPLE ID FROM THAT                   
         BRAS  RE,GETAGYID         SHOULDN'T - SRTGRP SHOULD BE SECAGY          
         MVC   SVE.SRTUSER,WORK                                                 
PRCR24   MVC   AGYCTRY,WORK+13     SAVE COUNTRY                                 
         MVC   AGYLANG,WORK+12     SAVE LANGUAGE                                
         MVC   AGYPPS,WORK+16      SAVE PPS FLAGS                               
*                                                                               
         MVC   HALF,SVE.SRTUSER    GET SYSTEM ELEMENTS FROM 'REPORTING'         
         BRAS  RE,GETSYELS         USER ID FOR CT21 REPORTING                   
*                                                                               
         MVC   PGEAGY,EFFS         CLEAR PAGE DETAILS                           
         MVC   PGEUSR,EFFS                                                      
*                                                                               
         CLI   LSTSRT,SRTSDDS      DDS REPORT?                                  
         BE    PRCR30              YES, NO MORE TO SET UP                       
*                                                                               
         CLC   LSTPRFGP,LSTGRP     CHECK PROFILE GROUP CHECKED                  
         BE    PRCR26                                                           
         MVC   LSTPRFGP,LSTGRP                                                  
         BRAS  RE,GETPRF           GET PROFILE FOR THIS GROUP                   
*                                                                               
PRCR26   CLC   DDPLANG,AGYLANG     IF NEW LANGUAGE                              
         BE    PRCR28                                                           
         MVC   DDPLANG,AGYLANG                                                  
         ICM   RF,15,AMASTC                                                     
         MVC   MCLANG-MASTC(,RF),DDPLANG                                        
         MVI   PCTLFRST,C'Y'       RESET PRINTERL FIRST TIME FLAG               
         BRAS  RE,DICTATOR         RESET TABLE DICTIONARY REFS                  
*                                                                               
PRCR28   BRAS  RE,BLDREMOT         START NEW PQ REPORT                          
*                                                                               
*        CONTINUE EXISTING REPORT (SAME TYPE, GROUP OR USER)                    
*        OR FIRST RECORD FOR NEW REPORT                                         
*                                                                               
PRCR30   MVC   TOTSRT,LSTSRT       SAVE TYPE FOR TOTALS                         
         MVC   TOTGRP,LSTGRP       SAVE GROUP FOR TOTALS                        
*                                                                               
         CLC   LSTAGY,EFFS                                                      
         BE    *+14                                                             
         CLC   LSTAGY,LSTGRP       SAME AGENCY ALPHA                            
         BE    PRCR32              YES                                          
         MVC   LSTAGY,LSTGRP                                                    
         MVC   HALF,LSTGRP         SET NEW AGY 2 CHAR                           
         BRAS  RE,GETAGYID                                                      
         MVC   LSTAGYN,WORK+2      SET NEW PRINCIPLE ID                         
*                                                                               
PRCR32   CLC   PGEAGY,LSTAGY       IS AGY SAME AS LAST PAGE?                    
         MVC   PGEAGY,LSTAGY                                                    
         BNE   *+10                NO, SKIP                                     
         CLC   PGEUSR,LSTUSR       IS USERID ALSO SAME AS LAST PAGE?            
         MVC   PGEUSR,LSTUSR                                                    
         BE    PRCR36              BOTH SAME, TITLE UNCHANGED                   
*                                                                               
         ZAP   LINE,P99            NEW PAGE                                     
         MVC   TITLE,SPACES        (RE)BUILD TITLE                              
         MVI   TITLE+00,C'('                                                    
         MVC   TITLE+01(2),LSTAGY                                               
         MVI   TITLE+03,C')'                                                    
         MVC   TITLE+05(10),LSTAGYN                                             
         LA    R0,CR#SEREP                                                      
         XR    RF,RF                                                            
         ICM   RF,4,=X'0A'                                                      
         ICM   RF,2,DDPLANG                                                     
         GOTO1 VGETTXT,DMCB,(R0),(L'TITLE-16,TITLE+16),(C'R',0),0,     X        
               (X'88',0),(RF)                                                   
         CLI   LSTSRT,SRTSGRP      CURRENTLY GROUP REPORT NEEDS NO USER         
         BE    PRCR34              IN HEADING                                   
         XR    RF,RF                                                            
         IC    RF,4(,R1)           GET ACTUAL MESSAGE LENGTH                    
         LA    RF,TITLE+16(RF)     END OF MESSAGE                               
         MVC   HALF,RUSER          GET AND SAVE USERID                          
         BRAS  RE,GETUSRID                                                      
         MVI   0(RF),C';'                                                       
         MVC   2(L'L8@USRID,RF),L8@USRID                                        
         MVC   2+L'L8@USRID+1(L'LSTNAM,RF),LSTNAM                               
*                                                                               
PRCR34   GOTO1 VSQUASH,DMCB,TITLE,L'TITLE                                       
*                                                                               
PRCR36   CLI   MODE,MODEDUM        TEST DUMMY RECORD                            
         BNE   *+12                                                             
         MVI   HADDUMMY,C'Y'       YES. FLAG WE'VE HAD ONE                      
         B     PRCR10              AND IGNORE IT                                
*                                                                               
         TM    RTIME,X'40'         TRAILER RECORDS ON THIS FILE?                
         BZ    *+8                                                              
         MVI   TRAILER,C'Y'                                                     
*                                                                               
         TM    RTIME,X'80'         NEW STYLE TIME?                              
         BZ    PRCR38              NO                                           
         NI    RTIME,X'3F'         SETS NEW STYLE TIME TO OLD                   
         MVI   RTIME+3,X'C0'       STYLE TIME FOR OUTPUT                        
         ICM   R1,15,RTIME                                                      
         SRL   R1,4                                                             
         STCM  R1,15,RTIME                                                      
*                                                                               
PRCR38   CLI   TRAILER,C'Y'        TRAILER RECORDS?                             
         BE    *+14                YES - ALWAYS GET TERMINAL                    
         CLC   LSTTNUM,RTRM        IS TERMINAL NO SAME AS LAST ONE?             
         BE    *+8                                                              
         BRAS  RE,GETTRM           NO - GET IT                                  
*                                                                               
         BRAS  RE,CTCOUNT          ADD RECORD TO TOTALS                         
*                                                                               
         BRAS  RE,RECOUT           OUTPUT RECORD INFORMATION                    
*                                                                               
         B     PRCR10                                                           
*                                                                               
*        END OF SORT DATA                                                       
*                                                                               
PRCRX    BRAS  RE,SORTTOT          PRINT AND RESET TOTALS                       
*                                                                               
         BRAS  RE,CLSREMOT         CLOSE PQ REPORT                              
         B     EXITOK                                                           
         DROP  R2,SVE                                                           
*                                                                               
NATITLE  DC    CL(L'TITLE)'Security Report. Records with Missing Group'         
         EJECT                                                                  
***********************************************************************         
* GET A RECORD FROM THE SORT                                          *         
***********************************************************************         
GETFRSRT NTR1  BASE=*,LABEL=*                                                   
*                                                                               
GFS02    GOTO1 VSORTER,PLIST,GET,0                                              
         ICM   R2,15,PLIST+4       END OF FILE?                                 
         BZ    EXITL                                                            
         USING SRTBLKD,R2                                                       
         MVC   SRTSAVE,SRTBLKD                                                  
         USING RECDS,SRTRECH                                                    
*                                                                               
         MVI   MODE,MODEDUM        SET MODE=DUMMY                               
         OC    RECLN,RECLN         IS RECORD A DUMMY?                           
         BZ    EXITOK              YES, EXIT                                    
*                                                                               
         CLI   RRECTY,3            WAS RECORD AN ADD?                           
         BNE   GFS04               NO                                           
         MVI   MODE,MODEADD        SET MODE=ADD                                 
         TM    OUTTYPE,ADDOUT      OUTPUT ADD RECORDS?                          
         BZ    GFS02               NO                                           
*                                                                               
         L     R0,AIOSORT          MOVE IT INTO MAIN I/O AREA                   
         LHI   R1,IOL                                                           
         LA    RE,RECDS                                                         
         LH    RF,RECLN                                                         
         MVCL  R0,RE                                                            
*                                                                               
         L     R0,AIOCOPY          AND CLEAR COPY AREA                          
         LHI   R1,IOL                                                           
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         B     EXITOK                                                           
*                                                                               
GFS04    TM    OUTTYPE,CHNGOUT+DELOUT+RESTOUT                                   
         BZ    GFS02               ONLY ADDS REQUIRED                           
*                                                                               
         L     R0,AIOCOPY          MOVE COPY RECORD INTO COPY AREA              
         LHI   R1,IOL                                                           
         LA    RE,RECDS                                                         
         LH    RF,RECLN                                                         
         MVCL  R0,RE                                                            
*                                                                               
         L     R0,AIOSORT          MOVE CHANGE INTO CHANGE/ADD AREA             
         LHI   R1,IOL                                                           
         LA    RE,RECDS            CHANGE FOLLOWS COPY REMEMBER                 
         AH    RE,RECLN                                                         
         LH    RF,0(RE)                                                         
         MVCL  R0,RE                                                            
*                                                                               
         L     R4,AIOSORT          MAKE SURE THIS PAIR REALLY CHANGED           
         LH    R5,0(R4)                                                         
         AHI   R5,-(RCVFRST-RECDS)                                              
*                                                                               
         L     RE,AIOCOPY                                                       
         LH    RF,0(RE)                                                         
         AHI   RF,-(RCVFRST-RECDS)                                              
*                                                                               
         CR    R5,RF               MAKE SURE LENGTHS ARE SAME                   
         BNE   GFS06                                                            
*                                                                               
         AHI   R4,RCVFRST-RECDS    GO TO FIRST ACTUAL DATA                      
         AHI   RE,RCVFRST-RECDS                                                 
*                                                                               
         CLCL  R4,RE               TEST RECORDS ARE IDENTICAL                   
         BE    GFS02               YES - IGNORE THEM                            
*                                                                               
GFS06    LHI   RF,27               DISP TO STATUS FOR CTFILE                    
         CLI   RFILTY,CTFILEQ                                                   
         BE    GFS08                                                            
         LHI   RF,34               DISP TO STATUS FOR GENFILE                   
         CLI   RFILTY,GENFILQ                                                   
         BE    GFS08                                                            
         DC    H'0'                                                             
*                                                                               
GFS08    MVI   MODE,MODECHG        SET DEFAULT MODE=CHANGE                      
         AHI   RF,RCVFRST-RECDS                                                 
         STH   RF,HALF             SET DISP TO STATUS FROM START                
*                                                                               
         LH    R1,HALF                                                          
         A     R1,AIOSORT                                                       
         MVC   BYTE,0(R1)          SAVE STATUS BYTE OF CHANGE                   
         LH    R1,HALF                                                          
         A     R1,AIOCOPY                                                       
         MVC   BYTE1,0(R1)         SAVE STATUS BYTE OF COPY                     
*                                                                               
         TM    BYTE1,X'80'         COPY RECORD DELETED?                         
         BO    GFS10               YES                                          
         TM    BYTE,X'80'          CHANGE RECORD DELETED?                       
         BZ    GFS12               NO                                           
*                                                                               
         MVI   MODE,MODEDEL        SET MODE=DELETED                             
         TM    OUTTYPE,DELOUT      REQUIRE TO OUTPUT DELETED RECORDS?           
         BZ    GFS02               NO                                           
         B     EXITOK                                                           
*                                                                               
GFS10    TM    BYTE,X'80'          CHANGE RECORD DELETED ALSO                   
         BO    GFS12               YES                                          
*                                                                               
         MVI   MODE,MODERES        SET MODE=RESTORED                            
         TM    OUTTYPE,RESTOUT     REQUIRED TO OUTPUT RESTORED RECORDS?         
         BZ    GFS02               NO                                           
         B     EXITOK                                                           
*                                                                               
GFS12    TM    OUTTYPE,CHNGOUT     OUTPUT COPY/CHANGE PAIRS?                    
         BZ    GFS02                                                            
         B     EXITOK                                                           
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
* BUILD PRINT QUEUE KEY                                               *         
***********************************************************************         
BLDREMOT NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R4,VREMOTEC                                                      
         USING REMOTED,R4                                                       
SVE      USING SRTBLKD,SRTSAVE                                                  
*                                                                               
         XC    PROFKEY,PROFKEY     SET PARAM LIST FOR PQPROF                    
         XC    PQPREMOT,PQPREMOT                                                
         OC    SVE.SRTUSER,SVE.SRTUSER                                          
         JZ    BLDREM01                                                         
*                                                                               
         MVC   PROFKEY+0(3),=C'CSA' GET CSA PROFILE                             
         MVC   PROFKEY+3(2),SVE.SRTUSER                                         
         GOTO1 =V(PQPROF),DMCB,PROFKEY,PQPREMOT,ACOMFACS                        
         CLI   8(R1),0                                                          
         JNE   *+2                                                              
         MVC   PQPFLAG,0(R1)       SAVE PQPFLAG                                 
*                                                                               
BLDREM01 MVC   REMOTABF,VPQBUFF                                                 
         MVC   REMOTADM,VDMGR                                                   
         MVC   REMOTAOP,VPQOPN                                                  
         MVI   REMOTFLG,X'FA'      SET NEW STYLE LAYOUT FOR REMOTEC             
         MVI   REMOTCLS,C'A'                                                    
         MVI   REMOTCPY,1                                                       
         XC    REMOTPAG,REMOTPAG                                                
         XC    REMOTLIN,REMOTLIN                                                
         MVC   REMOTKEY(3),REMJIDS IDENTIFY AS SECURITY REPORT                  
         MVC   REMOTJID,REMJIDS                                                 
         MVC   REMOTDSC,REMDESCS                                                
         CLI   RPTYPE,C'P'                                                      
         BNE   BLDREM02                                                         
         MVC   REMOTKEY(3),REMJIDP IDENTIFY AS PROFILE REPORT                   
         MVC   REMOTJID,REMJIDP                                                 
         MVC   REMOTDSC,REMDESCP                                                
BLDREM02 XC    REMOTFNO,REMOTFNO                                                
         MVC   REMOTDST,SVE.SRTUSER                                             
*                                                                               
*&&US                                                                           
         MVI   REMOTRET,C'V'       US HAS 72 HRS RETENTION                      
         OC    REMOTDST,REMOTDST   MAKE SURE WE HAVE A USER                     
         BZ    BLDREM08                                                         
*                                                                               
         CLI   PQPREMOT+(REMOTRET-REMOTED),0                                    
         JE    *+10                                                             
         MVC   REMOTRET,PQPREMOT+(REMOTRET-REMOTED)                             
         MVC   REMOTARC,PQPREMOT+(REMOTARC-REMOTED)                             
         MVC   REMOTTY1,PQPREMOT+(REMOTTY1-REMOTED)                             
*                                                                               
         CLI   PQPFLAG,X'08'       ANY PQ REPORT                                
         JE    *+10                                                             
         XC    REMOTKEY,REMOTKEY   NO                                           
*                                                                               
         CLI   RUNTYPE,C'T'        TEST RUN?                                    
         BNE   EXITOK              NO, EXIT                                     
*                                                                               
         CLI   PQPFLAG,X'08'       ANY PQ REPORT                                
         JNE   EXITOK                                                           
*                                                                               
BLDREM08 LA    R2,17               US REROUTE TEST OUTPUT TO SJR PQ             
*&&                                                                             
*&&UK                                                                           
         MVI   REMOTRET,C'Z'       UK HAS 96 HRS RETENTION                      
         OI    REMOTTY1,REMOTARQ   ARCHIVE THESE REPORTS IN UK                  
         MVI   REMOTARC,C'A'       ARCHIVE THESE REPORTS IN UK                  
         CLI   RUNTYPE,C'T'        TEST RUN?                                    
         BNE   BLDREM04            NO, TEST LANGUAGE          *UK-TEMP*         
         LA    R2,38               UK REROUTE TEST OUTPUT TO DDS1 PQ            
         B     BLDREM06                                       *UK-TEMP*         
*                                                             *UK-TEMP*         
BLDREM04 DS    0H                                             *UK-TEMP*         
         CLI   RPTYPE,C'S'         IF NOT SECURITY REPORT     *UK-TEMP*         
         BE    EXITOK                                         *UK-TEMP*         
         CLI   AGYLANG,0           FOREIGN LANG NOT YET LIVE  *UK-TEMP*         
         BE    EXITOK                                         *UK-TEMP*         
         LA    R2,998              SO REROUTE TO TSTGR PQ     *UK-TEMP*         
*&&                                                                             
*                                                                               
BLDREM06 MVC   HALF,REMOTDST       GET ORIGINAL USERID NAME                     
         BRAS  RE,GETUSRID                                                      
         MVI   REMOTDSC,C'@'                                                    
         MVC   REMOTDSC+1(10),WORK+2 PUT IT INTO DESCRIPTION                    
         STCM  R2,3,REMOTDST       REROUTE DESTINATION                          
         NI    REMOTTY1,255-(REMOTARQ+REMOTAEQ)  DON'T WHEN REROUTED            
         MVI   REMOTARC,C' '                                                    
         B     EXITOK                                                           
*                                                                               
         DROP  R4,SVE                                                           
*                                                                               
REMJIDS  DC    CL3'CSA'                                                         
REMDESCS DC    CL11'Con/Sec FA'                                                 
REMJIDP  DC    CL3'CPA'                                                         
REMDESCP DC    CL11'Con/Pro FA'                                                 
         EJECT                                                                  
***********************************************************************         
* CLOSE PRINT QUEUE                                                   *         
***********************************************************************         
CLSREMOT NTR1  BASE=*,LABEL=*                                                   
         L     R4,VREMOTEC                                                      
         USING REMOTED,R4                                                       
*                                                                               
         OC    REMOTKEY(3),REMOTKEY TEST WE ARE ON THE PRINT QUEUE              
         BZ    EXITOK              NO, EXIT                                     
*                                                                               
         XC    FULL,FULL           CLOSE LAST REPORT                            
         GOTO1 VPRINT,DMCB,(5,=C'CLOSE'),FULL                                   
         B     EXITOK                                                           
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* RECORD OUTPUT ROUTINE                                               *         
***********************************************************************         
RECOUT   NTR1  BASE=*,LABEL=*                                                   
         L     R2,AIOSORT          GET A(ADD OR CHANGE RECORD)                  
         USING RECDS,R2                                                         
         L     R3,AADDNTRY         GET A(ENTRY)                                 
         USING ADDTABD,R3                                                       
SVE      USING SRTBLKD,SRTSAVE                                                  
*                                                                               
         ICM   RF,15,ADSKIP        IS THERE A ROUTINE TO SKIP RECORD            
         BZ    RECO02                                                           
         BASR  RE,RF               YES, GO TO IT                                
         BE    RECO02              IT SAYS TO PRINT THIS RECORD                 
         BRAS  RE,CTBACK           REMOVE RECORD FROM TOTALS                    
         B     EXITOK                                                           
*                                                                               
PH       USING PLINED,BOXCOLS                                                   
RECO02   MVI   PH.PLLEFT,C'L'                                                   
         MVI   PH.PLRIGHT,C'R'                                                  
         MVI   PH.PLC1,C'C'                                                     
         MVI   PH.PLC2,C'C'                                                     
         MVI   PH.PLICOL,C'-'                                                   
         MVI   PCTLBOX,C'O'        OPEN NEW BOX                                 
*                                                                               
         CLC   LSTPWIND,SVE.SRTPWIND TEST PW INDICATOR CHANGED                  
         MVC   LSTPWIND,SVE.SRTPWIND                                            
         BE    *+10                                                             
         ZAP   LINE,P99            YES, START NEW PAGE                          
*                                                                               
         ZAP   FULL,LINE                                                        
         AP    FULL,PRECFREE       NEED AT LEAST THIS MANY LINES FREE           
         CLI   MODE,MODECHG        COPY/CHANGE PAIRS                            
         BNE   *+10                                                             
         AP    FULL,=P'2'          TWO MORE FOR 'CURRENT'/'PREVIOUS'            
         CP    FULL,MAXLINE                                                     
         BL    RECO04                                                           
         ZAP   LINE,P99            START NEW PAGE IF NOT                        
*                                                                               
RECO04   LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
         XR    R1,R1               GET ACTION PERFORMED                         
         IC    R1,MODE                                                          
         BCTR  R1,0                                                             
         SLL   R1,2                                                             
         LA    R1,MODTAB(R1)                                                    
         MVC   PLTEXT(4),0(R1)                                                  
*                                                                               
         LHI   R0,L'ADFILENM       CHOP UP RECORD NAME FOR DISPLAY              
         LHI   RF,L'PLINFO                                                      
         GOTO1 VCHOPPER,DMCB,((R0),ADFILENM),((RF),PLINFO),(C'P',4)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
*                                                                               
         XR    R1,R1               GET ACTION PERFORMED                         
         IC    R1,MODE                                                          
         BCTR  R1,0                                                             
         SLL   R1,2                                                             
         LA    R1,MODTAB1(R1)                                                   
         MVC   PLTEXT(4),0(R1)                                                  
*                                                                               
         OC    RPERSON,RPERSON     ONLINE HAS EITHER 0000 OR PERSON ID          
         BNZ   *+14                                                             
         MVC   PLINFO,LC@UNKNW                                                  
         B     RECO06                                                           
*                                                                               
         CLC   =X'0001',RPERSON    OFFLINE HAS 0001 IN RPERSON                  
         BNE   *+14                                                             
         MVC   PLINFO,LC@OFFLN                                                  
         B     RECO06                                                           
*                                                                               
         MVC   FULL+0(2),LSTAGY                                                 
         MVC   FULL+2(2),RPERSON                                                
         BRAS  RE,GETPID                                                        
         MVC   PLINFO(8),WORK+2    NORMALLY E.G. CHANGED BY PIDNAME             
         CLC   WORK+2(8),LC@UNKNW  DID WE FIND A PID?                           
         BE    RECO06              NO, FORGET FULL NAME                         
*                                                                               
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    RECO06              YES, IGNORE PROFILE                          
         CLI   LSTPRF05,C'Y'                                                    
         BNE   RECO06              PROFILE TO SHOW FULL NAME                    
         CLC   RPERSON,=Y(4096)                                                 
         BNL   RECO05              OK IF NOT A DDS PERSON                       
*&&UK*&& CLC   LSTAGY,=C'#E'                                                    
*&&US*&& CLC   LSTAGY,=C'#N'       TEST DDS SECURITY AGENCY                     
         BNE   RECO06              DON'T SHOW DDS NAMES TO CLIENTS              
*                                                                               
RECO05   MVC   WORK(2),LSTAGY                                                   
         BRAS  RE,GETPEN           GET PERSON RECORD IN IOTEMP                  
         L     RF,AIOTEMP                                                       
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SANAMELQ',(RF)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   RECO06              NO NAME                                      
*                                                                               
         MVC   DUB,WORK+2          SAVE PIDNAME                                 
         MVC   WORK(21+61+11),SPACES FIRSTNAME + LASTNAME + PID                 
*&&US                                                                           
         MVC   WORK(8),DUB         PIDNAME <FIRSTNAME LASTNAME>                 
         MVI   WORK+9,C'<'                                                      
*&&                                                                             
         L     RF,12(R1)                                                        
         USING SANAMD,RF           RF=A(PERSON NAME ELEMENT)                    
         LA    RE,SANAMES                                                       
         XR    R1,R1                                                            
         TM    SANAMIND,SANAMIFN                                                
         BZ    RECO05A                                                          
         IC    R1,0(,RE)                                                        
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
*&&UK*&& MVC   WORK(0),1(RE)       FIRSTNAME                                    
*&&US*&& MVC   WORK+10(0),1(RE)    FIRSTNAME                                    
         LA    RE,2(R1,RE)                                                      
RECO05A  TM    SANAMIND,SANAMIMN                                                
         BZ    RECO05B                                                          
         IC    R1,0(,RE)                                                        
         LA    RE,1(R1,RE)                                                      
RECO05B  TM    SANAMIND,SANAMILN                                                
         BZ    RECO05C                                                          
         IC    R1,0(,RE)                                                        
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
*&&UK*&& MVC   WORK+21(0),1(RE)    LASTNAME                                     
*&&US*&& MVC   WORK+10+21(0),1(RE) LASTNAME                                     
         DROP  RF                                                               
*&&UK                                                                           
RECO05C  MVI   WORK+21+61,C'('                                                  
         MVC   WORK+21+61+1(8),DUB FIRSTNAME LASTNAME (PIDNAME)                 
         LA    R1,WORK+21+61+9-1                                                
         CLI   0(R1),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         MVI   1(R1),C')'                                                       
*&&                                                                             
*&&US                                                                           
RECO05C  LA    R1,WORK+10+21+60-1                                               
         CLI   0(R1),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         MVI   1(R1),C'>'                                                       
*&&                                                                             
         GOTO1 VSQUASH,DMCB,WORK,21+61+11                                       
*                                                                               
         LHI   R0,21+61+11         CHOP UP NAME FOR DISPLAY                     
         LHI   RF,L'PLINFO                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLINFO),(C'P',10)                
         ICM   R0,15,8(R1)                                                      
         BCTR  R0,0                                                             
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
*                                                                               
RECO06   AHI   R4,L'PLINE                                                       
         MVCDD PLTEXT,GE#ATTRM,L                                                
         CLI   LSTTISTK,C'Y'                                                    
         BNE   *+10                                                             
         MVCDD PLTEXT,CT#TICKT,L                                                
         MVC   PLINFO(L'LSTTNAM),LSTTNAM                                        
         AHI   R4,L'PLINE                                                       
*                                                                               
RECO08   MVC   PLTEXT,LC@TIME                                                   
*                                                                               
         UNPK  DUB(7),RTIME        EDIT TIME OF ACTION                          
         OI    DUB+6,C'0'                                                       
         MVC   PLINFO(2),DUB+1                                                  
         MVI   PLINFO+2,C':'                                                    
         MVC   PLINFO+3(2),DUB+3                                                
         MVI   PLINFO+6,C'/'                                                    
         GOTO1 VDATCON,DMCB,(3,RDATE),(8,PLINFO+8),0                            
*                                                                               
         ICM   RF,15,ADODFLT                                                    
         TM    OUTTYPE,DETLOUT     DETAILED OUTPUT?                             
         BZ    *+8                 NO                                           
         ICM   RF,15,ADODETL                                                    
         BASR  RE,RF                                                            
*                                                                               
         BRAS  RE,PRNT                                                          
         LA    R4,PBLOCK           RESET PBLOCK                                 
*                                                                               
         CLI   MODE,MODECHG        COPY/CHANGE PAIRS GOING OUT?                 
         BNE   RECO10              NO                                           
PC       USING PLINED,BOXCOLS                                                   
         MVI   PC.PLICOL,C'C'                                                   
         DROP  PC                                                               
*                                                                               
RECO10   MVI   PCTLBOX,C'D'        PRINT DOTTED LINE                            
         DROP  R3                                                               
*                                                                               
         LHI   R3,42               GENFILE                                      
         LHI   R5,34               GENFILE STATUS                               
         MVI   STALNGTH,4                                                       
         CLI   RFILTY,X'A3'        CHECK FOR GEN                                
         BH    *+16                                                             
         LHI   R3,28               CTFILE                                       
         LHI   R5,27               CTFILE STATUS                                
         MVI   STALNGTH,1                                                       
         LA    R6,RCVFRST(R5)                                                   
         LA    R2,RCVFRST(R3)      WATCH OUT!! USING R2,RECDS                   
*                                                                               
         CLI   MODE,MODEDEL        DELETE - OUTPUT ALL ELEMENTS REMOVED         
         BNE   RECO12                                                           
         ST    R2,WHRCOPY                                                       
         ST    R6,STACOPY                                                       
         XC    WHRCHNG,WHRCHNG                                                  
         XC    STACHNG,STACHNG                                                  
         B     RECO20                                                           
*                                                                               
RECO12   CLI   MODE,MODERES        RESTORE - OUTPUT ALL ELEMENTS ADDED          
         BNE   RECO14                                                           
         ST    R2,WHRCHNG                                                       
         ST    R6,STACHNG                                                       
         XC    WHRCOPY,WHRCOPY                                                  
         XC    STACOPY,STACOPY                                                  
         B     RECO20                                                           
*                                                                               
RECO14   CLI   MODE,MODEADD        ADD - OUTPUT ALL ELEMENTS ADDED              
         BNE   RECO16                                                           
         ST    R2,WHRCHNG                                                       
         ST    R6,STACHNG                                                       
         XC    WHRCOPY,WHRCOPY                                                  
         XC    STACOPY,STACOPY                                                  
         B     RECO20                                                           
*                                                                               
RECO16   CLI   MODE,MODECPY        SPECIAL - OUTPUT COPIES ONLY                 
         BNE   RECO18                                                           
         L     R2,AIOCOPY                                                       
         LA    R2,RCVFRST(R3)      FIRST DATA OF COPY RECORD                    
         ST    R2,WHRCHNG          THEN OUTPUT AS ADDS                          
         L     R2,AIOCOPY                                                       
         LA    R6,RCVFRST(R5)                                                   
         ST    R6,STACHNG                                                       
         XC    WHRCOPY,WHRCOPY                                                  
         XC    STACOPY,STACOPY                                                  
         B     RECO20                                                           
*                                                                               
RECO18   CLI   MODE,MODECHG        COPY/CHANGE PAIRS                            
         BNE   RECOUTX                                                          
*                                                                               
         MVCDD PLNINF,CT#CURNT,L                                                
         MVCDD PLOINF,CT#PREV,L                                                 
         BRAS  RE,PRNT                                                          
         MVI   PCTLBOX,C'D'        PRINT DOTTED LINE                            
*                                                                               
         ST    R2,WHRCHNG                                                       
         L     R2,AIOCOPY                                                       
         LA    R2,RCVFRST(R3)                                                   
         ST    R2,WHRCOPY                                                       
         ST    R6,STACHNG                                                       
         L     R2,AIOCOPY                                                       
         LA    R6,RCVFRST(R5)                                                   
         ST    R6,STACOPY                                                       
*                                                                               
RECO20   BRAS  RE,STAINFO                                                       
*                                                                               
         BRAS  RE,ELSINFO                                                       
*                                                                               
RECOUTX  MVI   PCTLBOX,C'C'        PRINT CLOSE BOX                              
         GOTO1 VPRINTER                                                         
         B     EXITOK                                                           
         DROP  R4,PH,SVE                                                        
*                                                                               
MODTAB   DS    0CL4                                                             
         DCDD  CT#ADDRC,15,PAD=NONE                                             
         DCDD  CT#CHARC,15,PAD=NONE                                             
         DCDD  CT#DELRC,15,PAD=NONE                                             
         DCDD  CT#RESRC,15,PAD=NONE                                             
         DCDD  CT#UNKNW,15,PAD=NONE                                             
*                                                                               
MODTAB1  DS    0CL4                                                             
         DCDD  CT#ADDBY,15,PAD=NONE                                             
         DCDD  CT#CHABY,15,PAD=NONE                                             
         DCDD  CT#DELBY,15,PAD=NONE                                             
         DCDD  CT#RESBY,15,PAD=NONE                                             
         DCDD  CT#UNKNW,15,PAD=NONE                                             
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO OUTPUT STATUS CHANGE IN HEX                              *         
***********************************************************************         
STAINFO  NTR1  BASE=*,LABEL=*                                                   
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   EXITOK              NO, DON'T PRINT HEX STATUS                   
*                                                                               
         LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
*                                                                               
         XC    DUB,DUB                                                          
         ICM   R2,15,STACOPY                                                    
         BZ    *+10                                                             
         MVC   DUB(4),0(R2)                                                     
         ICM   R3,15,STACHNG                                                    
         BZ    *+10                                                             
         MVC   DUB+4(4),0(R3)                                                   
*                                                                               
         MVC   WORK(8),DUB         CHECK IF STATUS HAS CHANGED                  
         NI    WORK,X'7F'          BUT IGNORE DELETE BITS                       
         NI    WORK+4,X'7F'                                                     
         XR    R1,R1                                                            
         IC    R1,STALNGTH                                                      
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         BE    EXITOK              STATUS BYTES UNCHANGED OR NOT SET            
         CLC   WORK(0),WORK+4                                                   
*                                                                               
         MVC   PLTEXT(14),=C'Status Byte(s)'                                    
*                                                                               
         XR    R0,R0                                                            
         IC    R0,STALNGTH                                                      
*                                                                               
         LTR   R2,R2               COPY STATUS PRESENT?                         
         BZ    SINF02                                                           
*                                                                               
         GOTO1 VHEXOUT,PLIST,DUB,PLOINF,(R0),0                                  
*                                                                               
SINF02   LTR   R3,R3               CHANGE STATUS PRESENT?                       
         BZ    SINF04                                                           
*                                                                               
         GOTO1 VHEXOUT,PLIST,DUB+4,PLNINF,(R0),0                                
*                                                                               
SINF04   BRAS  RE,PRNT                                                          
         B     EXITOK                                                           
*                                                                               
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* OUTPUT ELEMENT UNRESOLVED COPY/CHANGE INFO AS REQUIRED              *         
*                                                                     *         
* NTRY:  WHRCOPY  = A(1ST ELEMENT IN COPY RECORD OR ZERO)             *         
*        WHRCHNG  = A(1ST ELEMENT IN CHANGE RECORD OR ZERO)           *         
***********************************************************************         
ELSINFO  NTR1  BASE=*,LABEL=*                                                   
         LHI   RF,1                SET FOR FIRST ELEMENT                        
*                                                                               
ELS02    STC   RF,THISELM          BUILD LISTS FOR COPY/CHANGE PAIRS            
         BRAS  RE,LSTELMS                                                       
*                                                                               
         L     R3,ACOPY            CHECK IF ANYTHING FOUND                      
         CLI   0(R3),X'FF'                                                      
         BNE   ELS03                                                            
         L     R3,ACHNG                                                         
         CLI   0(R3),X'FF'                                                      
         BE    ELS06               NO, NEXT ELEMENT CODE                        
*                                                                               
ELS03    LA    R1,THISELM          GET ELEMENT TABLE ENTRY                      
         BRAS  RE,GETELTAB                                                      
*                                                                               
         BRAS  RE,MCHELMS          MATCH BEF/AFT ELEMENTS                       
*                                                                               
         L     R3,ACOPY            CHECK IF ANYTHING LEFT TO OUTPUT NOW         
         CLI   0(R3),X'FF'                                                      
         BNE   ELS04                                                            
         L     R3,ACHNG                                                         
         CLI   0(R3),X'FF'                                                      
         BE    ELS06               NO, NEXT ELEMENT CODE                        
*                                                                               
ELS04    ZAP   FULL,LINE                                                        
         AP    FULL,PELMFREE       NEED AT LEAST THIS MANY LINES FREE           
         CP    FULL,MAXLINE                                                     
         BL    ELS05                                                            
         ZAP   LINE,P99            START NEW PAGE IF NOT                        
*                                                                               
ELS05    L     R4,AELMNTRY         OUTPUT ELEMENT INFO                          
         USING CTELEMD,R4                                                       
         MVC   DUB+0(4),ACOPY                                                   
         MVC   DUB+4(4),ACHNG                                                   
         GOTO1 CTRPOUT,DUB         CALL PAIR OUTPUT ROUTINE                     
*                                                                               
ELS06    XR    RF,RF               NEXT POSSIBLE ELEMENT CODE                   
         IC    RF,THISELM                                                       
         AHI   RF,1                                                             
         CHI   RF,256              FOR ALL ELEMENT CODES                        
         BL    ELS02                                                            
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* BUILD LIST OF MATCHING ELEMENTS FOR RECORD GIVEN ELEMENT CODE       *         
*                                                                     *         
* NTRY:  THISELM  = ELEMENT TO LIST                                   *         
*        WHRCOPY  = A(1ST ELEMENT IN COPY RECORD OR ZERO)             *         
*        WHRCHNG  = A(1ST ELEMENT IN CHANGE RECORD OR ZERO)           *         
* EXIT:  AELADDS  = ADDRESSES OF MATCHING ELEMENTS                    *         
*        ACOPY    = A(FIRST COPY IN ELADDS - FF DELIMTS END)          *         
*        ACHNG    = A(FIRST CHANGE IN ELADDS - FF DELIMTS END)        *         
***********************************************************************         
LSTELMS  NTR1  BASE=*,LABEL=*                                                   
         L     R3,AELADDS                                                       
         LR    R0,R3                                                            
         LHI   R1,ELADDSL                                                       
         XR    RF,RF                                                            
         MVCL  R0,RE               CLEAR BUILD AREA                             
*                                                                               
         ST    R3,ACOPY            SET A(COPY LIST)                             
         ICM   R2,15,WHRCOPY                                                    
         BZ    LELM04                                                           
         LA    R2,0(,R2)           ENSURE HOB IS CLEAR                          
*                                                                               
         XR    RF,RF                                                            
LELM02   CLI   0(R2),0             EOR?                                         
         BE    LELM04                                                           
         CLC   THISELM,0(R2)       MATCH ELEMENT CODE                           
         BNE   *+12                                                             
         ST    R2,0(R3)            SAVE A(ELEMENT)                              
         AHI   R3,4                NEXT IN LIST                                 
         ICM   RF,1,1(R2)                                                       
         BZ    LELM04                                                           
         BXH   R2,RF,LELM02                                                     
*                                                                               
LELM04   MVC   0(4,R3),EFFS        DELIMIT COPY LIST                            
         AHI   R3,4                                                             
*                                                                               
         ST    R3,ACHNG            SET A(CHANGE LIST)                           
         ICM   R2,15,WHRCHNG                                                    
         BZ    LELM08                                                           
         LA    R2,0(,R2)           ENSURE HOB IS CLEAR                          
*                                                                               
         XR    RF,RF                                                            
LELM06   CLI   0(R2),0             EOR?                                         
         BE    LELM08                                                           
         CLC   THISELM,0(R2)       MATCH ELEMENT CODE                           
         BNE   *+12                                                             
         ST    R2,0(R3)            SAVE A(ELEMENT)                              
         AHI   R3,4                NEXT IN LIST                                 
         ICM   RF,1,1(R2)                                                       
         BZ    LELM08                                                           
         BXH   R2,RF,LELM06                                                     
*                                                                               
LELM08   MVC   0(4,R3),EFFS        DELIMIT CHANGE LIST                          
*                                                                               
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* COMPARE LISTS OF COPY/CHANGE PAIRS                                  *         
* EMPTY BOTH LISTS IF ALL ELEMENTS MATCH                              *         
* REMOVE ALL THAT MATCH IF NOT PRINTING ALL ELEMENTS                  *         
*                                                                     *         
* NTRY:  AELADDS  = ADDRESSES OF COPY/CHANGE ELEMENTS LISTED          *         
*        ACOPY    = A(FIRST COPY IN ELADDS - 4XFF DELIMITS END)       *         
*        ACHNG    = A(FIRST CHANGE IN ELADDS - 4XFF DELIMITS END)     *         
* EXIT:  AELADDS  = ADDRESSES OF NON-PAIRED ELEMENTS ONLY             *         
*        ACOPY    = A(FIRST COPY IN ELADDS UPDATED)                   *         
*        ACHNG    = A(FIRST CHANGE IN ELADDS UPDATED)                 *         
***********************************************************************         
MCHELMS  NTR1  BASE=*,LABEL=*                                                   
         L     R3,ACOPY                                                         
MEL02    CLC   0(4,R3),EFFS        RESOLVED ALL POSSIBLE?                       
         BE    MEL14               YES                                          
*                                                                               
         L     RF,0(,R3)           GET A(COPY)                                  
         XR    R1,R1                                                            
         IC    R1,1(RF)                                                         
         BCTR  R1,0                GET L'COPY (FOR EXECUTED COMPARE)            
*                                                                               
         L     R4,ACHNG                                                         
MEL04    CLC   0(4,R4),EFFS        END OF CHANGES                               
         BE    MEL08               YES, SO COPY DOESN'T MATCH CHANGE            
         CLI   0(R4),X'FF'         IGNORE MATCHED ELEMENTS                      
         BE    MEL06                                                            
         L     RE,0(,R4)           GET A(CHANGE)                                
         EX    R1,MELCLC                                                        
         BNE   MEL06               ELEMENTS DON'T MATCH                         
         MVI   0(R3),X'FF'         MARK ELEMENTS MATCHED                        
         MVI   0(R4),X'FF'                                                      
         B     MEL10               GET NEXT COPY ELEMENT                        
MELCLC   CLC   0(0,RF),0(RE)                                                    
*                                                                               
MEL06    AHI   R4,4                NEXT CHANGE ELEMENT                          
         B     MEL04                                                            
*                                                                               
MEL08    TM    ELIND,CTEIBASQ      AT LEAST ONE ELEMENT DOESN'T MATCH           
         BO    MEL14               THAT'S ALL WE NEED IF PRINTING ALL           
*                                                                               
MEL10    AHI   R3,4                NEXT COPY ELEMENT                            
         B     MEL02                                                            
*                                                                               
MEL14    L     R3,ACOPY            CLOSE UP GAPS ON COPIES AND CLEAR            
         LR    R4,R3               MATCHED FLAGS                                
         XR    R2,R2               COUNT UNMATCHED                              
*                                                                               
MEL16    CLC   0(4,R3),EFFS                                                     
         BE    MEL18               END OF COPIES                                
         CLI   0(R3),X'FF'         DID ELEMENT MATCH?                           
         BE    MEL16A              YES, SKIP                                    
         AHI   R2,1                COUNT UNMATCHED                              
         B     MEL16B              KEEP ELEMENT                                 
MEL16A   TM    ELIND,CTEIBASQ      IF NOT PRINTING MATCHED ELEMENTS             
         BZ    MEL16C              DROP THEM                                    
MEL16B   MVC   0(4,R4),0(R3)       KEEP ELEMENT                                 
         MVI   0(R4),0             CLEAR FLAG                                   
         AHI   R4,4                                                             
MEL16C   AHI   R3,4                                                             
         B     MEL16                                                            
*                                                                               
MEL18    MVC   0(4,R4),EFFS        TERMINATE COPIES                             
         AHI   R4,4                                                             
         L     R3,ACHNG            CLOSE UP GAPS ON CHANGES                     
         ST    R4,ACHNG                                                         
*                                                                               
MEL20    CLC   0(4,R3),EFFS                                                     
         BE    MEL22               END OF CHANGES                               
         CLI   0(R3),X'FF'         DID ELEMENT MATCH?                           
         BE    MEL20A              YES, SKIP                                    
         AHI   R2,1                COUNT UNMATCHED                              
         B     MEL20B              KEEP ELEMENT                                 
MEL20A   TM    ELIND,CTEIBASQ      IF NOT PRINTING MATCHED ELEMENTS             
         BZ    MEL20C              DROP THEM                                    
MEL20B   MVC   0(4,R4),0(R3)       KEEP ELEMENT                                 
         MVI   0(R4),0             CLEAR FLAG                                   
         AHI   R4,4                                                             
MEL20C   AHI   R3,4                                                             
         B     MEL20                                                            
*                                                                               
MEL22    MVC   0(4,R4),EFFS        TERMINATE CHANGES                            
*                                                                               
         TM    ELIND,CTEIBASQ      TEST PRINTING MATCHED                        
         BZ    EXITOK              NO, EXIT                                     
         LTR   R2,R2               WERE THERE ANY UNMATCHED?                    
         BNZ   EXITOK              YES, EXIT                                    
         L     R3,ACOPY            CLEAR OUT BOTH ELEMENT LISTS AS ALL          
         MVC   0(8,R3),EFFS        ELEMENTS HAVE MATCHED                        
         AHI   R3,4                                                             
         ST    R3,ACHNG                                                         
*                                                                               
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* GET ELEMENT TABLE ENTRY FOR THIS PARTICULAR RECORD                  *         
* NTRY: R1       = A(ELEMENT TO MATCH)                                *         
*       AADDNTRY = A(ADDTAB TABLE ENTRY)                              *         
* EXIT: AELMNTRY = A(ELEMENT TABLE ENTRY)                             *         
***********************************************************************         
GETELTAB NTR1  BASE=*,LABEL=*                                                   
         XR    RF,RF                                                            
         IC    RF,0(R1)            GET ELEMENT CODE                             
         BCTR  RF,0                                                             
         MHI   RF,4                                                             
         A     RF,ACTELEMS         INDEX INTO ELEMENT TABLE                     
         L     R3,0(RF)                                                         
         USING CTELEMD,R3                                                       
         ST    R3,AELMNTRY         SAVE A(ELEMENT TABLE ENTRY)                  
*                                                                               
         L     R2,AADDNTRY                                                      
         USING ADDTABD,R2                                                       
         LA    RF,CTESYS           GET BEST TEXT MATCH FOR ELEMENT              
*                                                                               
X        USING CTESYS,RF                                                        
GEL06    CLI   X.CTESYS,0          SYSTEM 0 MEANS MATCH ALL                     
         BE    *+14                                                             
         CLC   X.CTESYS,ADFTYPE                                                 
         BNE   GEL08                                                            
*                                                                               
         CLI   X.CTEFREC,0         RECORD 0 MEANS MATCH ALL                     
         BE    *+14                                                             
         CLC   X.CTEFREC,ADRECNUM                                               
         BNE   GEL08                                                            
         MVC   ELNAMEC,X.CTENAME   SAVE NAME                                    
         MVC   ELIND,X.CTEIND      SAVE INDICATOR                               
         B     EXITOK                                                           
*                                                                               
GEL08    AHI   RF,CTFVARL          NEXT ELEMENT ENTRY                           
         B     GEL06                                                            
         DROP  R2,R3,X                                                          
         EJECT                                                                  
***********************************************************************         
* DEFAULT KEY OUTPUT ROUTINE                                          *         
***********************************************************************         
         USING RECDS,R2                                                         
DEFKYOUT NTR1  BASE=*,LABEL=*                                                   
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         LHI   R0,32               GEN FILES                                    
         CLI   RFILTY,CTFILEQ                                                   
         BNE   *+8                                                              
         LHI   R0,25               CTFILE                                       
*                                                                               
         AHI   R2,RCVFRST-RECDS                                                 
         GOTO1 VHEXOUT,PLIST,(R2),PLDATA,(R0),0                                 
         BRAS  RE,PRNT                                                          
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* DEFAULT ELEMENT PAIR HANDLER                                        *         
* NTRY: P1        = A(COPY RECORD OR 0)                               *         
*       P2        = A(CHANGE RECORD OR 0)                             *         
*       AELMNTRY  = A(ELEMENT TABLE ENTRY FOR THIS ELEMENT)           *         
***********************************************************************         
DEFPAIR  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R3,0(R1)                                                      
         LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
*                                                                               
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    *+12                YES, SKIP                                    
         TM    ELIND,CTEIDDSQ      ELSE TEST WHOLE ELEMENT DDS ONLY             
         BO    EXITOK              YES, IGNORE IT                               
*                                                                               
         L     R5,AELMNTRY                                                      
         USING CTELEMD,R5                                                       
         LHI   R0,L'ELNAMEC                                                     
         LHI   RF,L'PLELEM                                                      
         GOTO1 VCHOPPER,DMCB,((R0),ELNAMEC),((RF),PLELEM),(C'P',3)              
*                                                                               
         MVI   THISELMH,0          SET DIDN'T PRINT ELEMENT NAME YET            
*                                                                               
         XR    R0,R0               COUNT # OF COPIES                            
         LR    RF,R2                                                            
         BRAS  RE,COUNTEM                                                       
         BNE   DEFPP02             2+ COPIES OF THIS ELEMENT ON COPY            
*                                                                               
         LR    RF,R3                                                            
         BRAS  RE,COUNTEM                                                       
         BNE   DEFPP02             2+ COPIES OF THIS ELEMENT ON CHANGE          
*                                                                               
         XC    DMCB(12),DMCB                                                    
         CLC   0(4,R2),EFFS                                                     
         BE    *+10                                                             
         MVC   DMCB+00(4),0(R2)                                                 
         CLC   0(4,R3),EFFS                                                     
         BE    *+10                                                             
         MVC   DMCB+04(4),0(R3)                                                 
         ST    R4,DMCB+08                                                       
*                                                                               
         ICM   RF,15,CTRDOUT       DEFAULT INFORMATION OUTPUT                   
         TM    OUTTYPE,DETLOUT     WANT DETAILED OUTPUT?                        
         BZ    *+8                 NO                                           
         ICM   RF,15,CTRFOUT       DETAILED INFORMATION                         
*                                                                               
         LTR   RF,RF               ANY OUTPUT ROUTINE SET?                      
         BNZ   *+8                 YES                                          
         L     RF,APAIRHEX         USE DEFAULT (TO HEXOUT ELEMENT)              
         GOTO1 (RF),DMCB                                                        
         B     DEFPP10                                                          
*                                                                               
DEFPP02  CLI   MODE,MODECHG        ONLY CHANGES AND DELETES HAVE                
         BE    DEFPP04                                                          
         CLI   MODE,MODEDEL        COPY INFO ALSO                               
         BNE   DEFPP06                                                          
*                                                                               
DEFPP04  BRAS  RE,PRELPRT                                                       
         CLC   0(4,R2),EFFS        FINISHED WITH COPIES?                        
         BE    DEFPP06             YES                                          
*                                                                               
         MVC   DMCB+00(4),0(R2)    SET A(COPY ELEMENT)                          
         XC    DMCB+04(4),DMCB+04  CLEAR A(CHANGE ELEMENT)                      
         ST    R4,DMCB+08                                                       
*                                                                               
         ICM   RF,15,CTRDOUT       DEFAULT INFORMATION OUTPUT                   
         TM    OUTTYPE,DETLOUT                                                  
         BZ    *+8                                                              
         ICM   RF,15,CTRFOUT       DETAILED INFORMATION                         
*                                                                               
         LTR   RF,RF               OUTPUT ROUTINE SET?                          
         BNZ   *+8                 YES                                          
         L     RF,APAIRHEX         USE DEFAULT (TO HEXOUT ELEMENT)              
*                                                                               
         GOTO1 (RF),DMCB           DISPLAY SPECIAL FOR COPY                     
*                                                                               
         L     R4,FULL             NEXT LINE                                    
         AHI   R2,4                                                             
         B     DEFPP04                                                          
*                                                                               
DEFPP06  CLI   MODE,MODEDEL        DEL DOES NOT HAVE CHANGE INFO ALSO           
         BE    DEFPP10                                                          
*                                                                               
DEFPP08  BRAS  RE,PRELPRT                                                       
         CLC   0(4,R3),EFFS        FINISHED WITH CHANGES?                       
         BE    DEFPP10             YES                                          
*                                                                               
         XC    DMCB(12),DMCB                                                    
         MVC   DMCB+04(4),0(R3)    SET A(CHANGE ELEMENT)                        
         ST    R4,DMCB+08                                                       
*                                                                               
         ICM   RF,15,CTRDOUT       DEFAULT INFORMATION                          
         TM    OUTTYPE,DETLOUT                                                  
         BZ    *+8                                                              
         ICM   RF,15,CTRFOUT       DETAILED INFORMATION                         
*                                                                               
         LTR   RF,RF               OUTPUT ROUTINE SET?                          
         BNZ   *+8                 YES                                          
         L     RF,APAIRHEX         USE DEFAULT (TO HEXOUT ELEMENT)              
*                                                                               
         GOTO1 (RF),DMCB                                                        
         L     R4,FULL             NEXT PRINT LINE FREE                         
         AHI   R3,4                                                             
         B     DEFPP08                                                          
*                                                                               
DEFPP10  CLI   THISELMH,0          DID WE DO ELEMENT NAME YET?                  
         BNE   *+8                 NO                                           
         MVI   THISELMH,1          FORCE NAME OUT                               
         BRAS  RE,PRELPRT          PRINT LINES REMAINING                        
         B     EXITOK                                                           
*                                                                               
PRELPRT  ST    RE,SAVERE                                                        
         CLI   THISELMH,0                                                       
         BNE   PRELP02                                                          
         LHI   RF,L'PLINE*4                                                     
         LA    RF,PBLOCK(RF)         FROM THE 3 FOR ELEMENT DISPLAY             
         CR    R4,RF                                                            
         BL    PRELPRTX                                                         
*                                                                               
PRELP02  MVI   THISELMH,255                                                     
*                                                                               
PRELP04  BRAS  RE,PRNT                                                          
         LA    R4,PBLOCK                                                        
*                                                                               
PRELPRTX L     RE,SAVERE                                                        
         BR    RE                                                               
         DROP  R4,R5                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO OUTPUT IN HEX A PAIR OF ELEMENTS                         *         
* NTRY:  R2    = A(COPY ELEMENT)                                      *         
*        R3    = A(CHANGE ELEMENT)                                    *         
*        R4    = A(FIRST PRINT LINE TO USE)                           *         
***********************************************************************         
PAIRHEX  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
         XC    FULL,FULL                                                        
         LTR   R2,R2               COPY ELEMENT?                                
         BZ    PHEX02                                                           
*                                                                               
         XR    R0,R0               HEXOUT COPY ELEMENT                          
         IC    R0,1(R2)                                                         
         GOTO1 VHEXOUT,PLIST,0(R2),WORK,(R0),0                                  
*                                                                               
         SLL   R0,1                R0 = LENGTH OF DATA TO OUTPUT                
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,PLIST,((R0),WORK),((RF),PLOINF),(C'P',15)               
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL             SAVE MAX DISPLACEMENT                        
*                                                                               
PHEX02   LTR   R3,R3               CHANGE ELEMENT                               
         BZ    EXITOK                                                           
*                                                                               
PHEX04   XR    R0,R0                                                            
         IC    R0,1(R3)                                                         
         GOTO1 VHEXOUT,PLIST,0(R3),WORK,(R0),0                                  
*                                                                               
         SLL   R0,1                R0 = LENGTH OF DATA TO OUTPUT                
         LHI   RF,L'PLNINF         EITHER USE HALF OR ALL BLOCK                 
         CLI   MODE,MODECHG        DEPENDING ON WHETHER COPY EXISTS             
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,PLIST,((R0),WORK),((RF),PLNINF),(C'P',15)               
*                                                                               
         ICM   R0,15,8(R1)         FIND WHICH ELEMENT USED MORE LINES           
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* GET NAME FOR PROG NUMBER                                            *         
* NTRY:  R5    = A(RECOVERY RECORD)                                   *         
***********************************************************************         
         USING RECDS,R2                                                         
CTPGN    NTR1  BASE=*,LABEL=*                                                   
         XC    LSTPROG,LSTPROG     CLEAR LAST PROGRAM                           
         MVC   LSTPNUM,RPRG        SAVE PROGRAM NUMBER                          
         CLI   RPRG,0                                                           
         BNE   CTPGN02                                                          
         MVC   LSTPNAM,WORKER                                                   
         B     EXITOK                                                           
*                                                                               
CTPGN02  ICM   R5,15,ACTSE                                                      
         BNZ   CTPGN04                                                          
*                                                                               
         L     R5,VSELIST                                                       
         LH    RE,0(R5)                                                         
         L     RF,2(R5)                                                         
         LA    R5,6(R5)                                                         
         USING SELISTD,R5                                                       
         CLI   SESYS,X'0A'         GET CONTROL SYSTEM                           
         BE    CTPGN04                                                          
         BXLE  R5,RE,*-8                                                        
         DC    H'0'                Die if Control Not Found                     
*                                                                               
CTPGN04  ICM   R5,15,SEPGMS        R5 = A(PROGRAM TABLE)                        
         ST    R5,ACTPGMS                                                       
         LH    RE,0(R5)                                                         
         L     RF,2(R5)                                                         
         AHI   R5,6                                                             
         USING PGMLSTD,R5                                                       
         CLC   RPRG,PGMNUM         MATCH?                                       
         BE    VALPRNY                                                          
         BXLE  R5,RE,*-10                                                       
*                                                                               
         MVC   LSTPNAM,SPACES                                                   
         MVC   LSTPNAM+0(2),=CL2'X'''                                           
         GOTO1 VHEXOUT,DMCB,RPRG,LSTPNAM+2,1,0                                  
         MVI   LSTPNAM+4,C''''                                                  
         B     EXITOK                                                           
*                                                                               
VALPRNY  MVC   LSTPNAM,PGMNAME     GET NAME FOR PRINT                           
         MVC   LSTPNUM,PGMNUM      GET NUMBER FOR TEST                          
         B     EXITOK                                                           
         DROP  R2,R5                                                            
         EJECT                                                                  
***********************************************************************         
* ADD TO ACCUMULATOR TABLES                                           *         
***********************************************************************         
CTCOUNT  NTR1  BASE=*,LABEL=*                                                   
         XC    AADDNTRY,AADDNTRY                                                
*                                                                               
         L     R2,AIOSORT                                                       
         USING RECDS,R2                                                         
         MVC   BYTE,RFILTY                                                      
         CLI   RFILTY,GENFILQ      SPECIAL FOR GENFIL - USE GENDIR              
         BNE   *+8                                                              
         MVI   BYTE,GENDIRQ                                                     
         XR    R1,R1                                                            
*                                                                               
         L     R3,AADDTAB                                                       
         USING ADDTABD,R3                                                       
         LHI   RF,ADDTABLQ                                                      
*                                                                               
CTC02    CLI   ADFTYPE,0           RECORD NOT KNOWN                             
         BE    CTC06                                                            
         CLC   ADFTYPE,BYTE        MATCH FILE TYPE?                             
         BNE   CTC04               NO                                           
*                                                                               
         IC    R1,ADMTCHL          MATCH START OF KEY?                          
         BCTR  R1,0                                                             
         EX    R1,CTCCLC                                                        
         BE    CTC06               YES                                          
*                                                                               
CTC04    BXH   R3,RF,CTC02         NEXT ENTRY IN TABLE                          
         DC    H'0'                                                             
*                                                                               
CTCCLC   CLC   ADMTCHC(0),RCVFRST                                               
*                                                                               
CTC06    CLI   MODE,MODEERR                                                     
         BE    EXITL               IGNORE BAD RECORDS                           
         IC    R1,MODE                                                          
         BCTR  R1,0                                                             
         MHI   R1,L'ADBADD         R1 = A(INDEX INTO ACCUMULATOR TABLE)         
*                                                                               
         ST    R3,AADDNTRY         SAVE A(ENTRY)                                
*                                                                               
         LA    RF,ADBUCS(R1)       UPDATE COUNT OF ENTRIES                      
         ICM   R0,15,0(RF)                                                      
         AHI   R0,1                                                             
         STCM  R0,15,0(RF)                                                      
         ST    RF,LSTCT            SAVE A(COUNTER) IN CASE WE BACK IT           
*                                                                               
         L     R3,AADDTOTS                                                      
         LA    RF,ADBUCS(R1)       UPDATE TOTALS COUNT                          
         ICM   R0,15,0(RF)                                                      
         AHI   R0,1                                                             
         STCM  R0,15,0(RF)                                                      
         ST    RF,LSTCTT           SAVE A(COUNTER) IN CASE WE BACK IT           
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* BACK OUT LAST ADD TO ACCUMULATORS                                   *         
***********************************************************************         
CTBACK   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     RF,LSTCT            A(COUNTER) LAST INCREMENTED                  
         ICM   R0,15,0(RF)                                                      
         BCTR  R0,0                                                             
         STCM  R0,15,0(RF)                                                      
         XC    LSTCT,LSTCT         DIE IF WE TRY TO DO IT AGAIN                 
*                                                                               
         L     RF,LSTCTT           A(TOTAL COUNTER) LAST INCREMENTED            
         ICM   R0,15,0(RF)                                                      
         BCTR  R0,0                                                             
         STCM  R0,15,0(RF)                                                      
         XC    LSTCTT,LSTCTT       MAKE SURE WE DON'T DO IT TWICE               
*                                                                               
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* SUPPRESS RECORD IF ONLY ACTIVITY ELEMENT HAS CHANGED (SAACVD)       *         
***********************************************************************         
SKIPACT  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         CLI   MODE,MODECHG        ONLY APPLIES IF A CHANGE                     
         BNE   SKPAPRNT                                                         
*                                                                               
         L     R4,AIOSORT          PICK UP DETAILS OF OLD AND NEW               
         LH    R5,0(R4)                                                         
         L     RE,AIOCOPY                                                       
         LH    RF,0(RE)                                                         
*                                                                               
         CR    R5,RF               MAKE SURE LENGTHS ARE SAME                   
         BNE   SKPAPRNT            NO, SO OTHER CHANGES                         
*                                                                               
         AHI   R4,RCVFRST-RECDS    GO TO FIRST ACTUAL DATA                      
         AHI   R5,-(RCVFRST-RECDS)                                              
         AHI   RE,RCVFRST-RECDS                                                 
         AHI   RF,-(RCVFRST-RECDS)                                              
*                                                                               
         LR    R2,R4               FIND NEW ACTIVITY ELEMENT                    
         AHI   R2,SAASDATA-SAASREC                                              
         USING SAACVD,R2                                                        
         XR    R0,R0                                                            
SKPA10   CLI   SAACVEL,0                                                        
         BE    SKPAPRNT                                                         
         CLI   SAACVEL,SAACVELQ                                                 
         BNE   SKPA12                                                           
         CLI   SAACVLEN,SAACVLNQ                                                
         BE    SKPA20                                                           
SKPA12   IC    R0,SAACVLEN                                                      
         AR    R2,R0                                                            
         B     SKPA10                                                           
*                                                                               
SKPA20   LR    R1,R2                                                            
         SR    R1,R4                                                            
         AR    R1,RE               POINT TO SAME PLACE IN OLD REC               
         MVC   DUB(5),2(R1)        SAVE OLD CONTENT FROM LOCATION               
         MVC   2(5,R1),2(R2)       COPY NEW TO OLD                              
         CLCL  R4,RE               TEST RECORDS ARE NOW IDENTICAL               
         MVC   2(5,R1),DUB         RESTORE OLD CONTENT                          
         BE    SKPASKIP            IGNORE IF ONLY DATE/SEQ CHANGED              
         DROP  R2                                                               
*                                                                               
SKPAPRNT B     EXITOK                                                           
SKPASKIP B     EXITL                                                            
         EJECT                                                                  
***********************************************************************         
* SUPPRESS RECORD IF ONLY PERSON COUNT CHANGED                        *         
***********************************************************************         
SKIPPCO  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         CLI   MODE,MODECHG        ONLY APPLIES IF A CHANGE                     
         BNE   SKPCPRNT                                                         
*                                                                               
         L     R4,AIOSORT          PICK UP DETAILS OF OLD AND NEW               
         LH    R5,0(R4)                                                         
         L     RE,AIOCOPY                                                       
         LH    RF,0(RE)                                                         
*                                                                               
         CR    R5,RF               MAKE SURE LENGTHS ARE SAME                   
         BNE   SKPCPRNT            NO, SO OTHER CHANGES                         
*                                                                               
         AHI   R4,RCVFRST-RECDS    GO TO FIRST ACTUAL DATA                      
         AHI   R5,-(RCVFRST-RECDS)                                              
         AHI   RE,RCVFRST-RECDS                                                 
         AHI   RF,-(RCVFRST-RECDS)                                              
*                                                                               
         LR    R2,R4               FIND NEW PERSON COUNT ELEMENT                
         AHI   R2,SAOFDATA-SAOFREC                                              
         USING SAPCTD,R2                                                        
         XR    R0,R0                                                            
SKPC10   CLI   SAPCTEL,0                                                        
         BE    SKPCPRNT                                                         
         CLI   SAPCTEL,SAPCTELQ                                                 
         BE    SKPC20                                                           
         IC    R0,SAPCTLN                                                       
         AR    R2,R0                                                            
         B     SKPC10                                                           
*                                                                               
SKPC20   LA    R2,SAPCTVAL         LOCATE NEW TWO BYTE PERSON COUNT             
         LR    R1,R2                                                            
         SR    R1,R4                                                            
         AR    R1,RE               POINT TO SAME PLACE IN OLD REC               
         ICM   R0,3,0(R1)          SAVE OLD CONTENT AT LOCATION                 
         MVC   0(2,R1),0(R2)       COPY NEW TO OLD                              
         CLCL  R4,RE               TEST RECORDS ARE NOW IDENTICAL               
         STCM  R0,3,0(R1)          RESTORE CONTENTS                             
         BE    SKPCSKIP            IGNORE IF ONLY PERSON COUNT CHANGED          
         DROP  R2                                                               
*                                                                               
SKPCPRNT B     EXITOK                                                           
SKPCSKIP B     EXITL                                                            
         EJECT                                                                  
***********************************************************************         
* SUPPRESS PERSON RECORD IF ONLY ACTIVITY DATE OR EFFECTIVE DATE      *         
* (EFFECTIVE DATE CHANGE IS A FUDGE - SEE EFFDFIX) CHANGED. ALSO FUDGE*         
* PASSWORD CONTROL FIELD SO BLANK (DEFAULT) LOOKS SAME AS Y AND A     *         
* CHANGE FROM DEFAULT TO Y IS IGNORED THROUGHOUT.                     *         
***********************************************************************         
SKIPPER  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    SKPEPRNT            YES, DON'T TOUCH OR SKIP RECORD              
*                                                                               
         L     R4,AIOSORT          PICK UP DETAILS OF OLD AND NEW               
         AHI   R4,RCVFRST-RECDS    GO TO FIRST ACTUAL DATA                      
         L     R5,AIOCOPY                                                       
         AHI   R5,RCVFRST-RECDS                                                 
*                                                                               
SKPE10   LR    R2,R4               FIND NEW PERSON DETAIL ELEMENT               
         AHI   R2,SAOFDATA-SAOFREC                                              
         USING SAPERD,R2                                                        
         XR    R0,R0                                                            
SKPE12   CLI   SAPEREL,0                                                        
         BE    SKPE20                                                           
         CLI   SAPEREL,SAPERELQ                                                 
         BE    SKPE14                                                           
         IC    R0,SAPERLN                                                       
         AR    R2,R0                                                            
         B     SKPE12                                                           
SKPE14   CLI   SAPERPCN,C' '       TEST PASSWORD CONTROL VALUE SET              
         BH    *+8                                                              
         MVI   SAPERPCN,C'Y'       NO, MAKE IT LOOK LIKE IS DEFAULT Y           
*                                                                               
SKPE20   CLI   MODE,MODECHG        ONLY APPLIES IF A CHANGE                     
         BNE   SKPEPRNT                                                         
*                                                                               
         LR    R2,R5               FIND OLD PERSON DETAIL ELEMENT               
         AHI   R2,SAOFDATA-SAOFREC                                              
         XR    R0,R0                                                            
SKPE22   CLI   SAPEREL,0                                                        
         BE    SKPE30                                                           
         CLI   SAPEREL,SAPERELQ                                                 
         BE    SKPE24                                                           
         IC    R0,SAPERLN                                                       
         AR    R2,R0                                                            
         B     SKPE22                                                           
SKPE24   CLI   SAPERPCN,C' '       TEST PASSWORD CONTROL VALUE SET              
         BH    *+8                                                              
         MVI   SAPERPCN,C'Y'       NO, MAKE IT LOOK LIKE WAS DEFAULT Y          
         DROP  R2                                                               
*                                                                               
SKPE30   L     RE,AIOSORT                                                       
         L     RF,AIOCOPY                                                       
         CLC   0(2,RE),0(RF)       CHECK LENGTHS ARE SAME                       
         BNE   SKPEPRNT            NO, SO OTHER CHANGES                         
*                                                                               
         ICM   R0,3,SAPEDEF-SAPEREC(R5) SAVE OLD EFF DATE                       
         MVC   SAPEDEF-SAPEREC(,R5),SAPEDEF-SAPEREC(R4) SET DATES SAME          
         BRAS  RE,SKIPACT          NOW TEST ACTIVITY IS ONLY CHANGE             
         STCM  R0,3,SAPEDEF-SAPEREC(R5) RESTORE OLD EFF DATE                    
         BNE   SKPESKIP            SKIP IF IT IS                                
*                                                                               
SKPEPRNT B     EXITOK                                                           
*                                                                               
SKPESKIP B     EXITL                                                            
***********************************************************************         
* SUPPRESS MASTER PERSON ACCESS GROUP RECORD                          *         
* IF RECORD NOT A MASTER, SUPPRESS IF PERSON COUNT IS ONLY CHANGE     *         
***********************************************************************         
SKIPPAG  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R4,AIOSORT          PICK UP BASE RECORD                          
         AHI   R4,RCVFRST-RECDS    GO TO FIRST ACTUAL DATA                      
*                                                                               
         USING SAAGREC,R4                                                       
         OC    SAAGAGR,SAAGAGR     TEST MASTER RECORD                           
         BZ    SKPGSKIP            YES, DON'T PRINT                             
         DROP  R4                                                               
*                                                                               
         BRAS  RE,SKIPPCO          NOW TEST PERSON COUNT IS ONLY CHANGE         
         BNE   SKPGSKIP            SKIP IF IT IS                                
*                                                                               
SKPGPRNT B     EXITOK                                                           
*                                                                               
SKPGSKIP B     EXITL                                                            
         EJECT                                                                  
***********************************************************************         
* SUPPRESS MASTER TIMESHEET APPROVER GROUP RECORD                     *         
* IF RECORD NOT A MASTER, SUPPRESS IF PERSON COUNT IS ONLY CHANGE     *         
***********************************************************************         
SKIPSTAP NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R4,AIOSORT          PICK UP BASE RECORD                          
         AHI   R4,RCVFRST-RECDS    GO TO FIRST ACTUAL DATA                      
*                                                                               
         USING SAAPREC,R4                                                       
         OC    SAAPAGR,SAAPAGR     TEST MASTER RECORD                           
         BZ    SKSTSKIP            YES, DON'T PRINT                             
         DROP  R4                                                               
*                                                                               
         BRAS  RE,SKIPPCO          NOW TEST PERSON COUNT IS ONLY CHANGE         
         BNE   SKSTSKIP            SKIP IF IT IS                                
*                                                                               
SKSTPRNT B     EXITOK                                                           
*                                                                               
SKSTSKIP B     EXITL                                                            
         EJECT                                                                  
***********************************************************************         
* SUPPRESS NEW SYSTEM RECORD IF NOTHING ON IT OR IF NON PPS PASSIVE   *         
***********************************************************************         
SKIPPAU  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R4,AIOSORT          PICK UP ADD OR CHANGE RECORD                 
         AHI   R4,RCVFRST-RECDS    GO TO FIRST ACTUAL DATA                      
*                                                                               
         TM    AGYPPS,CTAADPRQ     TEST AGENCY ON PPS                           
         BO    SKAU10              YES, AUTH NUMBER STYLE IS ONLY FORM          
         USING SA0REC,R4                                                        
         OC    SA0KEYS(20),SA0KEYS NON-PPS, TEST AUTH NUMBER STYLE              
         BZ    SKAUSKIP            YES, IT'S A PASSIVE, SO IGNORE IT.           
         DROP  R4                                                               
*                                                                               
SKAU10   CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    SKAUPRNT            YES, NEVER SKIP RECORD                       
*                                                                               
         AHI   R4,SA0DATA-SA0REC   POINT TO 1ST ADD/CHANGE REC ELEMENT          
         LA    R5,=X'00'           ASSUME NO COPY REC                           
         CLI   MODE,MODEADD        WON'T BE IF AN ADD                           
         BE    SKAU20                                                           
         CLI   MODE,MODERES        IGNORE IT IF RESTORE                         
         BE    SKAU20                                                           
         L     R5,AIOCOPY                                                       
         AHI   R5,RCVFRST-RECDS                                                 
         AHI   R5,SA0DATA-SA0REC   POINT TO 1ST COPY REC ELEMENT                
         CLI   MODE,MODEDEL                                                     
         BNE   SKAU20                                                           
         LA    R4,=X'00'           IGNORE CHANGE REC IF DELETE                  
*                                                                               
SKAU20   XR    R1,R1                                                            
*                                                                               
SKAU30   CLI   0(R4),0             LOOK AT ADD/CHANGE REC                       
         BE    SKAU40              SKIP IF EOR                                  
         CLI   0(R4),SAIDELQ       IDEL IS SIGNIFICANT                          
         BE    SKAU40                                                           
         CLI   0(R4),SASYSELQ      SYSEL IS SIGNIFICANT                         
         BE    SKAU40                                                           
         CLI   0(R4),SAPALELQ      PID IS SIGNIFICANT                           
         BE    SKAU40                                                           
         CLI   0(R4),SACLAELQ      CLI LIMACC IS SIGNIFICANT                    
         BE    SKAU40                                                           
         IC    R1,1(,R4)           NEXT ADD/CHANGE REC ELEMENT                  
         AR    R4,R1                                                            
         B     SKAU30                                                           
*                                                                               
SKAU40   CLI   0(R5),0             LOOK AT COPY REC                             
         BE    SKAU50              SKIP IF EOR                                  
         CLI   0(R5),SAIDELQ       IDEL IS SIGNIFICANT                          
         BE    SKAU50                                                           
         CLI   0(R5),SASYSELQ      SYSEL IS SIGNIFICANT                         
         BE    SKAU50                                                           
         CLI   0(R5),SAPALELQ      PID IS SIGNIFICANT                           
         BE    SKAU50                                                           
         CLI   0(R5),SACLAELQ      CLI LIMACC IS SIGNIFICANT                    
         BE    SKAU50                                                           
         IC    R1,1(,R5)           NEXT COPY REC ELEMENT                        
         AR    R5,R1                                                            
         B     SKAU40                                                           
*                                                                               
SKAU50   CLC   0(1,R4),0(R5)       TEST SAME ELEMENT CODE                       
         BNE   SKAUPRNT            NO, SIGNIFICANT EL INSERTED/DELETED          
         CLI   0(R4),0             BOTH AT EOR?                                 
         BE    SKAUSKIP            YES, NO SIGNIFICANT ELEMENT ACTIVITY         
         IC    R1,1(,R4)                                                        
         BCTR  R1,0                                                             
         EX    R1,SKAU55EX         TEST SIGNIFICANT ELEMENT CHANGED             
         BNE   SKAUPRNT            YES, SO NEED TO PRINT                        
*                                                                               
         IC    R1,1(,R4)           IDENTICAL ELEMENTS, SO GET NEXT PAIR         
         AR    R4,R1                                                            
         IC    R1,1(,R5)                                                        
         AR    R5,R1                                                            
         B     SKAU30                                                           
*                                                                               
SKAU55EX CLC   0(0,R4),0(R5)                                                    
*                                                                               
SKAUPRNT B     EXITOK                                                           
SKAUSKIP B     EXITL                                                            
         EJECT                                                                  
***********************************************************************         
* ACCESS RECORD KEY DISPLAY ROUTINE                                   *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
ACCESSR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS   CTFILE KEY                                    
         USING CT5REC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLDATA,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,CT5KALPH       OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* LOCK RECORD KEY DISPLAY ROUTINE                                     *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
LOCKRR   NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS   CTFILE KEY                                    
         USING CT8REC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLDATA,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,CT8KAG         OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
*                                                                               
         AHI   R3,L'PLINE          NEXT LINE                                    
*                                                                               
         L     R1,VSELIST                                                       
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         LA    R1,6(R1)                                                         
         USING SELISTD,R1                                                       
         CLC   SESYS,CT8KSE        GET SE SYSTEM                                
         BE    LKRR02                                                           
         BXLE  R1,RE,*-10                                                       
         XR    R1,R1               SE SYSTEM NOT FOUND                          
*                                                                               
LKRR02   MVC   PLKHDR,LC@SYS                                                    
         LTR   R1,R1                                                            
         BZ    LKRR03              DEIS: WAS BAD BRANCH. FIXED MAR/2015         
         MVC   PLKINF(L'SENAME),SENAME                                          
*        B     LKRR04                                                           
         DROP  R1                                                               
*                                                                               
LKRR03   DS    0H                                                               
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         MVC   PLKINF+10(07),=CL07'- X''??'''                                   
         GOTO1 VHEXOUT,DMCB,CT8KSE,PLKINF+15,1,0                                
*                                                                               
LKRR04   AHI   R3,L'PLINE          NEXT LINE                                    
         MVC   PLKHDR,LC@DATE                                                   
         GOTO1 VDATCON,DMCB,(8,CT8KDATE),(8,PLKINF)                             
*                                                                               
         OC    CT8KTIME,CT8KTIME   TIME STAMP?                                  
         BZ    LKRR06              NO                                           
*                                                                               
         MVC   PLKHDR,HDATTIM                                                   
         LA    R4,PLKINF+09                                                     
         MVC   FULL(3),CT8KTIME                                                 
         XC    FULL(3),EFFS                                                     
         MVI   FULL+3,X'0C'                                                     
         UNPK  DUB,FULL                                                         
         MVC   0(2,R4),DUB+1                                                    
         MVC   3(2,R4),DUB+3                                                    
         MVC   6(2,R4),DUB+5                                                    
         MVI   2(R4),C':'                                                       
         MVI   5(R4),C':'                                                       
*                                                                               
LKRR06   AHI   R3,L'PLINE                                                       
         MVC   PLKHDR,LC@RECTY                                                  
         MVC   PLKINF(L'CT8KTYPE),CT8KTYPE                                      
         LA    R4,PLKINF+L'CT8KTYPE+1                                           
         MVC   0(4,R4),=CL4'- X'''                                              
         MVI   8(R4),C''''                                                      
         GOTO1 VHEXOUT,DMCB,CT8KTYPE,4(R4),L'CT8KTYPE                           
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVC   PLKHDR,HLOCKKEY                                                  
         MVC   PLKINF(L'CT8KKEY),CT8KKEY                                        
         GOTO1 VHEXOUT,DMCB,CT8KKEY,PLKINF+L'CT8KKEY+2,L'CT8KKEY,0              
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* CURRENCY RECORDS KEY DISPLAY ROUTINE                                *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
CURRENR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING GCURD,R2                                                         
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         OC    GCKAGY,GCKAGY       AGENCY OVERRIDE SET?                         
         BZ    CURR02              NO                                           
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,GCKAGY        OUTPUT AGENCY NAME                            
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
CURR02   MVCDD PLKHDR,CT#CUR,L                                                  
         MVC   PLKINF(L'GCKCURR),GCKCURR                                        
         B     EXITOK                                                           
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
* OUTPUT TYPE KEY DISPLAY ROUTINE                                     *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
OUTPUTR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CTOREC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@OTPTY                                                  
         MVC   PLKINF(L'CTOKID),CTOKID                                          
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   PLKHDR,HSUBNUM                                                   
         CURED CTOKSUB,(3,PLKINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* LIBRARY RECORD                                                      *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
LIBRECR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CTLREC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,HJCLBK                                                    
         CLI   CTLKTYP,C'J'       JCL BOOK                                      
         BE    LIBR02                                                           
         MVC   PLKHDR,HLIBBK                                                    
         CLI   CTLKSCR,C' '       SUB-TYPE (SCRIPT/EXTRACT)                     
         BNH   LIBR02                                                           
         MVCDD PLKHDR,CT#SCRP,L                                                 
         CLI   CTLKSCR,CTLKSCRQ   SCRIPT?                                       
         BE    LIBR02                                                           
         MVC   PLKHDR,HXTRBK                                                    
         CLI   CTLKSCR,CTLKXTRQ   XTRACT?                                       
         BE    LIBR02                                                           
         MVC   PLKHDR(2),CTLKTYP                                                
         MVCDD PLKHDR+3(8),CT#BK,L                                              
*                                                                               
LIBR02   MVC   PLKINF(L'CTLKNAME),CTLKNAME                                      
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   PLKHDR,HLINNUM                                                   
         CURED CTLKSUB,(3,PLKINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* SYSTEM LIST RECORD                                                  *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
SYSLSTR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CTWREC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
         OC    CTWKAGY,CTWKAGY     ANY AGENCY ALPHA SET?                        
         BZ    SYSL02              NO                                           
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,CTWKAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
SYSL02   MVCDD PLKHDR,GE#LSTTY,L                                                
         LA    R1,CWTTBL                                                        
SYSL04   CLI   0(R1),0                                                          
         BE    SYSL06                                                           
         CLC   CTWKREC,0(R1)                                                    
         BNE   *+14                                                             
         MVC   PLKINF(15),1(R1)     MOVE OUT MATCHING NAME                      
         B     SYSL08                                                           
         AHI   R1,CWTTBLL                                                       
         B     SYSL04                                                           
*                                                                               
SYSL06   MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         MVC   PLKINF+10(3),=CL3' - '                                           
         MVC   PLKINF+13(L'CTWKREC),CTWKREC                                     
*                                                                               
SYSL08   AHI   R3,L'PLINE                                                       
         MVC   PLKHDR,HLINEID      LINE ID                                      
         MVC   PLKINF(L'CTWKID),CTWKID                                          
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVC   PLKHDR,HSUBNUM                                                   
         CURED CTWKSUB,(6,PLKINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         B     EXITOK                                                           
         DROP  R2,R3                                                            
*                                                                               
CWTTBLL  EQU   16                                                               
CWTTBL   DC    C'L',CL15'Line List      '                                       
         DC    C'I',CL15'User Id List   '                                       
         DC    C'S',CL15'System List    '                                       
         DC    C'P',CL15'PTS List       '                                       
         DC    C'R',CL15'Printer List   '                                       
         DC    C'G',CL15'Id Group List  '                                       
         DC    C'A',CL15'Agency List    '                                       
         DC    X'00'                                                            
         EJECT                                                                  
***********************************************************************         
* TERMINAL RECORDS                                                    *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
TERMSRR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CTTREC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,HVTAML                                                    
         OC    CTTKTID(16),CTTKTID PASSIVE?                                     
         BZ    *+14                YES                                          
         MVC   PLKINF(L'CTTKTID),CTTKTID                                        
         B     RRTE02                                                           
*                                                                               
         GOTO1 VHEXOUT,PLIST,CTTKTID+8,PLKINF+11,2,0                            
         MVI   PLKINF+10,C'<'                                                   
         MVI   PLKINF+15,C'>'                                                   
         MVCDD PLKINF+18(10),CT#POINT,L                                         
*                                                                               
RRTE02   LA    R1,CTTDATA                                                       
         USING CTPASD,R1                                                        
         XR    RF,RF                                                            
RRTE04   CLI   CTPASEL,0          EOR                                           
         BE    RRTE10                                                           
         CLI   CTPASEL,CTPASELQ   POINTER ELEMENT                               
         BE    RRTE06                                                           
         IC    RF,CTPASLEN                                                      
         BXH   R1,RF,RRTE04                                                     
*                                                                               
RRTE06   CLI   CTPASLEN,4         PASSIVE POINTER ELEMENT                       
         BNE   RRTE08             NO                                            
         GOTO1 VHEXOUT,PLIST,CTPASDTA,PLKINF+11,2,0                             
         MVI   PLKINF+10,C'<'                                                   
         MVI   PLKINF+15,C'>'                                                   
         B     RRTE10                                                           
*                                                                               
RRTE08   IC    RF,CTPASLEN        MOVE IN LUID                                  
         AHI   RF,-(CTPASDTA-CTPASD+1)                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLKINF(0),CTPASDTA                                               
         B     RRTE14                                                           
*                                                                               
RRTE10   AHI   R3,L'PLINE                                                       
         OC    CTTKPASS,CTTKPASS   PASSWORD?                                    
         BZ    RRTE14              NO                                           
         MVCDD PLKHDR,CT#PSWD,L                                                 
         MVC   PLKINF(L'CTTKPASS),CTTKPASS                                      
*                                                                               
RRTE14   AHI   R3,L'PLINE                                                       
         TM    CTTSTAT,X'04'       PRINTER?                                     
         BZ    EXITOK              NO                                           
         MVC   PLKHDR,HPRTAUTO                                                  
         MVC   PLKINF(L'L4@NO),L4@NO                                            
         TM    CTTSTAT,X'08'                                                    
         BZ    *+10                                                             
         MVC   PLKINF(L'L4@YES),L4@YES                                          
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* PERSONAL AUTH RECORD                                                *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
PAUTHRR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CT0REC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,CT0KAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   WORK(L'SAPALPID),LC@UNKNW                                        
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'C3',(R2)),0,0,0,0                  
         CLI   12(R1),0                                                         
         BNE   *+14                ELEMENTS FOUND                               
         L     RF,12(R1)                                                        
         USING SAPALD,RF                                                        
         MVC   WORK(L'SAPALPID),SAPALPID                                        
         DROP  RF                                                               
*                                                                               
PAUT10   OC    CT0KEYS(20),CT0KEYS PID NUMBER FORMAT?                           
         BNZ   PAUT20              NO                                           
*                                                                               
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    PAUT12              YES, SHOW PIDN AND PASSWORD                  
         MVCDD PLKHDR,CT#PID,L     ELSE JUST PID FORMAT FOR PUNTERS             
         MVC   PLKINF(L'SAPALPID),WORK                                          
         B     PAUT50                                                           
PAUT12   MVCDD PLKHDR,CT#PINN,L                                                 
         GOTO1 VHEXOUT,PLIST,CT0KNUM,PLKINF,L'CT0KNUM,0                         
         LA    R1,PLKINF+5                                                      
         B     PAUT30              TACK PID ON                                  
*                                                                               
PAUT20   OC    CT0KEYS(12),CT0KEYS PASSWORD FORMAT? (NON PPS)                   
         BNZ   PAUT40              NO                                           
*                                                                               
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    PAUT22              YES, PASSWORD FORMAT                         
         MVCDD PLKHDR,CT#PID,L     ELSE PID FORMAT FOR PUNTERS                  
         MVC   PLKINF(L'SAPALPID),WORK                                          
         B     PAUT50                                                           
*                                                                               
PAUT22   MVCDD PLKHDR,CT#PSWD,L                                                 
*        MVC   PLKINF(L'CT0KCODE),CT0KCODE                                      
*&&UK*&& MVC   PLKINF(10),=C'**********'                                        
*&&US*&& MVC   PLKINF(10),=C'***       '                                        
         LA    R1,PLKINF+11                                                     
*                                                                               
PAUT30   MVI   0(R1),C'('                                                       
         MVC   1(L'SAPALPID,R1),WORK                                            
         LA    R1,1+L'SAPALPID-1(R1)                                            
         CLI   0(R1),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         MVI   1(R1),C')'                                                       
         B     EXITOK                                                           
*                                                                               
PAUT40   MVCDD PLKHDR,CT#OFFC,L                                                 
         MVC   PLKINF(L'CT0KOFFC),CT0KOFFC                                      
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#INITS,L                                                
         CLI   CT0KFI,C' '                                                      
         BNH   *+10                                                             
         MVC   PLKINF(L'CT0KFI),CT0KFI                                          
         CLI   CT0KMI,C' '                                                      
         BNH   *+10                                                             
         MVC   PLKINF+L'CT0KFI+1(L'CT0KMI),CT0KMI                               
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#LASTN,L                                                
         MVC   PLKINF(L'CT0KLAST),CT0KLAST                                      
         B     EXITOK                                                           
*                                                                               
PAUT50   MVC   WORK(2),CT0KAGY                                                  
         MVC   WORK+2(8),PLKINF                                                 
         BRAS  RE,GETPEN                                                        
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),(47,WORK+10)                      
         BRAS  RE,CHEVRON                                                       
         B     EXITOK                                                           
*                                                                               
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* ID RECORDS                                                          *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
IDRECSR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CTIREC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVCDD PLKHDR,CT#ID,L                                                   
         OC    CTIKID(8),CTIKID    PASSIVE?                                     
         BZ    *+14                YES                                          
         MVC   PLKINF(L'CTIKID),CTIKID                                          
         B     IDR02                                                            
*                                                                               
         GOTO1 VHEXOUT,PLIST,CTIKID+8,PLKINF+11,2,0                             
         MVI   PLKINF+10,C'('                                                   
         MVI   PLKINF+15,C')'                                                   
         MVCDD PLKINF+18(10),CT#POINT,L                                         
*                                                                               
IDR02    LA    R1,CTIDATA                                                       
         USING CTDSCD,R1                                                        
         XR    RF,RF                                                            
IDR04    CLI   CTDSCEL,0          EOR                                           
         BE    EXITOK                                                           
         CLI   CTDSCEL,CTDSCELQ   POINTER ELEMENT                               
         BE    IDR06                                                            
         IC    RF,CTDSCLEN                                                      
         BXH   R1,RF,IDR04                                                      
*                                                                               
IDR06    CLI   CTDSCLEN,4         PASSIVE POINTER ELEMENT                       
         BNE   IDR08              NO                                            
         GOTO1 VHEXOUT,PLIST,CTDSC,PLKINF+11,2,0                                
         MVI   PLKINF+10,C'('                                                   
         MVI   PLKINF+15,C')'                                                   
         B     EXITOK                                                           
*                                                                               
IDR08    IC    RF,CTDSCLEN         MOVE IN ID                                   
         AHI   RF,-(CTDSC-CTDSCD+1)                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLKINF(0),CTDSC                                                  
         B     EXITOK                                                           
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
* FAX RECORDS STANDARD OUTPUT                                         *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
FAXRECSR NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CTFXREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,CTFXAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#CODE,L                                                 
         MVC   PLKINF(L'CTFXCODE),CTFXCODE                                      
*                                                                               
         OC    CTFXSUBC,CTFXSUBC                                                
         BZ    EXITOK                                                           
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVC   PLKHDR,HFAXSUB                                                   
         MVC   PLKINF(L'CTFXSUBC),CTFXSUBC                                      
         B     EXITOK                                                           
*                                                                               
HFAXSUB  DC    CL15'Sub Code       '                                            
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* SAVED PROGRAM RECORD KEY STANDARD OUTPUT                            *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
C1RECSRR NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CT01RECD,R2                                                      
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,CT01AGID       OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#PHASE,L                                                
         GOTO1 VHEXOUT,DMCB,CT01SYS,PLKINF,3,0                                  
         MVI   PLKINF,C'T'                                                      
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   PLKHDR,LC@NAME                                                   
         MVC   PLKINF(L'CT01NAME),CT01NAME                                      
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* PROFILE RECORD KEY STANDARD OUTPUT                                  *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
PRRECSR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CTPREC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   HALF+0(1),CTPKSYS   SYSTEM NUMBER                                
         MVC   HALF+1(1),CTPKPROG  PROGRAM NUMBER                               
         BRAS  RE,GETSYPR                                                       
*                                                                               
         MVC   PLKHDR,LC@SYS                                                    
         MVC   PLKINF(8),WORK+0                                                 
         AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#PROG,L                                                 
         MVC   PLKINF(8),WORK+8                                                 
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   PLKHDR,HOFFOVER                                                  
         MVC   PLKINF(L'CTPKORIG),CTPKORIG                                      
         OC    CTPKORIG,CTPKORIG                                                
         BNZ   *+10                                                             
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#MED,L                                                  
         MVC   PLKINF(L'CTPKSUB),CTPKSUB                                        
         CLI   CTPKSYS,C'M'                                                     
         BNE   *+12                                                             
         CLI   CTPKSUB,C'A'                                                     
         BH    EXITOK                                                           
         CURED CTPKSUB,(3,PLKINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* USER PROFILE STANDARD OUTPUT                                        *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
USERPRS  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING CTUREC,R2                                                        
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         OC    CTUKAGY,CTUKAGY     FIELD DESCRIPTION?                           
         BNZ   USP02               NO, SKIP                                     
         MVCDD PLKHDR,CT#RECTY,L   MARK AS SUCH                                 
         MVCDD PLKINF(20),CT#AFD,L                                              
         B     USP06               NO                                           
*                                                                               
USP02    CLI   CTUKAGY,X'50'       USER ID RATHER THAN AGENCY?                  
         BH    USP04               NO                                           
         MVC   HALF,CTUKAGY        SEE IF MATCH USER ID                         
         BRAS  RE,GETUSRID                                                      
         CLI   WORK+2,C'#'         FOUND IT?                                    
         BE    USP04               NO                                           
         MVCDD PLKHDR,CT#USRID,L                                                
         MVC   PLKINF(10),WORK+2                                                
         B     USP06                                                            
*                                                                               
USP04    MVCDD PLKHDR,CT#AGYC,L    AGENCY ID                                    
         MVC   PLKINF(L'CTUKAGY),CTUKAGY                                        
*                                                                               
USP06    AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#PROG,L                                                 
         MVC   PLKINF(L'CTUKSYS+L'CTUKPROG),CTUKSYS                             
         CLI   CTUKPROG,0                                                       
         BNE   *+14                                                             
         MVC   PLKINF+L'CTUKSYS(L'CTUKPROG-1),CTUKPROG+1                        
         MVI   PLKINF+L'CTUKSYS+L'CTUKPROG-1,C' '                               
         AHI   R3,L'PLINE                                                       
*                                                                               
         OC    CTUKAGY,CTUKAGY     FIELD DESCRIPTION?                           
         BNZ   USP10               NO, SKIP                                     
         MVCDD PLKHDR,CT#LANG,L                                                 
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         CLI   CTUKLANG,0                                                       
         BE    USP09                                                            
         L     R1,VLANGTAB         DISPLAY LANGUAGE                             
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         LA    R1,6(R1)                                                         
         USING LANGTABD,R1         R1=A(LANG TABLE)                             
         CLC   LANGCODE,CTUKLANG                                                
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     USP09                                                            
         MVC   PLKINF(L'LANGFUL),LANGFUL                                        
         DROP  R1                                                               
USP09    AHI   R3,L'PLINE                                                       
*                                                                               
USP10    OC    CTUKMED(7),CTUKMED  ANY LOWER LEVEL STUFF                        
         BZ    EXITOK              NO, EXIT                                     
*                                                                               
         CLI   CTUKPROG,0          OFFLINE BASE PROFILE                         
         BNE   USP14               NO, CAN'T BE WRITER STYLE                    
         L     RF,=A(WRITBLE)      WRITER STYLE PROGRAM TABLE                   
USP11    CLC   CTUKSYS,0(RF)       THIS SYSTEM?                                 
         BNE   *+14                NO                                           
         CLC   CTUKPROG+1(2),1(RF) VALID WRITER TYPE REPORT?                    
         BE    USP12               YES - WRITER CODE PRESENT                    
         LA    RF,21(,RF)          NEXT ENTRY (WRONG LENGTH ON TABLE)           
         CLI   0(RF),X'FF'                                                      
         BNE   USP11                                                            
         B     USP14                                                            
USP12    MVC   PLKHDR,HWRITER                                                   
         MVC   PLKINF(L'CTUKNAM),CTUKNAM                                        
         B     EXITOK                                                           
*                                                                               
USP14    CLI   CTUKSYS,C'A'        ACCPAK IS ULA FORMAT                         
         BE    USP18                                                            
*                                                                               
         MVCDD PLKHDR,CT#MED,L                                                  
         MVC   PLKINF(L'CTUKMED),CTUKMED                                        
         CLI   CTUKMED,0                                                        
         BNE   *+10                                                             
         MVCDD PLKINF,CT#ALL,L                                                  
         AHI   R3,L'PLINE                                                       
*                                                                               
         OC    CTUKCLT,CTUKCLT                                                  
         BZ    EXITOK                                                           
         MVCDD PLKHDR,CT#CLI,L                                                  
         MVC   PLKINF(L'CTUKCLT),CTUKCLT                                        
*&&UK                                                                           
         CLI   CTUKCLT+1,C' '                                                   
         BH    EXITOK                                                           
         XR    R1,R1                                                            
         ICM   R1,3,CTUKCLT+1                                                   
         CVD   R1,DUB                                                           
         UNPK  PLKINF+1(4),DUB+5(3)                                             
         OI    PLKINF+4,X'F0'                                                   
*&&                                                                             
         B     EXITOK                                                           
*                                                                               
USP18    MVCDD PLKHDR,CT#ACC                                                    
         MVC   PLKINF(L'CTUKUNT+L'CTUKLDG+L'CTUKACT),CTUKUNT                    
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* OFFICE SECURITY RECORD CTFILE (F)02                                 *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
OFSRECS  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SAOFREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SAOFAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#OFFC,L                                                 
         MVC   PLKINF(L'SAOFOID),SAOFOID                                        
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SAOFFELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SAOFFD,RF           RF=A(OFFICE ELEMENT)                         
         XR    R0,R0                                                            
         IC    R0,SAOFFLN                                                       
         AHI   R0,-SAOFFLNQ                                                     
         BNP   EXITOK                                                           
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),((R0),SAOFFNAM)                   
         BRAS  RE,CHEVRON                                                       
         DROP  RF                                                               
*                                                                               
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* DEPT.  SECURITY RECORD CTFILE (F)03                                 *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
DEPRECS  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SADPREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SADPAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#OFFC,L                                                 
         MVC   PLKINF(L'SADPOID),SADPOID                                        
*                                                                               
         MVC   FULL(2),SADPAGY                                                  
         MVC   FULL+2(2),SADPOID                                                
         BRAS  RE,GETOFN                                                        
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),(30,WORK)                         
         BRAS  RE,CHEVRON                                                       
*                                                                               
DEP10    AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#DPTC,L                                                 
         MVC   PLKINF(L'SADPDID),SADPDID                                        
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SADPTELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SADPTD,RF           RF=A(DEPARTMENT ELEMENT)                     
         XR    R0,R0                                                            
         IC    R0,SADPTLN                                                       
         AHI   R0,-SADPTLNQ                                                     
         BNP   EXITOK                                                           
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),((R0),SADPTNAM)                   
         BRAS  RE,CHEVRON                                                       
         DROP  RF                                                               
*                                                                               
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* PERSON RECORD - CTFILE (F)04                                        *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
PSRECSR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SAPEREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SAPEAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#PID,L                                                  
         MVC   PLKINF(L'SAPEPID),SAPEPID                                        
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SANAMELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   PSR10                                                            
*                                                                               
         L     RF,12(R1)                                                        
         USING SANAMD,RF           RF=A(PERSON NAME ELEMENT)                    
         XR    R1,R1                                                            
         IC    R1,SANAMLN                                                       
         AHI   R1,-(SANAMLNQ+1)                                                 
         BNP   PSR10                                                            
         LR    R0,R1                                                            
         MVC   WORK(47),SANAME                                                  
         LA    RF,WORK-1(R1)       CLEAR OUT LENGTHS                            
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         MVI   0(RF),C' '                                                       
         BCTR  RF,0                                                             
         BCT   R1,*-14                                                          
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),((R0),WORK)                       
         BRAS  RE,CHEVRON                                                       
         DROP  RF                                                               
*                                                                               
PSR10    AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#EFFD,L                                                 
         MVC   HALF,EFFS                                                        
         XC    HALF,SAPEDEF                                                     
         GOTO1 VDATCON,PLIST,(2,HALF),(8,PLKINF)                                
*                                                                               
         CLI   MODE,MODECHG        IF CHANGE                                    
         BNE   EXITOK                                                           
         L     R2,AIOCOPY          SEE IF COPY EFF DATE IS DIFFERENT            
         AHI   R2,RCVFRST-RECDS    (ADD TREATED AS CHANGE, SEE EFFDFIX)         
         MVC   FULL(2),HALF        COPY CURRENT EFF DATE                        
         MVC   HALF,EFFS                                                        
         XC    HALF,SAPEDEF                                                     
         CLC   FULL(2),HALF        IS CURRENT SAME AS PREVIOUS                  
         BE    EXITOK              YES, EXIT THIS IS A REAL CHANGE              
         MVCDD PLKINF+10(10),CT#PREV,L ELSE SHOW PREVIOUS EFF DATE              
         GOTO1 VDATCON,PLIST,(2,HALF),(8,PLKINF+21)                             
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* PERSON ACCESS GROUP -  CTFILE (F)05                                 *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
PAGRECS  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SAAGREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SAAGAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#GCODE,L                                                
         MVC   PLKINF(L'SAAGAGR),SAAGAGR                                        
         OC    SAAGAGR,SAAGAGR                                                  
         BNZ   PAG10                                                            
         MVC   PLKINF(L'LC@NOSET),LC@NOSET EMPTY MEANS AGENCY MASTER            
         B     EXITOK                                                           
*                                                                               
PAG10    GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SAAGNELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SAAGND,RF           RF=A(ACCESS GROUP ELEMENT)                   
         XR    R0,R0                                                            
         IC    R0,SAAGNLN                                                       
         AHI   R0,-SAAGNLNQ                                                     
         BNP   EXITOK                                                           
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),((R0),SAAGNNAM)                   
         BRAS  RE,CHEVRON                                                       
         DROP  RF                                                               
*                                                                               
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* ACTION RECORDS -  CTFILE (F)11                                      *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
         PUSH  USING                                                            
ACTRECS  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SAACKEY,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,HSYSPROG                                                  
         MVC   HALF,SAACOVPG                                                    
         BRAS  RE,GETSYPR                                                       
         MVC   PLKINF(8),WORK                                                   
         LA    RF,PLKINF+8                                                      
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         MVI   1(RF),C'/'                                                       
         MVC   2(8,RF),WORK+8                                                   
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   HALF,SAACOVPG                                                    
         BRAS  RE,GETPGEL                                                       
*                                                                               
         USING SAPGMD,SVPGMEL                                                   
         MVC   PLKHDR,LC@ACT                                                    
         GOTO1 ADISCODE,PLIST,(SAPGMAIF,SAACACT)                                
         MVC   PLKINF(10),WORK                                                  
         B     EXITOK                                                           
         POP   USING                                                            
         EJECT                                                                  
***********************************************************************         
* RECORD RECORDS      -  CTFILE (F)12                                 *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
RECRECS  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SARCREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,HSYSPROG                                                  
         MVC   HALF,SARCOVPG                                                    
         BRAS  RE,GETSYPR                                                       
         MVC   PLKINF(8),WORK                                                   
         LA    RF,PLKINF+8                                                      
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         MVI   1(RF),C'/'                                                       
         MVC   2(8,RF),WORK+8                                                   
*                                                                               
         MVCDD PLKHDR,CT#REC,L                                                  
*&&DO*&& GOTO1 DISCODE,PLIST,(SAPGMRIF,SARCRCD)                                 
         MVC   PLKINF(10),WORK                                                  
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* ACCESS RECORD - CTFILE (F)15                                        *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
SACCSR   NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SAASREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SAASAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVC   PLKHDR,HSYSPROG                                                  
         MVC   HALF,SAASOVPG                                                    
         BRAS  RE,GETSYPR          OUTPUT SYSTEM/PROGRAM                        
*                                                                               
         LA    RF,PLKINF                                                        
         MVC   0(8,RF),WORK                                                     
         LA    RF,8(RF)                                                         
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         MVI   1(RF),C'/'                                                       
         MVC   2(8,RF),WORK+8                                                   
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#USRID,L   OUTPUT USER ID                               
         OC    SAASUID,SAASUID                                                  
         BNZ   *+14                                                             
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         B     SAC10                                                            
         MVC   HALF,SAASUID                                                     
         BRAS  RE,GETUSRID                                                      
         MVC   PLKINF(10),WORK+2                                                
*                                                                               
SAC10    AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#SECGR,L                                                
         OC    SAASAGN,SAASAGN                                                  
         BNZ   *+14                                                             
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         B     EXITOK                                                           
         MVC   FULL+00(02),SAASAGY                                              
         MVC   FULL+02(02),SAASAGN                                              
         BRAS  RE,GETACG                                                        
         MVC   PLKINF(8),WORK                                                   
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),(30,WORK+8)                       
         BRAS  RE,CHEVRON                                                       
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* FCONT  RECORD - CTFILE (F)16                                        *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
SFCONR   NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SAFCREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SAFCAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   PLKHDR,HSYSPROG                                                  
         MVC   HALF,SAFCOVPG                                                    
         BRAS  RE,GETSYPR          OUTPUT SYSTEM/PROGRAM                        
*                                                                               
         LA    RF,PLKINF                                                        
         MVC   0(8,RF),WORK                                                     
         LA    RF,8(RF)                                                         
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         MVI   1(RF),C'/'                                                       
         MVC   2(8,RF),WORK+8                                                   
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#USRID,L   OUTPUT USER ID                               
         OC    SAFCUID,SAFCUID                                                  
         BNZ   *+14                                                             
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         B     SFC10                                                            
         MVC   HALF,SAFCUID                                                     
         BRAS  RE,GETUSRID                                                      
         MVC   PLKINF(10),WORK+2                                                
*                                                                               
SFC10    AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#SECGR,L                                                
         OC    SAFCAGN,SAFCAGN                                                  
         BNZ   *+14                                                             
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         B     SFC20                                                            
         MVC   FULL+00(02),SAFCAGY                                              
         MVC   FULL+02(02),SAFCAGN                                              
         BRAS  RE,GETACG                                                        
         MVC   PLKINF(8),WORK                                                   
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),(30,WORK+8)                       
         BRAS  RE,CHEVRON                                                       
*                                                                               
SFC20    CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    EXITOK              YES, ALL DONE                                
*                                                                               
*        FOR CLIENT REPORTS, FUDGE THE READ FIELD CONTROL SO IT ONLY            
*        CONTAINS ITEMS NOT IN THE WRITE FIELD CONTROL ELEMENT. THAT            
*        ALLOWS CIENTS TO MAKE MORE SENSE OF IT, ESPECIALLY CHANGES.            
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'BD',SAFCREC),0,0,0,0               
         CLI   12(R1),0            WRITE ELEMENT FOUND?                         
         BNE   SFC30               NO, SO ALL READS                             
         L     RE,12(R1)                                                        
         USING SAFCWD,RE                                                        
         XC    BITTAB,BITTAB                                                    
         XR    RF,RF                                                            
         IC    RF,SAFCWLN                                                       
         AHI   RF,-(SAFCWLNQ+1)                                                 
         BM    SFC30               EMPTY ELEMENT                                
         EX    RF,*+8                                                           
         B     *+10                                                             
         OC    BITTAB(0),SAFCWTAB                                               
         BZ    SFC30               EMPTY ELEMENT                                
         DROP  RE                                                               
         XC    BITTAB,EFFS         SWAP ALL WRITE BITS                          
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'BE',SAFCREC),0,0,0,0               
         CLI   12(R1),0            READ ELEMENT FOUND?                          
         BNE   SFC30               NO, SHOULDN'T HAPPEN IF WRITES FOUND         
         L     RE,12(R1)                                                        
         USING SAFCRD,RE                                                        
         IC    RF,SAFCRLN                                                       
         AHI   RF,-(SAFCRLNQ+1)                                                 
         BM    SFC30               EMPTY ELEMENT, SHOULDN'T HAPPEN              
         EX    RF,*+8                                                           
         B     *+10                                                             
         NC    SAFCRTAB(0),BITTAB  CLEAR READ BITS ON IN WRITE ELEMENT          
         DROP  RE                                                               
*                                                                               
*        FOR COPY, FUDGE THE OTHER RECORD TOO                                   
*                                                                               
SFC30    CLI   MODE,MODECHG        COPY/CHANGE PAIRS                            
         BNE   EXITOK                                                           
         L     R2,AIOCOPY                                                       
         AHI   R2,RCVFRST-RECDS                                                 
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'BD',SAFCREC),0,0,0,0               
         CLI   12(R1),0            WRITE ELEMENT FOUND?                         
         BNE   EXITOK              NO, SO ALL READS                             
         L     RE,12(R1)                                                        
         USING SAFCWD,RE                                                        
         XC    BITTAB,BITTAB                                                    
         XR    RF,RF                                                            
         IC    RF,SAFCWLN                                                       
         AHI   RF,-(SAFCWLNQ+1)                                                 
         BM    EXITOK              EMPTY ELEMENT                                
         EX    RF,*+8                                                           
         B     *+10                                                             
         OC    BITTAB(0),SAFCWTAB                                               
         BZ    EXITOK              EMPTY ELEMENT                                
         DROP  RE                                                               
         XC    BITTAB,EFFS         SWAP ALL WRITE BITS                          
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'BE',SAFCREC),0,0,0,0               
         CLI   12(R1),0            READ ELEMENT FOUND?                          
         BNE   EXITOK              NO, SHOULDN'T HAPPEN IF WRITES FOUND         
         L     RE,12(R1)                                                        
         USING SAFCRD,RE                                                        
         IC    RF,SAFCRLN                                                       
         AHI   RF,-(SAFCRLNQ+1)                                                 
         BM    EXITOK              EMPTY ELEMENT, SHOULDN'T HAPPEN              
         EX    RF,*+8                                                           
         B     *+10                                                             
         NC    SAFCRTAB(0),BITTAB  CLEAR READ BITS ON IN WRITE ELEMENT          
         DROP  RE                                                               
*                                                                               
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* OCONT  RECORD - CTFILE (F)17                                        *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
SOCONR   NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SAOCREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SAOCAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   PLKHDR,HSYSPROG                                                  
         MVC   HALF,SAOCOVPG                                                    
         BRAS  RE,GETSYPR          OUTPUT SYSTEM/PROGRAM                        
*                                                                               
         LA    RF,PLKINF                                                        
         MVC   0(8,RF),WORK                                                     
         LA    RF,8(RF)                                                         
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         MVI   1(RF),C'/'                                                       
         MVC   2(8,RF),WORK+8                                                   
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#USRID,L   OUTPUT USER ID                               
         OC    SAOCUID,SAOCUID                                                  
         BNZ   *+14                                                             
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         B     SOC10                                                            
         MVC   HALF,SAOCUID                                                     
         BRAS  RE,GETUSRID                                                      
         MVC   PLKINF(10),WORK+2                                                
*                                                                               
SOC10    AHI   R3,L'PLINE                                                       
         MVCDD PLKHDR,CT#SECGR,L                                                
         OC    SAOCAGN,SAOCAGN                                                  
         BNZ   *+14                                                             
         MVC   PLKINF(L'LC@NOSET),LC@NOSET                                      
         B     EXITOK                                                           
         MVC   FULL+00(02),SAOCAGY                                              
         MVC   FULL+02(02),SAOCAGN                                              
         BRAS  RE,GETACG                                                        
         MVC   PLKINF(8),WORK                                                   
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),(30,WORK+8)                       
         BRAS  RE,CHEVRON                                                       
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* LIMIT ACCESS GROUP RECORD - CTFILE (F)18                            *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
LIMAGR   NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SALAREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SALAAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#GCODE,L                                                
         MVC   PLKINF(L'SALAAGR),SALAAGR                                        
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* LIMIT ACCESS GROUP RECORD - CTFILE (F)19                            *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
LIMAGLR  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SALMREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SALMAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   PLKHDR,LC@SYS                                                    
         MVC   HALF(1),SALMSYS                                                  
         MVI   HALF+1,0                                                         
         BRAS  RE,GETSYPR          OUTPUT SYSTEM/PROGRAM                        
         MVC   PLKINF(8),WORK                                                   
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#LIST,L                                                 
         MVC   PLKINF(L'SALMLID),SALMLID                                        
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* TIMESHEET APP GROUP -  CTFILE (F)20                                 *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
STAPRECS NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SAAPREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SAAPAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#APPG,L                                                 
         MVC   PLKINF(L'SAAPAGR),SAAPAGR                                        
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SAAPGELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SAAPGD,RF           RF=A(APPROVER GROUP ELEMENT)                 
         XR    R0,R0                                                            
         IC    R0,SAAPGLN                                                       
         AHI   R0,-(SAAPGLNQ+1)                                                 
         BNP   EXITOK                                                           
         GOTO1 ,DUB,(L'PLKINF-8-2,PLKINF+8+2),((R0),SAAPGNAM)                   
         BRAS  RE,CHEVRON                                                       
         DROP  RF                                                               
*                                                                               
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* TEXT LIMIT ACCESS GROUP RECORD - CTFILE (F)19                       *         
* NTRY: R2     = A(RECOVERY FILE RECORD)                              *         
***********************************************************************         
LIMTLAL  NTR1  BASE=*,LABEL=*                                                   
         AHI   R2,RCVFRST-RECDS                                                 
         USING SATLREC,R2                                                       
         LA    R3,PBLOCK                                                        
         USING PLINED,R3                                                        
*                                                                               
         MVC   PLKHDR,LC@AGYAL                                                  
         MVC   HALF,SATLAGY        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLKINF(22),SPROUT                                                
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVC   PLKHDR,LC@SYS                                                    
         MVC   HALF(1),SATLSYS                                                  
         MVI   HALF+1,0                                                         
         BRAS  RE,GETSYPR          OUTPUT SYSTEM                                
         MVC   PLKINF(8),WORK                                                   
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#LIST,L                                                 
         MVC   PLKINF(L'SATLLID),SATLLID                                        
         AHI   R3,L'PLINE                                                       
*                                                                               
         MVCDD PLKHDR,CT#EFFD,L                                                 
         MVC   HALF,EFFS                                                        
         XC    HALF,SATLDEF                                                     
         GOTO1 VDATCON,PLIST,(2,HALF),(8,PLKINF)                                
*                                                                               
         CLI   MODE,MODECHG        IF CHANGE                                    
         BNE   EXITOK                                                           
         L     R2,AIOCOPY          SEE IF COPY EFF DATE IS DIFFERENT            
         AHI   R2,RCVFRST-RECDS    (ADD TREATED AS CHANGE, SEE EFFDFIX)         
         MVC   FULL(2),HALF        COPY CURRENT EFF DATE                        
         MVC   HALF,EFFS                                                        
         XC    HALF,SATLDEF                                                     
         CLC   FULL(2),HALF        IS CURRENT SAME AS PREVIOUS                  
         BE    EXITOK              YES, EXIT THIS IS A REAL CHANGE              
         MVCDD PLKINF+10(10),CT#PREV,L ELSE SHOW PREVIOUS EFF DATE              
         GOTO1 VDATCON,PLIST,(2,HALF),(8,PLKINF+21)                             
*                                                                               
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* X'01' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT01ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,1          DESCRIPTION                                  
         BE    CT01P06                                                          
*                                                                               
         CLI   ADRECNUM,23         SECURITY RECORDS                             
         BL    *+12                                                             
         CLI   ADRECNUM,37                                                      
         BNH   CT01P66                                                          
*                                                                               
         CLI   ADRECNUM,71         FAX NUMBER                                   
         BE    CT01P12                                                          
         CLI   ADRECNUM,73         PROGRAM DETAILS                              
         BE    CT01P48                                                          
         CLI   ADRECNUM,74         PROGRAM DETAILS                              
         BE    CT01P48                                                          
         CLI   ADRECNUM,75         PROGRAM DETAILS                              
         BE    CT01P48                                                          
         CLI   ADRECNUM,94         SCREEN FIELD INFORMATION                     
         BE    CT01P64                                                          
         CLI   ADRECNUM,113        RFP GROUP HEADER                             
         BE    CT01P18                                                          
         DROP  RF                                                               
*                              *** DEFAULT IS RECORD ACTIVITY ELEMENT           
CT01P02  MVCDD PLNHDR,CT#ACTYD,L   ACTIVITY DATE                                
*                                                                               
         LTR   R2,R2               COPY ELEMENT?                                
         BZ    CT01P04             NO                                           
         USING CTACTD,R2                                                        
         GOTO1 VDATCON,PLIST,(3,CTACTDT),(8,PLOINF),0                           
*&&UK*&& OI    PLOINF,X'F0'                                                     
         DROP  R2                                                               
*                                                                               
CT01P04  LTR   R3,R3               CHANGE ELEMENT?                              
         BZ    CT01P99             NO                                           
         USING CTACTD,R3                                                        
         GOTO1 VDATCON,PLIST,(3,CTACTDT),(8,PLNINF),0                           
*&&UK*&& OI    PLNINF,X'F0'                                                     
         B     CT01P99                                                          
         DROP  R3                                                               
*                                                                               
CT01P06  MVCDD PLNHDR,CT#DESC,L  DESCRIPTION                                    
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT01P08                                                          
         USING CT01DSCD,R2         SAVED PROGRAM DESCRIPTION ELEMENT            
*                                                                               
         XR    R0,R0               R0 = LENGTH OF DATA                          
         IC    R0,CT01DLEN                                                      
         AHI   R0,-(CT01DESC-CT01DSCD)                                          
         LHI   RF,L'PLOINF         RF = WIDTH OF COLUMN                         
*                                                                               
         GOTO1 VCHOPPER,DMCB,((R0),CT01DESC),((RF),PLOINF),(C'P',5)             
         ICM   R0,15,8(R1)                                                      
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT01P08  LTR   R3,R3                                                            
         BZ    CT01P10                                                          
         USING CT01DSCD,R3         SAVED PROGRAM DESCRIPTION ELEMENT            
*                                                                               
         XR    R0,R0               R0 = LENGTH OF DATA                          
         IC    R0,CT01DLEN                                                      
         AHI   R0,-(CT01DESC-CT01DSCD)                                          
         LHI   RF,L'PLNINF         RF = WIDTH OF COLUMN                         
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
*                                                                               
         GOTO1 VCHOPPER,DMCB,((R0),CT01DESC),((RF),PLNINF),(C'P',5)             
         ICM   R0,15,8(R1)                                                      
         CLM   R0,15,FULL                                                       
         BH    *+8                                                              
         ICM   R0,15,FULL                                                       
*                                                                               
CT01P10  MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT01P12  MVC   PLNHDR,LC@NUM       FAX NUMBER ELEMENT                           
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2               COPY ELEMENT?                                
         BZ    CT01P14             NO                                           
         USING CTFX1EL,R2                                                       
*                                                                               
         XR    R0,R0               R0 = LENGTH OF DATA                          
         IC    R0,CTFX1LEN                                                      
         AHI   R0,-(CTFX1NUM-CTFX1EL+1)                                         
         LHI   RF,L'PLOINF         RF = WIDTH OF COLUMN                         
*                                                                               
         GOTO1 VCHOPPER,DMCB,((R0),CTFX1NUM),((RF),PLOINF),(C'P',5)             
         ICM   R0,15,8(R1)                                                      
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT01P14  LTR   R3,R3               CHANGE ELEMENT?                              
         BZ    CT01P16                                                          
         USING CTFX1EL,R3                                                       
*                                                                               
         XR    R0,R0               R0 = LENGTH OF DATA                          
         IC    R0,CTFX1LEN                                                      
         AHI   R0,-(CTFX1NUM-CTFX1EL+1)                                         
         LHI   RF,L'PLNINF         RF = WIDTH OF COLUMN                         
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
*                                                                               
         GOTO1 VCHOPPER,DMCB,((R0),CTFX1NUM),((RF),PLNINF),(C'P',5)             
         ICM   R0,15,8(R1)                                                      
         CLM   R0,15,FULL                                                       
         BH    *+8                                                              
         ICM   R0,15,FULL                                                       
*                                                                               
CT01P16  MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT01P18  LR    R5,R4           *** RFP HEADER                                   
         MVC   PLNHDR,HMINIO       MINIO KEY                                    
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#DESC,L    DESCRIPTION                                  
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#FREQ,L    FREQUENCY                                    
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,LC@OTPTY     OPTION TYPE                                  
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#DESTN,L   DESTINATION                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,LC@NAME      NAME                                         
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL             SAVE HIGH WATERMARK                          
*                                                                               
         LTR   R2,R2             COPY RECORD?                                   
         BZ    CT01P24                                                          
         USING GRPHD,R2                                                         
         LR    R4,R5                                                            
         GOTO1 VHEXOUT,DMCB,GRPHMKEY,PLOINF,L'GRPHMKEY,0                        
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'GRPHDESC),GRPHDESC                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLOINF+0(1),GRPHFREQ                                             
         MVC   PLOINF+1(3),=CL3' - '                                            
         MVC   PLOINF+4(L'LC@NOSET),LC@NOSET                                    
*                                                                               
         LA    RF,FREQTAB                                                       
CT01P20  CLI   0(RF),255                                                        
         BE    CT01P22                                                          
         CLC   GRPHFREQ,0(RF)                                                   
         BE    *+12                                                             
         AHI   RF,L'FREQTAB                                                     
         B     CT01P20                                                          
         MVC   PLOINF+4(L'LC@NOSET),SPACES                                      
         MVC   PLOINF(5),1(RF)                                                  
*                                                                               
CT01P22  AHI   R4,L'PLINE                                                       
         MVC   PLOINF,GRPHOTYP                                                  
         AHI   R4,L'PLINE                                                       
         MVC   HALF,GRPHDEST                                                    
         BRAS  RE,GETUSRID                                                      
         MVC   PLOINF(10),WORK+2                                                
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'GRPHNAME),GRPHNAME                                      
         DROP  R2                                                               
*                                                                               
CT01P24  LTR   R3,R3             CHANGE RECORD?                                 
         BZ    CT01P30                                                          
         USING GRPHD,R3                                                         
*                                                                               
         GOTO1 VHEXOUT,DMCB,GRPHMKEY,PLOINF,L'GRPHMKEY,0                        
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'GRPHDESC),GRPHDESC                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLNINF+0(1),GRPHFREQ                                             
         MVC   PLNINF+1(3),=CL3' - '                                            
         MVC   PLNINF+4(L'LC@NOSET),LC@NOSET                                    
*                                                                               
         LA    RF,FREQTAB                                                       
CT01P26  CLI   0(RF),255                                                        
         BE    CT01P28                                                          
         CLC   GRPHFREQ,0(RF)                                                   
         BE    *+12                                                             
         AHI   RF,L'FREQTAB                                                     
         B     CT01P26                                                          
         MVC   PLNINF+4(L'LC@NOSET),SPACES                                      
         MVC   PLNINF(5),1(RF)                                                  
*                                                                               
CT01P28  AHI   R4,L'PLINE                                                       
         MVC   PLNINF,GRPHOTYP                                                  
         AHI   R4,L'PLINE                                                       
         MVC   HALF,GRPHDEST                                                    
         BRAS  RE,GETUSRID                                                      
         MVC   PLNINF(10),WORK+2                                                
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'GRPHNAME),GRPHNAME                                      
         DROP  R3                                                               
*                                                                               
CT01P30  XC    BYTE,BYTE                                                        
         LTR   R2,R2               VARIABLE STUFF FROM HERE                     
         BZ    CT01P32                                                          
         USING GRPHD,R2                                                         
         OC    GRPHXFIL,GRPHXFIL   ATTACHED XFILE GROUP KEY                     
         BZ    CT01P64                                                          
         MVCDD PLNHDR,GE#XFILE                                                  
         GOTO1 VHEXOUT,DMCB,GRPHXFIL,PLOINF,L'GRPHXFIL,0                        
         MVI   BYTE,1                                                           
         DROP  R2                                                               
*                                                                               
CT01P32  LTR   R3,R3                                                            
         BZ    CT01P34                                                          
         USING GRPHD,R3                                                         
         OC    GRPHXFIL,GRPHXFIL   ATTACHED XFILE GROUP KEY                     
         BZ    CT01P34                                                          
         MVCDD PLNHDR,GE#XFILE                                                  
         GOTO1 VHEXOUT,DMCB,GRPHXFIL,PLNINF,L'GRPHXFIL,0                        
         MVI   BYTE,1                                                           
         DROP  R3                                                               
*                                                                               
CT01P34  CLI   BYTE,0              ANYTHING OUTPUT?                             
         BE    *+8                 NO                                           
         AHI   R4,L'PLINE          NEXT LINE                                    
*                                                                               
         MVI   BYTE,0                                                           
         LTR   R2,R2                                                            
         BZ    CT01P36                                                          
         USING GRPHD,R2                                                         
         OC    GRPHNXTR,GRPHNXTR   NEXT RUN DATE                                
         BZ    CT01P36                                                          
         MVCDD PLNHDR,CT#NRUN,L                                                 
         GOTO1 VDATCON,DMCB,(6,GRPHNXTR),(8,PLOINF),0                           
         MVI   BYTE,1                                                           
         DROP  R2                                                               
*                                                                               
CT01P36  LTR   R3,R3                                                            
         BZ    CT01P38                                                          
         USING GRPHD,R3                                                         
         OC    GRPHNXTR,GRPHNXTR   NEXT RUN DATE                                
         BZ    CT01P38                                                          
         MVCDD PLNHDR,CT#NRUN,L                                                 
         GOTO1 VDATCON,DMCB,(6,GRPHNXTR),(8,PLNINF),0                           
         MVI   BYTE,1                                                           
         DROP  R3                                                               
*                                                                               
CT01P38  CLI   BYTE,0              ANYTHING OUTPUT?                             
         BE    *+8                 NO                                           
         AHI   R4,L'PLINE          NEXT LINE                                    
*                                                                               
         MVI   BYTE,0                                                           
         LTR   R2,R2                                                            
         BZ    CT01P40                                                          
         USING GRPHD,R2                                                         
         OC    GRPHLSTR,GRPHLSTR                                                
         BZ    CT01P40                                                          
         MVCDD PLNHDR,CT#LRUN,L                                                 
         GOTO1 VDATCON,DMCB,(6,GRPHLSTR),(8,PLOINF),0                           
         MVI   BYTE,1                                                           
         DROP  R2                                                               
*                                                                               
CT01P40  LTR   R3,R3                                                            
         BZ    CT01P42                                                          
         USING GRPHD,R3                                                         
         OC    GRPHLSTR,GRPHLSTR                                                
         BZ    CT01P42                                                          
         MVCDD PLNHDR,CT#LRUN,L                                                 
         GOTO1 VDATCON,DMCB,(6,GRPHLSTR),(8,PLNINF),0                           
         MVI   BYTE,1                                                           
         DROP  R3                                                               
*                                                                               
CT01P42  CLI   BYTE,0              ANYTHING OUTPUT?                             
         BE    *+8                 NO                                           
         AHI   R4,L'PLINE          NEXT LINE                                    
*                                                                               
         MVI   BYTE,0                                                           
         LTR   R2,R2                                                            
         BZ    CT01P44                                                          
         USING GRPHD,R2                                                         
         OC    GRPHEND,GRPHEND     END RUN DATE                                 
         BZ    CT01P44                                                          
         MVCDD PLNHDR,GE#ERUND,L                                                
         GOTO1 VDATCON,DMCB,(6,GRPHEND),(8,PLOINF),0                            
         MVI   BYTE,1                                                           
         DROP  R2                                                               
*                                                                               
CT01P44  LTR   R3,R3                                                            
         BZ    CT01P46                                                          
         USING GRPHD,R3                                                         
         OC    GRPHEND,GRPHEND     END RUN DATE                                 
         BZ    CT01P46                                                          
         MVCDD PLNHDR,GE#ERUND,L                                                
         GOTO1 VDATCON,DMCB,(6,GRPHEND),(8,PLNINF),0                            
         MVI   BYTE,1                                                           
*                                                                               
CT01P46  CLI   BYTE,0              ANYTHING OUTPUT?                             
         BE    *+8                 NO                                           
         AHI   R4,L'PLINE          NEXT LINE                                    
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
         USING ACPRGD,R2                                                        
CT01P48  LR    R5,R4               SAVE FIRST LINE                              
         MVC   PLNHDR,HPTYPE       PROGRAM TYPE                                 
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#TXTN,L    TEXT NUMBER                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HRATYP                                                    
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R5,R4               BACK TO FIRST LINE                           
         LTR   R2,R2                                                            
         BZ    CT01P56             NO COPY INFO                                 
         USING ACPRGD,R2                                                        
*                                                                               
         LA    R1,PTYPTAB                                                       
CT01P50  CLI   0(R1),255                                                        
         BE    CT01P52                                                          
         CLC   ACPRGTYP,0(R1)                                                   
         BE    CT01P52                                                          
         AHI   R1,L'PTYPTAB                                                     
         B     CT01P50                                                          
*                                                                               
CT01P52  MVC   PLOINF(19),0(R1)                                                 
         AHI   R4,L'PLINE                                                       
*                                                                               
         GOTO1 VHEXOUT,DMCB,ACPRGDSC,PLOINF,2,0                                 
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         MVC   PLOINF+10(2),ACPRGREC                                            
*                                                                               
         LA    R1,RAIPTAB                                                       
CT01P54  CLI   0(R1),255                                                        
         BE    CT01P56                                                          
         CLC   ACPRGREC(2),0(R1)                                                
         BE    *+12                                                             
         AHI   R1,L'RAIPTAB                                                     
         B     CT01P54                                                          
         MVC   PLOINF(14),2(R1)                                                 
         DROP  R2                                                               
*                                                                               
CT01P56  LR    R5,R4               BACK TO FIRST LINE                           
         LTR   R3,R3                                                            
         BZ    EXITOK              NO CHANGE RECORD                             
         USING ACPRGD,R3                                                        
*                                                                               
         LA    R1,PTYPTAB                                                       
CT01P58  CLI   0(R1),255                                                        
         BE    CT01P60                                                          
         CLC   ACPRGTYP,0(R1)                                                   
         BE    CT01P60                                                          
         AHI   R1,L'PTYPTAB                                                     
         B     CT01P58                                                          
*                                                                               
CT01P60  MVC   PLNINF(19),0(R1)                                                 
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,ACPRGDSC,PLNINF,2,0                                 
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         MVC   PLNINF+10(2),ACPRGREC                                            
*                                                                               
         LA    R1,RAIPTAB                                                       
CT01P62  CLI   0(R1),255                                                        
         BE    EXITOK                                                           
         CLC   ACPRGREC(2),0(R1)                                                
         BE    *+12                                                             
         AHI   R1,L'RAIPTAB                                                     
         B     CT01P62                                                          
         MVC   PLNINF(14),2(R1)                                                 
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT01P64  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT01P66  LTR   R2,R2               ONLY IF LENGTH IS RIGHT                      
         BZ    *+12                                                             
         CLI   SAACVLEN-SAACVD(R2),SAACVLNQ                                     
         BNE   CT01P68                                                          
         LTR   R3,R3               ONLY IF LENGTH IS RIGHT                      
         BZ    *+12                                                             
         CLI   SAACVLEN-SAACVD(R3),SAACVLNQ                                     
         BNE   CT01P68                                                          
         B     CT01P70                                                          
*                                                                               
CT01P68  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT01P70  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#ACTYD,L   ACTIVITY                                     
         AHI   R4,L'PLINE                                                       
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   CT01P71                                                          
         MVCDD PLNHDR,CT#SEQ,L     SEQUENCE #                                   
         AHI   R4,L'PLINE                                                       
CT01P71  ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT01P72                                                          
         USING SAACVD,R2                                                        
         GOTO1 VDATCON,PLIST,(3,SAACVDT),(8,PLOINF),0                           
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   CT01P72                                                          
         AHI   R4,L'PLINE                                                       
         CURED SAACVSEQ,(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         DROP  R2                                                               
*                                                                               
CT01P72  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING SAACVD,R3                                                        
         GOTO1 VDATCON,PLIST,(3,SAACVDT),(8,PLNINF),0                           
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   CT01P99                                                          
         AHI   R4,L'PLINE                                                       
         CURED SAACVSEQ,(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT01P99  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
*                                                                               
FREQTAB  DS    0XL5                                                             
         DC    C'W'                                                             
         DCDDL GE#WKLY,15,L                                                     
         DC    C'M'                                                             
         DCDDL GE#MTHLY,15,L                                                    
         DC    C'Q'                                                             
         DCDDL GE#QTRLY,15,L                                                    
         DC    C'Y'                                                             
         DCDDL GE#YRLY,15,L                                                     
         DC    C'N'                                                             
         DCDDL GE#NOTRG,15,L                                                    
         DC    X'FF'                                                            
*                                                                               
RAIPTAB  DS    0CL16                                                            
         DC    C'XX',CL14'Hex,Hex'                                              
         DC    C'XA',CL14'Hex,Alpha'                                            
         DC    C'XN',CL14'Hex,Number'                                           
         DC    C'AX',CL14'Alpha,Hex'                                            
         DC    C'AN',CL14'Alpha,Number'                                         
         DC    C'AA',CL14'Alpha,Alpha'                                          
         DC    C'NX',CL14'Number,Hex'                                           
         DC    C'NA',CL14'Number,Alpha'                                         
         DC    C'NN',CL14'Number,Number'                                        
         DC    X'FF'                                                            
*                                                                               
PTYPTAB  DS    0CL20                                                            
         DC    X'01',CL19'File Maintenance'                                     
         DC    X'02',CL19'Enquiry/Summary '                                     
         DC    X'03',CL19'Request/Spool   '                                     
         DC    X'04',CL19'Input           '                                     
         DC    X'05',CL19'Info/List       '                                     
         DC    X'06',CL19'Gencon/General  '                                     
         DC    X'FF',CL19'Undefined       '                                     
*                                                                               
HPTYPE   DC    CL16'Program Type   '                                            
HRATYP   DC    CL16'Rec/Act Inputs '                                            
         EJECT                                                                  
***********************************************************************         
* X'02' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT02ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,1          FIELD DATA                                   
         BE    CT02P16                                                          
         CLI   ADRECNUM,71         ATTENTION NAME                               
         BE    CT02P20                                                          
         CLI   ADRECNUM,73         ACTION INFORMATION                           
         BE    CT02P14                                                          
         CLI   ADRECNUM,74         ACTION INFORMATION                           
         BE    CT02P14                                                          
         CLI   ADRECNUM,75         ACTION INFORMATION                           
         BE    CT02P14                                                          
         CLI   ADRECNUM,114        DARE INITIALS ACTIVITY                       
         BE    CT02P10                                                          
         DROP  RF                                                               
*                                                                               
         XC    FULL,FULL                                                        
         LTR   R2,R2           *** DEFAULT IS DESCRIPTION                       
         BZ    CT02P04                                                          
         USING CTDSCD,R2                                                        
         CLI   CTDSCLEN,4          NUMERIC?                                     
         BE    CT02P02             YES                                          
         MVCDD PLNHDR,CT#DESC,L                                                 
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTDSCLEN                                                      
         AHI   R0,-(CTDSC-CTDSCD)                                               
         LHI   RF,L'PLOINF         RF = WIDTH OF COLUMN                         
         GOTO1 VCHOPPER,DMCB,((R0),CTDSC),((RF),PLOINF),(C'P',5)                
         MVC   FULL,8(R1)                                                       
         B     CT02P04                                                          
*                                                                               
CT02P02  MVCDD PLNHDR,CT#IDC,L                                                  
         GOTO1 VHEXOUT,PLIST,CTDSC,PLOINF,2,0                                   
         LHI   R0,1                                                             
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT02P04  LTR   R3,R3               CHANGE RECORD?                               
         BZ    CT02P08                                                          
         USING CTDSCD,R3                                                        
         CLI   CTDSCLEN,4          NUMERIC?                                     
         BE    CT02P06             YES                                          
         MVCDD PLNHDR,CT#DESC,L                                                 
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTDSCLEN                                                      
         AHI   R0,-(CTDSC-CTDSCD)                                               
         LHI   RF,L'PLNINF         RF = WIDTH OF COLUMN                         
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTDSC),((RF),PLNINF),(C'P',5)                
         MVC   FULL,8(R1)                                                       
         B     CT02P08                                                          
*                                                                               
CT02P06  MVCDD PLNHDR,CT#IDC,L                                                  
         GOTO1 VHEXOUT,PLIST,CTDSC,PLNINF,2,0                                   
         LHI   R0,1                                                             
         ST    R0,FULL                                                          
*                                                                               
CT02P08  L     R0,FULL                                                          
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT02P10  LR    R5,R4           *** ACTIVITY ELEMENT                             
         MVCDD PLNHDR,CT#ADDTF,L   ADD ON                                       
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#LCHNG,L   CHANGED ON                                   
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#LAST,L    LAST CONNECT                                 
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,LC@TIME      TIME                                         
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT02P12                                                          
         USING DASAELD,R2                                                       
         GOTO1 VDATCON,DMCB,(3,DASAADDT),(8,PLOINF),0                           
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,DMCB,(3,DASACGDT),(8,PLOINF),0                           
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,DMCB,(3,DASACDTE),(8,PLOINF),0                           
         AHI   R4,L'PLINE                                                       
         XR    R0,R0                                                            
         ICM   R0,7,DASACTME                                                    
         BRAS  RE,PRTTIME                                                       
         MVC   PLOINF(8),WORK                                                   
         DROP  R2                                                               
*                                                                               
CT02P12  LR    R4,R5                                                            
         LTR   R3,R3               TEST CHANGE ELEMENT                          
         BZ    EXITOK                                                           
         USING DASAELD,R3                                                       
         GOTO1 VDATCON,DMCB,(3,DASAADDT),(8,PLNINF),0                           
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,DMCB,(3,DASACGDT),(8,PLNINF),0                           
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,DMCB,(3,DASACDTE),(8,PLNINF),0                           
         AHI   R4,L'PLINE                                                       
         XR    R0,R0                                                            
         ICM   R0,7,DASACTME                                                    
         BRAS  RE,PRTTIME                                                       
         MVC   PLNINF(8),WORK                                                   
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
*              ACACTD                                                           
*                                                                               
CT02P14  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT02P16  LR    R5,R4           *** PROGRAM SAVE ELEMENT                         
         MVC   PLNHDR,HIDSEQ       ID/SEQUENCE NUMBER                           
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HFLDDATA     FIELD DATA                                   
*                                                                               
         LTR   R2,R2               COPY ELEMENT?                                
         BZ    CT02P18                                                          
         LR    R4,R5                                                            
         USING CT01FLDD,R2                                                      
         GOTO1 VHEXOUT,PLIST,CT01ID,PLOINF,1,0                                  
         MVI   PLOINF+2,C'/'                                                    
         GOTO1 (RF),(R1),CT01SEQ,PLOINF+3,1,0                                   
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CT01FLEN                                                      
         AHI   R0,-(CT01TEXT-CT01FLDD)                                          
         LA    RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CT01TEXT),((RF),PLOINF),(C'P',5)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT02P18  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         LR    R4,R5                                                            
         USING CT01FLDD,R3                                                      
         GOTO1 VHEXOUT,PLIST,CT01ID,PLNINF,1,0                                  
         MVI   PLBOTH+3,C'/'                                                    
         GOTO1 (RF),(R1),CT01SEQ,PLNINF+4,1,0                                   
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CT01FLEN                                                      
         AHI   R0,-(CT01TEXT-CT01FLDD)                                          
         LA    RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LA    RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CT01TEXT),((RF),PLNINF),(C'P',5)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         CLM   R4,15,FULL                                                       
         BL    *+8                                                              
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT02P20  MVC   PLNHDR,LC@NAME                                                   
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTFX2ATT),CTFX2ATT-CTFXATT(R2)                          
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTFX2ATT),CTFX2ATT-CTFXATT(R3)                          
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'03' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
* NTRY: R2 = A(ELEMENT)                                               *         
***********************************************************************         
CT03ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,71         FAX RECORD                                   
         BE    CT03P12                                                          
         CLI   ADRECNUM,114        DARE ASSIST RECORD                           
         BE    CT03P18                                                          
         CLI   ADRECNUM,97         SCREEN FIELD                                 
         BE    CT03P24                                                          
         CLI   ADRECNUM,73         RECORD DESCRIPTION                           
         BE    CT03P26                                                          
         CLI   ADRECNUM,74         RECORD DESCRIPTION                           
         BE    CT03P26                                                          
         CLI   ADRECNUM,75         RECORD DESCRIPTION                           
         BE    CT03P26                                                          
         CLI   ADFTYPE,CTFILEQ                                                  
         BE    CT03P02                                                          
         DROP  RF                                                               
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT03P02  LHI   R0,1            *** PASSIVE POINTER                              
         ST    R0,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT03P06                                                          
         USING CTPASD,R2                                                        
         CLI   CTPASLEN,4          NUMBER?                                      
         BH    CT03P04             NO                                           
         MVC   PLNHDR,LC@NUM                                                    
         GOTO1 VHEXOUT,PLIST,CTPASDTA,PLOINF,2,0                                
         B     CT03P06                                                          
*                                                                               
CT03P04  L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,59         SYSTEM / PERSONAL AUTH RECORD                
         BE    CT03P32             YES, NAME IS REALLY A PASSWORD               
         DROP  RF                                                               
*                                                                               
         MVC   PLNHDR,LC@NAME                                                   
         XR    R0,R0                                                            
         IC    R0,CTPASLEN                                                      
         AHI   R0,-3                                                            
         LA    RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTPASDTA),((RF),PLOINF),(C'P',5)             
         MVC   FULL,8(R1)                                                       
         DROP  R2                                                               
*                                                                               
CT03P06  LTR   R3,R3           *** PASSIVE POINTER                              
         BZ    CT03P10                                                          
         USING CTPASD,R3                                                        
         CLI   CTPASLEN,4          NUMBER?                                      
         BH    CT03P08             NO                                           
         MVC   PLNHDR,LC@NUM                                                    
         GOTO1 VHEXOUT,PLIST,CTPASDTA,PLNINF,2,0                                
         B     CT03P10                                                          
*                                                                               
CT03P08  L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,59         SYSTEM / PERSONAL AUTH RECORD                
         BE    CT03P32             YES, NAME IS REALLY A PASSWORD               
         DROP  RF                                                               
*                                                                               
         MVC   PLNHDR,LC@NAME                                                   
         XR    R0,R0                                                            
         IC    R0,CTPASLEN                                                      
         AHI   R0,-3                                                            
         LA    RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LA    RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTPASDTA),((RF),PLNINF),(C'P',5)             
         MVC   FULL,8(R1)                                                       
         DROP  R3                                                               
*                                                                               
CT03P10  ICM   R0,15,FULL                                                       
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         B     EXITOK                                                           
*                                                                               
CT03P12  MVCDD PLNHDR,GE#LINE,L    FAX RECORD ATTENTION NAME                    
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT03P14                                                          
         USING CTFXMSG,R2                                                       
         CURED (B1,CTFX3LIN),(2,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTFX3LEN                                                      
         AHI   R0,-(CTFX3MSG-CTFXMSG)                                           
         LHI   RF,L'PLOINF-3                                                    
         GOTO1 VCHOPPER,DMCB,((R0),CTFX3MSG),((RF),PLOINF+3),(C'P',5)           
         MVC   FULL,8(R1)                                                       
         DROP  R2                                                               
*                                                                               
CT03P14  LTR   R3,R3                                                            
         BZ    CT03P16                                                          
         USING CTFXMSG,R3                                                       
         CURED (B1,CTFX3LIN),(2,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTFX3LEN                                                      
         AHI   R0,-(CTFX3MSG-CTFXMSG)                                           
         LHI   RF,L'PLNINF-3                                                    
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH-3                                                    
         GOTO1 VCHOPPER,DMCB,((R0),CTFX3MSG),((RF),PLNINF+3),(C'P',5)           
         ICM   R0,15,8(R1)                                                      
         CLM   R0,15,FULL                                                       
         BL    *+8                                                              
         ST    R0,FULL                                                          
         DROP  R3                                                               
*                                                                               
CT03P16  L     R0,FULL                                                          
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT03P18  MVCDD PLNHDR,CT#INITS,L                                                
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT03P20                                                          
         USING DASELD,R2                                                        
         LA    RF,WORK                                                          
         LA    R1,DASINITF                                                      
         LHI   R0,DASINIT#                                                      
         BRAS  RE,DASBLD                                                        
*                                                                               
         LR    R0,RF                                                            
         LA    RF,WORK                                                          
         SR    R0,RF                                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLOINF),(C'P',5)                 
         MVC   FULL,8(R1)                                                       
         DROP  R2                                                               
*                                                                               
CT03P20  LTR   R3,R3                                                            
         BZ    CT03P22                                                          
         USING DASELD,R3                                                        
*                                                                               
         LA    RF,WORK                                                          
         LA    R1,DASINITF                                                      
         LHI   R0,DASINIT#                                                      
         BRAS  RE,DASBLD                                                        
*                                                                               
         LR    R0,RF                                                            
         LA    RF,WORK                                                          
         SR    R0,RF                                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLOINF),(C'P',5)                 
         ICM   R0,15,8(R1)                                                      
         CLM   R0,15,FULL                                                       
         BL    *+8                                                              
         ST    R0,FULL                                                          
         DROP  R3                                                               
*                                                                               
CT03P22  L     R0,FULL                                                          
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
DASBLD   CLC   0(DASINITL,R1),SPACES                                            
         BNH   DASB02                                                           
         MVC   0(DASINITL,RF),0(R1)                                             
         MVI   DASINITL(RF),C','                                                
         AHI   RF,DASINITL+1                                                    
*                                                                               
DASB02   AHI   R1,DASINITL                                                      
         BCT   R0,DASBLD                                                        
         BCTR  RF,0                                                             
         CLI   0(RF),C','                                                       
         BNE   *+8                                                              
         MVI   0(RF),C' '                                                       
         BR    RE                                                               
*                                                                               
         USING FSRELD,R2           FIELD SCREEN INFO                            
CT03P24  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  R2                                                               
*                                                                               
CT03P26  MVCDD PLNHDR,CT#TXTN,L    RECORD ELEMENT                               
         LTR   R2,R2                                                            
         BZ    CT03P28                                                          
         USING ACRECD,R2                                                        
         GOTO1 VHEXOUT,ACRECDSC,PLOINF,L'ACRECDSC,0                             
         DROP  R2                                                               
*                                                                               
CT03P28  LTR   R3,R3                                                            
         BZ    CT03P30                                                          
         USING ACRECD,R3                                                        
         GOTO1 VHEXOUT,ACRECDSC,PLNINF,L'ACRECDSC,0                             
         DROP  R3                                                               
*                                                                               
CT03P30  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT03P32  MVC   PLELEM(16),=C'Password Pointer'                                  
         MVCDD PLNHDR,CT#PSWD,L    PASSWORD                                     
         LTR   R2,R2                                                            
         BZ    CT03P34                                                          
*        MVC   PLOINF(10),2(R2)                                                 
*&&UK*&& MVC   PLOINF(10),=C'**********'                                        
*&&US*&& MVC   PLOINF(10),=C'***       '                                        
*                                                                               
CT03P34  LTR   R3,R3                                                            
         BZ    CT03P36                                                          
*        MVC   PLNINF(10),2(R3)                                                 
*&&UK*&& MVC   PLNINF(10),=C'**********'                                        
*&&US*&& MVC   PLNINF(10),=C'***       '                                        
*                                                                               
CT03P36  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'04' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT04ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,42         JCL BOOK                                     
         BE    CT04P02                                                          
         CLI   ADRECNUM,44         LIBRARY BOOK                                 
         BE    CT04P02                                                          
         CLI   ADRECNUM,71         FAX RETURN NUMBER                            
         BE    CT04P06                                                          
         CLI   ADRECNUM,73         LANGUAGE FOR REC/ACT                         
         BE    CT04P12                                                          
         CLI   ADRECNUM,74         LANGUAGE FOR REC/ACT                         
         BE    CT04P12                                                          
         CLI   ADRECNUM,75         LANGUAGE FOR REC/ACT                         
         BE    CT04P12                                                          
         CLI   ADRECNUM,82         INPUT FIELD                                  
         BE    CT04P18                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT04P02  LR    R5,R4           *** INDEX ELEMENT                                
         MVC   PLNHDR,HHIGHSEQ                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HINDNTRY                                                  
*                                                                               
         LR    R4,R4                                                            
         LTR   R2,R2                                                            
         BZ    CT04P04                                                          
         USING CTINDD,R2                                                        
*                                                                               
         XR    R0,R0                                                            
         ICM   R0,1,CTINDHI                                                     
         CURED (R0),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         AHI   R4,L'PLINE                                                       
*                                                                               
         GOTO1 VHEXOUT,DMCB,CTINDEX,WORK,L'CTINDEX,0                            
*                                                                               
         LHI   R0,L'CTINDEX*2      R0 = L'DATA                                  
         LHI   RF,L'PLOINF         RF = WIDTH OF COLUMN                         
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLOINF),(C'P',10)                
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT04P04  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTINDD,R3                                                        
*                                                                               
         XR    R0,R0                                                            
         ICM   R0,1,CTINDHI                                                     
         CURED (R0),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         AHI   R4,L'PLINE                                                       
*                                                                               
         GOTO1 VHEXOUT,DMCB,CTINDEX,WORK,L'CTINDEX,0                            
         LHI   R0,L'CTINDEX*2      R0 = L'DATA                                  
         LHI   RF,L'PLNINF         RF = WIDTH OF COLUMN                         
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLNINF),(C'P',10)                
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         CLM   R4,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT04P06  MVC   PLNHDR,HFRETN   *** FAX RETURN NUMBER                            
         LTR   R2,R2                                                            
         BZ    CT04P08                                                          
         USING CTFXTEL,R2                                                       
*                                                                               
         XR    RF,RF                                                            
         IC    RF,CTFX4LEN                                                      
         AHI   RF,-3                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),CTFX4TEL                                               
         DROP  R2                                                               
*                                                                               
CT04P08  LTR   R3,R3                                                            
         BZ    CT04P10                                                          
         USING CTFXTEL,R3                                                       
*                                                                               
         XR    RF,RF                                                            
         IC    RF,CTFX4LEN                                                      
         AHI   RF,-3                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),CTFX4TEL                                               
*                                                                               
CT04P10  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT04P12  MVCDD PLNHDR,CT#LANG,L    REC/ACT LANGUAGE                             
         LTR   R2,R2                                                            
         BZ    CT04P14                                                          
         USING ACLNGD,R2                                                        
         GOTO1 VHEXOUT,(R2),PLOINF,ACLNGLNQ,0                                   
         DROP  R2                                                               
*                                                                               
CT04P14  LTR   R3,R3                                                            
         BZ    CT04P16                                                          
         USING ACLNGD,R3                                                        
         GOTO1 VHEXOUT,(R3),PLNINF,ACLNGLNQ,0                                   
         DROP  R3                                                               
*                                                                               
CT04P16  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT04P18  MVC   PLNHDR,HFINPFLD *** INPUT FIELD                                  
         LTR   R2,R2                                                            
         BZ    CT04P20                                                          
         USING DEINPD,R2                                                        
         GOTO1 VHEXOUT,DEINPOP,PLOINF,1,0                                       
         MVI   PLOINF+2,C'='                                                    
         XR    RF,RF                                                            
         IC    RF,DEINPLEN                                                      
         AHI   RF,-4                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF+3(0),DEINPTXT                                             
         DROP  R2                                                               
*                                                                               
CT04P20  LTR   R3,R3                                                            
         BZ    CT04P22                                                          
         USING DEINPD,R3                                                        
         GOTO1 VHEXOUT,DEINPOP,PLNINF,1,0                                       
         MVI   PLNINF+2,C'='                                                    
         XR    RF,RF                                                            
         IC    RF,DEINPLEN                                                      
         AHI   RF,-4                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF+3(0),DEINPTXT                                             
         DROP  R3                                                               
*                                                                               
CT04P22  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
HFRETN   DC    CL16'Fax Return #   '                                            
HFINPFLD DC    CL16'Input Field    '                                            
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'06' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT06ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,73         PERSON TITLE                                 
         BE    CT06P02                                                          
         CLI   ADRECNUM,74         PERSON TITLE                                 
         BE    CT06P02                                                          
         CLI   ADRECNUM,75         PERSON TITLE                                 
         BE    CT06P02                                                          
         CLI   ADFTYPE,CTFILEQ     AGENCY DEFAULT                               
         BE    CT06P06                                                          
*                                                                               
         GOTO1 APAIRHEX,(R2),(R3),(R4)                                          
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT06P02  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#DPTC,L                                                 
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#EXTN,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT06P04                                                          
         USING ACTITD,R2                                                        
         LR    R4,R5                                                            
         MVC   PLOINF(L'ACTITDID),ACTITDID                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'ACTITEXT),ACTITEXT                                      
         DROP  R2                                                               
*                                                                               
CT06P04  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         LR    R4,R5                                                            
         USING ACTITD,R3                                                        
         MVC   PLNINF(L'ACTITDID),ACTITDID                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'ACTITEXT),ACTITEXT                                      
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT06P06  LR    R5,R4                                                            
         MVC   PLNHDR,LC@AGYAL                                                  
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#LANG,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT06P10                                                          
         USING CTAGYD,R2                                                        
         LR    R4,R5                                                            
         MVC   HALF,CTAGYID        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLOINF(22),SPROUT                                                
         AHI   R4,L'PLINE                                                       
*                                                                               
         L     R1,VLANGTAB                                                      
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         AHI   R1,6                                                             
         USING LANGTABD,R1                                                      
         CLC   LANGCODE,CTAGYLNG   MATCH LANGUAGE CODE                          
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     CT06P08                                                          
*                                                                               
         MVC   PLOINF(L'LANGFULN),LANGFULN                                      
         B     CT06P10                                                          
         DROP  R1                                                               
*                                                                               
CT06P08  MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         MVI   PLOINF+10,C'-' UNKNOWN LANGAGE - EDIT IT OUT                     
         CURED (B1,CTAGYLNG),(3,PLOINF+11),0,ALIGN=LEFT,ZERO=NOBLANK            
         DROP  R2                                                               
*                                                                               
CT06P10  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTAGYD,R3                                                        
         MVC   HALF,CTAGYID        OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLNINF(22),SPROUT                                                
         AHI   R4,L'PLINE                                                       
*                                                                               
         L     R1,VLANGTAB                                                      
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         AHI   R1,6                                                             
         USING LANGTABD,R1                                                      
         CLC   LANGCODE,CTAGYLNG   MATCH LANGUAGE CODE                          
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     CT06P12                                                          
*                                                                               
         MVC   PLNINF(L'LANGFULN),LANGFULN                                      
         B     EXITOK                                                           
         DROP  R1                                                               
*                                                                               
CT06P12  MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         MVI   PLNINF+10,C'-'      UNKNOWN LANGAGE - EDIT IT OUT                
         CURED (B1,CTAGYLNG),(3,PLNINF+11),0,ALIGN=LEFT,ZERO=NOBLANK            
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'07' ELEMENT DISPLAY ROUTINE - TEXT LIMIT ACCESS LIST              *         
***********************************************************************         
CT07PAIR NTR1  BASE=*,LABEL=*                                                   
         L     R6,AELMNTRY                                                      
         USING CTELEMD,R6                                                       
         LM    R2,R3,0(R1)                                                      
         LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,117        TEXT LIMIT ACCESS RECORD                     
         BE    CT07P04                                                          
*                                                                               
CT07P02  BRAS  RE,DEFPAIR                                                       
         B     EXITOK                                                           
*                                                                               
CT07P04  LHI   R0,L'ELNAMEC        CHOP UP ELEMENT NAME FOR DISPLAY             
         LHI   RF,L'PLELEM                                                      
         LA    R4,PBLOCK                                                        
         GOTO1 VCHOPPER,DMCB,((R0),ELNAMEC),((RF),PLELEM),(C'P',3)              
         DROP  R6                                                               
*                                                                               
CT07P10  XC    FULL,FULL           LINES USED FOR THIS SET                      
*                                                                               
         MVI   THISTYPE,X'FF'      INIT LOWEST TYPE                             
         CLC   0(4,R2),EFFS        DONE WITH COPIES?                            
         BE    CT07P12             YES, SKIP                                    
         L     R1,0(,R2)           R1=A(FIRST COPY)                             
         MVC   THISTYPE,SATLMTYP-SATLMEL(R1) PRESET COPY AS LOWEST TYPE         
CT07P12  CLC   0(4,R3),EFFS        DONE WITH CHANGES?                           
         BE    CT07P14             YES, SKIP                                    
         L     R1,0(,R3)           R1=A(FIRST CHANGE)                           
         CLC   THISTYPE,SATLMTYP-SATLMEL(R1) IS CHANGE TYPE LOWER?              
         BNH   CT07P14             NO, SKIP                                     
         MVC   THISTYPE,SATLMTYP-SATLMEL(R1) SET CHANGE AS LOWEST               
CT07P14  CLI   THISTYPE,X'FF'      IF LOWEST IS FF, THEN ALL DONE               
         BNE   CT07P15                                                          
         BRAS  RE,PRNT             PRINT LINES                                  
         B     EXITOK              AND EXIT                                     
*                                                                               
CT07P15  LR    R6,R2               SEE IF THIS TYPE'S ELEMS CHANGED             
         LR    R7,R3                                                            
CT07P16  LA    RE,EFFS                                                          
         CLC   0(4,R6),EFFS        DONE WITH COPIES?                            
         BE    *+8                 YES, SKIP                                    
         L     RE,0(,R6)           RE=A(NEXT COPY ELEMENT)                      
         LA    RF,EFFS                                                          
         CLC   0(4,R7),EFFS        DONE WITH CHANGES?                           
         BE    *+8                 YES, SKIP                                    
         L     RF,0(,R7)           RF=A(NEXT CHANGE ELEMENT)                    
         CLC   THISTYPE,SATLMTYP-SATLMEL(RE) IS COPY SAME TYPE?                 
         BE    CT07P17             YES, COMPARE ELEMENTS                        
         CLC   THISTYPE,SATLMTYP-SATLMEL(RF) NO, IS CHANGE SAME TYPE?           
         BE    CT07P18             YES, SO THIS SYSTEM HAS CHANGED              
         LR    R2,R6               ELSE ALL ELEMS FOR THIS SYSTEM WERE          
         LR    R3,R7               THE SAME                                     
         B     CT07P10             SO SKIP THIS SYSTEM                          
CT07P17  XR    R1,R1                                                            
         IC    R1,1(,RE)                                                        
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RE),0(RF)       IS THIS PAIR THE SAME?                       
         BNE   CT07P18             NO, SO THIS SYSTEM HAS CHANGED               
         AHI   R6,4                                                             
         AHI   R7,4                                                             
         B     CT07P16             TRY NEXT PAIR                                
*                                                                               
CT07P18  BRAS  RE,CT07TYPE         OUTPUT TYPE IN PLNHDR                        
*                                                                               
         L     R0,AIOTEMP          CLEAR OUT BUILD AREA                         
         LHI   R1,IOL                                                           
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         L     R5,AIOTEMP          R5 = A(NEXT IN BUILD AREA)                   
*                                                                               
CT07P22  CLC   0(4,R2),EFFS        DONE WITH COPIES?                            
         BE    CT07P24             YES                                          
         L     R6,0(R2)                                                         
         CLC   THISTYPE,SATLMTYP-SATLMEL(R6) IS THIS THE CURRENT TYPE           
         BNE   CT07P24             NO, SKIP                                     
         BRAS  RE,CT07DIS                                                       
         AHI   R2,4                                                             
         B     CT07P22                                                          
*                                                                               
CT07P24  L     R0,AIOTEMP                                                       
         CR    R5,R0                                                            
         BE    CT07P30                                                          
         SHI   R5,2                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,AIOTEMP,((RF),PLOINF),(C'P',25),          X        
               C'LEN=',(R5)                                                     
         MVC   FULL,8(R1)                                                       
*                                                                               
CT07P30  L     R0,AIOTEMP          CLEAR OUT BUILD AREA                         
         LHI   R1,IOL                                                           
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         L     R5,AIOTEMP          R5 = A(NEXT IN BUILD AREA)                   
*                                                                               
CT07P32  CLC   0(4,R3),EFFS        FINISHED WITH CHANGES?                       
         BE    CT07P34             YES                                          
         L     R6,0(R3)                                                         
         CLC   THISTYPE,SATLMTYP-SATLMEL(R6) IS THIS THE CURRENT TYPE           
         BNE   CT07P34             NO, SKIP                                     
         BRAS  RE,CT07DIS                                                       
         AHI   R3,4                                                             
         B     CT07P32                                                          
*                                                                               
CT07P34  L     R0,AIOTEMP                                                       
         CR    R5,R0                                                            
         BE    CT07P40                                                          
         SHI   R5,2                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   R0,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   R0,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,AIOTEMP,((R0),PLNINF),(C'P',25),          X        
               C'LEN=',(R5)                                                     
         CLC   FULL,8(R1)                                                       
         BNL   *+10                                                             
         MVC   FULL,8(R1)                                                       
*                                                                               
CT07P40  ICM   R0,15,FULL          LINES USED                                   
         MHI   R0,L'PLINE                                                       
         AR    R4,R0               NEXT FREE LINE                               
         B     CT07P10             NEXT SYSTEM                                  
*                                                                               
         USING SATLMD,R6                                                        
CT07DIS  NTR1  BASE=*,LABEL=*                                                   
         TM    SATLMCTL,SATLMNFQ                                                
         BZ    *+12                                                             
         MVI   0(R5),C'-'                                                       
         AHI   R5,1                                                             
         XR    R1,R1                                                            
         IC    R1,SATLMLEN                                                      
         SHI   R1,(SATLMDTA-SATLMD)+1                                           
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R5),SATLMDTA                                                 
         LA    R5,1(R1,R5)                                                      
         TM    SATLMCTL,SATLMRDQ                                                
         BZ    CT07D10                                                          
         MVI   0(R5),C'('                                                       
         MVC   1(1,R5),L8@READ                                                  
         MVI   2(R5),C')'                                                       
         AHI   R5,3                                                             
*                                                                               
CT07D10  MVC   0(2,R5),=C', '                                                   
         AHI   R5,2                                                             
*                                                                               
CT07DX   XIT1  REGS=(R5)                                                        
         DROP  R6                                                               
*                                                                               
CT07TYPE NTR1  BASE=*,LABEL=*                                                   
         MVCDD PLNHDR(5),GE#TYPE,L                                              
         MVC   PLNHDR+6(1),THISTYPE COPY TYPE AS IS.                            
         CLI   AGYLANG,3           TEST ENGLISH                                 
         BL    EXIT                YES, NO NEED TO TRANSLATE TYPE               
         L     R1,AIOSORT                                                       
         AHI   R1,RCVFRST-RECDS                                                 
         USING SATLREC,R1                                                       
         LA    RF,CT07TYPT         SEE IF NON ENGLISH VERSION                   
CT07T06  CLC   SATLSYS,2(RF)                                                    
         DROP  R1                                                               
         BE    CT07T08                                                          
         AH    RF,0(RF)                                                         
         OC    0(2,RF),0(RF)                                                    
         BNZ   CT07T06                                                          
         B     EXIT                CAN'T TRANSLATE - NOT IN TABLE               
CT07T08  CLI   3+2(RF),0           ANY LANGUAGE?                                
         BE    *+14                NO, SKIP                                     
         CLC   AGYLANG,3+2(RF)     OUR LANGUAGE                                 
         BNE   *+14                NO, NEXT                                     
         CLC   THISTYPE,3+1(RF)    IS THIS THE TYPE                             
         BE    CT07T09             YES, USE IT                                  
         LA    RF,3(,RF)                                                        
         CLI   0(RF),X'FF'                                                      
         BNE   CT07T08                                                          
         B     EXIT                 CAN'T TRANSLATE - NOT IN TABLE              
CT07T09  MVC   PLNHDR+6(1),3+0(RF)  COPY TRANSLATED TYPE                        
         B     EXIT                                                             
*                                                                               
*&&US                                                                           
CT07TYPT EQU   *                                                                
CT07TY1  DC    AL2(CT07TY1X-*)     LENGTH OF ENTRY FOR SYSTEM                   
         DC    X'02'               SPOT SYSTEM SE                               
*        TYPES W/IN SYSTEM - DISPLAY, TYPE, LANG                                
         DC    C'M',C'M',AL1(0)                                                 
         DC    C'C',C'C',AL1(0)                                                 
         DC    C'P',C'P',AL1(0)                                                 
         DC    C'E',C'E',AL1(0)                                                 
         DC    X'FF'                                                            
CT07TY1X EQU   *                                                                
         DC    AL2(CT07TY2X-*)                                                  
         DC    X'06'               ACC SYSTEM SE                                
         DC    C'M',C'M',AL1(0)                                                 
         DC    C'C',C'C',AL1(0)                                                 
         DC    C'P',C'P',AL1(0)                                                 
         DC    C'O',C'O',AL1(0)                                                 
         DC    X'FF'                                                            
CT07TY2X EQU   *                                                                
         DC    AL2(0)              END OF THE TABLE                             
*&&                                                                             
*&&UK                                                                           
CT07TYPT EQU   *                                                                
CT07TY1  DC    AL2(CT07TY1X-*)     LENGTH OF ENTRY FOR SYSTEM                   
         DC    X'04'               MEDIA SYSTEM SE                              
         DC    C'K',C'C',AL1(3)    GERMAN                                       
         DC    C'C',C'C',AL1(0)                                                 
         DC    X'FF'                                                            
CT07TY1X EQU   *                                                                
         DC    AL2(0)              END OF THE TABLE                             
*&&                                                                             
         EJECT                                                                  
***********************************************************************         
* X'07' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT07ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,73         RECORD/ACTION COMBO                          
         BE    CT07E02                                                          
         CLI   ADRECNUM,74         RECORD/ACTION COMBO                          
         BE    CT07E02                                                          
         CLI   ADRECNUM,75         RECORD/ACTION COMBO                          
         BE    CT07E02                                                          
         CLI   ADRECNUM,95         PFKEY DEFINITION                             
         BE    CT07E02                                                          
         CLI   ADFTYPE,CTFILEQ     AGENCY DEFAULT                               
         BE    CT07E04                                                          
*                                                                               
CT07E02  GOTO1 APAIRHEX,(R2),(R3),(R4)                                          
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT07E04  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#PSWD,L                                                 
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'PQ generic      '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Wild card       '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Synonym         '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Synonym pointer '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Master PQ group '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Password reqd   '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Privileged PQ   '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Uses PNAME recs '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'PNAME frm prcpl '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'PNAME frm usrid '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'MASTER userid   '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'PARTNER userid  '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'MASTER userid # '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'SYNONYM number  '                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'SYNONYM name    '                                   
         AHI   R4,L'PLINE                                                       
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT07E06                                                          
         USING CTIDOD,R2                                                        
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFPW                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFGN                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFWC                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFSN                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFSP                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFPI                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFPP                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOPPU                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOFPN                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOPPP                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOPPI                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOFMA                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOFPA                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         CURED CTIDOPQI,(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         AHI   R4,L'PLINE                                                       
         CURED CTIDOSNU,(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTIDOSID),CTIDOSID                                      
         DROP  R2                                                               
*                                                                               
CT07E06  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTIDOD,R3                                                        
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFPW                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFGN                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFWC                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFSN                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFSP                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFPI                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOFPP                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL1,CTIDOPPU                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOFPN                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOPPP                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOPPI                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOFMA                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTIDOFL2,CTIDOFPA                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         CURED CTIDOPQI,(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         AHI   R4,L'PLINE                                                       
         CURED CTIDOSNU,(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTIDOSID),CTIDOSID                                      
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'10' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT10ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,1          FILTER                                       
         BE    CT10P02                                                          
         CLI   ADRECNUM,77         EXCHANGE RATE                                
         BE    CT10P08                                                          
         CLI   ADRECNUM,78         MESSAGE                                      
         BE    CT10P10                                                          
         CLI   ADRECNUM,80         NARRATIVE                                    
         BE    CT10P16                                                          
         CLI   ADRECNUM,81         HELP HEADING                                 
         BE    CT10P20                                                          
         CLI   ADRECNUM,82         RECORD START (DRIVER)                        
         BE    CT10P26                                                          
         CLI   ADRECNUM,84         BROADCAST FILTER                             
         BE    CT10P32                                                          
         CLI   ADRECNUM,86         NIC PARAMETERS                               
         BE    CT10P46                                                          
         CLI   ADRECNUM,87         NIC PARAMETERS                               
         BE    CT10P46                                                          
         CLI   ADRECNUM,88         NIC PARAMETERS                               
         BE    CT10P46                                                          
         CLI   ADRECNUM,89         NIC PARAMETERS                               
         BE    CT10P46                                                          
         CLI   ADRECNUM,90         ROLE DESCRIPTION PARAMETERS                  
         BE    CT10P46                                                          
         CLI   ADRECNUM,91         NIC PARAMETERS                               
         BE    CT10P46                                                          
         CLI   ADRECNUM,101        NAME TEXT                                    
         BE    CT10P48                                                          
         CLI   ADRECNUM,115        SUBJECT TEXT                                 
         BE    CT10P50                                                          
         CLI   ADRECNUM,113        RFP                                          
         BE    CT10E28                                                          
         CLI   ADFTYPE,CTFILEQ     DEFAULT FOR CTFILE                           
         BE    CT10P02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT10P02  MVCDD PLNHDR,CT#FLT,L                                                  
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CT01FILT),CT01FILT-CT01FLTD(R2)                         
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CT01FILT),CT01FILT-CT01FLTD(R3)                         
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT10P08  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
*                                                                               
CT10P10  MVC   PLNHDR,HMESSAGE *** SHORT MESSAGE                                
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT10P12                                                          
         USING GMSGEL,R2                                                        
         XR    R0,R0                                                            
         IC    R0,GMSGELL                                                       
         AHI   R0,-(GMSGTXT-GMSGD)                                              
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),GMSGTXT),((RF),PLOINF),(C'P',5)              
         MVC   FULL,8(R1)                                                       
         DROP  R2                                                               
*                                                                               
CT10P12  LTR   R3,R3                                                            
         BZ    CT10P14                                                          
         USING GMSGEL,R3                                                        
         XR    R0,R0                                                            
         IC    R0,GMSGELL                                                       
         AHI   R0,-(GMSGTXT-GMSGD)                                              
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),GMSGTXT),((RF),PLNINF),(C'P',5)              
         ICM   R0,15,8(R1)                                                      
         CLM   R0,15,FULL                                                       
         BL    *+8                                                              
         STCM  R0,15,FULL                                                       
         DROP  R3                                                               
*                                                                               
CT10P14  L     R0,FULL                                                          
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT10P16  LR    R5,R4           *** NARRATIVE                                    
         XC    FULL,FULL                                                        
         MVCDD PLNHDR,CT#SEQ,L                                                  
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#HEADR,L                                                
         AHI   R4,L'PLINE                                                       
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT10P18                                                          
         USING GNDATD,R2                                                        
*                                                                               
         CURED (B1,GNDATSEQ),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'GNDATHDR),GNDATHDR                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0               DATA PORTION                                 
         IC    R0,GNDATLEN                                                      
         AHI   R0,-(GNDATA-GNDATD)                                              
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),GNDATA),((RF),PLOINF),(C'P',8)               
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT10P18  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING GNDATD,R3                                                        
*                                                                               
         CURED (B1,GNDATSEQ),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'GNDATHDR),GNDATHDR                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0               DATA PORTION                                 
         IC    R0,GNDATLEN                                                      
         AHI   R0,-(GNDATA-GNDATD)                                              
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),GNDATA),((RF),PLNINF),(C'P',8)               
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         CLM   R4,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT10P20  MVCDD PLNHDR,CT#HEAD,L    HELP (V1)                                    
         LTR   R2,R2                                                            
         BZ    CT10P22                                                          
         USING HV1HEDD,R2                                                       
         MVC   PLOINF(L'HV1HEDTX),HV1HEDTX                                      
         DROP  R2                                                               
*                                                                               
CT10P22  LTR   R3,R3                                                            
         BZ    CT10P24                                                          
         USING HV1HEDD,R3                                                       
         MVC   PLNINF(L'HV1HEDTX),HV1HEDTX                                      
         DROP  R3                                                               
*                                                                               
CT10P24  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
         USING DERECD,R2                                                        
CT10P26  MVC   PLNHDR,HRECSTMT *** DRIVER DICTIONARY                            
         LTR   R2,R2                                                            
         BZ    CT10P28                                                          
         XR    R1,R1                                                            
         IC    R1,DERECLEN                                                      
         AHI   R1,-(DERECLAB-DERECD+1)                                          
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),DERECLAB                                               
*                                                                               
CT10P28  LR    R3,R3                                                            
         BZ    CT10P30                                                          
         USING DERECD,R2                                                        
         XR    R1,R1                                                            
         IC    R1,DERECLEN                                                      
         AHI   R1,-(DERECLAB-DERECD+1)                                          
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),DERECLAB                                               
*                                                                               
CT10P30  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT10P32  MVC   PLNHDR,HFACPAK  *** BROADCAST FILTER                             
CPY      USING BRDFLTD,R2                                                       
CHA      USING BRDFLTD,R3                                                       
*                                                                               
         LTR   R2,R2               FACPAK=                                      
         BZ    CT10P34                                                          
         MVC   PLOINF(L'L4@ALL),L4@ALL                                          
         XR    RF,RF                                                            
         ICM   RF,1,CPY.BRDFAPPL                                                
         BZ    CT10P34                                                          
         MHI   RF,L'FACITAB                                                     
         A     RF,AFACITAB                                                      
         MVC   PLOINF(L'FACISN4),FACISN4-FACITABD(RF)                           
*                                                                               
CT10P34  LTR   R3,R3                                                            
         BZ    CT10P36                                                          
         MVC   PLOINF(L'L4@ALL),L4@ALL                                          
         XR    RF,RF                                                            
         ICM   RF,1,CPY.BRDFAPPL                                                
         BZ    CT10P36                                                          
         MHI   RF,L'FACITAB                                                     
         A     RF,AFACITAB                                                      
         MVC   PLOINF(L'FACISN4),FACISN4-FACITABD(RF)                           
*                                                                               
CT10P36  AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,LC@DATE                                                   
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT10P38             START/END DATES                              
         OC    CPY.BRDFSTDT,CPY.BRDFSTDT                                        
         BZ    CT10P38                                                          
*                                                                               
         LA    RF,CPY.BRDFSTDT     A(DATES) - START, AND MAYBE END TOO          
         ST    RF,DMCB                                                          
         MVI   DMCB,2              COMPRESSED INPUT TYPE                        
         CLC   CPY.BRDFSTDT,CPY.BRDFENDT   SAME START AND END DATES?            
         BE    *+8                                                              
         OI    DMCB,X'10'          NO -- PASS BOTH DATES                        
         GOTO1 VDATCON,DMCB,,(17,PLOINF),0                                      
*                                                                               
CT10P38  LTR   R3,R3                                                            
         BZ    CT10P40             START/END DATES                              
         OC    CPY.BRDFSTDT,CPY.BRDFSTDT                                        
         BZ    CT10P40                                                          
*                                                                               
         LA    RF,CHA.BRDFSTDT     A(DATES) - START, AND MAYBE END TOO          
         ST    RF,DMCB                                                          
         MVI   DMCB,2              COMPRESSED INPUT TYPE                        
         CLC   CHA.BRDFSTDT,CHA.BRDFENDT   SAME START AND END DATES?            
         BE    *+8                                                              
         OI    DMCB,X'10'          NO -- PASS BOTH DATES                        
         GOTO1 VDATCON,DMCB,,(17,PLNINF),0                                      
*                                                                               
CT10P40  AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HTIMERG                                                   
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT10P42                                                          
         OC    CPY.BRDFSTTM,CPY.BRDFSTTM                                        
         BZ    CT10P42                                                          
*                                                                               
         XR    RE,RE                                                            
         IC    RE,CPY.BRDFSTTM     START HOUR                                   
         MHI   RE,100                                                           
         XR    RF,RF                                                            
         IC    RF,CPY.BRDFSTTM+1   START MINUTES                                
         AR    RE,RF                                                            
         STH   RE,FULL             START TIME (MILITARY)                        
*                                                                               
         XR    RE,RE                                                            
         IC    RE,CPY.BRDFENTM     END HOUR                                     
         MHI   RE,100                                                           
         XR    RF,RF                                                            
         IC    RF,CPY.BRDFENTM+1   END MINUTES                                  
         AR    RE,RF                                                            
         STH   RE,FULL+2           END TIME (MILITARY)                          
         GOTO1 VUNTIME,DMCB,FULL,PLOINF                                         
*                                                                               
CT10P42  LTR   R3,R3                                                            
         BZ    CT10P44                                                          
         OC    CHA.BRDFSTTM,CHA.BRDFSTTM                                        
         BZ    CT10P44                                                          
*                                                                               
         XR    RE,RE                                                            
         IC    RE,CHA.BRDFSTTM     START HOUR                                   
         MHI   RE,100                                                           
         XR    RF,RF                                                            
         IC    RF,CHA.BRDFSTTM+1   START MINUTES                                
         AR    RE,RF                                                            
         STH   RE,FULL             START TIME (MILITARY)                        
*                                                                               
         XR    RE,RE                                                            
         IC    RE,CHA.BRDFENTM     END HOUR                                     
         MHI   RE,100                                                           
         XR    RF,RF                                                            
         IC    RF,CHA.BRDFENTM+1   END MINUTES                                  
         AR    RE,RF                                                            
         STH   RE,FULL+2           END TIME (MILITARY)                          
         GOTO1 VUNTIME,DMCB,FULL,PLOINF                                         
*                                                                               
CT10P44  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  CPY,CHA                                                          
*                                                                               
*        USING GFNICD                                                           
*                                                                               
CT10P46  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT10P48  MVC   PLNHDR,LC@NAME      NAME ELEMENT (DESCRIPTION)                   
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DTNAME),DTNAME-DTNAMD(R2)                               
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DTNAME),DTNAME-DTNAMD(R3)                               
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT10P50  MVC   PLNHDR,HSUBJECT *** BROADCAST SUBJECT                            
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2               COPY ELEMENT                                 
         BZ    CT10P52                                                          
         USING CTDATD,R2                                                        
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTDATLEN                                                      
         AHI   R0,-(CTDATA-CTDATD)                                              
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTDATA),((RF),PLOINF),(C'P',3)               
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT10P52  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTDATD,R3                                                        
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTDATLEN                                                      
         AHI   R0,-(CTDATA-CTDATD)                                              
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTDATA),((RF),PLNINF),(C'P',3)               
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
*              GRPDD           *** GROUP DATE RANGE                             
*                                                                               
CT10E28  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'1F' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT1FELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     CONTROL FILE DEFAULT                         
         BE    CT1FP02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT1FP02  MVCDD PLNHDR,CT#ID,L  *** PERSONAL ID                                  
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTPID),CTPID-CTPIDD(R2)                                 
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTPID),CTPID-CTPIDD(R3)                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'20' ELEMENT DISPLAY ROUTINE - USER ID                             *         
***********************************************************************         
CT20PAIR NTR1  BASE=*,LABEL=*                                                   
         L     R6,AELMNTRY                                                      
         USING CTELEMD,R6                                                       
         LM    R2,R3,0(R1)                                                      
         LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,1          OTHER DATA                                   
         BE    CT20P02                                                          
         CLI   ADRECNUM,78         HIGH MESSAGE NUMBER                          
         BE    CT20P02                                                          
         CLI   ADRECNUM,81         HELP TEXT                                    
         BE    CT20P02                                                          
         CLI   ADRECNUM,82         INPUT STATEMENT HEADER                       
         BE    CT20P02                                                          
         CLI   ADRECNUM,84         HEADING                                      
         BE    CT20P02                                                          
         CLI   ADRECNUM,113        RFP - GROUP VALUE                            
         BE    CT20P02                                                          
         CLI   ADFTYPE,CTFILEQ     CTFILE DEFAULT                               
         BE    CT20P04                                                          
*                                                                               
CT20P02  BRAS  RE,DEFPAIR                                                       
         B     EXITOK                                                           
*                                                                               
CT20P04  LHI   R0,L'ELNAMEC        CHOP UP ELEMENT NAME FOR DISPLAY             
         LHI   RF,L'PLELEM                                                      
         LA    R4,PBLOCK                                                        
         GOTO1 VCHOPPER,DMCB,((R0),ELNAMEC),((RF),PLELEM),(C'P',3)              
         DROP  R6                                                               
*                                                                               
         MVCDD PLNHDR,CT#USRIS,L                                                
*                                                                               
         LA    R0,WORK             CLEAR OUT WORK AREA                          
         LHI   R1,L'WORK                                                        
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         LA    R5,WORK             R5 = A(NEXT IN WORK BUILD AREA)              
*                                                                               
CT20P06  CLC   0(4,R2),EFFS        DONE WITH COPIES?                            
         BE    CT20P08             YES                                          
         L     R6,0(R2)                                                         
         BRAS  RE,CT20DIS                                                       
         AHI   R2,4                                                             
         B     CT20P06                                                          
*                                                                               
CT20P08  LA    R0,WORK                                                          
         CR    R5,R0                                                            
         BE    CT20P10                                                          
         BCTR  R5,0                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R5),WORK),((RF),PLOINF),(C'P',10)                
*                                                                               
CT20P10  LA    R0,WORK             CLEAR OUT WORK AREA                          
         LHI   R1,L'WORK                                                        
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         LA    R5,WORK             R5 = A(NEXT IN WORK BUILD AREA)              
*                                                                               
CT20P12  CLC   0(4,R3),EFFS        FINISHED WITH CHANGES?                       
         BE    CT20P14             YES                                          
         L     R6,0(R3)                                                         
         BRAS  RE,CT20DIS                                                       
         AHI   R3,4                                                             
         B     CT20P12                                                          
*                                                                               
CT20P14  LA    R0,WORK                                                          
         CR    R5,R0                                                            
         BE    CT20P16                                                          
         BCTR  R5,0                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   R0,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   R0,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R5),WORK),((R0),PLNINF),(C'P',10)                
*                                                                               
CT20P16  BRAS  RE,PRNT             PRINT LINES                                  
         B     EXITOK                                                           
*                                                                               
         USING CTIDD,R6                                                         
CT20DIS  NTR1  ,                                                                
         TM    CTID,X'80'                                                       
         BZ    CT20D02                                                          
         MVC   0(L'CTID,R5),CTID                                                
         AHI   R5,L'CTID                                                        
         B     CT20D20                                                          
*                                                                               
CT20D02  OC    CTID(2),CTID                                                     
         BNZ   CT20D04                                                          
         MVC   0(L'CTID,R5),CTID                                                
         MVC   0(2,R5),=CL2'L='                                                 
         AHI   R5,L'CTID                                                        
         B     CT20D20                                                          
*                                                                               
CT20D04  CLC   CTID(2),=X'0001'                                                 
         BNE   CT20D06                                                          
         MVC   2(L'CTIDAGY,R5),CTIDAGY                                          
         MVC   0(2,R5),=CL2'A='                                                 
         AHI   R5,L'CTIDAGY+2                                                   
         B     CT20D20                                                          
*                                                                               
CT20D06  TM    CTID,X'40'                                                       
         BZ    CT20D10                                                          
         MVC   4(L'CTIDNAM,R5),CTIDNAM                                          
         MVC   0(4,R5),=CL4'R/O='                                               
         AHI   R5,L'CTIDNAM+4                                                   
         B     CT20D20                                                          
*                                                                               
CT20D10  XR    R0,R0               HEX OUT UNKNOWN VALUES                       
         IC    R0,CTIDLEN                                                       
         GOTO1 VHEXOUT,PLIST,CTIDD,0(R5),(R0),0                                 
         SLL   R0,2                                                             
         AR    R5,R0                                                            
*                                                                               
CT20D20  CLI   0(R5),C' '          ADD A TRAILING COMMA                         
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   1(R5),C','                                                       
         AHI   R5,2                                                             
         XIT1  REGS=(R5)                                                        
         DROP  R6                                                               
         EJECT                                                                  
***********************************************************************         
* X'20' ELEMENT PAIR DISPLAY ROUTINE                                  *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT20ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,1          OTHER DATA                                   
         BE    CT20E04                                                          
         CLI   ADRECNUM,78         HIGH MESSAGE NUMBER                          
         BE    CT20E08                                                          
         CLI   ADRECNUM,81         HELP TEXT                                    
         BE    CT20E12                                                          
         CLI   ADRECNUM,82         INPUT STATEMENT HEADER                       
         BE    CT20E16                                                          
         CLI   ADRECNUM,84         HEADING                                      
         BE    CT20E18                                                          
         CLI   ADRECNUM,113        RFP - GROUP VALUE                            
         BE    CT20E02                                                          
*                                                                               
CT20E02  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
         LR    R5,R4               SAVE A(FIRST LINE)                           
CT20E04  MVCDD PLNHDR,CT#OUID,L                                                 
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#OFFC,L                                                 
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#LIMAC,L                                                
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#AULST,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT20E06                                                          
         USING CT01OTHD,R2                                                      
         CURED CT01ORIG,(7,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CT01OFFC),CT01OFFC                                      
         CLI   CT01OFFC,C'*'                                                    
         BNE   *+10                                                             
         MVC   PLOINF+3(5),=CL5'(DDS)'                                          
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,CT01ACCS,PLOINF,L'CT01ACCS,0                        
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,CT01AUTH,PLOINF,L'CT01AUTH,0                        
         DROP  R2                                                               
*                                                                               
CT20E06  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CT01OTHD,R3                                                      
         CURED CT01ORIG,(7,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CT01OFFC),CT01OFFC                                      
         CLI   CT01OFFC,C'*'                                                    
         BNE   *+10                                                             
         MVC   PLNINF+3(5),=CL5'(DDS)'                                          
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,CT01ACCS,PLNINF,L'CT01ACCS,0                        
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,CT01AUTH,PLNINF,L'CT01AUTH,0                        
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
         USING GMCTLD,R2       *** HIGH MESSAGE NUMBER                          
CT20E08  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT20E12  LR    R5,R4           *** HELP TEXT MESSAGE                            
         MVCDD PLNHDR,CT#SEQ,L                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HVALBITS                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HOPTBITS                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HTEXT                                                     
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT20E14                                                          
         USING HV1TXTD,R2                                                       
         CURED (B1,HV1TXTSQ),(3,PLOINF),0,ZERO=NOBLANK,ALIGN=LEFT               
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,HV1TXTVB,PLOINF,L'HV1TXTVB,0                        
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,HV1TXTOP,PLOINF,L'HV1TXTOP,0                        
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         IC    R0,HV1TXTLN                                                      
         AHI   R0,-(HV1TXTOV+1)                                                 
         LHI   RF,L'PLNINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),HV1TXTTX),((RF),PLBOTH),(C'P',3)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         C     R4,FULL                                                          
         BNH   *+8                                                              
         ST    R4,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT20E14  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    CT20E14                                                          
         USING HV1TXTD,R3                                                       
         CURED (B1,HV1TXTSQ),(3,PLNINF),0,ZERO=NOBLANK,ALIGN=LEFT               
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,HV1TXTVB,PLNINF,L'HV1TXTVB,0                        
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,DMCB,HV1TXTOP,PLNINF,L'HV1TXTOP,0                        
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         IC    R0,HV1TXTLN                                                      
         AHI   R0,-(HV1TXTOV+1)                                                 
*                                                                               
         LHI   RF,L'PLNINF                                                      
         LTR   R2,R2                                                            
         BNZ   *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),HV1TXTTX),((RF),PLNINF),(C'P',3)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         C     R4,FULL                                                          
         BNH   *+8                                                              
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT20E16  MVC   PLNHDR,HLABEL   *** INPUT STATEMENT LABEL                        
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DEISLAB),DEISLAB-DEISD(R2)                              
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DEISLAB),DEISLAB-DEISD(R3)                              
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT20E18  MVCDD PLNHDR,CT#HEAD,L    BROADCAST HEADING                            
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'BRDHEDTX),BRDHEDTX-BRDHEDD(R2)                          
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'BRDHEDTX),BRDHEDTX-BRDHEDD(R2)                          
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
*                                                                               
HOPTBITS DC    CL16'Option Bits'                                                
HVALBITS DC    CL16'Validity Bits'                                              
         EJECT                                                                  
***********************************************************************         
* X'21' ELEMENT PAIR HANDLER                                          *         
***********************************************************************         
CT21PAIR NTR1  BASE=*,LABEL=*                                                   
         L     R6,AELMNTRY                                                      
         USING CTELEMD,R6                                                       
         LM    R2,R3,0(R1)                                                      
         LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,68         ADDRESS LINE 1                               
         BE    CT21P02                                                          
         CLI   ADRECNUM,82         OUTPUT STATEMENT LABEL                       
         BE    CT21P02                                                          
         CLI   ADFTYPE,CTFILEQ     CTFILE DEFAULT                               
         BE    CT21P04                                                          
*                                                                               
CT21P02  BRAS  RE,DEFPAIR                                                       
         B     EXITOK                                                           
*                                                                               
CT21P04  LHI   R0,L'ELNAMEC        CHOP UP ELEMENT NAME FOR DISPLAY             
         LHI   RF,L'PLELEM                                                      
         LA    R4,PBLOCK                                                        
         GOTO1 VCHOPPER,DMCB,((R0),ELNAMEC),((RF),PLELEM),(C'P',3)              
         DROP  R6                                                               
*                                                                               
CT21P06  CLC   0(4,R2),EFFS        DONE WITH COPIES?                            
         BE    CT21P14             YES                                          
         L     R6,0(R2)                                                         
CPY      USING CTSYSD,R6                                                        
*                                                                               
         LR    RF,R3               SEE IF MATCHING SYSTEM FOR CHANGE            
CT21P08  CLC   0(4,RF),EFFS                                                     
         BE    CT21P10             NO MATCHING SYSTEM                           
         ICM   R7,15,0(RF)                                                      
         BZ    CT21P09             SYSTEM ALREADY RESOLVED                      
CHG      USING CTSYSD,R7                                                        
         CLC   CPY.CTSYSSE,CHG.CTSYSSE                                          
         BE    *+12                                                             
CT21P09  AHI   RF,4                                                             
         B     CT21P08                                                          
*                                                                               
         XC    0(4,RF),0(RF)       CLEAR RESOLVED COPY                          
         LR    R0,R1                                                            
         GOTO1 CT21SDIS,PLIST,CPY.CTSYSD,CHG.CTSYSD                             
         B     CT21P12                                                          
*                                                                               
CT21P10  GOTO1 CT21SDIS,PLIST,CPY.CTSYSD,0                                      
*                                                                               
CT21P12  AHI   R2,4                NEXT COPY IN LIST                            
         B     CT21P06                                                          
         DROP  CPY,CHG                                                          
*                                                                               
CT21P14  CLC   0(4,R3),EFFS        FINISHED WITH CHANGES?                       
         BE    CT21P18             YES                                          
*                                                                               
         ICM   R6,15,0(R3)                                                      
         BZ    CT21P16             THIS CHANGE DISPLAYED AS A PAIR              
         GOTO1 CT21SDIS,PLIST,0,(R6)                                            
*                                                                               
CT21P16  AHI   R3,4                NEXT CHANGE                                  
         B     CT21P14                                                          
*                                                                               
CT21P18  LA    R0,PBLOCK           CLEAR PBLOCK TO SPACES IN CASE               
         L     R1,=A(PBLOCKL)      ALL DATA SUPPRESSED                          
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'21' SYSTEM ELEMENT PAIR DISPLAY ROUTINE                           *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT21SDIS NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
CPY      USING CTSYSD,R2           COPY ELEMENT                                 
CHG      USING CTSYSD,R3           CHANGE ELEMENT                               
         LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
*                                                                               
         LTR   R5,R2                                                            
         BNZ   *+6                                                              
         LR    R5,R3                                                            
         USING CTSYSD,R5           COMMON DATA COMES FROM THIS ONE              
*                                                                               
         XC    ASYSEL,ASYSEL       SET NO ID SYSEL APPLIES                      
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    CT21S04             YES, SYSEL CHECK NOT NEEDED                  
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,41         NOT NEEDED ON ID RECORD EITHER               
         BE    CT21S04                                                          
         CLI   ADRECNUM,52         NOR ON TERMINAL RECORD                       
         BE    CT21S04                                                          
         DROP  RF                                                               
*                                                                               
         LH    RF,=Y(SVSYSELS-WORKD)                                            
         AR    RF,RC                                                            
         XR    R0,R0                                                            
CT21S02  CLI   0(RF),0                                                          
         BE    EXITOK              IGNORE SYSTEM IF NO ID SYSEL FOR IT          
         CLC   CTSYSNUM,CTSYSNUM-CTSYSEL(RF)                                    
         BE    CT21S03             MATCHING SYSTEM                              
         IC    R0,1(,RF)                                                        
         AR    RF,R0                                                            
         B     CT21S02                                                          
CT21S03  ST    RF,ASYSEL           SAVE A(SYSEL) FOR THIS SYSTEM                
*                                                                               
CT21S04  MVC   PLNHDR,LC@SYS                                                    
         XC    APGMLST,APGMLST                                                  
         XC    ASE,ASE                                                          
*                                                                               
         L     R1,VSELIST                                                       
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         AHI   R1,6                                                             
         USING SELISTD,R1                                                       
         CLC   SESYS,CTSYSSE       MATCH SE NUMBER                              
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     CT21S06                                                          
*                                                                               
         ST    R1,ASE              STORE A(THIS SYSTEM)                         
         MVC   APGMLST,SEPGMS      AND A(SEPGMS)                                
*                                                                               
         LTR   R2,R2               COPY?                                        
         BZ    *+10                                                             
         MVC   PLOINF(L'SENAME),SENAME                                          
         LTR   R3,R3               CHANGE?                                      
         BZ    *+10                                                             
         MVC   PLNINF(L'SENAME),SENAME                                          
*                                                                               
         AHI   R4,L'PLINE          NEXT DISPLAY LINE                            
         B     CT21S10                                                          
*                                                                               
CT21S06  L     R1,VSELIST                                                       
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         LA    R1,6(R1)                                                         
         USING SELISTD,R1                                                       
         CLC   SEOVSYS,CTSYSNUM    MATCH SE NUMBER                              
         BE    CT21S08                                                          
         BXLE  R1,RE,*-10                                                       
*                                                                               
         MVC   WORK+00(80),SPACES                                               
         MVC   WORK+00(10),LC@UNKNW                                             
         MVC   WORK+12(12),=CL3'SE='                                            
         GOTO1 VHEXOUT,DMCB,CTSYSSE,WORK+15,L'CTSYSSE,0                         
         MVC   WORK+20(04),=CL4'SYS='                                           
         GOTO1 VHEXOUT,DMCB,CTSYSNUM,WORK+24,L'CTSYSNUM                         
*                                                                               
         LTR   R2,R2               COPY?                                        
         BZ    *+10                                                             
         MVC   PLOINF,WORK                                                      
         LTR   R3,R3               CHANGE?                                      
         BZ    *+10                                                             
         MVC   PLNINF,WORK                                                      
         BRAS  RE,PRNT             PRINT THIS AND EXIT                          
         B     EXITOK                                                           
*                                                                               
CT21S08  ST    R1,ASE              STORE A(THIS SYSTEM)                         
         MVC   APGMLST,SEPGMS      SAVE A(PGMS)                                 
*                                                                               
         L     R1,VSYSLST                                                       
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         LA    R1,6(R1)                                                         
         USING SYSLSTD,R1                                                       
         CLC   CTSYSNUM,SYSLNUM    MATCH SYSTEM NUMBER                          
         BE    *+10                                                             
         BXLE  R1,RE,*-10                                                       
         DC    H'0'                                                             
*                                                                               
         LTR   R2,R2               COPY?                                        
         BZ    *+10                                                             
         MVC   PLOINF(L'SYSLNAME),SYSLNAME                                      
         LTR   R3,R3               CHANGE?                                      
         BZ    *+10                                                             
         MVC   PLNINF(L'SYSLNAME),SYSLNAME                                      
*                                                                               
         AHI   R4,L'PLINE          NEXT DISPLAY LINE                            
         DROP  R1,R5                                                            
*                                                                               
CT21S10  L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,41         ID RECORD                                    
         BNE   CT21S16                                                          
         DROP  RF                                                               
*                                                                               
         MVCDD PLNHDR,CT#PSWD,L    PASSWORD                                     
*                                                                               
         LTR   R2,R2               TEST COPY                                    
         BZ    CT21S12                                                          
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         TM    CPY.CTSYSIND,CTSYSIYP                                            
         BZ    *+10                                                             
         MVCDD PLOINF,GE#REQ,L     PASSWORD IS REQUIRED                         
         TM    CPY.CTSYSIND,CTSYSINP                                            
         BZ    *+16                                                             
         MVC   PLOINF,SPACES                                                    
         MVC   PLOINF(L'L4@NO),L4@NO                                            
*                                                                               
CT21S12  LTR   R3,R3               TEST CHANGE                                  
         BZ    CT21S14                                                          
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         TM    CHG.CTSYSIND,CTSYSIYP                                            
         BZ    *+10                                                             
         MVCDD PLNINF,GE#REQ,L     PASSWORD IS REQUIRED                         
         TM    CHG.CTSYSIND,CTSYSINP                                            
         BZ    *+16                                                             
         MVC   PLOINF,SPACES                                                    
         MVC   PLNINF(L'L4@NO),L4@NO                                            
*                                                                               
CT21S14  AHI   R4,L'PLINE          NEXT DISPLAY LINE                            
*                                                                               
CT21S16  L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,41         ID RECORD                                    
         BE    *+8                                                              
         CLI   ADRECNUM,67         OR ACCESS RECORD                             
         BNE   CT21S22             NO, SO CTSYSAGB NOT RELEVANT                 
         DROP  RF                                                               
*                                                                               
         MVCDD PLNHDR,CT#AGYC,L    AGENCY BINARY CODE                           
*                                                                               
         LTR   R2,R2               TEST COPY                                    
         BZ    CT21S18                                                          
         GOTO1 VHEXOUT,DMCB,CPY.CTSYSAGB,PLOINF,L'CTSYSAGB                      
         CLI   CPY.CTSYSAGB,0                                                   
         BNE   *+10                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
*                                                                               
CT21S18  LTR   R3,R3               TEST CHANGE                                  
         BZ    CT21S20                                                          
         GOTO1 VHEXOUT,DMCB,CHG.CTSYSAGB,PLNINF,L'CTSYSAGB                      
         CLI   CHG.CTSYSAGB,0                                                   
         BNE   *+10                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
*                                                                               
*        DEAL WITH LIMIT ACCESS                                                 
*                                                                               
CT21S20  AHI   R4,L'PLINE                                                       
*                                                                               
CT21S22  MVCDD PLNHDR,CT#LIDAC,L   LIMIT ACCESS                                 
*                                                                               
         LTR   R1,R2                                                            
         BZ    CT21S28                                                          
         BRAS  RE,BLDLIMA                                                       
         MVC   PLOINF,WORK                                                      
*                                                                               
CT21S28  LTR   R1,R3                                                            
         BZ    CT21S70                                                          
         BRAS  RE,BLDLIMA                                                       
         MVC   PLNINF,WORK                                                      
*                                                                               
*        DEAL WITH SUNDRY FLAGS                                                 
*                                                                               
CT21S70  XC    BYTE,BYTE           USES NCA CABLE DATA                          
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         OC    BYTE,CPY.CTSYSIND                                                
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         OC    BYTE,CHG.CTSYSIND                                                
         TM    BYTE,CTSYSNCA                                                    
         BZ    CT21S74                                                          
*                                                                               
         AHI   R4,L'PLINE          NEXT LINE                                    
         MVCDD PLNHDR,CT#PRGAC,L                                                
*                                                                               
         LTR   R2,R2               TEST COPY                                    
         BZ    CT21S72                                                          
         TM    CPY.CTSYSIND,CTSYSNCA                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
*                                                                               
CT21S72  LTR   R3,R3               TEST CHANGE                                  
         BZ    CT21S74                                                          
         TM    CHG.CTSYSIND,CTSYSNCA                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
*                                                                               
CT21S74  XC    BYTE,BYTE           USES M STREET DATA                           
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         OC    BYTE,CPY.CTSYSIND                                                
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         OC    BYTE,CHG.CTSYSIND                                                
         TM    BYTE,CTSYSNCA                                                    
         BZ    CT21S80                                                          
*                                                                               
         AHI   R4,L'PLINE          NEXT LINE                                    
         MVCDD PLNHDR,CT#PRGAC,L                                                
*                                                                               
         LTR   R2,R2               TEST COPY                                    
         BZ    CT21S76                                                          
         TM    CPY.CTSYSIND,CTSYSNCA                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
*                                                                               
CT21S76  LTR   R3,R3               TEST CHANGE                                  
         BZ    CT21S80                                                          
         TM    CHG.CTSYSIND,CTSYSNCA                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
*                                                                               
*        NOW DEAL WITH PROGRAM ACCESS FIELDS                                    
*                                                                               
CT21S80  AHI   R4,L'PLINE          NEXT LINE                                    
         MVCDD PLNHDR,CT#PRGAC,L                                                
*                                                                               
         LTR   R2,R2               TEST COPY                                    
         BZ    CT21S82                                                          
         BRAS  RE,BLDSYSA                                                       
*                                                                               
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,WORK,((RF),PLOINF),(C'P',8),              X        
               C'LEN=',(R0)                                                     
*                                                                               
CT21S82  LTR   R2,R3               << NOTE COPY NO GOOD AFTER THIS TEST         
         BZ    CT21S84                                                          
         BRAS  RE,BLDSYSA                                                       
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG        ONLY CHANGES HAVE COPY FOLLOWING             
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,WORK,((RF),PLNINF),(C'P',8),              X        
               C'LEN=',(R0)                                                     
*                                                                               
CT21S84  BRAS  RE,PRNT                                                          
         B     EXITOK                                                           
         DROP  CPY,CHG                                                          
*                                                                               
* BUILD LIMIT ACCESS FIELD IN WORK                                              
* NTRY: R1 = A(CTSYSD ELEMENT)                                                  
*                                                                               
BLDLIMA  NTR1  ,                                                                
         USING CTSYSD,R2                                                        
         LR    R2,R1                                                            
         MVC   WORK(L'PLNINF),SPACES                                            
*                                                                               
         MVC   WORK(L'CTSYSLMT),CTSYSLMT DEFAULT TO PRINT AS IS                 
         OC    CTSYSLMT,CTSYSLMT                                                
         BNZ   *+14                                                             
         MVC   WORK(L'LC@NOSET),LC@NOSET                                        
         B     EXITOK              NOT SET                                      
*                                                                               
         CLC   CTSYSLMT(2),EFFS                                                 
         BNE   *+14                                                             
         MVC   WORK(2),=C'L='                                                   
         B     EXITOK              L=XX                                         
*&&US                                                                           
         CLI   CTSYSNUM,9          TEST MEDIABASE                               
         BNE   BLIMA10                                                          
         GOTO1 VHEXOUT,PLIST,CTSYSLMT,WORK,4,=C'N'                              
*&&                                                                             
BLIMA10  DS    0H                                                               
*&&UK                                                                           
         CLI   CTSYSNUM,4          UK MEDIA SYSTEM HAS SPECIAL CODE             
         BNE   BLIMA20                                                          
         MVC   WORK(L'CTSYSLMT),SPACES                                          
         LA    R5,WORK                                                          
         LA    R6,CTSYSLMT                                                      
         LHI   R7,4                                                             
*                                                                               
BLIMA12  ZIC   R0,0(R6)                                                         
         CURED (R0),(3,(R5)),0,ALIGN=LEFT,ZERO=NOBLANK                          
         AR    R5,R0                                                            
         MVI   0(R5),C','                                                       
         AHI   R5,1                                                             
         AHI   R6,1                                                             
         BCT   R7,BLIMA12                                                       
         BCTR  R5,0                                                             
         MVI   0(R5),C' '                                                       
         B     EXITOK                                                           
*&&                                                                             
BLIMA20  DS    0H                                                               
*&&US                                                                           
         MVI   BYTE,C'S'                                                        
         CLI   CTSYSNUM,2          TEST SPOT                                    
         BE    BLIMA22                                                          
         CLI   CTSYSNUM,13         TEST SPOT TRAFFIC                            
         BE    BLIMA22                                                          
         MVI   BYTE,C'N'                                                        
         CLI   CTSYSNUM,3          TEST NETWORK                                 
         BE    BLIMA22                                                          
         MVI   BYTE,C'P'                                                        
         CLI   CTSYSNUM,4          TEST PRINT                                   
         BNE   BLIMA30                                                          
         CLI   CTSYSLMT,C'*'       TEST OFFICE                                  
         BNE   EXITOK                                                           
*                                                                               
BLIMA22  CLI   CTSYSLMT,C'*'       TEST OFFICE/CLI GRP                          
         BE    BLIMA24                                                          
         CLI   CTSYSLMT,C'$'       TEST OFFICE LIST                             
         BE    EXITOK                                                           
         B     BLIMA26             CLIENT                                       
*                                                                               
BLIMA24  CLI   CTSYSLMT+2,C' '     TEST CLIENT GROUP                            
         BH    EXITOK              . YES                                        
*                                                                               
         LA    R3,WORK+L'PLNINF                                                 
         USING OFFICED,R3                                                       
         XC    0(OFCLENQ,R3),0(R3)                                              
         MVC   OFCSYS,CTSYSNUM     SYSTEM ID                                    
         MVC   OFCAGY,LSTGRP                                                    
         MVC   OFCOFC,CTSYSLMT+1   1 BYTE OFFICE                                
*                                                                               
         LA    RF,VDMGR            OFFICER NEEDS DMGR AS IN COMFACS             
         GOTO1 VOFFICER,PLIST,(C'2',(R3)),(RF)                                  
*                                                                               
         TM    OFCINDS,OFCINOLA+OFCIOINV  NOT USING 2 OFFS OR INVALID           
         BNZ   EXITOK                                                           
         MVI   WORK,C'*'                                                        
         MVI   WORK+1,C'*'                (**OF)                                
         MVC   WORK+2(L'OFCOFC2),OFCOFC2  DISPLAY 2 BYTE OFFICE VALUE           
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
BLIMA26  MVC   WORK(L'CTSYSLMT),SPACES                                          
         GOTO1 VCLUNPK,PLIST,CTSYSLMT,WORK  UNPACK CLIENT                       
         B     EXITOK                                                           
*&&                                                                             
BLIMA30  CLI   CTSYSNUM,14         PERSON SYSTEM HAS SPECIAL CODE               
         BNE   EXITOK              FORMAT IS N(NN)-N(NN)                        
*                                                                               
         MVC   WORK(L'CTSYSLMT),SPACES                                          
         OC    CTSYSLMT+2(2),CTSYSLMT+2                                         
         BNZ   *+14                                                             
         MVC   WORK(L'LC@NOSET),LC@NOSET                                        
         B     EXITOK                                                           
*                                                                               
         LA    R5,WORK                                                          
         ZIC   R0,CTSYSLMT+2                                                    
         CURED (R0),(3,0(R5)),0,ALIGN=LEFT,ZERO=NOBLANK                         
         AR    R5,R0                                                            
         MVI   0(R5),C'-'                                                       
         ZIC   R0,CTSYSLMT+3                                                    
         CURED (R0),(3,1(R5)),0,ALIGN=LEFT,ZERO=NOBLANK                         
         B     EXITOK                                                           
*                                                                               
         DROP  R2                                                               
*                                                                               
* BUILD SYSTEM AUTH LIST IN WORK                                                
* NTRY: R2 = A(CTSYSD ELEMENT)                                                  
* EXIT: R0 = L'DATA TO OUTPUT                                                   
*                                                                               
BLDSYSA  NTR1  ,                                                                
         USING CTSYSD,R2                                                        
         LA    R6,WORK                                                          
         LA    R7,CTSYSPGM         R7=A(AUTHS)                                  
         XR    R5,R5                                                            
         IC    R5,CTSYSLEN                                                      
         CHI   R5,CTSYSL1Q         CHECK FOR ALL= VALUE ONLY                    
         BE    BSYSA10                                                          
*                                                                               
*        HANDLE SPECIAL (LENGTH X'18') VERSION                                  
*                                                                               
         CHI   R5,X'18'                                                         
         BNE   BSYSA10                                                          
         MVC   0(L'L4@ALL,R6),L4@ALL    SET ALL= Y, N, OR XXXX                  
         AHI   R6,L'L4@ALL-1                                                    
         CLI   0(R6),C' '                                                       
         BH    *+8                                                              
         BCT   R6,*-8                                                           
         MVI   1(R6),C'='                                                       
         AHI   R6,2                                                             
*                                                                               
         LA    R7,CTSYSALL                                                      
         MVC   0(4,R6),L4@YES                                                   
         CLC   0(2,R7),YAUTH       YES?                                         
         BE    BSYSA02                                                          
         MVC   0(4,R6),L4@NO                                                    
         CLC   0(2,R7),NAUTH       NO?                                          
         BE    BSYSA02                                                          
         GOTO1 VHEXOUT,PLIST,0(R7),0(R6),2,0                                    
*                                                                               
BSYSA02  AHI   R6,12                                                            
         MVC   0(5,R6),=C'Data='                                                
         LA    R7,CTSYSPGM                                                      
         GOTO1 VHEXOUT,PLIST,(R7),5(R6),8,0 Hexout Data                         
         AHI   R6,5+8*2+1          (ONE EXTRA FOR COMMA REMOVAL)                
         B     BSYSA40                                                          
*                                                                               
*        HANDLE NORMAL VARIABLE LENGTH ENTRY                                    
*                                                                               
BSYSA10  CHI   R5,CTSYSL1Q         STILL INDIVIDUAL AUTHS?                      
         BH    BSYSA12             YES                                          
*                                                                               
         LA    R7,CTSYSALL                                                      
         MVC   PROGRAM,SPACES                                                   
         MVC   PROGRAM(L'L4@ALL),L4@ALL                                         
         XR    R5,R5               FLAG FINAL VALUE                             
         B     BSYSA18                                                          
*                                                                               
BSYSA12  CLC   1(2,R7),CTSYSALL    TEST SAME AS ALL= ENTRY                      
         BE    BSYSA14             YES, IGNORE                                  
         BRAS  RE,GETPRGN          GET NAME OF PROGRAM                          
         BE    BSYSA16             DISPLAY PROGRAM IF NOT DDS ONLY              
         CLI   LSTSRT,SRTSDDS                                                   
         BE    BSYSA16             DISPLAY DDS ONLY PROGS IF DDS REPORT         
BSYSA14  AHI   R7,3                NEXT ENTRY                                   
         AHI   R5,-3               ADJUST LENGTH REMAINING                      
         B     BSYSA10                                                          
*                                                                               
BSYSA16  AHI   R7,1                R7 = AUTH VALUE                              
*                                                                               
BSYSA18  MVC   0(L'PROGRAM,R6),PROGRAM                                          
         AHI   R6,L'PROGRAM+1      (ALLOW 1 TO INSERT '=')                      
*                                                                               
         MVC   0(4,R6),L4@YES      AUTH IS Y,N OR XXXX                          
         CLC   0(2,R7),YAUTH                                                    
         BE    BSYSA20                                                          
         MVC   0(4,R6),L4@NO                                                    
         CLC   0(2,R7),NAUTH                                                    
         BE    BSYSA20                                                          
         GOTO1 VHEXOUT,PLIST,0(R7),0(R6),2,0                                    
*&&US                                                                           
         CLI   CTSYSNUM,X'07'    TALENT HAS STAFF CODE IN LAST CHR              
         BNE   BSYSA20                                                          
         LA    R1,1(,R7)         POINT TO STAFF CODE                            
         BRAS  RE,FALSTAFF                                                      
         BNE   BSYSA20                                                          
         CLI   0(R7),0           TEST IF ANY BITS DEFINED                       
         BNE   BSYSA19                                                          
         MVC   0(4,R6),SPACES    C IF NO BITS SET                               
         MVC   0(1,R6),1(R7)                                                    
         B     BSYSA20                                                          
BSYSA19  MVI   2(R6),C'/'        XX/C IF XX BITS DEFINED                        
         MVC   3(1,R6),1(R7)                                                    
*&&                                                                             
*                                                                               
BSYSA20  AHI   R6,4+1            (ALLOW 1 TO INSERT ',')                        
*                                                                               
         LTR   R5,R5             EXIT IF ALL=VALUE JUST DONE                    
         BZ    BSYSA30                                                          
         AHI   R7,2              GO PAST AUTH                                   
         AHI   R5,-3             ADJUST LENGTH REMAINING                        
         B     BSYSA10                                                          
*                                                                               
BSYSA30  LR    R7,R6               SORT ENTRIES BY PROGRAM NAME                 
         LA    R0,WORK                                                          
         SR    R7,R0               R7=LENGTH USED                               
         XR    R6,R6                                                            
         D     R6,=A(L'PROGRAM+1+4+1)  R7=NUMBER OF ENTRIES                     
         BCT   R7,*+8              SORT ALL BUT LAST (ALL=) ENTRY               
         B     BSYSA32             SKIP IF ONLY ONE                             
         LA    RF,L'PROGRAM                                                     
         GOTO1 VXSORT,PLIST,WORK,(R7),1+4+1(RF),(RF),0                          
*                                                                               
BSYSA32  LA    R6,WORK             R6=O/P                                       
         LR    RE,R6               RE=I/P                                       
         AHI   R7,1                INCLUDE ALL=                                 
BSYSA34  MVC   0(L'PROGRAM,R6),0(RE) COPY PROGRAM NAME                          
         CLI   L'PROGRAM-1(R6),C' ' ADD AN = TO END                             
         BH    *+8                                                              
         BCT   R6,*-8                                                           
         MVI   L'PROGRAM(R6),C'='                                               
         MVC   L'PROGRAM+1(4,R6),L'PROGRAM+1(RE) COPY AUTH                      
         CLI   L'PROGRAM+1+4-1(R6),C' ' ADD A COMMA                             
         BH    *+8                                                              
         BCT   R6,*-8                                                           
         MVI   L'PROGRAM+1+4(R6),C','                                           
         AHI   R6,L'PROGRAM+1+4+1  NEXT O/P SPACE                               
         AHI   RE,L'PROGRAM+1+4+1  NEXT I/P                                     
         BCT   R7,BSYSA34          LOOP TILL ALL DONE                           
*                                                                               
*        RETURN STRING                                                          
*                                                                               
BSYSA40  BCTR  R6,0              REMOVE LAST COMMA                              
         MVI   0(R6),C' '                                                       
         LA    R0,WORK                                                          
         SR    R6,R0                                                            
         LR    R0,R6                                                            
         XIT1  REGS=(R0)                                                        
*                                                                               
         DROP  R2,R4                                                            
*                                                                               
* EXTRACT PROGRAM NAME                                                          
* NTRY: 0(R7)  = PROGRAM NUMBER                                                 
* EXITL IF DDS ONLY PROGRAM                                                     
*                                                                               
GETPRGN  NTR1  ,                   EXTRACT PROGRAM NAME                         
         L     R1,APGMLST          NTRY: R3 = A(PROGRAM NUMBER)                 
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         AHI   R1,6                                                             
         USING PGMLSTD,R1                                                       
         XC    PROGRAM,PROGRAM                                                  
GPRGN02  CLC   PGMNUM,0(R7)        MATCH ON PROGRAM NUMBER                      
         BNE   GPRGN04                                                          
         CLC   PGMCTRY,AGYCTRY     MATCH ON COUNTRY                             
         BE    GPRGN10                                                          
         CLI   PGMCTRY,0           OR DEFAULT COUNTRY (COMES LAST)              
         BE    GPRGN10                                                          
GPRGN04  BXLE  R1,RE,GPRGN02                                                    
         GOTO1 VHEXOUT,PLIST,(R7),PROGRAM,1,0 NOT FOUND, SO HEXOUT              
         B     EXITL               AND TREAT AS DDS ONLY                        
*                                                                               
GPRGN10  MVC   PROGRAM,PGMNAME                                                  
         TM    PGMIND,PGMIACC      TEST DDS ONLY PROGRAM                        
         BO    EXITL               YES, SET CC LOW                              
         TM    PGMIND,PGMINOP      TEST NOP PROGRAM                             
         BO    EXITL               YES, TREAT AS DDS ONLY                       
*                                                                               
         ICM   RF,15,ASYSEL        TEST ID LEVEL SYSEL APPLIES                  
         BZ    EXITOK              NO, EXIT OK                                  
         USING CTSYSD,RF                                                        
         LA    RE,CTSYSALL         PICK UP 'ALL=' ENTRY                         
         CLI   CTSYSLEN,X'18'                                                   
         BE    GPRGN16                                                          
         XR    R0,R0                                                            
         IC    R0,CTSYSLEN                                                      
         AR    R0,RF               R0=END OF ID LEVEL SYSEL                     
         LA    RF,CTSYSPGM         FIRST PROGRAM ENTRY                          
         DROP  RF                                                               
GPRGN12  CR    RF,R0               STILL WITHIN ELEMENT                         
         BNL   GPRGN16             NO, USE 'ALL=' ENTRY                         
         CLC   0(1,R7),0(RF)       MATCHING PROGRAM                             
         BE    GPRGN14             YES, USE IT                                  
         LA    RF,3(,RF)                                                        
         B     GPRGN12                                                          
GPRGN14  LA    RE,1(,RF)           USE PROGRAM ENTRY                            
GPRGN16  CLC   0(2,RE),NAUTH                                                    
         BE    EXITL               PROG=N ON ID RECORD (OR ALL=N)               
*                                                                               
         B     EXITOK                                                           
*                                                                               
         DROP  R1                                                               
*                                                                               
*&&US                                                                           
***********************************************************************         
* * * * * THE FOLLOWING ROUTINE, COMPLETE WITH ITS ASSOCIATED * * * * *         
* * * * * SENSE OF HUMOUR, WAS LIFTED UNCHANGED FROM SEACS0A  * * * * *         
* * * * *    EXCEPT FOR THE INSTRUCTION AT LABEL FALSTAF3   * * * * * *         
***********************************************************************         
                                                                                
***********************************************************************         
* ROUTINE TO TEST IF A CHARACTER IS A VALID TALENT STAFF CODE         *         
* R1=A(STAFF CODE) RETURN CC EQL IF VALID                             *         
* 1ST PART OF TABLE VALID FOR ALL. 2ND PART ONLY FOR TALENT AGENCYS.  *         
***********************************************************************         
                                                                                
FALSTAFF LARL  RF,HENRY_IV         THIS IS TRUELY SHAKESPEAREAN                 
IV_PART1 CLC   0(1,RF),0(R1)       PART1 VALID FOR EVERY ONE                    
         BER   RE                                                               
         LA    RF,1(RF)                                                         
         CLI   0(RF),X'FF'                                                      
         JL    IV_PART1                                                         
         LA    RF,1(RF)                                                         
IV_PART2 CLC   0(1,RF),0(R1)       PART2 VALID ONLY FOR TALENT PARTNERS         
         JE    FALSTAF2                                                         
         LA    RF,1(RF)                                                         
         CLI   0(RF),X'FF'                                                      
         JL    IV_PART2                                                         
         J     FALSTAFX                                                         
*                                                                               
FALSTAF2 LARL  RF,HENRY_V          POINT TO TABLE OF TALENT AGENCYS             
*ALSTAF3 CLC   TWAAGY,0(RF)        *** ORIGINAL VERSION FROM SEACS0A            
FALSTAF3 CLC   LSTAGY,0(RF)        *** MODIFIED VERSION FOR CTDFSEC             
         BER   RE                                                               
         LA    RF,2(RF)                                                         
         CLI   0(RF),X'FF'                                                      
         JL    FALSTAF3                                                         
*                                                                               
FALSTAFX CR    RE,RF               EXIT WITH CC=NEQ IF INVALID                  
         BR    RE                                                               
*                                                                               
HENRY_IV DC    C'CDF',X'FF',C'ABMOP2345678',X'FF'                               
         DS    0H                                                               
HENRY_V  DC    C'DS',C'SJ',X'FFFF'                                              
*&&                                                                             
*                                                                               
YAUTH    DC    X'000F'                                                          
NAUTH    DC    X'0000'                                                          
XAUTH    DC    X'FFFF'                                                          
         EJECT                                                                  
***********************************************************************         
* X'21' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT21ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,68         ADDRESS LINE 1                               
         BE    CT21E02                                                          
         CLI   ADRECNUM,82         OUTPUT STATEMENT LABEL                       
         BE    CT21E10                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT21E02  MVCDD PLNHDR,GE#ADRL1,L   ADDRESS LINE 1                               
         LTR   R2,R2                                                            
         BZ    CT21E04                                                          
         XR    RF,RF                                                            
         IC    RF,1(R2)                                                         
         AHI   RF,-3                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),2(R2)                                                  
*                                                                               
CT21E04  LTR   R3,R3                                                            
         BZ    CT21E06                                                          
         XR    RF,RF                                                            
         IC    RF,1(R3)                                                         
         AHI   RF,-3                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),2(R3)                                                  
*                                                                               
CT21E06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT21E10  MVC   PLNHDR,HLABEL   *** OUTPUT STATEMENT LABEL                       
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DEOSLABL),DEOSLABL-DEOSLD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DEOSLABL),DEOSLABL-DEOSLD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'23' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT23ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,68         ADDRESS LINE 3                               
         BE    CT23P02                                                          
         CLI   ADRECNUM,82         INPUT LENGTH                                 
         BE    CT23P08                                                          
         CLI   ADFTYPE,CTFILEQ     CTFILE DEFAULT                               
         BE    CT23P14                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT23P02  MVCDD PLNHDR,GE#ADRL3,L   ADDRESS LINE 3                               
         LTR   R2,R2                                                            
         BZ    CT23P04                                                          
         XR    RF,RF                                                            
         IC    RF,1(R2)                                                         
         AHI   RF,-3                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),2(R2)                                                  
*                                                                               
CT23P04  LTR   R3,R3                                                            
         BZ    CT23P06                                                          
         XR    RF,RF                                                            
         IC    RF,1(R3)                                                         
         AHI   RF,-3                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),2(R3)                                                  
*                                                                               
CT23P06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT23P08  MVCDD PLNHDR,GE#LEN,L *** INPUT LENGTH                                 
         LTR   R2,R2                                                            
         BZ    CT23P10                                                          
         USING DEILD,R2                                                         
         CURED (B1,DEILEN),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                 
         DROP  R2                                                               
*                                                                               
CT23P10  LTR   R3,R3                                                            
         BZ    CT23P12                                                          
         USING DEILD,R3                                                         
         CURED (B1,DEILEN),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                 
         DROP  R3                                                               
*                                                                               
CT23P12  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT23P14  MVCDD PLNHDR,GE#TEST,L    PROGRAM TEST ELEMENT                         
         LTR   R2,R2                                                            
         BZ    CT23P16                                                          
         USING CTPRGD,R2                                                        
         MVC   PLOINF(L'CTPRGRAM),CTPRGRAM                                      
         MVI   PLOINF+L'CTPRGRAM,C'='                                           
         MVC   PLOINF+L'CTPRGRAM+1(L'CTPRGTST),CTPRGTST                         
         DROP  R2                                                               
*                                                                               
CT23P16  LTR   R3,R3                                                            
         BZ    CT23P18                                                          
         USING CTPRGD,R3                                                        
         MVC   PLNINF(L'CTPRGRAM),CTPRGRAM                                      
         MVI   PLNINF+L'CTPRGRAM,C'='                                           
         MVC   PLNINF+L'CTPRGRAM+1(L'CTPRGTST),CTPRGTST                         
         DROP  R3                                                               
*                                                                               
CT23P18  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'24' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT24ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,52         APPLID                                       
         BE    CT24P02                                                          
         CLI   ADRECNUM,68         ADDRESS LINE 4                               
         BE    CT24P04                                                          
         CLI   ADRECNUM,82         INPUT ROUTINE                                
         BE    CT24P10                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT24P02  MVC   PLNHDR,HVTAML   *** APPLID                                       
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTAPLID),CTAPLID-CTAPLD(R2)                             
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTAPLID),CTAPLID-CTAPLD(R3)                             
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT24P04  MVCDD PLNHDR,GE#ADRL4,L   ADDRESS LINE 4                               
         LTR   R2,R2                                                            
         BZ    CT24P06                                                          
         XR    RF,RF                                                            
         IC    RF,1(R2)                                                         
         AHI   RF,-3                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),2(R2)                                                  
*                                                                               
CT24P06  LTR   R3,R3                                                            
         BZ    CT24P08                                                          
         XR    RF,RF                                                            
         IC    RF,1(R3)                                                         
         AHI   RF,-3                                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),2(R3)                                                  
*                                                                               
CT24P08  AHI   R3,L'PLINE                                                       
         ST    R3,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT24P10  MVC   PLNHDR,HINPRTN  *** INPUT ROUTINE                                
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DEIROUT),DEIROUT-DEIRD(R2)                              
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DEIROUT),DEIROUT-DEIRD(R3)                              
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
HINPRTN  DC    CL16'Input Routine'                                              
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'25' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT25ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,6          PHASE DESCRIPTION                            
         BE    CT25P02                                                          
         CLI   ADRECNUM,82         INPUT ARGUMENTS                              
         BE    CT25P08                                                          
         CLI   ADFTYPE,CTFILEQ     TERMINAL DEFINITION                          
         BE    CT25P14                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT25P02  MVCDD PLNHDR,CT#DESC,L    PROGRAM DESCRIPTION                          
         LTR   R2,R2                                                            
         BZ    CT25P04                                                          
         USING CTPHDSCD,R2                                                      
         XR    RF,RF                                                            
         IC    RF,CTPHDLEN                                                      
         AHI   RF,-(CTPHDOVQ+1)                                                 
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),CTPHDDSC                                               
         DROP  R2                                                               
*                                                                               
CT25P04  LTR   R3,R3                                                            
         BZ    CT25P06                                                          
         USING CTPHDSCD,R3                                                      
         XR    RF,RF                                                            
         IC    RF,CTPHDLEN                                                      
         AHI   RF,-(CTPHDOVQ+1)                                                 
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),CTPHDDSC                                               
         DROP  R3                                                               
*                                                                               
CT25P06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT25P08  MVC   PLNHDR,HARGMNTS *** INPUT ARGUMENTS                              
         LTR   R2,R2                                                            
         BZ    CT25P10                                                          
         USING DEIAD,R2                                                         
         XR    RF,RF                                                            
         IC    RF,DEIALEN                                                       
         AHI   RF,-(DEIARGS-DEIAD+1)                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),DEIARGS                                                
         DROP  R2                                                               
*                                                                               
CT25P10  LTR   R3,R3                                                            
         BZ    CT25P12                                                          
         USING DEIAD,R3                                                         
         XR    RF,RF                                                            
         IC    RF,DEIALEN                                                       
         AHI   RF,-(DEIARGS-DEIAD+1)                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),DEIARGS                                                
         DROP  R3                                                               
*                                                                               
CT25P12  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT25P14  LR    R5,R4           *** TERMINAL DEFINITION                          
         MVC   PLNHDR,HDISDEV      DEVICE                                       
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#TYPE,L    TYPE                                         
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#CTRY,L    COUNTRY                                      
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#AGYC,L    AGENCY CODE                                  
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#OFFC,L    OFFICE CODE                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HNODENM      NODE NAME                                    
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HLINEID      LINE ID                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HATT12       ATTRIBUTES 1 AND 2                           
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HESCCHR      ESCAPE SEQUENCE                              
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HLINETYP     LINE TYPE                                    
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HLINESPD     LINE SPEED                                   
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    *+12                                                             
         TM    CTTRMDEV-CTTRMD(R2),X'80'                                        
         BO    CT25P40             PRINTER - MORE LINES                         
         LTR   R3,R3                                                            
         BZ    *+12                                                             
         TM    CTTRMDEV-CTTRMD(R3),X'80'                                        
         BZ    CT25P18             NOT A PRINTER - EXIT                         
*                                                                               
CT25P16  AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HPRTSPD                                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HSPDTYPE                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HPQNTRY                                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HBUFFSZ      PRINTER BUFFER SIZE                          
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
CT25P18  LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT25P40                                                          
         USING CTTRMD,R2                                                        
*                                                                               
         LA    RE,DEVTBL           DISPLAY DEVICE                               
CT25P20  CLI   0(RE),255           EOT?                                         
         BNE   *+14                NO                                           
         MVC   PLOINF,LC@UNKNW                                                  
         B     CT25P22                                                          
         CLC   CTTRMDEV,8(RE)      MATCH DEVICE TYPE                            
         BE    *+12                                                             
         AHI   RE,DEVTBLL                                                       
         B     CT25P20                                                          
         MVC   PLOINF(8),0(RE)     SET DEVICE TYPE ON PRINT LINE                
*                                                                               
CT25P22  AHI   R4,L'PLINE                                                       
*                                                                               
         LA    RE,TYPTBL                                                        
CT25P24  CLI   0(RE),255           EOT?                                         
         BNE   *+14                NO                                           
         MVC   PLOINF,LC@UNKNW                                                  
         B     CT25P26                                                          
         CLC   CTTRMTYP,8(RE)      MATCH DEVICE TYPE                            
         BE    *+12                YES                                          
         LA    RE,TYPTBLL(RE)                                                   
         B     CT25P24                                                          
         MVC   PLOINF(8),0(RE)     SET DEVICE TYPE                              
*                                                                               
CT25P26  AHI   R4,L'PLINE                                                       
         MVC   PLOINF,LC@UNKNW                                                  
*                                                                               
         L     R1,VCTRYTAB         DISPLAY COUNTRY                              
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         LA    R1,6(R1)                                                         
         USING CTRYTABD,R1         R1=A(COUNTRY TABLE)                          
         CLC   CTRYCODE,CTTRMCTY                                                
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     CT25P28                                                          
         MVC   PLOINF(L'CTRYNAMN),CTRYNAMN                                      
         DROP  R1                                                               
*                                                                               
CT25P28  AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTTRMAGY),CTTRMAGY                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(1),CTTRMOFC                                               
         CLI   CTTRMOFC,C'*'                                                    
         BNE   CT25P30                                                          
         TM    CTTRMFL1,X'03'      SHOW *1 DDS LEVEL                            
         BZ    CT25P30                                                          
         MVI   PLOINF+1,C'1'                                                    
         TM    CTTRMFL1,X'02'      SHOW *2 DDS LEVEL                            
         BZ    *+8                                                              
         MVI   PLOINF+1,C'2'                                                    
*                                                                               
CT25P30  AHI   R4,L'PLINE                                                       
*                                                                               
         LA    RE,NODETBL                                                       
CT25P32  CLI   0(RE),255           EOT?                                         
         BNE   *+14                NO                                           
         MVC   PLOINF,LC@UNKNW                                                  
         B     CT25P34                                                          
*                                                                               
         CLC   CTTRMNDE,3(RE)      MATCH DEVICE TYPE                            
         BE    *+12                YES                                          
         LA    RE,NODETBLL(RE)                                                  
         B     CT25P32                                                          
         MVC   PLOINF(3),0(RE)     SET DEVICE TYPE                              
*                                                                               
CT25P34  AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTTRMLNE),CTTRMLNE                                      
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,PLIST,CTTRMCU,PLOINF,1                                   
         MVI   PLOINF+2,C'/'                                                    
         GOTO1 VHEXOUT,PLIST,CTTRMCU,PLOINF+3,1                                 
         AHI   R4,L'PLINE                                                       
*                                                                               
         LA    R6,PLOINF         ATTRIBUTES 1 AND 2                             
         MVC   BYTE,CTTRMAT1                                                    
         BRAS  RE,DTATB            AT1=ABCDEFGH                                 
         MVI   0(R6),C'/'                                                       
         AHI   R6,1                                                             
         MVC   BYTE,CTTRMAT2                                                    
         BRAS  RE,DTATB            AT2=ABCDEFGH                                 
         AHI   R4,L'PLINE                                                       
*                                                                               
         CURED CTTRMESC,(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLOINF(L'CTTRMLTY),CTTRMLTY                                      
         CLI   CTTRMLTY,C'B'                                                    
         BNE   *+10                                                             
         MVC   PLOINF(4),=CL4'BSC '                                             
         CLI   CTTRMLTY,C'L'                                                    
         BNE   *+10                                                             
         MVC   PLOINF(4),=CL4'LCL '                                             
         CLI   CTTRMLTY,C'S'                                                    
         BNE   *+10                                                             
         MVC   PLOINF(4),=CL4'SDLC'                                             
         CLI   CTTRMLTY,C'T'                                                    
         BNE   *+10                                                             
         MVC   PLOINF(4),=CL4'TWX '                                             
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         ICM   R0,3,CTTRMLSP                                                    
         MHI   R0,8                CONVERT FROM CPS TO BAUD                     
         CURED (R0),(8,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         LA    RF,PLOINF                                                        
         AR    RF,R0                                                            
         MVC   1(L'BAUD,RF),BAUD                                                
*                                                                               
         TM    CTTRMDEV,X'80'      PRINTER TYPE DEVICE?                         
         BZ    CT25P40             NO - EXIT                                    
*                                                                               
         AHI   R4,L'PLINE                                                       
         XR    R0,R0                                                            
         ICM   R0,3,CTTRMPSP                                                    
         BNZ   *+14                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         B     CT25P36                                                          
*                                                                               
         CURED (R0),(7,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
*                                                                               
CT25P36  AHI   R4,L'PLINE                                                       
         MVC   PLOINF(1),CTTRMPST   PRINTER SPEED TYPE                          
         OC    CTTRMPST,CTTRMPST                                                
         BNZ   *+10                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R4,L'PLINE                                                       
         XR    R0,R0                                                            
         ICM   R0,1,CTTRMPRQ                                                    
         BNZ   *+14                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         B     CT25P38                                                          
         CURED (R0),(3,PLOINF),0,ALIGN=LEFT                                     
*                                                                               
CT25P38  AHI   R4,L'PLINE                                                       
         XR    R0,R0                                                            
         ICM   R0,3,CTTRMPBS                                                    
         BNZ   *+14                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         B     CT25P40                                                          
         CURED (R0),(5,PLOINF),0,ALIGN=LEFT                                     
         DROP  R2                                                               
*                                                                               
CT25P40  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTTRMD,R3                                                        
*                                                                               
         LA    RE,DEVTBL           DISPLAY DEVICE                               
CT25P42  CLI   0(RE),255           EOT?                                         
         BNE   *+14                NO                                           
         MVC   PLNINF,LC@UNKNW                                                  
         B     CT25P44                                                          
         CLC   CTTRMDEV,8(RE)      MATCH DEVICE TYPE                            
         BE    *+12                                                             
         AHI   RE,DEVTBLL                                                       
         B     CT25P42                                                          
         MVC   PLNINF(8),0(RE)     SET DEVICE TYPE ON PRINT LINE                
*                                                                               
CT25P44  AHI   R4,L'PLINE                                                       
*                                                                               
         LA    RE,TYPTBL                                                        
CT25P46  CLI   0(RE),255           EOT?                                         
         BNE   *+14                NO                                           
         MVC   PLNINF,LC@UNKNW                                                  
         B     CT25P48                                                          
         CLC   CTTRMTYP,8(RE)      MATCH DEVICE TYPE                            
         BE    *+12                YES                                          
         LA    RE,TYPTBLL(RE)                                                   
         B     CT25P46                                                          
         MVC   PLNINF(8),0(RE)     SET DEVICE TYPE                              
*                                                                               
CT25P48  AHI   R4,L'PLINE                                                       
         MVC   PLNINF,LC@UNKNW                                                  
*                                                                               
         L     R1,VCTRYTAB         DISPLAY COUNTRY                              
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         LA    R1,6(R1)                                                         
         USING CTRYTABD,R1         R1=A(COUNTRY TABLE)                          
         CLC   CTRYCODE,CTTRMCTY                                                
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     CT25P50                                                          
         MVC   PLNINF(L'CTRYNAMN),CTRYNAMN                                      
         DROP  R1                                                               
*                                                                               
CT25P50  AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTTRMAGY),CTTRMAGY                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(1),CTTRMOFC                                               
         CLI   CTTRMOFC,C'*'                                                    
         BNE   CT25P52                                                          
         TM    CTTRMFL1,X'03'      SHOW *1 DDS LEVEL                            
         BZ    CT25P52                                                          
         MVI   PLNINF+1,C'1'                                                    
         TM    CTTRMFL1,X'02'      SHOW *2 DDS LEVEL                            
         BZ    *+8                                                              
         MVI   PLNINF+1,C'2'                                                    
*                                                                               
CT25P52  AHI   R4,L'PLINE                                                       
*                                                                               
         LA    RE,NODETBL                                                       
CT25P54  CLI   0(RE),255           EOT?                                         
         BNE   *+14                NO                                           
         MVC   PLNINF,LC@UNKNW                                                  
         B     CT25P56                                                          
         CLC   CTTRMNDE,3(RE)      MATCH DEVICE TYPE                            
         BE    *+12                YES                                          
         LA    RE,NODETBLL(RE)                                                  
         B     CT25P54                                                          
         MVC   PLNINF(3),0(RE)     SET DEVICE TYPE                              
*                                                                               
CT25P56  AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTTRMLNE),CTTRMLNE                                      
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,PLIST,CTTRMCU,PLNINF,1                                   
         MVI   PLNINF+2,C'/'                                                    
         GOTO1 VHEXOUT,PLIST,CTTRMCU,PLNINF+3,1                                 
         AHI   R4,L'PLINE                                                       
*                                                                               
         LA    R6,PLNINF         ATTRIBUTES 1 AND 2                             
         MVC   BYTE,CTTRMAT1                                                    
         BRAS  RE,DTATB            AT1=ABCDEFGH                                 
         MVI   0(R6),C'/'                                                       
         AHI   R6,1                                                             
         MVC   BYTE,CTTRMAT2                                                    
         BRAS  RE,DTATB            AT2=ABCDEFGH                                 
         AHI   R4,L'PLINE                                                       
*                                                                               
         CURED CTTRMESC,(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLNINF(L'CTTRMLTY),CTTRMLTY                                      
         CLI   CTTRMLTY,C'B'                                                    
         BNE   *+10                                                             
         MVC   PLNINF(4),=CL4'BSC '                                             
         CLI   CTTRMLTY,C'L'                                                    
         BNE   *+10                                                             
         MVC   PLNINF(4),=CL4'LCL '                                             
         CLI   CTTRMLTY,C'S'                                                    
         BNE   *+10                                                             
         MVC   PLNINF(4),=CL4'SDLC'                                             
         CLI   CTTRMLTY,C'T'                                                    
         BNE   *+10                                                             
         MVC   PLNINF(4),=CL4'TWX '                                             
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         ICM   R0,3,CTTRMLSP                                                    
         MHI   R0,8                CONVERT FROM CPS TO BAUD                     
         CURED (R0),(8,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         LA    RF,PLNINF                                                        
         AR    RF,R0                                                            
         MVC   1(L'BAUD,RF),BAUD                                                
*                                                                               
         TM    CTTRMDEV,X'80'      PRINTER TYPE DEVICE?                         
         BZ    EXITOK              NO - EXIT                                    
*                                                                               
         AHI   R4,L'PLINE                                                       
         XR    R0,R0                                                            
         ICM   R0,3,CTTRMPSP                                                    
         BNZ   *+14                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         B     CT25P58                                                          
*                                                                               
         CURED (R0),(7,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
*                                                                               
CT25P58  AHI   R4,L'PLINE                                                       
         MVC   PLNINF(1),CTTRMPST   PRINTER SPEED TYPE                          
         OC    CTTRMPST,CTTRMPST                                                
         BNZ   *+10                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R4,L'PLINE                                                       
         XR    R0,R0                                                            
         ICM   R0,1,CTTRMPRQ                                                    
         BNZ   *+14                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         B     CT25P60                                                          
         CURED (R0),(3,PLNINF),0,ALIGN=LEFT                                     
*                                                                               
CT25P60  AHI   R4,L'PLINE                                                       
         XR    R0,R0                                                            
         ICM   R0,3,CTTRMPBS                                                    
         BNZ   *+14                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         B     EXITOK                                                           
         CURED (R0),(5,PLNINF),0,ALIGN=LEFT                                     
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
DTATB    LHI   R0,8                BYTE TO ATT A/B/C/D/E/F/G/H                  
         LA    R1,DTATBITS                                                      
*                                                                               
DTATB1   MVC   BYTE1,BYTE          COPY INDICATORS                              
         NC    BYTE1,0(R1)         TEST IF FLAG SET                             
         BZ    *+14                                                             
         MVC   0(1,R6),1(R1)       MOVE IN INDICATOR                            
         AHI   R6,1                                                             
         AHI   R1,2                                                             
         BCT   R0,DTATB1                                                        
         BR    RE                                                               
         DROP  R4                                                               
*                                                                               
HATT12   DC    CL16'Attribute 1 && 2'                                           
HBUFFSZ  DC    CL16'Buffer Size    '                                            
HARGMNTS DC    CL16'Input Arguments'                                            
*                                                                               
DTATBITS DC    X'80',C'A',X'40',C'B',X'20',C'C',X'10',C'D'                      
         DC    X'08',C'E',X'04',C'F',X'02',C'G',X'01',C'H'                      
*                                                                               
***********************************************************************         
* DEVICE (DEVTBL), TYPE (TYPTBL), AND NODE (NODETBL) TABLES                     
***********************************************************************         
       ++INCLUDE CTREPLUTAB                                                     
         EJECT                                                                  
                                                                                
***********************************************************************         
* X'26' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT26ELM  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         INPUT OPTIONS                                
         BE    CT26P02                                                          
         CLI   ADFTYPE,CTFILEQ                                                  
         BE    CT26P06                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT26P02  LR    R5,R4           *** INPUT OPTION                                 
         MVC   PLNHDR,HIOPTS                                                    
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#VALUE,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT26P04                                                          
         USING DEIOD,R2                                                         
         CURED (B1,DEIONUM),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                
         AHI   R4,L'PLINE                                                       
         CURED (B1,DEIOVAL),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                
         DROP  R2                                                               
*                                                                               
CT26P04  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING DEIOD,R3                                                         
         CURED (B1,DEIONUM),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                
         AHI   R4,L'PLINE                                                       
         CURED (B1,DEIOVAL),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT26P06  MVC   PLNHDR,HVTAML   *** LUID                                         
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTLUIID),CTLUIID-CTLUID(R2)                             
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTLUIID),CTLUIID-CTLUID(R3)                             
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
HIOPTS   DC    CL16'Input Option # '                                            
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'27' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT27ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         INPUT COLUMN FOR RANKING                     
         BE    CT27P02                                                          
         CLI   ADFTYPE,CTFILEQ     TERMINAL INFORMATION                         
         BE    CT27P04                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT27P02  MVC   PLNHDR,HLABEL   *** INPUT COLUMN                                 
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DEICCOL),DEICCOL-DEICD(R2)                              
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DEICCOL),DEICCOL-DEICD(R3)                              
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT27P04  MVC   PLNHDR,HSERNO       TERMINAL INFORMATION                         
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#ACTYD,L                                                
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HVENDOR                                                   
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT27P06                                                          
         USING CTTIND,R2                                                        
         MVC   PLOINF(L'CTTINSER),CTTINSER-CTTIND(R2)                           
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,PLIST,(3,CTTINDAT),(8,PLOINF)                            
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R1,R1                                                            
         IC    R1,CTTINLEN                                                      
         AHI   R1,-(CTTINVEN-CTTIND+1)                                          
         BM    CT27P06                                                          
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),CTTINVEN                                               
         DROP  R2                                                               
*                                                                               
CT27P06  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTTIND,R3                                                        
         MVC   PLNINF(L'CTTINSER),CTTINSER-CTTIND(R2)                           
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,PLIST,(3,CTTINDAT),(8,PLNINF)                            
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R1,R1                                                            
         IC    R1,CTTINLEN                                                      
         AHI   R1,-(CTTINVEN-CTTIND+1)                                          
         BM    EXITOK                                                           
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),CTTINVEN                                               
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'29' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       4(R1)   = A(COPY ELEMENT OR 0)                                *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT29ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     DEFAULT PRINTER QUEUE                        
         BE    CT29P02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT29P02  LTR   R2,R2           *** DEFAULT PRINTER QUEUE                        
         BZ    *+12                                                             
         CLI   CTPRQLEN-CTPRQD(R2),18                                           
         BNE   CT29P04                                                          
         LTR   R3,R3                                                            
         BZ    *+12                                                             
         CLI   CTPRQLEN-CTPRQD(R3),18                                           
         BNE   CT29P04                                                          
         MVC   PLBOTH(L'OLDSTYLE),OLDSTYLE                                      
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT29P04  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#USRID,L                                                
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HSUBID                                                    
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#CLASS,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT29P06                                                          
         USING CTPRQD,R2                                                        
         MVC   HALF,CTPRQUSR       GET PQ USER ID                               
         NI    HALF,255-X'80'      TURN OFF GENERIC ID BIT                      
         BRAS  RE,GETUSRID                                                      
         MVC   PLOINF(10),WORK+2                                                
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTPRQSUB),CTPRQSUB                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTPRQCLS),CTPRQCLS                                      
         DROP  R2                                                               
*                                                                               
CT29P06  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTPRQD,R3                                                        
         MVC   HALF,CTPRQUSR       GET PQ USER ID                               
         NI    HALF,255-X'80'      TURN OFF GENERIC ID BIT                      
         BRAS  RE,GETUSRID                                                      
         MVC   PLNINF(10),WORK+2                                                
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTPRQSUB),CTPRQSUB                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTPRQCLS),CTPRQCLS                                      
         B     EXITOK                                                           
*                                                                               
OLDSTYLE DC    CL30'Old style element - can''t be resolved'                     
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'30' ELEMENT PAIR DISPLAY ROUTINES                                 *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT30ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         OUTPUT HEADER                                
         BE    CT30S02                                                          
         CLI   ADRECNUM,84         BROADCAST TEXT                               
         BE    CT30S04                                                          
         CLI   ADRECNUM,113        RFP REQUEST                                  
         BE    CT30S08                                                          
         CLI   ADFTYPE,CTFILEQ     DESTINATION DETAIL                           
         BE    CT30S20                                                          
*                                                                               
         GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT30S02  MVC   PLNHDR,HLABEL   *** OUTPUT HEADER                                
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DEOSLAB),DEOSLAB-DEOSD(R2)                              
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DEOSLAB),DEOSLAB-DEOSD(R3)                              
         AHI   R4,L'PLINE                                                       
         B     EXITOK                                                           
*                                                                               
CT30S04  MVC   PLNHDR,HTEXT    *** BROADCAST TEXT                               
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT30S06                                                          
         USING BRDTXTD,R2                                                       
         XR    R0,R0                                                            
         IC    R0,BRDTXTLN                                                      
         AHI   R0,-(BRDTXTTX-BRDTXTD)                                           
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),BRDTXTTX),((RF),PLOINF),(C'P',8)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT30S06  LTR   R3,R3                                                            
         BZ    CT30S24                                                          
         USING BRDTXTD,R3                                                       
         XR    R0,R0                                                            
         IC    R0,BRDTXTLN                                                      
         AHI   R0,-(BRDTXTTX-BRDTXTD)                                           
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),BRDTXTTX),((RF),PLNINF),(C'P',8)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
         USING GRPRD,R3                                                         
CT30S08  LR    R5,R4               RFP REQUEST                                  
         MVCDD PLNHDR,CT#REQID,L                                                
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HSRTCODE                                                  
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#SEQ,L                                                  
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         CLI   GRPRCRDN,GRPRCHDQ   HEADER CARD?                                 
         BNE   CT30S10             NO                                           
*                                                                               
         MVCDD PLNHDR,CT#STT,L                                                  
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,GE#CLMNO,L                                                
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#HEADR,L                                                
         ST    R4,FULL                                                          
         B     CT30S12                                                          
*                                                                               
CT30S10  MVCDD PLNHDR,CT#STT,L                                                  
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#DESC,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         DROP  R3                                                               
*                                                                               
CT30S12  LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT30S16                                                          
         USING GRPRD,R2                                                         
         MVC   PLOINF(L'GRPRRNUM),GRPRRNUM                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'GRPRSORT),GRPRSORT                                      
         AHI   R4,L'PLINE                                                       
         CURED (B1,GRPRSEQN),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
*                                                                               
         CLI   GRPRCRDN,GRPRCHDQ   HEADER CARD?                                 
         BNE   CT30S14             NO                                           
*                                                                               
         MVCDD PLNHDR,CT#STT,L                                                  
         LA    RF,PLOINF                                                        
         TM    GRPRSTAT,GRPRDISQ                                                
         BZ    *+14                                                             
         MVC   0(9,RF),=CL9'Disabled,'                                          
         AHI   RF,9                                                             
         TM    GRPRSTAT,GRPRSPOF                                                
         BZ    *+14                                                             
         MVC   0(12,RF),=CL12'Spoof-Style,'                                     
         AHI   RF,12                                                            
         BCTR  RF,0                                                             
         CLI   0(RF),C','                                                       
         BNE   *+12                                                             
         MVI   0(RF),C' '                                                       
         AHI   R4,L'PLINE                                                       
*                                                                               
         CURED (B1,GRPRRQST),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'GRPCARD),GRPCARD                                        
         B     CT30S16                                                          
*                                                                               
CT30S14  CURED (B1,GRPRRQST),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'GRPRDSC),GRPRDSC                                        
         DROP  R2                                                               
*                                                                               
CT30S16  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    CT30S24                                                          
         USING GRPRD,R3                                                         
         MVC   PLNINF(L'GRPRRNUM),GRPRRNUM                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'GRPRSORT),GRPRSORT                                      
         AHI   R4,L'PLINE                                                       
         CURED (B1,GRPRSEQN),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         CLI   GRPRCRDN,GRPRCHDQ   HEADER CARD?                                 
         BNE   CT30S18             NO                                           
*                                                                               
         LA    RF,PLNINF                                                        
         TM    GRPRSTAT,GRPRDISQ                                                
         BZ    *+14                                                             
         MVC   0(9,RF),=CL9'Disabled,'                                          
         AHI   RF,9                                                             
         TM    GRPRSTAT,GRPRSPOF                                                
         BZ    *+14                                                             
         MVC   0(12,RF),=CL12'Spoof-Style,'                                     
         AHI   RF,12                                                            
         BCTR  RF,0                                                             
         CLI   0(RF),C','                                                       
         BNE   *+12                                                             
         MVI   0(RF),C' '                                                       
         AHI   R4,L'PLINE                                                       
*                                                                               
         CURED (B1,GRPRRQST),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'GRPCARD),GRPCARD                                        
         B     CT30S24                                                          
*                                                                               
CT30S18  CURED (B1,GRPRRQST),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'GRPRDSC),GRPRDSC                                        
         B     CT30S24                                                          
         DROP  R3                                                               
*                                                                               
CT30S20  LR    R5,R4           *** DESTINATION DETAIL                           
         MVC   PLNHDR,HLOGO1                                                    
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HLOGO2                                                    
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HPOWERCD                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HSHIPRTE                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,LC@NAME                                                   
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#ADR,L                                                  
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2               ANY COPY RECORD?                             
         BZ    CT30S22             NO                                           
         USING CTDSTD,R2                                                        
         MVC   PLOINF(L'CTDSTLG1),CTDSTLG1                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTDSTLG2),CTDSTLG2                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTDSTPOW),CTDSTPOW                                      
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,PLIST,CTDSTRUT,PLOINF,2,0                                
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTDSTNAM),CTDSTNAM                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTDSTADD),CTDSTADD                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         CLI   CTDSTLEN,(CTDSTAD2-CTDSTD)                                       
         BNH   *+18                                                             
         MVC   PLOINF(L'CTDSTAD2),CTDSTAD2                                      
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         CLI   CTDSTLEN,CTDSTAD3-CTDSTD                                         
         BNH   *+18                                                             
         MVC   PLOINF(L'CTDSTAD3),CTDSTAD3                                      
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT30S22  LTR   R3,R3               ANY CHANGE RECORD?                           
         BZ    CT30S24             NO                                           
         USING CTDSTD,R3                                                        
         LA    R4,PBLOCK                                                        
         MVC   PLNINF(L'CTDSTLG1),CTDSTLG1                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTDSTLG2),CTDSTLG2                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTDSTPOW),CTDSTPOW                                      
         AHI   R4,L'PLINE                                                       
         GOTO1 VHEXOUT,PLIST,CTDSTRUT,PLNINF,2,0                                
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTDSTNAM),CTDSTNAM                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTDSTADD),CTDSTADD                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         CLI   CTDSTLEN,(CTDSTAD2-CTDSTD)                                       
         BNH   *+18                                                             
         MVC   PLNINF(L'CTDSTAD2),CTDSTAD2                                      
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         CLI   CTDSTLEN,CTDSTAD3-CTDSTD                                         
         BNH   *+18                                                             
         MVC   PLNINF(L'CTDSTAD3),CTDSTAD3                                      
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         DROP  R3                                                               
*                                                                               
CT30S24  BRAS  RE,PRNT                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'31' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT31ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         INPUT STATEMENT LABEL                        
         BE    CT31P02                                                          
         CLI   ADFTYPE,CTFILEQ     ATTENTION DETAIL                             
         BE    CT31P04                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT31P02  MVC   PLNHDR,HLABEL   *** INPUT STATEMENT LABEL                        
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DEISLABL),DEISLABL-DEISLD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DEISLABL),DEISLABL-DEISLD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT31P04  MVCDD PLNHDR,CT#DTL,L *** ATTENTION DETAIL                             
         LTR   R2,R2                                                            
         BZ    CT31P06                                                          
         USING CTATTND,R2                                                       
         MVC   PLOINF(L'CTATTTYP),CTATTTYP                                      
         LA    R5,PLOINF+L'CTATTTYP+1                                           
         MVI   0(R5),C'='                                                       
         XR    R1,R1                                                            
         IC    R1,CTATTLEN                                                      
         AHI   R1,-(CTATTDET-CTATTND+1)                                         
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   2(0,R5),CTATTDET                                                 
         DROP  R2                                                               
*                                                                               
CT31P06  LTR   R3,R3                                                            
         BZ    CT31P08                                                          
         USING CTATTND,R3                                                       
         MVC   PLNINF(L'CTATTTYP),CTATTTYP                                      
         LA    R5,PLNINF+L'CTATTTYP+1                                           
         MVI   0(R5),C'='                                                       
         XR    R1,R1                                                            
         IC    R1,CTATTLEN                                                      
         AHI   R1,-(CTATTDET-CTATTND+1)                                         
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   2(0,R5),CTATTDET                                                 
*                                                                               
CT31P08  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'32' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT32ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         OUTPUT TYPE                                  
         BE    CT32P02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT32P02  MVC   PLNHDR,LC@OTPTY     OUTPUT TYPE                                  
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DEOTYPE),DEOTYPE-DEOTD(R2)                              
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DEOTYPE),DEOTYPE-DEOTD(R3)                              
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'33' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT33ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         OUTPUT TYPE                                  
         BE    CT33P02                                                          
         CLI   ADFTYPE,CTFILEQ     AGENCY DEFINITION                            
         BE    CT33P08                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT33P02  MVC   PLNHDR,HOUTLEN  *** OUTPUT TYPE                                  
         LTR   R2,R2                                                            
         BZ    CT33P04                                                          
         USING DEOLD,R2                                                         
         CURED (B1,DEOLEN),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                 
         DROP  R2                                                               
*                                                                               
CT33P04  LTR   R3,R3                                                            
         BZ    CT33P06                                                          
         USING DEOLD,R3                                                         
         CURED (B1,DEOLEN),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                 
         DROP  R3                                                               
*                                                                               
CT33P06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT33P08  LR    R5,R4                                                            
*&&UK                                                                           
         MVC   PLNHDR,HLINEID                                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HIPAAGY                                                   
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT33P10                                                          
         USING CTUKAD,R2                                                        
         MVC   PLOINF(L'CTUKALIN),CTUKALIN                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTUKAIPA),CTUKAIPA                                      
         DROP  R2                                                               
*                                                                               
CT33P10  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    CT33P10                                                          
         USING CTUKAD,R3                                                        
         MVC   PLNINF(L'CTUKALIN),CTUKALIN                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTUKAIPA),CTUKAIPA                                      
         B     EXITOK                                                           
         DROP  R3                                                               
*&&                                                                             
*&&US                                                                           
         MVC   PLNHDR,HDAREPID                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HDARERC                                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HDAREFLG                                                  
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT33P10                                                          
         USING CTUSAD,R2                                                        
         MVC   PLOINF(L'CTUSADPI),CTUSADPI                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTUSADRC),CTUSADRC                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTUSADFL),CTUSADFL                                      
         DROP  R2                                                               
*                                                                               
CT33P10  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTUSAD,R3                                                        
         MVC   PLNINF(L'CTUSADPI),CTUSADPI                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTUSADRC),CTUSADRC                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTUSADFL),CTUSADFL                                      
         B     EXITOK                                                           
         DROP  R3,R4                                                            
*&&                                                                             
HOUTLEN  DC    CL16'Output Length  '                                            
HDAREFLG DC    CL16'DARE Flag      '                                            
HDAREPID DC    CL16'DARE Partner Id'                                            
HDARERC  DC    CL16'DARE Route Code'                                            
         EJECT                                                                  
***********************************************************************         
* X'34' ELEMENT PAIR HANDLER                                          *         
***********************************************************************         
CT34PAIR NTR1  BASE=*,LABEL=*                                                   
         L     R6,AELMNTRY                                                      
         USING CTELEMD,R6                                                       
         LM    R2,R3,0(R1)                                                      
         LA    R4,PBLOCK                                                        
X        USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         OUTPUT ROUTINE                               
         BE    CT34P02                                                          
         CLI   ADFTYPE,CTFILEQ     CTFILE DEFAULT                               
         BE    CT34P04                                                          
*                                                                               
CT34P02  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT34P04  LHI   R0,L'ELNAMEC        CHOP UP ELEMENT NAME FOR DISPLAY             
         LHI   RF,L'PLELEM                                                      
         LA    R4,PBLOCK                                                        
         GOTO1 VCHOPPER,DMCB,((R0),ELNAMEC),((RF),X.PLELEM),(C'P',3)            
         DROP  R6                                                               
*                                                                               
         MVCDD X.PLNHDR,CT#USRIS,L                                              
*                                                                               
         LA    R0,WORK             CLEAR OUT WORK AREA                          
         LHI   R1,L'WORK                                                        
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         LA    R5,WORK             R5 = A(NEXT IN WORK BUILD AREA)              
*                                                                               
CT34P06  CLC   0(4,R2),EFFS        DONE WITH COPIES?                            
         BE    CT34P08             YES                                          
         L     R6,0(R2)                                                         
         BRAS  RE,CT34DIS                                                       
         AHI   R2,4                                                             
         B     CT34P06                                                          
*                                                                               
CT34P08  LA    R0,WORK                                                          
         CR    R5,R0                                                            
         BE    CT34P10                                                          
         BCTR  R5,0                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R5),WORK),((RF),X.PLOINF),(C'P',10)              
*                                                                               
CT34P10  LA    R0,WORK             CLEAR OUT WORK AREA                          
         LHI   R1,L'WORK                                                        
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         LA    R5,WORK             R5 = A(NEXT IN WORK BUILD AREA)              
*                                                                               
CT34P12  CLC   0(4,R3),EFFS        FINISHED WITH CHANGES?                       
         BE    CT34P14             YES                                          
         L     R6,0(R3)                                                         
         BRAS  RE,CT34DIS                                                       
         AHI   R3,4                                                             
         B     CT34P12                                                          
*                                                                               
CT34P14  LA    R0,WORK                                                          
         CR    R5,R0                                                            
         BE    CT34P16                                                          
         BCTR  R5,0                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   RF,L'PLNINF                                                      
         GOTO1 VCHOPPER,DMCB,((R5),WORK),((RF),X.PLNINF),(C'P',10)              
*                                                                               
CT34P16  BRAS  RE,PRNT             PRINT LINES                                  
         B     EXITOK                                                           
         DROP  X                                                                
*                                                                               
         USING CTVALD,R6                                                        
CT34DIS  NTR1  ,                                                                
         TM    CTVALDST,X'C0'                                                   
         BZ    CT34D02                                                          
         MVC   0(L'CTVALDST,R5),CTVALDST                                        
         AHI   R5,L'CTVALDST                                                    
         B     CT34D08                                                          
*                                                                               
CT34D02  OC    CTVALDST(2),CTVALDST                                             
         BNZ   CT34D04                                                          
         MVC   0(L'CTVALDST,R5),CTVALDST                                        
         MVC   0(2,R5),=CL2'L='                                                 
         AHI   R5,L'CTVALDST                                                    
         B     CT34D08                                                          
*                                                                               
CT34D04  CLC   CTVALDST(2),=X'0001'                                             
         BNE   CT34D06                                                          
         MVC   0(L'CTVALDST,R5),CTVALDST                                        
         MVC   0(2,R5),=CL2'A='                                                 
         AHI   R5,L'CTVALDST                                                    
         B     CT34D08                                                          
*                                                                               
CT34D06  XR    R0,R0               HEX OUT UNKNOWN VALUES                       
         IC    R0,CTVALLEN                                                      
         GOTO1 VHEXOUT,PLIST,CTVALD,0(R5),(R0),0                                
         SLL   R0,2                                                             
         AR    R5,R0                                                            
*                                                                               
CT34D08  CLI   0(R5),C' '          ADD A TRAILING COMMA                         
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   1(R5),C','                                                       
         AHI   R5,2                                                             
         XIT1  REGS=(R5)                                                        
         DROP  R6                                                               
         EJECT                                                                  
***********************************************************************         
* X'35' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT35ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,6          COMMENT                                      
         BE    CT35P02                                                          
         CLI   ADRECNUM,82         OUTPUT ARGUMENTS                             
         BE    CT35P06                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT35P02  MVCDD PLNHDR,CT#CMT,L *** COMMENT                                      
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT35P04                                                          
         USING CTPHCOMD,R2                                                      
         CURED CTPHCLNM,(2,PLOINF),0,ZERO=NOBLANK                               
         MVI   PLOINF+02,C'='                                                   
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTPHCLEN                                                      
         AHI   R0,-(CTPHCOVQ)                                                   
         LHI   RF,L'PLOINF-3                                                    
         GOTO1 VCHOPPER,DMCB,((R0),CTPHCTXT),((RF),PLOINF+3),(C'P',10)          
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT35P04  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTPHCOMD,R3                                                      
         CURED CTPHCLNM,(2,PLNINF),0,ZERO=NOBLANK                               
         MVI   PLNINF+02,C'='                                                   
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTPHCLEN                                                      
         AHI   R0,-(CTPHCOVQ)                                                   
         LHI   RF,L'PLNINF-3                                                    
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   R0,L'PLBOTH-3                                                    
         GOTO1 VCHOPPER,DMCB,((R0),CTPHCTXT),((RF),PLNINF+3),(C'P',10)          
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
CT35P06  MVC   PLNHDR,HOUTARGS *** OUTPUT ARGUMENTS                             
         LTR   R2,R2                                                            
         BZ    CT35P08                                                          
         USING DEOAD,R2                                                         
         XR    RF,RF                                                            
         IC    RF,DEOALEN                                                       
         AHI   RF,-(DEOARGS-DEOAD+1)                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),DEOARGS                                                
         DROP  R2                                                               
*                                                                               
CT35P08  LTR   R3,R3                                                            
         BZ    CT35P10                                                          
         USING DEOAD,R3                                                         
         XR    RF,RF                                                            
         IC    RF,DEOALEN                                                       
         AHI   RF,-(DEOARGS-DEOAD+1)                                            
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),DEOARGS                                                
         DROP  R3                                                               
*                                                                               
CT35P10  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
HOUTARGS DC    CL16'Output Arguments'                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'36' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT)                                     *         
*       4(R1)   = A(CHANGE/ADD ELEMENT)                               *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT36ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         OUTPUT OPTION                                
         BE    CT36P02                                                          
         CLI   ADRECNUM,86         AGREEMENT EXPIRY                             
         BE    CT36P08                                                          
         CLI   ADRECNUM,87         AGREEMENT EXPIRY                             
         BE    CT36P08                                                          
         CLI   ADRECNUM,88         AGREEMENT EXPIRY                             
         BE    CT36P08                                                          
         CLI   ADRECNUM,89         AGREEMENT EXPIRY                             
         BE    CT36P08                                                          
         CLI   ADRECNUM,90         AGREEMENT EXPIRY                             
         BE    CT36P08                                                          
         CLI   ADRECNUM,91         AGREEMENT EXPIRY                             
         BE    CT36P08                                                          
         CLI   ADFTYPE,CTFILEQ     ORIGIN DETAIL - CTFILE DEFAULT               
         BE    CT36P10                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT36P02  LR    R5,R4           *** OUTPUT OPTION                                
         MVC   PLNHDR,HOOPTS                                                    
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#VALUE,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT36P04                                                          
         USING DEOOD,R2                                                         
         CURED (B1,DEOONUM),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                
         AHI   R4,L'PLINE                                                       
         CURED (B1,DEOOVAL),(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                
         DROP  R2                                                               
*                                                                               
CT36P04  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING DEOOD,R3                                                         
         CURED (B1,DEOONUM),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                
         AHI   R4,L'PLINE                                                       
         CURED (B1,DEOOVAL),(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                
         B     EXITOK                                                           
         DROP  R3                                                               
*                                                                               
*              GFAGRD          *** AGREEMENT EXPIRY                             
*                                                                               
CT36P08  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT36P10  MVC   PLNHDR,HORGNAME *** ORIGIN DETAIL                                
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTORGNAM),CTORGNAM-CTORGD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTORGNAM),CTORGNAM-CTORGD(R3)                           
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HORGADDR                                                  
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTORGADD),CTORGADD-CTORGD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTORGADD),CTORGADD-CTORGD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
*                                                                               
HOOPTS   DC    CL16'Output Option #'                                            
         EJECT                                                                  
***********************************************************************         
* X'38' ELEMENT PAIR HANDLER                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT)                                     *         
*       4(R1)   = A(CHANGE/ADD ELEMENT)                               *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT38ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,86         BAND PERCENTAGE                              
         BL    *+12                                                             
         CLI   ADRECNUM,91         BAND PERCENTAGE                              
         BNH   CT38E02                                                          
*                                                                               
         CLI   ADFTYPE,CTFILEQ     OUTPUT DETAIL                                
         BE    CT38E04                                                          
*                                                                               
CT38E02  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT38E04  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#CLASS,L                                                
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Priority'                                           
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Power code'                                         
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'CC tape'                                            
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'# of copies'                                        
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Disposition'                                        
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Seperators'                                         
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Tape details'                                       
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'User can request'                                   
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Output type'                                        
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Chars VAL=1'                                        
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Chars VAL=2'                                        
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Chars VAL=3'                                        
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Chars VAL=4'                                        
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'Fiche letter'                                       
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'# of FORMDEFS'                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'FORMDEF = '                                         
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'# of PAGEDEFS'                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,=CL16'PAGEDEF = '                                         
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT38E06                                                          
         USING CTOUTD,R2                                                        
         MVC   PLOINF(L'CTOUTCLS),CTOUTCLS                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTPRI),CTOUTPRI                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTPOW),CTOUTPOW                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTCC),CTOUTCC                                        
         AHI   R4,L'PLINE                                                       
         CURED (B1,CTOUTCPY),(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTDIS),CTOUTDIS                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTSEP),CTOUTSEP                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTTAP),CTOUTTAP                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'C4YESL),C4YESL                                          
         TM    CTOUTSTA,X'80'                                                   
         BO    *+10                                                             
         MVC   PLOINF(L'C4NOL),C4NOL                                            
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTTYP),CTOUTTYP                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTCHR),CTOUTCHR                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTCH2),CTOUTCH2                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTCH3),CTOUTCH3                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTCH4),CTOUTCH4                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTFCH),CTOUTFCH                                      
         AHI   R4,L'PLINE                                                       
         CURED (B1,CTOUTFMN),(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTFMD),CTOUTFMD                                      
         AHI   R4,L'PLINE                                                       
         CURED (B1,CTOUTPGN),(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTOUTPGD),CTOUTPGD                                      
         DROP  R2                                                               
*                                                                               
CT38E06  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTOUTD,R3                                                        
         MVC   PLNINF(L'CTOUTCLS),CTOUTCLS                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTPRI),CTOUTPRI                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTPOW),CTOUTPOW                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTCC),CTOUTCC                                        
         AHI   R4,L'PLINE                                                       
         CURED (B1,CTOUTCPY),(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTDIS),CTOUTDIS                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTSEP),CTOUTSEP                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTTAP),CTOUTTAP                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'C4YESL),C4YESL                                          
         TM    CTOUTSTA,X'80'                                                   
         BO    *+10                                                             
         MVC   PLNINF(L'C4NOL),C4NOL                                            
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTTYP),CTOUTTYP                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTCHR),CTOUTCHR                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTCH2),CTOUTCH2                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTCH3),CTOUTCH3                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTCH4),CTOUTCH4                                      
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTFCH),CTOUTFCH                                      
         AHI   R4,L'PLINE                                                       
         CURED (B1,CTOUTFMN),(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTFMD),CTOUTFMD                                      
         AHI   R4,L'PLINE                                                       
         CURED (B1,CTOUTPGN),(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTOUTPGD),CTOUTPGD                                      
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'3A' ELEMENT PAIR HANDLER                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT)                                     *         
*       4(R1)   = A(CHANGE/ADD ELEMENT)                               *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT3AELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,76         CURRENCY                                     
         BE    CT3AE02                                                          
         CLI   ADRECNUM,77         CURRENCY                                     
         BE    CT3AE02                                                          
         CLI   ADFTYPE,CTFILEQ     VALID PRINTER                                
         BE    CT3AE04                                                          
*                                                                               
CT3AE02  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CT3AE04  MVC   PLNHDR,HPRNTRLS                                                  
         ST    R4,FULL                                                          
*                                                                               
         LA    R0,WORK             CLEAR OUT WORK AREA                          
         LHI   R1,L'WORK                                                        
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         LA    R5,WORK             R5 = A(NEXT IN WORK BUILD AREA)              
*                                                                               
CT3AE06  LTR   R6,R2                                                            
         BZ    CT3AE10                                                          
         BRAS  RE,CT3ADIS                                                       
*                                                                               
CT3AE08  LA    R0,WORK                                                          
         CR    R5,R0                                                            
         BE    CT3AE10                                                          
         BCTR  R5,0                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R5),WORK),((RF),PLOINF),(C'P',10)                
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    *+8                                                              
         ST    R0,FULL                                                          
*                                                                               
CT3AE10  LA    R0,WORK             CLEAR OUT WORK AREA                          
         LHI   R1,L'WORK                                                        
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         LA    R5,WORK             R5 = A(NEXT IN WORK BUILD AREA)              
*                                                                               
         LTR   R6,R3                                                            
         BZ    EXITOK                                                           
         BRAS  RE,CT3ADIS                                                       
*                                                                               
         LA    R0,WORK                                                          
         CR    R5,R0                                                            
         BE    EXITOK                                                           
         BCTR  R5,0                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R5),WORK),((RF),PLNINF),(C'P',10)                
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    *+8                                                              
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
*                                                                               
         USING CTPRND,R6                                                        
CT3ADIS  NTR1  ,                                                                
         OC    CTPRNFLG,CTPRNFLG                                                
         BNZ   CT3AD02                                                          
         MVC   0(2,R5),=CL2'L='                                                 
         MVC   2(L'CTPRNLST,R5),CTPRNLST                                        
         AHI   R5,L'CTPRNLST+2                                                  
         B     CT3AD04                                                          
*                                                                               
CT3AD02  CURED CTPRNNUM,(3,0(R5)),0,ZERO=NOBLANK,ALIGN=LEFT                     
         AR    R5,R0                                                            
         MVI   0(R5),C'='                                                       
         MVC   1(L'CTPRNLIN+L'CTPRNADD,R5),CTPRNLIN                             
         AHI   R5,L'CTPRNLIN+L'CTPRNADD+1                                       
*                                                                               
CT3AD04  CLI   0(R5),C' '          ADD A TRAILING COMMA                         
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   1(R5),C','                                                       
         AHI   R5,2                                                             
         XIT1  REGS=(R5)                                                        
         DROP  R6                                                               
         EJECT                                                                  
***********************************************************************         
* X'3E' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT3EELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,86         COMMENT                                      
         BE    CT3EE02                                                          
         CLI   ADRECNUM,87         COMMENT                                      
         BE    CT3EE02                                                          
         CLI   ADRECNUM,88         COMMENT                                      
         BE    CT3EE02                                                          
         CLI   ADRECNUM,89         COMMENT                                      
         BE    CT3EE02                                                          
         CLI   ADRECNUM,90         COMMENT                                      
         BE    CT3EE02                                                          
         CLI   ADRECNUM,91         COMMENT                                      
         BE    CT3EE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT3EE02  MVCDD PLNHDR,CT#CMT,L                                                  
         LTR   R2,R2                                                            
         BZ    CT3EE04                                                          
         USING GFCOMMD,R2                                                       
         XR    R0,R0                                                            
         IC    R0,GFCOMELL                                                      
         AHI   R0,-(GFCOMFXQ)                                                   
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),GFCOMMNT),((RF),PLOINF),(C'P',8)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT3EE04  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING GFCOMMD,R3                                                       
         XR    R0,R0                                                            
         IC    R0,GFCOMELL                                                      
         AHI   R0,-(GFCOMFXQ)                                                   
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),GFCOMMNT),((RF),PLBOTH),(C'P',8)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'40' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT40ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         HEAD STATEMENT                               
         BE    CT40P02                                                          
         CLI   ADFTYPE,CTFILEQ     DESTINATION DETAIL                           
         BE    CT40P08                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT40P02  MVC   PLNHDR,HLINNUM                                                   
         LTR   R2,R2                                                            
         BZ    CT40P04                                                          
         USING DEHDD,R2                                                         
         CURED DEHDLIN,(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         DROP  R2                                                               
*                                                                               
CT40P04  LTR   R3,R3                                                            
         BZ    CT40P06                                                          
         USING DEHDD,R3                                                         
         CURED DEHDLIN,(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         DROP  R3                                                               
*                                                                               
CT40P06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
         USING CTDCOD,R2                                                        
CT40P08  BRAS  RE,PRFTYPE          OUTPUT PROFILE TYPE                          
         L     R4,FULL                                                          
         MVCDD PLNHDR,CT#DESTN,L                                                
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF,CTDCODE-CTDCOD(R2)                                        
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF,CTDCODE-CTDCOD(R3)                                        
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVCDD PLNHDR,GE#DEST#,L                                                
         LTR   R2,R2                                                            
         BZ    CT40P12                                                          
         USING CTDCOD,R2                                                        
         GOTO1 VHEXOUT,CTDCNUM,PLOINF,L'CTDCNUM,0                               
         DROP  R2                                                               
*                                                                               
CT40P12  LTR   R3,R3                                                            
         BZ    CT40P14                                                          
         USING CTDCOD,R3                                                        
         GOTO1 VHEXOUT,CTDCNUM,PLNINF,L'CTDCNUM,0                               
         DROP  R3                                                               
*                                                                               
CT40P14  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'41' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT41ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     DESTINATION DETAIL                           
         BE    CT41E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT41E02  BRAS  RE,PRFTYPE          OUTPUT PROFILE TYPE                          
         L     R4,FULL                                                          
         MVC   PLNHDR,HATTYPE                                                   
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTACODE),CTACODE-CTACOD(R2)                             
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTACODE),CTACODE-CTACOD(R3)                             
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'42' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT CODE OR 0)                           *         
*       4(R1)   = A(CHANGE ELEMENT CODE OR 0)                         *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT42ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         CHUNK STATEMENT                              
         BE    CT42E02                                                          
         CLI   ADFTYPE,CTFILEQ     OUTPUT TYPE                                  
         BE    CT42E04                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT42E02  MVC   PLNHDR,HLABEL                                                    
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'DECHENDL),DECHENDL-DECHD(R2)                            
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'DECHENDL),DECHENDL-DECHD(R3)                            
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT42E04  BRAS  RE,PRFTYPE          OUTPUT PROFILE TYPE                          
         L     R4,FULL                                                          
         MVC   PLNHDR,LC@OTPTY                                                  
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTOCODE),CTOCODE-CTOCOD(R2)                             
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTOCODE),CTOCODE-CTOCOD(R3)                             
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'43' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT43ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     OUTPUT MODE TYPE                             
         BE    CT43E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT43E02  BRAS  RE,PRFTYPE          OUTPUT PROFILE TYPE                          
         L     R4,FULL                                                          
         MVC   PLNHDR,HOUTMODE                                                  
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTOCODE),CTOCODE-CTOCOD(R2)                             
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTOCODE),CTOCODE-CTOCOD(R3)                             
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'44' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT44ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         FIRST/LAST STATEMENT                         
         BE    CT44P02                                                          
         CLI   ADFTYPE,CTFILEQ     PRIORITY CODE                                
         BE    CT44P08                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT44P02  MVC   PLNHDR,HLABEL                                                    
         LTR   R2,R2                                                            
         BZ    CT44P04                                                          
         USING DEFLD,R2                                                         
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         CLI   DEFLIND,C'F'                                                     
         BNE   *+10                                                             
         MVCDD PLOINF(10),CT#FIRST,L                                            
         CLI   DEFLIND,C'L'                                                     
         BNE   *+10                                                             
         MVCDD PLOINF(10),CT#LAST,L                                             
         DROP  R2                                                               
*                                                                               
CT44P04  LTR   R3,R3                                                            
         BZ    CT44P06                                                          
         USING DEFLD,R3                                                         
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         CLI   DEFLIND,C'F'                                                     
         BNE   *+10                                                             
         MVCDD PLNINF(10),CT#FIRST,L                                            
         CLI   DEFLIND,C'L'                                                     
         BNE   *+10                                                             
         MVCDD PLNINF(10),CT#LAST,L                                             
*                                                                               
CT44P06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT44P08  BRAS  RE,PRFTYPE      *** PRIORITY CODE                                
         L     R4,FULL                                                          
         MVC   PLNHDR,HSRTCODE                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HSRTTYPE                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HOUTCODE                                                  
         AHI   R4,L'PLINE                                                       
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT44P12                                                          
         L     R4,FULL                                                          
         USING CTPRID,R2                                                        
         MVC   PLOINF(L'CTPRISC),CTPRISC                                        
         OC    CTPRISC,CTPRISC                                                  
         BNZ   *+10                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLOINF(L'CTPRIPT),CTPRIPT                                        
         OC    CTPRIPT,CTPRIPT                                                  
         BNZ   *+10                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLOINF(L'CTPRIPO),CTPRIPO                                        
         OC    CTPRIPO,CTPRIPO                                                  
         BNZ   *+10                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R4,L'PLINE                                                       
         DROP  R2                                                               
*                                                                               
CT44P12  LTR   R3,R3                                                            
         BZ    CT44P14                                                          
         L     R4,FULL                                                          
         USING CTPRID,R3                                                        
         MVC   PLOINF(L'CTPRISC),CTPRISC                                        
         OC    CTPRISC,CTPRISC                                                  
         BNZ   *+10                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLOINF(L'CTPRIPT),CTPRIPT                                        
         OC    CTPRIPT,CTPRIPT                                                  
         BNZ   *+10                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLOINF(L'CTPRIPO),CTPRIPO                                        
         OC    CTPRIPO,CTPRIPO                                                  
         BNZ   *+10                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         AHI   R4,L'PLINE                                                       
         DROP  R3                                                               
*                                                                               
CT44P14  ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'45' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT45ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     READER CLASS                                 
         BE    CT45E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT45E02  BRAS  RE,PRFTYPE          OUTPUT PROFILE TYPE                          
         L     R4,FULL                                                          
         MVC   PLNHDR,HRDRCLS                                                   
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTRCLASS),CTRCLASS-CTRCLD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTRCLASS),CTRCLASS-CTRCLD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'46' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT46ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         CONTROL BREAK INSTRUCTIONS                   
         BE    CT46P02                                                          
         CLI   ADFTYPE,CTFILEQ     SORT DATA FORMULA                            
         BE    CT46P08                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
         USING DECBD,R2                                                         
CT46P02  MVC   PLNHDR,HINSTRCT                                                  
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         LTR   R2,R2                                                            
         BZ    CT46P04                                                          
         USING DECBD,R2                                                         
         CLI   DECBINS,X'01'                                                    
         BNE   *+14                                                             
         MVC   PLOINF(16),=CL16'Skip to new page'                               
         B     CT46P04                                                          
*                                                                               
         CLI   DECBINS,X'03'                                                    
         BNE   *+14                                                             
         MVC   PLOINF(22),=CL22'Reset page number to 1'                         
         B     CT46P04                                                          
*                                                                               
         CLI   DECBINS,X'04'                                                    
         BNE   *+14                                                             
         MVC   PLOINF(26),=CL26'Reset sub page number to 1'                     
         B     CT46P04                                                          
*                                                                               
         CLI   DECBINS,X'05'                                                    
         BNE   *+14                                                             
         MVC   PLOINF(24),=CL24'Midhead headings midpage'                       
         B     CT46P04                                                          
*                                                                               
         CLI   DECBINS,X'02'                                                    
         BNE   CT46P04                                                          
         MVC   PLOINF(6),=CL6'Space '                                           
         CURED DECBVAL,(3,PLOINF+6),0,ALIGN=LEFT,ZERO=NOBLANK                   
         LA    RF,PLOINF                                                        
         AR    RF,R0                                                            
         MVC   0(5,RF),=CL5'Lines'                                              
         DROP  R2                                                               
*                                                                               
CT46P04  LTR   R3,R3                                                            
         BZ    CT46P06                                                          
         USING DECBD,R3                                                         
         CLI   DECBINS,X'01'                                                    
         BNE   *+14                                                             
         MVC   PLNINF(16),=CL16'Skip to new page'                               
         B     CT46P06                                                          
*                                                                               
         CLI   DECBINS,X'03'                                                    
         BNE   *+14                                                             
         MVC   PLNINF(22),=CL22'Reset page number to 1'                         
         B     CT46P06                                                          
*                                                                               
         CLI   DECBINS,X'04'                                                    
         BNE   *+14                                                             
         MVC   PLNINF(26),=CL26'Reset sub page number to 1'                     
         B     CT46P06                                                          
*                                                                               
         CLI   DECBINS,X'05'                                                    
         BNE   *+14                                                             
         MVC   PLNINF(24),=CL24'Midhead headings midpage'                       
         B     CT46P06                                                          
*                                                                               
         CLI   DECBINS,X'02'                                                    
         BNE   CT46P06                                                          
         MVC   PLNINF(6),=CL6'Space '                                           
         CURED DECBVAL,(3,PLNINF+6),0,ALIGN=LEFT,ZERO=NOBLANK                   
         LA    RF,PLNINF                                                        
         AR    RF,R0                                                            
         MVC   0(5,RF),=CL5'Lines'                                              
         DROP  R3                                                               
*                                                                               
CT46P06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
         USING CTSRTD,R2                                                        
CT46P08  BRAS  RE,PRFTYPE      *** SORT DATA FORMULA                            
         L     R4,FULL                                                          
         MVC   PLNHDR,HSRTFRM                                                   
         XC    FULL,FULL                                                        
*                                                                               
         LTR   RF,R2               COPY ELEMENT                                 
         BZ    CT46P10                                                          
         BRAS  RE,DISSRTF                                                       
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLOINF),(C'P',8)                 
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
*                                                                               
CT46P10  LTR   RF,R3               CHANGE ELEMENT                               
         BZ    EXITOK                                                           
         BRAS  RE,DISSRTF                                                       
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLNINF),(C'P',8)                 
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
*                                                                               
DISSRTF  NTR1  ,                   DISPLAY DETAILS INTO WORK                    
         LR    R2,RF                                                            
         USING CTSRTD,R2           RETURN LENGTH IN (R0)                        
         LA    R6,WORK                                                          
         LA    R4,CTSRTFRM         DISPLAY DETAILS                              
*                                                                               
         XR    R3,R3                                                            
         IC    R3,CTSRTLEN                                                      
         AHI   R3,-(CTSRTFRM-CTSRTD)                                            
         BP    DSRTF02                                                          
         DROP  R2                                                               
*                                                                               
         MVC   WORK(20),=CL20'Improperly defined'                               
         LHI   R0,20                                                            
         B     DISSRTFX                                                         
*                                                                               
DSRTF02  MVI   2(R6),C','          FORMAT IS: DISP,LEN,ORDER                    
         MVI   5(R6),C','          SHOWN AS : XX,XX,X                           
         MVI   7(R6),C','                                                       
*                                                                               
         MVI   6(R6),C'A'          SET ORDER - ASCENDING OR DESCENDING          
         TM    0(R4),X'80'                                                      
         BZ    *+8                                                              
         MVI   6(R6),C'D'                                                       
*                                                                               
         NI    0(R4),X'7F'         TURN OFF HOB FOR SORT ORDER                  
         CURED (B1,(R4)),(2,(R6)),0,ZERO=NOBLANK                                
         CURED (B1,1(R4)),(2,3(R6)),0,ZERO=NOBLANK                              
*                                                                               
         LA    R4,2(R4)                                                         
         LA    R6,8(R6)                                                         
         AHI   R3,-2                                                            
         BP    DSRTF02                                                          
*                                                                               
         BCTR  R6,0                                                             
         CLI   0(R6),C','                                                       
         BNE   *+8                                                              
         MVI   0(R6),C' '                                                       
         LA    R0,WORK                                                          
         SR    R6,R0                                                            
         LR    R0,R6               SET DISPLAY LENGTH                           
*                                                                               
DISSRTFX XIT1  REGS=(R0)                                                        
         EJECT                                                                  
***********************************************************************         
* X'47' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT47ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     PQ PASSWORD                                  
         BE    CT47E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT47E02  BRAS  RE,PRFTYPE      *** PQ PASSWORD                                  
         L     R4,FULL                                                          
         MVC   PLNHDR,HPQPWD                                                    
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTPQPWD),CTPQPWD-CTPQPD(R2)                             
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTPQPWD),CTPQPWD-CTPQPD(R3)                             
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'48' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT48ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     PROCESSING INSTRUCTIONS                      
         BE    CT48E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT48E02  MVC   PLNHDR,HOPSINS  *** PROCESSING INSTRUCTIONS                      
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT48E04                                                          
         USING CTPRCD,R2                                                        
         XR    R0,R0                                                            
         IC    R0,CTPRCLEN                                                      
         AHI   R0,-(CTPRCINS-CTPRCD)                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTPRCINS),((RF),PLOINF),(C'P',3)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         ST    R4,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT48E04  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTPRCD,R3                                                        
         XR    R0,R0                                                            
         IC    R0,CTPRCLEN                                                      
         AHI   R0,-(CTPRCINS-CTPRCD)                                            
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTPRCINS),((RF),PLNINF),(C'P',3)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R4,R0                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'49' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT49ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,82         TOTALS DETAIL                                
         BE    CT49P02                                                          
         CLI   ADFTYPE,CTFILEQ     PQ RETAIN CLASS                              
         BE    CT49P08                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT49P02  MVC   PLNHDR,HDETCNT  *** TOTALS DETAIL                                
         LTR   R2,R2                                                            
         BZ    CT49P04                                                          
         USING DEDETD,R2                                                        
         GOTO1 VHEXOUT,DMCB,DEDETAIL,PLOINF,L'DEDETAIL,0                        
         DROP  R2                                                               
*                                                                               
CT49P04  LTR   R3,R3                                                            
         BZ    CT49P06                                                          
         USING DEDETD,R3                                                        
         GOTO1 VHEXOUT,DMCB,DEDETAIL,PLNINF,L'DEDETAIL,0                        
         DROP  R3                                                               
*                                                                               
CT49P06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT49P08  MVC   PLNHDR,HRETCLS  *** RETAIN CLASS                                 
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTPQCLAS),CTPQCLAS-CTPQCD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTPQCLAS),CTPQCLAS-CTPQCD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    *+12                                                             
         CLI   CTPQCLEN-CTPQCD(R2),CTPQCLA2-CTPQCD                              
         BH    CT49P10                                                          
*                                                                               
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         CLI   CTPQCLEN-CTPQCD(R3),CTPQCLA2-CTPQCD                              
         BNH   EXITOK                                                           
*                                                                               
CT49P10  MVC   PLNHDR,HSRETCLS                                                  
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTPQCLA2),CTPQCLA2-CTPQCD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTPQCLA2),CTPQCLA2-CTPQCD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
HDETCNT  DC    CL16'Detail Control '                                            
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'4A' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT4AELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     PACKING DETAILS                              
         BE    CT4AP02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT4AP02  MVC   PLNHDR,HPAKDET  *** PACKING DETAILS                              
         LTR   R3,R3                                                            
         BZ    CT4AP04                                                          
         USING CTPAKD,R2                                                        
         XR    R0,R0                                                            
         IC    R0,CTPAKLEN                                                      
         AHI   R0,-(CTPAKINS-CTPAKD)                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTPAKINS),((RF),PLOINF),(C'P',8)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT4AP04  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTPAKD,R3                                                        
         XR    R0,R0                                                            
         IC    R0,CTPAKLEN                                                      
         AHI   R0,-(CTPAKINS-CTPAKD)                                            
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTPAKINS),((RF),PLNINF),(C'P',8)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'4B' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT4BELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     REPORT SHORT DESCRIPTION                     
         BE    CT4BE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT4BE02  MVCDD PLNHDR,CT#DESC,L    REPORT SHORT DESCRIPTION                     
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTSDSTXT),CTSDSTXT-CTSDSD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTSDSTXT),CTSDSTXT-CTSDSD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'4C' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT4CELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     SHIPPING INSTRUCTIONS                        
         BE    CT4CE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT4CE02  MVC   PLNHDR,HSHPINS  *** SHIPPING INSTRUCTIONS                        
         LA    R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CT4CE08                                                          
         USING CTSHPD,R2                                                        
*                                                                               
         LA    R5,WORK                                                          
         XR    R0,R0                                                            
         TM    CTSHPINS,X'80'      ALPHANUMERIC SHIPPING                        
         BO    CT4CE04             NO                                           
*                                                                               
         CURED (B2,CTSHPINS),(5,WORK),0,ALIGN=LEFT,ZERO=NOBLANK                 
         CLI   CTSHPLEN,CTSHPINS-CTSHPD+2                                       
         BNH   CT4CE06                                                          
         AR    R5,R0               GO PAST NUMBER                               
*                                                                               
CT4CE04  XR    RF,RF                                                            
         IC    RF,CTSHPLEN                                                      
         AHI   RF,-(CTSHPINS-CTSHPD+1)                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R5),CTSHPINS                                                 
         AHI   RF,1                                                             
         AR    R0,RF               FULL FIELD LENGTH                            
*                                                                               
CT4CE06  LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLOINF),(C'P',8)                 
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CT4CE08  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTSHPD,R3                                                        
*                                                                               
         LA    R5,WORK                                                          
         XR    R0,R0                                                            
         TM    CTSHPINS,X'80'      ALPHANUMERIC SHIPPING                        
         BO    CT4CE10             NO                                           
*                                                                               
         CURED (B2,CTSHPINS),(5,WORK),0,ALIGN=LEFT,ZERO=NOBLANK                 
         CLI   CTSHPLEN,CTSHPINS-CTSHPD+2                                       
         BNH   CT4CE12                                                          
         AR    R5,R0               GO PAST NUMBER                               
*                                                                               
CT4CE10  XR    RF,RF                                                            
         IC    RF,CTSHPLEN                                                      
         AHI   RF,-(CTSHPINS-CTSHPD+1)                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R5),CTSHPINS                                                 
         AHI   RF,1                                                             
         AR    R0,RF               FULL FIELD LENGTH                            
*                                                                               
CT4CE12  LHI   RF,L'PLOINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLNINF),(C'P',8)                 
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'4D' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT4DELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     JCL EXCEPTION                                
         BE    CT4DE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT4DE02  MVC   PLNHDR,HJCLBK   *** JCL EXCEPTION                                
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTJCLEX),CTJCLEX-CTJCLD(R2)                             
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTJCLEX),CTJCLEX-CTJCLD(R3)                             
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'4E' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT4EELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     TEST PHASE                                   
         BE    CT4EE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT4EE02  MVC   PLNHDR,HTSTMSK  *** TEST PHASE                                   
         LTR   RF,R2                                                            
         BZ    *+12                                                             
         LA    R6,PLOINF                                                        
         BRAS  RE,DISTST                                                        
*                                                                               
         LTR   RF,R3                                                            
         BZ    *+12                                                             
         LA    R6,PLNINF                                                        
         BRAS  RE,DISTST                                                        
*                                                                               
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
*                                                                               
         USING CTPHSD,RF                                                        
DISTST   MVC   0(3,R6),=CL3'01='                                                
         MVC   3(1,R6),CTPHS01                                                  
         MVI   4(R6),C','                                                       
         AHI   R6,5                                                             
         MVC   0(3,R6),=CL3'02='                                                
         MVC   3(1,R6),CTPHS02                                                  
         MVI   4(R6),C','                                                       
         AHI   R6,5                                                             
         MVC   0(3,R6),=CL3'03='                                                
         MVI   4(R6),C','                                                       
         MVC   3(1,R6),CTPHS03                                                  
         AHI   R6,5                                                             
         MVC   0(3,R6),=CL3'04='                                                
         MVC   3(1,R6),CTPHS04                                                  
         BR    RE                                                               
         DROP  RF                                                               
         EJECT                                                                  
***********************************************************************         
* X'4F' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT4FELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     REPORT FORM CODE                             
         BE    CT4FE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT4FE02  MVC   PLNHDR,HFRMCD   *** REPORT FORM CODE                             
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTFRMCOD),CTFRMCOD-CTFRMD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTFRMCOD),CTFRMCOD-CTFRMD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'51' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT51ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,48         PROFILE                                      
         BE    CT51E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT51E02  BRAS  RE,PRFTYPE          OUTPUT PROFILE TYPE                          
         L     R4,FULL                                                          
         MVCDD PLNHDR,CT#CODE,L                                                 
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTARTCOD),CTARTCOD-CTARTD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTARTCOD),CTARTCOD-CTARTD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'52' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT52ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,48         PROFILE                                      
         BE    CT52E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT52E02  BRAS  RE,PRFTYPE          OUTPUT PROFILE TYPE                          
         L     R4,FULL                                                          
         MVCDD PLNHDR,CT#CODE,L                                                 
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTARCCOD),CTARCCOD-CTARCD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTARCCOD),CTARCCOD-CTARCD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* PROFILE FIELD - X'70' SINGLE ELEMENT OUTPUT ROUTINE                 *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(ELEMENT)                                          *         
***********************************************************************         
CT70ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     REPORT FORM CODE                             
         BE    CT70P02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
         USING CTFDD,R2                                                         
CT70P02  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#FLDN,L                                                 
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#DESC,L                                                 
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,GE#TYPE,L    FIELD TYPE                                   
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,GE#DDSO,L                                                 
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#DFALT,L                                                
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#VALUS,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CT70P08                                                          
         USING CTFDD,R2                                                         
         CURED CTFDNUM,(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    RF,RF               DESCRIPTION                                  
         IC    RF,CTFDLEN                                                       
         AHI   RF,-(CTFDDESC-CTFDD+1)                                           
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),CTFDDESC  (MAX 30)                                     
*                                                                               
         AHI   R4,L'PLINE          FIELD TYPE                                   
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         CLI   CTFDTYPE,C'C'                                                    
         BNE   *+10                                                             
         MVCDD PLNINF,CT#CHRS,L                                                 
         CLI   CTFDTYPE,C'H'                                                    
         BNE   *+10                                                             
         MVCDD PLNINF,CT#HEX,L                                                  
         CLI   CTFDTYPE,C'N'                                                    
         BNE   *+10                                                             
         MVCDD PLNINF,CT#NMRCL,L                                                
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         TM    CTFDOTHR,X'80'                                                   
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
*                                                                               
         TM    CTFDOTHR,X'40'      DEFAULT VALUE?                               
         BO    CT70P06             NO                                           
*                                                                               
         CLI   CTFDTYPE,C'C'                                                    
         BNE   *+14                                                             
         MVC   PLOINF(L'CTFDDEF),CTFDDEF                                        
         B     CT70P06                                                          
*                                                                               
         CLI   CTFDTYPE,C'N'                                                    
         BNE   CT70P04                                                          
         CURED CTFDDEF,(3,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         B     CT70P06                                                          
*                                                                               
CT70P04  GOTO1 VHEXOUT,DMCB,CTFDDEF,PLOINF,1,0                                  
*                                                                               
CT70P06  AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'CTFDLIST),CTFDLIST                                      
         B     EXITOK                                                           
         DROP  R2                                                               
*                                                                               
CT70P08  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTFDD,R2                                                         
         CURED CTFDNUM,(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    RF,RF               DESCRIPTION                                  
         IC    RF,CTFDLEN                                                       
         AHI   RF,-(CTFDDESC-CTFDD+1)                                           
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),CTFDDESC  (MAX 30)                                     
*                                                                               
         AHI   R4,L'PLINE          FIELD TYPE                                   
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         CLI   CTFDTYPE,C'C'                                                    
         BNE   *+10                                                             
         MVCDD PLNINF,CT#CHRS,L                                                 
         CLI   CTFDTYPE,C'H'                                                    
         BNE   *+10                                                             
         MVCDD PLNINF,CT#HEX,L                                                  
         CLI   CTFDTYPE,C'N'                                                    
         BNE   *+10                                                             
         MVCDD PLNINF,CT#NMRCL,L                                                
         AHI   R4,L'PLINE                                                       
*                                                                               
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         TM    CTFDOTHR,X'80'                                                   
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
*                                                                               
         TM    CTFDOTHR,X'40'      DEFAULT VALUE?                               
         BO    CT70P12             NO                                           
*                                                                               
         CLI   CTFDTYPE,C'C'                                                    
         BNE   *+14                                                             
         MVC   PLNINF(L'CTFDDEF),CTFDDEF                                        
         B     CT70P12                                                          
*                                                                               
         CLI   CTFDTYPE,C'N'                                                    
         BNE   CT70P10                                                          
         CURED CTFDDEF,(3,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                     
         B     CT70P12                                                          
*                                                                               
CT70P10  GOTO1 VHEXOUT,DMCB,CTFDDEF,PLNINF,1,0                                  
*                                                                               
CT70P12  AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'CTFDLIST),CTFDLIST                                      
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'72' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CT72ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,53         USER PROFILE                                 
         BE    CT72E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CT72E02  XC    FULL,FULL                                                        
         LTR   R2,R2               COPY RECORD?                                 
         BZ    CT72E04             NO                                           
         GOTO1 CT72DIS,PLIST,(1,(R2)),PLOINF,(R4)                               
         ST    R0,FULL                                                          
*                                                                               
CT72E04  LTR   R3,R3               CHANGE RECORD?                               
         BZ    EXITOK              NO                                           
         GOTO1 CT72DIS,PLIST,(0,(R3)),PLNINF,(R4)                               
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CT72DIS  NTR1  ,                   DISPLAY ROUTINE                              
         LM    R2,R4,0(R1)                                                      
         USING CTPVD,R2            CURRENT ELEMENT                              
         USING PRFLINED,R3         OUTPUT AREA FOR ELEMENT                      
         USING PLINED,R4           PRINT LINE                                   
*                                                                               
         MVI   CTFLAG,0            SET NOT RHS                                  
         CLI   0(R1),0                                                          
         BE    *+10                                                             
         MVC   CTFLAG,MODE         SET RHS AND SAVE MODE                        
*                                                                               
         CLI   LSTSRT,SRTSDDS                                                   
         BNE   CT72D02             DISPLAY PAGE ONLY IF DDS REPORT              
         MVCDD PLNHDR,CT#PAGE,L                                                 
         CURED CTPVPAGE,(3,PRFLINED),0,ALIGN=LEFT,ZERO=NOBLANK                  
         AHI   R3,L'PLINE                                                       
         AHI   R4,L'PLINE                                                       
*                                                                               
CT72D02  L     R5,AIOSORT          GET A(CHANGE/ADD RECORD)                     
         AHI   R5,RCVFRST-RECDS                                                 
R        USING CTUREC,R5                                                        
         LA    R6,KEY              GET HEADER RECORD IN TEMP IO AREA            
         USING CTUREC,R6                                                        
         XC    CTUKEY,CTUKEY                                                    
         MVI   CTUKTYP,CTUKTYPQ                                                 
         MVC   CTUKSYS,R.CTUKSYS                                                
         MVC   CTUKPROG,R.CTUKPROG                                              
         MVC   CTUKLANG,DDPLANG                                                 
         GOTO1 VDMGR,DMCB,(X'08',DMREAD),CTFILE,KEY,AIOTEMP                     
         CLI   8(R1),0                                                          
         BE    CT72D04             RECORD FOUND OK                              
         MVI   CTUKLANG,0                                                       
         GOTO1 VDMGR,DMCB,(X'08',DMREAD),CTFILE,KEY,AIOTEMP                     
         CLI   8(R1),0                                                          
         BE    CT72D04             RECORD FOUND OK                              
*                                                                               
         MVC   PRFLINED(30),=CL30'Header record not on file'                    
         AHI   R4,L'PLINE                                                       
         AHI   R3,L'PLINE                                                       
         B     CT72DHEX                                                         
*                                                                               
CT72D04  L     R6,AIOTEMP          HEADER RECORD IS IN TEMP IO AREA             
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'70',(R6)),0,0,0,0                  
         CLI   12(R1),0                                                         
         BE    CT72D10             ELEMENTS FOUND                               
*                                                                               
         MVC   PRFLINED(30),=CL30'No 70 elements in header record'              
         AHI   R4,L'PLINE                                                       
         AHI   R3,L'PLINE                                                       
         B     CT72DHEX                                                         
*                                                                               
CT72D10  L     R6,12(R1)                                                        
         USING CTFDD,R6                                                         
*                                                                               
         CLI   CTFLAG,MODECHG                                                   
         BE    CT72D12                                                          
         MVCDD PRFNUM,CT#NUMB,L2   PUT OUT FULL HEADERS                         
         MVCDD PRFDESC,CT#DESC,L                                                
         MVCDD PRFVAL,CT#VALUE,L3                                               
         AHI   R3,L'PLINE                                                       
         AHI   R4,L'PLINE                                                       
         MVCDD PRFNUM,CT#NUMB,L2U                                               
         MVCDD PRFDESC,CT#DESC,LU                                               
         MVCDD PRFVAL,CT#VALUE,L3U                                              
         AHI   R3,L'PLINE                                                       
         AHI   R4,L'PLINE                                                       
         B     CT72D14                                                          
CT72D12  MVCDD PRFVALC,CT#VALUE,L3 PUT OUT JUST VALUE HEADER                    
         AHI   R3,L'PLINE                                                       
         AHI   R4,L'PLINE                                                       
         MVCDD PRFVALC,CT#VALUE,L3U                                             
         AHI   R3,L'PLINE                                                       
         AHI   R4,L'PLINE                                                       
*                                                                               
CT72D14  CLI   CTFDEL,CTFDELQ      PROFILE ELEMENT?                             
         BE    CT72D20                                                          
         CLI   CTFDEL,0            END OF RECORD?                               
         BNE   CT72D16                                                          
         LR    R0,R4                                                            
         XIT1  REGS=(R0)           RETURN HIGH WATER                            
*                                                                               
CT72D16  XR    RF,RF               NEXT ELEMENT                                 
         IC    RF,CTFDLEN                                                       
         BXH   R6,RF,CT72D14                                                    
*                                                                               
CT72D20  CLI   CTFLAG,MODECHG                                                   
         BE    CT72D22                                                          
*                                                                               
         CURED CTFDNUM,(2,PRFNUM),0,ALIGN=LEFT,ZERO=NOBLANK                     
*                                                                               
         XR    RF,RF                                                            
         IC    RF,CTFDLEN                                                       
         AHI   RF,-(CTFDDESC-CTFDD+1)                                           
         CHI   RF,L'PRFDESC-1      ONLY THAT WHICH FITS                         
         BL    *+8                                                              
         LHI   RF,L'PRFDESC-1                                                   
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PRFDESC(0),CTFDDESC                                              
*                                                                               
CT72D22  XR    RF,RF                                                            
         IC    RF,CTFDNUM                                                       
         BCTR  RF,0                                                             
         LA    RF,CTPVALUE(RF)                                                  
*                                                                               
         CLI   CTFDTYPE,C'C'       DATA IS CHARACTER?                           
         BNE   CT72D24             NO                                           
         MVC   PRFVAL(1),0(RF)                                                  
         B     CT72D28                                                          
*                                                                               
CT72D24  CLI   CTFDTYPE,C'N'       DATA IS NUMERIC?                             
         BNE   CT72D26             NO                                           
         CURED (B1,0(RF)),(3,PRFVAL),0,ALIGN=LEFT,ZERO=NOBLANK                  
         B     CT72D28                                                          
*                                                                               
CT72D26  GOTO1 VHEXOUT,DMCB,0(RF),PRFVAL,1,0                                    
*                                                                               
CT72D28  XR    RF,RF                                                            
         IC    RF,CTFDNUM                                                       
         LHI   R0,1                                                             
         SLL   R0,16                                                            
         SRL   R0,0(RF)            R0 = BIT MASK                                
         XR    R1,R1                                                            
         ICM   R1,3,CTPVSTAT                                                    
         NR    R1,R0                                                            
         BZ    *+8                                                              
         MVI   PRFOVR,C'*'         NO OVERRIDE FLAG                             
*                                                                               
         CLI   CTFLAG,MODECHG                                                   
         BNE   CT72D30                                                          
         MVC   PRFVALC,PRFVAL                                                   
         MVC   PRFOVRC,PRFOVR                                                   
         MVC   PRFVAL,SPACES                                                    
         MVC   PRFOVR,SPACES                                                    
         B     CT72D32                                                          
*                                                                               
CT72D30  CLI   MODE,MODECHG        IF DOING NEW, AND CHANGE                     
         BNE   CT72D32             FLAG CHANGES                                 
         CLC   PRFVAL,PLOINF+PRFVALC-PRFLINED                                   
         BE    *+10                                                             
         MVC   PLNHDR+L'PLNHDR-4(3),=C'-->'                                     
*                                                                               
CT72D32  AHI   R3,L'PLINE                                                       
         AHI   R4,L'PLINE                                                       
         B     CT72D16                                                          
*                                                                               
CT72DHEX XR    R0,R0               DEFAULT ERROR HANDLING - HEXOUT              
         IC    R0,1(R2)                                                         
         GOTO1 VHEXOUT,DMCB,(R2),WORK,(R0),0                                    
*                                                                               
         XR    R0,R0                                                            
         IC    R0,1(R2)                                                         
         SLL   R0,1                R0 = LENGTH OF DATA TO OUTPUT                
         LHI   RF,L'PLOINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),(R3)),(C'P',10)                  
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         XIT1  REGS=(R0)           RETURN HIGH WATER                            
*                                                                               
PRFLINED DSECT                                                                  
PRFNUM   DS    CL2                                                              
         DS    C                                                                
PRFDESC  DS    CL35                                                             
         DS    C                                                                
PRFVAL   DS    CL3                                                              
PRFOVR   DS    C                                                                
         ORG   PRFNUM                                                           
PRFVALC  DS    CL3                                                              
PRFOVRC  DS    C                                                                
*                                                                               
SECDFA   CSECT                                                                  
         DROP  R2,R4,R                                                          
         EJECT                                                                  
***********************************************************************         
* X'A4' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTA4ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,55         LIST                                         
         BE    CTA4E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTA4E02  MVCDD PLNHDR,GE#LSTDA,L                                                
         XC    FULL,FULL                                                        
         LTR   R2,R2                                                            
         USING CTLSTD,R2                                                        
         BZ    CTA4E04                                                          
         TM    CTLSTIND,X'80'                                                   
         BZ    *+14                                                             
         MVC   PLOINF(5),=CL5'No-Op'                                            
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTLSTLEN                                                      
         AHI   R0,-(CTLSTDTA-CTLSTD)                                            
         AHI   R0,-(2)                                                          
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTLSTDTA),((RF),PLOINF),(C'P',3)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CTA4E04  LTR   R3,R3                                                            
         USING CTLSTD,R3                                                        
         BZ    EXITOK                                                           
         TM    CTLSTIND,X'80'                                                   
         BZ    *+14                                                             
         MVC   PLNINF(5),=CL5'No-Op'                                            
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTLSTLEN                                                      
         AHI   R0,-(CTLSTDTA-CTLSTD)                                            
         AHI   R0,-(2)                                                          
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTLSTDTA),((RF),PLNINF),(C'P',3)             
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'A5' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTA5ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,55         LIST INCLUDE                                 
         BE    CTA5E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTA5E02  MVC   PLNHDR,HINCLUDE                                                  
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'CTLINC),CTLINC-CTLIND(R2)                               
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'CTLINC),CTLINC-CTLIND(R3)                               
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'B6' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTB6ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     ASSOCIATED AGENCY                            
         BE    CTB6P02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTB6P02  MVC   PLNHDR,HASSAGY  *** ASSOCIATED AGENCY                            
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CTB6P04                                                          
         BRAS  RE,DISAAGYS                                                      
*                                                                               
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLNINF),(C'P',3)                 
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
*                                                                               
CTB6P04  LTR   R3,R2               <== LOOK                                     
         BZ    EXITOK                                                           
         BRAS  RE,DISAAGYS                                                      
*                                                                               
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLNINF),(C'P',3)                 
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
*                                                                               
HASSAGY  DC    CL16'Associated Agys'                                            
*                                                                               
         USING CTAGLD,R2                                                        
DISAAGYS NTR1  ,                                                                
         LA    RF,WORK                                                          
*                                                                               
         XR    R0,R0               PICK UP ASSOCIATED AGENCIES                  
         IC    R0,CTAGLLEN                                                      
         AHI   R0,-(CTAGLAID-CTAGLD)                                            
         LA    RE,CTAGLAID                                                      
*                                                                               
DISAA02  MVC   0(2,RF),0(RE)       COPY IN AGENCY ID                            
         AHI   R0,-2                                                            
         BNP   DISAA04                                                          
         MVI   2(RF),C','                                                       
         AHI   RF,3                                                             
         AHI   RE,2                                                             
         B     DISAA02                                                          
*                                                                               
DISAA04  BCTR  RF,0                                                             
         CLI   0(RF),C','                                                       
         BNE   *+8                                                              
         MVI   0(RF),C' '                                                       
         LA    R0,WORK                                                          
         SR    RF,R0                                                            
         LR    R0,RF                                                            
         XIT1  REGS=(R0)                                                        
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
* X'B7' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTB7ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,70         LOCKET ENTRY                                 
         BE    CTB7P02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTB7P02  LR    R5,R4           *** LOCKET ENTRY                                 
         MVC   PLNHDR,HVTAML       VTAM LUID                                    
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HREQTIME                                                  
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,HCMPTIME                                                  
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CTB7P04                                                          
         USING CTLKLD,R2                                                        
         MVC   PLOINF(L'CTLKLUID),CTLKLUID                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         ICM   R0,7,CTLKLT1                                                     
         SLL   R0,4                                                             
         O     R0,=X'0000000C'                                                  
         ST    R0,FULL                                                          
         CURED (P4,FULL),(8,DUB),0,ZERO=NOBLANK                                 
         LA    R6,PLOINF                                                        
         MVC   0(2,R6),DUB+2                                                    
         MVC   3(2,R6),DUB+4                                                    
         MVC   6(2,R6),DUB+6                                                    
         MVI   2(R6),C':'                                                       
         MVI   5(R6),C':'                                                       
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         ICM   R0,7,CTLKLT2                                                     
         BZ    CTB7P04                                                          
         SLL   R0,4                                                             
         O     R0,=X'0000000C'                                                  
         ST    R0,FULL                                                          
         CURED (P4,FULL),(8,DUB),0,ZERO=NOBLANK                                 
         LA    R6,PLOINF           COMPLETED TIME                               
         MVC   0(2,R6),DUB+2                                                    
         MVC   3(2,R6),DUB+4                                                    
         MVC   6(2,R6),DUB+6                                                    
         MVI   2(R6),C':'                                                       
         MVI   5(R6),C':'                                                       
         DROP  R2                                                               
*                                                                               
CTB7P04  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING CTLKLD,R3                                                        
         MVC   PLNINF(L'CTLKLUID),CTLKLUID                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         ICM   R0,7,CTLKLT1                                                     
         SLL   R0,4                                                             
         O     R0,=X'0000000C'                                                  
         ST    R0,FULL                                                          
         CURED (P4,FULL),(8,DUB),0,ZERO=NOBLANK                                 
         LA    R6,PLNINF                                                        
         MVC   0(2,R6),DUB+2                                                    
         MVC   3(2,R6),DUB+4                                                    
         MVC   6(2,R6),DUB+6                                                    
         MVI   2(R6),C':'                                                       
         MVI   5(R6),C':'                                                       
         AHI   R4,L'PLINE                                                       
*                                                                               
         XR    R0,R0                                                            
         ICM   R0,7,CTLKLT2                                                     
         BZ    EXITOK                                                           
         SLL   R0,4                                                             
         O     R0,=X'0000000C'                                                  
         ST    R0,FULL                                                          
         CURED (P4,FULL),(8,DUB),0,ZERO=NOBLANK                                 
         LA    R6,PLNINF           COMPLETED TIME                               
         MVC   0(2,R6),DUB+2                                                    
         MVC   3(2,R6),DUB+4                                                    
         MVC   6(2,R6),DUB+6                                                    
         MVI   2(R6),C':'                                                       
         MVI   5(R6),C':'                                                       
         B     EXITOK                                                           
         DROP  R3,R4                                                            
*                                                                               
HCMPTIME DC    CL16'Completion Time'                                            
         EJECT                                                                  
***********************************************************************         
* X'B8' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTB8ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,28         ACTION                                       
         BE    CTB8E10                                                          
         CLI   ADFTYPE,CTFILEQ     SEC AGY ALPHA ID                             
         BE    CTB8E04                                                          
*                                                                               
CTB8E02  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
*                                                                               
CTB8E04  MVC   PLNHDR,LC@AGYAL     SEC AGY ALPHA ID                             
         LTR   R2,R2                                                            
         BZ    CTB8E06                                                          
         USING CTSEAD,R2                                                        
         MVC   HALF,CTSEAAID       OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLOINF(22),SPROUT                                                
         DROP  R2                                                               
*                                                                               
CTB8E06  LTR   R3,R3                                                            
         BZ    CTB8E08                                                          
         USING CTSEAD,R3                                                        
         MVC   HALF,CTSEAAID       OUTPUT AGENCY NAME                           
         BRAS  RE,DISAGYAL                                                      
         MVC   PLNINF(22),SPROUT                                                
*                                                                               
CTB8E08  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CTB8E10  MVCDD PLNHDR,CT#DESC,L                                                 
         LA    R0,L'PLINE(R4)                                                   
         ST    R0,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CTB8E12                                                          
         USING SAACTD,R2                                                        
*                                                                               
         L     RF,AIOSORT          GET A(CHANGE/ADD RECORD)                     
         AHI   RF,RCVFRST-RECDS                                                 
         USING SAACREC,RF                                                       
         XR    R0,R0                                                            
         IC    R0,SAACOVS                                                       
         DROP  RF                                                               
*                                                                               
         AHI   R0,X'80'                                                         
         GOTO1 ADISTXT,PLIST,((R0),SAACTDSC),SAACTWRD                           
         MVC   PLOINF,WORK         ACTION DESCRIPTION                           
         DROP  R2                                                               
*                                                                               
CTB8E12  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING SAACTD,R3                                                        
*                                                                               
         L     RF,AIOSORT          GET A(CHANGE/ADD RECORD)                     
         AHI   RF,RCVFRST-RECDS                                                 
         USING SAACREC,RF                                                       
         XR    R0,R0                                                            
         IC    R0,SAACOVS                                                       
         DROP  RF                                                               
*                                                                               
         AHI   R0,X'80'                                                         
         GOTO1 ADISTXT,PLIST,((R0),SAACTDSC),SAACTWRD                           
         MVC   PLNINF,WORK         ACTION DESCRIPTION                           
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'BA' ELEMENT PAIR HANDLER                                          *         
***********************************************************************         
CTBAPAIR NTR1  BASE=*,LABEL=*                                                   
         L     R6,AELMNTRY                                                      
         USING CTELEMD,R6                                                       
         LM    R2,R3,0(R1)                                                      
         LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,32         ACCESS                                       
         BE    CTBAP04                                                          
         BRAS  RE,DEFPAIR                                                       
         B     EXITOK                                                           
*                                                                               
CTBAP04  LHI   R0,L'ELNAMEC        CHOP UP ELEMENT NAME FOR DISPLAY             
         LHI   RF,L'PLELEM                                                      
         GOTO1 VCHOPPER,DMCB,((R0),ELNAMEC),((RF),PLELEM),(C'P',3)              
         DROP  R6                                                               
*                                                                               
CTBAP06  CLC   0(4,R2),EFFS        DONE WITH COPIES?                            
         BE    CTBAP14             YES                                          
         L     R6,0(R2)                                                         
CPY      USING SAMIXD,R6                                                        
*                                                                               
         LR    RF,R3               SEE IF MATCHING RECORD FOR CHANGE            
CTBAP08  CLC   0(4,RF),EFFS                                                     
         BE    CTBAP10             NO MATCHING SYSTEM                           
         ICM   R7,15,0(RF)                                                      
         BZ    CTBAP09             RECORD ALREADY RESOLVED                      
CHG      USING SAMIXD,R7                                                        
*                                                                               
         CLC   CPY.SAMIXRCD(2),CHG.SAMIXRCD                                     
         BE    *+12                                                             
CTBAP09  AHI   RF,4                                                             
         B     CTBAP08                                                          
*                                                                               
         XC    0(4,RF),0(RF)       CLEAR RESOLVED COPY                          
         LR    R0,R1                                                            
         GOTO1 CTBAELM,PLIST,CPY.SAMIXD,CHG.SAMIXD,(R4)                         
         B     CTBAP12                                                          
*                                                                               
CTBAP10  GOTO1 CTBAELM,PLIST,CPY.SAMIXD,0,(R4)                                  
*                                                                               
CTBAP12  BRAS  RE,PRNT             PRINT LINES                                  
         AHI   R2,4                NEXT COPY IN LIST                            
         B     CTBAP06                                                          
         DROP  CPY,CHG                                                          
*                                                                               
CTBAP14  CLC   0(4,R3),EFFS        FINISHED WITH CHANGES?                       
         BE    CTBAP18             YES                                          
*                                                                               
         ICM   R6,15,0(R3)                                                      
         BZ    CTBAP16             THIS CHANGE DISPLAYED AS A PAIR              
         GOTO1 CTBAELM,PLIST,0,(R6),(R4)                                        
         BRAS  RE,PRNT             PRINT LINES                                  
*                                                                               
CTBAP16  AHI   R3,4                NEXT CHANGE                                  
         B     CTBAP14                                                          
*                                                                               
CTBAP18  B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'BA' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTBAELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,32         ACCESS                                       
         BE    CTBAE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTBAE02  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#REC,L     DEFAULT RECORD / ACTION TITLES               
         AHI   R4,L'PLINE                                                       
         MVC   PLNHDR,LC@ACT                                                    
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         L     R6,AIOSORT          GET PROGRAM RECORD DETAILS                   
         USING RECDS,R6                                                         
         USING SAASREC,RCVFRST                                                  
         MVC   HALF,SAASOVS                                                     
         DROP  R6                                                               
         BRAS  RE,GETPGEL                                                       
*                                                                               
         PUSH  USING                                                            
         USING SADICD,SVDICEL                                                   
         LR    R4,R5                                                            
         OC    SADICARC,SADICARC                                                
         BZ    CTBAE02A                                                         
         MVI   PLNHDR,CT#ESCL                                                   
         MVC   PLNHDR+1(2),SADICARC    MOVE IN DD REF FOR 'RECORD'              
         MVI   PLNHDR+3,L'PLNHDR                                                
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),PLNHDR,0                                      
CTBAE02A AHI   R4,L'PLINE                                                       
         OC    SADICAAC,SADICAAC                                                
         BZ    CTBAE03                                                          
         MVI   PLNHDR,CT#ESCL                                                   
         MVC   PLNHDR+1(2),SADICAAC    MOVE IN DD REF FOR 'ACTION'              
         MVI   PLNHDR+3,L'PLNHDR                                                
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),PLNHDR,0                                      
         POP   USING                                                            
*                                                                               
CTBAE03  BRAS  RE,BLDATAB          GET ACTION TABLE                             
*                                                                               
CTBAE04  LTR   R2,R2                                                            
         BZ    CTBAE12                                                          
         USING SAMIXD,R2                                                        
*                                                                               
         LR    R4,R5                                                            
         XC    BITTAB,BITTAB                                                    
         XR    RF,RF                                                            
         IC    RF,SAMIXLN                                                       
         AHI   RF,-(SAMIXLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   BITTAB(0),SAMIXACT                                               
*                                                                               
         STCM  R2,15,WORK                                                       
         BRAS  RE,GETRCDD                                                       
         MVC   PLOINF,WORK                                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         L     R0,AIOTEMP          CLEAR PBLOCK TO SPACES                       
         LHI   R1,IOL                                                           
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
*                                                                               
         L     R7,AIOTEMP          NOW WE FILL BUFFER WITH DATA                 
*                                                                               
         L     R6,AATAB                                                         
         USING ATABD,R6                                                         
CTBAE06  CLI   0(R6),X'FF'                                                      
         BE    CTBAE10                                                          
*                                                                               
         XR    RE,RE                                                            
         IC    RE,ATSEQ                                                         
         SRDL  RE,3                                                             
         LA    RE,BITTAB(RE)                                                    
         SRL   RF,32-3                                                          
         LHI   R1,X'80'                                                         
         SRL   R1,0(RF)            R0 = BITMASK                                 
         EX    R1,CTBATM                                                        
         BZ    CTBAE08                                                          
*                                                                               
         MVCDD 0(8,R7),CT#UNKNW,L                                               
         OC    ATWRD,ATWRD                                                      
         BZ    *+10                                                             
         MVC   1(2,R7),ATWRD       MOVE IN DD REF FOR ACTION                    
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),0(R7),0                                       
*                                                                               
         LA    R7,8(R7)                                                         
         CLI   0(R7),C' '                                                       
         BH    *+8                                                              
         BCT   R7,*-8                                                           
         MVI   1(R7),C','                                                       
         AHI   R7,3                                                             
*                                                                               
CTBAE08  AHI   R6,ATABL                                                         
         B     CTBAE06                                                          
         DROP  R2                                                               
*                                                                               
CTBAE10  LR    R0,R7                                                            
         L     R1,AIOTEMP                                                       
         SR    R0,R1                                                            
         AHI   R0,-2               FOR THE ', '                                 
         BP    *+14                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         B     CTBAE12                                                          
*                                                                               
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,PLIST,AIOTEMP,((RF),PLOINF),(C'P',25),         +        
               C'LEN=',(R0)                                                     
         ICM   R0,15,8(R1)         GET USED LINES                               
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL          SET HIGH POINT                               
         BL    *+8                                                              
         ST    R0,FULL                                                          
*                                                                               
CTBAE12  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING SAMIXD,R3                                                        
*                                                                               
         LR    R4,R5                                                            
         XC    BITTAB,BITTAB                                                    
         XR    RF,RF                                                            
         IC    RF,SAMIXLN                                                       
         AHI   RF,-(SAMIXLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   BITTAB(0),SAMIXACT                                               
*                                                                               
         STCM  R3,15,WORK                                                       
         BRAS  RE,GETRCDD                                                       
         MVC   PLNINF,WORK                                                      
         AHI   R4,L'PLINE                                                       
*                                                                               
         L     R0,AIOTEMP          CLEAR PBLOCK TO SPACES                       
         LHI   R1,IOL                                                           
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
*                                                                               
         L     R7,AIOTEMP          NOW WE FILL BUFFER WITH DATA                 
*                                                                               
         L     R6,AATAB                                                         
         USING ATABD,R6                                                         
CTBAE14  CLI   0(R6),X'FF'                                                      
         BE    CTBAE18                                                          
*                                                                               
         XR    RE,RE                                                            
         IC    RE,ATSEQ                                                         
         SRDL  RE,3                                                             
         LA    RE,BITTAB(RE)                                                    
         SRL   RF,32-3                                                          
         LHI   R1,X'80'                                                         
         SRL   R1,0(RF)            R0 = BITMASK                                 
         EX    R1,CTBATM                                                        
         BZ    CTBAE16                                                          
*                                                                               
         MVCDD 0(8,R7),CT#UNKNW,L                                               
         OC    ATWRD,ATWRD                                                      
         BZ    *+10                                                             
         MVC   1(2,R7),ATWRD       MOVE IN DD REF FOR ACTION                    
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),0(R7),0                                       
*                                                                               
         LA    R7,8(R7)                                                         
         CLI   0(R7),C' '                                                       
         BH    *+8                                                              
         BCT   R7,*-8                                                           
         MVI   1(R7),C','                                                       
         AHI   R7,3                                                             
*                                                                               
CTBAE16  AHI   R6,ATABL                                                         
         B     CTBAE14                                                          
         DROP  R3                                                               
*                                                                               
CTBAE18  LR    R0,R7                                                            
         L     R1,AIOTEMP                                                       
         SR    R0,R1                                                            
         AHI   R0,-2               FOR THE ', '                                 
         BP    *+14                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         B     EXITOK                                                           
*                                                                               
         LHI   RF,L'PLNINF         EITHER USE HALF OR ALL BLOCK                 
         CLI   MODE,MODECHG        DEPENDING ON WHETHER COPY EXISTS             
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,PLIST,AIOTEMP,((RF),PLNINF),(C'P',25),         +        
               C'LEN=',(R0)                                                     
*                                                                               
         ICM   R0,15,8(R1)         FIND WHICH ELEMENT USED MORE LINES           
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
*                                                                               
CTBATM   TM    0(RE),0                                                          
         EJECT                                                                  
***********************************************************************         
* GET DD REFERENCE FOR RECORD TYPE                                    *         
* NTRY   WORK(4) = A(X'BA' ELEMENT)                                   *         
* EXIT   WORK(4) = DD REFERENCE                                       *         
***********************************************************************         
GETRCDD  NTR1  BASE=*,LABEL=*                                                   
         ICM   R2,15,WORK                                                       
         USING SAMIXD,R2                                                        
         MVC   WORK(132),SPACES                                                 
*                                                                               
         LA    R3,KEY                                                           
         USING SARCREC,R3                                                       
         XC    SARCKEY,SARCKEY                                                  
         MVI   SARCTYP,SARCTYPQ                                                 
         MVI   SARCSUB,SARCSUBQ                                                 
         MVC   SARCOVPG,SVOVPG                                                  
         MVC   SARCRCD,SAMIXRCD    SET RECORD NUMBER                            
*                                                                               
         L     R3,AIOTEMP                                                       
         MVC   SARCKEY,KEY                                                      
         BRAS  RE,CTREAD                                                        
         BNE   GRCDD02                                                          
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B9',SARCREC),0,0,0,0               
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GRCDD02                                                          
         ICM   RF,15,12(R1)                                                     
         USING SARCDD,RF                                                        
*                                                                               
         MVI   WORK+0,CT#ESCL      OUTPUT NAME                                  
         MVC   WORK+1(2),SARCDWRD                                               
         MVI   WORK+3,8                                                         
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),WORK,0                                        
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
GRCDD02  MVC   WORK(12),LC@UNKNW                                                
         GOTO1 VHEXOUT,DMCB,KEY+SARCOVPG-SARCREC,WORK+12,3,0                    
         B     EXITL                                                            
         DROP  R2,R3,R6                                                         
         EJECT                                                                  
***********************************************************************         
* READ PROGRAM RECORD TO EXTRACT ACTION CODE LIST AND DICT# ELEMENT   *         
* NTRY   HALF = OVSYS/PRG                                             *         
***********************************************************************         
GETPGEL  NTR1  BASE=*,LABEL=*                                                   
         CLC   SVOVPG,HALF         HAVE WE ALREADY GOT IT                       
         BE    EXITOK              YES                                          
         MVC   SVOVPG,HALF                                                      
         XC    SVPGMEL,SVPGMEL                                                  
         XC    SVDICEL,SVDICEL                                                  
*                                                                               
         L     R3,AIOTEMP                                                       
         USING SAPGREC,R3                                                       
         XC    SAPGKEY,SAPGKEY                                                  
         MVI   SAPGTYP,SAPGTYPQ                                                 
         MVI   SAPGSUB,SAPGSUBQ                                                 
         MVC   SAPGOVPG,SVOVPG                                                  
         BRAS  RE,CTREAD                                                        
         BNE   EXITOK              SOMEBODY MAY HAVE DELETED IT                 
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B7',SAPGREC),0,0,0,0               
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GPGEL02             NO                                           
*                                                                               
         L     RF,12(R1)                                                        
         XR    R1,R1                                                            
         IC    R1,1(RF)                                                         
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   SVPGMEL(0),0(RF)   SAVE PROGRAM ELEMENT                          
*                                                                               
GPGEL02  GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'D3',SAPGREC),0,0,0,0               
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   EXITOK              NO                                           
*                                                                               
         L     RF,12(R1)                                                        
         XR    R1,R1                                                            
         IC    R1,1(RF)                                                         
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   SVDICEL(0),0(RF)   SAVE PROGRAM ELEMENT                          
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* BUILD LIST OF VALID ACTIONS FOR THIS BA ELEMENT                     *         
* NTRY: SVOVPG SET                                                    *         
* EXIT: ATAB BUILT                                                    *         
***********************************************************************         
         PUSH  USING                                                            
         USING SAPGMD,SVPGMEL                                                   
BLDATAB  NTR1  BASE=*,LABEL=*                                                   
         LA    R2,KEY                                                           
         USING SAACREC,R2          R2=A(ACTION RECORD KEY)                      
         XC    SAACKEY,SAACKEY                                                  
         MVI   SAACTYP,SAACTYPQ                                                 
         MVI   SAACSUB,SAACSUBQ                                                 
         MVC   SAACOVPG,SVOVPG                                                  
*                                                                               
         L     R2,AIOTEMP                                                       
         MVC   SAACKEY,KEY         SET START                                    
         L     R3,AATAB                                                         
         USING ATABD,R3            R3=A(ACTION TABLE)                           
*                                                                               
         GOTO1 VDMGR,DMCB,(X'08',DMRDHI),CTFILE,(R2),(R2)                       
         B     BATAB04                                                          
*                                                                               
BATAB02  GOTO1 VDMGR,DMCB,(X'08',DMRSEQ),CTFILE,(R2),(R2)                       
*                                                                               
BATAB04  CLC   SAACREC(SAACACT-SAACREC),KEY                                     
         BNE   BATAB12                                                          
*                                                                               
         LA    RF,SAPGMACT         SEARCH ACTION CODE LIST FOR CODE             
         LR    R1,RF                                                            
         LA    R0,L'SAPGMACT                                                    
BATAB06  CLC   SAACACT,0(RF)                                                    
         BE    BATAB08                                                          
         LA    RF,1(RF)                                                         
         BCT   R0,BATAB06                                                       
         B     BATAB02             IGNORE RECORD IF NOT IN LIST                 
*                                                                               
BATAB08  SR    RF,R1                                                            
         STC   RF,ATSEQ            SAVE SEQUENCE NUMBER                         
         XC    ATWRD(L'ATWRD+L'ATDSC),ATWRD                                     
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B8',SAACREC),0,0,0,0               
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   BATAB10                                                          
*                                                                               
         L     RF,12(R1)                                                        
         MVC   ATWRD,SAACTWRD-SAACTD(RF)                                        
         MVC   ATDSC,SAACTDSC-SAACTD(RF)                                        
*                                                                               
BATAB10  AHI   R3,ATABL                                                         
         B     BATAB02                                                          
*                                                                               
BATAB12  MVI   ATABD,255           SET E-O-T                                    
         B     EXITOK                                                           
         POP   USING                                                            
         EJECT                                                                  
***********************************************************************         
* X'BB' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTBBELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADFTYPE,CTFILEQ     SEC AGY ALPHA ID                             
         BE    CTBBE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTBBE02  MVC   PLNHDR,HTIMEOUT                                                  
         LTR   R2,R2                                                            
         BZ    CTBBE04                                                          
         USING CTTOUD,R2                                                        
         CURED CTTOUADV,(5,PLOINF),0,ZERO=NOBLANK,ALIGN=LEFT                    
         LA    R5,PLOINF+1                                                      
         AR    R5,R0                                                            
         MVC   0(8,R5),=CL8'Minutes'                                            
         DROP  R2                                                               
*                                                                               
CTBBE04  LTR   R3,R3                                                            
         BZ    CTBBE06                                                          
         USING CTTOUD,R3                                                        
         CURED CTTOUADV,(5,PLNINF),0,ZERO=NOBLANK,ALIGN=LEFT                    
         LA    R5,PLNINF+1                                                      
         AR    R5,R0                                                            
         MVC   0(8,R5),=CL8'Minutes'                                            
         DROP  R3                                                               
*                                                                               
CTBBE06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
*                                                                               
HTIMEOUT DC    CL16'ADV Timeout'                                                
         EJECT                                                                  
***********************************************************************         
* X'BD' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTBDELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,33         FCON                                         
         BE    CTBDE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTBDE02  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#WRITE,L   DEFAULT FIELD TITLE                          
         CLI   THISELM,X'BD'       TEST BD OR BE                                
         BE    *+10                                                             
         MVCDD PLNHDR,CT#READ,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         L     R6,AIOSORT          GET PROGRAM RECORD DETAILS                   
         USING RECDS,R6                                                         
         USING SAASREC,RCVFRST                                                  
         MVC   HALF,SAASOVS                                                     
         DROP  R6                                                               
         BRAS  RE,GETPGEL                                                       
*                                                                               
         PUSH  USING                                                            
         USING SADICD,SVDICEL                                                   
         LR    R4,R5                                                            
         XR    R1,R1                                                            
         ICM   R1,3,SADICFWR           DD REF FOR 'WRITE'                       
         CLI   THISELM,X'BD'           TEST BD OR BE                            
         BE    *+8                                                              
         ICM   R1,3,SADICFRD           DD REF FOR 'READ'                        
         LTR   R1,R1                   IS THERE AN OVERRIDE                     
         BZ    CTBDE03                 NO, LEAVE DEFAULTS                       
         MVI   PLNHDR,CT#ESCL                                                   
         STCM  R1,3,PLNHDR+1           MOVE IN DD REF                           
         MVI   PLNHDR+3,L'PLNHDR                                                
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),PLNHDR,0                                      
         POP   USING                                                            
*                                                                               
CTBDE03  BRAS  RE,BLDFTAB          GET FIELD TABLE                              
*                                                                               
CTBDE04  LTR   R2,R2                                                            
         BZ    CTBDE12                                                          
         USING SAFCWD,R2                                                        
*                                                                               
         LR    R4,R5                                                            
         XC    BITTAB,BITTAB                                                    
         XR    RF,RF                                                            
         IC    RF,SAFCWLN                                                       
         AHI   RF,-(SAFCWLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   BITTAB(0),SAFCWTAB                                               
*                                                                               
         L     R0,AIOTEMP          CLEAR PBLOCK TO SPACES                       
         LHI   R1,IOL                                                           
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
*                                                                               
         L     R7,AIOTEMP          NOW WE FILL BUFFER WITH DATA                 
                                                                                
         L     R6,AATAB                                                         
         USING ATABD,R6                                                         
CTBDE06  CLI   0(R6),X'FF'                                                      
         BE    CTBDE10                                                          
*                                                                               
         XR    RE,RE                                                            
         IC    RE,ATSEQ                                                         
         SRDL  RE,3                                                             
         LA    RE,BITTAB(RE)                                                    
         SRL   RF,32-3                                                          
         LHI   R1,X'80'                                                         
         SRL   R1,0(RF)            R0 = BITMASK                                 
         EX    R1,CTBDTM                                                        
         BZ    CTBDE08                                                          
*                                                                               
         MVCDD 0(8,R7),CT#UNKNW,L                                               
         OC    ATWRD,ATWRD                                                      
         BZ    *+10                                                             
         MVC   1(2,R7),ATWRD       MOVE IN DD REF FOR ACTION                    
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),0(R7),0                                       
*                                                                               
         LA    R7,8(R7)                                                         
         CLI   0(R7),C' '                                                       
         BH    *+8                                                              
         BCT   R7,*-8                                                           
         MVI   1(R7),C','                                                       
         AHI   R7,3                                                             
*                                                                               
CTBDE08  AHI   R6,ATABL                                                         
         B     CTBDE06                                                          
         DROP  R2                                                               
*                                                                               
CTBDE10  LR    R0,R7                                                            
         L     R1,AIOTEMP                                                       
         SR    R0,R1                                                            
         AHI   R0,-2               FOR THE ', '                                 
         BP    *+14                                                             
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         B     CTBDE12                                                          
*                                                                               
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,PLIST,AIOTEMP,((RF),PLOINF),(C'P',25),         +        
               C'LEN=',(R0)                                                     
         ICM   R0,15,8(R1)         GET USED LINES                               
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL          SET HIGH POINT                               
         BL    *+8                                                              
         ST    R0,FULL                                                          
*                                                                               
CTBDE12  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING SAFCWD,R3                                                        
*                                                                               
         LR    R4,R5                                                            
         XC    BITTAB,BITTAB                                                    
         XR    RF,RF                                                            
         IC    RF,SAFCWLN                                                       
         AHI   RF,-(SAFCWLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   BITTAB(0),SAFCWTAB                                               
*                                                                               
         L     R0,AIOTEMP          CLEAR PBLOCK TO SPACES                       
         LHI   R1,IOL                                                           
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
*                                                                               
         L     R7,AIOTEMP          NOW WE FILL BUFFER WITH DATA                 
*                                                                               
         L     R6,AATAB                                                         
         USING ATABD,R6                                                         
CTBDE14  CLI   0(R6),X'FF'                                                      
         BE    CTBDE18                                                          
*                                                                               
         XR    RE,RE                                                            
         IC    RE,ATSEQ                                                         
         SRDL  RE,3                                                             
         LA    RE,BITTAB(RE)                                                    
         SRL   RF,32-3                                                          
         LHI   R1,X'80'                                                         
         SRL   R1,0(RF)            R0 = BITMASK                                 
         EX    R1,CTBDTM                                                        
         BZ    CTBDE16                                                          
*                                                                               
         MVCDD 0(8,R7),CT#UNKNW,L                                               
         OC    ATWRD,ATWRD                                                      
         BZ    *+10                                                             
         MVC   1(2,R7),ATWRD       MOVE IN DD REF FOR ACTION                    
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),0(R7),0                                       
*                                                                               
         LA    R7,8(R7)                                                         
         CLI   0(R7),C' '                                                       
         BH    *+8                                                              
         BCT   R7,*-8                                                           
         MVI   1(R7),C','                                                       
         AHI   R7,3                                                             
*                                                                               
CTBDE16  AHI   R6,ATABL                                                         
         B     CTBDE14                                                          
         DROP  R3                                                               
*                                                                               
CTBDE18  LR    R0,R7                                                            
         L     R1,AIOTEMP                                                       
         SR    R0,R1                                                            
         AHI   R0,-2               FOR THE ', '                                 
         BP    *+14                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         B     EXITOK                                                           
*                                                                               
         LHI   RF,L'PLNINF         EITHER USE HALF OR ALL BLOCK                 
         CLI   MODE,MODECHG        DEPENDING ON WHETHER COPY EXISTS             
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,PLIST,AIOTEMP,((RF),PLNINF),(C'P',25),         +        
               C'LEN=',(R0)                                                     
*                                                                               
         ICM   R0,15,8(R1)         FIND WHICH ELEMENT USED MORE LINES           
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R4,R6                                                            
*                                                                               
CTBDTM   TM    0(RE),0                                                          
         EJECT                                                                  
***********************************************************************         
* X'BE' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTBEELM  EQU   CTBDELM             X'BE' SAME AS X'BD' ELEMENT                  
         EJECT                                                                  
***********************************************************************         
* BUILD LIST OF VALID FIELDS FOR THIS BD/BE ELEMENT                   *         
* NTRY: SVOVPG SET                                                    *         
* EXIT: ATAB BUILT                                                    *         
***********************************************************************         
         PUSH  USING                                                            
BLDFTAB  NTR1  BASE=*,LABEL=*                                                   
         LA    R2,KEY                                                           
         USING SAFDREC,R2          R2=A(FIELD RECORD KEY)                       
         XC    SAFDKEY,SAFDKEY                                                  
         MVI   SAFDTYP,SAFDTYPQ                                                 
         MVI   SAFDSUB,SAFDSUBQ                                                 
         MVC   SAFDOVPG,SVOVPG                                                  
*                                                                               
         L     R2,AIOTEMP                                                       
         MVC   SAFDKEY,KEY         SET START                                    
         L     R3,AATAB                                                         
         USING ATABD,R3            R3=A(ACTION TABLE)                           
*                                                                               
         GOTO1 VDMGR,DMCB,(X'08',DMRDHI),CTFILE,(R2),(R2)                       
         B     BFTAB04                                                          
*                                                                               
BFTAB02  GOTO1 VDMGR,DMCB,(X'08',DMRSEQ),CTFILE,(R2),(R2)                       
*                                                                               
BFTAB04  CLC   SAFDREC(SAFDFCD-SAFDREC),KEY                                     
         BNE   BFTAB10                                                          
*                                                                               
         MVC   ATSEQ,SAFDFCD       SAVE FIELD NUMBER                            
         XC    ATWRD(L'ATWRD+L'ATDSC),ATWRD                                     
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'BB',SAFDREC),0,0,0,0               
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   BFTAB06                                                          
*                                                                               
         L     RF,12(R1)                                                        
         MVC   ATWRD,SAFLDWRD-SAFLDD(RF)                                        
         MVC   ATDSC,SAFLDDSC-SAFLDD(RF)                                        
*                                                                               
BFTAB06  AHI   R3,ATABL                                                         
         B     BFTAB02                                                          
*                                                                               
BFTAB10  MVI   ATABD,255           SET E-O-T                                    
         B     EXITOK                                                           
         POP   USING                                                            
         EJECT                                                                  
***********************************************************************         
* X'BF' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTBFELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,34         OCON                                         
         BE    CTBFE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTBFE02  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#OPTS,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         L     R6,AIOSORT          GET PROGRAM RECORD DETAILS                   
         USING RECDS,R6                                                         
         USING SAASREC,RCVFRST                                                  
         MVC   HALF,SAASOVS                                                     
         DROP  R6                                                               
         BRAS  RE,GETPGEL                                                       
*                                                                               
         BRAS  RE,BLDOTAB          GET OPTIONS TABLE                            
*                                                                               
CTBFE04  LTR   R2,R2                                                            
         BZ    CTBFE12                                                          
         USING SAOCTD,R2                                                        
*                                                                               
         LR    R4,R5                                                            
         XC    BITTAB,BITTAB                                                    
         XR    RF,RF                                                            
         IC    RF,SAOCTLN                                                       
         AHI   RF,-(SAOCTLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   BITTAB(0),SAOCTTAB                                               
*                                                                               
         L     R0,AIOTEMP          CLEAR PBLOCK TO SPACES                       
         LHI   R1,IOL                                                           
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
*                                                                               
         L     R7,AIOTEMP          NOW WE FILL BUFFER WITH DATA                 
                                                                                
         L     R6,AATAB                                                         
         USING ATABD,R6                                                         
CTBFE06  CLI   0(R6),X'FF'                                                      
         BE    CTBFE10                                                          
*                                                                               
         XR    RE,RE                                                            
         IC    RE,ATSEQ                                                         
         SRDL  RE,3                                                             
         LA    RE,BITTAB(RE)                                                    
         SRL   RF,32-3                                                          
         LHI   R1,X'80'                                                         
         SRL   R1,0(RF)            R0 = BITMASK                                 
         EX    R1,CTBFTM                                                        
         BZ    CTBFE08                                                          
*                                                                               
         MVCDD 0(8,R7),CT#UNKNW,L                                               
         OC    ATWRD,ATWRD                                                      
         BZ    *+10                                                             
         MVC   1(2,R7),ATWRD       MOVE IN DD REF FOR ACTION                    
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),0(R7),0                                       
*                                                                               
         LA    R7,8(R7)                                                         
         CLI   0(R7),C' '                                                       
         BH    *+8                                                              
         BCT   R7,*-8                                                           
         MVI   1(R7),C','                                                       
         AHI   R7,3                                                             
*                                                                               
CTBFE08  AHI   R6,ATABL                                                         
         B     CTBFE06                                                          
         DROP  R2                                                               
*                                                                               
CTBFE10  LR    R0,R7                                                            
         L     R1,AIOTEMP                                                       
         SR    R0,R1                                                            
         AHI   R0,-2               FOR THE ', '                                 
         BP    *+14                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         B     CTBFE12                                                          
*                                                                               
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,PLIST,AIOTEMP,((RF),PLOINF),(C'P',25),         +        
               C'LEN=',(R0)                                                     
         ICM   R0,15,8(R1)         GET USED LINES                               
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL          SET HIGH POINT                               
         BL    *+8                                                              
         ST    R0,FULL                                                          
*                                                                               
CTBFE12  LTR   R3,R3                                                            
         BZ    EXITOK                                                           
         USING SAOCTD,R3                                                        
*                                                                               
         LR    R4,R5                                                            
         XC    BITTAB,BITTAB                                                    
         XR    RF,RF                                                            
         IC    RF,SAOCTLN                                                       
         AHI   RF,-(SAOCTLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   BITTAB(0),SAOCTTAB                                               
*                                                                               
         L     R0,AIOTEMP          CLEAR PBLOCK TO SPACES                       
         LHI   R1,IOL                                                           
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
*                                                                               
         L     R7,AIOTEMP          NOW WE FILL BUFFER WITH DATA                 
*                                                                               
         L     R6,AATAB                                                         
         USING ATABD,R6                                                         
CTBFE14  CLI   0(R6),X'FF'                                                      
         BE    CTBFE18                                                          
*                                                                               
         XR    RE,RE                                                            
         IC    RE,ATSEQ                                                         
         SRDL  RE,3                                                             
         LA    RE,BITTAB(RE)                                                    
         SRL   RF,32-3                                                          
         LHI   R1,X'80'                                                         
         SRL   R1,0(RF)            R0 = BITMASK                                 
         EX    R1,CTBFTM                                                        
         BZ    CTBFE16                                                          
*                                                                               
         MVCDD 0(8,R7),CT#UNKNW,L                                               
         OC    ATWRD,ATWRD                                                      
         BZ    *+10                                                             
         MVC   1(2,R7),ATWRD       MOVE IN DD REF FOR ACTION                    
         ICM   R0,12,SLDD                                                       
         ICM   R0,2,SVOVPG                                                      
         IC    R0,DDPLANG                                                       
         GOTO1 VDICTATE,DMCB,(R0),0(R7),0                                       
*                                                                               
         LA    R7,8(R7)                                                         
         CLI   0(R7),C' '                                                       
         BH    *+8                                                              
         BCT   R7,*-8                                                           
         MVI   1(R7),C','                                                       
         AHI   R7,3                                                             
*                                                                               
CTBFE16  AHI   R6,ATABL                                                         
         B     CTBFE14                                                          
         DROP  R3                                                               
*                                                                               
CTBFE18  LR    R0,R7                                                            
         L     R1,AIOTEMP                                                       
         SR    R0,R1                                                            
         AHI   R0,-2               FOR THE ', '                                 
         BP    *+14                                                             
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         B     EXITOK                                                           
*                                                                               
         LHI   RF,L'PLNINF         EITHER USE HALF OR ALL BLOCK                 
         CLI   MODE,MODECHG        DEPENDING ON WHETHER COPY EXISTS             
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,PLIST,AIOTEMP,((RF),PLNINF),(C'P',25),         +        
               C'LEN=',(R0)                                                     
*                                                                               
         ICM   R0,15,8(R1)         FIND WHICH ELEMENT USED MORE LINES           
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R4,R6                                                            
*                                                                               
CTBFTM   TM    0(RE),0                                                          
         EJECT                                                                  
***********************************************************************         
* BUILD LIST OF VALID OPTIONS FOR THIS BF ELEMENT                     *         
* NTRY: SVOVPG SET                                                    *         
* EXIT: ATAB BUILT                                                    *         
***********************************************************************         
         PUSH  USING                                                            
BLDOTAB  NTR1  BASE=*,LABEL=*                                                   
         LA    R2,KEY                                                           
         USING SAOPREC,R2          R2=A(FIELD RECORD KEY)                       
         XC    SAOPKEY,SAOPKEY                                                  
         MVI   SAOPTYP,SAOPTYPQ                                                 
         MVI   SAOPSUB,SAOPSUBQ                                                 
         MVC   SAOPOVPG,SVOVPG                                                  
*                                                                               
         L     R2,AIOTEMP                                                       
         MVC   SAOPKEY,KEY         SET START                                    
         L     R3,AATAB                                                         
         USING ATABD,R3            R3=A(ACTION TABLE)                           
*                                                                               
         GOTO1 VDMGR,DMCB,(X'08',DMRDHI),CTFILE,(R2),(R2)                       
         B     BOTAB04                                                          
*                                                                               
BOTAB02  GOTO1 VDMGR,DMCB,(X'08',DMRSEQ),CTFILE,(R2),(R2)                       
*                                                                               
BOTAB04  CLC   SAOPREC(SAOPOCD-SAOPREC),KEY                                     
         BNE   BOTAB10                                                          
*                                                                               
         MVC   ATSEQ,SAOPOCD       SAVE OPTION NUMBER                           
         XC    ATWRD(L'ATWRD+L'ATDSC),ATWRD                                     
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'BC',SAOPREC),0,0,0,0               
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   BOTAB06                                                          
*                                                                               
         L     RF,12(R1)                                                        
         MVC   ATWRD,SAOPTWRD-SAOPTD(RF)                                        
         MVC   ATDSC,SAOPTDSC-SAOPTD(RF)                                        
*                                                                               
BOTAB06  AHI   R3,ATABL                                                         
         B     BOTAB02                                                          
*                                                                               
BOTAB10  MVI   ATABD,255           SET E-O-T                                    
         B     EXITOK                                                           
         POP   USING                                                            
         EJECT                                                                  
***********************************************************************         
* X'C0' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC0ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,23         OFFICE RECORDS                               
         BE    CTC0E02                                                          
         DROP  RF                                                               
*                                                                               
         GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTC0E02  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#OFFN,L                                                 
         AHI   R4,L'PLINE                                                       
*        MVCDD PLNHDR,CT#MANID,L   SAOFFMID IS NOT USED, APPARENTLY             
*        AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CTC0E04                                                          
         USING SAOFFD,R2                                                        
         XR    RF,RF                                                            
         IC    RF,SAOFFLN                                                       
         AHI   RF,-(SAOFFLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),SAOFFNAM                                               
*        AHI   R4,L'PLINE                                                       
*        MVC   PLOINF(L'SAOFFMID),SAOFFMID                                      
         DROP  R2                                                               
*                                                                               
CTC0E04  LTR   R3,R3                                                            
         BZ    CTC0E06                                                          
         USING SAOFFD,R3                                                        
         XR    RF,RF                                                            
         IC    RF,SAOFFLN                                                       
         AHI   RF,-(SAOFFLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),SAOFFNAM                                               
*        AHI   R4,L'PLINE                                                       
*        MVC   PLNINF(L'SAOFFMID),SAOFFMID                                      
         DROP  R3                                                               
*                                                                               
CTC0E06  B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'C1' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC1ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,24         SECURITY RECORDS                             
         BE    CTC1E02                                                          
         DROP  RF                                                               
*                                                                               
         GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTC1E02  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#DPTN,L                                                 
         AHI   R4,L'PLINE                                                       
*        MVCDD PLNHDR,CT#MANID,L   SADPTMID IS NOT USED, APPARENTLY             
*        AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CTC1E04                                                          
         USING SADPTD,R2                                                        
         XR    RF,RF                                                            
         IC    RF,SADPTLN                                                       
         AHI   RF,-(SADPTLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),SADPTNAM                                               
*        AHI   R4,L'PLINE                                                       
*        MVC   PLOINF(L'SADPTMID),SADPTMID                                      
         DROP  R2                                                               
*                                                                               
CTC1E04  LTR   R3,R3                                                            
         BZ    CTC1E06                                                          
         USING SADPTD,R3                                                        
         XR    RF,RF                                                            
         IC    RF,SADPTLN                                                       
         AHI   RF,-(SADPTLNQ+1)                                                 
         BM    *+18                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),SADPTNAM                                               
*        AHI   R4,L'PLINE                                                       
*        MVC   PLNINF(L'SADPTMID),SADPTMID                                      
         DROP  R3                                                               
*                                                                               
CTC1E06  B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'C2' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC2ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,08         PRINTER NAME DESCRIPTION                     
         BE    CTC2E02                                                          
         CLI   ADRECNUM,23         SECURITY RECORDS                             
         BL    *+12                                                             
         CLI   ADRECNUM,37                                                      
         BNH   CTC2E08                                                          
         DROP  RF                                                               
*                                                                               
         GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTC2E02  MVCDD PLNHDR,CT#DESC,L                                                 
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CTC2E04                                                          
         USING CTPNDD,R2           PRINTER NAME COPY ELEMENT                    
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTPNDLEN                                                      
         AHI   R0,-(CTPNDLNQ+1)                                                 
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTPNDTXT),((RF),PLOINF),(C'P',4)             
         ICM   R0,15,8(R1)                                                      
         ST    R0,FULL                                                          
         DROP  R2                                                               
*                                                                               
CTC2E04  LTR   R3,R3                                                            
         BZ    CTC2E06                                                          
         USING CTPNDD,R3           PRINTER NAME CHANGE ELEMENT                  
*                                                                               
         XR    R0,R0                                                            
         IC    R0,CTPNDLEN                                                      
         AHI   R0,-(CTPNDLNQ+1)                                                 
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),CTPNDTXT),((RF),PLNINF),(C'P',4)             
         ICM   R0,15,8(R1)                                                      
         CLM   R0,15,FULL                                                       
         BH    *+8                                                              
         ICM   R0,15,FULL                                                       
         DROP  R3                                                               
*                                                                               
CTC2E06  MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CTC2E08  MVC   PLNHDR,HPRSNCNT                                                  
         LTR   R2,R2                                                            
         BZ    CTC2E10                                                          
         USING SAPCTD,R2                                                        
         CURED SAPCTVAL,(8,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         DROP  R2                                                               
*                                                                               
CTC2E10  LTR   R3,R3                                                            
         BZ    CTC2E12                                                          
         USING SAPCTD,R3                                                        
         CURED SAPCTVAL,(8,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                    
         DROP  R3                                                               
*                                                                               
CTC2E12  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'C3' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC3ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,08         PRINTER NAME DESCRIPTION                     
         BE    CTC3E04                                                          
         CLI   ADRECNUM,59         SECURITY RECORDS                             
         BE    CTC3E10                                                          
         DROP  RF                                                               
*                                                                               
CTC3E02  GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTC3E04  MVCDD PLNHDR,CT#ID,L                                                   
         LTR   R2,R2                                                            
         BZ    CTC3E06                                                          
         USING CTPNID,R2                                                        
         MVC   HALF,CTPNIUID                                                    
         BRAS  RE,GETUSRID                                                      
         MVC   PLOINF(10),WORK+2                                                
         DROP  R2                                                               
*                                                                               
CTC3E06  LTR   R3,R3                                                            
         BZ    CTC3E08                                                          
         USING CTPNID,R3                                                        
         MVC   HALF,CTPNIUID                                                    
         BRAS  RE,GETUSRID                                                      
         MVC   PLNINF(10),WORK+2                                                
         DROP  R3                                                               
*                                                                               
CTC3E08  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
*                                                                               
CTC3E10  MVCDD PLNHDR,CT#ID,L                                                   
         LTR   R2,R2                                                            
         BZ    *+10                                                             
         MVC   PLOINF(L'SAPALPID),SAPALPID-SAPALD(R2)                           
         LTR   R3,R3                                                            
         BZ    *+10                                                             
         MVC   PLNINF(L'SAPALPID),SAPALPID-SAPALD(R3)                           
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'C4' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC4ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,25         PERSONAL SECURITY RECORD                     
         BE    CTC4E02                                                          
         GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTC4E02  LR    R5,R4                                                            
         CLI   LSTSRT,SRTSDDS      ONLY DDS INTERESTED IN INTERNAL NUM          
         BNE   CTC4E02A                                                         
         MVC   PLNHDR,LC@NUM                                                    
         AHI   R4,L'PLINE                                                       
CTC4E02A MVCDD PLNHDR,CT#PSWD,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2                                                            
         BZ    CTC4E04                                                          
         USING SAPWDD,R2           PERSON PASSWORD COPY ELEMENT                 
         LR    R4,R5                                                            
*                                                                               
         CLI   LSTSRT,SRTSDDS                                                   
         BNE   CTC4E02B                                                         
         XR    RF,RF                                                            
         ICM   RF,3,SAPWDNUM                                                    
         CURED (RF),(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         AHI   R4,L'PLINE                                                       
CTC4E02B DS    0H                                                               
*        MVC   PLOINF(L'SAPWDCOD),SAPWDCOD                                      
*&&UK*&& MVC   PLOINF(10),=C'**********'                                        
*&&US*&& MVC   PLOINF(10),=C'***       '                                        
         DROP  R2                                                               
*                                                                               
CTC4E04  LTR   R3,R3               PERSON PASSWORD CHANGE ELEMENT               
         BZ    CTC4E06                                                          
         USING SAPWDD,R3                                                        
         LR    R4,R5                                                            
*                                                                               
         CLI   LSTSRT,SRTSDDS                                                   
         BNE   CTC4E04A                                                         
         XR    RF,RF                                                            
         ICM   RF,3,SAPWDNUM                                                    
         CURED (RF),(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         AHI   R4,L'PLINE                                                       
CTC4E04A DS    0H                                                               
*        MVC   PLNINF(L'SAPWDCOD),SAPWDCOD                                      
*&&UK*&& MVC   PLNINF(10),=C'**********'                                        
*&&US*&& MVC   PLNINF(10),=C'***       '                                        
         DROP  R3                                                               
*                                                                               
CTC4E06  B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'C5' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY RECORD OR 0)                                 *         
*       4(R1)   = A(CHANGE RECORD OR 0)                               *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC5ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,25         PERSONAL SECURITY RECORD                     
         BE    CTC5E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTC5E02  MVC   PLNHDR,LC@NAME      PERSON NAME ELEMENT                          
         XC    FULL,FULL                                                        
*                                                                               
         LTR   R2,R2                                                            
         BZ    CTC5E04                                                          
         BRAS  RE,DISSANA                                                       
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLOINF),(C'P',4)                 
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL                                                          
*                                                                               
CTC5E04  LTR   R2,R3               <== LOOK                                     
         BZ    EXITOK                                                           
         BRAS  RE,DISSANA                                                       
         LHI   RF,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,((R0),WORK),((RF),PLNINF),(C'P',4)                 
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         CLM   R0,15,FULL                                                       
         BL    EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
*                                                                               
DISSANA  NTR1  ,                                                                
         USING SANAMD,R2                                                        
         MVC   WORK(80),SPACES                                                  
         LA    RF,WORK                                                          
         LA    RE,SANAMELN         PROCESS NAME ELEMENT                         
         TM    SANAMIND,SANAMIFN                                                
         BZ    DSANA02                                                          
         XR    R1,R1                                                            
         IC    R1,0(RE)                                                         
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RF),1(RE)                                                    
         LA    RE,2(R1,RE)                                                      
         LA    RF,2(R1,RF)                                                      
*                                                                               
DSANA02  TM    SANAMIND,SANAMIMN                                                
         BZ    DSANA04                                                          
         XR    R1,R1                                                            
         IC    R1,0(RE)                                                         
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RF),1(RE)                                                    
         LA    RE,2(R1,RE)                                                      
         LA    RF,2(R1,RF)                                                      
*                                                                               
DSANA04  TM    SANAMIND,SANAMILN                                                
         BZ    DSANA06                                                          
         IC    R1,0(RE)                                                         
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RF),1(RE)                                                    
         LA    RE,2(R1,RE)                                                      
         LA    RF,2(R1,RF)                                                      
*                                                                               
DSANA06  LA    R0,WORK             RETURN LENGTH USED IN R0                     
         SR    RF,R0                                                            
         LR    R0,RF                                                            
         XIT1  REGS=(R0)                                                        
         DROP  R2,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'C6' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC6PDIS NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
         LR    R5,R4               SAVE A(PRINT LINE)                           
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,25         PERSONAL SECURITY RECORD                     
         BE    CTC6P02                                                          
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTC6P02  MVCDD PLNHDR,CT#OFFC,L    OFFICE                                       
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#DPTC,L    DEPARTMENT                                   
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#WEXT,L    WORK EXTENSION                               
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#STAFC,L   STAFF CODE                                   
         AHI   R4,L'PLINE                                                       
*        MVCDD PLNHDR,CT#PROFS,L   PROFS ID                                     
*        AHI   R4,L'PLINE                                                       
*&&UK*&& MVCDD PLNHDR,CT#NICOD,L                                                
*  US*&& MVC   PLNHDR,HINSCDE                                                   
*&&UK*&& AHI   R4,L'PLINE                                                       
*        MVCDD PLNHDR,CT#MARS,L    MARITAL STATUS                               
*        AHI   R4,L'PLINE                                                       
*&&UK*&& MVCDD PLNHDR,CT#SEXMF,L   SEX                                          
*&&UK*&& AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#HIRED,L                                                
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#TERMD,L                                                
         AHI   R4,L'PLINE                                                       
*        MVCDD PLNHDR,CT#DOB,L                                                  
*        AHI   R4,L'PLINE                                                       
*&&US*&& CLI   LSTSRT,SRTSDDS      ONLY DDS INTERESTED IN OVERRIDE              
*&&US*&& BNE   CTC6P04                                AND PWD CONTROL           
         MVCDD PLNHDR,CT#SECAD,L                                                
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#EXPRI,L                                                
         AHI   R4,L'PLINE                                                       
*                                                                               
CTC6P04  LR    R4,R5               BACK TO TOP                                  
*                                                                               
         LTR   R2,R2               ANY COPY RECORD PRESENT?                     
         BZ    CTC6P18             NO                                           
         USING SAPERD,R2                                                        
*                                                                               
         OC    SAPEROFF,SAPEROFF   OFFICE                                       
         BZ    CTC6P05                                                          
         MVC   PLOINF(L'SAPEROFF),SAPEROFF                                      
         MVC   FULL(2),LSTAGY                                                   
         MVC   FULL+2(2),SAPEROFF                                               
         BRAS  RE,GETOFN                                                        
         GOTO1 ,DUB,(L'PLOINF-8-2,PLOINF+8+2),(30,WORK)                         
         BRAS  RE,CHEVRON                                                       
CTC6P05  AHI   R4,L'PLINE                                                       
         OC    SAPERDID,SAPERDID   DEPARTMENT                                   
         BZ    CTC6P05A                                                         
         MVC   PLOINF(L'SAPERDID),SAPERDID                                      
         MVC   WORK(2),LSTAGY                                                   
         MVC   WORK+2(2),SAPEROFF                                               
         MVC   WORK+4(3),SAPERDID                                               
         BRAS  RE,GETDPN                                                        
         GOTO1 ,DUB,(L'PLOINF-8-2,PLOINF+8+2),(30,WORK+7)                       
         BRAS  RE,CHEVRON                                                       
CTC6P05A AHI   R4,L'PLINE                                                       
         OC    SAPEREXT,SAPEREXT                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'SAPEREXT),SAPEREXT                                      
         AHI   R4,L'PLINE                                                       
         OC    SAPERSTA,SAPERSTA                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'SAPERSTA),SAPERSTA                                      
         AHI   R4,L'PLINE                                                       
*        OC    SAPERPRO,SAPERPRO                                                
*        BZ    *+10                                                             
*        MVC   PLOINF(L'SAPERPRO),SAPERPRO                                      
*        AHI   R4,L'PLINE                                                       
*                                                                               
*&&UK                                                                           
         OC    SAPERINC,SAPERINC                                                
         BZ    CTC6P06                                                          
         MVC   PLOINF(L'SAPERINC),SAPERINC                                      
         OC    SAPERINX,SAPERINX                                                
         BZ    *+10                                                             
         MVC   PLOINF+L'SAPERINC(L'SAPERINX),SAPERINX                           
*                                                                               
CTC6P06  AHI   R4,L'PLINE                                                       
*&&                                                                             
*        OC    SAPERMAR,SAPERMAR                                                
*        BZ    *+10                                                             
*        MVC   PLOINF(L'SAPERMAR),SAPERMAR                                      
*        AHI   R4,L'PLINE                                                       
*                                                                               
*&&UK                                                                           
         OC    SAPERSEX,SAPERSEX                                                
         BZ    CTC6P08                                                          
         MVC   PLOINF(L'SAPERSEX),SAPERSEX                                      
         CLI   PLOINF,0                                                         
         BNE   *+8                                                              
         MVI   PLOINF,C'?'                                                      
*                                                                               
CTC6P08  AHI   R4,L'PLINE                                                       
*&&                                                                             
         OC    SAPERDHI,SAPERDHI                                                
         BZ    CTC6P10                                                          
         GOTO1 VDATCON,PLIST,(2,SAPERDHI),(8,PLOINF)                            
*                                                                               
CTC6P10  AHI   R4,L'PLINE                                                       
         OC    SAPERDTE,SAPERDTE                                                
         BZ    CTC6P12                                                          
         GOTO1 VDATCON,PLIST,(2,SAPERDTE),(8,PLOINF)                            
*                                                                               
CTC6P12  AHI   R4,L'PLINE                                                       
*        OC    SAPERDOB,SAPERDOB                                                
*        BZ    CTC6P14                                                          
*        GOTO1 VDATCON,PLIST,(2,SAPERDOB),(8,PLOINF)                            
*                                                                               
*TC6P14  AHI   R4,L'PLINE                                                       
*&&US*&& CLI   LSTSRT,SRTSDDS      ONLY DDS INTERESTED IN OVERRIDE              
*&&US*&& BNE   CTC6P16                                AND PWD CONTROL           
         OC    SAPEROVF,SAPEROVF                                                
         BZ    *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLOINF(L'SAPERPCN),SAPERPCN                                      
         CLI   SAPERPCN,SAPERPNQ                                                
         BNE   *+10                                                             
         MVC   PLOINF(L'L4@NO),L4@NO                                            
         CLI   SAPERPCN,SAPERPYQ                                                
         BNE   *+10                                                             
         MVC   PLOINF(L'L4@YES),L4@YES                                          
         CLI   SAPERPCN,C' '                                                    
         BH    *+10                                                             
         MVCDD PLOINF,CT#DFALT,L                                                
         CLI   SAPERPCN,SAPERPAQ   (OBSOLETE)                                   
         BNE   *+10                                                             
         MVCDD PLOINF,CT#AUTO,L                                                 
         CLI   SAPERPCN,SAPERPGQ   (OBSOLETE)                                   
         BNE   *+10                                                             
         MVC   PLOINF(L'HGENRT),HGENRT                                          
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL             SAVE FURTHEST REACHED                        
*                                                                               
CTC6P16  CLI   SAPERLN,SAPERLNQ                                                 
         BNH   CTC6P18                                                          
         XR    RF,RF                                                            
         IC    RF,SAPERLN                                                       
         AHI   RF,-(SAPERLNQ+1)                                                 
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),SAPERTIT                                               
         MVCDD PLNHDR,CT#TITLE,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL             SAVE FURTHEST REACHED                        
         DROP  R2                                                               
*                                                                               
CTC6P18  LR    R4,R5                                                            
         LTR   R3,R3               CHANGE RECORD PRESENT?                       
         BZ    CTC6P32             NO                                           
         USING SAPERD,R3                                                        
*                                                                               
         OC    SAPEROFF,SAPEROFF   OFFICE                                       
         BZ    CTC6P19                                                          
         MVC   PLNINF(L'SAPEROFF),SAPEROFF                                      
         MVC   FULL(2),LSTAGY                                                   
         MVC   FULL+2(2),SAPEROFF                                               
         BRAS  RE,GETOFN                                                        
         GOTO1 ,DUB,(L'PLNINF-8-2,PLNINF+8+2),(30,WORK)                         
         BRAS  RE,CHEVRON                                                       
CTC6P19  AHI   R4,L'PLINE                                                       
         OC    SAPERDID,SAPERDID   DEPARTMENT                                   
         BZ    CTC6P19A                                                         
         MVC   PLNINF(L'SAPERDID),SAPERDID                                      
         MVC   WORK(2),LSTAGY                                                   
         MVC   WORK+2(2),SAPEROFF                                               
         MVC   WORK+4(3),SAPERDID                                               
         BRAS  RE,GETDPN                                                        
         GOTO1 ,DUB,(L'PLNINF-8-2,PLNINF+8+2),(30,WORK+7)                       
         BRAS  RE,CHEVRON                                                       
CTC6P19A AHI   R4,L'PLINE                                                       
         OC    SAPEREXT,SAPEREXT   EXTENSION                                    
         BZ    *+10                                                             
         MVC   PLNINF(L'SAPEREXT),SAPEREXT                                      
         AHI   R4,L'PLINE                                                       
         OC    SAPERSTA,SAPERSTA                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'SAPERSTA),SAPERSTA                                      
         AHI   R4,L'PLINE                                                       
*        OC    SAPERPRO,SAPERPRO                                                
*        BZ    *+10                                                             
*        MVC   PLNINF(L'SAPERPRO),SAPERPRO                                      
*        AHI   R4,L'PLINE                                                       
*                                                                               
*&&UK                                                                           
         OC    SAPERINC,SAPERINC                                                
         BZ    CTC6P20                                                          
         MVC   PLNINF(L'SAPERINC),SAPERINC                                      
         OC    SAPERINX,SAPERINX                                                
         BZ    *+10                                                             
         MVC   PLNINF+L'SAPERINC(L'SAPERINX),SAPERINX                           
*                                                                               
CTC6P20  AHI   R4,L'PLINE                                                       
*&&                                                                             
*        OC    SAPERMAR,SAPERMAR                                                
*        BZ    *+10                                                             
*        MVC   PLNINF(L'SAPERMAR),SAPERMAR                                      
*        AHI   R4,L'PLINE                                                       
*                                                                               
*&&UK                                                                           
         OC    SAPERSEX,SAPERSEX                                                
         BZ    CTC6P22                                                          
         MVC   PLNINF(L'SAPERSEX),SAPERSEX                                      
         CLI   PLNINF,0                                                         
         BNE   *+8                                                              
         MVI   PLNINF,C'?'                                                      
*                                                                               
CTC6P22  AHI   R4,L'PLINE                                                       
*&&                                                                             
         OC    SAPERDHI,SAPERDHI                                                
         BZ    CTC6P24                                                          
         GOTO1 VDATCON,PLIST,(2,SAPERDHI),(8,PLNINF)                            
*                                                                               
CTC6P24  AHI   R4,L'PLINE                                                       
         OC    SAPERDTE,SAPERDTE                                                
         BZ    CTC6P26                                                          
         GOTO1 VDATCON,PLIST,(2,SAPERDTE),(8,PLNINF)                            
*                                                                               
CTC6P26  AHI   R4,L'PLINE                                                       
*        OC    SAPERDOB,SAPERDOB                                                
*        BZ    CTC6P28                                                          
*        GOTO1 VDATCON,PLIST,(2,SAPERDOB),(8,PLNINF)                            
*                                                                               
*TC6P28  AHI   R4,L'PLINE                                                       
*&&US*&& CLI   LSTSRT,SRTSDDS      ONLY DDS INTERESTED IN OVERRIDE              
*&&US*&& BNE   CTC6P30                                AND PWD CONTROL           
         OC    SAPEROVF,SAPEROVF                                                
         BZ    *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         AHI   R4,L'PLINE                                                       
         MVC   PLNINF(L'SAPERPCN),SAPERPCN                                      
         CLI   SAPERPCN,SAPERPNQ                                                
         BNE   *+10                                                             
         MVC   PLNINF(L'L4@NO),L4@NO                                            
         CLI   SAPERPCN,SAPERPYQ                                                
         BNE   *+10                                                             
         MVC   PLNINF(L'L4@YES),L4@YES                                          
         CLI   SAPERPCN,C' '                                                    
         BH    *+10                                                             
         MVCDD PLNINF,CT#DFALT,L                                                
         CLI   SAPERPCN,SAPERPAQ   (OBSOLETE)                                   
         BNE   *+10                                                             
         MVCDD PLNINF,CT#AUTO,L                                                 
         CLI   SAPERPCN,SAPERPGQ   (OBSOLETE)                                   
         BNE   *+10                                                             
         MVC   PLNINF(L'HGENRT),HGENRT                                          
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
CTC6P30  CLI   SAPERLN,SAPERLNQ                                                 
         BNH   CTC6P32                                                          
         XR    RF,RF                                                            
         IC    RF,SAPERLN                                                       
         AHI   RF,-(SAPERLNQ+1)                                                 
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),SAPERTIT                                               
         MVCDD PLNHDR,CT#TITLE,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         DROP  R3                                                               
*                                                                               
CTC6P32  B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'C7' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC7ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,25         PERSON RECORD                                
         BE    CTC7E02                                                          
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTC7E02  MVC   PLNHDR,LC@UNKNW                                                  
         USING SAADRD,R3                                                        
         CLI   SAADRTYP,SAADLINQ                                                
         BNE   *+10                                                             
         MVCDD PLNHDR,GE#ADRL1,L   ADDRESS LINE 1                               
         CLI   SAADRTYP,SAADLINQ+1                                              
         BNE   *+10                                                             
         MVCDD PLNHDR,GE#ADRL2,L   ADDRESS LINE 2                               
         CLI   SAADRTYP,SAADLINQ+2                                              
         BNE   *+10                                                             
         MVCDD PLNHDR,GE#ADRL3,L   ADDRESS LINE 3                               
         CLI   SAADRTYP,SAADCITQ                                                
         BNE   *+10                                                             
         MVCDD PLNHDR,CT#CITY,L    CITY                                         
         CLI   SAADRTYP,SAADCODQ                                                
         BNE   *+10                                                             
*&&US*&& MVCDD PLNHDR,CT#STATE,L   STATE                                        
*&&UK*&& MVCDD PLNHDR,CT#CODE,L    POSTCODE                                     
         CLI   SAADRTYP,SAADCTRQ                                                
         BNE   *+10                                                             
         MVCDD PLNHDR,CT#CTRY,L    COUNTRY                                      
         CLI   SAADRTYP,SAADPHOQ                                                
         BNE   *+10                                                             
         MVC   PLNHDR,HPHONE                                                    
         CLI   SAADRTYP,SAADTLXQ                                                
         BNE   *+10                                                             
         MVC   PLNHDR,HTELEX                                                    
         CLI   SAADRTYP,SAADFAXQ                                                
         BNE   *+10                                                             
         MVCDD PLNHDR,GE#FAX,L     FAX                                          
         DROP  R3                                                               
*                                                                               
         LTR   R2,R2                                                            
         BZ    CTC7E04                                                          
         USING SAADRD,R2                                                        
         XR    RF,RF                                                            
         IC    RF,SAADRDLN                                                      
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),SAADRDAT                                               
         DROP  R2                                                               
*                                                                               
CTC7E04  LTR   R3,R3                                                            
         BZ    CTC7E06                                                          
         USING SAADRD,R3                                                        
         XR    RF,RF                                                            
         IC    RF,SAADRDLN                                                      
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),SAADRDAT                                               
         DROP  R3                                                               
*                                                                               
CTC7E06  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
*                                                                               
HTELEX   DC    CL16'Telex'                                                      
HPHONE   DC    CL16'Phone'                                                      
         EJECT                                                                  
***********************************************************************         
* X'C8' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC8ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,25         PERSON SECURITY                              
         BE    CTC8E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTC8E02  LR    R5,R4               PERSON ACCESS GROUP CODE                     
         CLI   LSTSRT,SRTSDDS      ONLY DDS INTERESTED IN INTERNAL NUM          
         BNE   CTC8E02A                                                         
         MVC   PLNHDR,LC@NUM                                                    
         AHI   R4,L'PLINE                                                       
CTC8E02A MVCDD PLNHDR,CT#GCODE,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2               COPY RECORD?                                 
         BZ    CTC8E04                                                          
         USING SAAGCD,R2                                                        
         CLI   LSTSRT,SRTSDDS                                                   
         BNE   CTC8E02B                                                         
         XR    RF,RF                                                            
         ICM   RF,3,SAAGCNUM                                                    
         CURED (RF),(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         AHI   R4,L'PLINE                                                       
CTC8E02B MVC   PLOINF(L'SAAGCCOD),SAAGCCOD                                      
         MVC   WORK(2),LSTAGY                                                   
         MVC   WORK+2(8),SAAGCCOD                                               
         BRAS  RE,GETAGN                                                        
         GOTO1 ,DUB,(L'PLOINF-8-2,PLOINF+8+2),(30,WORK+10)                      
         BRAS  RE,CHEVRON                                                       
         DROP  R2                                                               
*                                                                               
CTC8E04  LR    R4,R5                                                            
         LTR   R3,R3               CHANGE RECORD?                               
         BZ    EXITOK                                                           
         USING SAAGCD,R3                                                        
         CLI   LSTSRT,SRTSDDS                                                   
         BNE   CTC8E04A                                                         
         XR    RF,RF                                                            
         ICM   RF,3,SAAGCNUM                                                    
         CURED (RF),(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         AHI   R4,L'PLINE                                                       
CTC8E04A MVC   PLNINF(L'SAAGCCOD),SAAGCCOD                                      
         MVC   WORK(2),LSTAGY                                                   
         MVC   WORK+2(8),SAAGCCOD                                               
         BRAS  RE,GETAGN                                                        
         GOTO1 ,DUB,(L'PLNINF-8-2,PLNINF+8+2),(30,WORK+10)                      
         BRAS  RE,CHEVRON                                                       
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'C9' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTC9ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,26         GROUP RECORD                                 
         BE    CTC9E02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTC9E02  LR    R5,R4               PERSON ACCESS GROUP NAME                     
         MVC   PLNHDR,LC@NAME                                                   
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2               COPY RECORD?                                 
         BZ    CTC9E04                                                          
         USING SAAGND,R2                                                        
         XR    RF,RF                                                            
         IC    RF,SAAGNLN                                                       
         AHI   RF,-(SAAGNLNQ+1)                                                 
         BM    CTC9E04                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),SAAGNNAM                                               
         DROP  R2                                                               
*                                                                               
CTC9E04  LR    R4,R5                                                            
         LTR   R3,R3               CHANGE RECORD?                               
         BZ    EXITOK                                                           
         USING SAAGND,R3                                                        
         XR    RF,RF                                                            
         IC    RF,SAAGNLN                                                       
         AHI   RF,-(SAAGNLNQ+1)                                                 
         BM    EXITOK                                                           
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),SAAGNNAM                                               
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'CA' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTCAELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,59         PASSWORD EFFECTIVE DATE                      
         BE    CTCAE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTCAE02  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#STRDT,L                                                
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#ENDDT,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2               COPY RECORD?                                 
         BZ    CTCAE04                                                          
         USING SAPEFD,R2                                                        
         GOTO1 VDATCON,DMCB,(2,SAPEFSTA),(8,PLOINF),0                           
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,DMCB,(2,SAPEFEND),(8,PLOINF),0                           
         CLC   SAPEFEND,=X'FFFF'                                                
         BNE   CTCAE04                                                          
         MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         DROP  R2                                                               
*                                                                               
CTCAE04  LR    R4,R5                                                            
         LTR   R3,R3               CHANGE RECORD?                               
         BZ    EXITOK                                                           
         USING SAPEFD,R3                                                        
         GOTO1 VDATCON,DMCB,(2,SAPEFSTA),(8,PLNINF),0                           
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,DMCB,(2,SAPEFEND),(8,PLNINF),0                           
         CLC   SAPEFEND,=X'FFFF'                                                
         BNE   EXITOK                                                           
         MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'CE' ELEMENT HANDLING ROUTINES                                     *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTCEELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,26         GROUP                                        
         BE    CTCEE02                                                          
         CLI   ADRECNUM,37         APPROVER GROUP                               
         BE    CTCEE02                                                          
*                                                                               
         GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTCEE02  LR    R5,R4               PERSON ACCESS GROUP CODE                     
         MVCDD PLNHDR,CT#LINE,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LTR   R2,R2               COPY RECORD?                                 
         BZ    CTCEE04                                                          
         USING SACOMD,R2                                                        
         MVC   WORK(L'SPACES),SPACES                                            
         LA    R4,WORK                                                          
         CLI   LSTSRT,SRTSDDS      ONLY DDS INTERESTED IN INTERNALS             
         BNE   CTCEE02A                                                         
         MVC   WORK(1),SACOMOPT                                                 
         CLI   WORK,C' '                                                        
         BH    *+8                                                              
         MVI   WORK,C'-'                                                        
         MVI   WORK+1,C'/'                                                      
         LA    R4,2(,R4)                                                        
CTCEE02A CURED (B1,SACOMLIN),(3,(R4)),0,ALIGN=LEFT,ZERO=NOBLANK                 
         AR    R4,R0                                                            
         MVI   0(R4),C'.'                                                       
         LA    R4,2(,R4)                                                        
         XR    RF,RF                                                            
         IC    RF,SACOMLN                                                       
         AHI   RF,-(SACOMLNQ+1)                                                 
         BM    CTCEE04                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),SACOMDAT                                                 
         LA    R0,1(RF,R4)                                                      
         LA    RF,WORK                                                          
         SR    R0,RF                                                            
         LR    R4,R5                                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,PLIST,((R0),WORK),((RF),PLOINF),(C'P',15)               
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         ST    R0,FULL             SAVE MAX DISPLACEMENT                        
         DROP  R2                                                               
*                                                                               
CTCEE04  LTR   R3,R3               CHANGE RECORD?                               
         BZ    EXITOK                                                           
         USING SACOMD,R3                                                        
         MVC   WORK(L'SPACES),SPACES                                            
         LA    R4,WORK                                                          
         CLI   LSTSRT,SRTSDDS      ONLY DDS INTERESTED IN INTERNALS             
         BNE   CTCEE04A                                                         
         MVC   WORK(1),SACOMOPT                                                 
         CLI   WORK,C' '                                                        
         BH    *+8                                                              
         MVI   WORK,C'-'                                                        
         MVI   WORK+1,C'/'                                                      
         LA    R4,2(,R4)                                                        
CTCEE04A CURED (B1,SACOMLIN),(3,(R4)),0,ALIGN=LEFT,ZERO=NOBLANK                 
         AR    R4,R0                                                            
         MVI   0(R4),C'.'                                                       
         LA    R4,2(,R4)                                                        
         XR    RF,RF                                                            
         IC    RF,SACOMLN                                                       
         AHI   RF,-(SACOMLNQ+1)                                                 
         BM    EXITOK                                                           
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),SACOMDAT                                                 
         LA    R0,1(RF,R4)                                                      
         LA    RF,WORK                                                          
         SR    R0,RF                                                            
         LR    R4,R5                                                            
         LHI   RF,L'PLNINF         EITHER USE HALF OR ALL BLOCK                 
         CLI   MODE,MODECHG        DEPENDING ON WHETHER COPY EXISTS             
         BE    *+8                                                              
         LHI   RF,L'PLBOTH                                                      
         GOTO1 VCHOPPER,PLIST,((R0),WORK),((RF),PLNINF),(C'P',15)               
         ICM   R0,15,8(R1)                                                      
         MHI   R0,L'PLINE                                                       
         AR    R0,R4                                                            
         C     R0,FULL             SAVE MAX DISPLACEMENT                        
         BNH   EXITOK                                                           
         ST    R0,FULL                                                          
         B     EXITOK                                                           
         DROP  R3,R4                                                            
         EJECT                                                                  
***********************************************************************         
* X'CF' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTCFELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,23         SECURITY RECORD                              
         BL    CTCFE02                                                          
         CLI   ADRECNUM,37         SECURITY RECORD                              
         BH    CTCFE02                                                          
         B     CTCFE04                                                          
*                                                                               
CTCFE02  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTCFE04  MVCDD PLNHDR,CT#MANID,L   MANAGER ID                                   
*                                                                               
         LTR   R2,R2               COPY ELEMENT?                                
         BZ    CTCFE06             NO                                           
         USING SAMAND,R2                                                        
         MVC   FULL+0(2),LSTAGY                                                 
         MVC   FULL+2(2),SAMANID                                                
         BRAS  RE,GETPID                                                        
         MVC   PLOINF(8),WORK+2                                                 
         MVC   WORK(2),LSTAGY                                                   
         MVC   WORK+2(8),PLOINF                                                 
         BRAS  RE,GETPEN                                                        
         GOTO1 ,DUB,(L'PLOINF-8-2,PLOINF+8+2),(47,WORK+10)                      
         BRAS  RE,CHEVRON                                                       
         DROP  R2                                                               
*                                                                               
CTCFE06  LTR   R3,R3                                                            
         BZ    CTCFE08                                                          
         USING SAMAND,R3                                                        
         MVC   FULL+0(2),LSTAGY                                                 
         MVC   FULL+2(2),SAMANID                                                
         BRAS  RE,GETPID                                                        
         MVC   PLNINF(8),WORK+2                                                 
         MVC   WORK(2),LSTAGY                                                   
         MVC   WORK+2(8),PLNINF                                                 
         BRAS  RE,GETPEN                                                        
         LHI   RF,L'PLNINF-8-2     RF = WIDTH OF COLUMN                         
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   RF,L'PLBOTH-8-2                                                  
         GOTO1 ,DUB,((RF),PLNINF+8+2),(47,WORK+10)                              
         BRAS  RE,CHEVRON                                                       
         DROP  R3                                                               
*                                                                               
CTCFE08  AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'D0' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTD0ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,23                                                      
         BL    CTD0E02                                                          
         CLI   ADRECNUM,37                                                      
         BH    CTD0E02                                                          
         B     CTD0E04                                                          
         DROP  RF                                                               
*                                                                               
CTD0E02  GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTD0E04  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#OPID,L                                                 
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#EFFD,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CTD0E06                                                          
         USING SAOPID,R2           OLD PERSON PID                               
         MVC   PLOINF(L'SAOPIPID),SAOPIPID                                      
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,PLIST,(2,SAOPIDAT),(8,PLOINF),0                          
         DROP  R2                                                               
*                                                                               
CTD0E06  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    CTD0E08                                                          
         USING SAOPID,R3                                                        
         MVC   PLNINF(L'SAOPIPID),SAOPIPID                                      
         AHI   R4,L'PLINE                                                       
         GOTO1 VDATCON,PLIST,(2,SAOPIDAT),(8,PLNINF),0                          
         DROP  R3                                                               
*                                                                               
CTD0E08  B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* X'DF' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(COPY ELEMENT OR 0)                                *         
*       4(R1)   = A(CHANGE ELEMENT OR 0)                              *         
*       8(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTDFELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,23         SECURITY RECORD                              
         BL    CTDFE02                                                          
         CLI   ADRECNUM,37         SECURITY RECORD                              
         BH    CTDFE02                                                          
         B     CTDFE04                                                          
*                                                                               
CTDFE02  GOTO1 APAIRHEX,DMCB,(R2),(R3),(R4)                                     
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
CTDFE04  LR    R5,R4                                                            
         CLI   LSTSRT,SRTSDDS      ONLY DDS INTERESTED IN INTERNAL NUM          
         BNE   CTDFE04A                                                         
         MVC   PLNHDR,LC@NUM       NUMBER                                       
         AHI   R4,L'PLINE                                                       
CTDFE04A MVCDD PLNHDR,CT#FULL,L    NAME                                         
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2               COPY ELEMENT?                                
         BZ    CTDFE06             NO                                           
         USING SAAPGD,R2                                                        
         CLI   LSTSRT,SRTSDDS                                                   
         BNE   CTDFE04B                                                         
         CURED (B2,SAAPGNUM),(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
*                                                                               
CTDFE04B XR    RF,RF               NOW OUTPUT NAME                              
         IC    RF,SAAPGLN                                                       
         AHI   RF,-(SAAPGLNQ+1)                                                 
         BM    CTDFE06                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),SAAPGNAM                                               
         DROP  R2                                                               
*                                                                               
CTDFE06  LR    R4,R5                                                            
         LTR   R3,R3               CHANGE ELEMENT                               
         BZ    CTDFE08                                                          
         USING SAAPGD,R3                                                        
         CLI   LSTSRT,SRTSDDS                                                   
         BNE   CTDFE06A                                                         
         CURED (B2,SAAPGNUM),(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK               
         AHI   R4,L'PLINE                                                       
*                                                                               
CTDFE06A XR    RF,RF               NOW OUTPUT NAME                              
         IC    RF,SAAPGLN                                                       
         AHI   RF,-(SAAPGLNQ+1)                                                 
         BM    CTDFE08                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),SAAPGNAM                                               
         DROP  R3                                                               
*                                                                               
CTDFE08  B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* X'E0' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTE0ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,23                                                      
         BL    CTE0E02                                                          
         CLI   ADRECNUM,37                                                      
         BH    CTE0E02                                                          
         B     CTE0E04                                                          
         DROP  RF                                                               
*                                                                               
CTE0E02  GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTE0E04  LR    R5,R4                                                            
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   CTE0E04A                                                         
         MVC   PLNHDR,LC@NUM                                                    
         AHI   R4,L'PLINE                                                       
CTE0E04A MVCDD PLNHDR,CT#GCODE,L                                                
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CTE0E06                                                          
         USING SAAPCD,R2           TIMESHEET APPROVER GROUP COPY                
*                                                                               
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   CTE0E04B                                                         
         XR    RF,RF                                                            
         ICM   RF,3,SAAPCNUM                                                    
         CURED (RF),(5,PLOINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         AHI   R4,L'PLINE                                                       
*                                                                               
CTE0E04B MVC   PLOINF(L'SAAPCCOD),SAAPCCOD                                      
         MVC   WORK(2),LSTAGY                                                   
         MVC   WORK+2(L'SAAPCCOD),SAAPCCOD                                      
         BRAS  RE,GETAPN                                                        
         GOTO1 ,DUB,(L'PLOINF-8-2,PLOINF+8+2),(30,WORK+10)                      
         BRAS  RE,CHEVRON                                                       
         DROP  R2                                                               
*                                                                               
CTE0E06  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    CTE0E08                                                          
         USING SAAPCD,R3           TIMESHEET APPROVER GROUP CHANGE              
*                                                                               
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   CTE0E06B                                                         
         XR    RF,RF                                                            
         ICM   RF,3,SAAPCNUM                                                    
         CURED (RF),(5,PLNINF),0,ALIGN=LEFT,ZERO=NOBLANK                        
         AHI   R4,L'PLINE                                                       
*                                                                               
CTE0E06B MVC   PLNINF(L'SAAPCCOD),SAAPCCOD                                      
         MVC   WORK(2),LSTAGY                                                   
         MVC   WORK+2(L'SAAPCCOD),SAAPCCOD                                      
         BRAS  RE,GETAPN                                                        
         GOTO1 ,DUB,(L'PLNINF-8-2,PLNINF+8+2),(30,WORK+10)                      
         BRAS  RE,CHEVRON                                                       
         DROP  R3                                                               
*                                                                               
CTE0E08  B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* X'E1' ELEMENT DISPLAY ROUTINE - USER ID                             *         
***********************************************************************         
CTE1PAIR NTR1  BASE=*,LABEL=*                                                   
         L     R6,AELMNTRY                                                      
         USING CTELEMD,R6                                                       
         LM    R2,R3,0(R1)                                                      
         LA    R4,PBLOCK                                                        
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,59         CLIENT CODE LIMIT ACCESS                     
         BE    CTE1P04                                                          
*                                                                               
CTE1P02  BRAS  RE,DEFPAIR                                                       
         B     EXITOK                                                           
*                                                                               
CTE1P04  LHI   R0,L'ELNAMEC        CHOP UP ELEMENT NAME FOR DISPLAY             
         LHI   RF,L'PLELEM                                                      
         LA    R4,PBLOCK                                                        
         GOTO1 VCHOPPER,DMCB,((R0),ELNAMEC),((RF),PLELEM),(C'P',3)              
         DROP  R6                                                               
*                                                                               
CTE1P10  XC    FULL,FULL           LINES USED FOR THIS SET                      
*                                                                               
         MVI   THISSYS,X'FF'       INIT LOWEST SYSTEM                           
         CLC   0(4,R2),EFFS        DONE WITH COPIES?                            
         BE    CTE1P12             YES, SKIP                                    
         L     R1,0(,R2)           R1=A(FIRST COPY)                             
         MVC   THISSYS,SACLASYS-SACLAEL(R1) PRESET COPY AS LOWEST SYS           
CTE1P12  CLC   0(4,R3),EFFS        DONE WITH CHANGES?                           
         BE    CTE1P14             YES, SKIP                                    
         L     R1,0(,R3)           R1=A(FIRST CHANGE)                           
         CLC   THISSYS,SACLASYS-SACLAEL(R1) IS CHANGE SYS LOWER?                
         BNH   CTE1P14             NO, SKIP                                     
         MVC   THISSYS,SACLASYS-SACLAEL(R1) SET CHANGE AS LOWEST                
CTE1P14  CLI   THISSYS,X'FF'       IF LOWEST IS FF, THEN ALL DONE               
         BNE   CTE1P15                                                          
         BRAS  RE,PRNT             PRINT LINES                                  
         B     EXITOK              AND EXIT                                     
*                                                                               
CTE1P15  LR    R6,R2               SEE IF THIS SYSTEM'S ELEMS CHANGED           
         LR    R7,R3                                                            
CTE1P16  LA    RE,EFFS                                                          
         CLC   0(4,R6),EFFS        DONE WITH COPIES?                            
         BE    *+8                 YES, SKIP                                    
         L     RE,0(,R6)           RE=A(NEXT COPY ELEMENT)                      
         LA    RF,EFFS                                                          
         CLC   0(4,R7),EFFS        DONE WITH CHANGES?                           
         BE    *+8                 YES, SKIP                                    
         L     RF,0(,R7)           RF=A(NEXT CHANGE ELEMENT)                    
         CLC   THISSYS,SACLASYS-SACLAEL(RE) IS COPY SAME SYSTEM?                
         BE    CTE1P17             YES, COMPARE ELEMENTS                        
         CLC   THISSYS,SACLASYS-SACLAEL(RF) NO, IS CHANGE SAME SYSTEM?          
         BE    CTE1P18             YES, SO THIS SYSTEM HAS CHANGED              
         LR    R2,R6               ELSE ALL ELEMS FOR THIS SYSTEM WERE          
         LR    R3,R7               THE SAME                                     
         B     CTE1P10             SO SKIP THIS SYSTEM                          
CTE1P17  XR    R1,R1                                                            
         IC    R1,1(,RE)                                                        
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RE),0(RF)       IS THIS PAIR THE SAME?                       
         BNE   CTE1P18             NO, SO THIS SYSTEM HAS CHANGED               
         AHI   R6,4                                                             
         AHI   R7,4                                                             
         B     CTE1P16             TRY NEXT PAIR                                
*                                                                               
CTE1P18  MVC   HALF(1),THISSYS                                                  
         MVI   HALF+1,0                                                         
         BRAS  RE,GETSYPR          OUTPUT SYSTEM                                
         MVC   PLNHDR(8),WORK                                                   
*                                                                               
         L     R0,AIOTEMP          CLEAR OUT BUILD AREA                         
         LHI   R1,100*7                                                         
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         L     R5,AIOTEMP          R5 = A(NEXT IN BUILD AREA)                   
*                                                                               
CTE1P22  CLC   0(4,R2),EFFS        DONE WITH COPIES?                            
         BE    CTE1P24             YES                                          
         L     R6,0(R2)                                                         
         CLC   THISSYS,SACLASYS-SACLAEL(R6) IS THIS THE CURRENT SYSTEM          
         BNE   CTE1P24             NO, SKIP                                     
         BRAS  RE,CTE1DIS                                                       
         AHI   R2,4                                                             
         B     CTE1P22                                                          
*                                                                               
CTE1P24  L     R0,AIOTEMP                                                       
         CR    R5,R0                                                            
         BE    CTE1P30                                                          
*&&US*&& SHI   R5,1                                                             
*&&UK*&& SHI   R5,2                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   RF,L'PLOINF                                                      
         GOTO1 VCHOPPER,DMCB,AIOTEMP,((RF),PLOINF),(C'P',20),          X        
               C'LEN=',(R5)                                                     
         MVC   FULL,8(R1)                                                       
*                                                                               
CTE1P30  L     R0,AIOTEMP          CLEAR OUT BUILD AREA                         
         LHI   R1,100*7                                                         
         XR    RF,RF                                                            
         MVCL  R0,RE                                                            
         L     R5,AIOTEMP          R5 = A(NEXT IN BUILD AREA)                   
*                                                                               
CTE1P32  CLC   0(4,R3),EFFS        FINISHED WITH CHANGES?                       
         BE    CTE1P34             YES                                          
         L     R6,0(R3)                                                         
         CLC   THISSYS,SACLASYS-SACLAEL(R6) IS THIS THE CURRENT SYSTEM          
         BNE   CTE1P34             NO, SKIP                                     
         BRAS  RE,CTE1DIS                                                       
         AHI   R3,4                                                             
         B     CTE1P32                                                          
*                                                                               
CTE1P34  L     R0,AIOTEMP                                                       
         CR    R5,R0                                                            
         BE    CTE1P40                                                          
*&&US*&& SHI   R5,1                                                             
*&&UK*&& SHI   R5,2                                                             
         MVI   0(R5),C' '          REMOVE FINAL COMMA                           
*                                                                               
         SR    R5,R0                                                            
         LHI   R0,L'PLNINF                                                      
         CLI   MODE,MODECHG                                                     
         BE    *+8                                                              
         LHI   R0,L'PLBOTH                                                      
         GOTO1 VCHOPPER,DMCB,AIOTEMP,((R0),PLNINF),(C'P',20),          X        
               C'LEN=',(R5)                                                     
         CLC   FULL,8(R1)                                                       
         BNL   *+10                                                             
         MVC   FULL,8(R1)                                                       
*                                                                               
CTE1P40  ICM   R0,15,FULL          LINES USED                                   
         MHI   R0,L'PLINE                                                       
         AR    R4,R0               NEXT FREE LINE                               
         B     CTE1P10             NEXT SYSTEM                                  
*                                                                               
         USING SACLAD,R6                                                        
CTE1DIS  NTR1  ,                                                                
         LA    R3,SACLACOD         R3=FIRST CLIENT                              
         XR    R4,R4                                                            
         IC    R4,SACLALN                                                       
         SHI   R4,SACLACOD-SACLAEL R4=LENGTH LEFT TO PRINT                      
CTE1D02  BNP   CTE1DX                                                           
*&&US                                                                           
         CLI   SACLASYS,X'04'      PRINT                                        
         BE    CTE1D04                                                          
         GOTO1 VCLUNPK,DMCB,(R3),0(R5) UNPACK IT IF NOT PRINT                   
         B     *+10                                                             
CTE1D04  MVC   0(3,R5),0(R3)       USE 'AS IS' IF PRINT                         
         CLI   2(R5),C' '          ADD A TRAILING COMMA                         
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   3(R5),C','                                                       
         AHI   R5,4                                                             
*&&                                                                             
*&&UK                                                                           
         CLI   0(R3),0             TEST L=XXX                                   
         BNE   CTE1D04             NO, SKIP                                     
         MVC   0(2,R5),=C'L='                                                   
         MVC   2(3,R5),1(R3)                                                    
         AHI   R3,1                L= IS A 4 BYTE ENTRY                         
         SHI   R4,1                AND SHOULD BE THE ONLY ENTRY                 
         B     CTE1D06             GO ADD COMMA                                 
CTE1D04  TM    0(R3),X'80'         TEST NEGATIVE                                
         BO    *+16                NO, SKIP                                     
         OI    0(R3),X'80'         SET THE -VE BIT BACK ON                      
         MVI   0(R5),C'-'          PREFIX WITH A MINUS                          
         AHI   R5,1                BUMP PAST THE MINUS                          
         MVC   0(3,R5),0(R3)       MOVE THREE CHAR CLIENT CODE                  
         MVC   3(2,R5),SPACES                                                   
         TM    1(R3),X'C0'         TEST 5 CHAR PACKED                           
         BNZ   CTE1D06             NO                                           
         XR    R0,R0                                                            
         ICM   R0,3,1(R3)                                                       
         CVD   R0,DUB                                                           
         OI    DUB+L'DUB-1,X'0F'                                                
         UNPK  1(4,R5),DUB                                                      
CTE1D06  CLI   4(R5),C' '          ADD A TRAILING COMMA                         
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVC   5(2,R5),=C', '                                                   
         AHI   R5,7                                                             
*&&                                                                             
         AHI   R3,L'SACLACOD       INCREMENT FOR NEXT CLIENT CODE               
         SHI   R4,L'SACLACOD       DECREMENT LENGTH LEFT TO DO                  
         B     CTE1D02                                                          
CTE1DX   XIT1  REGS=(R5)                                                        
         DROP  R6                                                               
         EJECT                                                                  
***********************************************************************         
* X'E4' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTE4ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,59                                                      
         BE    CTE4E04                                                          
         CLI   ADRECNUM,23                                                      
         BL    CTE4E02                                                          
         CLI   ADRECNUM,37                                                      
         BH    CTE4E02                                                          
         B     CTE4E04                                                          
         DROP  RF                                                               
*                                                                               
CTE4E02  GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTE4E04  LR    R5,R4                                                            
         MVCDD PLNHDR,CT#VALID,L                                                
         AHI   R4,L'PLINE                                                       
         MVCDD PLNHDR,CT#PSWD,L                                                 
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CTE4E12                                                          
         USING SAPWHD,R2           PASSWORD HISTORY                             
*                                                                               
         MVCDD PLOINF,CT#PERM,L                                                 
         CLC   =X'FFFF',SAPWHDTE                                                
         BE    CTE4E06                                                          
         GOTO1 VDATCON,PLIST,(2,SAPWHDTE),(8,PLOINF),0                          
*                                                                               
CTE4E06  XR    R0,R0                                                            
         ICM   R0,7,SAPWHTME                                                    
         BZ    CTE4E08                                                          
         BRAS  RE,PRTTBIN                                                       
         MVC   PLOINF+12(11),WORK                                               
*                                                                               
CTE4E08  TM    SAPWHFLG,SAPWHEXP                                                
         BZ    CTE4E10                                                          
         MVCDD PLOINF+22(16),CT#RST,L PASSWORD RESET BY MANAGER                 
*                                                                               
CTE4E10  AHI   R4,L'PLINE                                                       
         XR    RF,RF                                                            
         IC    RF,SAPWHLN                                                       
         AHI   RF,-(SAPWHLNQ+1)                                                 
         BM    CTE4E12                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),SAPWHPWD                                               
*&&UK*&& MVC   PLOINF(10),=C'**********'                                        
*&&US*&& MVC   PLOINF(10),=C'***       '                                        
         DROP  R2                                                               
*                                                                               
CTE4E12  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    CTE4E20                                                          
         USING SAPWHD,R3           PASSWORD HISTORY                             
*                                                                               
         MVCDD PLNINF,CT#PERM,L                                                 
         CLC   =X'FFFF',SAPWHDTE                                                
         BE    CTE4E14                                                          
         GOTO1 VDATCON,PLIST,(2,SAPWHDTE),(8,PLNINF),0                          
*                                                                               
CTE4E14  XR    R0,R0                                                            
         ICM   R0,7,SAPWHTME                                                    
         BZ    CTE4E16                                                          
         BRAS  RE,PRTTBIN                                                       
         MVC   PLNINF+12(11),WORK                                               
*                                                                               
CTE4E16  TM    SAPWHFLG,SAPWHEXP                                                
         BZ    CTE4E18                                                          
         MVCDD PLNINF+22(16),CT#RST,L PASSWORD RESET BY MANAGER                 
*                                                                               
CTE4E18  AHI   R4,L'PLINE                                                       
         XR    RF,RF                                                            
         IC    RF,SAPWHLN                                                       
         AHI   RF,-(SAPWHLNQ+1)                                                 
         BM    CTE4E20                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),SAPWHPWD                                               
*&&UK*&& MVC   PLNINF(10),=C'**********'                                        
*&&US*&& MVC   PLNINF(10),=C'***       '                                        
         DROP  R3                                                               
*                                                                               
CTE4E20  B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* X'E5' PAIR DISPLAY ROUTINE                                          *         
*                                                                     *         
* NTRY: 0(R1)   = A(ELEMENT)                                          *         
*       4(R1)   = A(PRINT LINE TO USE)                                *         
* EXIT: FULL    = A(NEXT PRINT LINE)                                  *         
***********************************************************************         
CTE5ELM  NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R4,0(R1)                                                      
         USING PLINED,R4                                                        
*                                                                               
         L     RF,AADDNTRY                                                      
         USING ADDTABD,RF                                                       
         CLI   ADRECNUM,23                                                      
         BL    CTE5E02                                                          
         CLI   ADRECNUM,37                                                      
         BH    CTE5E02                                                          
         B     CTE5E04                                                          
         DROP  RF                                                               
*                                                                               
CTE5E02  GOTO1 APAIRHEX,PLIST,(R2),(R3),(R4)                                    
         B     EXITOK                                                           
*                                                                               
CTE5E04  LR    R5,R4                                                            
         AHI   R4,L'PLINE                                                       
         ST    R4,FULL                                                          
*                                                                               
         LR    R4,R5                                                            
         LTR   R2,R2                                                            
         BZ    CTE5E10                                                          
*                                                                               
         USING SAPEED,R2           EMAIL ADDRESS                                
         XR    RF,RF                                                            
         IC    RF,SAPEELN                                                       
         AHI   RF,-(SAPEELNQ+1)                                                 
         BM    CTE5E10                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLOINF(0),SAPEEID                                                
         DROP  R2                                                               
*                                                                               
CTE5E10  LR    R4,R5                                                            
         LTR   R3,R3                                                            
         BZ    CTE5E16                                                          
*                                                                               
         USING SAPEED,R3           PASSWORD HISTORY                             
         XR    RF,RF                                                            
         IC    RF,SAPEELN                                                       
         AHI   RF,-(SAPEELNQ+1)                                                 
         BM    CTE5E16                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   PLNINF(0),SAPEEID                                                
         DROP  R3                                                               
*                                                                               
CTE5E16  B     EXITOK                                                           
         EJECT                                                                  
**********************************************************************          
* ACTIVITY ELEMENT (X'F1' ON CTFILE)                                 *          
* NTRY: R2 = A(ELEMENT)                                              *          
**********************************************************************          
         USING ACTVD,R2                                                         
         LM    R2,R3,0(R1)                                                      
X        USING PLINED,R3                                                        
ACF1ELM  NTR1  BASE=*,LABEL=*                                                   
         LA    R3,PBLOCK+(PLNHDR-PLINED)                                        
         MVCDD 0(L'PLNHDR,R3),GE#RADON,L                                        
         LA    RF,L'PLNHDR+1(R3)                                                
         GOTO1 VDATCON,PLIST,(3,ACTVADDT),(5,0(RF)),0                           
*                                                                               
         LA    RF,L'PLINED/3(R3)                                                
         MVC   0(L'PLNHDR,RF),HCHGON                                            
         AHI   RF,L'PLNHDR+1                                                    
         GOTO1 VDATCON,PLIST,(3,ACTVCHDT),(5,0(RF)),0                           
*                                                                               
         LA    RF,L'PLINED*2/3(R3)                                              
         MVCDD 0(L'PLNHDR,RF),GE#CHGNO,L                                        
         AHI   RF,L'PLNHDR+1                                                    
         CURED (B1,ACTVCHNM),(3,0(RF)),0,ZERO=NOBLANK,ALIGN=LEFT                
*                                                                               
         AHI   R3,L'PLINE                                                       
         MVC   0(L'PLNHDR,R3),HADDBY                                            
         LA    RF,L'PLNHDR+1(R3)                                                
         MVC   HALF,ACTVADID                                                    
         XC    HALF,EFFS                                                        
         BRAS  RE,GETUSRID                                                      
         MVC   0(10,RF),WORK+2                                                  
*                                                                               
         LA    RF,L'PLINED/3(R3)                                                
         MVC   0(L'PLNHDR,RF),HCHGBY                                            
         AHI   RF,L'PLNHDR+1                                                    
         MVC   HALF,ACTVCHID                                                    
         XC    HALF,EFFS                                                        
         BRAS  RE,GETUSRID                                                      
         MVC   0(10,RF),WORK+2                                                  
*                                                                               
         OC    ACTVSCID,ACTVSCID                                                
         BZ    ACF102                                                           
         LA    RF,L'PLINED*2/3(R3)                                              
         MVCDD 0(L'PLNHDR,RF),CT#PID,L                                          
         AHI   RF,L'PLNHDR+1                                                    
         MVC   0(L'ACTVSCID,RF),ACTVSCID                                        
*                                                                               
ACF102   AHI   R3,L'PLINE                                                       
         ST    R3,FULL                                                          
         B     EXITOK                                                           
*                                                                               
HADDBY   DC    CL16'Added by'                                                   
HCHGON   DC    CL16'Changed on'                                                 
HCHGBY   DC    CL16'Changed by'                                                 
         EJECT                                                                  
***********************************************************************         
* OUTPUT PRINT CONTROL ROUTINE                                        *         
***********************************************************************         
PRNT     NTR1  BASE=*,LABEL=*                                                   
         CLI   LSTSRT,SRTSDDS      DDS REPORT                                   
         JE    *+12                                                             
         CLI   PQPFLAG,X'08'       NO, ANY PQ REPORT TO OUTPUT TO               
         JNE   EXITOK                                                           
                                                                                
         L     R1,=A(PBLOCKL-L'PLINE)                                           
         LA    R1,PBLOCK(R1)                                                    
*                                                                               
         LHI   R0,PBLNUMQ                                                       
PRNT02   CLC   0(L'PLINE,R1),SPACES LOOK FOR LAST NON-SPACE LINE                
         BNE   PRNT04                                                           
         AHI   R1,-L'PLINE                                                      
         BCT   R0,PRNT02                                                        
         B     PRNT08                                                           
*                                                                               
PRNT04   LA    R2,PBLOCK                                                        
         CVD   R0,DUB                                                           
         ZAP   FULL,LINE                                                        
         CLI   BOXSTAT,C'I'        INSIDE A BOX ALREADY?                        
         BNE   *+10                YES                                          
         AP    FULL,PONE                                                        
         AP    FULL,PONE                                                        
         AP    FULL,DUB                                                         
         CP    FULL,MAXLINE                                                     
         BL    PRNT06                                                           
         ZAP   LINE,P99            NEW PAGE                                     
*                                                                               
PRNT06   MVC   P(L'PLINE),0(R2)                                                 
         GOTO1 VPRINTER                                                         
         AHI   R2,L'PLINE                                                       
         BCT   R0,PRNT06                                                        
*                                                                               
PRNT08   LA    R0,PBLOCK           CLEAR PBLOCK TO SPACES                       
         L     R1,=A(PBLOCKL)                                                   
         LHI   RF,C' '                                                          
         SLL   RF,32-8                                                          
         MVCL  R0,RE                                                            
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* READ CTFILE                                                         *         
* NTRY: AIOTEMP HOLDS KEY                                             *         
* EXIT: AIOTEMP HOLDS RECORD CC SET                                   *         
***********************************************************************         
CTREAD   NTR1  BASE=*,LABEL=*                                                   
         L     R0,AIOTEMP                                                       
         GOTO1 VDMGR,DMCB,(X'08',DMREAD),CTFILE,(R0),(R0),0                     
         CLI   8(R1),0                                                          
         B     EXIT                                                             
*                                                                               
CTRDHI   NTR1  BASE=*,LABEL=*                                                   
         L     R0,AIOTEMP                                                       
         GOTO1 VDMGR,DMCB,(X'08',DMRDHI),CTFILE,(R0),(R0),0                     
         CLI   8(R1),0                                                          
         B     EXIT                                                             
         EJECT                                                                  
***********************************************************************         
* VALIDATE KEY FIELDS RAGYSEC, RUSER                                  *         
* NTRY: R2      = SRTBLKD                                             *         
* EXIT: RAGYSEC, RUSER AND SRTGRP, SRTUSER CORRECTED                  *         
*       RPERSON, SRTPERS MAY BE ADJUSTED                              *         
*       SRTPWIND WILL BE SET                                          *         
***********************************************************************         
VERKEYS  NTR1  BASE=*,LABEL=*                                                   
         USING SRTBLKD,R2                                                       
         MVI   SRTPWIND,1          NORMAL SETTING                               
RCD      USING RECDS,SRTRECH                                                    
         XR    R3,R3                                                            
         CLI   RCD.RRECTY,1        SEE IF  THIS IS A COPY RECORD                
         BNE   VRKY10              NO                                           
         LH    R3,RCD.RECLN                                                     
         LA    R3,RCD.RECDS(R3)    POINT TO 2ND (CHANGE) RECORD                 
         USING RECDS,R3                                                         
*                                                                               
VRKY10   CLI   RCD.RFILTY,CTFILEQ  SEE IF IT'S A PERSON RECORD CHANGE           
         BNE   VRKY90              NOT CTFILE                                   
         CLI   RCD.RRECTY,1                                                     
         BNE   VRKY90              NOT A CHANGE                                 
         CLI   RCD.RCVFRST,SAPETYPQ                                             
         BNE   VRKY90              NOT A SECURITY RECORD                        
SPR      USING SAPEREC,RCD.RCVFRST                                              
         CLI   SPR.SAPESUB,SAPESUBQ                                             
         BNE   VRKY90              NOT A PERSON RECORD                          
*                                                                               
*        A CHANGE TO A PERSON RECORD COULD HAVE BEEN:                           
*        1. THE RESULT OF A NORMAL CHANGE ACTION BY AN ADMINISTRATOR            
*        2. A PASSWORD CHANGE WHERE THE USER CHOSE TO CHANGE (=PASS)            
*        3. A PASSWORD CHANGE AT CONNECT TIME DUE TO EXPIRED PASSWORD           
*        THE LAST TWO OF THESE NEED TO BE IDENTIFIED AND SEPARATED              
*        OUT FROM NORMAL CHANGES.                                               
*        THE BIG PROBLEM IS THAT A PASSWORD CHANGE AT CONNECT TIME              
*        IS HARD TO IDENTIFY CORRECTLY BECAUSE SEVERAL FIELDS IN THE            
*        TCB HAVE NOT BEEN RESET AT THE TIME THE RECOVERY RECORD IS             
*        WRITTEN, SO THINGS LIKE THE GROUP, PROGRAM AND USER ID MAY             
*        BE NULL, OR WORSE, MAY BE THE VALUES FROM THE LAST CONNECT.            
*        THE FOLLOWING CODE ATTEMMPTS TO IDENTIFY THIS                          
*                                                                               
*        A CHANGE TO A DDS PERSON RECORD WITH THE WRONG GROUP DETAILS           
*        CAN ONLY BE DONE VIA =CT WHILE CONNECTED TO OR PREVIOUSLY              
*        CONNECTED TO ANOTHER AGENCY.                                           
*                                                                               
*        IN THE CASE OF =PASS, IT CAN LOOK LIKE THE CHANGE WAS DONE IN          
*        =SEC IF THAT'S WHAT THE PERSON WAS CONNECTED TO. THE ONLY WAY          
*        TO BE SURE IS IF THE ONLY THING THAT CHANGED WAS THE PASSWORD.         
*        IF =SEC CHANGED IT, THE EFFECTIVE DATE SHOULD CHANGE TOO.              
*                                                                               
*        WHERE WE KNOW IT WAS A FORCED OR VOLUNTARY PASSWORD CHANGE,            
*        THE ONLY PERSON WHO COULD HAVE MADE THE CHANGE IS THE ONE              
*        DETAILED IN THE PERSON RECORD, SO WE CAN FILL IN THE GROUP AND         
*        PERSON FROM THE PERSON RECORD BEING CHANGED.                           
*                                                                               
VRKY60   OC    SRTGRP,SRTGRP       IF WE HAVE NO GROUP, IT MUST BE              
         BZ    VRKY80              A FORCED PASSWORD CHANGE AT CONNECT          
         CLI   RCD.RPRG,0          IF THE PROGRAM IS NULL, THE SAME IS          
         BE    VRKY80              TRUE, SO GROUP IS PROBABLY WRONG             
*&&UK*&& CLC   SPR.SAPEAGY,=C'#E'  IF ITS A DDS SECURITY AGENCY                 
*&&US*&& CLC   SPR.SAPEAGY,=C'#N'  IF ITS A DDS SECURITY AGENCY                 
         BNE   VRKY62                                                           
         CLC   SRTGRP,SPR.SAPEAGY  AND GROUP IS WRONG, MUST BE A SELF           
         BNE   VRKY80              PWD CHANGE SO REPORT TO DDS AGENCY           
*                                                                               
VRKY62   LA    R4,RCD.RCVFRST      GO TO FIRST ACTUAL DATA                      
         LH    R5,SAPELEN-SAPEREC(,R4) DDS RECORD LENGTH                        
         LA    RE,RCVFRST          SAME FOR OLD RECORD                          
         LH    RF,SAPELEN-SAPEREC(,RE)                                          
         CR    R5,RF               COMPARE RECORD LENGTHS                       
         BNE   VRKY90              NOT EQUAL, SO SOME OTHER CHANGES             
*                                                                               
         LR    R1,R4                                                            
         AHI   R1,SAPEDATA-SAPEREC FIND NEW PASSWORD ELEMENT                    
         USING SAPWDD,R1                                                        
         XR    R0,R0                                                            
VRKY64   CLI   SAPWDEL,0                                                        
         BE    VRKY90              CAN'T NOT HAVE A PWDEL                       
         CLI   SAPWDEL,SAPWDELQ                                                 
         BE    VRKY66                                                           
         IC    R0,SAPWDLN                                                       
         AR    R1,R0                                                            
         B     VRKY64                                                           
*                                                                               
VRKY66   LR    R7,R1                                                            
         SR    R7,R4                                                            
         AR    R7,RE               POINT TO SAME ELEMENT IN OLD REC             
         MVC   WORK(L'SAPWDCOD),SAPWDCOD SAVE NEW REC PWD                       
         MVC   SAPWDCOD,SAPWDCOD-SAPWDD(R7) COPY OLD TO NEW                     
         CLCL  R4,RE               TEST RECORDS ARE NOW IDENTICAL               
         MVC   SAPWDCOD,WORK       RESTORE NEW CONTENT                          
         BNE   VRKY90              SKIP IF NOT JUST PWD CHANGE                  
         DROP  R1                                                               
*                                                                               
*        WE ARE NOW PRETTY SURE THIS IS A SELF PASSWORD CHANGE, SO              
*        FORCE GROUP, USER AND PERSON FROM THE PERSON RECORD ITSELF             
*                                                                               
VRKY80   CLI   RPTYPE,C'S'         TEST SECURITY REPORT                         
         BNE   *+8                 NO, SKIP                                     
         MVI   SRTPWIND,0          MARK AS SELF PASSWORD CHANGE                 
         MVC   SRTGRP,SPR.SAPEAGY  USE ALPHA FROM PERSON RECORD                 
         XC    SRTUSER,SRTUSER     AND CLEAR USER SO IT'S SET FROM PID          
         TM    RCD.RTIME,X'40'     TRAILER RECORDS ON THIS RECORD?              
         BZ    VRKY84              NO                                           
         LH    RF,RCD.RECLN        POINT TO 1ST TRAILER RECORD                  
         LA    RF,RCD.RECDS(RF)                                                 
         BCTR  RF,0                                                             
         XR    R0,R0                                                            
         IC    R0,0(RF)                                                         
         LA    RF,1(,RF)                                                        
         SR    RF,R0                                                            
         USING RECVEXT,RF                                                       
         MVC   RAGYSEC,SRTGRP      SET AGENCY                                   
         DROP  RF                                                               
         LH    RF,RECLN            POINT TO COPY TRAILER                        
         LA    RF,RECDS(RF)                                                     
         BCTR  RF,0                                                             
         XR    R0,R0                                                            
         IC    R0,0(RF)                                                         
         LA    RF,1(,RF)                                                        
         SR    RF,R0                                                            
         USING RECVEXT,RF                                                       
         MVC   RAGYSEC,SRTGRP      SET AGENCY                                   
         DROP  RF                                                               
VRKY84   GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SAPWDELQ',SPR.SAPEREC),    X        
               0,0,0,0                                                          
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   VRKY90              NO, LEAVE RPERSON (SHOULD NOT OCCUR)         
         ICM   RF,15,12(R1)                                                     
         MVC   SRTPERS,2(RF)       THIS PERSON MUST HAVE DONE IT                
         MVC   RCD.RPERSON,SRTPERS AND RPERSON IS PROBABLY WRONG ANYWAY         
         MVC   RPERSON,SRTPERS     SET IN COPY REC TOO                          
         DROP  SPR                                                              
*                                                                               
*        IF THE USER IS MISSING, GET IT FROM THE GROUP PRINCIPAL ID.            
*        ELSE JUST PRETEND IT'S DDS                                             
*                                                                               
VRKY90   OC    SRTUSER,SRTUSER     TEST USER SET                                
         BNZ   VRKYX               YES, EXIT                                    
*                                                                               
         OC    SRTGRP,SRTGRP       DO WE HAVE A GROUP                           
         BZ    VRKY92              NO, CAN'T GET FROM PID                       
         MVC   HALF,SRTGRP         USE GROUP PRINCIPLE ID AS USER               
         BRAS  RE,GETAGYID                                                      
         MVC   SRTUSER,WORK                                                     
         OC    SRTUSER,SRTUSER     MAKE SURE USER SET NOW                       
         BNZ   VRKY94                                                           
VRKY92   DS    0H                                                               
*&&US*&& MVC   SRTUSER,=AL2(17)    IF NOT, USE DDS                              
*&&UK*&& MVC   SRTUSER,=AL2(38)    IF NOT, USE DDS                              
VRKY94   MVC   RCD.RUSER,SRTUSER                                                
         LTR   R3,R3               THERE WON'T BE A COPY FOR AN ADD.            
         BZ    *+10                                                             
         MVC   RUSER,SRTUSER                                                    
*                                                                               
VRKYX    B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* GET PROFILE FOR A GROUP AND SET DEFAULTS                            *         
* NTRY: LSTPRFGP= ALPHA ID                                            *         
* EXIT: LSTPRF  = 16 PROFILES                                         *         
***********************************************************************         
GETPRF   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVI   LSTPRFPP,C' '       PRESET NOT PPS                               
         MVI   LSTPRFCY,0          CLEAR COUNTRY                                
         MVC   LSTPRF,SPACES       PRESET BLANK PROFILES                        
         GOTO1 VBINSRCH,PRFPARMS,LSTPRFS FIND EXACT MATCH, DON'T ADD            
         CLI   0(R1),0             TEST FOUND                                   
         BNE   GPRF02              NO, USE BLANK                                
         L     RF,0(R1)                                                         
         MVC   LSTPRFS,0(RF)       YES, COPY FROM TABLE                         
GPRF02   BRAS  RE,SETPRF                                                        
GPRFX    B     EXITOK                                                           
***********************************************************************         
* SET PROFILE DEFAULTS                                                *         
* NTRY: LSTPRFGP= ALPHA ID                                            *         
*       LSTPRF  = 16 PROFILES                                         *         
***********************************************************************         
SETPRF   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
SPRF01   CLI   LSTPRF01,C'U'       VALIDATE PROFILE 01 - LEVEL                  
         BE    SPRF02              USER ID LEVEL REQUIRED                       
         CLI   LSTPRF01,C'A'                                                    
         BE    SPRF02              SECURITY AGENCY LEVEL REQUIRED               
         CLI   LSTPRF01,C'B'                                                    
         BE    SPRF02              BOTH LEVELS REQUIRED                         
*&&UK*&& CLI   LSTPRF01,C'N'                                                    
*&&UK*&& BE    SPRF02              NO REPORT REQUIRED                           
         MVI   LSTPRF01,C'A'       ELSE SECURITY AGENCY IS DEFAULT              
*&&UK*&& CLI   LSTPRFCY,3          EXCEPT FOR GERMANY                           
*&&UK*&& BNE   SPRF02                                                           
*&&UK*&& MVI   LSTPRF01,C'U'       USER ID IS DEFAULT FOR GERMANY               
*                                                                               
SPRF02   CLI   LSTPRF02,C'T'       VALIDATE PROFILE 02 - SEQUENCE               
         BE    SPRF03              TIME SEQUENCE REQUIRED (SOLE US OPT)         
*&&UK*&& CLI   LSTPRF02,C'R'                                                    
*&&UK*&& BE    SPRF03              RECORD KEY SEQUENCE REQUIRED                 
*&&UK*&& MVI   LSTPRF02,C'R'       ELSE KEY SEQUENCE IS DEFAULT FOR EU          
*&&US*&& MVI   LSTPRF02,C'T'       TIME SEQUENCE IS SOLE US VALUE               
*                                                                               
SPRF03   CLI   LSTPRF03,C'Y'       VALIDATE PROFILE 03 - EMPTY REPORT           
         BE    SPRF04              EMPTY REPORT REQUIRED IF NO DATA             
         CLI   LSTPRF03,C'N'                                                    
         BE    SPRF04              NO REPORT REQUIRED IF NO DATA                
         MVI   LSTPRF03,C'N'       N IS DEFAULT                                 
*&&US                                                                           
         CLI   LSTPRFPP,C'Y'       FOR US PPS AGENCY                            
         BNE   *+8                                                              
         MVI   LSTPRF03,C'Y'       Y IS DEFAULT                                 
*&&                                                                             
*                                                                               
SPRF04   CLI   RPTYPE,C'S'         VALIDATE PROFILE 04 - SELF PW CHG            
         BNE   SPRF05              ONLY APPLIES IF SECURITY REPORT              
         CLI   LSTPRF04,C'I'                                                    
         BE    SPRF05              INCLUDE SELF PASSWORD CHANGES                
*&&UK                                                                           
         CLI   LSTPRF04,C'X'                                                    
         BE    SPRF05              EXCLUDE SELF PASSWORD CHANGES                
*&&                                                                             
         CLI   LSTPRF04,C'S'                                                    
         BE    SPRF05              SEPARATE SELF PASSWORD CHANGES               
         MVI   LSTPRF04,C'I'       INCLUDE IS THE DEFAULT                       
*                                                                               
*&&UK                                                                           
SPRF05   CLI   LSTPRF05,C'Y'       VALIDATE PROFILE 05 - SHOW CHGR NAME         
         BE    SPRF06                                                           
         MVI   LSTPRF05,C'N'       N IS DEFAULT FOR UK                          
*&&                                                                             
*&&US                                                                           
SPRF05   MVI   LSTPRF05,C'Y'       Y IS ONLY VALUE ALLOWED FOR US               
*&&                                                                             
*                                                                               
SPRF06   DS    0H                                                               
*                                                                               
SPRFX    B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* READ CTFILE FOR A USERID                                            *         
* NTRY: HALF    = USERID TO READ                                      *         
* EXIT: WORK    = USERID(2)/USERNAME(10)/LANG(1)                      *         
***********************************************************************         
GETUSRID NTR1  BASE=*,LABEL=*                                                   
         XC    WORK(13),WORK       CLEAR                                        
         MVC   WORK(2),HALF                                                     
*                                                                               
         CLC   LSTNUM,WORK         TEST ALREADY GOT IT                          
         BNE   GUSR10                                                           
         MVC   WORK+2(11),LSTNAM   YES, RETURN SAVED                            
         B     EXITOK                                                           
*                                                                               
GUSR10   L     R3,AIOTEMP                                                       
         USING CTIREC,R3                                                        
         XC    CTIKEY,CTIKEY                                                    
         MVI   CTIKTYP,CTIKTYPQ    SET UP KEY FOR USERID                        
         MVC   CTIKNUM,HALF                                                     
         BRAS  RE,CTREAD                                                        
         BNE   GUSRBAD                                                          
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(2,CTIREC),0,0,0,0                    
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GUSRBAD                                                          
*                                                                               
         ICM   RF,15,12(R1)                                                     
         CLI   1(RF),4             LENGTH MUST BE >4                            
         BNH   GUSRBAD                                                          
         MVC   WORK+2(10),2(RF)                                                 
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(6,CTIREC),0,0,0,0                    
         CLI   12(R1),0            CTAGY ELEMENT FOUND?                         
         BNE   GUSRX                                                            
         L     RF,12(R1)                                                        
         MVC   WORK+12(1),CTAGYLNG-CTAGYD(RF) COPY AGENCY LANGUAGE              
         CLI   WORK+12,2           IS IT FOREIGN                                
         BH    *+8                                                              
         MVI   WORK+12,0           NO, SET DEFAULT LANG                         
         B     GUSRX                                                            
*                                                                               
GUSRBAD  MVC   WORK+2(10),SPACES                                                
         MVI   WORK+2,C'#'                                                      
         CURED HALF,(6,WORK+3),0,ALIGN=LEFT,ZERO=NOBLANK                        
*                                                                               
GUSRX    MVC   LSTCTFRD,WORK       SAVE LAST VALUES                             
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* READ CTFILE FOR SYSELS                                              *         
* NTRY: HALF     = USERID TO READ                                     *         
* EXIT: SVSYSELS = SYSELS FROM USER ID RECORD                         *         
***********************************************************************         
GETSYELS NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         LH    R2,=Y(SVSYSELS-WORKD)                                            
         AR    R2,RC                                                            
         MVI   0(R2),0             SET SVSYSELS EMPTY                           
*                                                                               
         L     R3,AIOTEMP                                                       
         USING CTIREC,R3                                                        
         XC    CTIKEY,CTIKEY                                                    
         MVI   CTIKTYP,CTIKTYPQ    SET UP KEY FOR USERID                        
         MVC   CTIKNUM,HALF                                                     
         BRAS  RE,CTREAD                                                        
         BNE   GSYEX                                                            
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'21',CTIREC),0,0,0,0                
         CLI   12(R1),0            ELEMENTS FOUND?                              
         BNE   GSYEX               NO                                           
*                                                                               
         ICM   RE,15,12(R1)        RE=FIRST CTSYSEL                             
         LR    RF,RE                                                            
         XR    R0,R0                                                            
*                                                                               
GSYE10   IC    R0,1(,RF)           LOOK FOR END                                 
         AR    RF,R0                                                            
         CLI   0(RF),X'21'                                                      
         BE    GSYE10                                                           
*                                                                               
         SR    RF,RE               RF=TOTAL LENGTH OF SYSELS                    
         LR    R0,R2                                                            
         LA    R1,1(,RF)           PAD A ZERO ONTO THE END                      
         MVCL  R0,RE               COPY THEM ALL TO SVSYSELS                    
*                                                                               
GSYEX    B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO MOVE AGY ALPHA + PRINCIPLE ID TO PRINT LINE              *         
* NTRY: HALF    = AGYID TO READ                                       *         
*       WORK    = AGYID(2)/AGY NAME(10)                               *         
* EXIT: SPROUT  = DISPLAYABLE FORMAT (22)                             *         
***********************************************************************         
DISAGYAL NTR1  BASE=*,LABEL=*                                                   
         MVC   SPROUT,SPACES                                                    
         MVC   SPROUT(L'HALF),HALF                                              
         BRAS  RE,GETAGYID                                                      
         MVI   SPROUT+10,C'<'                                                   
         MVC   SPROUT+11(10),WORK+2                                             
         LA    RF,SPROUT+20                                                     
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         MVI   1(RF),C'>'                                                       
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* READ CTFILE FOR AN AGENCY ID                                        *         
* NTRY: HALF    = AGYID TO READ                                       *         
* EXIT: WORK    = SEC PIDNO(2)/PIDNM(10)/LNG(1)/CTY(1)/SECAG(2)/PPS(1)*         
***********************************************************************         
GETAGYID NTR1  BASE=*,LABEL=*                                                   
         XC    WORK(17),WORK       CLEAR OUTPUT                                 
         MVC   WORK(2),HALF                                                     
*                                                                               
         L     R3,AIOTEMP                                                       
         USING CT5REC,R3                                                        
         XC    CT5KEY,CT5KEY                                                    
         MVI   CT5KTYP,CT5KTYPQ    SET UP KEY FOR ALPHA ID                      
         MVC   CT5KALPH,HALF                                                    
         BRAS  RE,CTREAD                                                        
         BNE   GALFBAD                                                          
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B4',(R3)),0,0,0,0                  
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GALF20                                                           
         L     RF,12(R1)                                                        
         USING CTAGDD,RF                                                        
         CLI   CTAGDLEN,CTAGDLNQ                                                
         BNH   *+10                                                             
         MVC   WORK+13(1),CTAGDCTY COUNTRY                                      
         DROP  RF                                                               
*                                                                               
GALF20   GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'02',(R3)),0,0,0,0                  
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GALFBAD                                                          
*                                                                               
         L     RF,12(R1)                                                        
         MVC   HALF,2(RF)          (CONTROL) PID                                
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'BE',(R3)),0,0,0,0                  
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GALF30                                                           
*                                                                               
         L     RF,12(R1)                                                        
         MVC   HALF,2(RF)          SECURITY PID PREFERRED IF THERE              
*                                                                               
GALF30   GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B8',(R3)),0,0,0,0                  
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GALF40                                                           
*                                                                               
         L     RF,12(R1)                                                        
         MVC   WORK+14(2),2(RF)    SECURITY AGENCY ALPHA ID                     
*                                                                               
GALF40   GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'B9',(R3)),0,0,0,0                  
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GALF50                                                           
*                                                                               
         L     RF,12(R1)                                                        
         MVC   WORK+16(1),CTAADFLG-CTAADD(RF) PPS FLAG                          
*                                                                               
GALF50   BRAS  RE,GETUSRID                                                      
         B     EXITOK                                                           
*                                                                               
GALFBAD  MVC   WORK+2(10),LC@UNKNW                                              
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* READ CTFILE FOR A PERSON ID                                         *         
* NTRY: FULL    = AGY ALPHA (2) PERSON PASSWORD (2)                   *         
* EXIT: WORK    = PERSON ID(2)/PERSON NAME(8)                         *         
***********************************************************************         
GETPID   NTR1  BASE=*,LABEL=*                                                   
         MVC   WORK(10),SPACES     CLEAR OUTPUT AREA                            
         MVC   WORK(2),FULL+2                                                   
*                                                                               
         L     R3,AIOTEMP                                                       
         USING SA0REC,R3                                                        
         XC    SA0KEY,SA0KEY                                                    
         MVI   SA0KTYP,SA0KTYPQ    SET UP KEY FOR USERID                        
         MVC   SA0KAGY,FULL                                                     
         MVC   SA0KNUM,FULL+2                                                   
*                                                                               
         CLC   SA0KNUM,=Y(4096)                                                 
         BNL   GETPID20                                                         
*&&UK*&& CLC   SA0KAGY,=C'#E'                                                   
*&&US*&& CLC   SA0KAGY,=C'#N'      TEST DDS SECURITY AGENCY                     
         BE    GETPID20                                                         
*&&UK*&& MVC   SA0KAGY,=C'#E'                                                   
*&&US*&& MVC   SA0KAGY,=C'#N'      SWITCH TO DDS SECURITY AGENCY                
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BE    GETPID20                                                         
         MVC   SA0KNUM,=Y(1)       NO, SHOW FIRST (GENERIC) ENTRY               
*                                                                               
GETPID20 GOTO1 VDMGR,DMCB,(X'22',DMREAD),CTFILE,(R3),(R3)                       
         CLI   8(R1),0                                                          
         BNE   GPIDBAD                                                          
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),(X'C3',SA0REC),0,0,0,0                
         CLI   12(R1),0            ELEMENT FOUND?                               
         BNE   GPIDBAD                                                          
*                                                                               
         L     RF,12(R1)                                                        
         MVC   WORK+2(8),2(RF)                                                  
         B     EXITOK                                                           
*                                                                               
GPIDBAD  MVC   WORK+2(8),LC@UNKNW                                               
         B     EXITOK                                                           
         DROP  R3                                                               
         EJECT                                                                  
***********************************************************************         
* READ CTFILE FOR A TERMINAL ID                                       *         
***********************************************************************         
GETTRM   NTR1  BASE=*,LABEL=*                                                   
         L     R2,AIOSORT                                                       
         USING RECDS,R2                                                         
         XC    LSTCTFRT,LSTCTFRT   CLEAR LAST READ                              
         MVC   LSTTNUM,RTRM                                                     
         MVC   LSTTNAM,QUERY                                                    
*                                                                               
         CLI   TRAILER,C'Y'        TRAILER RECORDS?                             
         BNE   GTRM02              NO                                           
         LH    RF,0(R2)                                                         
         AR    RF,R2                                                            
         BCTR  RF,0                                                             
         XR    R0,R0                                                            
         IC    R0,0(RF)                                                         
         AHI   RF,1                                                             
         SR    RF,R0                                                            
         USING RECVEXT,RF                                                       
         MVC   LSTTNAM,RLUID                                                    
         TM    RCTSTAT,RCTSTTKT                                                 
         BZ    EXITOK                                                           
         MVI   LSTTISTK,C'Y'                                                    
         B     EXITOK                                                           
         DROP  RF                                                               
*                                                                               
GTRM02   L     R3,AIOTEMP                                                       
         USING CTTREC,R3                                                        
         XC    CTTKEY,CTTKEY                                                    
         MVI   CTTKTYP,CTTKTYPQ                                                 
         MVC   23(2,R3),RTRM                                                    
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,(R3),(R3)                               
         CLI   8(R1),0                                                          
         BE    GTRM04                                                           
         MVC   LSTTNAM,SPACES                                                   
         CURED RTRM,(6,LSTTNAM),0,ALIGN=LEFT,ZERO=NOBLANK                       
         B     EXITOK                                                           
*                                                                               
GTRM04   GOTO1 VHELLO,PLIST,(C'G',CTFILE),(3,(R3)),0,0,0,0                      
         CLI   12(R1),0                                                         
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         L     RF,12(R1)                                                        
         MVC   LSTTNAM,2(RF)                                                    
         CLC   LSTTNAM(2),=C'AA'    CHARACTERS?                                 
         BNL   EXITOK                                                           
         MVC   LSTTNAM,=CL8'Automate'                                           
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO PRINT OUT SYSTEM/PROGRAM                                 *         
* NTRY:  HALF       = SYSTEM (SYSLST) / PROGRAM (PROGRAM MAY BE NULL) *         
* EXIT:  WORK+00(8) = SYSTEM LEFT ALIGNED SPACE FILLED                *         
* EXIT:  WORK+08(8) = PROGAM LEFT ALIGNED SPACE FILLED                *         
***********************************************************************         
GETSYPR  NTR1  BASE=*,LABEL=*                                                   
         MVC   WORK(16),SPACES                                                  
*                                                                               
         L     R1,VSYSLST                                                       
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         AHI   R1,6                                                             
         USING SYSLSTD,R1                                                       
         CLC   SYSLNUM,HALF                                                     
         BE    GSYPR02                                                          
         BXLE  R1,RE,*-10                                                       
         GOTO1 VHEXOUT,PLIST,HALF,WORK,1                                        
         MVC   WORK+08(8),QUERY                                                 
         B     EXITOK                                                           
*                                                                               
GSYPR02  MVC   WORK(L'SYSLNAME),SYSLNAME                                        
*                                                                               
         L     R1,VSELIST                                                       
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         AHI   R1,6                                                             
         USING SELISTD,R1                                                       
         CLC   SEOVSYS,HALF                                                     
         BE    *+10                                                             
         BXLE  R1,RE,*-10                                                       
         DC    H'0'                                                             
*                                                                               
         CLI   HALF+1,0                                                         
         BE    EXITOK                                                           
         L     R1,SEPGMS                                                        
         LH    RE,0(R1)                                                         
         L     RF,2(R1)                                                         
         LA    R1,6(R1)                                                         
         USING PGMLSTD,R1          FIND PGMLST ENTRY                            
GSYPR04  CLC   PGMNUM,HALF+1                                                    
         BNE   GSYPR06                                                          
         CLC   PGMCTRY,AGYCTRY     MATCH ON COUNTRY                             
         BE    GSYPR08                                                          
         CLI   PGMCTRY,0           OR DEFAULT COUNTRY (COMES LAST)              
         BE    GSYPR08                                                          
GSYPR06  BXLE  R1,RE,GSYPR04                                                    
         GOTO1 VHEXOUT,PLIST,HALF+1,WORK+8,1                                    
         B     EXITOK                                                           
*                                                                               
GSYPR08  MVC   WORK+8(L'PGMNAME),PGMNAME                                        
         B     EXITOK                                                           
         DROP  R1                                                               
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY SYSTEMS TEXT                                     *         
* NTRY: P1 BYTE 0 = X'80' ON IF TEXT #=0 MEANS USE DICTIONARY         *         
*                 = SYSTEM OVERLAY NUMBER                             *         
*             1-3 = A(TEXT NUMBER)                                    *         
*       P2        = A(DICTIONARY REF #) (IF REQUIRED)                 *         
* EXIT: WORK(64)  = TEXT                                              *         
***********************************************************************         
DISTXT   NTR1  BASE=*,LABEL=*                                                   
         LM    R2,R3,0(R1)                                                      
         MVC   WORK(64),SPACES                                                  
         MVC   BYTE,0(R1)                                                       
         NI    BYTE,255-X'80'                                                   
*                                                                               
         TM    0(R1),X'80'                                                      
         BZ    DISTXT02                                                         
         OC    0(2,R2),0(R2)                                                    
         BNZ   DISTXT02                                                         
         GOTO1 ADISDIC,PLIST,(BYTE,64),(C'L',(R3))                              
         B     EXITOK                                                           
*                                                                               
DISTXT02 LA    R1,PLIST                                                         
         USING GETTXTD,R1                                                       
         XC    GTBLOCK,GTBLOCK                                                  
         MVC   GTMSGNO,0(R2)                                                    
         MVI   GTMAXL,64                                                        
         LA    R0,WORK                                                          
         STCM  R0,7,GTAOUT                                                      
         MVI   GTMTYP,GTMSCR                                                    
         OI    GT1INDS,GT1OWRK                                                  
         MVC   GTMSYS,BYTE                                                      
         MVC   GTMLANG,DDPLANG                                                  
         GOTO1 VGETTXT                                                          
         TM    GT1INDS,GT1NOMSG                                                 
         BZ    EXITOK                                                           
         MVC   WORK(16),QUERY                                                   
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY A DICTIONARY WORD                                *         
*                                                                     *         
* NTRY: P1 BYTE 0 = X'80' ON TO RETURN DICTIONARY EQUATE TEXT         *         
*                 = SYSTEM OVERLAY NUMBER                             *         
*               3 = L(WORD)                                           *         
*       P2 BYTE 0 = C'U' TO RETURN WORD IN UPPER CASE                 *         
*                   C'L' TO RETURN WORD IN LOWER CASE                 *         
*             1-3 = A(DICTIONARY REFERENCE #)                         *         
* EXIT: WORK+00 = DICTIONARY WORD                                     *         
*       WORK+64 = DICTIONARY EQUATE (IF REQUIRED)                     *         
***********************************************************************         
DISDIC   NTR1  BASE=*,LABEL=*                                                   
         MVC   DUB,0(R1)           SAVE INPUT PARAMETERS                        
*                                                                               
         MVI   PLIST,C'S'          SET UP DICTATE PARAMETER 1                   
         MVC   PLIST+1(1),DUB+4                                                 
         MVC   PLIST+2(1),DUB                                                   
         NI    PLIST+2,255-X'80'                                                
         MVC   PLIST+3(1),DDPLANG                                               
*                                                                               
         XC    WORK(64),WORK       SET UP DICTATE ESCAPE SEQUENCE               
         MVI   WORK,CT#ESCL                                                     
         MVC   WORK+3(1),DUB+3                                                  
         L     R1,DUB+4                                                         
         MVC   WORK+1(2),0(R1)                                                  
*                                                                               
         GOTO1 VDICTATE,PLIST,,WORK                                             
*                                                                               
         TM    DUB,X'80'           TEST DICTIONARY EQUATE REQUIRED              
         BZ    EXITOK                                                           
*                                                                               
         LA    R2,KEY                                                           
         USING GMSGD,R2                                                         
         XC    GMKEY,GMKEY                                                      
         MVI   GMKREC,GMKRECQ                                                   
         MVC   GMKSYS,DUB                                                       
         NI    GMKSYS,255-X'80'                                                 
         MVI   GMKTYP,GMKTGDIC                                                  
         L     R1,DUB+4                                                         
         MVC   GMKMSG,0(R1)                                                     
*                                                                               
         MVC   KEYSAVE,KEY                                                      
         GOTO1 VDMGR,DMCB,(X'08',DMRDHI),GENDIR,KEY,KEY,0                       
         CLI   8(R1),0                                                          
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         CLC   GMKEY(GMKLANG-GMKEY),KEYSAVE                                     
         BE    *+6                                                              
         DC    H'0'                                                             
*                                                                               
         L     R2,AIOTEMP                                                       
         GOTO1 VDMGR,DMCB,GETREC,GENFIL,GMDDA,(R2),DMWORK                       
         LA    R3,GMFIRST(R2)                                                   
         USING GMQSYD,R3                                                        
         XR    RF,RF                                                            
         CLI   GMQSYEL,GMQSYELC                                                 
         BE    *+12                                                             
         IC    RF,GMQSYELL                                                      
         BXH   R3,RF,*-12                                                       
*                                                                               
         MVC   WORK+64(L'GMQSYSYM),GMQSYSYM                                     
         B     EXITOK                                                           
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY A FORMATTED CODE                                 *         
*                                                                     *         
* NTRY: P1    = (FORMAT OF CODE, A(CODE))                             *         
* EXIT: WORK  = OUTPUT                                                *         
***********************************************************************         
DISCODE  NTR1  BASE=*,LABEL=*                                                   
         MVC   WORK(10),SPACES                                                  
         L     R2,0(R1)                                                         
*                                                                               
         CLI   0(R1),SAPGMIFA      DISPLAY ALPHAMERIC                           
         BNE   DCODE02                                                          
         MVC   WORK(1),0(R2)                                                    
         B     EXITOK                                                           
*                                                                               
DCODE02  CLI   0(R1),SAPGMIFN      DISPLAY NUMERIC                              
         BNE   DCODE04                                                          
         CURED (B1,0(R2)),(3,WORK),0,ALIGN=LEFT,ZERO=NOBLANKA                   
         B     EXITOK                                                           
*                                                                               
DCODE04  GOTO1 VHEXOUT,PLIST,0(R2),WORK,1,0 DISPLAY HEX                         
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY ACCESS GROUP CODE                                *         
*                                                                     *         
* NTRY: FULL   = AGY ALPHA (2) AGY GROUP CODE (2)                     *         
* EXIT: WORK   = ACCESS GROUP CODE/NAME                               *         
***********************************************************************         
GETACG   NTR1  BASE=*,LABEL=*      R4=A(ACCESS GROUP NUMBER)                    
         MVC   WORK(40),SPACES                                                  
*                                                                               
         L     R2,AIOTEMP                                                       
         USING SAAGREC,R2                                                       
         XC    SAAGKEY,SAAGKEY                                                  
         MVI   SAAGTYP,SAAGTYPQ                                                 
         MVI   SAAGSUB,SAAGSUBQ                                                 
         MVC   SAAGAGY,FULL                                                     
         MVI   SAAGKEY+L'SAAGKEY-1,X'01'                                        
         MVC   WORK+40(25),0(R2)   SAVE START KEY                               
         GOTO1 VDMGR,DMCB,DMRDHI,CTFILE,(R2),(R2)                               
         CLI   8(R1),0                                                          
         B     GAGC04                                                           
*                                                                               
GAGC02   GOTO1 VDMGR,DMCB,DMRSEQ,CTFILE,(R2),(R2)                               
*                                                                               
GAGC04   CLC   SAAGKEY(SAAGAGR-SAAGKEY),WORK+40                                 
         BE    GAGC06                                                           
         CURED (B2,FULL+2),(5,WORK),0,ALIGN=LEFT,ZERO=NOBLANK                   
         B     EXITOK                                                           
*                                                                               
GAGC06   GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SAAGNELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   GAGC02                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SAAGND,RF           RF=A(AGENCY ELEMENT)                         
         CLC   SAAGNNUM,FULL+2     MATCH ON AGENCY NUMBER                       
         BNE   GAGC02                                                           
*                                                                               
         MVC   WORK+00(L'SAAGAGR),SAAGAGR                                       
         CLI   SAAGNLN,SAAGNLNQ                                                 
         BNH   EXITOK                                                           
         XR    R1,R1                                                            
         IC    R1,SAAGNLN                                                       
         AHI   R1,-(SAAGNLNQ+1)                                                 
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK+08(0),SAAGNNAM                                              
         B     EXITOK                                                           
         DROP  R2,RF                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY PERSON NAME                                      *         
*                                                                     *         
* NTRY: WORK    = AGY ALPHA (2) PERSON CODE (8)                       *         
* EXIT: WORK+10 = PERSON NAME (47 = 3 X 15 + 2)                       *         
***********************************************************************         
GETPEN   NTR1  BASE=*,LABEL=*      R4=A(ACCESS GROUP NAME)                      
         MVC   WORK+10(47),SPACES                                               
*                                                                               
         L     R2,AIOTEMP                                                       
         USING SAPEREC,R2                                                       
         XC    SAPEKEY,SAPEKEY                                                  
         MVI   SAPETYP,SAPETYPQ                                                 
         MVI   SAPESUB,SAPESUBQ                                                 
         MVC   SAPEAGY,WORK                                                     
         MVC   SAPEPID,WORK+2                                                   
         MVC   WORK+57(25),SAPEREC                                              
         GOTO1 VDMGR,DMCB,DMRDHI,CTFILE,(R2),(R2)                               
         CLI   8(R1),0                                                          
         BNE   EXITOK                                                           
         CLC   SAPEREC(SAPEDEF-SAPEREC),WORK+57                                 
         BNE   EXITOK                                                           
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SANAMELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SANAMD,RF           RF=A(PERSON NAME ELEMENT)                    
         XR    R1,R1                                                            
         IC    R1,SANAMLN                                                       
         AHI   R1,-(SANAMLNQ+1+1)                                               
         BM    EXITOK                                                           
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK+10(0),SANAME                                                
         LA    RF,WORK+10(R1)      CLEAR OUT LENGTHS                            
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         MVI   0(RF),C' '                                                       
         BCTR  RF,0                                                             
         BCT   R1,*-14                                                          
         B     EXITOK                                                           
         DROP  R2,RF                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY ACCESS GROUP NAME                                *         
*                                                                     *         
* NTRY: WORK    = AGY ALPHA (2) ACCESS GROUP CODE (8)                 *         
* EXIT: WORK+10 = ACCESS GROUP NAME                                   *         
***********************************************************************         
GETAGN   NTR1  BASE=*,LABEL=*      R4=A(ACCESS GROUP NAME)                      
         MVC   WORK+10(30),SPACES                                               
*                                                                               
         L     R2,AIOTEMP                                                       
         USING SAAGREC,R2                                                       
         XC    SAAGKEY,SAAGKEY                                                  
         MVI   SAAGTYP,SAAGTYPQ                                                 
         MVI   SAAGSUB,SAAGSUBQ                                                 
         MVC   SAAGAGY,WORK                                                     
         MVC   SAAGAGR,WORK+2                                                   
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,(R2),(R2)                               
         CLI   8(R1),0                                                          
         BNE   EXITOK                                                           
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SAAGNELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SAAGND,RF           RF=A(ACCESS GROUP ELEMENT)                   
         XR    R1,R1                                                            
         IC    R1,SAAGNLN                                                       
         AHI   R1,-(SAAGNLNQ+1)                                                 
         BM    EXITOK                                                           
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK+10(0),SAAGNNAM                                              
         B     EXITOK                                                           
         DROP  R2,RF                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY OFFICE NAME                                      *         
*                                                                     *         
* NTRY: FULL   = AGY ALPHA (2) OFFICE CODE (2)                        *         
* EXIT: WORK   = OFFICE NAME                                          *         
***********************************************************************         
GETOFN   NTR1  BASE=*,LABEL=*      R4=A(OFFICE NAME)                            
         MVC   WORK(30),SPACES                                                  
*                                                                               
         L     R2,AIOTEMP                                                       
         USING SAOFREC,R2                                                       
         XC    SAOFKEY,SAOFKEY                                                  
         MVI   SAOFTYP,SAOFTYPQ                                                 
         MVI   SAOFSUB,SAOFSUBQ                                                 
         MVC   SAOFAGY,FULL                                                     
         MVC   SAOFOID,FULL+2                                                   
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,(R2),(R2)                               
         CLI   8(R1),0                                                          
         BNE   EXITOK                                                           
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SAOFFELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SAOFFD,RF           RF=A(OFFICE ELEMENT)                         
         XR    R1,R1                                                            
         IC    R1,SAOFFLN                                                       
         AHI   R1,-(SAOFFLNQ+1)                                                 
         BM    EXITOK                                                           
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK(0),SAOFFNAM                                                 
         B     EXITOK                                                           
         DROP  R2,RF                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY DEPARTMENT NAME                                  *         
*                                                                     *         
* NTRY: WORK   = AGY ALPHA (2) OFFICE CODE (2) DEPT CODE (3)          *         
* EXIT: WORK+7 = DEPARTMENT NAME                                      *         
***********************************************************************         
GETDPN   NTR1  BASE=*,LABEL=*      R4=A(DEPARTMENT NAME)                        
         MVC   WORK+7(30),SPACES                                                
*                                                                               
         L     R2,AIOTEMP                                                       
         USING SADPREC,R2                                                       
         XC    SADPKEY,SADPKEY                                                  
         MVI   SADPTYP,SADPTYPQ                                                 
         MVI   SADPSUB,SADPSUBQ                                                 
         MVC   SADPAGY,WORK                                                     
         MVC   SADPOID,WORK+2                                                   
         MVC   SADPDID,WORK+4                                                   
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,(R2),(R2)                               
         CLI   8(R1),0                                                          
         BNE   EXITOK                                                           
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SADPTELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SADPTD,RF           RF=A(DEPARTMENT ELEMENT)                     
         XR    R1,R1                                                            
         IC    R1,SADPTLN                                                       
         AHI   R1,-(SADPTLNQ+1)                                                 
         BM    EXITOK                                                           
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK+7(0),SADPTNAM                                               
         B     EXITOK                                                           
         DROP  R2,RF                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO DISPLAY APPROVER NAME                                    *         
*                                                                     *         
* NTRY: WORK    = AGY ALPHA (2) APPROVER GROUP CODE (8)               *         
* EXIT: WORK+10 = APPROVER GROUP NAME (30)                            *         
***********************************************************************         
GETAPN   NTR1  BASE=*,LABEL=*      R4=A(APROVER GROUP)                          
         MVC   WORK+10(30),SPACES                                               
*                                                                               
         L     R2,AIOTEMP                                                       
         USING SAAPREC,R2                                                       
         XC    SAAPKEY,SAAPKEY                                                  
         MVI   SAAPTYP,SAAPTYPQ                                                 
         MVI   SAAPSUB,SAAPSUBQ                                                 
         MVC   SAAPAGY,WORK                                                     
         MVC   SAAPAGR,WORK+2                                                   
         GOTO1 VDMGR,DMCB,DMREAD,CTFILE,(R2),(R2)                               
         CLI   8(R1),0                                                          
         BNE   EXITOK                                                           
*                                                                               
         GOTO1 VHELLO,PLIST,(C'G',CTFILE),('SAAPGELQ',(R2)),0,0,0,0             
         CLI   12(R1),0                                                         
         BNE   EXITOK                                                           
*                                                                               
         L     RF,12(R1)                                                        
         USING SAAPGD,RF           RF=A(APPROVER GROUP ELEMENT)                 
         XR    R1,R1                                                            
         IC    R1,SAAPGLN                                                       
         AHI   R1,-(SAAPGLNQ+1)                                                 
         BM    EXITOK                                                           
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   WORK+10(0),SAAPGNAM                                              
         B     EXITOK                                                           
         DROP  R2,RF                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO MOVE TEXT AND SURROUND WITH CHEVRONS                     *         
*                                                                     *         
* NTRY: 0(1,R1) LENGTH TARGET (INCL < AND >)                          *         
*       1(3,R1) ADDRESS "                                             *         
*       4(1,R1) LENGTH SOURCE TEXT                                    *         
*       5(3,R1) ADDRESS "      "                                      *         
***********************************************************************         
CHEVRON  NTR1  BASE=*,LABEL=*                                                   
         LR    R2,R1                                                            
         L     RE,4(,R2)                                                        
         SRDL  RE,3*8              RE=LENGTH SOURCE                             
         SRL   RF,8                RF=A(SOURCE)                                 
         LA    R1,0(RE,RF)         R1=A(SOURCE END+1)                           
         BCTR  R1,0                                                             
         CLI   0(R1),C' '                                                       
         BH    *+12                                                             
         BCT   RE,*-10             RE=ACTUAL LENGTH SOURCE                      
         B     EXITOK                                                           
         L     R0,0(,R2)                                                        
         SRDL  R0,3*8              R0=LENGTH TARGET                             
         AHI   R0,-2               LESS CHEVRONS                                
         SRL   R1,8                R1=A(TARGET)                                 
         MVI   0(R1),C'<'                                                       
         CR    RE,R0               IS SOURCE TOO LONG                           
         BH    CHEV10              YES                                          
         EX    RE,CHEVMVC          NO, MOVE WHOLE SOURCE (+1)                   
         AR    R1,RE                                                            
         MVI   1(R1),C'>'                                                       
         B     EXITOK                                                           
CHEV10   LR    RE,R0               SET TARGET LENGTH                            
         AHI   RE,-2               LESS ELLIPSIS                                
         EX    RE,CHEVMVC          MOVE PART SOURCE (+1)                        
         AR    R1,RE                                                            
         MVC   1(3,R1),=C'..>'                                                  
         B     EXITOK                                                           
CHEVMVC  MVC   1(0,R1),0(RF)                                                    
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO OUTPUT NUMBERS IN  99999.99999 FORMAT                    *         
* NTRY: R1     = A(NUMBER)                                            *         
***********************************************************************         
EDITNUM  NTR1  BASE=*,LABEL=*                                                   
         XC    DUB,DUB                                                          
         MVC   DUB+2(6),0(R1)                                                   
         MVC   WORK(12),=X'4020202021204B2020202020'                            
         MVC   WORK+6(1),CURSEP                                                 
         ED    WORK(12),DUB+2                                                   
         LA    R1,WORK+11                                                       
EDITN1   LA    RF,WORK                                                          
         CR    R1,RF                                                            
         BNH   EDITN2                                                           
         CLC   0(1,R1),CURSEP      SEPARATOR                                    
         BE    EDITN2                                                           
         CLI   0(R1),C'0'                                                       
         BNE   EDITN3                                                           
         MVI   0(R1),C' '                                                       
         BCT   R1,EDITN1                                                        
EDITN2   MVI   1(R1),C'0'                                                       
         LA    R1,1(R1)                                                         
EDITN3   LA    R0,12                                                            
         CLI   WORK,C' '                                                        
         BNE   *+20                                                             
         MVC   WORK(11),WORK+1                                                  
         MVI   WORK+11,C' '                                                     
         BCTR  R1,0                                                             
         BCT   R0,*-20                                                          
EDNMX    B     EXITOK                                                           
*                                                                               
CURSEP   DC    C'.'                                                             
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO OUTPUT TIME AS CHARACTERS                                *         
* NTRY: R0      = TIME IN 1S UNITS                                    *         
* EXIT: WORK(8) = TIME AS CHARACTERS                                  *         
***********************************************************************         
PRTTIME  NTR1  BASE=*,LABEL=*                                                   
         SRDL  R0,32                                                            
         D     R0,=F'3600'         GIVES HOURS IN R1                            
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(2),DUB                                                      
         MVI   WORK+2,C':'                                                      
         SRDL  R0,32                                                            
         D     R0,=F'60'           GIVES MINUTES IN R1/SECS IN R0               
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+3(2),DUB                                                    
         MVI   WORK+5,C':'                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+6(2),DUB                                                    
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO OUTPUT TIME AS CHARACTERS                                *         
* NTRY: R0       = TIME IN 0.01S UNITS                                *         
* EXIT: WORK(11) = TIME AS CHARACTERS                                 *         
***********************************************************************         
PRTTBIN  NTR1  BASE=*,LABEL=*                                                   
         SRDL  R0,32                                                            
         D     R0,=F'360000'       GIVES HOURS IN R1                            
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK(2),DUB                                                      
         MVI   WORK+2,C':'                                                      
         SRDL  R0,32                                                            
         D     R0,=F'6000'         GIVES MINUTES IN R1/SECS IN R0               
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+3(2),DUB                                                    
         MVC   WORK+5(6),SPACES                                                 
         CLI   LSTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   EXITOK              NO, DON'T BOTHER PUNTERS WITH SECS           
         MVI   WORK+5,C':'                                                      
         SRDL  R0,32                                                            
         D     R0,=F'100'         GIVES SECS IN R1/100THS IN R0                 
         CVD   R1,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+6(2),DUB                                                    
         MVI   WORK+8,C'.'                                                      
         CVD   R0,DUB                                                           
         OI    DUB+7,X'0F'                                                      
         UNPK  WORK+9(2),DUB                                                    
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* PROFILE ELEMENTS (40-4F) OUTPUT PROFILE TYPE INFORMATION            *         
* NTRY: R2     = A(COPY ELEMENT OR 0)                                 *         
*       R3     = A(CHANGE ELEMENT OR 0)                               *         
*       R4     = A(PRINT LINE)                                        *         
* EXIT: FULL   = A(FIRST CLEAR LINE)                                  *         
***********************************************************************         
         USING CTDCOD,R2                                                        
         USING PLINED,R4                                                        
PRFTYPE  NTR1  BASE=*,LABEL=*                                                   
         MVC   PLNHDR,HPRFTYPE                                                  
*                                                                               
         LTR   R2,R2                                                            
         BZ    PFT06                                                            
         USING CTDCOD,R2                                                        
         CLI   CTDCOTYP,C'S'       SACRED                                       
         BNE   *+14                                                             
         MVCDD PLOINF,GE#NOVR,L                                                 
         B     PFT06                                                            
*                                                                               
         CLI   CTDCOTYP,C'P'       PERMANENT                                    
         BNE   *+14                                                             
         MVCDD PLOINF,CT#PERM,L                                                 
         B     PFT06                                                            
*                                                                               
         CLI   CTDCOTYP,C'D'       DAY OF WEEK                                  
         BNE   PFT02                                                            
         MVC   PLOINF+00(18),=CL18'Day of week - for '                          
         MVC   PLOINF+18(L'CTDCODTA),CTDCODTA                                   
         B     PFT06                                                            
*                                                                               
PFT02    CLI   CTDCOTYP,C'T'       TEMPORARY                                    
         BNE   PFT04                                                            
         MVCDD PLOINF+00(10),CT#TMP,L                                           
         MVI   PLOINF+11,C'-'                                                   
         MVCDD PLOINF+13(08),CT#EXPRS                                           
         GOTO1 VDATCON,PLIST,(3,CTDCODTA),(8,PLOINF+22),0                       
         B     PFT06                                                            
*                                                                               
PFT04    MVC   PLOINF(L'LC@NOSET),LC@NOSET                                      
         DROP  R2                                                               
*                                                                               
PFT06    LTR   R3,R3                                                            
         BZ    PFT12                                                            
         USING CTDCOD,R2                                                        
         CLI   CTDCOTYP,C'S'       SACRED                                       
         BNE   *+14                                                             
         MVCDD PLNINF,GE#NOVR,L                                                 
         B     PFT12                                                            
*                                                                               
         CLI   CTDCOTYP,C'P'       PERMANENT                                    
         BNE   *+14                                                             
         MVCDD PLNINF,CT#PERM,L                                                 
         B     PFT12                                                            
*                                                                               
         CLI   CTDCOTYP,C'D'       DAY OF WEEK                                  
         BNE   PFT08                                                            
         MVC   PLNINF+00(18),=CL18'Day of week - for '                          
         MVC   PLNINF+18(L'CTDCODTA),CTDCODTA                                   
         B     PFT12                                                            
*                                                                               
PFT08    CLI   CTDCOTYP,C'T'       TEMPORARY                                    
         BNE   PFT10                                                            
         MVCDD PLNINF+00(10),CT#TMP,L                                           
         MVI   PLNINF+11,C'-'                                                   
         MVCDD PLNINF+13(08),CT#EXPRS                                           
         GOTO1 VDATCON,PLIST,(3,CTDCODTA),(8,PLNINF+22),0                       
         B     PFT12                                                            
*                                                                               
PFT10    MVC   PLNINF(L'LC@NOSET),LC@NOSET                                      
*                                                                               
PFT12    AHI   R4,L'PLINE          RETURN A(NEXT LINE) IN FULL                  
         ST    R4,FULL                                                          
         B     EXITOK                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* COUNT NUMBER ELEMENTS FOR OUTPUT ROUTINES                           *         
* NTRY:  RF = LIST TO COUNT                                           *         
* EXIT:  CC EQ IF 1 OR LESS OF THIS TYPE                              *         
***********************************************************************         
COUNTEM  NTR1  BASE=*,LABEL=*                                                   
         XR    R0,R0                                                            
CTEM02   CLC   0(4,RF),EFFS        TEST DONE                                    
         BE    CTEM04              YES                                          
         AHI   R0,1                                                             
         AHI   RF,4                                                             
         B     CTEM02                                                           
*                                                                               
CTEM04   CHI   R0,1                MORE THAN ONE IS BAD                         
         BH    EXITL                                                            
         B     EXITOK                                                           
         EJECT                                                                  
***********************************************************************         
* END OF FILE TOTAL PRINTOUTS                                         *         
***********************************************************************         
         PUSH  USING                                                            
         USING PLINED,P                                                         
SORTTOT  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         L     R2,AADDTAB                                                       
         USING ADDTABD,R2                                                       
         LHI   RF,ADDTABLQ                                                      
SRTT02   CLI   ADFILENM,255        END OF TABLE                                 
         BE    SRTT04              NOTHING TO PRINT                             
         OC    ADBUCS,ADBUCS                                                    
         BNZ   SRTT06              NON-ZERO TOTALS                              
         BXH   R2,RF,SRTT02                                                     
         DC    H'0'                NO WAY                                       
         DROP  R2                                                               
*                                                                               
SRTT04   CLI   HADDUMMY,C'Y'       HAD DUMMY RECORD (FORCE EMPTY)               
         BNE   EXITOK              NO, EXIT                                     
         MVI   HADDUMMY,C'X'       INDICATE NO DATA FOUND                       
*                                                                               
SRTT06   ZAP   PAGE,PONE           RESET PAGE COUNT                             
         CLI   TOTSRT,SRTSDDS      TEST DDS REPORT                              
         BNE   *+10                                                             
         MVC   TITLE,STITLE        YES, REPLACE TITLE                           
         MVC   MID1,SPACES                                                      
         MVC   MID2,SPACES                                                      
*                                                                               
         MVC   BOXCOLS,SPACES      CLEAR DOWN COLUMNS                           
         ZAP   LINE,P99                                                         
         GOTO1 VPRINTER            SKIP TO NEW PAGE                             
*                                                                               
*        TOTALS TO PRINT, SO START A NEW BOX AND PRINT THEM                     
*                                                                               
PC       USING PLINED,BOXCOLS                                                   
         MVI   PC.POLEFT,C'L'      SET INPUT COLUMNS                            
         MVI   PC.POC1,C'C'                                                     
         MVI   PC.PORIGHT,C'R'                                                  
         MVI   PCTLBOX,C'O'        OPEN BOX                                     
*                                                                               
         MVC   POACT(L'LC@ACT),LC@ACT                                           
         GOTO1 VPRINTER            FIRST TITLE LINE                             
*                                                                               
         MVI   PC.POC1,C'C'                                                     
         MVI   PC.POC2,C'C'                                                     
         MVI   PC.POC3,C'C'                                                     
         MVI   PC.POC4,C'C'                                                     
         MVI   PCTLBOX,C'N'        PARTIAL UNDERLINE                            
*                                                                               
         MVC   POREC(L'LC@RECTY),LC@RECTY                                       
         MVCDD POCHA,CT#CHG,R                                                   
         MVCDD POADD,CT#ADD,R                                                   
         MVCDD PODEL,CT#DEL,R                                                   
         MVCDD PORES,CT#RSR,R                                                   
         GOTO1 VPRINTER            SET NEW COLUMNS                              
         MVI   PCTLBOX,C'B'        UNDERLINE                                    
         DROP  PC                                                               
*                                                                               
         L     R2,AADDTAB                                                       
         USING ADDTABD,R2                                                       
SRTT10   CLI   ADFILENM,255        END OF TABLE                                 
         BE    SRTT20                                                           
         CLI   ADRECNUM,0          TOTALS ALWAYS PRINT                          
         BNE   *+12                                                             
         MVI   PCTLBOX,C'B'        AND NEED A SEPARATOR LINE                    
         B     *+14                                                             
         OC    ADBUCS,ADBUCS       ANYTHING TO REPORT FOR THIS TYPE?            
         BZ    SRTT12                                                           
*                                                                               
         MVC   POREC,ADFILENM                                                   
         CURED ADBADD,(8,POADD),0,ZERO=NOBLANK                                  
         CURED ADBCHG,(8,POCHA),0,ZERO=NOBLANK                                  
         CURED ADBDEL,(8,PODEL),0,ZERO=NOBLANK                                  
         CURED ADBRES,(8,PORES),0,ZERO=NOBLANK                                  
         GOTO1 VPRINTER                                                         
*                                                                               
SRTT12   AHI   R2,ADDTABLQ                                                      
         B     SRTT10                                                           
         DROP  R2                                                               
*                                                                               
*        NOW PRINT FILE DETAIL LINE                                             
*                                                                               
*              NOTE, BOXCOLS IS EMPTY, BUT WE MAY STILL BE IN A 'BOX'           
*              THAT HAS TO BE CLOSED FIRST                                      
*                                                                               
SRTT20   MVI   PCTLBOX,C'C'                                                     
         GOTO1 VPRINTER            FORCE CLOSE BOX                              
*                                                                               
         GOTO1 (RF)                BLANK LINE                                   
*                                                                               
*        IF NO DATA FOUND, PRINT MESSAGE TO CONFIRM THAT                        
*                                                                               
         CLI   HADDUMMY,C'X'       NO DATA FOUND                                
         BNE   SRTT30                                                           
         GOTO1 VDATCON,DMCB,(0,NULLDATE),(8,PLINE),0                            
         LA    R0,CR#NOSAF                                                      
         XR    RF,RF                                                            
         ICM   RF,4,=X'0A'                                                      
         ICM   RF,2,DDPLANG                                                     
         GOTO1 VGETTXT,DMCB,(R0),(80,PLINE+9),(C'R',0),0,(X'88',0),(RF)         
         GOTO1 VPRINTER                                                         
         GOTO1 (RF)                                                             
*                                                                               
*        PRINT FROM AND TO DATES                                                
*                                                                               
SRTT30   CLC   LODATTIM,EFFS       DID WE GET ANY DATA AT ALL                   
         BE    SRTT40              NO, CAN'T PRINT FROM/TO DATES                
         MVC   WORK(40),SPACES     CONSTRUCT SUBSTITUTION STRING                
         LA    R3,WORK-1                                                        
         LR    R2,R3               START WITH FROM DATE                         
         GOTO1 VDATCON,DMCB,(3,LODATTIM),(8,2(R2)),0                            
         CLI   2(R2),C' '                                                       
         BNE   *+10                                                             
         MVC   2(8,R2),3(R2)       LOSE LEADING SPACE                           
         LA    R2,9(R2)                                                         
         CLI   0(R2),C' '                                                       
         BH    *+8                                                              
         BCT   R2,*-8                                                           
         SR    R2,R3                                                            
         STC   R2,1(,R3)                                                        
         AR    R3,R2               NEXT FIELD                                   
         LR    R2,R3               FROM TIME                                    
         UNPK  DUB(7),LODATTIM+3(4)                                             
         OI    DUB+6,C'0'                                                       
         MVC   2(2,R2),DUB+1                                                    
         MVI   4(R2),C':'                                                       
         MVC   5(2,R2),DUB+3                                                    
         MVI   1(R3),5+1                                                        
         LA    R3,5+1(,R3)         NEXT FIELD                                   
         LR    R2,R3               TO DATE                                      
         GOTO1 VDATCON,DMCB,(3,HIDATTIM),(8,2(R2)),0                            
         CLI   2(R2),C' '                                                       
         BNE   *+10                                                             
         MVC   2(8,R2),3(R2)       LOSE LEADING SPACE                           
         LA    R2,9(R2)                                                         
         CLI   0(R2),C' '                                                       
         BH    *+8                                                              
         BCT   R2,*-8                                                           
         SR    R2,R3                                                            
         STC   R2,1(,R3)                                                        
         AR    R3,R2               NEXT FIELD                                   
         LR    R2,R3               TO TIME                                      
         UNPK  DUB(7),HIDATTIM+3(4)                                             
         OI    DUB+6,C'0'                                                       
         OI    DUB+6,C'0'                                                       
         MVC   2(2,R2),DUB+1                                                    
         MVI   4(R2),C':'                                                       
         MVC   5(2,R2),DUB+3                                                    
         MVI   1(R3),5+1                                                        
         LA    R3,5+1(,R3)         NEXT FIELD                                   
         MVI   1(R3),0             TERMINATOR                                   
         LA    R0,CR#PSACF                                                      
         XR    RF,RF                                                            
         ICM   RF,4,=X'0A'                                                      
         ICM   RF,2,DDPLANG                                                     
         GOTO1 VGETTXT,DMCB,(R0),(100,PLINE),(C'R',0),0,(X'88',WORK),  X        
               (RF)                                                             
         GOTO1 VPRINTER            PRINT ACTIVITY DATES                         
*                                                                               
SRTT40   BRAS  RE,SORTCLR          CLEAR TOTALS FOR NEXT REPORT                 
*                                                                               
         B     EXITOK                                                           
         POP   USING                                                            
*                                                                               
STITLE   DC    CL(L'TITLE)'Security report record summary'                      
         EJECT                                                                  
***********************************************************************         
* END OF FILE TOTALS CLEARING FOR NEXT SET                            *         
***********************************************************************         
SORTCLR  NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVI   HADDUMMY,C'N'       NOT HAD A DUMMY RECORD                       
*                                                                               
         L     R2,AADDTAB                                                       
         USING ADDTABD,R2                                                       
         LHI   RF,ADDTABLQ                                                      
*                                                                               
SRTC02   CLI   ADFILENM,255        END OF TABLE                                 
         BE    EXITOK                                                           
         XC    ADBUCS,ADBUCS                                                    
         BXH   R2,RF,SRTC02                                                     
         DC    H'0'                NO WAY                                       
         DROP  R2                                                               
         EJECT                                                                  
**********************************************************************          
* COMMONLY ADDRESSIBLE ROUTINES - ADDRESSED OFF R?                   *          
**********************************************************************          
         ORG   SECDFA+(((*-SECDFA)/4096)+1)*4096                                
         DS    0D                                                               
COMMON   DC    CL8'*COMMON*'                                                    
*                                                                               
EXITOK   CR    RB,RB                                                            
         B     EXIT                                                             
*                                                                               
EXITL    CLI   *,255                                                            
         B     EXIT                                                             
*                                                                               
EXIT     XIT1  ,                                                                
*                                                                               
XBASE    L     RD,SAVERD                                                        
         XBASE                                                                  
         EJECT                                                                  
**********************************************************************          
* CONSTANTS AND EQUATES                                              *          
**********************************************************************          
ELDATAD  EQU   32                                                               
YES      EQU   C'Y'                                                             
NO       EQU   C'N'                                                             
C4YESL   DC    CL4'Yes '                                                        
C4NOL    DC    CL4'No  '                                                        
C4YES    DC    CL4'YES '                                                        
C4NO     DC    CL4'NO  '                                                        
EFFS     DC    32X'FF'                                                          
QUERY    DC    16C'?'                                                           
*                                                                               
CTFILEQ  EQU   X'A1'                                                            
CTREQQ   EQU   X'A3'                                                            
GENDIRQ  EQU   X'AE'                                                            
GENFILQ  EQU   X'AF'                                                            
*&&UK                                                                           
DEMOLDQ  EQU   X'A8'                                                            
DEMNEWQ  EQU   X'A9'                                                            
DEMDIRQ  EQU   X'AA'                                                            
*&&                                                                             
*                                                                               
FF       EQU   255                                                              
IOL      EQU   4196                LENGTH OF AN IO AREA                         
*                                                                               
AADDTAB  DC    A(ADDTAB)           A(ADDTAB)                                    
ACTFADD  DC    A(CTFADD)           A(CTFILE PORTION OF ADDTAB)                  
ACTRADD  DC    A(CTRADD)           A(CTREQ PORTION OF ADDTAB)                   
ACTGADD  DC    A(CTGADD)           A(GENDIR/FIL PORTION OF ADDTAB)              
ACTUADD  DC    A(CTUADD)           A(UNKNOWN RECORD TYPES)                      
AADDTOTS DC    A(ADDTOTS)                                                       
ACTELEMS DC    A(CTELEMS)          A(ELEMENTS IN CONTROL FILE)                  
ACARDTAB DC    A(CARDTAB)                                                       
ACOMFACS DC    A(COMFACS)                                                       
AIOSORT  DC    A(IO1)                                                           
AIOCOPY  DC    A(IO2)                                                           
AIOTEMP  DC    A(IO3)                                                           
ASRTBLK  DC    A(SRTBLK)                                                        
APRFBLK  DC    A(PRFBLK)                                                        
ADISCODE DC    A(DISCODE)                                                       
ADISTXT  DC    A(DISTXT)                                                        
ADISDIC  DC    A(DISDIC)                                                        
*                                                                               
VBINSRCH DC    V(BINSRCH)                                                       
VCARDS   DC    V(CARDS)                                                         
VCHOPPER DC    V(CHOPPER)                                                       
*&&US                                                                           
VCLUNPK  DC    V(CLUNPK)                                                        
VOFFICER DC    V(OFFICER)                                                       
*&&                                                                             
VCPRINT  DC    V(CPRINT)                                                        
VCTRYTAB DC    V(CTRYTAB)                                                       
VDMGR    DC    V(DATAMGR)                                                       
VDATCON  DC    V(DATCON)                                                        
VDATVAL  DC    V(DATVAL)                                                        
VDICTATE DC    V(DICTATE)                                                       
VDMOD000 DC    V(DMOD000)                                                       
VGETTXT  DC    V(GETTXT)                                                        
VDADDS   DC    V(DADDS)                                                         
VREMOTEC DC    V(REMOTEC)                                                       
VPQBUFF  DC    V(PQBUFF)                                                        
VPQOPN   DC    V(PQOPEN)                                                        
VHELLO   DC    V(HELLO)                                                         
VHEXIN   DC    V(HEXIN)                                                         
VHEXOUT  DC    V(HEXOUT)                                                        
VLANGTAB DC    V(LANGTAB)                                                       
VPRINTER DC    V(PRINTER)                                                       
VPRINT   DC    V(PRINT)                                                         
VSCANNER DC    V(SCANNER)                                                       
VSELIST  DC    V(SELIST)                                                        
VSORTER  DC    V(SORTER)                                                        
VSQUASH  DC    V(SQUASHER)                                                      
VBOXAREA DC    V(BOXAREA)                                                       
CUREDIT  DC    V(CUREDIT)                                                       
VSYSLST  DC    A(SYSLST)                                                        
VUNTIME  DC    V(UNTIMEC)                                                       
VXSORT   DC    V(XSORT)                                                         
AFACITAB DC    A(FACIDTAB)                                                      
ADCLIST  DC    A(DCLIST)                                                        
APAIRHEX DC    A(PAIRHEX)                                                       
ASSB     DC    V(SSB)                                                           
AMASTC   DC    V(MASTC)                                                         
VDDSIO   DC    V(DDSIO)                                                         
VGETPROF DC    V(GETPROF)                                                       
*                                                                               
PRFPARMS DC    A(0,PRFBLK,0,L'LSTPRFS,2,PRFBLKN) BINSRCH PARMS                  
*                                                                               
DMSYS    DC    CL8'CONTROL '                                                    
DMREAD   DC    CL8'DMREAD  '                                                    
DMRDHI   DC    CL8'DMRDHI  '                                                    
DMRSEQ   DC    CL8'DMRSEQ  '                                                    
GETREC   DC    CL8'GETREC  '                                                    
CTFILE   DC    CL8'CTFILE  '                                                    
GENDIR   DC    CL8'GENDIR  '                                                    
GENFIL   DC    CL8'GENFIL  '                                                    
CTRCVR   DC    CL8'CTRCVR  '                                                    
TRUE     DC    CL8'TRUE    '                                                    
TAPE     DC    CL4'TAPE'                                                        
DISK     DC    CL4'DISK'                                                        
DMOPEN   DC    CL4'OPEN'                                                        
PUT      DC    CL4'PUT '                                                        
GET      DC    CL4'GET '                                                        
END      DC    CL4'END '                                                        
SLDD     DC    C'SL',X'0A',C' '                                                 
*                                                                               
SYSOP    DC    C'N'                                                             
PZERO    DC    P'0'                                                             
PONE     DC    P'1'                                                             
P99      DC    P'99'                                                            
PPAGESIZ DC    P'60'               MAXIMUM PAGE SIZE                            
QMAXBOX  EQU   61                  MAX BOX ROW (ONE MORE THAN PAGE)             
PRECFREE DC    P'10'               FREE LINES NEEDED FOR NEW RECORD             
PELMFREE DC    P'4 '               FREE LINES NEEDED FOR NEW ELEMENT            
*                                                                               
SORTCARD DC    CL80'SORT FIELDS=(5,128,A),FORMAT=BI,WORK=1'                     
*                                                                               
RECCARD  DC    C'RECORD TYPE=V,LENGTH=(9000,9000,9000,350,1000) '               
*                                                                               
TAPEIN   DCB   DDNAME=TAPEIN,DSORG=PS,MACRF=(GL),RECFM=VB,             *        
               BUFNO=2,EODAD=TAPEEND                                            
*                                                                               
BAUD     DC    CL04'Baud'                                                       
PASSIVE  DC    CL08'Passive'                                                    
WORKER   DC    CL7'Worker'                                                      
*                                                                               
HATTYPE  DC    CL16'Attention type  '                                           
HDATTIM  DC    CL16'Date / Time     '                                           
HDISDEV  DC    CL16'Display device  '                                           
HESCCHR  DC    CL16'Escape char     '                                           
HFACPAK  DC    CL16'Facpak          '                                           
HFLDDATA DC    CL16'Field data      '                                           
HFLDID   DC    CL16'Field id        '                                           
HFRMCD   DC    CL16'Form code       '                                           
HHIGHSEQ DC    CL16'High sequence # '                                           
HIDSEQ   DC    CL16'Id/Sequence #   '                                           
HINCLUDE DC    CL16'Include         '                                           
HINDNTRY DC    CL16'Index entries   '                                           
HINSTRCT DC    CL16'Instruction     '                                           
HINSCDE  DC    CL16'SS NUMBER       '                                           
HIPAAGY  DC    CL16'IPA Agency id   '                                           
HJCLBK   DC    CL16'JCL book        '                                           
HLABEL   DC    CL16'Label           '                                           
HLIBBK   DC    CL16'Library book    '                                           
HLINEID  DC    CL16'Line id         '                                           
HLINNUM  DC    CL16'Line number     '                                           
HLINESPD DC    CL16'Line speed      '                                           
HLINETYP DC    CL16'Line type       '                                           
HLOCKKEY DC    CL16'Lock key        '                                           
HLOGO1   DC    CL16'Logo 1          '                                           
HLOGO2   DC    CL16'Logo 2          '                                           
HMESSAGE DC    CL16'Message         '                                           
HMINIO   DC    CL16'Minio key       '                                           
HNODENM  DC    CL16'Node name       '                                           
HOFFOVER DC    CL16'Office override '                                           
HOPSINS  DC    CL16'Ops instruction '                                           
HORGADDR DC    CL16'Origin address  '                                           
HORGNAME DC    CL16'Origin name     '                                           
HOUTCODE DC    CL16'Output code     '                                           
HOUTMODE DC    CL16'Output mode     '                                           
HPAKDET  DC    CL16'Packing details '                                           
HPRSNCNT DC    CL16'Person count    '                                           
HPQNTRY  DC    CL16'PQ entry number '                                           
HPQPWD   DC    CL16'PQ password     '                                           
HPOWERCD DC    CL16'Power code      '                                           
HPRINTER DC    CL16'Printer         '                                           
HPRTAUTO DC    CL16'Print automode  '                                           
HPRNTRLS DC    CL16'Printer list    '                                           
HPRTSPD  DC    CL16'Printer speed   '                                           
HPRFDATA DC    CL16'Profile data    '                                           
HPRFTYPE DC    CL16'Profile type    '                                           
HPGMAUTH DC    CL16'Program auths   '                                           
HRTYPE   DC    CL16'Rate type       '                                           
HRDRCLS  DC    CL16'Reader class    '                                           
HRECSTMT DC    CL16'Record statement'                                           
HREQTIME DC    CL16'Request time    '                                           
HRETCLS  DC    CL16'Retain class    '                                           
HSERNO   DC    CL16'Serial number   '                                           
HSHPINS  DC    CL16'Ship instructns '                                           
HSHIPRTE DC    CL16'Shipping route  '                                           
HSRETCLS DC    CL16'Soon retain cls '                                           
HSRTCODE DC    CL16'Sort code       '                                           
HSRTFRM  DC    CL16'Sort formula    '                                           
HSRTTYPE DC    CL16'Sort type       '                                           
HSPDTYPE DC    CL16'Speed type      '                                           
HSUBID   DC    CL16'Sub id          '                                           
HSUBJECT DC    CL16'Subject         '                                           
HSUBNUM  DC    CL16'Sub number      '                                           
HSYSPROG DC    CL16'System/Program  '                                           
HTSTMSK  DC    CL16'Test phase mask '                                           
HTEXT    DC    CL16'Text            '                                           
HTIMERG  DC    CL16'Time range      '                                           
HVENDOR  DC    CL16'Vendor          '                                           
HVTAML   DC    CL16'VTAM LUID       '                                           
HWRITER  DC    CL16'Writer          '                                           
HXTRBK   DC    CL16'Xtract book     '                                           
HSTATBIT DC    CL16'16 status bits  '                                           
*                                                                               
HGENRT   DC    CL16'Generate new    '                                           
         EJECT                                                                  
**********************************************************************          
* LITERALS                                                           *          
**********************************************************************          
*TEMP                                                                           
*&&UK                                                                           
CT#ASST  EQU   9999                                                             
CT#CALL  EQU   9999                                                             
*&&                                                                             
*TEMP                                                                           
         LTORG                                                                  
         EJECT                                                                  
**********************************************************************          
* PRINT BLOCK                                                        *          
**********************************************************************          
PBLNUMQ  EQU   50                                                               
PBLOCK   DS    (PBLNUMQ)CL132                                                   
PBLOCKL  EQU   *-PBLOCK                                                         
         EJECT                                                                  
**********************************************************************          
* SYSLST                                                             *          
**********************************************************************          
* FASYSLST                                                                      
         PRINT OFF                                                              
       ++INCLUDE FASYSLST                                                       
         PRINT ON                                                               
         EJECT                                                                  
**********************************************************************          
* DICTIONARY LIST                                                    *          
**********************************************************************          
         DS    0D                                                               
DCLIST   DCDDL CT#YES,4,L                                                       
         DCDDL CT#NO,4,L                                                        
         DCDDL CT#ALL,4,L                                                       
         DCDDL CT#USRID,8,L                                                     
         DCDDL CT#UNKNW,L'PLINFO,L                                              
         DCDDL CT#OFFLN,L'PLINFO,L                                              
         DCDDL CT#AGYAL,L'PLINFO,L                                              
         DCDDL CT#SYS,L'PLINFO,L                                                
         DCDDL GE#NOSET,L'PLINFO,L                                              
         DCDDL CT#NAME,L'PLINFO,L                                               
         DCDDL CT#NUM,L'PLINFO,L                                                
         DCDDL CT#DATE,L'PLINFO,L                                               
         DCDDL CT#TIME,L'PLINFO,L                                               
         DCDDL CT#RECTY,L'PLINFO,L                                              
         DCDDL CT#ACT,L'PLINFO,L                                                
         DCDDL CT#OTPTY,L'PLINFO,L                                              
         DCDDL CT#READ,8,L                                                      
         DC    X'00'                                                            
*                                                                               
         EJECT                                                                  
**********************************************************************          
* INPUT CARD TABLE                                                   *          
**********************************************************************          
CARDTAB  DC    CL8'ADDS    ',AL1(2,3,0,0),AL4(VALADD)                           
         DC    CL8'CHANGES ',AL1(2,6,0,0),AL4(VALCHNG)                          
         DC    CL8'DELETES ',AL1(2,6,0,0),AL4(VALDEL)                           
         DC    CL8'RESTORES',AL1(2,7,0,0),AL4(VALREST)                          
         DC    CL8'DETAIL  ',AL1(2,5,0,0),AL4(VALDETL)                          
*                                                                               
         DC    CL8'AGENCY  ',AL1(1,5,0,0),AL4(VALAGY)                           
         DC    CL8'AGYBIN  ',AL1(3,5,0,0),AL4(VALAGYB)                          
         DC    CL8'DDSIO   ',AL1(4,4,0,0),AL4(VALDDSIO)                         
         DC    CL8'DSPACE  ',AL1(2,5,0,0),AL4(VALDSPAC)                         
         DC    CL8'LUID    ',AL1(3,3,0,0),AL4(VALUID)                           
         DC    CL8'RUN     ',AL1(2,2,0,0),AL4(VALRUN)                           
         DC    CL8'PROGNUM ',AL1(4,6,0,0),AL4(VALPGN)                           
         DC    CL8'RECNUM  ',AL1(3,5,0,0),AL4(VALRCN)                           
         DC    CL8'REPORT  ',AL1(2,5,0,0),AL4(VALREP)                           
         DC    CL8'COPY    ',AL1(3,3,0,0),AL4(VALCOP)                           
         DC    CL8'PROGNAME',AL1(4,7,0,0),AL4(VALPRG)                           
         DC    CL8'TERMINAL',AL1(3,7,0,0),AL4(VALTRM)                           
         DC    CL8'USERID  ',AL1(4,5,0,0),AL4(VALID)                            
         DC    CL8'USERNAME',AL1(4,7,0,0),AL4(VALNID)                           
         DC    CL8'START   ',AL1(4,4,0,0),AL4(VALSTA)                           
         DC    CL8'END     ',AL1(2,2,0,0),AL4(VALEND)                           
         DC    CL8'NULL    ',AL1(3,3,0,0),AL4(VALNULL)                          
         DC    X'FF'                                                            
*                                                                               
COMFACS  DC    44A(0)                                                           
         ORG   COMFACS+(CDATAMGR-COMFACSD)                                      
         DC    V(DATAMGR)                                                       
         ORG   COMFACS+(CDATCON-COMFACSD)                                       
         DC    V(DATCON)                                                        
         ORG   COMFACS+(CGETDAY-COMFACSD)                                       
         DC    V(GETDAY)                                                        
         ORG                                                                    
*                                                                               
CARDTABD DSECT                     INPUT CARD PARAMETERS                        
CARDTXT  DS    CL8                 TEXT                                         
CMIN     DS    X                   MIN LEN FOR EXECUTE (-1)                     
CMAX     DS    X                   MAX LEN FOR EXECUTE (-1)                     
         DS    XL2                                                              
CARDVAL  DS    AL4                 A(VALIDATION ROUTINE)                        
CARDTABL EQU   *-CARDTABD                                                       
*                                                                               
SECDFA   CSECT                                                                  
         EJECT                                                                  
**********************************************************************          
* RECORD TOTALS TABLES                                               *          
**********************************************************************          
ADDTAB   DS    0D                                                               
CTFADD   DC    CL32'Saved Program                   '                           
         DC    AL2(000)                                                         
         DC    AL1(01,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'01FFFF'                                              
         DC    AL4(0,0,0,0),AL4(C1RECSRR,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'User Records (DRIVER)           '                           
         DC    AL2(000)                                                         
         DC    AL1(02,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'02FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Date Schemes                    '                           
         DC    AL2(000)                                                         
         DC    AL1(03,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'03FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'EDR Publication Name            '                           
         DC    AL2(000)                                                         
         DC    AL1(04,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0401FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'EDR Publication Linkage         '                           
         DC    AL2(000)                                                         
         DC    AL1(05,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0400FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Phase                           '                           
         DC    AL2(CT#PHASE)                                                    
         DC    AL1(06,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0501FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'ADDS Directory                  '                           
         DC    AL2(000)                                                         
         DC    AL1(07,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0504FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'ADDS Station                    '                           
         DC    AL2(000)                                                         
         DC    AL1(08,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0506FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'EASYLINK                        '                           
         DC    AL2(000)                                                         
         DC    AL1(09,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0507FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Dare EDICT Information          '                           
         DC    AL2(000)                                                         
         DC    AL1(10,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0508FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Zenith Client                   '                           
         DC    AL2(000)                                                         
         DC    AL1(11,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0509FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Zenith Payee Rep                '                           
         DC    AL2(000)                                                         
         DC    AL1(12,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'050AFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Office                          '                           
         DC    AL2(CT#OFF)                                                      
         DC    AL1(13,CTFILEQ,00,00,00,00)                                      
         DC    AL1(02),XL3'050BFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Batch Type                      '                           
         DC    AL2(000)                                                         
         DC    AL1(14,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'06FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Facpak Program Version Control  '                           
         DC    AL2(CT#VCTRL)                                                    
         DC    AL1(15,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'07C6FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Stereo Program Version Control  '                           
         DC    AL2(000)                                                         
         DC    AL1(16,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'07E2FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Printer Name                    '                           
         DC    AL2(000)                                                         
         DC    AL1(17,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'08FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'TWX Addressee                   '                           
         DC    AL2(000)                                                         
         DC    AL1(18,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'C1FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Demo (Latest Book)              '                           
         DC    AL2(000)                                                         
         DC    AL1(19,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'C2FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Comment (Book)                  '                           
         DC    AL2(CT#CMT)                                                      
         DC    AL1(20,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'C3FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Demo Name                       '                           
         DC    AL2(000)                                                         
         DC    AL1(21,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'C4FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Error Message                   '                           
         DC    AL2(000)                                                         
         DC    AL1(22,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'C5FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Office Security                 '                           
         DC    AL2(CT#OFF)                                                      
         DC    AL1(23,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                         
         DC    AL1(02),XL3'C602FF'                                              
         DC    AL4(0,0,0,0),AL4(OFSRECS,OFSRECS,SKIPPCO)                        
*                                                                               
         DC    CL32'Department Security             '                           
         DC    AL2(CT#DPT)                                                      
         DC    AL1(24,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                         
         DC    AL1(02),XL3'C603FF'                                              
         DC    AL4(0,0,0,0),AL4(DEPRECS,DEPRECS,SKIPPCO)                        
*                                                                               
         DC    CL32'Person Security             '                               
         DC    AL2(CT#PRSN)                                                     
         DC    AL1(25,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                         
         DC    AL1(02),XL3'C604FF'                                              
         DC    AL4(0,0,0,0),AL4(PSRECSR,DEFKYOUT,SKIPPER)                       
*                                                                               
         DC    CL32'Person Access Group Security'                               
         DC    AL2(CT#GROUP)                                                    
         DC    AL1(26,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                         
         DC    AL1(02),XL3'C605FF'                                              
         DC    AL4(0,0,0,0),AL4(PAGRECS,PAGRECS,SKIPPAG)                        
*                                                                               
         DC    CL32'Security - Program              '                           
         DC    AL2(CT#PROG)                                                     
         DC    AL1(27,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC+ADSTSECX)                
         DC    AL1(02),XL3'C610FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Security - Action               '                           
         DC    AL2(CT#ACT)                                                      
         DC    AL1(28,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC+ADSTSECX)                
         DC    AL1(02),XL3'C611FF'                                              
         DC    AL4(0,0,0,0),AL4(ACTRECS,ACTRECS,0)                              
*                                                                               
         DC    CL32'Security - Record               '                           
         DC    AL2(CT#REC)                                                      
         DC    AL1(29,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC+ADSTSECX)                
         DC    AL1(02),XL3'C612FF'                                              
         DC    AL4(0,0,0,0),AL4(RECRECS,RECRECS,0)                              
*                                                                               
         DC    CL32'Field Security                  '                           
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(30,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC+ADSTSECX)                
         DC    AL1(02),XL3'C613FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Options Security                '                           
         DC    AL2(CT#OPTS)                                                     
         DC    AL1(31,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC+ADSTSECX)                
         DC    AL1(02),XL3'C614FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Access Security                 '                           
         DC    AL2(CT#ACCS)                                                     
         DC    AL1(32,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                         
         DC    AL1(02),XL3'C615FF'                                              
         DC    AL4(0,0,0,0),AL4(SACCSR,SACCSR,SKIPACT)                          
*                                                                               
         DC    CL32'Field Control Security          '                           
         DC    AL2(CT#FCON)                                                     
         DC    AL1(33,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                         
         DC    AL1(02),XL3'C616FF'                                              
         DC    AL4(0,0,0,0),AL4(SFCONR,SFCONR,SKIPACT)                          
*                                                                               
         DC    CL32'Option Control Security         '                           
         DC    AL2(CT#OCON)                                                     
         DC    AL1(34,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                         
         DC    AL1(02),XL3'C617FF'                                              
         DC    AL4(0,0,0,0),AL4(SOCONR,SOCONR,SKIPACT)                          
*                                                                               
         DC    CL32'Limit Access Group Security '                               
         DC    AL2(CT#LIMAG)                                                    
         DC    AL1(35,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC+ADSTSECX)                
         DC    AL1(02),XL3'C618FF'                                              
         DC    AL4(0,0,0,0),AL4(LIMAGR,DEFKYOUT,0)                              
*                                                                               
         DC    CL32'Limit Access List Security  '                               
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(36,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC+ADSTSECX)                
         DC    AL1(02),XL3'C619FF'                                              
         DC    AL4(0,0,0,0),AL4(LIMAGLR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'Timesheet Approver Group    '                               
         DC    AL2(CT#APPG)                                                     
         DC    AL1(37,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                         
         DC    AL1(02),XL3'C620FF'                                              
         DC    AL4(0,0,0,0),AL4(STAPRECS,STAPRECS,SKIPSTAP)                     
*                                                                               
         DC    CL32'Text Limit Access List      '                               
         DC    AL2(CT#TXLIM)                                                    
         DC    AL1(117,CTFILEQ,00,00,00,ADSTSTD+ADSTSEC)                        
         DC    AL1(02),XL3'C621FF'                                              
         DC    AL4(0,0,0,0),AL4(LIMTLAL,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'File Control                '                               
         DC    AL2(000)                                                         
         DC    AL1(38,CTFILEQ,00,00,00,ADSTSEC+ADSTSECX)                        
         DC    AL1(01),XL3'C6FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Request Group               '                               
         DC    AL2(000)                                                         
         DC    AL1(39,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'C7FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'HUT (Network)               '                               
         DC    AL2(000)                                                         
         DC    AL1(40,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'C8FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Identification              '                               
         DC    AL2(CT#ID)                                                       
         DC    AL1(41,CTFILEQ,15,08,00,ADSTSTD+ADSTSEC+ADSTSECX)                
         DC    AL1(01),XL3'C9FFFF'                                              
         DC    AL4(0,0,0,0),AL4(IDRECSR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'JCL Book                    '                               
         DC    AL2(000)                                                         
         DC    AL1(42,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'D1FFFF'                                              
         DC    AL4(0,0,0,0),AL4(LIBRECR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'Authorisation               '                               
         DC    AL2(000)                                                         
         DC    AL1(43,CTFILEQ,00,00,00,ADSTSTD+ADSTSECX)                        
         DC    AL1(01),XL3'D2FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Library Book                '                               
         DC    AL2(000)                                                         
         DC    AL1(44,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'D3FFFF'                                              
         DC    AL4(0,0,0,0),AL4(LIBRECR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'Screen Field Map                '                           
         DC    AL2(000)                                                         
         DC    AL1(45,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'D4FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Demo Code                       '                           
         DC    AL2(000)                                                         
         DC    AL1(46,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'D5FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Output Type                     '                           
         DC    AL2(GE#OTYP)                                                     
         DC    AL1(47,CTFILEQ,00,00,00,ADSTSTD+ADSTSECX)                        
         DC    AL1(01),XL3'D6FFFF'                                              
         DC    AL4(0,0,0,0),AL4(OUTPUTR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'Profile                         '                           
         DC    AL2(000)                                                         
         DC    AL1(48,CTFILEQ,00,00,00,ADSTSTD+ADSTSECX)                        
         DC    AL1(01),XL3'D7FFFF'                                              
         DC    AL4(0,0,0,0),AL4(PRRECSR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'Demo Adjustment                 '                           
         DC    AL2(000)                                                         
         DC    AL1(49,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'D8FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Demo Agency Control             '                           
         DC    AL2(000)                                                         
         DC    AL1(50,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'D9FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Station Call Letter Change List '                           
         DC    AL2(CT#CALL)                                                     
         DC    AL1(51,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'E2FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Terminal                        '                           
         DC    AL2(000)                                                         
         DC    AL1(52,CTFILEQ,07,16,00,ADSTSTD+ADSTSECX)                        
         DC    AL1(01),XL3'E3FFFF'                                              
         DC    AL4(0,0,0,0),AL4(TERMSRR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'User Profile                    '                           
         DC    AL2(CT#PROFL)                                                    
         DC    AL1(53,CTFILEQ,00,00,00,ADSTSTD+ADSTPRF+ADSTSECX)                
         DC    AL1(01),XL3'E4FFFF'                                              
         DC    AL4(0,0,0,0),AL4(USERPRS,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'Value                           '                           
         DC    AL2(CT#VALUE)                                                    
         DC    AL1(54,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'E5FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'System List                     '                           
         DC    AL2(CT#SYSL)                                                     
         DC    AL1(55,CTFILEQ,00,00,00,ADSTSTD+ADSTSECX)                        
         DC    AL1(01),XL3'E6FFFF'                                              
         DC    AL4(0,0,0,0),AL4(SYSLSTR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'CPP Extract Rules               '                           
         DC    AL2(000)                                                         
         DC    AL1(56,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'E7FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'CPP Projection Formula          '                           
         DC    AL2(000)                                                         
         DC    AL1(57,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'E8FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Interface Tape                  '                           
         DC    AL2(000)                                                         
         DC    AL1(58,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'E9FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Personal Authorisation          '                           
         DC    AL2(CT#SYS)                                                      
         DC    AL1(59,CTFILEQ,00,00,00,ADSTSTD) SKIPPAU CHECKS PASSIVE          
         DC    AL1(01),XL3'F0FFFF'                                              
         DC    AL4(0,0,0,0),AL4(PAUTHRR,DEFKYOUT,SKIPPAU)                       
*                                                                               
         DC    CL32'Country Name                    '                           
         DC    AL2(000)                                                         
         DC    AL1(60,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'F1FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Country Code                    '                           
         DC    AL2(CT#CTRY)                                                     
         DC    AL1(61,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'F2FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Facpak Table - Application      '                           
         DC    AL2(000)                                                         
         DC    AL1(62,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'F3C1FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'IP Subnet ID                    '                           
         DC    AL2(000)                                                         
         DC    AL1(116,CTFILEQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'F3C9FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Facpak Table - DDS Dept Security'                           
         DC    AL2(000)                                                         
         DC    AL1(63,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'F4C4FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Facpak Table - Easilink Station '                           
         DC    AL2(000)                                                         
         DC    AL1(64,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'F4C5FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Facpak Table - Program          '                           
         DC    AL2(000)                                                         
         DC    AL1(65,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'F4D7FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Facpak Table - System SE        '                           
         DC    AL2(000)                                                         
         DC    AL1(66,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'F4E2FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Broadcast message               '                           
         DC    AL2(000)                                                         
         DC    AL1(115,CTFILEQ,00,00,00,ADSTSTD+ADSTSECX)                       
         DC    AL1(01),XL3'F4FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'System Access                   '                           
         DC    AL2(000)                                                         
         DC    AL1(67,CTFILEQ,00,00,00,ADSTSTD)                                 
         DC    AL1(03),XL3'F5FFFF'                                              
         DC    AL4(0,0,0,0),AL4(ACCESSR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'Traffic TWX                     '                           
         DC    AL2(000)                                                         
         DC    AL1(68,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'F6FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Script Object                   '                           
         DC    AL2(000)                                                         
         DC    AL1(69,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'F7FFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Lock Records                    '                           
         DC    AL2(CT#LOCK)                                                     
         DC    AL1(70,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'F8FFFF'                                              
         DC    AL4(0,0,0,0),AL4(LOCKRR,DEFKYOUT,0)                              
*                                                                               
         DC    CL32'Fax Records                     '                           
         DC    AL2(GE#FAX)                                                      
         DC    AL1(71,CTFILEQ,00,00,00,ADSTSECX)                                
         DC    AL1(01),XL3'F9FFFF'                                              
         DC    AL4(0,0,0,0),AL4(FAXRECSR,DEFKYOUT,0)                            
*                                                                               
CTRADD   DC    CL32'Request File Record (CTREQ)     '                           
         DC    AL2(000)                                                         
         DC    AL1(72,CTREQQ,00,00,00,ADSTSECX)                                 
         DC    AL1(01),XL3'FFFFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
CTGADD   DC    CL32'Access Control Record           '                           
         DC    AL2(000)                                                         
         DC    AL1(73,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00000A'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Department                      '                           
         DC    AL2(CT#DPT)                                                      
         DC    AL1(74,GENDIRQ,00,00,00,00)                                      
         DC    AL1(03),XL3'00000B'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Public IDs                      '                           
         DC    AL2(000)                                                         
         DC    AL1(75,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00000F'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Currency                        '                           
         DC    AL2(CT#CUR)                                                      
         DC    AL1(76,GENDIRQ,00,00,00,ADSTSTD+ADSTSECX)                        
         DC    AL1(03),XL3'0000C3'                                              
         DC    AL4(0,0,0,0),AL4(CURRENR,DEFKYOUT,0)                             
*                                                                               
         DC    CL32'Exchange Rate                   '                           
         DC    AL2(CT#XRATE)                                                    
         DC    AL1(77,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'0000C5'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Message                         '                           
         DC    AL2(000)                                                         
         DC    AL1(78,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'0000D4'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Spare                           '                           
         DC    AL2(000)                                                         
         DC    AL1(79,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'FFFFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Narrative                       '                           
         DC    AL2(000)                                                         
         DC    AL1(80,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'0000D5'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Help                            '                           
         DC    AL2(CT#HELP)                                                     
         DC    AL1(81,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0002FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Driver Dictionary               '                           
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(82,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0003FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'TV/Data Panel                   '                           
         DC    AL2(000)                                                         
         DC    AL1(83,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0007FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Broadcast                       '                           
         DC    AL2(000)                                                         
         DC    AL1(84,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'0009FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'XFILE Group Pointer             '                           
         DC    AL2(000)                                                         
         DC    AL1(85,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(02),XL3'000012'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Fees - Channel Configuration    '                           
         DC    AL2(000)                                                         
         DC    AL1(86,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00C6C3'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Fees - New Channel Configuration'                           
         DC    AL2(000)                                                         
         DC    AL1(87,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00C603'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Fees - National Insurance       '                           
         DC    AL2(000)                                                         
         DC    AL1(88,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00C6D5'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Fees - Payment Parameters       '                           
         DC    AL2(000)                                                         
         DC    AL1(89,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00C6D7'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Fees - Role Descriptions        '                           
         DC    AL2(000)                                                         
         DC    AL1(90,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00C6D9'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Fees - TVR Bands                '                           
         DC    AL2(000)                                                         
         DC    AL1(91,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00C6E3'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'NFILE Action Definition         '                           
         DC    AL2(000)                                                         
         DC    AL1(92,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00E7C1'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'NFILE Download Definition       '                           
         DC    AL2(000)                                                         
         DC    AL1(93,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00E7C4'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'NFILE Field Definition          '                           
         DC    AL2(000)                                                         
         DC    AL1(94,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00E7C6'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'NFILE PFKey Definition          '                           
         DC    AL2(000)                                                         
         DC    AL1(95,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00E7D7'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'NFILE Record Definition         '                           
         DC    AL2(000)                                                         
         DC    AL1(96,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00E7D9'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'NFILE Screen Definition         '                           
         DC    AL2(000)                                                         
         DC    AL1(97,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00E7E2'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'NFILE Default Column Definition  '                          
         DC    AL2(000)                                                         
         DC    AL1(98,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00E7E7'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'PC Billing Data Source          '                           
         DC    AL2(000)                                                         
         DC    AL1(99,GENDIRQ,00,00,00,ADSTSECX)                                
         DC    AL1(03),XL3'00C1C4'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'PC Billing Keyword List         '                           
         DC    AL2(000)                                                         
         DC    AL1(100,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'00C1D2'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Scroller Datatype               '                           
         DC    AL2(000)                                                         
         DC    AL1(101,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'000DFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'EXTRACT - Agency                '                           
         DC    AL2(000)                                                         
         DC    AL1(102,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'000010'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'EXTRACT - ESS (Server) Control  '                           
         DC    AL2(000)                                                         
         DC    AL1(103,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'000020'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'EXTRACT - Extract File Defn.     '                          
         DC    AL2(000)                                                         
         DC    AL1(104,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'000030'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'EXTRACT - Recovery System Log    '                          
         DC    AL2(000)                                                         
         DC    AL1(105,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'000040'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'ESS Id                          '                           
         DC    AL2(000)                                                         
         DC    AL1(106,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'000050'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'PQ Report Tranformation Control  '                          
         DC    AL2(000)                                                         
         DC    AL1(107,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'000060'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Equate Name                      '                          
         DC    AL2(000)                                                         
         DC    AL1(108,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'000094'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Report Spec                      '                          
         DC    AL2(000)                                                         
         DC    AL1(109,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'0070FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Staff                            '                          
         DC    AL2(CT#STAFF)                                                    
         DC    AL1(110,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'0051FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Staff - Passive                  '                          
         DC    AL2(000)                                                         
         DC    AL1(111,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'0055FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'ADV / Agency                     '                          
         DC    AL2(000)                                                         
         DC    AL1(111,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'0060FF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Agency Routing                   '                          
         DC    AL2(000)                                                         
         DC    AL1(112,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'005BFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Dare Rep Table                   '                          
         DC    AL2(000)                                                         
         DC    AL1(113,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'005CFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'RFP                              '                          
         DC    AL2(000)                                                         
         DC    AL1(113,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(02),XL3'002FFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
         DC    CL32'Dare Assist Initials             '                          
         DC    AL2(CT#ASST)                                                     
         DC    AL1(114,GENDIRQ,00,00,00,ADSTSECX)                               
         DC    AL1(03),XL3'0000C4'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
ADDTABMX EQU   (*-ADDTAB)/ADDTABLQ *** NUMBER OF ENTRIES                        
*        NEXT FREE NUMBER = 118                                                 
*                                                                               
CTUADD   DC    CL32'Unknown record types             '                          
         DC    AL2(CT#UNKNW)                                                    
         DC    AL1(255,00,00,00,00,00)                                          
         DC    AL1(00),XL3'FFFFFF'                                              
         DC    AL4(0,0,0,0),AL4(DEFKYOUT,DEFKYOUT,0)                            
*                                                                               
ADDTOTS  DC    CL32'---FILE TOTALS-------------------'                          
         DC    AL2(CT#TOTLS)                                                    
         DC    AL1(000,00,00,00,00,00)                                          
         DC    AL1(00),XL3'FFFFFF'                                              
         DC    AL4(0,0,0,0),AL4(0,0,0)                                          
*                                                                               
ADDTABX  DC    32X'FF'                                                          
         EJECT                                                                  
***********************************************************************         
* ELEMENT ARRAY (SAVES SEQUENTIAL SEARCH)                             *         
***********************************************************************         
CTELEMS  DC    A(CT01,CT02,CT03,CT04,CT05,CT06,CT07,CT08)                       
         DC    A(CT09,CT0A,CT0B,CT0C,CT0D,CT0E,CT0F,CT10)                       
         DC    A(CT11,CT12,CT13,CT14,CT15,CT16,CT17,CT18)                       
         DC    A(CT19,CT1A,CT1B,CT1C,CT1D,CT1E,CT1F,CT20)                       
         DC    A(CT21,CT22,CT23,CT24,CT25,CT26,CT27,CT28)                       
         DC    A(CT29,CT2A,CT2B,CT2C,CT2D,CT2E,CT2F,CT30)                       
         DC    A(CT31,CT32,CT33,CT34,CT35,CT36,CT37,CT38)                       
         DC    A(CT39,CT3A,CT3B,CT3C,CT3D,CT3E,CT3F,CT40)                       
         DC    A(CT41,CT42,CT43,CT44,CT45,CT46,CT47,CT48)                       
         DC    A(CT49,CT4A,CT4B,CT4C,CT4D,CT4E,CT4F,CT50)                       
         DC    A(CT51,CT52,CT53,CT54,CT55,CT56,CT57,CT58)                       
         DC    A(CT59,CT5A,CT5B,CT5C,CT5D,CT5E,CT5F,CT60)                       
         DC    A(CT61,CT62,CT63,CT64,CT65,CT66,CT67,CT68)                       
         DC    A(CT69,CT6A,CT6B,CT6C,CT6D,CT6E,CT6F,CT70)                       
         DC    A(CT71,CT72,CT73,CT74,CT75,CT76,CT77,CT78)                       
         DC    A(CT79,CT7A,CT7B,CT7C,CT7D,CT7E,CT7F,CT80)                       
         DC    A(CT81,CT82,CT83,CT84,CT85,CT86,CT87,CT88)                       
         DC    A(CT89,CT8A,CT8B,CT8C,CT8D,CT8E,CT8F,CT90)                       
         DC    A(CT91,CT92,CT93,CT94,CT95,CT96,CT97,CT98)                       
         DC    A(CT99,CT9A,CT9B,CT9C,CT9D,CT9E,CT9F,CTA0)                       
         DC    A(CTA1,CTA2,CTA3,CTA4,CTA5,CTA6,CTA7,CTA8)                       
         DC    A(CTA9,CTAA,CTAB,CTAC,CTAD,CTAE,CTAF,CTB0)                       
         DC    A(CTB1,CTB2,CTB3,CTB4,CTB5,CTB6,CTB7,CTB8)                       
         DC    A(CTB9,CTBA,CTBB,CTBC,CTBD,CTBE,CTBF,CTC0)                       
         DC    A(CTC1,CTC2,CTC3,CTC4,CTC5,CTC6,CTC7,CTC8)                       
         DC    A(CTC9,CTCA,CTCB,CTCC,CTCD,CTCE,CTCF,CTD0)                       
         DC    A(CTD1,CTD2,CTD3,CTD4,CTD5,CTD6,CTD7,CTD8)                       
         DC    A(CTD9,CTDA,CTDB,CTDC,CTDD,CTDE,CTDF,CTE0)                       
         DC    A(CTE1,CTE2,CTE3,CTE4,CTE5,CTE6,CTE7,CTE8)                       
         DC    A(CTE9,CTEA,CTEB,CTEC,CTED,CTEE,CTEF,CTF0)                       
         DC    A(CTF1,CTF2,CTF3,CTF4,CTF5,CTF6,CTF7,CTF8)                       
         DC    A(CTF9,CTFA,CTFB,CTFC,CTFD,CTFE,CTFF,0000)                       
         EJECT                                                                  
***********************************************************************         
* ELEMENT DESCRIPTOR TABLE (COVERED BY CTELEMD)                       *         
***********************************************************************         
CT01     DC    AL2(CT02-CT01),X'01',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT01ELM,CT01ELM,0)                                   
         DC    AL1(0,1,0),CL30'Description                   '                  
         DC    AL2(CT#DESC)                                                     
         DC    AL1(0,71,0),CL30'Fax Number                    '                 
         DC    AL2(000)                                                         
         DC    AL1(0,73,0),CL30'Program Details               '                 
         DC    AL2(000)                                                         
         DC    AL1(0,74,0),CL30'Program Details               '                 
         DC    AL2(000)                                                         
         DC    AL1(0,75,0),CL30'Program Details               '                 
         DC    AL2(000)                                                         
         DC    AL1(0,94,0),CL30'Screen Field Information      '                 
         DC    AL2(000)                                                         
         DC    AL1(0,113,0),CL30'RFP Group Header              '                
         DC    AL2(000)                                                         
         DC    AL1(0,0,0),CL30'Activity                      '                  
         DC    AL2(CT#ACTY)                                                     
*                                                                               
CT02     DC    AL2(CT03-CT02),X'02',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT02ELM,CT02ELM,0)                                   
         DC    AL1(0,1,0),CL30'Field Data                    '                  
         DC    AL2(000)                                                         
         DC    AL1(0,71,0),CL30'Attention Name                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,73,0),CL30'Action Information            '                 
         DC    AL2(000)                                                         
         DC    AL1(0,74,0),CL30'Action Information            '                 
         DC    AL2(000)                                                         
         DC    AL1(0,75,0),CL30'Action Information            '                 
         DC    AL2(000)                                                         
         DC    AL1(0,114,0),CL30'Initials Activity Information '                
         DC    AL2(000)                                                         
         DC    AL1(0,0,0),CL30'Description                   '                  
         DC    AL2(CT#DESC)                                                     
*                                                                               
CT03     DC    AL2(CT04-CT03),X'03',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT03ELM,CT03ELM,0)                                   
         DC    AL1(0,71,0),CL30'Fax Message Line              '                 
         DC    AL2(000)                                                         
         DC    AL1(0,73,0),CL30'Record Description            '                 
         DC    AL2(000)                                                         
         DC    AL1(0,74,0),CL30'Record Description            '                 
         DC    AL2(000)                                                         
         DC    AL1(0,75,0),CL30'Record Description            '                 
         DC    AL2(000)                                                         
         DC    AL1(0,92,0),CL30'Record Information            '                 
         DC    AL2(000)                                                         
         DC    AL1(0,97,0),CL30'Screen Field Position         '                 
         DC    AL2(000)                                                         
         DC    AL1(0,114,0),CL30'Assistant Initials            '                
         DC    AL2(CT#INITS)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Passive Pointer               '           
         DC    AL2(000)                                                         
*                                                                               
CT04     DC    AL2(CT05-CT04),X'04',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT04ELM,CT04ELM,0)                                   
         DC    AL1(0,42,0),CL30'Index                         '                 
         DC    AL2(000)                                                         
         DC    AL1(0,44,0),CL30'Index                         '                 
         DC    AL2(000)                                                         
         DC    AL1(0,71,0),CL30'Fax Return Number             '                 
         DC    AL2(000)                                                         
         DC    AL1(0,73,0),CL30'Language for Record/Action    '                 
         DC    AL2(CT#LANG)                                                     
         DC    AL1(0,74,0),CL30'Language for Record/Action    '                 
         DC    AL2(CT#LANG)                                                     
         DC    AL1(0,75,0),CL30'Language for Record/Action    '                 
         DC    AL2(CT#LANG)                                                     
         DC    AL1(0,82,0),CL30'Input Field                   '                 
         DC    AL2(000)                                                         
         DC    AL1(0,93,0),CL30'Download Column List          '                 
         DC    AL2(000)                                                         
         DC    AL1(0,94,0),CL30'Filter Field Information      '                 
         DC    AL2(000)                                                         
         DC    AL1(0,98,0),CL30'Default Column List           '                 
         DC    AL2(GE#DCLM)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 04 ELEMENT            '           
         DC    AL2(000)                                                         
*                                                                               
CT05     DC    AL2(CT06-CT05),X'05',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,73,0),CL30'Person Name                   '                 
         DC    AL2(CT#PERN)                                                     
         DC    AL1(0,74,0),CL30'Person Name                   '                 
         DC    AL2(CT#PERN)                                                     
         DC    AL1(0,75,0),CL30'Person Name                   '                 
         DC    AL2(CT#PERN)                                                     
         DC    AL1(0,84,0),CL30'High Message Number           '                 
         DC    AL2(000)                                                         
         DC    AL1(0,96,0),CL30'Record Definition             '                 
         DC    AL2(000)                                                         
         DC    AL1(0,23,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,24,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,25,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,26,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,27,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,28,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,29,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,30,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,31,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,32,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,33,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,34,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,35,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,36,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,37,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,38,0),CL30'Limit Access List             '                 
         DC    AL2(CT#LAGL)                                                     
         DC    AL1(0,82,0),CL30'Sub-entry                     '                 
         DC    AL2(000)                                                         
         DC    AL1(0,92,0),CL30'Action definition             '                 
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'System Element                '            
         DC    AL2(CT#VALS)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 05 Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT06     DC    AL2(CT07-CT06),X'06',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT06ELM,CT06ELM,0)                                   
         DC    AL1(0,73,0),CL30'Person Title                  '                 
         DC    AL2(CT#TITLE)                                                    
         DC    AL1(0,74,0),CL30'Person Title                  '                 
         DC    AL2(CT#TITLE)                                                    
         DC    AL1(0,75,0),CL30'Person Title                  '                 
         DC    AL2(CT#TITLE)                                                    
         DC    AL1(CTFILEQ,0,0),CL30'Agency Alpha Id                 '          
         DC    AL2(CT#AGYAL)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 06 Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT07     DC    AL2(CT08-CT07),X'07',XL5'0000000000'                             
         DC    AL4(CT07PAIR,CT07ELM,CT07ELM,0)                                  
         DC    AL1(0,73,0),CL30'Record/Action combo           '                 
         DC    AL2(000)                                                         
         DC    AL1(0,74,0),CL30'Record/Action combo           '                 
         DC    AL2(000)                                                         
         DC    AL1(0,75,0),CL30'Record/Action combo           '                 
         DC    AL2(000)                                                         
         DC    AL1(0,95,0),CL30'PFKey definition              '                 
         DC    AL2(000)                                                         
         DC    AL1(0,117,CTEIBASQ),CL30'Limit Access List Element     '         
         DC    AL2(CT#TXLIM)                                                    
         DC    AL1(CTFILEQ,0,0),CL30'User Id Options                '           
         DC    AL2(CT#OPTS)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 07 Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT08     DC    AL2(CT09-CT08),X'08',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,73,0),CL30'Limit access                  '                 
         DC    AL2(CT#LIMAC)                                                    
         DC    AL1(0,74,0),CL30'Limit access                  '                 
         DC    AL2(CT#LIMAC)                                                    
         DC    AL1(0,75,0),CL30'Limit access                  '                 
         DC    AL2(CT#LIMAC)                                                    
         DC    AL1(0,82,0),CL30'Attribute                     '                 
         DC    AL2(000)                                                         
         DC    AL1(0,86,0),CL30'VAT Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,87,0),CL30'VAT Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,88,0),CL30'VAT Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,89,0),CL30'VAT Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,90,0),CL30'VAT Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,91,0),CL30'VAT Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,97,0),CL30'Shadow screen pointer         '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 08 Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT09     DC    AL2(CT0A-CT09),X'09',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,73,0),CL30'Department                    '                 
         DC    AL2(CT#DPT)                                                      
         DC    AL1(0,74,0),CL30'Department                    '                 
         DC    AL2(CT#DPT)                                                      
         DC    AL1(0,75,0),CL30'Department                    '                 
         DC    AL2(CT#DPT)                                                      
         DC    AL1(0,97,0),CL30'Page Name                     '                 
         DC    AL2(GE#PNAME)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 09 Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT0A     DC    AL2(CT0B-CT0A),X'0A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 0A Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT0B     DC    AL2(CT0C-CT0B),X'0B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 0B Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT0C     DC    AL2(CT0D-CT0C),X'0C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 0C Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT0D     DC    AL2(CT0E-CT0D),X'0D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 0D Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT0E     DC    AL2(CT0F-CT0E),X'0E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 0E Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT0F     DC    AL2(CT10-CT0F),X'0F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 0F Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT10     DC    AL2(CT11-CT10),X'10',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT10ELM,CT10ELM,0)                                   
         DC    AL1(0,1,0),CL30'Filter                       '                   
         DC    AL2(GE#FLT)                                                      
         DC    AL1(0,77,0),CL30'Exchange Rate                '                  
         DC    AL2(CT#XRATE)                                                    
         DC    AL1(0,78,0),CL30'Short Message                '                  
         DC    AL2(000)                                                         
         DC    AL1(0,80,0),CL30'Narrative Data               '                  
         DC    AL2(000)                                                         
         DC    AL1(0,81,0),CL30'Heading                      '                  
         DC    AL2(CT#HEAD)                                                     
         DC    AL1(0,82,0),CL30'Record Start                 '                  
         DC    AL2(000)                                                         
         DC    AL1(0,84,0),CL30'Filter                       '                  
         DC    AL2(CT#FLT)                                                      
         DC    AL1(0,86,0),CL30'NIC (EES/ERS) Parameters     '                  
         DC    AL2(000)                                                         
         DC    AL1(0,87,0),CL30'NIC (EES/ERS) Parameters     '                  
         DC    AL2(000)                                                         
         DC    AL1(0,88,0),CL30'NIC (EES/ERS) Parameters     '                  
         DC    AL2(000)                                                         
         DC    AL1(0,89,0),CL30'NIC (EES/ERS) Parameters     '                  
         DC    AL2(000)                                                         
         DC    AL1(0,91,0),CL30'NIC (EES/ERS) Parameters     '                  
         DC    AL2(000)                                                         
         DC    AL1(0,90,0),CL30'Role Description Parameter   '                  
         DC    AL2(000)                                                         
         DC    AL1(0,101,0),CL30'Name text (Row Display)      '                 
         DC    AL2(000)                                                         
         DC    AL1(0,113,0),CL30'Date range                   '                 
         DC    AL2(000)                                                         
         DC    AL1(0,115,0),CL30'Subject Text                 '                 
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Data                         '             
         DC    AL2(GE#DATA)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 10 Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT11     DC    AL2(CT12-CT11),X'11',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,77,0),CL30'Exchange Rate as Input       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,78,0),CL30'Sub-Language Message Number  '                  
         DC    AL2(000)                                                         
         DC    AL1(0,115,0),CL30'Text Line 1                  '                 
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Include                      '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 11 Element            '           
         DC    AL2(000)                                                         
*                                                                               
CT12     DC    AL2(CT13-CT12),X'12',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,78,0),CL30'Full Text Message            '                  
         DC    AL2(000)                                                         
         DC    AL1(0,82,0),CL30'Data Start                   '                  
         DC    AL2(000)                                                         
         DC    AL1(0,86,0),CL30'Channel configuration        '                  
         DC    AL2(000)                                                         
         DC    AL1(0,87,0),CL30'Channel configuration        '                  
         DC    AL2(000)                                                         
         DC    AL1(0,88,0),CL30'Channel configuration        '                  
         DC    AL2(000)                                                         
         DC    AL1(0,89,0),CL30'Channel configuration        '                  
         DC    AL2(000)                                                         
         DC    AL1(0,90,0),CL30'Channel configuration        '                  
         DC    AL2(000)                                                         
         DC    AL1(0,91,0),CL30'Channel configuration        '                  
         DC    AL2(000)                                                         
         DC    AL1(0,115,0),CL30'Text Line 2                  '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 12 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT13     DC    AL2(CT14-CT13),X'13',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,115,0),CL30'Text Line 3                  '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 13 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT14     DC    AL2(CT15-CT14),X'14',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,78,0),CL30'Message Help Pointer         '                  
         DC    AL2(000)                                                         
         DC    AL1(0,82,0),CL30'Set/Unset                    '                  
         DC    AL2(000)                                                         
         DC    AL1(0,115,0),CL30'Text Line 4                  '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 14 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT15     DC    AL2(CT16-CT15),X'15',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,6,0),CL30'Reload List                  '                   
         DC    AL2(000)                                                         
         DC    AL1(0,62,0),CL30'Subnet Mask                  '                  
         DC    AL2(000)                                                         
         DC    AL1(0,81,0),CL30'Status                       '                  
         DC    AL2(CT#STT)                                                      
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 15 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT16     DC    AL2(CT17-CT16),X'16',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,78,0),CL30'Program Sub-Id + Max Length  '                  
         DC    AL2(000)                                                         
         DC    AL1(0,86,0),CL30'Pay Period                   '                  
         DC    AL2(CT#FORPR)                                                    
         DC    AL1(0,87,0),CL30'Pay Period                   '                  
         DC    AL2(CT#FORPR)                                                    
         DC    AL1(0,88,0),CL30'Pay Period                   '                  
         DC    AL2(CT#FORPR)                                                    
         DC    AL1(0,89,0),CL30'Pay Period                   '                  
         DC    AL2(CT#FORPR)                                                    
         DC    AL1(0,90,0),CL30'Pay Period                   '                  
         DC    AL2(CT#FORPR)                                                    
         DC    AL1(0,91,0),CL30'Pay Period                   '                  
         DC    AL2(CT#FORPR)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 16 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT17     DC    AL2(CT18-CT17),X'17',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 17 Element           '            
*                                                                               
CT18     DC    AL2(CT19-CT18),X'18',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,78,0),CL30'Equate symbol + Misc Info    '                  
         DC    AL2(000)                                                         
         DC    AL1(0,86,0),CL30'Pay Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,87,0),CL30'Pay Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,88,0),CL30'Pay Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,89,0),CL30'Pay Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,90,0),CL30'Pay Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,91,0),CL30'Pay Percentage                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 18 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT19     DC    AL2(CT1A-CT19),X'19',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 19 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT1A     DC    AL2(CT1B-CT1A),X'1A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 1A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT1B     DC    AL2(CT1C-CT1B),X'1B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 1B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT1C     DC    AL2(CT1D-CT1C),X'1C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 1C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT1D     DC    AL2(CT1E-CT1D),X'1D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 1D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT1E     DC    AL2(CT1F-CT1E),X'1E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 1E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT1F     DC    AL2(CT20-CT1F),X'1F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT1FELM,CT1FELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Principal Id                 '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 1F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT20     DC    AL2(CT21-CT20),X'20',XL5'0000000000'                             
         DC    AL4(CT20PAIR,CT20ELM,CT20ELM,0)                                  
         DC    AL1(0,1,0),CL30'Other Data                   '                   
         DC    AL2(000)                                                         
         DC    AL1(0,78,0),CL30'High Message Number          '                  
         DC    AL2(000)                                                         
         DC    AL1(0,81,0),CL30'Text                         '                  
         DC    AL2(000)                                                         
         DC    AL1(0,82,0),CL30'Input Statement Header       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,84,0),CL30'Heading                      '                  
         DC    AL2(CT#HEAD)                                                     
         DC    AL1(0,113,0),CL30'Group Symbolic Value         '                 
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,CTEIBASQ),CL30'Compatible ID'                      
         DC    AL2(CT#CMPID)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 20 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT21     DC    AL2(CT22-CT21),X'21',XL5'0000000000'                             
         DC    AL4(CT21PAIR,CT21ELM,CT21ELM,0)                                  
         DC    AL1(0,68,0),CL30'Address Line 1               '                  
         DC    AL2(GE#ADRL1)                                                    
         DC    AL1(0,82,0),CL30'Output Statement Label       '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'System Authorisation         '             
         DC    AL2(CT#AULST)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 21 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT22     DC    AL2(CT23-CT22),X'22',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,68,0),CL30'Address Line 2               '                  
         DC    AL2(GE#ADRL2)                                                    
         DC    AL1(0,82,0),CL30'Input Type                   '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Program Information          '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 22 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT23     DC    AL2(CT24-CT23),X'23',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT23ELM,CT23ELM,0)                                   
         DC    AL1(0,68,0),CL30'Address Line 3               '                  
         DC    AL2(GE#ADRL3)                                                    
         DC    AL1(0,82,0),CL30'Input Length                 '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Program Test                 '             
         DC    AL2(GE#TEST)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 23 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT24     DC    AL2(CT25-CT24),X'24',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT24ELM,CT24ELM,0)                                   
         DC    AL1(0,52,0),CL30'Application Id               '                  
         DC    AL2(000)                                                         
         DC    AL1(0,68,0),CL30'Address Line 4               '                  
         DC    AL2(GE#ADRL4)                                                    
         DC    AL1(0,82,0),CL30'Input Routine                '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 24 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT25     DC    AL2(CT26-CT25),X'25',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT25ELM,CT25ELM,0)                                   
         DC    AL1(0,6,0),CL30'Description                  '                   
         DC    AL2(CT#DESC)                                                     
         DC    AL1(0,82,0),CL30'Input Arguments              '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Terminal Definition          '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 25 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT26     DC    AL2(CT27-CT26),X'26',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT26ELM,CT26ELM,0)                                   
         DC    AL1(0,82,0),CL30'Input Options                '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'VTAM Luid                    '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 26 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT27     DC    AL2(CT28-CT27),X'27',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT27ELM,CT27ELM,0)                                   
         DC    AL1(0,82,0),CL30'Input Column (for ranking)   '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Terminal Information         '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 27 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT28     DC    AL2(CT29-CT28),X'28',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(CTFILEQ,0,0),CL30'Printer Id                   '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 28 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT29     DC    AL2(CT2A-CT29),X'29',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT29ELM,CT29ELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Default Printer Queue        '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 29 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT2A     DC    AL2(CT2B-CT2A),X'2A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 2A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT2B     DC    AL2(CT2C-CT2B),X'2B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 2B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT2C     DC    AL2(CT2D-CT2C),X'2C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 2C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT2D     DC    AL2(CT2E-CT2D),X'2D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 2D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT2E     DC    AL2(CT2F-CT2E),X'2E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 2E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT2F     DC    AL2(CT30-CT2F),X'2F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 2F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT30     DC    AL2(CT31-CT30),X'30',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT30ELM,CT30ELM,0)                                   
         DC    AL1(0,82,0),CL30'Output Header                '                  
         DC    AL2(000)                                                         
         DC    AL1(0,084,0),CL30'Broadcast Text               '                 
         DC    AL2(000)                                                         
         DC    AL1(0,113,0),CL30'Request Information          '                 
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Destination detail           '             
         DC    AL2(CT#DEST)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 30 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT31     DC    AL2(CT32-CT31),X'31',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT31ELM,CT31ELM,0)                                   
         DC    AL1(0,82,0),CL30'Input Statement Label        '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Attention Detail             '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 31 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT32     DC    AL2(CT33-CT32),X'32',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT32ELM,CT32ELM,0)                                   
         DC    AL1(0,82,0),CL30'Output Statement Label       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 32 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT33     DC    AL2(CT34-CT33),X'33',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT33ELM,CT33ELM,0)                                   
         DC    AL1(0,82,0),CL30'Output Length                '                  
         DC    AL2(000)                                                         
*&&UK*&& DC    AL1(CTFILEQ,0,0),CL30'Agency Definition            '             
*&&UK*&& DC    AL2(000)                                                         
*&&US*&& DC    AL1(CTFILEQ,0,0),CL30'Agency Extra Information     '             
*&&US*&& DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 33 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT34     DC    AL2(CT35-CT34),X'34',XL5'0000000000'                             
         DC    AL4(CT34PAIR,0,0,0)                                              
         DC    AL1(0,82,0),CL30'Output Routine               '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Valid Destination            '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 34 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT35     DC    AL2(CT36-CT35),X'35',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT35ELM,CT35ELM,0)                                   
         DC    AL1(0,6,0),CL30'Comment                      '                   
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,82,0),CL30'Output Argument              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 35 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT36     DC    AL2(CT37-CT36),X'36',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT36ELM,CT36ELM,0)                                   
         DC    AL1(0,82,0),CL30'Output Option                '                  
         DC    AL2(000)                                                         
         DC    AL1(0,86,0),CL30'Agreement Expiry             '                  
         DC    AL2(000)                                                         
         DC    AL1(0,87,0),CL30'Agreement Expiry             '                  
         DC    AL2(000)                                                         
         DC    AL1(0,88,0),CL30'Agreement Expiry             '                  
         DC    AL2(000)                                                         
         DC    AL1(0,89,0),CL30'Agreement Expiry             '                  
         DC    AL2(000)                                                         
         DC    AL1(0,90,0),CL30'Agreement Expiry             '                  
         DC    AL2(000)                                                         
         DC    AL1(0,91,0),CL30'Agreement Expiry             '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Origin Detail                '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 36 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT37     DC    AL2(CT38-CT37),X'37',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 37 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT38     DC    AL2(CT39-CT38),X'38',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT38ELM,CT38ELM,0)                                   
         DC    AL1(0,86,0),CL30'Band Percentage              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,87,0),CL30'Band Percentage              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,88,0),CL30'Band Percentage              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,89,0),CL30'Band Percentage              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,90,0),CL30'Band Percentage              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,91,0),CL30'Band Percentage              '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Output Detail                '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 38 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT39     DC    AL2(CT3A-CT39),X'39',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 39 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT3A     DC    AL2(CT3B-CT3A),X'3A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT3AELM,CT3AELM,0)                                   
         DC    AL1(0,76,0),CL30'Currency                     '                  
         DC    AL2(CT#CUR)                                                      
         DC    AL1(0,77,0),CL30'Currency                     '                  
         DC    AL2(CT#CUR)                                                      
         DC    AL1(CTFILEQ,0,0),CL30'Valid Printer                '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 3A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT3B     DC    AL2(CT3C-CT3B),X'3B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 3B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT3C     DC    AL2(CT3D-CT3C),X'3C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 3C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT3D     DC    AL2(CT3E-CT3D),X'3D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 3D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT3E     DC    AL2(CT3F-CT3E),X'3E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT3EELM,CT3EELM,0)                                   
         DC    AL1(0,86,0),CL30'Comment                      '                  
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,87,0),CL30'Comment                      '                  
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,88,0),CL30'Comment                      '                  
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,89,0),CL30'Comment                      '                  
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,90,0),CL30'Comment                      '                  
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,91,0),CL30'Comment                      '                  
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 3E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT3F     DC    AL2(CT40-CT3F),X'3F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 3F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT40     DC    AL2(CT41-CT40),X'40',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT40ELM,CT40ELM,0)                                   
         DC    AL1(0,82,0),CL30'Head Statement               '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Destination Code             '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 40 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT41     DC    AL2(CT42-CT41),X'41',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT41ELM,CT41ELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Attention Type               '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 41 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT42     DC    AL2(CT43-CT42),X'42',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT42ELM,CT42ELM,0)                                   
         DC    AL1(0,82,0),CL30'Chunk Statement              '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Output Type Code             '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 42 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT43     DC    AL2(CT44-CT43),X'43',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT43ELM,CT43ELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Output Mode Type             '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 43 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT44     DC    AL2(CT45-CT44),X'44',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT44ELM,CT44ELM,0)                                   
         DC    AL1(0,82,0),CL30'First/Last Statement         '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Priority Code                '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 44 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT45     DC    AL2(CT46-CT45),X'45',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT45ELM,CT45ELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Reader Class                 '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 45 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT46     DC    AL2(CT47-CT46),X'46',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT46ELM,CT46ELM,0)                                   
         DC    AL1(0,82,0),CL30'Control Break Instructions   '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'SORT Data Formula            '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 46 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT47     DC    AL2(CT48-CT47),X'47',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT47ELM,CT47ELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Print Queue Password         '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 47 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT48     DC    AL2(CT49-CT48),X'48',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT48ELM,CT48ELM,0)                                   
         DC    AL1(0,82,0),CL30'Total Statement              '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,82,0),CL30'Processing Instructions      '            
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 48 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT49     DC    AL2(CT4A-CT49),X'49',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT49ELM,CT49ELM,0)                                   
         DC    AL1(0,82,0),CL30'Total Detail                 '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Print Queue Retain Class     '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 49 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT4A     DC    AL2(CT4B-CT4A),X'4A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT4AELM,CT4AELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Packing Instructions         '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 4A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT4B     DC    AL2(CT4C-CT4B),X'4B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT4BELM,CT4BELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Report Short Description     '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 4B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT4C     DC    AL2(CT4D-CT4C),X'4C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT4CELM,CT4CELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Shipping Instructions        '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 4C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT4D     DC    AL2(CT4E-CT4D),X'4D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT4DELM,CT4DELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'JCL Exception                '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 4D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT4E     DC    AL2(CT4F-CT4E),X'4E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT4EELM,CT4EELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Test Phase                   '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 4E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT4F     DC    AL2(CT50-CT4F),X'4F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT4FELM,CT4FELM,0)                                   
         DC    AL1(CTFILEQ,0,0),CL30'Report Form Code             '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 4F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT50     DC    AL2(CT51-CT50),X'50',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'Start Computation Expression '                  
         DC    AL2(000)                                                         
         DC    AL1(0,101,0),CL30'Name Text                    '                 
         DC    AL2(000)                                                         
         DC    AL1(0,106,0),CL30'ID Definition                '                 
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'SQL Transform Formula        '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 50 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT51     DC    AL2(CT52-CT51),X'51',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT51ELM,CT51ELM,0)                                   
         DC    AL1(0,48,0),CL30'Archive report type          '                  
         DC    AL2(000)                                                         
         DC    AL1(0,106,0),CL30'Associated LU                '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 51 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT52     DC    AL2(CT53-CT52),X'52',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT52ELM,CT52ELM,0)                                   
         DC    AL1(0,48,0),CL30'Archive class                '                  
         DC    AL2(000)                                                         
         DC    AL1(0,82,0),CL30'Computation Formula          '                  
         DC    AL2(000)                                                         
         DC    AL1(0,106,0),CL30'Contact Person               '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 52 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT53     DC    AL2(CT54-CT53),X'53',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 53 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT54     DC    AL2(CT55-CT54),X'54',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 54 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT55     DC    AL2(CT56-CT55),X'55',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 55 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT56     DC    AL2(CT57-CT56),X'56',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(CTFILEQ,0,0),CL30'Timing                       '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 56 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT57     DC    AL2(CT58-CT57),X'57',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 57 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT58     DC    AL2(CT59-CT58),X'58',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,101,0),CL30'Name Text (Column Display)   '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 58 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT59     DC    AL2(CT5A-CT59),X'59',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 59 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT5A     DC    AL2(CT5B-CT5A),X'5A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 5A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT5B     DC    AL2(CT5C-CT5B),X'5B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 5B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT5C     DC    AL2(CT5D-CT5C),X'5C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 5C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT5D     DC    AL2(CT5E-CT5D),X'5D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 5D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT5E     DC    AL2(CT5F-CT5E),X'5E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 5E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT5F     DC    AL2(CT60-CT5F),X'5F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 5F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT60     DC    AL2(CT61-CT60),X'60',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'Condition                    '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 60 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT61     DC    AL2(CT62-CT61),X'61',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 61 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT62     DC    AL2(CT63-CT62),X'62',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'Sub-Condition                '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 62 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT63     DC    AL2(CT64-CT63),X'63',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 63 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT64     DC    AL2(CT65-CT64),X'64',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,082,0),CL30'Max/Min Condition            '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 64 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT65     DC    AL2(CT66-CT65),X'65',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 65 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT66     DC    AL2(CT67-CT66),X'66',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 66 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT67     DC    AL2(CT68-CT67),X'67',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 67 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT68     DC    AL2(CT69-CT68),X'68',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 68 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT69     DC    AL2(CT6A-CT69),X'69',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 69 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT6A     DC    AL2(CT6B-CT6A),X'6A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 6A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT6B     DC    AL2(CT6C-CT6B),X'6B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 6B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT6C     DC    AL2(CT6D-CT6C),X'6C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 6C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT6D     DC    AL2(CT6E-CT6D),X'6D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 6D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT6E     DC    AL2(CT6F-CT6E),X'6E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 6E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT6F     DC    AL2(CT70-CT6F),X'6F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 6F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT70     DC    AL2(CT71-CT70),X'70',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT70ELM,CT70ELM,0)                                   
         DC    AL1(0,53,0),CL30'Profile Field Definition     '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 70 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT71     DC    AL2(CT72-CT71),X'71',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,53,0),CL30'Profile Post Edit Validation '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 71 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT72     DC    AL2(CT73-CT72),X'72',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CT72ELM,CT72ELM,0)                                   
         DC    AL1(0,53,0),CL30'Profile Value                '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 72 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT73     DC    AL2(CT74-CT73),X'73',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 73 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT74     DC    AL2(CT75-CT74),X'74',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(CTFILEQ,0,0),CL30'Demo Extract                 '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 74 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT75     DC    AL2(CT76-CT75),X'75',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 75 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT76     DC    AL2(CT77-CT76),X'76',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(CTFILEQ,0,0),CL30'Program Type Equivalent      '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 76 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT77     DC    AL2(CT78-CT77),X'77',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 77 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT78     DC    AL2(CT79-CT78),X'78',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(CTFILEQ,0,0),CL30'CPP Projection Factor        '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 78 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT79     DC    AL2(CT7A-CT79),X'79',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 79 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT7A     DC    AL2(CT7B-CT7A),X'7A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 7A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT7B     DC    AL2(CT7C-CT7B),X'7B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 7B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT7C     DC    AL2(CT7D-CT7C),X'7C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 7C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT7D     DC    AL2(CT7E-CT7D),X'7D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 7D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT7E     DC    AL2(CT7F-CT7E),X'7E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 7E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT7F     DC    AL2(CT80-CT7F),X'7F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 7F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT80     DC    AL2(CT81-CT80),X'80',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'Dictionary Name              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 80 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT81     DC    AL2(CT82-CT81),X'81',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'Entry Name                   '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 81 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT82     DC    AL2(CT83-CT82),X'82',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'System Routine               '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 82 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT83     DC    AL2(CT84-CT83),X'83',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'System Arguments             '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 83 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT84     DC    AL2(CT85-CT84),X'84',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'IF Condition Label           '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 84 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT85     DC    AL2(CT86-CT85),X'85',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'NOT Condition Label          '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 85 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT86     DC    AL2(CT87-CT86),X'86',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'Output Print Position        '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 86 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT87     DC    AL2(CT88-CT87),X'87',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,82,0),CL30'Output Literal               '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 87 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT88     DC    AL2(CT89-CT88),X'88',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 88 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT89     DC    AL2(CT8A-CT89),X'89',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 89 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT8A     DC    AL2(CT8B-CT8A),X'8A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 8A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT8B     DC    AL2(CT8C-CT8B),X'8B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 8B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT8C     DC    AL2(CT8D-CT8C),X'8C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 8C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT8D     DC    AL2(CT8E-CT8D),X'8D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 8D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT8E     DC    AL2(CT8F-CT8E),X'8E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 8E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT8F     DC    AL2(CT90-CT8F),X'8F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 8F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT90     DC    AL2(CT91-CT90),X'90',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(CTFILEQ,0,0),CL30'Weekly HUT                   '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 90 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT91     DC    AL2(CT92-CT91),X'91',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 91 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT92     DC    AL2(CT93-CT92),X'92',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,43,0),CL30'Authorisation                '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 92 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT93     DC    AL2(CT94-CT93),X'93',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 93 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT94     DC    AL2(CT95-CT94),X'94',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 94 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT95     DC    AL2(CT96-CT95),X'95',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 95 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT96     DC    AL2(CT97-CT96),X'96',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 96 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT97     DC    AL2(CT98-CT97),X'97',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 97 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT98     DC    AL2(CT99-CT98),X'98',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 98 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT99     DC    AL2(CT9A-CT99),X'99',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 99 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT9A     DC    AL2(CT9B-CT9A),X'9A',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 9A Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT9B     DC    AL2(CT9C-CT9B),X'9B',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 9B Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT9C     DC    AL2(CT9D-CT9C),X'9C',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 9C Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT9D     DC    AL2(CT9E-CT9D),X'9D',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 9D Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT9E     DC    AL2(CT9F-CT9E),X'9E',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 9E Element           '            
         DC    AL2(000)                                                         
*                                                                               
CT9F     DC    AL2(CTA0-CT9F),X'9F',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown 9F Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA0     DC    AL2(CTA1-CTA0),X'A0',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,54,0),CL30'Value Name                   '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A0 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA1     DC    AL2(CTA2-CTA1),X'A1',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,54,0),CL30'Byte Value                   '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A1 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA2     DC    AL2(CTA3-CTA2),X'A2',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A2 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA3     DC    AL2(CTA4-CTA3),X'A3',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A3 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA4     DC    AL2(CTA5-CTA4),X'A4',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTA4ELM,CTA4ELM,0)                                   
         DC    AL1(0,55,0),CL30'List                         '                  
         DC    AL2(CT#LIST)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A4 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA5     DC    AL2(CTA6-CTA5),X'A5',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTA5ELM,CTA5ELM,0)                                   
         DC    AL1(0,55,0),CL30'List Include                 '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A5 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA6     DC    AL2(CTA7-CTA6),X'A6',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A6 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA7     DC    AL2(CTA8-CTA7),X'A7',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A7 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA8     DC    AL2(CTA9-CTA8),X'A8',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A8 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTA9     DC    AL2(CTAA-CTA9),X'A9',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown A9 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTAA     DC    AL2(CTAB-CTAA),X'AA',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown AA Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTAB     DC    AL2(CTAC-CTAB),X'AB',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown AB Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTAC     DC    AL2(CTAD-CTAC),X'AC',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown AC Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTAD     DC    AL2(CTAE-CTAD),X'AD',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown AD Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTAE     DC    AL2(CTAF-CTAE),X'AE',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown AE Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTAF     DC    AL2(CTB0-CTAF),X'AF',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown AF Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB0     DC    AL2(CTB1-CTB0),X'B0',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B0 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB1     DC    AL2(CTB2-CTB1),X'B1',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,45,0),CL30'Field Map                    '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B1 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB2     DC    AL2(CTB3-CTB2),X'B2',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,58,0),CL30'Interface                    '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B2 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB3     DC    AL2(CTB4-CTB3),X'B3',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,0),CL30'Rate                         '                   
         DC    AL2(000)                                                         
*                                                                               
CTB4     DC    AL2(CTB5-CTB4),X'B4',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,67,0),CL30'Agency Group Details         '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B4 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB5     DC    AL2(CTB6-CTB5),X'B5',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(CTFILEQ,0,0),CL30'Date Scheme Description      '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B5 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB6     DC    AL2(CTB7-CTB6),X'B6',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTB6ELM,CTB6ELM,0)                                   
         DC    AL1(CTFILEQ,70,0),CL30'Associated Agency            '            
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B6 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB7     DC    AL2(CTB8-CTB7),X'B7',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTB7ELM,CTB7ELM,0)                                   
         DC    AL1(0,70,0),CL30'Locket Entry                 '                  
         DC    AL2(000)                                                         
         DC    AL1(CTFILEQ,0,0),CL30'Program (Security)           '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B7 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB8     DC    AL2(CTB9-CTB8),X'B8',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTB8ELM,CTB8ELM,0)                                   
         DC    AL1(0,28,0),CL30'Action                       '                  
         DC    AL2(CT#ACT)                                                      
         DC    AL1(CTFILEQ,0,0),CL30'Security Agency Alpha Id     '             
         DC    AL2(CT#AGYAL)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B8 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTB9     DC    AL2(CTBA-CTB9),X'B9',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,29,0),CL30'Record                       '                  
         DC    AL2(CT#REC)                                                      
         DC    AL1(CTFILEQ,0,0),CL30'Agency Access Detail         '             
         DC    AL2(CT#DTL)                                                      
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown B9 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTBA     DC    AL2(CTBB-CTBA),X'BA',XL5'0000000000'                             
         DC    AL4(CTBAPAIR,CTBAELM,CTBAELM,0)                                  
         DC    AL1(0,15,0),CL30'Program Version Control      '                  
         DC    AL2(CT#VCTRL)                                                    
         DC    AL1(0,16,0),CL30'Program Version Control      '                  
         DC    AL2(CT#VCTRL)                                                    
         DC    AL1(0,32,0),CL30'Record/Action combination    '                  
         DC    AL2(CT#VALAC)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown BA Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTBB     DC    AL2(CTBC-CTBB),X'BB',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTBBELM,CTBBELM,0)                                   
         DC    AL1(0,23,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,24,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,25,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,26,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,27,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,28,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,29,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,30,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,31,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,32,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,33,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,34,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,35,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,36,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(0,37,0),CL30'Field                        '                  
         DC    AL2(CT#FIELD)                                                    
         DC    AL1(CTFILEQ,0,0),CL30'Adv Timeout                  '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown BB Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTBC     DC    AL2(CTBD-CTBC),X'BC',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,23,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,24,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,25,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,26,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,27,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,28,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,29,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,30,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,31,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,32,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,33,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,34,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,35,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,36,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,37,0),CL30'Option                       '                  
         DC    AL2(CT#OPT)                                                      
         DC    AL1(0,67,0),CL30'UK Media Agency              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown BC Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTBD     DC    AL2(CTBE-CTBD),X'BD',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTBDELM,CTBDELM,0)                                   
         DC    AL1(0,33,0),CL30'Field Control                '                  
         DC    AL2(CT#FCON)                                                     
         DC    AL1(0,113,0),CL30'Principal User Id   '                          
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown BD Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTBE     DC    AL2(CTBF-CTBE),X'BE',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTBEELM,CTBEELM,0)                                   
         DC    AL1(0,33,0),CL30'Field Control                '                  
         DC    AL2(CT#FCON)                                                     
         DC    AL1(0,113,0),CL30'Security Principal User Id   '                 
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown BE Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTBF     DC    AL2(CTC0-CTBF),X'BF',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTBFELM,CTBFELM,0)                                   
         DC    AL1(0,34,0),CL30'Options Control              '                  
         DC    AL2(CT#OCON)                                                     
         DC    AL1(CTFILEQ,34,0),CL30'Lotus Notes Admin User Id    '            
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown BF Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC0     DC    AL2(CTC1-CTC0),X'C0',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC0ELM,CTC0ELM,0)                                   
         DC    AL1(0,8,0),CL30'Printer Name LUID            '                   
         DC    AL2(000)                                                         
         DC    AL1(0,23,0),CL30'Office                       '                  
         DC    AL2(CT#OFF)                                                      
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C0 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC1     DC    AL2(CTC2-CTC1),X'C1',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC1ELM,CTC1ELM,0)                                   
         DC    AL1(0,8,0),CL30'Printer Name Terminal X-ref  '                   
         DC    AL2(000)                                                         
         DC    AL1(0,24,0),CL30'Department                   '                  
         DC    AL2(CT#DPT)                                                      
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C1 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC2     DC    AL2(CTC3-CTC2),X'C2',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC2ELM,CTC2ELM,0)                                   
         DC    AL1(0,8,0),CL30'Printer Name Description     '                   
         DC    AL2(000)                                                         
         DC    AL1(0,23,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,24,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,25,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,26,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,27,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,28,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,29,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,30,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,31,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,32,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,33,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,34,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,35,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,36,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,37,CTEIDDSQ),CL30'Person Count                 '           
         DC    AL2(CT#STAFN)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C2 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC3     DC    AL2(CTC4-CTC3),X'C3',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC3ELM,CTC3ELM,0)                                   
         DC    AL1(0,8,0),CL30'Printer Name Default User Id '                   
         DC    AL2(000)                                                         
         DC    AL1(0,59,0),CL30'Personal Id                  '                  
         DC    AL2(CT#PID)                                                      
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C3 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC4     DC    AL2(CTC5-CTC4),X'C4',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC4ELM,CTC4ELM,0)                                   
         DC    AL1(0,25,0),CL30'Personal Password            '                  
         DC    AL2(CT#PSWD)                                                     
         DC    AL1(CTFILEQ,0,0),CL30'AFP User Id Pointer          '             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C4 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC5     DC    AL2(CTC6-CTC5),X'C5',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC5ELM,CTC5ELM,0)                                   
         DC    AL1(0,25,0),CL30'Person Name                  '                  
         DC    AL2(CT#PERN)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C5 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC6     DC    AL2(CTC7-CTC6),X'C6',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC6PDIS,CTC6PDIS,0)                                 
         DC    AL1(0,25,0),CL30'Personnel Details            '                  
         DC    AL2(CT#PERDT)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C6 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC7     DC    AL2(CTC8-CTC7),X'C7',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC7ELM,CTC7ELM,0)                                   
         DC    AL1(0,25,0),CL30'Person Address               '                  
         DC    AL2(CT#ADR)                                                      
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C7 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC8     DC    AL2(CTC9-CTC8),X'C8',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC8ELM,CTC8ELM,0)                                   
         DC    AL1(0,25,0),CL30'Person Access Group Code     '                  
         DC    AL2(CT#SECGR)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C8 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTC9     DC    AL2(CTCA-CTC9),X'C9',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTC9ELM,CTC9ELM,0)                                   
         DC    AL1(0,26,0),CL30'Person Access Group Name     '                  
         DC    AL2(CT#SECGN)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown C9 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTCA     DC    AL2(CTCB-CTCA),X'CA',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTCAELM,CTCAELM,0)                                   
         DC    AL1(0,59,0),CL30'Password Effective Date      '                  
         DC    AL2(CT#EFFD)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown CA Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTCB     DC    AL2(CTCC-CTCB),X'CB',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,23,0),CL30'Limit Access Group Name      '                  
         DC    AL2(CT#LAGNM)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown CB Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTCC     DC    AL2(CTCD-CTCC),X'CC',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,23,0),CL30'Limit Access System          '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown CC Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTCD     DC    AL2(CTCE-CTCD),X'CD',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,25,0),CL30'Person Limit Access Grp Code '                  
         DC    AL2(CT#LAGCD)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown CD Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTCE     DC    AL2(CTCF-CTCE),X'CE',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTCEELM,CTCEELM,0)                                   
         DC    AL1(0,26,0),CL30'Comment line                 '                  
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,37,0),CL30'Comment line                 '                  
         DC    AL2(CT#CMT)                                                      
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown CE Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTCF     DC    AL2(CTD0-CTCF),X'CF',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTCFELM,CTCFELM,0)                                   
         DC    AL1(0,23,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,24,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,25,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,26,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,27,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,28,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,29,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,30,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,31,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,32,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,33,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,34,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,35,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,36,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,37,0),CL30'Manager Id                   '                  
         DC    AL2(CT#MANID)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown CF Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD0     DC    AL2(CTD1-CTD0),X'D0',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTD0ELM,CTD0ELM,0)                                   
         DC    AL1(0,14,0),CL30'List of Unit/Ledgers         '                  
         DC    AL2(000)                                                         
         DC    AL1(0,23,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,24,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,25,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,26,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,27,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,28,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,29,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,30,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,31,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,32,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,33,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,34,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,35,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,36,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,37,0),CL30'Old Person Personal Id       '                  
         DC    AL2(CT#OPID)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D0 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD1     DC    AL2(CTD2-CTD1),X'D1',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,23,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,24,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,25,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,26,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,27,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,28,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,29,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,30,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,31,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,32,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,33,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,34,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,35,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,36,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,37,0),CL30'1R Person Account Code       '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D1 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD2     DC    AL2(CTD3-CTD2),X'D2',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,23,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,24,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,25,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,26,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,27,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,28,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,29,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,30,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,31,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,32,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,33,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,34,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,35,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,36,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,37,0),CL30'Password Activity            '                  
         DC    AL2(CT#ACTY)                                                     
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D2 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD3     DC    AL2(CTD4-CTD3),X'D3',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,23,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,24,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,25,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,26,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,27,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,28,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,29,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,30,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,31,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,32,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,33,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,34,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,35,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,36,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,37,0),CL30'Dictionary Substitution Ref #'                  
         DC    AL2(GE#DDREF)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D3 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD4     DC    AL2(CTD5-CTD4),X'D4',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D4 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD5     DC    AL2(CTD6-CTD5),X'D5',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D5 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD6     DC    AL2(CTD7-CTD6),X'D6',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D6 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD7     DC    AL2(CTD8-CTD7),X'D7',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D7 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD8     DC    AL2(CTD9-CTD8),X'D8',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D8 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTD9     DC    AL2(CTDA-CTD9),X'D9',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown D9 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTDA     DC    AL2(CTDB-CTDA),X'DA',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown DA Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTDB     DC    AL2(CTDC-CTDB),X'DB',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown DB Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTDC     DC    AL2(CTDD-CTDC),X'DC',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown DC Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTDD     DC    AL2(CTDE-CTDD),X'DD',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,25,0),CL30'DDS Person Attributes        '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown DD Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTDE     DC    AL2(CTDF-CTDE),X'DE',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,25,0),CL30'DDS Agency List              '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown DE Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTDF     DC    AL2(CTE0-CTDF),X'DF',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTDFELM,CTDFELM,0)                                   
         DC    AL1(0,23,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,24,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,25,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,26,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,27,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,28,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,29,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,30,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,31,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,32,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,33,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,34,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,35,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,36,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,37,0),CL30'Timesheet Approver Group     '                  
         DC    AL2(CT#TSAGN)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown DF Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE0     DC    AL2(CTE1-CTE0),X'E0',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTE0ELM,CTE0ELM,0)                                   
         DC    AL1(0,23,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,24,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,25,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,26,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,27,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,28,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,29,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,30,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,31,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,32,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,33,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,34,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,35,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,36,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,37,0),CL30'Timesheet Approver Group Code'                  
         DC    AL2(CT#TSAGC)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E0 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE1     DC    AL2(CTE2-CTE1),X'E1',XL5'0000000000'                             
         DC    AL4(CTE1PAIR,0,0,0)                                              
         DC    AL1(0,59,CTEIBASQ),CL30'Client Code Limit Access     '           
         DC    AL2(000)                                                         
         DC    AL1(0,69,0),CL30'Script Object Code           '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E1 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE2     DC    AL2(CTE3-CTE2),X'E2',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,62,0),CL30'Application Access           '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E2 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE3     DC    AL2(CTE4-CTE3),X'E3',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(CTFILEQ,0,0),CL30'DDS Department Level Security'             
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E3 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE4     DC    AL2(CTE5-CTE4),X'E4',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTE4ELM,CTE4ELM,0)                                   
         DC    AL1(0,23,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,24,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,25,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,26,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,27,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,28,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,29,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,30,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,31,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,32,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,33,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,34,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,35,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,36,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,37,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,59,CTEIDDSQ),CL30'Password History             '           
         DC    AL2(000)                                                         
         DC    AL1(0,69,0),CL30'Script Book Name             '                  
         DC    AL2(000)                                                         
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E4 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE5     DC    AL2(CTE6-CTE5),X'E5',XL5'0000000000'                             
         DC    AL4(DEFPAIR,CTE5ELM,CTE5ELM,0)                                   
         DC    AL1(0,23,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,24,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,25,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,26,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,27,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,28,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,29,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,30,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,31,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,32,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,33,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,34,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,35,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,36,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,37,0),CL30'Person E-mail Id             '                  
         DC    AL2(CT#EMAIL)                                                    
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E5 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE6     DC    AL2(CTE7-CTE6),X'E6',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E6 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE7     DC    AL2(CTE8-CTE7),X'E7',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E7 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE8     DC    AL2(CTE9-CTE8),X'E8',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E8 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTE9     DC    AL2(CTEA-CTE9),X'E9',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown E9 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTEA     DC    AL2(CTEB-CTEA),X'EA',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown EA Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTEB     DC    AL2(CTEC-CTEB),X'EB',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown EB Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTEC     DC    AL2(CTED-CTEC),X'EC',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown EC Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTED     DC    AL2(CTEE-CTED),X'ED',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown ED Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTEE     DC    AL2(CTEF-CTEE),X'EE',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown EE Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTEF     DC    AL2(CTF0-CTEF),X'EF',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown EF Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF0     DC    AL2(CTF1-CTF0),X'F0',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F0 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF1     DC    AL2(CTF2-CTF1),X'F1',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,0),CL30'Activity                     '                   
         DC    AL2(CT#ACTY)                                                     
*                                                                               
CTF2     DC    AL2(CTF3-CTF2),X'F2',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F2 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF3     DC    AL2(CTF4-CTF3),X'F3',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F3 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF4     DC    AL2(CTF5-CTF4),X'F4',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F4 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF5     DC    AL2(CTF6-CTF5),X'F5',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F5 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF6     DC    AL2(CTF7-CTF6),X'F6',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F6 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF7     DC    AL2(CTF8-CTF7),X'F7',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F7 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF8     DC    AL2(CTF9-CTF8),X'F8',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F8 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTF9     DC    AL2(CTFA-CTF9),X'F9',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown F9 Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTFA     DC    AL2(CTFB-CTFA),X'FA',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown FA Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTFB     DC    AL2(CTFC-CTFB),X'FB',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown FB Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTFC     DC    AL2(CTFD-CTFC),X'FC',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown FC Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTFD     DC    AL2(CTFE-CTFD),X'FD',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown FD Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTFE     DC    AL2(CTFF-CTFE),X'FE',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown FE Element           '            
         DC    AL2(000)                                                         
*                                                                               
CTFF     DC    AL2(CTXX-CTFF),X'FF',XL5'0000000000'                             
         DC    AL4(DEFPAIR,0,0,0)                                               
         DC    AL1(0,0,CTEIDDSQ),CL30'Unknown FF Element            '           
         DC    AL2(000)                                                         
*                                                                               
CTXX     DC    X'FFFF'                                                          
         EJECT                                                                  
**********************************************************************          
* DSECT COVERING ADDTAB TABLE                                        *          
**********************************************************************          
ADDTABD  DSECT                                                                  
ADFILENM DS    XL32                RECORD NAME                                  
ASUBDD   DS    AL2                 SUBSTITUTE DD REFERENCE (US)                 
*                                                                               
ADRECNUM DS    XL1                 RECORD ID NUMBER (INTERNAL)                  
ADFTYPE  DS    XL1                 FILE TYPE (FROM RCVRHDR)                     
ADPASSD  DS    AL1                 IF PASSIVE - DISPLACEMENT IN KEY             
ADPASSL  DS    AL1                              LENGTH TO CHECK                 
ADPASSF  DS    AL1                 PASSIVE FILL TYPE (DEFAULT 0)                
ADSTDREP DS    AL1                                                              
ADSTSTD  EQU   X'01'               REQUIRED FOR STANDARD REPORT                 
ADSTSEC  EQU   X'02'               REQUIRED FOR SECURITY REPORT                 
ADSTPRF  EQU   X'04'               REQUIRED FOR PROFILE REPORT                  
ADSTSECX EQU   X'80'               EXCLUDE FROM SECURITY REPORT FOR NOW         
*                                                                               
ADMTCHL  DS    XL1                 LENGTH OF IDENTIFIER FOR THIS KEY            
ADMTCHC  DS    XL3                 IDENTIFIER FOR THIS KEY (FF FILLED)          
*                                                                               
ADBUCS   DS    0XL16               TOTALS FOR INPUT                             
ADBADD   DS    AL4                 ADD                                          
ADBCHG   DS    AL4                 CHANGE                                       
ADBDEL   DS    AL4                 DELETE                                       
ADBRES   DS    AL4                 RESTORE                                      
*                                                                               
ADODFLT  DS    AL4                 DEFAULT OUTPUT ROUTINE                       
ADODETL  DS    AL4                 DETAILED OUTPUT ROUTINE                      
ADSKIP   DS    AL4                 SKIP ROUTINE (TEST IGNORE RECORD)            
ADDTABLQ EQU   *-ADDTABD                                                        
         EJECT                                                                  
**********************************************************************          
* DSECT COVERING CTELEM TABLE                                        *          
**********************************************************************          
CTELEMD  DSECT                                                                  
CTEDSP   DS    AL2                 DISPLACEMENT TO NEXT ELEMENT                 
CTNUM    DS    X                   ELEMENT NUMBER                               
CTSPR    DS    XL5                 N/D                                          
CTRPOUT  DS    AL4                 PAIRED ELEMENT INFORMATION O/P               
CTRDOUT  DS    AL4                 SINGLE ELEMENT INFO O/P                      
CTRFOUT  DS    AL4                 SINGLE ELEMENT DETAILED INFO O/P             
         DS    AL4                 N/D                                          
CTFELEML EQU   *-CTELEMD           FIXED PORTION LENGTH                         
*                                                                               
CTESYS   DS    X                   SYSTEM                                       
CTEFREC  DS    X                   RECORD NUMBER                                
CTEIND   DS    X                   INDICATOR                                    
CTEIDDSQ EQU   X'80'               - IGNORE ELEMENT IF NOT DDS REPORT           
CTEIBASQ EQU   X'40'               - INCLUDE BEF/AFT, EVEN IF SAME              
CTENAME  DS    CL30                ELEMENT NAME                                 
CTDDREF  DS    AL2                                                              
CTFVARL  EQU   *-CTESYS                                                         
*                                                                               
SECDFA   CSECT                                                                  
         EJECT                                                                  
**********************************************************************          
* NON-ADDRESSIBLE STORAGE AREAS                                      *          
**********************************************************************          
       ++INCLUDE FACIDTAB                                                       
*                                                                               
       ++INCLUDE SRDQUPROF                                                      
*                                                                               
         DS    0D                                                               
         DC    CL8'**IO1**'                                                     
IO1      DS    (IOL)X                                                           
*                                                                               
         DC    CL8'**IO2**'                                                     
IO2      DS    (IOL)X                                                           
*                                                                               
         DC    CL8'**IO3**'                                                     
IO3      DS    (IOL*2)X            NEEDS ROOM FOR OLD/NEW ELMNT MATCH           
*                                                                               
         DC    CL8'*SRTBLK*'                                                    
SRTBLK   DS    CL(SRTBLKLQ)                                                     
         DS    (IOL*2)X            CAN CONTAIN TWO RCVRY RECS                   
*                                                                               
         DC    CL8'*PRFBLK*'                                                    
PRFBLKN  EQU   1000                                                             
PRFBLK   DS    CL(PRFBLKN*L'LSTPRFS)  PROFILE BLOCK                             
         EJECT                                                                  
**********************************************************************          
* W/S                                                                *          
**********************************************************************          
REGSAVE  CSECT                                                                  
         DS    400000C                                                          
         EJECT                                                                  
**********************************************************************          
* DSECTS                                                             *          
**********************************************************************          
WORKD    DSECT                                                                  
SAVERD   DS    A                                                                
SAVERE   DS    A                                                                
APGMLST  DS    A                                                                
AADDNTRY DS    A                                                                
AELMNTRY DS    A                                                                
AELADDS  DS    A                                                                
ASCANTAB DS    A                                                                
AATAB    DS    A                                                                
*                                                                               
DUB      DS    D                                                                
FULL     DS    F                                                                
DMCB     DS    XL24                                                             
DMWORK   DS    XL72                                                             
PLIST    DS    XL24                GENERAL PARAMETER LIST                       
KEY      DS    CL64                                                             
KEYSAVE  DS    CL64                                                             
*                                                                               
HALF     DS    H                                                                
BYTE     DS    X                                                                
BYTE1    DS    X                                                                
*                                                                               
THISSYS  DS    X                   CURRENT SYSTEM                               
THISTYPE DS    X                   CURRENT TYPE                                 
*                                                                               
THISELM  DS    X                                                                
THISELMH DS    X                                                                
*                                                                               
TRAILER  DS    X                                                                
HADDUMMY DS    X                                                                
RPTYPE   DS    C                                                                
RUNTYPE  DS    C                                                                
GOTERR   DS    C                                                                
*                                                                               
PARMCNT  DS    X                   NO OF I/P PARAMETERS                         
PARMCNTQ EQU   20                  MAX NUMBER OF I/P PARAMETERS                 
*                                                                               
FERN     DS    X                   CONTAINS CURRENT ERROR NO. OR 0              
*                                                                               
OFFLINE  DS    X                   Y/N                                          
*                                                                               
CTFLAG   DS    X                   FLAG FOR ELEMENT ROUTINES                    
*                                                                               
AGYCTRY  DS    X                                                                
AGYLANG  DS    X                                                                
AGYPPS   DS    X                   CTAADFLG (PPS FLAGS)                         
*                                                                               
NULLDATE DS    CL6                                                              
*                                                                               
PROGRAM  DS    CL7                 PROGRAM NAME IF VALID                        
*                                                                               
BITTAB   DS    XL32                                                             
*                                                                               
PGEAGY   DS    CL2                 PREVENTS REBUILDING TITLE                    
PGEUSR   DS    XL2                 CONTROLS NEWPAGE ON CHANGE OF USERID         
*                                                                               
TOTSRT   DS    X                   TYPE FOR TOTALS                              
TOTGRP   DS    XL2                 GROUP FOR TOTALS                             
*                                                                               
LSTCTFRD DS    0XL13               COVERS LAST USERID READ (CTFILE)             
LSTNUM   DS    XL2                 USERID NO.                                   
LSTNAM   DS    XL10                ASSOCIATED NAME                              
LSTLANG  DS    XL1                 LANGUAGE                                     
*                                                                               
LSTCTFRT DS    0XL11               COVERS LAST TERMINAL NO. READ (CTF)          
LSTTNUM  DS    XL2                 TERMINAL NO.                                 
LSTTISTK DS    C                   Y IF LSTTNAM IS A TICKET                     
LSTTNAM  DS    XL8                 LUID                                         
*                                                                               
LSTAGY   DS    CL2                 AGY 2 CHARACTER                              
LSTAGYN  DS    CL10                PRINCIPAL ID NAME                            
*                                                                               
LSTPROG  DS    0XL8                COVERS LAST PROGRAM READ (FATABOFF)          
LSTPNUM  DS    X                   PROGRAM NUMBER                               
LSTPNAM  DS    XL7                 PROGRAM NAME                                 
*                                                                               
LSTSRT   DS    X                                                                
LSTGRP   DS    CL2                                                              
LSTUSR   DS    CL2                                                              
*                                                                               
LSTPWIND DS    X                   PREVIOUS SRTPWIND                            
*                                                                               
LSTPRFS  DS    0CL20               LATEST PROFILE SET                           
LSTPRFGP DS    CL2                 SECURITY ALPHA ID                            
LSTPRFPP DS    C                   Y IF PPS AGENCY                              
LSTPRFCY DS    X                   COUNTRY CODE                                 
LSTPRF   DS    0CL16    SEC/PROF   CSA/CPA PROFILE                              
LSTPRF01 DS    CL1      BOTH       REPORT LVL:A=AGYALPH,U=USERID,B=BOTH         
LSTPRF02 DS    CL1      BOTH       REPORT SEQNCE:R=RECORD,T=TIME                
LSTPRF03 DS    CL1      BOTH       EMPTY REPORT IF NO DATA:Y/N                  
LSTPRF04 DS    CL1      SEC        SELF PSWD CHANGES:I=INC,X=EXC,S=SEP          
LSTPRF05 DS    CL1      BOTH       SHOW FULL NAME OF CHANGER:Y/N                
LSTPRF06 DS    CL1                 UNDEFINED                                    
LSTPRF07 DS    CL1                 UNDEFINED                                    
LSTPRF08 DS    CL1                 UNDEFINED                                    
LSTPRF09 DS    CL1                 UNDEFINED                                    
LSTPRF10 DS    CL1                 UNDEFINED                                    
LSTPRF11 DS    CL1                 UNDEFINED                                    
LSTPRF12 DS    CL1                 UNDEFINED                                    
LSTPRF13 DS    CL1                 UNDEFINED                                    
LSTPRF14 DS    CL1                 UNDEFINED                                    
LSTPRF15 DS    CL1                 UNDEFINED                                    
LSTPRF16 DS    CL1                 UNDEFINED                                    
*                                                                               
OUTTYPE  DS    X                   OUTPUT TYPES TO BE DISPLAYED                 
ADDOUT   EQU   X'80'               SHOW ADDS                                    
CHNGOUT  EQU   X'20'               CHANGE RECORDS SHOWN                         
DELOUT   EQU   X'10'               DELETE RECORDS SHOWN                         
RESTOUT  EQU   X'08'               RESTORE RECORDS SHOWN                        
HARDONLY EQU   X'04'               HARDCOPY ONLY                                
PPSAGNLY EQU   X'02'               HARDCOPY + PPS AGENCIES ONLY TO PQ           
*              X'02+04' BOTH OFF   HARDCOPY + ALL AGENCIES TO PQ                
*              X'02+04' BOTH ON    INVALID                                      
DETLOUT  EQU   X'01'               DETAIL INFORMATION ON RECORDS                
*                                                                               
DEFOUT   EQU   ADDOUT+CHNGOUT+DELOUT+RESTOUT                                    
*                                                                               
V_FILTS  DS    0H                                                               
V_TCODE  DS    H                   TERMINAL CODE VALUE IF SET                   
V_USRID  DS    H                   USER ID VALUE IF SET                         
V_RTYPE  DS    XL16                RECORD TYPES IF SET                          
V_AGYID  DS    X                   AGENCY ID IF SET                             
V_PRNUM  DS    X                   PROGRAM NO. IF SET                           
V_LUID   DS    CL8                 LUID - FOR TRAILING LUIDS                    
V_AGENCY DS    CL2                 AGENCY ALPHA (SECURITY)                      
V_START  DS    CL3                 START DATE (AS RDATE)                        
V_END    DS    CL3                 END DATE                                     
V_FILTLQ EQU   *-V_FILTS                                                        
*                                                                               
MYDATTIM DS    XL7                 CURRENT RECORD DATE/TIME                     
LODATTIM DS    XL7                 LOWEST/HIGHEST DATE/TIME FOUND               
HIDATTIM DS    XL7                 FORMAT AS SRTDATE/SRTTIME                    
*                                                                               
MODE     DS    X                   ADD/DELETE/RESTORE/CHANGE TYPE               
MODEDUM  EQU   0                   DUMMY SORT RECORD                            
MODEADD  EQU   1                   RECORD ADDED                                 
MODECHG  EQU   2                   RECORD CHANGED                               
MODEDEL  EQU   3                   RECORD DELETED                               
MODERES  EQU   4                   RECORD RESTORED                              
MODECPY  EQU   5                   SPECIAL                                      
MODEERR  EQU   255                 ERROR                                        
*                                                                               
CARDIO   DS    CL80                                                             
IND_FLAG DS    XL1                 INDICATOR FLAG                               
*                                                                               
ACOPY    DS    A                  A(CURRENT COPY ENTRY IN ELADDS)               
ACHNG    DS    A                  A(CURRENT CHANGE ENTRY IN ELADDS)             
STACOPY  DS    A                  A(STATUS BYTE(S) IN COPY RECORD)              
STACHNG  DS    A                  A(STATUS BYTE(S) IN CHANGE RECORD)            
WHRCOPY  DS    A                  A(CURRENT POS IN COPY RECORD)                 
WHRCHNG  DS    A                  A(CURRENT POS IN CHANGE RECORD)               
NOW1     DS    A                  WHERE IN RECORD CURRENT FOR PRINT             
WAS1     DS    A                  WHERE IN RECORD COPY FOR PRINT                
ELADD    DS    A                                                                
ASE      DS    A                  A(SELIST ENTRY)                               
ACTSE    DS    A                  A(CONTROL SELIST ENTRY)                       
ACTPGMS  DS    A                  A(CONTROL PROGRAM TABLE)                      
*                                                                               
LSTCT    DS    F                   LAST RECORD COUNTER UPDATED                  
LSTCTT   DS    F                   LAST TOTAL RECORD COUNTER UPDATED            
*                                                                               
ASYSEL   DS    F                  A(SYSEL) FROM ID RECORD                       
*                                                                               
COPYNUM1 DS    X                  CURRENT NO. OF UNRESOLVED COPY ELMNTS         
CHNGNUM1 DS    X                  CURRENT NO. OF UNRESOLVED CHNG ELMNTS         
ADDNUM1  DS    X                  TOTAL OF UNRESOLVED ADDS IN EL.               
ADDNUM2  DS    X                  TOTAL ADDS RESOLVED THIS TIME                 
DELNUM1  DS    X                  TOTAL OF UNRESOLVED DELS IN EL.               
DELNUM2  DS    X                  TOTAL DELS RESOLVED THIS TIME                 
STALNGTH DS    X                  LENGTH OF STATUS AREA                         
FLAG     DS    X                                                                
SVOVPG   DS    XL2                                                              
*                                                                               
PROFKEY  DS    XL16                                                             
PQPFLAG  DS    CL1                                                              
PQPREMOT DS    CL160                                                            
*                                                                               
ELIND    DS    CL1                SAVED ELEMENT INDICATOR                       
ELNAMEC  DS    CL30               SAVED ELEMENT NAME                            
SPROUT   DS    CL80               SPARE OUTPUT BLOCK                            
DSLISTL  DS    0X                                                               
L4@YES   DS    CL4                                                              
L4@NO    DS    CL4                                                              
L4@ALL   DS    CL4                                                              
L8@USRID DS    CL8                                                              
LC@UNKNW DS    CL(L'PLINFO)                                                     
LC@OFFLN DS    CL(L'PLINFO)                                                     
LC@AGYAL DS    CL(L'PLINFO)                                                     
LC@SYS   DS    CL(L'PLINFO)                                                     
LC@NOSET DS    CL(L'PLINFO)                                                     
LC@NAME  DS    CL(L'PLINFO)                                                     
LC@NUM   DS    CL(L'PLINFO)                                                     
LC@DATE  DS    CL(L'PLINFO)                                                     
LC@TIME  DS    CL(L'PLINFO)                                                     
LC@RECTY DS    CL(L'PLINFO)                                                     
LC@ACT   DS    CL(L'PLINFO)                                                     
LC@OTPTY DS    CL(L'PLINFO)                                                     
L8@READ  DS    CL8                                                              
*                                                                               
         DS    0D                                                               
WORK     DS    CL512                                                            
*                                                                               
SRTSAVE  DS    XL(SRTBLKLQ)                                                     
SVPGMEL  DS    XL255                                                            
SVDICEL  DS    XL(SADICLNQ)                                                     
ATAB     DS    255XL(ATABL)                                                     
SCANTAB  DS    (PARMCNTQ)CL(SCBLKLQ)                                            
SVBXCOLS DS    CL(L'BOXCOLS)                                                    
*                                                                               
ELADDS   DS    2XL(256*4)          ADDRS COPY & CHANGE ELS OF SAME TYPE         
ELADDSL  EQU   *-ELADDS                                                         
SVSYSELS DS    XL512               CTSYSELS FROM 'REPORTING' USERID             
WORKL    EQU   *-WORKD                                                          
                                                                                
***********************************************************************         
* ACTION TABLE DSECT (FOR BA ELEMENT RESOLUTION)                      *         
***********************************************************************         
ATABD    DSECT                                                                  
ATSEQ    DS    XL1                 ACTION SEQUENCE NUMBER                       
ATWRD    DS    XL2                 DICTIONARY REFERENCE NUMBER                  
ATDSC    DS    XL2                 TEXT DESCRIPTION REFERENCE NUMBER            
ATABL    EQU   *-ATABD                                                          
                                                                                
***********************************************************************         
* DMRCVRHDR                                                           *         
***********************************************************************         
RECDS    DSECT                                                                  
RECLN    DS    XL4                                                              
       ++INCLUDE DMRCVRHDR                                                      
RCVFRST  DS    0X                                                               
                                                                                
***********************************************************************         
* SORT BLOCK DSECT                                                    *         
***********************************************************************         
SRTBLKD  DSECT                                                                  
SRTLEN   DS    H                 LENGTH OF SORT RECORD WITH HEADER              
         DS    H                                                                
SRTSRT   DS    X                 RECORD TYPE                                    
SRTSDDS  EQU   1                 DDS SORT                                       
SRTSGRP  EQU   2                 GROUP SORT                                     
SRTSUSR  EQU   3                 USERID SORT                                    
SRTGRP   DS    XL2               AGY ALPHA (OF SECURITY AGENCY)                 
SRTUSER  DS    XL2               USER ID                                        
SRTPWIND DS    X                 0=FORCED PW CHANGE ELSE 1=OTHER                
SRTKEY2  DS    XL32              COPY OF SRTKEY IF RECORD SEQUENCE RQD          
SRTDATE  DS    XL3               DATE AS BINARY YMD                             
SRTTIME  DS    XL4               TIME AS HHMMSSC                                
SRTLUID  DS    XL8               TERMINAL LUID                                  
SRTPERS  DS    XL2               PERSON ID (WAS RTRM)                           
SRTKEY   DS    XL32              RECORD KEY (ZERO FILLED, LEFT ALIGNED)         
SRTPRG   DS    X                                                                
SRTSIN   DS    XL4               SYSTEM INPUT NUMBER                            
SRTRECH  DS    0X                                                               
SRTBLKLQ EQU   *-SRTBLKD                                                        
         EJECT                                                                  
***********************************************************************         
* SSB                                                                 *         
***********************************************************************         
SSB      CSECT                                                                  
         DC    X'0000FF',1021X'00'                                              
         EJECT                                                                  
***********************************************************************         
* MASTC                                                               *         
***********************************************************************         
MASTC    CSECT                                                                  
* DDMASTC                                                                       
         PRINT OFF                                                              
       ++INCLUDE DDMASTC                                                        
         PRINT ON                                                               
         EJECT                                                                  
***********************************************************************         
* PRINT LINE DSECT                                                    *         
***********************************************************************         
PLINED   DSECT                                                                  
         ORG   PLINED                                                           
PLLEFT   DS    X                                                                
         DS    C                                                                
PLTEXT   DS    CL15                                                             
         ORG   PLTEXT                                                           
PLELEM   DS    CL16                                                             
         DS    X                                                                
PLC1     DS    C                                                                
         DS    C                                                                
PLINFO   DS    CL16                                                             
         DS    C                                                                
PLC2     DS    C                                                                
         DS    C                                                                
PLDATA   DS    0CL90                                                            
PLKHDR   DS    CL15                                                             
         DS    X                                                                
PLKINF   DS    CL74                                                             
         DS    X                                                                
*                                                                               
         ORG   PLINFO                                                           
PLNHDR   DS    CL16                                                             
         DS    XL3                                                              
PLNINF   DS    CL43                                                             
         DS    X                                                                
PLICOL   DS    X                                                                
         DS    X                                                                
PLOINF   DS    CL43                                                             
         DS    X                                                                
         ORG   PLNINF                                                           
PLBOTH   DS    CL(L'PLNINF+L'PLOINF+4)                                          
         DS    X                                                                
         ORG                                                                    
PLRIGHT  DS    X                                                                
*                                                                               
         ORG   PLINED                                                           
PLINE    DS    0CL132                                                           
POLEFT   DS    C                                                                
         DS    X                                                                
POREC    DS    CL(L'ADFILENM)                                                   
         DS    X                                                                
POC1     DS    C                                                                
         DS    X                                                                
POACT    DS    0XL42                                                            
POADD    DS    CL8                                                              
         DS    X                                                                
POC2     DS    C                                                                
         DS    X                                                                
POCHA    DS    CL8                                                              
         DS    X                                                                
POC3     DS    C                                                                
         DS    X                                                                
PODEL    DS    CL8                                                              
         DS    X                                                                
POC4     DS    C                                                                
         DS    X                                                                
PORES    DS    CL8                                                              
         DS    X                                                                
PORIGHT  DS    X                                                                
         EJECT                                                                  
***********************************************************************         
* OTHER INCLUDED DSECTS                                               *         
***********************************************************************         
* CTGENFILE                                                                     
         PRINT OFF                                                              
       ++INCLUDE CTGENFILE                                                      
         PRINT ON                                                               
* CTDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE CTDDEQUS                                                       
         PRINT ON                                                               
* CTMSGEQUS                                                                     
         PRINT OFF                                                              
       ++INCLUDE CTMSGEQUS                                                      
         PRINT ON                                                               
* GEDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE GEDDEQUS                                                       
         PRINT ON                                                               
* GEGENFILE                                                                     
         PRINT OFF                                                              
       ++INCLUDE GEGENFILE                                                      
         PRINT ON                                                               
* GEGENSPEC                                                                     
         PRINT OFF                                                              
       ++INCLUDE GEGENSPEC                                                      
         PRINT ON                                                               
* GEGENESS                                                                      
         PRINT OFF                                                              
       ++INCLUDE GEGENESS                                                       
         PRINT ON                                                               
* CTGENAPASS                                                                    
         PRINT OFF                                                              
       ++INCLUDE CTGENAPASS                                                     
         PRINT ON                                                               
* CTGENASTAF                                                                    
         PRINT OFF                                                              
       ++INCLUDE CTGENASTAF                                                     
         PRINT ON                                                               
* CTGENAGRD                                                                     
         PRINT OFF                                                              
       ++INCLUDE CTGENAGRD                                                      
         PRINT ON                                                               
* CTGENADVD                                                                     
         PRINT OFF                                                              
       ++INCLUDE CTGENADVD                                                      
         PRINT ON                                                               
* CTGENDTBD                                                                     
         PRINT OFF                                                              
       ++INCLUDE CTGENDTBD                                                      
         PRINT ON                                                               
* CTGENRFP                                                                      
         PRINT OFF                                                              
       ++INCLUDE CTGENRFP                                                       
         PRINT ON                                                               
* SEACSFILE                                                                     
         PRINT OFF                                                              
       ++INCLUDE SEACSFILE                                                      
         PRINT ON                                                               
* DDACTIVD                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDACTIVD                                                       
         PRINT ON                                                               
* FASSBOFF                                                                      
         PRINT OFF                                                              
       ++INCLUDE FASSBOFF                                                       
         PRINT ON                                                               
* FASELIST                                                                      
         PRINT OFF                                                              
       ++INCLUDE FASELIST                                                       
         PRINT ON                                                               
* DDDPRINTL                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDDPRINTL                                                      
         PRINT ON                                                               
* FAPGMLST                                                                      
         PRINT OFF                                                              
       ++INCLUDE FAPGMLST                                                       
         PRINT ON                                                               
* DDSCANBLKD                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDSCANBLKD                                                     
         PRINT ON                                                               
* DMRCVREXT                                                                     
         PRINT OFF                                                              
       ++INCLUDE DMRCVREXT                                                      
         PRINT ON                                                               
* FACIDTABD                                                                     
         PRINT OFF                                                              
       ++INCLUDE FACIDTABD                                                      
         PRINT ON                                                               
* FALANG                                                                        
         PRINT OFF                                                              
       ++INCLUDE FALANG                                                         
         PRINT ON                                                               
* FACTRY                                                                        
         PRINT OFF                                                              
       ++INCLUDE FACTRY                                                         
         PRINT ON                                                               
* DMGREQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE DMGREQUS                                                       
         PRINT ON                                                               
* DDDDEQUS                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDDDEQUS                                                       
         PRINT ON                                                               
* DDREMOTED                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDREMOTED                                                      
         PRINT ON                                                               
* DDBIGBOX                                                                      
         PRINT OFF                                                              
       ++INCLUDE DDBIGBOX                                                       
         PRINT ON                                                               
* FAGETTXTD                                                                     
         PRINT OFF                                                              
       ++INCLUDE FAGETTXTD                                                      
         PRINT ON                                                               
* DDCOMFACS                                                                     
         PRINT OFF                                                              
       ++INCLUDE DDCOMFACS                                                      
         PRINT ON                                                               
* FASYSLSTD                                                                     
         PRINT OFF                                                              
       ++INCLUDE FASYSLSTD                                                      
         PRINT ON                                                               
* DDOFFICED                                                                     
         PRINT OFF                                                              
*&&US                                                                           
       ++INCLUDE DDOFFICED                                                      
*&&                                                                             
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'056CTDFSEC   07/24/19'                                      
         END                                                                    
