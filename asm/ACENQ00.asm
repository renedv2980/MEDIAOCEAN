*          DATA SET ACENQ00    AT LEVEL 050 AS OF 10/13/16                      
*PHASE T62000A                                                                  
*INCLUDE ACJOBCOL                                                               
*INCLUDE ACSRCHC                                                                
*INCLUDE SRCHCALL                                                               
T62000   TITLE 'FINANCIAL INFORMATION SYSTEM (FIS) - BASE'                      
                                                                                
* TKLU 139 021215 <RD006922> ORDER NAME SEARCH SUPPORT                          
                                                                                
T62000   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 WORKX-WORKD,**ENQ0**,R8,R7,R6,CLEAR=YES,RR=RE                    
         LR    R9,RC                                                            
         USING WORKD,R9                                                         
         ST    RE,RELO                                                          
         MVC   AINP,0(R1)                A(TRANSLATOR I/O BLOCK)                
         L     RA,4(R1)                  A(TWA)                                 
         USING TWAD,RA                                                          
         MVC   TERMINAL,TWATRM           LOGON ATTRIBUTES                       
         MVC   TERMAUTH,TWAAUTH                                                 
         MVC   TERMACCS,TWAACCS                                                 
*                                                                               
         L     RE,8(R1)                                                         
         USING ACCFACSD,RE                                                      
         MVC   VACCEMU,AACCEMU                                                  
*                                                                               
         L     RE,16(R1)                                                        
         USING COMFACSD,RE                                                      
         MVC   VDATAMGR,CDATAMGR                                                
         MVC   VCALLOV,CCALLOV                                                  
         MVC   VDATCON,CDATCON                                                  
         MVC   VSCANNER,CSCANNER                                                
         MVC   VGETMSG,CGETMSG                                                  
         MVC   VUNSCAN,CUNSCAN                                                  
         MVC   VCASHVAL,CCASHVAL                                                
         MVC   VHEXIN,CHEXIN                                                    
         MVC   VHEXOUT,CHEXOUT                                                  
         MVC   VGETPROF,CGETPROF                                                
         MVC   VGETTXT,CGETTXT                                                  
         MVC   VGETFACT,CGETFACT                                                
         MVC   CUREDIT,CCUREDIT                                                 
         MVC   VPERVAL,CPERVAL                                                  
         MVC   VDICTATE,CDICTATE                                                
         MVC   VADDAY,CADDAY                                                    
         MVC   VGETHELP,CGETHELP                                                
         MVC   VSECRET,CSECRET                                                  
         MVC   VBLDCUR,CBLDCUR                                                  
         MVC   VDLFLD,CDLFLD                                                    
         MVC   VSWITCH,CSWITCH                                                  
         DROP  RE                                                               
*                                                                               
         L     RF,20(R1)                 RF=A(EXTRA INFO BLOCK)                 
         MVC   AGYCTRY,1(RF)             AGENCY COUNTRY                         
         CLI   AGYCTRY,0                 SET DEFAULT COUNTRY                    
         BNE   *+8                                                              
         MVI   AGYCTRY,CTRYUSA                                                  
         MVC   AGYLANG,3(RF)             AGENCY LANGUAGE                        
         CLI   AGYLANG,0                 SET DEFAULT LANGUAGE                   
         BNE   *+8                                                              
         MVI   AGYLANG,LANGEUS                                                  
         MVC   AGYCURR,4(RF)             AGENCY CURRENCY                        
*                                                                               
         MVC   ATIA,12(R1)               A(TIA)                                 
         MVC   ACOMFACS,16(R1)           A(COMMON FACILITIES)                   
         MVC   MYCO,0(R1)                HEX COMPANY ID                         
*                                        SET A(COMMON ROUTINES IN W/S)          
         LA    R0,COMMONN                R0=(# OF COMMON ROUTINES)              
         L     RE,=A(COMMON)                                                    
         A     RE,RELO                   RE=A(COMMON ROUTINE ADDRS)             
         LA    RF,ACOMMON                RF=A(RELOCATED ADDRESSES)              
INIT10   L     R1,0(RE)                  GET NEXT ADDRESS                       
         A     R1,RELO                   RELOCATE IT                            
         ST    R1,0(RF)                  PUT IN RELOACTED LIST                  
         LA    RE,4(RE)                  BUMP UP ADDRESS LISTS                  
         LA    RF,4(RF)                                                         
         BCT   R0,INIT10                                                        
*                                        SET A(ROOT TABLES IN W/S)              
         LA    R0,TABLESN                R0=(NUMBER OF TABLE ENTRIES)           
         L     RE,=A(TABLES)                                                    
         A     RE,RELO                   RE=A(TABLE ADDRESSES)                  
         LA    RF,ATABLES                RF=A(RELOCATED TABLE ADDRS)            
INIT20   L     R1,0(RE)                  GET NEXT ADDRESS                       
         A     R1,RELO                   RELOCATE IT                            
         ST    R1,0(RF)                  PUT IN RELOACTED LIST                  
         LA    RE,4(RE)                  BUMP UP ADDRESS LISTS                  
         LA    RF,4(RF)                                                         
         BCT   R0,INIT20                                                        
*                                        SET SUNDRY ADDRS ON WS AREAS           
         L     R1,=A(ANAWS)                                                     
         A     R1,RELO                   R1=A(NON ADDRSSABLE W/S TABLE)         
         LA    R0,ANAWSN                 R0=# OF NON-ADDR W/S ENTRIES           
INIT30   ICM   RE,15,0(R1)               RE=AL2(AREA),AL2(ADDRESS)              
         SRDL  RE,16                                                            
         SRL   RF,16                                                            
         LA    RE,WORKD(RE)                                                     
         LA    RF,WORKD(RF)                                                     
         STCM  RE,15,0(RF)               SET AREA ADDRESS                       
         LA    R1,L'ANAWS(R1)            BUMP UP TABLE                          
         BCT   R0,INIT30                                                        
*                                                                               
         L     R1,=A(ANATWA)             SET SUNDRY ADDRS ON TWA AREAS          
         A     R1,RELO                   R1=A(NON ADDRSSABLE TWA TABLE)         
         LA    R0,ANATWAN                R0=# OF NON-ADDR TWA ENTRIES           
INIT40   ICM   RE,15,0(R1)               RE=AL2(AREA),AL2(ADDRESS)              
         SRDL  RE,16                                                            
         SRL   RF,16                                                            
         LA    RE,TWAD(RE)                                                      
         LA    RF,WORKD(RF)                                                     
         STCM  RE,15,0(RF)               SET AREA ADDRESS                       
         LA    R1,L'ANATWA(R1)           BUMP UP TABLE                          
         BCT   R0,INIT40                                                        
*                                                                               
         LA    R0,AROUTS1N               SET ROUTINE ADDRESSES - 1              
         L     RF,AROUT1                                                        
         SR    RE,RE                                                            
         LA    R1,AROUTS1                                                       
INIT46   ST    RF,0(R1)                  SET A(ROUTS)                           
         STCM  RE,1,0(R1)                SET ROUTINE NUMBER                     
         LA    RE,1(RE)                                                         
         LA    R1,4(R1)                                                         
         BCT   R0,INIT46                                                        
*                                                                               
         GOTO1 VCALLOV,DMCB,0,X'E3000A02',0  CHOPPER                            
         MVC   VCHOPPER,0(R1)                                                   
*                                                                               
         XC    DMCB(12),DMCB             SQUASHER                               
         MVC   DMCB+4(4),=X'C1000A0D'                                           
         BASR  RE,RF                                                            
         MVC   VSQASHER,0(R1)                                                   
*                                                                               
         XC    DMCB(12),DMCB             TSAR                                   
         MVC   DMCB+4(4),=X'D9000A5D'                                           
         BASR  RE,RF                                                            
         MVC   VTSAR,0(R1)                                                      
*                                                                               
         XC    DMCB(12),DMCB             OFFAL                                  
         MVC   DMCB+4(4),=X'D9000A62'                                           
         BASR  RE,RF                                                            
         MVC   VOFFAL,0(R1)                                                     
*                                                                               
         MVC   DMCB+4(4),=X'D9000A84'    GETOPT                                 
         GOTO1 VCALLOV,DMCB,0                                                   
         CLI   4(R1),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         MVC   VGETOPT,0(R1)                                                    
*                                                                               
         MVC   DMCB+4(4),=X'D9000A85'    JOBBER                                 
         GOTO1 VCALLOV,DMCB,0                                                   
         CLI   4(R1),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         MVC   VJOBBER,0(R1)                                                    
*                                                                               
         MVC   DMCB+4(4),=X'D9000A12'    XSORT                                  
         GOTO1 VCALLOV,DMCB,0                                                   
         CLI   4(R1),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         MVC   VXSORT,0(R1)                                                     
*                                                                               
         MVC   DMCB+4(4),=X'D9000A69'    PRORATA                                
         GOTO1 VCALLOV,DMCB,0                                                   
         CLI   4(R1),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         MVC   VPRORATA,0(R1)                                                   
*                                                                               
         MVC   DMCB+4(4),=X'D9000A1D'    GETBROAD                               
         GOTO1 VCALLOV,DMCB,0                                                   
         CLI   4(R1),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
         MVC   VGETBRD,0(R1)                                                    
*                                                                               
         XC    DUB,DUB             CALL FASWITCH TO GET A(SYSFACS)              
         MVC   DUB(4),=X'FEFFFFFF'                                              
         GOTO1 VSWITCH,DUB                                                      
         L     RF,DUB                                                           
         USING FSYSFACD,RF     RF=A(SYSFAC)                                     
         MVC   SHIPIT,FVSHIPIT                                                  
         MVC   ASSB,FVSSB                                                       
         DROP  RF                                                               
*                                                                               
         TM    TWAMODE,TWAMTIA           TIA REQUIRS RESTORE FROM DISK          
         BO    INIT50                                                           
         MVI   TEMPSPAG,1                TEMPSTR PAGE 1                         
         L     R0,ATIA                   CLEAR TIA                              
         LHI   R1,TIALENQ                                                       
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         MVCL  R0,RE                                                            
         OI    TWAMODE,TWAMTIA           TIA REQUIRS RESTORE FROM DISK          
         B     INIT60                                                           
*                                                                               
INIT50   MVC   DMCB+20(2),=C'L='                                                
         MVC   DMCB+22(2),=Y(1024*18)                                           
         GOTO1 VDATAMGR,DMCB,DMREAD,TEMPSTR,(TEMPSPAG,0),ATIA                   
         CLI   8(R1),0                                                          
         BE    INIT60                                                           
         DC    H'0'                      CAN'T READ TEMPSTR                     
*                                                                               
INIT60   NI    TWAMODE,X'FF'-(TWAMSAV1+TWAMSAV2)  ONLY SAVE IF NEEDED           
*                                                                               
         OC    TWALEN,TWALEN             NEW SECURITY?                          
         BZ    INIT70                                                           
         LA    RF,L'SECBLK                                                      
         L     R2,ASECBLK                                                       
         USING SECD,R2                                                          
         GOTO1 VSECRET,DMCB,('SECPINIT',SECD),(RF)                              
         ORG   *-2                                                              
         TM    SECINDS,SECIINIT          TEST SECRET BLOCK INITIALISED          
         BNZ   *+12                                                             
         BASR  RE,RF                                                            
         BE    *+6                                                              
         DC    H'0'                                                             
         DROP  R2                                                               
*                                                                               
INIT70   ST    RB,ABASE1                 SET BASE REGISTERS                     
         ST    R8,ABASE2                                                        
         ST    R7,ABASE3                                                        
         ST    R6,ABASE4                                                        
         MVI   SPACES,C' '               SET SPACES                             
         MVC   SPACES+1(L'SPACES-1),SPACES                                      
         ZAP   PZERO,=P'0'                                                      
*                                                                               
         GOTO1 VDICTATE,DMCB,C'LU  ',ADICUPR,DSUPG GLOBAL UPPER CASE            
         GOTO1 (RF),(R1),C'LL  ',ADICMIX,DSMIXG    GLOBAL MIXED CASE            
*                                                                               
INIT80   MVC   BASHEAD,SPACES            CLEAR MESSAGE DISPLAY AREA             
         OI    BASHEADH+6,X'80'                                                 
         NI    PCDRIVEN,X'FF'-PCMODEQ-PCGSCRQ-PCBINTQ                           
         NI    GMSGFLG,GMSG1                                                    
*                                                                               
         GOTO1 VGETFACT,DMCB,0                                                  
         L     RF,0(R1)                  RF=A(SYSTEM DEFINITION BLOCK)          
         MVC   LANG,FALANG-FACTSD(RF)                                           
         MVC   CTRY,FACTRY-FACTSD(RF)                                           
         MVC   AGYSEC,FATAGYSC-FACTSD(RF) SECURITY AGENCY                       
*                                                                               
         TM    FATSTAT6-FACTSD(RF),X'80'                                        
         BZ    *+8                                                              
         OI    PCDRIVEN,PCMODEQ          RUNNING UNDER PC ACCPAK                
*                                                                               
         TM    FATSTAT8-FACTSD(RF),TST8BINT                                     
         BZ    *+8                                                              
         OI    PCDRIVEN,PCBINTQ          SUPPORTS COMPRESSION                   
*                                                                               
         XC    WORK,WORK                 SAVE AGY LEVEL PROGRM PROFILE          
         MVI   WORK+00,C'A'-X'40'                                               
         MVC   WORK+01(3),=C'FIS'                                               
         MVC   WORK+04(1),MYCO                                                  
         CLC   BASKEY,SPACES                                                    
         BNH   *+10                                                             
         MVC   WORK+5(2),BASKEY                                                 
         MVC   WORK+12(2),TWAAGY                                                
         GOTO1 VGETPROF,DMCB,(X'C0',WORK),PROF1,VDATAMGR                        
         MVI   WORK+03,C'2'                                                     
         GOTO1 VGETPROF,DMCB,(X'C0',WORK),PROF2,VDATAMGR                        
*                                                                               
         TM    HLPFLAG,HLPSCRN           SCREEN IN HELP FORMAT?                 
         BNO   INIT90                                                           
         BRAS  RE,BLDSCRN                REBUILD THE SCREEN                     
         MVI   HLPFLAG,HLPRES            RESET HELP FLAG                        
INIT90   TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRIDS                     
         BNO   INITX                                                            
         GOTO1 ASCRNCLR,DISSTART         CLEAR ALL SCREEN DATA LINES            
INITX    DS    0H                                                               
         EJECT ,                                                                
***********************************************************************         
*        READ COMPANY RECORD                                          *         
*        CHECK IF DDS TERMINAL HAS OVERRIDEN THE COMPANY CODE         *         
*        IF COMPANY OVERRIDE IS 1 CHAR THE EBCDIC IF 2 CHAR THEN HEX  *         
***********************************************************************         
* CHECK FOR GRIDS IN MOA FIELD                                                  
*-----------------------------------                                            
         USING FLDHDRD,R2                                                       
VALCOM   LA    R2,BASMOAH                R2=A(OPTION SCREEN FIELD HEAD)         
         ST    R2,FVADDR                                                        
         TM    FLDIIND,FINPTHIS                                                 
         BZ    VALCOM50                                                         
         TM    PCDRIVEN,PCMODEQ          TEST RUNNING UNDER STEREO?             
         BZ    VALCOM50                                                         
         CLI   FLDILEN,4                 INPUT AFTER 2 CHAR RECORD ID?          
         BNE   VALCOM50                                                         
*                                                                               
         CLC   =C'GRPF',FLDDATA          TEST GRID W/ PF KEYS?                  
         BE    VALCO02                   . YES                                  
         CLC   =C'GRID',FLDDATA          TEST CONNECT TO GRID?                  
         BE    VALCO04                                                          
         CLC   =C'GOFF',FLDDATA          TEST DISCONNECT FROM GRID?             
         BNE   VALCOM50                                                         
         NI    PCDRIVEN,X'FF'-(PCGRIDQ+PCGDATQ+PCGRPFQ)                         
         B     VALCO08                                                          
*                                                                               
VALCO02  OI    PCDRIVEN,PCGRPFQ                                                 
VALCO04  OI    PCDRIVEN,PCGNEWF                                                 
         TM    PCDRIVEN,PCGDATQ          PASS GRID SCREEN LINE                  
         BO    VALCO10                                                          
         OI    PCDRIVEN,PCGDATQ          PASS GRID SCREEN LINE                  
VALCO08  MVI   SVACTNUM,0                REBUILD SCREEN                         
VALCO10  MVC   BASMOA,SVBASMOA                                                  
*ALCO10  MVC   BASMOA,SPACES                                                    
         OI    FLDOIND,FOUTTRN+FOUTMOD                                          
         NI    FLDIIND,X'FF'-FINPVAL                                            
         MVC   BASHEAD,SPACES            CLEAR HEADER FIELD                     
         LA    R2,BASACTH                R2=A(ACT TYPE SCRN FIELD HEAD)         
         NI    FLDIIND,X'FF'-FINPVAL                                            
         B     FVERRX                                                           
*-----------------------------------                                            
* CHECK FOR GRIDS IN ACTION FIELD                                               
*-----------------------------------                                            
VALCOM50 LA    R2,BASACTH                R2=A(ACT TYPE SCRN FIELD HEAD)         
         ST    R2,FVADDR                                                        
         TM    FLDIIND,FINPVAL           PREVIOUSLY VALIDATED?                  
         BO    VALCOMX                                                          
         CLI   FLDILEN,ACTSHLNQ          INPUT AFTER 2 CHAR REC ID?             
         BE    VALCOM70                                                         
         TM    PCDRIVEN,PCMODEQ          TEST RUNNING UNDER STEREO?             
         BZ    VALCOM70                                                         
*                                                                               
         CLC   =C'GRI',FLDDATA           TEST GRID W/O PF KEYS?                 
         BE    VALCOM62                  . YES                                  
         CLC   =C'GOF',FLDDATA           TEST DISCONNECT FROM GRID?             
         BNE   VALCOM70                  . NO                                   
         NI    PCDRIVEN,X'FF'-(PCGRIDQ+PCGDATQ+PCGRPFQ)                         
         B     VALCOM64                                                         
*                                                                               
VALCOM62 TM    PCDRIVEN,PCGDATQ          PASS GRID SCREEN LINE                  
         BO    VALCOM66                                                         
         OI    PCDRIVEN,PCGDATQ          PASS GRID SCREEN LINE                  
VALCOM64 MVI   SVACTNUM,0                REBUILD SCREEN                         
VALCOM66 MVC   BASACT,SPACES                                                    
         OI    FLDOIND,FOUTTRN+FOUTMOD                                          
         NI    FLDIIND,X'FF'-FINPVAL                                            
         MVC   BASHEAD,SPACES            CLEAR HEADER FIELD                     
         B     FVERRX                                                           
*-----------------------------------                                            
* CONTINUE VALIDATE COMPANY                                                     
*-----------------------------------                                            
VALCOM70 CLI   TWAOFFC,C'*'              DDS TERMINAL?                          
         BNE   VALCOM80                                                         
*                                                                               
         MVC   TEMPCOMP,SPACES                                                  
         SR    RE,RE                                                            
         LA    RF,L'BASACT-1             RF=A(DISP TO LAST CHAR)                
VALCOM72 LA    R3,FLDDATA(RF)                                                   
         CLI   0(R3),C','                COMMA DELIMINATOR REQUIRED             
         BE    VALCOM74                                                         
         CLI   0(R3),C' '                IF NOT COMMA AND NOT SPACE             
         BNH   *+8                                                              
         LA    RE,1(RE)                  ASSUME PART OF COMPANY CODE            
         BCT   RF,VALCOM72                                                      
         B     VALCOM80                  NO OVERRIDE DELIMITOR FOUND            
*                                                                               
VALCOM74 CHI   RE,L'TEMPCOMP-1           LENGTH OF OVERRIDE RESONABLE?          
         BH    ERRLONG                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   TEMPCOMP(0),0(R3)         SAVE OVERRIDE FOR REFORMAT             
         LA    R3,1(R3)                  R3=A(COMPANY OVERRIDE CHARS)           
         CHI   RE,EBCCOMLN               ASSUME EBCIDIC OVERRIDE?               
         BE    VALCOM76                                                         
         CHI   RE,HEXCOMLN               ASSUME HEX OVERRIDE?                   
         BNE   ERRNOTV                                                          
         GOTO1 VHEXIN,DMCB,(R3),MYCO,2                                          
         OC    DMCB+12(4),DMCB+12                                               
         BZ    ERRNOTV                                                          
         B     *+10                                                             
*                                                                               
VALCOM76 MVC   MYCO,0(R3)                                                       
*                                                                               
         LA    RF,FLDDATA+ACTSHLNQ       REFORMAT TO ENSURE 2 CHAR              
         MVC   0(L'BASACT-ACTSHLNQ,RF),SPACES                                   
         MVC   0(L'TEMPCOMP,RF),TEMPCOMP                                        
*                                                                               
         CLI   MYCO,DDSLTD               PREVENT A SWITCH TO DDS LTD            
         BNE   VALCOM82                                                         
         DC    H'0'                      P45 TIME                               
*                                                                               
VALCOM80 LA    RF,FLDDATA+ACTSHLNQ       ENSURE REST OF FIELD IS CLEAR          
         MVC   0(L'BASACT-ACTSHLNQ,RF),SPACES                                   
*                                                                               
VALCOM82 CLC   MYCO,SVCO                 READ COMPANY REC IF DIFFERENT          
         BE    VALCOMX                   FROM LAST & SAVE PROD UNIT             
         MVI   DISPFLAG,0                & LEDGER AND RECEIVABLE U/L            
         MVI   DISPFLG2,0                                                       
         NI    BASCACH+4,X'DF'                                                  
         LA    R3,IOKEY                                                         
         USING CPYRECD,R3                                                       
         MVC   CPYKEY,SPACES                                                    
         MVC   CPYKCPY,MYCO                                                     
         GOTO1 AIO,IOREAD+IOACCMST+IO1                                          
         BNE   ERRERNF                                                          
         L     R3,AIO1                                                          
         LA    R1,CPYRFST                                                       
         USING CPYELD,R1                                                        
         SR    R0,R0                                                            
VALCOM84 CLI   CPYEL,0                   TEST EOR                               
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLI   CPYEL,CPYELQ              TEST COMPANY ELEMENT                   
         BE    *+14                                                             
         IC    R0,CPYLN                                                         
         AR    R1,R0                                                            
         B     VALCOM84                                                         
*                                                                               
         MVC   SVCO,MYCO                                                        
         MVC   COMPSTA1,CPYSTAT1         SAVE COMPANY STATUS INFO               
         MVC   COMPSTA2,CPYSTAT2                                                
         MVC   COMPSTA3,CPYSTAT3                                                
         MVC   COMPSTA4,CPYSTAT4                                                
         MVC   COMPSTA5,CPYSTAT5                                                
         MVC   COMPSTA6,CPYSTAT6                                                
         MVC   COMPSTA7,CPYSTAT7                                                
         MVC   COMPSTA8,CPYSTAT8                                                
         MVC   COMPSTA9,CPYSTAT9                                                
         MVC   COMPSTAA,CPYSTATA                                                
*                                                                               
         MVI   SPECIAL,0                                                        
         TM    COMPSTAA,CPYSADBL                                                
         BZ    *+8                                                              
         MVI   SPECIAL,C'Y'                                                     
*                                                                               
         MVC   COMPSFST,CPYSFST          START MONTH OF FINANCIAL YEAR          
         MVC   COMPCURR,CPYCURR          COMPANY CURRENCY                       
         OC    COMPCURR,COMPCURR         TEST CURRENCY CODE RESOLVED            
         BNZ   VALCOM90                                                         
         L     RF,ADFCTAB                DEFAULT CURRENCY IN TABLE              
VALCOM88 CLI   0(RF),0                                                          
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLC   AGYCTRY,0(RF)             MATCH ON COUNTRY CODE                  
         BE    *+12                                                             
         LA    RF,L'DFCTAB(RF)                                                  
         B     VALCOM88                                                         
         MVC   COMPCURR,1(RF)                                                   
*                                                                               
VALCOM90 MVC   SPROUL,CPYPROD            PRODUCTION U/L                         
         MVC   SRECUL,CPYRECV            RECEIVABLE U/L                         
         MVC   SBNKUL,CPYBANK            BANK U/L                               
         MVC   SSUPUL,CPYSUPP            SUPPLIER U/L                           
         MVC   SHSPUL,=C'SX'             HOUSE SUPPLIER U/L                     
         MVC   STAXUL,=C'SG'             TAX U/L                                
         MVC   SEXPUL,=C'SE'             EXPENSES U/L                           
         MVC   SARTUL,=C'ST'             ARTISTES U/L                           
         MVC   SFOLUL,=C'SF'             FOLIO U/L                              
*                                        ONLY USE LATEST VAT RATE               
         MVC   COMPVATR,HEXFFS                                                  
         LA    RF,CPYVATR+CPYVATL-L'CPYVATR RF=A(LAST VAT SLOT)                 
         LA    R0,CPYVATN                R0=(MAX NUMBER OF VAT SLOTS)           
         CLC   0(L'CPYVATR,RF),HEXFFS    UNUSED SLOT?                           
         BNE   *+12                                                             
         SHI   RF,L'CPYVATR                                                     
         BCT   R0,*-14                                                          
         MVC   COMPVATR(L'CPYVATR),0(RF) GET LATEST VAT RATE                    
         DROP  R1                                                               
*                                                                               
VALCOMX  DS    0H                                                               
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* ENSURE ACTION TYPE IS ENTERED AND VALIDATE IF DIFFERENT FROM LAST   *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
VALACT   CLI   TWASCROV,0                 ANY SCREEN LOADED?                    
         BNE   VALACT10                                                         
         GOTO1 AOVRSCR,TWASCRAL           LOAD A DUMMY SCREEN                   
*                                                                               
VALACT10 LA    R3,TEMP                    TEST GLOBBER CALL                     
         USING GLVXCTLD,R3                                                      
         XC    GLVXCODE(24),GLVXCODE                                            
         L     R4,ACOMFACS                                                      
         USING COMFACSD,R4                                                      
         GOTO1 CGLOBBER,DMCB,=C'GETD',GLVXFRSY,22,GLVXCTL                       
         TM    8(R1),X'10'                                                      
         BO    VALACT15                   NOT A GLOBBER CALL                    
         GOTO1 CGLOBBER,DMCB,=C'DELE'     DELETE XCTL ELEMENT                   
         CLC   GLVXFRSY(6),=C'ACCINP'     FROM ACC/INPUT                        
         BE    *+8                                                              
         B     VALACT15                   UNKNOWN CALL                          
         MVC   TWASESSR,GLVXSESR          SAVE SESSION # OF =INPUT              
         OI    TWAFLG1,TWAFRINP           SET ENTERED VIA GLOBBER CALL          
         LA    RF,INVPDA-INVPKEY          GET VENDOR INVOICE PASSIVE            
         GOTO1 CGLOBBER,DMCB,=C'GETD',TEMP+50,(RF),GLVAINVP                     
         CLI   8(R1),0                                                          
         BE    *+8                                                              
         B     VALACT15                   PROBLEM                               
*                                                                               
         LA    R2,TEMP+50                                                       
         USING INVPASD,R2                                                       
         MVC   BASACT(2),=C'VE'                                                 
         MVI   BASACTH+5,2                                                      
         MVI   BASKEY,C'S'                                                      
         MVC   BASKEY+1(L'INVPLDG+L'INVPACT),INVPLDG                            
         MVI   BASKEYH+5,L'INVPLDG+L'INVPACT+1                                  
         MVC   BASOPT(4),=C'DF=Y'                                               
         LA    RF,BASOPT+4                                                      
         MVC   0(5,RF),=C',INV='                                                
         MVC   5(20,RF),INVPINV                                                 
         LA    RF,BASOPT+L'BASOPT-1                                             
         LA    R1,L'BASOPT                                                      
         CLI   0(RF),C' '                                                       
         BH    *+10                                                             
         BCTR  R1,0                                                             
         BCT   RF,*-10                                                          
         STC   R1,BASOPTH+5                                                     
         DROP  R2,R3,R4                                                         
*                                                                               
         USING FLDHDRD,R2                                                       
VALACT15 LA    R2,BASACTH                R2=A(ACTION FIELD HEADER)              
         ST    R2,FVADDR                                                        
         LA    R1,HLPACT                 R1=HELP FIELD NUMBER                   
         BAS   RE,CHKHELP                SEE IF HELP WANTED                     
         BNE   FVERRX                    IF HELP DISPLAYED EXIT                 
*                                                                               
         CLI   FLDILEN,0                 ACTION MANDATORY                       
         BE    ERRNONE                                                          
*-----------------------------------                                            
* ACTION CHANGE DUE TO PFKEY WHEN                                               
* NAVIGATION CHANGES KEY                                                        
*-----------------------------------                                            
         TM    PCDRIVEN,PCGRPFQ                                                 
         BZ    VALACT18                                                         
         L     R1,AINP                   R1=A(TRANSLATOR I/O BLOCK)             
         ICM   RF,1,TIOBAID-TIOBD(R1)    ANY PF KEY PRESSED?                    
         BZ    VALACT18                                                         
         STC   RF,PFKEY                                                         
         LA    RF,DSUPG                                                         
         CLI   PFKEY,PF13                                                       
         BNE   VALACT16                                                         
         CLI   SVACTNUM,ACTNVICF         VENDOR CASHFLOW?                       
         BNE   VALACT18                                                         
         AHI   RF,UP@JOBCF-DSUPG                                                
         MVC   BASACT(ACTSHLNQ),0(RF)                                           
         NI    FLDIIND,TURNOFF-FINPVAL                                          
VALACT16 CLI   PFKEY,PF5                                                        
         BNE   VALACT18                                                         
         CLI   SVACTNUM,ACTNJBCF         JOB CASHFLOW?                          
         BNE   VALACT18                                                         
         AHI   RF,UP@VNDCF-DSUPG                                                
         MVC   BASACT(ACTSHLNQ),0(RF)                                           
         NI    FLDIIND,TURNOFF-FINPVAL                                          
*-----------------------------------                                            
VALACT18 CLI   PHASE,0                   HELP SET FIELD VALIDATED ON?           
         BNE   *+12                                                             
         NI    FLDIIND,TURNOFF-FINPVAL                                          
         B     *+12                                                             
         TM    FLDIIND,FINPVAL           PREVIOUSLY VALIDATED?                  
         BO    VALACT95                                                         
         XC    HLPBLK(HLPBLKL),HLPBLK    RESET HELP VARIABLES                   
         MVC   SVACTION,BASACT           SAVE ANYTHNG ENTERED IN FIELD          
         MVC   SAVEACCN,SPACES                                                  
*                                                                               
         GOTO1 ACHKACT,DMCB,FLDDATA      CHECK ACTION                           
         BNE   ERRNOTV                                                          
         L     R3,0(,R1)                 R3=A(ACTION TABLE)                     
         USING ACTTABD,R3                                                       
         LR    RF,R3                                                            
         SR    RF,RB                                                            
         ST    RF,AACTENT                SAVE ADDRESS OF ACTION ENTRY           
*                                                                               
         NI    PCDRIVEN,X'FF'-PCGRIDQ                                           
         TM    PCDRIVEN,PCGDATQ          TEST PASS GRID DATA?                   
         BZ    VALACT20                                                         
         TM    ACTAUTH,ACTGRIDQ          ACTION ALLOWED FOR GRID                
         BZ    VALACT20                                                         
         OI    PCDRIVEN,PCGRIDQ          RUNNING UNDER GRID                     
*                                                                               
         USING SESD,R1                                                          
VALACT20 TM    LSTINDS,LSTISUB           COMING FROM LS SUBACT?                 
         BZ    VALACT50                                                         
         L     R1,ASVSES                 R1=A(SAVED CURRENT SESSION)            
         CLC   SESSUB,BASACT             TEST ACTION CHANGED?                   
         BE    VALACT50                                                         
         MVI   LSTINDS,0                 . YES - RESET PREVIOUS SESSION         
         XC    0(SESLNQ,R1),0(R1)                                               
         DROP  R1                                                               
*                                                                               
VALACT50 CLC   SVACTNUM,ACTNUM           SAME ACTION NUMBER?                    
         BE    VALACTX                                                          
*                                                                               
         LA    R0,OSSAVE                 CLEAR OVERLAY SAVE STORAGE             
         LA    R1,L'OSSAVE                                                      
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         MVCL  R0,RE                                                            
*                                                                               
         L     RF,ASECBLK                                                       
         OC    TWALEN,TWALEN             NEW SECURITY?                          
         BZ    VALACT60                                                         
         GOTO1 VSECRET,DMCB,('SECPRACT',(RF)),(ACTNUM,ACTDIS)                   
         BNE   ERRSECLO                                                         
*                                                                               
VALACT60 MVI   DISPFLAG,0                                                       
         MVI   DISLINE,0                                                        
         MVC   PHASE,ACTOLAY             SAVE PHASE NUMBER                      
         MVC   SVACTNUM,ACTNUM                                                  
         MVC   LASTACT,CURRACT                                                  
         MVC   CURRACT,SVACTNUM                                                 
*                                                                               
         LA    RF,TWASCRGR               GRID ENQUIRY SCREEN                    
         TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BO    VALACT70                                                         
         LA    RF,TWASCRLI               LIST ENQUIRY SCREEN                    
         CLI   SVACTNUM,ACTNLSLT         TEST LIST/SELECT ENQUIRY?              
         BE    VALACT70                                                         
         LA    RF,TWASCRAL               OTHER ENQUIRY SCREEN                   
*                                                                               
VALACT70 SR    RE,RE                                                            
         IC    RE,TWASCROV                                                      
         CR    RE,RF                     TEST SCREEN ALREADY LOADED?            
         BE    VALACT75                                                         
         GOTO1 AOVRSCR,(RF)              LOAD SCREEN                            
*                                                                               
VALACT75 GOTO1 ASCRNCLR,DISLINE          CLEAR ALL SCREEN DATA LINES            
         OI    FLDOIND,FOUTTRN                                                  
         OI    FLDIIND,FINPVAL           PREVIOUSLY VALIDATED                   
*                                                                               
         LA    R2,GRDPFAH                PFKEY LINE ON GRID SCREEN              
         TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BO    VALACT80                                                         
         LA    R2,LSTPFAH                PFKEY LINE ON LIST SCREEN              
         CLI   SVACTNUM,ACTNLSLT         TEST LIST/SELECT ENQUIRY?              
         BE    VALACT80                                                         
         LA    R2,ENQPFAH                PFKEY LINE ON OTHER SCREEN             
VALACT80 MVC   FLDDATA(L'ENQPFA),SPACES  CLEAR PFKEY SCREEN LINE                
         OI    FLDOIND,FOUTTRN                                                  
*                                                                               
VALACT95 LA    R2,BASTABH                TAB FIELD                              
         OI    FLDOIND,FOUTPRT           PROTECT THE TAB FIELD                  
         LA    R2,BASACTH                                                       
         OI    FLDOIND,FOUTTRN+FOUTMOD   ENSURE TRANSMIT FLD                    
         B     VALACTX                                                          
*                                                                               
VALACTX  DS    0H                                                               
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* CHECK FOR ACTION DEPENDENT HELP AND DISPLAY IF REQUESTED            *         
***********************************************************************         
HELPDEP  LA    R1,HLPKEY                 R1=HELP FIELD NUMBER                   
         LA    R2,BASKEYH                R2=A(KEY FILED HEADER)                 
         BAS   RE,CHKHELP                SEE IF HELP WANTED                     
         BNE   FVERRX                    IF HELP DISPLAY EXIT                   
         MVC   SVKEY,BASKEY                                                     
*                                                                               
         LA    R1,HLPCONT                R1=HELP FIELD NUMBER                   
         LA    R2,BASCACH                R2=A(CONTRA FIELD HEADER)              
         BAS   RE,CHKHELP                SEE IF HELP WANTED                     
         BNE   FVERRX                    IF HELP DISPLAY EXIT                   
         MVC   SVCONTRA,BASCAC                                                  
*                                                                               
         LA    R1,HLPOPT                 R1=HELP FIELD NUMBER                   
         LA    R2,BASOPTH                R2=A(ACTION FIELD HEADER)              
         BAS   RE,CHKHELP                SEE IF HELP WANTED                     
         BNE   FVERRX                    IF HELP DISPLAY EXIT                   
         MVC   SVOPTION,BASOPT           SAVE INPUT FOR FIELD                   
*                                                                               
         TM    PCDRIVEN,PCGRIDQ          RUNNING UNDER GRID                     
         BO    VALKEY                                                           
         LA    R1,HLPSCRL                R1=HELP FIELD NUMBER                   
         LA    R2,ENQSCRLH               R2=A(ACTION FIELD HEADER)              
         BAS   RE,CHKHELP                SEE IF HELP WANTED                     
         BNE   FVERRX                    IF HELP DISPLAY EXIT                   
         MVC   SVSCROLL,ENQSCRL          SAVE INPUT FOR FIELD                   
         EJECT                                                                  
***********************************************************************         
*        VALIDATE KEY FIELD - GET LEDGER INFORMATION                  *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
VALKEY   LA    R2,BASKEYH                                                       
         L     R3,AACTENT                ADDRESS OF ACTION ENTRY                
         AR    R3,RB                                                            
         USING ACTTABD,R3                                                       
         MVC   FVMSGNO,=AL2(EALDGINV)                                           
         ST    R2,FVADDR                                                        
*                                                                               
         LA    R1,FLDDATA                                                       
         TM    ACTAUTH2,ACT2NULQ         UNIT LEDGER REQUIRED?                  
         BZ    VALKEY5                   . YES                                  
         LA    R1,SPROUL                                                        
         TM    ACTAUTH2,ACT2PROQ         PRODUCTION TYPE?                       
         BO    VALKEY5                   . YES                                  
         TM    ACTAUTH2,ACT2RECQ         RECEIVABLES?                           
         BZ    VALKEYX                   . NO, FORGET LEDGER INFO               
         LA    R1,SRECUL                                                        
         CLI   FLDDATA,C'*'                                                     
         BNE   VALKEY5                                                          
         LA    R1,FLDDATA+1                                                     
*                                                                               
VALKEY5  OC    LDGTUL,LDGTUL             UNIT LEDGER INFO?                      
         BZ    VALKEY6                   . NO, MUST GET IT                      
         TM    FLDIIND,FINPTHIS          FIELD INPUT THIS TIME?                 
         BZ    VALKEYX                   . NO, HAVE IT ALREADY                  
         MVI   DISPFLAG,0                                                       
         MVI   DISPFLG2,0                                                       
*                                                                               
VALKEY6  GOTO1 AUNITLDG,(R1)             READ LEDGER RECORD                     
*----------------------------------------                                       
* GRID PF NAVIGATION ALWAYS ADDS U/L FOR LISTS                                  
*----------------------------------------                                       
         TM    PCDRIVEN,PCGRPFQ                                                 
         BZ    VALKEYX                                                          
         L     R1,AINP                    R1=A(TRANSLATOR I/O BLOCK)            
         ICM   RF,1,TIOBAID-TIOBD(R1)     ANY PF KEY PRESSED?                   
         BZ    VALKEYX                                                          
         CLI   LASTACT,ACTNLIST           TEST COMING FROM LIST                 
         BNE   VALKEYX                                                          
         TM    ACTAUTH2,ACT2NULQ        UNIT LEDGER REQUIRED?                   
         BZ    VALKEYX                  . YES                                   
         MVC   BASKEY(L'BASKEY-2),BASKEY+2                                      
         MVC   BASKEY+L'BASKEY-2(2),SPACES                                      
         OI    FLDOIND,FOUTTRN            ENSURE TRANSMIT FLD                   
         SR    R1,R1                                                            
         ICM   R1,1,FLDILEN                                                     
         BNP   VALKEYX                                                          
         AHI   R1,-2                                                            
         STC   R1,FLDILEN                                                       
*----------------------------------------                                       
VALKEYX  DS    0H                                                               
         DROP  R3                                                               
***********************************************************************         
*        VALIDATE OPTIONS                                             *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
VALOPT   LA    R2,BASKEYH                                                       
         TM    FLDIIND,FINPTHIS          KEY FIELD INPUT THIS TIME?             
         BZ    VALOPT10                                                         
         MVI   DISPFLAG,0                                                       
         MVI   DISPFLG2,0                                                       
*                                                                               
VALOPT10 LA    R2,BASMOAH                R2=A(MOA SCREEN FIELD HEAD)            
         TM    FLDIIND,FINPTHIS          HAS MOA FIELD BEEN VALIDATED?          
         BZ    VALOPT12                                                         
         MVI   DISPFLAG,0                                                       
         MVI   DISPFLG2,0                                                       
*                                                                               
VALOPT12 LA    R2,BASOPTH                R2=A(OPTION SCREEN FIELD HEAD)         
         ST    R2,FVADDR                                                        
         TM    FLDIIND,FINPVAL                                                  
         BO    VALOPT15                                                         
         MVI   DISPFLAG,0                                                       
         MVI   DISPFLG2,0                                                       
*                                                                               
VALOPT15 CLI   DISPFLAG,0                IF ACTION CHANGED THEN REDO            
         BNE   VALOPTX                                                          
         L     R0,AOPTVALS               CLEAR SCAN BLOCK                       
         LHI   R1,OPTVLLNQ                                                      
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         MVCL  R0,RE                                                            
         CLI   FLDILEN,0                                                        
         BE    VALOPT90                                                         
         LA    R0,SCANBLK                CLEAR SCAN BLOCK                       
         LHI   R1,L'SCANBLK                                                     
         SR    RE,RE                                                            
         LA    RF,X'40'                                                         
         SLL   RF,24                                                            
         MVCL  R0,RE                                                            
*                                                                               
         LA    R0,L'SCANRHS                                                     
         GOTO1 VSCANNER,DMCB,((R0),(R2)),('MAXSCAN',SCANBLK),C',=  '            
         CLI   4(R1),0                                                          
         BE    ERRNOTV                                                          
*                                                                               
         LA    R4,SCANBLK                                                       
         USING SCANBLKD,R4                                                      
         CLI   4(R1),1                                                          
         BE    *+8                                                              
         MVI   FVINDX,1                                                         
         SR    R5,R5                                                            
         IC    R5,4(R1)                                                         
*                                                                               
         OI    OPTFLAG,OPTFSTP                                                  
VALOPT20 L     R3,AOPTTAB                                                       
         USING OPTTABD,R3                                                       
VALOPT30 CLI   0(R3),EOT                 END OF OPTTAB?                         
         BE    VALOPT84                                                         
         TM    OPTFLAG,OPTFSTP           2 CHAR MATCH NOT FOUND                 
         BNO   VALOPT40                  ON FIRST PASS?                         
         CLI   SCANINF,OPTSHLNQ                                                 
         BL    ERRSHRT                                                          
         BH    VALOPT40                                                         
         SR    RF,RF                                                            
         ICM   RF,3,OPTSHNAM             RF=(DISPLCMNT TO 2 CHAR NAME)          
         LA    RF,WORKD(RF)              RF=A(2 CHAR NAME)                      
         CLC   0(OPTSHLNQ,RF),SCANLHS    MATCHED ON TWO CHAR NAME?              
         BE    VALOPT50                                                         
         B     VALOPT75                                                         
*                                                                               
VALOPT40 CLI   SCANINF,OPTLOLNQ          MATCH PART/ALL OF FULL NAME            
         BH    ERRLONG                                                          
         SR    RE,RE                                                            
         IC    RE,SCANINF                                                       
         BCTR  RE,0                                                             
         SR    RF,RF                                                            
         ICM   RF,3,OPTLONAM             RF=(DISPL TO FULL OPTION NAME)         
         LA    RF,WORKD(RF)              RF=A(LONG OPTION NAME)                 
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANLHS(0),0(RF)                                                 
         BNE   VALOPT75                                                         
*                                                                               
VALOPT50 LA    RF,OPTACTNS                                                      
         CLI   0(RF),ACTNALLX            TEST ALL ACTIONS EXCEPT...             
         BNE   VALOPT60                                                         
         LA    RF,1(,RF)                                                        
VALOPT52 CLI   0(RF),EOT                 TEST ACTION EXCLUSIONS                 
         BE    VALOPT62                  NOT FOUND - PASS THIS ACTION           
         CLC   SVACTNUM,0(RF)                                                   
         BE    VALOPT75                  FOUND - FAIL THIS ACTION               
         LA    RF,1(,RF)                                                        
         B     VALOPT52                                                         
*                                                                               
VALOPT60 CLI   0(RF),EOT                                                        
         BE    VALOPT75                                                         
         CLC   SVACTNUM,0(RF)                                                   
         BE    VALOPT62                                                         
         LA    RF,1(RF)                                                         
         B     VALOPT60                                                         
*                                                                               
VALOPT62 CLC   BASKEY,SPACES             ACCOUNT NOT YET ENTERED?               
         BNH   VALOPT70                                                         
         CLI   OPTLN,OPTTABL             ACTION/LEDGER LIST PRESENT?            
         BNH   VALOPT70                                                         
         LA    R1,OPTACT                 R1=A(VALID ACTION/LEDGER LIST)         
         LA    RE,L'OPTACT+L'OPTLEDG     RE=L'(ACTION/LEDGER LIST NTRY)         
         SR    RF,RF                                                            
         IC    RF,OPTLN                                                         
         LA    RF,OPTSHNAM(RF)           RF=A(END OF OPTION ENTRY               
         SHI   RF,L'OPTACT+L'OPTLEDG                                            
         CLC   SVACTNUM,0(R1)            MATCH ON ACTION NUMBER                 
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     VALOPT70                                                         
         LA    R1,L'OPTACT(R1)           RF=A(VALID LEDGERS FOR ACTION)         
         LA    R0,L'OPTLEDG/L'SPROUL                                            
VALOPT65 CLC   BASKEY(L'SPROUL),0(R1)    MATCH ON LEDGER?                       
         BE    VALOPT70                                                         
         LA    R1,L'SPROUL(R1)           BUMP TO NEXT LEDGER                    
         BCT   R0,VALOPT65                                                      
         OI    OPTFLAG,OPTINLDG          INVALID LEGDER                         
         B     VALOPT75                                                         
*                                                                               
VALOPT70 TM    PCDRIVEN,PCGRIDQ                                                 
         BZ    *+12                                                             
         TM    OPTSTAT,OPTNGRDQ                                                 
         BO    VALOPT75                                                         
*                                                                               
         TM    OPTSTAT,OPT2CHQ           2 CHAR OFFICE ONLY?                    
         BNO   VALOPT72                                                         
         TM    COMPSTA4,CPYSOFF2         2 CHAR OFFICE COMPANY?                 
         BNO   VALOPT75                                                         
*                                                                               
VALOPT72 TM    OPTSTAT,OPTDDSQ           DDS ONLY?                              
         BNO   VALOPT80                                                         
         CLI   TWAOFFC,C'*'                                                     
         BE    VALOPT80                                                         
*                                                                               
VALOPT75 SR    RF,RF                                                            
         IC    RF,OPTLN                                                         
         AR    R3,RF                                                            
         B     VALOPT30                                                         
*                                                                               
VALOPT80 CLC   SCANRHSL,OPTMAXL                                                 
         BH    ERRLONG                                                          
         CLI   SCANRHSL,0                                                       
         BE    ERRSHRT                                                          
         SR    RF,RF                                                            
         ICM   RF,3,OPTVAL                                                      
         LA    RF,T62000(RF)             RF=A(OPTION VAL/SAVE ROUTINE)          
         L     R1,AOPTVALS                                                      
         SR    RE,RE                                                            
         ICM   RE,3,OPTVALUE                                                    
         AR    R1,RE                     R1=A(OPTION SAVE ADDRESS)              
         BASR  RE,RF                                                            
         BNE   FVERR                                                            
         B     VALOPT88                                                         
*                                                                               
VALOPT84 CLI   SCANINF,OPTSHLNQ                                                 
         BNE   VALOPT86                                                         
         TM    OPTFLAG,OPTFSTP                                                  
         BNO   VALOPT86                                                         
         NI    OPTFLAG,TURNOFF-OPTFSTP                                          
         B     VALOPT20                                                         
VALOPT86 TM    OPTFLAG,OPTINLDG          INVALID LEDGER?                        
         BO    ERROPTNV                                                         
         B     ERRNOTV                                                          
*                                                                               
VALOPT88 OI    OPTFLAG,OPTFSTP                                                  
         SR    RF,RF                                                            
         IC    RF,FVINDX                                                        
         LA    RF,1(RF)                                                         
         STC   RF,FVINDX                                                        
         LA    R4,SCANBLKL(R4)                                                  
         BCT   R5,VALOPT20                                                      
*                                                                               
VALOPT90 OI    FLDOIND,FOUTTRN                                                  
         OI    FLDIIND,FINPVAL                                                  
VALOPTX  MVI   FVINDX,0                                                         
*                                                                               
         DROP  R2,R3,R4                                                         
         EJECT                                                                  
*                                                                               
***********************************************************************         
* CHECK FOR CONTRA ACCOUNT FILTER                                     *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
*                                                                               
VALCAC   LA    R2,BASCACH          R2=A(CONTRA ACCOUNT SCREEN HEADER)           
         ST    R2,FVADDR           STORE FIELD FOR POSSIBLE ERROR               
         TM    FLDIIND,FINPVAL     PREVIOUSLY VALIDATED?                        
         BO    VALCACX                                                          
         MVC   SVCACN,SPACES       CONTRA ACCOUNT NAME                          
         MVI   DISPFLAG,0                                                       
         MVI   DISPFLG2,0                                                       
         XC    CONFILT(CONFLNQ),CONFILT INITIALISE CONTRA FILTER VALS           
         XR    RF,RF                                                            
         ICM   RF,1,FLDILEN        RF=L'(INPUT)                                 
         BZ    VALC20                                                           
         LA    RE,FLDDATA          RE=A(INPUT)                                  
         CLI   0(RE),NEGFILTR      NEGATIVE FILTER?                             
         BNE   VALC10                                                           
         MVI   NEGCONT,NEGFILTR    SET AS NEGATIVE FILTER                       
         LA    RE,1(RE)                                                         
         MVC   FVMSGNO,=AL2(EGIFMISS)                                           
         SHI   RF,1                                                             
         BZ    FVERR               NO ACCOUNT ENTERED?                          
*                                                                               
VALC10   STC   RF,CONTLEN          L'(CONTRA CODE)                              
         BCTR  RF,0                                                             
         MVC   CONTRA,SPACES       GET CONTRA ACCOUNT                           
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   CONTRA(0),0(RE)     GET CONTRA ACCOUNT                           
         GOTO1 ACNAME              ATTEMPT TO FIND CONTRA NAME                  
*                                                                               
VALC20   OI    FLDIIND,FINPVAL                                                  
         OI    FLDOIND,FOUTTRN                                                  
*                                                                               
VALCACX  DS    0H                                                               
         DROP  R2                                                               
         EJECT ,                                                                
*                                                                               
***********************************************************************         
*        VALIDATE MONTH OF ACTIVITY FIELD                             *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
*                                                                               
VALMOA   LA    R2,BASKEYH                                                       
         TM    FLDIIND,FINPTHIS    HAS KEY FIELD BEEN INPUT THIS TIME?          
         BNO   VALMOA10                                                         
         MVI   DISPFLAG,0                                                       
         MVI   DISPFLG2,0                                                       
*                                                                               
VALMOA10 LA    R2,BASMOAH          R2=A(OPTION SCREEN FIELD HEAD)               
         ST    R2,FVADDR                                                        
         TM    FLDIIND,FINPVAL                                                  
         BO    VALMOA20                                                         
         MVI   DISPFLAG,0                                                       
         MVI   DISPFLG2,0                                                       
*                                                                               
VALMOA20 CLI   DISPFLAG,0          IF ACTION CHANGED THEN REDO OPT              
         BNE   VALMOAX                                                          
         MVC   FVMSGNO,=AL2(AE$NAWTT)   NOT WITH THIS TYPE                      
*                                                                               
         L     R3,AOPTVALS         CLEAR SCAN BLOCK                             
         USING OPTVALSD,R3                                                      
         XC    OMOS,OMOS                                                        
*                                                                               
         CLI   FLDILEN,0                                                        
         BE    VALMOA90                                                         
*                                                                               
         USING SCANBLKD,R4                                                      
VALMOA25 LA    R4,SCANBLK          CLEAR SCAN BLOCK                             
         MVC   0(SCANBLKL,R4),SPACES                                            
         MVC   SCANRHS(L'BASMOA),BASMOA                                         
         MVI   SCANRHSL,L'BASMOA                                                
         DROP  R4                                                               
*                                                                               
         USING OPTTABD,R3                                                       
         L     R3,AOPTTAB                                                       
         SHI   R3,MOLNQ            BACK UP TO MOA ENTRY                         
*                                                                               
         LA    RF,OPTACTNS                                                      
         CLI   0(RF),ACTNALLX      TEST ALL ACTIONS EXCEPT...                   
         BNE   VALMOA55                                                         
         LA    RF,1(,RF)                                                        
VALMOA52 CLI   0(RF),EOT           TEST ACTION EXCLUSIONS                       
         BE    VALMOA56            NOT FOUND - PASS THIS ACTION                 
         CLC   SVACTNUM,0(RF)                                                   
         BE    FVERR               FOUND - FAIL THIS ACTION                     
         LA    RF,1(,RF)                                                        
         B     VALMOA52                                                         
*                                                                               
VALMOA55 CLI   0(RF),EOT                                                        
         BE    VALMOA90                                                         
         CLC   SVACTNUM,0(RF)                                                   
         BE    *+12                                                             
         LA    RF,1(RF)                                                         
         B     VALMOA55                                                         
*                                                                               
VALMOA56 CLC   BASKEY,SPACES       ACCOUNT NOT YET ENTERED?                     
         BNH   VALMOA58                                                         
         CLI   OPTLN,OPTTABL       ACTION/LEDGER LIST PRESENT?                  
         BNH   VALMOA58                                                         
         LA    R1,OPTACT           R1=A(VALID ACTION/LEDGER LIST)               
         LA    RE,L'OPTACT+L'OPTLEDG RE=L'(ACTION/LEDGER LIST ENTRY)            
         SR    RF,RF                                                            
         IC    RF,OPTLN                                                         
         LA    RF,OPTSHNAM(RF) RF=A(END OF OPTION ENTRY                         
         SHI   RF,L'OPTACT+L'OPTLEDG                                            
         CLC   SVACTNUM,0(R1)      MATCH ON ACTION NUMBER                       
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     VALMOA58                                                         
         LA    R1,L'OPTACT(R1)     RF=A(VALID LEDGERS FOR THIS ACTION)          
         LA    R0,L'OPTLEDG/L'SPROUL                                            
VALMOA57 CLC   BASKEY(L'SPROUL),0(R1)     MATCH ON LEDGER?                      
         BE    VALMOA58                                                         
         LA    R1,L'SPROUL(R1)            BUMP TO NEXT LEDGER                   
         BCT   R0,VALMOA57                                                      
         OI    OPTFLAG,OPTINLDG           INVALID LEGDER                        
         B     FVERR                                                            
*                                                                               
VALMOA58 TM    OPTSTAT,OPT2CHQ            2 CHAR OFFICE ONLY?                   
         BNO   VALMOA59                                                         
         TM    COMPSTA4,CPYSOFF2          2 CHAR OFFICE COMPANY?                
         BNO   FVERR                                                            
*                                                                               
VALMOA59 TM    OPTSTAT,OPTDDSQ            DDS ONLY?                             
         BNO   VALMOA65                                                         
         CLI   TWAOFFC,C'*'                                                     
         BE    VALMOA65                                                         
*                                                                               
*-------------------------*                                                     
* VALIDATE THE DATE RANGE *                                                     
*-------------------------*                                                     
VALMOA65 SR    RF,RF                                                            
         ICM   RF,3,OPTVAL                                                      
         LA    RF,T62000(RF)       RF=A(OPTION VALIDATION/SAVE ROUTINE)         
         L     R1,AOPTVALS                                                      
         SR    RE,RE                                                            
         ICM   RE,3,OPTVALUE                                                    
         AR    R1,RE               R1=A(OPTION SAVE ADDRESS)                    
         BASR  RE,RF                                                            
         BNE   FVERR                                                            
*                                                                               
VALMOA90 OI    FLDOIND,FOUTTRN                                                  
         OI    FLDIIND,FINPVAL                                                  
VALMOAX  MVI   FVINDX,0                                                         
         MVC   SVBASMOA,BASMOA                                                  
*                                                                               
         DROP  R2,R3                                                            
         EJECT                                                                  
***********************************************************************         
* CHECK WHETHER DISPLAY IS STARTING/RESTARTING. IF SO INITIALISE      *         
* TSAR AND RELATED VARIABLES                                          *         
***********************************************************************         
FSTIN    CLI   DISPFLAG,0                 START OR RESTART ?                    
         BNE   FSTIN10                    . RESTART, SKIP                       
         NI    GMSGFLG,X'FF'-GMSG1        RESET GRID MESSAGE                    
*--------------                                                                 
* CHECK LEDGER                                                                  
*--------------                                                                 
         L     R3,AACTENT                 ACTION TABLE ENTRY                    
         AR    R3,RB                                                            
         USING ACTTABD,R3                                                       
         TM    ACTAUTH2,ACT2ALLQ                                                
         BO    FSTIN02                                                          
         TM    ACTAUTH2,ACT2NULQ                                                
         BO    FSTIN02                                                          
         TM    ACTAUTH2,ACT2ULTQ                                                
         BO    FSTIN02                                                          
*                                                                               
         LA    R2,BASKEYH                 R2=A(ACTION FIELD HEADER)             
         ST    R2,FVADDR                                                        
         MVC   WORK,BASKEY                                                      
*                                                                               
         GOTO1 ATSTUL,ACTAUTH2            TEST U/L                              
         BE    *+14                                                             
         MVC   FVMSGNO,=AL2(AE$INULA)     INVALID U/L FOR ACTION                
         B     FVERR                                                            
*--------------------                                                           
* CHECK CONTRA ORDER                                                            
*--------------------                                                           
FSTIN02  TM    COMPSTA4,CPYSOFF2          2 CHAR OFFICE?                        
         BZ    FSTI05                     . NO, SKIP                            
         MVI   CORDFLAG,0                                                       
* TURN OFF RESTART READUP, READ25, AND RESTART LOCAL ROUTINE                    
         NI    IOMAXSW,X'FF'-(IOMRRDUP+IOMRRD25+IOMRLOCL)                       
         TM    ACTAUTH,ACTCORDQ           CONTRA ORDER ALL LOGONS?              
         BO    FSTI04                                                           
         TM    ACTAUTH,ACTCOROQ           CONTRA ORD RESTRICTD LOGON?           
         BZ    FSTI05                                                           
         CLI   TERMACCS,C'*'              LIMIT ACCESS?                         
         BE    FSTI04                                                           
         CLI   TERMACCS,C'$'                                                    
         BNE   FSTI05                                                           
         DROP  R3                                                               
*                                                                               
FSTI04   MVI   CORDFLAG,CORDMODQ+CORDFSTQ CONTRA ORDER MODE                     
*--------------------------                                                     
* TSAR AND TEMPEST TEMPSTR                                                      
*--------------------------                                                     
FSTI05   XC    HLPBLK(HLPBLKL),HLPBLK RESET HELP VARIABLES                      
         MVI   BLOKEYN,0                  NUMBER OF COLUMNS IN KEY              
         MVI   OVRSTAT,0                  OVERLAY STATUS                        
         MVI   GRXTLNS,0                  GRID EXTRA TITLE LINES                
         MVI   HORNDIS,0                  NUMBER OF DISPLAYED COLUMNS           
         MVI   HORIDIS,0                  INDEX  TO DISPLAYED COLUMNS           
         MVI   SCRLLADJ,0                 SCROLL ADJUSTMENT                     
*                                                                               
*                                         CLEAR TSAR COUNTS AREA: I.E.          
*                                         . TS2FIRST, TSNEXTST,                 
*                                         . TSCURRNO, TSLSTLIN,                 
*                                         . TSLSTREC, TEMPBLKN                  
         XC    TSCOUNTA(TSCOUNTQ),TSCOUNTA                                      
         MVC   TSNEXTST,=H'1'             TSAR REC# FOR NEXT DISP START         
         MVC   TSCURRNO,=H'1'             TSAR REC# FOR CURR DISP LINE          
*        NI    TWAMODE,TWAMRSRA+TWAMTIA                                         
*                                         TURN OFF RESTORE SWITCHES             
         NI    TWAMODE,TURNOFF-TWAMRST1-TWAMRST2                                
         MVI   TEMPSPAG,1                 TEMPSTR PAGE 1                        
         L     R0,ATEMPBLK                CLEAR TEMPBLOCK                       
         LHI   R1,L'TEMPBLK                                                     
         SR    RE,RE                                                            
         LA    RF,0                                                             
         SLL   RF,24                                                            
         MVCL  R0,RE                                                            
*                                                                               
         USING TSARD,R1                   R1=A(TSAR BLOCK)                      
FSTIN10  L     R1,ATSARBLK                -> TSAR BLOCK                         
         L     R0,ATSARREC                                                      
         ST    R0,TSAREC                  SET A(RECORD)                         
         MVC   TSACOM,ACOMFACS            SET A(COMFACS)                        
         MVI   TSKEYL,TSARKEYL            SET KEY LENGTH                        
         MVC   TSRECL,=Y(TSARRECL)        SET MAXIMUM LENGTH OF RECORD          
         OI    TSRECI,TSRVAR              VARIABLE RECORD LENGTHS               
         MVI   TSINDS,TSIALLOC+TSIRTNAF   RETURN IF ALLOCATION FAILS            
         MVI   TSPAGN,TSPEXPN             SET NUMBER OF TEMPSTR C/I'S           
*                                                                               
         TM    TWAMODE,TWAMGOT1       TSAR 1 PREVIOUSLY INITIALIZED?            
         BZ    FSTIN40                . NO,  CONTINUE                           
*                                     . YES, USE PREVIOUS ALLOCATIONS           
         MVC   TSINDS,TWATSAR1        SET INDICATORS                            
         OI    TSINDS,TSIREUSE        SET TO RE-USE PREVIOUS ALLOCATION         
         MVC   TSPAGL,TWALOWP1        SET LOW PAGE NUMBER                       
         MVC   TSPAGN,TWANUMP1        SET NUMBER OF PAGES ALLOCATED             
*                                                                               
FSTIN40  MVI   TSACTN,TSAINI          SET INITIALISE                            
         TM    TWAMODE,TWAMRST1       RESTORE 1ST TSAR?                         
         BZ    *+8                    . NO, CONTINUE                            
         MVI   TSACTN,TSARES          SET RESTORE                               
         GOTO1 VTSAR                  CALL TO INITIALISE/RESTORE                
         BE    FSTIN50                OK, CONTINUE                              
         TM    TWAMODE,TWAMGOT1       TEST FIRST TIME ALLOCATION                
         BZ    *+6                    . YES, CONTINUE                           
         DC    H'0'                   KILL IF RESTORE (INITIALISED)             
*                                                                               
         MVC   FVMSGNO,=AL2(AE$ISUTS)                                           
         TM    CORDFLAG,CORDMODQ   CONTRA ORDER DISPLAY FOR 2 CHAR OFF?         
         BO    FVERR                                                            
*                                     CAN'T GET TEMPEST 'A' TRY TEMPSTR         
         NI    TSINDS,255-TSIALLOC-TSIRTNAF                                     
         MVI   TSPAGL,2               SET TO USE TEMPSTR PAGES 2-4              
         MVI   TSPAGN,3                                                         
         BASR  RE,RF                  INITIALISE TEMPSTR PAGES                  
         BE    FSTIN50                                                          
         DC    H'0'                   CAN'T INITIALISE TEMPSTR                  
*                                                                               
FSTIN50  MVC   TWALOWP1,TSPAGL        SAVE LOW TSAR PAGE NUMBER                 
         MVC   TWANUMP1,TSPAGN        SAVE NUMBER OF PAGES ALLOCATED            
         MVC   TWATSAR1,TSINDS        SAVE TEMPSTR/TEMPEST INDICATOR            
*        NI    TWATSAR1,TSIALLOC                                                
         NI    TWATSAR1,TSIALLOC+TSIRTNAF                                       
*                                  TURN ON RESTORE TSAR 1 NEXT TIME AND         
*                                  TSAR 1 WAS GOTTEN (INITIALIZED)              
         OI    TWAMODE,TWAMRST1+TWAMGOT1                                        
         OI    TWAMODE,TWAMSAV1       NEED TO SAVE FIRST TEMPEST BUFF           
*                                                                               
         TM    TWATSAR1,TSIALLOC      USING TEMPEST ON 1ST TSAR BUFFER?         
         BZ    FSTIN55                . NO,  SKIP TSAR 'B'                      
         TM    TWAMODE,TWAMRST2       RESTORE 2ND TSAR BUFFER ?                 
         BZ    FSTIN55                . NO,  SKIP TSAR 'B'                      
*                                     RESTORE TSAR 'B'                          
         L     R1,ATSARBKB            TSAR BLOCK  'B'                           
         L     R0,ATSARREC            TSAR RECORD AREA                          
         ST    R0,TSAREC              SET A(RECORD)                             
         MVC   TSACOM,ACOMFACS        SET A(COMFACS)                            
         MVI   TSKEYL,TSARKEYL        SET KEY LENGTH                            
         MVC   TSRECL,=Y(TSARRECL)    SET MAXIMUM LENGTH OF RECORD              
         OI    TSRECI,TSRVAR          VARIABLE RECORD LENGTHS                   
*                                     NOTE: THE ONLY WAY TO RESTART THE         
*                                       2ND TSAR BUFFER IS IF IT WAS            
*                                       ALREADY GOTTEN                          
         MVC   TSINDS,TWATSAR2        SET INDICATORS                            
         OI    TSINDS,TSIREUSE        SET TO RE-USE PREVIOUS ALLOCATION         
         MVI   TSIND2,TSI2BUF2        USE TSAR BUFFER B                         
         MVC   TSPAGL,TWALOWP2        SET LOW PAGE NUMBER                       
         MVC   TSPAGN,TWANUMP2        SET NUMBER OF PAGES ALLOCATED             
*                                                                               
         MVI   TSACTN,TSARES        SET  RESTORE                                
         GOTO1 VTSAR                CALL TO RESTORE THE 2ND TSAR BUFFER         
         BE    *+6                  OK,  CONTINUE                               
         DC    H'0'                 CANNOT RESTORE THE 2ND TSAR BUFFER          
*                                                                               
         MVC   TWALOWP2,TSPAGL        SAVE LOW TSAR PAGE NUMBER                 
         MVC   TWANUMP2,TSPAGN        SAVE NUMBER OF PAGES ALLOCATED            
         MVC   TWATSAR2,TSINDS        SAVE TEMPEST INDICATOR                    
         NI    TWATSAR2,TSIALLOC+TSIRTNAF                                       
*                                  TURN ON RESTORE TSAR 2 NEXT TIME AND         
*                                  TSAR 2 WAS GOTTEN (INITIALIZED)              
         OI    TWAMODE,TWAMRST2+TWAMGOT2                                        
         OI    TWAMODE,TWAMSAV2       NEED TO SAVE SECOND TEMPEST BUFF          
*                                                                               
FSTIN55  TM    TWAMODE,TWAMRST2       ANY SECOND TSAR AREA ?                    
         BO    *+10                   . YES, SKIP                               
         MVC   TS2FIRST,=H'0'         CLEAR 1ST KEY ON 2ND TSAR BUFFER          
*--------------------                                                           
* OFFICE INFORMATION                                                            
*--------------------                                                           
         USING OFFALD,R1                                                        
         L     R1,AOFFBLK2            GET LIST OF ALL OFFICES FIRST             
         MVI   OFFACTRL,OFFACCNV                                                
         MVC   OFFACOMF,ACOMFACS                                                
         MVC   OFFATSAR,VTSAR                                                   
         MVC   OFFAALPH,TWAAGY                                                  
         MVC   OFFAAUTH,TWAAUTH                                                 
         MVC   OFFACPY,MYCO                                                     
         MVC   OFFACST1(OFFAOPOS-OFFACST1),COMPSTA1                             
         MVI   OFFAACT,OFFAINI                                                  
         OI    OFFAINDS,OFFAISEC+OFFAIOFF                                       
         GOTO1 VOFFAL                                                           
         BNE   ERROFF              OFFAL ERROR                                  
*                                                                               
         L     R1,AOFFBLK          OFFICES ALLOWED UNDER LIMITED ACCESS         
         MVI   OFFACTRL,OFFACCNV                                                
         MVC   OFFACOMF,ACOMFACS                                                
         MVC   OFFATSAR,VTSAR                                                   
         MVC   OFFAALPH,TWAAGY                                                  
         MVC   OFFAAUTH,TWAAUTH                                                 
         MVC   OFFACPY,MYCO                                                     
         MVC   OFFACST1(OFFAOPOS-OFFACST1),COMPSTA1                             
         MVC   OFFALIMA,TWAACCS                                                 
         MVI   OFFAACT,OFFAINI                                                  
         OC    OFFASAV(OFFASAVL),TWAOFFSV                                       
         BZ    *+8                                                              
         MVI   OFFAACT,OFFARES                                                  
         OI    OFFAINDS,OFFAISEC+OFFAIOFF                                       
         GOTO1 VOFFAL                                                           
         BNE   ERROFF              OFFAL ERROR                                  
         MVC   TWAOFFSV,OFFASAV    SAVE SETTINGS                                
*                                                                               
         TM    COMPSTA4,CPYSOFF2   NOT SUPPORTED FOR OLD OFFICES                
         BZ    FSTINX                                                           
*                                                                               
         USING OPTVALSD,R2                                                      
         L     R2,AOPTVALS                                                      
         OC    OOFFICVL,OOFFICVL   OFFICE LIST OVERRIDE?                        
         BZ    FSTINX              NO                                           
         CLI   OOFFICFI,NEGFILTR   NEGATIVE FILTER?                             
         BNE   FSTINX                                                           
*-----------------------------------------------------------------              
* IF A NEGATIVE OFFICE FILTER, THEN CHANGE TO A POSITIVE FILTER BY              
*    ERASING UNWANTED OFFICES FROM OFFICE LIST                                  
*-----------------------------------------------------------------              
         L     R1,AOFFBLK          LIMITED ACCESS                               
         CLI   LDGTOFFP,LDGOTRAN   OFFPOS=T?                                    
         BE    *+8                 . YES                                        
         L     R1,AOFFBLK2         . NO, THEN USE ALL OFFICES                   
*                                                                               
         MVI   OOFFICFI,C' '       TURN OFF NEG FILT                            
         SR    R0,R0                                                            
         ICM   R0,3,OFFAWORK       # OF OFFICE CODES IN ACCESS LIST             
         LA    R4,OFFAWORK+2                                                    
         SR    RE,RE                                                            
         ICM   RE,3,OOFFICLS       # OF OFFICE CODES IN OFF FILT LIST           
         LA    RF,OOFFICLS+2                                                    
*                                                                               
FSTIN60  CLC   0(L'TRNKOFF,R4),0(RF)   IS THIS OFFICE WANTED?                   
         BE    FSTIN66                   NO                                     
         LA    RF,L'TRNKOFF(RF)    BUMP TO NEXT OFFICE FILT                     
         BCT   RE,FSTIN60                                                       
FSTIN62  SR    RE,RE                                                            
         ICM   RE,3,OOFFICLS                                                    
         LA    RF,OOFFICLS+2                                                    
         LA    R4,L'TRNKOFF(R4)    BUMP TO NEXT OFFICE                          
         BCT   R0,FSTIN60                                                       
         B     FSTIN70                                                          
FSTIN66  MVC   0(2,R4),SPACES      ERASE OFFICE FROM ACCESS LIST                
         B     FSTIN62                                                          
*                                                                               
FSTIN70  LA    R0,OFFAWORK         CONV POS FILT OFFAWORK TO OOFFICLS           
         LA    R1,L'OOFFICLS                                                    
         LA    RE,OOFFICLS                                                      
         LR    RF,R1                                                            
         MVCL  RE,R0               COPY OFFAWORK TO OOFFICLS                    
*                                                                               
FSTINX   DS    0H                                                               
         DROP  R1,R2                                                            
         EJECT                                                                  
***********************************************************************         
* VALIDATE PFKEY                                                      *         
***********************************************************************         
VALPFK   MVI   PFKEY,0                                                          
         TM    HLPFLAG,HLPSCRN           SCREEN IN HELP FORMAT?                 
         BO    VALPFX                    YES-IGNORE AND TREAT AS ENTER          
         L     R1,AINP                   R1=A(TRANSLATOR I/O BLOCK)             
         ICM   RF,1,TIOBAID-TIOBD(R1)    ANY PF KEY PRESSED?                    
         BZ    VALPFX                                                           
         STC   RF,PFKEY                                                         
*-----------------------------------                                            
* GLOBBERED FROM INPUT                                                          
*-----------------------------------                                            
         TM    TWAFLG1,TWAFRINP          TEST GLOBBER FROM INPUT                
         BZ    VALPF08                                                          
         CLI   PFKEY,PF6                                                        
         BNE   VALPF08                                                          
         LA    R3,TEMP                                                          
         USING GLVXCTLD,R3                                                      
         XC    GLVXCTLD(GLVXLENQ),GLVXCTLD                                      
         MVI   GLVXCODE,GLVXCODQ         SET RETURN TO $INPUT                   
         MVI   GLVXLEN,GLVXLENQ                                                 
         MVC   GLVXFRSY,=C'ACC'                                                 
         MVC   GLVXFRPR,=C'FIS'                                                 
         MVC   GLVXTOSY,=C'ACC'                                                 
         MVC   GLVXTOPR,=C'INP'                                                 
         MVC   GLVXSESR,TWASESSR                                                
         OI    GLVXFLG1,GLV1RETN+GLV1SEPS+GLV1SIDR                              
         NI    TWAFLG1,X'FF'-TWAFRINP                                           
         L     R4,ACOMFACS                                                      
         USING COMFACSD,R4                                                      
         GOTO1 CGLOBBER,DMCB,=C'PUTD',GLVXFRSY,22,GLVXCTL                       
         CLI   8(R1),0                                                          
         JE    XIT                                                              
         B     VALPFX                    IGNORE, TREAT AS ENTER                 
         DROP  R3,R4                                                            
*-----------------------------------                                            
* VALIDATE PFKEY WITH ACTION                                                    
*-----------------------------------                                            
         USING PFKTABD,R3                                                       
VALPF08  L     R3,APFKTAB                R3=A(PFK TABLE)                        
VALPF10  CLI   0(R3),EOT                 END OF TABLE?                          
         BNE   *+12                                                             
VALPF15  MVI   PFKEY,0                   IGNORE AND TREAT AS ENTER              
         B     VALPFX                                                           
         CLC   PFKNUM,PFKEY              MATCH ON PFKEY?                        
         BNE   VALPF26                                                          
         LA    RF,PFKACTNS               RF=A(ACTIONS VALID W/ PFKEY)           
VALPF20  CLI   0(RF),EOT                 END OF TABLE?                          
         BE    VALPF26                                                          
         CLC   SVACTNUM,0(RF)            MATCH ON ACTION?                       
         BE    VALPF30                                                          
         LA    RF,1(RF)                  BUMP UP ACTION LIST                    
         B     VALPF20                                                          
VALPF26  LA    R3,PFKTABL(R3)            BUMP UP PFK TABLE                      
         B     VALPF10                                                          
*                                                                               
VALPF30  TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BZ    VALPF35                                                          
         TM    PFKINDS,PFKNGRDQ          TEST IF NOT VALID FOR GRID             
         BO    VALPF26                   . YES - NEXT ENTRY                     
         B     *+12                                                             
VALPF35  TM    PFKINDS,PFKGRONQ          TEST IF GRIDS ONLY                     
         BO    VALPF26                   . YES - NEXT ENTRY                     
*                                                                               
         TM    PFKINDS,PFKOFF2Q          PFKEY FOR 2 CHAR OFFICES ONLY          
         BZ    *+12                      . NO, NO NEED TO CHECK                 
         TM    COMPSTA4,CPYSOFF2         TWO CHAR OFFICE FILE?                  
         BZ    VALPF26                   . NO, NOT SUPPORTED                    
*-----------------------------------                                            
* RETURN TO LIST AND SELECT                                                     
*-----------------------------------                                            
         TM    PFKINDS,PFKRTNLI          PFKEY RETURN TO LS REC?                
         BZ    VALPF45                   . NO - CONTINUE                        
         TM    LSTINDS,LSTISUB           SELECTED BY LS SUBACT?                 
         BO    *+12                                                             
         MVI   PFKEY,0                   . NO - IGNORE, TREAT AS ENTER          
         B     VALPFX                                                           
         NI    LSTINDS,LSTIMLT           RE-SET                                 
         CLI   PFKEY,PF12                                                       
         BNE   *+12                                                             
         MVI   LSTINDS,0                                                        
         B     VALPF42                                                          
         TM    LSTINDS,LSTIMLT                                                  
         BZ    *+8                                                              
         OI    LSTINDS,LSTINXT           SET NEXT PFKEY PRESSED                 
VALPF42  OI    LSTINDS,LSTIRTN                                                  
*                                                                               
         L     R1,AINP                   R1=A(TRANSLATOR I/O BLOCK)             
         MVI   TIOBAID-TIOBD(R1),0       SET NO PFKEY PRESSED                   
         L     R1,ASVSES                 R1=A(SAVED SESSION)                    
         USING SESD,R1                                                          
         LA    R2,BASKEYH                RESTORE CURRENT SESSION                
         USING FLDHDRD,R2                                                       
         MVC   FLDDATA(L'BASKEY),SESKEYF KEY FIELD                              
         MVC   FLDILEN,SESKEYFL                                                 
         OI    FLDOIND,FOUTTRN                                                  
         NI    FLDIIND,X'FF'-FINPVAL                                            
         LA    R2,BASOPTH                                                       
         MVC   FLDDATA(L'BASOPT),SESOPTF OPTION FIELD                           
         MVC   FLDILEN,SESOPTFL                                                 
         LA    R2,BASACTH                                                       
         MVC   FLDDATA(L'BASACT),SESACTF ACTION FIELD                           
         OI    FLDOIND,FOUTTRN                                                  
         NI    FLDIIND,X'FF'-FINPVAL                                            
         MVI   DISSTART,0                                                       
         MVI   SVACTNUM,0                                                       
*                                                                               
         TM    LSTINDS,LSTINXT+LSTIMLT   TEST MULTIPLE SUB-ACTION?              
         BO    VALACT                    . YES-REVALIDATE ACTION FIELD          
         ST    R2,FVADDR                                                        
*                                                                               
         MVC   DMCB+20(2),=C'L='                                                
         MVC   DMCB+22(2),=Y(1024*14)                                           
         GOTO1 VDATAMGR,DMCB,DMREAD,TEMPSTR,(TEMPSPAG,0),ATIA                   
         CLI   8(R1),0                                                          
         BE    VALACT                    RESTORE PREV. SESSION                  
         DC    H'0'                      CAN'T READ TEMPSTR                     
         DROP  R1,R2                                                            
*-----------------------------------                                            
* PFKEY TO SWITCH ACTIONS                                                       
*-----------------------------------                                            
VALPF45  TM    PFKINDS,PFKSWACT          SWITCHING TO OTHER ACTION?             
         BZ    VALPFX                                                           
         LA    R5,PFKLDGN                LEDG/ACT/DISP TO PFKEY WORD 1          
         GOTO1 ATSTUL,(R5)               CHECK U/L                              
         BE    VALPF50                   . OK - VALID LEDGER                    
         LA    R5,PFKLDGN2               LEDG/ACT/DISP TO PFKEY WORD 2          
         GOTO1 ATSTUL,(R5)                                                      
         BE    VALPF50                                                          
         MVI   PFKEY,0                   . NO-IGNORE, TREAT AS ENTER            
         B     VALPFX                                                           
*                                                                               
VALPF50  MVC   BYTE1,1(R5)               SAVE NEW ACTION NUMBER                 
         SR    RF,RF                                                            
         ICM   RF,3,2(R5)                DISP. TO ACTION NAME                   
         LA    RF,WORKD(RF)                                                     
         MVC   HALF,0(RF)                ACTION NAME                            
         DROP  R3                                                               
*                                                                               
FROM     USING ACTTABD,R4                                                       
TO       USING ACTTABD,R5                                                       
         GOTO1 ACHKACT,DMCB,BASACT       CHECK FROM ACTION                      
         BNE   ERRNOTV                                                          
         L     R4,0(,R1)                 ACTION TABLE ENTRY                     
         GOTO1 ACHKACT,DMCB,HALF         CHECK TO ACTION                        
         BNE   ERRNOTV                                                          
         L     R5,0(,R1)                 ACTION TABLE ENTRY                     
         MVC   WORK,SPACES               PUT NEW KEY INTO WORK                  
         XC    FVADDR,FVADDR                                                    
*                                                                               
         TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BO    VALPF85                                                          
*                                                                               
         TM    FROM.ACTAUTH2,ACT2LSTQ    TEST LIST ENQUIRY?                     
         BNO   VALPF85                                                          
         TM    DISPFLAG,NORECQ           TEST ANY ITEMS TO DISPLAY?             
         BNO   *+12                                                             
         MVI   PFKEY,0                   . NO-IGNORE, TREAT AS ENTER            
         B     VALPFX                                                           
*                                                                               
         L     R1,AINP                   R1=A(TRANSLATOR I/O BLOCK)             
         SR    R2,R2                                                            
         ICM   R2,3,TIOBCURD-TIOBD(R1)                                          
         LA    R2,TWAD(R2)               R2=A(CURSOR)                           
         USING FLDHDRD,R2                                                       
         SR    RF,RF                                                            
         ICM   RF,1,DISSTART             RF=START POS FOR DATA DISPLAY          
         BNZ   *+12                      IF DISSTART HAS BEEN INIT.             
         MVI   PFKEY,0                   NO-IGNORE AND TREAT AS ENTER           
         B     VALPFX                                                           
         SHI   RF,1                                                             
         CLI   SVACTNUM,ACTNLSLT         LIST/SELECT ENQUIRY?                   
         BE    VALPF60                                                          
         MH    RF,=Y(ENQDAT3H-ENQDAT2H)                                         
         LA    RF,ENQDAT2H(RF)           RF=A(FIRST DATA FIELD)                 
         B     *+12                                                             
VALPF60  MH    RF,=Y(LSTACT3H-LSTACT2H)                                         
         LA    RF,LSTACT2H(RF)                                                  
         CR    R2,RF                     CURSOR ON THE DATA LINE?               
         BL    VALPF70                   . NO - ERROR                           
*                                                                               
         SR    RF,RF                                                            
         IC    RF,DISEND                 RF=END POS FOR DATA DISPLAY            
         CLI   SVACTNUM,ACTNLSLT         LIST/SELECT ENQUIRY?                   
         BE    VALPF65                                                          
         MH    RF,=Y(ENQDAT3H-ENQDAT2H)                                         
         LA    RF,ENQDAT2H(RF)           RF=A(LAST DATA FIELD)                  
         B     *+12                                                             
VALPF65  MH    RF,=Y(LSTACT3H-LSTACT2H)                                         
         LA    RF,LSTACT2H(RF)                                                  
         CR    R2,RF                     CURSOR ON THE DATA LINE                
         BL    VALPF75                   . YES - OK                             
*                                                                               
VALPF70  MVC   FVMSGNO,=AL2(AE$PCOL)     COPY PFKEY WORD FOR ERROR MESS         
         MVC   FVXTRA(ACTSHLNQ),HALF                                            
         LA    R2,BASKEYH                KEY HEADER FIELD                       
         ST    R2,FVADDR                 SET CURSOR TO KEY FIELD                
         B     FVERR                                                            
*                                                                               
VALPF75  LH    RE,=Y(ENQDAT3H-ENQDAT2H)                                         
         CLI   SVACTNUM,ACTNLSLT         LIST/SELECT ENQUIRY?                   
         BNE   VALPF80                                                          
         LH    RE,=Y(LSTDAT3H-LSTDAT2H)                                         
         SR    RF,RF                                                            
         IC    RF,FLDLEN                 LENGTH OF THIS FIELD                   
         CH    RF,=Y(LSTDAT2H-LSTACT2H)                                         
         BH    *+6                       DATA FIELD?                            
         AR    R2,RF                     .NO - INCREMENT TO DATA FIELD          
*                                                                               
VALPF80  CLI   FLDDATA,C' '              ANY ACCOUNT CODE?                      
         BH    *+10                                                             
         SR    R2,RE                                                            
         B     VALPF80                                                          
*                                                                               
         ST    R2,FVADDR           SET CURSOR TO THE DATA LINE                  
         CLI   FROM.ACTNUM,ACTNESTL    FROM ESTIMATE LIST?                      
         BNE   VALPF82                                                          
         MVC   WORK(L'EGNPNUM),FLDDATA                                          
         B     VALPF90                                                          
                                                                                
VALPF82  MVC   WORK(2),BASKEY                                                   
         MVC   WORK+2(L'ACTKACT),FLDDATA                                        
         TM    FROM.ACTAUTH2,ACT2NULQ    TEST U/L REQUIRED IN KEY FLD           
         BNO   *+10                                                             
         MVC   WORK(L'SPROUL),SPROUL     OTHERWISE MOVE IN SJ LEDGER            
         TM    FROM.ACTAUTH2,ACT2ULTQ  TEST U/L OF TSAR                         
         BZ    *+10                                                             
         MVC   WORK(L'ACTKULA),FLDDATA                                          
         B     VALPF90                                                          
*                                                                               
VALPF85  MVC   WORK(L'ACTKULA),BASKEY                                           
         TM    FROM.ACTAUTH2,ACT2NULQ    TEST U/L REQUIRED IN KEY FLD           
         BZ    VALPF90                   . YES - OK                             
         TM    TO.ACTAUTH2,ACT2NULQ      TEST U/L REQUIRED IN KEY FLD           
         BO    VALPF90                   . YES - OK                             
         MVC   WORK(L'SPROUL),SPROUL     OTHERWISE MOVE IN SJ LEDGER            
         MVC   WORK+2(L'ACTKACT),BASKEY                                         
         MVC   BASKEY(L'ACTKULA),WORK                                           
*                                                                               
VALPF90  GOTO1 ACHKKEY,DMCB,TO.ACTTABD   CHECK NEW KEY FIELD                    
         BE    VALPF95                                                          
         OC    FVADDR,FVADDR             HAS FVADDR BEEN SET?                   
         BNZ   FVERR                     . YES - OK                             
         ST    R2,FVADDR                  SET CURSOR TO KEY FIELD               
         B     FVERR                                                            
*                                                                               
VALPF95  MVC   BASACT(ACTSHLNQ),HALF     PUT NEW ACTION NAME IN                 
         MVC   SVACTNUM,BYTE1            SAVE NEW ACTION NUMBER                 
         MVC   LASTACT,CURRACT                                                  
         MVC   CURRACT,SVACTNUM                                                 
         B     SWCHACT                   SWITCH ACTION                          
*                                                                               
VALPFX   DS    0H                                                               
         DROP  R2,FROM,TO                                                       
         EJECT                                                                  
***********************************************************************         
* VALIDATE SCROLL FIELD.                                              *         
* IF KEY WORD ENTERED THEN MATCHING PFKEY SET                         *         
* IF NUMBER ENTERED THEN CORRESPONDING TSAR REC NUMBER SET            *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
VALSCROL TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BO    VALSCX              ALWAYS SCROLL A PAGE                         
*                                                                               
         LA    R2,ENQSCRLH                                                      
         ST    R2,FVADDR                                                        
         MVI   SCRLAMT,0           SCROLL AMOUNT QUANTITY                       
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,1,FLDILEN        RF=L'(SCROLLING ACTION)                      
         BZ    VALSC30                                                          
         LA    R3,FLDDATA          R3=A(START OF SCROLLING ACTION)              
         CLI   0(R3),C' '          IGNORE LEADING BLANKS                        
         BH    VALSC10                                                          
         LA    R3,1(R3)                                                         
         BCT   RF,*-12             AND REDUCE LENGTH ACCORDINGLY                
         B     VALSC30             ALL BLANK DEFAULT TO 'PAGE' AMOUNT           
*                                                                               
VALSC10  BCTR  RF,0                RF=EXCUTABLE LENGTH OF SCREEN FIELD          
         EX    RF,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R3),UP@HALF     SCROLL QUANTITY OF A HALF SCREEN?            
         BNE   VALSC20                                                          
         MVC   ENQSCRL,SPACES                                                   
         MVC   ENQSCRL(L'UP@HALF),UP@HALF                                       
         B     VALSC60                                                          
*                                                                               
VALSC20  EX    RF,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R3),UP@PAGE     SCROLL QUANTITY OF A FULL SCREEN?            
         BNE   VALSC40                                                          
         MVC   ENQSCRL,SPACES                                                   
VALSC30  MVC   ENQSCRL(L'UP@PAGE),UP@PAGE                                       
         B     VALSC60                                                          
*                                                                               
VALSC40  EX    RF,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R3),UP@MAX      MAXIMUM (ONLY VALID FOR LEFT AND UP)         
         BNE   VALSC50                                                          
         MVC   ENQSCRL,SPACES                                                   
         CLI   PFKEY,PF8                                                        
         BE    *+12                                                             
         CLI   PFKEY,PF10                                                       
         BNE   *+14                                                             
         MVC   ENQSCRL(L'UP@PAGE),UP@PAGE                                       
         B     *+10                                                             
         MVC   ENQSCRL(L'UP@MAX),UP@MAX                                         
         B     VALSC60                                                          
*                                                                               
VALSC50  LA    RF,1(RF)            RF=L'(SCROLL FIELD VALUE)                    
         GOTO1 VCASHVAL,DMCB,(C'N',(R3)),(RF)                                   
         CLI   0(R1),0                                                          
         BNE   ERRISCRL            INVALID AMOUNT                               
         L     R3,4(R1)            R3=(LINE NUM DISPLACEMENT)                   
         CURED (R3),(L'ENQSCRL,ENQSCRL),0,ALIGN=LEFT                            
*                                                                               
         CHI   R3,MAXSCROL                                                      
         BH    ERRIAMNT                                                         
         LTR   R3,R3                                                            
         BM    ERRIAMNT                                                         
         STC   R3,SCRLAMT                                                       
*                                                                               
VALSC60  OI    FLDOIND,FOUTTRN                                                  
*                                                                               
VALSCX   DS    0H                                                               
         EJECT                                                                  
***********************************************************************         
*        VALIDATE LIST SUB-ACTIONS - FOR LIST ENQUIRY ONLY            *         
***********************************************************************         
VALLST   CLI   SVACTNUM,ACTNLSLT   TEST LIST/SELECT ENQUIRY?                    
         BNE   VALLSTX                                                          
         LA    R2,BASKEYH                                                       
         TM    FLDIIND,FINPTHIS    HAS KEY FIELD BEEN INPUT THIS TIME?          
         BO    VALLSTX                                                          
         SR    R2,R2                                                            
         ICM   R2,1,DISSTART       START POSITION FOR DATA DISPLAY              
         BZ    VALLSTX             EXIT IF FIRST TIME IN                        
         SHI   R2,1                                                             
         MHI   R2,LSTACT3H-LSTACT2H                                             
         LA    R2,LSTACT2H(R2)     FIRST LIST SUB-ACTION LINE                   
         USING FLDHDRD,R2                                                       
         LHI   RE,LSTACT3H-LSTACT2H RE=LENGTH OF THIS LINE                      
         LA    RF,LSTACTLH              RF=LAST LIST SUB-ACTION LINE            
         MVI   BYTE2,0                                                          
*                                                                               
VLST10   LA    R1,HLPLST           R1=HELP FIELD NUMBER                         
         LR    R4,RE               SAVE RE,RF                                   
         LR    R5,RF                                                            
         BAS   RE,CHKHELP          SEE IF HELP WANTED                           
         BNE   FVERRX              IF HELP DISPLAYED EXIT                       
         LR    RE,R4               RESTORE RE,RF                                
         LR    RF,R5                                                            
         MVI   HLPFNO,0            ONLY ONE PAGE AVAIL. FOR SUBACTION           
*                                                                               
T        USING FLDHDRD,R4                                                       
         LA    R4,LSTDAT2H-LSTACT2H(R2)     R4=SCREEN DATA FIELD                
         CLC   T.FLDDATA(L'ACTKACT),SPACES  TEST ANY ACCOUNT CODE?              
         BH    VLST15                                                           
         MVC   FLDDATA(L'LSTACT2),SPACES    CLEAR FIELD                         
         OI    FLDOIND,FOUTPRT+FOUTTRN      PROTECT FIELD & TRANSMIT            
         B     VLST50                                                           
*                                                                               
VLST15   SR    R1,R1                                                            
         IC    R1,BYTE2                                                         
         LA    R1,1(,R1)                                                        
         STC   R1,BYTE2                     INCREMENT TSAR COUNTER              
         CLC   FLDDATA(L'LSTACT2),SPACES    ANY LIST SUB-ACTION?                
         BNH   VLST20                       NO-CHECK NEXT PFKEY ENTRED          
         CLI   FLDDATA,C'*'                                                     
         BE    VLST50                                                           
         B     VLST30                                                           
*                                                                               
VLST20   TM    LSTINDS,LSTIMLT+LSTINXT      TEST NEXT PFKEY PRESSED &           
         BZ    VLST50                       MULTIPLE SUBACT?                    
         L     R1,ASVSES                    A(SAVED SESSION)                    
         USING SESD,R1                                                          
         CLC   BYTE2,SESDISPL               DO WE WANT THIS LINE?               
         BNH   VLST50                                                           
         MVC   FLDDATA(ACTSHLNQ),SESSUB     VIEW THIS LINE                      
         DROP  R1                                                               
*                                                                               
VLST30   ST    R2,FVADDR                                                        
         MVC   FVMSGNO,=AL2(AE$INVIF)      INVALID INPUT FIELD                  
         CLC   FLDDATA(ACTSHLNQ),BASACT                                         
         BE    VLSTERR             ERROR - LOOPING TO ITSELF                    
         GOTO1 ACHKACT,DMCB,FLDDATA  CHECK ACTION                               
         BNE   VLSTERR                                                          
*                                                                               
         L     R3,0(,R1)           A(ACTION TABLE ENTRY)                        
         USING ACTTABD,R3                                                       
         GOTO1 ATSTUL,ACTAUTH2     TEST U/L                                     
         BE    *+14                                                             
         MVC   FVMSGNO,=AL2(AE$INULA)                                           
         B     VLSTERR             INVALID U/L FOR ACTION                       
*                                                                               
         MVC   TEMP(L'BASKEYH+L'BASKEY),BASKEYH    SAVE KEY FIELD               
*                                                                               
         MVC   WORK,SPACES                                                      
         MVC   WORK(2),BASKEY                                                   
         MVC   WORK+2(L'ACTKACT),T.FLDDATA                                      
         GOTO1 ACHKKEY,DMCB,ACTTABD  CHECK NEW KEY FIELD - WORK=NEW KEY         
         BE    VLST32                                                           
         TM    LSTINDS,LSTIMLT+LSTINXT      TEST NEXT PFKEY PRESSED &           
         BNO   VLSTERR                      MULTIPLE SUBACT?                    
         LHI   RE,LSTACT3H-LSTACT2H         RE=LENGTH OF THIS LINE              
         MVC   FLDDATA(ACTSHLNQ),SPACES                                         
         B     VLST50                                                           
*                                                                               
VLST32   CLI   FLDDATA+2,C' '                                                   
         BNH   VLST34                                                           
         CLI   FLDDATA+2,C'+'                                                   
         BNE   VLSTERR                                                          
         OI    LSTINDS,LSTIMLT     SET MULTIPLE SUBACT                          
*                                                                               
VLST34   MVC   HALF,FLDDATA        SAVE NEW ACTION TO FREE R2                   
         MVI   FLDDATA,C'*'                                                     
         MVC   FLDDATA+1(ACTSHLNQ),HALF                                         
         MVC   SVACTNUM,ACTNUM     SAVE A/C NUMBER FOR TSTOPT ONLY              
         MVC   LASTACT,CURRACT                                                  
         MVC   CURRACT,SVACTNUM                                                 
         DROP  R3                                                               
*                                                                               
         SR    R2,R2                                                            
         IC    R2,DISSTART         START POSITION FOR DATA DISPLAY              
         SHI   R2,1                                                             
         MHI   R2,LSTACT3H-LSTACT2H                                             
         LA    R2,LSTACT2H(R2)          R2=FIRST LIST SUB-ACTION LINE           
         LHI   RE,LSTACT3H-LSTACT2H     RE=LENGTH OF THIS LINE                  
         LA    RF,LSTACTLH              RF=LAST LIST SUB-ACTION LINE            
         L     R1,ASVSES                A(SAVED SESSION)                        
         LA    R3,SESSUBF-SESD(R1)      SUB-ACTION FIELDS                       
         SR    R1,R1                    TSAR RECORD COUNTER                     
*                                                                               
VLST36   MVC   0(L'SESSUBF,R3),FLDDATA     SAVE SUB-ACTION FIELDS               
         LA    R4,LSTDAT2H-LSTACT2H(R2)    R4=SCREEN DATA FIELD                 
         CLC   T.FLDDATA(L'ACTKACT),SPACES TEST ANY ACCOUNT CODE?               
         BNH   VLST38                                                           
         CLC   T.FLDDATA(L'LC@TOTAL),LC@TOTAL TEST FOR TOTAL                    
         BE    VLST38                                                           
         LA    R1,1(,R1)                   INCREMENT TSAR COUNTER               
VLST38   LA    R3,L'SESSUBF(,R3)                                                
         BXLE  R2,RE,VLST36                                                     
         DROP  R2,T                                                             
*                                                                               
         LH    RF,TSCURRNO         TSAR REC NO FOR NEXT DISPLAY LINE            
         SR    RF,R1               RF=TSAR REC NO FOR THE FIRST LINE            
*                                                                               
         L     R1,ASVSES           A(SAVED SESSION)                             
         USING SESD,R1                                                          
         MVC   SESDISPL,BYTE2      CURRENT LINE COUNTER                         
         TM    LSTINDS,LSTINXT+LSTIRTN  TEST RETURN BACK TO LS                  
         BNZ   VLST40                                                           
         STH   RF,SESCURNO         SAVE CURRENT TSAR RECORD                     
         MVC   SESSUB,HALF         SUB-ACTION                                   
         MVC   SESACTF,BASACT                                                   
         MVC   SESKEYF,TEMP+L'BASKEYH  KEY FIELD                                
         MVC   SESKEYFL,TEMP+5         LENGTH OF KEY FIELD                      
         MVC   SESOPTF,BASOPT                                                   
         MVC   SESOPTFL,BASOPTH+5                                               
         DROP  R1                                                               
*                                                                               
VLST40   MVC   BASACT(ACTSHLNQ),HALF                                            
         OI    LSTINDS,LSTISUB     LIST SUBACT USED                             
         NI    LSTINDS,X'FF'-LSTINXT                                            
         B     SWCHACT             RE-BUILD OPTIONS AND SWITCH ACTION           
*                                                                               
*--------------------------                                                     
VLST50   BXLE  R2,RE,VLST10                                                     
*--------------------------                                                     
         TM    LSTINDS,LSTIMLT+LSTINXT NEXT PFKEY PRESSED?                      
         BNO   VALLSTX                                                          
         MVI   FVOMTYP,INFOMSG     INFORMATION MESSAGE                          
         MVC   FVMSGNO,=AL2(AI$PSRES)                                           
         MVC   FVXTRA,SPACES                                                    
         MVC   FVXTRA(3),=C'...'                                                
VLSTERR  MVI   LSTINDS,0                                                        
         L     R1,ASVSES               A(SAVED SESSION)                         
         XC    0(SESLNQ,R1),0(R1)      CLEAR                                    
         B     FVERR                                                            
*                                                                               
VALLSTX  DS    0H                                                               
         EJECT                                                                  
***********************************************************************         
* PROCESS VERTICAL SCROLLING                                          *         
* IF NO PFKEY PRESSED USE DEFAULT PFKEY                               *         
* IF FIRST TIME FOR DISPLAY THEN USE DEFAULT PFKEY                    *         
***********************************************************************         
VSCROLL  TM    DISPFLAG,DISIOMAX                                                
         BO    VSCROLX                                                          
         TM    HLPFLAG,HLPRES                                                   
         BO    VSCROL90                                                         
         TM    DISPFLAG,NOTFRSTQ                                                
         BNO   *+12                                                             
         CLI   PFKEY,0                                                          
         BNE   *+8                                                              
         MVI   PFKEY,DEFLTPF       IF NO SCROLL PFKEY THEN USE DEFAULT          
*                                                                               
VSCROL05 CLI   PFKEY,PF7           UP DIRECTION                                 
         BE    VSCROL10                                                         
         CLI   PFKEY,PF8           DOWN DIRECTION                               
         BE    VSCROL15                                                         
         MVC   TSCURRNO,TSNEXTST                                                
         B     VSCROLX             PFKEY  FOR SCROLLING                         
*                                                                               
VSCROL10 NI    DISPFLAG,TURNOFF-DOWNQ                                           
         LA    R2,ENQSCRLH                                                      
         CLC   UP@PAGE,ENQSCRL                                                  
         BE    VSCROL40                                                         
         CLC   UP@HALF,ENQSCRL                                                  
         BE    VSCROL50                                                         
         CLC   UP@MAX,ENQSCRL                                                   
         BE    VSCROL55                                                         
         B     VSCROL60                                                         
*                                                                               
VSCROL15 OI    DISPFLAG,DOWNQ                                                   
         TM    DISPFLAG,TSARFULQ                                                
         BZ    VSCROL16                                                         
         CLC   TSLSTLIN,TSLSTREC   LAST RECORD CURRENTLY DISPLAYED?             
         BE    VSCROL90                                                         
VSCROL16 TM    DISPFLAG,ALLREADQ   * DOWN PAGE **                               
         BNO   VSCROL18            ALL RECORDS READ?                            
         CLC   TSLSTLIN,TSLSTREC   LAST RECORD CURRENTLY DISPLAYED?             
         BNE   VSCROL18                                                         
         LA    R2,1                                                             
         B     VSCROL80                                                         
*                                                                               
VSCROL18 TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BO    VSCROL20                                                         
*                                                                               
         LA    R2,ENQSCRLH                                                      
         CLC   UP@PAGE,ENQSCRL                                                  
         BE    VSCROL20                                                         
         CLC   UP@HALF,ENQSCRL                                                  
         BE    VSCROL30                                                         
         B     VSCROL35                                                         
*                                                                               
VSCROL20 SR    R2,R2               ** DOWN PAGE **                              
         ICM   R2,3,TSLSTLIN       TSAR REC AT BOTTOM OF CURRENT SCREEN         
         LA    R2,1(R2)                                                         
         B     VSCROL80                                                         
*                                                                               
VSCROL30 SR    RF,RF               ** DOWN HALF **                              
         IC    RF,DISEND                                                        
         SR    RE,RE                                                            
         IC    RE,DISSTART                                                      
         SR    RF,RE                                                            
         SR    RE,RE                                                            
         IC    RE,SCRLLADJ         ADJUSMENT FOR POSSIBLE INFO LINES            
         SR    RF,RE                                                            
         SRL   RF,1                                                             
         LA    RF,1(RF)                                                         
         STC   RF,LINEMAX          RF=(HALFWAY LINE NUMBER ON SCREEN)           
         BAS   RE,LOOKAHED         R2 SET BY 'LOOKAHED'                         
         B     VSCROL80                                                         
*                                  ** DOWN AN AMOUNT **                         
VSCROL35 SR    RF,RF                                                            
         IC    RF,SCRLAMT                                                       
         SR    R2,R2                                                            
         ICM   R2,3,TSNEXTST                                                    
         AR    R2,RF                                                            
         B     VSCROL80                                                         
*                                                                               
VSCROL40 SR    RF,RF               ** UP PAGE **                                
         IC    RF,DISEND                                                        
         SR    RE,RE                                                            
         IC    RE,DISSTART                                                      
         SR    RF,RE                                                            
         SR    RE,RE                                                            
         IC    RE,SCRLLADJ         ADJUSMENT FOR POSSIBLE INFO LINES            
         SR    RF,RE                                                            
         LA    RF,1(RF)                                                         
         STC   RF,LINEMAX                                                       
         BAS   RE,BACKTRCK         R2 SET BY 'BACKTRCK'                         
         B     VSCROL80                                                         
*                                                                               
VSCROL50 SR    RF,RF               ** UP HALF **                                
         IC    RF,DISEND                                                        
         SR    RE,RE                                                            
         IC    RE,DISSTART                                                      
         SR    RF,RE                                                            
         SR    RE,RE                                                            
         IC    RE,SCRLLADJ         ADJUSMENT FOR POSSIBLE INFO LINES            
         SR    RF,RE                                                            
         SRL   RF,1                                                             
         STC   RF,LINEMAX          RF=(HALFWAY LINE NUMBER ON SCREEN)           
         BAS   RE,BACKTRCK         R2 SET BY 'BACKTRCK'                         
         B     VSCROL80                                                         
*                                                                               
VSCROL55 LA    R2,1                ** MAX UP **                                 
         B     VSCROL80                                                         
*                                                                               
VSCROL60 SR    RF,RF               ** UP AN AMOUNT **                           
         IC    RF,SCRLAMT                                                       
         SR    R2,R2                                                            
         ICM   R2,3,TSNEXTST                                                    
         SR    R2,RF                                                            
         BP    VSCROL80                                                         
         LA    R2,1                                                             
         B     VSCROL80                                                         
*                                                                               
VSCROL80 STH   R2,TSNEXTST                                                      
         CLC   TSNEXTST,TSLSTREC                                                
         BH    VSCROL95                                                         
VSCROL90 MVC   TSCURRNO,TSNEXTST                                                
         MVI   HLPFLAG,0           RESET HELP FLAG                              
         B     VSCROLX                                                          
VSCROL95 SR    RF,RF                                                            
         ICM   RF,3,TSLSTREC                                                    
         TM    DISPFLAG,ALLREADQ                                                
         BO    *+8                                                              
         LA    RF,1(RF)                                                         
         STCM  RF,3,TSCURRNO                                                    
*                                                                               
VSCROLX  DS    0H                                                               
         EJECT                                                                  
***********************************************************************         
* CALL OVERLAY                                                        *         
***********************************************************************         
GO       GOTO1 VCALLOV,DMCB,(PHASE,0),0,0 GET ADDRESS OF OVERLAY                
         CLI   DMCB+4,X'FF'                                                     
         BNE   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         MVI   FVOMTYP,ERRORMSG          ERROR MESSAGE                          
         TM    DISPFLAG,NOTFRSTQ         FIRST TIME FOR DISPLAY?                
         BNO   GO10                                                             
         TM    DISPFLAG,DISIOMAX         RE-ENTER AFTER MAX IO?                 
         BZ    GO05                                                             
         NI    DISPFLAG,TURNOFF-DISIOMAX                                        
         TM    PCDRIVEN,PCGRIDQ          AND IF RUNNING UNDER GRIDS             
         BZ    *+10                      . NO                                   
GO05     MVC   DISLINE,DISSTART          SET LAST SCREEN LINE USED              
         MVC   IOKEY,KEYSAVE             RESTABLISH SEQUENCE                    
*                                                                               
         TM    DISPFLAG,NORECQ                                                  
         BO    GO15                                                             
GO10     L     RF,DMCB                                                          
         BASR  RE,RF                     GO TO OVERLAY                          
         BNE   GOX                       CC NOT EQUAL MEANS ERROR               
*                                                                               
         TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BO    GO15                                                             
         CLI   SVACTNUM,ACTNLSLT         TEST LIST/SELECT ENQUIRY?              
         BNE   GO15                                                             
         TM    LSTINDS,LSTIRTN           TEST RETURN BACK TO LS                 
         BZ    GO03                      . NO - OK                              
*                                                                               
         SR    R2,R2                                                            
         ICM   R2,1,DISSTART             START POS FOR DATA DISPLAY             
         BZ    GO03                      !!                                     
         SHI   R2,1                                                             
         MHI   R2,LSTACT3H-LSTACT2H                                             
         LA    R2,LSTACT2H(R2)           FIRST LIST SUB-ACTION LINE             
         USING FLDHDRD,R2                                                       
         LHI   RE,LSTACT3H-LSTACT2H                                             
         LA    RF,LSTACTLH               LAST LIST SUB-ACTION LINE              
         L     R1,ASVSES                 R4=A(SAVED CURRENT SESSION)            
         LA    R4,SESSUBF-SESD(R1)       SUB-ACTION FIELDS                      
*                                                                               
         MVC   FLDDATA(L'SESSUBF),0(R4)  RESTORE SUB-ACTION FIELDS              
         LA    R4,L'SESSUBF(,R4)                                                
         BXLE  R2,RE,*-10                                                       
*                                                                               
         OI    LSTINDS,LSTINCR           DON'T CLEAR SUB-ACTION FIELDS          
         TM    LSTINDS,LSTIMLT+LSTINXT   NEXT PFKEY PRESSED?                    
         BNO   *+12                                                             
         NI    LSTINDS,X'FF'-LSTIRTN                                            
         B     VALLST                    YES-REVALIDATE SUB-ACTION FLD          
         DROP  R2                                                               
*                                                                               
GO03     BRAS  RE,PROLSUB                PROTECT LIST SUB-ACTION FIELDS         
         MVI   LSTINDS,0                                                        
         L     R1,ASVSES                 A(SAVED SESSION)                       
         XC    0(SESLNQ,R1),0(R1)        CLEAR                                  
*                                                                               
GO15     LA    R2,BASKEYH                                                       
         ST    R2,FVADDR                                                        
         MVI   FVOMTYP,INFOMSG           INFORMATION MESSAGE                    
*                                                                               
         TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BZ    *+8                                                              
         OI    GMSGFLG,GMSG              SHOW GRID MESSAGE                      
*                                                                               
         TM    DISPFLAG,DISIOMAX                                                
         BZ    GO19                                                             
         TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BZ    GO18                                                             
         CLC   DISSTART,DISLINE                                                 
         BNE   GO19                                                             
         TM    GMSGFLG,GMSG1             SHOW GRID MESSAGE 1?                   
         BZ    GO18                                                             
         OI    GMSGFLG,GMSGP                                                    
         B     GO19                                                             
GO18     MVC   FVMSGNO,=AL2(IAMAXIO)     MAXIMUM IO HIT ENTER                   
         B     FVERR                                                            
*                                                                               
GO19     TM    DISPFLAG,NORECQ                                                  
         BNO   *+14                                                             
         MVC   FVMSGNO,=AL2(AI$NDFWP)    NO ITEMS TO DISPLAY                    
         B     GOX                                                              
         TM    DISPFLG2,DISMOMAX                                                
         BNO   *+14                                                             
         MVC   FVMSGNO,=AL2(IAOFFWRN)    NOT ALL OFFICE DISPLAYED               
         B     GOX                                                              
         TM    DISPFLG2,DISWCOVF                                                
         BNO   *+14                                                             
         MVC   FVMSGNO,=AL2(IAWCWRN)     TOO MANY WORK CODES                    
         B     GOX                                                              
         MVC   FVMSGNO,=AL2(IAIDINX)     ITEMS DISPLYED HIT ENTER               
         TM    DISPFLAG,DOWNQ            SCROLLING FORWARDS?                    
         BO    GO20                                                             
         CLC   TSNEXTST,=H'1'            ARE WE AT THE START?                   
         BNE   GOX                       CC EQUAL MEANS INFORMATION             
         MVC   FVMSGNO,=AL2(IASTART)                                            
         B     GOX                       CC EQUAL MEANS INFORMATION             
*                                                                               
GO20     TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BZ    *+8                                                              
         OI    GMSGFLG,GMSG              SHOW GRID MESSAGE                      
*                                                                               
         TM    DISPFLAG,ALLREADQ         HAVE ALL RECORDS BEEN READ?            
         BNO   GOX                                                              
         CLC   TSNEXTST,TSLSTREC         SCROLL START WAS PAST END?             
         BNH   *+10                                                             
         MVC   TSNEXTST,TSLSTREC         LAST TSAR REC WILL BE AT START         
         CLC   TSLSTLIN,TSLSTREC         IS LAST ONE BEING DISPLAYED?           
         BL    GOX                                                              
         MVC   FVMSGNO,=AL2(AI$RDDIS)    NO MORE ITEMS TO BE DISPLAYED          
         B     GOX                                                              
*                                                                               
GOX      TM    PCDRIVEN,PCGDATQ          TEST GRID ON?                          
         BZ    GOX10                                                            
         TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BO    GOX10                                                            
         MVC   FVXTRA(3),=C'...'         TELL PC GRID NO GRID DATA              
*                                                                               
GOX10    TM    DISPFLAG,NORECQ           TEST NO ITEMS TO DISPLAY               
         BZ    GOX20                                                            
         TM    GMSGFLG,GMSG              TEST SHOW GRID MESSAGE                 
         BZ    GOX20                                                            
         GOTO1 ASCRNCLR,DISSTART         CLEAR SCREEN                           
         B     FVERR                                                            
*                                                                               
GOX20    DS    0H                                                               
         TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRIDS                     
         BO    GOX25                                                            
         GOTO1 ASCRNCLR,DISLINE          CLEAR REST OF SCREEN                   
*                                                                               
GOX25    TM    GMSGFLG,GMSG              TEST SHOW GRID MESSAGE                 
         BZ    FVERR                                                            
*                                                                               
         TM    GMSGFLG,GMSG1             SHOW GRID MESSAGE 1?                   
         BO    *+14                                                             
         CLC   TSNEXTST,=H'1'            ARE WE AT THE START?                   
         BE    GOX40                                                            
         MVC   BASHEAD,SPACES                                                   
*-----------------------------------                                            
* HANDLE GRID PAGE LIMIT                                                        
*-----------------------------------                                            
         TM    GMSGFLG,GMSGP             SHOW GRID MESSAGE NEXTP?               
         BZ    GOX30                                                            
         MVC   BASHEAD(GRMSG3Q),GRMSG3                                          
         NI    GMSGFLG,TURNOFF-GMSGP                                            
         B     GOX39                                                            
GOX30    MVC   BASHEAD(GRMSG2Q),GRMSG2                                          
         SR    RF,RF                                                            
         ICM   RF,1,GRXTLNS              ANY EXTRA LINES NEEDED?                
         BZ    GOX38                     . NO                                   
         AHI   RF,GRSDOR                 ADD DEFAULT                            
         LA    RE,BASHEAD+GRM2DAT-GRMSG2 POINT TO DOR                           
         EDIT  (RF),(2,(RE)),ALIGN=LEFT,ZERO=NOBLANK                            
*                                                                               
GOX38    MVI   SHIPIND,2                                                        
         B     FVERRX                                                           
GOX39    MVI   SHIPIND,3                                                        
         B     FVERRX                                                           
*-----------------------------------                                            
* FIRST SCREEN GRID MESSAGE                                                     
*-----------------------------------                                            
GOX40    GOTO1 AGETEID,DMCB,0            GET ENQUIRY ID NUMBER                  
         L     RF,0(,R1)                                                        
         MVC   BASHEAD(GRMSG1Q),GRMSG1                                          
         MVC   BASHEAD+GRMEID-GRMSG1(L'EIDREF),0(RF)                            
         SR    RF,RF                                                            
         ICM   RF,1,GRXTLNS                                                     
         AHI   RF,GRSDOR                                                        
         LA    RE,BASHEAD+GRMDOR-GRMSG1  DOR                                    
         EDIT  (RF),(2,(RE)),ALIGN=LEFT,ZERO=NOBLANK                            
*                                                                               
         CLI   SVACTNUM,ACTNESTL    DON'T SUBTRACT GRSDAT FOR EL                
         BE    *+8                                                              
         AHI   RF,GRSDAT                 NUMBER OF FIELDS TO DATA               
*                                                                               
         LA    RE,BASHEAD+GRM1DAT-GRMSG1                                        
         EDIT  (RF),(2,(RE)),ALIGN=LEFT,ZERO=NOBLANK                            
*                                                                               
         OI    GMSGFLG,GMSG1                                                    
*                                                                               
         MVI   SHIPIND,1                                                        
         MVI   SHIPCNT,0                                                        
         B     FVERRX                                                           
**********************************************************************          
*        CHECK IF HELP REQUIRED                                      *          
* ON ENTRY R1=(FIELD NUMBER)                                         *          
*          R2=A(FIELD HEADER)                                        *          
* ON EXIT  CC EQUAL MEANS HELP NOT REQUIRED                          *          
* ON EXIT  CC UNEQUAL MEANS HELP WAS DISPLAYED                       *          
**********************************************************************          
         USING FLDHDRD,R2                                                       
*                                                                               
CHKHELP  LR    R0,RE                                                            
         LA    RF,L'UP@HELP-1      HELP- THE WORD?                              
         LA    RE,UP@HELP(RF)                                                   
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-12                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         CLC   UP@HELP(0),FLDDATA                                               
         BE    *+12                                                             
         CLI   FLDDATA,C'?'        HELP- THE QUESTION MARK?                     
         BNE   HLPX                                                             
         SR    RF,RF                                                            
         IC    RF,HLPFNO           GET CURRENT HELP FIELD NUMBER                
         CR    R1,RF               SAME HELP?                                   
         BE    *+14                                                             
         XC    HLPBLK(HLPBLKL),HLPBLK RESET HELP VARIABLES                      
         STC   R1,HLPFNO           SAVE HELP FIELD NUMBER                       
         BAS   RE,GETHELP          GET HELP                                     
         ST    R2,FVADDR                                                        
         LA    R2,BASACTH          R2=A(ACTION FIELD HEADER)                    
         OI    FLDIIND,FINPVAL                                                  
         B     HLPCALLX                                                         
*                                                                               
HLPX     B     XITEQ0E             HELP NOT REQUIRED                            
HLPCALLX B     XITNEQ0E            HELP HAS BEEN DISPLAYED                      
*                                                                               
         DROP  R2                                                               
         EJECT ,                                                                
***********************************************************************         
* DISPLAY HELP PANEL                                                  *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
         USING HLPTABD,R3                                                       
GETHELP  NTR1                                                                   
         TM    PCDRIVEN,PCGRIDQ                                                 
         BO    GETHX                                                            
*                                                                               
         L     R3,AHLPTAB          R3=A(HELP TABLE)                             
         SR    RE,RE                                                            
         ICM   RE,1,HLPSLEFT       NUMBER OF SCREENS LEFT (0 IF START)          
         BNZ   GETH70                                                           
*                                                                               
GETH10   CLI   HLPACTN,EOT         END OF TABLE ?                               
         BE    GETHX               NO, CONTINUE                                 
*                                  NO  HELP PANELS FOR THIS ACTION              
*                                                                               
         CLI   HLPFNO,HLPACT       FIELD NUMBER = ACTION ?                      
         BE    GETH15              YES, SKIP NEXT TEST                          
         CLI   HLPFNO,HLPSCRL      FIELD NUMBER = SCROLL ?                      
         BNE   GETH20              NO,  CONTINUE                                
*                                                                               
GETH15   CLI   HLPACTN,NULLACTQ    NULL ACTION ENTRY ?                          
         BNE   GETH60              NO,  NEXT  HELP TABLE ENTRY                  
         B     GETH30              YES, FOUND HELP TABLE ENTRY                  
*                                                                               
GETH20   CLC   SVACTNUM,HLPACTN    MATCH ON ACTION ?                            
         BNE   GETH60              NO,  NEXT  HELP TABLE ENTRY                  
*                                                                               
GETH30   LA    RF,HLPPANS          RF=A(HELP PANELS LIST)                       
*                                                                               
         USING HLPPANS,RF          MAP  HELP PANELS BY TYPE & COUNTRY           
GETH40   CLI   HLPTYPE,EOT         END  OF TABLE ?                              
         BE    GETH60              YES, NEXT  HELP TABLE ENTRY                  
         CLC   HLPTYPE,HLPFNO      MATCH ON FIELD NUMBER ?                      
         BNE   GETH50              NO,  GET NEXT TYPE & COUNTRY ENTRY           
         CLI   HLPCTRY,CTRYALLQ    EVERY COUNTRY ?                              
         BE    GETH43              YES, CONTINUE                                
         CLC   HLPCTRY,AGYCTRY     MATCH ON COUNTRY ?                           
         BNE   GETH50              NO,  GET NEXT TYPE & COUNTRY ENTRY           
*                                                                               
GETH43   TM    HLPSTAT,HLPDDSQ     DDS  ONLY HELP ?                             
         BZ    GETH45              NO,  FOUND THE ENTRY                         
         CLI   TWAOFFC,C'*'        DDS  TERMINAL ?                              
         BNE   GETH50              NO,  FOUND THE ENTRY                         
*                                                                               
GETH45   ZIC   R3,HLPPANSL         GET  SIZE OF PANEL                           
         SHI   R3,HLPPANSQ         MINUS BASIC HELP PANEL LIST                  
         STC   R3,HLPSLEFT         SAVE NUMBER OF PAGES TO DISPLAY              
         BNP   GETHX               NONE, EXIT                                   
         LA    RF,HLPPAN           ->   HELP PANELS LIST                        
         STCM  RF,15,HLP@NPNL      SAVE ADDRESS OF NEXT PANEL ADDRESS           
         CLI   0(RF),0             1ST  PANEL NUMBER ZERO ?                     
         BE    GETHX               YES, EXIT                                    
         B     GETH70              PROCESS THE ENTRY                            
*                                                                               
GETH50   IC    RE,HLPPANSL         GET LENGTH OF TYPE & COUNTRY ENTRY           
         AR    RF,RE               BUMP TO NEXT TYPE & COUNTRY ENTRY            
         B     GETH40              TEST NEXT ENTRY                              
         DROP  RF                                                               
*                                                                               
GETH60   IC    RE,HLPLN            GET  THIS ACTION ENTRY LENGTH                
         AR    R3,RE               ->   NEXT ACTION ENTRY                       
         B     GETH10              TEST NEXT ENTRY                              
         DROP  R3                                                               
*                                                                               
         USING HELPKEYD,R3                                                      
GETH70   LA    R3,TEMP             R3=A(TEMP WORK AREA)                         
         ICM   RE,15,HLP@NPNL      RE=A(NEXT HELP PANEL ADDRESS)                
         MVC   GTHPAGN,0(RE)       PAGE NUMBER                                  
         MVC   GTHFLDN,HLPFNO      FIELD NUMBER                                 
         MVI   GTHSYSN,X'06'       ACCOUNTS SYSTEM                              
         MVI   GTHPGMN,X'20'       ENQUIRY PROGRAM                              
         MVI   GTHSCRN,X'FF'       SCREEN NUMBER                                
         TM    HLPFLAG,HLPSCRN     SCREEN IS IN HELP FORMAT ?                   
         BO    GETH80              YES, SKIP                                    
         L     R0,ASVSCRN          ->        SAVE/RESTORE SCREEN AREA           
         LA    R1,L'SVSCRN         LENGTH OF SAVE/RESTORE SCREEN AREA           
         LR    RF,R1                                                            
         TM    PCDRIVEN,PCGRIDQ                                                 
         BZ    GETH75                                                           
         LA    RE,GRDDAT1H         SAVE FROM 1ST DATA AREA                      
         MVC   GRDPFA,SPACES                                                    
         MVCL  R0,RE               SAVE HELP AREA OF SCREEN                     
         LA    R4,GRDDAT1H         SAVE FROM 1ST DATA AREA                      
         B     GETH80                                                           
GETH75   LA    RE,ENQDAT1H         SAVE FROM 1ST DATA AREA                      
         MVC   ENQPFA,SPACES                                                    
         MVCL  R0,RE               SAVE HELP AREA OF SCREEN                     
         LA    R4,ENQDAT1H         SAVE FROM 1ST DATA AREA                      
*                                                                               
GETH80   GOTO1 VGETHELP,DMCB,('GHMKEYQ',HELPKEYD),(R2),(R4),0,0                 
         TM    16(R1),GHNONEQ      HELP PANEL FOUND ?                           
         BO    *+8                 NO, SKIP                                     
         OI    HLPFLAG,HLPSCRN     SET HELP DISPLAYED                           
*                                                                               
         ICM   RE,15,HLP@NPNL      ->   NEXT HELP PANEL ADDRESS                 
         LA    RE,1(,RE)                                                        
         STCM  RE,15,HLP@NPNL      ->   NEXT HELP PANEL ADDRESS                 
         ZIC   RE,HLPSLEFT         GET  NUMBER OF PAGES LEFT TO DISPLAY         
         SHI   RE,1                MINUS 1                                      
         STC   RE,HLPSLEFT         SAVE NUMBER OF PAGES LEFT TO DISPLAY         
         BNZ   GETHX               PAGES LEFT TO DISPLAY, THEN EXIT             
         MVC   BASACT,SVACTION     RESET SCREEN FIELDS                          
*----------------------------------------------------------------------         
* ALL PAGES DISPLAYED, SO END HELP                                              
*----------------------------------------------------------------------         
         CLI   HLPFNO,HLPKEY       RESTORE OLD KEY FIELD                        
         BNE   *+10                                                             
         MVC   BASKEY,SVKEY                                                     
         CLI   HLPFNO,HLPCONT      RESTORE OLD CONTRA FIELD                     
         BNE   *+10                                                             
         MVC   BASCAC,SVCONTRA                                                  
         CLI   HLPFNO,HLPOPT       RESTORE OLD OPTIONS                          
         BNE   *+10                                                             
         MVC   BASOPT,SVOPTION                                                  
         CLI   HLPFNO,HLPSCRL      RESTORE OLD SCROLL FIELD                     
         BNE   *+10                                                             
         MVC   ENQSCRL,SVSCROLL                                                 
         OI    FLDOIND,FOUTTRN     TRANSMIT FIELD                               
*                                                                               
         XC    HLPBLK(HLPBLKL),HLPBLK RESET HELP VARIABLES                      
*                                                                               
GETHX    B     XIT                                                              
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
* SWITCH ACTION AND REBUILD OPTION FIELD                              *         
*   - IF OPTIONS NOT VALID FOR THE NEW ACTION,                        *         
*     THEN REMOVE THEM FROM THE NEW OPTION FIELD                      *         
***********************************************************************         
SWCHACT  LA    R2,BASACTH                                                       
         USING FLDHDRD,R2                                                       
         OI    FLDOIND,FOUTTRN+FOUTMOD                                          
         NI    FLDIIND,X'FF'-FINPVAL                                            
*                                                                               
         LA    R2,BASOPTH          R2=A(OPTION SCREEN FIELD HEAD)               
         CLI   FLDILEN,0                                                        
         BE    SWCHACTX                                                         
         LA    R0,SCANBLK          CLEAR SCAN BLOCK                             
         LHI   R1,L'SCANBLK                                                     
         SR    RE,RE                                                            
         LA    RF,X'40'                                                         
         SLL   RF,24                                                            
         MVCL  R0,RE                                                            
         XC    TEMP,TEMP           SAVE NEW OPTIONS IN TEMP                     
*                                                                               
         LA    R0,L'SCANRHS                                                     
         GOTO1 VSCANNER,DMCB,((R0),(R2)),('MAXSCAN',SCANBLK),C',=  '            
         CLI   4(R1),0                                                          
         BH    *+12                                                             
         MVI   FLDILEN,0           SET TO NO OPTION                             
         B     SWACT70             ERROR???                                     
*                                                                               
         LA    R4,SCANBLK                                                       
         USING SCANBLKD,R4                                                      
         SR    R5,R5                                                            
         IC    R5,4(R1)            NUMBER OF OPTIONS                            
*                                                                               
         LA    R3,TEMP                                                          
SWACT20  MVI   OPTFLAG,OPTFSTP     FIRST PASS                                   
         BAS   RE,CHKOPT           CHECK OPTIONS                                
         BNE   SWACT40             DON'T SAVE IT IF NOT VALID                   
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,1,SCANLHSL       LENGTH OF OPTION NAME ON THE LEFT            
         BZ    SWACT40                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R3),SCANLHS                                                  
         LA    R3,1(RF,R3)                                                      
         MVI   0(R3),C'='                                                       
         ICM   RF,1,SCANRHSL      LENGTH OF OPTION NAME ON THE RIGHT            
         BZ    SWACT40                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   1(0,R3),SCANRHS                                                  
         LA    R3,1+1(RF,R3)                                                    
         MVI   0(R3),C','                                                       
         LA    R3,1(,R3)                                                        
*                                                                               
SWACT40  LA    R4,SCANBLKL(,R4)                                                 
         BCT   R5,SWACT20                                                       
*                                                                               
         MVI   FLDILEN,0                                                        
         CLC   TEMP,SPACES         ANY NEW OPTION                               
         BNH   SWACT70                                                          
         BCTR  R3,0                                                             
         MVI   0(R3),C' '          REMOVE LAST ','                              
         LA    RF,TEMP                                                          
         SR    R3,RF                                                            
         STC   R3,FLDILEN          SAVE NEW LENGTH                              
SWACT70  MVC   FLDDATA(L'BASOPT),TEMP  NEW OPTION FIELD                         
         OI    FLDOIND,FOUTTRN+FOUTMOD                                          
         NI    FLDIIND,X'FF'-FINPVAL                                            
SWCHACTX MVI   SVACTNUM,0          REMOVE A/C NUMBER                            
         B     VALACT              REVALIDATE THE ACTION                        
         DROP  R2,R4                                                            
         EJECT                                                                  
                                                                                
***********************************************************************         
* CHECK OPTION                                                        *         
* ON ENTRY R4=(CURRENT SCAN BLOCK)                                    *         
*          OPTSVAL ON - SET OPTVALUE                                  *         
* ON EXIT  CC EQUAL MEANS VALID OPTION                                *         
*          CC UNEQUAL MEANS INVALID OPTION WITH FVMSGNO SET           *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
CHKOPT   NTR1                                                                   
*                                                                               
CHKOPT10 L     R3,AOPTTAB                                                       
         USING OPTTABD,R3                                                       
CHKOPT20 CLI   0(R3),EOT           END OF OPTTAB?                               
         BE    CHKOPT50                                                         
         BRAS  RE,TSTOPT           CHECK OPTION TABLE ENTRY                     
         BE    CHKOPT30                                                         
         BL    CHKOPTL                                                          
*                                                                               
         SR    RF,RF                                                            
         IC    RF,OPTLN                                                         
         AR    R3,RF                                                            
         B     CHKOPT20            BUMP TO NEXT OPTION ENTRY                    
*                                                                               
CHKOPT30 CLC   SCANRHSL,OPTMAXL                                                 
         BNH   *+14                                                             
         MVC   FVMSGNO,=AL2(AE$FLDTL)                                           
         B     CHKOPTL             INPUT FIELD TOO LONG                         
         CLI   SCANRHSL,0                                                       
         BNE   *+14                                                             
         MVC   FVMSGNO,=AL2(AE$FLDTS)                                           
         B     CHKOPTL             INPUT FIELD TOO SHORT                        
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,3,OPTVAL                                                      
         LA    RF,T62000(RF)       RF=A(OPTION VALIDATION/SAVE ROUTINE)         
         XC    WORK,WORK           AVOID DUPLICATE OPTION ERROR                 
         LA    R1,WORK                                                          
         TM    OPTFLAG,OPTSVAL     DO WE WANT TO SET OPTVALUE?                  
         BZ    CHKOPT40                                                         
         L     R1,AOPTVALS                                                      
         SR    RE,RE                                                            
         ICM   RE,3,OPTVALUE                                                    
         AR    R1,RE               R1=A(OPTION SAVE ADDRESS)                    
CHKOPT40 BASR  RE,RF                                                            
         BNE   CHKOPTL                                                          
         B     CHKOPTX             VALID OPTION                                 
*                                                                               
CHKOPT50 CLI   SCANLHSL,OPTSHLNQ                                                
         BNE   CHKOPT60                                                         
         TM    OPTFLAG,OPTFSTP     TEST FIRST PASS?                             
         BNO   CHKOPT60                                                         
         NI    OPTFLAG,X'FF'-OPTFSTP                                            
         B     CHKOPT10                                                         
CHKOPT60 MVC   FVMSGNO,=AL2(AE$OPTNV)                                           
         TM    OPTFLAG,OPTINLDG    INVALID LEDGER?                              
         BO    CHKOPTL                                                          
         MVC   FVMSGNO,=AL2(AE$INVIF)                                           
         B     CHKOPTL                                                          
*                                                                               
CHKOPTX  B     XITEQ               SET CC EQUAL                                 
CHKOPTL  B     XITNEQ              SET CC NOT EQUAL                             
         EJECT                                                                  
*                                                                               
***********************************************************************         
* FIND  TOP TSAR REC THAT WILL FIT IN NEXT SCREEN DISPLAY             *         
* ON ENTRY  LINEMAX CONTAINS THE NUM OF SCREEN LINES TO GO FORWARD    *         
* ON EXIT   R2=(TSAR REC NUMBER AT TOP OF NEW DISPLAY)                *         
***********************************************************************         
LOOKAHED LR    R0,RE                                                            
         SR    R3,R3               R3=(NUM OF LINES USED BY TSAR RECS)          
         SR    R2,R2                                                            
         ICM   R2,3,TSNEXTST       R2=TSAR REC NUMBER AT TOP OF SCREEN          
         B     *+8                                                              
LOOKA10  LA    R2,1(R2)            R2=NEXT TSAR NUM                             
         SR    RE,RE                                                            
         ICM   RE,3,TSLSTLIN                                                    
         BZ    LOOKA20                                                          
         CR    R2,RE                                                            
         BL    *+10                                                             
         LR    R2,RE                                                            
         B     LOOKA30                                                          
         STCM  R2,3,TSCURRNO                                                    
         GOTO1 ATSARGET,TSCURRNO   GET TSAR RECORD                              
         BE    *+6                                                              
         DC    H'0'                                                             
         L     RE,ATSARREC                                                      
         SR    RF,RF                                                            
         IC    RF,TSARLINE-TSARRECD(RE) NO OF SCREEN LINES RECORD USES          
         AR    R3,RF               R3=(NO OF LINES FOR PREV TSAR RECS)          
         SR    RF,RF                                                            
         IC    RF,LINEMAX          RF=(MAX LINES FOR FULL SCREEN)               
         CR    R3,RF                                                            
         BNH   LOOKA10             IS SCREEN FULL?                              
         BCTR  R2,0                                                             
         CH    R2,TSNEXTST         SAME AS BEFORE?                              
         BNE   *+8                                                              
         LA    R2,1(R2)                                                         
         B     LOOKA30                                                          
LOOKA20  LA    R2,1                R2=TSAR NUM AT TOP OF NXT SCRN               
*                                                                               
LOOKA30  LR    RE,R0                                                            
         BR    RE                                                               
         EJECT ,                                                                
*                                                                               
***********************************************************************         
* FIND  TOP TSAR REC THAT WILL FIT IN PREVIOUS SCREEN DISPLAY         *         
* ON ENTRY  LINEMAX CONTAINS THE NUM OF SCREEN LINES TO GO BACK       *         
* ON EXIT   R2=(TSAR REC NUMBER AT TOP OF NEW DISPLAY)                *         
***********************************************************************         
*                                                                               
BACKTRCK LR    R0,RE                                                            
         SR    R3,R3               R3=LINE COUNT FOR PREV TSAR RECS             
         SR    R2,R2               R2=TRAR REC NUMBER AT TOP OF SCRN            
         ICM   R2,3,TSNEXTST                                                    
BACKTR10 SHI   R2,1                R2=PREVIOUS TSAR NUM                         
         BNZ   *+12                                                             
         LA    R2,1                                                             
         B     BACKTR20                                                         
         STCM  R2,3,TSCURRNO                                                    
         GOTO1 ATSARGET,TSCURRNO   GET TSAR RECORD                              
         BE    *+6                                                              
         DC    H'0'                                                             
         L     RE,ATSARREC                                                      
         SR    RF,RF                                                            
         IC    RF,TSARLINE-TSARRECD(RE) NO OF SCREEN LINES RECORD USES          
         AR    R3,RF               R3=(NUM OF LINES FOR PREV TSAR RECS)         
         SR    RF,RF                                                            
         IC    RF,LINEMAX          RF=(MAX LINES FOR FULL SCREEN)               
         CR    R3,RF                                                            
         BL    BACKTR10            IS SCREEN FULL?                              
BACKTR20 TM    DISPFLAG,BALANCEQ   IF BALANCE LINE FORMAT                       
         BNO   *+14                                                             
         CHI   R2,2                AND SECOND RECORD AT TOP, MAKE IT            
         BNE   *+6                                                              
         BCTR  R2,0                FIRST RECORD AS BAL LINE NOT SHOWN           
         CHI   R2,1                TOP OF ENQUIRY?                              
         BE    BACKTR30                                                         
         CH    R2,TSNEXTST         ARE WE AT THE SAME AS BEFORE                 
         BNE   *+6                                                              
         BCTR  R2,0                MOVE BACK ONE                                
BACKTR30 LR    RE,R0                                                            
         BR    RE                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS THE OPTION DATE VALUE FROM SCAN BLOCK, VALIDATES AND SAVES IT  *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION DATE VALUE)         *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD DATE                      *         
*               CC IS SET TO UNEQUAL FOR BAD DATE                     *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALDMY   NTR1                                                                   
         LR    R3,R1               R3=A(OPTION SAVE AREA IN TWA)                
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         OC    0(L'ODATE,R3),0(R3)                                              
         BNZ   VALDMY50                                                         
*                                                                               
         CLI   SCANRHS,C'-'        START RANGE MISSING?                         
         BNE   VALDMY04            NO, CONTINUE                                 
         CLI   SVACTNUM,ACTNLSLT   DO FOR LIST/SELECT - LS                      
         BE    VALDMY02                                                         
         CLI   SVACTNUM,ACTNLIST   LI                                           
         BE    VALDMY02                                                         
         CLI   SVACTNUM,ACTNCONT   CL                                           
         BE    VALDMY02                                                         
         CLI   SVACTNUM,ACTNMNTH   MO                                           
         BE    VALDMY02                                                         
         CLI   SVACTNUM,ACTNOFMN   FM                                           
         BE    VALDMY02                                                         
         CLI   SVACTNUM,ACTNMNOF   MF                                           
         BE    VALDMY02                                                         
         CLI   SVACTNUM,ACTNSTMT   ST                                           
         BE    VALDMY02                                                         
         CLI   SVACTNUM,ACTNSTOF   AND SF                                       
         BNE   VALDMY04                                                         
*                                                                               
VALDMY02 MVC   FVMSGNO,=AL2(EAPLSTR)                                            
         CLC   SEXPUL,BASKEY       YES, IF P&L, ERROR                           
         BE    VALDMY50                                                         
         CLC   SINCUL,BASKEY                                                    
         BE    VALDMY50                                                         
         CLC   GPROUL,BASKEY                                                    
         BE    VALDMY50                                                         
*                                                                               
VALDMY04 MVC   FVMSGNO,=AL2(EGDATINV)                                           
         MVC   DATEFORM,LANG       AGENCY LANGUAGE                              
         OI    DATEFORM,PVINSGLS   TREAT SINGLE DATE AS SINGLE                  
         SR    R5,R5                                                            
         IC    R5,SCANRHSL         R5=L'(DATE VALUE)                            
         LA    R2,SCANRHS          R2=A(DATE VALUE)                             
         CLI   SCANRHS,NEGFILTR    NEGATIVE FILTER?                             
         BNE   *+14                                                             
         MVI   0(R3),NEGFILTR      SAVE NEGATIVE FILTER                         
         LA    R2,1(R2)            BUMP R2 TO NEXT CHARACTER                    
         BCTR  R5,0                REDUCE LENGTH OF DATE VALUE                  
         GOTO1 VPERVAL,DMCB,((R5),(R2)),(DATEFORM,WORK) VALIDATE DATE           
         L     RF,4(R1)                                                         
         CLI   4(R1),0             DATE RANGE FOUND?                            
         BE    *+12                                                             
         CLI   4(R1),PVRCONE       SINGLE DATE FOUND?                           
         BNE   VALDMY50                                                         
         USING PERVALD,RF                                                       
         L     RE,AOPTVALS                                                      
         AHI   RE,OMOS-OPTVALSD                                                 
         CR    R3,RE               MOS DATE?                                    
         BNE   VALDMY05            NO                                           
         TM    PVALASSM,PVALASD    START OR END DAY INVALID FOR MOS             
         BNO   VALDMY50                                                         
         TM    PVALASSM,PVALAED                                                 
         BNO   VALDMY50                                                         
*                                                                               
VALDMY05 MVC   TEMPASSM,PVALASSM   ASSUMPTION FLAG                              
         NI    TEMPASSM,PVALASD+PVALASM+PVALASY                                 
         CLI   TEMPASSM,PVALASD+PVALASM+PVALASY START DATE ASSUMED?             
         BE    *+10                                                             
         MVC   1(L'PVALPSTA,R3),PVALPSTA GET START DATE                         
*                                                                               
         MVC   TEMPASSM,PVALASSM   ASSUMPTION FLAG                              
         NI    TEMPASSM,PVALAED+PVALAEM+PVALAEY                                 
         CLI   TEMPASSM,PVALAED+PVALAEM+PVALAEY END DATE ASSUMED?               
         BNE   VALDMY30                                                         
         SR    R5,R5                                                            
         IC    R5,SCANRHSL                                                      
         LR    R0,R5                                                            
         LA    RE,SCANRHS                                                       
         CLI   0(RE),C'-'          CHECK RANGE SYMBOL                           
         BE    VALDMY40                                                         
         LA    RE,1(RE)                                                         
         BCT   R0,*-12                                                          
*                                                                               
         LA    R1,L'UP@THRU-1                                                   
         LA    RE,UP@THRU(R1)      CHECK RANGE 'WORD'                           
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-12                                                          
         LA    RE,SCANRHS                                                       
         LR    R0,R5                                                            
VALDMY10 EX    R1,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RE),UP@THRU                                                  
         BE    VALDMY40                                                         
         LA    RE,1(RE)                                                         
         BCT   R0,VALDMY10                                                      
*                                                                               
         LA    R1,L'UP@TO-1                                                     
         LA    RE,UP@TO(R1)                                                     
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-12                                                          
         LA    RE,SCANRHS                                                       
         LR    R0,R5                                                            
VALDMY20 EX    R1,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RE),UP@TO                                                    
         BE    VALDMY40                                                         
         LA    RE,1(RE)                                                         
         BCT   R0,VALDMY20                                                      
*                                  RANGE SYMBOL/WORD NOT FOUND                  
         MVC   TEMPASSM,PVALASSM                                                
         NI    TEMPASSM,PVALASD+PVALASM+PVALASY                                 
         CLM   RF,8,=X'4'         SINGLE DATE ENTERED?                          
         BE    VALDMY29                                                         
         CLI   TEMPASSM,0          START DATE ASSUMED?                          
         BE    *+14                                                             
         MVC   4(L'PVALPEND,R3),PVALPEND SET END DATE                           
         B     *+10                                                             
VALDMY29 MVC   4(L'PVALPSTA,R3),PVALPSTA SET END DATE                           
         B     VALDMY40                                                         
*                                                                               
VALDMY30 CLI   4(R1),PVRCONE       SINGLE DATE ENTERED?                         
         BE    *+14                                                             
         MVC   4(L'PVALPEND,R3),PVALPEND SET END DATE                           
         B     *+10                                                             
         MVC   4(L'PVALPSTA,R3),PVALPSTA                                        
*                                                                               
VALDMY40 L     RE,AOPTVALS                                                      
         AHI   RE,OMOS-OPTVALSD                                                 
         CR    R3,RE               MOS DATE?                                    
         BNE   VALDMY45            NO                                           
         CLI   PBALDFLT,C'Y'       YES, FORCE DEFAULT FISCAL SET?               
         BNE   VALDMY45            NO                                           
         OC    0(L'OMOS,R3),0(R3)  YES, MUST HAVE END IF HAVE START             
         BZ    VALDMY45                                                         
         OC    4(L'OMOSEN,R3),4(R3)                                             
         BZ    VALDMY50                                                         
*                                                                               
VALDMY45 B     XITEQ               VALID DATE(S)                                
VALDMY50 B     XITNEQ              INVALID DATE(S)/ DUPLICATE KEYWORD           
         DROP  R4,RF                                                            
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS THE OPTION VALUE FROM SCAN BLOCK, VALIDATES AND SAVES IT       *         
* CAN BE YES,NO,ONLY OR A VALID DATE RANGE                            *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION DATE VALUE)         *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD DATE                      *         
*               CC IS SET TO UNEQUAL FOR BAD DATE                     *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALDYNO  NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         OC    0(L'ORECDTE,R1),0(R1)                                            
         BNZ   VALDYN55                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@YES                                                
         BNE   VALDYN01                                                         
         MVI   0(R1),C'Y'                                                       
         B     VALDYN50                                                         
VALDYN01 EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@NO                                                 
         BNE   VALDYN02                                                         
         MVI   0(R1),C'N'                                                       
         B     VALDYN50                                                         
VALDYN02 EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@ONLY                                               
         BNE   VALDYN03                                                         
         MVI   0(R1),C'O'                                                       
         B     VALDYN50                                                         
*                                                                               
VALDYN03 LR    R3,R1               R3=A(OPTION SAVE AREA IN TWA)                
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         OC    0(L'ODATE,R3),0(R3)                                              
         BNZ   VALDYN55                                                         
*                                                                               
         CLI   SCANRHS,C'-'        START RANGE MISSING?                         
         BNE   VALDYN10            NO, CONTINUE                                 
         CLI   SVACTNUM,ACTNLSLT   DO FOR LIST/SELECT - LS                      
         BE    VALDYN05                                                         
         CLI   SVACTNUM,ACTNLIST   LI                                           
         BE    VALDYN05                                                         
         CLI   SVACTNUM,ACTNCONT   CL                                           
         BE    VALDYN05                                                         
         CLI   SVACTNUM,ACTNMNTH   MO                                           
         BE    VALDYN05                                                         
         CLI   SVACTNUM,ACTNOFMN   FM                                           
         BE    VALDYN05                                                         
         CLI   SVACTNUM,ACTNMNOF   MF                                           
         BE    VALDYN05                                                         
         CLI   SVACTNUM,ACTNSTMT   ST                                           
         BE    VALDYN05                                                         
         CLI   SVACTNUM,ACTNSTOF   AND SF                                       
         BNE   VALDYN10                                                         
*                                                                               
VALDYN05 MVC   FVMSGNO,=AL2(EAPLSTR)                                            
         CLC   SEXPUL,BASKEY       YES, IF P&L, ERROR                           
         BE    VALDYN55                                                         
         CLC   SINCUL,BASKEY                                                    
         BE    VALDYN55                                                         
         CLC   GPROUL,BASKEY                                                    
         BE    VALDYN55                                                         
*                                                                               
VALDYN10 MVC   FVMSGNO,=AL2(EGDATINV)                                           
         MVC   DATEFORM,LANG       AGENCY LANGUAGE                              
         OI    DATEFORM,PVINSGLS   TREAT SINGLE DATE AS SINGLE                  
         SR    R5,R5                                                            
         IC    R5,SCANRHSL         R5=L'(DATE VALUE)                            
         LA    R2,SCANRHS          R2=A(DATE VALUE)                             
         CLI   SCANRHS,NEGFILTR    NEGATIVE FILTER?                             
         BNE   *+14                                                             
         MVI   0(R3),NEGFILTR      SAVE NEGATIVE FILTER                         
         LA    R2,1(R2)            BUMP R2 TO NEXT CHARACTER                    
         BCTR  R5,0                REDUCE LENGTH OF DATE VALUE                  
         GOTO1 VPERVAL,DMCB,((R5),(R2)),(DATEFORM,WORK) VALIDATE DATE           
         L     RF,4(R1)                                                         
         CLI   4(R1),0             DATE RANGE FOUND?                            
         BE    *+12                                                             
         CLI   4(R1),PVRCONE       SINGLE DATE FOUND?                           
         BNE   VALDYN55                                                         
         USING PERVALD,RF                                                       
*                                                                               
         MVC   TEMPASSM,PVALASSM   ASSUMPTION FLAG                              
         NI    TEMPASSM,PVALASD+PVALASM+PVALASY                                 
         CLI   TEMPASSM,PVALASD+PVALASM+PVALASY START DATE ASSUMED?             
         BE    *+10                                                             
         MVC   1(L'PVALPSTA,R3),PVALPSTA GET START DATE                         
*                                                                               
         MVC   TEMPASSM,PVALASSM   ASSUMPTION FLAG                              
         NI    TEMPASSM,PVALAED+PVALAEM+PVALAEY                                 
         CLI   TEMPASSM,PVALAED+PVALAEM+PVALAEY END DATE ASSUMED?               
         BNE   VALDYN40                                                         
         SR    R5,R5                                                            
         IC    R5,SCANRHSL                                                      
         LR    R0,R5                                                            
         LA    RE,SCANRHS                                                       
         CLI   0(RE),C'-'          CHECK RANGE SYMBOL                           
         BE    VALDYN50                                                         
         LA    RE,1(RE)                                                         
         BCT   R0,*-12                                                          
*                                                                               
         LA    R1,L'UP@THRU-1                                                   
         LA    RE,UP@THRU(R1)      CHECK RANGE 'WORD'                           
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-12                                                          
         LA    RE,SCANRHS                                                       
         LR    R0,R5                                                            
VALDYN20 EX    R1,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RE),UP@THRU                                                  
         BE    VALDYN50                                                         
         LA    RE,1(RE)                                                         
         BCT   R0,VALDYN20                                                      
*                                                                               
         LA    R1,L'UP@TO-1                                                     
         LA    RE,UP@TO(R1)                                                     
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-12                                                          
         LA    RE,SCANRHS                                                       
         LR    R0,R5                                                            
VALDYN30 EX    R1,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RE),UP@TO                                                    
         BE    VALDYN50                                                         
         LA    RE,1(RE)                                                         
         BCT   R0,VALDYN30                                                      
*                                  RANGE SYMBOL/WORD NOT FOUND                  
         MVC   TEMPASSM,PVALASSM                                                
         NI    TEMPASSM,PVALASD+PVALASM+PVALASY                                 
         CLM   RF,8,=X'4'         SINGLE DATE ENTERED?                          
         BE    VALDYN38                                                         
         CLI   TEMPASSM,0          START DATE ASSUMED?                          
         BE    *+14                                                             
         MVC   4(L'PVALPEND,R3),PVALPEND SET END DATE                           
         B     *+10                                                             
VALDYN38 MVC   4(L'PVALPSTA,R3),PVALPSTA SET END DATE                           
         B     VALDYN50                                                         
*                                                                               
VALDYN40 CLI   4(R1),PVRCONE       SINGLE DATE ENTERED?                         
         BE    *+14                                                             
         MVC   4(L'PVALPEND,R3),PVALPEND SET END DATE                           
         B     *+10                                                             
         MVC   4(L'PVALPSTA,R3),PVALPSTA                                        
*                                                                               
VALDYN50 B     XITEQ               VALID DATE(S)                                
VALDYN55 B     XITNEQ              INVALID DATE(S)/ DUPLICATE KEYWORD           
         DROP  R4,RF                                                            
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS AN AMOUNT AND VALIDATES IT                                     *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION DATE VALUE)         *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD AMOUNT                    *         
*               CC IS SET TO UNEQUAL FOR BAD AMOUNT                   *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALAMT   NTR1                                                                   
         LR    R3,R1               R3=A(OPTION SAVE AREA)                       
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         OC    0(L'OAMOUNT,R3),0(R3)                                            
         BNZ   VALAMT20                                                         
         MVC   FVMSGNO,=AL2(EAAMTINV) INVALID AMOUNT                            
         LA    RF,SCANRHS          RF=A(OPTION VALUE)                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE)                          
         CLI   0(RF),NEGFILTR      NEGATIVE FILTER?                             
         BNE   *+12                                                             
         MVI   0(R3),NEGFILTR      SAVE NEGATIVE FILTER                         
         LA    RF,1(RF)            BUMP RF TO POINT TO NEXT CHAR                
         CLI   0(RF),C'>'          MORE THAN?                                   
         BE    *+12                                                             
         CLI   0(RF),C'<'          LESS THAN?                                   
         BNE   *+14                                                             
         MVC   1(1,R3),0(RF)       SAVE MORE/LESS THAN                          
         LA    RF,1(RF)            BUMP RF TO POINT TO NEXT CHAR                
         CLI   0(RF),PLUS          IS A SIGN PROVIDED?                          
         BE    *+12                                                             
         CLI   0(RF),MINUS                                                      
         BNE   *+10                                                             
         MVC   2(1,R3),0(RF)       SAVE THE SIGN                                
         LR    R1,RF               R1=A(AMOUNT)                                 
         LA    R0,SCANRHS          R0=A(START OF OPTION VALUE)                  
         SR    R1,R0               R1=L'(OF ANY SIGN AND OR FILTER)             
         SR    RE,R1               RE=L'(AMOUNT PART OF OPTION VAL)             
         BZ    VALAMT20                                                         
         LR    R2,RE                                                            
         GOTO1 VCASHVAL,DMCB,(X'80',(RF)),((R2))                                
         CLI   DMCB,X'FF'                                                       
         BE    VALAMT20                                                         
         ZAP   3(L'OAMTVL,R3),4(8,R1)                                           
*                                                                               
VALAMT10 B     XITEQ               VALID AMOUNT                                 
VALAMT20 B     XITNEQ              INVALID AMOUNT/DUPLICATE KEYWORD             
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* VERIFYS THAT RUNNO OPTION IS NUMERIC                                *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD                    *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALRUN   NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         SR    R2,R2                                                            
         ICM   R2,1,SCANRHSL       R2=L'(OPTION VALUE IN SCAN BLOCK)            
         BZ    VALRUERR                                                         
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         OC    0(L'ORUNNO,R1),0(R1)                                             
         BNZ   VALRUERR                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV) NOT VALID                                 
         LA    RF,SCANRHS                                                       
         CLI   0(RF),C'*'                                                       
         BNE   VALRU10                                                          
         LA    RF,1(RF)                                                         
         SHI   R2,1                                                             
         BZ    VALRUERR                                                         
         MVI   0(R1),C'*'                                                       
VALRU10  LR    R0,R1                                                            
         GOTO1 VCASHVAL,DMCB,(C'N',(RF)),(R2)                                   
         CLI   0(R1),0                                                          
         BNE   VALRUERR            INVALID AMOUNT                               
         L     RF,4(R1)            R3=(LINE NUM DISPLACEMENT)                   
         LR    R1,R0                                                            
         STCM  RF,3,1(R1)                                                       
*                                                                               
VALRUX   B     XITEQ               VALID OPTION                                 
VALRUERR B     XITNEQ              DUPLICATE KEYWORD/NOT NUMERIC                
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* VERIFYS THAT VALID OFFICE/OFFICE LIST INPUT         (OFFPOS FILTER) *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD/INVALID OFFICE     *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALOFF   NTR1                                                                   
*                                                                               
         MVC   FVMSGNO,=AL2(AE$OPTNV)                                           
         CLI   LDGTOFFP,LDGOTRAN        OFFPOS=T?                               
         BE    VALTF02                  . YES, TRANSACTIONAL FILTERING          
*                                       . NO                                    
         CLI   SVACTNUM,ACTNLIST        LIST?                                   
         BE    VALOF02                  . YES                                   
         CLI   SVACTNUM,ACTNLSLT        LIST AND SELECT?                        
         BNE   VALOFERR                 . NO, ERROR 'OF=' NOT ALLOWED           
*                                                                               
VALOF02  MVC   FVMSGNO,=AL2(EGOPTDUP)   DUPLICATE OPTION KEYWORD                
         LA    R1,OOFFPOS-OOFFICE(R1)                                           
         OC    1(L'OOFFPOS,R1),1(R1)    OFFICE COUNT ALREADY SET?               
         BNZ   VALOFERR                                                         
*                                                                               
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         SR    R2,R2                                                            
         ICM   R2,1,SCANRHSL            R2=L'(OPT VALUE IN SCAN BLOCK)          
         BZ    VALOFERR                                                         
         LA    RF,SCANRHS                                                       
         CLI   0(RF),C'*'                                                       
         BNE   VALOF10                                                          
         LA    RF,1(RF)                                                         
         SHI   R2,1                                                             
         BZ    VALOFERR                                                         
         MVI   0(R1),C'*'                                                       
*                                                                               
VALOF10  MVC   FVMSGNO,=AL2(AE$IVOFF)                                           
         LA    R2,1(R1)                                                         
         MVC   0(2,R2),0(RF)                                                    
         TM    COMPSTA4,CPYSOFF2      OFFAREQ NOT SUPPORTED FOR OLD OFF         
         BZ    VALOFX                                                           
*                                                                               
         USING OFFALD,R1                                                        
VALOF20  MVC   HALF,0(RF)                                                       
         L     R1,AOFFBLK                INIT OFFAL FOR OFFICE ACCESS           
         MVI   OFFACTRL,OFFACCNV                                                
         MVC   OFFACOMF,ACOMFACS                                                
         MVC   OFFATSAR,VTSAR                                                   
         MVC   OFFAALPH,TWAAGY                                                  
         MVC   OFFAAUTH,TWAAUTH                                                 
         MVC   OFFACPY,MYCO                                                     
         MVC   OFFACST1(OFFAOPOS-OFFACST1),COMPSTA1                             
         MVI   OFFAACT,OFFAINI                                                  
         OI    OFFAINDS,OFFAISEC+OFFAIOFF                                       
         MVC   OFFALIMA,TWAACCS          LIMITED ACCESS                         
         GOTO1 VOFFAL                                                           
         BE    *+6                                                              
         DC    H'0'                      OFFAL ERROR                            
*                                                                               
         LA    R2,OFFAWORK                                                      
         ST    R2,OFFAREQL               RF=A(REQUESTED LIST OUTPUT)            
         MVC   OFFAOFFC,HALF             OFFICE CODE FOR SECURITY TEST          
         MVI   OFFAACT,OFFAREQ           CREATE OFFICE LIST                     
         GOTO1 VOFFAL                                                           
         BE    VALOFX                                                           
         CLI   OFFAERR,OFFAESEC            SECURITY LOCKOUT?                    
         BNE   VALOFERR                    . NO                                 
         MVC   FVMSGNO,=AL2(AE$SECLK)                                           
         DROP  R1                                                               
*                                                                               
VALOFERR B     XITNEQ                                                           
VALOFX   B     XITEQ                                                            
         EJECT                                                                  
*                                                                               
***********************************************************************         
* VERIFYS THAT VALID OFFICE/OFFICE LIST INPUT (TRANSACTION FILTER)    *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD/INVALID OFFICE     *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALTOFF  NTR1                                                                   
*                                                                               
VALTF02  CLI   SVACTNUM,ACTNLIST        LIST?                                   
         BE    *+12                     . YES                                   
         CLI   SVACTNUM,ACTNLSLT        LIST AND SELECT?                        
         BNE   VALTF04                  . NO                                    
         MVC   FVMSGNO,=AL2(AE$OPTNV)                                           
         TM    COMPSTA4,CPYSOFF2        2 CHAR OFFICES?                         
         BZ    VALTFERR                                                         
*                                                                               
VALTF04  MVC   FVMSGNO,=AL2(EGOPTDUP)   DUPLICATE OPTION KEYWORD                
         OC    1(2,R1),1(R1)            OFFICE COUNT ALREADY SET?               
         BNZ   VALTFERR                                                         
*                                                                               
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         SR    R2,R2                                                            
         ICM   R2,1,SCANRHSL            R2=L'(OPT VALUE IN SCAN BLOCK)          
         BZ    VALTFERR                                                         
         LA    RF,SCANRHS                                                       
         CLI   0(RF),C'*'                                                       
         BNE   VALTF10                                                          
         LA    RF,1(RF)                                                         
         SHI   R2,1                                                             
         BZ    VALTFERR                                                         
         MVI   0(R1),C'*'                                                       
*                                                                               
VALTF10  MVC   FVMSGNO,=AL2(AE$IVOFF)                                           
         LA    R2,1(R1)                                                         
         TM    COMPSTA4,CPYSOFF2      OFFAREQ NOT SUPPORTED FOR OLD OFF         
         BO    VALTF20                                                          
         MVC   0(2,R2),=X'0001'                                                 
         MVC   2(2,R2),0(RF)                                                    
         B     VALTFX                                                           
*                                                                               
         USING OFFALD,R1                                                        
VALTF20  MVC   HALF,0(RF)                                                       
         L     R1,AOFFBLK                INIT OFFAL FOR OFFICE ACCESS           
         MVI   OFFACTRL,OFFACCNV                                                
         MVC   OFFACOMF,ACOMFACS                                                
         MVC   OFFATSAR,VTSAR                                                   
         MVC   OFFAALPH,TWAAGY                                                  
         MVC   OFFAAUTH,TWAAUTH                                                 
         MVC   OFFACPY,MYCO                                                     
         MVC   OFFACST1(OFFAOPOS-OFFACST1),COMPSTA1                             
         MVI   OFFAACT,OFFAINI                                                  
         OI    OFFAINDS,OFFAISEC+OFFAIOFF                                       
         CLI   LDGTOFFP,LDGOTRAN         OFFPOS=T?                              
         BNE   *+10                      . NO                                   
         MVC   OFFALIMA,TWAACCS          LIMITTED ACCESS                        
*                                                                               
         GOTO1 VOFFAL                                                           
         BE    *+6                                                              
         DC    H'0'                      OFFAL ERROR                            
*                                                                               
         ST    R2,OFFAREQL               RF=A(REQUESTED LIST OUTPUT)            
         MVC   OFFAOFFC,HALF             OFFICE CODE FOR SECURITY TEST          
         MVI   OFFAACT,OFFAREQ           VALIDATE AND CREATE LIST               
         GOTO1 VOFFAL                                                           
         BE    VALTFX                                                           
         CLI   OFFAERR,OFFAESEC            SECURITY LOCKOUT?                    
         BNE   VALTFERR                    . NO                                 
         MVC   FVMSGNO,=AL2(AE$SECLK)                                           
         DROP  R1                                                               
*                                                                               
VALTFERR B     XITNEQ                                                           
VALTFX   B     XITEQ                                                            
         EJECT                                                                  
*                                                                               
***********************************************************************         
* VERIFYS THAT INPUT TYPE IS NUMERIC                                  *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD                    *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALBATTY NTR1                                                                   
*                                                                               
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         SR    R2,R2                                                            
         ICM   R2,1,SCANRHSL       R2=L'(OPTION VALUE IN SCAN BLOCK)            
         BZ    VALBTERR                                                         
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   1(R1),0                                                          
         BNZ   VALBTERR                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV) NOT VALID                                 
         LA    RF,SCANRHS                                                       
         CLI   0(RF),C'*'                                                       
         BNE   VALBT10                                                          
         LA    RF,1(RF)                                                         
         SHI   R2,1                                                             
         BZ    VALBTERR                                                         
         MVI   0(R1),C'*'                                                       
VALBT10  LR    R0,R1                                                            
         GOTO1 VCASHVAL,DMCB,(C'N',(RF)),(R2)                                   
         CLI   0(R1),0                                                          
         BNE   VALBTERR            INVALID AMOUNT                               
         L     RF,4(R1)            R3=(LINE NUM DISPLACEMENT)                   
         LR    R1,R0                                                            
         STC   RF,1(R1)                                                         
*                                                                               
VALBTX   B     XITEQ                                                            
VALBTERR B     XITNEQ                                                           
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS THE OPTION VALUE AND SAVES IT WITH THE LENGTH OF THE VALUE     *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD                    *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALMOVL1 NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         SR    RE,RE                                                            
         ICM   RE,1,SCANRHSL       RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BZ    VALML20                                                          
         LR    RF,RE               RF=RE                                        
         BCTR  RE,0                                                             
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         EX    RE,*+8                                                           
         B     *+10                                                             
         OC    0(0,R1),0(R1)                                                    
         BNZ   VALML20                                                          
         MVC   0(L'FVINDX,R1),FVINDX OPTION NUMBER                              
         LA    R1,1(R1)                                                         
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         CLI   SCANRHS,NEGFILTR    NEGATIVE FILTER?                             
         BNE   VALML15                                                          
         SHI   RF,1                REDUCE LENGTH                                
         BZ    VALML20                                                          
VALML15  STC   RF,0(R1)            SAVE LENGTH OF VALUE                         
         LA    R1,1(R1)            R1=A(SAVE AREA IN TWA)                       
         CLI   SCANRHS,NEGFILTR    NEGATIVE FILTER?                             
         BE    *+8                                                              
         LA    R1,1(R1)            BUMP PAST FILTER SAVE                        
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),SCANRHS     SAVE OPTION VALUE                            
*                                                                               
VALML10  B     XITEQ               VALID OPTION                                 
VALML20  B     XITNEQ              DUPLICATE KEYWORD                            
         DROP  R4                                                               
         EJECT ,                                                                
*                                                                               
***********************************************************************         
* GETS THE OPTION WC VALULE                                           *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD                    *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALWC    NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         SR    RE,RE                                                            
         ICM   RE,1,SCANRHSL       RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BZ    VALML20                                                          
         LR    RF,RE               RF=RE                                        
         BCTR  RE,0                                                             
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         EX    RE,*+8                                                           
         B     *+10                                                             
         OC    0(0,R1),0(R1)                                                    
         BNZ   VALML20                                                          
         MVC   0(L'FVINDX,R1),FVINDX OPTION NUMBER                              
         LA    R1,1(R1)                                                         
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         CLI   SCANRHS,NEGFILTR    NEGATIVE FILTER?                             
         BNE   VALWC15                                                          
         CHI   RF,L'OWCODEVL                                                    
         BNE   *+12                                                             
         CLI   SCANRHS+1,C'*'                                                   
         BE    VALWC15                                                          
         SHI   RF,1                REDUCE LENGTH                                
         BZ    VALWC20                                                          
         STC   RF,0(R1)            SAVE LENGTH OF VALUE                         
         LA    R1,1(R1)            R1=A(SAVE AREA IN TWA)                       
         B     *+12                                                             
VALWC15  STC   RF,0(R1)            SAVE LENGTH OF VALUE                         
         LA    R1,2(R1)            R1=A(SAVE AREA IN TWA)                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),SCANRHS     SAVE OPTION VALUE                            
*                                                                               
VALWC10  B     XITEQ               VALID OPTION                                 
VALWC20  B     XITNEQ              DUPLICATE KEYWORD                            
         DROP  R4                                                               
         EJECT ,                                                                
*                                                                               
***********************************************************************         
* GETS THE INCREMENT VALUE FOR DATE COLUMNS                           *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL IF VALUE ACCEPTED                  *         
*               CC IS SET TO UNEQUAL IF VALUE REJECTED                *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALINCR  LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         OC    0(L'OINCRMT,R1),0(R1)                                            
         BNZ   VALIERRX                                                         
         MVC   FVMSGNO,=AL2(IAAGEVAL)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         TM    SCANRTYP,SCNUMQ     NUMERIC?                                     
         BNO   VALI10                                                           
         EX    RE,*+8                                                           
         B     *+10                                                             
         PACK  DUB,SCANRHS(0)                                                   
         CVB   RF,DUB                                                           
         LTR   RF,RF                                                            
         BNP   VALIERRX                                                         
         CHI   RF,999              MAX AGING VALUE                              
         BH    VALIERRX                                                         
         MVI   0(R1),C'N'          NUMERICE AGING                               
         STCM  RF,3,1(R1)                                                       
         B     VALIX                                                            
*                                                                               
VALI10   EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@MTHL  MONTHLY?                                     
         BNE   VALIERRX                                                         
         MVI   0(R1),C'M'                                                       
*                                                                               
VALIX    B     XITEQ0E                                                          
VALIERRX B     XITNEQ0E                                                         
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* CHECKS CLIENT/PRODUCT LENGTH AGAINST LEDGER AND IF OK PASSES VALUES *         
* TO VALSTRNG FOR VALIDATION                                          *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC SET EQUAL IF RANGE VALID                           *         
*               CC SET UNEQUAL IF RANGE NOT VALID                     *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALCLPR  NTR1                                                                   
         BAS   RE,VALSTRNG                                                      
         BNE   VALCPERR                                                         
         MVC   FVMSGNO,=AL2(EGRECNOF) RECORD NOT ON FILE                        
         LR    R0,R1               R0=A(OPTION SAVE AREA)                       
         LA    R2,IOKEY            R2=A(KEY FOR PROD LEDGER READ)               
         USING LDGRECD,R2                                                       
         MVC   LDGKEY,SPACES                                                    
         MVC   LDGKCPY,MYCO                                                     
         MVC   LDGKUNT(L'SPROUL),SPROUL                                         
         GOTO1 AIO,IOREAD+IOACCMST+IO1 READ LEDGER RECORD                       
         BNE   VALCPERR                                                         
*                                                                               
         MVC   FVMSGNO,=AL2(EGIFLONG)                                           
         L     R2,AIO1             R3=A(IOAREA2)                                
         LA    R2,LDGRFST          R2=A(FIRST ELEMENT)                          
VALCP10  CLI   0(R2),EOR           END OF RECORD?                               
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLI   0(R2),ACLELQ        TEST HIERARCHY ELEMENT                       
         BE    VALCP20                                                          
*                                                                               
         SR    RF,RF                                                            
         IC    RF,1(R2)                                                         
         AR    R2,RF                                                            
         B     VALCP10                                                          
*                                                                               
         USING ACLELD,R2                                                        
VALCP20  LA    RF,ACLVALS          RF=A(CLIENT LEVEL DETAILS)                   
         SR    RE,RE                                                            
         IC    RE,SCANLHSL         RE=L'(OPTION KEY WORD)                       
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANLHS(0),UP@CLINL CLIENT OR PRODUCT?                           
         BE    *+8                                                              
         LA    RF,L'ACLVALS(RF)    RF=A(PRODUCT LEVEL DETAILS)                  
         LR    R1,R0                                                            
         CLC   1(1,R1),0(RF)                                                    
         BH    VALCPERR                                                         
         SR    RE,RE                                                            
         IC    RE,OPTMAXL-OPTTABD(R3) R5=L'(MAX INPUT)                          
         SHI   RE,2                MINUS L'(NEG FILTER+SEPARATOR)               
         SRL   RE,1                RE= MAX L'(START/END VALUE)                  
         LA    R1,2(R1,RE)                                                      
         CLC   0(1,R1),0(RF)                                                    
         BH    VALCPERR                                                         
*                                                                               
VALCPX   B     XITEQ                                                            
VALCPERR B     XITNEQ                                                           
         DROP  R2,R4                                                            
         EJECT                                                                  
*                                                                               
***********************************************************************         
* CHECKS SOURCE LEDGER AND IF OK PASSES VALUES TO VALSTRNG FOR        *         
* VALIDATION                                                          *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC SET EQUAL IF VALID                                 *         
*               CC SET UNEQUAL IF NOT VALID                           *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALSRC   NTR1                                                                   
*                                                                               
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         SR    RF,RF                                                            
         IC    RF,SCANRHSL                                                      
         LA    RE,SCANRHS                                                       
         CLI   0(RE),C'*'                                                       
         BNE   VALSR05                                                          
         SHI   RF,1                                                             
         BM    VALSRERR                                                         
         LA    RE,1(RE)                                                         
VALSR05  CHI   RF,L'SPROUL                                                      
         BL    VALSRERR                                                         
         MVC   FVMSGNO,=AL2(EALDGINV)                                           
         CLC   0(L'SPROUL,RE),SPROUL                                            
         BE    VALSR10                                                          
         CLC   0(L'SEXPUL,RE),SEXPUL                                            
         BE    VALSR10                                                          
         CLC   0(2,RE),=C'SA'                                                   
         BE    VALSR10                                                          
         CLC   0(2,RE),=C'SQ'                                                   
         BNE   VALSRERR                                                         
VALSR10  BAS   RE,VALSTRNG                                                      
         BNE   VALSRERR                                                         
*                                                                               
VALSRX   B     XITEQ                                                            
VALSRERR B     XITNEQ                                                           
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* GETS THE OPTION VALUE AND PUTS IT IN RELEVANT PLACE                 *         
* ALLOWS A RANGE IE  AAAAAAAAA (MAX LENGTH FOR START/END IS 12 CHARS) *         
*                   -AAAAAAAAA                                        *         
*                    AAAAAAAAA-                                       *         
*                    AAAAAAAAA-BBBBBBBBB                              *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC SET EQUAL IF RANGE VALID                           *         
*               CC SET UNEQUAL IF RANGE NOT VALID                     *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALSTRNG NTR1                                                                   
*                                                                               
         SR    R5,R5                                                            
         IC    R5,OPTMAXL-OPTTABD(R3) R5=L'(MAX INPUT)                          
         LR    RF,R5                                                            
         SHI   R5,2                   MINUS L'(NEG FILTER+SEPARATOR)            
         SRL   R5,1                R5= MAX L'(START/END VALUE)                  
         STC   R5,HALF                                                          
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         OC    0(0,R1),0(R1)                                                    
         BNZ   VALSTERR                                                         
         SR    RF,RF                                                            
         IC    RF,SCANRHSL         RF=L'(OPTION VALUE IN SCAN BLOCK)            
         LA    R5,SCANRHS          R5=A(OPTION VALUE)                           
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         CLI   SCANRHS,NEGFILTR    DO WE HAVE A NEGATIVE FILTER?                
         BNE   VALST05                                                          
         SHI   RF,1                REDUCE OPTION VALUE LENGTH                   
         BZ    VALSTERR                                                         
         LA    R5,1(R5)            BUMP R5 PAST NEGATIVE FILTER                 
         MVI   0(R1),NEGFILTR      PLACE NEGATIVE FILTER IN OPT BLOCK           
VALST05  LA    R1,1(R1)                                                         
         LR    RE,RF                                                            
         LA    R2,0(R5,RE)         R2=A(LAST CHAR OF OPTION VALUE)              
         BCTR  R2,0                                                             
         CLI   0(R2),C'-'                                                       
         BE    VALST10                                                          
         BCT   RE,*-14                                                          
         B     VALST08                                                          
*                                                                               
VALST08  MVC   FVMSGNO,=AL2(EGIFLONG)                                           
         SR    RE,RE                                                            
         IC    RE,HALF             MAX LENGTH OF START/END VALUE                
         CR    RF,RE               MAX LENGTH EXCEEDED?                         
         BH    VALSTERR                                                         
         LA    RE,1(R1,RE)         RE=A(END VALUES)                             
         STC   RF,0(R1)            LENGTH OF START VALUE                        
         STC   RF,0(RE)            LENGTH OF END VALUE                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   1(0,R1),0(R5)       START VALUE                                  
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   1(0,RE),0(R5)       END VALUE                                    
         B     VALSTX                                                           
*                                                                               
VALST10  MVC   FVMSGNO,=AL2(EGIFLONG)                                           
         SR    RF,RE                                                            
         BZ    VALST20             ONLY FST VALUE INPUT, RANGE ASSUMED          
         SR    R3,R3                                                            
         IC    R3,HALF                                                          
         CR    RF,R3                                                            
         BH    VALSTERR                                                         
         LA    R3,1(R1,R3)                                                      
         STC   RF,0(R3)            L'(SECOND VAL IN RANGE)                      
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   1(0,R3),1(R2)                                                    
*                                                                               
VALST20  SHI   RE,1                                                             
         BZ    VALSTX              ONLY 2ND VALUE INPT, RANGE ASSUMED           
         SR    R3,R3                                                            
         IC    R3,HALF                                                          
         CR    RE,R3                                                            
         BH    VALSTERR                                                         
         STC   RE,0(R1)            L'(FIRST VAL IN RANGE)                       
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   1(0,R1),0(R5)                                                    
         SR    RF,RF                                                            
         IC    RF,HALF                                                          
         LA    R3,1(R1,R3)                                                      
         SR    RF,RF                                                            
         IC    RF,0(R3)            RF=L'(SECOND INPUT)                          
         SHI   RF,1                                                             
         BM    VALSTX                                                           
         CR    RF,RE                                                            
         BNH   *+6                                                              
         LR    RF,RE               GET SHORTEST LENGTH                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         CLC   1(0,R1),1(R3)       1ST VAL LESS THAN SECOND VAL?                
         BL    VALSTX                                                           
         SR    RF,RF                                                            
         IC    RF,HALF                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         XC    1(0,R1),1(R3)        SWAP VALUES ROUND                           
         EX    RF,*+8                                                           
         B     *+10                                                             
         XC    1(0,R3),1(R1)                                                    
         EX    RF,*+8                                                           
         B     *+10                                                             
         XC    1(0,R1),1(R3)                                                    
*                                                                               
VALSTX   B     XITEQ                                                            
VALSTERR B     XITNEQ                                                           
         DROP  R4                                                               
         EJECT                                                                  
                                                                                
***********************************************************************         
* VALIDATE LEVEL VALUE                                                *         
* ALLOWS A RANGE IE  N       ('N' CAN HAVE VALUE OF '1' TO '4')       *         
*                   -N                                                *         
*                    N-                                               *         
*                    N-N                                              *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC SET EQUAL IF RANGE VALID                           *         
*               CC SET UNEQUAL IF RANGE NOT VALID                     *         
***********************************************************************         
         USING LRANGED,R1                                                       
         USING SCANBLKD,R4                                                      
*                                                                               
VALLEV   NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         OC    0(L'OLEVEL,R1),0(R1)                                             
         BNZ   VALLVERR                                                         
         SR    RF,RF                                                            
         IC    RF,SCANRHSL         RF=L'(OPTION VALUE IN SCAN BLOCK)            
         LA    R5,SCANRHS          R5=A(OPTION VALUE)                           
         MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         CLI   SCANRHS,NEGFILTR    DO WE HAVE A NEGATIVE FILTER?                
         BNE   VALLV05                                                          
         SHI   RF,1                REDUCE OPTION VALUE LENGTH                   
         BZ    VALLVERR                                                         
         LA    R5,1(R5)            BUMP R5 PAST NEGATIVE FILTER                 
         MVI   LRANGFI,NEGFILTR    PLACE NEGATIVE FILTER IN OPT BLOCK           
VALLV05  LR    RE,RF                                                            
         LA    R2,0(R5,RE)         R2=A(LAST CHAR OF OPTION VALUE)              
         BCTR  R2,0                                                             
         CLI   0(R2),C'-'                                                       
         BE    VALLV10                                                          
         BCT   RE,*-14                                                          
*                                                                               
         MVC   FVMSGNO,=AL2(EGIFLONG)                                           
         CHI   RF,L'LRANGVL1                                                    
         BH    VALLVERR                                                         
         MVC   LRANGVL1,0(R5)                                                   
         MVC   LRANGVL2,LRANGVL1                                                
         B     VALLV30                                                          
*                                                                               
VALLV10  CHI   RF,1                                                             
         BNH   VALLVERR            ONLY A '-' INPUT WITH NO VALUES              
         MVC   FVMSGNO,=AL2(EGIFLONG)                                           
         SR    RF,RE                                                            
         BZ    VALLV20             ONLY FST VALUE INPUT, RANGE ASSUMED          
         CHI   RF,L'LRANGVL2                                                    
         BH    VALLVERR                                                         
         MVC   LRANGVL2,1(R2)                                                   
*                                                                               
VALLV20  SHI   RE,1                                                             
         BZ    VALLV30             ONLY 2ND VALUE INPT, RANGE ASSUMED           
         CHI   RE,L'LRANGVL1                                                    
         BH    VALLVERR                                                         
         MVC   LRANGVL1,0(R5)                                                   
*                                                                               
VALLV30  LA    RF,LRANGVL1                                                      
         LA    RE,2                                                             
VALLV40  CLI   0(RF),0                                                          
         BE    VALLV50                                                          
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         CLI   0(RF),C'1'                                                       
         BL    VALLVERR                                                         
         CLI   0(RF),C'4'                                                       
         BH    VALLVERR                                                         
         NI    0(RF),X'0F'                                                      
VALLV50  LA    RF,LRANGVL2                                                      
         BCT   RE,VALLV40                                                       
*                                                                               
VALLVX   B     XITEQ               CC SET TO EQUAL                              
VALLVERR B     XITNEQ              CC SET UNEQUAL                               
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS THE OPTION VALUE AND PUTS IT IN RELEVANT PLACE                 *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD                    *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALMOVE  LR    R0,RE                                                            
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         EX    RE,*+8                                                           
         B     *+10                                                             
         OC    0(0,R1),0(R1)                                                    
         BNZ   VALMERR                                                          
         CLI   SCANRHS,C'*'        NEGATIVE FILTER?                             
         BE    *+8                                                              
         LA    R1,1(R1)            BUMP PAST FILTER SAVE                        
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),SCANRHS     SAVE OPTION VALUE                            
*                                                                               
         B     XITEQ0E                                                          
VALMERR  B     XITNEQ0E                                                         
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* VALIDATE OPTION VALUE FOR METHOD= CAN BE 1, 2 OR 3                  *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD OR INVALID METHOD  *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
*                                                                               
VALMETH  LR    R0,RE                                                            
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         EX    RE,*+8                                                           
         B     *+10                                                             
         OC    0(0,R1),0(R1)                                                    
         BNZ   VALMTERR                                                         
         LA    R1,1(R1)            BUMP PAST FILTER SAVE                        
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),SCANRHS     SAVE OPTION VALUE                            
         MVC   FVMSGNO,=AL2(AE$INVIF) INVALID INPUT FIELD                       
         CLI   0(R1),C'1'                                                       
         BL    VALMTERR                                                         
         CLI   0(R1),C'9'                                                       
         BH    VALMTERR                                                         
*                                                                               
         B     XITEQ0E                                                          
VALMTERR B     XITNEQ0E                                                         
         DROP  R4                                                               
         EJECT ,                                                                
*                                                                               
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'YES' OR 'NO' AND SAVES IT               *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALYN    LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALYNERR                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         MVI   0(R1),C'Y'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@YES                                                
         BE    VALYN10                                                          
         MVI   0(R1),C'N'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@NO                                                 
         BE    VALYN10                                                          
*                                                                               
VALYNERR B     XITNEQ0E                                                         
VALYN10  B     XITEQ0E                                                          
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'YES' OR 'NO' OR 'ONLY' AND SAVES IT     *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALYNO   LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALYNOER                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         MVI   0(R1),C'Y'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@YES                                                
         BE    VALYNO10                                                         
         MVI   0(R1),C'N'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@NO                                                 
         BE    VALYNO10                                                         
         MVI   0(R1),C'O'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@ONLY                                               
         BNE   VALYNOER                                                         
*                                                                               
VALYNO10 B     XITEQ0E                                                          
VALYNOER B     XITNEQ0E                                                         
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'T', 'M' OR 'A' AND SAVES IT             *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALTTYP  LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALTTERR                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         CLI   SCANRHSL,1                                                       
         BNE   VALTTERR                                                         
         CLI   SCANRHS,C'T'           REGULAR TIME SHEET                        
         BE    VALTT10                                                          
         CLI   SCANRHS,C'M'           MISSING TIME SHEET                        
         BE    VALTT10                                                          
         CLI   SCANRHS,C'A'           ADJUSTED TIME SHEET                       
         BNE   VALTTERR                                                         
VALTT10  MVC   0(1,R1),SCANRHS                                                  
         B     VALTTX                                                           
*                                                                               
VALTTERR B     XITNEQ0E                                                         
VALTTX   B     XITEQ0E                                                          
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'B', 'N' OR 'R' AND SAVES IT             *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALTIME  LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALTIERR                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         CLI   SCANRHSL,1                                                       
         BNE   VALTIERR                                                         
         CLI   SCANRHS,C'B'           BILLABLE TIME                             
         BE    VALTI10                                                          
         CLI   SCANRHS,C'N'           NON-BILLABLE TIME                         
         BE    VALTI10                                                          
         CLI   SCANRHS,C'R'           SPECIAL NON-BILLABLE TIME                 
         BNE   VALTTERR                                                         
VALTI10  MVC   0(1,R1),SCANRHS                                                  
         B     VALTIX                                                           
*                                                                               
VALTIERR B     XITNEQ0E                                                         
VALTIX   B     XITEQ0E                                                          
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'ZERO' OR '*ZERO' AND SAVES IT           *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALZERO  LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALZERR                                                          
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         LA    RF,SCANRHS                                                       
         MVI   0(R1),C'Z'                                                       
         CLI   0(RF),NEGFILTR                                                   
         BNE   *+14                                                             
         MVI   0(R1),C'N'                                                       
         LA    RF,1(RF)                                                         
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RF),UP@ZERO                                                  
         BE    VALZX                                                            
*                                                                               
VALZERR  B     XITNEQ0E                                                         
VALZX    B     XITEQ0E                                                          
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'PURCHASE' OR 'EXPENSE' AND SAVES IT     *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALODTYP LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALOERR                                                          
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         MVI   0(R1),C'P'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@PRD                                                
         BE    VALOD10                                                          
         MVI   0(R1),C'E'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@EXP                                                
         BE    VALOD10                                                          
*                                                                               
VALOERR  B     XITNEQ0E                                                         
VALOD10  B     XITEQ0E                                                          
         DROP  R4                                                               
         EJECT ,                                                                
*                                                                               
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'BALANCE' OR 'UNBILLED' OR               *         
* 'ESTIMATE-CHARGES'                                                  *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALSHOW  NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALSH10                                                          
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@BALL                                               
         BNE   *+12                                                             
         MVI   0(R1),C'B'          BALANCE                                      
         B     VALSH20                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@UBLD  UNBILLED                                     
         BNE   *+12                                                             
         MVI   0(R1),C'U'                                                       
         B     VALSH20                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@EST   ESTIMATE (-CHARGES)                          
         BNE   *+12                                                             
         MVI   0(R1),C'E'                                                       
         B     VALSH20                                                          
         LA    RF,L'UP@EST                                                      
         LA    R2,SCANRHS(RF)                                                   
         CLI   0(R2),C'-'                                                       
         BE    *+12                                                             
         BCT   RF,*-12                                                          
         B     VALSH10                                                          
         SR    RE,RF                                                            
         BCTR  RE,0                                                             
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@EST                                                
         BNE   VALSH10                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   1(0,R2),UP@CHGS                                                  
         BNE   VALSH10                                                          
         MVI   0(R1),C'E'                                                       
         B     VALSH20                                                          
*                                                                               
VALSH10  B     XITNEQ                                                           
VALSH20  B     XITEQ                                                            
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* GETS OPTION VALUE VALIDATES PAYTYPE=SALARY,PENSION OR BENEFITS      *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALPAYT  NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALPAY10                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         EXCLC RE,SCANRHS,UP@SLRY                                               
         BNE   *+12                                                             
         MVI   0(R1),C'1'          SALARY                                       
         B     VALPAY20                                                         
*                                                                               
         EXCLC RE,SCANRHS,UP@BEN   BENEFIT                                      
         BNE   *+12                                                             
         MVI   0(R1),C'2'                                                       
         B     VALPAY20                                                         
*                                                                               
         EXCLC RE,SCANRHS,UP@PENSN PENSION                                      
         BNE   *+12                                                             
         MVI   0(R1),C'3'                                                       
         B     VALPAY20                                                         
*                                                                               
         EXCLC RE,SCANRHS,UP@IDR   INDIRECT                                     
         BNE   VALPAY10                                                         
         MVI   0(R1),C'4'                                                       
         B     VALPAY20                                                         
*                                                                               
VALPAY10 B     XITNEQ                                                           
VALPAY20 B     XITEQ                                                            
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'ESTIMATE' OR 'OVEREST' OR 'UNDEREST'    *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALEOU   NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALE10                                                           
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@EST                                                
         BNE   *+12                                                             
         MVI   0(R1),C'E'          ESTIMATE?                                    
         B     VALE20                                                           
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@OVEST OVER ESTIMATE?                               
         BNE   *+12                                                             
         MVI   0(R1),C'O'                                                       
         B     VALE20                                                           
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@UNEST UNDER ESTIMATE?                              
         BNE   *+12                                                             
         MVI   0(R1),C'U'                                                       
         B     VALE20                                                           
*                                                                               
VALE10   B     XITNEQ                                                           
VALE20   B     XITEQ                                                            
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'AGENCY' OR 'LOCAL' OR 'BOTH'            *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALALB   NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALALB10                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@AGY                                                
         BNE   *+12                                                             
         MVI   0(R1),C'A'          AGENCY?                                      
         B     VALALB20                                                         
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@LCLCU LOCAL?                                       
         BNE   *+12                                                             
         MVI   0(R1),C'L'                                                       
         B     VALALB20                                                         
         CLI   SVACTNUM,ACTNDETL                                                
         BE    *+12                                                             
         CLI   SVACTNUM,ACTNJBDE                                                
         BNE   VALALB10                                                         
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@BOTH  BOTH?                                        
         BNE   *+12                                                             
         MVI   0(R1),C'B'                                                       
         B     VALALB20                                                         
*                                                                               
VALALB10 B     XITNEQ                                                           
VALALB20 B     XITEQ                                                            
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* GET  OPTION VALUE CHECK IF 'OUT' OR '*OUT' AND SAVE  IT             *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALOUT   LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALOU10                                                          
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         LA    RF,SCANRHS                                                       
         MVI   0(R1),C'O'                                                       
         CLI   0(RF),C'*'                                                       
         BNE   *+14                                                             
         MVI   0(R1),C'N'                                                       
         LA    RF,1(RF)                                                         
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   0(0,RF),UP@OUT                                                   
         BE    VALOU20                                                          
*                                                                               
VALOU10  B     XITNEQ0E                                                         
VALOU20  B     XITEQ0E                                                          
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'CLIENT' OR 'SOURCE' AND SAVES IT        *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALWCS   LR    R0,RE                                                            
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALCSERR                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         LA    RF,SCANRHS                                                       
         MVI   0(R1),C'W'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@WC                                                 
         BE    VALCS10                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@WCS                                                
         BE    VALCS10                                                          
         MVI   0(R1),C'C'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@CLINL                                              
         BE    VALCS10                                                          
         MVI   0(R1),C'S'                                                       
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@SRC                                                
         BE    VALCS10                                                          
*                                                                               
VALCSERR B     XITNEQ0E                                                         
VALCS10  B     XITEQ0E                                                          
         DROP  R4                                                               
         EJECT                                                                  
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'BILL' OR 'DUE' OR 'MOS'                 *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALAGEBY NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALAG10                                                          
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@BIL   BILL?                                        
         BNE   *+12                                                             
         MVI   0(R1),C'B'          AGE BY BILL DATE                             
         B     VALAG20                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@DUE   AGE BY DUE?                                  
         BNE   *+12                                                             
         MVI   0(R1),C'D'                                                       
         B     VALAG20                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@MOA   AGE BY MOA                                   
         BNE   *+12                                                             
         MVI   0(R1),C'M'                                                       
         B     VALAG20                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@MOS   AGE BY MOS?                                  
         BNE   *+12                                                             
         MVI   0(R1),C'M'                                                       
         B     VALAG20                                                          
*                                                                               
VALAG10  B     XITNEQ                                                           
VALAG20  B     XITEQ                                                            
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* GETS OPTION VALUE CHECK IF 'DUE' (RECEIVABLES)                      *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC IS SET TO EQUAL FOR GOOD VALUE                     *         
*               CC IS SET TO EQUAL FOR BAD VALUE                      *         
***********************************************************************         
         USING SCANBLKD,R4                                                      
VALSHREC NTR1                                                                   
         MVC   FVMSGNO,=AL2(EGOPTDUP) DUPLICATE OPTION KEYWORD                  
         CLI   0(R1),0                                                          
         BNE   VALSHR10                                                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         SR    RE,RE                                                            
         IC    RE,SCANRHSL         RE=L'(OPTION VALUE IN SCAN BLOCK)            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANRHS(0),UP@DUE                                                
         BNE   *+12                                                             
         MVI   0(R1),C'D'          SHOW DUE DATE                                
         B     VALSHR20                                                         
*                                                                               
VALSHR10 B     XITNEQ                                                           
VALSHR20 B     XITEQ                                                            
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* VALIDATE MEDIA SERIAL NUMBER                                        *         
* ALLOWS A RANGE IE  A9999999  (MAX LENGTH FOR START/END IS 8 CHARS)  *         
*                   -A9999999                                         *         
*                    A9999999-                                        *         
*                    A9999999-B9999999                                *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC SET EQUAL IF RANGE VALID                           *         
*               CC SET UNEQUAL IF RANGE NOT VALID                     *         
***********************************************************************         
VALMSER  NTR1                                                                   
         BAS   RE,VALSTRNG                                                      
         BNE   VALMSERR                                                         
         LA    R0,2                                                             
         L     R4,AOPTVALS                                                      
         USING OPTVALSD,R4                                                      
         LA    R2,OSERVL1                                                       
         LA    R3,OSERLN1                                                       
VALMS10  SR    RF,RF                                                            
         ICM   RF,1,0(R3)                                                       
         BZ    VALMS20                                                          
         CHI   RF,L'OSERVL1                                                     
         BE    VALMS20                                                          
         LA    R1,WORK                                                          
         MVC   0(1,R1),0(R2)                                                    
         LA    RE,L'OSERVL1                                                     
         SR    RE,RF                                                            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   1(0,R1),ZEROS                                                    
         LA    R1,2(RE,R1)                                                      
         SHI   RF,2                                                             
         BM    VALMS05                                                          
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),1(R2)                                                    
VALMS05  MVC   0(L'OSERVL1,R2),WORK                                             
         MVI   0(R3),L'OSERVL1                                                  
VALMS20  LA    R2,OSERVL2                                                       
         LA    R3,OSERLN2                                                       
         BCT   R0,VALMS10                                                       
*                                                                               
VALMSX   B     XITEQ                                                            
VALMSERR B     XITNEQ                                                           
         DROP  R4                                                               
         EJECT ,                                                                
***********************************************************************         
* VALIDATE STATUS= OPTION                                             *         
* ON ENTRY      R1=A(OPTION SAVE AREA IN TWA)                         *         
*               R4=A(SCAN ENTRY CONTAINING OPTION)                    *         
*               R3=A(OPTION TABLE ENTRY CORRESPONDING TO SCAN OPTION) *         
* ON EXIT       CC EQUAL MEANS VALID OPTION                           *         
*               CC UNEQUAL MEANS DUPLICATE KEYWORD                    *         
***********************************************************************         
         SPACE 1                                                                
         USING SCANBLKD,R4                                                      
         USING OPTVALSD,RF                                                      
VALSTA   DS    0H                  STATUS=X                                     
         L     RF,AOPTVALS                                                      
         CLI   OSTAT,C' '          ALREADY SET?                                 
         BNH   *+10                                                             
         MVC   FVMSGNO,=AL2(AE$DIOPT) DUPLICATE/INCOMPATIBLE OPTIONS            
         CLI   0(R1),0                                                          
         BNE   VALSTAER                                                         
         MVC   FVMSGNO,=AL2(AE$INALP) MUST BE ALPHABET VALUE                    
         CLI   SCANRHS,C'A'                                                     
         BL    VALSTAER                                                         
         CLI   SCANRHS+1,C'Z'                                                   
         BH    VALSTAER                                                         
         MVC   0(L'OSTAT,R1),SCANRHS  SAVE OPTION VALUE                         
*                                                                               
VALSTAX  CR    RB,RB               CC SET TO EQUAL                              
         BR    RE                                                               
VALSTAER LTR   RB,RB               CC SET TO UNEQUAL                            
         BR    RE                                                               
         DROP  R4,RF                                                            
         EJECT                                                                  
***********************************************************************         
* COMMON ERROR EXITS                                                  *         
***********************************************************************         
ERROFF   TM    1(R1),OFFAESEC                                                   
         BO    ERRSECLO                                                         
         B     ERRINVOF                                                         
ERRSHRT  MVC   FVMSGNO,=AL2(EGIFSHRT)                                           
         B     FVERR                                                            
ERRNOTV  MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         B     FVERR                                                            
ERROPTNV MVC   FVMSGNO,=AL2(AE$OPTNV)                                           
         B     FVERR                                                            
ERRISCRL MVC   FVMSGNO,=AL2(EASCRINV)                                           
         B     FVERR                                                            
ERRLONG  MVC   FVMSGNO,=AL2(EGIFLONG)                                           
         B     FVERR                                                            
ERRINVDT MVC   FVMSGNO,=AL2(EGDATINV)                                           
         B     FVERR                                                            
ERRNONE  MVC   FVMSGNO,=AL2(EGIFMISS)                                           
         B     FVERR                                                            
ERRKDUP  MVC   FVMSGNO,=AL2(EGOPTDUP)                                           
         B     FVERR                                                            
ERRERNF  MVC   FVMSGNO,=AL2(EGRECNOF)                                           
         B     FVERR                                                            
ERRIAMNT MVC   FVMSGNO,=AL2(EAAMTINV)                                           
         B     FVERR                                                            
ERRSECLO MVC   FVMSGNO,=AL2(EASECLOC)                                           
         B     FVERR                                                            
ERROFFN2 MVC   FVMSGNO,=AL2(AE$OFFN2)                                           
         B     FVERR                                                            
ERRINVOF MVC   FVMSGNO,=AL2(AE$IVOFF)                                           
         B     FVERR                                                            
ERRRANGE MVC   FVMSGNO,=AL2(EARNGINV)                                           
ERRMSGON B     FVERR                                                            
         EJECT ,                                                                
*                                                                               
***********************************************************************         
* ROUTINE TO OUTPUT ERROR MESSAGE, FIELD INDEX INFO & EXTRA MESSAGE   *         
* NTRY - FVADDR=A(FIELD HEADER OF FIELD IN ERROR)                     *         
*        FVMSGNO=FIELD ERROR NUMBER                                   *         
*        FVFLAG=ZERO IF A STANDARD CONTROLLER ERROR MESSAGE REQUIRED  *         
*        FVOSYS=OVERRIDE SYSTEM FOR GETTXT CALL (ZERO=STANDARD)       *         
*        FVINDX=MULTIPLE FIELD INDEX NUMBER                           *         
*        FVSUBX=MULTIPLE FIELD SUB-INDEX NUMBER                       *         
*        FVXTRA=USER SUPPLIED MESSAGE TO TACK ONTO GENERAL MESSAGE    *         
* NTR AT FVERR  TO SET MULTIPLE FIELD INDEX VALUES TO ZERO            *         
*        FVERRX ONLY TO SET CURSOR TO FIELD ADDRESSED BY FVADDR       *         
***********************************************************************         
         USING GETTXTD,R2                                                       
FVERR    LA    R2,PARM             DEFINE GETTXT CONTROL BLOCK                  
         XC    GTBLOCK,GTBLOCK                                                  
         MVC   GTINDX,FVINDX                                                    
         MVC   GTSUBX,FVSUBX                                                    
         MVC   GTMSGNO,FVMSGNO                                                  
*        CLI   GTINDX,X'FF'        PUTTING PATCH TO SOLVE IMDB#2317231          
*        BNE   *+6                 AND IMDB#2361501 PROBLEM                     
*        DC    H'0'                INVALID OR NO DATA RECEIVED                  
         MVC   GTMSYS,FVOSYS       OVERRIDE SYSTEM (IF SET)                     
         MVC   GTMTYP,FVOMTYP      OVERRIDE MESSAGE TYPE (IF SET)               
         CLI   GTMSGNO,X'FF'       STD CONTROLLER MSG                           
         BNE   *+12                                                             
         MVI   GTMSGNO,0                                                        
         MVI   GTMSYS,X'FF'        GENERAL SYSTEM MESSAGE                       
         OC    GTMSGNO,GTMSGNO     MESSAGE 0 = DATAMGR ERR                      
         BNZ   FVERR10                                                          
         LA    R1,DMCB                                                          
         STCM  R1,7,GTADMCB                                                     
         OI    GT1INDS,GT1DMGRE                                                 
FVERR10  CLI   FVXTRA,C' '         LOOK FOR ADDITIONAL TEXT                     
         BNH   FVERR20                                                          
         LA    R1,FVXTRA                                                        
         STCM  R1,7,GTATXT                                                      
         LA    RF,L'FVXTRA-1(R1)                                                
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         SR    RF,R1                                                            
         LA    RF,1(RF)                                                         
         STC   RF,GTLTXT                                                        
*                                                                               
FVERR20  LA    R2,PARM             PARM DEFINED INTERNALLY                      
         CLI   GTMSGNO,X'FF'       CHECK FOR GENERAL MESSAGES                   
         BNE   *+12                                                             
         MVI   GTMSYS,X'FF'        FORCE SYSTEM ZERO LOOKUP                     
         MVI   GTMSGNO,0                                                        
         XC    BASHEAD,BASHEAD                                                  
         GOTO1 VGETTXT,GETTXTD                                                  
         DROP  R2                                                               
*                                                                               
FVERRX   OI    BASHEADH+(FVOIND-FVIHDR),FVOXMT                                  
         ICM   R1,15,FVADDR        TEST IF OVERLAY SET FIELD ADDRESS            
         BZ    *+8                                                              
         OI    FVOIND-FVIHDR(R1),FVOCUR                                         
*                                                                               
         USING TSARD,R1                                                         
         L     R1,ATSARBLK         SAVE TSAR BUFFER ON DISK                     
         TM    TWAMODE,TWAMSAV1    NEED TO SAVE FIRST TEMPEST BUFF?             
         BNO   FVERRX10                                                         
         MVI   TSACTN,TSASAV       YES - SAVE IT                                
         MVC   TSACOM,ACOMFACS     SET A(COMFACS) - FOR HELP SCREENS            
         GOTO1 VTSAR                                                            
*                                                                               
FVERRX10 CLC   TS2FIRST,=H'0'      2ND  TSAR BUFFER IN USE ?                    
         BE    FVHLPX              NO,  SKIP                                    
         L     R1,ATSARBKB         SAVE TSAR BUFFER ON DISK                     
         TM    TWAMODE,TWAMSAV2    NEED TO SAVE SECOND TEMPEST BUFF?            
         BNO   FVHLPX                                                           
         MVI   TSACTN,TSASAV       YES - SAVE IT                                
         MVC   TSACOM,ACOMFACS     SET A(COMFACS) - FOR HELP SCREENS            
         GOTO1 VTSAR                                                            
*                                                                               
FVHLPX   CLI   TEMPSPAG,1          TEMPSTR PAGE 1 USED?                         
         BNE   FVSHIP                                                           
         GOTO1 VDATAMGR,DMCB,DMWRT,TEMPSTR,(1,0),ATIA                           
         CLI   8(R1),0                                                          
         BE    FVSHIP                                                           
         DC    H'0'                CAN'T SAVE TEMPSTR                           
         DROP  R1                                                               
*                                                                               
FVSHIP   TM    PCDRIVEN,PCGRIDQ+PCBINTQ TEST GRIDS AND PKZIP SUPPORT            
**NOP    BO    FVSHIP10      <--------- NOT USED FOR NOW, NEEDS NEW             
**NOP    XC    OSIN,OSIN     <--------- VERSION OF CONNECTION MANAGER           
**NOP    GOTOR VGETFACT,DMCB,(X'80',OSIN),F#OSISET                              
         B     XIT                                                              
*                                                                               
         USING FHD,R2                                                           
FVSHIP10 LA    R2,BASHEADH         TRANSMIT SCREEN TO AVOID PC PAK WOES         
         XR    RF,RF                                                            
FVSHIP20 ICM   RF,1,FHLN           END OF SCREEN?                               
         BZ    FVSHIP03            YES                                          
         NI    FHII,X'FF'-FHIITH                                                
         OI    FHII,FHIIPR+FHIIVA                                               
         OI    FHOI,FHOITR                                                      
         BXH   R2,RF,FVSHIP20                                                   
         DROP  R2                                                               
*                                                                               
         USING SHIPBLKD,R3                                                      
FVSHIP03 LA    R3,WORK                                                          
         XC    WORK,WORK                                                        
         LA    RE,SAVESHIP                                                      
         ST    RE,SHIPSHIP                                                      
*                                                                               
         CLI   SHIPIND,1           FIRST TRANSACTION                            
         BNE   FVSHIP40                                                         
         OI    SHIPFLAG,SHIPFFST                                                
         GOTOR VGETFACT,DMCB,(X'80',OSIN),F#OSIMAK                              
         GOTOR (RF),(R1),(X'80',OSIN),F#OSISET                                  
*                                                                               
FVSHIP40 TM    GMSGFLG,GMSG        MAKE SURE IT IS A GRIDS MESSAGE              
         BNO   FVSHIP50                                                         
         CLC   GRMSG1,BASHEAD      C'GRID NEXTL '                               
         BNE   FVSHIP50                                                         
*                                                                               
         CLI   SHIPCNT,35          35 SCREENS FIT IN ONE BUFFER                 
         BNE   *+12                                                             
         MVI   SHIPCNT,0                                                        
         B     FVSHIP50                                                         
*                                                                               
         TM    OVRSTAT,OVRGDONE    HAVE ALL RECORDS BEEN READ?                  
         BNO   *+8                                                              
FVSHIP50 OI    SHIPFLAG,SHIPFEND   LAST FOR THIS COMPRESSION                    
         OI    SHIPFLAG,SHIPFVGC   WE HOPE                                      
         DROP  R3                                                               
*                                                                               
         GOTO1 SHIPIT,(R3)                                                      
         BNE   XIT                                                              
*                                                                               
         LLC   RF,SHIPCNT          BUMP SHIP BUFFER COUNT                       
         AHI   RF,1                                                             
         STC   RF,SHIPCNT                                                       
*                                                                               
FVSHIP80 LA    RE,WORKD                                                         
         AHI   RE,OVERWORK-WORKD   CLEAR OVERLAY WORKING STORAGE                
         LHI   RF,L'OVERWORK                                                    
         XCEF                                                                   
*                                                                               
         SAM24                                                                  
         B     INIT80                                                           
                                                                                
***********************************************************************         
XITEQ0E  CR    RB,RB             RESTORE RE WITH R0 AND EXIT EQUAL              
         B     *+6                                                              
XITNEQ0E LTR   RB,RB             RESTORE RE WITH R0 AND EXIT NOT EQUAL          
         LR    RE,R0                                                            
         BR    RE                                                               
*                                                                               
XITEQ    CR    RB,RB             EXIT SUBROUTINE EQUAL                          
         J     XIT                                                              
XITNEQ   LTR   RB,RB             EXIT SUBROUTINE NOT EQUAL                      
XIT      XIT1                                                                   
         EJECT                                                                  
*                                                                               
***********************************************************************         
*                                                                               
DMWRT    DC    C'DMWRT  '                                                       
DMREAD   DC    C'DMREAD '                                                       
TEMPSTR  DC    C'TEMPSTR '                                                      
ZEROS    DC    C'00000000'                                                      
ACTDIS   DC    X'01'                                                            
HEXFFS   DC    20X'FF'                                                          
SINCUL   DC    C'SI'                                                            
GPROUL   DC    C'GP'                                                            
GRSDOR   EQU   17                                                               
GRSDAT   EQU   3                                                                
*                                                                               
GRMSG1   DC    C'GRID NEXTL '                                                   
         DC    C'DOR '                                                          
GRMDOR   DC    C'17 '                                                           
         DC    C'DATA '                                                         
GRM1DAT  DC    C'20 '                                                           
         DC    C'EID '                                                          
GRMEID   DC    C'026 '                                                          
         DC    C'WR ',AL1(GCTSEPQ)                                              
GRMSG1Q  EQU   *-GRMSG1                                                         
*                                                                               
GRMSG2   DC    C'GRID NEXTL '                                                   
         DC    C'DATA '                                                         
GRM2DAT  DC    C'17'                                                            
GRMSG2Q  EQU   *-GRMSG2                                                         
*                                                                               
GRMSG3   DC    C'GRID NEXTL PR'                                                 
GRMSG3Q  EQU   *-GRMSG3                                                         
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
                                                                                
***********************************************************************         
* PROTECT LIST SUB-ACTION FIELDS IF NO A/C CODE COLUMNS                         
***********************************************************************         
PROLSUB  NTR1  BASE=*,LABEL=*                                                   
         SR    R2,R2                                                            
         ICM   R2,1,DISSTART                START POS FOR DATA DISPLAY          
         BZ    PLSUBX                       EXIT IF NO START POSITION!          
         SHI   R2,1                                                             
         MHI   R2,LSTACT3H-LSTACT2H                                             
         LA    R2,LSTACT2H(R2)              FIRST LIST SUB-ACTION LINE          
         USING FLDHDRD,R2                                                       
         LHI   RE,LSTACT3H-LSTACT2H                                             
         LA    RF,LSTACTLH                  LAST LIST SUB-ACTION LINE           
T        USING FLDHDRD,R4                                                       
PLSUB10  LA    R4,LSTDAT2H-LSTACT2H(R2)     R4=SCREEN DATA FIELD                
         OI    FLDOIND,FOUTPRT+FOUTTRN      PROTECT FIELD & TRANSMIT            
         TM    LSTINDS,LSTINCR              CLEAR SUB-ACTIONS FIELD?            
         BO    *+10                         NO - OK                             
         MVC   FLDDATA(L'LSTACT2),SPACES    CLEAR SUB-ACTION FIELD              
         CLC   T.FLDDATA(L'ACTKACT),SPACES  ANY ACCOUNT CODE                    
         BNH   PLSUB20                                                          
         CLC   T.FLDDATA(L'LC@TOTAL),LC@TOTAL TEST FOR TOTAL                    
         BE    PLSUB20                                                          
         NI    FLDOIND,X'FF'-FOUTPRT        UNPROTECT THIS LIST FIELD           
PLSUB20  BXLE  R2,RE,PLSUB10                                                    
PLSUBX   J     XIT                                                              
         DROP  T                                                                
         LTORG                                                                  
         EJECT                                                                  
                                                                                
**********************************************************************          
*        TEST OPTION                                                 *          
* ON ENTRY P1=(ACCOUNT NUMBER,OPTION TABLE ENTRY)                    *          
*          P2=(CURRENT SCAN BLOCK)                                   *          
* ON EXIT  CC EQUAL MEANS VALID OPTION                               *          
*          CC HIGH  MEANS INVALID OPTION                             *          
*          CC LOW   MEANS INVALID OPTION WITH FVMSGNO SET            *          
**********************************************************************          
         USING OPTTABD,R3                                                       
         USING SCANBLKD,R4                                                      
TSTOPT   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         TM    OPTFLAG,OPTFSTP     2 CHAR MATCH NOT FOUND ON FRST PASS?         
         BNO   TSTOPT10                                                         
         CLI   SCANLHSL,OPTSHLNQ                                                
         BNL   *+14                                                             
         MVC   FVMSGNO,=AL2(AE$FLDTS)                                           
         B     TSTOPTL             INPUT FIELD TOO SHORT                        
         BH    TSTOPT10                                                         
         SR    RF,RF                                                            
         ICM   RF,3,OPTSHNAM       RF=(DISPLACEMENT TO 2 CHAR NAME)             
         LA    RF,WORKD(RF)        RF=A(2 CHAR NAME)                            
         CLC   0(OPTSHLNQ,RF),SCANLHS MATCHED ON TWO CHAR NAME?                 
         BE    TSTOPT20                                                         
         B     TSTOPTH                                                          
*                                                                               
TSTOPT10 CLI   SCANLHSL,OPTLOLNQ   TRY AND MATCH PART/ALL OF FULL NAME          
         BNH   *+14                                                             
         MVC   FVMSGNO,=AL2(AE$FLDTL)                                           
         B     TSTOPTL             INPUT FIELD TOO LONG                         
*                                                                               
         SR    RE,RE                                                            
         IC    RE,SCANLHSL                                                      
         BCTR  RE,0                                                             
         SR    RF,RF                                                            
         ICM   RF,3,OPTLONAM      RF=(DISPLACEMENT TO FULL OPTION NAME)         
         LA    RF,WORKD(RF)       RF=A(LONG OPTION NAME)                        
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   SCANLHS(0),0(RF)                                                 
         BNE   TSTOPTH                                                          
*                                                                               
TSTOPT20 TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BZ    TSTOPT30                                                         
         TM    OPTSTAT,OPTNGRDQ    TEST IF OPTION VALID FOR GRID?               
         BZ    TSTOPT30                                                         
         MVC   FVMSGNO,=AL2(AE$OPTIN)                                           
         B     TSTOPTL             OPTION INVALID FOR GRID                      
*                                                                               
TSTOPT30 LA    RF,OPTACTNS                                                      
         CLI   0(RF),ACTNALLX      TEST ALL ACTIONS EXCEPT...                   
         BNE   TSTOPT40                                                         
         LA    RF,1(,RF)                                                        
TSTOPT34 CLI   0(RF),EOT           TEST ACTION EXCLUSIONS                       
         BE    TSTOPT50            NOT FOUND - PASS THIS ACTION                 
         CLC   SVACTNUM,0(RF)                                                   
         BE    TSTOPTH             FOUND - FAIL THIS ACTION                     
         LA    RF,1(,RF)                                                        
         B     TSTOPT34                                                         
*                                                                               
TSTOPT40 CLI   0(RF),EOT                                                        
         BE    TSTOPTH                                                          
         CLC   SVACTNUM,0(RF)                                                   
         BE    TSTOPT50                                                         
         LA    RF,1(,RF)                                                        
         B     TSTOPT40                                                         
*                                                                               
TSTOPT50 CLC   BASKEY,SPACES       ACCOUNT NOT YET ENTERED?                     
         BNH   TSTOPT60                                                         
         CLI   OPTLN,OPTTABL       ACTION/LEDGER LIST PRESENT?                  
         BNH   TSTOPT60                                                         
         LA    R1,OPTACT           R1=A(VALID ACTION/LEDGER LIST)               
         LA    RE,L'OPTACT+L'OPTLEDG RE=L'(ACTION/LEDGER LIST ENTRY)            
         SR    RF,RF                                                            
         IC    RF,OPTLN                                                         
         LA    RF,OPTSHNAM(RF)     RF=A(END OF OPTION ENTRY                     
         SHI   RF,L'OPTACT+L'OPTLEDG                                            
         CLC   SVACTNUM,0(R1)      MATCH ON ACTION NUMBER                       
         BE    *+12                                                             
         BXLE  R1,RE,*-10                                                       
         B     TSTOPT60                                                         
         LA    R1,L'OPTACT(,R1)    RF=A(VALID LEDGERS FOR THIS ACTION)          
         LA    R0,L'OPTLEDG/L'SPROUL                                            
TSTOPT54 CLC   BASKEY(L'SPROUL),0(R1) MATCH ON LEDGER?                          
         BE    TSTOPT60                                                         
         LA    R1,L'SPROUL(R1)     BUMP TO NEXT LEDGER                          
         BCT   R0,TSTOPT54                                                      
         OI    OPTFLAG,OPTINLDG    INVALID LEGDER                               
         B     TSTOPTH                                                          
*                                                                               
TSTOPT60 TM    OPTSTAT,OPT2CHQ     2 CHAR OFFICE ONLY?                          
         BNO   TSTOPT64                                                         
         TM    COMPSTA4,CPYSOFF2   2 CHAR OFFICE COMPANY?                       
         BNO   TSTOPTH                                                          
*                                                                               
TSTOPT64 TM    OPTSTAT,OPTDDSQ     DDS ONLY?                                    
         BNO   TSTOPTE                                                          
         CLI   TWAOFFC,C'*'                                                     
         BNE   TSTOPTH                                                          
*                                                                               
TSTOPTL  MVI   BYTE1,0             EXIT WITH CC SET TO LESS                     
         B     TSTOPTX                                                          
TSTOPTH  MVI   BYTE1,2             EXIT WITH CC SET TO HIGH                     
         B     TSTOPTX                                                          
TSTOPTE  MVI   BYTE1,1             EXIT WITH CC SET TO EQUAL                    
TSTOPTX  CLI   BYTE1,1                                                          
         J     XIT                                                              
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
                                                                                
***********************************************************************         
* REBUILD SCREEN AFTER HELP HAS BEEN DISPLAYED                                  
***********************************************************************         
BLDSCRN  NTR1  BASE=*,LABEL=*                                                   
         L     RE,ASVSCRN                                                       
         LA    R1,L'SVSCRN                                                      
         LR    RF,R1                                                            
         LA    R0,ENQDAT1H                                                      
         MVCL  R0,RE               GET SCREEN BACK                              
         LA    R2,BASHEADH                                                      
         USING FLDHDRD,R2                                                       
         SR    RF,RF                                                            
BLDSC10  ICM   RF,1,0(R2)                                                       
         BZ    *+14                                                             
         OI    FLDOIND,FOUTTRN                                                  
         AR    R2,RF                                                            
         B     BLDSC10                                                          
         MVI   FLDLEN,0            SET EOS                                      
         MVI   FLDLEN+1,1          FORCE DELETE SCREEN                          
         J     XIT                                                              
         LTORG                                                                  
         DROP  R2                                                               
         EJECT                                                                  
                                                                                
***********************************************************************         
* GENERAL ROUTINES                                                    *         
***********************************************************************         
ROUT1    CSECT                                                                  
         NMOD1 250,**ROU1**,R8,R7,R6,CLEAR=YES                                  
         USING TWAD,RA                                                          
         USING WORKD,R9                                                         
         SRL   RF,32-8                                                          
         SLL   RF,2                                                             
         B     ROUTS1(RF)                                                       
*                                                                               
ROUTS1   DS    0XL4                                                             
         B     BLDDIS              BUILD DISPLAY COLUMNS                        
         B     DISPFK              DISPLAY PFKEY LINE                           
         B     IOEX                I/O ROUTINE                                  
         B     TSARADD             ADD A RECORD TO TSAR                         
         B     TSARGET             GET A RECORD FROM TSAR                       
         B     DISPLAY             DISPLAY DUMMY SCREEN LINES                   
         B     SCRNCLR             CLEAR DATA LINES ON SCREEN                   
         B     UNITLDGR            GET UNIT/LEDGER ATTRIBUTES                   
         B     DISUL               DISPLAY UNIT/LEDGER NAMES                    
         B     GETJOB              GET A JOB RECORD                             
         B     CNAME               GET CONTRA ACCOUNT NAME                      
         B     SCOMP               STRING COMPARE                               
         B     DCOMP               DATE COMPARE                                 
         B     XDETDIS             DISPLAY XTRA DETAIL LINE                     
         B     OFFACC              CHECK ACCOUNT SECURITY                       
         B     OFFTRN              CHECK TRANSACTION SECURITY                   
         B     BUKMAKE             GET BUCKET AMOUNT FROM TRANSACTION           
         B     BLDSRC              GET SOURCE ACCOUNT                           
         B     BLOVDIS             VALIDATE DISPLAY COLUMNS                     
         B     XDFCURR             XTRA DETAIL FOREIGN CURRENCY                 
         B     GETCURR             GET CURRENCY TABLE ENTRY                     
         B     READUP              READ FILE UP FRONT                           
         B     NXTREC              GET NEXT RECORD                              
         B     SETELE              SET ELEMENT ADDRESSES                        
         B     GETACC              GET ACCOUNT RECORD                           
         B     DISACC              DISPLAY ACCOUNT/CONTRA NAMES                 
         B     SCRNDIM             GET SCREEN DIMENSIONS                        
         B     DEFMTH              GET DEFAULT MONTH RANGE                      
         B     PERDIS              GET DEFAULT MONTH RANGE                      
         B     OFFOFF              CHECK SECURITY IN OFFICE/ACCOUNT             
         B     SETFIS              SET FISCAL YEAR AND OBFWD OPTION             
         B     DISMOS              DISPLAY MOS AND BBF INFORMATION              
         B     DISGRD              DISPLAY GRID LINES                           
         B     DWNL                DOWNLOAD ROUTINE                             
         B     OVRSCR              LOAD SCREEN                                  
         B     CHKACT              CHECK ACTION                                 
         B     CHKKEY              CHECK NEW KEY                                
         B     TSTUL               TEST UNIT/LEDGER                             
         J     GETEID              GET ENQUIRY ID NUMBER                        
         J     BLDDOR              BUILD GRID DETAIL OF REQUEST                 
*                                                                               
ROUTL1   MVI   BYTE1,0             SET CC LOW                                   
         J     ROUTCC1                                                          
ROUTH1   MVI   BYTE1,2             SET CC HIGH                                  
         J     ROUTCC1                                                          
ROUTE1   MVI   BYTE1,1             SET CC EQUAL                                 
ROUTCC1  CLI   BYTE1,1                                                          
*                                                                               
ROUTX1   XIT1                      EXIT WITH CC SET                             
         EJECT                                                                  
***********************************************************************         
* PROCESS HORIZONTLE SCROLLING- BUILD COLUMN HEADINGS AND COLUMN      *         
* DISPLACEMENTS                                                       *         
* IF FIRST TIME FOR DISPLAY OR NOT HORIZONTAL SCROLL PFKEY OR         *         
* RETURNING FROM MAX IO THEN IGNORE THIS ROUTINE                      *         
***********************************************************************         
         USING BDWORKD,RC                                                       
*                                                                               
BLDDIS   XC    BDWORKD(BDWORKX-BDWORKD),BDWORKD                                 
         XC    BLDSDSP(BLDSDSPL),BLDSDSP                                        
         L     RF,ADCLTAB          RF=A(DEFAULT COLUMN TABLE)                   
         USING DCLTABD,RF                                                       
BLD1     CLI   DCLACTN,EOT         END OF TABLE?                                
         BNE   *+6                                                              
         DC    H'0'                ENTRY MISSING FROM DCLTAB                    
         CLC   DCLACTN,SVACTNUM    MATCH ON ACTION NUMBER?                      
         BE    BLD3                                                             
         XR    R0,R0               BUMP TO NEXT ENTRY                           
         IC    R0,DCLLEN                                                        
         AR    RF,R0                                                            
         B     BLD1                                                             
*                                                                               
BLD3     XR    RE,RE                                                            
         ICM   RE,3,DCLACOL        DISPLACEMENT TO COL TABLE                    
         L     R1,ADISTAB                                                       
         AR    R1,RE                                                            
         ST    R1,ADISENT          SAVE ADDRESS OF COLUMN TABLE                 
         DROP  RF                                                               
*                                                                               
         L     R0,ADUMLINE         CLEAR DUMMY SCREEN LINES                     
         LHI   R1,DUMLINLN                                                      
         SR    RE,RE                                                            
         LA    RF,X'40'                                                         
         SLL   RF,24                                                            
         MVCL  R0,RE                                                            
         XR    R0,R0                                                            
         IC    R0,HORNDIS          R0=NUMBER OF DISPLAYED COLUMNS               
         XR    R1,R1                                                            
         IC    R1,HORIDIS          R1=INDEX TO DISPLAYED COLUMNS                
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,1,BLOKEYN        NUMBER OF COLUMNS IN KEY                     
         BZ    BLDDISA                                                          
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   BDTEMP(0),BLOKEY                                                 
*                                                                               
BLDDISA  CLI   PFKEY,PF9           LEFT?                                        
         BE    BLDDIS08                                                         
         CLI   PFKEY,PF10          RIGHT?                                       
         BNE   BLDDIS12                                                         
*                                  SCROLL RIGHT                                 
         CLC   UP@PAGE,ENQSCRL     PAGE?                                        
         BNE   *+10                                                             
         AR    R1,R0                                                            
         B     BLDDIS12                                                         
         CLC   UP@HALF,ENQSCRL     HALF?                                        
         BNE   BLDDIS02                                                         
         SRA   R0,1                                                             
         BNZ   *+6                                                              
         XR    R1,R1                                                            
         AR    R1,R0                                                            
         B     BLDDIS12                                                         
BLDDIS02 SR    R0,R0               ASSUME NUMERIC                               
         IC    R0,SCRLAMT                                                       
         AR    R1,R0                                                            
         B     BLDDIS12                                                         
*                                  SCROLL LEFT                                  
BLDDIS08 CLC   UP@MAX,ENQSCRL      TEST MAXIMUM SCROLL LEFT                     
         BNE   *+10                                                             
         SR    R1,R1                                                            
         B     BLDDIS12                                                         
         CLC   UP@HALF,ENQSCRL     HALF?                                        
         BNE   *+14                                                             
         SRL   R0,1                                                             
         SR    R1,R0                                                            
         B     BLDDIS12                                                         
         CLC   UP@PAGE,ENQSCRL     PAGE?                                        
         BNE   BLDDIS10                                                         
         LTR   R1,R1                                                            
         BZ    BLDDIS12                                                         
*                                                                               
         OI    BDFLAG,BDFINVRT                                                  
*                                                                               
BLDDIS09 SR    RE,RE                                                            
         IC    RE,BLOKEYN                                                       
         LR    R0,R1                                                            
         LA    RE,BDTEMP(RE)       INVERT DISPLAY PROFILE                       
         LA    RF,BLODIS(R1)                                                    
         BCTR  RF,0                                                             
         MVC   0(1,RE),0(RF)                                                    
         LA    RE,1(RE)                                                         
         BCT   R1,*-12                                                          
         B     BLDDIS22                                                         
*                                                                               
BLDDIS10 SR    R0,R0               AMOUNT ASSUMED                               
         IC    R0,SCRLAMT                                                       
         SR    R1,R0                                                            
*                                                                               
BLDDIS12 LA    RE,BLODIS+L'BLODIS-1                                             
         LA    RF,L'BLODIS                                                      
         CLI   0(RE),0                                                          
         BNE   *+12                                                             
         BCTR  RE,0                                                             
         BCT   RF,*-10                                                          
         DC    H'0'                                                             
         LTR   R1,R1                                                            
         BM    BLDDIS14                                                         
         CR    R1,RF                                                            
         BL    BLDDIS16                                                         
*                                                                               
BLDDIS14 SR    R1,R1                                                            
*                                                                               
BLDDIS16 STC   R1,HORIDIS                                                       
         SR    RF,R1                                                            
         LA    R1,BLODIS(R1)                                                    
         SR    RE,RE                                                            
         IC    RE,BLOKEYN                                                       
         LA    RE,BDTEMP(RE)                                                    
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),0(R1)                                                    
*                                                                               
BLDDIS22 LA    R5,BDTEMP           R5=A(DISPLAY COLUMN PROFILE)                 
         SR    R3,R3               R3=DISPLACEMENT TO DISPLAY VALUE             
*                                                                               
BLDDIS24 CLI   0(R5),0             TEST END OF COLUMN DEFINITIONS               
         BE    BLDDIS42                                                         
         L     R2,ADISENT                                                       
         USING DISTABD,R2          R2=A(DISPLAY COLUMN TABLE)                   
BLDDIS26 CLI   DISTABD,EOT         TEST EOT                                     
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLC   DISCOL,0(R5)        TEST COLUMN MATCH                            
         BE    *+12                                                             
         LA    R2,DISTABL(R2)                                                   
         B     BLDDIS26                                                         
*                                                                               
         TM    BDFLAG,BDFPASS2     TEST SECOND PASS                             
         BNZ   BLDDIS32                                                         
         LA    RF,BDWORK                                                        
         CLI   0(RF),0                                                          
         BE    *+12                                                             
         LA    RF,1(RF)                                                         
         B     *-12                                                             
*                                                                               
         SR    RE,RE                                                            
         IC    RE,DISWID                                                        
         AR    RE,R3               ADD DISPLACEMENT SO FAR                      
         CLM   RE,1,=AL1(L'DUMLIN1)                                             
         BH    BLDDIS42            OVERFLOW - DROP THIS COLUMN                  
         LA    R3,1(RE)            R3=DISPLACEMENT TO NEXT COLUMN               
         MVC   0(1,RF),DISCOL                                                   
         IC    RF,BDCOLS           BUMP NUMBER OF DISPLAY COLUMNS               
         LA    RF,1(RF)                                                         
         STC   RF,BDCOLS                                                        
         B     BLDDIS40                                                         
*                                                                               
BLDDIS32 LA    RF,1(R3)            DISPLACEMENT SO FAR +1                       
         SR    RE,RE                                                            
         IC    RE,0(R5)                                                         
         STC   RF,BLDSDSP-1(RE)    SET SCREEN LINE DISPLACEMENT                 
         CLI   DISNAM1,0                                                        
         BE    BLDDIS34                                                         
         MVC   WORK(L'DISNAM1),DISNAM1                                          
         TM    DISSTAT,DISUPPRQ    UPPER CASE?                                  
         BO    BLDDIS33                                                         
         GOTO1 VDICTATE,DMCB,C'SL  ',WORK                                       
         B     BLDDS33A                                                         
BLDDIS33 GOTO1 VDICTATE,DMCB,C'SU  ',WORK                                       
BLDDS33A XR    RE,RE                                                            
         ICM   RE,1,DISHWI         HEADING WIDTH OVERRIDE                       
         BNZ   *+8                                                              
         IC    RE,DISWID           COLUMN WIDTH                                 
         BCTR  RE,0                                                             
         L     R4,ADUMLINE                                                      
         LA    R4,0(R3,R4)                                                      
         EX    RE,*+8                                                           
         B     BLDDIS34                                                         
         MVC   0(0,R4),WORK                                                     
*                                                                               
BLDDIS34 CLI   DISNAM2,0                                                        
         BE    BLDDIS38                                                         
         L     R4,ADUMLINE                                                      
         LA    R4,DUMLIN2-DUMLINED(R3,R4) INDEX TO SECOND HEADLINE              
         MVC   WORK(L'DISNAM2),DISNAM2                                          
         TM    DISSTAT,DISUPPRQ    UPPER CASE?                                  
         BO    BLDDIS35                                                         
         GOTO1 VDICTATE,DMCB,C'SL  ',WORK                                       
         B     BLDDS35A                                                         
BLDDIS35 GOTO1 VDICTATE,DMCB,C'SU  ',WORK                                       
BLDDS35A XR    RE,RE                                                            
         ICM   RE,1,DISHWI         HEADING WIDTH OVERRIDE                       
         BNZ   *+8                                                              
         IC    RE,DISWID           COLUMN WIDTH                                 
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     BLDDIS38                                                         
         MVC   0(0,R4),WORK                                                     
*                                                                               
BLDDIS38 SR    RE,RE                                                            
         IC    RE,DISWID           RESET COLUMN WIDTH                           
         LA    R3,1(R3,RE)         R3=DISPLACEMENT TO NEXT COLUMN               
         LR    RE,R5               RE=A(CURRENT COLUMN CODE)                    
         LA    R0,BDTEMP-1         R0=A(FIRST COLUMN CODE-1)                    
         SR    RE,R0               RE=(CURRENT COLUMN NUMBER)                   
         CLM   RE,1,BLOKEYN        COLUMN PART OF KEY?                          
         BNH   BLDDIS40                                                         
         A     R3,FULL             ADD CONSTANT FACTOR FOR SPARE                
*                                                                               
BLDDIS40 LA    R5,1(R5)            BUMP TO NEXT FIELD                           
         B     BLDDIS24            PERFORM FOR NUMBER OF PROFILES               
*                                                                               
BLDDIS42 TM    BDFLAG,BDFPASS2     TEST SECOND PASS                             
         BNZ   BLDDISX             YES - WE HAVE FINISHED                       
         TM    BDFLAG,BDFINVRT     TEST INVERTED LIST                           
         BZ    BLDDIS44                                                         
         MVC   BDSAVE,BDTEMP RE-INVERT LIST                                     
         SR    R1,R1                                                            
         ICM   R1,1,BDCOLS                                                      
         BNZ   *+6                                                              
         DC    H'0'                                                             
         LA    RF,BDSAVE(R1)                                                    
         XR    RE,RE                                                            
         IC    RE,BLOKEYN                                                       
         SR    R1,RE                                                            
         LA    RE,BDTEMP(RE)                                                    
         BCTR  RF,0                                                             
         MVC   0(1,RE),0(RF)                                                    
         LA    RE,1(RE)                                                         
         BCT   R1,*-12                                                          
*                                                                               
         XR    R1,R1               ADJUST INDEX VALUE                           
         IC    R1,BDCOLS                                                        
         XR    RE,RE                                                            
         IC    RE,BLOKEYN                                                       
         SR    R1,RE                                                            
         XR    R0,R0                                                            
         IC    R0,HORIDIS                                                       
         SR    R0,R1                                                            
         BNM   *+6                                                              
         DC    H'0'                                                             
         STC   R0,HORIDIS                                                       
         NI    BDFLAG,TURNOFF-BDFINVRT                                          
*                                                                               
BLDDIS44 OI    BDFLAG,BDFPASS2     SET SECOND TIME                              
         SR    R1,R1                                                            
         IC    R1,BDCOLS                                                        
         LA    R1,BDTEMP(R1)                                                    
         MVI   0(R1),0             SET END OF COLUMN DEFINITION                 
         LA    R1,L'DUMLIN1+1                                                   
         SR    R1,R3               GET REMAINING SPACE INTO R1                  
         BNP   BLDDIS22            NOTHING LEFT TO ADD                          
         CLI   BDCOLS,1            TEST SINGLE COLUMN                           
         BE    BLDDIS22            DON'T DIVIDE OR SET FACTOR                   
         XR    R0,R0                                                            
         XR    RF,RF                                                            
         IC    RF,BDCOLS           NO. OF COLS                                  
         XR    RE,RE                                                            
         IC    RE,BLOKEYN                                                       
         XC    FULL,FULL                                                        
         SR    RF,RE                                                            
         BZ    BLDDIS22                                                         
         DR    R0,RF                                                            
         ST    R1,FULL             SET CONSTANT FACTOR FOR SPARE                
         B     BLDDIS22            GO BACK AND SET DISPLACEMENTS                
*                                                                               
BLDDISX  XR    RF,RF                                                            
         IC    RF,BDCOLS          SET NUMBER OF COLUMNS PROCESSED               
         XR    RE,RE                                                            
         IC    RE,BLOKEYN         REDUCE KEY COLUMNSMNS PROCESSED               
         SR    RF,RE                                                            
         STC   RF,HORNDIS                                                       
         MVI   LINSUSED,2                                                       
         B     ROUTX1                                                           
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
*        DISPLAY PF KEY LINE FOR ACTION                               *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
DISPFK   LA    R2,BASPF1H                CLEAR GRIDS PFKEYS                     
         MVC   BASPF1,SPACES                                                    
         OI    FLDOIND,FOUTTRN                                                  
         MVC   BASPF2,SPACES                                                    
         OI    BASPF2H+(FLDOIND-FLDHDRD),FOUTTRN                                
*                                                                               
         TM    PCDRIVEN,PCGRIDQ          RUNNING UNDER GRID?                    
         BZ    DISPF12                   . NO                                   
         LA    R2,GRDPFAH                                                       
         TM    PCDRIVEN,PCGRPFQ          RUNNING UNDER GRID W/ PFKEYS?          
         BO    DISPF14                   . NO                                   
         LA    R2,BASPF1H                                                       
         TM    LSTINDS,LSTISUB           COMING FROM LS SUBACT?                 
         BZ    DISPF60                   . NO                                   
         MVC   BASPF1(2),LC@PFK          PFKEYS                                 
         MVC   BASPF1+2(3),=C'11='                                              
         MVC   BASPF1+5(4),LC@NXT                                               
         MVC   BASPF2(2),LC@PFK                                                 
         MVC   BASPF2+2(3),=C'12='                                              
         MVC   BASPF2+5(6),LC@RETRN                                             
         B     DISPF60                                                          
*                                                                               
DISPF12  LA    R2,LSTPFAH                                                       
         CLI   SVACTNUM,ACTNLSLT         LIST/SELECT ENQUIRY?                   
         BE    *+8                                                              
         LA    R2,ENQPFAH                                                       
*                                                                               
DISPF14  MVC   FLDDATA(L'ENQPFA),SPACES  CLEAR PFK LINE                         
         LA    R4,FLDDATA                                                       
         MVC   0(L'LC@PFK,R4),LC@PFK     PFKEY                                  
         LA    R4,L'LC@PFK-1(R4)                                                
         CLI   0(R4),C' '                                                       
         BH    *+8                                                              
         BCT   R4,*-8                                                           
         LA    R4,1(R4)                                                         
*                                                                               
         L     R3,APFKTAB                R3=A(PFK TABLE)                        
         USING PFKTABD,R3                                                       
DISPF20  CLI   0(R3),EOT                 END OF TABLE?                          
         BE    DISPF60                                                          
*                                                                               
         TM    PCDRIVEN,PCGRIDQ          TEST RUNNING UNDER GRID?               
         BZ    DISPF24                   . NO                                   
         TM    PFKINDS,PFKNGRDQ          TEST IF NOT VALID FOR GRID             
         BO    DISPF50                   . YES - NEXT ENTRY                     
         B     *+12                                                             
DISPF24  TM    PFKINDS,PFKGRONQ          TEST IF GRIDS ONLY                     
         BO    DISPF50                   . YES - NEXT ENTRY                     
*                                                                               
         TM    PFKINDS,PFKOFF2Q          PFKEY FOR 2 CHAR OFFICES ONLY          
         BZ    *+12                      . NO, NO NEED TO CHECK                 
         TM    COMPSTA4,CPYSOFF2         TWO CHAR OFFICE FILE?                  
         BZ    DISPF50                   . NO, NOT SUPPORTED                    
*                                                                               
         TM    PFKINDS,PFKGLOBQ          PFKEY FOR INPUT GLOBBER                
         BZ    *+12                      . NO, NO NEED TO CHECK                 
         TM    TWAFLG1,TWAFRINP          TEST GLOBBER CALLL                     
         BZ    DISPF50                                                          
*                                                                               
         LA    RF,PFKACTNS               RF=A(ACTION LIST)                      
DISPF30  CLI   0(RF),EOT                 END OF TABLE?                          
         BE    DISPF50                                                          
         CLC   SVACTNUM,0(RF)            MATCH ON ACTION?                       
         BE    DISPF36                                                          
DISPF32  LA    RF,1(RF)                  BUMP UP ACTION LIST                    
         B     DISPF30                                                          
*                                                                               
DISPF36  CLI   PFKNUM,PF1                PFKEY 1                                
         BNE   DISPF38                                                          
         TM    LSTINDS,LSTISUB           COMING FROM LS SUBACT?                 
         BO    DISPF50                   . YES - DON'T SHOW PFKEY 1             
*                                                                               
DISPF38  TM    PFKINDS,PFKRTNLI          PFKEY TO RETURN TO LS RECORD?          
         BZ    DISPF40                   . NO - CONTINUE                        
         TM    LSTINDS,LSTISUB           COMING FROM LS SUBACT?                 
         BZ    DISPF50                   . NO - DON'T SHOW THIS PFKEY           
*                                                                               
DISPF40  LA    R5,PFKLDGN                U/L & DISP. TO PFKEY WORD 1            
         TM    PFKINDS,PFKSWACT          SWITCHING TO OTHER ACTION?             
         BZ    DISPF44                                                          
         GOTO1 ATSTUL,(R5)               CHECK U/L 1                            
         BE    DISPF44                   . OK - VALID LEDGER                    
         LA    R5,PFKLDGN2               U/L & DISP. TO PFKEY WORD 2            
         GOTO1 ATSTUL,(R5)               CHECK U/L 2                            
         BNE   DISPF50                                                          
*                                                                               
DISPF44  CURED PFKNUM,(2,(R4)),0,ALIGN=LEFT    PFKEY NUMBER                     
         LA    R4,1(R4)                                                         
         CLI   0(R4),C' '                                                       
         BE    *+8                                                              
         LA    R4,1(R4)                                                         
         MVI   0(R4),C'='                                                       
         LA    R4,1(R4)                                                         
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,3,PFKKEYWD-PFKLDGN(R5) DISP. TO PFKEY WORD                    
         LA    RF,WORKD(RF)                                                     
         LHI   R1,PFKWDLEN-1                                                    
         TM    PFKINDS,PFKSWACT          SWITCHING TO OTHER ACTION?             
         BZ    *+8                                                              
         LHI   R1,ACTSHLNQ-1             LENGTH OF ACTION PFKEY WORD            
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R4),0(RF)             PFKEY WORD                             
         LA    R4,1(R1,R4)                                                      
         CLI   0(R4),C' '                                                       
         BH    *+8                                                              
         BCT   R4,*-8                                                           
         LA    R4,2(R4)                                                         
*                                                                               
DISPF50  LA    R3,PFKTABL(R3)            BUMP UP PFKEY TABLE                    
         B     DISPF20                                                          
*                                                                               
DISPF60  LA    R4,FLDDATA                                                       
         LA    R4,L'LC@PFK-1(R4)                                                
         CLI   0(R4),C' '                                                       
         BH    *+8                                                              
         BCT   R4,*-8                                                           
         LA    R4,1(R4)                                                         
         CLI   0(R4),C' '                                                       
         BH    *+10                                                             
         MVC   FLDDATA(L'LC@PFK),SPACES  PFKEY                                  
         B     ROUTX1                                                           
         DROP  R2                                                               
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO ISSUE AN I/O TO ACCOUNT FILES                            *         
*                                                                     *         
* NTRY - R1=I/O CONTROL BYTES (LOW ORDER 2 BYTES) SET FROM IO EQUATES *         
*           CONTAINS - FILE NUMBER       (ZERO=USE IOFILE)            *         
*                      COMMAND NUMBER    (ZERO=USE IOCMND)            *         
*                      COMMAND QUALIFIER (READ LOCK/READ DELETES)     *         
*                      I/O AREA NUMBER   (ZERO=USE IOADDR)            *         
*                                                                     *         
* EXIT - CC=LOW IF A HARD I/O ERROR OCCURED                           *         
*        CC=EQUAL IF I/O SUCCESSFUL (NO ERRORS)                       *         
*        CC=HIGH IF A SOFT ERROR (EOF/NOT FOUND/DELETED)              *         
*        IOADDR=A(I/O AREA USED)                                      *         
*        IOERR=DATAMGR ERROR BYTE                                     *         
*        IOKEYSAV=SAVE IOKEY VALUE (BEFORE I/O IS EXECUTED)           *         
*        IODA=DISK ADDRESS EXTRACTED FOR I/S RECORD (I/S D/A PAIR)    *         
*                                                                     *         
* NOTE - FOR INDEX SEQUENTIAL I/O'S IOKEY IS ALWAYS SAVED IN IOKEYSAV *         
*        BEFORE I/O IS EXECUTED. FOR D/A FILE I/O'S IF IODA IS ZERO   *         
*        AND FILE HAS A DIRECTORY ATTACHED (I/S D/A PAIR) THE READ    *         
*        SPECIFIED TO THE FILE (HIGH/READ) IS EXECUTED TO THE         *         
*        DIRECTORY.                                                   *         
***********************************************************************         
         USING IOWORKD,RC                                                       
*                                                                               
IOEX     ST    R1,IOCTRL           SAVE I/O CONTROL BYTES IN W/S                
         MVI   IOFLAG,0            RESET I/O FLAG BYTE                          
         MVI   IOQ,0               ESTABLISH COMMAND QUALIFIER                  
         TM    IOCTRL+3,IOLOCK     TEST READ-FOR-UPDATE                         
         BZ    *+8                                                              
         OI    IOQ,X'80'                                                        
         TM    IOCTRL+3,IORDEL     TEST DELETED RECORDS WANTED                  
         BZ    *+8                                                              
         OI    IOQ,X'08'                                                        
         LA    R1,IO1+IO2          ESTABLISH I/O AREA ADDRESS                   
         N     R1,IOCTRL                                                        
         BZ    IOEX2                                                            
*                                                                               
         SRL   R1,6                R1=I/O AREA NUMBER                           
         STC   R1,IODUB                                                         
         CLI   IODUB,3             ONLY 3 I/O AREAS SUPPORTED HERE              
         BNH   *+6                                                              
         DC    H'0'                I/O AREA NUMBER INVALID                      
         BCTR  R1,0                                                             
         MHI   R1,IOAREALN                                                      
         AHI   R1,IOAREA1-WORKD                                                 
         LA    R1,WORKD(R1)                                                     
         ST    R1,IOAREAD          SAVE I/O AREA ADDRESS                        
*                                                                               
         LA    R1,L'IODA+L'IOWORK(R1)                                           
         STCM  R1,15,IOADDR        SET REAL I/O ADDRESS                         
*                                                                               
IOEX2    LA    R1,IOFILES          ESTABLISH FILE                               
         N     R1,IOCTRL                                                        
         BNZ   IOEX4                                                            
         OC    IOFILE,IOFILE       CALLER MUST SUPPLY FILE NAME                 
         BNZ   *+6                                                              
         DC    H'0'                                                             
         MVC   IOFILNM,IOFILE      SET FILE NAME                                
         OC    IOCMND,IOCMND       FILE GIVEN - SO MUST COMMAND BE              
         BNZ   *+6                                                              
         DC    H'0'                                                             
         MVC   IOCMDNM,IOCMND      SET COMMAND NAME                             
         B     IOEX20                                                           
*                                                                               
IOEX4    SRL   R1,8                R1=FILE NUMBER                               
         L     RE,AFILTAB          POINT TO LOCAL SYSTEM FILES                  
         LA    R0,10                                                            
         CR    R1,R0                                                            
         BNH   *+6                                                              
         DC    H'0'                ONLY ACCOUNT FILES SUPPORTED                 
*                                                                               
         USING FILTABD,RE                                                       
IOEX6    CLI   FILNUM,EOT          TEST E-O-T                                   
         BNE   *+6                                                              
         DC    H'0'                INVALID FILE NUMBER                          
         CLM   R1,1,FILNUM         MATCH ON FILE NUMBER                         
         BE    *+12                                                             
         LA    RE,FILTABL(RE)                                                   
         B     IOEX6                                                            
         MVC   IOFILV,FILNUM       EXTRACT FILE VALUES                          
         OC    IOFILNM,IOFILNM     TEST NATIVE SYSTEM FILE                      
         BNZ   IOEX7                                                            
         DC    H'0'                                                             
*                                                                               
*                                                                               
IOEX7    L     RE,ACMDTAB          RE=A(I/O COMMAND TABLE)                      
         SR    RF,RF                                                            
         LA    R1,IOCMNDS          ESTABLISH COMMAND                            
         N     R1,IOCTRL                                                        
         BNZ   IOEX8                                                            
         OC    IOCMND,IOCMND       NOT GIVEN - TEST COMMAND NAMED               
         BNZ   *+6                                                              
         DC    H'0'                                                             
         B     IOEX20                                                           
*                                                                               
IOEX8    CLI   0(RE),EOT           TEST E-O-T                                   
         BNE   *+6                                                              
         DC    H'0'                                                             
         MVC   IODUB(1),0(RE)                                                   
         NC    IODUB(1),IOFILI                                                  
         CLC   IODUB(1),IOFILI                                                  
         BNE   *+12                                                             
         LA    RE,4(RE)                                                         
         B     IOEX10                                                           
         ICM   RF,3,2(RE)                                                       
         LA    RE,3(RF,RE)                                                      
         B     IOEX8                                                            
*                                                                               
         USING CMDTABD,RE          RE=A(FILE/COMMAND TABLE)                     
IOEX10   CLI   0(RE),EOT           TEST E-O-T                                   
         BNE   *+6                                                              
         DC    H'0'                INVALID COMMAND                              
         CLM   R1,1,CMDNUMB        MATCH ON COMMAND NUMBER                      
         BE    *+12                                                             
         LA    RE,CMDTABL(RE)                                                   
         B     IOEX10                                                           
         MVC   IOCMDV,CMDNAME      EXTRACT COMMAND VALUES                       
*                                                                               
         TM    IOCMDI,CMDIDAXC     TEST CLEAR D/A NOW                           
         BZ    *+10                                                             
         XC    IODA,IODA                                                        
         TM    IOCMDI,CMDIDADD     TEST DISK ADDRESS RETURNED                   
         BNZ   IOEX16                                                           
         TM    IOCMDI,CMDIDARQ     TEST D/A REQUIRED FOR I/O                    
         BZ    IOEX18                                                           
         OC    IODAOVER,IODAOVER   TEST OVERRIDE D/A SET                        
         BZ    IOEX11                                                           
         MVC   IODA,IODAOVER       YES - SET D/A AND CLEAR OVERRIDE             
         XC    IODAOVER,IODAOVER                                                
         B     IOEX16                                                           
*                                                                               
IOEX11   ICM   R1,15,IOAREAD       R1=A(I/O AREA)                               
         BZ    IOEX14                                                           
         TM    IOCMDI,CMDIDAXC     TEST CLEAR D/A NOW                           
         BZ    *+10                                                             
         XC    0(L'IODA,R1),0(R1)                                               
         OC    0(L'IODA,R1),0(R1)                                               
         BZ    *+10                                                             
         MVC   IODA,0(R1)          YES - SET D/A                                
         LA    R1,L'IODA(R1)                                                    
*                                                                               
IOEX12   OC    0(L'IOWORK,R1),0(R1)                                             
         BZ    *+10                                                             
         MVC   IOWORK,0(R1)        YES - SET WORK                               
         LA    R1,L'IOWORK(R1)                                                  
*                                                                               
IOEX14   OC    IODA,IODA           TEST D/A PRESENT                             
         BNZ   IOEX16                                                           
*                                                                               
         TM    IOFILI,FILIIS       TEST THIS IS A D/A FILE                      
         BNZ   *+14                                                             
         TM    IOFILI2,FILIDI      AND THAT AN I/S FILE IS ATTACHED             
         BNZ   *+6                                                              
         DC    H'0'                                                             
         MVC   IODUB(4),IOCTRL                                                  
         NI    IODUB+2,X'F0'       TURN OFF FILE INDICATORS                     
         L     R0,IODUB                                                         
         SR    R1,R1                                                            
         IC    R1,IOFILN2                                                       
         SLL   R1,8                                                             
         OR    R1,R0                                                            
         GOTO1 AIO                 RECURSE FOR DIRECTORY I/O                    
         BE    IOEX16              SUCCESSFUL I/O                               
         BL    IOEXX               EXIT ON BAD I/S ERRORS                       
         TM    IOERR,IOERNF        TEST RECORD-NOT-FOUND                        
         BNZ   IOEXX                                                            
         TM    IOERR,IOEDEL        TEST RECORD IS DELETED                       
         BZ    IOEXX                                                            
         OC    IODA,IODA           TEST DISK ADDRESS SET                        
         BNZ   *+6                                                              
         DC    H'0'                SOMETHING BAD HAPPENED                       
*                                                                               
IOEX16   ICM   R0,15,IOADDR                                                     
         BNZ   *+6                                                              
         DC    H'0'                NO I/O AREA ADDRESS                          
         MVC   IOFILE,IOFILNM      SET FILE NAME IN WORK AREA                   
         GOTO1 VDATAMGR,DMCB,(IOQ,IOCMDNM),IOFILNM,IODA,(R0),IOWORK             
         MVC   IOERR,8(R1)         SAVE ERROR RETURN BYTE                       
         TM    IOERR,IOERRS-IOEDEL                                              
         BNZ   IOEXX                                                            
         ICM   R1,15,IOAREAD       POINT TO I/O AREA                            
         BZ    IOEXX                                                            
         MVC   0(L'IODA,R1),IODA                                                
         LA    R1,L'IODA(R1)       YES - BUMP BY D/A LENGTH                     
         MVC   0(L'IOWORK,R1),IOWORK                                            
         B     IOEXX               EXIT TO CALLER                               
*                                                                               
IOEX18   TM    IOFILI,FILIIS       TEST INDEX SEQUENTIAL FILE                   
         BZ    IOEX20                                                           
         MVC   IOFILE,IOFILNM      SET FILE NAME IN WORK AREA                   
         MVC   IOKEYSAV,IOKEY      SAVE CURRENT I/O KEY                         
         LA    R0,IOKEY            FL I/S READS INTO IOKEY                      
         TM    IOFILI2,FILIID      TEST I/S FILE HAS D/A ATTACHED               
         BZ    *+12                YES - MUST READ INTO IOAREA                  
         TM    IOFILI,FILIVL                                                    
         BZ    *+14                                                             
         ICM   R0,15,IOADDR        VL I/S MUST READ INTO IOAREA ALSO            
         BNZ   *+6                                                              
         DC    H'0'                                                             
         GOTO1 VDATAMGR,DMCB,(IOQ,IOCMDNM),IOFILNM,IOKEY,(R0)                   
         MVC   IOERR,8(R1)         SAVE ERROR RETURN BYTE                       
         TM    IOERR,IOERRS-IOEDEL                                              
         BNZ   IOEXX                                                            
         TM    IOFILI2,FILIID      TEST D/A FILE ATTCHED TO THIS FILE           
         BZ    IOEX182                                                          
         SR    R1,R1                                                            
         IC    R1,IOFILKL          YES - EXTRACT DISK ADDRESS                   
         SR    R0,R0                                                            
         IC    R0,IOFILCL                                                       
         AR    R1,R0                                                            
         LA    R1,IOKEY(R1)        POINT TO DISK ADDRESS                        
         MVC   IODA,0(R1)                                                       
         ICM   R1,15,IOAREAD       POINT TO I/O AREA                            
         BZ    IOEXX                                                            
         MVC   0(L'IODA,R1),IODA                                                
         B     IOEXX                                                            
*                                                                               
IOEX182  ICM   R1,15,IOAREAD       POINT TO I/O AREA                            
         BZ    IOEXX                                                            
         LA    R1,L'IODA(R1)       YES - BUMP BY D/A LENGTH                     
         MVC   0(L'IOWORK,R1),IOWORK                                            
         B     IOEXX                                                            
*                                                                               
IOEX20   ICM   R0,15,IOADDR                                                     
         BNZ   *+6                                                              
         DC    H'0'                                                             
         GOTO1 VDATAMGR,DMCB,(IOQ,IOCMDNM),IOFILNM,(R0),(R0)                    
         MVC   IOERR,8(R1)                                                      
         B     IOEXX                                                            
*                                                                               
IOEXX    GOTO1 VGETFACT,DMCB,0     GET A(SYSTEM INFO BLOCK)                     
         L     R1,DMCB                                                          
         USING FACTSD,R1                                                        
         SR    R2,R2                                                            
         SR    R3,R3                                                            
         ICM   R3,3,FATMAXIO       MAXIMUM ALLOWABLE IOS                        
         CLI   SVACTNUM,ACTNJBES   IS THIS JOB ESTIMATE (ES)                    
         BNE   *+12                                                             
         MHI   R3,7                USE 70% FOR THIS                             
         B     *+8                                                              
         MHI   R3,9                                                             
         D     R2,=F'10'           90 PERCENT OF MAX IOS IN R3                  
         CLM   R3,3,FATIOCNT       TEST RUNNING OUT OF IOS                      
         BH    *+8                 NO - STILL WITHIN 90 PERCENT                 
         OI    IOERR,IOMAX                                                      
         DROP  R1                                                               
*                                                                               
         MVI   IOQ,1               SET I/O COMPLETED OK                         
         TM    IOERR,IOERRS                                                     
         BZ    IOEXXX                                                           
         MVI   IOQ,2               SET IRRECOVERABLE ERROR                      
         TM    IOERR,IOEEOF+IOERNF+IOEDEL                                       
         BNZ   IOEXXX                                                           
         MVI   IOQ,0               SET LOGICAL I/O ERROR                        
*                                                                               
IOEXXX   CLI   IOQ,1               SET CONDITION CODE FOR CALLER                
         B     ROUTX1                                                           
         EJECT ,                                                                
***********************************************************************         
*        ADD A RECORD TO TSAR                                         *         
*                                                                     *         
*        ON ENTRY RECORD TO BE ADDED IS IN TSARREC                    *         
*                                                                     *         
*        ON EXIT  CC     EQUAL MEANS RECORD ADDED OK                  *         
*                 CC NOT EQUAL MEANS PROBLEM                          *         
***********************************************************************         
*                                                                               
         USING TSARRECD,R2         MAP  TSAR RECAORD AREA                       
         USING TSARD,R3            MAP  TSAR BLOCK                              
*                                                                               
TSARADD  L     R2,ATSARREC         ->   TSAR RECORD                             
         SR    R4,R4                                                            
         ICM   R4,3,TSARKYNO       GET  TSAR RECORD ID                          
         DROP  R2                                                               
*                                                                               
         L     R3,ATSARBLK                                                      
         CLC   TS2FIRST,=H'0'      2ND  TSAR BUFFER IN USE ?                    
         BE    *+8                 NO,  SKIP                                    
         L     R3,ATSARBKB         ADD  TO 2ND TSAR BUFFER                      
*                                                                               
         MVI   TSERRS,0                                                         
         MVI   TSACTN,TSAADD                                                    
         GOTO1 VTSAR,TSARD         ADD RECORD TO TSAR                           
         BE    TSARA80                                                          
*                                                                               
         TM    TSERRS,TSEEOF       EOF  ERROR ?                                 
         JNO   *+2                                                              
*                                                                               
         TM    TWAMODE,TWAMRST2    TSAR AREA 'B' IN USE ?                       
         BO    TSARA60             YES, RETURN TSAR EOF ERROR                   
         TM    TWATSAR1,TSIALLOC   USING TEMPEST ON 1ST TSAR BUFFER ?           
         BZ    TSARA60             NO,  RETURN TSAR EOF ERROR                   
*                                                                               
         L     R3,ATSARBKB         -> TSAR BLOCK "B"                            
         L     R0,ATSARREC                                                      
         ST    R0,TSAREC           SET  A(RECORD)                               
         MVC   TSACOM,ACOMFACS     SET  A(COMFACS)                              
         MVI   TSKEYL,TSARKEYL     SET  KEY LENGTH                              
         MVC   TSRECL,=Y(TSARRECL) SET  MAXIMUM LENGTH OF RECORD                
         OI    TSRECI,TSRVAR       VARIABLE RECORD LENGTHS                      
*                                  ALLOCATE FROM TEMPEST AND                    
         MVI   TSINDS,TSIALLOC+TSIRTNAF RETURN IF ALLOCATION FAILS              
         MVI   TSIND2,TSI2BUF2     USE  TSAR BUFFER B                           
         MVI   TSPAGN,TSPEXPN      SET  NUMBER OF TEMPSTR C/I'S                 
         TM    TWAMODE,TWAMGOT2    TSAR 2 PREVIOUSLY INITIALIZED ?              
         BZ    TSARA10             NO,  CONTINUE                                
*                                  YES, USE PREVIOUS ALLOCATIONS                
         MVC   TSINDS,TWATSAR2     SET INDICATORS                               
         OI    TSINDS,TSIREUSE     SET TO RE-USE PREVIOUS ALLOCATION            
         MVC   TSPAGL,TWALOWP2     SET LOW PAGE NUMBER                          
         MVC   TSPAGN,TWANUMP2     SET NUMBER OF PAGES ALLOCATED                
*                                                                               
TSARA10  MVI   TSACTN,TSAINI       SET  INITIALISE                              
         GOTO1 VTSAR,TSARD         CALL TO INITIALISE/RESTORE                   
         BE    TSARA20             OK,  CONTINUE                                
         TM    TWAMODE,TWAMGOT2    TEST FIRST TIME ALLOCATION ?                 
         JNZ   *+2                                                              
*                                                                               
         TM    CORDFLAG,CORDMODQ   CONTRA ORDER DISPLAY FOR 2 CHAR OFF?         
         BO    TSARA60             YES, RETURN TSAR EOF ERROR                   
*                                                                               
*                                  CANNOT GET TEMPEST 'B' TRY TEMPSTR           
         NI    TSINDS,TURNOFF-TSIALLOC-TSIRTNAF                                 
         MVI   TSPAGL,2            SET TO USE TEMPSTR PAGES 2-4                 
         MVI   TSPAGN,3                                                         
         GOTO1 VTSAR,TSARD         INITIALISE TEMPSTR PAGES                     
*                                  CANNOT INITIALISE TEMPSTR,                   
         BNE   TSARA60             .    RETURN TSAR EOF ERROR                   
*                                                                               
TSARA20  MVC   TWALOWP2,TSPAGL     SAVE LOW TSAR PAGE NUMBER                    
         MVC   TWANUMP2,TSPAGN     SAVE NUMBER OF PAGES ALLOCATED               
         MVC   TWATSAR2,TSINDS     SAVE TEMPSTR/TEMPEST INDICATOR               
         NI    TWATSAR2,TSIALLOC+TSIRTNAF                                       
*                                  TURN ON RESTORE TSAR 2 NEXT TIME AND         
*                                  TSAR 2 WAS GOTTEN (INITIALIZED)              
         OI    TWAMODE,TWAMRST2+TWAMGOT2                                        
         OI    TWAMODE,TWAMSAV2    NEED TO SAVE SECOND TEMPEST BUFF             
*                                                                               
         MVI   TSACTN,TSAADD                                                    
         MVI   TSERRS,0                                                         
         GOTO1 VTSAR,TSARD         ADD  RECORD TO TSAR                          
         JNE   *+2                                                              
*                                                                               
         STH   R4,TS2FIRST         SAVE FIRST KEY ON 2ND TSAR BUFFER            
         B     TSARA80             CONTINUE TSAR ADD OKAY                       
*                                                                               
TSARA60  MVC   FVMSGNO,=AL2(EATRNMAX)                                           
         LA    R2,BASKEYH                                                       
         ST    R2,FVADDR                                                        
         OI    DISPFLAG,TSARFULQ                                                
         B     TSARADDX                                                         
*                                                                               
*                                  TSAR ADDED OKAY                              
TSARA80  GOTO1 VGETFACT,DMCB,0     GET A(SYSTEM INFO BLOCK)                     
         L     R1,DMCB                                                          
         USING FACTSD,R1                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,3,FATMAXIO       MAXIMUM ALLOWABLE IOS                        
         MHI   RF,9                                                             
         D     RE,=F'10'           90 PERCENT OF MAX IOS IN R3                  
         CLM   RF,3,FATIOCNT       TEST RUNNING OUT OF IOS                      
         BH    *+12                NO - STILL WITHIN 90 PERCENT                 
         OI    TSERRS,IOMAX                                                     
         OI    DISPFLAG,DISIOMAX                                                
         DROP  R1                                                               
*                                                                               
TSARADDX CLI   TSERRS,0                                                         
         B     ROUTX1                                                           
         DROP  R3                                                               
         EJECT ,                                                                
***********************************************************************         
*        ROUTINE TO GET A RECORD FROM TSAR AND SET KEY VALUES         *         
* ON ENTRY R1=A(RECORD NUMBER REQUIRED)                               *         
* ON EXIT  CC EQUAL MEANS RECORD READ OK                              *         
*          CC UNEQUAL MEANS PROBLEM                                   *         
***********************************************************************         
*                                                                               
         USING TSARD,R3            R3=A(TSAR BLOCK)                             
*                                                                               
TSARGET  SR    R2,R2               GET  RECORD    NUMBER                        
         ICM   R2,3,0(R1)               INTO REGISTER  2                        
         L     R3,ATSARBLK         GET  FROM 1ST  TSAR BUFFER                   
         CLC   TS2FIRST,=H'0'      2ND  TSAR BUFFER    IN   USE ?               
         BE    TSARGE10            NO,  SKIP                                    
         CLC   TS2FIRST,0(R1)      GET  FROM 2ND  TSAR BUFFER ?                 
         BH    TSARGE10            NO,  SKIP                                    
         L     R3,ATSARBKB         GET  FROM 2ND  TSAR BUFFER                   
         SR    RE,RE               GET  1ST  KEY  ON                            
         ICM   RE,3,TS2FIRST            2ND  TSAR BUFFER                        
         SR    R2,RE               GET  RELATIVE  RECORD                        
         LA    R2,1(,R2)                STARTING  FROM 1                        
*                                                                               
TSARGE10 MVI   TSACTN,TSAGET                                                    
         STH   R2,TSRNUM           SAVE RECORD    NUMBER                        
         GOTO1 VTSAR,TSARD                                                      
         CLI   TSERRS,0            SET CC FOR CALLER                            
         BNE   ROUTX1                                                           
*                                                                               
         GOTO1 VGETFACT,DMCB,0     GET A(SYSTEM INFO BLOCK)                     
         L     R1,DMCB                                                          
         USING FACTSD,R1                                                        
         SR    RE,RE                                                            
         SR    RF,RF                                                            
         ICM   RF,3,FATMAXIO       MAXIMUM ALLOWABLE IOS                        
         MHI   RF,9                                                             
         D     RE,=F'10'           90 PERCENT OF MAX IOS IN R3                  
         CLM   RF,3,FATIOCNT       TEST RUNNING OUT OF IOS                      
         BH    *+12                NO - STILL WITHIN 90 PERCENT                 
         OI    TSERRS,IOMAX                                                     
         OI    DISPFLAG,DISIOMAX                                                
         DROP  R1                                                               
*                                                                               
TSARGETX CLI   TSERRS,0            SET CC FOR CALLER                            
         B     ROUTX1                                                           
         DROP  R3                                                               
         EJECT ,                                                                
***********************************************************************         
*        DISPLAY DUMMY SCREEN LINES ON SCREEN                         *         
***********************************************************************         
*                                                                               
DISPLAY  MVC   BYTE1,0(R1)                                                      
         SR    RF,RF                                                            
         IC    RF,DISLINE          RF=(NEXT FREE LINE NUMBER)                   
         LR    RE,RF               RE=RF                                        
         SR    R0,R0                                                            
         ICM   R0,1,LINSUSED       R0=(NUMBER OF LINES NEEDED)                  
         BZ    DISPX                                                            
         LR    R1,R0                                                            
         BCTR  R1,0                                                             
         AR    RE,R1               RE=(PROJECTED SCREEN END LINE)               
         SR    R1,R1                                                            
         IC    R1,DISEND           R1=(MAX SCREEN END LINE)                     
         CR    RE,R1               CAN WE FIT ITEM ON SCREEN?                   
         BH    DISPFULL                                                         
         LA    RE,1(RE)                                                         
         STC   RE,DISLINE          UPDATE NEXT FREE LINE NUMBER                 
         MHI   RF,ENQDAT2H-ENQDAT1H                                             
         LA    R2,ENQDAT1H(RF)                                                  
         TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BZ    DISP09                                                           
         LA    R2,GRDDAT1H(RF)                                                  
         USING FLDHDRD,R2                                                       
DISP09   L     RF,ADUMLINE                                                      
DISP10   MVC   FLDDATA(L'DUMLIN1),0(RF) PUT DUMMY SCREEN LINE OF SCREEN         
         OI    FLDOIND,FOUTTRN                                                  
         NI    FLDATB,TURNOFF-FATBHIGH                                          
         TM    BYTE1,HILIGHTQ                                                   
         BNO   *+8                                                              
         OI    FLDATB,FATBHIGH                                                  
         LA    RF,L'DUMLIN1(RF)                                                 
         LA    R2,ENQDAT2H-ENQDAT1H(R2)                                         
         BCT   R0,DISP10                                                        
*                                                                               
DISPX    B     ROUTE1                                                           
*                                                                               
DISPFULL CLI   LINSUSED,MAXWCS                                                  
         BL    ROUTH1                                                           
         NI    DISPFLG2,X'FF'-DISWCOVF                                          
         B     ROUTH1                                                           
         EJECT ,                                                                
*                                                                               
***********************************************************************         
*        CLEAR DATA LINES ON SCREEN                                   *         
*        ON ENTRY R1=A(LINE NUMBER TO START CLEARING FROM)            *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
SCRNCLR  SR    R2,R2               CLEAR FROM LINE COUNT ONWARDS                
         ICM   R2,1,0(R1)                                                       
         BNZ   SCRNC02                                                          
         LA    R2,ENQDAT1H         CLEAR ALL LINES                              
         TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BNO   SCRNC08                                                          
         LA    R2,GRDDAT1H                                                      
         B     SCRNC08                                                          
*                                                                               
SCRNC02  SHI   R2,1                                                             
         TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BNO   SCRNC03                                                          
         MHI   R2,GRDDAT3H-GRDDAT2H                                             
         LA    R2,GRDDAT2H(R2)                                                  
         B     SCRNC08                                                          
SCRNC03  CLI   SVACTNUM,ACTNLSLT   TEST LIST/SELECT ENQUIRY?                    
         BNE   SCRNC04                                                          
         MHI   R2,LSTACT3H-LSTACT2H                                             
         LA    R2,LSTACT2H(R2)                                                  
         B     SCRNC08                                                          
*                                                                               
SCRNC04  MHI   R2,ENQDAT3H-ENQDAT2H                                             
         LA    R2,ENQDAT2H(R2)                                                  
*                                                                               
SCRNC08  LA    RF,GRDDATLH                                                      
         TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BO    SCRNC09                                                          
         LA    RF,LSTDATLH                                                      
         CLI   SVACTNUM,ACTNLSLT   TEST LIST/SELECT ENQUIRY?                    
         BE    SCRNC09                                                          
         LA    RF,ENQDATLH                                                      
*                                                                               
SCRNC09  CR    R2,RF                                                            
         BH    SCRNCLRX                                                         
         SR    RE,RE                                                            
         SR    R1,R1                                                            
SCRNC10  IC    RE,FLDLEN                                                        
*                                                                               
         LR    R1,RE                                                            
         SH    R1,=Y(FLDDATA-FLDLEN) R1=INPUT DATA LENGTH                       
         BZ    SCRNC20                                                          
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         XC    FLDDATA(0),FLDDATA                                               
*                                                                               
SCRNC20  OI    FLDOIND,FOUTTRN                                                  
         NI    FLDATB,X'FF'-FATBHIGH                                            
         BXLE  R2,RE,SCRNC10                                                    
*                                                                               
SCRNCLRX B     ROUTX1                                                           
         DROP  R2                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
*        READ UNIT AND LEDGER RECORDS READ USING AIOAREA2             *         
*        ON ENTRY R1=A(UNIT AND LEDGER)                               *         
***********************************************************************         
*                                                                               
UNITLDGR MVC   UNITLEDG,0(R1)                                                   
         XC    LEDGTLVA(L'LEDGTLVA*4),LEDGTLVA                                  
         LA    R3,IOKEY            R3=A(KEY FOR UNIT RECORD READ)               
         USING UNTRECD,R3                                                       
         MVC   UNTKEY,SPACES                                                    
         MVC   UNTKCPY,MYCO                                                     
         MVC   UNTKUNT,UNITLEDG                                                 
         GOTO1 AIO,IOREAD+IOACCMST+IO2 READ UNIT RECORD                         
         BE    UNLG10                                                           
         TM    IOERR,IOMAX         TOO MANY IOS?                                
         BZ    *+12                                                             
         OI    DISPFLAG,DISIOMAX                                                
         B     UNLGX                                                            
         MVC   FVMSGNO,=AL2(EALDGINV)                                           
         TM    IOERR,IOERNF                                                     
         BO    UNLGERRX                                                         
         DC    H'0'                                                             
UNLG10   L     R3,AIO2             R3=A(IOAREA2)                                
         LA    R4,UNTRFST          R4=A(FIRST ELEMENT)                          
*                                                                               
UNLG20   CLI   0(R4),EOR                                                        
         JE    *+2                                                              
         CLI   0(R4),NAMELQ        NAME ELEMENT?                                
         BE    UNLG40                                                           
*                                                                               
UNLG30   SR    R0,R0                                                            
         IC    R0,1(R4)                                                         
         AR    R4,R0                                                            
         B     UNLG20                                                           
*                                                                               
         USING NAMELD,R4           NAME ELEMENT                                 
UNLG40   SR    RF,RF                                                            
         IC    RF,NAMLN                                                         
         SHI   RF,NAMLN1Q                                                       
         MVC   UNITNAME,SPACES                                                  
         LA    RE,L'UNITNAME                                                    
         CR    RF,RE                                                            
         BNH   *+6                                                              
         LR    RF,RE                                                            
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   UNITNAME(0),NAMEREC                                              
         DROP  R4                                                               
*                                                                               
         LA    R3,IOKEY            R3=A(KEY FOR LEDGER RECORD READ)             
         USING LDGRECD,R3                                                       
         MVC   LDGKEY,SPACES                                                    
         MVC   LDGKCPY,MYCO                                                     
         MVC   LDGKUNT(L'UNITLEDG),UNITLEDG                                     
         GOTO1 AIO,IOREAD+IOACCMST+IO2 READ LEDGER RECORD                       
         BE    UNLG50                                                           
         TM    IOERR,IOMAX         TOO MANY IOS?                                
         BNO   *+12                                                             
         OI    DISPFLAG,DISIOMAX                                                
         B     UNLGX                                                            
         MVC   FVMSGNO,=AL2(EALDGINV)                                           
         TM    IOERR,IOERNF                                                     
         BO    UNLGERRX                                                         
         DC    H'0'                                                             
UNLG50   L     R3,AIO2             R3=A(IOAREA2)                                
         LA    R4,LDGRFST          R4=A(FIRST ELEMENT)                          
UNLG60   CLI   0(R4),EOR           END OF RECORD?                               
         BE    UNLGX                                                            
         CLI   0(R4),LDGELQ        TEST LEDGER ELEMENT                          
         BE    UNLG80                                                           
         CLI   0(R4),ACLELQ        TEST HIERARCHY ELEMENT                       
         BE    UNLG90                                                           
         CLI   0(R4),NAMELQ        TEST NAME ELEMENT                            
         BE    UNLG100                                                          
         CLI   0(R4),RSTELQ        TEST STATUS ELEMENT                          
         BE    UNLG110                                                          
*                                                                               
UNLG70   SR    R0,R0                                                            
         IC    R0,1(R4)                                                         
         AR    R4,R0                                                            
         B     UNLG60                                                           
*                                                                               
         USING LDGELD,R4                                                        
UNLG80   MVC   LDGTTYPE,LDGTYPE                                                 
         MVC   LDGTLIKE,LDGLIKE                                                 
         MVC   LDGTOFFP,LDGOPOS                                                 
         CLI   LDGTOFFP,LDGONONE                                                
         BNE   *+8                                                              
         MVI   LDGTOFFP,LDGOTRAN                                                
         MVC   LDGTCLOS,LDGCLOS                                                 
         CLI   LDGLN,LDGLNQ                                                     
         BL    UNLG70                                                           
         PACK  LDGTDDL,LDGDPOS     EXTRACT DEPARTMENT VALUES                    
         NI    LDGDLEN,X'0F'                                                    
         OC    LDGTDDL,LDGDLEN                                                  
         B     UNLG70                                                           
         DROP  R4                                                               
*                                                                               
         USING ACLELD,R4                                                        
UNLG90   LA    RF,LEDGTLVA                                                      
         LA    RE,ACLVALS                                                       
         SR    R0,R0                                                            
UNLG95   MVC   0(L'LEDGTLVA,RF),0(RE)                                           
         AHI   R0,1                                                             
         CLI   0(RE),X'0C'                                                      
         BNL   UNLG96                                                           
         LA    RF,L'LEDGTLVA(RF)                                                
         LA    RE,L'ACLVALS(RE)                                                 
         B     UNLG95                                                           
UNLG96   STC   R0,LDGLEVS                                                       
         B     UNLG70                                                           
         DROP  R4                                                               
*                                                                               
         USING NAMELD,R4                                                        
UNLG100  SR    RF,RF                                                            
         IC    RF,NAMLN                                                         
         SHI   RF,NAMLN1Q                                                       
         MVC   LDGTNAME,SPACES                                                  
         LA    RE,L'LDGTNAME                                                    
         CR    RF,RE                                                            
         BNH   *+6                                                              
         LR    RF,RE                                                            
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   LDGTNAME(0),NAMEREC                                              
         B     UNLG70                                                           
         DROP  R4                                                               
*                                                                               
         USING RSTELD,R4                                                        
UNLG110  MVC   LDGTSEC,RSTSECY+1                                                
         MVC   LDGTSTA3,RSTSTAT3   STATUS BYTE 3                                
         CLC   TWAAUTH+1(1),LDGTSEC                                             
         BNL   UNLG70                                                           
         MVC   FVMSGNO,=AL2(EASECLOC)                                           
         B     UNLGERRX            SECURITY ERROR                               
         DROP  R4                                                               
*                                                                               
UNLGERRX B     ROUTH1                                                           
*                                                                               
UNLGX    MVC   LDGTUL,UNITLEDG                                                  
*                                                                               
         L     R2,AOPTVALS                                                      
         USING OPTVALSD,R2                                                      
         OC    OOFFICVL,OOFFICVL   NO, OFFICE OVERRIDE?                         
         BZ    ROUTE1              NO, DONE                                     
*                                                                               
UNLOFFC  TM    COMPSTA4,CPYSOFF2   NEW OFF?                                     
         BO    ROUTE1              YES                                          
*                                                                               
         CLI   OOFFICVL+3,C' '     MAKE SURE ONE CHARACTER                      
         BNE   UNLOFCER                                                         
*                                                                               
         LA    R3,IOKEY            ELSE - READ 2D LEDGER                        
         USING ACTRECD,R3                                                       
         MVC   ACTKEY,SPACES                                                    
         MVC   ACTKCPY,MYCO        COMPANY CODE                                 
         MVC   ACTKUNT(2),=C'2D'                                                
         MVC   ACTKACT(L'OOFFICVL),OOFFICVL+2                                   
         GOTO1 AIO,IOHIGH+IOACCDIR+IO2                                          
         BE    UNLOFC10                                                         
         TM    IOERR,IOMAX             TOO MANY IOS?                            
         JNO   *+2                                                              
         OI    DISPFLAG,DISIOMAX                                                
         B     ROUTH1                                                           
                                                                                
UNLOFC10 CLC   IOKEYSAV(4),IOKEY    OFFICE VALID?                               
         BE    ROUTE1                                                           
*                                                                               
UNLOFCER LA    R2,BASOPTH                                                       
         ST    R2,FVADDR                                                        
         MVC   FVMSGNO,=AL2(AE$IVOFF)                                           
         B     ROUTH1                                                           
*                                                                               
         DROP  R3                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
*        DISPLAY UNIT AND LEDGER NAMES ONE FIRST DATA SCREEN LINE     *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
*                                                                               
DISUL    MVC   FLDDATA(L'ENQDAT1),SPACES                                        
         OI    FLDOIND,FOUTTRN                                                  
         MVC   FLDDATA(L'LC@UNIT),LC@UNIT                                       
         LA    R5,FLDDATA+L'LC@UNIT-1                                           
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   1(R5),C'='                                                       
         MVC   2(L'UNITNAME,R5),UNITNAME                                        
         LA    R5,L'UNITNAME+1(R5)                                              
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   2(R5),C'/'                                                       
         LA    R5,4(R5)                                                         
*                                                                               
         MVC   0(L'LC@LGR,R5),LC@LGR                                            
         LA    R5,L'LC@LGR-1(R5)                                                
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   1(R5),C'='                                                       
         MVC   2(L'LDGTNAME,R5),LDGTNAME                                        
*                                                                               
DISULX   B     ROUTX1                                                           
         EJECT ,                                                                
***********************************************************************         
*        READ FIRST/NEXT JOB RECORD AND GET COMPOSITE OFFICE          *         
*        ON ENTRY IOKEY SET FOR HIGH READ                             *         
*        ON EXIT  JOB RECORD PLACED IN AIOAREA1                       *         
***********************************************************************         
*                                                                               
         USING OPTVALSD,R2                                                      
*                                                                               
GETJOB   L     R2,AOPTVALS         R2=A(OPTION VALUES)                          
*                                                                               
GETJ10   GOTO1 AIO,IOHIGH+IOACCDIR+IO1                                          
         BE    GETJ15                                                           
         TM    IOERR,IOMAX             TOO MANY IOS?                            
         JNO   *+2                                                              
         OI    DISPFLAG,DISIOMAX                                                
         B     GETJERRX                                                         
*                                                                               
GETJ15   CLC   IOKEYSAV(ACTKACT-ACTKEY),IOKEY IS RECORD ON PROD LEDG?           
         BNE   GETJERRX                                                         
*                                                                               
GETJ15A  LA    R3,IOKEY                                                         
         USING ACTRECD,R3                                                       
         SR    RE,RE                                                            
         IC    RE,LEDGTLVB                                                      
         LA    RE,ACTKACT(RE)                                                   
         CLI   0(RE),C' '                                                       
         BNH   GETJ19                                                           
*                                                                               
         OC    OMEDIA,OMEDIA       MEDIA FILTER?                                
         BZ    GETJ17                                                           
         CLC   OMEDIAVL,0(RE)                                                   
         BNE   GETJ16                                                           
         CLI   OMEDIAFI,NEGFILTR                                                
         BE    GETJ35                                                           
         B     GETJ17                                                           
GETJ16   CLI   OMEDIAFI,NEGFILTR                                                
         BNE   GETJ35                                                           
*                                                                               
GETJ17   TM    ACTKSTAT,ACTSCLOS   IS JOB CLOSED?                               
         BNO   GETJ18                                                           
         CLI   OCLOSED,C'N'        ONLY WANT OPEN JOBS?                         
         BE    GETJ35              IF SO REJECT JOB                             
         B     *+12                                                             
GETJ18   CLI   OCLOSED,C'O'        ONLY WANT CLOSED JOBS?                       
         BE    GETJ35              IF SO REJECT JOB                             
*                                                                               
         TM    ACTKSTAT,ACTSLOCK   IS JOB CLOSED?                               
         BNO   GETJ18A                                                          
         CLI   OLOCKED,C'N'        ONLY WANT UNLOCKED JOBS?                     
         BE    GETJ35              IF SO REJECT JOB                             
         B     *+12                                                             
GETJ18A  CLI   OLOCKED,C'O'        ONLY WANT LOCKED JOBS?                       
         BE    GETJ35              IF SO REJECT JOB                             
*                                                                               
GETJ19   GOTO1 AIO,IOGET+IOACCMST+IO1                                           
         BE    GETJ20                                                           
         TM    IOERR,IOMAX             TOO MANY IOS?                            
         JNO   *+2                                                              
         OI    DISPFLAG,DISIOMAX                                                
         B     GETJERRX                                                         
*                                                                               
GETJ20   L     R3,AIO1                 R3=A(IOAREA1)                            
         USING ACTRECD,R3                                                       
*                                                                               
GETJ30   SR    RE,RE                                                            
         IC    RE,LEDGTLVB                                                      
         LA    RE,ACTKACT(RE)                                                   
         CLI   0(RE),C' '                                                       
         BH    GETJX                                                            
GETJ35   LA    R3,IOKEY                                                         
         MVI   ACTKACT+L'ACTKACT,X'FF'                                          
         B     GETJ10                                                           
*                                                                               
GETJERRX B     ROUTH1                                                           
*                                                                               
GETJX    B     ROUTE1                                                           
         DROP  R2,R3                                                            
         EJECT ,                                                                
***********************************************************************         
*        ATTEMPT TO GET NAME FOR CONTRA CODE PROVIDED. IF NO NAME     *         
*        FOUND THE RETURN THE CONTRA CODE                             *         
***********************************************************************         
*                                                                               
         USING FLDHDRD,R2                                                       
*                                                                               
CNAME    MVC   SVCACN,SPACES                                                    
         LA    R2,BASCACH                                                       
         LA    R3,IOKEY            R3=A(KEY)                                    
*                                                                               
         USING ACTRECD,R3                                                       
CNAME20  MVC   ACTKEY,SPACES                                                    
         MVC   ACTKCPY,MYCO                                                     
         MVC   ACTKULA,CONTRA                                                   
         GOTO1 AIO,IOREAD+IOACCMST+IO2 READ ACCOUNT RECORD                      
         BNE   CNAME25                                                          
         L     R3,AIO2                                                          
         LA    R4,ACTRFST          R4=A(FIRST ELEMENT)                          
         B     CNAME40                                                          
CNAME25  TM    IOERR,IOMAX         TOO MANY IOS?                                
         BNO   *+12                                                             
         OI    DISPFLAG,DISIOMAX                                                
         B     CNAMEX                                                           
         MVC   FVMSGNO,=AL2(EALDGINV)                                           
         TM    IOERR,IOERNF                                                     
         JNO   *+2                                                              
*                                                                               
CNAME30  SR    RF,RF                                                            
         IC    RF,FLDILEN                                                       
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   SVCACN(0),FLDDATA                                                
         B     CNAMEX                                                           
*                                                                               
CNAME40  CLI   0(R4),EOR           END OF RECORD?                               
         JE    *+2                                                              
         CLI   0(R4),NAMELQ        TEST NAME ELEMENT                            
         BE    CNAME60                                                          
*                                                                               
CNAME50  SR    R0,R0                                                            
         IC    R0,1(R4)                                                         
         AR    R4,R0                                                            
         B     CNAME40                                                          
*                                                                               
         USING NAMELD,R4                                                        
CNAME60  SR    RF,RF                                                            
         IC    RF,NAMLN                                                         
         SHI   RF,NAMLN1Q                                                       
         LA    RE,L'SVCACN                                                      
         CR    RF,RE                                                            
         BNH   *+6                                                              
         LR    RF,RE                                                            
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   SVCACN(0),NAMEREC                                                
         DROP  R4                                                               
*                                                                               
CNAMEX   B     ROUTX1                                                           
         EJECT ,                                                                
***********************************************************************         
*        STRING COMPARE CHECK                                         *         
* ON ENTRY PARM1             =A'(VALUE STRING TO BE CHECKED           *         
*          PARM2   BYTE 0    =L'(LOW STRING RANGE)                    *         
*                  BYTE 1-3  =A(LOW STRING RANGE)                     *         
*          PARM3   BYTE 0    =L'HIGH STRING RANGE)                    *         
*                  BYTE 1-3  =L'(HIGH STRING RANGE)                   *         
*          PARM4   BYTE 0    =A(+VE/-VE FILTERING SWITCH)             *         
* ON EXIT  CC EQUAL-    IF VALUE TO BE ACCEPTED                       *         
*          CC NOT EQUAL- IF VALUE REJECTED                            *         
***********************************************************************         
*                                                                               
         USING SCOMPD,R1                                                        
*                                                                               
SCOMP    SR    R2,R2                                                            
         ICM   R2,15,SCVAL                                                      
         ICM   RF,15,SCLST         RF=A(LOW STRING RANGE VALUE)                 
         SR    RE,RE                                                            
         ICM   RE,1,SCLSTLN        RF=L'(LOW STRING RANGE VALUE)                
         BZ    SCOM1                                                            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R2),0(RF)                                                    
         BL    SCOM20                                                           
SCOM1    ICM   RF,15,SCHST         RF=A(HIGH STRING RANGE VALUE)                
         SR    RE,RE                                                            
         ICM   RE,1,SCHSTLN        RF=L'(HIGH STRING RANGE VALUE)               
         BZ    SCOM10                                                           
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R2),0(RF)                                                    
         BH    SCOM20                                                           
SCOM10   ICM   RF,15,SCFLAG                                                     
         CLI   0(RF),NEGFILTR                                                   
         BE    SCOMREJX                                                         
         B     SCOMX                                                            
SCOM20   ICM   RF,15,SCFLAG                                                     
         CLI   0(RF),NEGFILTR                                                   
         BNE   SCOMREJX                                                         
*                                                                               
SCOMX    B     ROUTE1                                                           
*                                                                               
SCOMREJX B     ROUTH1                                                           
         DROP  R1                                                               
         EJECT ,                                                                
***********************************************************************         
*        DATE VALUE RANGE CHECK                                       *         
* ON ENTRY PARM1   BYTE 0    =L'(VALUE DATE TO BE CHECKED)            *         
*                       1-3  =A(VALUE DATE)                           *         
*          PARM2             =A(START DATE)                           *         
*          PARM3             =A(END DATE)                             *         
*          PARM4   BYTE 0    =A(+VE/-VE FILTERING SWITCH)             *         
* ON EXIT  CC EQUAL-    IF VALUE TO BE ACCEPTED                       *         
*          CC NOT EQUAL- IF VALUE REJECTED                            *         
***********************************************************************         
*                                                                               
         USING DCOMPD,R1                                                        
*                                                                               
DCOMP    SR    R2,R2                                                            
         IC    R2,DCCOMLN          R2=(COMPARE LENGTH)                          
         BCTR  R2,0                                                             
         ICM   R3,15,DCVAL         R3=A(COMPARE DATE VALUE)                     
         EX    R2,*+8                                                           
         B     *+10                                                             
         OC    0(0,R3),0(R3)       COMPARE DATE PRESENT?                        
         BZ    DCOML                                                            
         ICM   RF,15,DCDATST       RF=A(START DATE)                             
         EX    R2,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R3),0(RF)       COMPARE DATE LESS THAT START DATE?           
         BL    DCOM20                                                           
         ICM   RF,15,DCDATEN       RF=A(END DATE)                               
         EX    R2,*+8                                                           
         B     *+10                                                             
         OC    0(0,RF),0(RF)       HAVE WE AN END DATE?                         
         BZ    DCOM10                                                           
         EX    R2,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R3),0(RF)       COMPARE DATE HIGHER THAN END DATE?           
         BH    DCOM30                                                           
DCOM10   ICM   RF,15,DCFLAG                                                     
         CLI   0(RF),NEGFILTR                                                   
         BNE   DCOME                                                            
         ICM   RF,15,DCDATST       RF=A(START DATE)                             
         OC    0(0,RF),0(RF)       HAVE WE AN END DATE?                         
         BNZ   DCOMH                                                            
         B     DCOML                                                            
DCOM20   ICM   RF,15,DCFLAG                                                     
         CLI   0(RF),NEGFILTR                                                   
         BNE   DCOML                                                            
         B     DCOME                                                            
DCOM30   ICM   RF,15,DCFLAG                                                     
         CLI   0(RF),NEGFILTR                                                   
         BNE   DCOMH                                                            
         B     DCOME                                                            
*                                                                               
DCOML    B     ROUTL1                                                           
DCOMH    B     ROUTH1                                                           
DCOME    B     ROUTE1                                                           
         DROP  R1                                                               
         EJECT ,                                                                
                                                                                
***********************************************************************         
*        UNSCAN ONTO DUMMY SCREEN LINES, SURROUNDED BY BRACKETS       *         
*        USED   TO DISPLAY EXTRA DETAIL LINES                         *         
*        ON ENTRY UNSCANBLOCK CONTAINS XDETAIL INFO                   *         
*                 R2=A(NEXT AVAILABLE DUMMY SCREEN LINE)              *         
*        ON EXIT  LINSUSED INCREMENTED WITH NUMBER OF LINES USED      *         
*                 R2=A(NEXT AVAILABLE DUMMY SCREEN LINE)              *         
***********************************************************************         
         USING UNSCAND,R3                                                       
*                                                                               
XDETDIS  SR    R4,R4               NUMBER OF UNSCAN ITEMS                       
         LA    R3,UNSCANBK                                                      
         CLC   0(UNSCNLNQ,R3),SPACES ANYTHING TO DISPLAY?                       
         BE    XDETDX                                                           
         MVI   0(R2),C'('          LEFT BRACKET                                 
         LA    R5,1(R2)            R5=A(NXT AVAILABLE POSITION ON LINE)         
XDETD10  LA    RE,UNSCNLHS         RE=A(LHS KEYWORD)                            
         LA    RF,L'UNSCNLHS-1(RE)                                              
XDETD20  CLI   0(RF),C' '                                                       
         BH    *+14                                                             
         CR    RF,RE                                                            
         BE    *+12                                                             
         BCT   RF,XDETD20                                                       
         LA    RF,1(RF)                                                         
*                                                                               
         SR    RF,RE               RF=L'(LHS KEYWORD)                           
*                                                                               
         LA    RE,UNSCNRHS         RE=A(RHS VALUE)                              
         LA    R1,L'UNSCNRHS-1(RE)                                              
XDETD30  CLI   0(R1),C' '                                                       
         BH    *+14                                                             
         CR    R1,RE                                                            
         BE    *+12                                                             
         BCT   R1,XDETD30                                                       
         LA    R1,1(R1)                                                         
*                                                                               
         SR    R1,RE               R1=L'(RHS VALUE)                             
         BZ    XDETD40                                                          
         LTR   RF,RF                                                            
         BZ    XDETD40                                                          
         LA    RE,1(R1,RF)         RE=L'(KEYWORD+'='+VALUE)                     
         B     *+8                                                              
XDETD40  LA    RE,0(R1,RF)         RE=L'(KEYWORD) OR L'(VALUE)                  
         LA    R0,1(R2)                                                         
         CR    R5,R0               HAVE WE GOT ANYTHING ON THE LINE?            
         BE    XDETD60             NO                                           
         LA    RE,1(RE,R5)                                                      
         SR    RE,R0                                                            
         CHI   RE,L'DUMLIN1-2      CAN WE FIT NEXT ITEM ON THE LINE?            
         BNH   XDETD50                                                          
         MVI   0(R5),C')'          NO, CLOSE THIS LINE OFF                      
         LA    R2,L'DUMLIN1(R2)                                                 
         SR    RE,RE                                                            
         IC    RE,LINSUSED                                                      
         LA    RE,1(RE)                                                         
         SR    R0,R0                                                            
         IC    R0,MAXLINES                                                      
         CR    RE,R0                                                            
         BH    XDETDX                                                           
         STC   RE,LINSUSED                                                      
         MVI   0(R2),C'('          AND START A NEW LINE                         
         LA    R5,1(R2)                                                         
         B     XDETD60                                                          
XDETD50  MVI   0(R5),C','                                                       
         LA    R5,1(R5)                                                         
XDETD60  LTR   RF,RF               IS THERE A KEYWORD?                          
         BZ    XDETD70             NO                                           
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R5),UNSCNLHS    PUT KEYWORD ON THE LINE                      
         LA    R5,1(R5,RF)                                                      
         LTR   R1,R1               IS THERE A VALUE?                            
         BZ    XDETD80                                                          
         MVI   0(R5),C'='                                                       
         LA    R5,1(R5)                                                         
XDETD70  BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R5),UNSCNRHS    PUT VALUE ON THE LINE                        
         LA    R5,1(R5,R1)                                                      
XDETD80  LA    R3,UNSCNLNQ(R3)                                                  
         LA    R4,1(R4)                                                         
         CHI   R4,MAXUNSCN                                                      
         BNL   *+14                                                             
         CLC   0(UNSCNLNQ,R3),SPACES                                            
         BNE   XDETD10                                                          
         MVI   0(R5),C')'                                                       
         LA    R2,L'DUMLIN1(R2)                                                 
         SR    RE,RE                                                            
         IC    RE,LINSUSED                                                      
         LA    RE,1(RE)                                                         
         SR    R1,R1                                                            
         IC    R1,MAXLINES                                                      
         CR    RE,R1                                                            
         BH    XDETDX                                                           
         STC   RE,LINSUSED                                                      
*                                                                               
XDETDX   XIT1  REGS=(R2)                                                        
         DROP  R3                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* ROUTINE TO TEST FOR SECURITY ON ACCOUNT RECORDS                     *         
* NTRY - AIOAREA1 CONTAINS LOW LEVEL ACCOUNT RECORD                   *         
***********************************************************************         
         USING OPTVALSD,R2                                                      
*                                                                               
OFFACC   L     R2,AOPTVALS         R2=A(OPTION VALUES)                          
         MVI   OFFLFLAG,0                                                       
         CLC   TWAAUTH+1(1),LDGTSEC FAILED LEDGER SECURITY?                     
         BL    OFFASL                                                           
*                                                                               
         CLI   SVACTNUM,ACTNJBDE   JOB DETAIL?                                  
         BE    OFFA05                                                           
         CLI   SVACTNUM,ACTNJBCF   JOB CASHFLOW?                                
         BE    OFFA05                                                           
         CLI   SVACTNUM,ACTNODSM   ORDER SUMMARY?                               
         BE    OFFA05                                                           
         CLI   SVACTNUM,ACTNLSLT   LIST/SELECT? - LS                            
         BE    OFFA05                                                           
         CLI   SVACTNUM,ACTNLIST   LIST? - LI                                   
         BE    OFFA05                                                           
         CLI   SVACTNUM,ACTNESTL   ESTIMATE LIST?                               
         BE    OFFA05                                                           
*                                                                               
         CLI   TERMACCS,C'*'       LIMIT ACCESS?                                
         BE    OFFA05                                                           
         CLI   TERMACCS,C'$'                                                    
         BE    OFFA05                                                           
         CLI   TWAAUTH+1,0         NO SECURITY?                                 
         BE    OFFAX                                                            
         CLI   TWAAUTH+1,X'FF'     HIGHEST LEVEL?                               
         BE    OFFAX                                                            
*                                                                               
OFFA05   L     R4,AIO1                                                          
         MVC   RECOFFC,SPACES                                                   
         CLC   SPROUL,ACTKUNT-ACTRECD(R4)                                       
         BNE   OFFA10                                                           
         LA    R3,LEDGTLVC         R3=A(L'JOB LEVEL)                            
         LA    R0,3                R0=3 LEVELS - CLIENT/PRODUCT/JOB             
         B     OFFA20                                                           
*                                                                               
OFFA10   CLI   TWAAUTH+1,0         SECURITY SET UP?                             
         BE    *+12                                                             
         CLI   TWAAUTH+1,X'FF'     FULL ACCESS?                                 
         BNE   OFFA15                                                           
*                                                                               
         CLI   LDGTOFFP,LDGOFLT1   TEST OFFICE IN ACCOUNT FILTER 1-5            
         BL    OFFA110             NO - CALL OFFAL NOW                          
         CLI   LEDGTLVA,L'ACTKACT  TEST ONE LEVEL LEDGER                        
         BE    OFFA110             YES - CALL OFFAL NOW                         
*                                                                               
OFFA15   LA    R3,LEDGTLVD         R3=A(L'LOWEST POSSIBLE LEVEL)                
         LA    R0,LEDGTLVD+1-LEDGTLVA R0=MAX NUMBER OF POSSIBLE LEVELS          
         CLI   0(R3),0             TEST ANYTHING AT THIS LEVEL                  
         BNE   OFFA20              YES - LOWEST LEVEL ESTABLISHED               
         BCTR  R3,0                UP ONE LEVEL                                 
         BCT   R0,*-10             TRY AGAIN                                    
         DC    H'0'                A LEDGER WITHOUT LEVELS                      
*                                                                               
OFFA20   MVC   IOKEY,SPACES        BUILD KEY FOR ACCOUNT READ TO IO2            
         IC    R1,0(R3)            TAKE L'CURRENT LEVEL                         
         LA    R1,2(R1)            ADD CUL (-1 FOR EXECUTE)                     
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   IOKEY(0),0(R4)      TAKE PART OF KEY FROM LOW LEVEL A/C          
         GOTO1 AIO,IOREAD+IOACCDIR+IO2                                          
         BE    OFFA25                                                           
         CLI   IOERR,IOMAX                                                      
         BE    OFFAIO                                                           
         B     OFFASL              PROBABLY MISSING HIGH LEVEL ACC              
OFFA25   GOTO1 AIO,IOGET+IOACCMST+IO2                                           
         BE    *+14                                                             
         TM    IOERR,IOMAX                                                      
         BO    OFFAIO                                                           
         DC    H'0'                                                             
         L     R1,AIO2                                                          
         LA    R1,ACCRFST-ACCRECD(R1)                                           
         CLC   SPROUL,ACTKUNT-ACTRECD(R4)                                       
         BE    OFFA60                                                           
*                                                                               
         USING RSTELD,R1                                                        
OFFA30   CLI   RSTEL,0             TEST E-O-R                                   
         JE    *+2                                                              
         CLI   RSTEL,RSTELQ        TEST STATUS ELEMENT                          
         BE    OFFA40                                                           
         SR    RF,RF                                                            
         IC    RF,RSTLN                                                         
         AR    R1,RF                                                            
         B     OFFA30                                                           
OFFA40   CLC   TWAAUTH+1(1),RSTSECY+1 CHECK ACCOUNT LEVEL SECURITY              
         BNL   *+12                                                             
         MVI   OFFLFLAG,OFFLSEC    SECURITY LOCKOUT                             
         B     OFFA100                                                          
         CLC   SPROUL,ACTKUNT-ACTRECD(R4)                                       
         BE    OFFA60                                                           
         CLI   LDGTOFFP,LDGOFLT1   TEST OFFICE IN ACCOUNT FILTER 1-5            
         BL    OFFA100             NO - CALL OFFAL NOW                          
         CLC   RECOFFC,SPACES                                                   
         BNE   OFFA50                                                           
         MVC   WORK(1),LDGTOFFP    EXTRACT FILTER POSITION FOR OFFICE           
         NI    WORK,X'07'          X'F1'...X'F5' -> X'01'...X'05'               
         SR    RE,RE                                                            
         IC    RE,WORK                                                          
         IC    RE,FILTDISP-1(RE)   TAKE DISPLACMENT TO FILTER                   
         LA    RE,RSTELD(RE)       DISPLACE INTO ELEMENT                        
         CLI   0(RE),C' '          TEST OFFICE PRESENT AT THIS LEVEL            
         BNH   OFFA50                                                           
         MVC   RECOFFC(1),0(RE)    SET OFFICE                                   
         CLI   TWAAUTH+1,0         SECURITY SET UP?                             
         BE    OFFA90                                                           
         CLI   TWAAUTH+1,X'FF'     FULL ACCESS?                                 
         BE    OFFA90                                                           
OFFA50   BCTR  R3,0                NO - UP ONE LEVEL                            
         BCT   R0,OFFA20           AND TRY AGAIN                                
         CLC   RECOFFC,SPACES                                                   
         BNE   OFFA90                                                           
         CLC   TERMACCS,SPACES     NO, DO WE NEED ONE?                          
         BNH   OFFA90              NO, OK                                       
         MVI   OFFLFLAG,OFFLSEC    YES, SECURITY LOCKOUT                        
         B     OFFA100             NO OFFICE FOUND AT ANY LEVEL                 
*                                                                               
         USING PPRELD,R1                                                        
OFFA60   L     R1,AIO2                                                          
         LA    R1,ACCRFST-ACCRECD(R1)                                           
OFFA65   CLI   PPREL,0             TEST E-O-R                                   
         BE    OFFA80                                                           
         CLI   PPREL,PPRELQ        TEST PRODUCTION PROFILE ELEMENT              
         BE    OFFA70              YES - EXTRACT OFFICE                         
         SR    RF,RF                                                            
         IC    RF,PPRLN                                                         
         AR    R1,RF                                                            
         B     OFFA65                                                           
OFFA70   CLC   RECOFFC,SPACES      TEST OFFICE SET AT LOWER LEVEL               
         BH    OFFA80              SET PRODUCTION OFFICE IN OFFBLK              
         CLC   PPRUFORA,SPACES     TEST OLD UNIT FOR ANALYSIS                   
         BNH   *+10                                                             
         MVC   RECOFFC(L'PPRUFORA),PPRUFORA  EXTRACT IT                         
         CLC   PPRGAOFF,SPACES     TEST NEW OFFICE CODE                         
         BNH   OFFA80                                                           
         MVC   RECOFFC,PPRGAOFF    EXTRACT IT                                   
         B     OFFA90                                                           
OFFA80   BCTR  R3,0                READ NEXT LEVEL UP                           
         BCT   R0,OFFA20           AND TRY AGAIN                                
*                                                                               
         USING OFFALD,R1                                                        
OFFA90   L     R1,AOFFBLK          R1=A(OFFAL CONTROL BLOCK)                    
         MVC   OFFAOFFC,RECOFFC    SET OFFICE IN OFFBLK                         
         MVC   RECOFFC,SPACES      AND CLEAR THE WORK AREA                      
*                                                                               
OFFA100  MVC   IOKEY,0(R4)         RE-READ LOW LEVEL A/C FOR DMRSEQ             
         GOTO1 AIO,IOREAD+IOACCDIR+IO1                                          
         BE    OFFA110                                                          
         TM    IOERR,IOMAX                                                      
         BO    OFFAIO                                                           
         DC    H'0'                                                             
*                                                                               
OFFA110  CLI   OFFLFLAG,OFFLSEC    SECURITY LOCKOUT ALREADY ESABLISHED?         
         BE    OFFASL                                                           
         CLI   SVACTNUM,ACTNJBDE   JOB DETAIL?                                  
         BE    OFFA111                                                          
         CLI   SVACTNUM,ACTNJBCF   JOB CASHFLOW?                                
         BE    OFFA111                                                          
         CLI   SVACTNUM,ACTNODSM   ORDER SUMMARY?                               
         BE    OFFA111                                                          
         CLI   SVACTNUM,ACTNLSLT   LIST/SELECT? - LS                            
         BE    OFFA111                                                          
         CLI   SVACTNUM,ACTNLIST   LIST?  - LI                                  
         BE    OFFA111                                                          
         CLI   TERMACCS,C'*'       LIMIT ACCESS?                                
         BE    OFFA111                                                          
         CLI   TERMACCS,C'$'                                                    
         BNE   OFFAX               ONLY CHECKING TWAAUTH+1 SEC BIT?             
*                                                                               
OFFA111  L     R1,AOFFBLK          R1=A(OFFAL CONTROL BLOCK)                    
         CLI   LDGTOFFP,LDGOTRAN                                                
         BE    OFFAX                                                            
OFFA140  CLI   TERMACCS,C'*'       LIMIT ACCESS?                                
         BE    *+12                                                             
         CLI   TERMACCS,C'$'                                                    
         BNE   OFFA145                                                          
         ST    R4,OFFAREC          SAVE A(ACCOUNT RECORD)                       
         MVC   OFFAOPOS,LDGTOFFP                                                
         MVC   OFFALDGL,LEDGTLVA                                                
         MVC   OFFALDGT,LDGTCLOS                                                
         MVI   OFFAACT,OFFATST                                                  
         GOTO1 VOFFAL              CALL OFFAL FOR OFFICE/SECURITY CHECK         
         BNE   OFFASL                                                           
OFFA145  MVC   RECOFFC,OFFAOFFC    SET OFFICE CODE                              
         B     OFFAX                                                            
*                                                                               
OFFAIO   OI    DISPFLAG,DISIOMAX                                                
         B     OFFAX                                                            
*                                                                               
OFFASL   MVI   OFFLFLAG,OFFLSEC    SECURITY LOCKOUT                             
         B     OFFAX                                                            
*                                                                               
OFFAX    CLI   OFFLFLAG,0                                                       
         B     ROUTX1                                                           
*                                                                               
         DROP  R1,R2                                                            
*                                                                               
FILTDISP DS    0AL1                DISPLACEMENTS TO ACCOUNT FILTERS             
         DC    AL1(RSTFILT1-RSTELD)                                             
         DC    AL1(RSTFILT2-RSTELD)                                             
         DC    AL1(RSTFILT3-RSTELD)                                             
         DC    AL1(RSTFILT4-RSTELD)                                             
         DC    AL1(RSTFILT5-RSTELD)                                             
         EJECT                                                                  
*                                                                               
***********************************************************************         
* ROUTINE TO CALL OFFAL TO TEST IF A TRANSACTION IS LOCKED-OUT        *         
***********************************************************************         
         USING OFFALD,R1           R1=A(OFFAL CONTROL BLOCK)                    
         USING OPTVALSD,R2         R1=A(OFFAL CONTROL BLOCK)                    
OFFTRN   L     R1,AOFFBLK                                                       
         L     R2,AOPTVALS         R2=A(OPTION VALUES)                          
         MVI   OFFLFLAG,0                                                       
         L     RF,AIO1             A(TRANSACTION DATA RECORD)                   
         ST    RF,OFFAREC                                                       
         LA    RF,TRNRFST-TRNRECD(RF)                                           
*                                                                               
         CLI   0(RF),TRNELQ                                                     
         JNE   *+2                                                              
*                                                                               
         MVC   OFFAOFFC,TRNOFFC-TRNELD(RF) SET OFFICE IN OFFBLK                 
         OC    OFFALIMA,OFFALIMA   LIMIT ACCESS?                                
         BZ    OFFT04                                                           
         MVI   OFFAACT,OFFATST                                                  
         MVC   OFFAOPOS,LDGTOFFP                                                
         MVI   OFFAACT,OFFATST                                                  
         GOTO1 VOFFAL                                                           
         BNE   OFFTSL              OFFICE LOCKOUT                               
         L     RF,AIO1             A(TRANSACTION DATA RECORD)                   
         LA    RF,TRNRFST-TRNRECD(RF)                                           
*                                                                               
OFFT04   OC    OOFFICVL,OOFFICVL   OFFICE FILTER?                               
         BZ    OFFTX                                                            
         TM    COMPSTA4,CPYSOFF2   2 CHAR OFFICES?                              
         BO    OFFT30                                                           
         CLC   OOFFICVL+2(2),TRNOFFC-TRNELD(RF)                                 
         BE    OFFT10                                                           
         CLI   OOFFICFI,NEGFILTR                                                
         BNE   OFFTFL                                                           
         B     OFFTX                                                            
*                                                                               
OFFT10   CLI   OOFFICFI,NEGFILTR                                                
         BE    OFFTFL                                                           
         B     OFFTX                                                            
*                                                                               
OFFT30   SR    R0,R0                                                            
         ICM   R0,3,OOFFICLS                                                    
         BZ    OFFTX                                                            
         LA    RE,OOFFICLS+2       TEST OFFICE IS IN OPTION LIST                
*                                                                               
OFFT40   CLC   OFFAOFFC,0(RE)      MATCH OFFICE TO OPTION LIST                  
         BE    OFFT45                                                           
         LA    RE,L'TRNKOFF(RE)    BUMP TO NEXT OFFICE                          
         BCT   R0,OFFT40           DO FOR NUMBER OF LIST ENTRIES                
*                                                                               
         CLI   OOFFICFI,NEGFILTR                                                
         BNE   OFFTSL                                                           
         B     OFFTX                                                            
OFFT45   CLI   OOFFICFI,NEGFILTR                                                
         BE    OFFTSL                                                           
         B     OFFTX                                                            
OFFTSL   MVI   OFFLFLAG,OFFLSEC    SECURITY LOCKOUT                             
         B     OFFTX                                                            
OFFTFL   MVI   OFFLFLAG,OFFLFILT   FILTER                                       
OFFTX    CLI   OFFLFLAG,0                                                       
         B     ROUTX1                                                           
         DROP  R2,R1                                                            
         EJECT ,                                                                
***********************************************************************         
* ROUTINE TO CHECK OFFICE/ACCOUNT RECORDS TO OFFICE LIST              *         
***********************************************************************         
         USING OFFALD,R1               R1=A(OFFAL CONTROL BLOCK)                
         USING OPTVALSD,R2             R2=A(OFFAL OPTION  VALUES)               
OFFOFF   L     R1,AOFFBLK                                                       
         L     R2,AOPTVALS             R2=A(OPTION VALUES)                      
         LA    R3,IOKEY                KEY                                      
         MVI   OFFLFLAG,0                                                       
*--------------                                                                 
* OFFICE LISTS                                                                  
*--------------                                                                 
         OC    OOFFICVL,OOFFICVL       OFFICE LIST OVERRIDE?                    
         BZ    *+12                    . NO                                     
         LA    R4,OOFFICLS             . YES, USE WANTED OFFICES                
         B     OFFO20                                                           
*                                                                               
         L     R4,AOFFBLK              LIMITED ACCESS                           
         CLI   LDGTOFFP,LDGOTRAN       SECURITY OFFICE IN TRANSACTIONS?         
         BE    *+8                     . YES                                    
*                                                                               
         L     R4,AOFFBLK2             . NO, USE ALL OFFICES                    
         LA    R4,OFFAWORK-OFFALD(,R4)                                          
*----------------------------                                                   
* START CHECKING THE OFFICES                                                    
*----------------------------                                                   
OFFO20   SR    R0,R0                                                            
         ICM   R0,3,0(R4)                                                       
         BZ    OFFOX                                                            
         LA    R5,2(R4)                TEST OFFICE IN USER ACCESS LIST          
*                                                                               
OFFO30   CLC   0(2,R5),OFAKOFF-OFAKEY(R3)                                       
         BE    OFFO40                                                           
         LA    R5,L'TRNKOFF(R5)        BUMP TO NEXT OFFICE                      
         BCT   R0,OFFO30               DO FOR NUMBER OF LIST ENTRIES            
*                                                                               
         CLI   OOFFICFI,NEGFILTR                                                
         BNE   OFFOFL                                                           
         B     OFFOX                                                            
OFFO40   CLI   OOFFICFI,NEGFILTR                                                
         BE    OFFOFL                                                           
         B     OFFOX                                                            
*                                                                               
OFFOSL   MVI   OFFLFLAG,OFFLSEC        SECURITY LOCKOUT                         
         B     OFFOX                                                            
OFFOFL   MVI   OFFLFLAG,OFFLFILT       FILTER                                   
OFFOX    CLI   OFFLFLAG,0                                                       
         B     ROUTX1                                                           
         DROP  R2,R1                                                            
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO SET FISCAL YEAR AND BF OPTION                            *         
***********************************************************************         
         USING OPTVALSD,R2                                                      
SETFIS   L     R2,AOPTVALS                                                      
         XC    COMPFIN,COMPFIN     CLEAR COMPANY FINANCIAL YEAR YYMM            
         OC    OMOS,OMOS           ANY MOS?                                     
         BZ    SETF04              NO, USE TODAY                                
         CLI   OMOSFI,NEGFILTR     YES, NEGATIVE FILTERING?                     
         BE    SETF02              YES                                          
         OC    OMOSST,OMOSST       START MOS START SET?                         
         BZ    SETFX               NO                                           
         MVC   WORK(L'OMOSST),OMOSST                                            
         B     SETF06              YES, SAVE IT                                 
*                                                                               
SETF02   OC    OMOSEN,OMOSEN       END MOS SET?                                 
         BZ    SETFX               NO                                           
         OC    OMOSST,OMOSST       YES, DO WE HAVE A START?                     
         BNZ   SETFX               YES                                          
         MVC   WORK(L'OMOSEN),OMOSEN                                            
         B     SETF06              NO, SAVE THE END                             
*                                                                               
SETF04   GOTO1 VDATCON,DMCB,(5,0),(1,WORK) TODAYS DATE YYMMDD                   
*                                                                               
SETF06   LHI   R1,1                SET DEFAULT TO JANUARY                       
         CLI   COMPSFST,0          ANY START MONTH SET?                         
         BE    SETF07              YES                                          
         IC    R1,COMPSFST                                                      
         N     R1,=X'0000000F'                                                  
         CLI   COMPSFST,C'0'       MONTH A NUMBER OR ALPHA?                     
         BH    *+8                                                              
         LA    R1,15(R1)           CONVERT C'A' --> X'10'                       
SETF07   STC   R1,COMPFINM         SET FISCAL YEAR START MONTH                  
*                                                                               
         CLM   R1,1,WORK+1         FISCAL START MONTH TO CURRENT MONTH          
         BNH   SETF08                                                           
         GOTO1 VDATCON,DMCB,(1,WORK),(0,WORK+3)                                 
         GOTO1 VADDAY,DMCB,(C'Y',WORK+3),WORK+9,-1                              
         GOTO1 VDATCON,DMCB,(0,WORK+9),(1,WORK)                                 
SETF08   MVC   COMPFINY(1),WORK                                                 
         GOTO1 VDATCON,DMCB,(5,0),(1,WORK) TODAYS DATE YYMMDD                   
         OC    OMOS,OMOS           ANY MOA SPECIFIED?                           
         BNZ   SETF12              YES                                          
         CLI   OCF,0               ANY OVERRIDE TO FISCAL OPTION?               
         BE    SETF10              NO, USE PROFILE                              
         CLI   OCF,C'Y'            YES, USE THE CURRENT AS DEFAULT?             
         BNE   SETF12              NO                                           
         B     *+12                YES                                          
*                                                                               
SETF10   CLI   PBALDFLT,C'Y'       NO, USE CURRENT FISCAL AS DEFAULT?           
         BNE   SETF12              NO                                           
         MVC   OMOSST(L'COMPFIN),COMPFIN                                        
         MVC   OMOSEN(L'OMOSEN-1),WORK                                          
*                                                                               
SETF12   CLC   SEXPUL,BASKEY       EXPENSES LEDGER?                             
         BE    SETF14              YES                                          
         CLC   GPROUL1,BASKEY      PROFIT AND LOSS?                             
         BE    SETF14              YES                                          
         CLC   SINCUL1,BASKEY      INCOME LEDGER?                               
         BNE   SETF16              NO                                           
*                                                                               
SETF14   TM    LDGTSTA3,RSTSLABS   BAL SET ON LEDGER?                           
         BO    SETF16              YES                                          
*                                                                               
         OC    OMOS,OMOS                                                        
         BZ    SETFX                                                            
         MVC   WORK+20(2),COMPFIN                                               
         MVI   WORK+22,X'01'                                                    
         GOTO1 VDATCON,DMCB,(1,WORK+20),(0,WORK)                                
         GOTO1 VADDAY,DMCB,(C'Y',WORK),WORK+6,1                                 
         GOTO1 VADDAY,DMCB,(C'D',WORK+6),WORK+12,-1                             
         GOTO1 VDATCON,DMCB,(0,WORK+12),(1,WORK)                                
         CLC   OMOSEN,WORK                                                      
         BNH   SETFX                                                            
         CLI   OBFWD,C'Y'          PAST FISCAL YEAR, DID USER SET BBF?          
         BE    SETFX               YES                                          
         MVI   OBFWD,C'N'          NO, WE DID - TURN IT OFF                     
         B     SETFX                                                            
*                                                                               
SETF16   XC    COMPFIN,COMPFIN     CLEAR FISCAL YEAR                            
*                                                                               
SETFX    B     ROUTX1                                                           
         DROP  R2                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* ROUTINE TO DISPLAY MOS AND BBF DATES                                *         
* ON ENTRY                                                                      
*         PARM1   BYTE 0    =L'(MOS DESCRIPTION)                                
*                 BYTE 1-3  =A(MOS DESCRIPTION)                                 
*         PARM2   BYTE 0    =L'(BBF DESCRIPTION)                                
*                 BYTE 1-3  =A(BBF DESCRIPTION)                                 
***********************************************************************         
         USING FLDHDRD,R2                                                       
         USING OPTVALSD,R3                                                      
*                                                                               
DISMOS   L     R3,AOPTVALS                                                      
         LA    R2,BASMOAH                                                       
         NI    FLDATB,TURNOFF-FATBHIGH                                          
         OI    FLDOIND,FOUTTRN                                                  
         LM    R4,R5,0(R1)         SAVE PARMS                                   
         MVC   BASMOA,SPACES                                                    
         LA    RE,BASMOA                                                        
         XR    RF,RF                                                            
         IC    RF,OMOSFI                                                        
*                                                                               
         GOTO1 APERDIS,DMCB,(RE),0,((RF),OMOSST),OMOSEN                         
*                                                                               
         CLI   OBFWD,C'N'          SHOWING BALANCE FORWARD?                     
         BE    DISMFX              NO                                           
         CLI   OMOSFI,NEGFILTR     YES, NEGATIVE FILTERING?                     
         BE    DISM20              YES                                          
         OC    OMOSST,OMOSST       NO, DO WE HAVE A START MOS?                  
         BZ    DISMFX              NO                                           
         MVC   ENDBBF,OMOSST       YES, GENERATE END DATE FOR BBF               
         MVI   ENDBBF+2,X'01'                                                   
         GOTO1 VDATCON,DMCB,(1,ENDBBF),(0,WORK)                                 
         LA    RF,1                                                             
         LNR   RF,RF                                                            
         GOTO1 VADDAY,DMCB,WORK,WORK+6,(RF)                                     
         GOTO1 VDATCON,DMCB,(0,WORK+6),(1,ENDBBF)                               
         B     DISM40                                                           
*                                                                               
DISM20   OC    OMOSEN,OMOSEN       DO WE HAVE AN END MOS?                       
         BZ    DISMFX              . NO                                         
         OC    OMOSST,OMOSST       A START ALSO?                                
         BNZ   DISMFX              . YES                                        
         MVC   ENDBBF,OMOSEN       . NO, END BECOMES END OF BBF                 
         MVI   ENDBBF+2,X'01'                                                   
*                                                                               
DISM40   CLC   COMPFIN,ENDBBF      CHECK IF BBF DATE NEEDED                     
         BH    DISMFX                                                           
         MVC   WORK,COMPFIN                                                     
         MVI   WORK+2,X'01'                                                     
*                                                                               
         LA    R2,GRDDAT1H                                                      
         TM    PCDRIVEN,PCGRIDQ                                                 
         BO    *+8                                                              
         LA    R2,ENQDAT1H                                                      
         LA    RF,FLDDATA+L'ENQDAT1-DATPRLNQ                                    
         CLI   SVACTNUM,ACTNLSLT              TEST LIST/SELECT ENQUIRY?         
         BNE   *+12                                                             
         LA    R2,LSTDAT1H                                                      
         LA    RF,FLDDATA+L'LSTDAT1-DATPRLNQ                                    
*                                                                               
         MVC   0(DATPRLNQ,RF),SPACES                                            
         NI    FLDATB,TURNOFF-FATBHIGH                                          
         OI    FLDOIND,FOUTTRN                                                  
         GOTO1 APERDIS,DMCB,(RF),(R5),(0,WORK),ENDBBF                           
         B     DISMX                                                            
*                                                                               
DISMFX   XC    ENDBBF,ENDBBF                                                    
         LA    R2,GRDDAT1H                                                      
         TM    PCDRIVEN,PCGRIDQ                                                 
         BO    *+8                                                              
         LA    R2,ENQDAT1H                                                      
         LA    RF,FLDDATA+L'ENQDAT1-DATPRLNQ                                    
         CLI   SVACTNUM,ACTNLSLT              TEST LIST/SELECT ENQUIRY?         
         BNE   *+12                                                             
         LA    R2,LSTDAT1H                                                      
         LA    RF,FLDDATA+L'LSTDAT1-DATPRLNQ                                    
         MVC   0(DATPRLNQ,RF),SPACES                                            
DISMX    B     ROUTX1                                                           
         EJECT ,                                                                
***********************************************************************         
*        MAKE UP BUCKET VALUE FROM A 'SCIELD'                         *         
* ON ENTRY PARM 1 HOLDS ADDRESS OF SCIELD                             *         
*          PARM 2 HOLDS ADDRESS OF TRANSACTION RECORD                 *         
*          PARM 4 HOLDS ADDRESS OF 8 BYTE FIELD FOR DEBITS            *         
*          PARM 5 HOLDS ADDRESS OF 8 BYTE FIELD FOR CREDITS           *         
* ON EXIT  DEBIT AND CREDITS SET                                      *         
***********************************************************************         
*                                                                               
         USING TRNRECD,R2                                                       
         USING SCIELD,R3                                                        
*                                                                               
BUKMAKE  L     R3,0(,R1)                                                        
         L     R2,4(,R1)                                                        
         LM    RE,RF,8(R1)                                                      
         ST    RE,ADEBIT                                                        
         ZAP   0(8,RE),=P'0'                                                    
         ST    RF,ACREDIT                                                       
         ZAP   0(8,RF),=P'0'                                                    
         MVI   SYSCTRY,SYSCNAM     SET NORTH AMERICA                            
         ZAP   BUCKDR,=P'0'        LOCATE SUBSIDIARY CASH ELEMENTS              
         ZAP   BUCKCR,=P'0'                                                     
         L     R1,ABUKTAB                                                       
         USING BUKTABD,R1          R1=A(BUCKET TYPE TABLE)                      
BUKM10   CLI   BUKTSYSC,BUKTEOTQ   TEST EOT                                     
         BE    BUKMREJX                                                         
         CLI   BUKTSYSC,SYSCANY    TEST ANY SYSTEM COUNTRY VALID                
         BE    BUKM30                                                           
         TM    BUKTSYSC,SYSCNOT    TEST 'NOT' SYSTEM COUNTRY                    
         BZ    BUKM20                                                           
         MVC   BYTE1,BUKTSYSC      EXTRACT SYSTEM COUNTRY FROM TABLE            
         NI    BYTE1,TURNOFF-SYSCNOT  TURN OFF 'NOT' BIT                        
         CLC   BYTE1,SYSCTRY       MATCH ON SYSTEM COUNTRY CODE                 
         BNE   BUKM30              CARRY ON IF NOT EQUAL                        
         B     BUKM40                                                           
BUKM20   CLC   BUKTSYSC,SYSCTRY    MATCH ON SYSTEM COUNTRY CODE                 
         BNE   BUKM40                                                           
BUKM30   CLC   BUKTITYP,SCITYPE    MATCH ON BUCKET (ELEMENT) TYPE               
         BNE   BUKM40                                                           
         CLC   BUKTLEDG,SPACES     TEST SPECIAL LEDGER IN TABLE                 
         BE    BUKM50                                                           
         CLC   BUKTLEDG,TRNKUNT    YES - MATCH ON LEDGER                        
         BE    BUKM50                                                           
BUKM40   LA    R1,BUKTABL(R1)      BUMP TO NEXT TABLE ENTRY                     
         B     BUKM10                                                           
*                                                                               
BUKM50   CLI   BUKTOTYP,0          TEST DON'T CREATE BUCKET RECORD              
         BE    BUKMREJX                                                         
         L     RF,AOPTVALS         RF=A(OPTION VALUES)                          
         USING OPTVALSD,RF                                                      
         CLC   OBUKTYPE,BUKTOTYP                                                
         BNE   BUKMREJX                                                         
         DROP  RF                                                               
         SR    RF,RF                                                            
         ICM   RF,3,BUKTROUT                                                    
         BZ    BUKMREJX                                                         
         LA    RF,ROUT1(RF)                                                     
         BASR  RE,RF               CALL SUBSIDIARY CASH ROUTINE                 
         B     BUKMX               RETURNS AT 0(RE) TO SKIP BUCKET              
         DROP  R1                                                               
*                                                                               
BUKMX    L     RF,ADEBIT                                                        
         ZAP   0(8,RF),BUCKDR                                                   
         L     RF,ACREDIT                                                       
         ZAP   0(8,RF),BUCKCR                                                   
         B     ROUTE1                                                           
*                                                                               
BUKMREJX B     ROUTH1                                                           
         EJECT ,                                                                
***********************************************************************         
* HANDLE SUBSIDIARY CASH ELEMENTS FOR BUCKET UPDATING                 *         
***********************************************************************         
*                                                                               
BTGRNT   DS    0H                  GROSS/NET FOR US COKE EXPENDITURE            
         ZAP   BUCKDR,SCIGRS       FOR COKE GROSS=DEBIT, NET=CREDIT             
         CLI   SCILN,SCILN2Q                                                    
         BL    *+10                                                             
         ZAP   BUCKCR,SCINET                                                    
         B     4(,RE)                                                           
*                                                                               
BTVEHI   DS    0H                  VEHICLES                                     
BTHOUR   DS    0H                  HOURS                                        
BTGRSS   DS    0H                  GROSS                                        
BTIVAT2P DS    0H                  VAT                                          
BTGLEV   DS    0H                  NET (GROSS LESS VAT)                         
         LA    R1,BUCKDR           POST DEBIT/CREDIT BASED ON TRNSTAT           
         LA    R2,TRNRFST                                                       
         USING TRNELD,R2                                                        
         TM    TRNSTAT,TRNSDR                                                   
         BNZ   *+8                                                              
         LA    R1,BUCKCR                                                        
         ZAP   0(L'BUCKCR,R1),SCIAMNT                                           
         B     4(RE)                                                            
         DROP  R2                                                               
*                                                                               
BTHOUR1R DS    0H                  HOURS (1R LEDGER ONLY)                       
         LA    R1,BUCKCR                                                        
         LA    R2,TRNRFST-TRNRECD(R2)                                           
         USING TRNELD,R2                                                        
         CP    TRNAMNT,=P'0'                                                    
         BE    *+8                                                              
         LA    R1,BUCKDR                                                        
         ZAP   0(L'BUCKDR,R1),SCIAMNT                                           
         B     4(RE)                                                            
         DROP  R2                                                               
*                                                                               
BTGRSS1J DS    0H                  GROSS (US 1J LEDGER ONLY)                    
BTHOUR1J DS    0H                  HOURS (US 1J LEDGER ONLY)                    
BTVEHI1J DS    0H                  VEHICLES (US 1J LEDGER ONLY)                 
BTFEEA   DS    0H                  FEE ADJUSTMENTS                              
BTFEES   DS    0H                  FEES                                         
         ZAP   BUCKDR,SCIAMNT      AMOUNT TO DEBIT                              
         CLI   SCILN,SCILN2Q                                                    
         BNE   *+10                                                             
         ZAP   BUCKCR,SCIADMN      ADMIN TO CREDIT (IF PRESENT)                 
         B     4(RE)                                                            
*                                                                               
BTDEPR41 DS    0H                  ASSET DEPRECIATION (LEDGER 41 ONLY)          
BTBENE   DS    0H                  BENEFITS (US 1R LEDGER ONLY?)                
         ZAP   BUCKDR,SCIAMNT      BENEFIT                                      
         ZAP   BUCKCR,SCIADMN      ADMINISTRATIVE                               
         B     4(RE)                                                            
*                                                                               
BTIAMTST DS    0H                  INSURABLE AMOUNT (UK LEDGER ST ONLY)         
BTFORDST DS    0H                  INCOME DEBIT (UK LEDGER ST ONLY)             
BTJHRSST DS    0H                  NET DEBIT (UK LEDGER ST ONLY)                
         ZAP   BUCKDR,SCIAMNT                                                   
         B     4(RE)                                                            
*                                                                               
BTINCAST DS    0H                  INCOME CREDIT (UK ST LEDGER ONLY)            
BTGLEVST DS    0H                  NET CREDIT (UK LEDGER ST ONLY)               
         ZAP   BUCKCR,SCIAMNT                                                   
         B     4(RE)                                                            
         DROP  R3                                                               
         EJECT ,                                                                
***********************************************************************         
* ROUTINE TO BUILD SOURCE ACCOUNT FROM ELEMENT AND/OR TRANSACTION KEY *         
***********************************************************************         
*                                                                               
BLDSRC   MVC   SRCWORK,SPACES      CLEAR SOURCE ACCOUNT WORK AREA               
         MVC   SRCWC,SPACES        CLEAR WORK CODE                              
         XC    SRCFMMD,SRCFMMD     MEDIA MONTH/DATE                             
         XC    SRCPERD,SRCPERD     MEDIA PAYEMNT PERIOD                         
         ZAP   SRCFTAX,=P'0'       GST/GST BASIS                                
         MVI   SRCIND,0            INDICATOR BYTE                               
         L     R2,AIO1             R2=A(TRANSACTION RECORD)                     
         USING TRNRECD,R2                                                       
*                                                                               
         CLI   BASKEY,C'S'         SUBSIDIARY UNIT?                             
         BNE   BLDSCX                                                           
         L     R4,ALDGTAB          R4=A(LEDGER ATTRIBUTE TABLE)                 
         USING LEDGTABD,R4                                                      
BLDSRC1  CLI   LEDGTYPE,EOT        END OF TABLE?                                
         BE    BLDSCX                                                           
         CLC   LEDGTYPE,TRNKLDG    MATCH ON LEDGER?                             
         BE    *+12                                                             
         LA    R4,LEDGLNQ(R4)                                                   
         B     BLDSRC1                                                          
         TM    LEDGATTR,LEDGCRD    CREDITOR LEDGER?                             
         BNO   BLDSCX                                                           
*                                                                               
         CLC   SPROUL,TRNKULC                                                   
         BE    BLDSR1                                                           
         TM    LEDGATTR,LEDGSPOT+LEDGPRNT SPOT OR PRINT?                        
         BZ    BLDSRC1A                                                         
         LA    RE,TRNKCACT+9       RE=A(CLIENT CODE ON PRINT/SPOT)              
         B     *+8                                                              
BLDSR1   LA    RE,TRNKCACT         RE=A(CLIENT CODE ON PRODUCTION)              
         SR    RF,RF                                                            
         IC    RF,CLEN             RF=L'CLIENT                                  
         BCTR  RF,0                RF=X L'CLIENT                                
         MVC   SRCWORK(L'SPROUL),SPROUL                                         
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   SRCWORK+L'SPROUL(0),0(RE) EXTRACT SJCLIENT                       
*                                                                               
BLDSRC1A LA    R2,TRNRFST-TRNRECD(R2)                                           
         USING TRNELD,R2           R2=A(TRNEL)                                  
         LR    R3,R2               R3=A(TRNEL)                                  
*                                                                               
         TM    LEDGATTR,LEDGSPOT+LEDGPRNT TEST MEDIA VENDOR                     
         BZ    BLDSRC02                                                         
         CLI   TRNEL,TRNELQ        TEST TRANSACTION ELEMENT                     
         JNE   *+2                                                              
         GOTO1 VDATCON,DMCB,(1,TRNDATE),(0,WORK)                                
         MVI   BYTE1,X'FF'         SET DAY IS KNOWN                             
         SR    RF,RF                                                            
         IC    RF,CLEN                                                          
         LA    R1,SRCWORK+L'SPROUL(RF)                                          
         SR    RE,RE                                                            
         IC    RE,CPLEN                                                         
         SR    RE,RF                                                            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),TRNREF                                                   
*                                                                               
BLDSRC02 SR    R0,R0                                                            
         IC    R0,TRNLN                                                         
         AR    R2,R0                                                            
         CLI   0(R2),EOR           TEST EOR                                     
         BE    BLDSRC50                                                         
         CLI   0(R2),SCIELQ        SUBSIDIARY CASH ELEMENT                      
         BE    BLDSRC30                                                         
         TM    LEDGATTR,LEDGPROD   TEST PRODUCTION                              
         BNO   BLDSRC04                                                         
         CLI   0(R2),OTHELQ        OTHERS ELEMENT                               
         BE    BLDSRC26                                                         
         B     BLDSRC02                                                         
*                                                                               
BLDSRC04 CLI   0(R2),XPYELQ        MEDIA EXTRA PAYMENT ELEMENT                  
         BE    BLDSRC16                                                         
         CLI   0(R2),FFTELQ        FREE FRM TEXT ELEMENT?                       
         BE    BLDSRC24                                                         
         CLI   0(R2),MDTELQ        MEDIA TRANSFER ELEMENT?                      
         BE    BLDSRC25                                                         
         B     BLDSRC02                                                         
*                                                                               
         USING XPYELD,R2           R2=A(EXTRA PAYMENT ELEMENT)                  
BLDSRC16 TM    LEDGATTR,LEDGSPOT+LEDGPRNT TEST SPOT/PRINT VENDOR                
         BZ    BLDSRC22                                                         
         OC    XPYPER,XPYPER       TEST PAYMENT PERIOD                          
         BZ    BLDSRC22                                                         
*        TM    LEDGATTR,LEDGSPOT                                                
*        BNO   *+10                                                             
         MVC   SRCPERD,XPYPER                                                   
*                                                                               
*LDSRC22 L     R1,AIO1                                                          
*        SR    RE,RE                                                            
*        IC    RE,CPLEN            RE=L'CLIENT/PRODUCT                          
*        SR    RF,RF                                                            
*        IC    RF,CLEN             RF=L'CLIENT                                  
*        SR    RE,RF               RE=L'PRODUCT                                 
*        LA    R1,(TRNKCACT+L'TRNKCACT)-TRNRECD(R1)                             
*        SR    R1,RF               R1=A(CLIENT CODE IN C/A)                     
*        BCTR  RF,0                                                             
*        EX    RF,*+4                                                           
*        MVC   SRCWORK(0),0(R1)    EXTRACT CLIENT                               
*        LA    R1,SRCWORK+1(RF)                                                 
*        L     RF,AIO1             ASSUME PRODUCT IN KEY REFERENCE              
*        LA    RF,TRNKREF-TRNRECD(RF)                                           
*        TM    LEDGATTR,LEDGPRNT   TEST PRINT VENDOR                            
*        BNZ   BLDSRC24                                                         
*        LA    RF,XPYPRO           ELSE PRODUCT IN XPYEL                        
*        CLC   XPYPRO(3),=C'POL'   TEST POL=                                    
*        BNE   BLDSRC24                                                         
*        LA    RF,XPYPRO+4         SKIP TO PRODUCT                              
*LDSRC24 BCTR  RE,0                RE=L'PRODUCT-1                               
*        EX    RE,*+4                                                           
*        MVC   0(0,R1),0(RF)       EXTRACT PRODUCT                              
BLDSRC22 OC    XPYEST,XPYEST       TEST ESTIMATE PRESENT                        
         BZ    BLDSRC02                                                         
         SR    RF,RF                                                            
         IC    RF,CPLEN                                                         
         LA    RF,SRCWORK+L'SPROUL(RF)                                          
         CURED XPYEST,(6,(RF)),0,ALIGN=LEFT                                     
         B     BLDSRC02                                                         
*                                                                               
         USING FFTELD,R2                                                        
BLDSRC24 CLI   FFTTYPE,FFTTESTN    ESTIMATE NUMBER ELEMENT?                     
         JNE   BLDSRC02                                                         
         SR    RF,RF                                                            
         IC    RF,CPLEN                                                         
         LA    RF,SRCWORK+L'SPROUL(RF)                                          
         MVC   0(L'FFTOESTN,RF),FFTOESTN                                        
         B     BLDSRC02                                                         
*                                                                               
         USING MDTELD,R2           MEDIA TRANSFER ELEMENT                       
BLDSRC25 MVC   SRCWORK(L'SPROUL),SPROUL UNIT/LEDGER                             
         LA    RE,SRCWORK+L'SPROUL                                              
         SR    RF,RF                                                            
         IC    RF,CLEN             RF=(LENGTH OF CLIENT LEVEL)                  
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),MDTCLI      GET CLIENT                                   
         LA    RE,1(RE,RF)                                                      
         SR    R1,R1                                                            
         IC    R1,CLEN             RF=(LENGTH OF CLIENT LEVEL)                  
         SR    RF,RF                                                            
         IC    RF,CPLEN            RF=(LENGTH OF CLIENT+PROD LEV)               
         SR    RF,R1               RF=(LENGTH OF PRODUCT LEVEL)                 
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),MDTPRD      GET PRODUCT                                  
         LA    RE,1(RE,RF)                                                      
         SR    R1,R1                                                            
         IC    R1,CPLEN            RF=(LENGTH OF CLIENT+PROD LEV)               
         SR    RF,RF                                                            
         IC    RF,CPJLEN           RF=(LENGTH OF CLIENT+PROD+JOB LEV)           
         SR    RF,R1               RF=(LENGTH OF JOB LEVEL)                     
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),MDTJOB      GET JOB                                      
         B     BLDSRC02                                                         
*                                                                               
         USING OTHELD,R2           R2=A(OTHERS ELEMENT)                         
         USING TRNELD,R3           R3=A(TRANSACTION ELEMENT)                    
BLDSRC26 SR    RE,RE                                                            
         IC    RE,CPLEN            RE=L'CLIENT/PRODUCT                          
         SR    RF,RF                                                            
         IC    RF,CLEN             RF=L'CLIENT                                  
         SR    RE,RF               RE=L'PRODUCT                                 
         LR    R0,RE               R0=L'PRODUCT                                 
         LA    R1,SRCWORK+L'SPROUL(RF)                                          
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),OTHNUM      EXTRACT PRODUCT                              
         LA    R1,1(R1,RE)                                                      
         SR    RE,RE                                                            
         IC    RE,CPJLEN           RE=L'CLIENT/PRODUCT/JOB                      
         SR    RF,RF                                                            
         IC    RF,CPLEN            RF=L'CLIENT/PRODUCT                          
         SR    RE,RF               RE=L'JOB                                     
         CLM   RE,1,=AL1(6)        CHECK NOT TOO LONG FOR OTHNUM                
         BNH   *+8                                                              
         LA    RE,6                THIS IS THE MAXIMUM PERMISSABLE              
         BCTR  RE,0                                                             
         CLI   TRNTYPE,9           TEST MEDIA TRANSFER                          
         BE    *+12                                                             
         LA    RF,OTHNUM+6         NO - JOB IS AT OTHNUM+6                      
         B     BLDSRC27                                                         
         LA    RF,OTHNUM           YES - JOB IS AT OTHNUM+L'PRODUCT             
         AR    RF,R0                                                            
BLDSRC27 EX    RE,*+8                                                           
         B     BLDSRC02            GO BACK FOR NEXT ELEMENT                     
         MVC   0(0,R1),0(RF)       EXTRACT JOB                                  
*                                                                               
         USING SCIELD,R2           R2=A(SUBSIDIARY CASH ELEMENT)                
BLDSRC30 CLI   SCITYPE,SCITGLEV    TEST GST BASIS (IE. NET)                     
         BE    *+12                                                             
         CLI   SCITYPE,SCITTAXP    TEST GST AMOUNT                              
         BNE   BLDSRC02                                                         
         ZAP   SRCFTAX,SCIAMNT     SET GST OR GST BASIS                         
         B     BLDSRC02                                                         
*                                                                               
         USING GINELD,R2           R2=A(GROUP INVOICE NUMBER ELEMENT)           
BLDSRC40 MVC   SRCWORK,SPLIT                                                    
         LA    RE,L'LC@SPLIT-1                                                  
         LA    R1,LC@SPLIT(RE)                                                  
         CLI   0(R1),C' '                                                       
         BH    *+10                                                             
         BCT   RE,*-12                                                          
         DC    H'0'                                                             
         LA    RF,L'SRCWORK                                                     
         LA    R1,2(RE)                                                         
         CR    R1,RF                                                            
         BH    BLDSRC02                                                         
         SR    RF,RE                                                            
         SRA   RF,1                                                             
         LA    RF,SRCWORK(RF)                                                   
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RF),LC@SPLIT                                                 
         B     BLDSRC02                                                         
*                                                                               
         USING MDTELD,R2           MEDIA TRANSFER ELEMENT                       
BLDSRC50 ICM   R2,15,AMDTELD                                                    
         BZ    BLDSRC60                                                         
         MVC   SRCFMMD(L'MDTMOS),MDTMOS                                         
         B     BLDSC100                                                         
*                                                                               
         USING GDAELD,R2           GENERAL DATE ELEMENT                         
BLDSRC60 ICM   R2,15,AGDAELD                                                    
         BZ    BLDSRC70                                                         
BLDSRC64 CLI   GDATYPE,GDAMMOS                                                  
         BE    BLDSRC68                                                         
BLDSRC66 SR    RF,RF                                                            
         IC    RF,1(R2)                                                         
         AR    R2,RF                                                            
         CLI   GDAEL,0             END OF RECORD?                               
         BE    BLDSRC70                                                         
         CLI   GDAEL,GDAELQ        STILL GENERAL DATE?                          
         BE    BLDSRC64                                                         
         B     BLDSRC66                                                         
BLDSRC68 MVC   SRCFMMD(L'GDAYYMM),GDAYYMM                                       
         B     BLDSC100                                                         
         DROP  R2                                                               
*                                                                               
         USING MBIELD,R2           NEW BILLING XFER ELEM                        
BLDSRC70 ICM   R2,15,AMBIELD                                                    
         BZ    BLDSRC80                                                         
         MVC   SRCFMMD(L'MBIMOS),MBIMOS                                         
         B     BLDSC100                                                         
         DROP  R2                                                               
*                                                                               
         USING OTHELD,R2           OTHERS ELEMENT                               
         USING TRNELD,R3           R3=A(TRANSACTION ELEMENT)                    
BLDSRC80 ICM   R2,15,AOTHELD                                                    
         BZ    BLDSRC90                                                         
         CLI   TRNTYPE,9           TEST MEDIA TRANSFER                          
         BNE   BLDSC100                                                         
         MVC   SRCFMMD(L'OTHDATE),OTHDATE  SET MEDIA MONTH/DATE                 
         B     BLDSC100                                                         
         DROP  R2,R3                                                            
*                                                                               
         USING XPYELD,R2           EXTRA PAYMENT ELEMENT                        
BLDSRC90 ICM   R2,15,AXPYELD                                                    
         BZ    BLDSC100                                                         
         TM    LEDGATTR,LEDGSPOT+LEDGPRNT TEST SPOT/PRINT VENDOR                
         BZ    BLDSC100                                                         
         OC    XPYPER,XPYPER       TEST PAYMENT PERIOD                          
         BZ    BLDSRC92                                                         
         LA    RF,XPYPER+6         FIRST TRY THE END DATE                       
         CLI   0(RF),C'-'          SEPARATED BY A DASH?                         
         BNE   *+8                                                              
         LA    RF,1(RF)            RF TO END DATE                               
         CLI   0(RF),C' '          ANY DATA IN END DATE FIELD                   
         BH    *+8                                                              
         LA    RF,XPYPER           NO, USE START DATE                           
         MVC   WORK(6),0(RF)                                                    
         CLC   WORK+4(2),=C'00'    CHECK THE DAY                                
         BNE   BLDSRC92                                                         
         MVC   WORK+4(2),=C'01'    ASSUME FIRST OF MONTH                        
         MVI   BYTE1,0             SET DAY IS ASSUMED                           
*                                                                               
BLDSRC92 TM    LEDGATTR,LEDGSPOT   TEST MEDIA SPOT VENDOR                       
         BZ    BLDSRC94                                                         
         TM    LEDGATTR,LEDGNETW   BUT NOT NETWORK SPOT VENDOR                  
         BO    BLDSRC94                                                         
         L     RF,AIO1             R2=A(TRANSACTION RECORD)                     
         USING TRNRECD,RF                                                       
         CLI   TRNKACT,C'N'        OLD NETWORK SPOT VENDOR (SS IS USED)         
         BE    BLDSRC94                                                         
         DROP  RF                                                               
         GOTO1 VDATCON,DMCB,(0,WORK),(0,WORK)  CHANGE PAY PERI TO DDS           
         L     RF,ACOMFACS                                                      
         USING COMFACSD,RF                                                      
         GOTO1 VGETBRD,DMCB,(1,WORK),WORK+6,CGETDAY,CADDAY                      
         DROP  RF                                                               
         MVC   WORK(6),WORK+12     SET END DATE OF BROADCAST MONTH              
         MVI   BYTE1,X'FF'         SET DAY IS KNOWN                             
*                                                                               
BLDSRC94 GOTO1 VDATCON,DMCB,(0,WORK),(1,SRCFMMD)                                
         CLI   BYTE1,0             TEST DAY WAS ASSUMED                         
         BNE   BLDSC100                                                         
         MVI   SRCFMMD+L'SRCFMMD-1,0                                            
*                                                                               
BLDSC100 DS    0H                                                               
         CLC   SRCWORK,SPACES      TEST IF SOURCE ACCOUNT WAS EXTRACTED         
         BE    *+12                                                             
         OI    SRCIND,SRCJEST      SOURCE A/C IS GENUINE JOB/ESTIMATE           
         B     BLDSCX                                                           
         L     R1,AIO1             IF NOT - SET CONTRA ACCOUNT                  
         CLC   SPROUL,TRNKCUNT-TRNRECD(R1)                                      
         BNE   BLDSCX                                                           
         MVC   SRCWORK,TRNKCUNT-TRNRECD(R1)                                     
*                                                                               
BLDSCX   B     ROUTX1                                                           
         DROP  R2,R4                                                            
         EJECT                                                                  
*                                                                               
***********************************************************************         
* VALIDATE DISPLAY=ABC OR +ABC OR ABC+ OR ++ (ALL COLUMNS)            *         
***********************************************************************         
         USING OPTVALSD,R2                                                      
BLOVDIS  L     R2,AOPTVALS                                                      
         CLI   ODSPFI,0            NEGATIVE FILTER NOT ALLOWED                  
         BNE   BLOVERRX                                                         
*                                                                               
         USING DCLTABD,RF                                                       
         L     RF,ADCLTAB          RF=A(DEFAULT COLUMN TABLE)                   
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
*                                                                               
BLOVD1   CLI   DCLACTN,EOT         END OF TABLE?                                
         BE    BLOVERRX                                                         
**NOP    DC    H'0'                ENTRY MISSING FROM DCLTAB                    
         CLC   DCLACTN,SVACTNUM    MATCH ON ACTION NUMBER?                      
         BE    BLOVD3                                                           
         XR    R0,R0               BUMP TO NEXT ENTRY                           
         IC    R0,DCLLEN                                                        
         AR    RF,R0                                                            
         B     BLOVD1                                                           
*                                                                               
BLOVD3   XR    RE,RE                                                            
         ICM   RE,3,DCLACOL        DISPLACEMENT TO COL TABLE                    
         L     R1,ADISTAB                                                       
         AR    R1,RE                                                            
         ST    R1,ADISENT          SAVE ADDRESS OF COLUMN TABLE                 
         LA    RF,DCLDATA                                                       
         USING DCLDATA,RF                                                       
BLOVD5   CLI   DCLLEDG,DCLDEFQ     DEFAULT LEDGER COLUMN LIST                   
         BE    BLOVD7                                                           
         CLC   DCLLEDG,LDGTUL      MATCH ON UNIT/LEDGER?                        
         BE    BLOVD7                                                           
         LA    RF,DCLDALNQ(RF)                                                  
         B     BLOVD5                                                           
*                                                                               
BLOVD7   LA    R0,DCLCOLS                                                       
         ST    R0,ADEFCOL          DEFAULT COLUMNS                              
         DROP  RF                                                               
*                                                                               
         XC    WORK,WORK                                                        
         XC    BLOCHR,BLOCHR                                                    
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
         L     R1,ADEFCOL          R1=A(DEFAULT COLUMN LIST FOR LEDGER)         
         CLI   SVACTNUM,ACTNVEND   ACTION VENDOR IN US                          
         BNE   STE                                                              
         OC    PDISCOL1(L'PDISCOL1+L'PDISCOL2),PDISCOL1 PROFILES SET?           
         BNZ   *+14                                                             
STE      MVC   PDISCOL1(L'DCLCOLS),0(R1) NO PROFILES SO USE DEFAULT             
         B     BLOVDIAD                                                         
         LA    RF,PDISCOL1         RF=A(PROFILE COLUMN LIST)                    
         LA    R0,L'DCLCOLS        R0=L'(DEFAULT COLUMN LIST)                   
BLOVDIAA CLI   0(RF),C'*'          DEFAULT COL SUBSTITUTION REQUIRED?           
         BH    *+10                                                             
         MVC   0(1,RF),0(R1)       SUBSTITUTE DEFAULT COLUMN                    
         LA    R1,1(R1)                                                         
         LA    RF,1(RF)                                                         
         BCT   R0,BLOVDIAA                                                      
*                                                                               
BLOVDIAD CLI   ODSPLN,0            DISP= OPTION IN USE?                         
         BE    *+12                                                             
         CLI   ODSPVAL,C'+'        LEADING + =(PROF/DEF COLS +OPT COLS)         
         BNE   BLOVDI06                                                         
         LA    RF,L'PDISCOL1+L'PDISCOL2                                         
         GOTO1 ADDCOL,DMCB,((RF),PDISCOL1) ADD PROFILE/DEFAULT COLS             
         XR    RE,RE                                                            
         ICM   RE,1,ODSPLN         DISP= OPTION IN USE?                         
         BZ    BLOVDI00                                                         
*                                                                               
BLOVDIAE SHI   RE,1                TEST ONLY 1 CHARACTER INPUT                  
         BZ    BLOVDI08                                                         
         CLI   ODSPLN,2            TEST FOR DIS=++                              
         BNE   BLOVDI04                                                         
         CLI   ODSPVAL+1,C'+'                                                   
         BNE   BLOVDI04                                                         
*                                  DIS=++ IN USE (OR ASSUMED - US/CAN)          
BLOVDI00 L     R3,ADISENT          R1=A(DISPLAY TABLE)                          
         USING DISTABD,R3                                                       
BLOVDI02 CLI   DISTABD,EOT         END OF TABLE?                                
         BE    BLOVDISX                                                         
         GOTO1 ADDCOL,DMCB,(1,DISCHR) APPEND ALL OTHER COLUMNS                  
         LA    R3,DISTABL(R3)                                                   
         B     BLOVDI02                                                         
         DROP  R3                                                               
*                                  DIS=+ IN USE                                 
BLOVDI04 MVI   WORK,BLODISIS       OPTION COLUMNS WILL SUFFIX PROF/DEF          
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   ODSPVAL(0),ODSPVAL+1 OVERWRITE '+'                               
         STC   RE,ODSPLN           SET LENGTH OF INPUT                          
         B     BLOVDI08                                                         
*                                  DIS=ABC OR DIS=ABC+                          
BLOVDI06 XR    RE,RE                                                            
         ICM   RE,1,ODSPLN                                                      
         LA    RF,ODSPVAL-1(RE)    POINT TO END OF INPUT STRING                 
         CLI   0(RF),C'+'          TEST FOR TRAILING + SIGN (PREFIX)            
         BNE   BLOVDI08                                                         
         MVI   WORK,BLODISIP       PLACE DIS= COLUMN LIST B4 PROF/DEF           
         MVI   0(RF),C' '                                                       
         SHI   RE,1                                                             
         BZ    BLOVERRX                                                         
         STC   RE,ODSPLN           SET L'(DIS= COLUMN LIST)                     
*                                                                               
BLOVDI08 GOTO1 ADDCOL,DMCB,(ODSPLN,ODSPVAL) ADD DIS= COLUMNS                    
         BE    *+14                                                             
         MVC   FVXTRA(1),0(R1)                                                  
         B     BLOVERRX                                                         
*                                                                               
         CLI   WORK,BLODISIP       TEST INPUT COLUMNS ARE PREFIX                
         BNE   BLOVDISX                                                         
BLOVDIDF LA    RF,L'PDISCOL1+L'PDISCOL2 RF=L'(DEFAULT COLUMN LIST)              
         GOTO1 ADDCOL,DMCB,((RF),PDISCOL1) ADD PROFILE 1 COLUMNS                
         B     BLOVDISX                                                         
*                                                                               
BLOVDISX XC    BLOKEY,BLOKEY                                                    
         SR    RF,RF                                                            
         ICM   RF,1,BLOKEYN                                                     
         BZ    BLOVDX1             KEY INDICATOR NOT FOUND                      
         SHI   RF,1                RESET TO ACTUAL NUMBER OF COLS               
         STC   RF,BLOKEYN                                                       
         BZ    BLOVDX1                                                          
         CHI   RF,L'BLOKEY                                                      
         BNH   *+8                                                              
         LA    RF,L'BLOKEY                                                      
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   BLOKEY(0),WORK+1                                                 
         LA    RF,1(RF)                                                         
BLOVDX1  LA    RF,WORK+1(RF)                                                    
         CLI   0(RF),0                                                          
         BE    BLOVERRX                                                         
         MVC   BLODIS,0(RF)                                                     
         B     ROUTE1                                                           
*                                                                               
BLOVERRX B     ROUTH1                                                           
         DROP  R2                                                               
         EJECT ,                                                                
***********************************************************************         
* ADD A COLUMN TO LIST OF DISPLAY COLUMNS                             *         
*                                                                     *         
* NTRY - PARAM 1 BYTE 0 LENGTH OF LIST TO BE ADDED                    *         
*        PARAM 1 BYTES 1-3 A(COLUMN LIST TO BE ADDED)                 *         
* EXIT - CC=EQUAL IF OK, NOT EQUAL ON ERROR                           *         
***********************************************************************         
*                                                                               
ADDCOL   NTR1                                                                   
         XR    R2,R2                                                            
         IC    R2,0(,R1)           R2=L'(COL LIST TO BE ADDED)                  
         L     R3,0(,R1)           R3=A(COL LIST TO BE ADDED)                   
ADDCOL01 CLI   0(R3),0             IGNORE NULL COLUMNS                          
         BE    ADDCOL07                                                         
         CLI   0(R3),COLKEYQ       KEY SEPARATOR?                               
         BNE   ADDCOL1F                                                         
         CLI   BLOKEYN,0           KEY SEPARATOR ALREADY FOUND?                 
         BNE   ADDCOL07                                                         
         LA    R0,L'BLODIS                                                      
         LA    R1,WORK+1                                                        
ADDCOL1B CLI   0(R1),0             TEST THIS IS A NEW COLUMN                    
         BE    ADDCOL1C                                                         
         LA    R1,L'DISCOL(R1)                                                  
         BCT   R0,ADDCOL1B                                                      
         B     ADDCOLN                                                          
ADDCOL1C LA    R0,WORK+1                                                        
         SR    R1,R0                                                            
         LA    R1,1(R1)            INCREASE INCASE OF OVBERRIDE OF ZERO         
         STC   R1,BLOKEYN          NUMBER OF COLUMNS IN KEY + 1                 
         B     ADDCOL07                                                         
ADDCOL1F L     RF,ADISENT                                                       
         USING DISTABD,RF          RF=A(DISPLAY COLUMN TABLE)                   
ADDCOL02 CLI   DISTABD,EOT         TEST EOT                                     
         BE    ADDCOLN                                                          
         CLC   DISCHR,0(R3)        MATCH CHARACTER TO TABLE                     
         BNE   ADDCOL03                                                         
         TM    DISSTAT,DISDDSQ     COLUMN DDS ONLY?                             
         BNO   ADDCOL3A                                                         
         TM    PCDRIVEN,PCGRIDQ    RUNNING UNDER GRIDS?                         
         BO    ADDCOL3A            YES, ADD THE COLUMN THEN                     
         CLI   TWAOFFC,C'*'        IS THE TERMINAL DDS ?                        
         BE    ADDCOL3A                                                         
ADDCOL03 LA    RF,DISTABL(RF)                                                   
         B     ADDCOL02                                                         
*                                                                               
ADDCOL3A LA    R1,WORK+1                                                        
         LA    RE,BLOCHR                                                        
         LA    R0,L'BLODIS                                                      
ADDCOL04 CLI   0(R1),0             TEST THIS IS A NEW COLUMN                    
         BE    ADDCOL06                                                         
         CLC   DISCOL,0(R1)        IGNORE DUPLICATE COLUMNS                     
         BE    ADDCOL07                                                         
         LA    R1,L'DISCOL(R1)                                                  
         LA    RE,L'DISCHR(RE)                                                  
         BCT   R0,ADDCOL04                                                      
         B     ADDCOLN                                                          
ADDCOL06 MVC   0(L'DISCOL,R1),DISCOL  SET INTERNAL VALUE                        
         MVC   0(L'DISCHR,RE),DISCHR  SET COLUMN CHARACTER                      
*                                                                               
ADDCOL07 LA    R3,1(R3)                                                         
         BCT   R2,ADDCOL01                                                      
*                                                                               
ADDCOLY  CR    RF,RF                                                            
         B     ADDCOLX                                                          
ADDCOLN  MVC   DMCB(1),0(R3)                                                    
         CLI   *,0                                                              
*                                                                               
ADDCOLX  J     ROUTX1                                                           
         DROP  RF                                                               
         EJECT ,                                                                
***********************************************************************         
*        SET FOREIGN CURRENCY DETAILS IN UNSCAN BLOCK                 *         
*        USED   TO DISPLAY EXTRA DETAIL LINES                         *         
*        ON ENTRY UNSCANBLOCK CONTAINS XDETAIL INFO                   *         
*                 R2=A(ACOUNT FOREIGN CURRENCY ELEMENT)               *         
*                 R3=A(NEXT AVAILABLE UNSCAN POSITION)                *         
*        ON EXIT  R3=A(UPDATED WITH NEXT AVAILABLE UNSCAN POSITION)   *         
***********************************************************************         
*                                                                               
         USING AFCELD,R2                                                        
         USING UNSCAND,R3                                                       
*                                                                               
XDFCURR  CLI   AFCEL,AFCELQ        ACOUNT FOREIGN CURRENCY ELEMENT?             
         JNE   *+2                                                              
         CLI   AFCCURR+0,C'A'      BAD POSTING FROM MEDIA SYSTEM?               
         BL    XDFCX                                                            
         CLI   AFCCURR+1,C'A'                                                   
         BL    XDFCX                                                            
         MVC   UNSCNLHS(L'LC@EXCHR),LC@EXCHR XRATE, EXCHANGE RATE               
         ZAP   DUB,=P'0'                                                        
         MVO   DUB,AFCXRATE                                                     
         CURED (P8,DUB),(L'UNSCNRHS,UNSCNRHS),5,ALIGN=LEFT                      
         LA    R1,UNSCNRHS+L'UNSCNRHS-1                                         
XDFC10   CLI   0(R1),C','                                                       
         BE    *+8                                                              
         CLI   0(R1),C'.'                                                       
         BNE   *+12                                                             
         MVI   1(R1),C'0'                                                       
         B     XDFC20                                                           
         CLI   0(R1),C'0'                                                       
         BH    XDFC20                                                           
         MVI   0(R1),C' '                                                       
         BCT   R1,XDFC10                                                        
XDFC20   LA    R3,UNSCNLNQ(R3)                                                  
         MVC   UNSCNLHS(L'LC@AMT),LC@AMT AMOUNT                                 
         GOTO1 AGETCURR,DMCB,AFCCURR GET CURRENCY CODE ENTRY                    
         ICM   R4,15,0(R1)                                                      
         JZ    *+2                                                              
*                                                                               
XDFC50   CURED (P6,AFCAMNT),(L'UNSCNRHS,UNSCNRHS),(R4),MINUS=YES,      X        
               ALIGN=LEFT,CURSYMB=YES                                           
         LA    R3,UNSCNLNQ(R3)                                                  
*                                                                               
         TM    AFCXSTAT,AFCXSMEM MEMO FOREIGN CURRENCY?                         
         BNO   XDFCX                                                            
         MVI   UNSCNRHS,C'('                                                    
         MVC   UNSCNRHS+1(L'LC@MEMO),LC@MEMO                                    
         LA    RF,UNSCNRHS+1+L'LC@MEMO-1                                        
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         MVI   0(RF),C')'                                                       
         LA    R3,UNSCNLNQ(R3)                                                  
*                                                                               
XDFCX    XIT1  REGS=(R3)                                                        
         DROP  R2,R3                                                            
         EJECT                                                                  
*                                                                               
***********************************************************************         
*        READ FIRST/NEXT JOB RECORD AND GET COMPOSITE OFFICE          *         
*        ON ENTRY PARAM 1 IS CURRENCY CODE                            *         
*        ON EXIT  PARAM 1 CONTAINS A(CURRENCY ENTRY) OR ZEROS         *         
***********************************************************************         
GETCURR  LR    R3,R1                                                            
         L     R2,0(R3)                                                         
         CLC   0(L'COMPCURR,R2),SPACES IF NOTHING SET                           
         BNE   *+10                                                             
         MVC   0(L'COMPCURR,R2),COMPCURR  GET AGENCY CURRENCY                   
*                                                                               
         USING CURTABD,R4                                                       
         L     R4,ACURTAB                                                       
*                                                                               
GETC10   CLI   CURTCUR,EOT         END OF TABELE?                               
         BE    GETC20                                                           
         CLC   CURTCUR,0(R2)       MATCH ON CURRENCY CODE?                      
         BE    GETCX                                                            
         LA    R4,CURTABL(R4)      ASSUME BASIC CURRENCY TABLE LENGTH           
         B     GETC10                                                           
*                                                                               
GETC20   GOTO1 VBLDCUR,DMCB,(R2),(0,(R4)),ACOMFACS                              
         CLI   0(R1),0                                                          
         BNE   GETCERRX                                                         
*                                                                               
         GOTO1 AIO,IOREAD+IOACCDIR+IO1                                          
         BE    GETCX                                                            
         CLI   IOERR,IOMAX                                                      
         BNE   GETCERRX                                                         
         OI    DISPFLAG,DISIOMAX   MAX IO'S                                     
GETCX    ST    R4,0(R3)                                                         
         B     *+10                                                             
GETCERRX XC    0(4,R3),0(R3)                                                    
         B     ROUTX1                                                           
         DROP  R4                                                               
         EJECT                                                                  
*                                                                               
***********************************************************************         
* ROUTINE TO READ 2 CHAR OFFICE FILE FOR CONTRA/OFFICE ORDER READ     *         
* ON ENTRY IOKEY ASSUMED TO HOLD ACCOUNT RECORD KEY                   *         
***********************************************************************         
READUP   TM    CORDFLAG,CORDMODQ          CONTRA ORDERED MODE?                  
         BZ    READUX                     NO, EXIT                              
         TM    IOMAXSW,IOMRRDUP+IOMRRD25  RESTART READUP OR READU25 ?           
         BZ    READU05                    NO, SKIP                              
         LA    R3,IOKEY                                                         
         MVC   IOKEY,KEYSAVE              RESET I/O KEY                         
         MVC   WORK(L'CHDKCULC),KEYSAVE+(CHDKCULC-CHDRECD)                      
         NI    IOMAXSW,TURNOFF-IOMRRDUP   TURN OFF RESTART READUP               
*                                                                               
READU05  MVC   ACNTKEY,IOKEY              SAVE THE INPUT KEY                    
         TM    IOMAXSW,IOMRRD25           RESTART READU25                       
         BO    READU25                    YES, THEN RESTART READU25             
*                                                                               
         USING CHDRECD,R3                                                       
READU10  LA    R3,IOKEY                                                         
         MVI   CHDKSPCS,X'FF'                                                   
         GOTO1 AIO,IOHIGH+IOACCDIR+IO1    GET CONTRA HEADER                     
         BNE   READCIO1                                                         
*                                                                               
READU12  CLC   IOKEY(L'CHDKCULA),ACNTKEY  TEST SAME ACCOUNT                     
         BNE   READUERX                                                         
         CLC   CHDKOFF,SPACES             END OF CONTRA HEADERS                 
         BH    READUERX                                                         
         CLC   CHDKSPCS,SPACES            IS IT A CONTRA ACCOUNT                
         BH    READU40                    NO, TRY LAST CONTRA                   
         MVC   TWAOFWK#,=H'1'             POINTER TO OFFICE CODE                
         MVC   WORK(L'CHDKCULC),CHDKCULC  SAVE CONTRA                           
*                                                                               
         CLI   CONTLEN,0                  ANY CONTRA FILTER?                    
         BE    READU24                    NO, SKIP CONTRA FILTER                
*                                                                               
         LA    RF,L'CHDKULC               VALIDATE THE CONTRA READ              
         LA    R1,CHDKULC                                                       
*                                                                               
READU15  CLI   0(R1),C' '                 SKIP PASSED POSSIBLE SPACES           
         BH    READU16                                                          
         LA    R1,1(,R1)                                                        
         BCT   RF,READU15                                                       
         B     READUERX                                                         
*                                                                               
READU16  SR    RF,RF                                                            
         IC    RF,CONTLEN                                                       
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         CLC   0(0,R1),CONTRA             MATCHES CONTRA?                       
         BNE   READU20                                                          
*                                                                               
         CLI   NEGCONT,NEGFILTR           YES, NEGATIVE FILTER?                 
         BE    READU40                    YES, NEXT CONTRA                      
         B     READU24                    NO, CONTINUE W/ THIS REC              
*                                                                               
READU20  CLI   NEGCONT,NEGFILTR           NEGATIVE FILTER?                      
         BE    READU24                    YES, CONTINUE W/ THIS REC             
         B     READU40                                                          
*                                                                               
READU24  TM    NXTRMODE,NXTRCACQ          CONTRA RECS ONLYS?                    
         BO    READUX                                                           
*                                                                               
         USING OFFALD,RF                                                        
READU25  NI    IOMAXSW,TURNOFF-IOMRRD25   TURN OFF RESTART READU25              
*----------------------------------                                             
* DECIDE WHICH OFFICE LIST WE NEED                                              
*----------------------------------                                             
         USING OPTVALSD,R1                                                      
         L     R1,AOPTVALS                                                      
         OC    OOFFICVL,OOFFICVL       OFFICE LIST OVERRIDE?                    
         BZ    *+12                    . NO                                     
         LA    RF,OOFFICLS             . YES, USE WANTED OFFICES                
         B     READU30                                                          
         DROP  R1                                                               
         L     RF,AOFFBLK              LIMITTED ACCESS                          
         CLI   LDGTOFFP,LDGOTRAN       SECURITY OFFICE IN TRANSACTIONS?         
         BE    *+8                     . YES                                    
         L     RF,AOFFBLK2             . NO, USE ALL OFFICES                    
         LA    RF,OFFAWORK-OFFALD(,RF)                                          
*----------------                                                               
* GET THE RECORD                                                                
*----------------                                                               
READU30  CLC   TWAOFWK#,0(RF)             END OF OFFICE LIST?                   
         BH    READU40                    YES, NEXT CONTRA                      
         LH    R1,TWAOFWK#                OFFICE LIST COUNT                     
         SLL   R1,1                       SHIFT NO OF OFFICES FOR INDEX         
         LA    RF,0(R1,RF)                                                      
         SRL   R1,1                                                             
         LA    R1,1(,R1)                                                        
         STH   R1,TWAOFWK#                BUMP TO NEXT                          
         CLC   0(L'CHDKOFF,RF),SPACES     SPACES MEANS FILLER OFFICE            
         BE    READU25                                                          
         MVC   CHDKCULA,ACNTKEY           SET ACCOUNT CODE                      
         MVC   CHDKOFF,0(RF)              SET OFFICE  CODE                      
         MVC   CHDKCULC,WORK              RESTORE LAST CONTRA                   
         XC    CHDKSPCS(L'CHDKSPCS+L'CHDKBTYP+L'CHDKNULL),CHDKSPCS              
         DROP  RF                                                               
*                                                                               
         GOTO1 AIO,IOHIGH+IOACCDIR+IO1    READ OFFICE REC                       
         BNE   READCIO2                                                         
         CLC   IOKEY(L'CHDKCULA),ACNTKEY  TEST SAME ACCOUNT                     
         BNE   READU40                    GET NEXT CONTRA                       
         LA    RE,IOKEY+CHDKOFF-CHDRECD   COMPARE OFFICE AND CONTRA             
         LA    RF,IOKEYSAV+CHDKOFF-CHDRECD                                      
         CLC   0(L'CHDKOFF+L'CHDKCULC,RE),0(RF)                                 
         BNE   READU25                    NOT EQUAL, THEN TRY AGAIN             
         B     READUX                     RETURN WITH CONTRA/OFFICE REC         
*----------------------------                                                   
* SET UP TO READ NEXT CONTRA                                                    
*----------------------------                                                   
READU40  MVC   IOKEY,SPACES                                                     
         MVC   CHDKCULA,ACNTKEY                                                 
         MVC   CHDKCULC,WORK              READ LAST CONTRA                      
         XC    CHDKSPCS(L'CHDKSPCS+L'CHDKBTYP+L'CHDKNULL),CHDKSPCS              
         B     READU10                                                          
*                                                                               
READUERX TM    CORDFLAG,CORDFSTQ          FIRST RECORD ?                        
         BO    READUER5                                                         
         MVC   IOKEY,SPACES               SET NO MORE RECORDS                   
         B     READUX                                                           
*                                                                               
READUER5 NI    CORDFLAG,TURNOFF-CORDFSTQ                                        
         MVI   FVOMTYP,INFOMSG            INFORMATION MESSAGE                   
         MVC   FVMSGNO,=AL2(AI$NDFWP)     NO DATA FOUND                         
         B     ROUTH1                                                           
*                                                                               
READUX   NI    CORDFLAG,TURNOFF-CORDFSTQ                                        
         B     ROUTE1                                                           
*                                                                               
READCIO1 CLI   IOERR,IOMAX                MAX IOS REACHED?                      
         JNE   *+2                                                              
*                                                                               
         CLC   IOKEYSAV+(CHDKOFF-CHDRECD)(L'CHDKOFF),SPACES                     
         BE    READU12                                                          
         OI    IOMAXSW,IOMRRDUP           RESTART READUP                        
         B     READCIO                                                          
*                                                                               
READCIO2 CLI   IOERR,IOMAX                MAX IOS REACHED?                      
         JNE   *+2                                                              
         OI    IOMAXSW,IOMRRD25           RESTART READU25                       
*                                                                               
READCIO  XC    KEYSAVE,KEYSAVE                                                  
         MVC   KEYSAVE(CHDKSPCS-CHDRECD),IOKEYSAV                               
         MVC   KEYSAVE+(CHDKOFF-CHDRECD)(L'CHDKOFF),SPACES                      
         MVC   KEYSAVE+(CHDKSPCS-CHDRECD)(L'CHDKSPCS+L'CHDKBTYP),SPACES         
         LH    R1,TWAOFWK#                BACK UP OFFICE COUNT BY ONE           
         BCTR  R1,0                                                             
         STH   R1,TWAOFWK#                                                      
         OI    DISPFLAG,DISIOMAX                                                
         B     ROUTH1                                                           
*                                                                               
         DROP  R3                                                               
         EJECT ,                                                                
***********************************************************************         
* ROUTINE TO GET THE NEXT RECORD                                      *         
* ON ENTRY IOKEY HOLDS THE KEY OF THE CURRENT RECORD                  *         
*         PARM 1 BYTE 0 SET TO CACONLYQ IF ONLY CONTRA RECS REQUIRED  *         
***********************************************************************         
*                                                                               
NXTREC   MVC   BYTE1,0(R1)         SAVE READ MODE                               
         GOTO1 AIO,IOSEQ+IOACCDIR+IO1                                           
         BNE   NXTCIO                                                           
*                                                                               
NXTR10   CLC   IOKEY(L'TRNKCULA),IOKEYSAV   TEST SAME ACCOUNT                   
         BNE   NXTR12                                                           
         TM    CORDFLAG,CORDMODQ   CONTRA ORDERED MODE?                         
         BO    NXTR16              YES, PROCESS CONTRA ORDERED MODE             
         TM    BYTE1,NXTRCACQ      RETURN ONLY CONTRA ACCOUNT?                  
         BZ    NXTRX               NO,  EXIT, FOUND RECORD                      
*                                  YES, ONLY WANT CONTRA RECORDS                
         CLC   IOKEY+TRNKDATE-TRNRECD(L'TRNKDATE),SPACES TRAN REC?              
         BE    NXTRX               NO, EXIT, FOUND CONTRA RECORD                
         MVI   IOKEY+TRNKDATE-TRNRECD,X'FF' GET NEXT CONTRA RECORD              
         GOTO1 AIO,IOHIGH+IOACCDIR+IO1                                          
         BNE   NXTCIO                                                           
         B     NXTRX               EXIT, FOUND NEXT CONTRA RECORD               
*                                                                               
*                                  DIFFERENT ACCOUNT                            
NXTR12   TM    CORDFLAG,CORDMODQ   CONTRA ORDERED MODE?                         
         BO    NXTR18              YES, GET NEXT OFFICE/CONTRA                  
         MVC   IOKEY,SPACES                                                     
         B     NXTRX               EXIT, NO MORE RECORDS                        
*                                                                               
*                                  CONTRA ORDERED MODE                          
NXTR16   TM    BYTE1,NXTRCACQ      CONTRA RECS ONLYS?                           
         BZ    NXTR17              NO, SKIP                                     
         CLC   IOKEY+TRNKDATE-TRNRECD(L'TRNKDATE),SPACES TRAN REC?              
         BNE   NXTR18              YES, NOT RECORD, GET NEXT CONTRA REC         
*                                                                               
NXTR17   LA    RE,IOKEY+TRNKOFF-TRNKEY    -> OFFICE/CONTRA IN NEW REC           
         LA    RF,IOKEYSAV+TRNKOFF-TRNKEY -> OFFICE/CONTRA IN OLD REC           
         CLC   0(L'TRNKOFF+L'TRNKCULC,RE),0(RF)  SAME OFFICE/CONTRA ?           
         BE    NXTRX               YES, EXIT, FOUND NEXT RECORD                 
*                                                                               
NXTR18   DS    0H                  CALL READUP FOR NEXT OFFICE/CONTRA           
         LA    R3,IOKEYSAV                                                      
         USING CHDRECD,R3                                                       
         MVC   WORK(L'CHDKCULC),CHDKCULC SAVE CURRENT CONTRA                    
         LA    R3,IOKEY                                                         
*                                                                               
         TM    BYTE1,NXTRCACQ      CONTRA RECS ONLYS?                           
         BO    READU40             YES, FIND NEXT CONTRA                        
         B     READU25             NO,  FIND NEXT OFFICE                        
*                                                                               
NXTRX    B     ROUTE1                                                           
*                                                                               
NXTCIO   CLI   IOERR,IOMAX                MAX IOS REACHED?                      
         JNE   *+2                                                              
*                                                                               
         OI    DISPFLAG,DISIOMAX                                                
         MVC   KEYSAVE,IOKEYSAV                                                 
         B     ROUTH1                                                           
         DROP  R3                                                               
*                                                                               
         EJECT ,                                                                
***********************************************************************         
* ROUTINE TO SET ELEMENT ADDRESSES                                    *         
* ON NTRY R1=A(FIRST ELEMENT ON ACCMAST/TSAR RECORD)                  *         
***********************************************************************         
*                                                                               
SETELE   LR    R3,R1               R3=A(FIRST TRANSACTION)                      
         XC    ELEADDS(ELEADLN),ELEADDS CLEAR ELEMENT ADDRESSES                 
*                                                                               
         USING ELETABD,R2                                                       
SETEL10  L     R2,AELETAB          R2=A(ELEMENT TABLE)                          
         CLI   0(R3),EOR           END OF RECORD?                               
         BE    SETELX                                                           
*                                                                               
SETEL20  CLI   ELETYPE1,EOT        END OF TABLE                                 
         BE    SETEL30                                                          
         CLC   ELETYPE1,0(R3)      MATCH ON ELEMENT TYPE?                       
         BNE   SETEL25                                                          
         CLI   ELETYPE2,0          ACCMAST OR TSAR RECORD?                      
         BE    SETEL27                                                          
         CLC   ELETYPE2,2(R3)      CHECK TSAR ELEMENT TYPE                      
         BE    SETEL27                                                          
SETEL25  LA    R2,ELETABL(R2)      BUMP TO NEXT ENTRY                           
         B     SETEL20                                                          
*                                                                               
SETEL27  SR    RF,RF                                                            
         ICM   RF,3,ELEADDR        RF=(DISPLACEMENT TO ELEMENT ADDR)            
         LA    RF,WORKD(RF)                                                     
         OC    0(L'ELEADDS,RF),0(RF) ALREADY GOT AN ADDRESS?                    
         BNZ   SETEL30                                                          
         ST    R3,0(RF)                                                         
*                                                                               
SETEL30  SR    RF,RF                                                            
         IC    RF,1(R3)                                                         
         AR    R3,RF                                                            
         B     SETEL10                                                          
*                                                                               
SETELX   B     ROUTX1                                                           
         EJECT ,                                                                
***********************************************************************         
* ROUTINE TO GET LOW LEVEL ACCOUNT RECORD                             *         
* ON NTRY R1=A(UNIT/LEDGER CODE OR BINARY ZEROES IF PART OF SCREEN    *         
*         KEY)                                                        *         
***********************************************************************         
*                                                                               
GETACC   MVC   HALF,SPACES         R2=A(KEY FIELD)                              
         LTR   R1,R1               LEDGER IN KEY FIELD?                         
         BZ    *+10                                                             
         MVC   HALF,0(R1)                                                       
*                                                                               
         USING FLDHDRD,R2                                                       
         LA    R2,BASKEYH          R2=A(KEY FIELD)                              
         ST    R2,FVADDR                                                        
*                                                                               
         MVC   FVMSGNO,=AL2(EGIFMISS) MISSING INPUT                             
         XR    R4,R4                                                            
         ICM   R4,1,FLDILEN        R4=L'(KEY FIELD INPUT)                       
         BZ    GETAERRX                                                         
         MVC   FVMSGNO,=AL2(EGIFLONG) INPUT TOO LONG                            
         LA    RF,L'ACTKACT                                                     
         CLC   HALF,SPACES                                                      
         BNE   *+8                                                              
         LA    RF,L'ACTKULA                                                     
         SR    RE,RE                                                            
         IC    RE,FLDILEN                                                       
         CR    RE,RF                                                            
         BH    GETAERRX                                                         
*                                                                               
         MVC   FVMSGNO,=AL2(EAWRNGLV) WRONG LEVEL ACCOUNT                       
         LA    RF,LEDGTLVA         RF=A(HIERARCHY LEVELS)                       
         LR    RE,RF               RE=RF                                        
         XR    R1,R1               R1=MINIMUM LENGTH OF ACCOUNT                 
         CLI   0(RF),X'0C'         FULL HIERARCHY?                              
         BE    *+12                                                             
         LA    RF,1(RF)            NO BUMP RF                                   
         B     *-12                                                             
         CR    RF,RE               ONE LEVEL LEDGER?                            
         BE    GETA12                                                           
         BCTR  RF,0                RF=A(MINIMUM LENGTH)                         
         IC    R1,0(RF)                                                         
         LR    RE,R4               RE=L'(INPUT)                                 
         CLC   HALF,SPACES                                                      
         BNE   *+8                                                              
         SHI   RE,L'ACTKUNT+L'ACTKLDG     SUBTRACT UNIT/LEDGER LENGTH           
         CR    RE,R1               IS INPUT LONG ENOUGH?                        
         BNH   GETAERRX                                                         
*                                                                               
GETA12   LA    R3,IOKEY            R3=A(KEY FOR LOW LEVEL ACCOUNT)              
         USING ACTRECD,R3                                                       
         MVC   ACTKEY,SPACES                                                    
         MVC   ACTKCPY,MYCO        COMPANY                                      
         BCTR  R4,0                                                             
         LA    RF,ACTKULA                                                       
         CLC   HALF,SPACES                                                      
         BE    GETA13                                                           
         MVC   ACTKUNT(L'ACTKUNT+L'ACTKLDG),HALF                                
         LA    RF,ACTKACT                                                       
GETA13   EX    R4,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RF),FLDDATA  ACCOUNT CODE                                    
         MVC   FVMSGNO,=AL2(EAIFNTFN) ACCOUNT NOT FOUND                         
*                                                                               
GETA15   GOTO1 AIO,IOREAD+IOACCMST+IO1                                          
         BE    GETA20                                                           
         TM    IOERR,IOERNF                                                     
         BO    GETAERRX            LOW LEVEL ACCOUNT NOT FOUND                  
         DC    H'0'                                                             
*                                                                               
GETA20   MVC   FVMSGNO,=AL2(EASECLOC) SECURITY LOCKOUT                          
         GOTO1 AOFFACC             TEST OFFICE SECURITY                         
         CLI   OFFLFLAG,OFFLSEC    SECURITY LOCKOUT?                            
         BE    GETAERRX                                                         
*                                                                               
         L     R3,AIO1             R3=A(ACCOUNT RECORD)                         
         MVI   SECFFLAG,0          INIT SECURITY FIELD FLAG                     
         OC    TWALEN,TWALEN       NEW SECURITY?                                
         BZ    GETA40                                                           
         CLC   ONEP,ACTKUNT                                                     
         BE    GETA30                                                           
         CLC   ONER,ACTKUNT                                                     
         BE    GETA30                                                           
         CLC   ONEJ,ACTKUNT                                                     
         BNE   GETA40                                                           
GETA30   L     RF,ASECBLK         SEE IF NOT ALLOWED TO SEE RATE AMT            
         USING SECD,RF                                                          
         GOTO1 VSECRET,DMCB,('SECPFLDP',SECD),=AL1(1)                           
         BNL   GETA40                                                           
         OI    SECFFLAG,SECFRATE   SET RATE CANNOT BE SHOWN                     
*                                                                               
GETA40   MVC   SAVEACC,ACTKEY      ACCOUNT KEY FOR ENQUIRY                      
*                                                                               
GETAX    B     ROUTE1                                                           
*                                                                               
GETAERRX B     ROUTH1                                                           
         DROP  R2,R3                                                            
         EJECT ,                                                                
***********************************************************************         
* ROUTINE TO DISPLAY ACCOUNT/CONTRA NAMES                             *         
* ON NTRY AIO1 CONTAINS ACCOUNT RECORD SVCACN CONTAINS CONTRA NAME    *         
***********************************************************************         
         USING FLDHDRD,R2                                                       
         USING ACTRECD,R3                                                       
*                                                                               
DISACC   L     R3,AIO1                                                          
         OI    FLDOIND,FOUTTRN                                                  
         GOTO1 ASETELE,ACTRFST                                                  
         TM    PCDRIVEN,PCGRIDQ                                                 
         BZ    *+8                                                              
         LA    R2,GRDDAT1H                                                      
*                                                                               
         MVC   FLDDATA(L'ENQDAT1),SPACES                                        
         LA    R1,FLDDATA                                                       
*        MVC   FLDDATA(L'LC@ACC),LC@ACC ACCOUNT                                 
*        LA    R1,FLDDATA+L'LC@ACC-1                                            
*        CLI   0(R1),C' '                                                       
*        BH    *+8                                                              
*        BCT   R1,*-8                                                           
*        MVI   1(R1),C'='                                                       
*        LA    R1,2(R1)                                                         
*                                                                               
DISA05   ICM   RF,15,ANAMELD       RF=A(NAME ELEMENT)                           
         BNZ   DISA08              NO NAME FOUND                                
         MVC   0(L'UP@LISTL,R1),UP@LISTL                                        
         OI    FLDOIND,FOUTTRN                                                  
         B     DISAX                                                            
*                                                                               
         USING NAMELD,RF                                                        
DISA08   SR    RE,RE               GET ACCOUNT NAME                             
         IC    RE,NAMLN                                                         
         SHI   RE,NAMLN1Q+1                                                     
         BNP   DISA10                                                           
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),NAMEREC                                                  
         LA    R1,4(RE,R1)                                                      
DISA10   OI    FLDOIND,FOUTTRN                                                  
*                                                                               
         ICM   RF,15,AJOBELD       RF=A(PRODUCTION JOB ELEMENT)                 
         BZ    DISA20                                                           
         TM    JOBSTA1-JOBELD(RF),JOBSXJOB                                      
         BNO   DISA20                                                           
         MVI   0(R1),C'/'                                                       
         MVC   2(L'LC@XJOB,R1),LC@XJOB EXPENSE JOB                              
         LA    R1,L'LC@XJOB+1(R1)                                               
         CLI   0(R1),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         LA    R1,2(R1)                                                         
*                                                                               
DISA20   CLC   SVCACN,SPACES       HAVE WE SPECIFIED FILTER CONTRA?             
         BNH   DISAGR                                                           
         MVI   0(R1),C'/'                                                       
         MVC   2(L'LC@CTR,R1),LC@CTR CONTRA                                     
         LA    R1,L'LC@CTR+1(R1)                                                
         CLI   0(R1),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         MVI   1(R1),C'='                                                       
         LA    R1,2(R1)                                                         
         LA    RE,FLDDATA+L'ENQDAT1-1                                           
         SR    RE,R1                                                            
         CHI   RE,L'SVCACN-1                                                    
         BNH   *+8                                                              
         LA    RE,L'SVCACN-1                                                    
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),SVCACN  DISPLAY AS MUCH OF CONTRA NAME AS POSS           
         B     DISAGR                                                           
         DROP  RF                                                               
*----------------------------------------------------------------------         
* FOR GRIDS                                                                     
*----------------------------------------------------------------------         
DISAGR   TM    PCDRIVEN,PCGRIDQ                                                 
         BZ    DISAX                                                            
         MVC   GRDDAT2,SPACES                                                   
         MVC   GRDDAT3,SPACES                                                   
         OI    GRDDAT2H+5,FOUTTRN                                               
         OI    GRDDAT3H+5,FOUTTRN                                               
*                                                                               
         ICM   RF,15,AADRELD                                                    
         BZ    DISAG30                                                          
         USING ADRELD,RF                                                        
         SR    R1,R1                                                            
         ICM   R1,1,ADRNUM            AT LEAST ONE ADDRESS LINE?                
         BZ    DISAG30                . NO                                      
         LA    RE,ADRADD1                                                       
         ST    RE,FULL                + FULL=A(ADDRESS LINE)                    
         LA    R2,GRDDAT2                                                       
         ST    R2,DUB                 + DUB=A(OUTPUT DISPLAY LINE)              
         LA    RF,ADRADD1                                                       
         DROP  RF                                                               
*                                                                               
DISAG10  LHI   RE,L'ADRADD1           + RE=LENGTH OF ADDRESS LINE               
         LA    RF,L'ADRADD1-1(RF)     + RF=A(LAST BYTE IN ADDRESS LINE)         
         CLI   0(RF),C' '                                                       
         BH    DISAG15                                                          
         AHI   RF,-1                  BACK UP PAST SPACES                       
         BCT   RE,*-12                                                          
         B     DISAG20                ALL SPACES                                
*                                                                               
DISAG15  L     R0,DUB                                                           
         AHI   R0,L'GRDDAT2-1                                                   
         LR    R4,R2                                                            
         AR    R4,RE                                                            
         CR    R4,R0                                                            
         BNL   DISAG25                                                          
         SHI   RE,1                                                             
         L     RF,FULL                                                          
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R2),0(RF)                                                    
         CLI   GRXTLNS,0               ANY EXTRAS YET?                          
         BNE   *+8                                                              
         MVI   GRXTLNS,1                                                        
         AR    R2,RE                                                            
         LA    R2,2(R2)                                                         
DISAG20  L     RF,FULL                 ADDRESS LINE                             
         LA    RF,L'ADRADD1(RF)        NEXT ADDRESS LINE                        
         ST    RF,FULL                                                          
         BCT   R1,DISAG10                                                       
         B     DISAG30                 NO MORE ADDRESS LINES                    
*                                                                               
DISAG25  L     R2,DUB                                                           
         LA    R2,GRDDAT3-GRDDAT2(R2)  NEXT OUTPUT DISPLAY LINE                 
         ST    R2,DUB                                                           
         SR    R0,R0                                                            
         IC    R0,GRXTLNS              # OF EXTRA TITLE LINES NEEDED            
         AHI   R0,1                                                             
         STC   R0,GRXTLNS                                                       
         B     DISAG15                                                          
*                                                                               
DISAG30  LA    R1,SAVEACCN                                                      
         MVC   SAVEACCN,SPACES                                                  
*                                                                               
         ICM   RF,15,ANAMELD       RF=A(NAME ELEMENT)                           
         BZ    DISAX               NO NAME FOUND                                
*                                                                               
         USING NAMELD,RF                                                        
         SR    RE,RE               GET ACCOUNT NAME                             
         IC    RE,NAMLN                                                         
         SHI   RE,NAMLN1Q+1                                                     
         BNP   DISAG40                                                          
         CHI   RE,L'SAVEACCN-1                                                  
         BNH   *+8                                                              
         LHI   RE,L'SAVEACCN-1                                                  
*                                                                               
*        BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),NAMEREC                                                  
         LA    R1,1(RE,R1)                                                      
*                                                                               
         LA    RF,SAVEACCN+L'SAVEACCN-1                                         
         CR    RF,R1                                                            
         BNH   DISAX                                                            
*                                                                               
DISAG40  ICM   RF,15,AJOBELD       RF=A(PRODUCTION JOB ELEMENT)                 
         BZ    DISAG50                                                          
         TM    JOBSTA1-JOBELD(RF),JOBSXJOB                                      
         BZ    DISAG50                                                          
*                                                                               
         LA    R6,SAVEACCN+L'SAVEACCN-1                                         
         LR    R5,R1                                                            
         AHI   R5,L'LC@XJOB+5                                                   
         CR    R5,R6                                                            
         BNL   DISAX                                                            
*                                                                               
         MVI   0(R1),C'/'                                                       
         MVC   2(L'LC@XJOB,R1),LC@XJOB EXPENSE JOB                              
         LA    R1,L'LC@XJOB+1(R1)                                               
         CLI   0(R1),C' '                                                       
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         LA    R1,2(R1)                                                         
*                                                                               
DISAG50  CLC   SVCACN,SPACES       HAVE WE SPECIFIED FILTER CONTRA?             
         BNH   DISAX                                                            
         MVI   0(R1),C'/'                                                       
         LA    R1,1(R1)                                                         
         LA    RE,SAVEACCN+L'SAVEACCN-1                                         
         SR    RE,R1                                                            
         BNP   DISAX                                                            
         CHI   RE,L'SVCACN-1                                                    
         BNH   *+8                                                              
         LA    RE,L'SVCACN-1                                                    
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R1),SVCACN  DISPLAY AS MUCH OF CONTRA NAME AS POSS           
         DROP  RF                                                               
*                                                                               
DISAX    B     ROUTX1                                                           
         DROP  R2,R3                                                            
         EJECT ,                                                                
***********************************************************************         
* ROUTINE TO GET SCREEN DIMENSIONS                                    *         
* ON NTRY PARAM 1 BYTE 0 NUMBER OF PERMANENT TOTAL LINES              *         
*         PARAM 1 BYTES 1-3 A(FIRST AVAILABLE LINE)                   *         
***********************************************************************         
*                                                                               
SCRNDIM  MVC   BYTE1,0(R1)         NUMBER OF TOTAL LINES                        
         XR    RF,RF                                                            
         ICM   RF,7,1(R1)          RF=A(NEXT AVAILABLE SCREEN LINE)             
         LA    RE,ENQDAT1H         RE=A(FIRST DISPLAY FIELD HEADER)             
*                                                                               
         TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BZ    SCRN10                                                           
         LA    RE,GRDDAT2H         GRID SCREEN LINE                             
         XR    RF,RF                                                            
         IC    RF,GRXTLNS                                                       
         MHI   RF,GRDDAT2H-GRDDAT1H                                             
         LA    RE,GRDDAT2H         GRID SCREEN LINE                             
         AR    RF,RE                                                            
         LA    RE,GRDDAT1H         RE=A(FIRST DISPLAY FIELD HEADER)             
*                                                                               
SCRN10   SR    RF,RE                                                            
         XR    R1,R1                                                            
         IC    R1,FLDLEN-FLDHDRD(RE) R1=TOTAL SCREEN FIELD LENGTH               
         XR    RE,RE                                                            
         DR    RE,R1                                                            
         STC   RF,DISSTART         START POSITION FOR DATA DISPLAY              
         STC   RF,DISLINE          LAST LINE USED                               
         LA    RF,ENQDATLH                                                      
         LA    RE,ENQDAT1H                                                      
         TM    PCDRIVEN,PCGRIDQ    TEST RUNNING UNDER GRID?                     
         BNO   *+12                                                             
         LA    RF,GRDDATLH         GRID DATA LINES                              
         LA    RE,GRDDAT1H                                                      
         SR    RF,RE                                                            
         XR    RE,RE                                                            
         DR    RE,R1                                                            
         XR    R2,R2                                                            
         IC    R2,BYTE1                                                         
         SR    RF,R2               REDUCE BY NUMBER OF TOTAL LINES              
         STC   RF,DISEND           MAXIMUM LINES FOR DATA DISPLAY               
*                                                                               
         XR    RF,RF                                                            
         IC    RF,DISEND                                                        
         XR    RE,RE                                                            
         IC    RE,DISSTART                                                      
         SR    RF,RE                                                            
         LA    RF,1(RF)                                                         
         STC   RF,MAXLINES         MAX LINES ON SCREEN                          
*                                                                               
         B     ROUTX1                                                           
***********************************************************************         
* ROUTINE TO GET DEFAULT MONTH RANGE AND DISPLAY IT ON SCREEN         *         
* ON NTRY R2=A(SCREEN LINE FOR DISPLAY)                                         
***********************************************************************         
*                                                                               
DEFMTH   L     R3,AOPTVALS                                                      
         USING OPTVALSD,R3                                                      
         OC    OMOS,OMOS                                                        
         BNZ   DEFM10                                                           
         GOTO1 VDATCON,DMCB,(5,0),(1,WORK) TODAYS DATE YYMMDD                   
         LHI   R1,1                SET DEFAULT TO JANUARY                       
         CLI   COMPSFST,0          ANY START MONTH SET?                         
         BE    DEFM01                                                           
         IC    R1,COMPSFST                                                      
         N     R1,=X'0000000F'                                                  
         CLI   COMPSFST,C'0'       MONTH A NUMBER OR ALPHA?                     
         BH    *+8                                                              
         LA    R1,15(R1)           CONVERT C'A' --> X'10'                       
DEFM01   STC   R1,COMPFINM         SET FISCAL YEAR START MONTH                  
         SR    RF,RF                                                            
         IC    RF,WORK             GET CURRENT YEAR                             
         CLM   R1,1,WORK+1         FISCAL START MONTH TO CURRENT MONTH          
         BNH   DEFM02                                                           
         GOTO1 VDATCON,DMCB,(1,WORK),(0,WORK+6)                                 
         GOTO1 VADDAY,DMCB,(C'Y',WORK+6),WORK+12,-1                             
         GOTO1 VDATCON,DMCB,(0,WORK+12),(1,WORK)                                
*                                                                               
DEFM02   MVC   COMPFINY,WORK                                                    
         MVC   OMOSST(L'COMPFIN),COMPFIN                                        
         MVC   OMOSEN(L'OMOSEN-1),WORK                                          
*                                                                               
DEFM10   OC    OPMOS,OPMOS                                                      
         BNZ   DEFM20                                                           
         MVC   WORK(L'OMOSST-1),OMOSST                                          
         MVI   WORK+L'OMOSST-1,X'01'                                            
         GOTO1 VDATCON,DMCB,(1,WORK),(0,WORK+L'OMOSST)                          
         LA    RF,1                                                             
         LNR   RF,RF                                                            
         GOTO1 VADDAY,DMCB,(C'Y',WORK+L'OMOSST),WORK+L'OMOSST+6,(RF)            
         GOTO1 VDATCON,DMCB,(0,WORK+L'OMOSST+6),(1,OPMOSST)                     
         MVI   OPMOSST+L'OPMOSST-1,0                                            
         MVC   WORK(L'OMOSEN-1),OMOSEN                                          
         MVI   WORK+L'OMOSEN-1,X'01'                                            
         GOTO1 VDATCON,DMCB,(1,WORK),(0,WORK+L'OMOSEN)                          
         LA    RF,1                                                             
         LNR   RF,RF                                                            
         GOTO1 VADDAY,DMCB,(C'Y',WORK+L'OMOSEN),WORK+L'OMOSEN+6,(RF)            
         GOTO1 VDATCON,DMCB,(0,WORK+L'OMOSEN+6),(1,OPMOSEN)                     
         MVI   OPMOSEN+L'OMOSEN-1,0                                             
*                                                                               
DEFM20   LA    R2,FLDDATA+L'ENQDAT1-18-FLDHDRD(R2)                              
         MVC   0(16,R2),SPACES                                                  
         MVC   1(L'UP@MOA2L,R2),UP@MOA2L MONTH OF ACTIVITY                      
         LA    R2,L'UP@MOA2L-1(R2)                                              
         CLI   0(R2),C' '                                                       
         BH    *+8                                                              
         BCT   R2,*-8                                                           
         MVI   1(R2),C'='                                                       
         CLI   OMOSFI,NEGFILTR                                                  
         BNE   *+12                                                             
         MVI   2(R2),NEGFILTR                                                   
         LA    R2,1(R2)                                                         
         GOTO1 VDATCON,DMCB,(1,OMOSST),(9,2(R2))                                
         LA    R2,7(R2)                                                         
         CLI   0(R2),C' '                                                       
         BE    *+12                                                             
         LA    R2,1(R2)                                                         
         B     *-12                                                             
         MVI   0(R2),C'-'                                                       
         GOTO1 VDATCON,DMCB,(1,OMOSEN),(9,1(R2))                                
         DROP  R3                                                               
*                                                                               
         B     ROUTX1                                                           
*                                                                               
***********************************************************************         
*        DISLAY DATE PERIOD   AAA=MMMYY-MMMYY                         *         
*                                                                               
*        ON NTRY PARM 1           = A(DISPLAY AREA)                   *         
*                PARM 2 BYTE 0    = L'(TEXT)                          *         
*                PARM 2 BYTES 1-3 = A(TEXT)                           *         
*                PARM 3 BYTE 0    = NEGATIVE DATE INDICATOR           *         
*                PARM 3 BYTES 1-3 = A(START DATE PL3 YYMMDD)          *         
*                PARM 4           = A(END DATE PL3 YYMMDD)            *         
***********************************************************************         
PERDIS   LM    R2,R5,0(R1)                                                      
         CLI   0(R4),0                                                          
         BNE   PERD05                                                           
         CLI   0(R5),0                                                          
         BNE   PERD05                                                           
         B     PERDX                                                            
PERD05   XR    RF,RF                                                            
         ICM   RF,1,4(R1)                RF=L'(TEXT)                            
         BZ    PERD08                                                           
         BCTR  RF,0                                                             
         MVC   0(DATPRLNQ,R2),SPACES     R2=A(DISPLAY AREA)                     
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   0(0,R2),0(R3)             R3=A(TEXT)                             
         LA    R2,0(RF,R2)                                                      
         CLI   0(R2),C' '                                                       
         BH    *+8                                                              
         BCT   R2,*-8                                                           
         MVI   1(R2),C'='                                                       
         LA    R2,2(R2)                                                         
PERD08   CLI   8(R1),NEGFILTR                                                   
         BNE   *+12                                                             
         MVI   0(R2),NEGFILTR                                                   
         LA    R2,1(R2)                                                         
         CLI   0(R4),0                                                          
         BE    PERD12                                                           
         GOTO1 VDATCON,DMCB,(1,(R4)),(9,0(R2)) R4=A(START DATE)                 
PERD10   LA    R2,10(R2)                                                        
         CLI   0(R2),C' '                                                       
         BNE   *+8                                                              
         BCT   R2,*-8                                                           
         LA    R2,1(,R2)                                                        
PERD12   MVI   0(R2),C'-'                                                       
         LA    R2,1(,R2)                                                        
         CLI   0(R5),0                                                          
         BE    PERDX                                                            
         GOTO1 VDATCON,DMCB,(1,(R5)),(9,0(R2)) R5=A(END DATE)                   
PERDX    B     ROUTX1                                                           
         EJECT                                                                  
***********************************************************************         
*       BUILD GRID LINES                                              *         
*                                                                     *         
*        ON ENTRY PARM 1 BYTE 0    = GRID SWITCH                      *         
*                 PARM 1 BYTES 1-3 = A(GRID COLUMN TABLE)             *         
*                 PARM 2 BYTES 1-3 = A(UNIT/LEDGER)                   *         
***********************************************************************         
         USING GCTBLD,R3                                                        
         USING DLCBD,R4                                                         
DISGRD   L     R3,0(R1)                   R3=GRID COLUMN TABLE                  
         LA    R3,0(R3)                                                         
         L     R4,ADLCB                   DOWNLOAD CONTROL BLOCK                
         MVC   SCRLFLAG,0(R1)             NO SCRLL W/GRIDS USE THIS             
*                                                                               
         GOTO1 ADWNL,DWNINIT              INITIALIZE THE DOWNLOAD               
         JNE   *+2                                                              
*                                                                               
         TM    OVRSTAT,OVRGDONE           GRIDS PROCESSING COMPLETED?           
         BO    DISG418                    . YES-THEN JUST OUTPUT EOF            
         CLI   SCRLFLAG,DWNEOR            WANT EOR?                             
         BNE   *+12                       . NO                                  
         TM    OVRSTAT,OVRGINIT           GRIDS PROCESSING INITIALIZED?         
         BZ    DISG418                    . NO-JUST OUTPUT EOF                  
*-----------------------------------------                                      
* INITIALIZE DOWNLOAD AND BUILD HEADERS                                         
*-----------------------------------------                                      
         CLI   SCRLFLAG,DWNINIT                                                 
         BNE   DISG25                                                           
         OI    OVRSTAT,OVRGINIT           GRIDS PROCESSING HAS STARTED          
*                                                                               
         XC    TEMP,TEMP                  CREATE ENQUIRY HEADERS                
         LA    RE,TEMP                                                          
         CLC   SAVEACCN,SPACES                                                  
         BH    DISG04                                                           
         MVC   SAVEACCN,SPACES                                                  
         MVC   SAVEACCN(L'UP@LISTL),UP@LISTL                                    
*                                                                               
DISG04   MVC   0(L'LC@ACC,RE),LC@ACC      ACCOUNT                               
         LA    RE,L'LC@ACC-1(RE)                                                
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         MVI   1(RE),C':'                                                       
         MVC   2(L'SAVEACCN,RE),SAVEACCN                                        
*                                                                               
         LA    RF,TEMP                    BACK UP OVER SPACES                   
         LA    RE,L'TEMP-1(RF)                                                  
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         SR    RE,RF                                                            
         LA    RE,1(RE)                                                         
*                                                                               
         MVC   DLCBFLX(L'DUMLIN1),TEMP                                          
         STC   RE,DLCBLEN                 LENGTH OF FIELD                       
         GOTO1 ADWNL,DWNTEXT                                                    
         JNE   *+2                                                              
         GOTO1 ADWNL,DWNEOL                                                     
         JNE   *+2                                                              
*        -----------------------                                                
         XC    TEMP,TEMP                  CREATE ENQUIRY HEADERS                
         LA    RE,TEMP                                                          
         LA    R1,DSUPG                                                         
         AHI   R1,UP@TYPEL-DSUPG                                                
         MVC   0(L'UP@TYPEL,RE),0(R1)     TYPE                                  
         LA    RE,L'UP@TYPEL-1(,RE)                                             
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         MVI   1(RE),C':'                                                       
         SR    R5,R5                                                            
         IC    R5,BASACTH+5                                                     
         BCTR  R5,0                                                             
         EX    R5,*+8                                                           
         B     *+10                                                             
         MVC   2(0,RE),BASACT                                                   
         LA    RE,2+1(R5,RE)                                                    
         MVI   0(RE),C','                                                       
*        -----------------------                                                
         MVC   2(L'LC@KEY,RE),LC@KEY      KEY                                   
         LA    RE,2+L'LC@KEY-1(,RE)                                             
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         MVI   1(RE),C':'                                                       
         SR    R5,R5                                                            
         ICM   R5,1,BASKEYH+5                                                   
         BNZ   DISG06                                                           
         LA    RE,2(RE)                                                         
         B     DISG08                                                           
DISG06   BCTR  R5,0                                                             
         EX    R5,*+8                                                           
         B     *+10                                                             
         MVC   2(0,RE),BASKEY                                                   
         LA    RE,2+1(R5,RE)                                                    
*        -----------------------                                                
DISG08   SR    R5,R5                                                            
         ICM   R5,1,BASCACH+5             TEST ANY CONTRA A/C?                  
         BZ    DISG09                                                           
         MVI   0(RE),C','                                                       
         MVC   2(L'LC@CTR,RE),LC@CTR                                            
         LA    RE,2+L'LC@CTR-1(,RE)                                             
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         MVI   1(RE),C':'                                                       
         BCTR  R5,0                                                             
         EX    R5,*+8                                                           
         B     *+10                                                             
         MVC   2(0,RE),BASCAC                                                   
         LA    RE,2+1(R5,RE)                                                    
*        -----------------------                                                
DISG09   SR    R5,R5                                                            
         ICM   R5,1,BASMOAH+5             TEST ANY CONTRA A/C?                  
         BNZ   DISG10                                                           
         CLC   BASMOA,SPACES                                                    
         BNH   DISG12                                                           
         LHI   R5,L'BASMOA                                                      
DISG10   MVI   0(RE),C','                                                       
         MVC   2(L'UP@MOA2L,RE),UP@MOA2L                                        
         LA    RE,2+L'UP@MOA2L-1(,RE)                                           
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         MVI   1(RE),C':'                                                       
         BCTR  R5,0                                                             
         EX    R5,*+8                                                           
         B     *+10                                                             
         MVC   2(0,RE),BASMOA                                                   
         LA    RE,2+1(R5,RE)                                                    
*        -----------------------                                                
DISG12   LA    RF,TEMP                                                          
         SR    RE,RF                      RF=LENGTH OF FIELD                    
*                                                                               
         MVC   DLCBFLX(L'DUMLIN1),TEMP                                          
         STC   RE,DLCBLEN                 LENGTH OF FIELD                       
         GOTO1 ADWNL,DWNTEXT                                                    
         JNE   *+2                                                              
         GOTO1 ADWNL,DWNEOL                                                     
         JNE   *+2                                                              
*        -----------------------                                                
         XC    TEMP,TEMP                  BUILD OPTION FIELD                    
         LA    RE,TEMP                                                          
         MVC   0(L'LC@OPTS,RE),LC@OPTS                                          
         LA    RE,L'LC@OPTS-1(,RE)                                              
         CLI   0(RE),C' '                                                       
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         MVI   1(RE),C':'                                                       
         LA    RE,2(,RE)                                                        
         LR    RF,RE                                                            
         SR    R5,R5                                                            
         ICM   R5,1,BASOPTH+5                                                   
         BNZ   DISG20                                                           
         MVC   0(L'LC@NONE,RE),LC@NONE    NO OPTIONS                            
         LA    RF,L'LC@NONE(,RE)                                                
         B     DISG22                                                           
*                                                                               
DISG20   BCTR  R5,0                                                             
         EX    R5,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),BASOPT                                                   
         LA    RF,1(R5,RE)                                                      
*                                                                               
DISG22   LA    RE,TEMP                                                          
         SR    RF,RE                      RF=LENGTH OF FIELD                    
*                                                                               
         MVC   DLCBFLX(L'DUMLIN1),TEMP                                          
         STC   RF,DLCBLEN                 LENGTH OF FIELD                       
         GOTO1 ADWNL,DWNTEXT                                                    
         JNE   *+2                                                              
         GOTO1 ADWNL,DWNEOL                                                     
         JNE   *+2                                                              
*-----------------------------------------                                      
* COPY OVER PREVIOUS SCREEN LINE                                                
*-----------------------------------------                                      
DISG25   CLI   SCRLFLAG,DWNDNB                                                  
         BE    DISG30                                                           
         CLI   SCRLFLAG,DWNINIT                                                 
         BE    DISG30                                                           
         CLI   SCRLFLAG,DWNEOR                                                  
         BNE   *+12                                                             
         TM    GCTIND1,GCTINOTO           NO TOTAL LINE, JUST EOR?              
         BO    DISG420                    . YES                                 
*                                                                               
DISG27   CLC   DISSTART,DISLINE                                                 
         BE    DISG30                                                           
         SR    RE,RE                                                            
         IC    RE,DISLINE                                                       
         SHI   RE,1                                                             
         STC   RE,DISLINE                 BACK UP LINE COUNT                    
         OI    OVRSTAT,OVRGDILC           NEED TO BACK UP A LINE                
*                                                                               
         MHI   RE,GRDDAT2H-GRDDAT1H                                             
         LA    R2,GRDDAT1                                                       
         AR    R2,RE                      GO TO LAST LINE PUT TO SCREEN         
         CLC   0(L'DUMLIN1,R2),SPACES                                           
         BE    DISG27                                                           
         L     R5,ADUMLINE                                                      
         MVC   0(L'DUMLIN1,R5),0(R2)      COPY CONTENTS OF THAT LINE            
         LHI   RE,L'GRDDAT1-1                                                   
         AR    RE,R2                                                            
         CLI   0(RE),C' '                 BACK UP PAST THE SPACES               
         BNE   *+8                                                              
         BCT   RE,*-8                                                           
         CR    RE,R2                      STARTING FROM THE BEGINNING?          
         BH    DISG28                     . NO                                  
         BL    DISG30                     BEFORE BEGINNING THEN PROBLEM         
         CLI   0(RE),X'5E'                A SEMI-COLON?                         
         BNE   DISG30                                                           
DISG28   LA    RE,2(RE)                                                         
         SR    RE,R2                                                            
         STH   RE,DLCBNUMC                CONTINUE WHERE WE LEFT OFF            
*----------------------------------------------------------------------         
* BUILD GRID COLUMN HEADLINES AND DATA LINES BASED ON GRID TABLE                
*----------------------------------------------------------------------         
DISG30   CLI   GCTLN,EOT                  CHECK END OF GRID COL TABLE           
         BE    DISG410                                                          
*-----------------------------------------                                      
* CHECK DUPLICATE COLUMN ID                                                     
*-----------------------------------------                                      
NEXTGCT  USING GCTBLD,RF                                                        
         SR    RF,RF                                                            
         IC    RF,GCTLN                                                         
         AR    RF,R3                      RF=NEXT GRID COLUMN ENTRY             
*                                                                               
         TM    OVRSTAT,OVRGNOD            PREV COLUMN THE SAME?                 
         BZ    DISG38                     . NO                                  
         CLI   NEXTGCT.GCTLN,EOT          FINAL COLUMN?                         
         BE    *+14                       . YES                                 
         CLC   NEXTGCT.GCTCOID,GCTCOID    NEXT COLUMN THE SAME?                 
         BE    DISG400                    . YES-LEAVE FLAG ON AND SKIP          
         B     DISG399                    . NO-SKIP AND SHUT OFF FLAG           
*                                                                               
DISG38   CLI   NEXTGCT.GCTLN,EOT          FINAL COLUMN?                         
         BE    DISG39                     . YES-CONTINUE                        
         CLC   NEXTGCT.GCTCOID,GCTCOID    NEXT COLUMN THE SAME?                 
         BNE   DISG39                     . NO-CONTINUE                         
         OI    OVRSTAT,OVRGNOD            . YES-FLAG ON AND CONTINUE            
         DROP  NEXTGCT                                                          
*-----------------------------------------                                      
* DDS OR CANADIAN ONLY COLUMN?                                                  
*-----------------------------------------                                      
DISG39   TM    GCTIND2,GCTIDDS            DDS ONLY COLUMN?                      
         BZ    DISG40                     . NO-CONTINUE                         
         CLI   TWAOFFC,C'*'               DDS TERMINAL?                         
         BNE   DISG399                    . NO-SKIP                             
*                                                                               
DISG40   TM    GCTIND3,GCTICAN            CANADIAN COLUMN?                      
         BZ    DISG41                     . NO - CONTINUE                       
         CLI   AGYCTRY,CTRYCAN            CANADIAN AGENCY?                      
         BNE   DISG399                    . NO - SKIP                           
*-----------------------------------------                                      
* CHECK IF SPECIAL PHASE ONLY                                                   
*-----------------------------------------                                      
DISG41   TM    GCTIND3,GCTISPC            SPECIAL USERS ONLY?                   
         BZ    DISG43                     . NO - CONTINUE                       
         CLI   SPECIAL,0                  IS THIS SEY?                          
         BE    DISG399                    . NO - SKIP                           
*-----------------------------------------                                      
* CHECK COLUMN VALID FOR THIS LEDGER                                            
*-----------------------------------------                                      
DISG43   CLI   GCTLN,GCTLN1Q              ANY LEDGER LIST?                      
         BE    DISG50                     . NO                                  
         SR    RE,RE                                                            
         IC    RE,GCTLN                   LENGTH OF GRID TABLE ENTRY            
         SHI   RE,GCTLN1Q                 LENGTH LEDGER LIST                    
         SRA   RE,1                       CUT IN HALF FOR HOW MANY U/L          
         JM    *+2                        IF MINUS, THEN TABLE IS WRONG         
         LA    R5,GCTLDG                  LEDGER LIST                           
*                                                                               
DISG44   CLC   LDGTUL,0(R5)               COLUMN FOR THIS LEDGER?               
         BE    DISG45                     . YES                                 
         LA    R5,L'GCTLDG(R5)                                                  
         BCT   RE,DISG44                                                        
         TM    GCTIND1,GCTIXLDG           LEDGER NOT IN LIST                    
         BO    DISG50                     . YES-THATS WHAT WE WANT              
         B     DISG399                    ELSE SKIP COLUMN                      
DISG45   TM    GCTIND1,GCTIXLDG           LEDGER IN LIST, EXCLUDE?              
         BO    DISG399                    . YES-SKIP COLUMN                     
*-----------------------------------------                                      
* GRID COLUMN HEADLINES                                                         
*-----------------------------------------                                      
DISG50   CLI   SCRLFLAG,DWNINIT                                                 
         BNE   DISG100                                                          
*                                                                               
         XC    TEMP,TEMP                                                        
         LA    RE,TEMP                                                          
         LA    R5,WORKD                   POINT TO WORKD FOR NAME               
         TM    GCTIND1,GCTIOVER           IS DD ENTRY IN OVERWORK?              
         BZ    *+8                        . NO                                  
         AHI   R5,OVERWORK-WORKD                                                
         AH    R5,GCTNADI                 DISPLACEMENT TO NAME                  
         SR    R1,R1                                                            
         IC    R1,GCTNMLN                 LENGTH OF GRID COLUMN NAME            
*                                                                               
         SHI   R1,1                       DECR NAME LENGTH                      
         JM    *+2                        MINUS MEANS TABLE IS WRONG            
         EX    R1,*+8                     MOVE NAME INTO TEMP                   
         B     *+10                                                             
         MVC   0(0,RE),0(R5)              MOVE NAME INTO TEMP                   
*                                                                               
         AR    RE,R1                                                            
         AHI   R1,1                       BACK TO TRUE LENGTH                   
DISG51   CLI   0(RE),C' '                                                       
         BH    DISG52                                                           
         SHI   RE,1                                                             
         BCT   R1,DISG51                                                        
         B     DISG56                                                           
*                                         *POSSIBLE HEADER SEPARATION*          
DISG52   LA    RF,TEMP+1                                                        
DISG54   CR    RF,RE                      ARE THERE NO SPACES?                  
         BNL   DISG56                     . NO-THEN DON'T SEPARATE              
         CLI   0(RF),C' '                                                       
         BE    *+12                                                             
         LA    RF,1(RF)                                                         
         B     DISG54                                                           
         MVI   0(RF),GCTSEPQ              HEADING SEPARATOR (|)                 
*-----------------------------------------                                      
DISG56   MVI   1(RE),C'*'                                                       
         LA    RE,2(RE)                                                         
         EDIT  GCTCOID,(2,(RE)),ZERO=NOBLANK,FILL=0                             
         LA    RE,2(RE)                                                         
*                                                                               
         CLI   GCTFIND,0                                                        
         BE    DISG60                                                           
         MVI   0(RE),C'*'                                                       
         LA    RE,1(RE)                                                         
*                                                                               
         TM    GCTFIND,GCTFHIDE                                                 
         BZ    *+12                                                             
         MVI   0(RE),C'H'                 HIDE                                  
         LA    RE,1(RE)                                                         
*                                                                               
         TM    GCTFIND,GCTFDAT                                                  
         BZ    DISG57                                                           
         MVI   0(RE),C'D'                 DATE                                  
         TM    GCTIND2,GCTIMONO                                                 
         BZ    DISG58                                                           
         MVC   1(8,RE),=C'#MMM/YY#'                                             
         LA    RE,8(RE)                                                         
         B     DISG58                                                           
DISG57   TM    GCTFIND,GCTFNUM                                                  
         BZ    *+12                                                             
         MVI   0(RE),C'N'                 NUMBER                                
DISG58   LA    RE,1(RE)                                                         
*                                                                               
         TM    GCTFIND,GCTFRGHT                                                 
         BZ    *+12                                                             
         MVI   0(RE),C'R'                 RIGHT                                 
         B     DISG59                                                           
         TM    GCTFIND,GCTFCENT                                                 
         BZ    *+12                                                             
         MVI   0(RE),C'C'                 CENTER                                
         B     DISG59                                                           
         TM    GCTFIND,GCTFSIZ                                                  
         BZ    *+12                                                             
         MVI   0(RE),C'S'                 SIZED (2")                            
DISG59   LA    RE,1(RE)                                                         
*                                                                               
DISG60   LR    R1,RE                                                            
         LA    RE,TEMP                                                          
         SR    R1,RE                      R1=LENGTH OF FIELD                    
         JNP   *+2                                                              
         B     DISG180                    CONTINUE AS TEXT FIELD                
*-----------------------------------------                                      
* GRID COLUMN DATA                                                              
*-----------------------------------------                                      
DISG100  XC    TEMP,TEMP                                                        
         L     R5,ATSARREC                R5=START WITH THE TSAR DATA           
         LA    R5,TSARDATA-TSARRECD(R5)                                         
         CLI   SCRLFLAG,DWNEOR            WANT EOR?                             
         BE    DISG102                    . NO                                  
         CLI   SCRLFLAG,DWNSBT                                                  
         BE    DISG102                                                          
         TM    GCTIND2,GCTISPDA           SPECIAL DATA FIELD ?                  
         BZ    DISG102                    . NO                                  
         LA    R5,WORKD                   POINT TO WORKD FOR ROUTINE            
         AHI   R5,OVERWORK-WORKD                                                
*-----------------------------------------                                      
* HANDLE TOTALS                                                                 
*-----------------------------------------                                      
DISG102  CLI   SCRLFLAG,DWNEOR                                                  
         BE    DISG103                                                          
         CLI   SCRLFLAG,DWNSBT                                                  
         BNE   DISG115                                                          
DISG103  TM    GCTIND1,GCTITOT            TOTAL THIS COLUMN?                    
         BZ    DISG130                    . NO                                  
*                                                                               
         TM    GCTIND1,GCTIRTOT           TOTAL NEEDS SPECIAL ROUTINE?          
         BZ    DISG105                    . NO                                  
         LA    R5,WORKD                   POINT TO WORKD FOR ROUTINE            
         AHI   R5,OVERWORK-WORKD                                                
         AH    R5,GCTDTOT                 DISPLACMNT TO SPECIAL ROUTINE         
         L     RF,0(R5)                   BRANCH TO SPECIAL ROUTINE             
         BASR  RE,RF                                                            
         B     DISG180                                                          
*                                                                               
DISG105  TM    GCTIND3,GCTISPTO           SPECIAL TOTAL                         
         BO    DISG106                                                          
         TM    GCTFIND,GCTFNUM            IF NUMBER GET TOTAL                   
         BO    DISG108                                                          
DISG106  LA    R5,WORKD                   NEED TEXT FOR TOTAL LINE              
         AHI   R5,OVERWORK-WORKD          TOTAL TEXT ALWAYS OFF OVERWRK         
DISG108  AH    R5,GCTDTOT                 ADD DISPLACEMENT TO TOTAL             
         SR    R1,R1                                                            
         ICM   R1,1,GCTLTOT               R1=LENGTH OF GRID COLUMN DATA         
         JZ    *+2                        INTERNAL TABLE SETUP WRONG            
         TM    GCTFIND,GCTFNUM                                                  
         BO    DISG340                                                          
         B     DISG175                                                          
*-----------------------------------------                                      
* CHECK FOR SECONDARY COLUMNS                                                   
*-----------------------------------------                                      
DISG115  CLI   SCRLFLAG,DWN2ND            DO WE WANT SECONDARY COLUMNS?         
         BE    DISG116                                                          
         TM    GCTIND3,GCTI2ND            SECONDARY COLUMN?                     
         BO    DISG130                    . YES-DISPLAY A BLANK                 
         B     DISG118                                                          
DISG116  TM    GCTIND3,GCTI1ST            PRIMARY ONLY COLUMN?                  
         BO    DISG130                    . YES-DISPLAY A BLANK                 
*-----------------------------------------                                      
* SPECIAL DATA ROUTINE                                                          
*-----------------------------------------                                      
DISG118  TM    GCTIND1,GCTIROUT           SPECIAL ROUTINE NEEDED?               
         BZ    DISG120                    . NO                                  
         LA    R5,WORKD                   POINT TO WORKD FOR ROUTINE            
         AHI   R5,OVERWORK-WORKD                                                
         AH    R5,GCTDADI                 DISPLACMNT TO SPECIAL ROUTINE         
         L     RF,0(R5)                   BRANCH TO SPECIAL ROUTINE             
         BASR  RE,RF                                                            
         B     DISG180                                                          
*-----------------------------------------                                      
* DATA FROM AN ELEMENT                                                          
*-----------------------------------------                                      
         USING ELETABD,RF                                                       
DISG120  TM    GCTIND1,GCTIELEM           DATA IN AN ELEMENT?                   
         BZ    DISG140                    . NO                                  
         L     RF,AELETAB                 R2=A(ELEMENT TABLE)                   
DISG122  CLI   ELETYPE1,EOT               END OF TABLE                          
         BE    DISG130                                                          
         CLC   ELETYPE1,GCTELCD           MATCH ON ELEMENT CODE?                
         BE    DISG124                                                          
DISG123  LA    RF,ELETABL(RF)             BUMP TO NEXT ENTRY                    
         B     DISG122                                                          
*                                                                               
DISG124  SR    R5,R5                                                            
         ICM   R5,3,ELEADDR               R5=(DISPLCMNT TO ELEMNT ADDR)         
         BZ    DISG123                    NO DATA, CHECK NEXT ELEMENT           
         LA    R5,WORKD(R5)                                                     
         L     R5,0(R5)                                                         
DISG125  DS    0H                                                               
         CLI   0(R5),EOR                                                        
         BE    DISG123                    NO DATA, CHECK NEXT ELEMENT           
         CLC   GCTELCD,0(R5)              SURE THIS IS WHAT WE WANT             
         BNE   DISG126                    . NO                                  
         TM    GCTIND1,GCTIELST           CHECKING FOR SUB-EL CODE              
         BZ    DISG128                    NOT NEEDED                            
         CLC   GCTELSCD,2(R5)             MATCH ON SUB-EL CODE?                 
         BE    DISG128                    . YES                                 
DISG126  SR    RE,RE                                                            
         IC    RE,1(R5)                   BUMP TO THE NEXT ELEMENT              
         AR    R5,RE                                                            
         B     DISG125                                                          
*                                                                               
DISG128  TM    GCTIND3,GCTIEVL            CHECK FOR VARIABLE LENGTH             
         BZ    DISG129                                                          
         SR    R1,R1                                                            
         IC    R1,1(R5)                   ELEMENT LENGTH                        
         SR    RF,RF                                                            
         IC    RF,GCTELDS                 DISPLACEMENT TO DATA                  
         SR    R1,RF                                                            
         BNP   DISG130                                                          
         CHI   R1,L'TEMP                                                        
         BNH   DISG129                                                          
         LHI   R1,L'TEMP                                                        
*                                                                               
DISG129  SR    RF,RF                                                            
         IC    RF,GCTELDS                 DISPL TO DATA WITHIN ELEMENT          
         AR    R5,RF                                                            
         B     DISG150                    CONTINUE                              
         DROP  RF                                                               
*-----------------------------------------                                      
* NO DATA FOUND                                                                 
*-----------------------------------------                                      
DISG130  TM    OVRSTAT,OVRGNOD            NEXT COLUMN THE SAME?                 
         BO    DISG399                    . YES-SKIP AND SHUT OFF FLAG          
         LHI   R1,1                       LENGTH OF FIELD                       
         MVI   TEMP,C' '                                                        
         B     DISG180                                                          
*-----------------------------------------                                      
* CALCULATE DISPLACEMENT TO DATA                                                
*-----------------------------------------                                      
DISG140  AH    R5,GCTDADI                 DISPLACEMENT TO DATA                  
*-----------------------------------------                                      
* DATA FIELD                                                                    
*-----------------------------------------                                      
DISG150  TM    GCTFIND,GCTFDAT+GCTFNUM    FORMAT IS DATE OR NUMBER?             
         BNZ   DISG200                    . YES                                 
*                                                                               
         TM    GCTIND2,GCTIHEX            HEX/BIN NUMBER TO HEXOUT?             
         BZ    DISG160                    . NO                                  
         TM    GCTIND3,GCTIEVL                                                  
         BZ    DISG156                                                          
         LR    RF,R1                                                            
         B     DISG158                                                          
DISG156  SR    RF,RF                                                            
         ICM   RF,1,GCTDALN               R1=LENGTH OF GRID COLUMN DATA         
         JZ    *+2                        INTERNAL TABLE SETUP WRONG            
DISG158  GOTO1 VHEXOUT,DMCB,(R5),TEMP,(RF),=C'MIX'                              
         L     RE,16(R1)                  PARAMETER 5                           
         CHI   RE,0                       CHECK IF UNSUCCESSFUL HEXOUT          
         BE    DISG130                    . YES                                 
         LR    R1,RE                      LOAD UP LENGTH                        
         B     DISG180                    CONTINUE AS TEXT                      
*-----------------------------------------                                      
* YES/NO BIT SETTING                                                            
*-----------------------------------------                                      
DISG160  TM    GCTIND2,GCTIYON            IS THIS A YES/NO BIT SETTING          
         BZ    DISG170                                                          
*                                                                               
         IC    RE,GCTYONV                 BIT WE NEED TO TEST                   
         LHI   R1,3                                                             
         EX    RE,*+8                                                           
         B     *+8                                                              
         TM    0(R5),0                    SHOULD WE KEEP THE YES?               
         BZ    DISG130                    . YES                                 
*                                                                               
         LA    RE,TEMP                                                          
         LA    R5,WORKD                   POINT TO WORKD FOR NAME               
         TM    GCTIND1,GCTIOVER           IS DD ENTRY IN OVERWORK?              
         BZ    *+8                        . NO                                  
         AHI   R5,OVERWORK-WORKD                                                
         AH    R5,GCTNADI                 DISPLACEMENT TO NAME                  
         SR    R1,R1                                                            
         IC    R1,GCTNMLN                 LENGTH OF GRID COLUMN NAME            
         SHI   R1,1                                                             
         JM    *+2                                                              
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),0(R5)              MOVE NAME INTO TEMP                   
         AHI   R1,1                                                             
         B     DISG180                                                          
*                                                                               
DISG170  TM    GCTIND3,GCTIEVL                                                  
         BO    DISG175                                                          
         SR    R1,R1                                                            
         ICM   R1,1,GCTDALN               R1=LENGTH OF GRID COLUMN DATA         
         BNZ   *+8                        ZERO LENGTH MEANS NO DATA             
         B     DISG130                                                          
DISG175  LA    RE,TEMP                                                          
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   0(0,RE),0(R5)                                                    
         AR    RE,R1                      POINT TO LAST BYTE                    
         CLI   0(RE),C' '                 BACK UP PAST THE SPACES               
         BH    *+8                                                              
         BCT   RE,*-8                                                           
         LA    R1,1(RE)                   BYTE AFTER THE DATA                   
         LA    RE,TEMP                                                          
         SR    R1,RE                      R1=LENGTH OF FIELD                    
         CHI   R1,0                       MAKE SURE THERE WAS SOMETHING         
         BNH   DISG130                    NOTHING                               
         CHI   R1,L'TEMP                                                        
         BH    DISG130                                                          
         CLC   TEMP(L'SPACES),SPACES                                            
         BNH   DISG130                                                          
*-----------------------------------------                                      
* ROW HEADER CHARACTER AND/OR OUTPUT COL                                        
*-----------------------------------------                                      
DISG180  CLI   SCRLFLAG,DWNINIT                                                 
         BE    DISG181                                                          
         CLI   GCTCOID,90                 START OF ROW? THEN XTRA SPACE         
         BL    DISG181                    . NO                                  
         MVC   DLCBFLX+1(L'DUMLIN1-1),TEMP                                      
         AHI   R1,1                                                             
         CLI   SCRLFLAG,DWNSBT                                                  
         BE    *+12                                                             
         CLI   SCRLFLAG,DWNSUB                                                  
         BNE   *+8                                                              
         MVI   DLCBFLX,C'S'                                                     
         CLI   SCRLFLAG,DWNEOR                                                  
         BNE   *+8                                                              
         MVI   DLCBFLX,C'T'                                                     
         B     *+10                                                             
DISG181  MVC   DLCBFLX(L'DUMLIN1),TEMP                                          
*                                                                               
         STC   R1,DLCBLEN                 LENGTH OF FIELD                       
         GOTO1 ADWNL,DWNTEXT                                                    
         JNE   *+2                                                              
         B     DISG400                                                          
*-----------------------------------------                                      
* DATE DATA FIELD                                                               
*-----------------------------------------                                      
DISG200  TM    GCTFIND,GCTFDAT            FORM = C'D'                           
         BZ    DISG300                                                          
*                                                                               
         TM    GCTIND2,GCTIMONO                                                 
         BZ    DISG250                                                          
         CLC   0(2,R5),SPACES                                                   
         BNH   DISG130                                                          
         MVC   TEMP+10(2),0(R5)                                                 
         MVI   TEMP+12,X'01'                                                    
         GOTO1 VDATCON,DMCB,(1,TEMP+10),(6,TEMP)                                
         LHI   R1,6                                                             
         B     DISG180                                                          
*                                                                               
DISG250  SR    RE,RE                                                            
         IC    RE,GCTDTYP                                                       
         CLC   0(2,R5),SPACES                                                   
         BNH   DISG130                                                          
         GOTO1 VDATCON,DMCB,((RE),(R5)),(11,TEMP)                               
         LHI   R1,8                       R1=LENGTH OF FIELD                    
         B     DISG180                    CONTINUE AS TEXT FIELD                
*-----------------------------------------                                      
* NUMERIC DATA FIELD                                                            
*-----------------------------------------                                      
DISG300  TM    GCTFIND,GCTFNUM            FORM = C'N'                           
         BZ    DISG400                                                          
         TM    GCTIND2,GCTIDR+GCTICR      IS IT SPECIAL DR OR CR TYPE?          
         BZ    DISG310                    . NO-THEN SKIP                        
         SR    RE,RE                                                            
         IC    RE,GCTDITRS                TRNSTAT TO TEST IF DR                 
         AR    RE,R5                                                            
         TM    0(RE),TRNSDR               IS THIS A DEBIT?                      
         BZ    DISG302                    . NO                                  
         TM    GCTIND2,GCTIDR             . YES-DO I WANT DEBITS?               
         BO    DISG320                         . YES                            
         B     DISG130                         . NO                             
DISG302  TM    GCTIND2,GCTICR             DO I WANT CREDITS?                    
         BO    DISG320                    . YES                                 
         B     DISG130                    . NO                                  
*                                                                               
DISG310  TM    GCTIND2,GCTIBIN            IS THIS A BINARY/HEX NUMBER?          
         BZ    DISG320                    . YES                                 
         SR    R1,R1                                                            
         ICM   R1,1,GCTDALN               R1=MASK FOR ICM                       
         JZ    *+2                        INTERNAL TABLE SETUP WRONG            
         SR    RF,RF                                                            
         EX    R1,*+8                                                           
         B     *+8                                                              
         ICM   RF,0,0(R5)                 PICK UP BINARY NUMBER                 
         EDIT  (RF),(16,TEMP),ALIGN=LEFT,ZERO=NOBLANK                           
         LA    R1,TEMP+16-1               POINT TO LAST BYTE                    
         B     DISG360                                                          
*                                                                               
DISG320  SR    R1,R1                                                            
         ICM   R1,1,GCTDALN               R1=LENGTH OF GRID COLUMN DATA         
         BZ    DISG130                    NO DATA, JUST PUT A BLANK             
DISG340  BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         ZAP   TEMP+20(14),0(0,R5)                                              
*                                                                               
         TM    GCTIND3,GCTIZAB            BLANK FOR ZEROS                       
         BZ    DISG342                    . NO                                  
         CP    TEMP+20(14),=P'0'          ZERO?                                 
         BE    DISG130                    . YES                                 
*                                                                               
DISG342  TM    GCTIND3,GCTINDEC           NO DECIMALS?                          
         BO    DISG345                    . YES-WE DO NOT WANT DECIMALS         
         CURED (P14,TEMP+20),(20,TEMP),2,FLOAT=-,ALIGN=LEFT,COMMAS=YES          
         B     DISG350                                                          
DISG345  EDIT  (P14,TEMP+20),(20,TEMP),FLOAT=-,ALIGN=LEFT,COMMAS=YES            
*                                                                               
DISG350  LA    R1,TEMP+20-1               POINT TO LAST BYTE                    
DISG360  CLI   0(R1),C' '                 BACK UP PAST THE SPACES               
         BH    *+8                                                              
         BCT   R1,*-8                                                           
         LA    R1,1(R1)                   BYTE AFTER THE DATA                   
         LA    RE,TEMP                                                          
         SR    R1,RE                      R1=LENGTH OF FIELD                    
         CHI   R1,0                       MAKE SURE THERE WAS SOMETHING         
         BNH   DISG130                    NOTHING                               
*                                                                               
         MVC   DLCBFLD,TEMP                                                     
         STC   R1,DLCBLEN                 LENGTH OF FIELD                       
         GOTO1 ADWNL,DWNNUM                                                     
         JNE   *+2                                                              
         B     DISG400                                                          
*-----------------------------------------                                      
* NEXT GRID COLUMN ENTRY                                                        
*-----------------------------------------                                      
DISG399  NI    OVRSTAT,X'FF'-OVRGNOD     SKIP COL, SO LOOK FOR NEXT             
*                                                                               
DISG400  SR    R1,R1                                                            
         IC    R1,GCTLN                                                         
         AR    R3,R1                                                            
         B     DISG30                                                           
*-----------------------------------------                                      
* END OF HEADER/DATA LINE                                                       
*-----------------------------------------                                      
DISG410  GOTO1 ADWNL,DWNEOL                                                     
         JNE   *+2                                                              
         CLI   SCRLFLAG,DWNEOR                                                  
         BE    DISG420                                                          
         B     DISGX                                                            
*                                                                               
DISG418  GOTO1 ASCRNCLR,DISSTART          CLEAR ALL SCREEN DATA LINES           
*                                                                               
DISG420  GOTO1 ADWNL,DWNEOR                                                     
         JNE   *+2                                                              
         CLI   SCRLFLAG,DWNEOR                                                  
         BNE   *+8                                                              
         OI    OVRSTAT,OVRGDONE           END IT                                
*-----------------------------------------                                      
* CHECK DISPLAY LINES FIT BEFORE EXITING                                        
*-----------------------------------------                                      
DISGX    SR    RF,RF                                                            
         IC    RF,DISLINE                 RF=(NEXT FREE LINE NUMBER)            
         LR    RE,RF                      RE=RF                                 
         SR    R0,R0                                                            
         ICM   R0,1,LINSUSED              R0=(NUMBER OF LINES NEEDED)           
         BZ    DISGXH                                                           
         LR    R1,R0                                                            
         BCTR  R1,0                                                             
         AR    RE,R1                      RE=(PROJECTD SCREEN END LINE)         
         SR    R1,R1                                                            
         IC    R1,DISEND                  R1=(MAX SCREEN END LINE)              
         CR    RE,R1                      COULD WE FIT ITEM ON SCREEN?          
         BNH   DISGXE                     . YES                                 
*                                                                               
         NI    OVRSTAT,X'FF'-OVRGDONE     NOT OVER, LINES DO NOT FIT            
*                                                                               
         TM    OVRSTAT,OVRGDILC           NEED TO CORRECT BACK UP?              
         BZ    DISGXH                     . NO-NOT NEEDED                       
         AHI   RF,1                       MAKE UP FOR GRID OVERLAPPING          
         STC   RF,DISLINE                                                       
*                                                                               
DISGXH   NI    OVRSTAT,X'FF'-OVRGDILC                                           
         B     ROUTH1                                                           
*                                                                               
DISGXE   NI    OVRSTAT,X'FF'-OVRGDILC                                           
         B     ROUTE1                                                           
         DROP  R3,R4                                                            
*********************************************************************           
* DOWNLOAD MODULE                                                   *           
*********************************************************************           
DWNL     BRAS  RE,UDWNL                                                         
         BE    ROUTE1                                                           
         B     ROUTH1                                                           
         EJECT                                                                  
***********************************************************************         
* ROUTINE TO OVERLAY LIST OR OTHER ENQUIRIES SCREEN                   *         
***********************************************************************         
OVRSCR   STC   R1,TWASCROV                                                      
         MVC   DMCB+4(3),=X'D90620'                                             
         MVC   DMCB+7(1),TWASCROV                                               
         GOTO1 VCALLOV,DMCB,(0,BASOLAYH)                                        
         CLI   4(R1),X'FF'                                                      
         JE    *+2                        KILL IF CAN'T LOAD SCREEN             
         LA    R1,BASHEADH                RE-TRANSMIT ALL HEADER FIELDS         
         XR    RE,RE                                                            
         LA    RF,BASOLAYH-1                                                    
         ICM   RE,1,0(R1)                                                       
         BZ    *+12                                                             
         OI    FVOIND-FVIHDR(R1),FVOXMT                                         
         BXLE  R1,RE,*-12                                                       
OVRSCRX  B     ROUTX1                                                           
         EJECT                                                                  
**********************************************************************          
*        CHECK ACTION                                                *          
*         ON ENTRY P1 = A(2-CHARS ACTION NAME)                       *          
*         ON EXIT  P1 = A(ACTION TABLE ENTRY) IF ONE IS FOUND        *          
**********************************************************************          
         USING ACTTABD,R3                                                       
CHKACT   L     R2,0(R1)                                                         
         L     R3,AACTTAB            R3=A(ACTION TABLE)                         
         MVC   FVMSGNO,=AL2(EGIFNOTV)                                           
*                                                                               
CHKACT10 CLI   0(R3),EOT             END OF TABLE?                              
         BE    CHKACTER              ERROR - ACTION NOT FOUND                   
         SR    RF,RF                                                            
         ICM   RF,3,ACTSHNAM         RF=(DISPLACEMENT TO 2 CHAR NAME)           
         LA    RF,WORKD(RF)          RF=A(2 CHAR NAME)                          
*                                                                               
         CLC   0(ACTSHLNQ,RF),0(R2)  FOUND MATCH WITH ACT SCREEN FLD?           
         BNE   CHKACT40              . NO                                       
*                                                                               
         TM    COMPSTA4,CPYSOFF2     2 CHAR OFFICE COMPANY?                     
         BO    *+12                                                             
         TM    ACTAUTH,ACTC2CHQ      ACTION ONLY FOR 2 CHAR OFFICE?             
         BO    CHKACT40                                                         
*                                                                               
         CLI   ACTCTRY,CTRYALLQ      EVERY COUNTRY?                             
         BE    CHKACT30                                                         
         MVC   BYTE1,ACTCTRY                                                    
         NI    BYTE1,X'FF'-CTRYNOTQ                                             
         TM    ACTCTRY,CTRYNOTQ      NOT FLAG ON?                               
         BO    CHKACT20                                                         
         CLC   AGYCTRY,BYTE1         MATCH ON COUNTRY?                          
         BNE   CHKACT40                                                         
         B     CHKACT30                                                         
CHKACT20 CLC   AGYCTRY,BYTE1         MATCH ON COUNTRY?                          
         BE    CHKACT40                                                         
*                                                                               
CHKACT30 TM    ACTAUTH,ACTDDSQ       ACTION DDS ONLY?                           
         BZ    CHKACT35              . NO                                       
         CLI   TWAOFFC,C'*'          IS THE TERMINAL DDS ?                      
         BNE   CHKACT40              . YES                                      
*                                                                               
CHKACT35 TM    ACTAUTH,ACTGRONQ      ACTION GRIDS ONLY?                         
         BNO   CHKACTX               . NO                                       
         TM    PCDRIVEN,PCGDATQ      PC ACCPAK GRIDS ENABLED?                   
         BO    CHKACTX                                                          
*                                                                               
CHKACT40 LA    R3,ACTTABL(,R3)       BUMP TO NEXT ENTRY IN THE ACTTAB           
         B     CHKACT10                                                         
*                                                                               
CHKACTX  ST    R3,0(,R1)             RETURN A(ACTION TABLE ENTRY)               
         B     ROUTE1                SET CC TO EQUAL                            
CHKACTER B     ROUTH1                SET CC TO HIGH                             
         DROP  R3                                                               
         EJECT                                                                  
**********************************************************************          
*        CHECK LIST SUB-ACTION                                       *          
* ON ENTRY  P1 =(ACTION TABLE ENTRY)                                 *          
*          WORK=NEW KEY INCLUDING U/L                                *          
* ON EXIT  NEW KEY AND LENGTH IN THE KEY FIELD                       *          
**********************************************************************          
         USING FLDHDRD,R2                                                       
         USING ACTTABD,R3                                                       
CHKKEY   L     R3,0(,R1)                                                        
         LA    R2,BASKEYH          KEY HEADER FIELD                             
         TM    ACTAUTH2,ACT2LOWQ   TEST WE WANT LOWER LEVEL A/C ONLY            
         BZ    CHKEY10                                                          
         GOTO1 AUNITLDG,WORK       READ LEDGER RECORD                           
         CLI   LEDGTLVA,0          ERROR - LEDGER NOT VALID                     
         BE    CHKEYER1                                                         
         CLI   LEDGTLVA,L'ACTKACT                                               
         BE    CHKEY10             OK - ONLY ONE LEVEL                          
         LA    R1,LEDGTLVD         FIND LOWEST LEVEL                            
         CLI   0(R1),0                                                          
         BH    *+10                                                             
         BCTR  R1,0                                                             
         B     *-10                                                             
         BCTR  R1,0                THEN PENULTIMATE LEVEL                       
*                                                                               
         SR    RE,RE                                                            
         IC    RE,0(,R1)           LENGTH OF NEXT LOWEST LEVEL A/C              
         LA    R1,WORK(RE)                                                      
         LA    R1,2(,R1)           FIRST CHARACTER OF THIS LEVEL A/C            
         LA    RF,L'ACTKACT        LENGTH OF ACCOUNT                            
         SR    RF,RE               RF=(L'LEFT FOR THIS LEVEL)                   
         BCTR  RF,0                                                             
         EX    RF,*+8              SEE IF THIS LEVEL CONTAINS SPACES            
         BNH   CHKEYER2            YES - WE DON'T WANT IT                       
         CLC   0(0,R1),SPACES                                                   
*                                                                               
CHKEY10  LA    RF,WORK             NEW KEY WITH U/L                             
         TM    ACTAUTH2,ACT2NULQ                                                
         BZ    *+8                                                              
         LA    RF,2(,RF)           NO UNIT/LEDGER REQUIRED IN THE KEY           
         MVC   BASKEY,0(RF)        MOVE IN NEW KEY                              
         NI    FLDIIND,X'FF'-FINPVAL                                            
         LA    RF,BASKEY+L'BASKEY-1                                             
         CLI   0(RF),C' '                                                       
         BH    *+8                                                              
         BCT   RF,*-8                                                           
         LA    RF,1(,RF)                                                        
         LA    RE,BASKEY                                                        
         SR    RF,RE               LENGTH OF DATA IN KEY FIELD                  
         STC   RF,FLDILEN          SAVE NEW LENGTH                              
                                                                                
CHKEYX   B     ROUTE1              SET CC TO EQUAL                              
*                                                                               
CHKEYER1 MVC   FVMSGNO,=AL2(AE$INULA) INVALID U/L FOR ACTION                    
         ST    R2,FVADDR           SET CURSOR TO KEY FIELD                      
         B     ROUTH1                                                           
CHKEYER2 MVC   FVMSGNO,=AL2(AE$NLOWA) NOT A LOW LEVEL ACCOUNT                   
         B     ROUTH1                 SET CC TO HIGH                            
         DROP  R2,R3                                                            
         EJECT                                                                  
*                                                                               
**********************************************************************          
*        TEST UNIT/LEDGER                                            *          
* ON ENTRY R1=A(UNIT/LEDGER NUMBER) - SEE ACTAUTH2                   *          
**********************************************************************          
TSTUL    TM    0(R1),ACT2ALLQ      TEST ALL LEDGERS?                            
         BO    TSTULX                                                           
         MVC   WORK(L'BASKEY),BASKEY                                            
         CLI   SVACTNUM,ACTNODSM   TEST ORDER SUMMARY?                          
         BE    TSTUL02                                                          
         CLI   SVACTNUM,ACTNJBES   TEST JOB ESTIMATE?                           
         BNE   TSTUL05                                                          
TSTUL02  MVC   WORK(L'SPROUL),SPROUL DEFAULT U/L - PRODUCTION                   
*                                                                               
TSTUL05  TM    0(R1),ACT2NSJQ      TEST ALL LEDGERS EXCEPT SJ?                  
         BNO   TSTUL10                                                          
         CLC   SPROUL,WORK         SJ?                                          
         BE    TSTULH                                                           
         B     TSTULX                                                           
*                                                                               
TSTUL10  TM    0(R1),ACT2CSTQ      TEST COSTING LEDGER?                         
         BNO   TSTUL20                                                          
         CLC   =C'1C',WORK         1C?                                          
         BNE   TSTULH                                                           
         B     TSTULX                                                           
*                                                                               
TSTUL20  CLI   WORK,C'S'           SUBSIDIARY UNIT?                             
         BNE   TSTULH                                                           
*                                                                               
         TM    0(R1),ACT2EXPQ      TEST EXPENSE LEDGER?                         
         BZ    TSTUL22                                                          
         CLC   SEXPUL,WORK         SE?                                          
         BE    TSTULX                                                           
*                                                                               
TSTUL22  TM    0(R1),ACT2CRDQ      TEST CREDITORS LEDGER                        
         BZ    TSTUL40                                                          
*                                                                               
         L     RF,ALDGTAB          R4=A(LEDGER ATTRIBUTE TABLE)                 
         USING LEDGTABD,RF                                                      
TSTUL30  CLI   LEDGTYPE,EOT        END OF TABLE?                                
         BE    TSTUL40                                                          
         CLC   LEDGTYPE,WORK+1     MATCH ON LEDGER?                             
         BE    *+12                                                             
         LA    RF,LEDGLNQ(,RF)                                                  
         B     TSTUL30                                                          
         TM    LEDGATTR,LEDGCRD    CREDITOR LEDGER?                             
         BZ    TSTUL40                                                          
         B     TSTULX                                                           
         DROP  RF                                                               
*                                                                               
TSTUL40  TM    0(R1),ACT2PROQ      TEST PRODUCTION LEDGER?                      
         BNO   TSTUL50                                                          
         CLC   SPROUL,WORK         SJ?                                          
         BNE   TSTULH                                                           
         B     TSTULX                                                           
*                                                                               
TSTUL50  TM    0(R1),ACT2RECQ      TEST RECEIVABLE LEDGER                       
         BZ    TSTULH                                                           
*                                                                               
         L     RF,ALDGTAB          R4=A(LEDGER ATTRIBUTE TABLE)                 
         USING LEDGTABD,RF                                                      
TSTUL60  CLI   LEDGTYPE,EOT        END OF TABLE?                                
         BE    TSTULH                                                           
         CLC   LEDGTYPE,WORK+1     MATCH ON LEDGER?                             
         BE    *+12                                                             
         LA    RF,LEDGLNQ(,RF)                                                  
         B     TSTUL60                                                          
         TM    LEDGATTR,LEDGDEB    RECEIVABLE LEDGER?                           
         BZ    TSTULH                                                           
         DROP  RF                                                               
*                                                                               
TSTULX   B     ROUTE1              SET CC TO EQUAL                              
TSTULH   B     ROUTH1              SET CC TO HIGH                               
         EJECT                                                                  
***********************************************************************         
* UNADDRESSABLE ROUTINES                                                        
***********************************************************************         
GETEID   BRAS  RE,UGETEID          ENQUIRY ID TABLE                             
         J     ROUTX1                                                           
BLDDOR   BRAS  RE,UBLDDOR          BUILD GRID DETAIL                            
         J     ROUTX1                                                           
***********************************************************************         
*        CONSTANTS                                                    *         
***********************************************************************         
ONEP     DC    C'1P'               1P UNIT/LEDGER                               
ONER     DC    C'1R'               1R UNIT/LEDGER                               
ONEJ     DC    C'1J'               1J UNIT/LEDGER                               
DMWRT1   DC    C'DMWRT  '                                                       
DMREAD1  DC    C'DMREAD '                                                       
TEMPSTR1 DC    C'TEMPSTR '                                                      
SINCUL1  DC    C'SI'                                                            
GPROUL1  DC    C'GP'                                                            
SPLIT    DC    C'**************'                                                
         EJECT                                                                  
***********************************************************************         
*        LITERALS                                                     *         
***********************************************************************         
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ADDRESS/TABLES                                               *         
***********************************************************************         
COMMON   DS    0F                  COMMON S/R'S                                 
         DC    A(ROUT1)            GENERAL ROUTINES                             
         DC    V(ACJOBCOL)         JOBBER                                       
         DC    XL4'0'                                                           
         DC    XL4'0'                                                           
         DC    V(ACSRCHC)          SEARCH FOR ACCOUNTS                          
COMMONN  EQU   (*-COMMON)/L'COMMON NUMBER OF ENTRIES                            
*                                                                               
TABLES   DS    0F                  DISPLACEMENT OF TABLES IN ROOT               
         DC    A(DICUPR)           DICTIONARY (UPPER CASE)                      
         DC    A(DICMIX)           DICTIONARY (MIXED CASE)                      
         DC    A(ACTTAB)           ACTION TABLE                                 
         DC    A(OPTTAB)           OPTION TABLE                                 
         DC    A(FILTAB)           FILE TABLE                                   
         DC    A(CMDTAB)           COMMAND TABLE                                
         DC    A(PFKTAB)           PFKEY TABLE                                  
         DC    A(BUKTAB)           BUCKET TABLE                                 
         DC    A(HLPTAB)           HELP TABLE                                   
         DC    A(LDGTAB)           LEDGER ATTRIBUTE TABLE                       
         DC    A(DISTAB)           STANDARD COLUMN TABLE                        
         DC    A(DFCTAB)           DEFAULT CURRENCY TABLE                       
         DC    A(ELETAB)           ELEMENT TABLE                                
         DC    A(DCLTAB)           DEFAULT COLUMN TABLE                         
         DC    A(EIDTAB)           FIS TYPE ID TABLE                            
TABLESN  EQU   (*-TABLES)/L'TABLES NUMBER OF ENTRIES                            
         EJECT ,                                                                
**********************************************************************          
*        UNADDRESSABLE ROUTINES                                                 
**********************************************************************          
* DOWNLOAD MODULE                                                   *           
*   ON ENTRY R1=DOWNLOAD MODE                                       *           
*            DLCBLEN HAS DOWNLOAD FIELD LENGTH                      *           
*            DLCBFLD HAS DOWNLOAD FIELD DATA                        *           
*********************************************************************           
         USING GCTBLD,R3                                                        
         USING DLCBD,R4                                                         
UDWNL    NTR1  BASE=*,LABEL=*             DOWNLOAD CONTROL BLOCK                
         L     R4,ADLCB                   DOWNLOAD CONTROL BLOCK                
         STC   R1,BYTE2                   SAVE CURRENT MODE                     
*                                                                               
         CLI   BYTE2,DWNINIT              INITIALIZE                            
         BE    DWNL10                                                           
         CLI   BYTE2,DWNTEXT              DOWN-LOAD TEXT                        
         BE    DWNL20                                                           
         CLI   BYTE2,DWNNUM               DOWN-LOAD NUMBER                      
         BE    DWNL30                                                           
         MVI   DLCBACT,DLCBEOL                                                  
         CLI   BYTE2,DWNEOL               END OF LINE                           
         BE    DWNL50                                                           
         MVI   DLCBACT,DLCBEOR                                                  
         CLI   BYTE2,DWNEOR               END OF REPORT                         
         BE    DWNL50                                                           
         DC    H'0'                                                             
*-----------------------------------------                                      
* INITIALIZATION                                                                
*-----------------------------------------                                      
DWNL10   XC    DLCBD(DLCBL),DLCBD                                               
         MVI   DLCBACT,DLCBINIT           DOWN LOAD ACTION IS START             
         LA    RF,DWNHOOK                 DUMMY HOOK                            
         ST    RF,DLCBAPR                                                       
         MVC   DLCBAPL,ADUMLINE           DUMMY SCREEN LINE                     
         MVC   DLCXMAXL,=Y(L'DUMLIN1)                                           
         MVI   DLCXDELC,C' '              DELIMITER                             
         MVI   DLCXEOTC,C'"'              TEXT DELIMITER                        
         MVI   DLCXEOLC,X'5E'             SEMI-COLON, END-OF-LINE               
         MVI   DLCXEORC,C':'              END-OF-REPORT                         
         GOTO1 VDLFLD,(R4)                                                      
         BNE   DWNLH1                                                           
         MVC   DLCBFLD,SPACES             MUST CLEAR FIRST TIME IN              
         MVI   DLCBFLX,C' '                                                     
         MVC   DLCBFLX+1(L'DLCBFLX-1),DLCBFLX                                   
         B     DWNLX                      EXIT                                  
*-----------------------------------------                                      
* DOWNLOAD A RECORD - TEXT                                                      
*-----------------------------------------                                      
DWNL20   MVI   DLCBACT,DLCBPUT            ACTION IS PUT                         
         MVI   DLCBTYP,DLCBTXT            TYPE IS TEXT                          
         OI    DLCBFLG1,DLCBFXFL          USE EXTENDED FOR TEXT                 
*                                                                               
         CLI   DLCBLEN,0                  PRECATIONARY CHECK                    
         BH    DWNL24                                                           
         MVI   DLCBLEN,1                                                        
         MVI   DLCBFLX,C' '                                                     
         B     DWNL50                                                           
*                                                                               
DWNL24   CLI   DLCBLEN,GCTDLMXQ           LIMITED BY SCREEN                     
         BNH   DWNL26                                                           
         BRAS  RE,DWNBIG                  DOWNLOAD LONG TEXT FIELD              
         BNE   DWNLH1                                                           
         B     DWNLX                      DOWNLOAD FIELD                        
*                                                                               
DWNL26   LLC   R1,DLCBLEN                 R1=LENGTH OF TEXT                     
         LA    RF,DLCBFLX                 RF=A(TEXT)                            
         BRAS  RE,CLEANTXT                REMOVE DISRUPTIVE CHARACTERS          
         B     DWNL50                                                           
*-----------------------------------------                                      
* DOWNLOAD A RECORD - NUMBER                                                    
*-----------------------------------------                                      
DWNL30   MVI   DLCBACT,DLCBPUT            ACTION IS PUT                         
         MVI   DLCBTYP,DLCBNUM            TYPE IS NUMBER                        
         B     DWNL50                     DOWNLOAD FIELD                        
*-----------------------------------------                                      
* END OF LINE/END OF RECORD                                                     
*-----------------------------------------                                      
DWNL50   GOTO1 VDLFLD,(R4)                DOWNLOAD FIELD                        
         NI    DLCBFLG1,X'FF'-DLCBFXFL    MAKE SURE EXTENDED IS OFF             
*                                                                               
DWNLX    L     RE,ADUMLINE                START OF DUMMY LINE BUFFER            
         L     RF,DLCBAPL                 DUMMY LINE USED FOR OUTPUT            
         SR    RF,RE                                                            
         CHI   RF,DUMLINLN                DIFF MUST BE LESS THAN MAX            
         BNL   DWNLH1                     IF NOT EXIT NOT EQUAL                 
         B     DWNLE1                                                           
*                                                                               
DWNLH1   J     ROUTH1                     IF NOT EXIT NOT EQUAL                 
DWNLE1   J     ROUTE1                                                           
*-----------------------------------------                                      
* DOWNLOAD HOOK                                                                 
*-----------------------------------------                                      
DWNHOOK  L     RF,DLCBAPL                 NEXT DOWNLOAD PRINT LINE              
         LA    RF,L'DUMLIN1(,RF)                                                
         ST    RF,DLCBAPL                                                       
*                                                                               
         L     RF,ADUMLINE                DID WE EXCEED SPACE LIMIT?            
         AHI   RF,DUMLINLN                                                      
         C     RF,DLCBAPL                 MAKE SURE MAX IS HIGHER               
         JH    *+6                        . YES                                 
         DC    H'0'                                                             
*                                                                               
         SR    RF,RF                                                            
         IC    RF,LINSUSED                INCREMENT # OF DUMMY LINES            
         AHI   RF,1                                                             
         STC   RF,LINSUSED                                                      
         BR    RE                                                               
                                                                                
*----------------------------------------------------------------------         
* CLEAN TEXT STRING OF DISRUPTIVE CHARACTERS - ENTRY R1=LENGTH OF DATA          
*                                                    RF=A(DATA)                 
*----------------------------------------------------------------------         
CLEANTXT CLC   0(1,RF),DLCXEOTC           REMOVE TEXT DELIMETER C'"'            
         JE    CTXT2                                                            
         CLI   0(RF),X'5F'                REMOVE C'`'                           
         JE    CTXT2                                                            
         J     CTXT3                                                            
CTXT2    MVI   0(RF),C' '                                                       
CTXT3    LA    RF,1(RF)                                                         
         BRCT  R1,CLEANTXT                                                      
         BR    RE                                                               
                                                                                
*----------------------------------------------------------------------         
* DOWNLOAD LONG TEXT DATA                                                       
*----------------------------------------------------------------------         
DWNBIG   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         LLC   R1,DLCBLEN                 R1=TEXT LENGTH                        
         LA    RF,TEMP                    RF=A(TEXT DATA)                       
         BRAS  RE,CLEANTXT                REMOVE DISRUPTIVE CHARACTERS          
*                                                                               
         LLC   R2,DLCBLEN                 R2=TEXT LENGTH                        
         LA    R3,TEMP                    R3=A(TEXT DATA)                       
         MVI   BYTE1,C'1'                 FIRST LINE                            
*                                                                               
DWNB10   CHI   R2,GCTDLMXQ                TEXT BIGGER THAN LINE?                
         BNH   *+12                       . NO-ONLY PUT WHAT'S LEFT             
         LHI   R1,GCTDLMXQ                . YES-ONLY PUT 1 LINE                 
         B     *+6                                                              
         LR    R1,R2                                                            
         STC   R1,DLCBLEN                 INDICATE OUTPUT LENGTH                
*                                                                               
         BCTR  R1,0                       DECREMENT FOR MOVE                    
         EX    R1,*+8                                                           
         B     *+10                                                             
         MVC   DLCBFLX(0),0(R3)           TEXT FOR DOWNLOAD                     
*                                                                               
         MVI   DLCBACT,DLCBPUT            ACTION IS PUT                         
         MVI   DLCBTYP,DLCBTXT            TYPE IS TEXT                          
         OI    DLCBFLG1,DLCBFXFL          USE EXTENDED FOR TEXT                 
         MVI   DLCXEOTC,C' '              TEXT DELIMITER                        
         GOTO1 VDLFLD,(R4)                                                      
         NI    DLCBFLG1,X'FF'-DLCBFXFL    MAKE SURE EXTENDED IS OFF             
         MVI   DLCXEOTC,C'"'              TEXT DELIMITER                        
*                                                                               
         L     RE,ADUMLINE                START OF DUMMY BUFFER                 
         L     RF,DLCBAPL                 CURRENT LINE USED FOR OUTPUT          
         SR    RF,RE                                                            
         CHI   RF,DUMLINLN                MUST BE LESS THAN MAXIMUM             
         BNL   DWNBHX                     EXIT IF TOO BIG                       
*                                                                               
         L     RF,DLCBAPL                 CURRENT LINE USED FOR OUTPUT          
         CLI   BYTE1,C'1'                 FIRST LINE                            
         BNE   DWNB18                                                           
         MVI   0(RF),C'"'                                                       
         B     DWNB19                                                           
DWNB18   SHI   RF,1                       REDUCE FOR SHIFT                      
         MVC   0(GCTDLMXQ+1,RF),1(RF)     SHIFT OVER FOR QUOTES+2               
DWNB19   SHI   R2,GCTDLMXQ                REDUCE LEN BY WHAT JUST PUT           
         BP    DWNB20                     IF NOT POSITIVE THEN DONE             
         AHI   R2,GCTDLMXQ                                                      
         AR    RF,R2                                                            
         MVI   1(RF),C'"'                 ADD THE END QUOTE                     
         B     DWNBEX                                                           
DWNB20   AHI   R3,GCTDLMXQ-1              BUMP OVER TEXT JUST PUT               
         AHI   RF,GCTDLMXQ                END OF CURRENT LINE                   
         MVC   0(2,RF),0(R3)              MOVE TWO, YES                         
         LA    R3,1(R3)                   ADJUST?                               
         CLI   BYTE1,C'1'                                                       
         BE    DWNB22                                                           
         LA    R3,1(R3)                   FOR WHAT?                             
         SHI   R2,1                       SOMETHING?                            
         BNP   DWNB24                                                           
DWNB22   MVI   BYTE1,C'S'                 SUBSEQUENT LINES                      
         B     DWNB10                                                           
DWNB24   MVI   1(RF),C'"'                 ADD THE END QUOTE                     
*                                                                               
DWNBEX   J     ROUTE1                                                           
DWNBHX   J     ROUTH1                                                           
         DROP  R3,R4                                                            
         LTORG                                                                  
         EJECT                                                                  
                                                                                
**********************************************************************          
*        GET ENQUIRY ID NUMBER                                                  
* ON EXIT P1=(ACTION TABLE ENTRY IF FOUND)                                      
**********************************************************************          
UGETEID  NTR1  BASE=*,LABEL=*                                                   
         L     R3,AEIDTAB          ENQUIRY ID TABLE                             
         USING EIDTABD,R3                                                       
         SR    R0,R0                                                            
GEID02   CLI   EIDACT,EOT          TEST END OF TABLE                            
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLC   EIDACT,SVACTNUM     MATCH ON ACTION                              
         BE    *+14                                                             
         ICM   R0,3,EIDLN                                                       
         AR    R3,R0               BUMP TO NEXT ENTRY                           
         B     GEID02                                                           
         DROP  R3                                                               
*                                                                               
         LA    R3,EIDLN1Q(,R3)     SUB ELEMENTS                                 
         USING EIDSUB,R3                                                        
GEID04   CLI   EIDCTRY,CTRYALLQ    TEST ALL COUNTRIES                           
         BE    GEID06                                                           
         CLC   EIDCTRY,AGYCTRY     MATCH ON COUNTRY?                            
         BNE   GEID14                                                           
*                                                                               
GEID06   SR    RF,RF                                                            
         ICM   RF,1,EIDNLDG        RF=NUMBER OF LEDGERS IN THE LIST             
         BZ    GETEIDX             OK - ALL LEDGERS                             
         LA    RE,EIDLEDG          LIST OF LEDGERS                              
GEID08   CLI   1(RE),C' '          TEST UNIT ONLY?                              
         BH    GEID10                                                           
         CLC   0(1,RE),BASKEY      YES - COMPARE UNIT                           
         BE    GETEIDX                                                          
         B     *+14                                                             
GEID10   CLC   0(L'EIDLEDG,RE),BASKEY                                           
         BE    GETEIDX                                                          
         LA    RE,L'EIDLEDG(,RE)   NEXT UNIT/LEDGER                             
         BCT   RF,GEID08                                                        
*                                                                               
GEID14   LA    RF,EIDSLNQ          LENGTH OF SUB-ELEM WITHOUT LDG LIST          
         SR    RE,RE                                                            
         ICM   RE,1,EIDNLDG        NUMBER OF LEDGERS IN SUB-ELEM                
         BZ    GEID16                                                           
         SLL   RE,1                LENGTH OF LEDGER LIST                        
         AR    RF,RE                                                            
GEID16   AR    R3,RF               BUMP TO NEXT SUB-ELEM                        
         B     GEID04                                                           
         DROP  R3                                                               
*                                                                               
GETEIDX  ST    R3,0(,R1)           RETURN A(ENQUIRY ID NUMBER)                  
         J     ROUTE1              SET CC TO EQUAL                              
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
* MODULE TO BUILD GRID DETAIL OF REQUEST                              *         
* NTRY:      P1=(NEXT AVAILABLE SCREEN LINE)                          *         
*            P2=(L'ENQUIRY NAME,A(ENQUIRY NAME)                       *         
*            P3=(L'ACCOUNT EXTRA INFO),A(ACCOUNT EXTRA INFO)          *         
* EXIT:      R2=A(NEXT AVAILABLE SCREEN LINE)                         *         
*            'LINSUSED' UPDATED WITH NUMBER OF LINES USED             *         
* REGS USED: R2=A(PRINT LINES)                                        *         
*            R4=A(DOWNLOAD BLOCK)                                     *         
***********************************************************************         
         SPACE 1                                                                
UBLDDOR  NTR1  BASE=*,LABEL=*                                                   
         SR    RF,RF                                                            
         ICM   RF,1,4(R1)                                                       
         BNZ   *+6                                                              
         DC    H'0'                NO ENQUIRY NAME!                             
         STC   RF,BYTE1            SAVE LENGTH OF ENQUIRY NAME                  
*                                                                               
         MVI   BYTE2,0                                                          
         ICM   RF,1,8(R1)                                                       
         BZ    BDOR02              NO EXTRA ACCOUNT INFO.                       
         STC   RF,BYTE2            SAVE LENGTH OF ACCOUNT EXTRA INFO.           
         ST    R4,AACTINF          SAVE A(ACCOUNT EXTRA INFO.)                  
         MVI   GRDNDOR,0                                                        
*                                                                               
BDOR02   L     R4,ADLCB            BUILD DOWNLOAD CONTROL BLOCK                 
         USING DLCBD,R4                                                         
         XC    DLCBD(DLCBL),DLCBD                                               
         LA    RF,BDOR40           DUMMY PRINT RTN                              
         ST    RF,DLCBAPR                                                       
         ST    R2,DLCBAPL                                                       
         MVI   DLCBACT,DLCBINIT    INITIALIZE CALL                              
         GOTO1 VDLFLD,DLCBD                                                     
*                                                                               
         CLI   SVACTNUM,ACTNODLI                                                
         BE    BDOR09                   YES - NO ACCOUNT NAME                   
         CLI   SVACTNUM,ACTNRNSU                                                
         BE    BDOR09                                                           
         CLI   SVACTNUM,ACTNESTL                                                
         BE    BDOR09                                                           
*&&UK*&& CLI   SVACTNUM,ACTNAGPL                                                
*&&UK*&& BE    BDOR09                                                           
         MVC   WORK(L'IOKEY),IOKEY  SAVE KEY                                    
T        USING ACTRECD,IOKEY                                                    
         MVC   IOKEY,SPACES        READ ACCOUNT RECORD                          
         MVC   T.ACTKCPY,MYCO                                                   
         SR    RF,RF                                                            
         IC    RF,BASKEYH+5                                                     
         CHI   RF,2                                                             
         BNH   BDOR08A             NO ACCOUNT CODE                              
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   T.ACTKULA(0),BASKEY                                              
         DROP  T                                                                
         GOTO1 AIO,IOREAD+IOACCMST+IO2                                          
         BE    BDOR03                                                           
         TM    IOERR,IOMAX                                                      
         BNO   BDOR08A                                                          
         OI    DISPFLAG,DISIOMAX       TOO MANY IOS?                            
         B     BDORERRX                                                         
*                                                                               
BDOR03   L     RF,AIO2                                                          
         LA    RF,ACTRFST-ACTRECD(,RF) RF=A(FIRST ELEMENT)                      
         USING NAMELD,RF                                                        
         SR    RE,RE                                                            
BDOR04   CLI   NAMEL,EOR           END OF RECORD?                               
         BE    BDOR08A                                                          
         CLI   NAMEL,NAMELQ                                                     
         BE    *+14                                                             
         IC    RE,NAMLN                                                         
         AR    RF,RE                                                            
         B     BDOR04                                                           
*                                                                               
         MVI   TEMP,C' '               BUILD DETAIL OF REQUEST                  
         MVC   TEMP+1(L'TEMP-1),TEMP                                            
         MVC   TEMP(L'GRDACNM),GRDACNM TELL PC GRID TO PUT IT ON SCREEN         
         LA    R5,TEMP+L'GRDACNM                                                
         MVC   0(L'LC@ACC,R5),LC@ACC                                            
         LA    R5,L'LC@ACC-1(,R5)                                               
         CLI   0(R5),C' '          SKIP ALL SPACES                              
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   1(R5),C'='                                                       
*                                                                               
         IC    RE,NAMLN                                                         
         SHI   RE,NAMLN1Q+1                                                     
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   2(0,R5),NAMEREC                                                  
         LA    R5,2+1(RE,R5)                                                    
         DROP  RF                                                               
*                                                                               
         ICM   RE,1,BYTE2                                                       
         BZ    BDOR08              NO ACCOUNT EXTRA INFO.                       
         MVI   2(R5),C'/'                                                       
         BCTR  RE,0                                                             
         ICM   RF,15,AACTINF       A(ACCOUNT EXTRA INFO.)                       
         BNZ   *+6                                                              
         DC    H'0'                EMPTY!!!                                     
         EX    RE,*+8                                                           
         B     *+10                                                             
         MVC   4(0,R5),0(RF)       ACCOUNT EXTRA INFO.                          
         LA    R5,4+1(RE,R5)                                                    
         CLI   0(R5),C' '          SKIP ALL SPACES                              
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         LA    R5,1(,R5)                                                        
*                                                                               
BDOR08   LA    RE,TEMP                                                          
         SR    R5,RE               LENGTH OF DOWNLOAD LINE                      
         BAS   RE,BDORTXT                                                       
*                                                                               
BDOR08A  MVC   IOKEY,WORK          REESTABLISH SEQ                              
         GOTO1 AIO,IOREAD+IOACCDIR+IO1                                          
         BE    BDOR09                                                           
         TM    IOERR,IOMAX             TOO MANY IOS?                            
         BO    *+6                                                              
         DC    H'0'                                                             
         OI    DISPFLAG,DISIOMAX                                                
         B     BDORERRX                                                         
*                                                                               
BDOR09   MVI   TEMP,C' '                                                        
         MVC   TEMP+1(L'TEMP-1),TEMP                                            
         SR    RF,RF                                                            
         IC    RF,BYTE1            RF=LENGTH OF ENQUIRY NAME                    
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   TEMP(0),0(R3)       MOVE IN ENQUIRY NAME                         
         LA    R5,TEMP                                                          
         AR    R5,RF                                                            
         CLI   0(R5),C' '          FIND LAST CHAR                               
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         CLI   SVACTNUM,ACTNRNSU   RE ACTION?                                   
         BE    *+8                 NO                                           
         CLI   SVACTNUM,ACTNESTL   EL ACTION?                                   
         BE    *+8                 NO                                           
         CLI   SVACTNUM,ACTNAGPL   AG ACTION?                                   
         BNE   *+12                NO                                           
         LA    R5,2(,R5)                                                        
         B     BDOR09A                                                          
*                                                                               
         MVC   2(L'LC@ON,R5),LC@ON                                              
         CLI   SVACTNUM,ACTNODLI                                                
         BNE   *+18                                                             
         MVC   2+L'LC@ON(L'LC@ORDER,R5),LC@ORDER                                
         LA    R5,2+L'LC@ON+L'LC@ORDER-1(,R5)                                   
         B     BDOR09A                                                          
*                                                                               
         MVC   2+L'LC@ON(L'LC@ACC,R5),LC@ACC                                    
         MVC   2+L'LC@ON(L'LC@ACC,R5),LC@ACC                                    
         LA    R5,2+L'LC@ON+L'LC@ACC-1(,R5)                                     
BDOR09A  CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,1,BASKEYH+5                                                   
         BNZ   BDOR10                                                           
         MVI   1(R5),C'='                                                       
         MVC   2(L'LC@NONE,R5),LC@NONE NO KEY                                   
         LA    R5,2+L'LC@NONE(,R5)                                              
         B     BDOR11                                                           
*                                                                               
BDOR10   BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   2(0,R5),BASKEY                                                   
         LA    R5,2(RF,R5)                                                      
BDOR11   CLI   0(R5),C' '          SKIP ALL SPACES                              
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         LA    R5,2(,R5)                                                        
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,1,BASCACH+5      TEST ANY CONTRA A/C?                         
         BZ    BDOR12                                                           
         MVC   0(L'LC@AND,R5),LC@AND                                            
         LA    R5,L'LC@AND-1(,R5)                                               
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVC   2(L'LC@CTRA,R5),LC@CTRA                                          
         LA    R5,2+L'LC@CTRA-1(,R5)                                            
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   2(0,R5),BASCAC                                                   
         LA    R5,2+1+1(RF,R5)                                                  
*                                                                               
BDOR12   MVC   0(L'LC@WITH,R5),LC@WITH                                          
         LA    R5,L'LC@WITH-1(,R5)                                              
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVC   2(L'LC@OPTS,R5),LC@OPTS                                          
         LA    R5,2+L'LC@OPTS-1(,R5)                                            
         CLI   0(R5),C' '                                                       
         BH    *+8                                                              
         BCT   R5,*-8                                                           
         MVI   1(R5),C'='                                                       
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,1,BASOPTH+5                                                   
         BNZ   BDOR16                                                           
         MVC   2(L'LC@NONE,R5),LC@NONE NO OPTIONS                               
         LA    R5,2+L'LC@NONE(,R5)                                              
         B     BDOR20                                                           
*                                                                               
BDOR16   BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   2(0,R5),BASOPT                                                   
         LA    R5,2+1(RF,R5)                                                    
*                                                                               
BDOR20   LA    RE,TEMP                                                          
         SR    R5,RE               R5=LENGTH OF FIELD                           
         BAS   RE,BDORTXT          BUILD OPTION DOWNLOAD LINE                   
         B     BLDDORX                                                          
*                                                                               
BDOR40   L     RF,DLCBAPL          BUMP TO NEXT SCREEN LINE                     
         LA    RF,L'DUMLIN1(,RF)                                                
         ST    RF,DLCBAPL                                                       
         BR    RE                                                               
*                                                                               
BLDDORX  MVI   DLCBACT,DLCBEOL     END OF HEADING TEXT LINE                     
         GOTO1 VDLFLD,DLCBD                                                     
         L     RF,DLCBTOTL                                                      
         STC   RF,LINSUSED         NUMBER OF PRINT LINES                        
         STC   RF,GRDNDOR          NUMBER OF DETAIL OF REQ. LINES               
         L     R2,DLCBAPL          NEXT AVAILABLE SCREEN LINE                   
         J     ROUTE1                                                           
*                                                                               
BDORERRX J     ROUTH1                                                           
GRDACNM  DC    C'***S'                                                          
         SPACE 2                                                                
***********************************************************************         
*        BUILD DOWNLOAD DATA                                          *         
* ON ENTRY     R2=A(DUMMY SCREEN LINES)                               *         
*              R4=A(DOWNLOAD BLOCK)                                   *         
*              R5=LENGTH OF TEXT DATA                                 *         
*              TEMP=TEXT DATA UPTO 74 CHARACTERS                      *         
***********************************************************************         
         SPACE 2                                                                
BDORTXT  LR    R0,RE                                                            
         MVI   DLCBACT,DLCBPUT                                                  
         MVI   DLCBTYP,DLCBTXT                                                  
         CHI   R5,L'DLCBFLD                                                     
         BH    *+14                                                             
         MVC   DLCBFLD,TEMP                                                     
         B     BDTXTP              PUT TEXT INTO DOWNLOAD BLOCK                 
*                                                                               
         CHI   R5,L'DUMLIN1-4      MAKE SURE IT'S NOT TOO LONG                  
         BH    BDTXT06             YES - DON'T CALL DLFLD                       
         OI    DLCBFLG1,DLCBFXFL   IF CAN'T FIX IN DLCBFLD,                     
         MVC   DLCBFLX,TEMP        MOVE DATA TO EXTENDED FIELD                  
         B     BDTXTP                                                           
*                                                                               
BDTXT06  L     RE,DLCBAPL          CURRENT DOWNLOAD PRINT LINES                 
         AH    RE,DLCBNUMC         RE=A(NEXT AVAIL CHR IN PRINT LINE)           
         MVI   0(RE),C'"'                                                       
         LR    RF,R5                                                            
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         MVC   1(0,RE),TEMP        MOVE IN FIELD                                
         LA    RE,1+1(RF,RE)       END OF FIELD                                 
         MVI   0(RE),C'"'                                                       
         L     RF,DLCBAPL          CURRENT DOWNLOAD PRINT LINES                 
         SR    RE,RF                                                            
         LA    RE,2(,RE)           TOTAL LENGTH FROM START OF LINE              
         L     RF,DLCBTOTC         BUMP TOTAL NUMBER OF CHARS                   
         AR    RF,RE                                                            
         ST    RF,DLCBTOTC                                                      
         SRDL  RE,32                                                            
         D     RE,=A(L'DUMLIN1)                                                 
         STH   RE,DLCBNUMC         BUMP NUM OF CHARS THIS LINE                  
         MVC   DLCBNUMF,=H'1'      BUMP NUM OF FIELDS THIS LINE                 
         L     RE,DLCBTOTL         BUMP TOTAL NUMBER OF LINES                   
         AR    RE,RF                                                            
         ST    RE,DLCBTOTL                                                      
         MHI   RF,L'DUMLIN1                                                     
         L     RE,DLCBAPL          BUMP NUM OF DOWNLOAD PRINT LINES             
         AR    RE,RF                                                            
         ST    RE,DLCBAPL                                                       
         B     BDTXTX                                                           
*                                                                               
BDTXTP   STC   R5,DLCBLEN          LENGTH OF FIELD                              
         GOTO1 VDLFLD,DLCBD                                                     
         NI    DLCBFLG1,X'FF'-DLCBFXFL                                          
         B     BDTXTX                                                           
*                                                                               
BDTXTX   MVI   DLCBACT,DLCBEOL     END OF HEADING TEXT LINE                     
         GOTO1 VDLFLD,DLCBD                                                     
         LR    RE,R0                                                            
         BR    RE                                                               
         DROP  R4                                                               
         EJECT ,                                                                
         LTORG                                                                  
         DROP  RB                                                               
         EJECT                                                                  
**********************************************************************          
*        TABLES                                                                 
**********************************************************************          
PFKTAB   DS    0X                  PFKEY TABLE COVERED BY PFKTABD               
*                                                                               
         DC    AL1(PF1,PFKSWACT+PFKGRONQ)                                       
         DC    AL1(ACT2ALLQ,ACTNLIST),AL2(UP@LISTS-WORKD)                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNCONT,ACTNDETL,ACTNSTMT,ACTNDTOF,ACTNETIM)                
         DC    AL1(ACTNJBBL,ACTNJBDE,ACTNJBST,ACTNLSLT,ACTNMNTH)                
         DC    AL1(ACTNNBUD,ACTNODDE,ACTNSTOF,ACTNODSM,ACTNMNOF)                
         DC    AL1(ACTNRAGE,ACTNVEND,ACTNOFMN,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF2,PFKSWACT+PFKGRONQ)                                       
         DC    AL1(ACT2NSJQ,ACTNDETL),AL2(UP@DTLS-WORKD)                        
         DC    AL1(ACT2PROQ,ACTNJBDE),AL2(UP@JBDTS-WORKD)                       
         DC    AL1(ACTNLIST,ACTNRNSU,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF3,PFKSWACT+PFKGRONQ+PFKOFF2Q)                              
         DC    AL1(ACT2NSJQ,ACTNDTOF),AL2(UP@DTOFS-WORKD)                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNLIST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF4,PFKSWACT+PFKGRONQ)                                       
         DC    AL1(ACT2CRDQ,ACTNVEND),AL2(UP@CROS-WORKD)                        
         DC    AL1(ACT2PROQ,ACTNJBST),AL2(UP@JBSTS-WORKD)                       
         DC    AL1(ACTNLIST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF5,PFKSWACT+PFKGRONQ)                                       
         DC    AL1(ACT2ALLQ,ACTNVICF),AL2(UP@VNDCF-WORKD)                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNJBCF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF6,PFKGLOBQ)                                                
         DC    AL1(0,0),AL2(LC@INPUT-WORKD)                                     
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNCONT,ACTNDETL,ACTNSTMT,ACTNJBES,ACTNETIM)                
         DC    AL1(ACTNJBBL,ACTNJBDE,ACTNJBST,ACTNLSLT,ACTNMNTH)                
         DC    AL1(ACTNNBUD,ACTNODDE,ACTNODLI,ACTNODSM,ACTNRECV)                
         DC    AL1(ACTNLIST,ACTNRAGE,ACTNVEND,ACTNDTOF,ACTNSTOF)                
         DC    AL1(ACTNMNOF,ACTNOFMN,0,0,0)                                     
*                                                                               
         DC    AL1(PF7,PFKNGRDQ)                                                
         DC    AL1(0,0),AL2(LC@UP-WORKD)                                        
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNCONT,ACTNDETL,ACTNSTMT,ACTNJBES,ACTNETIM)                
         DC    AL1(ACTNJBBL,ACTNJBDE,ACTNJBST,ACTNLSLT,ACTNMNTH)                
         DC    AL1(ACTNNBUD,ACTNODDE,ACTNODLI,ACTNODSM,ACTNRECV)                
         DC    AL1(ACTNLIST,ACTNRAGE,ACTNVEND,ACTNDTOF,ACTNSTOF)                
         DC    AL1(ACTNMNOF,ACTNOFMN,ACTNRNSU,ACTNESTL,ACTNESTD)                
*                                                                               
         DC    AL1(PF8,PFKNGRDQ)                                                
         DC    AL1(0,0),AL2(LC@DOWN-WORKD)                                      
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNCONT,ACTNDETL,ACTNSTMT,ACTNJBES,ACTNETIM)                
         DC    AL1(ACTNJBBL,ACTNJBDE,ACTNJBST,ACTNLSLT,ACTNMNTH)                
         DC    AL1(ACTNNBUD,ACTNODDE,ACTNODLI,ACTNODSM,ACTNRECV)                
         DC    AL1(ACTNLIST,ACTNRAGE,ACTNVEND,ACTNDTOF,ACTNSTOF)                
         DC    AL1(ACTNMNOF,ACTNOFMN,ACTNRNSU,ACTNESTL,ACTNESTD)                
*                                                                               
         DC    AL1(PF9,PFKNGRDQ)                                                
         DC    AL1(0,0),AL2(LC@LEFT-WORKD)                                      
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNCRED,ACTNVEND,ACTNPFLS,ACTNCRED,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF10,PFKNGRDQ)                                               
         DC    AL1(0,0),AL2(LC@RIGHT-WORKD)                                     
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNCRED,ACTNVEND,ACTNPFLS,ACTNCRED,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF11,PFKRTNLI)                                               
         DC    AL1(0,0),AL2(LC@NXT-WORKD)                                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNCONT,ACTNDETL,ACTNVEND,ACTNJBES,ACTNETIM)                
         DC    AL1(ACTNJBBL,ACTNJBDE,ACTNJBST,ACTNMNTH,ACTNNBUD)                
         DC    AL1(ACTNODDE,ACTNODSM,ACTNRECV,ACTNSTMT,ACTNPFLS)                
         DC    AL1(ACTNMNOF,ACTNOFMN,ACTNRAGE,ACTNSTOF,ACTNDTOF)                
         DC    AL1(ACTNLIST,0,0,0,0)                                            
*                                                                               
         DC    AL1(PF12,PFKRTNLI)                                               
         DC    AL1(0,0),AL2(LC@RETRN-WORKD)                                     
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNCONT,ACTNDETL,ACTNVEND,ACTNJBES,ACTNETIM)                
         DC    AL1(ACTNJBBL,ACTNJBDE,ACTNJBST,ACTNMNTH,ACTNNBUD)                
         DC    AL1(ACTNODDE,ACTNODSM,ACTNRECV,ACTNSTMT,ACTNPFLS)                
         DC    AL1(ACTNMNOF,ACTNOFMN,ACTNRAGE,ACTNSTOF,ACTNDTOF)                
         DC    AL1(ACTNLIST,0,0,0,0)                                            
*                                                                               
         DC    AL1(PF13,PFKSWACT+PFKGRONQ)                                      
         DC    AL1(ACT2ALLQ,ACTNJBCF),AL2(UP@JOBCF-WORKD)                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNVICF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF14,PFKSWACT+PFKGRONQ)                                      
         DC    AL1(ACT2NSJQ,ACTNRAGE),AL2(UP@AGEIS-WORKD)                       
         DC    AL1(ACT2PROQ,ACTNODDE),AL2(UP@ODDES-WORKD)                       
         DC    AL1(ACTNLIST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF15,PFKSWACT+PFKGRONQ)                                      
         DC    AL1(ACT2NSJQ,ACTNSTMT),AL2(UP@STMTS-WORKD)                       
         DC    AL1(ACT2PROQ,ACTNODSM),AL2(UP@ODSMS-WORKD)                       
         DC    AL1(ACTNLIST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF16,PFKSWACT+PFKGRONQ+PFKOFF2Q)                             
         DC    AL1(ACT2NSJQ,ACTNSTOF),AL2(UP@STOFS-WORKD)                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNLIST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF17,PFKSWACT+PFKGRONQ)                                      
         DC    AL1(ACT2ALLQ,ACTNMNTH),AL2(UP@MNTHS-WORKD)                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNLIST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF18,PFKSWACT+PFKGRONQ+PFKOFF2Q)                             
         DC    AL1(ACT2ALLQ,ACTNMNOF),AL2(UP@MNOFS-WORKD)                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNLIST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(PF19,PFKSWACT+PFKGRONQ+PFKOFF2Q)                             
         DC    AL1(ACT2ALLQ,ACTNOFMN),AL2(UP@OFFMS-WORKD)                       
         DC    AL1(0,0),AL2(0)                                                  
         DC    AL1(ACTNLIST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    AL1(EOT)                                                         
         EJECT                                                                  
**********************************************************************          
* FIS TYPE ID NUMBERS TABLE                                                     
**********************************************************************          
EIDTAB   DS    0X                  FIS ID TABLE COVERED BY EIDTABD              
*                                                                               
EIDVE    DC    AL1(ACTNVEND),AL2(EIDVELQ)   VENDOR                              
*        DC    C'011',AL1(CTRYUSA,1),C'SF'                                      
*        DC    C'012',AL1(CTRYUSA,1),C'SQ'                                      
*        DC    C'013',AL1(CTRYUSA,1),C'ST'                                      
*        DC    C'014',AL1(CTRYUSA,1),C'SV'                                      
*        DC    C'015',AL1(CTRYUSA,1),C'SX'                                      
*        DC    C'010',AL1(CTRYUSA,EIDALDGQ)                                     
         DC    C'011',AL1(CTRYALLQ,1),C'SF'                                     
         DC    C'012',AL1(CTRYALLQ,1),C'SQ'                                     
         DC    C'013',AL1(CTRYALLQ,1),C'ST'                                     
         DC    C'014',AL1(CTRYALLQ,1),C'SV'                                     
         DC    C'015',AL1(CTRYALLQ,1),C'SX'                                     
         DC    C'010',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDVELQ  EQU   *-EIDVE                                                          
*                                                                               
EIDDET   DC    AL1(ACTNDETL),AL2(EIDDETLQ)  DETAIL                              
         DC    C'021',AL1(CTRYALLQ,1),C'GB'                                     
         DC    C'022',AL1(CTRYALLQ,1),C'GP'                                     
         DC    C'023',AL1(CTRYALLQ,1),C'SA'                                     
         DC    C'024',AL1(CTRYALLQ,1),C'SB'                                     
         DC    C'025',AL1(CTRYALLQ,1),C'SC'                                     
         DC    C'026',AL1(CTRYALLQ,1),C'SE'                                     
         DC    C'027',AL1(CTRYALLQ,1),C'SF'                                     
         DC    C'028',AL1(CTRYALLQ,1),C'SG'                                     
         DC    C'029',AL1(CTRYALLQ,1),C'SI'                                     
         DC    C'02A',AL1(CTRYALLQ,1),C'SK'                                     
         DC    C'02B',AL1(CTRYALLQ,1),C'SQ'                                     
         DC    C'02C',AL1(CTRYALLQ,1),C'SR'                                     
         DC    C'02D',AL1(CTRYALLQ,1),C'ST'                                     
         DC    C'02E',AL1(CTRYALLQ,1),C'SV'                                     
         DC    C'02F',AL1(CTRYALLQ,1),C'SX'                                     
         DC    C'02G',AL1(CTRYALLQ,1),C'SZ'                                     
         DC    C'02H',AL1(CTRYALLQ,1),C'S9'                                     
         DC    C'02I',AL1(CTRYALLQ,1),C'1C'                                     
         DC    C'02J',AL1(CTRYALLQ,1),C'1P'                                     
         DC    C'02K',AL1(CTRYALLQ,1),C'1N'                                     
         DC    C'02L',AL1(CTRYALLQ,1),C'11'                                     
         DC    C'02M',AL1(CTRYALLQ,1),C'12'                                     
         DC    C'02N',AL1(CTRYALLQ,1),C'13'                                     
         DC    C'02O',AL1(CTRYALLQ,1),C'14'                                     
         DC    C'02P',AL1(CTRYALLQ,1),C'15'                                     
         DC    C'02Q',AL1(CTRYALLQ,1),C'2D'                                     
         DC    C'02R',AL1(CTRYALLQ,1),C'2P'                                     
         DC    C'02S',AL1(CTRYALLQ,1),C'28'                                     
         DC    C'02T',AL1(CTRYALLQ,1),C'29'                                     
         DC    C'02U',AL1(CTRYALLQ,1),C'41'                                     
         DC    C'020',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDDETLQ EQU   *-EIDDET                                                         
*                                                                               
EIDDF    DC    AL1(ACTNDTOF),AL2(EIDDFLQ)    DETAIL BY OFFICE                   
         DC    C'2F1',AL1(CTRYALLQ,1),C'GB'                                     
         DC    C'2F2',AL1(CTRYALLQ,1),C'GP'                                     
         DC    C'2F3',AL1(CTRYALLQ,1),C'SA'                                     
         DC    C'2F4',AL1(CTRYALLQ,1),C'SB'                                     
         DC    C'2F5',AL1(CTRYALLQ,1),C'SC'                                     
         DC    C'2F6',AL1(CTRYALLQ,1),C'SE'                                     
         DC    C'2F7',AL1(CTRYALLQ,1),C'SF'                                     
         DC    C'2F8',AL1(CTRYALLQ,1),C'SG'                                     
         DC    C'2F9',AL1(CTRYALLQ,1),C'SI'                                     
         DC    C'2FA',AL1(CTRYALLQ,1),C'SK'                                     
         DC    C'2FB',AL1(CTRYALLQ,1),C'SQ'                                     
         DC    C'2FC',AL1(CTRYALLQ,1),C'SR'                                     
         DC    C'2FD',AL1(CTRYALLQ,1),C'ST'                                     
         DC    C'2FE',AL1(CTRYALLQ,1),C'SV'                                     
         DC    C'2FF',AL1(CTRYALLQ,1),C'SX'                                     
         DC    C'2FG',AL1(CTRYALLQ,1),C'SZ'                                     
         DC    C'2FH',AL1(CTRYALLQ,1),C'S9'                                     
         DC    C'2FI',AL1(CTRYALLQ,1),C'1C'                                     
         DC    C'2FJ',AL1(CTRYALLQ,1),C'1P'                                     
         DC    C'2FK',AL1(CTRYALLQ,1),C'1N'                                     
         DC    C'2FL',AL1(CTRYALLQ,1),C'11'                                     
         DC    C'2FM',AL1(CTRYALLQ,1),C'12'                                     
         DC    C'2FN',AL1(CTRYALLQ,1),C'13'                                     
         DC    C'2FO',AL1(CTRYALLQ,1),C'14'                                     
         DC    C'2FP',AL1(CTRYALLQ,1),C'15'                                     
         DC    C'2FQ',AL1(CTRYALLQ,1),C'2D'                                     
         DC    C'2FR',AL1(CTRYALLQ,1),C'2P'                                     
         DC    C'2FS',AL1(CTRYALLQ,1),C'28'                                     
         DC    C'2FT',AL1(CTRYALLQ,1),C'29'                                     
         DC    C'2FU',AL1(CTRYALLQ,1),C'41'                                     
         DC    C'2F0',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDDFLQ  EQU   *-EIDDF                                                          
*                                                                               
EIDMO    DC    AL1(ACTNMNTH),AL2(EIDMOLQ)    MONTHLY                            
         DC    C'031',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDMOLQ  EQU   *-EIDMO                                                          
*                                                                               
EIDMF    DC    AL1(ACTNMNOF),AL2(EIDMFLQ)    MONTHLY BY OFFICE                  
         DC    C'03A',AL1(CTRYALLQ,1),C'SJ'                                     
         DC    C'032',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDMFLQ  EQU   *-EIDMF                                                          
*                                                                               
EIDFM    DC    AL1(ACTNOFMN),AL2(EIDFMLQ)    OFFICE BY MONTH                    
         DC    C'03B',AL1(CTRYALLQ,1),C'SJ'                                     
         DC    C'033',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDFMLQ  EQU   *-EIDFM                                                          
*                                                                               
EIDLO    DC    AL1(ACTNLIST),AL2(EIDLOLQ)    LIST                               
         DC    C'051',AL1(CTRYALLQ,1),C'SJ'                                     
         DC    C'050',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDLOLQ  EQU   *-EIDLO                                                          
*                                                                               
EIDJD    DC    AL1(ACTNJBDE),AL2(EIDJDLQ)    JOB DETAILS                        
         DC    C'060',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDJDLQ  EQU   *-EIDJD                                                          
*                                                                               
EIDRE    DC    AL1(ACTNRECV),AL2(EIDRELQ)    RECEIVABLES                        
         DC    C'07A',AL1(CTRYALLQ,1),C'SR'                                     
         DC    C'070',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDRELQ  EQU   *-EIDRE                                                          
*                                                                               
EIDAG    DC    AL1(ACTNRAGE),AL2(EIDAGLQ)    AGEING                             
         DC    C'08A',AL1(CTRYALLQ,1),C'SR'                                     
         DC    C'080',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDAGLQ  EQU   *-EIDAG                                                          
*                                                                               
EIDST    DC    AL1(ACTNSTMT),AL2(EIDSTLQ)    STATEMENT                          
         DC    C'091',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDSTLQ  EQU   *-EIDST                                                          
*                                                                               
EIDSF    DC    AL1(ACTNSTOF),AL2(EIDSFLQ)    STATEMENT BY OFFICE                
         DC    C'092',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDSFLQ  EQU   *-EIDSF                                                          
*                                                                               
EIDJS    DC    AL1(ACTNJBST),AL2(EIDJSLQ)    JOB STATEMENT                      
         DC    C'093',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDJSLQ  EQU   *-EIDJS                                                          
*                                                                               
EIDCL    DC    AL1(ACTNCONT),AL2(EIDCLLQ)    CONTRA LIST                        
         DC    C'100',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDCLLQ  EQU   *-EIDCL                                                          
*                                                                               
EIDJB    DC    AL1(ACTNJBBL),AL2(EIDJBLQ)    JOB BILLING                        
         DC    C'110',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDJBLQ  EQU   *-EIDJB                                                          
*                                                                               
EIDET    DC    AL1(ACTNETIM),AL2(EIDETLQ)    ESTIMATED TIME                     
         DC    C'120',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDETLQ  EQU   *-EIDET                                                          
*                                                                               
EIDJE    DC    AL1(ACTNJBES),AL2(EIDJELQ)    JOB ESTIMATES                      
         DC    C'0B0',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDJELQ  EQU   *-EIDJE                                                          
*                                                                               
EIDOD    DC    AL1(ACTNODDE),AL2(EIDODLQ)    ORDER DETAIL                       
         DC    C'0C0',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDODLQ  EQU   *-EIDOD                                                          
*                                                                               
EIDOL    DC    AL1(ACTNODLI),AL2(EIDOLLQ)    ORDER LIST                         
         DC    C'0D0',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDOLLQ  EQU   *-EIDOL                                                          
*                                                                               
EIDOS    DC    AL1(ACTNODSM),AL2(EIDOSLQ)    ORDER SUMMARY                      
         DC    C'0E0',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDOSLQ  EQU   *-EIDOS                                                          
*                                                                               
EIDBU    DC    AL1(ACTNNBUD),AL2(EIDBULQ)    BUDGETS                            
         DC    C'0F0',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDBULQ  EQU   *-EIDBU                                                          
*                                                                               
EIDIC    DC    AL1(ACTNVICF),AL2(EIDICLQ)    VENDOR CASHFLOW                    
         DC    C'140',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDICLQ  EQU   *-EIDIC                                                          
                                                                                
EIDJC    DC    AL1(ACTNJBCF),AL2(EIDJCLQ)    JOB CASHFLOW                       
         DC    C'150',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDJCLQ  EQU   *-EIDJC                                                          
*                                                                               
EIDRSN   DC    AL1(ACTNRNSU),AL2(EIDRSNLQ)   REF NO SEARCH                      
         DC    C'200',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDRSNLQ EQU   *-EIDRSN                                                         
*                                                                               
EIDCLM   DC    AL1(ACTNCLMS),AL2(EIDCLMLQ)   EXP. CLAIMS                        
         DC    C'210',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDCLMLQ EQU   *-EIDCLM                                                         
*                                                                               
EIDMEL   DC    AL1(ACTNESTL),AL2(EIDMELLQ)   ESTIMATE LIST                      
         DC    C'220',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDMELLQ EQU   *-EIDMEL                                                         
*                                                                               
EIDMED   DC    AL1(ACTNESTD),AL2(EIDMEDLQ)   ESTIMATE DETAILS                   
         DC    C'230',AL1(CTRYALLQ,EIDALDGQ)                                    
EIDMEDLQ EQU   *-EIDMED                                                         
*                                                                               
         DC    AL1(EOT)                                                         
*                                                                               
**********************************************************************          
*        ACTION TABLE                                                           
**********************************************************************          
ACTTAB   DS    0X                  ACTION TABLE COVERED BY ACTTABD              
*---------------------------------------------*                                 
*** USA ***                                   *                                 
*---------------------------------------------*                                 
         DC    AL1(ACTNVEND,CTRYUSA)              VENDORS                       
         DC    AL2(UP@CROS-WORKD,UP@CROS-WORKD)                                 
         DC    AL2(0,0,0,0)                                                     
         DC    X'01'                                                            
         DC    AL1(ACTGRIDQ,ACT2CRDQ+ACT2LOWQ)                                  
*                                                                               
         DC    AL1(ACTNDTOF,CTRYUSA)              DETAIL BY OFFICE              
         DC    AL2(UP@DTOFS-WORKD,UP@DTOFS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'02'                                                            
         DC    AL1(ACTC2CHQ+ACTGRIDQ,ACT2NSJQ+ACT2LOWQ)                         
*                                                                               
         DC    AL1(ACTNOFMN,CTRYUSA)              OFFICE BY MONTH               
         DC    AL2(UP@OFFMS-WORKD,UP@OFFMS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'03'                                                            
         DC    AL1(ACTC2CHQ+ACTGRIDQ,ACT2ALLQ+ACT2LOWQ)                         
*                                                                               
*        DC    AL1(ACTNRECV,CTRYUSA)              RECEIVABLES                   
*        DC    AL2(UP@RCVS-WORKD,UP@RCVS-WORKD)                                 
*        DC    AL2(0,0,0,0)                                                     
*        DC    X'07'                                                            
*        DC    AL1(ACTCORDQ+ACTGRIDQ,ACT2RECQ+ACT2LOWQ+ACT2NULQ)                
*---------------------------------------------*                                 
* CANADA                                      *                                 
*---------------------------------------------*                                 
         DC    AL1(ACTNVEND,CTRYCAN)              VENDORS                       
         DC    AL2(UP@CROS-WORKD,UP@CROS-WORKD)                                 
         DC    AL2(0,0,0,0)                                                     
         DC    X'01'                                                            
         DC    AL1(ACTGRIDQ,ACT2CRDQ+ACT2LOWQ)                                  
*                                                                               
         DC    AL1(ACTNDTOF,CTRYCAN)              DETAIL BY OFFICE              
         DC    AL2(UP@DTOFS-WORKD,UP@DTOFS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'02'                                                            
         DC    AL1(ACTC2CHQ+ACTGRIDQ,ACT2NSJQ+ACT2LOWQ)                         
*                                                                               
         DC    AL1(ACTNOFMN,CTRYCAN)              OFFICE BY MONTH               
         DC    AL2(UP@OFFMS-WORKD,UP@OFFMS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'03'                                                            
         DC    AL1(ACTC2CHQ+ACTGRIDQ,ACT2ALLQ+ACT2LOWQ)                         
*                                                                               
*        DC    AL1(ACTNRECV,CTRYCAN)              RECEIVABLES                   
*        DC    AL2(UP@RCVS-WORKD,UP@RCVS-WORKD)                                 
*        DC    AL2(0,0,0,0)                                                     
*        DC    X'07'                                                            
*        DC    AL1(ACTCORDQ+ACTGRIDQ,ACT2RECQ+ACT2LOWQ+ACT2NULQ)                
*                                                                               
*-----------------------------------------------*                               
* ALL                                           *                               
*-----------------------------------------------*                               
         DC    AL1(ACTNCRED,CTRYNOTQ+CTRYUSA)     CREDITORS                     
         DC    AL2(UP@CROS-WORKD,UP@CROS-WORKD)                                 
         DC    AL2(0,0,0,0)                                                     
         DC    X'01'                                                            
         DC    AL1(0,ACT2CRDQ+ACT2LOWQ)                                         
*                                                                               
         DC    AL1(ACTNDETL,CTRYALLQ)             DETAIL                        
         DC    AL2(UP@DTLS-WORKD,UP@DTLS-WORKD)                                 
         DC    AL2(0,0,0,0)                                                     
         DC    X'02'                                                            
         DC    AL1(ACTCORDQ+ACTGRIDQ,ACT2NSJQ+ACT2LOWQ)                         
*                                                                               
         DC    AL1(ACTNMNTH,CTRYALLQ)             MONTHLY                       
         DC    AL2(UP@MNTHS-WORKD,UP@MNTHS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'03'                                                            
         DC    AL1(ACTGRIDQ,ACT2ALLQ+ACT2LOWQ)                                  
*                                                                               
         DC    AL1(ACTNMNOF,CTRYALLQ)             MONTH BY OFFICE               
         DC    AL2(UP@MNOFS-WORKD,UP@MNOFS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'03'                                                            
         DC    AL1(ACTC2CHQ+ACTGRIDQ,ACT2ALLQ+ACT2LOWQ)                         
*                                                                               
         DC    AL1(ACTNPFLS,CTRYNOTQ+CTRYUSA)     PROFIT AND LOSS               
         DC    AL2(UP@PFTLS-WORKD,UP@PFTLS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'04'                                                            
         DC    AL1(ACTCORDQ,0)                                                  
*                                                                               
         DC    AL1(ACTNLIST,CTRYALLQ)             LIST                          
         DC    AL2(UP@LISTS-WORKD,UP@LISTS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'05'                                                            
         DC    AL1(ACTGRIDQ,ACT2ALLQ+ACT2LSTQ)                                  
*                                                                               
         DC    AL1(ACTNJBDE,CTRYALLQ)             JOB DETAIL                    
         DC    AL2(UP@JBDTS-WORKD,UP@JBDTS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'06'                                                            
         DC    AL1(ACTGRIDQ,ACT2PROQ+ACT2LOWQ+ACT2NULQ)                         
*                                                                               
*        DC    AL1(ACTNDEBT,CTRYNOTQ+CTRYUSA) DEBTORS                           
*        DC    AL2(UP@RCVS-WORKD,UP@RCVS-WORKD)                                 
*        DC    AL2(0,0,0,0)                                                     
*        DC    X'07'                                                            
*        DC    AL1(0,ACT2RECQ+ACT2LOWQ)                                         
*                                                                               
         DC    AL1(ACTNRAGE,CTRYALLQ)             AGING (RECV AND PAYA)         
         DC    AL2(UP@AGEIS-WORKD,UP@AGEIS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'08'                                                            
         DC    AL1(ACTCORDQ+ACTGRIDQ,ACT2RECQ+ACT2CRDQ+ACT2LOWQ)                
*                                                                               
         DC    AL1(ACTNSTMT,CTRYALLQ)             STATEMENT                     
         DC    AL2(UP@STMTS-WORKD,UP@STMTS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'09'                                                            
         DC    AL1(ACTCORDQ+ACTGRIDQ,ACT2NSJQ+ACT2LOWQ)                         
*                                                                               
         DC    AL1(ACTNSTOF,CTRYALLQ)             STATEMENT BY OFFICE           
         DC    AL2(UP@STOFS-WORKD,UP@STOFS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'09'                                                            
         DC    AL1(ACTC2CHQ+ACTGRIDQ,ACT2NSJQ+ACT2LOWQ)                         
*                                                                               
         DC    AL1(ACTNJBST,CTRYALLQ)             JOB STATEMENT                 
         DC    AL2(UP@JBSTS-WORKD,UP@JBSTS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'09'                                                            
         DC    AL1(ACTGRIDQ,ACT2PROQ+ACT2LOWQ+ACT2NULQ)                         
*                                                                               
         DC    AL1(ACTNCONT,CTRYALLQ)             CONTRA LIST                   
         DC    AL2(UP@CTRLS-WORKD,UP@CTRLS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'10'                                                            
         DC    AL1(ACTCORDQ+ACTGRIDQ,ACT2NSJQ+ACT2LOWQ)                         
*                                                                               
         DC    AL1(ACTNJBBL,CTRYALLQ)             JOB BILLING                   
         DC    AL2(UP@JBBLS-WORKD,UP@JBBLS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'11'                                                            
         DC    AL1(ACTGRIDQ,ACT2PROQ+ACT2LOWQ+ACT2NULQ)                         
*                                                                               
         DC    AL1(ACTNETIM,CTRYALLQ)             ESTIMATED TIME                
         DC    AL2(UP@ESTMS-WORKD,UP@ESTMS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'12'                                                            
         DC    AL1(ACTDDSQ+ACTGRIDQ,ACT2PROQ+ACT2LOWQ+ACT2NULQ)                 
*                                                                               
         DC    AL1(ACTNLSLT,CTRYALLQ)             LIST/SELECT                   
         DC    AL2(UP@LISEL-WORKD,UP@LISEL-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'13'                                                            
         DC    AL1(0,ACT2ALLQ+ACT2LSTQ)                                         
*                                                                               
         DC    AL1(ACTNJBES,CTRYALLQ)             JOB ESTIMATE                  
         DC    AL2(UP@JBESS-WORKD,UP@JBESS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'0B'                                                            
         DC    AL1(ACTGRIDQ,ACT2PROQ+ACT2LSTQ+ACT2NULQ)                         
*                                                                               
         DC    AL1(ACTNODDE,CTRYALLQ)             ORDER DETAIL                  
         DC    AL2(UP@ODDES-WORKD,UP@ODDES-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'0C'                                                            
         DC    AL1(ACTGRIDQ,ACT2PROQ+ACT2EXPQ+ACT2LOWQ)                         
*                                                                               
         DC    AL1(ACTNODLI,CTRYALLQ)             ORDER LIST                    
         DC    AL2(UP@ODLIS-WORKD,UP@ODLIS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'0D'                                                            
         DC    AL1(ACTGRIDQ,ACT2LSTQ+ACT2NULQ)                                  
*                                                                               
         DC    AL1(ACTNODSM,CTRYALLQ)             ORDER SUMMARY                 
         DC    AL2(UP@ODSMS-WORKD,UP@ODSMS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'0E'                                                            
         DC    AL1(ACTGRIDQ,ACT2PROQ+ACT2LSTQ+ACT2NULQ)                         
*                                                                               
         DC    AL1(ACTNNBUD,CTRYALLQ)             BUDGET                        
         DC    AL2(UP@BGTS-WORKD,UP@BGTS-WORKD)                                 
         DC    AL2(0,0,0,0)                                                     
         DC    X'0F'                                                            
         DC    AL1(ACTGRIDQ,ACT2NSJQ)                                           
*                                                                               
         DC    AL1(ACTNVICF,CTRYALLQ)             VENDOR CASHFLOW               
         DC    AL2(UP@VNDCF-WORKD,UP@VNDCL-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'14'                                                            
         DC    AL1(ACTGRONQ,ACT2CRDQ+ACT2LOWQ)                                  
*                                                                               
         DC    AL1(ACTNJBCF,CTRYALLQ)             JOB CASHFLOW                  
         DC    AL2(UP@JOBCF-WORKD,UP@JOBCL-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'15'                                                            
         DC    AL1(ACTGRONQ,ACT2PROQ+ACT2LOWQ+ACT2NULQ)                         
*                                                                               
         DC    AL1(ACTNCLMS,CTRYALLQ)             EXPENSE CLAIMS                
         DC    AL2(UP@EXCLS-WORKD,UP@EXCLS-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'18'                                                            
         DC    AL1(ACTDDSQ+ACTGRIDQ,ACT2NULQ)                                   
*                                                                               
         DC    AL1(ACTNESTL,CTRYALLQ)             ESTIMATE LIST                 
         DC    AL2(UP@ENQEL-WORKD,UP@ENQEL-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'1A'                                                            
         DC    AL1(ACTGRIDQ,ACT2LSTQ+ACT2ULTQ)                                  
*                                                                               
         DC    AL1(ACTNESTD,CTRYALLQ)             ESTIMATE DETAILS              
         DC    AL2(UP@ENQED-WORKD,UP@ENQED-WORKD)                               
         DC    AL2(0,0,0,0)                                                     
         DC    X'1B'                                                            
         DC    AL1(0,ACT2NULQ)                                                  
*                                                                               
*        DC    AL1(ACTNRNSU,CTRYALLQ)             REFERENCE NO. SEARCH          
*        DC    AL2(UP@REF-WORKD,UP@REF-WORKD)                                   
*        DC    AL2(0,0,0,0)                                                     
*        DC    X'20'                                                            
*        DC    AL1(ACTGRIDQ,ACT2LSTQ+ACT2ULTQ)                                  
*                                                                               
         DC    AL1(EOT)                                                         
         EJECT                                                                  
**********************************************************************          
* CONTRA BUCKET TABLE                                                *          
**********************************************************************          
BUKTAB   DS    0X                  ** CONTRA BUCKET TABLE **                    
         DC    AL1(SYSCNAM),AL1(SCITGRNT,SCITDFLT),C'SE'                        
         DC    AL2(BTGRNT-ROUT1)                                                
         DC    AL1(SYSCNAM),AL1(SCITCOKE,SCITGRNT),C'SE'                        
         DC    AL2(BTGRNT-ROUT1)                                                
         DC    AL1(SYSCNAM),AL1(SCITGRNT,SCITGRNT),C'  '                        
         DC    AL2(BTGRNT-ROUT1)                                                
         DC    AL1(SYSCEUR),AL1(SCITGLEV,SCITGLEV),C'ST'                        
         DC    AL2(BTGLEVST-ROUT1)                                              
         DC    AL1(SYSCEUR),AL1(SCITINCA,SCITINCA),C'ST'                        
         DC    AL2(BTINCAST-ROUT1)                                              
         DC    AL1(SYSCEUR),AL1(SCITFORD,SCITGLEV),C'ST'                        
         DC    AL2(BTFORDST-ROUT1)                                              
         DC    AL1(SYSCEUR),AL1(SCITJHRS,SCITINCA),C'ST'                        
         DC    AL2(BTJHRSST-ROUT1)                                              
         DC    AL1(SYSCEUR),AL1(SCITIAMT,SCITIAMT),C'ST'                        
         DC    AL2(BTIAMTST-ROUT1)                                              
         DC    AL1(SYSCNOT+SYSCNAM),AL1(SCITIVAT,SCITIVAT),C'2P'                
         DC    AL2(BTIVAT2P-ROUT1)                                              
         DC    AL1(SYSCEUR),AL1(SCITDEPR,SCITDEPR),C'41'                        
         DC    AL2(BTDEPR41-ROUT1)                                              
         DC    AL1(SYSCANY),AL1(SCITVEHI,SCITVEHI),C'1J'                        
         DC    AL2(BTVEHI1J-ROUT1)                                              
         DC    AL1(SYSCANY),AL1(SCITHOUR,0),C'1C'                               
         DC    AL2(0)                                                           
         DC    AL1(SYSCANY),AL1(SCITHOUR,SCITHOUR),C'1J'                        
         DC    AL2(BTHOUR1J-ROUT1)                                              
         DC    AL1(SYSCANY),AL1(SCITGRSS,SCITGRSS),C'1J'                        
         DC    AL2(BTGRSS1J-ROUT1)                                              
         DC    AL1(SYSCANY),AL1(SCITGRSS,SCITGRSS),C'  '                        
         DC    AL2(BTGRSS-ROUT1)                                                
         DC    AL1(SYSCANY),AL1(SCITBENE,SCITBENE),C'  '                        
         DC    AL2(BTBENE-ROUT1)                                                
         DC    AL1(SYSCANY),AL1(SCITJHRS,SCITHOUR),C'  '                        
         DC    AL2(BTHOUR-ROUT1)                                                
         DC    AL1(SYSCANY),AL1(SCITHOUR,SCITHOUR),C'1R'                        
         DC    AL2(BTHOUR1R-ROUT1)                                              
         DC    AL1(SYSCANY),AL1(SCITHOUR,SCITHOUR),C'  '                        
         DC    AL2(BTHOUR-ROUT1)                                                
         DC    AL1(SYSCANY),AL1(SCITGLEV,SCITGLEV),C'  '                        
         DC    AL2(BTGLEV-ROUT1)                                                
         DC    AL1(SYSCANY),AL1(SCITVEHI,SCITVEHI),C'  '                        
         DC    AL2(BTVEHI-ROUT1)                                                
         DC    AL1(SYSCANY),AL1(SCITFEEA,SCITFEEA),C'  '                        
         DC    AL2(BTFEEA-ROUT1)                                                
         DC    AL1(SYSCANY),AL1(SCITFEES,SCITFEES),C'  '                        
         DC    AL2(BTFEES-ROUT1)                                                
BUKTABX  DC    AL1(BUKTEOTQ)                                                    
         EJECT ,                                                                
*                                                                               
**********************************************************************          
* A(NON-ADDRESSABLE W/S AREAS)                                       *          
**********************************************************************          
ANAWS    DS    0XL4                ** A(NON-ADDRESSABLE W/S AREAS) **           
         DC    AL2(IOAREA1+L'IODA+L'IOWORK-WORKD,AIO1-WORKD)                    
         DC    AL2(IOAREA2+L'IODA+L'IOWORK-WORKD,AIO2-WORKD)                    
         DC    AL2(IOAREA3+L'IODA+L'IOWORK-WORKD,AIO3-WORKD)                    
         DC    AL2(OFFBLK-WORKD,AOFFBLK-WORKD)                                  
         DC    AL2(JOBLOCK-WORKD,AJOBLOCK-WORKD)                                
         DC    AL2(OPTBUFF-WORKD,AOPTBUFF-WORKD)                                
         DC    AL2(COLTAB-WORKD,ACOLTAB-WORKD)                                  
         DC    AL2(COLIST-WORKD,ACOLIST-WORKD)                                  
         DC    AL2(OPTVTAB-WORKD,AOPTVTAB-WORKD)                                
         DC    AL2(MYGOBLCK-WORKD,AGOBLOCK-WORKD)                               
         DC    AL2(TSARREC-WORKD,ATSARREC-WORKD)                                
         DC    AL2(DUMLINE-WORKD,ADUMLINE-WORKD)                                
         DC    AL2(OFFBLK2-WORKD,AOFFBLK2-WORKD)                                
         DC    AL2(DLCB-WORKD,ADLCB-WORKD)                                      
ANAWSN   EQU   (*-ANAWS)/L'ANAWS                                                
*                                                                               
ANATWA   DS    0XL4                ** A(NON-ADDRESSABLE TWA AREAS) **           
         DC    AL2(TEMPBLK-TWAD,ATEMPBLK-WORKD) TEMP BLOCK                      
         DC    AL2(TSARBLK-TWAD,ATSARBLK-WORKD) TSAR BLOCK                      
         DC    AL2(TSARBLKB-TWAD,ATSARBKB-WORKD) TSAR BLOCK B                   
         DC    AL2(OPTVALS-TWAD,AOPTVALS-WORKD) OPTION VALUES                   
         DC    AL2(SECBLK-TWAD,ASECBLK-WORKD)   SECURITY BLOCK                  
         DC    AL2(SVSCRN-TWAD,ASVSCRN-WORKD)   SCREEN RESTORE AREA             
         DC    AL2(CURTAB-TWAD,ACURTAB-WORKD)   CURRENCY TABLE                  
         DC    AL2(SVSES-TWAD,ASVSES-WORKD)     CURRENT SESSION INFO            
         DC    AL2(SVTSAR-TWAD,ASVTSAR-WORKD)   SAVED TSAR RECORD               
ANATWAN  EQU   (*-ANATWA)/L'ANATWA                                              
*                                                                               
ANATIA   DS    0XL4                ** A(NON-ADDRESSABLE TIA AREAS) **           
*        DC    AL2(GENOVER-TIAD,AGENOVER-WORKD)                                 
*        DC    AL2(CURTAB-TIAD,ACURTAB-WORKD)                                   
ANATIAN  EQU   (*-ANATIA)/L'ANATIA                                              
         EJECT ,                                                                
***********************************************************************         
*        GLOBAL UPPER CASE DICTIONARY ENTRIES                         *         
***********************************************************************         
*                                                                               
DICUPR   DS    0X                                                               
         DCDDL AC#AGY,L'UP@AGY     AGENCY                                       
         DCDDL AC#BEN,L'UP@BEN     BENEFIT                                      
         DCDDL AC#BIL,L'UP@BIL     BILL                                         
         DCDDL AC#BOTH,L'UP@BOTH   BOTH                                         
         DCDDL AC#CHGS,L'UP@CHGS   CHARGES                                      
         DCDDL AC#DELD,L'UP@DELD   DELETED                                      
         DCDDL AC#DUE,L'UP@DUE     DUE                                          
         DCDDL AC#EST,L'UP@EST     ESTIMATE                                     
         DCDDL AC#EXP,L'UP@EXP     EXPENSE                                      
         DCDDL AC#FLYMO,L'UP@FLYMO FU, FULLY MATCHED ORDER                      
         DCDDL AC#HALF,L'UP@HALF   HALF                                         
         DCDDL AC#HELP,L'UP@HELP   HELP                                         
         DCDDL AC#IDR,L'UP@IDR     INDIRECT                                     
         DCDDL AC#LCLCU,L'UP@LCLCU LOCAL, LOCAL CURRENCY                        
         DCDDL AC#MAX,L'UP@MAX     MAXIMUM                                      
         DCDDL AC#MOA,L'UP@MOA     MONTH - MOA                                  
         DCDDL AC#MOS,L'UP@MOS     MONTH - MOS                                  
         DCDDL AC#MOS,L'UP@MOS3    MOS                                          
         DCDDL AC#NO,L'UP@NO       NO                                           
         DCDDL AC#ONLY,L'UP@ONLY   ONLY                                         
         DCDDL AC#OUT,L'UP@OUT     OUT                                          
         DCDDL AC#OVEST,L'UP@OVEST OVEREST                                      
         DCDDL AC#PAGE,L'UP@PAGE   PAGE                                         
         DCDDL AC#APG76,L'UP@PENSN PENSION                                      
         DCDDL AC#PRD,L'UP@PRD     PRODUCTION                                   
         DCDDL AC#PUR,L'UP@PUR     PURCHASE                                     
         DCDDL AC#SLRY,L'UP@SLRY   SALARY                                       
         DCDDL AC#SRC,L'UP@SRC     SOURCE                                       
         DCDDL AC#THRU,L'UP@THRU   THRU                                         
         DCDDL AC#TO,L'UP@TO       TO                                           
         DCDDL AC#UBLD,L'UP@UBLD   UNBILLED                                     
         DCDDL AC#UNEST,L'UP@UNEST UNDEREST                                     
         DCDDL AC#WC,L'UP@WC       WORKCODE                                     
         DCDDL AC#YES,L'UP@YES     YES                                          
         DCDDL AC#ZERO,L'UP@ZERO   ZERO                                         
*                                                                               
*                                  OPTIONS THAT MUST BE ADDRESSABLE             
         DCDDL AC#BAL,OPTLOLNQ     BALANCE                                      
         DCDDL AC#CLINT,OPTLOLNQ   CLIENT                                       
         DCDDL AC#FULDL,OPTSHLNQ   FD, FULLDEL                                  
         DCDDL AC#MOA2,OPTLOLNQ    MOA                                          
         DCDDL AC#MTH,OPTLOLNQ     MONTH                                        
         DCDDL AC#WC,(OPTSHLNQ+1)  WC, WORK CODE                                
*                                                                               
         DCDDL AC#BGT,ACTSHLNQ     BU, BUDGET                                   
         DCDDL AC#CTRL,ACTSHLNQ    CL, CONTRA LIST                              
         DCDDL AC#CROR,ACTSHLNQ    CR, CREDITOR(UK) / VE VENDOR(US)             
         DCDDL AC#DTL2,ACTSHLNQ    DE, DETAIL                                   
         DCDDL AC#DTOFF,ACTSHLNQ   DF, DETAIL BY OFFICE                         
         DCDDL AC#RCV,ACTSHLNQ     DR, DEBTOR(UK) / RE RECEIVABLE(US)           
         DCDDL AC#DDSST,ACTSHLNQ   DS, DDS STATEMENT                            
         DCDDL AC#JOBES,ACTSHLNQ   ES, JOB ESTIMATES                            
         DCDDL AC#ESTIM,ACTSHLNQ   ET, ESTIMATED TIME                           
         DCDDL AC#FMOFF,ACTSHLNQ   FM, OFFICE BY MONTH                          
         DCDDL AC#JOBBL,ACTSHLNQ   JB, JOB BILLING                              
         DCDDL AC#JOBDE,ACTSHLNQ   JD, JOB DETAIL                               
         DCDDL AC#JBSTA,ACTSHLNQ   JS, JOB STATEMENT                            
         DCDDL AC#LIST2,ACTSHLNQ   LI, LIST                                     
         DCDDL AC#LISEL,ACTSHLNQ   LS, LIST AND SELECT                          
         DCDDL AC#MNOFF,ACTSHLNQ   MF, MONTH BY OFFICE                          
         DCDDL AC#MTHLY,ACTSHLNQ   MO, MONTHLY                                  
         DCDDL AC#ORDDE,ACTSHLNQ   OD, ORDER DETAIL                             
         DCDDL AC#ORDLI,ACTSHLNQ   OL, ORDER LIST                               
         DCDDL AC#ORDSM,ACTSHLNQ   OS, ORDER SUMMARY                            
         DCDDL AC#PFTLS,ACTSHLNQ   PL, PROFIT/LOSS                              
         DCDDL AC#REF,ACTSHLNQ                                                  
         DCDDL AC#STOFF,ACTSHLNQ   SF, STATEMENT BY OFFICE                      
         DCDDL AC#STMNT,ACTSHLNQ   ST, STATEMENT                                
*                                                                               
         DCDDL AC#BGT,ACTLOLNQ     BUDGET                                       
         DCDDL AC#CTRL,ACTLOLNQ    CLIST, CONTRA LIST                           
         DCDDL AC#CROR,ACTLOLNQ    CREDITOR(UK) / VENDOR(US)                    
         DCDDL AC#RCV,ACTLOLNQ     DEBTOR(UK)/RECEIVAB, RECEIVABLE(US)          
         DCDDL AC#DTL2,ACTLOLNQ    DETAIL                                       
         DCDDL AC#DTOFF,ACTLOLNQ   DETOFF, DETAIL BY OFFICE                     
         DCDDL AC#DDSST,ACTLOLNQ   DS, DDS STATEMENT                            
         DCDDL AC#ESTIM,ACTLOLNQ   ESTTIME, ESTIMATED TIME                      
         DCDDL AC#JOBBL,ACTLOLNQ   JOBBILL, JOB BILLING                         
         DCDDL AC#JOBDE,ACTLOLNQ   JOBDET, JOB DETAIL                           
         DCDDL AC#JOBES,ACTLOLNQ   JOBEST, JOB ESTIMATES                        
         DCDDL AC#JBSTA,ACTLOLNQ   JOBSTAT, JOB STATEMENT                       
         DCDDL AC#LIST2,ACTLOLNQ   LIST                                         
         DCDDL AC#MTHLY,ACTLOLNQ   MONTHLY                                      
         DCDDL AC#MNOFF,ACTLOLNQ   MONTHOFF, MONTH BY OFFICE                    
         DCDDL AC#FMOFF,ACTLOLNQ   OFFMONTH, OFFICE BY MONTH                    
         DCDDL AC#ORDDE,ACTLOLNQ   ORDDET, ORDER DETAIL                         
         DCDDL AC#ORDLI,ACTLOLNQ   ORDLIST, ORDER LIST                          
         DCDDL AC#ORDSM,ACTLOLNQ   ORDSUMM, ORDER SUMMARY                       
         DCDDL AC#STMNT,ACTLOLNQ   STATMNT, STATEMENT                           
         DCDDL AC#STOFF,ACTLOLNQ   STATOFF, STATEMENT BY OFFICE                 
*                                                                               
         DCDDL AC#ACTYD,OPTSHLNQ   AD, ACTDATE, ACTIVITY DATE                   
         DCDDL AC#ADDED,OPTSHLNQ   AD, ADDED                                    
         DCDDL AC#AGEIN,OPTSHLNQ   AG, AGEING                                   
         DCDDL AC#ALL,OPTSHLNQ     AL, ALL                                      
         DCDDL AC#ALLDT,OPTSHLNQ   AL, ALLDET                                   
         DCDDL AC#AMT,OPTSHLNQ     AM, AMOUNT                                   
         DCDDL AC#APRVD,OPTSHLNQ   AP, APPROVED                                 
         DCDDL AC#ATTR,OPTSHLNQ    AT, ATTRIBUTE                                
         DCDDL AC#ATH,OPTSHLNQ     AU, AUTHORIZE                                
*                                                                               
         DCDDL AC#BAL,OPTSHLNQ     BA, BALANCE                                  
         DCDDL AC#BSSIS,OPTSHLNQ   BS, BASIS                                    
         DCDDL AC#BAT,OPTSHLNQ     BA, BATCH                                    
         DCDDL AC#BFWD,OPTSHLNQ    BF, BFWD, BROUGHT FORWARD                    
         DCDDL AC#BLD,OPTSHLNQ     BI, BILLED                                   
         DCDDL AC#BILN,OPTSHLNQ    BN, BILLNUM                                  
         DCDDL AC#BUCKT,OPTSHLNQ   BT, BUCKTYPE                                 
*                                                                               
         DCDDL AC#CHQD1,OPTSHLNQ   CD, CDATE                                    
         DCDDL AC#CFY,OPTSHLNQ     CF, CURRENT FISCAL YEAR                      
         DCDDL AC#CHGS,OPTSHLNQ    CH, CHARGES                                  
         DCDDL AC#CHK,OPTSHLNQ     CH, CHEQUE(UK), CHECK(US)                    
         DCDDL AC#CLINT,OPTSHLNQ   CL, CLIENT                                   
         DCDDL AC#CLSD,OPTSHLNQ    CL, CLOSED                                   
         DCDDL AC#CHKC3,OPTSHLNQ   CN, CNUM(UK), CK CKNO(US)                    
         DCDDL AC#CTRD,OPTSHLNQ    CO, CONTRA'D(UK), OF OFFSET(US)              
         DCDDL AC#CR,OPTSHLNQ      CR, CREDIT                                   
         DCDDL AC#CURRY,OPTSHLNQ   CU, CURRENCY                                 
*                                                                               
         DCDDL AC#DATE,OPTSHLNQ    DA, DATE                                     
         DCDDL AC#DPSD2,OPTSHLNQ   DD, DDATE                                    
         DCDDL AC#DDS,OPTSHLNQ     DD, DDS                                      
         DCDDL AC#DEND,OPTSHLNQ    DE, DEND                                     
         DCDDL AC#DELD,OPTSHLNQ    DE, DELETED                                  
         DCDDL AC#DELS,OPTSHLNQ    DE, DELETES                                  
         DCDDL AC#DTL,OPTSHLNQ     DE, DETAIL                                   
         DCDDL AC#DRAFT,OPTSHLNQ   DF, DRAFT                                    
         DCDDL AC#DISB,OPTSHLNQ    DI, DISBURSED                                
         DCDDL AC#DISS,OPTSHLNQ    DI, DISCOUNT                                 
         DCDDL AC#DSP,OPTSHLNQ     DI, DISPLAY                                  
         DCDDL AC#DR,OPTSHLNQ      DR, DEBIT                                    
         DCDDL AC#DSTRT,OPTSHLNQ   DS, DSTART                                   
         DCDDL AC#DUE,OPTSHLNQ     DU, DUE                                      
*                                                                               
         DCDDL AC#END,OPTSHLNQ     EN, END                                      
         DCDDL AC#EST,OPTSHLNQ     ES, ESTIMATE                                 
         DCDDL AC#EXPAN,OPTSHLNQ   EX, EXPAND                                   
*                                                                               
         DCDDL AC#FMTCH,OPTSHLNQ   FM, FMATCHED                                 
         DCDDL AC#FXDRF,OPTSHLNQ   FR, FIXED REF#                               
*                                                                               
         DCDDL AC#GROSS,OPTSHLNQ   GR, GROSS                                    
*                                                                               
         DCDDL AC#HELD,OPTSHLNQ    HE, HELD                                     
         DCDDL AC#HOUR1,OPTSHLNQ   HO, HOUR                                     
*                                                                               
         DCDDL AC#INCMT,OPTSHLNQ   IN, INCREMENT                                
         DCDDL AC#INV,OPTSHLNQ     IN, INVOICE                                  
*                                                                               
         DCDDL AC#JOB,OPTSHLNQ     JB, JOB                                      
*                                                                               
         DCDDL AC#LEVEL,OPTSHLNQ   LE, LEVEL                                    
         DCDDL AC#LCKD1,OPTSHLNQ   LO, LOCKED                                   
*                                                                               
         DCDDL AC#MANU,OPTSHLNQ    MA, MANUAL                                   
         DCDDL AC#MED,OPTSHLNQ     ME, MEDIA                                    
         DCDDL AC#MEMO,OPTSHLNQ    ME, MEMO                                     
         DCDDL AC#MERGE,OPTSHLNQ   ME, MERGE                                    
         DCDDL AC#METH,OPTSHLNQ    ME, METHOD                                   
         DCDDL AC#MOA2,OPTSHLNQ    MO, MOA                                      
         DCDDL AC#MTH,OPTSHLNQ     MO, MONTH                                    
*                                                                               
         DCDDL AC#NET,OPTSHLNQ     NE, NET                                      
         DCDDL AC#NEG,OPTSHLNQ     NG, NEGATIVE                                 
*                                                                               
         DCDDL AC#ORDD3,OPTSHLNQ   OD, ODATE                                    
         DCDDL AC#OFFDE,OPTSHLNQ   OD, OFFICE DETAIL                            
         DCDDL AC#OFF,OPTSHLNQ     OF, OFFICE                                   
         DCDDL AC#OPNDT,OPTSHLNQ   OP, OPEN DATE                                
         DCDDL AC#ORDER,OPTSHLNQ   OR, ORDER                                    
         DCDDL AC#ORDS,OPTSHLNQ    OR, ORDERS                                   
         DCDDL AC#OVRI,OPTSHLNQ    OV, OVERRIDE                                 
*                                                                               
         DCDDL AC#PAID,OPTSHLNQ    PA, PAID                                     
         DCDDL AC#PARDL,OPTSHLNQ   PD, PARTDEL                                  
         DCDDL AC#PAYD2,OPTSHLNQ   PD, PAYDATE                                  
         DCDDL AC#PELDT,OPTSHLNQ   PD, PEELDATE                                 
         DCDDL AC#PELED,OPTSHLNQ   PE, PEELED                                   
         DCDDL AC#PROJB,OPTSHLNQ   PJ, PROJOB                                   
         DCDDL AC#PTYMO,OPTSHLNQ   PM, PMATCHED                                 
         DCDDL AC#PAYR2,OPTSHLNQ   PR, PAYREF                                   
         DCDDL AC#PRO,OPTSHLNQ     PR, PRODUCT                                  
         DCDDL AC#PST,OPTSHLNQ     PS, PST                                      
         DCDDL AC#PAYTY,OPTSHLNQ   PT, PAY TYPE                                 
*                                                                               
         DCDDL AC#RCND,OPTSHLNQ    RC, RECONCILED                               
         DCDDL AC#REF,OPTSHLNQ     RE, REFERENCE                                
         DCDDL AC#RUNNO,OPTSHLNQ   RU, RUN NUMBER                               
         DCDDL AC#RVRSS,OPTSHLNQ   RV, REVERSALS                                
*                                                                               
         DCDDL AC#SEL,OPTSHLNQ     SE, SELECT                                   
         DCDDL AC#SERNO,OPTSHLNQ   SE, SERIAL NUMBER                            
         DCDDL AC#SHOW,OPTSHLNQ    SH, SHOW                                     
         DCDDL AC#SRC,OPTSHLNQ     SO, SOURCE                                   
         DCDDL AC#STMD2,OPTSHLNQ   ST, STADATE                                  
         DCDDL AC#START,OPTSHLNQ   ST, START                                    
         DCDDL AC#SUBR,OPTSHLNQ    SU, SUB-REFERENCE                            
         DCDDL AC#SMY,OPTSHLNQ     SU, SUMMARY                                  
         DCDDL AC#SUP,OPTSHLNQ     SU, SUPPLIER(UK), VE VENDOR(US)              
*                                                                               
         DCDDL AC#TAX,OPTSHLNQ     TA, TAX                                      
         DCDDL AC#TIME,OPTSHLNQ    TI, TIME                                     
         DCDDL AC#TMTYP,OPTSHLNQ   TT, TTYPE                                    
         DCDDL AC#TYPE,OPTSHLNQ    TY, TYPE                                     
*                                                                               
         DCDDL AC#UDAT2,OPTSHLNQ   UD, USEDATE                                  
         DCDDL AC#UBLD,OPTSHLNQ    UN, UNBILLED                                 
         DCDDL AC#URG,OPTSHLNQ     UR, URGENT                                   
*                                                                               
         DCDDL AC#VALUE,OPTSHLNQ   VA, VALUE                                    
         DCDDL AC#VAT,OPTSHLNQ     VA, VAT RATE(UK), GS GST(US)                 
         DCDDL AC#VOID,OPTSHLNQ    VO, VOID                                     
*                                                                               
         DCDDL AC#XD,OPTSHLNQ      XD, XDETAIL                                  
*                                                                               
         DCDDL AC#11DET,OPTSHLNQ   11, 11DET                                    
         DCDDL AC#12DET,OPTSHLNQ   12, 12DET                                    
         DCDDL AC#13DET,OPTSHLNQ   13, 13DET                                    
         DCDDL AC#14DET,OPTSHLNQ   14, 14DET                                    
         DCDDL AC#15DET,OPTSHLNQ   15, 15DET                                    
         DCDDL AC#16DET,OPTSHLNQ   16, 16DET                                    
*                                                                               
         DCDDL AC#ACTYD,OPTLOLNQ   ACTDATE (ACTIVITY DATE)                      
         DCDDL AC#ADDED,OPTLOLNQ   ADDED                                        
         DCDDL AC#AGEIN,OPTLOLNQ   AGEING                                       
         DCDDL AC#ALL,OPTLOLNQ     ALL                                          
         DCDDL AC#ALLDT,OPTLOLNQ   ALLDET                                       
         DCDDL AC#AMT,OPTLOLNQ     AMOUNT                                       
         DCDDL AC#APRVD,OPTLOLNQ   APPROVED                                     
         DCDDL AC#ATTR,OPTLOLNQ    ATTRIBUTE                                    
         DCDDL AC#ATH,OPTLOLNQ     AUTHORISE                                    
*                                                                               
         DCDDL AC#BSSIS,OPTLOLNQ   BASIS                                        
         DCDDL AC#BAT,OPTLOLNQ     BATCH                                        
         DCDDL AC#BFWD,OPTLOLNQ    BFWD, BROUGHT FORWARD                        
         DCDDL AC#BLD,OPTLOLNQ     BILLED                                       
         DCDDL AC#BILN,OPTLOLNQ    BILLNUM                                      
         DCDDL AC#BUCKT,OPTLOLNQ   BUCKTYPE                                     
*                                                                               
         DCDDL AC#CHQD1,OPTLOLNQ   CDATE                                        
         DCDDL AC#CFY,OPTLOLNQ     CF, CURRENT FISCAL YEAR                      
         DCDDL AC#CHGS,OPTLOLNQ    CHARGES                                      
         DCDDL AC#CHK,OPTLOLNQ     CHEQUE(UK), CHECK(US)                        
         DCDDL AC#CHKC3,OPTLOLNQ   CNUM(UK), CKNO(US)                           
         DCDDL AC#CLSD,OPTLOLNQ    CLOSED                                       
         DCDDL AC#CTRD,OPTLOLNQ    CONTRA'D(UK), OFFSET(US)                     
         DCDDL AC#CR,OPTLOLNQ      CREDIT                                       
         DCDDL AC#CURRY,OPTLOLNQ   CURRENCY                                     
*                                                                               
         DCDDL AC#DATE,OPTLOLNQ    DATE                                         
         DCDDL AC#DPSD2,OPTLOLNQ   DDATE                                        
         DCDDL AC#DDS,OPTLOLNQ     DDS                                          
         DCDDL AC#DR,OPTLOLNQ      DEBIT                                        
         DCDDL AC#DELD,OPTLOLNQ    DELETED                                      
         DCDDL AC#DELS,OPTLOLNQ    DELETES                                      
         DCDDL AC#DEND,OPTLOLNQ    DEND                                         
         DCDDL AC#DTL,OPTLOLNQ     DETAIL                                       
         DCDDL AC#DISB,OPTLOLNQ    DISBURSED                                    
         DCDDL AC#DISS,OPTLOLNQ    DISCOUNT                                     
         DCDDL AC#DSP,OPTLOLNQ     DISPLAY                                      
         DCDDL AC#DRAFT,OPTLOLNQ   DRAFT                                        
         DCDDL AC#DSTRT,OPTLOLNQ   DSTART                                       
         DCDDL AC#DUE,OPTLOLNQ     DUE                                          
*                                                                               
         DCDDL AC#END,OPTLOLNQ     END                                          
         DCDDL AC#EST,OPTLOLNQ     ESTIMATE                                     
         DCDDL AC#EXPAN,OPTLOLNQ   EXPAND                                       
*                                                                               
         DCDDL AC#FXDRF,OPTLOLNQ   FIXED REF#                                   
         DCDDL AC#FMTCH,OPTLOLNQ   FMATCHED                                     
         DCDDL AC#FULDL,OPTLOLNQ   FULLDEL                                      
*                                                                               
         DCDDL AC#GROSS,OPTLOLNQ   GROSS                                        
*                                                                               
         DCDDL AC#HELD,OPTLOLNQ    HELD                                         
         DCDDL AC#HOUR1,OPTLOLNQ   HOUR                                         
*                                                                               
         DCDDL AC#INCMT,OPTLOLNQ   INCREMENT                                    
         DCDDL AC#INV,OPTLOLNQ     INVOICE                                      
*                                                                               
         DCDDL AC#JOB,OPTLOLNQ     JOB                                          
*                                                                               
         DCDDL AC#LEVEL,OPTLOLNQ   LEVEL                                        
         DCDDL AC#LCKD1,OPTLOLNQ   LOCKED                                       
*                                                                               
         DCDDL AC#MANU,OPTLOLNQ    MANUAL                                       
         DCDDL AC#MED,OPTLOLNQ     MEDIA                                        
         DCDDL AC#MEMO,OPTLOLNQ    MEMO                                         
         DCDDL AC#MERGE,OPTLOLNQ   MERGE                                        
         DCDDL AC#METH,OPTLOLNQ    METHOD                                       
*                                                                               
         DCDDL AC#NEG,OPTLOLNQ     NEGATIVE                                     
         DCDDL AC#NET,OPTLOLNQ     NET                                          
*                                                                               
         DCDDL AC#OFFDE,OPTLOLNQ   OD, OFFICE DETAIL                            
         DCDDL AC#ORDD3,OPTLOLNQ   ODATE                                        
         DCDDL AC#OFF,OPTLOLNQ     OFFICE                                       
         DCDDL AC#OPNDT,OPTLOLNQ   OPEN DATE                                    
         DCDDL AC#ORDER,OPTLOLNQ   ORDER                                        
         DCDDL AC#ORDS,OPTLOLNQ    ORDERS                                       
         DCDDL AC#OVRI,OPTLOLNQ    OVERRIDE                                     
*                                                                               
         DCDDL AC#PAID,OPTLOLNQ    PAID                                         
         DCDDL AC#PARDL,OPTLOLNQ   PARTDEL                                      
         DCDDL AC#PAYTY,OPTLOLNQ   PAY TYPE                                     
         DCDDL AC#PAYD2,OPTLOLNQ   PAYDATE                                      
         DCDDL AC#PAYR2,OPTLOLNQ   PAYREF                                       
         DCDDL AC#PELDT,OPTLOLNQ   PEELDATE                                     
         DCDDL AC#PELED,OPTLOLNQ   PEELED                                       
         DCDDL AC#PTYMO,OPTLOLNQ   PMATCHED                                     
         DCDDL AC#PRO,OPTLOLNQ     PRODUCT                                      
         DCDDL AC#PROJB,OPTLOLNQ   PROJOB                                       
         DCDDL AC#PST,OPTLOLNQ     PST                                          
*                                                                               
         DCDDL AC#RCND,OPTLOLNQ    RECONCILED                                   
         DCDDL AC#REF,OPTLOLNQ     REFERENCE                                    
         DCDDL AC#RVRSS,OPTLOLNQ   REVERSALS                                    
         DCDDL AC#RUNNO,OPTLOLNQ   RUN NUMBER                                   
*                                                                               
         DCDDL AC#SEL,OPTLOLNQ     SELECT                                       
         DCDDL AC#SERNO,OPTLOLNQ   SERIAL#                                      
         DCDDL AC#SHOW,OPTLOLNQ    SHOW                                         
         DCDDL AC#SRC,OPTLOLNQ     SOURCE                                       
         DCDDL AC#STMD2,OPTLOLNQ   STADATE                                      
         DCDDL AC#START,OPTLOLNQ   START                                        
         DCDDL AC#SUBR,OPTLOLNQ    SUBREF                                       
         DCDDL AC#SMY,OPTLOLNQ     SUMMARY                                      
         DCDDL AC#SUP,OPTLOLNQ     SUPPLIER(UK), VENDOR(US)                     
*                                                                               
         DCDDL AC#TAX,OPTLOLNQ     TAX                                          
         DCDDL AC#TIME,OPTLOLNQ    TIME                                         
         DCDDL AC#TMTYP,OPTLOLNQ   TTYPE                                        
         DCDDL AC#TYPE,OPTLOLNQ    TYPE                                         
*                                                                               
         DCDDL AC#UBLD,OPTLOLNQ    UNBILLED                                     
         DCDDL AC#URG,OPTLOLNQ     URGENT                                       
         DCDDL AC#UDAT2,OPTLOLNQ   USEDATE                                      
*                                                                               
         DCDDL AC#VAT,OPTLOLNQ     VAT(UK), GST(US)                             
         DCDDL AC#VALUE,OPTLOLNQ   VALUE                                        
         DCDDL AC#VOID,OPTLOLNQ    VOID                                         
*                                                                               
         DCDDL AC#WC,OPTLOLNQ      WORK CODE                                    
*                                                                               
         DCDDL AC#XD,OPTLOLNQ      XDETAIL                                      
*                                                                               
         DCDDL AC#11DET,OPTLOLNQ   11DET                                        
         DCDDL AC#12DET,OPTLOLNQ   12DET                                        
         DCDDL AC#13DET,OPTLOLNQ   13DET                                        
         DCDDL AC#14DET,OPTLOLNQ   14DET                                        
         DCDDL AC#15DET,OPTLOLNQ   15DET                                        
         DCDDL AC#16DET,OPTLOLNQ   16DET                                        
*                                                                               
         DCDDL AC#CLRDA,OPTSHLNQ   CE, CLEARED                                  
         DCDDL AC#CLRDA,OPTLOLNQ   CE, CLEARED                                  
         DCDDL AC#STMNT,OPTLOLNQ   ST, STATEMENT                                
         DCDDL AC#TRNOF,OPTSHLNQ   TF, TOFFICE                                  
         DCDDL AC#TRNOF,OPTLOLNQ   TF, TOFFICE                                  
*                                                                               
         DCDDL AC#VNDCF,ACTSHLNQ   VC, VENDOR CASHFLOW                          
         DCDDL AC#VNDCF,ACTLOLNQ   VC, VENDOR CASHFLOW                          
         DCDDL AC#JOBCF,ACTSHLNQ   JC, JOB CASHFLOW                             
         DCDDL AC#JOBCF,ACTLOLNQ   JC, JOB CASHFLOW                             
*                                                                               
         DCDDL AC#KEYRF,OPTSHLNQ   KR, KEY REFERENCE                            
         DCDDL AC#KEYRF,OPTLOLNQ   KR, KEYREF                                   
         DCDDL AC#PAPPR,OPTLOLNQ   PA, PAPPROVED, PARTIALLY APPRVD              
         DCDDL AC#REJEC,OPTLOLNQ   RE, REJECT                                   
         DCDDL AC#SUBMT,OPTLOLNQ   SU, SUBMIT                                   
         DCDDL AC#INPR,L'UP@INPRS  IP, IN PROGRESS                              
         DCDDL AC#INPR,L'UP@INPRL  INPROGRESS                                   
*        DCDDL AC#RCVE,OPTSHLNQ    RC, RECEIVED UP@RCVDS                        
*        DCDDL AC#RCVE,OPTLOLNQ    RC, RECEIVED UP@RCVDL                        
*                                                                               
         DCDDL AC#STT,L'UP@STT                                                  
         DCDDL AC#STT,L'UP@STTL                                                 
         DCDDL AC#ENQEL,L'UP@ENQEL                                              
         DCDDL AC#ENQED,L'UP@ENQED                                              
         DCDDL AC#EXPCL,ACTSHLNQ   EC, EXPENSE CLAIMS                           
         DCDDL AC#EXPCL,ACTLOLNQ   EXPENSE CLAIMS                               
*                                                                               
         DC    AL1(EOT)                                                         
         EJECT ,                                                                
***********************************************************************         
*        GLOBAL MIXED CASE DICTIONARY ENTRIES                         *         
***********************************************************************         
*                                                                               
DICMIX   DS    0X                                                               
         DCDDL AC#ACC,L'LC@ACC     ACCOUNT                                      
         DCDDL AC#AMT,L'LC@AMT     AMOUNT                                       
         DCDDL AC#CTR,L'LC@CTR     CONTRA                                       
         DCDDL AC#DOWN,L'LC@DOWN   DOWN                                         
         DCDDL AC#XJOB,L'LC@XJOB   EXPENSE JOB                                  
         DCDDL AC#LGR,L'LC@LGR     LEDGER                                       
         DCDDL AC#LEFT,L'LC@LEFT   LEFT                                         
         DCDDL AC#MEMO,L'LC@MEMO   MEMO                                         
         DCDDL AC#PFK,L'LC@PFK     PF, PFKEY                                    
         DCDDL AC#RIGHT,L'LC@RIGHT RIGHT                                        
         DCDDL AC#SPLIT,L'LC@SPLIT SPLIT                                        
         DCDDL AC#UNIT,L'LC@UNIT   UNIT                                         
         DCDDL AC#UP,L'LC@UP       UP                                           
         DCDDL AC#EXCHR,L'LC@EXCHR XRATE, EXCHANGE RATE                         
         DCDDL AC#ENQRY,L'LC@ENQRY ENQUIRY                                      
         DCDDL AC#KEY,L'LC@KEY     KEY                                          
         DCDDL AC#OPTS,L'LC@OPTS   OPTIONS                                      
         DCDDL AC#NONE,L'LC@NONE   NONE                                         
         DCDDL AC#NXT,L'LC@NXT     NEXT                                         
         DCDDL AC#RETRN,L'LC@RETRN RETURN                                       
         DCDDL AC#DRS,L'LC@DRS     DEBITS                                       
         DCDDL AC#CRS,L'LC@CRS     CREDITS                                      
         DCDDL AC#OFFC,L'LC@OFFC   OFFICE                                       
         DCDDL AC#MOS,L'LC@MOS     MONTH                                        
         DCDDL AC#RSCOC,L'LC@CTRA  CONTRA A/C                                   
         DCDDL AC#DATE,L'LC@DATE   DATE                                         
         DCDDL AC#STT,L'LC@STT     STATUS                                       
         DCDDL AC#RSNAR,L'LC@RSNAR NARRATIVE                                    
         DCDDL AC#REF,L'LC@REF     REF#                                         
         DCDDL AC#BATS,L'LC@BATS   BATCH                                        
         DCDDL AC#WC2,L'LC@WC2     W/C                                          
         DCDDL AC#TOTAL,L'LC@TOTAL TOTAL                                        
         DCDDL AC#INP,L'LC@INPUT   INPUT                                        
         DCDDL AC#ON,L'LC@ON       ON                                           
         DCDDL AC#AND,L'LC@AND     AND                                          
         DCDDL AC#WITH,L'LC@WITH   WITH                                         
         DCDDL AC#ORDER,L'LC@ORDER ORDER                                        
         DC    AL1(EOT)                                                         
         EJECT ,                                                                
*                                                                               
***********************************************************************         
*        HELP TABLE                                                   *         
***********************************************************************         
HLPTAB   DS    0X                  HELP LISTS                                   
*                                                                               
*-------------------*                                                           
* ACTION AND SCROLL *                                                           
*-------------------*                                                           
ACHLP    DC    AL1(NULLACTQ,ACHLPLNQ)                                           
*                                                                               
ACHLP01  DC    AL1(HLPACT,CTRYUSA,0,ACHLP01Q)                                   
         DC    AL1(1,2,3,4,5)                                                   
ACHLP01Q EQU   *-ACHLP01                                                        
*                                                                               
ACHLP02  DC    AL1(HLPACT,CTRYCAN,0,ACHLP02Q)                                   
         DC    AL1(1,2,3,4,5)                                                   
ACHLP02Q EQU   *-ACHLP02                                                        
*                                                                               
ACHLP03  DC    AL1(HLPACT,CTRYALLQ,0,ACHLP03Q)                                  
         DC    AL1(1,2)                                                         
ACHLP03Q EQU   *-ACHLP03                                                        
*                                                                               
ACHLP04  DC    AL1(HLPSCRL,CTRYALLQ,0,ACHLP04Q)                                 
         DC    AL1(1,2)                                                         
ACHLP04Q EQU   *-ACHLP04                                                        
*                                                                               
         DC    AL1(EOT)                                                         
ACHLPLNQ EQU   *-ACHLP                                                          
*                                                                               
*-------------*                                                                 
* CONTRA LIST *                                                                 
*-------------*                                                                 
CLHLP    DC    AL1(ACTNCONT,CLHLPLNQ)                                           
*                                                                               
CLHLP01  DC    AL1(HLPKEY,CTRYUSA,0,CLHLP01Q)                                   
         DC    AL1(1,2)                                                         
CLHLP01Q EQU   *-CLHLP01                                                        
*                                                                               
CLHLP02  DC    AL1(HLPKEY,CTRYCAN,0,CLHLP02Q)                                   
         DC    AL1(1,2)                                                         
CLHLP02Q EQU   *-CLHLP02                                                        
*                                                                               
CLHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,CLHLP03Q)                                  
         DC    AL1(2)                                                           
CLHLP03Q EQU   *-CLHLP03                                                        
*                                                                               
CLHLP04  DC    AL1(HLPCONT,CTRYUSA,0,CLHLP04Q)                                  
         DC    AL1(1)                                                           
CLHLP04Q EQU   *-CLHLP04                                                        
*                                                                               
CLHLP05  DC    AL1(HLPCONT,CTRYCAN,0,CLHLP05Q)                                  
         DC    AL1(1)                                                           
CLHLP05Q EQU   *-CLHLP05                                                        
*                                                                               
CLHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,CLHLP06Q)                                 
         DC    AL1(2)                                                           
CLHLP06Q EQU   *-CLHLP06                                                        
*                                                                               
CLHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,CLHLP07Q)                                  
         DC    AL1(2)                                                           
CLHLP07Q EQU   *-CLHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
CLHLPLNQ EQU   *-CLHLP                                                          
*                                                                               
*                                  **** DETAIL ****                             
DEHLP    DC    AL1(ACTNDETL,DEHLPLNQ)                                           
*                                                                               
DEHLP01  DC    AL1(HLPKEY,CTRYUSA,0,DEHLP01Q)                                   
         DC    AL1(1,2)                                                         
DEHLP01Q EQU   *-DEHLP01                                                        
*                                                                               
DEHLP02  DC    AL1(HLPKEY,CTRYCAN,0,DEHLP02Q)                                   
         DC    AL1(1,2)                                                         
DEHLP02Q EQU   *-DEHLP02                                                        
*                                                                               
DEHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,DEHLP03Q)                                  
         DC    AL1(4)                                                           
DEHLP03Q EQU   *-DEHLP03                                                        
*                                                                               
DEHLP04  DC    AL1(HLPCONT,CTRYUSA,0,DEHLP04Q)                                  
         DC    AL1(1)                                                           
DEHLP04Q EQU   *-DEHLP04                                                        
*                                                                               
DEHLP05  DC    AL1(HLPCONT,CTRYCAN,0,DEHLP05Q)                                  
         DC    AL1(1)                                                           
DEHLP05Q EQU   *-DEHLP05                                                        
*                                                                               
DEHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,DEHLP06Q)                                 
         DC    AL1(4)                                                           
DEHLP06Q EQU   *-DEHLP06                                                        
*                                                                               
DEHLP07  DC    AL1(HLPOPT,CTRYUSA,0,DEHLP07Q)                                   
         DC    AL1(3,4,5,6,7,8,9,10,11)                                         
DEHLP07Q EQU   *-DEHLP07                                                        
*                                                                               
DEHLP08  DC    AL1(HLPOPT,CTRYCAN,0,DEHLP08Q)                                   
         DC    AL1(3,4,5,6,7,8,9,10,11)                                         
DEHLP08Q EQU   *-DEHLP08                                                        
*                                                                               
DEHLP09  DC    AL1(HLPOPT,CTRYALLQ,0,DEHLP09Q)                                  
         DC    AL1(3,4,5,6,7,8,9,10,11,42)                                      
DEHLP09Q EQU   *-DEHLP09                                                        
*                                                                               
         DC    AL1(EOT)                                                         
DEHLPLNQ EQU   *-DEHLP                                                          
*                                                                               
*                                  **** CREDITOR ****                           
CRHLP    DC    AL1(ACTNCRED,CRHLPLNQ)                                           
*                                                                               
CRHLP01  DC    AL1(HLPKEY,CTRYUSA,0,CRHLP01Q)                                   
         DC    AL1(1,2)                                                         
CRHLP01Q EQU   *-CRHLP01                                                        
*                                                                               
CRHLP02  DC    AL1(HLPKEY,CTRYCAN,0,CRHLP02Q)                                   
         DC    AL1(1,2)                                                         
CRHLP02Q EQU   *-CRHLP02                                                        
*                                                                               
CRHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,CRHLP03Q)                                  
         DC    AL1(3)                                                           
CRHLP03Q EQU   *-CRHLP03                                                        
*                                                                               
CRHLP04  DC    AL1(HLPCONT,CTRYUSA,0,CRHLP04Q)                                  
         DC    AL1(1)                                                           
CRHLP04Q EQU   *-CRHLP04                                                        
*                                                                               
CRHLP05  DC    AL1(HLPCONT,CTRYCAN,0,CRHLP05Q)                                  
         DC    AL1(1)                                                           
CRHLP05Q EQU   *-CRHLP05                                                        
*                                                                               
CRHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,CRHLP06Q)                                 
         DC    AL1(3)                                                           
CRHLP06Q EQU   *-CRHLP06                                                        
*                                                                               
CRHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,CRHLP07Q)                                  
         DC    AL1(43,44,45,46,47,48,49,50,51,52,53,54)                         
CRHLP07Q EQU   *-CRHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
CRHLPLNQ EQU   *-CRHLP                                                          
*                                                                               
*                                  **** VENDOR ****                             
VEHLP    DC    AL1(ACTNVEND,VEHLPLNQ)                                           
*                                                                               
VEHLP01  DC    AL1(HLPKEY,CTRYUSA,0,VEHLP01Q)                                   
         DC    AL1(1,2)                                                         
VEHLP01Q EQU   *-VEHLP01                                                        
*                                                                               
VEHLP02  DC    AL1(HLPKEY,CTRYCAN,0,VEHLP02Q)                                   
         DC    AL1(1,2)                                                         
VEHLP02Q EQU   *-VEHLP02                                                        
*                                                                               
VEHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,VEHLP03Q)                                  
         DC    AL1(3)                                                           
VEHLP03Q EQU   *-VEHLP03                                                        
*                                                                               
VEHLP04  DC    AL1(HLPCONT,CTRYUSA,0,VEHLP04Q)                                  
         DC    AL1(1)                                                           
VEHLP04Q EQU   *-VEHLP04                                                        
*                                                                               
VEHLP05  DC    AL1(HLPCONT,CTRYCAN,0,VEHLP05Q)                                  
         DC    AL1(1)                                                           
VEHLP05Q EQU   *-VEHLP05                                                        
*                                                                               
VEHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,VEHLP06Q)                                 
         DC    AL1(3)                                                           
VEHLP06Q EQU   *-VEHLP06                                                        
*                                                                               
VEHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,VEHLP07Q)                                  
         DC    AL1(42,43,44,45,46,47,48,49,50,51,52,53)                         
VEHLP07Q EQU   *-VEHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
VEHLPLNQ EQU   *-VEHLP                                                          
*                                                                               
*                                  **** JOB ESTIMATE ****                       
ESHLP    DC    AL1(ACTNJBES,ESHLPLNQ)                                           
*                                                                               
ESHLP01  DC    AL1(HLPKEY,CTRYUSA,0,ESHLP01Q)                                   
         DC    AL1(1,2)                                                         
ESHLP01Q EQU   *-ESHLP01                                                        
*                                                                               
ESHLP02  DC    AL1(HLPKEY,CTRYCAN,0,ESHLP02Q)                                   
         DC    AL1(1,2)                                                         
ESHLP02Q EQU   *-ESHLP02                                                        
*                                                                               
ESHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,ESHLP03Q)                                  
         DC    AL1(6,24,29)                                                     
ESHLP03Q EQU   *-ESHLP03                                                        
*                                                                               
ESHLP04  DC    AL1(HLPCONT,CTRYUSA,0,ESHLP04Q)                                  
         DC    AL1(1)                                                           
ESHLP04Q EQU   *-ESHLP04                                                        
*                                                                               
ESHLP05  DC    AL1(HLPCONT,CTRYCAN,0,ESHLP05Q)                                  
         DC    AL1(1)                                                           
ESHLP05Q EQU   *-ESHLP05                                                        
*                                                                               
ESHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,ESHLP06Q)                                 
         DC    AL1(6)                                                           
ESHLP06Q EQU   *-ESHLP06                                                        
*                                                                               
ESHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,ESHLP07Q)                                  
         DC    AL1(16,17,18)                                                    
ESHLP07Q EQU   *-ESHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
ESHLPLNQ EQU   *-ESHLP                                                          
*                                                                               
*                                  **** ESTIMATED TIME ****                     
ETHLP    DC    AL1(ACTNETIM,ETHLPLNQ)                                           
*                                                                               
ETHLP01  DC    AL1(HLPKEY,CTRYUSA,0,ETHLP01Q)                                   
         DC    AL1(1,2)                                                         
ETHLP01Q EQU   *-ETHLP01                                                        
*                                                                               
ETHLP02  DC    AL1(HLPKEY,CTRYCAN,0,ETHLP02Q)                                   
         DC    AL1(1,2)                                                         
ETHLP02Q EQU   *-ETHLP02                                                        
*                                                                               
ETHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,ETHLP03Q)                                  
         DC    AL1(7)                                                           
ETHLP03Q EQU   *-ETHLP03                                                        
*                                                                               
ETHLP04  DC    AL1(HLPCONT,CTRYUSA,0,ETHLP04Q)                                  
         DC    AL1(1)                                                           
ETHLP04Q EQU   *-ETHLP04                                                        
*                                                                               
ETHLP05  DC    AL1(HLPCONT,CTRYCAN,0,ETHLP05Q)                                  
         DC    AL1(1)                                                           
ETHLP05Q EQU   *-ETHLP05                                                        
*                                                                               
ETHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,ETHLP06Q)                                 
         DC    AL1(7)                                                           
ETHLP06Q EQU   *-ETHLP06                                                        
*                                                                               
ETHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,ETHLP07Q)                                  
         DC    AL1(19)                                                          
ETHLP07Q EQU   *-ETHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
ETHLPLNQ EQU   *-ETHLP                                                          
*                                                                               
*                                  **** JOB BILLING ****                        
JBHLP    DC    AL1(ACTNJBBL,JBHLPLNQ)                                           
*                                                                               
JBHLP01  DC    AL1(HLPKEY,CTRYUSA,0,JBHLP01Q)                                   
         DC    AL1(1,2)                                                         
JBHLP01Q EQU   *-JBHLP01                                                        
*                                                                               
JBHLP02  DC    AL1(HLPKEY,CTRYCAN,0,JBHLP02Q)                                   
         DC    AL1(1,2)                                                         
JBHLP02Q EQU   *-JBHLP02                                                        
*                                                                               
JBHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,JBHLP03Q)                                  
         DC    AL1(8)                                                           
JBHLP03Q EQU   *-JBHLP03                                                        
*                                                                               
JBHLP04  DC    AL1(HLPCONT,CTRYUSA,0,JBHLP04Q)                                  
         DC    AL1(1)                                                           
JBHLP04Q EQU   *-JBHLP04                                                        
*                                                                               
JBHLP05  DC    AL1(HLPCONT,CTRYCAN,0,JBHLP05Q)                                  
         DC    AL1(1)                                                           
JBHLP05Q EQU   *-JBHLP05                                                        
*                                                                               
JBHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,JBHLP06Q)                                 
         DC    AL1(8)                                                           
JBHLP06Q EQU   *-JBHLP06                                                        
*                                                                               
JBHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,JBHLP07Q)                                  
         DC    AL1(20,21,22,23,24,25)                                           
JBHLP07Q EQU   *-JBHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
JBHLPLNQ EQU   *-JBHLP                                                          
*                                                                               
*                                  **** JOB DETAIL ****                         
JDHLP    DC    AL1(ACTNJBDE,JDHLPLNQ)                                           
*                                                                               
JDHLP01  DC    AL1(HLPKEY,CTRYUSA,0,JDHLP01Q)                                   
         DC    AL1(1,2)                                                         
JDHLP01Q EQU   *-JDHLP01                                                        
*                                                                               
JDHLP02  DC    AL1(HLPKEY,CTRYCAN,0,JDHLP02Q)                                   
         DC    AL1(1,2)                                                         
JDHLP02Q EQU   *-JDHLP02                                                        
*                                                                               
JDHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,JDHLP03Q)                                  
         DC    AL1(9)                                                           
JDHLP03Q EQU   *-JDHLP03                                                        
*                                                                               
JDHLP04  DC    AL1(HLPCONT,CTRYUSA,0,JDHLP04Q)                                  
         DC    AL1(1)                                                           
JDHLP04Q EQU   *-JDHLP04                                                        
*                                                                               
JDHLP05  DC    AL1(HLPCONT,CTRYCAN,0,JDHLP05Q)                                  
         DC    AL1(1)                                                           
JDHLP05Q EQU   *-JDHLP05                                                        
*                                                                               
JDHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,JDHLP06Q)                                 
         DC    AL1(9)                                                           
JDHLP06Q EQU   *-JDHLP06                                                        
*                                                                               
JDHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,JDHLP07Q)                                  
         DC    AL1(26,27,28,29,30,31)                                           
JDHLP07Q EQU   *-JDHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
JDHLPLNQ EQU   *-JDHLP                                                          
*                                                                               
*                                  **** JOB STATEMENT ****                      
JSHLP    DC    AL1(ACTNJBST,JSHLPLNQ)                                           
*                                                                               
JSHLP01  DC    AL1(HLPKEY,CTRYUSA,0,JSHLP01Q)                                   
         DC    AL1(1,2)                                                         
JSHLP01Q EQU   *-JSHLP01                                                        
*                                                                               
JSHLP02  DC    AL1(HLPKEY,CTRYCAN,0,JSHLP02Q)                                   
         DC    AL1(1,2)                                                         
JSHLP02Q EQU   *-JSHLP02                                                        
*                                                                               
JSHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,JSHLP03Q)                                  
         DC    AL1(10)                                                          
JSHLP03Q EQU   *-JSHLP03                                                        
*                                                                               
JSHLP04  DC    AL1(HLPCONT,CTRYUSA,0,JSHLP04Q)                                  
         DC    AL1(1)                                                           
JSHLP04Q EQU   *-JSHLP04                                                        
*                                                                               
JSHLP05  DC    AL1(HLPCONT,CTRYCAN,0,JSHLP05Q)                                  
         DC    AL1(1)                                                           
JSHLP05Q EQU   *-JSHLP05                                                        
*                                                                               
JSHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,JSHLP06Q)                                 
         DC    AL1(10)                                                          
JSHLP06Q EQU   *-JSHLP06                                                        
*                                                                               
JSHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,JSHLP07Q)                                  
         DC    AL1(32)                                                          
JSHLP07Q EQU   *-JSHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
JSHLPLNQ EQU   *-JSHLP                                                          
*                                                                               
*                                  **** LIST ****                               
LIHLP    DC    AL1(ACTNLIST,LIHLPLNQ)                                           
*                                                                               
LIHLP01  DC    AL1(HLPKEY,CTRYUSA,0,LIHLP01Q)                                   
         DC    AL1(1,2)                                                         
LIHLP01Q EQU   *-LIHLP01                                                        
*                                                                               
LIHLP02  DC    AL1(HLPKEY,CTRYCAN,0,LIHLP02Q)                                   
         DC    AL1(1,2)                                                         
LIHLP02Q EQU   *-LIHLP02                                                        
*                                                                               
LIHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,LIHLP03Q)                                  
         DC    AL1(11)                                                          
LIHLP03Q EQU   *-LIHLP03                                                        
*                                                                               
LIHLP04  DC    AL1(HLPCONT,CTRYUSA,0,LIHLP04Q)                                  
         DC    AL1(1)                                                           
LIHLP04Q EQU   *-LIHLP04                                                        
*                                                                               
LIHLP05  DC    AL1(HLPCONT,CTRYCAN,0,LIHLP05Q)                                  
         DC    AL1(1)                                                           
LIHLP05Q EQU   *-LIHLP05                                                        
*                                                                               
LIHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,LIHLP06Q)                                 
         DC    AL1(11)                                                          
LIHLP06Q EQU   *-LIHLP06                                                        
*                                                                               
LIHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,LIHLP07Q)                                  
         DC    AL1(33,34)                                                       
LIHLP07Q EQU   *-LIHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
LIHLPLNQ EQU   *-LIHLP                                                          
*                                                                               
*                                  **** MONTHLY ****                            
MOHLP    DC    AL1(ACTNMNTH,MOHLPLNQ)                                           
*                                                                               
MOHLP01  DC    AL1(HLPKEY,CTRYUSA,MOHLP01Q)                                     
         DC    AL1(1,2)                                                         
MOHLP01Q EQU   *-MOHLP01                                                        
*                                                                               
MOHLP02  DC    AL1(HLPKEY,CTRYCAN,0,MOHLP02Q)                                   
         DC    AL1(1,2)                                                         
MOHLP02Q EQU   *-MOHLP02                                                        
*                                                                               
MOHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,MOHLP03Q)                                  
         DC    AL1(12)                                                          
MOHLP03Q EQU   *-MOHLP03                                                        
*                                                                               
MOHLP04  DC    AL1(HLPCONT,CTRYUSA,0,MOHLP04Q)                                  
         DC    AL1(1)                                                           
MOHLP04Q EQU   *-MOHLP04                                                        
*                                                                               
MOHLP05  DC    AL1(HLPCONT,CTRYCAN,0,MOHLP05Q)                                  
         DC    AL1(1)                                                           
MOHLP05Q EQU   *-MOHLP05                                                        
*                                                                               
MOHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,MOHLP06Q)                                 
         DC    AL1(12)                                                          
MOHLP06Q EQU   *-MOHLP06                                                        
*                                                                               
MOHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,MOHLP07Q)                                  
         DC    AL1(35)                                                          
MOHLP07Q EQU   *-MOHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
MOHLPLNQ EQU   *-MOHLP                                                          
*                                                                               
*                                  **** BUDGET ****                             
NBHLP    DC    AL1(ACTNNBUD,NBHLPLNQ)                                           
*                                                                               
NBHLP01  DC    AL1(HLPKEY,CTRYUSA,0,NBHLP01Q)                                   
         DC    AL1(1,2)                                                         
NBHLP01Q EQU   *-NBHLP01                                                        
*                                                                               
NBHLP02  DC    AL1(HLPKEY,CTRYCAN,0,NBHLP02Q)                                   
         DC    AL1(1,2)                                                         
NBHLP02Q EQU   *-NBHLP02                                                        
*                                                                               
NBHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,NBHLP03Q)                                  
         DC    AL1(1)                                                           
NBHLP03Q EQU   *-NBHLP03                                                        
*                                                                               
NBHLP04  DC    AL1(HLPCONT,CTRYUSA,0,NBHLP04Q)                                  
         DC    AL1(1)                                                           
NBHLP04Q EQU   *-NBHLP04                                                        
*                                                                               
NBHLP05  DC    AL1(HLPCONT,CTRYCAN,0,NBHLP05Q)                                  
         DC    AL1(1)                                                           
NBHLP05Q EQU   *-NBHLP05                                                        
*                                                                               
NBHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,NBHLP06Q)                                 
         DC    AL1(1)                                                           
NBHLP06Q EQU   *-NBHLP06                                                        
*                                                                               
NBHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,NBHLP07Q)                                  
         DC    AL1(1)                                                           
NBHLP07Q EQU   *-NBHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
NBHLPLNQ EQU   *-NBHLP                                                          
*                                                                               
*                                  **** ORDER DETAIL ****                       
ODHLP    DC    AL1(ACTNODDE,ODHLPLNQ)                                           
*                                                                               
ODHLP01  DC    AL1(HLPKEY,CTRYUSA,0,ODHLP01Q)                                   
         DC    AL1(1,2)                                                         
ODHLP01Q EQU   *-ODHLP01                                                        
*                                                                               
ODHLP02  DC    AL1(HLPKEY,CTRYCAN,0,ODHLP02Q)                                   
         DC    AL1(1,2)                                                         
ODHLP02Q EQU   *-ODHLP02                                                        
*                                                                               
ODHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,ODHLP03Q)                                  
         DC    AL1(13)                                                          
ODHLP03Q EQU   *-ODHLP03                                                        
*                                                                               
ODHLP04  DC    AL1(HLPCONT,CTRYUSA,0,ODHLP04Q)                                  
         DC    AL1(1)                                                           
ODHLP04Q EQU   *-ODHLP04                                                        
*                                                                               
ODHLP05  DC    AL1(HLPCONT,CTRYCAN,0,ODHLP05Q)                                  
         DC    AL1(1)                                                           
ODHLP05Q EQU   *-ODHLP05                                                        
*                                                                               
ODHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,ODHLP06Q)                                 
         DC    AL1(13)                                                          
ODHLP06Q EQU   *-ODHLP06                                                        
*                                                                               
ODHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,ODHLP07Q)                                  
         DC    AL1(36,37)                                                       
ODHLP07Q EQU   *-ODHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
ODHLPLNQ EQU   *-ODHLP                                                          
*                                                                               
*                                  **** ORDER LIST ****                         
OLHLP    DC    AL1(ACTNODLI,OLHLPLNQ)                                           
*                                                                               
OLHLP01  DC    AL1(HLPKEY,CTRYUSA,0,OLHLP01Q)                                   
         DC    AL1(1,2)                                                         
OLHLP01Q EQU   *-OLHLP01                                                        
*                                                                               
OLHLP02  DC    AL1(HLPKEY,CTRYCAN,0,OLHLP02Q)                                   
         DC    AL1(1,2)                                                         
OLHLP02Q EQU   *-OLHLP02                                                        
*                                                                               
OLHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,OLHLP03Q)                                  
         DC    AL1(14)                                                          
OLHLP03Q EQU   *-OLHLP03                                                        
*                                                                               
OLHLP04  DC    AL1(HLPCONT,CTRYUSA,0,OLHLP04Q)                                  
         DC    AL1(1)                                                           
OLHLP04Q EQU   *-OLHLP04                                                        
*                                                                               
OLHLP05  DC    AL1(HLPCONT,CTRYCAN,0,OLHLP05Q)                                  
         DC    AL1(1)                                                           
OLHLP05Q EQU   *-OLHLP05                                                        
*                                                                               
OLHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,OLHLP06Q)                                 
         DC    AL1(14)                                                          
OLHLP06Q EQU   *-OLHLP06                                                        
*                                                                               
OLHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,OLHLP07Q)                                  
         DC    AL1(38,39)                                                       
OLHLP07Q EQU   *-OLHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
OLHLPLNQ EQU   *-OLHLP                                                          
*                                                                               
*                                  **** ORDER SUMMARY ****                      
OSHLP    DC    AL1(ACTNODSM,OSHLPLNQ)                                           
*                                                                               
OSHLP01  DC    AL1(HLPKEY,CTRYUSA,0,OSHLP01Q)                                   
         DC    AL1(1,2)                                                         
OSHLP01Q EQU   *-OSHLP01                                                        
*                                                                               
OSHLP02  DC    AL1(HLPKEY,CTRYCAN,0,OSHLP02Q)                                   
         DC    AL1(1,2)                                                         
OSHLP02Q EQU   *-OSHLP02                                                        
*                                                                               
OSHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,OSHLP03Q)                                  
         DC    AL1(15)                                                          
OSHLP03Q EQU   *-OSHLP03                                                        
*                                                                               
OSHLP04  DC    AL1(HLPCONT,CTRYUSA,0,OSHLP04Q)                                  
         DC    AL1(1)                                                           
OSHLP04Q EQU   *-OSHLP04                                                        
*                                                                               
OSHLP05  DC    AL1(HLPCONT,CTRYCAN,0,OSHLP05Q)                                  
         DC    AL1(1)                                                           
OSHLP05Q EQU   *-OSHLP05                                                        
*                                                                               
OSHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,OSHLP06Q)                                 
         DC    AL1(15)                                                          
OSHLP06Q EQU   *-OSHLP06                                                        
*                                                                               
OSHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,OSHLP07Q)                                  
         DC    AL1(40)                                                          
OSHLP07Q EQU   *-OSHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
OSHLPLNQ EQU   *-OSHLP                                                          
*                                                                               
*                                  **** RECEIVABLE ****                         
REHLP    DC    AL1(ACTNRECV,REHLPLNQ)                                           
*                                                                               
REHLP01  DC    AL1(HLPKEY,CTRYUSA,0,REHLP01Q)                                   
         DC    AL1(1,2)                                                         
REHLP01Q EQU   *-REHLP01                                                        
*                                                                               
REHLP02  DC    AL1(HLPKEY,CTRYCAN,0,REHLP02Q)                                   
         DC    AL1(1,2)                                                         
REHLP02Q EQU   *-REHLP02                                                        
*                                                                               
REHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,REHLP03Q)                                  
         DC    AL1(5)                                                           
REHLP03Q EQU   *-REHLP03                                                        
*                                                                               
REHLP04  DC    AL1(HLPCONT,CTRYUSA,0,REHLP04Q)                                  
         DC    AL1(1)                                                           
REHLP04Q EQU   *-REHLP04                                                        
*                                                                               
REHLP05  DC    AL1(HLPCONT,CTRYCAN,0,REHLP05Q)                                  
         DC    AL1(1)                                                           
REHLP05Q EQU   *-REHLP05                                                        
*                                                                               
REHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,REHLP06Q)                                 
         DC    AL1(5)                                                           
REHLP06Q EQU   *-REHLP06                                                        
*                                                                               
REHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,REHLP07Q)                                  
         DC    AL1(12,13,14,15)                                                 
REHLP07Q EQU   *-REHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
REHLPLNQ EQU   *-REHLP                                                          
*                                                                               
*                                  **** DEBTORS ****                            
DRHLP    DC    AL1(ACTNDEBT,DRHLPLNQ)                                           
*                                                                               
DRHLP01  DC    AL1(HLPKEY,CTRYUSA,0,DRHLP01Q)                                   
         DC    AL1(1,2)                                                         
DRHLP01Q EQU   *-DRHLP01                                                        
*                                                                               
DRHLP02  DC    AL1(HLPKEY,CTRYCAN,0,DRHLP02Q)                                   
         DC    AL1(1,2)                                                         
DRHLP02Q EQU   *-DRHLP02                                                        
*                                                                               
DRHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,DRHLP03Q)                                  
         DC    AL1(5)                                                           
DRHLP03Q EQU   *-DRHLP03                                                        
*                                                                               
DRHLP04  DC    AL1(HLPCONT,CTRYUSA,0,DRHLP04Q)                                  
         DC    AL1(1)                                                           
DRHLP04Q EQU   *-DRHLP04                                                        
*                                                                               
DRHLP05  DC    AL1(HLPCONT,CTRYCAN,0,DRHLP05Q)                                  
         DC    AL1(1)                                                           
DRHLP05Q EQU   *-DRHLP05                                                        
*                                                                               
DRHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,DRHLP06Q)                                 
         DC    AL1(5)                                                           
DRHLP06Q EQU   *-DRHLP06                                                        
*                                                                               
DRHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,DRHLP07Q)                                  
         DC    AL1(12,13,14,15)                                                 
DRHLP07Q EQU   *-DRHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
DRHLPLNQ EQU   *-DRHLP                                                          
*                                                                               
*                                  **** STATEMENT ****                          
STHLP    DC    AL1(ACTNSTMT,STHLPLNQ)                                           
*                                                                               
STHLP01  DC    AL1(HLPKEY,CTRYUSA,0,STHLP01Q)                                   
         DC    AL1(1,2)                                                         
STHLP01Q EQU   *-STHLP01                                                        
*                                                                               
STHLP02  DC    AL1(HLPKEY,CTRYCAN,0,STHLP02Q)                                   
         DC    AL1(1,2)                                                         
STHLP02Q EQU   *-STHLP02                                                        
*                                                                               
STHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,STHLP03Q)                                  
         DC    AL1(16)                                                          
STHLP03Q EQU   *-STHLP03                                                        
*                                                                               
STHLP04  DC    AL1(HLPCONT,CTRYUSA,0,STHLP04Q)                                  
         DC    AL1(1)                                                           
STHLP04Q EQU   *-STHLP04                                                        
*                                                                               
STHLP05  DC    AL1(HLPCONT,CTRYCAN,0,STHLP05Q)                                  
         DC    AL1(1)                                                           
STHLP05Q EQU   *-STHLP05                                                        
*                                                                               
STHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,STHLP06Q)                                 
         DC    AL1(16)                                                          
STHLP06Q EQU   *-STHLP06                                                        
*                                                                               
STHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,STHLP07Q)                                  
         DC    AL1(41)                                                          
STHLP07Q EQU   *-STHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
STHLPLNQ EQU   *-STHLP                                                          
*                                                                               
*                                  **** DETAIL BY OFFICE ****                   
DFHLP    DC    AL1(ACTNDTOF,DFHLPLNQ)                                           
*                                                                               
DFHLP01  DC    AL1(HLPKEY,CTRYUSA,0,DFHLP01Q)                                   
         DC    AL1(1,2)                                                         
DFHLP01Q EQU   *-DFHLP01                                                        
*                                                                               
DFHLP02  DC    AL1(HLPKEY,CTRYCAN,0,DFHLP02Q)                                   
         DC    AL1(1,2)                                                         
DFHLP02Q EQU   *-DFHLP02                                                        
*                                                                               
DFHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,DFHLP03Q)                                  
         DC    AL1(4)                                                           
DFHLP03Q EQU   *-DFHLP03                                                        
*                                                                               
DFHLP04  DC    AL1(HLPCONT,CTRYUSA,0,DFHLP04Q)                                  
         DC    AL1(1)                                                           
DFHLP04Q EQU   *-DFHLP04                                                        
*                                                                               
DFHLP05  DC    AL1(HLPCONT,CTRYCAN,0,DFHLP05Q)                                  
         DC    AL1(1)                                                           
DFHLP05Q EQU   *-DFHLP05                                                        
*                                                                               
DFHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,DFHLP06Q)                                 
         DC    AL1(4)                                                           
DFHLP06Q EQU   *-DFHLP06                                                        
*                                                                               
DFHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,DFHLP07Q)                                  
         DC    AL1(3,4,5,6,7,8,9,10,11)                                         
DFHLP07Q EQU   *-DFHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
DFHLPLNQ EQU   *-DFHLP                                                          
*                                                                               
*                                  **** MONTH BY OFFICE ****                    
MFHLP    DC    AL1(ACTNMNOF,MFHLPLNQ)                                           
*                                                                               
MFHLP01  DC    AL1(HLPKEY,CTRYUSA,0,MFHLP01Q)                                   
         DC    AL1(1,2)                                                         
MFHLP01Q EQU   *-MFHLP01                                                        
*                                                                               
MFHLP02  DC    AL1(HLPKEY,CTRYCAN,0,MFHLP02Q)                                   
         DC    AL1(1,2)                                                         
MFHLP02Q EQU   *-MFHLP02                                                        
*                                                                               
MFHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,MFHLP03Q)                                  
         DC    AL1(12)                                                          
MFHLP03Q EQU   *-MFHLP03                                                        
*                                                                               
MFHLP04  DC    AL1(HLPCONT,CTRYUSA,0,MFHLP04Q)                                  
         DC    AL1(1)                                                           
MFHLP04Q EQU   *-MFHLP04                                                        
*                                                                               
MFHLP05  DC    AL1(HLPCONT,CTRYCAN,0,MFHLP05Q)                                  
         DC    AL1(1)                                                           
MFHLP05Q EQU   *-MFHLP05                                                        
*                                                                               
MFHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,MFHLP06Q)                                 
         DC    AL1(12)                                                          
MFHLP06Q EQU   *-MFHLP06                                                        
*                                                                               
MFHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,MFHLP07Q)                                  
         DC    AL1(35)                                                          
MFHLP07Q EQU   *-MFHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
MFHLPLNQ EQU   *-MFHLP                                                          
*                                                                               
*                                  **** OFFICE BY MONTH ****                    
FMHLP    DC    AL1(ACTNOFMN,FMHLPLNQ)                                           
*                                                                               
FMHLP01  DC    AL1(HLPKEY,CTRYUSA,0,FMHLP01Q)                                   
         DC    AL1(1,2)                                                         
FMHLP01Q EQU   *-FMHLP01                                                        
*                                                                               
FMHLP02  DC    AL1(HLPKEY,CTRYCAN,0,FMHLP02Q)                                   
         DC    AL1(1,2)                                                         
FMHLP02Q EQU   *-FMHLP02                                                        
*                                                                               
FMHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,FMHLP03Q)                                  
         DC    AL1(12)                                                          
FMHLP03Q EQU   *-FMHLP03                                                        
*                                                                               
FMHLP04  DC    AL1(HLPCONT,CTRYUSA,0,FMHLP04Q)                                  
         DC    AL1(1)                                                           
FMHLP04Q EQU   *-FMHLP04                                                        
*                                                                               
FMHLP05  DC    AL1(HLPCONT,CTRYCAN,0,FMHLP05Q)                                  
         DC    AL1(1)                                                           
FMHLP05Q EQU   *-FMHLP05                                                        
*                                                                               
FMHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,FMHLP06Q)                                 
         DC    AL1(12)                                                          
FMHLP06Q EQU   *-FMHLP06                                                        
*                                                                               
FMHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,FMHLP07Q)                                  
         DC    AL1(35)                                                          
FMHLP07Q EQU   *-FMHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
FMHLPLNQ EQU   *-FMHLP                                                          
*                                                                               
*                                  **** STATEMENT BY OFFICE ****                
SFHLP    DC    AL1(ACTNSTOF,SFHLPLNQ)                                           
*                                                                               
SFHLP01  DC    AL1(HLPKEY,CTRYUSA,0,SFHLP01Q)                                   
         DC    AL1(1,2)                                                         
SFHLP01Q EQU   *-SFHLP01                                                        
*                                                                               
SFHLP02  DC    AL1(HLPKEY,CTRYCAN,0,SFHLP02Q)                                   
         DC    AL1(1,2)                                                         
SFHLP02Q EQU   *-SFHLP02                                                        
*                                                                               
SFHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,SFHLP03Q)                                  
         DC    AL1(16)                                                          
SFHLP03Q EQU   *-SFHLP03                                                        
*                                                                               
SFHLP04  DC    AL1(HLPCONT,CTRYUSA,0,SFHLP04Q)                                  
         DC    AL1(1)                                                           
SFHLP04Q EQU   *-SFHLP04                                                        
*                                                                               
SFHLP05  DC    AL1(HLPCONT,CTRYCAN,0,SFHLP05Q)                                  
         DC    AL1(1)                                                           
SFHLP05Q EQU   *-SFHLP05                                                        
*                                                                               
SFHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,SFHLP06Q)                                 
         DC    AL1(16)                                                          
SFHLP06Q EQU   *-SFHLP06                                                        
*                                                                               
SFHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,SFHLP07Q)                                  
         DC    AL1(41)                                                          
SFHLP07Q EQU   *-SFHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
SFHLPLNQ EQU   *-SFHLP                                                          
*                                                                               
*                                  **** PROFIT AND LOSS ****                    
PLHLP    DC    AL1(ACTNPFLS,PLHLPLNQ)                                           
*                                                                               
PLHLP01  DC    AL1(HLPKEY,CTRYUSA,0,PLHLP01Q)                                   
         DC    AL1(1)                                                           
PLHLP01Q EQU   *-PLHLP01                                                        
*                                                                               
PLHLP02  DC    AL1(HLPKEY,CTRYCAN,0,PLHLP02Q)                                   
         DC    AL1(1)                                                           
PLHLP02Q EQU   *-PLHLP02                                                        
*                                                                               
PLHLP03  DC    AL1(HLPKEY,CTRYALLQ,0,PLHLP03Q)                                  
         DC    AL1(1)                                                           
PLHLP03Q EQU   *-PLHLP03                                                        
*                                                                               
PLHLP04  DC    AL1(HLPCONT,CTRYUSA,0,PLHLP04Q)                                  
         DC    AL1(1)                                                           
PLHLP04Q EQU   *-PLHLP04                                                        
*                                                                               
PLHLP05  DC    AL1(HLPCONT,CTRYCAN,0,PLHLP05Q)                                  
         DC    AL1(1)                                                           
PLHLP05Q EQU   *-PLHLP05                                                        
*                                                                               
PLHLP06  DC    AL1(HLPCONT,CTRYALLQ,0,PLHLP06Q)                                 
         DC    AL1(1)                                                           
PLHLP06Q EQU   *-PLHLP06                                                        
*                                                                               
PLHLP07  DC    AL1(HLPOPT,CTRYALLQ,0,PLHLP07Q)                                  
         DC    AL1(0)                                                           
PLHLP07Q EQU   *-PLHLP07                                                        
*                                                                               
         DC    AL1(EOT)                                                         
PLHLPLNQ EQU   *-PLHLP                                                          
*                                                                               
         DC    AL1(EOT)                                                         
         EJECT ,                                                                
*                                                                               
***********************************************************************         
* LEDGER ATTRIBUTE TABLE                                              *         
***********************************************************************         
LDGTAB   DS    0X                  LEDGER ATTRIBUTE TABLE                       
         DC    C'S',AL1(LEDGCRD+LEDGSPOT)                                       
         DC    C'T',AL1(LEDGCRD+LEDGSPOT)                                       
         DC    C'U',AL1(LEDGCRD+LEDGSPOT+LEDGNETW)                              
         DC    C'P',AL1(LEDGCRD+LEDGPRNT)                                       
         DC    C'Q',AL1(LEDGCRD+LEDGPRNT)                                       
         DC    C'V',AL1(LEDGCRD+LEDGPROD)                                       
         DC    C'Y',AL1(LEDGCRD+LEDGPROD)                                       
         DC    C'W',AL1(LEDGCRD+LEDGPROD)                                       
         DC    C'X',AL1(LEDGCRD)                                                
         DC    C'R',AL1(LEDGDEB)                                                
         DC    C'A',AL1(LEDGDEB)                                                
         DC    C'B',AL1(LEDGDEB)                                                
         DC    AL1(EOT)                                                         
         EJECT                                                                  
*                                                                               
***********************************************************************         
* TABLE OF DEFAULT CURRENCY CODES FOR ALL COUNTRIES                   *         
***********************************************************************         
DFCTAB   DS    0XL4                                                             
       ++INCLUDE ACCURTAB                                                       
DFCTABX  DC    AL1(EOT)                                                         
         EJECT                                                                  
*                                                                               
***********************************************************************         
* TABLE OF ELEMENT ADDRESSES COVERED BY 'ELETABD'                     *         
***********************************************************************         
ELETAB   DS    0X                                                               
*                                                                               
         DC    AL1(PRTELQ,0),AL2(APRTELD-WORKD) PERSONNEL RATE                  
         DC    AL1(MDTELQ,0),AL2(AMDTELD-WORKD) MEDIA TRANSFER                  
         DC    AL1(CPJELQ,0),AL2(ACPJELD-WORKD) CLI/PRO/JOB                     
         DC    AL1(SPAELQ,0),AL2(ASPAELD-WORKD) SPECIAL POSTING                 
         DC    AL1(APEELQ,0),AL2(AAPEELD-WORKD) ANALYSIS POINTER                
         DC    AL1(OTHELQ,0),AL2(AOTHELD-WORKD) OTHERS                          
         DC    AL1(FFNELQ,0),AL2(AFFNELD-WORKD) FREE FORM NUMBER                
         DC    AL1(DUEELQ,0),AL2(ADUEELD-WORKD) DUE DATE                        
         DC    AL1(SCIELQ,0),AL2(ASCIELD-WORKD) SUBSIDIARY CASH                 
         DC    AL1(AFPELQ,0),AL2(AAFPELD-WORKD) ARTISTE FEE PAYMENT             
         DC    AL1(MPYELQ,0),AL2(AMPYELD-WORKD) MANUAL PAYMENT                  
         DC    AL1(RALELQ,0),AL2(ARALELD-WORKD) RECEIVABLE ALLOCATION           
         DC    AL1(PCIELQ,0),AL2(APCIELD-WORKD) PROJECT CONTROL INFO            
         DC    AL1(NAMELQ,0),AL2(ANAMELD-WORKD) NAME                            
         DC    AL1(JOBELQ,0),AL2(AJOBELD-WORKD) PRODUCTION JOB                  
         DC    AL1(ADRELQ,0),AL2(AADRELD-WORKD) ADDRESS                         
         DC    AL1(FFTELQ,0),AL2(AFFTELD-WORKD) FREE FORM TEXT                  
         DC    AL1(AFCELQ,0),AL2(AAFCELD-WORKD) ACCOUNT FOREIGN CURRY           
         DC    AL1(SORELQ,0),AL2(ASORELD-WORKD) SOURCE                          
         DC    AL1(RATEVATQ,0),AL2(ARATELD-WORKD) VAT RATE                      
         DC    AL1(RATETAXQ,0),AL2(ARATELD-WORKD) FREELANCE TAX                 
         DC    AL1(RATEDSCQ,0),AL2(ARATELD-WORKD) DISCOUNT                      
         DC    AL1(PXDELQ,0),AL2(APXDELD-WORKD) TRANSFER INFORAMTION            
         DC    AL1(VBIELQ,0),AL2(AVBIELD-WORKD) VAT BILLED                      
         DC    AL1(PBIELQ,0),AL2(APBIELD-WORKD) PST BILLED                      
         DC    AL1(TPRELQ,0),AL2(ATPRELD-WORKD) PRICE LIST INFORMATION          
         DC    AL1(TRNELQ,0),AL2(ATRNELD-WORKD) TRANSACTION                     
         DC    AL1(TRSELQ,0),AL2(ATRSELD-WORKD) TRANSACTION STATUS              
         DC    AL1(UNPELQ,0),AL2(AUNPELD-WORKD) UNIT PRICE                      
         DC    AL1(BNDELQ,0),AL2(ABNDELD-WORKD) BILL NUMBER/DATE                
         DC    AL1(PTAELQ,0),AL2(APTAELD-WORKD) PROD TRAN ACTIVITY              
         DC    AL1(MXPELQ,0),AL2(AMXPELD-WORKD) MEDIA EXTRA PAYMENT             
         DC    AL1(XPYELQ,0),AL2(AXPYELD-WORKD) XTRA PAYMENT ELEMENT            
         DC    AL1(GINELQ,0),AL2(AGINELD-WORKD) GROUP INVOICE ELEMENT           
         DC    AL1(GDAELQ,0),AL2(AGDAELD-WORKD) GENERAL DATE ELEMENT            
         DC    AL1(PIDELQ,0),AL2(APIDELD-WORKD) PERSON ID ELEMENT               
         DC    AL1(PAKELQ,0),AL2(APAKELD-WORKD) PAYABLE KEY ELEMENT             
         DC    AL1(MBIELQ,0),AL2(AMBIELD-WORKD) NEW BILLING XFER ELEM           
         DC    AL1(RACELQ,0),AL2(ARACELD-WORKD) RECORD ACTIVITY ELEM            
         DC    AL1(MDPELQ,0),AL2(AMDPELD-WORKD) MEDIA TRANSFER PACKED           
*---------------------------*                                                   
* TSAR RECORD ELEMENTS ONLY *                                                   
*---------------------------*                                                   
         DC    AL1(ELETSARQ,NARELQ),AL2(ANARELD-WORKD) NARRATIVE                
         DC    AL1(ELETSARQ,CFWVELQ),AL2(ACFVELD-WORKD) NARRATIVE               
         DC    AL1(ELETSARQ,CFWRELQ),AL2(ACFRELD-WORKD) NARRATIVE               
ELETABX  DC    AL1(EOT)                                                         
         EJECT                                                                  
*                                                                               
***********************************************************************         
*        DISPLAY COLUMNS                                              *         
***********************************************************************         
DISTAB   DS    0X                  DISLPAY COLUMNS                              
*                                                                               
DISCR    DC    AL1(COLOFFQ,BLDSOFFC+1-BLDSDSP),AL1(2,0)          1              
         DC    AL1(0)                                                           
         DCDDL AC#OFF,2,L                                                       
         DC    XL1'00'                                                          
         DCDDL AC#OFF,2,LU                                                      
*---------------------------------------------------------------------*         
* NOTE: THE PREVIOUS VERSION OF FIS HAD A SPECIFIC SET OF                       
*       COLUMNS ON THE FIRST SCREEN OF THE DEFAULT VE RECORD                    
*       DISPLAY INFORMATION.                                                    
*       WHENEVER, THE USER REDESIGNED THE VE RECORD DISPLAY                     
*       SCREEN TO EXACTLY FILL THE SCREEN, AND THE "CHECK DATE"                 
*       COLUMN WAS RIGHT BEFORE A NON-NUMERIC COLUMN; THEN                      
*       THERE WAS NEVER A BLANK BETWEEN THESE TWO COLUMNS.                      
*       THE NEW VERSION OF FIS FIXED THE "CHECK DATE" COLUMN                    
*       TO BE 8 CHARACTERS WIDE (MMMDD/YY) INSTEAD OF 7                         
*       CHARACTERS WIDE.                                                        
*       HOWEVER, IN ORDER TO GET ALL OF THE COLUMNS ON THE                      
*       FIRST SCREEN OF THE DEFAULT VE RECORD DISPLAY, WE HAD                   
*       TO REDUCE THE WIDTH OF ONE OF THE SCREEN'S COLUMNS.                     
*       PAM SHAPIRO DECIDED THAT THE USERS RARELY USE ALL                       
*       14 COLUMNS OF THE CONTRA ACCOUNT FIELD (UNIT/LEDGER AND                 
*       ACCOUNT), THEREFORE, THE WIDTH OF THIS COLUMN WAS                       
*       REDUCED BY ONE.                                                         
*---------------------------------------------------------------------*         
*        DC    AL1(COLCONQ,BLDSCACT+1-BLDSDSP),AL1(14,0)         3              
         DC    AL1(COLCONQ,BLDSCACT+1-BLDSDSP),AL1(13,0)         3              
         DC    AL1(0)                                                           
         DCDDL AC#CTRA,14,L                                                     
         DCDDL AC#CTRA,14,LU                                                    
*                                                                               
         DC    AL1(COLDATQ,BLDSDATE+1-BLDSDSP),AL1(8,0)          4              
         DC    AL1(0)                                                           
         DCDDL AC#DATE,8,L                                                      
         DCDDL AC#DATE,8,LU                                                     
*                                                                               
         DC    AL1(COLREFQ,BLDSREF+1-BLDSDSP),AL1(6,0)           5              
         DC    AL1(0)                                                           
         DCDDL AC#REF,6,L                                                       
         DCDDL AC#REF,6,LU                                                      
*                                                                               
         DC    AL1(COLMOSQ,BLDSMOS+1-BLDSDSP),AL1(5,0)           6              
         DC    AL1(0)                                                           
         DCDDL AC#MOS,5,L                                                       
         DCDDL AC#MOS,5,LU                                                      
*                                                                               
         DC    AL1(COLBATQ,BLDSBREF+1-BLDSDSP),AL1(6,0)          7              
         DC    AL1(0)                                                           
         DCDDL AC#BAT,6,L                                                       
         DCDDL AC#BAT,6,LU                                                      
*                                                                               
         DC    AL1(COLNETQ,BLDSNET+1-BLDSDSP),AL1(13,0)          8              
         DC    AL1(0)                                                           
         DCDDL AC#NET,13,R                                                      
         DCDDL AC#NET,13,RU                                                     
*                                                                               
         DC    AL1(COLCRSQ,BLDSCRAM+1-BLDSDSP),AL1(13,0)         A              
         DC    AL1(0)                                                           
         DCDDL AC#CRS,13,R                                                      
         DCDDL AC#CRS,13,RU                                                     
*                                                                               
         DC    AL1(COLJOBQ,BLDSJOB+1-BLDSDSP),AL1(12,0)          C              
         DC    AL1(0)                                                           
         DCDDL AC#JOEST,12,L                                                    
         DCDDL AC#JOEST,12,LU                                                   
*                                                                               
         DC    AL1(COLSRCQ,BLDSSRCA+1-BLDSDSP),AL1(14,0)         D              
         DC    AL1(0)                                                           
         DCDDL AC#SRC,14,L                                                      
         DCDDL AC#SRC,14,LU                                                     
*                                                                               
         DC    AL1(COLPYMQ,BLDSCHQ+1-BLDSDSP),AL1(7,0)           E              
         DC    AL1(0)                                                           
         DCDDL AC#CHK,7,L                                                       
         DCDDL AC#NUM,7,L                                                       
*                                                                               
         DC    AL1(COLNUMQ,BLDSRNUM+1-BLDSDSP),AL1(6,0)          I              
         DC    AL1(0)                                                           
         DCDDL AC#REC,6,L                                                       
         DCDDL AC#REC,6,LU                                                      
*                                                                               
         DC    AL1(COLDSCQ,BLDSDSCA+1-BLDSDSP),AL1(8,0)          J              
         DC    AL1(0)                                                           
         DCDDL AC#DISS,8,R                                                      
         DCDDL AC#AMT,8,R                                                       
*                                                                               
         DC    AL1(COLGSTQ,BLDSGST+1-BLDSDSP),AL1(13,0)          K              
         DC    AL1(0)                                                           
         DCDDL AC#VAT,13,R                                                      
         DCDDL AC#VAT,13,RU                                                     
*                                                                               
         DC    AL1(COLADAQ,BLDSADAT+1-BLDSDSP),AL1(8,0)          M              
         DC    AL1(0)                                                           
         DCDDL AC#DATAD,8,L                                                     
         DCDDL AC#DATAD,8,LU                                                    
*                                                                               
         DC    AL1(COLBTYQ,BLDSBTYP+1-BLDSDSP),AL1(5,0)          N              
         DC    AL1(0)                                                           
         DCDDL AC#BAT1,5,L                                                      
         DCDDL AC#TYPE,5,L                                                      
*                                                                               
         DC    AL1(COLPSTQ,BLDSPST+1-BLDSDSP),AL1(20,0)          P              
         DC    AL1(0)                                                           
         DCDDL AC#PST,20,R                                                      
         DCDDL AC#PST,20,RU                                                     
*                                                                               
         DC    AL1(COLXSTQ,BLDSXST+1-BLDSDSP),AL1(VECXSTQ,10)    Q              
         DC    AL1(0)                             20                            
         DCDDL AC#STT,10,L                                                      
         DCDDL AC#STT,10,LU                                                     
*                                                                               
         DC    AL1(COLUSEQ,BLDSCTRD+1-BLDSDSP),AL1(8,0)          R              
         DC    AL1(0)                                                           
         DCDDL AC#CTRD,8,L                                                      
         DCDDL AC#CTRD,8,LU                                                     
*                                                                               
         DC    AL1(COLMINQ,BLDSMIN+1-BLDSDSP),AL1(20,14)         S              
         DC    AL1(0)                                                           
         DCDDL AC#INVC2,14,L                                                    
         DCDDL AC#INVC2,14,LU                                                   
*                                                                               
         DC    AL1(COLPERDQ,BLDSPERD+1-BLDSDSP),AL1(17,7)        T              
         DC    AL1(0)                                                           
         DCDDL AC#PERD,7,L                                                      
         DCDDL AC#PERD,7,LU                                                     
*                                                                               
         DC    AL1(COLNARRQ,BLDSNARR+1-BLDSDSP),AL1(VECNARRQ,10) U              
         DC    AL1(0)                               45                          
         DCDDL AC#NRTV,10,L                                                     
         DCDDL AC#NRTV,10,LU                                                    
*                                                                               
         DC    AL1(COLMMOSQ,BLDSMMOS+1-BLDSDSP),AL1(6,3)         V              
         DC    AL1(DISUPPRQ)                                                    
         DCDDL AC#MOS,3,L                                                       
         DC    X'00'                                                            
         DCDDL AC#MOS,3,LU                                                      
*                                                                               
         DC    AL1(COLPDUEQ,BLDSPDUE+1-BLDSDSP),AL1(8,0)         W              
         DC    AL1(0)                                                           
         DCDDL AC#DUE,8,L                                                       
         DCDDL AC#DUE,8,LU                                                      
*                                                                               
         DC    AL1(COLPDATQ,BLDSCDAT+1-BLDSDSP),AL1(8,0)         Y              
         DC    AL1(0)                                                           
         DCDDL AC#CHK,8,L                                                       
         DCDDL AC#DATE,8,L                                                      
*                                                                               
         DC    AL1(COLTSTAQ,BLDSTSTA+1-BLDSDSP),AL1(2,0)         #              
         DC    AL1(DISDDSQ)                                                     
         DCDDL AC#STT,2,L                                                       
         DC    X'00'                                                            
         DCDDL AC#STT,2,LU                                                      
*                                                                               
         DC    AL1(COLTSRFQ,BLDSTSRF+1-BLDSDSP),AL1(3,0)         <              
         DC    AL1(DISDDSQ)                                                     
         DCDDL AC#SUBR,3,L                                                      
         DC    X'00'                                                            
         DCDDL AC#SUBR,3,LU                                                     
*                                                                               
         DC    AL1(COLDAQ,BLDSDA+1-BLDSDSP),AL1(8,0)             (              
         DC    AL1(DISDDSQ)                                                     
         DCDDL AC#ADR,8,L                                                       
         DCDDL AC#ADR,8,LU                                                      
*                                                                               
DISCRX   DC    AL1(EOT)                                                         
*                                                                               
DISPL    DC    AL1(PL#CAC,BPLCAC+1-BLDSDSP),AL1(14,0)            3              
         DC    AL1(0)                                                           
         DCDDL AC#CTRA,14,L                                                     
         DCDDL AC#CTRA,14,LU                                                    
*                                                                               
         DC    AL1(PL#CACN,BPLCACN+1-BLDSDSP),AL1(30,10)         4              
         DC    AL1(0)                                                           
         DCDDL AC#NAME,10,L                                                     
         DCDDL AC#NAME,10,LU                                                    
*                                                                               
         DC    AL1(PL#AAMT,BPLAAMT+1-BLDSDSP),AL1(13,12)         5              
         DC    AL1(0)                                                           
         DCDDL AC#AMT,12,R                                                      
         DCDDL AC#AMT,12,RU                                                     
*                                                                               
         DC    AL1(PL#PAMT,BPLPAMT+1-BLDSDSP),AL1(13,12)         6              
         DC    AL1(0)                                                           
         DCDDL AC#PRYTD,12,R                                                    
         DCDDL AC#PRYTD,12,RU                                                   
*                                                                               
         DC    AL1(PL#ASAL,BPLASAL+1-BLDSDSP),AL1(13,12)         7              
         DC    AL1(0)                                                           
         DCDDL AC#SLRY,12,R                                                     
         DCDDL AC#SLRY,12,RU                                                    
*                                                                               
         DC    AL1(PL#APEN,BPLAPEN+1-BLDSDSP),AL1(13,12)         8              
         DC    AL1(0)                                                           
         DCDDL AC#APG76,12,R                                                    
         DCDDL AC#APG76,12,RU                                                   
*                                                                               
         DC    AL1(PL#ABEN,BPLABEN+1-BLDSDSP),AL1(13,12)         9              
         DC    AL1(0)                                                           
         DCDDL AC#BEN,12,R                                                      
         DCDDL AC#BEN,12,RU                                                     
*                                                                               
         DC    AL1(PL#AIND,BPLAIND+1-BLDSDSP),AL1(13,12)         A              
         DC    AL1(0)                                                           
         DCDDL AC#IDR,12,R                                                      
         DCDDL AC#IDR,12,RU                                                     
*                                                                               
DISPLX   DC    AL1(EOT)                                                         
*                                                                               
DISTABX  DC    AL1(EOT)                                                         
         EJECT ,                                                                
***********************************************************************         
*        OPTION TABLE                                                 *         
***********************************************************************         
*--------------------*                                                          
* SPECIAL MOA OPTION *                                                          
*--------------------                                                           
MO       DC    AL2(UP@MOA2S-WORKD,UP@MOA2L-WORKD)  MOA=MMM/YY                   
         DC    AL1(MOLNQ)                          MO=MMM/YY                    
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,OMOS-OPTVALSD)                                 
         DC    AL1(ACTNALLX,ACTNODLI,ACTNODSM,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
MOLNQ    EQU   *-MO                                                             
*                                                                               
*----------------------------------*                                            
* GENERAL OPTION TABLE STARTS HERE *                                            
*----------------------------------*                                            
OPTTAB   DS    0X                  OPTION TABLE COVERED BY OPTTABD              
*                                                                               
AC       DC    AL2(UP@ACTS-WORKD,UP@ACTL-WORKD)    ACTDATE=MMMDD/YY             
         DC    AL1(ACLNQ)                          AD=MMMDD/YY                  
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,OACT-OPTVALSD)                                 
         DC    AL1(ACTNLSLT,ACTNLIST,ACTNODLI,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ACLNQ    EQU   *-AC                                                             
*                                                                               
ADD      DC    AL2(UP@ADDS-WORKD,UP@ADDL-WORKD)    ADDED=MMMDD/YY               
         DC    AL1(ADDLNQ)                         AD=MMMDD/YY                  
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,OACT-OPTVALSD)                                 
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNJBBL,ACTNCRED,ACTNVEND)                
         DC    AL1(ACTNDTOF,ACTNJBCF,ACTNVICF,ACTNODLI,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ADDLNQ   EQU   *-ADD                                                            
*                                                                               
AG       DC    AL2(UP@AGEIS-WORKD,UP@AGEIL-WORKD)  AGEING=DUE/BILL/MOS          
         DC    AL1(AGLNQ)                          AG=DUE/BILL/MOS              
         DC    AL1(5,0)                                                         
         DC    AL2(VALAGEBY-T62000,OAGEBY-OPTVALSD)                             
         DC    AL1(ACTNRECV,ACTNDEBT,ACTNRAGE,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
AGLNQ    EQU   *-AG                                                             
*                                                                               
ALL      DC    AL2(UP@ALLS-WORKD,UP@ALLL-WORKD)    ALL=ZERO                     
         DC    AL1(ALLNQ)                          AL=ZERO                      
         DC    AL1(4,OPTDDSQ)                                                   
         DC    AL2(VALZERO-T62000,OALL-OPTVALSD)                                
         DC    AL1(ACTNLSLT,ACTNLIST,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ALLNQ    EQU   *-ALL                                                            
*                                                                               
ALLT     DC    AL2(UP@ALLS-WORKD,UP@ALLL-WORKD)    ALL=YES/NO                   
         DC    AL1(ALLTLNQ)                        AL=YES/NO                    
         DC    AL1(4,OPTDDSQ)                                                   
         DC    AL2(VALYN-T62000,OALLTRAN-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ALLTLNQ  EQU   *-ALLT                                                           
*                                                                               
DALL     DC    AL2(UP@ALLDS-WORKD,UP@ALLDL-WORKD)  ALLDET=YES/NO                
         DC    AL1(DALLLNQ)                        AL=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,OALLDET-OPTVALSD)                               
         DC    AL1(ACTNPFLS,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
DALLLNQ  EQU   *-DALL                                                           
*                                                                               
AM       DC    AL2(UP@AMTS-WORKD,UP@AMTL-WORKD)    AMOUNT=9999999999            
         DC    AL1(AMLNQ)                          AM=999999999                 
         DC    AL1(14,0)                                                        
         DC    AL2(VALAMT-T62000,OAMOUNT-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNCRED,ACTNVEND)                
         DC    AL1(ACTNDTOF,ACTNJBCF,ACTNVICF,ACTNRNSU,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
AMLNQ    EQU   *-AM                                                             
*                                                                               
AP       DC    AL2(UP@APRVS-WORKD,UP@APRVL-WORKD)  APPROVED=YES/NO/ONLY         
         DC    AL1(APLNQ)                          AP=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OSELECT-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNCRED,ACTNVEND,ACTNDTOF,ACTNVICF)                
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SF',C'SS',C'ST',C'SU',C'SP',C'SQ',C'SV'          
         DC    C'SY',C'SW',C'SX',AL2(0,0,0,0,0)                                 
         DC    AL1(ACTNDTOF),C'SF',C'SS',C'ST',C'SU',C'SP',C'SQ',C'SV'          
         DC    C'SY',C'SW',C'SX',AL2(0,0,0,0,0)                                 
APLNQ    EQU   *-AP                                                             
*                                                                               
AT       DC    AL2(UP@ATTRS-WORKD,UP@ATTRL-WORKD)  ATTRIBUTE=YES/NO             
         DC    AL1(ATLNQ)                          AT=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,OATTRIB-OPTVALSD)                               
         DC    AL1(ACTNDETL,ACTNDTOF,ACTNJBDE,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ATLNQ    EQU   *-AT                                                             
*                                                                               
AU       DC    AL2(UP@ATHS-WORKD,UP@ATHL-WORKD)   AUTHORISE=YES/NO/ONLY         
         DC    AL1(AULNQ)                         AU=YES/NO/ONLY                
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OAUTH-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNCRED,ACTNVEND)                
         DC    AL1(ACTNDTOF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SE',C'SQ',C'SV',C'SX',C'SJ',AL2(0,0,0,0)         
         DC    AL2(0,0,0,0,0,0)                                                 
         DC    AL1(ACTNCRED),C'SV',C'SX',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0)         
         DC    AL1(ACTNVEND),C'SV',C'SX',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0)         
         DC    AL1(ACTNDTOF),C'SE',C'SQ',C'SV',C'SX',C'SJ',AL2(0,0,0,0)         
         DC    AL2(0,0,0,0,0,0)                                                 
AULNQ    EQU   *-AU                                                             
*                                                                               
BALA     DC    AL2(UP@BALS-WORKD,UP@BALL-WORKD)    BALANCE=OUT                  
         DC    AL1(BALALNQ)                        BA=OUT                       
         DC    AL1(5,0)                                                         
         DC    AL2(VALOUT-T62000,OOUT-OPTVALSD)                                 
         DC    AL1(ACTNLSLT,ACTNLIST,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
BALALNQ  EQU   *-BALA                                                           
*                                                                               
BAT      DC    AL2(UP@BATS-WORKD,UP@BATL-WORKD)    BATCH=AAAAAA                 
         DC    AL1(BATLNQ)                         BA=AAAAAA                    
         DC    AL1(14,0)                                                        
         DC    AL2(VALSTRNG-T62000,OBATCH-OPTVALSD)                             
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNCRED,ACTNVEND)                
         DC    AL1(ACTNDTOF,ACTNJBCF,ACTNVICF,ACTNRNSU,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
BATLNQ   EQU   *-BAT                                                            
*                                                                               
BAS      DC    AL2(UP@BASIS-WORKD,UP@BASIL-WORKD)  BASIS=YES/NO                 
         DC    AL1(BASLNQ)                         BA=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,OBASIS-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SG',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'SG',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
BASLNQ   EQU   *-BAS                                                            
*                                                                               
BFWD     DC    AL2(UP@BFWDS-WORKD,UP@BFWDL-WORKD)  BFWD=YES/NO                  
         DC    AL1(BFWDLNQ)                        BF=YES/NO                    
         DC    AL1(4,0)                                                         
         DC    AL2(VALYN-T62000,OBFWD-OPTVALSD)                                 
         DC    AL1(ACTNMNTH,ACTNMNOF,ACTNOFMN,ACTNSTOF,ACTNLSLT)                
         DC    AL1(ACTNLIST,ACTNSTMT,ACTNCONT,ACTNNBUD,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
BFWDLNQ  EQU   *-BFWD                                                           
*                                                                               
BI       DC    AL2(UP@BLDS-WORKD,UP@BLDL-WORKD)    BILLED=EST/OVER/UNDR         
         DC    AL1(BILNQ)                          BI=EST/OVER/UNDR             
         DC    AL1(10,0)                                                        
         DC    AL2(VALEOU-T62000,OBILLED-OPTVALSD)                              
         DC    AL1(ACTNJBES,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
BILNQ    EQU   *-BI                                                             
*                                                                               
BIL      DC    AL2(UP@BLDS-WORKD,UP@BLDL-WORKD)    BILLED=YES/NO/ONLY           
         DC    AL1(BILLNQ)                         BI=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OBILLED-OPTVALSD)                              
         DC    AL1(ACTNJBBL,ACTNJBDE,ACTNJBCF,ACTNVICF,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
BILLNQ   EQU   *-BIL                                                            
*                                                                               
BILN     DC    AL2(UP@BILNS-WORKD,UP@BILNL-WORKD)  BILLNUM=AAAAAA               
         DC    AL1(BILNLNQ)                        BN=AAAAAA                    
         DC    AL1(14,0)                                                        
         DC    AL2(VALSTRNG-T62000,OBILNO-OPTVALSD)                             
         DC    AL1(ACTNJBBL,ACTNRECV,ACTNDEBT,ACTNRAGE,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
BILNLNQ  EQU   *-BILN                                                           
*                                                                               
*AP      DC    AL2(UP@BLDS-WORKD,UP@BLDL-WORKD)    BILLED PAID                  
*        DC    AL1(BAPLNQ)                         BP=YES/NO/ONLY               
*        DC    AL1(4,0)                                                         
*        DC    AL2(VALYNO-T62000,O      -OPTVALSD)                              
*        DC    AL1(ACTNVICF,0,0,0,0)                                            
*        DC    AL1(0,0,0,0,0)                                                   
*        DC    AL1(0,0,0,0,0)                                                   
*        DC    AL1(0,0,0,0,0)                                                   
*APLNQ   EQU   *-BAP                                                            
*                                                                               
BT       DC    AL2(UP@BUCKS-WORKD,UP@BUCKL-WORKD)  BUCKTYPE=A                   
         DC    AL1(BTLNQ)                          BT=A                         
         DC    AL1(1,0)                                                         
         DC    AL2(VALMOVE-T62000,OBUKTYP-OPTVALSD)                             
         DC    AL1(ACTNCONT,ACTNMNTH,ACTNMNOF,ACTNOFMN,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNCONT),C'ST',C'SG',C'SI',C'41',C'1R',C'1J',C'1C'          
         DC    AL2(0,0,0,0,0,0,0,0)                                             
         DC    AL1(ACTNMNTH),C'ST',C'SG',C'SI',C'41',C'1R',C'1J',C'1C'          
         DC    AL2(0,0,0,0,0,0,0,0)                                             
         DC    AL1(ACTNMNOF),C'ST',C'SG',C'SI',C'41',C'1R',C'1J',C'1C'          
         DC    AL2(0,0,0,0,0,0,0,0)                                             
         DC    AL1(ACTNOFMN),C'ST',C'SG',C'SI',C'41',C'1R',C'1J',C'1C'          
         DC    AL2(0,0,0,0,0,0,0,0)                                             
BTLNQ    EQU   *-BT                                                             
*                                                                               
CD       DC    AL2(UP@CHQDS-WORKD,UP@CHQDL-WORKD)  CDATE=MMMDD/YY               
         DC    AL1(CDLNQ)                          CD=MMMDD/YY                  
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,OPAYDATE-OPTVALSD)                             
         DC    AL1(ACTNDETL,ACTNVEND,ACTNRECV,ACTNDTOF,ACTNRAGE)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SS',C'ST',C'SU',C'SP',C'SQ',C'SV',C'SY'          
         DC    C'SW',C'SX',C'SR',AL2(0,0,0,0,0)                                 
         DC    AL1(ACTNDTOF),C'SS',C'ST',C'SU',C'SP',C'SQ',C'SV',C'SY'          
         DC    C'SW',C'SX',C'SR',AL2(0,0,0,0,0)                                 
         DC    AL1(ACTNRAGE),C'SR',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
CDLNQ    EQU   *-CD                                                             
*                                                                               
CF       DC    AL2(UP@CFYS-WORKD,UP@CFYL-WORKD)    CF=Y/N                       
         DC    AL1(CFLNQ)                         (CURRENT FISCAL YEAR)         
         DC    AL1(2,0)                                                         
         DC    AL2(VALYN-T62000,OCF-OPTVALSD)                                   
         DC    AL1(ACTNLSLT,ACTNMNTH,ACTNMNOF,ACTNOFMN,ACTNCONT)                
         DC    AL1(ACTNLIST,ACTNSTMT,ACTNSTOF,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
CFLNQ    EQU   *-CF                                                             
*                                                                               
CHG      DC    AL2(UP@CHGSS-WORKD,UP@CHGSL-WORKD)                               
         DC    AL1(CHGLNQ)                       CHARGES=EST/OVER/UNDER         
         DC    AL1(10,0)                           CH=EST/OVER/UNDER            
         DC    AL2(VALEOU-T62000,OCHARGE-OPTVALSD)                              
         DC    AL1(ACTNJBES,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
CHGLNQ   EQU   *-CHG                                                            
*                                                                               
CH       DC    AL2(UP@CHKS-WORKD,UP@CHKL-WORKD)    CHEQUE=AAAAAA (UK)           
         DC    AL1(CHLNQ)                          CHECK=AAAAAA  (US)           
         DC    AL1(14,0)                           CH=AAAAAA                    
         DC    AL2(VALSTRNG-T62000,OPAYREF-OPTVALSD)                            
         DC    AL1(ACTNDETL,ACTNVEND,ACTNRECV,ACTNDTOF,ACTNRAGE)                
         DC    AL1(ACTNVICF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SS',C'ST',C'SU',C'SP',C'SQ',C'SV',C'SY'          
         DC    C'SW',C'SX',C'SR',C'SC',AL2(0,0,0,0,0)                           
         DC    AL1(ACTNDTOF),C'SS',C'ST',C'SU',C'SP',C'SQ',C'SV',C'SY'          
         DC    C'SW',C'SX',C'SR',C'SC',AL2(0,0,0,0,0)                           
CHLNQ    EQU   *-CH                                                             
*                                                                               
CK       DC    AL2(UP@CHKCS-WORKD,UP@CHKCL-WORKD)    CNUM=AAAAAA (UK)           
         DC    AL1(CKLNQ)                            CN=AAAAAA   (UK)           
         DC    AL1(14,0)                             CKNO=AAAAAA (US)           
         DC    AL2(VALSTRNG-T62000,OPAYREF-OPTVALSD) CK=AAAAAA   (US)           
         DC    AL1(ACTNDETL,ACTNVEND,ACTNRECV,ACTNDTOF,ACTNRAGE)                
         DC    AL1(ACTNVICF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SS',C'ST',C'SU',C'SP',C'SQ',C'SV',C'SY'          
         DC    C'SW',C'SX',C'SR',C'SC',AL2(0,0,0,0,0)                           
         DC    AL1(ACTNDTOF),C'SS',C'ST',C'SU',C'SP',C'SQ',C'SV',C'SY'          
         DC    C'SW',C'SX',C'SR',C'SC',AL2(0,0,0,0,0)                           
CKLNQ    EQU   *-CK                                                             
*                                                                               
CLI      DC    AL2(UP@CLINS-WORKD,UP@CLINL-WORKD)  CLIENT=AAAAAA                
         DC    AL1(CLILNQ)                         CL=AAAAAA                    
         DC    AL1(14,0)                                                        
         DC    AL2(VALCLPR-T62000,OCLIENT-OPTVALSD)                             
         DC    AL1(ACTNODLI,ACTNDETL,ACTNCRED,ACTNVEND,ACTNDTOF)                
         DC    AL1(ACTNVICF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SV',C'ST',C'SR',C'SI',C'1R',C'SP',C'SQ'          
         DC    C'SS',C'SU',C'SW',C'SX',C'SY',C'1C',AL2(0,0)                     
         DC    AL1(ACTNDTOF),C'SV',C'ST',C'SR',C'SI',C'1R',C'SP',C'SQ'          
         DC    C'SS',C'SU',C'SW',C'SX',C'SY',C'1C',AL2(0,0)                     
CLILNQ   EQU   *-CLI                                                            
*                                                                               
CL       DC    AL2(UP@CLSDS-WORKD,UP@CLSDL-WORKD)  CLOSED=YES/NO/ONLY           
         DC    AL1(CLLNQ)                          CL=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OCLOSED-OPTVALSD)                              
         DC    AL1(ACTNJBES,ACTNLSLT,ACTNODSM,ACTNLIST,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNLSLT),C'SJ',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNLIST),C'SJ',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
CLLNQ    EQU   *-CL                                                             
*                                                                               
CRE      DC    AL2(UP@CRS-WORKD,UP@CRL-WORKD)      CREDIT=ZERO                  
         DC    AL1(CRELNQ)                         CR=ZERO                      
         DC    AL1(4,0)                                                         
         DC    AL2(VALZERO-T62000,OCREDIT-OPTVALSD)                             
         DC    AL1(ACTNLSLT,ACTNLIST,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
CRELNQ   EQU   *-CRE                                                            
*                                                                               
CRED     DC    AL2(UP@CRS-WORKD,UP@CRL-WORKD)      CREDIT=YES/NO/ONLY           
         DC    AL1(CREDLNQ)                        CR=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OCREDIT-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNDTOF,ACTNJBCF)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
CREDLNQ  EQU   *-CRED                                                           
*                                                                               
DA       DC    AL2(UP@DATES-WORKD,UP@DATEL-WORKD)  DATE=MMMDD/YY                
         DC    AL1(DALNQ)                          DA=MMMDD/YY                  
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,ODATE-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNODDE,ACTNRECV)                
         DC    AL1(ACTNVEND,ACTNJBST,ACTNETIM,ACTNCRED,ACTNDEBT)                
         DC    AL1(ACTNODLI,ACTNDTOF,ACTNRAGE,ACTNJBCF,ACTNVICF)                
         DC    AL1(ACTNRNSU,ACTNESTL,0,0,0)                                     
DALNQ    EQU   *-DA                                                             
*                                                                               
DDA      DC    AL2(UP@DPSDS-WORKD,UP@DPSDL-WORKD)  DDATE=MMDDYY                 
         DC    AL1(DDALNQ)                         DD=MMDDYY                    
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,ODDATE-OPTVALSD)                               
         DC    AL1(ACTNRECV,ACTNRAGE,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNRAGE),C'SR',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
DDALNQ   EQU   *-DDA                                                            
*                                                                               
DDS      DC    AL2(UP@DDSS-WORKD,UP@DDSL-WORKD)    DDS=YES/NO                   
         DC    AL1(DDSLNQ)                         DD=YES/NO                    
         DC    AL1(3,OPTDDSQ)                                                   
         DC    AL2(VALYN-T62000,ODDS-OPTVALSD)                                  
         DC    AL1(ACTNSTMT,ACTNSTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
DDSLNQ   EQU   *-DDS                                                            
*                                                                               
DEL      DC    AL2(UP@DELDS-WORKD,UP@DELDL-WORKD)  DELETED=YES/NO/ONLY          
         DC    AL1(DELLNQ)                         DE=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,ODELETED-OPTVALSD)                             
         DC    AL1(ACTNODDE,ACTNODLI,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
DELLNQ   EQU   *-DEL                                                            
*                                                                               
DET      DC    AL2(UP@DETLS-WORKD,UP@DETLL-WORKD)  DETAIL=YES/NO                
         DC    AL1(DETLNQ)                         DE=YES/NO                    
         DC    AL1(4,0)                                                         
         DC    AL2(VALYN-T62000,ODETAIL-OPTVALSD)                               
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
DETLNQ   EQU   *-DET                                                            
*                                                                               
DISP     DC    AL2(UP@DSPS-WORKD,UP@DSPL-WORKD)    DISPLAY=++                   
         DC    AL1(DISPLNQ)                        DI=++                        
         DC    AL1(20,0)                                                        
         DC    AL2(VALMOVL1-T62000,ODSP-OPTVALSD)                               
         DC    AL1(ACTNCRED,ACTNVEND,ACTNPFLS,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
DISPLNQ  EQU   *-DISP                                                           
*                                                                               
DISB     DC    AL2(UP@DISBS-WORKD,UP@DISBL-WORKD)  DISBURSED=Y/N/O              
         DC    AL1(DISBLNQ)                        DI=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OPAID-OPTVALSD)                                
         DC    AL1(ACTNCRED,ACTNVEND,ACTNJBCF,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
DISBLNQ  EQU   *-DISB                                                           
*                                                                               
DI       DC    AL2(UP@DISSS-WORKD,UP@DISSL-WORKD)  DISCOUNT=YES/NO/ONLY         
         DC    AL1(DILNQ)                          DI=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,ODISC-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNCRED,ACTNVEND,ACTNDTOF,ACTNVICF)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SV',C'SX',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0)         
         DC    AL1(ACTNDTOF),C'SV',C'SX',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0)         
DILNQ    EQU   *-DI                                                             
*                                                                               
DR       DC    AL2(UP@DRFTS-WORKD,UP@DRFTL-WORKD)  DRAFT=YES/NO/ONLY            
         DC    AL1(DRLNQ)                          DF=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,ODRAFT-OPTVALSD)                               
         DC    AL1(ACTNRAGE,ACTNDETL,ACTNJBDE,ACTNJBST,ACTNRECV)                
         DC    AL1(ACTNCRED,ACTNDEBT,ACTNVEND,ACTNDTOF,ACTNCONT)                
         DC    AL1(ACTNMNTH,ACTNMNOF,ACTNOFMN,ACTNSTMT,ACTNSTOF)                
         DC    AL1(ACTNJBCF,ACTNVICF,ACTNRNSU,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
DRLNQ    EQU   *-DR                                                             
*                                                                               
DE       DC    AL2(UP@DRS-WORKD,UP@DRL-WORKD)      DEBIT=ZERO                   
         DC    AL1(DELNQ)                          DR=ZERO                      
         DC    AL1(4,0)                                                         
         DC    AL2(VALZERO-T62000,ODEBIT-OPTVALSD)                              
         DC    AL1(ACTNLSLT,ACTNLIST,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
DELNQ    EQU   *-DE                                                             
*                                                                               
DEB      DC    AL2(UP@DRS-WORKD,UP@DRL-WORKD)      DEBIT=YES/NO/ONLY            
         DC    AL1(DEBLNQ)                         DR=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,ODEBIT-OPTVALSD)                               
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNDTOF,ACTNJBCF)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
DEBLNQ   EQU   *-DEB                                                            
*                                                                               
DU       DC    AL2(UP@DUES-WORKD,UP@DUEL-WORKD)    DUE=MMMDD/YY                 
         DC    AL1(DULNQ)                          DU=MMMDD/YY                  
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,ODUE-OPTVALSD)                                 
         DC    AL1(ACTNDETL,ACTNRECV,ACTNCRED,ACTNDEBT,ACTNVEND)                
         DC    AL1(ACTNDTOF,ACTNRAGE,ACTNVICF,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SR',C'SV',C'SW',C'SX',C'SY',C'ST'                
         DC    AL2(0,0,0,0,0,0,0,0,0)                                           
         DC    AL1(ACTNDTOF),C'SR',C'SV',C'SW',C'SX',C'SY'                      
         DC    AL2(0,0,0,0,0,0,0,0,0,0)                                         
*        DC    AL1(ACTNRAGE),C'SR',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
DULNQ    EQU   *-DU                                                             
*                                                                               
ES       DC    AL2(UP@ESTS-WORKD,UP@ESTL-WORKD)    ESTIMATE=YES/NO/ONLY         
         DC    AL1(ESLNQ)                          ES=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OEST-OPTVALSD)                                 
         DC    AL1(ACTNJBES,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ESLNQ    EQU   *-ES                                                             
*                                                                               
EST      DC    AL2(UP@ESTS-WORKD,UP@ESTL-WORKD)    ESTIMATE=AAAAAA              
         DC    AL1(ESTLNQ)                         ES=AAAAAA                    
         DC    AL1(26,0)                                                        
         DC    AL2(VALSTRNG-T62000,OESTIMAT-OPTVALSD)                           
         DC    AL1(ACTNDETL,ACTNDTOF,ACTNVEND,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SS',C'ST',C'SU',C'SP',C'SQ',C'SR',C'SI'          
         DC    AL2(0,0,0,0,0,0,0,0)                                             
         DC    AL1(ACTNDTOF),C'SS',C'ST',C'SU',C'SP',C'SQ',C'SR',C'SI'          
         DC    AL2(0,0,0,0,0,0,0,0)                                             
         DC    AL1(ACTNVEND),C'SS',C'ST',C'SU',C'SP',C'SQ'                      
         DC    AL2(0,0,0,0,0,0,0,0,0,0)                                         
ESTLNQ   EQU   *-EST                                                            
*                                                                               
EX       DC    AL2(UP@EXPAS-WORKD,UP@EXPAL-WORKD)  EXPAND=YES/NO                
         DC    AL1(EXLNQ)                          EX=YES/NO                    
         DC    AL1(4,OPTNGRDQ)                                                  
         DC    AL2(VALYN-T62000,OEXP-OPTVALSD)                                  
         DC    AL1(ACTNCRED,ACTNODLI,ACTNVEND,ACTNESTD,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
EXLNQ    EQU   *-EX                                                             
*                                                                               
EXTV     DC    AL2(UP@EXPAS-WORKD,UP@EXPAL-WORKD)  EX=YES/NO/ONLY               
         DC    AL1(EXTVLNQ)                        EX=YES/NO/ONLY               
         DC    AL1(4,0)                            EXTERNAL VENDOR              
         DC    AL2(VALYNO-T62000,OEXP-OPTVALSD)    EXPENSE JOBS                 
         DC    AL1(ACTNJBCF,ACTNVICF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
EXTVLNQ  EQU   *-EXTV                                                           
*                                                                               
FD       DC    AL2(UP@FULDS-WORKD,UP@FULDL-WORKD)  FULLDEL=YES/NO/ONLY          
         DC    AL1(FDLNQ)                          FD=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OFULLDEL-OPTVALSD)                             
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
FDLNQ    EQU   *-FD                                                             
*                                                                               
FM       DC    AL2(UP@FMTCS-WORKD,UP@FMTCL-WORKD)  FMATCHED=YES/NO/ONLY         
         DC    AL1(FMLNQ)                          FM=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OFMATCH-OPTVALSD)                              
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
FMLNQ    EQU   *-FM                                                             
*                                                                               
FI       DC    AL2(UP@FXDRS-WORKD,UP@FXDRL-WORKD)  FIXED REF#=AAAAAA            
         DC    AL1(FILNQ)                          FR=AAAAAA                    
         DC    AL1(14,0)                                                        
         DC    AL2(VALSTRNG-T62000,OFIXD-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SC',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'SC',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
FILNQ    EQU   *-FI                                                             
*                                                                               
GR       DC    AL2(UP@GROSS-WORKD,UP@GROSL-WORKD)  GROSS=YES/NO                 
         DC    AL1(GRLNQ)                          GR=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,OGROSS-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SI',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
GRLNQ    EQU   *-GR                                                             
*                                                                               
HE       DC    AL2(UP@HELDS-WORKD,UP@HELDL-WORKD)  HELD=YES/NO/ONLY             
         DC    AL1(HELNQ)                          HE=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OHELD-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNCRED,ACTNVEND,ACTNDTOF)                
         DC    AL1(ACTNJBCF,ACTNVICF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL)                                                    
         DC    C'SV',C'SX',C'ST',C'SF',C'SP',C'SQ',C'SS',C'SU',C'SW'            
         DC    C'SY',AL2(0,0,0,0,0)                                             
         DC    AL1(ACTNDTOF)                                                    
         DC    C'SV',C'SX',C'ST',C'SF',C'SP',C'SQ',C'SS',C'SU',C'SW'            
         DC    C'SY',AL2(0,0,0,0,0)                                             
HELNQ    EQU   *-HE                                                             
*                                                                               
HO       DC    AL2(UP@HOURS-WORKD,UP@HOURL-WORKD)  HOUR=YES/NO                  
         DC    AL1(HOLNQ)                          HO=YES/NO                    
         DC    AL1(4,0)                                                         
         DC    AL2(VALYN-T62000,OHOURS-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNDTOF,ACTNCONT,ACTNMNTH,ACTNOFMN)                
         DC    AL1(ACTNMNOF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'1P',C'1R',C'1J',AL2(0,0,0,0,0,0,0,0)             
         DC    AL2(0,0,0,0)                                                     
         DC    AL1(ACTNDTOF),C'1P',C'1R',C'1J',AL2(0,0,0,0,0,0,0,0)             
         DC    AL2(0,0,0,0)                                                     
         DC    AL1(ACTNCONT),C'1C',C'1R',C'1N'                                  
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0)                                     
         DC    AL1(ACTNMNTH),C'1C',C'1R',C'1N'                                  
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0)                                     
         DC    AL1(ACTNMNOF),C'1C',C'1R',C'1N'                                  
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0)                                     
         DC    AL1(ACTNOFMN),C'1C',C'1R',C'1N'                                  
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0)                                     
HOLNQ    EQU   *-HO                                                             
*                                                                               
IN       DC    AL2(UP@INCMS-WORKD,UP@INCML-WORKD)  INCREMENT=NNN                
         DC    AL1(INLNQ)                          IN=NNN (WHERE                
         DC    AL1(5,0)                               NNN =                     
         DC    AL2(VALINCR-T62000,OINCRMT-OPTVALSD)    1-999 MONTHS)            
         DC    AL1(ACTNRECV,ACTNDEBT,ACTNRAGE,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
INLNQ    EQU   *-IN                                                             
*                                                                               
INV      DC    AL2(UP@INVS-WORKD,UP@INVL-WORKD)  INVOICE=99999999999999         
         DC    AL1(INVLNQ)                         IN=99999999999999            
         DC    AL1(42,0)                                                        
         DC    AL2(VALSTRNG-T62000,OSERIAL-OPTVALSD)                            
         DC    AL1(ACTNCRED,ACTNVEND,ACTNJBCF,ACTNVICF,ACTNDETL)                
         DC    AL1(ACTNDTOF,ACTNRAGE,ACTNJBDE,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
INVLNQ   EQU   *-INV                                                            
*                                                                               
JB       DC    AL2(UP@JOBS-WORKD,UP@JOBL-WORKD)    JOB=AAAAAA                   
         DC    AL1(JBLNQ)                          JB=AAAAAA                    
         DC    AL1(26,0)                                                        
         DC    AL2(VALSTRNG-T62000,OJOB-OPTVALSD)                               
         DC    AL1(ACTNODLI,ACTNDETL,ACTNCRED,ACTNVEND,ACTNDTOF)                
         DC    AL1(ACTNVICF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SV',C'SR',C'SI',C'1R',C'SW',C'SX',C'SY'          
         DC    AL2(0,0,0,0,0,0,0,0)                                             
         DC    AL1(ACTNDTOF),C'SV',C'SR',C'SI',C'1R',C'SW',C'SX',C'SY'          
         DC    AL2(0,0,0,0,0,0,0,0)                                             
JBLNQ    EQU   *-JB                                                             
*                                                                               
LE       DC    AL2(UP@LEVES-WORKD,UP@LEVEL-WORKD)  LEVEL=A                      
         DC    AL1(LELNQ)                          LE=A                         
         DC    AL1(4,0)                                                         
         DC    AL2(VALLEV-T62000,OLEVEL-OPTVALSD)                               
         DC    AL1(ACTNLSLT,ACTNLIST,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
LELNQ    EQU   *-LE                                                             
*                                                                               
LO       DC    AL2(UP@LCKES-WORKD,UP@LCKEL-WORKD)  LOCKED=YES/NO/ONLY           
         DC    AL1(LOLNQ)                          LO=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OLOCKED-OPTVALSD)                              
         DC    AL1(ACTNODSM,ACTNJBES,ACTNLSLT,ACTNLIST,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
LOLNQ    EQU   *-LO                                                             
*                                                                               
MA       DC    AL2(UP@MANUS-WORKD,UP@MANUL-WORKD)  MANUAL=YES/NO/ONLY           
         DC    AL1(MALNQ)                          MA=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OMAN-OPTVALSD)                                 
         DC    AL1(ACTNCRED,ACTNVEND,ACTNVICF,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
MALNQ    EQU   *-MA                                                             
*                                                                               
ME       DC    AL2(UP@MEDS-WORKD,UP@MEDL-WORKD)    MEDIA=A                      
         DC    AL1(MELNQ)                          ME=A                         
         DC    AL1(2,0)                                                         
         DC    AL2(VALMOVE-T62000,OMEDIA-OPTVALSD)                              
         DC    AL1(ACTNLSLT,ACTNODSM,ACTNJBES,ACTNLIST,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNLSLT),C'SJ',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNLIST),C'SJ',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
MELNQ    EQU   *-ME                                                             
*                                                                               
MER      DC    AL2(UP@MERGS-WORKD,UP@MERGL-WORKD)  MERGE=YES/NO                 
         DC    AL1(MERLNQ)                         ME=YES/NO                    
         DC    AL1(4,0)                                                         
         DC    AL2(VALYN-T62000,OMERGE-OPTVALSD)                                
         DC    AL1(ACTNVEND,ACTNCRED,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
MERLNQ   EQU   *-MER                                                            
*                                                                               
METH     DC    AL2(UP@METHS-WORKD,UP@METHL-WORKD)  METHOD=A                     
         DC    AL1(METHLNQ)                        ME=A                         
         DC    AL1(1,0)                                                         
         DC    AL2(VALMETH-T62000,OBUKTYP-OPTVALSD)                             
         DC    AL1(ACTNCONT,ACTNMNTH,ACTNMNOF,ACTNOFMN,ACTNPFLS)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNCONT),C'1C',C'1R',C'1N'                                  
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0)                                     
         DC    AL1(ACTNMNTH),C'1C',C'1R',C'1N'                                  
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0)                                     
         DC    AL1(ACTNMNOF),C'1C',C'1R',C'1N'                                  
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0)                                     
         DC    AL1(ACTNOFMN),C'1C',C'1R',C'1N'                                  
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0)                                     
METHLNQ  EQU   *-METH                                                           
*                                                                               
MOS      DC    AL2(UP@MOS3-WORKD,UP@MOS3-WORKD)    MOS=MMM/YY                   
         DC    AL1(MOSLNQ)                         MO=MMM/YY                    
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,OMMOS-OPTVALSD)                                
         DC    AL1(ACTNVEND,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
MOSLNQ   EQU   *-MOS                                                            
*                                                                               
NE       DC    AL2(UP@NEGS-WORKD,UP@NEGL-WORKD)    NEGATIVE=YES/NO/ONLY         
         DC    AL1(NELNQ)                          NG=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,ONEGATIV-OPTVALSD)                             
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNJBBL,ACTNRECV,ACTNCRED)                
         DC    AL1(ACTNDEBT,ACTNVEND,ACTNDTOF,ACTNRAGE,ACTNJBCF)                
         DC    AL1(ACTNVICF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
NELNQ    EQU   *-NE                                                             
*                                                                               
NET      DC    AL2(UP@NETS-WORKD,UP@NETL-WORKD)    NET=YES/NO                   
         DC    AL1(NETLNQ)                         NE=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,ONET-OPTVALSD)                                  
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SG',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'SG',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
NETLNQ   EQU   *-NET                                                            
*                                                                               
ODA      DC    AL2(UP@ORDDS-WORKD,UP@ORDDL-WORKD)  ODATE=MMMDD/YY               
         DC    AL1(ODALNQ)                         OD=MMMDD/YY                  
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,OODATE-OPTVALSD)                               
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ODALNQ   EQU   *-ODA                                                            
*                                                                               
OFD      DC    AL2(UP@OFFDS-WORKD,UP@OFFDL-WORKD)  OD=YES/NO (WHERE:            
         DC    AL1(OFDLNQ)                         OD = OFFICE                  
         DC    AL1(3,OPT2CHQ)                              DETAIL)              
         DC    AL2(VALYN-T62000,OOFFDET-OPTVALSD)                               
         DC    AL1(ACTNLSLT,ACTNLIST,ACTNNBUD,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
OFDLNQ   EQU   *-OFD                                                            
*                                                                               
OF       DC    AL2(UP@OFFS-WORKD,UP@OFFL-WORKD)    OFFICE=AA                    
         DC    AL1(OFLNQ)                          OF=AA                        
         DC    AL1(3,0)                                                         
         DC    AL2(VALOFF-T62000,OOFFICE-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNMNTH,ACTNCONT,ACTNCRED,ACTNSTMT)                
         DC    AL1(ACTNRECV,ACTNDEBT,ACTNVEND,ACTNODSM,ACTNDTOF)                
         DC    AL1(ACTNMNOF,ACTNOFMN,ACTNSTOF,ACTNLSLT,ACTNLIST)                
         DC    AL1(ACTNRAGE,ACTNVICF,ACTNRNSU,0,0)                              
OFLNQ    EQU   *-OF                                                             
*                                                                               
OF1      DC    AL2(UP@OFFS-WORKD,UP@OFFL-WORKD)    OFFICE=AA                    
         DC    AL1(OF1LNQ)                         OF=AA                        
         DC    AL1(7,0)                                                         
         DC    AL2(VALSTRNG-T62000,OOFF1-OPTVALSD)                              
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
OF1LNQ   EQU   *-OF1                                                            
*                                                  (UK)                         
OFS      DC    AL2(UP@CTRDS-WORKD,UP@CTRDL-WORKD)  CONTRA'D=YES/NO/ONLY         
         DC    AL1(OFSLNQ)                         CO=YES/NO/ONLY               
*                                                  (US)                         
         DC    AL1(4,0)                            OFFSET=YES/NO/ONLY           
         DC    AL2(VALYNO-T62000,OCONT-OPTVALSD)   OF=YES/NO/ONLY               
         DC    AL1(ACTNDETL,ACTNCRED,ACTNVEND,ACTNDTOF,ACTNVICF)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SP',C'SQ',C'SS',C'ST',C'SU',C'SV'                
         DC    C'SW',C'SX',C'SY',AL2(0,0,0,0,0,0)                               
         DC    AL1(ACTNDTOF),C'SP',C'SQ',C'SS',C'ST',C'SU',C'SV'                
         DC    C'SW',C'SX',C'SY',AL2(0,0,0,0,0,0)                               
OFSLNQ   EQU   *-OFS                                                            
*                                                                               
ORD      DC    AL2(UP@ORDES-WORKD,UP@ORDEL-WORKD)  ORDER=AAAAAA                 
         DC    AL1(ORDLNQ)                         OR=AAAAAA                    
         DC    AL1(14,0)                                                        
         DC    AL2(VALSTRNG-T62000,OORDNO-OPTVALSD)                             
         DC    AL1(ACTNJBBL,ACTNJBDE,ACTNODDE,ACTNJBCF,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ORDLNQ   EQU   *-ORD                                                            
*                                                                               
OR       DC    AL2(UP@ORDSS-WORKD,UP@ORDSL-WORKD)  ORDERS=YES/NO/ONLY           
         DC    AL1(ORLNQ)                          OR=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OORDERS-OPTVALSD)                              
         DC    AL1(ACTNODSM,ACTNJBES,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
ORLNQ    EQU   *-OR                                                             
*                                                                               
PA       DC    AL2(UP@PAIDS-WORKD,UP@PAIDL-WORKD)  PAID=YES/NO/ONLY             
         DC    AL1(PALNQ)                          PA=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OPAID-OPTVALSD)                                
         DC    AL1(ACTNCRED,ACTNVEND,ACTNVICF,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PALNQ    EQU   *-PA                                                             
*                                                                               
PD       DC    AL2(UP@PAYDS-WORKD,UP@PAYDL-WORKD)   PAYDATE=MMMDD/YY            
         DC    AL1(PDLNQ)                           PD=MMMDD/YY                 
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,OUSED-OPTVALSD)                                
         DC    AL1(ACTNCRED,ACTNVEND,ACTNVICF,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PDLNQ    EQU   *-PD                                                             
*                                                                               
PDEL     DC    AL2(UP@PARDS-WORKD,UP@PARDL-WORKD)  PARTDEL=YES/NO/ONLY          
         DC    AL1(PDELLNQ)                        PD=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OPARTDEL-OPTVALSD)                             
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PDELLNQ  EQU   *-PDEL                                                           
*                                                                               
PAPPR    DC    AL2(UP@PAPPL-WORKD,UP@PAPPL-WORKD) PAPPROVED=YES/NO/ONLY         
         DC    AL1(PAPPLNQ)                       PA=YES/NO/ONLY                
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OPARTAPP-OPTVALSD)                             
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PAPPLNQ  EQU   *-PAPPR                                                          
*                                                                               
PREJECT  DC    AL2(UP@REJEL-WORKD,UP@REJEL-WORKD)  REJECTED=YES/NO/ONLY         
         DC    AL1(PREJLNQ)                        RE=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OREJECT-OPTVALSD)                              
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PREJLNQ  EQU   *-PREJECT                                                        
*                                                                               
PSUBMIT  DC    AL2(UP@SUBML-WORKD,UP@SUBML-WORKD) SUBMITTED=YES/NO/ONLY         
         DC    AL1(PSUBLNQ)                       SU=YES/NO/ONLY                
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OSUBMIT-OPTVALSD)                              
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PSUBLNQ  EQU   *-PSUBMIT                                                        
*                                                                               
PINPRGRS DC    AL2(UP@INPRS-WORKD,UP@INPRL-WORKD) INPROGRS=YES/NO/ONLY          
         DC    AL1(PINPLNQ)                       IP=YES/NO/ONLY                
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OINPRGRS-OPTVALSD)                             
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PINPLNQ  EQU   *-PINPRGRS                                                       
*                                                                               
*PRECEIVE DC    AL2(UP@RCVDS-WORKD,UP@RCVDL-WORKD) RECEIVED=YES/NO/ONLY         
*        DC    AL1(PRCVLNQ)                       SU=YES/NO/ONLY                
*        DC    AL1(4,0)                                                         
*        DC    AL2(VALYNO-T62000,ORECEIVE-OPTVALSD)                             
*        DC    AL1(ACTNODLI,0,0,0,0)                                            
*        DC    AL1(0,0,0,0,0)                                                   
*        DC    AL1(0,0,0,0,0)                                                   
*        DC    AL1(0,0,0,0,0)                                                   
*PRCVLNQ  EQU   *-PRECEIVE                                                      
*                                                                               
PE       DC    AL2(UP@PELES-WORKD,UP@PELEL-WORKD)  PEELED=YES/NO/ONLY           
         DC    AL1(PELNQ)                          PE=YES/NO/ONLY               
         DC    AL1(3,0)                                                         
         DC    AL2(VALYNO-T62000,OPEELED-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNCRED,ACTNVEND)                
         DC    AL1(ACTNDTOF,ACTNJBCF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PELNQ    EQU   *-PE                                                             
*                                                                               
PM       DC    AL2(UP@PTYMS-WORKD,UP@PTYML-WORKD)  PMATCHED=YES/NO/ONLY         
         DC    AL1(PMLNQ)                          PM=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OPMATCH-OPTVALSD)                              
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
PMLNQ    EQU   *-PM                                                             
*                                                                               
PRO      DC    AL2(UP@PROS-WORKD,UP@PROL-WORKD)    PRODUCT=AAAAAA               
         DC    AL1(PROLNQ)                         PR=AAAAAA                    
         DC    AL1(24,0)                                                        
         DC    AL2(VALCLPR-T62000,OPROD-OPTVALSD)                               
         DC    AL1(ACTNODLI,ACTNDETL,ACTNCRED,ACTNVEND,ACTNDTOF)                
         DC    AL1(ACTNVICF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SV',C'ST',C'SR',C'SI',C'1R',C'SP',C'SQ'          
         DC    C'SS',C'SU',C'SW',C'SX',C'SY',C'1C',AL2(0,0)                     
         DC    AL1(ACTNDTOF),C'SV',C'ST',C'SR',C'SI',C'1R',C'SP',C'SQ'          
         DC    C'SS',C'SU',C'SW',C'SX',C'SY',C'1C',AL2(0,0)                     
PROLNQ   EQU   *-PRO                                                            
*                                                                               
PJ       DC    AL2(UP@PROJS-WORKD,UP@PROJL-WORKD)  PROJOB=AAAAAA                
         DC    AL1(PJLNQ)                          PJ=AAAAAA                    
         DC    AL1(24,0)                                                        
         DC    AL2(VALSTRNG-T62000,OPJOB-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SR',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'SR',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
PJLNQ    EQU   *-PJ                                                             
*                                                                               
PST      DC    AL2(UP@PSTS-WORKD,UP@PSTL-WORKD)    PST=YES/NO                   
         DC    AL1(PSTLNQ)                         PS=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,OPST-OPTVALSD)                                  
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SS',C'ST',C'SP',C'SQ',C'SX',C'SV',C'SW'          
         DC    C'SR',AL2(0,0,0,0,0,0,0)                                         
         DC    AL1(ACTNDTOF),C'SS',C'ST',C'SP',C'SQ',C'SX',C'SV',C'SW'          
         DC    C'SR',AL2(0,0,0,0,0,0,0)                                         
PSTLNQ   EQU   *-PST                                                            
*                                                                               
PTY      DC    AL2(UP@PAYTS-WORKD,UP@PAYTL-WORKD)  PAY TYPE=SALARY/             
*                                                           BENEFIT/            
*                                                           PENSION/            
*                                                           INDIRECT            
         DC    AL1(PTYLNQ)                         PT=SAL/BEN/PEN/IND           
         DC    AL1(7,0)                                                         
         DC    AL2(VALPAYT-T62000,OPAYTYPE-OPTVALSD)                            
         DC    AL1(ACTNCONT,ACTNMNTH,ACTNMNOF,ACTNOFMN,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNCONT),C'1C',C'1R'                                        
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0,0)                                   
         DC    AL1(ACTNMNTH),C'1C',C'1R'                                        
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0,0)                                   
         DC    AL1(ACTNMNOF),C'1C',C'1R'                                        
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0,0)                                   
         DC    AL1(ACTNOFMN),C'1C',C'1R'                                        
         DC    AL2(0,0,0,0,0,0,0,0,0,0,0,0,0)                                   
PTYLNQ   EQU   *-PTY                                                            
*                                                                               
REF      DC    AL2(UP@REFS-WORKD,UP@REFL-WORKD)    REFERENCE=AAAAAA             
         DC    AL1(REFLNQ)                         RE=AAAAAA                    
         DC    AL1(14,0)                                                        
         DC    AL2(VALSTRNG-T62000,OREF-OPTVALSD)                               
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNODDE,ACTNRECV)                
         DC    AL1(ACTNCRED,ACTNDEBT,ACTNVEND,ACTNDTOF,ACTNRAGE)                
         DC    AL1(ACTNJBCF,ACTNVICF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
REFLNQ   EQU   *-REF                                                            
*                                                                               
KREF     DC    AL2(UP@KEYRS-WORKD,UP@KEYRL-WORKD) KR=123456 OR 123*00           
         DC    AL1(KREFLNQ)                        KREF=12345 OR 123*00         
         DC    AL1(14,0)                                                        
         DC    AL2(VALSTRNG-T62000,OKREF-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
KREFLNQ  EQU   *-KREF                                                           
*                                                                               
REV      DC    AL2(UP@RVRSS-WORKD,UP@RVRSL-WORKD) REVERSALS=YES/NO/ONLY         
         DC    AL1(REVLNQ)                         RE=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OREVERSE-OPTVALSD)                             
         DC    AL1(ACTNDETL,ACTNJBBL,ACTNJBDE,ACTNRECV,ACTNCRED)                
         DC    AL1(ACTNDEBT,ACTNVEND,ACTNDTOF,ACTNRAGE,ACTNJBCF)                
         DC    AL1(ACTNVICF,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
REVLNQ   EQU   *-REV                                                            
*                                                                               
REC      DC    AL2(UP@RCNDS-WORKD,UP@RCNDL-WORKD) RECONCILED=Y/N/O              
         DC    AL1(RECLNQ)                        RC=YES/NO/ONLY                
         DC    AL1(20,0)                          RC=MMMDD/YY-MMMDD/YY          
         DC    AL2(VALDYNO-T62000,ORECON-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNDTOF,ACTNCRED,ACTNVEND,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SC',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'SC',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
RECLNQ   EQU   *-REC                                                            
*                                                                               
CLRD     DC    AL2(UP@CLRDS-WORKD,UP@CLRDL-WORKD) CLEARED DATE                  
         DC    AL1(CLRDLNQ)                       CD=YES/NO/ONLY                
         DC    AL1(20,0)                          CD=MMMDD/YY-MMMDD/YY          
         DC    AL2(VALDYNO-T62000,OCLRDTE-OPTVALSD)                             
         DC    AL1(ACTNDETL,ACTNDTOF,ACTNCRED,ACTNVEND,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SC',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'SC',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
CLRDLNQ  EQU   *-CLRD                                                           
*                                                                               
RUN      DC    AL2(UP@RUNNS-WORKD,UP@RUNNL-WORKD)  RUN NUMBER=999999            
         DC    AL1(RUNLNQ)                         RU=999999                    
         DC    AL1(14,0)                                                        
         DC    AL2(VALRUN-T62000,ORUNNO-OPTVALSD)                               
         DC    AL1(ACTNCRED,ACTNDETL,ACTNVEND,ACTNDTOF,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'ST',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNCRED),C'ST',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNVEND),C'ST',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'ST',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
RUNLNQ   EQU   *-RUN                                                            
*                                                                               
SH       DC    AL2(UP@SHOWS-WORKD,UP@SHOWL-WORKD)  SHOW=BAL/UNBIL/E-CHG         
         DC    AL1(SHLNQ)                          SH=BAL/UNBIL/E-CHG           
         DC    AL1(20,OPTNGRDQ)                                                 
         DC    AL2(VALSHOW-T62000,OSHOW-OPTVALSD)                               
         DC    AL1(ACTNJBES,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
SHLNQ    EQU   *-SH                                                             
*                                                                               
SHOW     DC    AL2(UP@SHOWS-WORKD,UP@SHOWL-WORKD)  SHOW=DUE                     
         DC    AL1(SHOWLNQ)                        SH=DUE                       
         DC    AL1(5,OPTNGRDQ)                                                  
         DC    AL2(VALSHREC-T62000,OSHREC-OPTVALSD)                             
         DC    AL1(ACTNRECV,ACTNDEBT,ACTNRAGE,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
SHOWLNQ  EQU   *-SHOW                                                           
*                                                                               
SO       DC    AL2(UP@SRCS-WORKD,UP@SRCL-WORKD)    SOURCE=AAAAAA                
         DC    AL1(SOLNQ)                          SO=AAAAAA                    
         DC    AL1(30,0)                                                        
         DC    AL2(VALSRC-T62000,OSRC-OPTVALSD)                                 
         DC    AL1(ACTNDETL,ACTNCRED,ACTNVEND,ACTNDTOF,ACTNVICF)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
SOLNQ    EQU   *-SO                                                             
*                                                                               
SD       DC    AL2(UP@STMTS-WORKD,UP@STMNL-WORKD)  STATEMENT=MMMDD/YY           
         DC    AL1(SDLNQ)                          ST=MMMDD/YY                  
         DC    AL1(20,0)                                                        
         DC    AL2(VALDYNO-T62000,OSTATDT-OPTVALSD)                             
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SC',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'SC',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
SDLNQ    EQU   *-SD                                                             
*                                                                               
SU       DC    AL2(UP@SMYS-WORKD,UP@SMYL-WORKD)    SUMMARY=WORKCODE             
         DC    AL1(SULNQ)                          SU=WORKCODE                  
         DC    AL1(8,0)                                                         
         DC    AL2(VALWCS-T62000,OSUMM1-OPTVALSD)                               
         DC    AL1(ACTNJBST,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
SULNQ    EQU   *-SU                                                             
*                                                                               
SUM      DC    AL2(UP@SMYS-WORKD,UP@SMYL-WORKD)    SUMMARY=CLI/SOURCE           
         DC    AL1(SUMLNQ)                         SU=CLI/SOURCE                
         DC    AL1(6,0)                                                         
         DC    AL2(VALWCS-T62000,OSUMM1-OPTVALSD)                               
         DC    AL1(ACTNRECV,ACTNDEBT,ACTNRAGE,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
SUMLNQ   EQU   *-SUM                                                            
*                                                                               
TAX1     DC    AL2(UP@TAXS-WORKD,UP@TAXL-WORKD)    TAX=YES/NO (GST+PST)         
         DC    AL1(TAX1LNQ)                        TA=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,OTAXALL-OPTVALSD)                               
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SS',C'ST',C'SP',C'SQ',C'SX',C'SV',C'SW'          
         DC    C'SR',AL2(0,0,0,0,0,0,0)                                         
         DC    AL1(ACTNDTOF),C'SS',C'ST',C'SP',C'SQ',C'SX',C'SV',C'SW'          
         DC    C'SR',AL2(0,0,0,0,0,0,0)                                         
TAX1LNQ  EQU   *-TAX1                                                           
*                                                                               
TIME     DC    AL2(UP@TIMES-WORKD,UP@TIMEL-WORKD)  TIME=B/N/R                   
         DC    AL1(TIMELNQ)                        TI=B/N/R                     
         DC    AL1(4,0)                                                         
         DC    AL2(VALTIME-T62000,OTIME-OPTVALSD)                               
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNDTOF,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
TIMELNQ  EQU   *-TIME                                                           
*                                                                               
TOF      DC    AL2(UP@TRNOS-WORKD,UP@TRNOL-WORKD)  TOFFICE=AA TRAN              
         DC    AL1(TOFLNQ)                         TF=AA      OFFICE            
         DC    AL1(3,0)                                                         
         DC    AL2(VALTOFF-T62000,OOFFICE-OPTVALSD)                             
         DC    AL1(ACTNDETL,ACTNDTOF,ACTNMNTH,ACTNMNOF,ACTNOFMN)                
         DC    AL1(ACTNLIST,ACTNLSLT,ACTNVEND,ACTNCONT,ACTNSTMT)                
         DC    AL1(ACTNSTOF,ACTNVICF,ACTNNBUD,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
TOFLNQ   EQU   *-TOF                                                            
*                                                                               
TIMTY    DC    AL2(UP@TTYPS-WORKD,UP@TTYPL-WORKD)  TIME TYPE=T/M/A              
         DC    AL1(TIMTYLNQ)                       TT=T/M/A                     
         DC    AL1(4,0)                                                         
         DC    AL2(VALTTYP-T62000,OTTYPE-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNDTOF,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
TIMTYLNQ EQU   *-TIMTY                                                          
*                                                                               
TY       DC    AL2(UP@TYPES-WORKD,UP@TYPEL-WORKD)  TYPE=AAAA (BT TYPE)          
         DC    AL1(TYLNQ)                          TY=AAAA (BT TYPE)            
         DC    AL1(4,0)                                                         
         DC    AL2(VALBATTY-T62000,OBTYPE-OPTVALSD)                             
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNJBBL,ACTNCRED,ACTNVEND)                
         DC    AL1(ACTNDTOF,ACTNJBCF,ACTNVICF,ACTNRNSU,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
TYLNQ    EQU   *-TY                                                             
*                                                                               
TYP      DC    AL2(UP@TYPES-WORKD,UP@TYPEL-WORKD)  TYPE=AAAAAAAAAA              
         DC    AL1(TYPLNQ)                         TY=AAAAAAAAAA                
         DC    AL1(10,0)                                                        
         DC    AL2(VALMOVL1-T62000,OTYPE-OPTVALSD)                              
         DC    AL1(ACTNNBUD,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
TYPLNQ   EQU   *-TYP                                                            
*                                                                               
TYPE     DC    AL2(UP@TYPES-WORKD,UP@TYPEL-WORKD)  TYPE=PROD/EXPENSE            
         DC    AL1(TYPELNQ)                        TY=PROD/EXPENSE              
         DC    AL1(3,0)                                                         
         DC    AL2(VALODTYP-T62000,OTYPE1-OPTVALSD)                             
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
TYPELNQ  EQU   *-TYPE                                                           
*                                                                               
UD       DC    AL2(UP@USEDS-WORKD,UP@USEDL-WORKD)   USEDATE=MMMDD/YY            
         DC    AL1(UDLNQ)                           UD=MMMDD/YY                 
         DC    AL1(20,0)                                                        
         DC    AL2(VALDMY-T62000,OUSED-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNJBBL,ACTNCRED,ACTNVEND)                
         DC    AL1(ACTNDTOF,ACTNJBCF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
UDLNQ    EQU   *-UD                                                             
*                                                                               
UNB      DC    AL2(UP@UBLDS-WORKD,UP@UBLDL-WORKD)  UNBILLED=YES/NO/ONLY         
         DC    AL1(UNBLNQ)                         UN=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OUNBILL-OPTVALSD)                              
         DC    AL1(ACTNJBES,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
UNBLNQ   EQU   *-UNB                                                            
*                                                                               
URG      DC    AL2(UP@URGS-WORKD,UP@URGL-WORKD)    URGENT=YES/NO/ONLY           
         DC    AL1(URGLNQ)                         UR=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OURGENT-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNDTOF,ACTNJBCF,ACTNVICF)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
URGLNQ   EQU   *-URG                                                            
*                                                                               
VAT      DC    AL2(UP@VATS-WORKD,UP@VATL-WORKD)    VAT=YES/NO (UK)              
         DC    AL1(VATLNQ)                         VA=YES/NO  (UK)              
         DC    AL1(3,0)                            GST=YES/NO (US)              
         DC    AL2(VALYN-T62000,OTAX-OPTVALSD)     GS=YES/NO  (US)              
         DC    AL1(ACTNDETL,ACTNDTOF,0,0,0)                                     
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SS',C'ST',C'SP',C'SQ',C'SX',C'SV',C'SW'          
         DC    C'SR',AL2(0,0,0,0,0,0,0)                                         
         DC    AL1(ACTNDTOF),C'SS',C'ST',C'SP',C'SQ',C'SX',C'SV',C'SW'          
         DC    C'SR',AL2(0,0,0,0,0,0,0)                                         
VATLNQ   EQU   *-VAT                                                            
*                                                                               
*                                                  (UK)                         
VND      DC    AL2(UP@SUPS-WORKD,UP@SUPL-WORKD)   SUPPLIER=AAAAAAAAAAAA         
         DC    AL1(VNDLNQ)                         SU=AAAAAAAAAAAA              
*                                                  (US)                         
         DC    AL1(26,0)                           VENDOR=AAAAAAAAAAAA          
         DC    AL2(VALSTRNG-T62000,OSUPP-OPTVALSD) VE=AAAAAAAAAAAA              
         DC    AL1(ACTNODLI,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
VNDLNQ   EQU   *-VND                                                            
*                                                                               
VO       DC    AL2(UP@VOIDS-WORKD,UP@VOIDL-WORKD)  VOID=YES/NO/ONLY             
         DC    AL1(VOLNQ)                          VO=YES/NO/ONLY               
         DC    AL1(4,0)                                                         
         DC    AL2(VALYNO-T62000,OVOID-OPTVALSD)                                
         DC    AL1(ACTNDETL,ACTNCRED,ACTNVEND,ACTNDTOF,ACTNVICF)                
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNDETL),C'SP',C'SQ',C'SS',C'ST',C'SU',C'SV',C'SW'          
         DC    C'SX',C'SY',C'SF',AL2(0,0,0,0,0)                                 
         DC    AL1(ACTNDTOF),C'SP',C'SQ',C'SS',C'ST',C'SU',C'SV',C'SW'          
         DC    C'SX',C'SY',C'SF',AL2(0,0,0,0,0)                                 
VOLNQ    EQU   *-VO                                                             
*                                                                               
WO       DC    AL2(UP@WCS-WORKD,UP@WCL-WORKD)      WORK CODE=AA                 
         DC    AL1(WOLNQ)                          WC=AA                        
         DC    AL1(3,0)                                                         
         DC    AL2(VALMOVL1-T62000,OWCODE-OPTVALSD)                             
         DC    AL1(ACTNETIM,ACTNJBBL,ACTNJBDE,ACTNMNTH,ACTNODDE)                
         DC    AL1(ACTNODLI,ACTNJBST,ACTNDETL,ACTNDTOF,ACTNMNOF)                
         DC    AL1(ACTNOFMN,ACTNJBCF,ACTNESTD,0,0)                              
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(ACTNMNTH),C'SJ',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNMNOF),C'SJ',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNOFMN),C'SJ',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDETL),C'1R',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
         DC    AL1(ACTNDTOF),C'1R',AL2(0,0,0,0,0,0,0,0,0,0,0,0,0,0)             
WOLNQ    EQU   *-WO                                                             
*                                                                               
XD       DC    AL2(UP@XDS-WORKD,UP@XDL-WORKD)      XDETAIL=YES/NO               
         DC    AL1(XDLNQ)                          XD=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,OXDETAIL-OPTVALSD)                              
         DC    AL1(ACTNDETL,ACTNJBDE,ACTNJBBL,ACTNRECV,ACTNDEBT)                
         DC    AL1(ACTNDTOF,ACTNRAGE,ACTNESTL,ACTNESTD,0)                       
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
XDLNQ    EQU   *-XD                                                             
*                                                                               
D11      DC    AL2(UP@11DES-WORKD,UP@11DEL-WORKD)  11DET=YES/NO                 
         DC    AL1(D11LNQ)                         11=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,O11DET-OPTVALSD)                                
         DC    AL1(ACTNPFLS,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
D11LNQ   EQU   *-D11                                                            
*                                                                               
D12      DC    AL2(UP@12DES-WORKD,UP@12DEL-WORKD)  12DET=YES/NO                 
         DC    AL1(D12LNQ)                         12=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,O12DET-OPTVALSD)                                
         DC    AL1(ACTNPFLS,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
D12LNQ   EQU   *-D12                                                            
*                                                                               
D13      DC    AL2(UP@13DES-WORKD,UP@13DEL-WORKD)  13DET=YES/NO                 
         DC    AL1(D13LNQ)                         13=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,O13DET-OPTVALSD)                                
         DC    AL1(ACTNPFLS,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
D13LNQ   EQU   *-D13                                                            
*                                                                               
D14      DC    AL2(UP@14DES-WORKD,UP@14DEL-WORKD)  14DET=YES/NO                 
         DC    AL1(D14LNQ)                         14=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,O14DET-OPTVALSD)                                
         DC    AL1(ACTNPFLS,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
D14LNQ   EQU   *-D14                                                            
*                                                                               
D15      DC    AL2(UP@15DES-WORKD,UP@15DEL-WORKD)  15DET=YES/NO                 
         DC    AL1(D15LNQ)                         15=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,O15DET-OPTVALSD)                                
         DC    AL1(ACTNPFLS,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
D15LNQ   EQU   *-D15                                                            
*                                                                               
D16      DC    AL2(UP@16DES-WORKD,UP@16DEL-WORKD)  16DET=YES/NO                 
         DC    AL1(D16LNQ)                         16=YES/NO                    
         DC    AL1(3,0)                                                         
         DC    AL2(VALYN-T62000,O16DET-OPTVALSD)                                
         DC    AL1(ACTNPFLS,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
D16LNQ   EQU   *-D16                                                            
*                                                                               
*                                                                               
STAT     DC    AL2(UP@STT-WORKD,UP@STTL-WORKD)     STATUS=X                     
         DC    AL1(STATLNQ)                                                     
         DC    AL1(1,0)                                                         
         DC    AL2(VALSTA-T62000,OSTAT-OPTVALSD)                                
         DC    AL1(ACTNESTL,0,0,0,0)                                            
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
STATLNQ  EQU   *-STAT                                                           
*                                                                               
         DC    AL1(EOT)                                                         
         EJECT ,                                                                
***********************************************************************         
* ACCOUNT FILE NAMES TABLE                                            *         
***********************************************************************         
*                                                                               
FILTAB   DS    0X                                                               
*                                  ** ACCOUNT SYSTEM FILES **                   
         DC    AL1(IOACCFIL/256),C'ACCFIL '                                     
         DC    AL1(FILIVL+FILIIS,0)                                             
         DC    AL1(0,42,49),AL2(1000)                                           
         DC    XL5'00'                                                          
*                                                                               
         DC    AL1(IOACCDIR/256),C'ACCDIR '                                     
         DC    AL1(FILIIS,FILIID)                                               
         DC    AL1(IOACCMST/256,42,08),AL2(54)                                  
         DC    XL5'00'                                                          
*                                                                               
         DC    AL1(IOACCMST/256),C'ACCMST '                                     
         DC    AL1(FILIDA,FILIDI)                                               
         DC    AL1(IOACCDIR/256,42,56),AL2(2000)                                
         DC    XL5'00'                                                          
*                                                                               
         DC    AL1(IOACCARC/256),C'ACCARC '                                     
         DC    AL1(FILIDA,FILIDI)                                               
         DC    AL1(IOACCDIR/256,42,56),AL2(2000)                                
         DC    XL5'00'                                                          
*                                                                               
FILTABX  DC    AL1(EOT)                                                         
         EJECT ,                                                                
***********************************************************************         
* SYSTEM FILE COMMANDS TABLE                                          *         
***********************************************************************         
*                                                                               
CMDTAB   DS    0X                                                               
*                                  ** INDEX SEQUENTIAL COMMANDS **              
CMDIS    DC    AL1(FILIVL+FILIIS,0),AL2(CMDISX-*)                               
         DC    C'DMRDHI ',AL1(IOHI,0,0)                                         
         DC    C'DMREAD ',AL1(IORD,0,0)                                         
         DC    C'DMRSEQ ',AL1(IOSQ,0,0)                                         
         DC    C'DMADD  ',AL1(IOADD,0,0)                                        
         DC    C'DMWRT  ',AL1(IOWRITE,0,0)                                      
CMDISX   DC    AL1(EOT)                                                         
*                                  ** DIRECT ACCESS COMMANDS **                 
CMDDA    DC    AL1(FILIDA,0),AL2(CMDDAX-*)                                      
         DC    C'GETREC ',AL1(IOHI,CMDIDARQ+CMDIDAXC,0)                         
         DC    C'GETREC ',AL1(IORD,CMDIDARQ+CMDIDAXC,0)                         
         DC    C'GETREC ',AL1(IOSQ,CMDIDARQ+CMDIDAXC,0)                         
         DC    C'GETREC ',AL1(IOGET,CMDIDARQ,0)                                 
         DC    C'ADDREC ',AL1(IOADDREC,CMDIDADD,0)                              
         DC    C'PUTREC ',AL1(IOPUTREC,CMDIDARQ,0)                              
CMDDAX   DC    AL1(EOT)                                                         
*                                                                               
CMDTABX  DC    AL1(EOT)                                                         
         EJECT ,                                                                
***********************************************************************         
* COLUMN TABLE                                                        *         
***********************************************************************         
*                                                                               
DCLTAB   DS    0X                                                               
*                                  ** DEFAULT COLUMN ORDER **                   
DCLCR    DC    AL1(ACTNCRED,DCLCRLNQ)                                           
         DC    AL2(DISCR-DISTAB)                                                
*                                                                               
         DC    C'SF'               SF DEFAULTS                                  
         DC    AL1(COLCONQ,COLDATQ,COLREFQ,COLKEYQ,COLSRCQ)                     
         DC    AL1(COLOFFQ,COLPYMQ,COLPDATQ,COLCRSQ,COLMIVQ)                    
         DC    AL1(COLXSTQ,COLMOSQ,COLBTYQ,COLBATQ,COLBTYQ)                     
         DC    AL1(COLADAQ,COLUSEQ,COLNARRQ,COLNUMQ,0)                          
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    C'ST'               ST DEFAULTS                                  
         DC    AL1(COLCONQ,COLDATQ,COLREFQ,COLKEYQ,COLSRCQ)                     
         DC    AL1(COLOFFQ,COLPYMQ,COLPDATQ,COLCRSQ,COLXSTQ)                    
         DC    AL1(COLMOSQ,COLBTYQ,COLBATQ,COLBTYQ,COLADAQ)                     
         DC    AL1(COLUSEQ,COLNARRQ,COLNUMQ,0,0)                                
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    X'FFFF'             OTHER DEFAULTS                               
         DC    AL1(COLCONQ,COLDATQ,COLREFQ,COLKEYQ,COLSRCQ)                     
         DC    AL1(COLOFFQ,COLPYMQ,COLPDATQ,COLCRSQ,COLDSCQ)                    
         DC    AL1(COLNETQ,COLXSTQ,COLBATQ,COLMOSQ,COLBTYQ)                     
         DC    AL1(COLFOTQ,COLFWKQ,COLADAQ,COLUSEQ,COLNARRQ)                    
         DC    AL1(COLNUMQ,0,0,0,0)                                             
*                                                                               
DCLCRLNQ EQU   *-DCLCR                                                          
*                                                                               
DCLVE    DC    AL1(ACTNVEND,DCLVELNQ)                                           
         DC    AL2(DISCR-DISTAB)                                                
*                                                                               
         DC    C'SF'               SF DEFAULTS                                  
         DC    AL1(COLCONQ,COLDATQ,COLREFQ,COLKEYQ,COLSRCQ)                     
         DC    AL1(COLOFFQ,COLPYMQ,COLPDATQ,COLCRSQ,COLMIVQ)                    
         DC    AL1(COLXSTQ,COLMOSQ,COLBTYQ,COLBATQ,COLBTYQ)                     
         DC    AL1(COLADAQ,COLUSEQ,COLNARRQ,COLNUMQ,0)                          
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    C'ST'               ST DEFAULTS                                  
         DC    AL1(COLCONQ,COLDATQ,COLREFQ,COLKEYQ,COLSRCQ)                     
         DC    AL1(COLOFFQ,COLPYMQ,COLPDATQ,COLCRSQ,COLXSTQ)                    
         DC    AL1(COLMOSQ,COLBTYQ,COLBATQ,COLBTYQ,COLADAQ)                     
         DC    AL1(COLUSEQ,COLNARRQ,COLNUMQ,0,0)                                
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
         DC    X'FFFF'             OTHER DEFAULTS                               
         DC    AL1(COLCONQ,COLDATQ,COLREFQ,COLKEYQ,COLSRCQ)                     
         DC    AL1(COLOFFQ,COLPYMQ,COLPDATQ,COLCRSQ,COLDSCQ)                    
         DC    AL1(COLNETQ,COLXSTQ,COLBATQ,COLMOSQ,COLBTYQ)                     
         DC    AL1(COLADAQ,COLUSEQ,COLNARRQ,COLNUMQ,0)                          
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
DCLVELNQ EQU   *-DCLVE                                                          
*                                                                               
DCLPL    DC    AL1(ACTNPFLS,DCLPLLNQ)                                           
         DC    AL2(DISPL-DISTAB)                                                
*                                                                               
         DC    X'FFFF'             OTHER DEFAULTS                               
         DC    AL1(PL#CAC,PL#CACN,COLKEYQ,PL#AAMT,PL#PAMT)                      
         DC    AL1(PL#ASAL,PL#APEN,PL#ABEN,PL#AIND,0)                           
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
         DC    AL1(0,0,0,0,0)                                                   
*                                                                               
DCLPLLNQ EQU   *-DCLPL                                                          
*                                                                               
DCLTABX  DC    AL1(EOT)                                                         
         EJECT ,                                                                
*                                                                               
       ++INCLUDE ACENQWORK                                                      
       ++INCLUDE DDFH                                                           
*                                                                               
* DDGLOBEQUS                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDGLOBEQUS                                                     
         PRINT ON                                                               
* DDGLVXCTLD                                                                    
         PRINT OFF                                                              
       ++INCLUDE DDGLVXCTLD                                                     
         PRINT ON                                                               
*FASYSFAC                                                                       
*PREFIX=F                                                                       
         PRINT OFF                                                              
       ++INCLUDE FASYSFAC                                                       
         PRINT ON                                                               
*PREFIX=                                                                        
*FASHIPBLK                                                                      
         PRINT OFF                                                              
       ++INCLUDE FASHIPBLK                                                      
         PRINT ON                                                               
*FAUTL                                                                          
         PRINT OFF                                                              
       ++INCLUDE FAUTL                                                          
         PRINT ON                                                               
*FATCB                                                                          
         PRINT OFF                                                              
       ++INCLUDE FATCB                                                          
         PRINT ON                                                               
*FASSB                                                                          
         PRINT OFF                                                              
       ++INCLUDE FASSB                                                          
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'050ACENQ00   10/13/16'                                      
         END                                                                    
