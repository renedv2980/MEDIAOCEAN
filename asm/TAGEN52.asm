*          DATA SET TAGEN52    AT LEVEL 157 AS OF 03/15/17                      
*PHASE T70252B,*                                                                
         TITLE 'T70252 - PAY SCREEN/USE TYPE HANDLING'                          
T70252   CSECT                                                                  
         PRINT NOGEN                                                            
         NMOD1 0,T70252,R7,R6,R5                                                
         L     RC,0(R1)            RC=GENCON STORAGE AREA                       
         USING GEND,RC                                                          
         L     RA,ATWA             RA=A(TWA)                                    
         USING T702FFD,RA                                                       
         L     R9,ASYSD            R9=ROOT STORAGE AREA                         
         USING SYSD,R9                                                          
         LA    R8,TWAHOLE          R8=A(PAY STORAGE)                            
         USING PAYD,R8                                                          
         SPACE 3                                                                
         CLI   MODE,VALREC         RECOGNIZE ONLY MODE VALREC                   
         BE    MODE10                                                           
         TM    TGFASTAT,TGFROMFA   OR IF PAYMENT COMING FROM WEB                
         BZ    XIT                                                              
         SPACE 1                                                                
MODE10   GOTOR INIT                INITIALIZE                                   
         SPACE  1                                                               
         LA    RF,V52              SET A(ENTRY POINT FOR MODE CALLS)            
         ST    RF,APAYOVLY                                                      
         ST    RB,PRGRB            SAVE BASE REGISTERS                          
         ST    R7,PRGR7                                                         
         ST    R6,PRGR6                                                         
         ST    R5,PRGR5                                                         
         SPACE 1                                                                
         GOTO1 APAYCNTL,DMCB,(RC)  GO OFF TO PAY CONTROL                        
         SPACE 1                                                                
YES      XR    RC,RC                                                            
NO       LTR   RC,RC                                                            
XIT      XIT1                                                                   
         SPACE 3                                                                
         GETEL R4,DATADISP,ELCODE                                               
         EJECT                                                                  
*              MODE CONTROLLED ROUTINES                                         
         SPACE 1                                                                
V52      NTR1  BASE=PRGRB                                                       
         L     R7,PRGR7                                                         
         L     R6,PRGR6                                                         
         L     R5,PRGR5                                                         
         SPACE 1                                                                
         CLI   MYMODE,XVALCOM      POST-COMMERCIAL VALIDATION                   
         BNE   V52B                                                             
         GOTOR XVCOM                                                            
         B     XIT                                                              
         SPACE 1                                                                
V52B     CLI   MYMODE,VALISCRN     VALIDATE SCREEN                              
         BNE   *+12                                                             
         BAS   RE,VSCREEN                                                       
         B     XIT                                                              
         SPACE 1                                                                
         CLI   MYMODE,XVALMID      POST-MIDDLE OF SCREEN VALIDATION             
         BNE   *+12                                                             
         BAS   RE,XVMID                                                         
         B     XIT                                                              
         SPACE 1                                                                
         CLI   MYMODE,DISPDTL      DISPLAY DETAIL LINE                          
         BNE   *+12                                                             
         BAS   RE,DISPLAY                                                       
         B     XIT                                                              
         SPACE 1                                                                
         CLI   MYMODE,VALIDTL      VALIDATE DETAIL LINE                         
         BNE   *+12                                                             
         BAS   RE,VALCAST                                                       
         B     XIT                                                              
         SPACE 1                                                                
         CLI   MYMODE,BLDCHK       BUILDING CHECK RECORD                        
         BNE   *+12                                                             
         BRAS  RE,PROCCHK                                                       
         B     XIT                                                              
         SPACE 1                                                                
         CLI   MYMODE,BLDINV       BUILDING INVOICE RECORD                      
         BNE   XIT                                                              
         BAS   RE,PROCINV                                                       
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN                                                  
         SPACE 1                                                                
VSCREEN  NTR1                                                                   
         NI    LCLSTAT3,X'FF'-WSPTYPCH   CLEAR TYPE CHANGED BIT                 
         TM    PAYMODE,DTLDSPLD    DON'T BOTHER IF DETAIL INFO DISPLAYD         
         BO    VSCX                                                             
         XC    SVINPUNT(3),SVINPUNT  CLEAR SO WILL RESAVE LATER                 
         XC    SVINPSUB(8),SVINPSUB                                             
         LH    RF,DSPVSCR            RF=A(DISP. TO INDIV. VAL. ROUTINE)         
         LTR   RF,RF                                                            
         BZ    VSCX                                                             
         AR    RF,RB                                                            
         LA    RE,VSCX             SET RE FOR COMMON NTR1                       
VS       NTR1                                                                   
         BR    RF                  ** VALIDATE INDIVIDUAL SCREEN **             
VSCX     B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (MUSIC SESSION)                                 
         SPACE 1                                                                
VSCRMSES DS    0H                                                               
         CLI   TGUSEQU,UIDS        IF IDS                                       
         BE    VSCRSESS                                                         
         BRAS  RE,CKMUSDT                                                       
         B     VSCRSESS                                                         
*                                                                               
*                                                                               
*                                                                               
*              VALIDATE SCREEN  (SESSION)                                       
         SPACE 1                                                                
VSCRSESS DS    0H                                                               
         TM    PAYMODE,DTLONBSE    IF NOT SET YET                               
         BO    *+12                                                             
         OI    PAYMODE,DTLONBSE    SET DETAIL ON BASE SCREEN                    
         OI    LCLSTAT,DTLFIRST    AND FIRST TIME FOR DETAIL                    
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (BD - DEALER)                                   
         SPACE 1                                                                
VSCRBD   DS    0H                                                               
         LA    R2,DLR8WH                                                        
         GOTO1 FLDVAL,DMCB,(X'80',DLR8WH),DLR6MH                                
         BE    NOCHOICE            ERROR - NO SELECTION MADE                    
         GOTO1 VCHOICE,WORK,('UDLRA',DLRAH),('UDLRANY',DLRANYH),       X        
               ('UDLRB',DLRBH),('UDLRBNY',DLRBNYH),                    X        
               ('UDLRRAD',DLRRADH),(X'FF',0)                                    
         CLI   DLR8WH+5,0                                                       
         JE    XIT                                                              
         CLI   DLR6MH+5,0                                                       
         JE    *+12                                                             
         LA    R2,DLR6MH                                                        
         J     FLDINV                                                           
         ZIC   RE,TYPE                                                          
****     LA    RE,UDLRN13W(RE)                                                  
         LA    RE,UDLRA8-UDLRA(RE)                                              
****     LA    RE,5(RE)                                                         
         STC   RE,TYPE                                                          
         MVC   BYTE,TYPE                                                        
*                                                                               
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (BC - RADIO NETWORK)                            
         SPACE 1                                                                
VSCRBC   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('URNT1W',RNT1WH),('URNT4W',RNT4WH),       X        
               ('URNT8W',RNT8WH),('URNT13W',RNT13WH),                  X        
               ('URNT26U',RNT26UH),('URNT39U',RNT39UH),                X        
               ('URNTAB',RNTABH),(X'FF',0)                                      
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (BB - WILDSPOT)                                 
         SPACE 1                                                                
VSCRBB   DS    0H                                                               
         XC    WSPAUNT,WSPAUNT   CLEAR AUTO FIELD                               
         MVI   WSPAUNTH+5,0                                                     
         OI    WSPAUNTH+6,X'80'                                                 
         SPACE 1                                                                
         XC    TGUPCDE(TGUPTOTY+L'TGUPTOTY-TGUPCDE),TGUPCDE                     
         XC    TCUNITS(3),TCUNITS                                               
         SPACE 1                                                                
         GOTO1 VCHOICE,DMCB,('UWSP8W',WSP8WH),('UWSP13W',WSP13WH),     X        
               (X'FF',0)                                                        
         SPACE 1                                                                
         LA    R2,WSPUPGRH         R2=A(UPGRADE FLD HDR)                        
         CLI   8(R2),C'I'                                                       
         BE    VSCRBB5                                                          
         BRAS  RE,TESTUPGR         TEST FOR UPGRADE                             
         BNE   VSCRBB5                                                          
         MVI   BYTE,UWSPU13W       SET UPGRADE TYPE                             
         CLI   TYPE,UWSP13W                                                     
         BE    *+8                                                              
         MVI   BYTE,UWSPU8W                                                     
         MVC   TYPE,BYTE                                                        
         SPACE                                                                  
VSCRBB5  GOTO1 FLDVAL,DMCB,(X'40',WSP8WH),WSP13WH  TEST ALL VALID               
         BNE   *+12                                                             
         TM    WSPUPGRH+4,X'20'                                                 
         BO    VSCRBBX                                                          
         OI    LCLSTAT3,WSPTYPCH   ELSE SET TYPE CHANGED                        
         GOTO1 FLDVAL,DMCB,(X'20',WSP8WH),WSP13WH  MAKE ALL VALID               
         OI    WSPUPGRH+4,X'20'                                                 
VSCRBBX  B     XIT                                                              
         SPACE 2                                                                
*              VALIDATE SCREEN  (BA - NETWORK / CLA,LNB,LNA,LNC)                
         SPACE 1                                                                
VSCRBA   DS    0H                                                               
         MVI   TYPE,0              INIT TYPE TO 0                               
         CLI   TGUSEQU,UPAX        IF PAX                                       
         BNE   *+12                                                             
         MVI   TYPE,UPAXREG        SET REGULAR TYPE                             
         B     VSBAX                                                            
         CLI   TGUSEQU,UCLA        DONE IF NOT CLA                              
         BNE   VSBAX                                                            
         MVI   TYPE,UCLAREG        ONLY SET TYPE NOW - WILL VALIDATE            
         LA    R2,CLAG13H          USE DETAILS LATER                            
         CLI   5(R2),0                                                          
         BE    VSBAX                                                            
         CLI   8(R2),C'N'                                                       
         BE    VSBAX                                                            
         CLI   8(R2),C'Y'                                                       
         BNE   FLDINV                                                           
         MVI   TYPE,UCLAG13        GUARANTEED 13 USE                            
VSBAX    B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (B9 - CABLE)                                    
         SPACE 3                                                                
*              VALIDATE SCREEN  (B9 - CABLE)                                    
         SPACE 1                                                                
VSCRB9   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('UCAB4W',CAB4WH),                         X        
               ('UCAB13W',CAB13WH),('UCAB52W',CAB52WH),                X        
               ('UCABU413',CAB413H),('UCABU13',CAB1352H),              X        
               ('UCABU452',CAB452H),(X'FF',0)                                   
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (B8 - MUSIC)                                    
         SPACE 1                                                                
VSCRB8   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('UMUS13W',MUSREUH),('UMUSNEW',MUSNEWH),   X        
               ('UMUSDUB',MUSDUBH),(X'FF',0)                                    
*                                                                               
         USING TACOD,R4                                                         
         CLI   TYPE,UMUS13W        COMM'L MUST HAVE DUB DATE IF                 
         BE    VSCRB8B             DOING A DUB OR CONVERSION                    
         L     R4,ACOML                                                         
         MVI   ELCODE,TACOELQ                                                   
         BAS   RE,GETEL                                                         
         BNE   NODUBD                                                           
         OC    TACODUB,TACODUB                                                  
         BZ    NODUBD                                                           
         DROP  R4                                                               
*                                                                               
VSCRB8B  CLI   MUSLTSH+5,0         IF LONG TO SHORT SELECTED                    
         BE    VSCRB8BB                                                         
         LA    R2,MUSLTSH                                                       
         CLI   MUSDUBH+5,0         DUB MUST ALSO BE SELECTED                    
         BE    NOINPUT                                                          
         MVI   TYPE,UMUSDSH        SET TYPE                                     
                                                                                
VSCRB8BB CLI   MUSLTS2H+5,0        IF 2ND LONG TO SHORT SELECTED                
         BE    VSCRB8C                                                          
         LA    R2,MUSLTS2H                                                      
         CLI   TGMEEQU,RADIO       NOT VALID FOR RADIO                          
         BE    MEDERR                                                           
         CLI   MUSDUBH+5,0         DUB MUST ALSO BE SELECTED                    
         BE    NOINPUT                                                          
         CLI   TYPE,UMUSDSH        ENSURE LONG TO SHORT NOT SELECTED            
         BE    CHOICERR                                                         
         MVI   TYPE,UMUS2DS        SET TYPE                                     
                                                                                
VSCRB8C  CLI   TYPE,UMUS13W        IF REUSE SELECTED                            
         BNE   VSCRB8D                                                          
         BRAS  RE,CKMUSDT          CHECK MUSIC DATE                             
*                                                                               
VSCRB8D  XR    R0,R0               R0=LENGTH COUNTER                            
         ZIC   R1,TYPE             R1=TYPE                                      
*                                                                               
         CLI   MUS8WH+5,0          IF 8 WEEKS IS CHECKED                        
         BE    VSCRB8E                                                          
         LA    R2,MUS8WH                                                        
         CLI   TYPE,UMUS2DS        NOT VALID FOR 2ND TO SHORT                   
         BE    FLDINV                                                           
         CLI   TGMEEQU,RADIO       ONLY VALID FOR RADIO                         
         BNE   MEDERR                                                           
         AHI   R0,1                BUMP COUNTER                                 
         AHI   R1,1                AND BUMP TYPE                                
*                                                                               
VSCRB8E  CLI   MUS13WH+5,0         IF 13 WEEKS IS CHECKED                       
         BE    VSCRB8F                                                          
         LA    R2,MUS13WH                                                       
         LTR   R0,R0               MUST BE FIRST LENGTH CHECKED                 
         BNE   FLDINV                                                           
         AHI   R0,1                TYPE IS OK BUT MUST BUMP COUNTER             
*                                                                               
VSCRB8F  CLI   MUS6MH+5,0          IF 6 MONTHS IS CHECKED                       
         BE    VSCRB8G                                                          
         LA    R2,MUS6MH                                                        
         LTR   R0,R0               MUST BE FIRST LENGTH CHECKED                 
         BNE   FLDINV                                                           
         CLI   TYPE,UMUS2DS        NOT VALID FOR 2ND TO SHORT                   
         BE    FLDINV                                                           
         CLI   TGMEEQU,INTERNET    ONLY VALID FOR INTERNET                      
         BH    MEDERR                                                           
         CLI   TGMEEQU,NEWMEDIA    AND NEWMEDIA COMMERCIALS                     
         BL    MEDERR                                                           
         CLI   MUSDUBH+5,0         ONLY VALID FOR DUB PAYMENTS                  
         BE    FLDINV                                                           
         AHI   R0,1                BUMP COUNTER                                 
         AHI   R1,8                AND BUMP TYPE                                
*                                                                               
VSCRB8G  CLI   MUS1YH+5,0          IF 1 YEAR IS CHECKED                         
         BE    VSCRB8H                                                          
         LA    R2,MUS1YH                                                        
         LTR   R0,R0               MUST BE FIRST LENGTH CHECKED                 
         BNE   FLDINV                                                           
         CLI   TYPE,UMUS2DS        NOT VALID FOR 2ND TO SHORT                   
         BE    FLDINV                                                           
         CLI   TGMEEQU,INTERNET    TO INTERNET                                  
         BH    MEDERR                                                           
         CLI   TGMEEQU,NEWMEDIA    AND NEWMEDIA COMMERCIALS                     
         BL    MEDERR                                                           
         CLI   MUSDUBH+5,0         ONLY VALID FOR DUB PAYMENTS                  
         BE    FLDINV                                                           
         AHI   R0,1                BUMP COUNTER                                 
         AHI   R1,9                AND BUMP TYPE                                
*                                                                               
VSCRB8H  STC   R1,TYPE             SAVE TYPE                                    
         LTR   R0,R0               AND ENSURE AT LEAST 1 LENGTH                 
         BNE   XIT                 IS CHECKED                                   
         LA    R2,MUS8WH                                                        
         B     FLDMISS                                                          
         EJECT                                                                  
*              VALIDATE SCREEN  (76 - MUSIC RATE REUSE)                         
         SPACE 1                                                                
VSCR76   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('UMRR2YR',MRR2YRH),('UMRRFON',MRRFONH),   X        
               ('UMRRVID',MRRVIDH),(X'FF',0)                                    
         BRAS  RE,CKMUSDT                                                       
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (59 - RADIO REGIONAL NETWORK)                   
         SPACE 1                                                                
VSCR59   DS    0H                                                               
         MVI   TCMAJORS,0                                                       
         LA    R2,RRNNONEH         SET R2=A(NONE FIELD)                         
         SPACE                                                                  
         GOTO1 FLDVAL,DMCB,(X'80',RRNNONEH),(X'80',RRNCHIH) TEST EMPTY          
         BE    NOCHOICE            ERROR - NO SELECTION MADE                    
         SPACE                                                                  
VSC59C   CLI   RRNNYH+5,0          SET MAJORS - ANY INPUT IS OK                 
         BE    *+8                                                              
         OI    TCMAJORS,NY                                                      
         CLI   RRNLAH+5,0                                                       
         BE    *+8                                                              
         OI    TCMAJORS,LA                                                      
         CLI   RRNCHIH+5,0                                                      
         BE    *+8                                                              
         OI    TCMAJORS,CHI                                                     
         SPACE                                                                  
         CLI   TCMAJORS,0          IF THERE ARE MAJORS                          
         BE    XIT                                                              
         CLI   5(R2),0                                                          
         BNE   NOINPUT             INPUT NOT ALLOWED IN NONE FIELD              
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (5C - LOCAL REUSE)                              
         SPACE 1                                                                
VSCR5C   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('ULOCB',LOCBH),('ULOCBNY',LOCBNYH),       X        
               ('ULOCC',LOCCH),(X'FF',0)                                        
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (5E - FOREIGN REUSE)                            
         SPACE 1                                                                
VSCR5E   DS    0H                                                               
         LA    R2,FGRUKH                                                        
         GOTO1 FLDVAL,DMCB,(X'80',FGRUKH),FGRRADH  TEST ALL EMPTY               
         BE    NOCHOICE            ERROR - NO SELECTION MADE                    
         L     R3,8(R1)            SET R3=A(1ST SELECTED FIELD)                 
         LA    R2,FGRWORH                                                       
         CR    R3,R2               TEST IT'S AFTER REST FIELD                   
         BNH   VSCR5E5                                                          
         GOTO1 VCHOICE,WORK,('UFGRMAJ',FGRWIDEH),('UFGRRAD',FGRRADH),  X        
               (X'FF',0)                                                        
         CLI   TYPE,UFGRMAJ        IF W/WIDE SELECTED                           
         BNE   *+8                                                              
         MVI   TCMAJORS,WWIDE      SET MAJORS                                   
         B     VSCR5E10                                                         
         SPACE                                                                  
VSCR5E5  MVI   TYPE,UFGRMAJ        SET NEW TYPE FOR MULT. LOCATIONS             
         LA    R2,FGRWIDEH                                                      
         CLI   FGRWIDEH+5,0        IF W/WIDE ALSO SELECTED                      
         BNE   INCOMPT             ERROR - INCOMPATIBLE SELECTION               
         LA    R2,FGRRADH                                                       
         CLI   FGRRADH+5,0         IF RADIO ALSO SELECTED                       
         BNE   INCOMPT             ERROR - INCOMPATIBLE SELECTION               
         SPACE                                                                  
         LR    R2,R3               SET R2 TO 1ST SELECTED FLD                   
         GOTO1 USEVAL,DMCB,TGUSCDE,TYPE VALIDATE TYPE                           
         BNE   VSCR5E10                                                         
         MVC   BYTE,TGUSTYMD       TEST IT'S VALID FOR THIS MEDIA               
         NC    BYTE,TGMEEQU                                                     
         BZ    MEDERR                                                           
         SPACE                                                                  
         MVI   TCMAJORS,0                                                       
         CLI   FGRUKH+5,0          SET MAJORS - ANY INPUT IS OK                 
         BE    *+8                                                              
         OI    TCMAJORS,UK                                                      
         CLI   FGREURH+5,0                                                      
         BE    *+8                                                              
         OI    TCMAJORS,EUR                                                     
         CLI   FGRJAPH+5,0                                                      
         BE    *+8                                                              
         OI    TCMAJORS,JAP                                                     
         CLI   FGRAPH+5,0                                                       
         BE    *+8                                                              
         OI    TCMAJORS,AP                                                      
         CLI   FGRWORH+5,0                                                      
         BE    *+8                                                              
         OI    TCMAJORS,REST                                                    
         SPACE                                                                  
VSCR5E10 LA    R2,FGREXTH                                                       
         CLI   FGREXTH+5,0         TEST FOR EXTENSION CHOSEN                    
         BE    VSCR5EX                                                          
         CLI   TYPE,UFGRRAD        IF YES, TEST FOR RADIO CHOSEN                
         BE    INCOMPT             RADIO & EXT INCOMPATIBLE                     
         MVI   TYPE,UFGREXT        SET TYPE FOR EXTENSION                       
VSCR5EX  B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (5F - CABLE - BDCAST TV)                        
         SPACE 1                                                                
VSCR5F   DS    0H                                                               
         XC    CBLAUNT,CBLAUNT   CLEAR AUTO FIELD                               
         MVI   CBLAUNTH+5,0                                                     
         OI    CBLAUNTH+6,X'80'                                                 
         SPACE 1                                                                
         XC    TGUPCDE(TGUPTOTY+L'TGUPTOTY-TGUPCDE),TGUPCDE                     
         XC    TCUNITS(3),TCUNITS                                               
         XC    TCSUBS,TCSUBS                                                    
         SPACE 1                                                                
         MVI   TYPE,0            SET REGULAR TYPE FOR CBL/SCB                   
         TM    TGUSSTA3,CBLUSE                                                  
         BNZ   VSCR5F10                                                         
         MVI   TYPE,1            SET REGULAR TYPE FOR ALL OTHERS                
         SPACE 1                                                                
VSCR5F10 LA    R2,CBLUPGRH                                                      
         CLI   8(R2),C'I'                                                       
         BE    VSCR5F20                                                         
         BRAS  RE,TESTUPGR       TEST FOR UPGRADE                               
         BNE   VSCR5F20                                                         
         ZIC   RE,TYPE           SET UPGRADE TYPE                               
         AHI   RE,1                                                             
         STC   RE,TYPE                                                          
         SPACE 1                                                                
         CLI   TGUSEQU,ULCB      FOR LCB                                        
         BNE   VSCR5F20                                                         
         MVI   TYPE,ULCBU50      SET FAKE UPGRADE TYPE                          
         MVC   TGUPFRCD,=C'LCB'                                                 
         SPACE 1                                                                
VSCR5F20 TM    CBLUPGRH+4,X'20'  TEST UPGR FLD VALID                            
         BO    *+12                                                             
         OI    LCLSTAT3,WSPTYPCH ELSE SET TYPE CHANGED                          
         OI    CBLUPGRH+4,X'20'  SET UPGR FLD VALID                             
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (60 - FIRST MUSIC)                              
         SPACE 1                                                                
VSCR60   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('UFMU8W',FMU8WH),('UFMU13W',FMU13WH),     X        
               ('UFMU6M',FMU6MH),(X'FF',0)                                      
         BRAS  RE,CKMUSDT                                                       
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (61 - SPANISH WILDSPOT)                         
         SPACE 1                                                                
VSCR61   DS    0H                                                               
         MVI   TYPE,USWSREG        SET TYPE FOR SWS                             
         SPACE                                                                  
         LA    R2,SWSUNITH         R2=A(UNITS FIELD)                            
         BRAS  RE,VALUNITS         VALIDATE UNITS                               
         STH   R1,TCUNITS          SAVE N'UNITS                                 
         SPACE 1                                                                
         LTR   R1,R1               TEST THEY INPUT SOMETHING                    
         BZ    NEEDUNIT                                                         
         LA    R2,SWSUPGRH                                                      
         BRAS  RE,TESTUPGR         TEST FOR UPGRADE                             
         BNE   *+8                                                              
         MVI   TYPE,USWSUPG        SET UPGRADE TYPE FOR SWS                     
         SPACE                                                                  
         TM    SWSUPGRH+4,X'20'    TEST UPGR FLD VALID                          
         BO    *+12                                                             
         OI    LCLSTAT3,WSPTYPCH   ELSE SET TYPE CHANGED                        
         OI    SWSUPGRH+4,X'20'    SET UPGR FLD VALID                           
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (62 - FOREIGN MUSIC)                            
         SPACE 1                                                                
VSCR62   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('UFGMEU12',FGMUK12H),                     X        
               ('UFGMEU24',FGMUK24H),('UFGMNE12',FGMNE12H),            X        
               ('UFGMNE24',FGMNE24H),('UFGMWO12',FGMWO12H),            X        
               ('UFGMWO24',FGMWO24H),(X'FF',0)                                  
         BRAS  RE,CKMUSDT                                                       
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (63 - SPANISH NETWORK/WILDSPOT COMB.)           
         SPACE 1                                                                
VSCR63   DS    0H                                                               
         LA    R2,SNWUNITH         R2=A(UNITS FIELD)                            
         BRAS  RE,VALUNITS         VALIDATE UNITS                               
         STH   R1,TCUNITS          SAVE N'UNITS                                 
         SPACE                                                                  
         CLI   VERSION,0           IF PAYING A VERSION                          
         BE    VSCR63A                                                          
         CLI   SNWUPGWH+5,0        AND UPGRADING FROM SWS                       
         BNE   VSCR63B             UNITS ARE NOT REQUIRED                       
         SPACE                                                                  
VSCR63A  LTR   R1,R1               ELSE TEST THEY INPUT SOMETHING               
         BZ    NEEDUNIT                                                         
         SPACE                                                                  
VSCR63B  MVI   TYPE,0                                                           
         LA    R2,SNWUPGNH         TEST FOR UPGRADE                             
         BRAS  RE,TESTUPGR                                                      
         BNE   *+8                                                              
         MVI   TYPE,USNWUN         SET UPGRADE TYPE                             
         SPACE                                                                  
         LA    R2,SNWUPGWH         TEST FOR UPGRADE                             
         BRAS  RE,TESTUPGR                                                      
         BNE   VSCR637                                                          
         CLI   TYPE,0                                                           
         BNE   CHOICERR                                                         
         MVI   TYPE,USNWUW         SET UPGRADE TYPE                             
         SPACE                                                                  
         OC    TCUNITS,TCUNITS                                                  
         BNZ   VSCR637                                                          
         OI    LCLSTAT7,SNW0UNIT                                                
         SPACE                                                                  
VSCR637  LA    R2,SNWUPGCH         TEST FOR UPGRADE                             
         BRAS  RE,TESTUPGR                                                      
         BNE   VSCR638                                                          
         CLI   TYPE,0                                                           
         BNE   CHOICERR                                                         
         MVI   TYPE,USNWUC         SET UPGRADE TYPE                             
         B     VSCR639                                                          
         SPACE                                                                  
VSCR638  CLI   TYPE,0                                                           
         BNE   *+8                                                              
         MVI   TYPE,USNWREG        SET REGULAR TYPE FOR SNW                     
         SPACE                                                                  
VSCR639  GOTO1 FLDVAL,DMCB,(X'40',SNWUPGNH),SNWUPGCH  TEST ALL VALID            
         BE    VSCR63X                                                          
         OI    LCLSTAT3,WSPTYPCH   ELSE SET TYPE CHANGED                        
         GOTO1 FLDVAL,DMCB,(X'20',SNWUPGNH),SNWUPGCH  MAKE ALL VALID            
VSCR63X  B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (64 - ADDENDUM SESSION - TV)                    
         SPACE 1                                                                
VSCR64   DS    0H                                                               
         TM    PAYMODE,DTLONBSE    IF NOT SET YET                               
         BO    *+12                                                             
         OI    PAYMODE,DTLONBSE    SET DETAIL ON BASE SCREEN                    
         OI    LCLSTAT,DTLFIRST    AND FIRST TIME FOR DETAIL                    
         SPACE                                                                  
         CLI   ADDTYPES+1,X'FF'    IF ONLY 1 TYPE                               
         BNE   VSCR645                                                          
         MVC   TYPE,ADDTYPES       SET TYPE                                     
         B     XIT                                                              
         SPACE                                                                  
VSCR645  LA    R4,ADDTYPES         SET TYPES                                    
         GOTO1 VCHOICE,WORK,(0(R4),ADTTTY1H),(1(R4),ADTTTY2H),         X        
               (2(R4),ADTTTY3H),(3(R4),ADTTTY4H),(4(R4),ADTTTY5H),     X        
               (X'FF',0)                                                        
*                                                                               
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         BNE   XIT                 IF 3RD OR 4TH HEADINGS ARE SELECTED          
         DROP  R1                  SET BITS FOR OTHER RATES                     
         CLI   ADTTTY3H+5,0                                                     
         BE    *+8                                                              
         OI    TCPAYST,TCUNLMTD    ONE YEAR UNLIMITED RATE                      
         CLI   ADTTTY4H+5,0                                                     
         BE    XIT                                                              
         OI    TCPAYST,TCSINGLE    SINGLE MARKET RATE                           
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (65 - ADDENDUM SESSION - RADIO)                 
         SPACE 1                                                                
VSCR65   DS    0H                                                               
         TM    PAYMODE,DTLONBSE    IF NOT SET YET                               
         BO    *+12                                                             
         OI    PAYMODE,DTLONBSE    SET DETAIL ON BASE SCREEN                    
         OI    LCLSTAT,DTLFIRST    AND FIRST TIME FOR DETAIL                    
         SPACE                                                                  
         CLI   ADDTYPES+1,X'FF'    IF ONLY 1 TYPE                               
         BNE   VSCR655                                                          
         MVC   TYPE,ADDTYPES       SET TYPE                                     
         B     XIT                                                              
         SPACE                                                                  
VSCR655  LA    R4,ADDTYPES         SET TYPES                                    
         GOTO1 VCHOICE,WORK,(0(R4),ADOTTY1H),(1(R4),ADOTTY2H),         X        
               (2(R4),ADOTTY3H),(3(R4),ADOTTY4H),(4(R4),ADOTTY5H),     X        
               (X'FF',0)                                                        
*                                                                               
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         BNE   XIT                 IF 3RD OR 4TH HEADINGS ARE SELECTED          
         DROP  R1                  SET BITS FOR OTHER RATES                     
         CLI   ADOTTY3H+5,0                                                     
         BE    *+8                                                              
         OI    TCPAYST,TCUNLMTD    ONE YEAR UNLIMITED RATE                      
         CLI   ADOTTY4H+5,0                                                     
         BE    XIT                                                              
         OI    TCPAYST,TCSINGLE    SINGLE MARKET RATE                           
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (66 - ADDENDUM WILDSPOT)                        
         SPACE 1                                                                
VSCR66   DS    0H                                                               
         XC    ADWAUNT,ADWAUNT   CLEAR AUTO FIELD                               
         MVI   ADWAUNTH+5,0                                                     
         OI    ADWAUNTH+6,X'80'                                                 
         SPACE 1                                                                
         XC    TGUPCDE(TGUPTOTY+L'TGUPTOTY-TGUPCDE),TGUPCDE                     
         XC    TCUNITS(3),TCUNITS                                               
         SPACE 1                                                                
         CLI   ADDTYPES+1,X'FF'    IF ONLY 1 TYPE                               
         BNE   VSCR662                                                          
         MVC   TYPE,ADDTYPES       SET TYPE                                     
         B     VSCR663                                                          
         SPACE                                                                  
VSCR662  LA    R4,ADDTYPES         SET TYPE                                     
         GOTO1 VCHOICE,WORK,(0(R4),ADWTTY1H),(1(R4),ADWTTY2H),         X        
               (2(R4),ADWTTY3H),(3(R4),ADWTTY4H),(4(R4),ADWTTY5H),     X        
               (X'FF',0)                                                        
*                                                                               
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         BNE   VSCR663             IF 3RD HEADING IS SELECTED                   
         DROP  R1                  SET BIT FOR ONE YEAR UNLIMITED RATE          
         CLI   ADWTTY3H+5,0                                                     
         BE    *+8                                                              
         OI    TCPAYST,TCUNLMTD    ONE YEAR UNLIMITED RATE                      
*                                                                               
VSCR663  LA    R2,ADWUPGRH         TEST FOR UPGRADE                             
         CLI   8(R2),C'I'                                                       
         BE    VSCR668                                                          
         BRAS  RE,TESTUPGR                                                      
         BNE   VSCR668                                                          
         L     R4,TGAUPGRS         R4=A(UPGRADE TABLE)                          
         SPACE                                                                  
         USING UPGRDD,R4                                                        
VSCR664  CLI   0(R4),X'FF'         TEST NOT END OF TABLE                        
         BNE   *+6                                                              
         DC    H'0'                                                             
         CLC   UPGFRCD,TGUSCDE     MATCH ON FROM USE CODE                       
         BNE   *+14                                                             
         CLC   UPGFRTY,TYPE        AND FROM TYPE                                
         BE    *+12                                                             
         LA    R4,UPGLNQ(R4)       ELSE BUMP TO NEXT ENTRY                      
         B     VSCR664                                                          
         SPACE                                                                  
         MVC   TYPE,UPGTYP               SET UPGRADE TYPE                       
         GOTO1 USEVAL,DMCB,TGUSCDE,TYPE  RE-VALIDATE TYPE                       
         SPACE 1                                                                
VSCR668  GOTO1 FLDVAL,DMCB,(X'40',ADWTTY1H),ADWTTY5H  TEST ALL VALID            
         BNE   *+12                                                             
         TM    ADWUPGRH+4,X'20'                                                 
         BO    VSCR66X                                                          
         OI    LCLSTAT3,WSPTYPCH   ELSE SET TYPE CHANGED                        
         GOTO1 FLDVAL,DMCB,(X'20',ADWTTY1H),ADWTTY5H  MAKE ALL VALID            
         OI    ADWUPGRH+4,X'20'                                                 
         SPACE 1                                                                
VSCR66X  B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (67 - ADDENDUM COMBINED SESS/WSP)               
         SPACE 1                                                                
VSCR67   DS    0H                                                               
         CLI   ADDTYPES+1,X'FF'    IF ONLY 1 TYPE                               
         BNE   VSCR675                                                          
         MVC   TYPE,ADDTYPES       SET TYPE                                     
         B     VSCR678                                                          
         SPACE                                                                  
VSCR675  LA    R4,ADDTYPES         SET TYPES                                    
         GOTO1 VCHOICE,WORK,(0(R4),ADCTTY1H),(1(R4),ADCTTY2H),         X        
               (2(R4),ADCTTY3H),(3(R4),ADCTTY4H),(4(R4),ADCTTY5H),     X        
               (X'FF',0)                                                        
*                                                                               
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         BNE   VSCR678             IF 3RD HEADING IS SELECTED                   
         DROP  R1                  SET BIT FOR ONE YEAR UNLIMITED RATE          
         CLI   ADCTTY3H+5,0                                                     
         BE    *+8                                                              
         OI    TCPAYST,TCUNLMTD    ONE YEAR UNLIMITED RATE                      
         SPACE 1                                                                
VSCR678  LA    R2,ADCUNITH         R2=A(UNITS FIELD)                            
         BRAS  RE,VALUNITS         VALIDATE UNITS                               
         STH   R1,TCUNITS          SAVE N'UNITS                                 
         SPACE 1                                                                
         LTR   R1,R1               TEST THEY INPUT SOMETHING                    
         BZ    NEEDUNIT                                                         
         B     XIT                                                              
*&&DO                                                                           
         SPACE 3                                                                
*              VALIDATE SCREEN  (68 - INSERTS FOR BOOKENDS)                     
         SPACE 1                                                                
VSCR68   DS    0H                                                               
         MVI   TYPE,UIFBREG        SET TYPE FOR IFB                             
         SPACE                                                                  
         LA    R2,IFBINSH          R2=A(INSERTS FIELD)                          
         BRAS  RE,VALUNITS         VALIDATE INSERTS                             
         STH   R1,TCINSRTS         SAVE N'INSERTS                               
         SPACE 1                                                                
         LTR   R1,R1               TEST THEY INPUT AT LEAST 1 INSERT            
         BZ    NEEDINS                                                          
         SPACE                                                                  
         LA    R2,IFBUPGRH                                                      
         BRAS  RE,TESTUPGR         TEST FOR UPGRADE                             
         BNE   *+8                                                              
         MVI   TYPE,UIFBUPG        SET UPGRADE TYPE FOR IFB                     
         SPACE                                                                  
         TM    IFBUPGRH+4,X'20'    TEST UPGR FLD VALID                          
         BO    *+12                                                             
         OI    LCLSTAT3,WSPTYPCH   ELSE SET TYPE CHANGED                        
         OI    IFBUPGRH+4,X'20'    SET UPGR FLD VALID                           
         B     XIT                                                              
*&&                                                                             
         EJECT                                                                  
*              VALIDATE SCREEN  (6A - TAGS)                                     
         SPACE 1                                                                
VSCR6A   DS    0H                                                               
         MVI   TYPE,UTAGREG        SET REGULAR TYPE OF TAGS                     
         LA    R2,TAGTAGH          R2=A(TAGS FIELD)                             
         GOTO1 VALINUM                                                          
         MVC   TCTAGS,ACTUAL                                                    
         SPACE 1                                                                
         LA    R2,TAGSESSH                                                      
         CLI   5(R2),0                                                          
         BE    XIT                                                              
         CLI   8(R2),C'N'                                                       
         BE    XIT                                                              
         CLI   8(R2),C'Y'                                                       
         BNE   FLDINV                                                           
         MVI   TYPE,UTAGSESS       SET TYPE FOR 1 TAG AT SESSION RATE           
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (6D - INDUST. REUSE)                            
         SPACE 1                                                                
VSCR6D   DS    0H                                                               
         GOTO1 VCHOICE,DMCB,('UINR30D',INR30DH),('UINRUNL',INRUNLH),   X        
               (X'FF',0)                                                        
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (70 - DEMOS)                                    
         SPACE 1                                                                
VSCR70   DS    0H                                                               
         LA    R2,DEMDEMOH         R2=A(DEMO FIELD)                             
         GOTO1 VALINUM                                                          
         MVC   TCDEMO,ACTUAL                                                    
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (71 - LOCAL CABLE)                              
         SPACE 1                                                                
VSCR71   DS    0H                                                               
         LA    R2,LCBUPGRH         R2=A(UPGRADE FLD HDR)                        
         CLI   TGUSEQU,UACB        ADDENDUM CABLE?                              
         BNE   VSCR7140                                                         
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'GA'     IF ADDENDUM STATE IS GEORGIA                 
         BE    *+10                                                             
         CLC   TACOADST,=C'TX'     IF ADDENDUM STATE IS TEXAS                   
         BNE   VSCR714                                                          
         BRAS  RE,TESTUPGR         TEST FOR UPGRADE                             
         BNE   VSCR713                                                          
         CLI   8(R2),C'F'          IF FORCING UPGRADE                           
         BNE   VSCR713                                                          
         GOTO1 VCHOICE,PARAS,('UACB50',LCBL50H),('UACB100',LCBL100H),  X        
               ('UACB150',LCBL150H),('UACB200',LCBL200H),              X        
               ('UACB250',LCBL250H),('UACB500',LCBL500H),              X        
               ('UACB750',LCBL750H),('UACB1M',LCBL1MIH),               X        
               ('UACBMAX',LCBLMAXH),(X'FF',0)                                   
         MVC   TGUPFRTY,TYPE       SAVE UPGRADE INFO                            
*                                                                               
VSCR713  GOTO1 VCHOICE,PARAS,('UACB50',LCB50H),('UACB100',LCB100H),    X        
               ('UACB150',LCB150H),('UACB200',LCB200H),                X        
               ('UACB250',LCB250H),('UACB500',LCB500H),                X        
               ('UACB750',LCB750H),('UACB1M',LCB1MILH),                X        
               ('UACBMAX',LCBMAXH),(X'FF',0)                                    
         B     VSCR7125                                                         
*                                                                               
VSCR714  CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NOT NORTHWEST,          
         BNE   ADDENERR            INVALID USE TYPE                             
         CLI   8(R2),C'I'                                                       
         BE    VSCR7115                                                         
         BRAS  RE,TESTUPGR         TEST FOR UPGRADE                             
         BNE   VSCR7115                                                         
         CLI   8(R2),C'F'          IF FORCING UPGRADE                           
         BNE   VSCR7115                                                         
*                                                                               
         CLI   LCBLMAXH+5,0        IS 1 MILLION ALSO SELECTED?                  
         BNE   VSCR715                                                          
         GOTO1 VCHOICE,PARAS,('UACB50',LCBL50H),('UACB100',LCBL100H),  X        
               ('UACB150',LCBL150H),('UACB200',LCBL200H),              X        
               ('UACB250',LCBL250H),('UACB500',LCBL500H),              X        
               ('UACB750',LCBL750H),('UACB1M',LCBL1MIH),(X'FF',0)               
         B     VSCR7110                                                         
VSCR715  GOTO1 VCHOICE,PARAS,('UACBM50',LCBL50H),('UACBM100',LCBL100H),X        
               ('UACBM150',LCBL150H),('UACBM200',LCBL200H),            X        
               ('UACBM250',LCBL250H),('UACBM500',LCBL500H),            X        
               ('UACBM750',LCBL750H),('UACBM1M',LCBL1MIH),(X'FF',0)             
         OI    TCPAYST,TCMILFR     SET FLAG TO ADD 1MIL RATE TO RATE            
VSCR7110 MVC   TGUPFRTY,TYPE       SAVE UPGRADE INFO                            
*                                                                               
VSCR7115 CLI   LCBMAXH+5,0         ADDING 1 MILLION RATE?                       
         BNE   VSCR7120                                                         
         GOTO1 VCHOICE,PARAS,('UACB50',LCB50H),('UACB100',LCB100H),    X        
               ('UACB150',LCB150H),('UACB200',LCB200H),                X        
               ('UACB250',LCB250H),('UACB500',LCB500H),                X        
               ('UACB750',LCB750H),('UACB1M',LCB1MILH),(X'FF',0)                
         B     VSCR7125                                                         
VSCR7120 GOTO1 VCHOICE,PARAS,('UACBM50',LCB50H),('UACBM100',LCB100H),  X        
               ('UACBM150',LCB150H),('UACBM200',LCB200H),              X        
               ('UACBM250',LCB250H),('UACBM500',LCB500H),              X        
               ('UACBM750',LCB750H),('UACBM1M',LCB1MILH),(X'FF',0)              
         OI    TCPAYST,TCMIL       ADD 1MIL RATE TO THIS RATE                   
*                                                                               
VSCR7125 CLI   8(R2),C'F'          SKIP IF FORCING UPGRADE                      
         BE    VSCR7180                                                         
         CLI   8(R2),C'Y'          IF UPGRADE                                   
         BNE   VSCR71X                                                          
         MVI   TGUPFRTY,UACB50     SET DUMMY "FROM" TYPE FOR NOW                
         B     VSCR7180                                                         
*                                                                               
*                                  LOCAL CABLE                                  
VSCR7140 DC    0H                                                               
*&&DO                                                                           
VSCR7140 BRAS  RE,TESTUPGR         TEST FOR UPGRADE                             
         BNE   VSCR7150                                                         
         CLI   8(R2),C'F'          IF FORCING UPGRADE                           
         BNE   VSCR7150                                                         
         GOTO1 VCHOICE,PARAS,('ULCB50',LCBL50H),('ULCB100',LCBL100H),  X        
               ('ULCB150',LCBL150H),('ULCB200',LCBL200H),              X        
               ('ULCB250',LCBL250H),('ULCB500',LCBL500H),              X        
               ('ULCB750',LCBL750H),('ULCB1M',LCBL1MIH),               X        
               ('ULCBMAX',LCBLMAXH),(X'FF',0)                                   
         MVC   TGUPFRTY,TYPE       SAVE UPGRADE INFO                            
VSCR7150 GOTO1 VCHOICE,PARAS,('ULCB50',LCB50H),('ULCB100',LCB100H),    X        
               ('ULCB150',LCB150H),('ULCB200',LCB200H),                X        
               ('ULCB250',LCB250H),('ULCB500',LCB500H),                X        
               ('ULCB750',LCB750H),('ULCB1M',LCB1MILH),                X        
               ('ULCBMAX',LCBMAXH),(X'FF',0)                                    
         CLI   8(R2),C'F'          SKIP IF FORCING UPGRADE                      
         BE    VSCR7180                                                         
         CLI   8(R2),C'Y'          IF UPGRADE                                   
         BNE   VSCR71X                                                          
         MVI   TGUPFRTY,ULCB50     SET DUMMY "FROM" TYPE FOR NOW                
*&&                                                                             
*                                                                               
VSCR7180 GOTO1 UPGRVAL,DMCB,(X'80',TGUSCDE),TGUPFRTY,TGUSCDE,TYPE               
         BNE   NOTUPG                                                           
         MVC   TYPE,TGUPTYP                                                     
         SPACE 1                                                                
*&&UK                                                                           
VSCR7115 MVI   TCMAJORS,0                                                       
         CLI   LCBNYH+5,0          SET MAJORS - ANY INPUT IS OK                 
         BE    *+8                                                              
         OI    TCMAJORS,NY                                                      
         CLI   LCBLAH+5,0                                                       
         BE    *+8                                                              
         OI    TCMAJORS,LA                                                      
         CLI   LCBCHIH+5,0                                                      
         BE    *+8                                                              
         OI    TCMAJORS,CHI                                                     
*&&                                                                             
         SPACE                                                                  
VSCR71X  B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (72 - PNH)                                      
         SPACE 1                                                                
VSCR72   DS    0H                                                               
         LA    R2,PNHCYCH                                                       
         CLI   5(R2),0                                                          
         BE    FLDMISS                                                          
VSCR72X  B     VSCRSESS                                                         
         EJECT                                                                  
*&&DO                                                                           
*              VALIDATE SCREEN  (73 - VAR)                                      
         SPACE 1                                                                
VSCR73   DS    0H                                                               
         LA    R2,VARVARH          R2=A(VAR/INS FIELD)                          
         BRAS  RE,VALUNITS         VALIDATE NUMBER                              
         STH   R1,TCINSRTS         SAVE IN TCINSRTS                             
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (74 - VNW)                                      
         SPACE 1                                                                
VSCR74   DS    0H                                                               
         MVI   TYPE,UVNWREG        SET REGULAR TYPE OF VNW                      
         LA    R2,VNWVNWH          R2=A(VAR/INS FIELD)                          
         BRAS  RE,VALUNITS         VALIDATE NUMBER                              
         STH   R1,TCINSRTS         SAVE IN TCINSRTS                             
         SPACE 1                                                                
         LA    R2,VNWSESSH                                                      
         CLI   5(R2),0                                                          
         BE    XIT                                                              
         CLI   8(R2),C'N'                                                       
         BE    XIT                                                              
         CLI   8(R2),C'Y'                                                       
         BNE   FLDINV                                                           
         MVI   TYPE,UVNWSESS       SET TYPE FOR 1 VAR/INS AT SESS RATE          
         B     XIT                                                              
         SPACE 3                                                                
*&&                                                                             
*              VALIDATE SCREEN  (76 - NBM)                                      
         SPACE 1                                                                
VSCR75   DS    0H                                                               
         GOTO1 VCHOICE,DMCB,('UNBM8WK',NBM8WKH),('UNBM1YR',NBM1YRH),   X        
               ('UNBM2YR',NBM2YRH),(X'FF',0)                                    
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (77 - ITN)                                      
         SPACE 1                                                                
VSCR77   DS    0H                                                               
         XC    TCUSETAB,TCUSETAB   CLEAR CLASS A VARIABLES                      
         XC    TCTXUSES,TCTXUSES                                                
         XC    TCTXUSEL,TCTXUSEL                                                
         XC    TCNUSESL,TCNUSESL                                                
         XC    TCNUSESP,TCNUSESP                                                
         XC    TCTXUSCR,TCTXUSCR                                                
         XC    TCTXULCR,TCTXULCR                                                
         SPACE 1                                                                
         LA    R2,ITNAUTOH         IF ITN AUTOMATIC OPTION CHECKED              
         CLI   5(R2),0                                                          
         BE    VSCR77A                                                          
         LA    R2,ITNEUSEH         ENDING USE                                   
         CLI   5(R2),0                                                          
         BNE   FLDINV                                                           
         LA    R2,ITNNUSEH         AND NUMBER OF USES CANNOT BE                 
         CLI   5(R2),0             CHECKED                                      
         BNE   FLDINV                                                           
         B     VSCR77X                                                          
         SPACE 1                                                                
VSCR77A  CLI   ITNEUSEH+5,0        IF NONE ARE CHECKED                          
         BNE   VSCR77B                                                          
         CLI   ITNNUSEH+5,0        GIVE MISSING INPUT MESSAGE                   
         BE    FLDMISS                                                          
         SPACE 1                                                                
VSCR77B  LA    R2,ITNEUSEH         IF AUTO OPTION NOT CHECKED                   
         GOTO1 ANY                 ENDING USE AND NUMBER OF USES                
         LA    R2,ITNNUSEH         ARE REQUIRED                                 
         GOTO1 ANY                                                              
         SPACE 1                                                                
         BRAS  RE,VALUNITS         SAVE NUMBER OF USES TO PAY                   
         LTR   R1,R1               IN TCTUSES                                   
         BZ    FLDINV              (CANNOT BE ZERO)                             
         STH   R1,TCTUSES                                                       
         SPACE 1                                                                
         LA    R2,ITNEUSEH         VALIDATE LAST CLA USE NUMBER                 
         BRAS  RE,VALUNITS                                                      
         LTR   R1,R1               CANNOT BE ZERO                               
         BZ    FLDINV                                                           
         CH    R1,TCTUSES          MUST BE LESS THAN NUMBER OF                  
         BL    FLDINV              USES TO PAY                                  
         SPACE 1                                                                
         SH    R1,TCTUSES          SAVE STARTING USE NUMBER                     
         STH   R1,TCUNITS          IN TCUNITS                                   
VSCR77X  B     XIT                                                              
         SPACE 3                                                                
         EJECT                                                                  
*              VALIDATE SCREEN  (79 - SPANISH FOREIGN REUSE)                    
         SPACE 1                                                                
VSCR79   DS    0H                                                               
         LA    R2,SFRSFAH                                                       
         GOTO1 FLDVAL,DMCB,(X'80',SFRSFAH),SFRSFCH  TEST ALL EMPTY              
         BE    NOCHOICE            ERROR - NO SELECTION MADE                    
         GOTO1 VCHOICE,WORK,('USFRA',SFRSFAH),('USFRB',SFRSFBH),       X        
               ('USFRC',SFRSFCH),(X'FF',0)                                      
VSCR79X  B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (78 - HOLDING FEE)                              
         SPACE 1                                                                
VSCR78   DS    0H                                                               
         TM    TGFASTAT,TGFROMFA   IF PAYMENT COMING FROM WEB                   
         BO    XIT                 VALIDATION NOT REQUIRED                      
         SPACE                                                                  
         LA    R2,HLDFULH                                                       
         XC    HSD(HSLNQ),HSD                                                   
         SPACE                                                                  
         USING TACOD,R1                                                         
         L     R1,TCATACO                                                       
         CLI   TACOSPCY,C'Y'       TEST IF SPLIT CYCLES SET                     
         BE    VSCR78A                                                          
         SPACE                                                                  
         CLI   5(R2),0                                                          
         BNE   FLDINV                                                           
         LA    R2,HLDSELH                                                       
         CLI   5(R2),0                                                          
         BNE   FLDINV                                                           
         B     VSCR78X                                                          
         SPACE                                                                  
VSCR78A  GOTO1 FLDVAL,DMCB,(X'80',HLDFULH),HLDSELH IF SET,TST ALL EMP           
         BE    NOCHOICE            ERROR - NO SELECTION MADE                    
         GOTO1 VCHOICE,WORK,('UHLDFCST',HLDFULH),                      X        
               ('UHLDSCST',HLDSELH),(X'FF',0)                                   
         SPACE                                                                  
         CLI   TYPE,UHLDFCST                                                    
         BNE   VSCR78B                                                          
         TM    PAYSTAT1,CASTSELD                                                
         BO    FLDINV                                                           
         SPACE                                                                  
VSCR78B  CLI   TYPE,UHLDSCST                                                    
         BNE   VSCR78X                                                          
         TM    PAYSTAT1,CASTSELD                                                
         BO    VSCR78X                                                          
         LA    R2,HLDSELH                                                       
         TM    PAYMODE,DRAFT                                                    
         BO    NOTIFDFT                                                         
         MVC   HSAUTH,HLDAUTH                                                   
         MVC   HSEST,HLDEST                                                     
         MVC   HSPD,HLDPD                                                       
         MVC   HSCYC,HLDCYC                                                     
         MVC   HSDTL,HLDDTL                                                     
         MVC   HSBNP,HLDBNP                                                     
         MVC   HSEINV,HLDEINV                                                   
         MVC   HSHCOM,HLDHCOM                                                   
         MVC   HSOPT,HLDOPT                                                     
         MVC   HSICOM,HLDICOM                                                   
         GOTO1 APAYINIT,DMCB,X'40'                                              
VSCR78X  B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (81 - INTERNET/NEW MEDIA)                       
         SPACE 1                                                                
VSCR81   DS    0H                                                               
         MVC   BYTE,TGMEEQU        SAVE COMMERCIAL MEDIA                        
         SPACE 1                                                                
         LA    R2,IRNFRSTH         R2=A(1ST INTERNET/NEWMEDIA FIELD)            
         LA    R3,IRNLSTH          R3=A(LAST INTERNET/NEWMEDIA FIELD)           
         B     VSCR82B                                                          
         EJECT                                                                  
*              VALIDATE SCREEN  (82 - MOVE TO NEW MEDIA)                        
         SPACE 1                                                                
VSCR82   DS    0H                                                               
         GOTO1 VCHOICE,DMCB,('UMVII4W',MOVI4WH),('UMVII8W',MOVI8WH),   X        
               ('UMVII1Y',MOVI1YH),('UMVIEXT',MOVE1YH),(X'FF',0)                
         SPACE 1                                                                
         MVC   BYTE,TGMEEQU        SAVE COMMERCIAL MEDIA                        
         SPACE 1                                                                
         MVI   TGMEEQU,INTERNET    SET TO READ INTERNET RECORDS                 
         CLI   TGUSEQU,UMVI                                                     
         BE    VSCR82A                                                          
         CLI   TGUSEQU,USMI                                                     
         BE    VSCR82A                                                          
         MVI   TGMEEQU,NEWMEDIA    OR NEWMEDIA RECORDS                          
         SPACE 1                                                                
VSCR82A  LA    R2,MOVFRSTH         R2=A(1ST INTERNET/NEWMEDIA FIELD)            
         LA    R3,MOVLSTH          R3=A(LAST INTERNET/NEWMEDIA FIELD)           
         SPACE 1                                                                
         USING MEDTABLD,R4                                                      
VSCR82B  L     R4,AMEDTABL         CLEAR INTERNET/NEW MEDIA TABLE               
         LHI   RF,L'MEDTABL                                                     
         XCEFL 0(R4)                                                            
         SPACE 1                                                                
         GOTO1 FLDVAL,DMCB,(X'80',(R2)),(X'80',(R3))                            
         BE    VSCR82F                                                          
         SPACE 1                                                                
VSCR82C  CR    R2,R3               IF MORE FIELDS TO VALIDATE                   
         BH    VSCR82F                                                          
         SPACE 1                                                                
         ZIC   RE,0(R2)            BUMP PAST > FIELD                            
         AR    R2,RE                                                            
         SPACE 1                                                                
         CLI   5(R2),0             IF FIELD IS EMPTY, SKIP IT                   
         BE    VSCR82E                                                          
         SPACE 1                                                                
         GOTO1 RECVAL,DMCB,TLMDCDQ,(4,(R2))                                     
         BE    VSCR82D                                                          
         MVC   TGMEEQU,BYTE                                                     
         B     RECNTFD                                                          
         SPACE 1                                                                
VSCR82D  MVC   MEDTYP,TGMEEQU      IF FOUND, ADD TO INTERNET/                   
         MVC   MEDCOD,TGMDCODE     NEW MEDIA TABLE                              
         LA    R4,MEDLNQ(R4)                                                    
         SPACE 1                                                                
VSCR82E  ZIC   RE,0(R2)            BUMP TO NEXT > FIELD                         
         AR    R2,RE                                                            
         B     VSCR82C                                                          
         SPACE 1                                                                
VSCR82F  MVC   TGMEEQU,BYTE        IF ALL VALID, RESTORE GLOBAL MEDIA           
         MVI   0(R4),X'FF'         MARK END OF INTERNET/NEW MEDIA TAB           
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (83 - LIFT)                                     
         SPACE 1                                                                
VSCR83   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('ULFTFFCY',LFTFFCH),                      X        
               ('ULFTFFCN',LFTNFFCH),(X'FF',0)                                  
         B     XIT                                                              
         EJECT                                                                  
*              VALIDATE SCREEN  (84 - RADIO GUARANTEE)                          
         SPACE 1                                                                
VSCR84   DS    0H                                                               
         MVI   TYPE,0                                                           
         CLI   GRRUSEH+5,0         IF USE FIELD IS EMPTY, GUARANTEE             
         BE    XIT                 COVERS ALL USES                              
*                                                                               
         LA    R2,GRRUSEH                                                       
         CLI   5(R2),3                                                          
         BNE   FLDINV                                                           
*                                                                               
         USING USETABD,RE                                                       
         L     RE,TGAUSES          RE=A(USE TABLE)                              
VSCR84A  CLI   0(RE),X'FF'         IF END OF TABLE REACHED, INPUT               
         BE    FLDINV              IS NOT A VALID USE                           
         CLC   USECDE,8(R2)                                                     
         BE    VSCR84B                                                          
         LH    RF,USELEN           BUMP TO NEXT USE ENTRY                       
         AR    RE,RF                                                            
         B     VSCR84A                                                          
*                                                                               
VSCR84B  TM    USEMEDS,RADIO       WHEN USE IS FOUND, ENSURE IT IS              
         BZ    FLDINV              VALID FOR RADIO                              
         TM    USESTAT2,APPREUSE   AND ENSURE IT DOES NOT CREATE                
         BO    FLDINV              AN FTRACK                                    
         MVC   TYPE,USEEQU         AND SAVE TYPE                                
         B     XIT                                                              
         DROP  RE                                                               
         EJECT                                                                  
*              VALIDATE SCREEN  (86 - CANADIAN NEWMEDIA)                        
         SPACE 1                                                                
VSCR86   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('UCNM4W',CNM4WKH),('UCNM8W',CNM8WKH),     X        
               ('UCNM26W',CNM26WKH),('UCNM1Y',CNM1YRH),(X'FF',0)                
*                                                                               
         LA    R2,CNMCUTSH         CUTS FOR AUDIO ONLY                          
         CLI   5(R2),0                                                          
         BE    XIT                                                              
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLI   TACOCTYP,CCTYADO    ACTRA TYPE MUST BE AUDIO                     
         BNE   FLDINV                                                           
         BRAS  RE,VALUNITS         VALIDATE UNITS FIELD                         
         STH   R1,TCUNITS          SAVE N'UNITS                                 
         B     XIT                 R2=A(UNITS FIELD)                            
         SPACE 3                                                                
*              VALIDATE SCREEN  (19 - STORECASTING)                             
         SPACE 1                                                                
VSCR19   DS    0H                                                               
*                                                                               
*        LOOK FOR ENTRY IN ONE OF 3 FIELDS                                      
*                                                                               
         GOTO1 VCHOICE,DMCB,('USTRBUY',STRBOUTH),('USTR3MO',STR3MH),   X        
               ('USTR6MO',STR6MH),(X'FF',0)                                     
*                                                                               
         CLI   STREXTH+5,0         IF ENTRY IN EXTENSION FIELD                  
         BE    VSCR19X                                                          
*                                                                               
         CLI   TYPE,USTRBUY           IF BUYOUT FLAGGED                         
         BNE   *+12                                                             
         LA    R2,STREXTH                POINT TO FIELD IN ERROR                
         B     FLDINV                    ERROR                                  
*                                                                               
         CLI   TYPE,USTR3MO           IF 3 MON RATE FLAGGED                     
         BNE   *+12                                                             
         MVI   TYPE,USTR3ME              CONVERT TO 3 MON EXTENDED.             
         B     VSCR19X                                                          
*                                                                               
         CLI   TYPE,USTR6MO           IF 6 MON RATE FLAGGED                     
         BNE   *+12                                                             
         MVI   TYPE,USTR6ME              CONVERT TO 6 MON EXTENDED.             
         B     VSCR19X                                                          
*                                                                               
VSCR19X  DS    0H                                                               
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (7A - INDUSTRIAL SUPPLEMENTAL)                  
         SPACE 1                                                                
VSCR7A   DS    0H                                                               
         GOTO1 VCHOICE,DMCB,('UISUW90',ISUW90H),('UISUB90',ISUB90H),   X        
               (X'FF',0)                                                        
         BRAS  RE,VSCR7AR                                                       
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (1A - INM AND NIM)                              
         SPACE 1                                                                
VSCR1A   DS    0H                                                               
         CLI   TGUSEQU,UMVM                                                     
         BNE   VSCR1A10                                                         
         GOTO1 VCHOICE,WORK,('UMVM8WK',MVM8WKH),('UMVM26W',MVM6MOH),   X        
               ('UMVM1YR',MVM1YRH),(X'FF',0)                                    
         B     XIT                                                              
         SPACE 1                                                                
VSCR1A10 CLI   TGUSEQU,UNIM                                                     
         BE    *+6                                                              
         DC    H'00'                                                            
         GOTO1 VCHOICE,WORK,('UNIM8WK',MVM8WKH),('UNIM6MO',MVM6MOH),   X        
               ('UNIM1YR',MVM1YRH),(X'FF',0)                                    
         B     XIT                                                              
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (1B - IN HOME MUSIC)                            
         SPACE 1                                                                
VSCR1B   DS    0H                                                               
         GOTO1 VCHOICE,WORK,('UIHMTU1',IHMU1MH),('UIHMTO1',IHM1MOH),   X        
               ('UIHMONT',IHMONTH),(X'FF',0)                                    
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE SCREEN  (1D - INTERNET/NEW MEDIA)                       
         SPACE 1                                                                
VSCR1D   DS    0H                                                               
         GOTO1 VCHOICE,DMCB,('UINUI4W',INUI4WH),('UINUI8W',INUI8WH),   X        
               ('UINUI1Y',INUI1YH),('UINUEXT',INUE1YH),(X'FF',0)                
         SPACE 1                                                                
         CLI   INURADH+5,0                                                      
         BE    VSCR1D10                                                         
         ZIC   RE,TYPE                                                          
         LHI   RF,1                                                             
         CLI   INUI4WH+5,0                                                      
         BNE   *+8                                                              
         LHI   RF,3                                                             
         AR    RE,RF                                                            
         STC   RE,TYPE                                                          
         SPACE 1                                                                
VSCR1D10 MVC   BYTE,TGMEEQU        SAVE COMMERCIAL MEDIA                        
         SPACE 1                                                                
         LA    R2,INUFRSTH         R2=A(1ST INTERNET/NEWMEDIA FIELD)            
         LA    R3,INULSTH          R3=A(LAST INTERNET/NEWMEDIA FIELD)           
         B     VSCR82B                                                          
         SPACE 3                                                                
*              VALIDATE SCREEN  (EVENT)                                         
         SPACE 1                                                                
VSCR1E   DS    0H                                                               
         TM    PAYMODE,DTLONBSE    IF NOT SET YET                               
         BO    *+12                                                             
         OI    PAYMODE,DTLONBSE    SET DETAIL ON BASE SCREEN                    
         OI    LCLSTAT,DTLFIRST    AND FIRST TIME FOR DETAIL                    
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*              VALIDATE SCREEN  (VRE/VNR)                                       
*======================================================================         
         SPACE 1                                                                
VSCR1F   DS    0H                                                               
         LA    R2,VREVERH                                                       
         BRAS  RE,BLDINTBL       BUILD TABLE OF INPUTTED VERSIONS               
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*              VALIDATE SCREEN  (20 - EQUITY)                                   
*======================================================================         
         SPACE 1                                                                
VSCR20   DS    0H                                                               
         LA    R2,EQY6MH                                                        
         GOTO1 FLDVAL,DMCB,(X'80',EQY6MH),EQY1YH                                
         BE    NOCHOICE            ERROR - NO SELECTION MADE                    
         GOTO1 VCHOICE,DMCB,('UEQY6M',EQY6MH),('UEQY1Y',EQY1YH),       X        
               (X'FF',0)                                                        
         MVC   TCTUSES,=H'1'                                                    
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*              VALIDATE SCREEN  (21 - MUSIC BUYOUT)                             
*======================================================================         
         SPACE 1                                                                
VSCR21   DS    0H                                                               
         LA    R2,MBOINIH                                                       
         GOTO1 FLDVAL,DMCB,(X'80',MBOINIH),MBOREUH                              
         BE    NOCHOICE            ERROR - NO SELECTION MADE                    
         GOTO1 VCHOICE,DMCB,('UMBOI1Y',MBOINIH),('UMBOR1Y',MBOREUH),   X        
               (X'FF',0)                                                        
***      MVC   TCTUSES,=H'1'                                                    
         B     XIT                                                              
         EJECT                                                                  
*======================================================================         
*              VALIDATE SCREEN  (22 - NEWMEDIA CANADA)                          
*======================================================================         
         SPACE 1                                                                
VSCR22   DS    0H                                                               
         LA    R2,NMC3MH                                                        
         GOTO1 VCHOICE,WORK,('UNMC3M',NMC3MH),('UNMC6M',NMC6MH),       X        
               ('UNMC1Y',NMC12MH),(X'FF',0)                                     
*                                                                               
         B     XIT                                                              
         SPACE 3                                                                
*======================================================================         
*        ONLY FOR CMS,FMU,SMU,OTM AND PEM                                       
*======================================================================         
VSCR51   DS    0H                                                               
         CLI   TGUSEQU,UCMS                                                     
         BE    VSCR51A                                                          
         CLI   TGUSEQU,UFMU                                                     
         BE    VSCR51A                                                          
         CLI   TGUSEQU,USMU                                                     
         BE    VSCR51A                                                          
         CLI   TGUSEQU,UOTM                                                     
         BE    VSCR51A                                                          
         CLI   TGUSEQU,UPEM                                                     
         BNE   XIT                                                              
VSCR51A  BRAS  RE,CKMUSDT                                                       
VSCR51X  B     XIT                                                              
*              VALIDATE MULTIPLE CHOICE FIELDS                                  
         SPACE 1                                                                
*                                  PLIST OF FORM: (USE TYPE,A(FIELD))           
VCHOICE  NTR1                                                                   
         MVI   TYPE,X'FF'          INITIALIZE TYPE                              
         LR    R3,R1                                                            
VCH2     CLI   0(R3),X'FF'         TEST FOR END OF LIST                         
         BE    VCH6                                                             
         L     R2,0(R3)                                                         
         CLI   5(R2),0             ANY INPUT IS OK                              
         BE    VCH4                                                             
         CLI   TYPE,X'FF'          DO WE ALREADY HAVE A TYPE                    
         BNE   CHOICERR                                                         
         MVC   TYPE,0(R3)          SET TYPE CORRESPONDING TO CHOICE             
         LR    R4,R2               AND SAVE A(CHOICE)                           
*                                                                               
VCH4     LA    R3,4(R3)            BUMP TO NEXT PARAMETER                       
         B     VCH2                                                             
*                                                                               
VCH6     L     R2,0(R1)            POINT TO 1ST FIELD                           
         CLI   TYPE,X'FF'          INSURE USER SELECTED SOMETHING               
         BE    NOCHOICE                                                         
*                                                                               
         LR    R2,R4               POINT TO SELECTED FIELD                      
         GOTO1 USEVAL,DMCB,TGUSCDE,TYPE VALIDATE TYPE                           
         BNE   VCHX                                                             
         MVC   BYTE,TGUSTYMD       TEST IT'S VALID FOR THIS MEDIA               
         NC    BYTE,TGMEEQU                                                     
         BZ    MEDERR                                                           
VCHX     B     XIT                                                              
*                                                                               
         EJECT                                                                  
*              POST-MIDDLE OF SCREEN PROCESSING                                 
         SPACE 1                                                                
XVMID    NTR1                                                                   
         TM    PAYMODE,DTLDSPLD    DON'T BOTHER IF DETAIL INFO DISPLAYD         
         BO    XVMX                                                             
         TM    TGUSTYST,UPGRADE    IF UPGRADE                                   
         BZ    *+10                                                             
         XC    SVTCUNIT(3),SVTCUNIT  CLEAR SO WILL RESAVE LATER                 
         LH    RF,DSPXVM             RF=A(DISP. TO INDIVIDUAL ROUTINE)          
         LTR   RF,RF                                                            
         BZ    XVMX                                                             
         AR    RF,RB                                                            
         LA    RE,XVMX             SET RE FOR COMMON NTR1                       
XM       NTR1                                                                   
         BR    RF                  ** HANDLE INDIVIDUAL SCREEN **               
XVMX     B     XIT                                                              
         EJECT                                                                  
*              POST-MIDDLE OF SCREEN PROCESSING  (BA - NETWORK/CLASS A)         
         SPACE 1                                                                
XVMDBA   DS    0H                                                               
         GOTO1 DATCON,DMCB,(1,TCPCYCS),CYCSTART  CVT CYCLE TO EBCDIC            
         GOTO1 (RF),(R1),(1,TCPCYCE),CYCEND                                     
         SPACE 1                                                                
         MVI   LIFTPAID,C'N'       INIT NO USES PAID TO LIFT                    
         XC    TCUSETAB,TCUSETAB                                                
         XC    TCTUSESL,TCTUSESL                                                
         XC    FRSTUSE,FRSTUSE                                                  
         XC    TCTXUSES,TCTXUSES                                                
         XC    TCTXUSEL,TCTXUSEL                                                
         SPACE 1                                                                
         TM    PAYOPTS3,ONUMUSE    TEST HAVE OVERRIDE NUMBER OF USES            
         BZ    XVMBA2                                                           
         SPACE                                                                  
         GOTO1 FLDVAL,DMCB,(X'80',CLAFRSTH),(X'80',CLALSTIH) TEST EMPTY         
         BE    XVMBA1              IF THERE'S INPUT IN USE DETAILS              
         L     R2,8(R1)            SET R2=A(FIRST FIELD WITH INPUT)             
         TM    TGFASTAT,TGFROMFA   ERROR - INPUT NOT ALLOWEDB                   
         BZ    NOINPUT                                                          
         GOTOR ADDEAR,DMCB,ERBANINP,CLAFRST                                     
         B     XIT                                                              
         SPACE                                                                  
XVMBA1   CLI   LIFT,C'Y'           TEST IF ENTIRE PAYMENT TO LIFT               
         BE    XVMBA1A                                                          
         CLI   VERSION,0           ELSE IF PAYING A VERSION                     
         BE    XVMBA1D                                                          
         CLI   TCVERSEC,15         TEST IF IT'S LENGTH IS <= 15 SEC             
         BH    XVMBA1D                                                          
         B     *+8                                                              
XVMBA1A  MVI   LIFTPAID,C'Y'       SET THERE ARE USES PAID TO LIFT              
         MVC   TCTUSESL,OPTNUMUS   SET # USES PD TO LIFT OR SHORT VERS          
         SPACE 1                                                                
XVMBA1D  MVC   TCTUSES,OPTNUMUS        SET TOTAL NUMBER OF USES PAID            
         MVC   TCUSETAB(3),TCPCYCS     SET DUMMY 1ST ENTRY IN TCUSETAB          
         MVI   TCUSETAB+3,0                                                     
         MVC   TCTXUSES,TCTXUSCR                                                
         MVC   TCTXUSEL,TCTXULCR                                                
         CLI   LIFTPAID,C'Y'                                                    
         BNE   XVMBAX                                                           
         OI    TCUSETAB+3,TCLFTPRO     (USED BY LOOKUP)                         
         B     XVMBAX                                                           
         SPACE 1                                                                
         USING CLAD,R3                                                          
XVMBA2   XC    TCTUSES,TCTUSES     CLEAR TOTAL NUMBER OF USES                   
         LA    R0,20               R0=MAX. N'SCREEN ENTRIES                     
         LA    R3,CLAFRSTH         LOOP THROUGH SCREEN USE ENTRIES              
         LA    R4,TCUSETAB         R4=A(TABLE OF DATES/LIFT STATUS)             
         SPACE 1                                                                
XVMBA4   BRAS  RE,VALDATE          VALIDATE USE DATE                            
         BNE   XVMBA8                                                           
         BRAS  RE,VALPROG          VALIDATE PROGRAM NAME                        
         BRAS  RE,VALLIFT          VALIDATE LIFT                                
         BRAS  RE,VALNWK           VALIDATE NETWORK                             
         BRAS  RE,VALPAX           SET PAX INDICATOR                            
         LA    R4,4(R4)            BUMP TO NEXT ENTRY IN TABLE                  
         SPACE 1                                                                
XVMBA8   LA    R3,CLANEXT          BUMP TO NEXT SET OF SCREEN FIELDS            
         BCT   R0,XVMBA4                                                        
         SPACE 1                                                                
         LA    R3,CLAFRSTH         R3=A(1ST GROUP OF USE ENTRIES)               
         LA    R2,CLADATEH         R2=A(DATE IN THE 1ST GROUP)                  
         OC    TCTUSES,TCTUSES     INSURE WE HAVE SOME USES                     
         BNZ   XVMBAX                                                           
         TM    TGFASTAT,TGFROMFA                                                
         BZ    FLDMISS                                                          
         GOTO1 ADDERROR,DMCB,ERBANMIS,TGAERTAB                                  
         B     XIT                                                              
         SPACE                                                                  
XVMBAX   OC    FRSTUSE,FRSTUSE     IF DON'T HAVE A FIRST USE DATE               
         BNZ   XIT                                                              
         MVC   FRSTUSE,TCPCYCS     SET FIRST USE DATE FOR GETDUE                
         B     XIT                                                              
         SPACE 2                                                                
ERBANMIS DC    AL1(EBANMISX-*),AL2(502),AL1(ERRCATY3),AL1(0)                    
         DC    AL2(D#PUUID)                                                     
         DC    C'Missing field'                                                 
EBANMISX EQU   *                                                                
         SPACE 1                                                                
ERBANINP DC    AL1(EBANINPX-*),AL2(503),AL1(ERRCATY3),AL1(0)                    
         DC    AL2(D#PUUID)                                                     
         DC    C'Field not allowed'                                             
EBANINPX EQU   *                                                                
         EJECT                                                                  
*              POST-MIDDLE OF SCREEN PROCESSING  (A6 - GUARANTEE)               
         SPACE 1                                                                
XVMDA6   DS    0H                                                               
         MVI   GUARSTAT,0          INITIALIZE GUARANTEE STATUS                  
         SPACE 1                                                                
         LA    R2,GRTDBALH         DESCENDING BALANCE                           
         MVI   BYTE,DESCBAL                                                     
         BRAS  RE,VALSTAT                                                       
         SPACE 1                                                                
         LA    R2,GRTPNHH          PAYING P&H                                   
         CLI   8(R2),C'Y'                                                       
         BE    FLDINV                                                           
         MVI   BYTE,PAYPNH                                                      
         BRAS  RE,VALSTAT                                                       
         SPACE 1                                                                
         LA    R2,GRTOVERH         PAYING OVERAGE                               
         MVI   BYTE,PAYOVRAG                                                    
         BRAS  RE,VALSTAT                                                       
         SPACE 1                                                                
XVMDAX   B     XIT                                                              
         EJECT                                                                  
*              POST-MIDDLE OF SCREEN PROCESSING (55,5F AND 66)                  
         SPACE                                                                  
XVMDCM   DS    0H                                                               
         SPACE 1                                                                
******************************** INITIALIZE VARIABLES *****************         
         SPACE 1                                                                
         XC    TCUNITS,TCUNITS   CLEAR VARIABLES                                
         XC    TCSUBS,TCSUBS                                                    
         NI    LCLSTAT3,X'FF'-FORCEUPG                                          
         NI    LCLSTAT5,X'FF'-FORCEINI                                          
         NI    PAYSTAT1,X'FF'-OVERMKTS                                          
         MVI   TGBYTE3,C'N'                                                     
         SPACE 1                                                                
         MVC   TGDATE,TCPCYCS    DEFAULT LAST DATE TO CYCLE START               
         SPACE 1                                                                
         USING MKTTABLD,R3                                                      
         L     R3,AMKTTABL       CLEAR OUT CNET/MKT/CSYS TABLE                  
         LHI   RF,L'MKTTABL                                                     
         XCEFL 0(R3)                                                            
         MVI   0(R3),X'FF'                                                      
         SPACE 1                                                                
         BAS   RE,R2UPGFLD       DETERMINE IF THIS IS A FORCED                  
         CLI   8(R2),C'F'        UPGRADE                                        
         BNE   IVR10                                                            
         OI    LCLSTAT3,FORCEUPG                                                
         SPACE 1                                                                
IVR10    CLI   8(R2),C'I'        DETERMINE IF THIS IS A FORCED                  
         BNE   SMJ10             INITIAL PAYMENT                                
         CLI   VERSION,0         ONLY VALID FOR NON-VERSION PAYMENTS            
         BNE   FLDINV                                                           
         TM    PAYSTAT1,CASTSELD WITH CAST SELECTED                             
         BZ    FLDINV                                                           
         OI    LCLSTAT5,FORCEINI                                                
         OI    LCLSTAT3,FORCEUPG                                                
         SPACE 1                                                                
******************************** SYNC MAJOR OUTPUT WITH DATE/CODE INPUT         
         SPACE 1                                                                
SMJ10    CLI   TWASCR,SCR55        ONLY EXECUTE THIS ROUTINE FOR                
         BNE   DCE10               WILDSPOT PAYMENTS                            
         SPACE 1                                                                
         BRAS  RE,SYNCMAJ          SYNC MAJORS AND MKT FIELD INPUT              
         SPACE 1                                                                
         MVI   TCMAJORS,0                                                       
         CLI   WSPNYH+5,0          SET MAJORS - ANY INPUT IS OK                 
         BE    *+8                                                              
         OI    TCMAJORS,NY                                                      
         CLI   WSPLAH+5,0                                                       
         BE    *+8                                                              
         OI    TCMAJORS,LA                                                      
         CLI   WSPCHIH+5,0                                                      
         BE    *+8                                                              
         OI    TCMAJORS,CHI                                                     
         SPACE 1                                                                
******************************** SEE IF ANY DATES/CODES ENTERED *******         
         SPACE 1                                                                
DCE10    LA    R2,WSPFRSTH       R2=A(FIRST CNET/MKT/CSYS HEADER FIELD)         
         LA    R4,WSPLSTH        R4=A(LAST CNET/MKT/CSYS FIELD)                 
         CLI   TWASCR,SCR55                                                     
         BE    DCE20                                                            
         LA    R2,CBLFRSTH                                                      
         LA    R4,CBLLSTH                                                       
         CLI   TWASCR,SCR5F                                                     
         BE    DCE20                                                            
         LA    R2,ADWFRSTH                                                      
         LA    R4,ADWLSTH                                                       
DCE20    ZIC   R0,0(R4)                                                         
         AR    R4,R0                                                            
         ZIC   R0,0(R4)                                                         
         AR    R4,R0                                                            
         SPACE                                                                  
         GOTO1 FLDVAL,DMCB,(X'80',(R2)),(X'80',(R4))                            
         BE    CSU10             SKIP AHEAD IF NONE ENTERED                     
         SPACE 1                                                                
******************************** IF DATES/CODES ENTERED            ****         
******************************** SET TO READ CNET/MKT/CSYS RECORDS ****         
         SPACE 1                                                                
         MVI   TGMTTYPE,TANPNET  SET TO READ CNET RECORDS                       
         TM    TGUSSTA3,CBLUSE   FOR CABLE                                      
         BNZ   PDC10             OR SPANISH CABLE                               
         SPACE 1                                                                
         MVI   TGMTTYPE,C'S'     SET TO READ CSYS RECORDS                       
         CLI   TGUSEQU,ULCB      FOR LOCAL CABLE                                
         BE    PDC10                                                            
         SPACE 1                                                                
         MVI   TGMTTYPE,C'T'     ELSE, SET TO READ TMKT RECORDS                 
         CLI   TGMEEQU,RADIO     UNLESS MEDIA IS RADIO                          
         BNE   PDC10             THEN SET TO READ RMKT RECORDS                  
         MVI   TGMTTYPE,C'R'                                                    
         SPACE 1                                                                
******************************** PROCESS EACH DATE/CODE COMBO *********         
         SPACE 1                                                                
PDC10    LA    RE,WSPLSTH        RE=A(LAST CNET/MKT/CSYS HEADER FIELD)          
         CLI   TWASCR,SCR55                                                     
         BE    PDC20                                                            
         LA    RE,CBLLSTH                                                       
         CLI   TWASCR,SCR5F                                                     
         BE    PDC20                                                            
         LA    RE,ADWLSTH                                                       
PDC20    CR    R2,RE             IF AT END OF CNET/MKT/CSYS FLDS                
         BH    CSU10             DONE VALIDATING DATE/CODE FIELDS               
         SPACE 1                                                                
******************************** ENSURE DATE/CODE INPUT IS IN SYNC ****         
         SPACE 1                                                                
         ZIC   R4,0(R2)                                                         
         AR    R4,R2             R4=A(DATE FIELD)                               
         SPACE 1                                                                
         ZIC   R2,0(R4)                                                         
         AR    R2,R4             R2=A(CODE FIELD)                               
         SPACE 1                                                                
         NI    1(R2),X'FF'-X'20' ENSURE CODE FIELD NEVER GETS                   
         OI    6(R2),X'80'       PROTECTED                                      
         SPACE 1                                                                
         CLI   5(R4),0           IF DATE IS PRESENT                             
         BE    DCS10                                                            
         CLI   5(R2),0           CODE MUST BE PRESENT TOO                       
         BE    FLDMISS                                                          
         SPACE 1                                                                
         CLI   8(R4),C'*'        IF DATE INPUT IS *                             
         BNE   DCS30             PUT LAST DATE INTO DATE                        
         GOTO1 DATCON,DMCB,(1,TGDATE),(8,8(R4))                                 
         B     DCS20                                                            
         SPACE 1                                                                
DCS10    CLI   5(R2),0           IF DATE IS NOT PRESENT                         
         BE    DCS30             BUT CODE IS                                    
         TM    PAYSTAT1,CREDIT   AND THIS IS NOT A CREDIT PAYMENT               
         BNZ   DCS30             DEFAULT DATE TO CYCLE START                    
         GOTO1 DATCON,DMCB,(1,TCPCYCS),(8,8(R4))                                
DCS20    MVI   5(R4),8                                                          
         OI    6(R4),X'80'                                                      
         SPACE 1                                                                
DCS30    CLI   5(R2),0           IF NEITHER DATE OR CODE IS INPUT               
         BE    BNDC20            SKIP AHEAD                                     
         SPACE 1                                                                
******************************** VALIDATE AND SAVE DATE ***************         
         SPACE 1                                                                
         LR    R2,R4             R2=A(DATE FIELD)                               
         SPACE 1                                                                
         MVC   MT1DATE,TCPCYCS                                                  
         TM    PAYSTAT1,CREDIT   IF MAKING CREDIT PAYMENT                       
         BZ    VSD10             INPUT NOT ALLOWED                              
         CLI   5(R2),0           DEFAULT DATE TO CYCLE START FOR NOW            
         BNE   FLDDTCR                                                          
         B     VSC10                                                            
         SPACE 1                                                                
VSD10    BRAS  RE,SVCYCLE        SET CYCLE INFORMATION IN WORK                  
         SPACE 1                                                                
         USING PERVALD,RE                                                       
         LA    RE,BLOCK          SAVE CYCLE LENGTH IN R4                        
         LH    R4,PVALNDYS                                                      
         BCTR  R4,0                                                             
         DROP  RE                                                               
         SPACE 1                                                                
         CLI   5(R2),5                               IF L'I/P <= 5              
         BH    VSD30                                                            
         GOTO1 DATVAL,DMCB,(1,8(R2)),DUB   VALIDATE MONTH/DAY ONLY              
         OC    0(4,R1),0(R1)                  TEST FOR INPUT ERROR              
         BZ    FLDINV                                                           
         MVC   DUB(2),WORK             CARRY YEAR FROM CYCLE START              
         CLC   WORK(2),WORK+8         TEST CYCLE START YEAR <> END              
         BE    VSD40                                                            
         CLC   DUB+2(4),WORK+2          IF MM/DD IS LT CYCLE START              
         BNL   VSD20                                                            
         CLC   DUB+2(4),WORK+10        & MM/DD IS NOT GT CYCLE END              
         BH    FLDINV                                                           
         MVC   DUB(2),WORK+8             CARRY YEAR FROM CYCLE END              
VSD20    B     VSD50                                                            
         SPACE 1                                                                
VSD30    GOTO1 DATVAL,DMCB,8(R2),DUB                VALIDATE Y/M/D              
         OC    0(4,R1),0(R1)                  TEST FOR INPUT ERROR              
         BZ    FLDINV                                                           
VSD40    CLC   DUB(6),WORK       IF USE DATE NOT BEFORE CYCLE START             
         BL    FLDINV                                                           
         CLC   DUB(6),WORK+8                AND NOT AFTER CYCLE END             
         BH    FLDINV                                                           
         SPACE 1                                                                
VSD50    GOTO1 DATCON,DMCB,(0,DUB),(1,MT1DATE) SAVE DATE IN TABLE               
         MVC   TGDATE,MT1DATE                  SAVE AS LAST DATE                
         SPACE 1                                                                
         GOTO1 DATCON,DMCB,(0,DUB),(8,8(R2))   DISPLAY ON SCREEN                
         MVI   5(R2),8                                                          
         OI    6(R2),X'80'                                                      
         SPACE 1                                                                
         GOTO1 ADDAY,DMCB,DUB,TGDUB,(R4)       CALCULATE CYCLE END              
         GOTO1 DATCON,DMCB,(0,TGDUB),(1,MTCYCEND)                               
         SPACE 1                                                                
         CLC   MTCYCEND,WORK+24  IF CYCLE END FOR THIS CNET/MKT/CSYS            
         BNH   *+10              EARLIER THAN COMMERCIAL'S MAX END              
         MVC   MTCYCEND,WORK+24  DATE, USE CNET/MKT/CSYS'S                      
         SPACE 1                                                                
         ST    R2,TGDUB          SAVE DATE FIELD ADDRESS IN TGDUB               
         SPACE 1                                                                
******************************** VALIDATE AND SAVE CODE ***************         
         SPACE 1                                                                
VSC10    ZIC   R1,0(R2)          R2=A(CNET/MKT/CSYS CODE FIELD)                 
         AR    R2,R1                                                            
*                                FOR NON-VERSIONS, SAME CODE                    
         BRAS  RE,DUPCODE        CANNOT BE ENTERED MORE THAN ONCE               
         SPACE 1                                                                
         BRAS  RE,ONFILE         ENSURE CNET/MKT/CSYS IS ON FILE                
         BE    VSC20                                                            
         SPACE 1                                                                
         CLI   TGMTTYPE,TANPNET  IF CNET NOT FOUND FOR CBL OR SCB               
         BNE   BMKTNFND          LOOK FOR CSYS                                  
         MVI   TGMTTYPE,C'S'                                                    
         BRAS  RE,ONFILE         ENSURE THE CSYS IN ON FILE                     
         BNE   BMKTNFND                                                         
         MVI   TGMTTYPE,TANPNET                                                 
         SPACE 1                                                                
VSC20    MVC   MTCODE,8(R2)      SAVE CNET/MKT/CSYS CODE                        
         MVC   MTINUM,TGMTINTC   AND INTERNAL NUMBER IN TABLE                   
         MVI   MKTLNQ(R3),X'FF'  MARK NEW END OF TABLE                          
         SPACE 1                                                                
         BAS   RE,VALCYC         CHECK CYCLE DOES NOT OVERLAP PREVIOUS          
         SPACE 1                                                                
******************************** PREPARE TO ADD WEIGHT TO PAYMENT *****         
         SPACE 1                                                                
         TM    MTSTAT,MTNOCALC   IF CNET/MKT/CSYS ALREADY ENCOUNTERED           
         BZ    PWP10             ON THIS PAYMENT, DON'T ADD IT AGAIN            
         NI    MTSTAT,X'FF'-MTNOCALC                                            
         B     BNDC10                                                           
         DROP  R3                                                               
         SPACE 1                                                                
PWP10    XC    TGFULL,TGFULL     USE TGFULL TO ACCUMULATE WEIGHT                
         SPACE 1                                                                
******************************** ADD WEIGHT TO PAYMENT AND DISPLAY ****         
         SPACE 1                                                                
         USING TLMTD,R4                                                         
         L     R4,AIO                                                           
         TM    TGUSSTA3,CBLUSE   IF MAKING A CABLE PAYMENT                      
         BZ    AWP10                                                            
         CLI   TLMTTYPE,C'S'     AND PROCESSING A CSYS                          
         BE    AWP50             SKIP AHEAD TO NEXT SECTION                     
         MVI   TGBYTE3,C'Y'                                                     
         SPACE 1                                                                
AWP10    CLI   TGUSEQU,USWS      IF PAYING SPANISH WILDSPOT                     
         BNE   AWP20             WEIGHT DEFAULTS TO ONE IF                      
         MVI   TGFULL+3,1        SPANISH WEIGHT NOT ON MKT RECORD               
         SPACE 1                                                                
         USING TAMSD,R4                                                         
AWP20    MVI   ELCODE,TAMSELQ    ELSE, GET CNET/MKT/CSYS'S WEIGHT               
         BAS   RE,GETEL          ELEMENT                                        
         B     *+8                                                              
AWP30    BAS   RE,NEXTEL                                                        
         BNE   AWP60                                                            
         CLI   TGUSEQU,USWS      FOR SPANISH WILDSPOT                           
         BNE   AWP40             LOOK FOR SPANISH WEIGHT                        
         CLI   TAMSTYPE,C'S'                                                    
         BNE   AWP30                                                            
AWP40    MVC   TGFULL,TAMSWGHT   SAVE WEIGHT IN TGFULL                          
         B     AWP60                                                            
         SPACE 1                                                                
AWP50    MVC   TGFULL,=F'1'      IF PROCESSING A CSYS ON A CABLE                
         MVI   ELCODE,TAMSELQ    OR SPANISH CABLE PAYMENT                       
         BAS   RE,GETEL          WEIGHT IS ONE                                  
         BNE   AWP60                                                            
         ZICM  RF,TCSUBS,4       AND ADD CURRENT SUBSCRIBERS                    
         A     RF,TAMSWGHT       TO TOTAL SUBSCRIBERS                           
         STCM  RF,15,TCSUBS                                                     
         SPACE 1                                                                
AWP60    LA    R4,WSPAUNTH       R4=A(AUTOMATIC UNIT/SUBS FIELD)                
         CLI   TWASCR,SCR55                                                     
         BE    AWP70                                                            
         LA    R4,CBLAUNTH                                                      
         CLI   TWASCR,SCR5F                                                     
         BE    AWP70                                                            
         LA    R4,ADWAUNTH       ADD CURRENT WEIGHT TO TOTAL                    
AWP70    BRAS  RE,ADD2TOT        ADD DISPLAY AUTOMATIC UNITS/SUBS               
         SPACE 1                                                                
******************************** BUMP TO NEXT DATE/CODE IN TABLE AND **         
******************************** ON SCREEN                           **         
         SPACE 1                                                                
BNDC10   LA    R3,MKTLNQ(R3)     BUMP TO NEXT TABLE ENTRY                       
BNDC20   ZIC   RE,0(R2)          BUMP TO THE NEXT MKT/CNET/CSYS FIELD           
         AR    R2,RE                                                            
         B     PDC10                                                            
         SPACE 1                                                                
******************************** ALL CNET/MKT/CSYS FIELDS ARE PROCESSED         
         SPACE 1                                                                
******************************** FOR CBL AND SCB NON-UPGRADES, CONVERT          
******************************** CSYS SUBSCRIBERS INTO UNITS                    
         SPACE 1                                                                
CSU10    TM    TGUSSTA3,CBLUSE   FOR CBL AND SCB                                
         BZ    VSA10                                                            
         TM    TGUSTYST,UPGRADE  NON-UPGRADE PAYMENTS                           
         BNZ   VSA10                                                            
         OC    TCSUBS,TCSUBS     ON WHICH, CSYS CODES WERE INPUTTED             
         BZ    VSA10                                                            
         ZIC   R1,CBLAUNTH+5     PUT ACCUMULATED AUTOMATIC UNITS                
         LTR   R1,R1             INTO R1                                        
         BZ    CSU20                                                            
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         PACK  DUB,CBLAUNT(0)                                                   
         CVB   R1,DUB                                                           
CSU20    XR    RE,RE             DIVIDE NUMBER OF SUBSCRIBERS BY                
         ZICM  RF,TCSUBS,4       350,000                                        
         D     RE,=F'350000'                                                    
         AR    RF,R1             ADD QUOTIENT TO AUTOMATIC UNITS                
         LR    R4,RF                                                            
         EDIT  (R4),CBLAUNT,ALIGN=LEFT                                          
         OI    CBLAUNTH+4,X'08'                                                 
         STC   R0,CBLAUNTH+5     AND DISPLAY ACCUMULATED WEIGHT                 
         SPACE 1                                                                
         CLI   TGBYTE3,C'Y'      ENSURE PAYMENT INCLUDES AT LEAST 1             
         BE    VSA10             CABLE NETWORK OR EXCEEDS 1MIL SUBS             
         CLC   TCSUBS,=F'1000000'                                               
         BNH   ERNOCBL                                                          
         SPACE 1                                                                
******************************** VALIDATE AND SAVE AUTO UNITS/SUBS ***          
         SPACE 1                                                                
VSA10    LA    R2,WSPAUNTH       R2=A(AUTOMATIC UNITS/SUBS FIELD)               
         CLI   TWASCR,SCR55                                                     
         BE    VSA20                                                            
         LA    R2,CBLAUNTH                                                      
         CLI   TWASCR,SCR5F                                                     
         BE    VSA20                                                            
         LA    R2,ADWAUNTH                                                      
VSA20    BRAS  RE,VSUNIT         VALIDATE AND SAVE AUTO UNITS/SUBS              
         SPACE 1                                                                
******************************** VALIDATE AND SAVE OVER UNITS/SUBS ***          
         SPACE 1                                                                
         LA    R2,WSPUNITH       R2=A(OVERRIDE UNITS/SUBS FIELD)                
         CLI   TWASCR,SCR55                                                     
         BE    VSO10                                                            
         LA    R2,CBLUNITH                                                      
         CLI   TWASCR,SCR5F                                                     
         BE    VSO10                                                            
         LA    R2,ADWUNITH                                                      
         SPACE 1                                                                
VSO10    CLI   5(R2),0           IF INPUTTED                                    
         BE    EI10                                                             
         CLI   TGUSEQU,ULCB      AND NOT MAKING LCB PAYMENT                     
         BE    VSO20                                                            
         CLI   5(R2),4           INPUT CANNOT EXCEED 4 CHARACTERS               
         BH    FLDINV                                                           
         SPACE 1                                                                
VSO20    BRAS  RE,VSUNIT         VALIDATE AND SAVE OVER UNITS/SUBS              
         OI    PAYSTAT1,OVERMKTS AND TURN ON OVERRIDE BIT                       
         SPACE 1                                                                
******************************** ENSURE AT LEAST 1 UNIT/SUB ENTERED **          
         SPACE 1                                                                
EI10     CLI   TGUSEQU,ULCB        IF USE IS NOT LOCAL CABLE                    
         BE    EI20                                                             
         TM    LCLSTAT3,FORCEUPG   AND NOT FORCING UPGRADE                      
         BO    SPU10                                                            
         OC    TCUNITS(3),TCUNITS  AT LEAST 1 UNIT (AUTO OR OVERRIDE)           
         BZ    CADI10              MUST BE ENTERED                              
         B     SPU10                                                            
         SPACE 1                                                                
EI20     ZICM  R1,TCSUBS,4         IF USE IS LOCAL CABLE                        
         LTR   R1,R1               AT LEAST 1 SUBSCRIBER (AUTO OR OVER)         
         BZ    CADI10              MUST BE ENTERED                              
         BAS   RE,LCBTYP           THEN GO SET LCB TYPE                         
         MVC   TYPE,11(RF)                                                      
         MVC   SVUSTYP,11(RF)                                                   
         SPACE 1                                                                
         TM    TGUSTYST,UPGRADE                                                 
         BO    SPU10                                                            
         MVC   TGUSTYP,11(RF)                                                   
         B     SPU10                                                            
         SPACE 1                                                                
******************************** POSSIBLY GO COMPLETE ADVICE *********          
******************************** AND DELETE INVOICE          *********          
         SPACE 1                                                                
CADI10   TM    PAYMODE,DRAFT       IF MAKING A DRAFT PAYMENT                    
         BO    NEEDUNIT            RETURN ERROR                                 
         SPACE 1                                                                
         OC    SVADVDA,SVADVDA     IF NOT PAYING AN ADVICE                      
         BZ    NEEDUNIT            RETURN ERROR                                 
         SPACE 1                                                                
         XC    SVADVDA,SVADVDA                                                  
         SPACE 1                                                                
         LH    RE,DSPCYC           INVALIDATE CYCLE FIELD                       
         LTR   RE,RE                                                            
         BZ    *+10                                                             
         AR    RE,RA                                                            
         NI    4(RE),X'FF'-X'20'                                                
         SPACE 1                                                                
         LH    R2,DSPAUTH          RE-POPULATE AUTH/PO FIELD                    
         LTR   R2,R2               WITH ADVICE NUMBER                           
         BZ    NEEDUNIT                                                         
         AR    R2,RA                                                            
         MVC   8(2,R2),=C'A='                                                   
         MVC   10(L'TGADV,R2),TGADV                                             
         MVI   5(R2),L'TGADV+2                                                  
         OI    6(R2),X'80'                                                      
         SPACE 1                                                                
         MVI   OVERLAY,X'54'                                                    
         GOTO1 LOADSOPH,DMCB,0     LOAD ADVICE EXTRACT MODULE                   
         GOTO1 (R3),DMCB,(RC)      AND PASS CONTROL TO IT                       
         DC    H'00'                                                            
         SPACE 1                                                                
******************************** SEE IF INTENDING TO UPGRADE *********          
         SPACE 1                                                                
SPU10    TM    TGUSTYST,UPGRADE  IF NOT INTENDING TO UPGRADE,SKIP AHEAD         
         BZ    USUS10                                                           
         SPACE 1                                                                
         BAS   RE,R2UPGFLD       R2=A(UPGRADE FIELD)                            
         SPACE 1                                                                
******************************** SET UPGRADE VARIABLES ***************          
         SPACE 1                                                                
         TM    TGUSSTA3,CBLUSE   IF MAKING A CABLE                              
         BO    SUV10                                                            
         CLI   TGUSEQU,ULCB      OR LOCAL CABLE PAYMENT                         
         BNE   SUV20                                                            
SUV10    MVC   TGUPFRCD,TGUSCDE  SET UPGRADE "FROM" CODE                        
         SPACE 1                                                                
SUV20    TM    LCLSTAT3,FORCEUPG IF FORCING UPGRADE                             
         BZ    SUV30             SET DUMMY UH ELEMENT FOR UPGRADE               
         BAS   RE,STDUMUH                                                       
         SPACE 1                                                                
SUV30    OC    TCTAUHEL,TCTAUHEL MUST BE A PREVIOUS PAYMENT                     
         BZ    NOPREV            TO UPGRADE FROM                                
         SPACE 1                                                                
         USING TAUHD,R4                                                         
         LA    R4,TCTAUHEL       R3=A(USAGE HISTORY ELEM) FOR UPGRADE           
         SPACE 1                                                                
         MVC   TGUPFRTY,TAUHTYPE SET UPGRADE FROM TYPE                          
         SPACE 1                                                                
******************************** ADD CURRENT UNITS/SUBSCRIBERS TO ****          
******************************** WHAT'S ALREADY BEEN PAID IN CYCLE ***          
******************************** AND DISPLAY                       ***          
         SPACE 1                                                                
         BRAS  RE,SUB2UNTS       FOR CBL/SCB, ADD UNITS FOR SUBSCRIBERS         
         SPACE 1                                                                
         CLI   VERSION,0         IF PAYING A VERSION                            
         BNE   ACC10                                                            
         TM    PAYSTAT1,OVERMKTS OR IF JUST USING AUTOMATIC CALC.               
         BNZ   ACC30                                                            
ACC10    BRAS  RE,ADD2PREV       ADD CURRENT UNITS TO PREVIOUS                  
         B     ACC40                                                            
         SPACE 1                                                                
ACC20    CLI   VERSION,0         FOR NON-VERSION PAYMENTS                       
         BNE   ACC30                                                            
         TM    PAYSTAT1,OVERMKTS JUST USING AUTOMATIC CALCULATION               
         BNZ   ACC30                                                            
         LH    R1,TCUNITS                                                       
         CLI   TGUSEQU,ULCB      DISPLAY ACCUMULATED UNITS/SUBSCRIBERS          
         BNE   ACC60                                                            
         ZICM  R1,TCSUBS,4                                                      
         B     ACC60                                                            
         SPACE 1                                                                
ACC30    TM    PAYSTAT1,OVERMKTS IF OVERRIDING                                  
         BZ    VUF10                                                            
ACC40    CLI   VERSION,0         A NON-VERSION PAYMENT                          
         BNE   VUF10                                                            
         LA    R2,WSPAUNTH                                                      
         CLI   TWASCR,SCR55                                                     
         BE    ACC50                                                            
         LA    R2,CBLAUNTH                                                      
         CLI   TWASCR,SCR5F                                                     
         BE    ACC50                                                            
         LA    R2,ADWAUNTH       ADD CURRENT AUTOMATIC UNITS                    
ACC50    BAS   RE,ADD2AUTO       TO PREVIOUS UNITS                              
         SPACE 1                                                                
ACC60    CLI   TWASCR,SCR5F                                                     
         BNE   ACC70                                                            
         EDIT  (R1),CBLAUNT,ALIGN=LEFT                                          
         LA    R2,CBLAUNTH                                                      
         B     ACC90                                                            
         SPACE 1                                                                
ACC70    LA    R2,WSPAUNTH                                                      
         CLI   TWASCR,SCR55                                                     
         BE    ACC80                                                            
         LA    R2,ADWAUNTH                                                      
ACC80    EDIT  (R1),(L'WSPAUNT,8(R2)),ALIGN=LEFT                                
         SPACE 1                                                                
ACC90    OI    4(R2),X'08'                                                      
         STC   R0,5(R2)                                                         
         OI    6(R2),X'80'                                                      
         SPACE 1                                                                
******************************** VALIDATE UPGRADE FIELD **************          
         SPACE 1                                                                
VUF10    BAS   RE,R2UPGFLD       R2=A(UPGRADE FIELD)                            
         SPACE 1                                                                
         CLI   TGUSEQU,ULCB                                                     
         BE    VUF40                                                            
         SPACE 1                                                                
         CLI   TGUSEQU,UWSP      TEST UPGRADE FOR WILDSPOT                      
         BNE   VUF20                                                            
         BRAS  RE,VALUPGR                                                       
         BNE   NOTUPG                                                           
         B     USUS10                                                           
         SPACE 1                                                                
VUF20    LA    R1,TAUHCBUN       TEST UPGRADE FOR CBL,SCB,SWS,WSC,              
         TM    TGUSSTA3,CBLUSE   AND ADW                                        
         BNZ   VUF30                                                            
         LA    R1,TAUHUNT                                                       
VUF30    CLC   0(L'TAUHCBUN,R1),TCUNITS                                         
         BNL   NOTUPG                                                           
         TM    TGUSSTA3,CBLUSE                                                  
         BO    USUS10                                                           
         GOTO1 UPGRVAL,DMCB,TGUSCDE,TGUSTYP                                     
         B     USUS10                                                           
         SPACE 1                                                                
VUF40    ZICM  R1,TCSUBS,4       TEST FOR LCB UPGRADE                           
         BAS   RE,LCBTYP                                                        
         MVC   TYPE,11(RF)                                                      
         MVC   TGUPTOTY,11(RF)                                                  
         GOTO1 UPGRVAL,DMCB,(X'80',TGUSCDE),TGUPFRTY,TGUSCDE,TGUPTOTY           
         CLC   TAUHSUBS,TCSUBS                                                  
         BNL   NOTUPG                                                           
         SPACE 1                                                                
         CLI   TGUPTYP,0                                                        
         BE    USUS10                                                           
         MVC   TYPE,TGUPTYP                                                     
         MVC   SVUSTYP,TGUPTYP                                                  
         DROP  R4                                                               
         SPACE                                                                  
******************************** GIVE USER CHANGE TO SEE UNITS/SUBS **          
         SPACE 1                                                                
USUS10   LA    R3,WSPLNYH                                                       
         LA    R4,WSPTOTSH                                                      
         LA    RE,WSPFRSTH                                                      
         CLI   TWASCR,SCR55                                                     
         BE    USUS20                                                           
         LA    R3,CBLLUNTH                                                      
         LA    R4,CBLTOTSH                                                      
         LA    RE,CBLFRSTH                                                      
         CLI   TWASCR,SCR5F      IF ANY CNET/MKT/CSYS FIELDS HAVE               
         BE    USUS20            CHANGED SINCE CALCULATED UNITS/                
         LA    R3,ADWLUNTH       SUBS WERE LAST DISPLAYED, PAUSE SO             
         LA    R4,ADWTOTSH       USER CAN SEE NEW TOTAL                         
         LA    RE,ADWFRSTH                                                      
         SPACE 1                                                                
USUS20   ZIC   RF,0(RE)                                                         
         AR    RE,RF                                                            
         TM    1(RE),X'20'                                                      
         BO    XIT                                                              
         SPACE 1                                                                
         GOTO1 FLDVAL,DMCB,(X'40',(R3)),(X'80',(R4))                            
         BE    XIT                                                              
         GOTO1 FLDVAL,DMCB,(X'80',(R3)),(X'80',(R4))                            
         BE    XIT                                                              
         GOTO1 FLDVAL,DMCB,(X'22',(R3)),(X'80',(R4))                            
         SPACE 2                                                                
         MVI   MYMSGNO1,255      GIVE MESSAGE INDICATING                        
         TM    PAYSTAT1,ELIMINTD INPUT IS OK, HIT ENTER                         
         BZ    USUS30            TO CONTINUE                                    
         MVI   MYMTYP,GTMINF                                                    
         MVC   MYMSGNO,=H'256'                                                  
         MVI   BLOCK,0                                                          
USUS30   LA    R2,CBLUNITH                                                      
         LA    R3,CBLAUNTH                                                      
         CLI   TWASCR,SCR5F                                                     
         BE    USUS40                                                           
         LA    R2,WSPUNITH                                                      
         LA    R3,WSPAUNTH                                                      
         CLI   TWASCR,SCR55                                                     
         BE    USUS40                                                           
         LA    R2,ADWUNITH                                                      
         LA    R3,ADWAUNTH                                                      
USUS40   CLI   TCMAJORS,0                                                       
         BNE   INFEND                                                           
         CLI   5(R3),0                                                          
         BE    XIT                                                              
         B     INFEND                                                           
         EJECT                                                                  
*              ROUTINE TO ENSURE THAT CNET/MKT/CSYS CYCLE DOES                  
*              NOT OVERLAP A PREVIOUS CYCLE                                     
         SPACE 1                                                                
         USING MKTTABLD,R3                                                      
VALCYC   NTR1                                                                   
         MVI   TGBYTE,UHCUR      SET TRIED CURRENT AGENCY/COMM'L                
         SPACE 1                                                                
         USING TLUHPD,R4                                                        
         LA    R4,KEY            READ ALL USAGE HISTORY KEYS                    
         XC    TLUHPKEY,TLUHPKEY FOR THIS CNET/MKT/CSYS ON THIS                 
         MVI   TLUHPCD,TLUHMTDQ  COMMERCIAL                                     
         MVC   TLUHMINM,TGMTINTC                                                
         MVC   TLUHMCOM,TGCOM                                                   
VCYC10   GOTO1 HIGH                                                             
         B     VCYC30                                                           
VCYC20   GOTO1 SEQ                                                              
VCYC30   CLC   KEY(TLUHMUSE-TLUHPCD),KEYSAVE                                    
         BE    VCYC40                                                           
         SPACE 1                                                                
         BRAS  RE,RDPREVUH       IF NONE FOUND, SEARCH PREV AGY/COM             
         BNE   VCYC110                                                          
         BE    VCYC10                                                           
         SPACE 1                                                                
VCYC40   LA    RE,TLUHMC1D                                                      
         TM    PAYSTAT1,CREDIT                                                  
         BZ    *+8                                                              
         LA    RE,TLUHMCCS                                                      
         CLC   0(3,RE),MT1DATE   IF USE DATE OR LAG END DATE FITS               
         BNH   VCYC50            WITHIN AN EXISTING CYCLE FOR THIS              
         CLC   0(3,RE),MTCYCEND  CNET/MKT/CSYS ...                              
         BH    VCYC20                                                           
VCYC50   CLC   TLUHMCYE,MT1DATE                                                 
         BNL   VCYC60                                                           
         CLC   TLUHMCYE,MTCYCEND                                                
         BL    VCYC20                                                           
         SPACE 1                                                                
VCYC60   TM    PAYSTAT1,CREDIT   IF THIS IS NOT A CREDIT PAYMENT                
         BNZ   VCYC90                                                           
         TM    TLUHMSTA,TLUHMCRD AND FOUND ON A PREV CREDIT PAYMENT             
         BNZ   VCYCX             OK TO PAY AGAIN                                
         DROP  R4                                                               
         SPACE 1                                                                
         GOTO1 GETREC            GET USAGE HISTORY RECORD                       
         SPACE 1                                                                
         USING TAUHD,R4                                                         
         L     R4,AIO            GET USAGE HISTORY ELEMENT                      
         MVI   ELCODE,TAUHELQ                                                   
         BAS   RE,GETEL                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
         CLC   TCPCYCS,TAUHEND                                                  
         BH    CYCINV                                                           
         CLC   TCPCYCE,TAUHSTRT                                                 
         BL    CYCINV            COMMERCIAL CYCLES MUST OVERLAP                 
         SPACE 1                                                                
         MVC   WORK,TAUHEND      SAVE THE FOUND CYCLE END DATE                  
         DROP  R4                                                               
         SPACE 1                                                                
         USING TLUHPD,R4                                                        
         LA    R4,KEY            RESTORE KEY POINTER                            
         SPACE 1                                                                
         CLC   MT1DATE,TLUHMC1D  IF PAYING A NON-VERSION                        
         BL    VCYC80            INPUTTED DATE CANNOT BE LATER                  
         TM    LCLSTAT3,FORCEUPG (UNLESS THIS IS A FORCED UPGRADE)              
         BO    VCYC70                                                           
         CLI   VERSION,0                                                        
         BE    CYCINV                                                           
         SPACE 1                                                                
VCYC70   MVC   MTCYCEND,TLUHMCYE IF PAYING A VERSION (OR FORCING UPG)           
         BRAS  RE,ONFILE         THEN USE ESTABLISHED END DATE                  
         BE    VCYCX             AS LAG END DATE                                
         CLI   TGMTTYPE,TANPNET                                                 
         BE    *+6                                                              
         DC    H'00'                                                            
         MVI   TGMTTYPE,C'S'                                                    
         BRAS  RE,ONFILE                                                        
         BE    *+6                                                              
         DC    H'00'                                                            
         MVI   TGMTTYPE,TANPNET                                                 
         B     VCYCX                                                            
         SPACE 1                                                                
VCYC80   BRAS  RE,UPDHIST        IF INPUTTED DATE IS EARLIER,                   
         DC    H'00'             GO OFF AND UPDATE HISTORY                      
         SPACE 1                                                                
VCYC90   CLC   TLUHMCCS,TCPCYCS  IF THIS IS A CREDIT PAYMENT                    
         BNE   VCYC20            PREV CYCLE MUST HAVE SAME START DATE           
******** CLI   VERSION,0                                                        
******** BNE   VCYC100                                                          
******** TM    TLUHMSTA,TLUHMCRD AND IF THIS IS A CREDIT PAYMENT                
******** BNZ   CCYCINV           AND FOUND ON A PREV NON-CREDIT                 
VCYC100  MVC   MT1DATE,TLUHMC1D  OK TO PAY, ELSE ERROR                          
         MVC   MTCYCEND,TLUHMCYE                                                
         B     VCYCX                                                            
         DROP  R4                                                               
         SPACE 1                                                                
VCYC110  TM    PAYSTAT1,CREDIT   IF NOT FOUND ON PREVIOUS PAYMENT               
         BNZ   CCYCINV           AND THIS IS A CREDIT, ERROR                    
         SPACE 1                                                                
         CLI   VERSION,0         IF NOT FOUND ON PREVIOUS PAYMENT               
         BE    VCYCX             AND THIS IS A VERSION                          
         CLC   MT1DATE,TCPCYCE   INPUTTED DATE MUST FIT WITHIN CYCLE            
         BH    FLDINV                                                           
VCYCX    B     XIT                                                              
         DROP  R3                                                               
         EJECT                                                                  
*              ROUTINE TO SET LCB TYPE BASED ON NUMBER OF SUBSCRIBERS           
*              ON ENTRY ... R1=NUMBER OF SUBSCRIBERS                            
*              ON EXIT .... 11(RF)=LCB TYPE EQUATE                              
         SPACE 1                                                                
LCBTYP   LA    RF,SUBSTAB                                                       
LT10     CLI   0(RF),X'FF'                                                      
         BER   RE                                                               
         C     R1,0(RF)                                                         
         BNHR  RE                                                               
         LA    RF,L'SUBSTAB(RF)                                                 
         B     LT10                                                             
         SPACE 1                                                                
         DC    0F                                                               
SUBSTAB  DC    0XL12                                                            
         DC    F'50000',C'50000  ',AL1(ULCB50)                                  
         DC    F'100000',C'100000 ',AL1(ULCB100)                                
         DC    F'150000',C'150000 ',AL1(ULCB150)                                
         DC    F'200000',C'200000 ',AL1(ULCB200)                                
         DC    F'250000',C'250000 ',AL1(ULCB250)                                
         DC    F'500000',C'500000 ',AL1(ULCB500)                                
         DC    F'750000',C'750000 ',AL1(ULCB750)                                
         DC    F'1000000',C'1000000',AL1(ULCB1M)                                
         DC    F'99999999',C'9999999',AL1(ULCBMAX)                              
         DC    X'FF'                                                            
         EJECT                                                                  
*              ROUTINE TO POINT R2 AT UPGRADE FIELD                             
R2UPGFLD LA    R2,WSPUPGRH       R2=A(UPGRADE FIELD)                            
         CLI   TWASCR,SCR55                                                     
         BER   RE                                                               
         LA    R2,CBLUPGRH                                                      
         CLI   TWASCR,SCR5F                                                     
         BER   RE                                                               
         LA    R2,ADWUPGRH                                                      
         BR    RE                                                               
         EJECT                                                                  
*              ROUTINE TO BUILD DUMMY UH ELEMENT IF FORCING UPGRADE             
         SPACE 1                                                                
STDUMUH  NTR1                                                                   
         LA    R2,WSPLUNTH       R2=A(FORCED UNIT/SUBS FIELD)                   
         CLI   TWASCR,SCR55                                                     
         BE    SDUH01                                                           
         LA    R2,CBLLUNTH                                                      
         CLI   TWASCR,SCR5F                                                     
         BE    SDUH01                                                           
         LA    R2,ADWLUNTH                                                      
         SPACE 1                                                                
         USING TAUHD,R3                                                         
SDUH01   LA    R3,WORK2          R3=A(DUMMY UH ELEM) FOR UPGRADE                
         XC    WORK2(TAUHLNQ),WORK2                                             
         MVC   WORK2(TAUHDATA-TAUHD),TCTAUHEL                                   
         SPACE 1                                                                
         TM    TGUSSTA3,CBLUSE   IF CABLE OR SPANISH CABLE                      
         BZ    SDUH05            DO NOT FORCE OVER SUBSCRIBERS                  
         MVC   TAUHCSUB,TCTAUHEL+TAUHCSUB-TAUHD                                 
         B     SDUH10                                                           
         SPACE 1                                                                
SDUH05   CLI   TGUSEQU,ULCB      IF LOCAL CABLE                                 
         BNE   SDUH10            DO NOT FORCE OVER CSYS COUNT                   
         MVC   TAUHCSYS,TCTAUHEL+TAUHCSYS-TAUHD                                 
         SPACE 1                                                                
SDUH10   CLI   TGUSEQU,UWSP      IF WILDSPOT                                    
         BNE   SDUH20                                                           
         MVI   TAUHMAJ,0         SET MAJORS BASED ON FORCED INPUT               
         CLI   WSPLNYH+5,0                                                      
         BE    *+8                                                              
         OI    TAUHMAJ,NY                                                       
         CLI   WSPLLAH+5,0                                                      
         BE    *+8                                                              
         OI    TAUHMAJ,LA                                                       
         CLI   WSPLCHIH+5,0                                                     
         BE    *+8                                                              
         OI    TAUHMAJ,CHI                                                      
         SPACE 1                                                                
SDUH20   BRAS  RE,VALUNITS       VALIDATE FORCED UNITS                          
         SPACE 1                                                                
*&&DO                                                                           
         CLI   TAUHMAJ,0         ENSURE THE INPUT OF AT LEAST                   
         BNE   SDUH30            ONE UNIT                                       
         LTR   R1,R1                                                            
         BZ    NEEDUNIT          OR ONE UNIT/SUBSCRIBER                         
*&&                                                                             
         SPACE 1                                                                
SDUH30   CLI   TGUSEQU,ULCB      IF LOCAL CABLE                                 
         BNE   SDUH40            SAVE FORCED SUBSCRIBERS                        
         ST    R1,TAUHSUBS                                                      
         BAS   RE,LCBTYP                                                        
         MVC   TAUHTYPE,11(RF)                                                  
         MVC   TGUPFRTY,11(RF)                                                  
         B     SDUH60                                                           
         SPACE 1                                                                
SDUH40   LA    RE,TAUHCBUN       ELSE, SAVE FORCED UNITS                        
         TM    TGUSSTA3,CBLUSE                                                  
         BNZ   SDUH50                                                           
         LA    RE,TAUHUNT                                                       
SDUH50   STH   R1,0(RE)                                                         
         SPACE 1                                                                
SDUH60   MVC   TCTAUHEL,WORK2    SAVE DUMMY UH EL FOR UPGRADE                   
         DROP  R3                                                               
         SPACE 1                                                                
         B     XIT                                                              
         EJECT                                                                  
*              ROUTINE TO ADD CURRENT UNITS/SUBSCRIBERS TO PREVIOUS             
*              UNITS/SUBSCRIBERS                                                
*              ON ENTRY ... R2=A(AUTOMATIC UNITS/SUBSCRIBERS FIELD)             
*                           R4=A(USAGE HISTORY ELEMENT)                         
*              ON EXIST ... R1=(ACCUMULATED UNITS/SUBSCRIBERS)                  
         SPACE 1                                                                
         USING TAUHD,R4                                                         
ADD2AUTO ZIC   RF,5(R2)                                                         
         LTR   RF,RF                                                            
         BZ    A2AUTO30                                                         
         BCTR  RF,0                                                             
         EX    RF,*+8                                                           
         B     *+10                                                             
         PACK  DUB,8(0,R2)                                                      
         CVB   RF,DUB                                                           
         SPACE 1                                                                
A2AUTO10 L     R1,TAUHSUBS                                                      
         CLI   TGUSEQU,ULCB                                                     
         BE    A2AUTO20                                                         
         LH    R1,TAUHCBUN                                                      
         TM    TGUSSTA3,CBLUSE                                                  
         BNZ   A2AUTO20                                                         
         LH    R1,TAUHUNT                                                       
A2AUTO20 AR    R1,RF                                                            
         BR    RE                                                               
A2AUTO30 XR    R1,R1                                                            
         BR    RE                                                               
         DROP  R4                                                               
         EJECT                                                                  
*              POST-MIDDLE OF SCREEN PROCESSING (61 - SPANISH WILDSPOT)         
         SPACE                                                                  
         USING TAUHD,R3                                                         
XVMD61   DS    0H                                                               
         NI    LCLSTAT3,X'FF'-FORCEUPG                                          
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    XIT                                                              
         SPACE                                                                  
         CLI   SWSUPGR,C'F'        TEST FORCING HISTORY FOR UPGRADE             
         BNE   XVMD6110                                                         
         SPACE                                                                  
         OI    LCLSTAT3,FORCEUPG   SET LOCAL BIT FOR LATER                      
         SPACE                                                                  
         LA    R3,WORK2            R3=A(DUMMY UH ELEM) FOR UPGRADE              
         XC    WORK2(TAUHLNQ),WORK2                                             
         LA    R2,SWSLUNTH         R2=A(UNITS FIELD)                            
         BRAS  RE,VALUNITS         VALIDATE UNITS                               
         STH   R1,TAUHUNT          SAVE N'UNITS                                 
         LTR   R1,R1                                                            
         BZ    NEEDUNIT            THEY MUST INPUT SOMETHING                    
         SPACE                                                                  
         LA    R2,SWSUPGRH         R2=A(UPGRADE? FIELD HEADER)                  
         MVC   TCTAUHEL,WORK2      SAVE DUMMY UH EL FOR UPGRADE                 
         B     XVMD6115                                                         
         SPACE                                                                  
XVMD6110 LA    R2,SWSUPGRH         R2=A(UPGRADE? FIELD HEADER)                  
         OC    TCTAUHEL,TCTAUHEL                                                
         BZ    NOPREV              CAN'T UPGRADE - NO PREV PAYMENT              
         SPACE                                                                  
XVMD6115 LA    R3,TCTAUHEL         R3=A(USAGE HISTORY ELEM) FOR UPGRADE         
         CLI   VERSION,0           IF PAYING A VERSION                          
         BE    XVMD6120                                                         
         LH    R1,TCUNITS                                                       
         AH    R1,TAUHUNT          ADD PREV UNITS TO CURRENT                    
         STH   R1,TCUNITS                                                       
         SPACE                                                                  
XVMD6120 CLC   TAUHUNT,TCUNITS     TEST THIS PAYMENT IS AN UPGRADE              
         BNL   NOTUPG                                                           
         B     XIT                                                              
         EJECT                                                                  
*              POST-MIDDLE OF SCREEN PROCESSING (63 - SPANISH NWK/WSP)          
         SPACE                                                                  
         USING TAUHD,R3                                                         
XVMD63   DS    0H                                                               
         NI    LCLSTAT3,X'FF'-FORCEUPG                                          
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    XIT                                                              
         GOTO1 FLDVAL,DMCB,(X'80',SNWUPGNH),SNWUPGCH  GET UPGRADE FIELD         
         L     R4,8(R1)            R4=A(UPGRADE FIELD)                          
         SPACE                                                                  
         CLI   8(R4),C'F'          TEST FORCING HISTORY FOR UPGRADE             
         BNE   XVMD6310                                                         
         SPACE                                                                  
         OI    LCLSTAT3,FORCEUPG   SET LOCAL BIT FOR LATER                      
         SPACE                                                                  
         LA    R3,WORK2            R3=A(DUMMY UH ELEM) FOR UPGRADE              
         XC    WORK2(TAUHLNQ),WORK2                                             
         LA    R1,SNWUPGNH         IF FORCING UPGRADE FROM SNT                  
         CR    R4,R1                                                            
         BE    XVMD635             NEED NO UNITS & ALWAYS VALID UPGRADE         
         SPACE                                                                  
         LA    R2,SNWLUNTH         R2=A(UNITS FIELD)                            
         BRAS  RE,VALUNITS         VALIDATE UNITS                               
         STH   R1,TAUHUNT          SAVE N'UNITS                                 
         LTR   R1,R1                                                            
         BZ    NEEDUNIT            THEY MUST INPUT SOMETHING                    
         SPACE                                                                  
         LR    R2,R4               R2=A(UPGRADE? FIELD HEADER)                  
         CLC   TAUHUNT,TCUNITS     TEST THIS PAYMENT IS AN UPGRADE              
         BH    NOTUPG              UNITS CAN'T DECREASE                         
         BL    XVMD635             ALWAYS VALID IF UNITS INCREASED              
         LA    R1,SNWUPGCH         IF FORCING UPGRADE FROM COMBINED             
         CR    R2,R1                                                            
         BE    NOTUPG              UNITS MUST INCREASE                          
XVMD635  MVC   TCTAUHEL,WORK2      SAVE DUMMY UH EL FOR UPGRADE                 
         B     XVMD63X                                                          
         SPACE                                                                  
XVMD6310 LR    R2,R4               R2=A(UPGRADE? FIELD HEADER)                  
         OC    TCTAUHEL,TCTAUHEL                                                
         BZ    NOPREV              CAN'T UPGRADE - NO PREV PAYMENT              
         SPACE                                                                  
         LA    R1,SNWUPGNH         IF UPGRADE FROM SNT                          
         CR    R2,R1                                                            
         BE    XVMD63X             ALWAYS VALID UPGRADE                         
         SPACE                                                                  
         LA    R3,TCTAUHEL         R3=A(USAGE HISTORY ELEM) FOR UPGRADE         
******** CLI   VERSION,0                                                        
******** BE    XVMD6320                                                         
******** LH    R1,TCUNITS                                                       
******** AH    R1,TAUHUNT                                                       
******** STH   R1,TCUNITS                                                       
         SPACE                                                                  
XVMD6320 CLI   VERSION,0                                                        
         BNE   XIT                                                              
         CLC   TAUHUNT,TCUNITS     TEST THIS PAYMENT IS AN UPGRADE              
         BH    NOTUPG              UNITS CAN'T DECREASE                         
         BL    XVMD63X             ALWAYS VALID IF UNITS INCREASED              
         LA    R1,SNWUPGCH         IF FORCING UPGRADE FROM COMBINED             
         CR    R2,R1                                                            
         BE    NOTUPG              UNITS MUST INCREASE                          
XVMD63X  B     XIT                                                              
         EJECT                                                                  
*&&DO                                                                           
*              POST-MIDDLE OF SCREEN PROCESSING (68-INSRT FOR BOOKEND)          
         SPACE                                                                  
         USING TAUHD,R3                                                         
XVMD68   DS    0H                                                               
         NI    LCLSTAT3,X'FF'-FORCEUPG                                          
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    XIT                                                              
         SPACE                                                                  
         CLI   IFBUPGR,C'F'        TEST FORCING HISTORY FOR UPGRADE             
         BNE   XVMD6810                                                         
         SPACE                                                                  
         OI    LCLSTAT3,FORCEUPG   SET LOCAL BIT FOR LATER                      
         SPACE                                                                  
         LA    R3,WORK2            R3=A(DUMMY UH ELEM) FOR UPGRADE              
         XC    WORK2(TAUHLNQ),WORK2                                             
         LA    R2,IFBLINSH         R2=A(INSERTS FIELD)                          
         BRAS  RE,VALUNITS         VALIDATE INSERTS                             
         STH   R1,TAUHINS          SAVE N'INSERTS                               
         LTR   R1,R1                                                            
         BZ    NEEDINS             THEY MUST INPUT SOMETHING                    
         SPACE                                                                  
         LA    R2,IFBUPGRH         R2=A(UPGRADE? FIELD HEADER)                  
         CLC   TAUHINS,TCINSRTS    TEST THIS PAYMENT IS AN UPGRADE              
         BNL   NOTUPG                                                           
         MVC   TCTAUHEL,WORK2      SAVE DUMMY UH EL FOR UPGRADE                 
         B     XIT                                                              
         SPACE                                                                  
XVMD6810 LA    R2,IFBUPGRH         R2=A(UPGRADE? FIELD HEADER)                  
         OC    TCTAUHEL,TCTAUHEL                                                
         BZ    NOPREV              CAN'T UPGRADE - NO PREV PAYMENT              
         SPACE                                                                  
         LA    R3,TCTAUHEL         R3=A(USAGE HISTORY ELEM) FOR UPGRADE         
         CLC   TAUHINS,TCINSRTS    TEST THIS PAYMENT IS AN UPGRADE              
         BNL   NOTUPG                                                           
         B     XIT                                                              
         EJECT                                                                  
*&&                                                                             
*              POST-MIDDLE OF SCREEN PROCESSING (6B-SOAP RESIDUAL)              
         SPACE                                                                  
         USING TMPPAYD,R1                                                       
XVMD6B   DS    0H                                                               
         L     R1,ATMPPAYD         USE TEMPORARY STORAGE                        
         LA    R1,TSARAREA                                                      
         ST    R1,TCATSAR          SET A(TSAR RECORD)                           
         MVC   MYTSRNUM,=H'1'                                                   
         MVI   MYTSACTN,TSAGET     GET 1ST RECORD WITH ALL EPIS INPUT           
         GOTOR CALLTSAR                                                         
         BE    *+6                                                              
         DC    H'0'                MUST BE THERE                                
         SPACE                                                                  
         USING ECASTABD,R4                                                      
         L     R4,TCATSAR          R4=A(TSAR RECORD)                            
         LA    R2,BLOCK                                                         
         ZIC   R0,ECSTNEPI         R0=NUMBER OF EPISODES                        
         LA    RE,ECSTNEPI                                                      
         LA    R3,MAXEPIS*EPINUMLN+1  SAVE NEPI & ALL EPI INFO IN BLOCK         
         LR    RF,R3                                                            
         MVCL  R2,RE                                                            
         LA    R2,BLOCK+1          R2=A(EPISODE INFO) IN BLOCK                  
         LA    R3,KEY              R3=A(KEY)                                    
         SPACE                                                                  
         USING TLECD,R3                                                         
XVMD6B5  XC    KEY,KEY                                                          
         MVI   TLECCD,TLECCDQ                                                   
         MVC   TLECCOM,TGCOM                                                    
         LH    R1,0(R2)            EPISODE NUMBER IN BINARY                     
         CVD   R1,DUB              CONVERT IT                                   
         UNPK  TLECEPI,DUB+5(3)                                                 
         OI    TLECEPI+4,X'F0'                                                  
         XC    TLECEPI,=5X'FF'     COMPLEMENT EPISODE NUM                       
         GOTO1 HIGH                                                             
         B     XVMD6B9                                                          
         SPACE 1                                                                
XVMD6B7  GOTO1 SEQ                                                              
XVMD6B9  CLC   KEY(TLECSORT-TLECD),KEYSAVE CHECK STILL SAME EPISODE NUM         
         BNE   XVMD6B25                                                         
         GOTO1 GETREC                                                           
         BRAS  RE,MERGECAT         SET TG INFO,MERGE CATEGORY IF NEEDED         
         BRAS  RE,FILTER           DO SOME FILTERING                            
         BNE   XVMD6B7                                                          
         BRAS  RE,INCOUNT          INCREMENT COUNT OF CAST FOR THIS EPI         
         USING TLDRD,R3                                                         
         MVC   TGBYTE,TLDRSTAT     TGBYTE=1ST STATUS BYTE                       
         LA    R1,ECSTKLNQ                                                      
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         XC    0(0,R4),0(R4)       CLEAR KEY AREA IN TSAR                       
         USING TLECD,R3                                                         
         MVC   ECSTSSN,TLECSSN     BUILD KEY FOR TSAR RECORD                    
         MVC   ECSTCAT,TGCAT                                                    
         MVC   ECSTSORT,TGCASORT                                                
         CLC   TLECCOM,COM2        IF DOING 2ND COMMERCIAL                      
         BNE   *+8                                                              
         OI    ECSTSTAT,ECSTS2ND   SET BIT IN STATUS                            
         XC    MYTSRNUM,MYTSRNUM                                                
         MVI   MYTSACTN,TSARDH                                                  
         GOTOR CALLTSAR            TEST IF TSAR REC EXISTS                      
         BE    XVMD6B11            IF YES, CHANGE EXISTING REC                  
         SPACE                                                                  
         BRAS  RE,CLRTSAR          ELSE CLEAR TSAR RECORD AREA                  
         MVC   ECSTSSN,TLECSSN     BUILD NEW RECORD                             
         MVC   ECSTSORT,TGCASORT                                                
         MVC   ECSTCAT,TGCAT                                                    
         CLC   TLECCOM,COM2        IF DOING 2ND COMMERCIAL                      
         BNE   *+8                                                              
         OI    ECSTSTAT,ECSTS2ND   SET BIT IN STATUS                            
         MVI   MYTSACTN,TSAADD     ADD RECORD LATER                             
         LA    R3,ECSTEPIS         R3=A(EPISODE ENTRY)                          
         B     XVMD6B15                                                         
         SPACE                                                                  
XVMD6B11 MVI   MYTSACTN,TSAWRT     WRITE THE RECORD BACK LATER                  
         BRAS  RE,GETENTRY         SET R3=A(ENTRY) FOR THIS EPISODE             
XVMD6B15 BRAS  RE,NEEDEC           GET ECAST REC AND PROCESS IF NEEDED          
         SPACE                                                                  
         USING EPISD,R3                                                         
         MVC   EPINUM,0(R2)        SAVE EPISODE NUM                             
         ZIC   R1,ECSTNEPI                                                      
         LA    R1,1(R1)                                                         
         STC   R1,ECSTNEPI         INCREMENT NUMBER OF EPISODES                 
         GOTOR CALLTSAR                                                         
         BE    *+14                                                             
         MVC   TGCOM,SVTGCOM       RESTORE TGCOM                                
         B     TOOBIG              GIVE ERROR IF END OF FILE                    
         LA    R3,KEY              RESET R3=A(KEY)                              
         B     XVMD6B7             ELSE GET NEXT ECAST RECORD                   
         SPACE                                                                  
XVMD6B25 LA    R2,EPINUMLN(R2)     BUMP TO NEXT EPISODE NUM                     
         BCT   R0,XVMD6B5          LOOP FOR NUMBER OF EPISODES                  
         SPACE                                                                  
         OC    COM2,COM2           IF HAVE 2ND COMMERCIAL                       
         BZ    XVMD6BX                                                          
         CLC   TGCOM,COM2          AND HAVEN'T PROCESSED YET                    
         BE    XVMD6BX                                                          
         MVC   TGCOM,COM2          PROCESS IT                                   
         LA    R2,BLOCK+1          START WITH FIRST EPISODE                     
         ZIC   R0,BLOCK                                                         
         LA    R3,KEY                                                           
         B     XVMD6B5                                                          
         SPACE                                                                  
XVMD6BX  MVC   TGCOM,SVTGCOM       RESTORE TGCOM                                
         BRAS  RE,SAVCOUNT         SAVE CAST COUNTS IN EPISAIR                  
         B     XIT                                                              
         EJECT                                                                  
*              POST-MIDDLE OF SCREEN PROCESSING  (71 - LOCAL CABLE)             
         SPACE 1                                                                
         USING TAUHD,R3                                                         
XVMD71   DS    0H                                                               
         NI    LCLSTAT3,X'FF'-FORCEUPG                                          
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    XIT                                                              
         SPACE                                                                  
         LA    R2,LCBUPGRH         R2=A(UPGRADE? FIELD HEADER)                  
         CLI   LCBUPGR,C'F'        TEST FORCING HISTORY FOR UPGRADE             
         BNE   XVMD7110                                                         
         SPACE                                                                  
         OI    LCLSTAT3,FORCEUPG   SET LOCAL BIT FOR LATER                      
         SPACE                                                                  
         LA    R3,WORK2            R3=A(DUMMY UH ELEM) FOR UPGRADE              
         XC    WORK2(TAUHLNQ),WORK2 LAST DETAILS OVERIDDEN-CHANGE UH EL         
         MVC   TAUHTYPE,TGUPFRTY    SET TYPE                                    
         TM    TCPAYST,TCMILFR                                                  
         BZ    *+8                                                              
         OI    TAUHLCST,TAUHFMIL    IF 1MIL ADDED TO RATE, TURN ON BIT          
*&&UK                                                                           
         MVI   TAUHLCBM,0                                                       
         CLI   LCBLNYH+5,0         SET MAJORS - ANY INPUT IS OK                 
         BE    *+8                                                              
         OI    TAUHLCBM,NY                                                      
         CLI   LCBLLAH+5,0                                                      
         BE    *+8                                                              
         OI    TAUHLCBM,LA                                                      
         CLI   LCBLCHIH+5,0                                                     
         BE    *+8                                                              
         OI    TAUHLCBM,CHI                                                     
*&&                                                                             
         SPACE 1                                                                
         BRAS  RE,VALCBUPG         TEST THIS PAYMENT IS AN UPGRADE              
         BNE   NOTUPG                                                           
         MVC   TCTAUHEL,WORK2      SAVE DUMMY UH EL FOR UPGRADE                 
         B     XIT                                                              
         SPACE                                                                  
XVMD7110 BRAS  RE,GETLCBUH         GET UH FOR THIS CYCLE & SET TGUPFRTY         
         BNE   NOPREV                                                           
         GOTO1 UPGRVAL,DMCB,(X'80',TGUSCDE),TGUPFRTY,TGUSCDE,TGUPTOTY           
         BNE   NOTUPG                                                           
         MVC   TYPE,TGUPTYP                                                     
         GOTO1 USEVAL,DMCB,CONREC,TYPE  VALIDATE REAL USE CODE AND TYPE         
         BE    *+6                                                              
         DC    H'0'                                                             
XVMD7120 LA    R3,TCTAUHEL         R3=A(USAGE HISTORY ELEM) FOR UPGRADE         
         BRAS  RE,VALCBUPG         TEST THIS PAYMENT IS AN UPGRADE              
         BNE   NOTUPG                                                           
         B     XIT                                                              
         EJECT                                                                  
*              UPDATE GCON RECORD IF PNH PAYMENT                                
*                                                                               
XVMD72   TM    LCLSTAT9,CASTGRT    CAST ON GRT?                                 
         JO    XVMD73                                                           
         TM    LCLSTAT8,NOGCPEND   CAST NOT ON GRT, GIVE WARNING                
         JNZ   *+12                                                             
         OI    LCLSTAT8,NOGCPEND                                                
         J     PNH20ERR                                                         
         SPACE                                                                  
         CLI   PFAID,20                                                         
         JNE   PNH20ERR                                                         
         NI    LCLSTAT8,X'FF'-NOGCPEND                                          
XVMD73   OC    GUARCONT,GUARCONT   ANY GUARANTEE CONTRACT?                      
         BZ    XIT                                                              
         MVC   TGGCNT,GUARCONT                                                  
         BRAS  RE,GETGCON          GET GCON RECORD + VALUES                     
         B     XIT                                                              
         EJECT                                                                  
*              POST-MIDDLE OF SCREEN PROCESSING  (85 - GUARANTEE)               
         SPACE 1                                                                
XVMD85   DS    0H                                                               
         MVI   GUARSTAT,DESCBAL                                                 
         MVI   GUARSTA2,0                                                       
         SPACE 1                                                                
         LA    R2,GT2OVERH         PAYING OVERAGE                               
         MVI   BYTE,PAYOVRAG                                                    
         BRAS  RE,VALSTAT                                                       
         SPACE 1                                                                
         LA    R2,GT2MSCH          MULTI-CONTRACT SERVICE                       
         GOTO1 ANY                                                              
         CLI   8(R2),C'N'                                                       
         BE    XVMD85A                                                          
         CLI   8(R2),C'Y'                                                       
         BNE   FLDINV                                                           
         OI    GUARSTA2,TAGUSMSC                                                
         SPACE 1                                                                
XVMD85A  LA    R2,GT2GCONH         GUARANTEE CONTRACT CODE                      
         CLI   5(R2),0                                                          
         JNE   XVMD85C                                                          
         SPACE                                                                  
         OC    GUARCONT,GUARCONT   GCON ON CAST GRT?                            
         JZ    XVMD85B             NO                                           
         MVC   TGGCNT,GUARCONT     YES                                          
         J     XVMD85D                                                          
         SPACE                                                                  
XVMD85B  TM    LCLSTAT9,CASTGRT    CAST ON GRT BUT NO GCON, THEN                
         JO    XVMDAX              LET IT GO THROUGH                            
         TM    LCLSTAT8,NOGCPEND   NO GCON ON SCREEN OR GRT                     
         JNZ   *+12                                                             
         OI    LCLSTAT8,NOGCPEND                                                
         J     PNH20ERR                                                         
         SPACE                                                                  
         CLI   PFAID,20                                                         
         JNE   PNH20ERR                                                         
         NI    LCLSTAT8,X'FF'-NOGCPEND                                          
         J     XVMDAX                                                           
         SPACE                                                                  
XVMD85C  CLI   5(R2),L'GT2GCON                                                  
         JNE   FLDINV                                                           
         CLC   =C'GC',8(R2)                                                     
         JNE   FLDINV                                                           
         SPACE                                                                  
         ZIC   R1,5(R2)                                                         
         SHI   R1,3                2 FOR 'GC' AND 1 FOR EXPACK                  
         EX    R1,*+8                                                           
         J     *+10                                                             
         PACK  DUB,10(0,R2)                                                     
         CVB   R1,DUB                                                           
         LNR   R1,R1               COMPLEMENT GRT CONTRACT CODE                 
         STCM  R1,15,TGGCNT                                                     
         SPACE                                                                  
         OC    GUARCONT,GUARCONT                                                
         JZ    XVMD85D                                                          
         CLC   GUARCONT,TGGCNT                                                  
         JNE   FLDINV                                                           
XVMD85D  BRAS  RE,GETGCON                                                       
         SPACE                                                                  
         TM    LCLSTAT8,MORE1SSN                                                
         JO    FLDINV                                                           
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY A DETAIL LINE                                            
         SPACE 1                                                                
DISPLAY  NTR1                                                                   
         LH    RF,DSPDDTL          RF=A(DISP. TO INDIVIDUAL ROUTINE)            
         LTR   RF,RF                                                            
         BZ    DISX                                                             
         AR    RF,RB                                                            
         LA    RE,DISX             SET RE FOR COMMON NTR1                       
         L     R3,ATHSLINE         R3=A(LINE)                                   
         NTR1                                                                   
         BR    RF                  ** HANDLE INDIVIDUAL SCREEN **               
DISX     B     XIT                                                              
         SPACE 3                                                                
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY BF)                       
         SPACE 1                                                                
DISBF    DS    0H                                                               
         BRAS  RE,DISBFR                                                        
         B     XIT                                                              
         EJECT                                                                  
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 5D)                       
         SPACE 1                                                                
         USING LIN5DD,R3           R3=A(LINE)                                   
DIS5D    DS    0H                                                               
         MVC   L5DNAME,CASTNAME    NAME                                         
         MVC   L5DCAT,TGCAT        CATEGORY                                     
         MVC   L5DYR,TGYRCDE       YEAR                                         
         CLI   TCW4TYPE,TAW4TYIN   IF THIS ISN'T AN INDIVIDUAL                  
         BE    DIS5D1                                                           
         LA    R1,L5DTYP                                                        
         CLI   TGYRCDE+2,C' '      IF YEAR IS 3 BYTES                           
         BNH   *+8                                                              
         LA    R1,1(R1)            SKIP A SPACE                                 
         MVC   0(1,R1),TCW4TYPE    DISPLAY TYPE                                 
         SPACE                                                                  
DIS5D1   MVC   L5DTAG,=C'Cmt'      MOVE IN CHECK COMMENT TAG                    
         MVC   L5DETAG,=C'Epis'    MOVE IN EPISODE TAG                          
         SPACE 1                                                                
         USING TASOD,R4                                                         
         OC    ELTASO,ELTASO       IF HAVE EPISODE NUMS ELEMENT                 
         BZ    DIS5D4                                                           
         LA    R4,ELTASO                                                        
         ZIC   R0,TASONUM          R0=NUMBER OF ENTRIES                         
         LTR   R0,R0               SKIP IF 0                                    
         BZ    DIS5D4                                                           
         LA    R1,L5DENUM-1        R1=A(EPISODE NUM OUTPUT), SKIP ","           
         LA    R4,TASOEPI          R4=A(EPISODE NUMBER)                         
         B     *+8                                                              
DIS5D2   MVI   0(R1),C','                                                       
         LH    RE,0(R4)                                                         
         CVD   RE,DUB                                                           
         UNPK  WORK(5),DUB+5(3)    CONVERT IT TO 5 CHARS                        
         OI    WORK+4,X'F0'                                                     
         MVC   1(5,R1),WORK                                                     
         LA    R1,6(R1)                                                         
         LA    R4,L'TASOSEPI(R4)                                                
         BCT   R0,DIS5D2           LOOP FOR NUMBER OF ENTRIES                   
         SPACE 1                                                                
         USING TACAD,R4                                                         
DIS5D4   LA    R4,ELTACA                                                        
         OC    TACANCDE,TACANCDE                                                
         BZ    DIS5D5                                                           
         GOTO1 TRNSAGT,DMCB,(X'40',TACANCDE),L5DAGT                             
         SPACE 1                                                                
DIS5D5   GOTO1 CHAROUT,DMCB,TACMELQ,L5DCMNTH,TACMTYPC  DISPLAY CHK CMNT         
         B     XIT                                                              
         EJECT                                                                  
*              DISPLAY A DETAIL LINE  (DETAIL SCREEN OVERLAY B5)                
         SPACE 1                                                                
         USING LINB5D,R3           R3=A(LINE)                                   
DISB5    DS    0H                                                               
         MVC   LB5NAME,CASTNAME    NAME                                         
         MVC   LB5CAT,TGCAT        CATEGORY                                     
         MVI   LB5CAM,C'Y'         SET Y=ON CAMERA                              
         CLI   TCCAONOF+1,C'F'                                                  
         BNE   *+8                                                              
         MVI   LB5CAM,C'N'         N=OFF                                        
         MVC   LB5YR,TGYRCDE       YEAR                                         
         MVC   LB5TAG,=C'^Cmnt'    MOVE IN CHECK COMMENT TAG                    
         MVC   LB5ACDE,TCAPPLCD    APPLIED AMOUNT CODE                          
         SPACE 1                                                                
         L     R2,ADTLCMTH                                                      
         CLC   COMCMNT,8(R2)       IF WE DON'T HAVE COMMERCIAL COMMENT          
         BE    *+14                                                             
         MVC   8(L'DTLCMNT,R2),COMCMNT  MOVE IT IN                              
         OI    6(R2),X'80'              AND TRANSMIT                            
         SPACE 1                                                                
         L     R2,ADTLDUEH                                                      
         CLI   13(R2),C' '         IF WE DIDN'T DISPLAY DUE DATE YET            
         BH    DB510                                                            
         GOTO1 DATCON,DMCB,(1,DUEDATE),(8,13(R2))  DO SO NOW                    
         OI    6(R2),X'80'                                                      
         SPACE 1                                                                
DB510    CLI   TGUSEQU,UGRT        IF MAKING GRT PAYMENT                        
         BNE   XIT                                                              
         NI    LB5PAYH+4,X'DF'     TURN OFF PAYMENT AMOUNT'S                    
         B     XIT                 PRE-VALIDATED STATUS                         
         SPACE 3                                                                
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY AF)                       
         SPACE 1                                                                
         USING LINAFD,R3           R3=A(LINE)                                   
DISAF    DS    0H                                                               
         MVC   LAFNAME,CASTNAME    NAME                                         
         MVC   LAFCAT,TGCAT        CATEGORY                                     
         MVI   LAFCAM,C'Y'         SET Y=ON CAMERA                              
         CLI   TCCAONOF+1,C'F'                                                  
         BNE   *+8                                                              
         MVI   LAFCAM,C'N'         N=OFF                                        
         MVC   LAFYR,TGYRCDE       YEAR                                         
         MVC   LAFTAG,=C'^Cmnt'    MOVE IN CHECK COMMENT TAG                    
         SPACE 1                                                                
         XC    TCTOTS(TCTOTLNQ),TCTOTS  DON'T DISPLAY ANY AMOUNTS               
         B     XIT                                                              
         EJECT                                                                  
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 58)                       
         SPACE 1                                                                
         USING LIN58D,R3           R3=A(LINE)                                   
DIS58    DS    0H                                                               
         MVC   L58NAME,CASTNAME    NAME                                         
         MVC   L58CAT,TGCAT        CATEGORY                                     
         MVI   L58CAM,C'Y'         SET Y=ON CAMERA                              
         CLI   TCCAONOF+1,C'F'                                                  
         BNE   *+8                                                              
         MVI   L58CAM,C'N'         N=OFF                                        
         MVC   L58YR,TGYRCDE       YEAR                                         
         MVC   L58TAG,=C'^Cmnt'    MOVE IN CHECK COMMENT TAG                    
         SPACE 1                                                                
         XC    TCTOTS(TCTOTLNQ),TCTOTS  DON'T DISPLAY ANY AMOUNTS               
         B     XIT                                                              
         SPACE 3                                                                
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 69)                       
         SPACE 1                                                                
         USING LIN69D,R3           R3=A(LINE)                                   
DIS69    DS    0H                                                               
         MVC   L69NAME,CASTNAME    NAME                                         
         MVC   L69CAT,TGCAT        CATEGORY                                     
         MVI   L69CAM,C'Y'         SET Y=ON CAMERA                              
         CLI   TCCAONOF+1,C'F'                                                  
         BNE   *+8                                                              
         MVI   L69CAM,C'N'         N=OFF                                        
         MVC   L69YR,TGYRCDE       YEAR                                         
         MVC   L69TAG,=C'^Cmnt'    MOVE IN CHECK COMMENT TAG                    
         SPACE 1                                                                
         USING TADLD,R4                                                         
         LA    R4,ELTADL                                                        
         OC    TADLEXP,TADLEXP                                                  
         BZ    DIS695                                                           
         GOTO1 DATCON,DMCB,(1,TADLEXP),(8,L69EXPD) DISPLAY EXP DATE             
         SPACE 1                                                                
         USING TACAD,R4                                                         
DIS695   LA    R4,ELTACA                                                        
         EDIT  (2,TACARATE),(5,L69AGTF),2,ZERO=NOBLANK  AGENCY FEE RATE         
         SPACE 1                                                                
         OC    TACANCDE,TACANCDE                                                
         BZ    DIS69X                                                           
         GOTO1 TRNSAGT,DMCB,(X'40',TACANCDE),L69AGT                             
DIS69X   B     XIT                                                              
         EJECT                                                                  
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 6B)                       
         SPACE 1                                                                
         USING LIN6BD,R3           R3=A(LINE)                                   
DIS6B    DS    0H                                                               
         MVC   L6BNAME,CASTNAME    NAME                                         
         MVC   L6BCAT,TGCAT        CATEGORY                                     
         MVI   L6BCAM,C'Y'         SET Y=ON CAMERA                              
         CLI   TCCAONOF+1,C'F'                                                  
         BNE   *+8                                                              
         MVI   L6BCAM,C'N'         N=OFF                                        
         MVC   L6BYR,TGYRCDE       YEAR                                         
         MVC   L6BTAG,=C'Cmt'      MOVE IN CHECK COMMENT TAG                    
         SPACE 1                                                                
         USING TACAD,R4                                                         
         LA    R4,ELTACA                                                        
         OC    TACANCDE,TACANCDE                                                
         BZ    XIT                                                              
         GOTO1 TRNSAGT,DMCB,(X'40',TACANCDE),L6BAGT                             
         B     XIT                                                              
         SPACE 3                                                                
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 72)                       
         SPACE 1                                                                
         USING LIN72D,R3           R3=A(LINE)                                   
DIS72    DS    0H                                                               
         MVC   L72NAME,CASTNAME    NAME                                         
         MVC   L72CAT,TGCAT        CATEGORY                                     
         MVI   L72CAM,C'Y'         SET Y=ON CAMERA                              
         CLI   TCCAONOF+1,C'F'                                                  
         BNE   *+8                                                              
         MVI   L72CAM,C'N'         N=OFF                                        
         MVC   L72YR,TGYRCDE       YEAR                                         
         MVC   L72TAG,=C'^Cmnt'    MOVE IN CHECK COMMENT TAG                    
         SPACE 1                                                                
         XC    TCTOTS(TCTOTLNQ),TCTOTS  DON'T DISPLAY ANY AMOUNTS               
         B     XIT                                                              
*                                                                               
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 16)             *         
*                                                                     *         
***********************************************************************         
                                                                                
         USING LIN16D,R3           R3=A(LINE)                                   
DIS16    DS    0H                                                               
         BRAS  RE,DIS16R                                                        
         B     XIT                                                              
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 17)             *         
*                                                                     *         
***********************************************************************         
                                                                                
         USING LIN17D,R3           R3=A(LINE)                                   
DIS17    DS    0H                                                               
         BRAS  RE,DIS17R                                                        
         B     XIT                                                              
         EJECT                                                                  
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 18)                       
         SPACE 1                                                                
         USING LIN18D,R3           R3=A(LINE)                                   
DIS18    DS    0H                                                               
         BRAS  RE,DIS18R                                                        
         B     XIT                                                              
         EJECT                                                                  
*              DISPLAY A DETAIL LINE  (EVENT)                                   
         SPACE 1                                                                
         USING LIN1ED,R3           R3=A(LINE)                                   
DIS1E    DS    0H                                                               
         MVC   L1ENAM,CASTNAME     NAME                                         
         B     XIT                                                              
         DROP  R3                                                               
         EJECT                                                                  
*              ROUTINE TO VALIDATE A DETAIL LINE                                
         SPACE 1                                                                
VALCAST  NTR1                                                                   
         LH    RF,DSPVDTL          RF=A(DISP. TO INDIVIDUAL ROUTINE)            
         LTR   RF,RF                                                            
         BZ    VALX                                                             
         AR    RF,RB                                                            
         LA    RE,VALX             SET RE FOR COMMON NTR1                       
         L     R3,ATHSLINE         R3=A(LINE)                                   
         NTR1                                                                   
         BR    RF                  ** HANDLE INDIVIDUAL SCREEN **               
VALX     B     XIT                                                              
         EJECT                                                                  
*              VALIDATE A DETAIL LINE  (DETAIL SCREEN OVERLAY B5)               
         SPACE 1                                                                
         USING LINB5D,R3           R3=A(LINE)                                   
VALB5    DS    0H                                                               
         MVC   TGCAT,LB5CAT        SAVE CATEGORY IN GLOBAL STORAGE              
         SPACE 1                                                                
         LA    R2,LB5ACDEH                                                      
         CLI   8(R2),C'2'          IF APPLY CODE IS 2                           
         BE    VALB5A                                                           
         CLI   8(R2),C'4'          OR 4                                         
         BNE   VALB5B                                                           
VALB5A   CLI   LB5APPLH+5,0        APPLIED FIELD CANNOT BE EMPTY                
         BE    FLDINV              OR ZERO                                      
         ZIC   R4,LB5APPLH+5                                                    
         GOTO1 CASHVAL,DMCB,LB5APPL,(R4)                                        
         OC    4(4,R1),4(R1)                                                    
         BZ    FLDINV                                                           
         SPACE 1                                                                
VALB5B   TM    LB5ACDEH+4,X'20'    IF APPLIED CODE FIELD                        
         BZ    *+12                                                             
         TM    LB5APPLH+4,X'20'    OR APPLIED CREDITS FIELD CHANGED             
         BO    VB5X                                                             
         LA    R2,LB5PAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
         LA    R2,LB5SPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
VB5X     B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 5D)                      
         SPACE 1                                                                
         USING LIN5DD,R3           R3=A(LINE)                                   
VAL5D    DS    0H                                                               
         MVC   TGCAT,L5DCAT        SAVE CATEGORY IN GLOBAL STORAGE              
         SPACE                                                                  
         TM    L5DICDEH+4,X'20'    IF INCLUDE CODE FIELD                        
         BZ    *+12                                                             
         TM    L5DREIMH+4,X'20'    OR REIMBURSED EXPENSES FIELD CHANGED         
         BO    V5D10                                                            
         LA    R2,L5DPAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
         LA    R2,L5DSPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
         SPACE                                                                  
V5D10    LA    R2,L5DCMNTH                                                      
         TM    4(R2),X'20'         TEST CMNT FLD CHANGED                        
         BO    V5DX                                                             
         OI    1(R2),X'08'         MAKE HIGH INTENSITY                          
         NI    1(R2),X'FB'                                                      
         OI    6(R2),X'80'                                                      
V5DX     B     XIT                                                              
         EJECT                                                                  
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY BF)                      
         SPACE 1                                                                
         USING LINBFD,R3           R3=A(LINE)                                   
         USING TASDD,R4                                                         
VALBF    DS    0H                                                               
         MVC   TGCAT,LBFCAT        SAVE CATEGORY IN GLOBAL STORAGE              
         LA    R4,ELTASD                                                        
         ST    R4,TCATASD                                                       
         XC    TASDEL(TASDLNQ),TASDEL  INITIALIZE SESSION DETAILS EL.           
         MVI   TASDEL,TASDELQ                                                   
         MVI   TASDLEN,TASDLNQ                                                  
         MVC   TASDEQU,TGUSEQU     USE EQUATE                                   
         SPACE 1                                                                
         LA    R2,LBFSPOTH         N'SPOTS                                      
         CLI   5(R2),0                                                          
         BE    VBF4                                                             
         GOTO1 VALINUM                                                          
         MVC   TASDSP,ACTUAL                                                    
         SPACE 1                                                                
VBF4     LA    R2,LBFDAYH          N'DAYS                                       
         CLI   5(R2),0                                                          
         BE    VBF6                                                             
         GOTO1 VALINUM                                                          
         MVC   TASDDAY,ACTUAL                                                   
         SPACE 1                                                                
         USING TACOD,R1                                                         
VBF6     LA    R2,LBFOTH           N'OVERTIME HOURS                             
         CLI   5(R2),0                                                          
         BE    VBF8                                                             
         TM    TGUSSTA3,ADDENUSE   IF ADDENDUM USE                              
         BZ    VBF7                                                             
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'KS'     AND STATE IS KS, SKIP OFF CAM CHECK          
         BE    *+8                                                              
VBF7     CLI   TGUSEQU,UCSS        IF USE IS NOT CSS                            
         BE    *+12                                                             
         CLI   LBFCAM,C'N'         AND IF OFF CAMERA                            
         BE    NOINPUT             INPUT NOT ALLOWED                            
         GOTO1 VALINUM                                                          
         MVC   TASDOT,ACTUAL                                                    
         SPACE 1                                                                
VBF8     LA    R2,LBFDTH           N'DOUBLE-TIME HOURS                          
         CLI   5(R2),0                                                          
         BE    VBF10                                                            
         CLI   TGUSEQU,UCSS        IF USE IS NOT CSS                            
         BE    *+12                                                             
         CLI   LBFCAM,C'N'         AND IF OFF CAMERA                            
         BE    NOINPUT             INPUT NOT ALLOWED                            
         GOTO1 VALINUM                                                          
         MVC   TASDDT,ACTUAL                                                    
         SPACE 1                                                                
VBF10    LA    R2,LBFTRAVH         N'TRAVEL TIME HOURS/MINUTES                  
         CLI   TGUSEQU,UCSS                                                     
         BNE   *+12                CSS DOES NOT ALLOW TRAVEL INPUT              
         CLI   5(R2),0                                                          
         BNE   NOINPUT                                                          
         MVC   FULL,=F'15'         VALID INCREMENTS ARE 15 MINUTES              
         OI    FULL,X'A0'          SET NO 1 HR MINIMUM AND 99 HR MAX            
         BRAS  RE,VALHRMN                                                       
         MVC   TASDTRV,HALF                                                     
         SPACE 1                                                                
         LA    R2,LBFTAGSH         N'TAGS                                       
         CLI   5(R2),0                                                          
         BE    VBF12                                                            
         CLI   TGUSEQU,UCSS                                                     
         BE    NOINPUT             CSS DOES NOT ALLOW TAG INPUT                 
         GOTO1 VALINUM                                                          
         MVC   TASDTAG,ACTUAL                                                   
         SPACE 1                                                                
VBF12    LA    R2,LBFPDWH          N'PRIOR-DAY WARDROBE HOURS/MINUTES           
         CLI   5(R2),0                                                          
         BE    VBF14                                                            
         CLI   LBFCAM,C'N'         IF OFF CAMERA                                
         BE    NOINPUT             INPUT NOT ALLOWED                            
         MVC   FULL,=F'15'         VALID INCREMENTS ARE 15 MINUTES              
         BRAS  RE,VALHRMN                                                       
         MVC   TASDPDW,HALF                                                     
         SPACE 1                                                                
VBF14    GOTO1 FLDVAL,DMCB,(X'40',LBFSPOTH),LBFTAGSH IF EXTRA DETAIL            
         BE    VBFX                                  FIELDS CHANGED             
         LA    R2,LBFPAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
         LA    R2,LBFSPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
VBFX     B     XIT                                                              
         EJECT                                                                  
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY AF)                      
         SPACE 1                                                                
         USING LINAFD,R3           R3=A(LINE)                                   
         USING TASDD,R4                                                         
VALAF    DS    0H                                                               
         MVC   TGCAT,LAFCAT        SAVE CATEGORY IN GLOBAL STORAGE              
         LA    R4,ELTASD                                                        
         ST    R4,TCATASD                                                       
         XC    TASDEL(TASDLNQ),TASDEL  INITIALIZE SESSION DETAILS EL.           
         MVI   TASDEL,TASDELQ                                                   
         MVI   TASDLEN,TASDLNQ                                                  
         MVC   TASDEQU,TGUSEQU     USE EQUATE                                   
         SPACE 1                                                                
         LA    R2,LAFSPOTH         N'SPOTS                                      
         CLI   5(R2),0                                                          
         BE    VAF4                                                             
         GOTO1 VALINUM                                                          
         MVC   TASDMSP,ACTUAL                                                   
         SPACE 1                                                                
VAF4     LA    R2,LAFHMH           HOURS/MINUTES                                
         MVC   FULL,=F'20'         VALID INCREMENTS ARE 20 MINUTES              
*                                                                               
         CLI   TGUSEQU,UIDS                                                     
         BNE   *+10                                                             
         MVC   FULL,=F'1'          ALL MINUTES VALID LESS THAN 60               
*                                                                               
         CLI   TGUSEQU,UIMS                                                     
         BNE   *+14                                                             
         MVC   FULL,=F'15'         INCREMENTS ARE 15 MINUTES                    
         OI    FULL,X'40'          SET 2 HR MINIMUM                             
         BRAS  RE,VALHRMN                                                       
         MVC   TASDMHM,HALF                                                     
         SPACE 1                                                                
         GOTO1 FLDVAL,DMCB,(X'40',LAFSPOTH),LAFAPPLH IF EXTRA DETAIL            
         BE    VAFX                                  FIELD CHANGED              
         LA    R2,LAFPAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
         LA    R2,LAFSPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
VAFX     B     XIT                                                              
         EJECT                                                                  
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 58)                      
         SPACE 1                                                                
         USING LIN58D,R3           R3=A(LINE)                                   
         USING TASDD,R4                                                         
VAL58    DS    0H                                                               
         MVC   TGCAT,L58CAT        SAVE CATEGORY IN GLOBAL STORAGE              
         LA    R4,ELTASD                                                        
         ST    R4,TCATASD                                                       
         XC    TASDEL(TASDLNQ),TASDEL  INITIALIZE SESSION DETAILS EL.           
         MVI   TASDEL,TASDELQ                                                   
         MVI   TASDLEN,TASDLNQ                                                  
         MVC   TASDEQU,TGUSEQU     USE EQUATE                                   
         SPACE 1                                                                
         LA    R2,L58SPOTH         N'SPOTS                                      
         CLI   5(R2),0                                                          
         BE    V584                                                             
         GOTO1 VALINUM                                                          
         MVC   TASDRSP,ACTUAL                                                   
         SPACE 1                                                                
V584     LA    R2,L58HMH           HOURS/MINUTES                                
         MVC   FULL,=F'1'          ANY INCREMENT ALLOWED                        
         BRAS  RE,VALHRMN                                                       
         MVC   TASDRHM,HALF                                                     
         SPACE 1                                                                
         LA    R2,L58TAGSH         N'TAGS                                       
         CLI   5(R2),0                                                          
         BE    V586                                                             
         GOTO1 VALINUM                                                          
         MVC   TASDRTG,ACTUAL                                                   
         SPACE 1                                                                
V586     GOTO1 FLDVAL,DMCB,(X'40',L58SPOTH),L58APPLH IF EXTRA DETAIL            
         BE    V58X                                  FIELD CHANGED              
         LA    R2,L58PAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
         LA    R2,L58SPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
V58X     B     XIT                                                              
         EJECT                                                                  
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 69)                      
         SPACE 1                                                                
         USING LIN69D,R3           R3=A(LINE)                                   
VAL69    DS    0H                                                               
         MVC   TGCAT,L69CAT        SAVE CATEGORY IN GLOBAL STORAGE              
         SPACE                                                                  
*&&UK                                                                           
         TM    L69ICDEH+4,X'20'    IF INCLUDE CODE FIELD                        
         BZ    *+12                                                             
         TM    L69REIMH+4,X'20'    OR REIMBURSED EXPENSES FIELD CHANGED         
         BO    V6910                                                            
         LA    R2,L69PAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
*&&                                                                             
         SPACE                                                                  
V6910    LA    R2,L69EXPDH         VALIDATE EXPIRATION DATE                     
         GOTO1 DTVAL,DMCB,(X'80',OPTEXPD)                                       
         GOTO1 DATCON,DMCB,(1,OPTEXPD),(8,8(R2))  FORMAT AND REDISPLAY          
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 6B)                      
         SPACE 1                                                                
         USING LIN6BD,R3           R3=A(LINE)                                   
VAL6B    DS    0H                                                               
         MVC   TGCAT,L6BCAT        SAVE CATEGORY IN GLOBAL STORAGE              
         SPACE                                                                  
         TM    L6BACDEH+4,X'20'    IF APPLIED CODE FIELD                        
         BZ    *+12                                                             
         TM    L6BAPPLH+4,X'20'    OR APPLIED CREDITS FIELD CHANGED             
         BO    V6BX                                                             
         LA    R2,L6BPAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
         LA    R2,L6BSPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
V6BX     B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE A DETAIL LINE  (DETAIL SCREEN OVERLAY 72)               
         SPACE 1                                                                
         USING LIN72D,R3           R3=A(LINE)                                   
VAL72    DS    0H                                                               
         MVC   TGCAT,L72CAT        SAVE CATEGORY IN GLOBAL STORAGE              
         B     XIT                                                              
*                                                                               
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 16)            *         
*                                                                     *         
***********************************************************************         
         SPACE 2                                                                
         USING LIN16D,R3           R3=A(LINE)                                   
*                                                                               
VAL16    DS    0H                                                               
         BRAS  RE,VAL16R              VALIDATE DETAIL LINE                      
         B     XIT                                                              
*                                                                               
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 17)            *         
*                                                                     *         
***********************************************************************         
         SPACE 2                                                                
         USING LIN17D,R3           R3=A(LINE)                                   
VAL17    DS    0H                                                               
         BRAS  RE,VAL17R              VALIDATE DETAIL LINE                      
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 18)                      
         SPACE 1                                                                
         USING LIN18D,R3           R3=A(LINE)                                   
VAL18    DS    0H                                                               
         BRAS  RE,VAL18R              VALIDATE DETAIL LINE                      
         B     XIT                                                              
         SPACE 3                                                                
*              VALIDATE A DETAIL LINE  (EVENT)                                  
         SPACE 1                                                                
         USING LIN1ED,R3           R3=A(LINE)                                   
VAL1E    DS    0H                                                               
         B     XIT                                                              
         DROP  R3                                                               
         EJECT                                                                  
*              ROUTINES PROCESSED AT END OF INVOICE                             
         SPACE 1                                                                
PROCINV  NTR1                                                                   
         LA    R3,TCTAUHEL         SET R3=A(NEW USAGE HISTORY ELEMENT)          
         SPACE 1                                                                
         LH    RF,DSPBINV          RF=A(DISP. TO INDIV. ROUTINE)                
         AR    RF,RB                                                            
         LA    RE,PINX             SET RE FOR COMMON NTR1                       
PIN      NTR1                                                                   
         BR    RF                  ** PROCESS INDIVIDUAL SCREEN **              
         SPACE 1                                                                
PINX     B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (BE - GENERAL)                           
         SPACE 1                                                                
BINVBE   DS    0H                                                               
         LA    R2,PAYTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (BF - TV SESSION)                        
         SPACE 1                                                                
BINVBF   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,BSSFRSTH+LBFDATA-LINBFD                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            AND CORPORATE GROSS ON NEXT DTL LINE         
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         LA    R2,LBFLNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (BD - DEALER)                            
         SPACE 1                                                                
BINVBD   DS    0H                                                               
         LA    R2,DLRTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (BC - RADIO NETWORK)                     
         SPACE 1                                                                
BINVBC   DS    0H                                                               
         LA    R2,RNTTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (5D - SOAPS)                             
         SPACE 1                                                                
BINV5D   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,SOPDAT1                                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            DISPLAY CORP GROSS ON NEXT DTL LINE          
         LA    R2,L5DLNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TEXPENSE         AND REIMB EXPENSE ON NEXT DTL LINE           
         LA    R2,L5DLNQ(R2)                                                    
         MVC   0(L'LTREIMB,R2),LTREIMB                                          
         LA    R3,L'LTREIMB(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPNH             AND P&H ON NEXT DTL LINE                     
         LA    R2,L5DLNQ(R2)                                                    
         MVC   0(L'LTPNH,R2),LTPNH                                              
         LA    R3,L'LTPNH(R2)                                                   
         BRAS  RE,EDITTOTS                                                      
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (BA - NETWORK / CLASS A)                 
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINVBA   DS    0H                                                               
         LA    R4,ELEMENT          BUILD NETWORK/CLASS A DETAILS EL.            
         XC    ELEMENT,ELEMENT                                                  
         USING TANDD,R4                                                         
         MVI   TANDEL,TANDELQ      ELEMENT CODE                                 
         MVI   TANDLEN,TANDLNQ             LENGTH                               
         SPACE 1                                                                
         LH    R1,TAUHUSN          PREV. TOTAL N'USES PAID                      
         SH    R1,TAUHUSNL         - PREV. N'USES PAID TO LIFT                  
         AHI   R1,1                + 1                                          
         STH   R1,TANDSTUS         = STARTING USE NUMBER FOR MAIN ONLY          
         SPACE 1                                                                
         LH    R1,TCTUSES          TOTAL N'USES PAID                            
         SH    R1,TCTUSESL         - N'USES PAID TO LIFT                        
         STH   R1,TANDUSES         = N'USES PAID TO MAIN                        
         SPACE 1                                                                
         LH    R1,TAUHUSNL         PREV. N'USES PAID TO LIFT                    
         AHI   R1,1                + 1                                          
         STH   R1,TANDSTUL         = STARTING USE NUMBER FOR LIFT               
         SPACE 1                                                                
         MVC   TANDUSEL,TCTUSESL   N'USES PAID TO LIFT                          
         GOTO1 ADDL                ADD ELEMENT TO INVOICE RECORD                
         SPACE 1                                                                
*                                  * NOW UPDATE USAGE HISTORY ELEMENT *         
         LH    R1,TAUHUSN          PREVIOUS N'USES PD TO MAIN COMM'L            
         AH    R1,TCTUSES          + N'USES PAID TO MAIN COMM'L                 
         STH   R1,TAUHUSN          = NEW N'USES PAID TO MAIN COMM'L             
         SPACE 1                                                                
         LH    R1,TAUHUSNL         PREVIOUS N'USES PD TO LIFT                   
         AH    R1,TCTUSESL         + N'USES PAID TO LIFT                        
         STH   R1,TAUHUSNL         = NEW N'USES PAID TO LIFT                    
         SPACE 1                                                                
         LH    R1,TAUHUSNP         PREVIOUS N'PAX USES EXCL FROM CLA            
         TM    PAYSTAT1,CREDIT                                                  
         BO    *+12                                                             
         AH    R1,TCTXUSES         + N'PAX USES EXCLUDED THIS TIME              
         B     *+8                                                              
         SH    R1,TCTXUSES                                                      
         CHI   R1,0                                                             
         BNL   *+6                                                              
         XR    R1,R1                                                            
         STH   R1,TAUHUSNP         = NEW N'PAX USES EXCL FROM CLA               
         SPACE 1                                                                
         LH    R1,TAUHLUSP         PREVIOUS N'PAX LFT USES EX FROM CLA          
         TM    PAYSTAT1,CREDIT                                                  
         BO    *+12                                                             
         AH    R1,TCTXUSEL         + N'PAX LFT USES EXCL THIS TIME              
         B     *+8                                                              
         SH    R1,TCTXUSES                                                      
         CHI   R1,0                                                             
         BNL   *+6                                                              
         XR    R1,R1                                                            
         STH   R1,TAUHLUSP         = NEW N'PAX LFT USES EXCL FROM CLA           
         SPACE 1                                                                
         MVC   LASTINV,DSPLYINV                                                 
         GOTOR DISCLAUH            DISPLAY UPDATED UH ELEM                      
         SPACE 1                                                                
         TM    PAYOPTS3,ONUMUSE    IF NUMBER OF USES OVERRIDDEN                 
         BO    BIBA8               SKIP-DUMMY TCUSETAB & NO USE DETAILS         
         SPACE 1                                                                
         XC    ELEMENT,ELEMENT     SET TO BUILD NETWORK PROGRAM DTLS EL         
         USING TANPD,R4                                                         
         MVI   TANPEL,TANPELQ      ELEMENT CODE                                 
         MVI   TANPLEN,TANPLNQ             LENGTH                               
         SPACE 1                                                                
         USING CLAD,R3                                                          
         LA    R3,CLAFRSTH         LOOP THROUGH USE ENTRIES ON SCREEN           
         LA    R2,TCUSETAB         AND IN USE DATE TABLE                        
         XR    R1,R1               R1=SEQUENCE NUMBER                           
         LA    R0,20               R0=MAX N'ENTRIES ON SCREEN                   
         SPACE 1                                                                
BIBA4    OC    0(3,R2),0(R2)       TEST REACHED END OF USE DATE TABLE           
         BZ    BIBA8                                                            
         CLI   CLADATEH+5,0        IF NO DATE ON SCREEN                         
         BE    BIBA6               BUMP TO NEXT SCREEN ENTRY                    
         STC   R1,TANPSEQ          SET SEQUENCE NUMBER                          
         MVC   TANPDATE,0(R2)      PWOS USE DATE FROM TABLE                     
         MVI   TANPLFT,0                                                        
         TM    3(R2),TCLFTPRO                                                   
         BZ    *+8                                                              
         MVI   TANPLFT,C'Y'        AND LIFT STATUS                              
         MVC   TANPPNME,CLAPROG    PROGRAM NAME FROM SCREEN                     
         MVC   TANPNWK,CLANWK      AND NETWORK                                  
         GOTO1 ADDL                ADD ELEMENT TO INVOICE                       
         SPACE 1                                                                
         LA    R2,4(R2)            BUMP TO NEXT ENTRY IN TABLE                  
         AHI   R1,1                BUMP SEQUENCE NUMBER                         
         SPACE 1                                                                
BIBA6    LA    R3,CLANEXT          BUMP TO NEXT SET OF SCREEN FIELDS            
         BCT   R0,BIBA4                                                         
         SPACE 1                                                                
BIBA8    LA    R2,CLATOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (B9 - CABLE)                             
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINVB9   DS    0H                                                               
         LA    R2,CABTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    XIT                                                              
         MVC   TAUHTYPE,TGUPTOTY   SET NEW UPGRADED TYPE                        
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (B8 - MUSIC)                             
         SPACE 1                                                                
BINVB8   DS    0H                                                               
         LA    R2,MUSTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (76 - MUSIC RATE REUSE)                  
         SPACE 1                                                                
BINV76   DS    0H                                                               
         LA    R2,MRRTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (AF - MUSIC SESSION)                     
         SPACE 1                                                                
BINVAF   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,BSMFRSTH+LAFDATA-LINAFD                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            AND CORPORATE GROSS ON NEXT DTL LINE         
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         LA    R2,LAFLNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (A6 - GUARANTEE)                         
         SPACE 1                                                                
BINVA6   DS    0H                                                               
         LA    R2,GRTTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (58 - RADIO SESSION)                     
         SPACE 1                                                                
BINV58   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,BSRFRSTH+L58DATA-LIN58D                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            AND CORPORATE GROSS ON NEXT DTL LINE         
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         LA    R2,L58LNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (59 - RADIO REGIONAL NETWORK)            
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV59   DS    0H                                                               
         LA    R2,RRNTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         MVC   TAUHRMAJ,TCMAJORS   SET NEW MAJORS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (5C - LOCAL REUSE)                       
         SPACE 1                                                                
BINV5C   DS    0H                                                               
         LA    R2,LOCTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (5E - FOREIGN REUSE)                     
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV5E   DS    0H                                                               
         LA    R2,FGRTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         MVC   TAUHFMAJ,TCMAJORS   SET NEW MAJORS/LOCATIONS                     
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (60 - FIRST MUSIC)                       
         SPACE 1                                                                
BINV60   DS    0H                                                               
         LA    R2,FMUTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (61 - SPANISH WILDSPOT)                  
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV61   DS    0H                                                               
         LA    R2,SWSTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    BINV615                                                          
         MVC   TAUHTYPE,TGUPTOTY   SET NEW UPGRADED TYPE                        
         MVC   TAUHIUNT,TAUHUNT                                                 
         NI    TAUHSTAT,X'FF'-TAUHSFUP                                          
         TM    LCLSTAT3,FORCEUPG   IF FORCED UPGRADE                            
         BZ    *+8                                                              
         OI    TAUHSTAT,TAUHSFUP   SET BIT                                      
         SPACE 1                                                                
         USING TAUPD,R4                                                         
         LA    R4,ELEMENT          BUILD UPGRADE DETAILS ELEMENT                
         XC    ELEMENT,ELEMENT                                                  
         MVI   TAUPEL,TAUPELQ      ELEMENT CODE                                 
         MVI   TAUPLEN,TAUPLNQ             LENGTH                               
         MVC   TAUPIUNT,TAUHIUNT           UNITS                                
         SPACE                                                                  
         GOTO1 ADDL                ADD ELEMENT TO INVOICE RECORD                
         SPACE                                                                  
BINV615  MVC   TAUHUNT,TCUNITS     SET NEW UNITS                                
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (62 - FOREIGN MUSIC)                     
         SPACE 1                                                                
BINV62   DS    0H                                                               
         LA    R2,FGMTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (63 - SPANISH NETWORK/WILDSPOT)          
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV63   DS    0H                                                               
         LA    R2,SNWTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    BINV635                                                          
         MVC   TAUHTYPE,TGUPTOTY   SET NEW UPGRADED TYPE                        
         MVC   TAUHIUNT,TAUHUNT                                                 
         MVI   TAUHSTAT,0          CLEAR STATUS                                 
         TM    LCLSTAT3,FORCEUPG   IF FORCED UPGRADE                            
         BZ    *+8                                                              
         OI    TAUHSTAT,TAUHSFUP   SET BIT                                      
         SPACE                                                                  
         CLI   SNWUPGNH+5,0        SET TYPE OF UPGRADE                          
         BE    *+8                                                              
         OI    TAUHSTAT,TAUHSUPN                                                
         CLI   SNWUPGWH+5,0                                                     
         BE    *+8                                                              
         OI    TAUHSTAT,TAUHSUPW                                                
         CLI   SNWUPGCH+5,0                                                     
         BE    *+8                                                              
         OI    TAUHSTAT,TAUHSUPC                                                
         SPACE 1                                                                
         USING TAUPD,R4                                                         
         LA    R4,ELEMENT          BUILD UPGRADE DETAILS ELEMENT                
         XC    ELEMENT,ELEMENT                                                  
         MVI   TAUPEL,TAUPELQ      ELEMENT CODE                                 
         MVI   TAUPLEN,TAUPLNQ             LENGTH                               
         MVC   TAUPIUNT,TAUHIUNT           UNITS                                
         SPACE                                                                  
         GOTO1 ADDL                ADD ELEMENT TO INVOICE RECORD                
         SPACE                                                                  
BINV635  MVC   TAUHUNT,TCUNITS     SET NEW UNITS                                
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (64 - ADDENDUM SESSION - TV)             
         SPACE 1                                                                
BINV64   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,ADTFRSTH+LBFDATA-LINBFD                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            AND CORPORATE GROSS ON NEXT DTL LINE         
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         LA    R2,LBFLNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         BRAS  RE,SETNWA           SET BITS FOR NORTHWESTERN ADDENDUM           
         B     XIT                                                              
         DROP  R3                                                               
         SPACE 3                                                                
*              INVOICE END PROCESSING  (65 - ADDENDUM SESSION - RADIO)          
         SPACE 1                                                                
BINV65   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,ADOFRSTH+L58DATA-LIN58D                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            AND CORPORATE GROSS ON NEXT DTL LINE         
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         LA    R2,L58LNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         BRAS  RE,SETNWA           SET BITS FOR NORTHWESTERN ADDENDUM           
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (55 - WILDSPOT)                          
*                                      (5F - CBL,SCB,SWS,WSC,LCB)               
*                                      (66 - ADDENDUM WILDSPOT)                 
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINVCOM  DS    0H                                                               
         LA    R2,ADWTOTSH                                                      
         CLI   TGUSEQU,UADW                                                     
         BE    BINVCOMA                                                         
         LA    R2,WSPTOTSH                                                      
         CLI   TGUSEQU,UWSP                                                     
         BE    BINVCOMA                                                         
         LA    R2,CBLTOTSH                                                      
BINVCOMA BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         BRAS  RE,BLDMKTEL         BUILD MARKET ELEMENTS                        
         BRAS  RE,SVUPGINF         SAVE UH ELEMENT UPGRADE INFORMATION          
         BRAS  RE,SVFININF         SAVED FORCED INITIAL PAYMENT INFO            
         BRAS  RE,ADDUPGEL         ADD UPGRADE ELEMENT                          
         BRAS  RE,SVPAIDIN         SAVE UH ELEMENT CURRENT INFORMATION          
         BRAS  RE,SVCREDIT         SAVE UH ELEMENT CREDIT STATUS                
         DROP  R3                                                               
         SPACE 1                                                                
         CLI   TGUSEQU,UADW        IF PAYING ADDENDUM WILDSPOT                  
         BNE   BINVCOMB                                                         
         BRAS  RE,SETNWA           SET BITS FOR NORTHWESTERN ADDENDUM           
         SPACE 1                                                                
BINVCOMB LA    R2,ADWAUNTH                                                      
         CLI   TGUSEQU,UADW                                                     
         BE    BINVCOMC                                                         
         LA    R2,WSPAUNTH                                                      
         CLI   TGUSEQU,UWSP                                                     
         BE    BINVCOMC                                                         
         LA    R2,CBLAUNTH                                                      
BINVCOMC BRAS  RE,SVAUTOIN         SAVE UH ELEMENT AUTOMATIC INFO               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (67 - ADDENDUM COMB SESS/WSP)            
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV67   DS    0H                                                               
         LA    R2,ADCTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         MVC   TAUHUNT,TCUNITS     SET NEW UNITS                                
         BRAS  RE,SETNWA           SET BITS FOR NORTHWESTERN ADDENDUM           
         B     XIT                                                              
         EJECT                                                                  
*&&DO                                                                           
*              INVOICE END PROCESSING  (68 - INSERTS FOR BOOKENDS)              
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV68   DS    0H                                                               
         LA    R2,IFBTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    BINV685                                                          
         MVC   TAUHTYPE,TGUPTOTY   SET NEW UPGRADED TYPE                        
         MVC   TAUHIINS,TAUHINS                                                 
         NI    TAUHSTAT,X'FF'-TAUHSFUP                                          
         TM    LCLSTAT3,FORCEUPG   IF FORCED UPGRADE                            
         BZ    *+8                                                              
         OI    TAUHSTAT,TAUHSFUP   SET BIT                                      
         SPACE 1                                                                
         USING TAUPD,R4                                                         
         LA    R4,ELEMENT          BUILD UPGRADE DETAILS ELEMENT                
         XC    ELEMENT,ELEMENT                                                  
         MVI   TAUPEL,TAUPELQ      ELEMENT CODE                                 
         MVI   TAUPLEN,TAUPLNQ             LENGTH                               
         MVC   TAUPIINS,TAUHIINS           INSERTS                              
         SPACE                                                                  
         GOTO1 ADDL                ADD ELEMENT TO INVOICE RECORD                
         SPACE                                                                  
BINV685  MVC   TAUHINS,TCINSRTS    SET NEW INSERTS                              
         B     XIT                                                              
         SPACE 3                                                                
*&&                                                                             
*              INVOICE END PROCESSING  (69 - PRINT)                             
         SPACE 1                                                                
BINV69   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,PRTFRSTH+L69DATA-LIN69D                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            AND CORPORATE GROSS ON NEXT DTL LINE         
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         LA    R2,L69LNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (6A - TAGS)                              
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV6A   DS    0H                                                               
         LA    R2,TAGTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         MVC   TAUHTAGS,TCTAGS     SET NUMBER OF TAGS                           
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (6B - SOAP RESIDUALS)                    
         SPACE 1                                                                
BINV6B   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,SORDATA                                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            DISPLAY CORP GROSS ON NEXT DTL LINE          
         LA    R2,L6BLNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         SPACE                                                                  
         GOTO1 NAMIN,DMCB,TACMELQ,(X'80',SOREPISH),TACMTYPS                     
*                                  SAVE EPIS INPUT IN COMMENT EL                
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (6C - SOAP RESID.-DIRCTR & WRIT)         
         SPACE 1                                                                
BINV6C   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,SDRDATA                                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            DISPLAY CORP GROSS ON NEXT DTL LINE          
         LA    R2,L6BLNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         SPACE                                                                  
         GOTO1 NAMIN,DMCB,TACMELQ,(X'80',SDREPISH),TACMTYPS                     
*                                  SAVE EPIS INPUT IN COMMENT EL                
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (6D - INDUST. REUSE)                     
         SPACE 1                                                                
BINV6D   DS    0H                                                               
         LA    R2,INRTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (6E - SOAP CABLE REUSE)                  
         SPACE 1                                                                
BINV6E   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,SOCDATA                                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            DISPLAY CORP GROSS ON NEXT DTL LINE          
         LA    R2,L6BLNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         SPACE                                                                  
         GOTO1 NAMIN,DMCB,TACMELQ,(X'80',SOCEPISH),TACMTYPS                     
*                                  SAVE EPIS INPUT IN COMMENT EL                
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (6F - SOAP CABLE-DIRCTR & WRIT)          
         SPACE 1                                                                
BINV6F   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,SDCDATA                                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            DISPLAY CORP GROSS ON NEXT DTL LINE          
         LA    R2,L6BLNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         SPACE                                                                  
         GOTO1 NAMIN,DMCB,TACMELQ,(X'80',SDCEPISH),TACMTYPS                     
*                                  SAVE EPIS INPUT IN COMMENT EL                
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (70 - DEMOS)                             
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV70   DS    0H                                                               
         LA    R2,DEMTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         MVC   TAUHDEMS,TCDEMO     SET NUMBER OF DEMOS                          
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (71 - LOCAL CABLE)                       
         SPACE 1                                                                
BINV71   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS                         
         LA    R3,LCBTOTI+12                                                    
         BRAS  RE,EDITTOTS                                                      
         NI    LCBTOTIH+1,X'F3'    MAKE TOTALS FIELD NORMAL INTENSITY           
         OI    LCBTOTIH+6,X'80'                                                 
         SPACE 1                                                                
         L     R1,TPAYC            DISPLAY CORPORATE GROSS                      
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         LA    R3,LCBTOTC+11                                                    
         BRAS  RE,EDITTOTS                                                      
         NI    LCBTOTCH+1,X'F3'    MAKE TOTALS FIELD NORMAL INTENSITY           
         OI    LCBTOTCH+6,X'80'                                                 
         SPACE                                                                  
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
         LA    R3,TCTAUHEL                                                      
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         BZ    BINV715                                                          
         MVC   TAUHFRTY,TAUHTYPE   SAVE FROM TYPE                               
         MVC   TAUHTYPE,TGUPTOTY   SET NEW UPGRADED TYPE                        
*****    MVC   TAUHILCM,TAUHLCBM   SAVE ORIGINAL MAJORS                         
         NI    TAUHLCST,X'FF'-TAUHLSFU                                          
*                                                                               
         TM    LCLSTAT5,FORCEINI   IF FORCED INTIAL PAYMENT                     
         BZ    *+12                                                             
         OI    TAUHSTAT,TAUHLSFI   SET BIT                                      
         B     BINV711                                                          
*                                                                               
         TM    LCLSTAT3,FORCEUPG   IF FORCED UPGRADE                            
         BZ    BINV711                                                          
         OI    TAUHLCST,TAUHLSFU   SET BIT                                      
*                                                                               
BINV711  TM    TCPAYST,TCMILFR     IF ADDING 1MIL RATE TO FROM RATE             
         BZ    *+8                                                              
         OI    TAUHLCST,TAUHFMIL   SET BIT                                      
*                                                                               
         USING TAUPD,R4                                                         
         LA    R4,ELEMENT          BUILD UPGRADE DETAILS ELEMENT                
         XC    ELEMENT,ELEMENT                                                  
         MVI   TAUPEL,TAUPELQ      ELEMENT CODE                                 
         MVI   TAUPLEN,TAUPLNQ             LENGTH                               
*****    MVC   TAUPILCM,TAUHILCM   INITIAL MAJORS                               
         SPACE                                                                  
         GOTO1 ADDL                ADD ELEMENT TO INVOICE RECORD                
         SPACE                                                                  
*                                                                               
**NV715  MVC   TAUHLCBM,TCMAJORS   SET NEW MAJORS                               
BINV715  TM    TCPAYST,TCMIL       IF ADDING 1MIL RATE                          
         BZ    XIT                                                              
         OI    TAUHLCST,TAUHTMIL   SET BIT                                      
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (72 - P&H ONLY)                          
         SPACE 1                                                                
BINV72   DS    0H                                                               
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         LA    R2,PNHFRSTH+L72DATA-LIN72D                                       
         MVC   0(L'LTINDIV,R2),LTINDIV                                          
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         L     R1,TPAYC            AND CORPORATE GROSS ON NEXT DTL LINE         
         LA    R2,L72LNQ(R2)                                                    
         MVC   0(L'LTCORP,R2),LTCORP                                            
         LA    R3,L'LTCORP(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
         B     XIT                                                              
         SPACE 3                                                                
*&&DO                                                                           
*              INVOICE END PROCESSING  (73 - VAR)                               
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV73   DS    0H                                                               
         LA    R2,VARTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         MVC   TAUHINS,TCINSRTS    SET NUMBER OF VAR/INS                        
         B     XIT                                                              
         SPACE 3                                                                
*              INVOICE END PROCESSING  (74 - VNW)                               
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV74   DS    0H                                                               
         LA    R2,VNWTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE                                                                  
         MVC   TAUHINS,TCINSRTS    SET NUMBER OF VAR/INS                        
         B     XIT                                                              
         SPACE 3                                                                
*&&                                                                             
*              INVOICE END PROCESSING  (76 - NBM)                               
         SPACE 1                                                                
BINV75   DS    0H                                                               
         LA    R2,NBMTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
*              INVOICE END PROCESSING  (77 - ITN)                               
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV77   DS    0H                                                               
         LA    R2,ITNTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         SPACE 1                                                                
         TM    TCPAYST,TCITNMAN    IF USES ENTERED MANUALLY                     
         BZ    XIT                                                              
         LH    RE,TCUNITS          SAVE LAST USE                                
         AHI   RE,1                                                             
         STH   RE,TAUHIFUS                                                      
         MVC   TAUHINUS,TCTUSES    AND # OF USES                                
         XC    ELEMENT,ELEMENT                                                  
         MVC   ELEMENT,TCTAUHEL    IN USAGE HISTORY ELEMENT                     
         GOTO1 ADDL                                                             
         SPACE 1                                                                
         XC    TCUNITS,TCUNITS                                                  
         XC    TCTUSES,TCTUSES                                                  
         NI    TCPAYST,X'FF'-TCITNMAN                                           
         B     XIT                                                              
*              INVOICE END PROCESSING  (79 - SPANISH FOREIGN REUSE)             
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
BINV79   DS    0H                                                               
         LA    R2,SFRTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
*                                                                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (78 - HOLDING FEE)                       
         SPACE 1                                                                
BINV78   DS    0H                                                               
         LA    R2,HLDTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (81 - INTERNET/NEW MEDIA)                
         SPACE 1                                                                
BINV81   DS    0H                                                               
         LA    R2,IRNTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (82 - MOVE TO NEW MEDIA)                 
         SPACE 1                                                                
BINV82   DS    0H                                                               
         LA    R2,MOVTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (83 - LIFT)                              
         SPACE 1                                                                
BINV83   DS    0H                                                               
         LA    R2,LFTTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (84 - RADIO GUARANTEE)                   
         SPACE 1                                                                
BINV84   DS    0H                                                               
         LA    R2,GRRTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         DROP  R4                                                               
         EJECT                                                                  
*              INVOICE END PROCESSING  (85 - GUARANTEE)                         
         SPACE 1                                                                
BINV85   DS    0H                                                               
         LA    R2,GT2TOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (86 - CANADIAN NEWMEDIA)                 
         SPACE 1                                                                
BINV86   DS    0H                                                               
         LA    R2,CNMTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         MVC   TAUHUNT,TCUNITS     SET NEW UNITS                                
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (16 - INDUSTRIAL RETAKE SESSION)         
         SPACE 1                                                                
BINV16   DS    0H                                                               
         GOTOR BINVISES,DMCB,L16LNQ,RTKFRSTH+L16DATA-LIN16D                     
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (17 - INDUSTRIAL AUDIO SESSION)          
         SPACE 1                                                                
BINV17   DS    0H                                                               
         GOTOR BINVISES,DMCB,L17LNQ,DIOFRSTH+L17DATA-LIN17D                     
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (18 - INTERACTIVE VOICE SESSION)         
         SPACE 1                                                                
BINV18   DS    0H                                                               
         GOTOR BINVISES,DMCB,L18LNQ,IVRFRSTH+L18DATA-LIN18D                     
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (19 - STORECASTING)                      
         SPACE 1                                                                
BINV19   DS    0H                                                               
         LA    R2,STRTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (7A - INDUSTRIAL SUPPLEMENTAL)           
         SPACE 1                                                                
BINV7A   DS    0H                                                               
         LA    R2,ISUTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
                                                                                
         USING TAIDD,R4                                                         
         LA    R4,ELEMENT                                                       
         XC    ELEMENT,ELEMENT     BUILD INDUSTRIAL SUPPLEMENTAL                
         MVI   TAIDEL,TAIDELQ      DETAILS ELEMENT                              
         MVI   TAIDLEN,TAIDLNQ                                                  
         MVC   TAIDTY1,ISUTYPE1                                                 
         MVC   TAIDTY2,ISUTYPE2                                                 
         GOTO1 ADDL                                                             
         B     XIT                                                              
         DROP  R4                                                               
         EJECT                                                                  
*              INVOICE END PROCESSING  (1A - INM AND NIM)                       
         SPACE 1                                                                
BINV1A   DS    0H                                                               
         LA    R2,MVMTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (1B - IN HOME MUSIC)                     
         SPACE 1                                                                
BINV1B   DS    0H                                                               
         LA    R2,IHMTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (1D - INTERNET/NEW MEDIA)                
         SPACE 1                                                                
BINV1D   DS    0H                                                               
         LA    R2,INUTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (1E - EVENT)                             
         SPACE 1                                                                
BINV1E   DS    0H                                                               
         BRAS  RE,BINV1EX                                                       
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (1F - VRE/VNR)                           
         SPACE 1                                                                
BINV1F   DS    0H                                                               
         LA    R2,VRETOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (20 - EQUITY)                            
         SPACE 1                                                                
BINV20   DS    0H                                                               
         LA    R2,EQYTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (21 - MUSIC BUYOUT)                      
         SPACE 1                                                                
BINV21   DS    0H                                                               
         LA    R2,MBOTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         B     XIT                                                              
         EJECT                                                                  
*              INVOICE END PROCESSING  (22 - NEWMEDIA CANADA)                   
         SPACE 1                                                                
BINV22   DS    0H                                                               
         LA    R2,NMCTOTSH                                                      
         BRAS  RE,DISTOTS          DISPLAY TOTALS                               
         MVC   TAUHUNT,TCUNITS     SET NEW UNITS                                
         B     XIT                                                              
         EJECT                                                                  
*              ERRORS, ETC.                                                     
         SPACE 1                                                                
FLDINV   MVI   ERROR,INVALID       INVALID INPUT FIELD                          
         J     THEEND                                                           
         SPACE 1                                                                
FLDMISS  MVI   ERROR,MISSING       MISSING INPUT FIELD                          
         J     THEEND                                                           
         SPACE 1                                                                
AMTINV   MVI   ERROR,ERINVAMT      INVALID AMOUNT                               
         J     THEEND                                                           
         SPACE 1                                                                
RECNTFD  MVI   ERROR,NOTFOUND      RECORD NOT FOUND                             
         J     THEEND                                                           
         SPACE 1                                                                
NOTIFDFT MVI   ERROR,ERNOTDFT                                                   
         J     THEEND                                                           
         SPACE 1                                                                
INCOMPT  MVI   ERROR,ERCOMPT       INCOMPATIBLE INPUT                           
         J     THEEND                                                           
         SPACE 1                                                                
TOOBIG   MVI   ERROR,ERTOOBIG      PAYMENT TOO BIG                              
         J     THEEND                                                           
         SPACE 1                                                                
DATEINV  MVI   ERROR,INVDATE       INVALID DATE                                 
         J     THEEND                                                           
         SPACE 1                                                                
CHOICERR MVI   ERROR,ERGT1SEL      CANNOT SELECT MORE THAN ONE TYPE             
         J     THEEND                                                           
         SPACE 1                                                                
NOCHOICE MVI   ERROR,ERNOSEL       NO SELECTION MADE                            
         J     THEEND                                                           
         SPACE 1                                                                
ADDENERR MVI   ERROR,ERADDTYP      INVAL USE TYPE FOR THIS ADDEN STATE          
         LA    R2,LCBCIDH                                                       
         J     THEEND                                                           
         SPACE 1                                                                
MEDERR   MVI   ERROR,ERUSEMED      INVALID USE TYPE FOR THIS MEDIA              
         J     THEEND                                                           
         SPACE 1                                                                
*V26ERR   MVI   ERROR,ERRVR26K       INVALID INPUT FIELD                        
V26ERR   MVC   MYMSGNO,=Y(ERRVR26K) DATE ENTERED ON CREDIT PAYMENT              
         J     NTHEEND                                                          
         SPACE 1                                                                
NUMINV   MVI   ERROR,NOTNUM        NOT VALID NUMERIC DATA                       
         J     THEEND                                                           
         SPACE 1                                                                
NEEDUNIT MVI   ERROR,ERNEEDUN      AT LEAST ONE UNIT REQUIRED                   
         J     THEEND                                                           
         SPACE 1                                                                
NEEDINS  MVI   ERROR,ERNEEDIN      AT LEAST ONE INSERT REQUIRED                 
         J     THEEND                                                           
         SPACE 1                                                                
NOPREV   MVI   ERROR,ERNOPREV      NO PREVIOUS PAYMENT TO UPGRADE               
         J     THEEND                                                           
         SPACE 1                                                                
NOTUPG   MVI   ERROR,ERNOTUPG      THIS IS NOT AN UPGRADE                       
         J     THEEND                                                           
         SPACE 1                                                                
NOINPUT  MVI   ERROR,ERNOINP       INPUT NOT ALLOWED                            
         J     THEEND                                                           
         SPACE 1                                                                
FLDTWC   MVC   MYMSGNO,=Y(ERDTTWCE) DATE ENTERED TWICE                          
         J     NTHEEND                                                          
         SPACE 1                                                                
FLDDTCR  MVC   MYMSGNO,=Y(ERDTCRED) DATE ENTERED ON CREDIT PAYMENT              
         J     NTHEEND                                                          
         SPACE 1                                                                
ERNOCBL  LA    R2,CBLUNITH                                                      
         MVC   MYMSGNO,=Y(ERRNOCBL) PAYMENT MUST BE MADE AS LCB                 
         J     NTHEEND                                                          
         SPACE 1                                                                
NODUBD   MVC   MYMSGNO,=Y(ERCMDUBD) COMMERCIAL MISSING DUB DATE                 
         J     NTHEEND                                                          
         SPACE 1                                                                
BMKTNFND MVC   MYMSGNO,=Y(ERCNNTFD) NETWORK/SYSTEM NOT FOUND                    
         TM    TGUSSTA3,CBLUSE                                                  
         JNZ   NTHEEND                                                          
         MVC   MYMSGNO,=Y(ERCSNTFD) SYSTEM NOT FOUND                            
         CLI   TGUSEQU,ULCB                                                     
         JE    NTHEEND                                                          
         MVC   MYMSGNO,=Y(ERMKNTFD) MARKET NOT FOUND                            
         J     NTHEEND                                                          
         SPACE 1                                                                
CYCINV   MVC   MYMSGNO,=Y(ERONPREV)  MKT/CNET/CSYS ON PREVIOUS INVOICE          
         J     CINVEND                                                          
         SPACE 1                                                                
CCYCINV  MVC   MYMSGNO,=Y(ERNONPRE)  MKT/CNET/CSYS NOT ON PREV INVOICE          
         J     CINVEND                                                          
         SPACE 1                                                                
CINVEND  LH    RE,DSPCYC                                                        
         AR    RE,RA                                                            
         NI    4(RE),X'FF'-X'20'                                                
         J     NTHEEND                                                          
         SPACE 1                                                                
PNH20ERR MVC   MYMSGNO,=Y(ERMUS518) SUBJ P&H ERROR                              
         J     NTHEEND                                                          
         SPACE 1                                                                
GCONERR2 MVC   MYMSGNO,=Y(ERMUS517)  GUARANTEE CONTRACTS DON'T MATCH            
         J     NTHEEND                                                          
         SPACE 1                                                                
GCONERR3 MVC   MYMSGNO,=Y(ERMUS520)  PAYMENT CYCLE OUTSIDE OF GCON TERM         
         J     NTHEEND                                                          
         SPACE 1                                                                
NTHEEND  MVI   BLOCK,0              NEW THEEND FOR TWO BYTE ERROR MSGS          
         MVI   MYMTYP,GTMERR                                                    
         SPACE 1                                                                
INFEND   OI    GENSTAT2,USGETTXT                                                
THEEND   GOTO1 EXIT,DMCB,0                                                      
         EJECT                                                                  
*              CONSTANTS, ETC.                                                  
         SPACE 1                                                                
LTINDIV  DC    C'Indiv Gross='                                                  
LTCORP   DC    C'Corp Gross='                                                   
LTREIMB  DC    C'Reimb Exp='                                                    
LTPNH    DC    C'P&&H='                                                         
         SPACE 1                                                                
         LTORG                                                                  
         DROP  R7,R6               DROP SECONDARY BASE REGISTERS                
         EJECT                                                                  
*              ROUTINE TO RETURN GCON VALUES                                    
*                                                                               
GETGCON  NTR1  BASE=*,LABEL=*                                                   
         USING TLGCD,R3            GET GCON RECORD                              
         LA    R3,KEY                                                           
         XC    TLGCKEY,TLGCKEY                                                  
         MVI   TLGCCD,TLGCCDQ                                                   
         MVC   TLGCSSN,TGSSN                                                    
         MVC   TLGCGCNT,TGGCNT                                                  
         GOTO1 HIGH                                                             
         CLC   KEY(L'TLGCKEY),KEYSAVE                                           
         JNE   FLDINV                                                           
         SPACE                                                                  
         MVC   AIO,AIO2                                                         
         GOTO1 GETREC                                                           
         MVC   AIO,AIO1                                                         
         SPACE                                                                  
         L     R4,AIO2                                                          
         USING TAGDD,R4                                                         
         MVI   ELCODE,TAGDELQ      TEST CYCLE FALLS WITHIN GCON TERM            
         BRAS  RE,GETEL                                                         
         JE    *+6                                                              
         DC    H'0'                                                             
         SPACE                                                                  
         MVC   FULL(L'TCPCYCS),TCPCYCS    USE CYCLE START                       
         TM    PAYOPTS4,OAGRTEND          UNLESS G=E OPTION USED                
         JZ    *+10                                                             
         MVC   FULL(L'TCPCYCE),TCPCYCE    THEN USE CYCLE END                    
         CLC   FULL(L'TAGDSTRT),TAGDSTRT  CYCLE START < TERM START?             
         JL    GCONERR3                                                         
         CLC   FULL(L'TAGDEND),TAGDEND    > TERM END?                           
         JH    GCONERR3                                                         
         SPACE                                                                  
         L     R4,AIO2                                                          
         USING TAGCD,R4                                                         
         MVI   ELCODE,TAGCELQ      FIND CONTRACT YEAR P&H LIMIT AND             
         BRAS  RE,GETEL            BALANCE                                      
         J     *+8                                                              
GETGCON2 BRAS  RE,NEXTEL                                                        
         JNE   FLDINV                                                           
         SPACE                                                                  
         MVC   FULL(L'TCPCYCS),TCPCYCS    USE CYCLE START                       
         TM    PAYOPTS4,OAGRTEND          UNLESS G=E OPTION USED                
         JZ    *+10                                                             
         MVC   FULL(L'TCPCYCE),TCPCYCE    THEN USE CYCLE END                    
         SPACE                                                                  
         CLC   FULL(L'TAGCEND),TAGCEND   CYCLE DATE > CONT. YEAR END            
         JH    GETGCON2                                                         
         SPACE                                                                  
         MVC   GUARCONT,TGGCNT     GUARANTEE CONTRACT CODE                      
         MVC   GCCYEAR,TAGCPD      CONTRACT YEAR                                
         MVC   GCLIM,TAGCAMT       P&H LIMIT                                    
         MVC   GCBAL,TAGCBAL       BALANCE                                      
         J     XIT                                                              
         EJECT                                                                  
*              ROUTINE SAVES FORCED INITIAL PAYMENT INFORMATION                 
         SPACE 1                                                                
         USING TAUHD,R3                                                         
SVFININF NTR1  BASE=*,LABEL=*                                                   
         TM    LCLSTAT5,FORCEINI   TEST FOR FORCED INTIAL                       
         JZ    XIT                                                              
         SPACE 1                                                                
         LA    R1,TAUHLCST         R1=A(FORCED UPGRADE STATUS FIELD)            
         CLI   TGUSEQU,ULCB        FOR LOCAL CABLE                              
         JE    SFII10                                                           
         LA    R1,TAUHCSTA                                                      
         TM    TGUSSTA3,CBLUSE     FOR CABLE                                    
         JNZ   SFII10                                                           
         LA    R1,TAUHSTAT         FOR WILDSPOT                                 
         SPACE 1                                                                
SFII10   OI    0(R1),TAUHSFIN      SET FORCED INITIAL BIT                       
         J     XIT                                                              
         DROP  R3                                                               
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE ADDS UPGRADE ELEMENT TO INVOICE RECORD                   
         SPACE 1                                                                
         USING TAUHD,R3                                                         
ADDUPGEL NTR1  BASE=*,LABEL=*                                                   
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         JZ    XIT                                                              
         SPACE 1                                                                
         USING TAUPD,R4                                                         
         LA    R4,ELEMENT          BUILD BASICS FOR UPGRADE                     
         XC    ELEMENT,ELEMENT     DETAILS ELEMENT                              
         MVI   TAUPEL,TAUPELQ                                                   
         MVI   TAUPLEN,TAUPLNQ                                                  
         SPACE 1                                                                
         LA    RE,TAUPICBU         RE=A(INITIAL UNITS/SUBSCIBERS                
         LHI   R1,L'TAUPICBU            FIELD)                                  
         LA    RF,TAUHCBUN         R1=L'INITIAL UNITS/SUBSCRIBERS               
         TM    TGUSSTA3,CBLUSE          FIELD)                                  
         JNZ   AUE10               RF=A(INITIAL UNITS/SUBSCRIBERS               
         LA    RE,TAUPISUB              FIELD FROM USAGE HISTORY)               
         LHI   R1,L'TAUPISUB                                                    
         LA    RF,TAUHISUB                                                      
         CLI   TGUSEQU,ULCB                                                     
         JE    AUE10                                                            
         LA    RE,TAUPIUNT                                                      
         LHI   R1,L'TAUPIUNT                                                    
         LA    RF,TAUHUNT                                                       
         SPACE 1                                                                
AUE10    BCTR  R1,0                MOVE INTITIAL UNITS/SUBSCRIBERS              
         EX    R1,*+8              FROM USAGE HISTORY INTO UPGRADE              
         B     *+10                ELEMENT                                      
         MVC   0(0,RE),0(RF)                                                    
         SPACE 1                                                                
         CLI   TGUSEQU,UWSP        IF PAYING WILDSPOT                           
         JNE   AUE20                                                            
         MVC   TAUPIMAJ,TAUHIMAJ   SAVE INITIAL MAJORS TOO                      
         SPACE 1                                                                
AUE20    GOTO1 ADDL                ADD UPRADE ELEMENT                           
         DROP  R4                                                               
         J     XIT                                                              
         DROP  R3                                                               
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE SAVES CURRENT PAYMENT'S PAID UNITS,SUBSCRIBERS           
*              AND MAJORS INTO USAGE HISTORY ELEMENT                            
                                                                                
         USING TAUHD,R3                                                         
SVPAIDIN NTR1  BASE=*,LABEL=*                                                   
         CLI   TGUSEQU,ULCB                                                     
         JE    SPI30                                                            
                                                                                
         LA    R1,TAUHCBUN       R1=A(CURRENT UNITS FIELD)                      
         TM    TGUSSTA3,CBLUSE                                                  
         JNZ   SPI10                                                            
         LA    R1,TAUHUNT                                                       
SPI10    MVC   0(L'TAUHCBUN,R1),TCUNITS  SAVE CURRENT UNITS                     
                                                                                
SPI20    CLI   TGUSEQU,UWSP      IF WILDSPOT PAYMENT                            
         JNE   XIT                                                              
         MVC   TAUHMAJ,TCMAJORS  SAVE CURRENT MAJORS                            
         J     XIT                                                              
                                                                                
SPI30    ZICM  RF,TCSUBS,4                                                      
         CLI   VERSION,0                                                        
         JE    SPI40                                                            
         TM    PAYSTAT1,OVERMKTS                                                
         JZ    SPI40                                                            
         A     RF,TAUHISUB                                                      
SPI40    STCM  RF,15,TAUHSUBS                                                   
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE CHECKS TO SEE IF CNET/MKT/CSYS IS ON FILE                
         SPACE 1                                                                
ONFILE   NTR1  BASE=*,LABEL=*                                                   
         LHI   RF,TLMTCDQ                                                       
         BRAS  RE,USEALPH                                                       
         JNE   *+8                                                              
         LHI   RF,TLMTALDQ                                                      
         GOTO1 RECVAL,DMCB,(RF),(X'24',(R2))                                    
         J     XIT                                                              
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO SET UP USAGE HISTORY READ IF A PREVIOUS               
*              AGENCY/COMMERCIAL EXISTS                                         
         SPACE 1                                                                
         USING TLUHPD,R4                                                        
         USING MKTTABLD,R3                                                      
RDPREVUH NTR1  BASE=*,LABEL=*                                                   
         CLI   TGBYTE,UHPRE      EXIT IF PREVIOUS AGENCY/COMMERCIAL             
         JE    NO                ALREADY SEARCHED                               
         SPACE 1                                                                
         MVI   TGBYTE,UHPRE      SET PREVIOUS AGY/COM READ                      
         SPACE 1                                                                
         OC    ELTAOC,ELTAOC     EXIT IF PREVIOUS AGENCY/COMMERCIAL             
         JZ    NO                DOES NOT EXIST                                 
         SPACE 1                                                                
         USING TAOCD,RE                                                         
         LA    RE,ELTAOC         SET UP USAGE HISTORY KEY                       
         TM    TAOCSTAT,TAOCSFRO                                                
         JZ    NO                                                               
         XC    KEY,KEY                                                          
         MVI   TLUHPCD,TLUHMTDQ                                                 
         MVC   TLUHMINM,TGMTINTC                                                
         MVC   TLUHMCOM,TAOCCOM                                                 
         J     YES                                                              
         DROP  RE,R3,R4                                                         
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO SAVE OFF CYCLE INFORMATION                            
*              ON EXIT ... WORK    = CYCLE START DATE                           
*                          WORK+8  = CYCLE END DATE                             
*                          WORK+16 = MAX CYCLE END DATE                         
SVCYCLE  NTR1  BASE=*,LABEL=*                                                   
         XC    WORK,WORK                                                        
         SPACE 1                                                                
         LH    R2,DSPCYC         SAVE CYCLE LENGTH                              
         AR    R2,RA                                                            
         LA    R3,BLOCK                                                         
         GOTO1 PDVAL,DMCB,(R3)                                                  
         SPACE 1                                                                
         GOTO1 DATCON,DMCB,(1,TCPCYCS),WORK                                     
         GOTO1 (RF),(R1),(1,TCPCYCE),WORK+8                                     
         MVC   WORK+16(L'TCPCYCE),TCPCYCE                                       
         SPACE 1                                                                
         LHI   R4,28             IF CYCLE LENGTH IS 13 WEEKS                    
         CLI   TGUSWKS,13        ADD 4 WEEKS TO IT                              
         BE    SCYCLE10                                                         
         LHI   R4,14             IF CYCLE LENGTH IS 8 WEEKS                     
         CLI   TGUSWKS,8         ADD 2 WEEKS TO IT                              
         JNE   XIT                                                              
         SPACE 1                                                                
SCYCLE10 GOTO1 DATCON,DMCB,(1,TCPCYCE),(0,TGDUB)                                
         GOTO1 ADDAY,DMCB,TGDUB,WORK+16,(R4)                                    
         GOTO1 DATCON,DMCB,(0,WORK+16),(1,WORK+24)                              
         SPACE 1                                                                
         TM    TGUSTYST,UPGRADE  IF MAKING AN UPGRADE PAYMENT                   
         JZ    XIT                                                              
         CLI   VERSION,0         TO A VERSION                                   
         JE    XIT                                                              
         MVC   WORK+8(8),WORK+16 USE LAG END DATE AS CYCLE END                  
         J     XIT                                                              
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE ENSURES THAT ALL EXISTING DATES FIT WITHIN               
*              THE NEWLY DEFINED CYCLE                                          
         SPACE 1                                                                
CHKUHDTS NTR1  BASE=*,LABEL=*                                                   
         USING TLUHD,R4                                                         
         LA    R4,KEY                                                           
         XC    KEY,KEY                                                          
         MVI   TLUHCD,TLUHCDQ                                                   
         MVC   TLUHCOM,TGCOM                                                    
         GOTO1 HIGH              READ ALL EXISTING HISTORY ...                  
         B     CUHD20                                                           
CUHD10   GOTO1 SEQ                                                              
         LA    R4,KEY                                                           
         SPACE 1                                                                
CUHD20   CLC   KEY(TLUHCSEQ-TLUHD),KEYSAVE                                      
         JNE   YES                                                              
         SPACE 1                                                                
         CLI   TGBYTE,C'U'                                                      
         BE    CUHD30                                                           
         OC    TLUHCSEQ,TLUHCSEQ                                                
         BNZ   CUHD10                                                           
         SPACE 1                                                                
CUHD30   CLC   TLUHUSE,TGUSCDE   ... FOR THIS USE ...                           
         BE    CUHD40                                                           
         TM    TGUSSTA3,CBLUSE                                                  
         BZ    CUHD10                                                           
         CLC   TLUHUSE,=C'LCB'                                                  
         BNE   CUHD10                                                           
         DROP  R4                                                               
         SPACE 1                                                                
CUHD40   CLI   TGBYTE,C'U'                                                      
         BNE   *+8                                                              
         MVI   RDUPDATE,C'Y'                                                    
         GOTO1 GETREC                                                           
         SPACE 1                                                                
         CLI   TGBYTE,C'U'                                                      
         BNE   CUHD50                                                           
         L     RF,AIO2                                                          
         GOTO1 SAVPTRS,DMCB,(RF)                                                
         SPACE 1                                                                
         USING TAUHD,R4                                                         
CUHD50   L     R4,AIO                                                           
         MVI   ELCODE,TAUHELQ                                                   
         BRAS  RE,GETEL                                                         
         BE    *+6                                                              
         DC    H'00'                                                            
         CLC   TAUHEND,WORK      ... WITH A COMM'L CYCLE END THAT               
         BNE   CUHD10            MATCHES THE OVERLAPPED CYCLE END               
         MVC   TAUHSTRT(6),TCPCYCS                                              
         DROP  R4                                                               
         SPACE 1                                                                
         CLI   TGBYTE,C'U'                                                      
         BE    CUHD70                                                           
         SPACE 1                                                                
         USING TAMTD,R4                                                         
         L     R4,AIO                                                           
         MVI   ELCODE,TAMTELQ    AND ENSURE THAT ALL CNET/MKT/CSYS              
         BRAS  RE,GETEL          DATES FIT WITHIN THIS NEW CYCLE                
         B     *+8                                                              
CUHD60   BRAS  RE,NEXTEL                                                        
         BNE   CUHD10                                                           
         CLC   TAMTCYCS,TCPCYCE                                                 
         BNH   CUHD60                                                           
         J     NO                                                               
         DROP  R4                                                               
         SPACE 1                                                                
CUHD70   GOTO1 PUTREC                                                           
         SPACE 1                                                                
         MVC   SVCASTKY,KEY                                                     
         SPACE 1                                                                
         USING TMPPAYD,R1                                                       
         L     R1,ATMPPAYD                                                      
         L     RF,AIO2                                                          
         GOTO1 ADDPTRS,DMCB,(X'08',(RF)),UHMTPTRS                               
         MVI   TGBYTE,C'U'                                                      
         SPACE 1                                                                
         XC    KEY,KEY                                                          
         MVC   KEY(L'SVCASTKY),SVCASTKY                                         
         GOTO1 HIGH                                                             
         B     CUHD10                                                           
         DROP  R1                                                               
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO PROMPT USER FOR PF KEY VALIDATION TO GO               
*              UPDATE CYCLE HISTORY                                             
         SPACE                                                                  
CYUPPFK  NTR1  BASE=*,LABEL=*                                                   
         MVI   MYMTYP,GTMINF     GIVE "EXISTING CYCLE OVERLAPS" MESSAGE         
         MVI   BLOCK,0           AND PROMPT FOR PF KEY OVERRIDE                 
         OI    GENSTAT2,USGETTXT                                                
         OI    CYCSTAT,CYSTUPCY                                                 
         MVC   MYMSGNO,=H'264'                                                  
         TM    TGUSSTA3,CBLUSE                                                  
         JO    THEEND                                                           
         MVC   MYMSGNO,=H'266'                                                  
         CLI   TGUSEQU,ULCB                                                     
         JE    THEEND                                                           
         MVC   MYMSGNO,=H'267'                                                  
         J     THEEND                                                           
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO RETURN "CYCLE HISTORY HAS BEEN UPDATED"               
*              MESSAGE                                                          
         SPACE                                                                  
CYUPMSG  NTR1  BASE=*,LABEL=*                                                   
         CLI   VERSION,0         IF PAYING A NON-VERSION                        
         BNE   CUP30                                                            
         TM    LCLSTAT5,FORCEINI OR FORCING AN INITIAL PAYMENT                  
         BO    CUP30             SKIP AHEAD                                     
         SPACE 1                                                                
         CLI   TGUSEQU,UWSP                                                     
         BNE   CUP20             CLEAR OUT MAJOR CHECKOFF FIELD                 
         LA    RF,WSPNYH                                                        
         CLC   8(2,R2),=C'NY'                                                   
         BE    CUP10                                                            
         LA    RF,WSPLAH                                                        
         CLC   8(2,R2),=C'LA'                                                   
         BE    CUP10                                                            
         LA    RF,WSPCHIH                                                       
         CLC   8(3,R2),=C'CHI'                                                  
         BNE   CUP20                                                            
CUP10    MVI   8(RF),0                                                          
         MVI   5(RF),0                                                          
         OI    6(RF),X'80'                                                      
         SPACE 1                                                                
CUP20    L     RF,TGDUB          CLEAR THE DATE AND CNET/MKT/CSYS               
         GOTO1 FLDVAL,DMCB,(3,0(RF)),(X'80',0(R2))                              
         SPACE 1                                                                
CUP30    L     R2,TGDUB                                                         
         MVI   MYMTYP,GTMINF     GIVE "CYCLE HISTORY HAS BEEN UPDATED"          
         MVC   MYMSGNO,=H'263'   MESSAGE                                        
         MVI   BLOCK,0                                                          
         OI    GENSTAT2,USGETTXT                                                
         J     THEEND                                                           
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO TEST THAT MAJORS INPUT IS IN SYNC WITH                
*              MARKET FIELD INPUT                                               
         SPACE 1                                                                
SYNCMAJ  NTR1  BASE=*,LABEL=*                                                   
         LA    R3,WSPFRSTH         R3=A(FIRST MARKET FIELD)                     
         SPACE 1                                                                
         ZIC   RE,0(R3)                                                         
         AR    RE,R3                                                            
         TM    1(RE),X'20'         IF MARKET FIELDS ARE PROTECTED               
         JO    XIT                 SKIP THIS ROUTINE                            
         SPACE 1                                                                
         LA    R4,WSPLSTH          R4=A(LAST MARKET HEADER FIELD)               
         SPACE 1                                                                
         LR    R2,R3                                                            
SMAJ10   CR    R2,R4               SEE IF NY ENTERED IN MKT FIELDS              
         BH    SMAJ30                                                           
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         CLC   8(2,R2),=C'NY'                                                   
         BE    SMAJ20                                                           
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         B     SMAJ10                                                           
         SPACE 1                                                                
SMAJ20   BAS   RE,NYCHK                                                         
         BNE   SMAJ100                                                          
         MVI   WSPNY,C'Y'          IF NY ENTERED, CHECK OFF MAJOR TOO           
         MVI   WSPNYH+5,1                                                       
         OI    WSPNYH+6,X'80'                                                   
         OI    TCMAJORS,NY                                                      
         B     SMAJ100                                                          
         SPACE 1                                                                
SMAJ30   CLI   WSPNYH+5,0          IF NY NOT ENTERED AND MAJOR NY NOT           
         BE    SMAJ100             CHECKED, OK                                  
         SPACE 1                                                                
*                                  IF NY NOT ENTERED AND MAJOR NY WAS           
*                                  CHECKED ...                                  
         SPACE 1                                                                
*                                  IF PAYING AN UPG TO A NON-VERSION            
SMAJ40   BAS   RE,NYCHK            WHERE NY WAS PREVIOUSLY PAID                 
         BNE   SMAJ100             NY CAN'T BE INPUT IN MARKET FIELDS           
         SPACE 1                                                                
         LR    R2,R3                                                            
SMAJ60   CR    R2,R4               ELSE, FIND FIRST EMPTY MARKET                
         BH    SMAJ80              FIELD AND INPUT NY AUTOMATICALLY             
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         CLI   5(R2),0                                                          
         BE    SMAJ70                                                           
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         B     SMAJ60                                                           
SMAJ70   MVC   8(2,R2),=C'NY'                                                   
         MVI   5(R2),2                                                          
         OI    6(R2),X'80'                                                      
         B     SMAJ100                                                          
         SPACE 1                                                                
SMAJ80   LA    R2,WSPNYH           IF NO ROOM LEFT TO PUT NY INTO               
         J     FLDINV              MARKET LIST, GIVE ERROR                      
         SPACE 1                                                                
SMAJ100  LR    R2,R3                                                            
SMAJ110  CR    R2,R4               SEE IF LA ENTERED IN MKT FIELDS              
         BH    SMAJ130                                                          
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         CLI   10(R2),C' '                                                      
         BH    *+14                                                             
         CLC   8(2,R2),=C'LA'                                                   
         BE    SMAJ120                                                          
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         B     SMAJ110                                                          
         SPACE 1                                                                
SMAJ120  BAS   RE,LACHK                                                         
         BNE   SMAJ140                                                          
         MVI   WSPLA,C'Y'          IF LA ENTERED, CHECK OFF MAJOR TOO           
         MVI   WSPLAH+5,1                                                       
         OI    WSPLAH+6,X'80'                                                   
         OI    TCMAJORS,LA                                                      
         B     SMAJ200                                                          
         SPACE 1                                                                
SMAJ130  CLI   WSPLAH+5,0          IF LA NOT ENTERED AND MAJOR LA NOT           
         BE    SMAJ200             CHECKED, OK                                  
         SPACE 1                                                                
*                                  IF LA NOT ENTERED AND MAJOR LA WAS           
*                                  CHECKED ...                                  
         SPACE 1                                                                
*                                  IF PAYING AN UPG TO A NON-VERSION            
SMAJ140  BAS   RE,LACHK            WHERE LA WAS PREVIOUSLY PAID                 
         BNE   SMAJ200             LA CAN'T BE INPUT IN MARKET FIELDS           
         SPACE 1                                                                
         LR    R2,R3                                                            
SMAJ160  CR    R2,R4               ELSE, FIND FIRST EMPTY MARKET                
         BH    SMAJ180             FIELD AND INPUT LA AUTOMATICALLY             
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         CLI   5(R2),0                                                          
         BE    SMAJ170                                                          
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         B     SMAJ160                                                          
SMAJ170  MVC   8(2,R2),=C'LA'                                                   
         MVI   5(R2),2                                                          
         OI    6(R2),X'80'                                                      
         B     SMAJ200                                                          
         SPACE 1                                                                
SMAJ180  LA    R2,WSPLAH           IF NO ROOM LEFT TO PUT LA INTO               
         J     FLDINV              MARKET LIST, GIVE ERROR                      
         SPACE 1                                                                
SMAJ200  LR    R2,R3                                                            
SMAJ210  CR    R2,R4               SEE IF CHI ENTERED IN MKT FIELDS             
         BH    SMAJ230                                                          
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         CLC   8(3,R2),=C'CHI'                                                  
         BE    SMAJ220                                                          
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         B     SMAJ210                                                          
         SPACE 1                                                                
SMAJ220  BAS   RE,CHICHK                                                        
         BNE   SMAJ240                                                          
         MVI   WSPCHI,C'Y'         IF CHI ENTERED, CHECK OFF MAJOR TOO          
         MVI   WSPCHIH+5,1                                                      
         OI    WSPCHIH+6,X'80'                                                  
         OI    TCMAJORS,CHI                                                     
         J     XIT                                                              
         SPACE 1                                                                
SMAJ230  CLI   WSPCHIH+5,0         IF CHI NOT ENTERED AND MAJOR CHI NOT         
         JE    XIT                 CHECKED, OK                                  
         SPACE 1                                                                
*                                  IF CHI NOT ENTERED AND MAJOR CHI WAS         
*                                  CHECKED ...                                  
         SPACE 1                                                                
*                                  IF PAYING AN UPG TO A NON-VERSION            
SMAJ240  BAS   RE,CHICHK           WHERE CHI WAS PREVIOUSLY PAID                
         JNE   XIT                 CHI CAN'T BE INPUT IN MARKET FIELDS          
         SPACE 1                                                                
SMAJ250  LR    R2,R3                                                            
SMAJ260  CR    R2,R4               ELSE, FIND FIRST EMPTY MARKET                
         BH    SMAJ280             FIELD AND INPUT CHI AUTOMATICALLY            
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         CLI   5(R2),0                                                          
         BE    SMAJ270                                                          
         ZIC   R1,0(R2)                                                         
         AR    R2,R1                                                            
         B     SMAJ260                                                          
SMAJ270  MVC   8(3,R2),=C'CHI'                                                  
         MVI   5(R2),3                                                          
         OI    6(R2),X'80'                                                      
         J     XIT                                                              
         SPACE 1                                                                
SMAJ280  LA    R2,WSPCHIH          IF NO ROOM LEFT TO PUT CHI INTO              
         J     FLDINV              MARKET LIST, GIVE ERROR                      
         SPACE 2                                                                
*              ROUTINE TO PROHIBIT NY FROM BEING INPUT IN MARKET FIELDS         
*              FOR NON-VERSION UPGRADES WHERE NY WAS PREVIOUSLY PAID            
         SPACE 1                                                                
NYCHK    NTR1                                                                   
         USING TAUHD,RE                                                         
         LA    RE,TCTAUHEL                                                      
         TM    TAUHMAJ,NY          IF NY WAS NOT PREVIOUSLY PAID,               
         JZ    YES                 NO REASON TO CHECK FURTHER                   
         B     ALLCHK                                                           
         DROP  RE                                                               
         SPACE 2                                                                
*              ROUTINE TO PROHIBIT LA FROM BEING INPUT IN MARKET FIELDS         
*              FOR NON-VERSION UPGRADES WHERE LA WAS PREVIOUSLY PAID            
         SPACE 1                                                                
LACHK    NTR1                                                                   
         USING TAUHD,RE                                                         
         LA    RE,TCTAUHEL                                                      
         TM    TAUHMAJ,LA          IF LA WAS NOT PREVIOUSLY PAID,               
         JZ    YES                 NO REASON TO CHECK FURTHER                   
         B     ALLCHK                                                           
         DROP  RE                                                               
         SPACE 2                                                                
*              ROUTINE TO PROHIBIT CHI FROM BEING INPUT IN MARKET FLDS          
*              FOR NON-VERSION UPGRADES WHERE CHI WAS PREVIOUSLY PAID           
         SPACE 1                                                                
CHICHK   NTR1                                                                   
         USING TAUHD,RE                                                         
         LA    RE,TCTAUHEL                                                      
         TM    TAUHMAJ,CHI         IF CHI WAS NOT PREVIOUSLY PAID,              
         JZ    YES                 NO REASON TO CHECK FURTHER                   
         B     ALLCHK                                                           
         DROP  RE                                                               
         SPACE 2                                                                
*              ROUTINE TO PROHIBIT (NY,LA,CHI) FROM BEING INPUT IN              
*              MARKET FIELDS FOR NON-VERSION, NON-CREDIT UPGRADES               
*              WHERE (NY,LA,CHI) WAS PREVIOUSLY PAID                            
         SPACE 1                                                                
ALLCHK   TM    TGUSTYST,UPGRADE    IF PAYING AN UPGRADE                         
         JZ    YES                                                              
         TM    PAYSTAT1,CREDIT     NON-CREDIT PAYMENT                           
         JNZ   YES                                                              
         CLI   VERSION,0           TO A NON-VERSION COMMERCIAL                  
         JNE   YES                                                              
         J     NO                  MAJOR CAN'T BE INPUT IN MARKET FLDS          
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO ADD CURRENT UNITS/SUBSCRIBERS TO PREVIOUS             
*              UNITS/SUBSCRIBERS                                                
*              ON ENTRY ... R4=A(USAGE HISTORY ELEMENT)                         
         SPACE 1                                                                
         USING TAUHD,R4                                                         
ADD2PREV NTR1  BASE=*,LABEL=*                                                   
         MVC   SVINPUNT(3),TCUNITS                                              
         MVC   SVINPSUB,TCSUBS                                                  
         SPACE 1                                                                
         LH    RE,TAUHCBUN       RE=PREVIOUS UNITS/SUBSCRIBERS                  
         LH    RF,TCUNITS        RF=CURRENT  UNITS/SUBSCRIBERS                  
         TM    TGUSSTA3,CBLUSE                                                  
         BNZ   A2PREV10                                                         
         L     RE,TAUHSUBS                                                      
         ZICM  RF,TCSUBS,4                                                      
         CLI   TGUSEQU,ULCB                                                     
         BE    A2PREV10                                                         
         LH    RE,TAUHUNT                                                       
         LH    RF,TCUNITS                                                       
         SPACE 1                                                                
A2PREV10 AR    RE,RF             ADD CURRENT UNITS/SUBSCRIBERS                  
         STH   RE,TCUNITS        TO PREVIOUS                                    
         CLI   TGUSEQU,ULCB                                                     
         BNE   A2PREV20                                                         
         XC    TCUNITS,TCUNITS                                                  
         STCM  RE,15,TCSUBS                                                     
         SPACE 1                                                                
A2PREV20 CLI   VERSION,0         IF PAYING A VERSION                            
         BE    A2PREV30                                                         
         OC    TCMAJORS,TAUHMAJ  MERGE CURRENT MAJORS WITH PREVIOUS             
         SPACE 1                                                                
         TM    PAYSTAT1,OVERMKTS IF NOT PAYING A VERSION                        
         JNZ   XIT               OR NOT OVERRIDING A VERSION PAYMENT            
A2PREV30 MVC   SVINPUNT,TCUNITS  SAVE N'UNITS                                   
         MVC   SVINPSUB,TCSUBS   SAVE N'SUBSCRIBERS                             
         J     XIT                                                              
         DROP  R4                                                               
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO ADD ONE UNIT TO CBL/SCB PAYMENTS FOR                  
*              EVERY 350,000 SUBSCRIBERS ACCUMULATED BY CSYS INPUT              
*              ON ENTRY ... R4=A(USAGE HISTORY ELEMENT)                         
         SPACE 1                                                                
         USING TAUHD,R4                                                         
SUB2UNTS NTR1  BASE=*,LABEL=*                                                   
         TM    TGUSSTA3,CBLUSE                                                  
         JZ    XIT                                                              
         SPACE 1                                                                
S2U10    XR    RE,RE             CALCULATE SUBSCRIBERS ON THIS                  
         ZICM  RF,TCSUBS,4       PAYMENT PLUS PREVIOUS AND DIVIDE               
         A     RF,TAUHCSUB       BY 350,000                                     
         STCM  RF,15,TCSUBS                                                     
         D     RE,=F'350000'                                                    
         LR    R1,RF             SAVE QUOTIENT IN R1                            
         SPACE 1                                                                
         XR    RE,RE             DIVIDE PREVIOUS BY 350,000                     
         L     RF,TAUHCSUB                                                      
         D     RE,=F'350000'     SAVE QUOTIENT IN RE                            
         SPACE 1                                                                
         SR    R1,RF             SUBTRACT THE TWO QUOTIENTS                     
         ST    R1,TGFULL         AND ADD THE DIFFERENCE ONTO THE                
         LA    R4,CBLAUNTH       AUTOMATIC UNITS OF CURRENT PAYMENT             
         BRAS  RE,ADD2TOT                                                       
         SPACE 1                                                                
         MVC   SVINPSUB,TCSUBS   UPDATE SUBS OF CURRENT PAYMENT                 
         SPACE 1                                                                
         TM    PAYSTAT1,OVERMKTS IF PAYMENT NOT BEING OVERRIDDEN                
         JNZ   XIT                                                              
         L     R1,TGFULL         ADD THE DIFFERENCE ONTO THE                    
         AH    R1,TCUNITS        UNITS OF CURRENT PAYMENT                       
         STH   R1,TCUNITS                                                       
         J     XIT                                                              
         DROP  R4                                                               
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO ADD CURRENT WEIGHT TO TOTAL WEIGHT                    
*              ON ENTRY ... R4=A(AUTOMATIC UNITS FIELD)                         
         SPACE 1                                                                
ADD2TOT  NTR1  BASE=*,LABEL=*                                                   
         ZIC   RE,5(R4)          PUT PREVIOUSLY PAID UNITS INTO RE              
         LTR   RE,RE                                                            
         BZ    A2T10                                                            
         BCTR  RE,0                                                             
         EX    RE,*+8                                                           
         B     *+10                                                             
         PACK  DUB,8(0,R4)                                                      
         CVB   RE,DUB                                                           
A2T10    A     RE,TGFULL         ADD THIS CNET/MKT/CSYS'S WEIGHT                
         CLI   TWASCR,SCR5F                                                     
         BE    A2T20                                                            
         EDIT  (RE),(L'WSPAUNT,8(R4)),ALIGN=LEFT                                
         B     A2T30                                                            
A2T20    EDIT  (RE),(L'CBLAUNT,8(R4)),ALIGN=LEFT                                
A2T30    OI    4(R4),X'08'                                                      
         STC   R0,5(R4)          AND DISPLAY ACCUMULATED TOTAL                  
         J     XIT                                                              
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO VALIDATE CLA PROGRAM NAMES                            
         SPACE 1                                                                
         USING CLAD,R3             R3=A(SCREEN ENTRY)                           
VALPROG  NTR1  BASE=*,LABEL=*                                                   
         LA    R2,CLAPROGH         TEST FOR INPUT                               
         CLI   5(R2),0                                                          
         JE    XIT                                                              
         SPACE 1                                                                
         CLI   8(R2),C'*'          ASTERISK MEANS SAME AS LAST                  
         BNE   VPRG4                                                            
         OC    LASTPROG,LASTPROG   TEST WE HAVE A LAST                          
         JZ    VPROINV                                                          
         MVC   8(15,R2),LASTPROG   MOVE SAVED TO SCREEN                         
         OI    6(R2),X'80'                                                      
         J     XIT                                                              
VPRG4    MVC   LASTPROG,8(R2)      SAVE NEW PROGRAM NAME                        
         J     XIT                                                              
                                                                                
***********************************************************************         
                                                                                
VPROINV  TM    TGFASTAT,TGFROMFA                                                
         JZ    FLDINV                                                           
         GOTOR ADDEAR,DMCB,EVPTI,CLAIND                                         
         J     XIT                                                              
                                                                                
EVPTI    DC    AL1(EVPTIX-*),AL2(EPROINV),AL1(ERRCATY1),AL1(0)                  
         DC    AL2(D#PUNAM)                                                     
         DC    C'Invalid program'                                               
EVPTIX   EQU   *                                                                
                                                                                
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO VALIDATE CLA LIFT FIELD                               
         SPACE 1                                                                
VALLIFT  NTR1  BASE=*,LABEL=*                                                   
         LA    R2,CLALIFTH                                                      
         CLI   5(R2),0             NO INPUT MEANS NOT TO LIFT                   
         BNE   VLFT1G                                                           
         CLI   LIFT,C'Y'           UNLESS ENTIRE PAYMENT TO LIFT                
         BE    VLFT6                                                            
         CLI   VERSION,0           IF PAYING A VERSION                          
         BE    VLFT2                                                            
         CLI   TCVERSEC,15         TEST IT'S LENGTH <= 15 SEC                   
         BH    VLFT2                                                            
         B     VLFT6B                                                           
         SPACE 1                   IF HAVE INPUT                                
VLFT1G   CLI   VERSION,0           AND PAYING A VERSION                         
         JNE   NOINPUT             THEN INPUT NOT ALLOWED                       
         SPACE                                                                  
         CLI   8(R2),C'N'          NO IS OK                                     
         BNE   VLFT4                                                            
         CLI   LIFT,C'Y'           UNLESS PAYING ALL USES TO LIFT               
         JE    FLDINV                                                           
         SPACE 1                                                                
VLFT2    LH    R0,TCTUSES                                                       
         AHI   R0,1                BUMP TOTAL N'USES PAID                       
         STH   R0,TCTUSES                                                       
         J     XIT                                                              
         SPACE 1                                                                
VLFT4    CLI   8(R2),C'Y'          YES IS OK                                    
         JNE   FLDINV                                                           
         CLI   HASLIFT,C'Y'        AS LONG AS COMM'L HAS LIFTED VERSION         
         JNE   FLDINV                                                           
         SPACE 1                                                                
VLFT6    OI    3(R4),TCLFTPRO      MOVE 'Y' TO TABLE                            
VLFT6B   LH    R0,TCTUSESL                                                      
         AHI   R0,1                BUMP N'USES PD TO LIFT OR SHORT VERS         
         STH   R0,TCTUSESL                                                      
         SPACE 1                                                                
         LH    R0,TCTUSES                                                       
         AHI   R0,1                AND BUMP TOTAL N'USES PAID                   
         STH   R0,TCTUSES                                                       
         SPACE 1                                                                
         CLI   VERSION,0           SKIP IF PAYING A VERSION                     
         JNE   XIT                                                              
         CLI   LIFT,C'Y'           IF NOT ENTIRE PAYMENT TO LIFT                
         BE    VLFT8                                                            
         CLI   LIFTPAID,C'Y'       OR NO USES PAID TO LIFT YET                  
         JE    XIT                                                              
         MVI   ELCODE,TALFELQ      GET LIFT DETAILS ELEMENT                     
         L     R4,ACOML            FROM COMMERCIAL REC IN AIO2                  
         BRAS  RE,GETEL                                                         
         BNE   VLFT8                                                            
         MVC   ELTALF,0(R4)        SAVE ENTIRE ELEMENT                          
VLFT8    MVI   LIFTPAID,C'Y'       SET THERE ARE USES PAID TO LIFT              
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO VALIDATE CLA NETWORK FIELD                            
         SPACE 1                                                                
         USING CLAD,R3             R3=A(SCREEN ENTRY)                           
VALNWK   NTR1  BASE=*,LABEL=*                                                   
         LA    R2,CLANWKH                                                       
         CLI   5(R2),0                                                          
         JE    VALN5                                                            
         CLI   8(R2),C'*'                                                       
         JE    VNWKINV                                                          
         SPACE                                                                  
                                                                                
         CLI   TGUSEQU,UPAX        IF USE IS PAX                                
         JNE   VALN0                                                            
         CLI   8(R2),C'X'          NETWORK MUST BE 'X'                          
         JE    XIT                                                              
         CLI   8(R2),C'B'          OR 'B' FOR BOUNCE                            
         JE    XIT                                                              
         CLI   8(R2),C'E'          OR 'E' FOR ME TV                             
         JE    XIT                                                              
         CLI   8(R2),C'Y'          OR 'Y' FOR ANTENNA TV                        
         JE    XIT                                                              
         CLI   8(R2),C'T'          OR 'T' FOR THIS TV                           
         JE    XIT                                                              
         CLI   8(R2),C'Z'          OR 'Z' FOR COZI TV                           
         JE    XIT                                                              
         CLI   8(R2),C'P'          OR 'P' FOR ESCAPE                            
         JE    XIT                                                              
         CLI   8(R2),C'G'          OR 'G' FOR GET TV                            
         JE    XIT                                                              
         CLI   8(R2),C'R'          OR 'R' FOR GRIT                              
         JE    XIT                                                              
         CLI   8(R2),C'J'          OR 'J' FOR JUSTICE                           
         JE    XIT                                                              
         CLI   8(R2),C'L'          OR 'L' FOR LAFF                              
         JNE   VNWKINV                                                          
         J     XIT                                                              
         SPACE                                                                  
VALN0    CLI   TGUSEQU,UCLA        IF USE IS CLASS A                            
         JNE   VALN1                                                            
         CLI   8(R2),C'X'          AND PROGRAM NETWORK IS PAX                   
         JNE   XIT                                                              
         LH    R1,TCTXUSES         INCREMENT TOTAL PAX COUNTER                  
         AHI   R1,1                                                             
         STH   R1,TCTXUSES                                                      
         SPACE                                                                  
         CLI   CLALIFT,C'Y'        IF PROGRAM IS LIFT                           
         JE    *+12                                                             
         CLI   LIFT,C'Y'           OR WHOLE PAYMENT TO LIFT                     
         JNE   VALNA                                                            
         LH    R1,TCTXUSEL         INCREMENT LIFT PAX COUNTER                   
         AHI   R1,1                                                             
         STH   R1,TCTXUSEL                                                      
         J     XIT                                                              
         SPACE                                                                  
VALNA    CLI   VERSION,0           IF PAYMENT TO VERSION                        
         JE    XIT                                                              
         CLI   TCVERSEC,10         OF 10 SECOND                                 
         JE    *+12                                                             
         CLI   TCVERSEC,15         OR 15 SECOND LENGTH                          
         JNE   XIT                                                              
         LH    R1,TCTXUSEL         INCREMENT LIFT PAX COUNTER                   
         AHI   R1,1                                                             
         STH   R1,TCTXUSEL                                                      
         J     XIT                                                              
         SPACE                                                                  
VALN1    CLI   TGUSEQU,ULNA        IF LNA USE                                   
         JNE   *+16                                                             
         CLI   8(R2),C'A'          NETWORK MUST BE "A"                          
         JNE   VNWKINV                                                          
         J     XIT                                                              
         CLI   TGUSEQU,ULNN        IF LNN USE                                   
         JNE   *+16                                                             
         CLI   8(R2),C'N'          NETWORK MUST BE "N"                          
         JNE   VNWKINV                                                          
         J     XIT                                                              
         CLI   TGUSEQU,ULNC        IF LNC USE                                   
         JNE   *+16                                                             
         CLI   8(R2),C'C'          NETWORK MUST BE "C"                          
         JNE   VNWKINV                                                          
         J     XIT                                                              
         CLI   TGUSEQU,ULNF        IF LNF USE                                   
         JNE   *+16                                                             
         CLI   8(R2),C'F'          NETWORK MUST BE "F"                          
         JNE   VNWKINV                                                          
         J     XIT                                                              
VALN5    CLI   NWKREQ,C'Y'         TEST NETWORK REQUIRED FOR NWK USES           
         JE    VNWKMISS                                                         
         J     XIT                                                              
                                                                                
***********************************************************************         
                                                                                
VNWKMISS TM    TGFASTAT,TGFROMFA                                                
         JZ    FLDMISS                                                          
         GOTOR ADDEAR,DMCB,EVNWKM,CLAIND                                        
         J     XIT                                                              
                                                                                
EVNWKM   DC    AL1(EVNWKMX-*),AL2(ENWKMIS),AL1(ERRCATY1),AL1(0)                 
         DC    AL2(D#PUNWK)                                                     
         DC    C'Missing network'                                               
EVNWKMX  EQU   *                                                                
                                                                                
***********************************************************************         
                                                                                
VNWKINV  TM    TGFASTAT,TGFROMFA                                                
         JZ    FLDINV                                                           
         GOTOR ADDEAR,DMCB,EVNWKI,CLAIND                                        
         J     XIT                                                              
                                                                                
EVNWKI   DC    AL1(EVNWKIX-*),AL2(ENWKINV),AL1(ERRCATY1),AL1(0)                 
         DC    AL2(D#PUNWK)                                                     
         DC    C'Invalid network'                                               
EVNWKIX  EQU   *                                                                
                                                                                
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO SET PAX INDICATOR                                     
         SPACE 1                                                                
VALPAX   NTR1  BASE=*,LABEL=*                                                   
         CLI   CLANWK,C'X'          IF PROGRAM'S NETWORK IS PAX                 
         JNE   XIT                                                              
         OI    3(R4),TCPAXPRO       SET PAX INDICATOR                           
         J     XIT                                                              
         DROP  R3                                                               
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO DISPLAY TOTALS AT INVOICE END                         
         SPACE 1                                                                
*                                  R2=A(TOTALS FIELD HEADER)                    
DISTOTS  NTR1  BASE=*,LABEL=*                                                   
         L     R1,TPAYI            DISPLAY INDIVIDUAL GROSS                     
         LA    R3,20(R2)                                                        
         BRAS  RE,EDITTOTS                                                      
         L     R1,TPAYC            AND CORPORATE GROSS                          
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         LA    R3,46(R2)                                                        
         BRAS  RE,EDITTOTS                                                      
         SPACE 1                                                                
         NI    1(R2),X'F3'         MAKE TOTALS FIELD NORMAL INTENSITY           
         OI    6(R2),X'80'         AND TRANSMIT                                 
         J     XIT                                                              
         SPACE 3                                                                
EDITTOTS NTR1  BASE=*,LABEL=*                                                   
         EDIT  (R1),(14,(R3)),2,COMMAS=YES,MINUS=YES,ALIGN=LEFT                 
         J     XIT                                                              
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TESTS IF INPUT AT R2 IS VALID FOR UPGRADE? FIELD         
*              RETURNS CC EQUAL IF INPUT = Y OR F AND CC NOT EQUAL              
*              IF INPUT = N OR NO INPUT, ELSE FLD IS INVALID                    
         SPACE 1                                                                
TESTUPGR NTR1  BASE=*,LABEL=*                                                   
         CLI   5(R2),0             IF NO INPUT                                  
         JE    NO                                                               
         CLI   8(R2),C'N'          OR INPUT = N                                 
         JE    NO                  SET CC NO                                    
         CLI   8(R2),C'Y'                                                       
         JE    YES                 IF INPUT = Y                                 
         CLI   8(R2),C'F'          OR INPUT = F, SET CC YES                     
         JNE   FLDINV              ELSE INVALID                                 
         J     YES                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO VALIDATE STATUS FIELDS                                
         SPACE 1                                                                
*                                  R2   = A(FIELD)                              
*                                  WORK = BIT VALUE <==> 'Y'                    
VALSTAT  NTR1  BASE=*,LABEL=*                                                   
         GOTO1 ANY                 REQUIRE INPUT                                
         CLI   8(R2),C'N'                                                       
         JE    XIT                 GET OUT IF NO                                
         CLI   8(R2),C'Y'                                                       
         JNE   FLDINV                                                           
         OC    GUARSTAT,BYTE       TURN ON STATUS BIT                           
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO VALIDATE THAT THIS PAYMENT IS AN UPGRADE              
*              RETURNS CC EQ IF IT IS, ELSE CC NOT EQ                           
         SPACE 1                                                                
         USING TAUHD,R4            R4=A(USAGE HISTORY ELEMENT)                  
VALUPGR  NTR1  BASE=*,LABEL=*                                                   
         MVC   BYTE,TAUHMAJ        UPGRADE MAJORS MUST INCLUDE                  
         NC    BYTE,TCMAJORS       ALL ORIGINAL MAJORS                          
         CLC   BYTE,TAUHMAJ                                                     
         JNE   NO                  ELSE, NOT VALID                              
         SPACE 1                                                                
         GOTO1 UPGRVAL,DMCB,TGUSCDE,TGUSTYP                                     
         SPACE 1                                                                
         CLC   TAUHUNT,TCUNITS     COMPARE ORIG UNITS                           
         JH    NO                  NEW UNITS CAN'T DECREASE                     
         JL    YES                 SET CC EQ IF NEW UNITS INCREASED             
         CLC   TAUHMAJ,TCMAJORS    OR IF NEW MAJORS INCREASED                   
         JL    YES                 ELSE SET CC NOT EQ                           
         J     NO                                                               
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              BUILDING A CHECK RECORD                                          
         SPACE 1                                                                
PROCCHK  NTR1  BASE=*,LABEL=*                                                   
         TM    TGFASTAT,TGFROMFA   IF PAYMENT IS NOT COMING FROM WEB            
         JO    PROCC6                                                           
         L     R2,ATHSLINE         R2=A(LINE)                                   
         AH    R2,DSPCCOM          ADD DISPLACEMENT TO COMMENT HEADER           
                                                                                
         CLI   TGUSEQU,USOP        IF SOP USE                                   
         JNE   PROCC5                                                           
         TM    1(R2),X'0C'         TEST IF FLD IS NORMAL INTENSITY              
         JNZ   PROCC5                                                           
         L     R1,ATMPPAYD                                                      
         USING TMPPAYD,R1                                                       
         OC    SOPCMTEL,SOPCMTEL   TEST IF HAVE CHK CMT FROM CAST REC           
         JZ    PROCC6                                                           
         MVC   ELEMENT(L'SOPCMTEL),SOPCMTEL  ADD IT TO CHECK                    
         GOTO1 ADDL                                                             
         J     PROCC6                                                           
PROCC5   GOTO1 NAMIN,DMCB,TACMELQ,(X'80',(R2)),TACMTYPC  ADD CHECK CMNT         
                                                                                
PROCC6   CLI   ELTASD,0            IF WE HAVE A SESSION DETAILS EL.             
         JE    PROCC10                                                          
         MVC   ELEMENT(L'ELTASD),ELTASD                                         
         GOTO1 ADDL                ADD IT TO CHECK RECORD                       
                                                                                
PROCC10  TM    TGFASTAT,TGFROMFA   IF PAYMENT COMING FROM WEB                   
         JZ    XIT                                                              
                                                                                
         USING TLCKD,R2                                                         
         L     R2,AIO              R2=A(CHECK RECORD)                           
                                                                                
         USING WEBRESD,R1                                                       
         L     R1,TGAFARES         R1=A(WEB RESPONSE DETAILS)                   
PROCC11  CLI   0(R1),X'FF'                                                      
         JE    PROCC20                                                          
         CLC   TLCKSORT+4(2),WRSSEQ                                             
         JE    PROCC12             LOOK FOR CURRENT CAST'S ENTRY                
         LA    R1,WRSLNQ(R1)                                                    
         J     PROCC11                                                          
         DROP  R2                                                               
                                                                                
         USING TACMD,R2                                                         
PROCC12  CLC   WRSCKCMT,SPACES     IF CHECK COMMENT IS PRESENT                  
         JE    XIT                                                              
         LA    R2,ELEMENT          ADD IT TO THE CHECK                          
         XC    ELEMENT,ELEMENT                                                  
         MVI   TACMEL,TACMELQ                                                   
         MVI   TACMLEN,3+L'WRSCKCMT                                             
         MVI   TACMTYPE,TACMTYPC                                                
         MVC   TACMCOMM(L'WRSCKCMT),WRSCKCMT                                    
         GOTO1 ADDL                                                             
         J     XIT                                                              
         DROP  R1,R2                                                            
                                                                                
PROCC20  TM    TGFASTAT,TGCRNOPY   IF PAYMENT COMING FROM CERNO                 
         JZ    XIT                                                              
                                                                                
         USING TLCKD,R2                                                         
         L     R2,AIO              R2=A(CHECK RECORD)                           
         GOTOR GTHFCDET,DMCB,TLCKSORT+4                                         
         JE    *+6                                                              
         DC    H'00'                                                            
         DROP  R2                                                               
                                                                                
         USING WBPYCSD,RF                                                       
         L     RF,TGFULL                                                        
         CLC   WPCSCKC,SPACES      IF CHECK COMMENT IS PRESENT                  
         JE    XIT                                                              
                                                                                
         USING TACMD,R1                                                         
         LA    R1,ELEMENT          ADD IT TO THE CHECK                          
         XC    ELEMENT,ELEMENT                                                  
         MVI   TACMEL,TACMELQ                                                   
         MVI   TACMLEN,3+L'WPCSCKC                                              
         MVI   TACMTYPE,TACMTYPC                                                
         MVC   TACMCOMM(L'WPCSCKC),WPCSCKC                                      
         GOTO1 ADDL                                                             
         J     XIT                                                              
         DROP  R1,RF                                                            
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO VALIDATE AND SAVE AUTO OR OVER UNITS FIELD            
*              ON ENTRY ... R2=A(AUTO OR OVER UNITS/SUBS FIELD)                 
         SPACE 1                                                                
VSUNIT   NTR1  BASE=*,LABEL=*                                                   
         CLI   5(R2),0                                                          
         JE    XIT                                                              
         OC    8(4,R2),8(R2)                                                    
         JZ    XIT                                                              
         BRAS  RE,VALUNITS       VALIDATE UNITS/SUBS FIELD                      
         STH   R1,TCUNITS        SAVE N'UNITS                                   
         SPACE 1                                                                
         CLI   TGUSEQU,ULCB                                                     
         JNE   XIT                                                              
         STCM  R1,15,TCSUBS      OR N'SUBSCRIBERS                               
         XC    TCUNITS,TCUNITS                                                  
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE VALIDATES THE NUMBER OF UNITS OR INSERTS IN              
*              FIELD AT R2 RETURNS BINARY OF INPUT IN R1                        
         SPACE                                                                  
VALUNITS NTR1  BASE=*,LABEL=*                                                   
         GOTO1 ANY                                                              
         TM    4(R2),X'08'         TEST FOR NUMERIC                             
         BZ    NUMINV                                                           
         ZIC   R1,5(R2)            CONVERT TO BINARY                            
         BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         B     *+10                                                             
         PACK  DUB,8(0,R2)         * EXECUTED *                                 
         CVB   R1,DUB                                                           
         XIT1  REGS=(R1)           RETURN # OF UNITS OR INSERTS IN R1           
         EJECT                                                                  
*              ROUTINE TO VALIDATE CLA USE DATES                                
         SPACE 1                                                                
         USING CLAD,R3             R3=A(SCREEN ENTRY)                           
VALDATE  NTR1  BASE=*,LABEL=*                                                   
         LA    R2,CLADATEH                                                      
         CLI   5(R2),0             TEST USE DATE INPUT                          
         JNE   VDTE6                                                            
         CLI   CLAPROGH+5,0        NO - IF ANY OTHERS INPUT                     
         JNE   VDTEMISS            REQUIRE INPUT IN DATE FIELD                  
         CLI   CLALIFTH+5,0                                                     
         JNE   VDTEMISS                                                         
         CLI   CLANWKH+5,0                                                      
         JNE   VDTEMISS                                                         
         J     NO                  RETURN CC NE TO SKIP THIS ENTRY              
         SPACE 1                                                                
VDTE6    CLI   8(R2),C'*'          ASTERISK MEANS SAME AS LAST                  
         JNE   VDTE8                                                            
         OC    LASTDATE,LASTDATE   TEST WE HAVE A LAST                          
         JZ    VDTEINV                                                          
         CLC   LASTDATE(3),=C'TBA' TEST IF LAST IS UNKNOWN                      
         JNE   *+14                                                             
         MVC   8(3,R2),LASTDATE                                                 
         J     VDTE7                                                            
         GOTO1 DATCON,DMCB,(1,LASTDATE),(8,8(R2))  DISPLAY DATE                 
         BRAS  RE,SETFRST          SET FIRST USE DATE                           
VDTE7    OI    6(R2),X'80'                                                      
         MVC   0(3,R4),LASTDATE    MOVE TO THIS TABLE ENTRY                     
         J     YES                 AND CONTINUE                                 
         SPACE 1                                                                
VDTE8    CLC   =C'TBA',8(R2)       TEST FOR UNKNOWN DATE                        
         JNE   VDTE10                                                           
         MVC   0(3,R4),8(R2)       SAVE IT IN TABLE                             
         MVC   LASTDATE,8(R2)      SAVE MOST RECENT DATE                        
         J     YES                                                              
         SPACE 1                                                                
VDTE10   CLI   5(R2),5             IF L'I/P LESS OR EQUAL TO FIVE               
         JH    VDTE12                                                           
         GOTO1 DATVAL,DMCB,(1,8(R2)),DUB   VALIDATE MONTH/DAY ONLY              
         OC    0(4,R1),0(R1)               TEST FOR INPUT ERROR                 
         JZ    VDTEINV                                                          
         MVC   DUB(2),CYCSTART             CARRY YEAR FROM CYCLE START          
         CLC   CYCSTART(2),CYCEND          TEST CYCLE START YEAR <> END         
         JE    VDTE13                                                           
         CLC   DUB+2(4),CYCSTART+2         IF MM/DD IS LT CYCLE START           
         JNL   VDTE11                                                           
         CLC   DUB+2(4),CYCEND+2           & MM/DD IS NOT GT CYCLE END          
         JH    VDTEINV                                                          
         MVC   DUB(2),CYCEND               CARRY YEAR FROM CYCLE END            
VDTE11   J     VDTE14                                                           
         SPACE 1                                                                
VDTE12   GOTO1 DATVAL,DMCB,8(R2),DUB       VALIDATE Y/M/D                       
         OC    0(4,R1),0(R1)               TEST FOR INPUT ERROR                 
         JZ    VDTEINV                                                          
VDTE13   CLC   DUB(6),CYCSTART     IF USE DATE NOT BEFORE CYCLE START           
         JL    VDTEINV                                                          
         CLC   DUB(6),CYCEND       AND NOT AFTER CYCLE END                      
         JH    VDTEINV                                                          
         SPACE 1                                                                
VDTE14   GOTO1 DATCON,DMCB,(0,DUB),(1,(R4)) SAVE IN TABLE                       
         SPACE 1                                                                
         MVC   LASTDATE,0(R4)               SAVE MOST RECENT DATE               
         BRAS  RE,SETFRST                   SET FIRST USE DATE                  
         J     YES                                                              
                                                                                
***********************************************************************         
                                                                                
VDTEMISS TM    TGFASTAT,TGFROMFA                                                
         JZ    FLDMISS                                                          
         GOTOR ADDEAR,DMCB,EVDTM,CLAIND                                         
         J     NO                                                               
                                                                                
EVDTM    DC    AL1(EVDTMX-*),AL2(EDTEMIS),AL1(ERRCATY1),AL1(0)                  
         DC    AL2(D#PUDAT)                                                     
         DC    C'Missing date'                                                  
EVDTMX   EQU   *                                                                
                                                                                
***********************************************************************         
                                                                                
VDTEINV  TM    TGFASTAT,TGFROMFA                                                
         JZ    FLDINV                                                           
         GOTOR ADDEAR,DMCB,EVDTI,CLAIND                                         
         J     NO                                                               
                                                                                
EVDTI    DC    AL1(EVDTIX-*),AL2(EDTEINV),AL1(ERRCATY1),AL1(0)                  
         DC    AL2(D#PUDAT)                                                     
         DC    C'Invalid date'                                                  
EVDTIX   EQU   *                                                                
                                                                                
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO SET FIRST USE DATE                                    
*              CURRENT USE DATE IS IN LASTDATE                                  
         SPACE 1                                                                
SETFRST  NTR1  BASE=*,LABEL=*                                                   
         OC    FRSTUSE,FRSTUSE     IF ALREADY HAVE A FIRST USE DATE             
         BZ    SETF10                                                           
         CLC   LASTDATE,FRSTUSE                                                 
         JNL   XIT                 AND CURRENT USE DATE IS BEFORE IT            
                                                                                
SETF10   MVC   FRSTUSE,LASTDATE    SAVE NEW FIRST USE DATE                      
         XC    DUEDATE,DUEDATE     CLEAR DUE DATE (CAUSES RECALC)               
         XC    DUEDATE2,DUEDATE2                                                
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE ADDS HEADINGS FOR ONE YEAR UNLIMITED USE AND             
*              SINGLE MARKET. ONLY USED FOR NORTHWEST ADDENDUM STATE            
*              R3 POINTS AT 3RD HEADING AND R4 POINTS AT 3RD TYPE               
         SPACE                                                                  
DISNWA   NTR1  BASE=*,LABEL=*                                                   
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         JNE   XIT                 PUT HEADINGS FOR 1-YR UNLIMITED USE          
         DROP  R1                  AND SINGLE MARKET                            
*                                                                               
         LA    RE,NWHTAB                                                        
         CLI   TGUSEQU,UADW        IF ADDENDUM WILDSPOT OR                      
         BE    *+12                COMBINED SESSION/WILDSPOT                    
         CLI   TGUSEQU,UADC        USE A DIFFERENT TABLE THAT DOESN'T           
         BNE   DISNW10             HAVE SINGLE MARKET                           
         LA    RE,NWHWTAB                                                       
DISNW10  MVC   8(L'ADDTYHED,R3),0(RE)     MOVE IN HEADING                       
         OI    6(R3),X'80'                                                      
         NI    1(R4),X'DF'         UNPROTECT INPUT FIELD                        
         OI    6(R4),X'80'                                                      
         LA    RE,5(RE)                                                         
         CLI   0(RE),X'FF'                                                      
         JE    XIT                                                              
         ZIC   R1,0(R3)                                                         
         AR    R3,R1               BUMP TO NEXT HEADING FIELD                   
         ZIC   R1,0(R4)                                                         
         AR    R4,R1               BUMP TO NEXT INPUT FIELD                     
         B     DISNW10                                                          
*                                                                               
NWHTAB   DC    C'1y-un'                                                         
         DC    C'1-mkt'                                                         
         DC    X'FF'                                                            
*                                                                               
NWHWTAB  DC    C'1y-un'                                                         
         DC    X'FF'                                                            
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE SAVES THE TYPES VALID FOR THIS ADDENDUM STATE            
*              IN ADDTYPES AND MOVES IN HEADINGS STARTING AT R3 AND             
*              UNPROTECTS THE TYPE INPUT COLUMNS STARTING AT R4                 
         SPACE                                                                  
         USING ADDTYTD,R1                                                       
SETTYPES NTR1  BASE=*,LABEL=*                                                   
         LA    R1,ADDTYTAB         R1=A(ADDENDUM TYPE TABLE)                    
SETTY5   CLI   0(R1),X'FF'                                                      
         BNE   SETTY6              CHECK NOT END OF TABLE FOR STATES            
         LA    R1,GAALL                                                         
         B     SETTY10             ELSE JUST USE GA TABLE                       
         SPACE                                                                  
         USING TACOD,R2                                                         
SETTY6   LA    R2,ELTACO                                                        
         CLC   TACOADST,ADDTYTST   MATCH ON ADDENDUM STATE                      
         BE    SETTY7                                                           
         ZIC   R0,ADDTYTLN                                                      
         AR    R1,R0               ELSE BUMP TO NEXT STATE                      
         B     SETTY5                                                           
SETTY7   LA    R1,ADDTYTUS         SET R1=USE TABLE                             
         SPACE                                                                  
         USING ADDUSED,R1                                                       
SETTY10  CLI   0(R1),X'FF'                                                      
         BE    SETTY12             CHECK TABLE IS FOR ALL USES                  
         CLC   TGUSEQU,ADDUSUSE    ELSE MATCH ON USE EQUATE                     
         BE    SETTY12                                                          
         ZIC   R0,ADDUSLN                                                       
         AR    R1,R0               ELSE BUMP TO NEXT USE                        
         B     SETTY10                                                          
SETTY12  LA    R1,ADDUSTYP         SET R1=USE TYPE TABLE                        
         LA    R0,MAXTYPES         R0=MAX N'TYPES PER USE                       
         LA    R2,ADDTYPES         R2=A(WHERE TO SAVE TYPES)                    
         XR    RE,RE                                                            
         SPACE                                                                  
         USING ADDTYPD,R1                                                       
SETTY15  MVC   0(1,R2),ADDTYTYP    SAVE TYPE                                    
         CLI   0(R1),X'FF'         CHECK NOT END OF TYPES                       
         JE    XIT                                                              
         OC    ADDTYHED,ADDTYHED   IF THERE'S A HEADING                         
         BZ    SETTY20                                                          
         MVC   8(L'ADDTYHED,R3),ADDTYHED  MOVE IN HEADING                       
         OI    6(R3),X'80'                                                      
         NI    1(R4),X'DF'         UNPROTECT INPUT FIELD                        
         OI    6(R4),X'80'                                                      
SETTY20  LA    R1,ADDTYNXT         BUMP TO NEXT TYPE                            
         IC    RE,0(R3)                                                         
         AR    R3,RE               BUMP TO NEXT HEADING FIELD                   
         IC    RE,0(R4)                                                         
         AR    R4,RE               BUMP TO NEXT INPUT FIELD                     
         LA    R2,1(R2)            BUMP TO NEXT ENTRY IN ADDTYPES               
         BCT   R0,SETTY15          LOOP FOR MAX N'TYPES                         
         J     XIT                                                              
         DROP R2                                                                
         SPACE 2                                                                
         LTORG                                                                  
         SPACE 1                                                                
*              TABLE OF VALID ADDENDUM TYPES FOR EACH ADDENDUM STATE            
         SPACE 1                                                                
ADDTYTAB DS    0C                                                               
GATAB    DC    C'GA',AL1(GATABX-GATAB)         GEORGIA                          
GAALL    DC    AL1(ALL,GAALLX-GAALL)           ALL USES                         
         DC    AL1(UADT3D),CL5'3-day'                                           
         DC    AL1(UADT1W),CL5'1-wk'                                            
         DC    AL1(UADT4W),CL5'4-wk'                                            
         DC    AL1(UADT13W),CL5'13-wk'                                          
         DC    X'FF'                                                            
GAALLX   EQU   *                                                                
GATABX   EQU   *                                                                
         SPACE 3                                                                
KSTAB    DC    C'KS',AL1(KSTABX-KSTAB)         KANSAS                           
KSADW    DC    AL1(UADW,KSADWX-KSADW)          ADW                              
         DC    AL1(UADW1W),CL5'1-wk'                                            
         DC    AL1(UADW31D),CL5'31-dy'                                          
         DC    AL1(UADW13W),CL5'13-wk'                                          
         DC    X'FF'                                                            
KSADWX   EQU   *                                                                
KSALL    DC    AL1(ALL,KSALLX-KSALL)           ALL OTHER USES                   
         DC    AL1(UADC1W),CL5'1-wk'                                            
         DC    AL1(UADC31D),CL5'31-dy'                                          
         DC    AL1(UADC13W),CL5'13-wk'                                          
         DC    X'FF'                                                            
KSALLX   EQU   *                                                                
KSTABX   EQU   *                                                                
         SPACE 3                                                                
TXTAB    DC    C'TX',AL1(TXTABX-TXTAB)         TEXAS                            
TXALL    DC    AL1(ALL,TXALLX-TXALL)           ALL USES                         
         DC    AL1(UADT13W),5X'00'                                              
         DC    X'FF'                                                            
TXALLX   EQU   *                                                                
TXTABX   EQU   *                                                                
         SPACE 3                                                                
NWTAB    DC    C'NW',AL1(NWTABX-NWTAB)         NORTHWEST                        
NWADW    DC    AL1(UADW,NWADWX-NWADW)          ADW                              
         DC    AL1(UADW2W),CL5'2-wk'                                            
         DC    AL1(UADW13W),CL5'13-wk'                                          
         DC    X'FF'                                                            
NWADWX   EQU   *                                                                
NWALL    DC    AL1(ALL,NWALLX-NWALL)           ALL OTHER USES                   
         DC    AL1(UADT2W),CL5'2-wk'                                            
         DC    AL1(UADT13W),CL5'13-wk'                                          
         DC    X'FF'                                                            
NWALLX   EQU   *                                                                
NWTABX   EQU   *                                                                
         DC    X'FF'               MARK END OF STATES                           
         EJECT                                                                  
*              ROUTINE TO VALIDATE AN HOURS/MINUTES FIELD                       
         SPACE 1                                                                
*                                  FULL BYTE 0 X'80'=NO MINIMUM OF 1 HR         
*                                              X'40'=2 HOUR MINIMUM             
*                                              X'20'=99 HOUR MAXIMUM            
*                                            1-3 = VALID INCREMENTS             
*                                  R2=A(FIELD)                                  
VALHRMN  NTR1  BASE=*,LABEL=*                                                   
         XC    HALF,HALF           PRE-CLEAR RETURN FIELD                       
         CLI   5(R2),0                                                          
         JE    XIT                                                              
         ZIC   R3,5(R2)                                                         
         GOTO1 CASHVAL,DMCB,8(R2),(R3) VALIDATE AMOUNT                          
         CLI   0(R1),X'FF'                                                      
         JE    AMTINV                                                           
         TM    4(R1),X'80'         NO NEGATIVE AMOUNTS                          
         JO    AMTINV                                                           
         ICM   RF,15,4(R1)         MOVE TO RF / TEST FOR ZERO                   
         JZ    XIT                                                              
         SPACE 1                                                                
         STH   RF,HALF             SAVE VALUE IN HALF                           
         SPACE 1                                                                
         TM    FULL,X'80'          UNLESS SPECIFIED                             
         BO    VALHR10                                                          
         TM    FULL,X'40'          MINIMUM OF 2 HOURS?                          
         BNO   VALHR05                                                          
         C     RF,=F'200'                                                       
         JL    AMTINV                                                           
         B     VALHR10                                                          
*                                                                               
VALHR05  C     RF,=F'100'          MINIMUM IS 1 HOUR                            
         JL    AMTINV                                                           
VALHR10  TM    FULL,X'20'          99 HOURS MAXIMUM?                            
         BNO   VALHR20                                                          
         C     RF,=F'9900'                                                      
         JH    AMTINV                                                           
         B     *+12                                                             
VALHR20  C     RF,=F'2400'         MAXIMUM IS 24 HOURS                          
         JH    AMTINV                                                           
         XR    RE,RE                                                            
         D     RE,=F'100'          RF=N'HOURS                                   
         LR    R1,RE               R1=N'MINUTES                                 
         CH    R1,=H'60'           MUST BE LESS THAN SIXTY MINUTES              
         JNL   AMTINV                                                           
         SPACE                                                                  
         MVI   FULL,0              CLEAR FLAG                                   
         CLC   FULL,=F'1'          DON'T BOTHER IF FULL=1                       
         JE    XIT                                                              
         MH    RF,=H'60'             N'HOURS * 60 MINUTES                       
         AR    R1,RF               + N'MINUTES = TOTAL N'MINUTES                
         XR    R0,R0                                                            
         D     R0,FULL             INSURE VALID INTERVAL                        
         LTR   R0,R0               SHOULD BE NO REMAINDER                       
         JNZ   AMTINV                                                           
         J     XIT                                                              
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO GET USAGE HISTORY FOR CURRENT CYCLE OF LCB            
*              RETURNS CC EQUAL IF FINDS ONE, ELSE CC NOT EQUAL                 
         SPACE                                                                  
GETLCBUH NTR1  BASE=*,LABEL=*                                                   
         XC    TCTAUHEL,TCTAUHEL   CLEAR USAGE HISTORY EL.                      
         SPACE 1                                                                
         LA    R3,KEY              BUILD PARTIAL KEY FOR RECORD                 
         USING TLUHD,R3                                                         
         XC    TLUHKEY,TLUHKEY                                                  
         MVI   TLUHCD,TLUHCDQ      RECORD CODE                                  
         MVC   TLUHCOM,TGCOM       INTERNAL COMMERCIAL NUMBER                   
         MVC   TLUHUSE,TGUSCDE     USE CODE                                     
         GOTO1 HIGH                GET DIRECTORY RECORD                         
         B     GETLUH5                                                          
         SPACE 1                                                                
GETLUH4  GOTO1 SEQ                 GET NEXT DIRECTORY RECORD                    
GETLUH5  CLC   TLUHKEY(TLUHINV-TLUHD),KEYSAVE  DID WE FIND REC FOR USE          
         JNE   NO                                                               
         GOTO1 GETREC              GET THE RECORD                               
         SPACE 1                                                                
         USING TAUHD,R4                                                         
         MVI   ELCODE,TAUHELQ      GET USAGE HISTORY ELEMENT                    
         L     R4,AIO                                                           
         BRAS  RE,GETEL                                                         
         BNE   GETLUH4                                                          
         SPACE                                                                  
         CLC   TCPCYCS,TAUHSTRT    IF CYCLE STARTS ARE THE SAME                 
         BNE   GETLUH4                                                          
         MVC   TGUPFRTY,TAUHTYPE   SET "FROM" TYPE FOR UPGRVAL                  
         TM    TAUHLCST,TAUHTMIL   IF 1MIL ADDED TO RATE, TURN ON BIT           
         BZ    *+8                                                              
         OI    TCPAYST,TCMILFR                                                  
         MVC   TCTAUHEL,TAUHEL     SAVE ELEMENT IN LOCAL BUFFER                 
         J     YES                                                              
         DROP  R4                                                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO VALIDATE THAT THIS LCB PAYMENT IS AN UPGRADE          
*              RETURNS CC EQ IF IT IS, ELSE CC NOT EQ                           
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
VALCBUPG NTR1  BASE=*,LABEL=*                                                   
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     NORTHWEST ADDENDUM CABLE?                    
         BNE   *+12                                                             
         CLI   TGUSEQU,UACB                                                     
         BE    VUPG10                                                           
         DROP  R1                                                               
*                                                                               
         CLC   TAUHTYPE,TGUPTOTY   TEST RANGE OF SUBSCRIBERS                    
         JNE   YES                 IF NOT EQ MEANS INCREASED, SET CC EQ         
****     CLC   TAUHLCBM,TCMAJORS                                                
****     JL    YES                 ELSE NEW MAJORS MUST INCREASE                
         J     NO                  ELSE SET CC NOT EQ                           
*                                                                               
VUPG10   TM    TCPAYST,TCMIL+TCMILFR  IF 1MIL SELECTED FOR BOTH                 
         BNO   VUPG20                 UPG SUBS MUST BE > OLD SUBS.              
         CLC   TAUHTYPE,TGUPTOTY                                                
         JL    YES                                                              
         J     NO                                                               
VUPG20   TM    TCPAYST,TCMILFR     IF FROM MIL IS SELECTED, THIS MIL            
         JZ    YES                 MUST ALSO BE SELECTED                        
         J     NO                                                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE CLEARS TSAR RECORD AREA AT TCATSAR                       
         SPACE                                                                  
CLRTSAR  NTR1  BASE=*,LABEL=*                                                   
         L     R2,TCATSAR                                                       
         LA    R3,ECSTRLNQ                                                      
         XR    RE,RE                                                            
         XR    RF,RF                                                            
         MVCL  R2,RE               CLEAR TSAR RECORD AREA                       
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE SAVES COUNTS OF CAST IN BLOCK TO EPISAIR                 
*              ORDER OF EPISODES ARE THE SAME IN BOTH                           
         SPACE                                                                  
         USING EPISATBD,R3                                                      
         USING EPISD,R2                                                         
SAVCOUNT NTR1  BASE=*,LABEL=*                                                   
         LA    R3,EPISAIR          R3=A(ENTRY IN EPISAIR)                       
         ZIC   R0,BLOCK            R0=N'EPISODES                                
         LA    R2,BLOCK+1          R2=A(ENTRY IN BLOCK)                         
                                                                                
SAVC5    MVC   EPATNCON,EPINCON    SAVE COUNTS                                  
         MVC   EPATNU5,EPINU5                                                   
         LA    R3,EPATNXT          BUMP R3                                      
         LA    R2,EPINUMLN(R2)     BUMP R2                                      
         BCT   R0,SAVC5            LOOP FOR N'EPISODES                          
         J     XIT                                                              
         DROP  R2                                                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE USES ECAST RECORD IN AIO AND SETS ADDITIONAL             
*              INFO IF WRITER CATEGORY OR IF THERE'S CREDIT BALANCE             
*              R3=A(EPISODE ENTRY), TGBYTE=1ST STATUS BYTE ON ECAST             
         SPACE                                                                  
         USING EPISD,R3                                                         
NEEDEC   NTR1  BASE=*,LABEL=*                                                   
         TM    TGCATYPE,WRITER     FOR WRITERS                                  
         BZ    NEEDEC30                                                         
         SPACE                                                                  
         USING TASOD,R4                                                         
         L     R4,AIO              R4=A(TASOEL)                                 
         MVI   ELCODE,TASOELQ      GET IT                                       
         BRAS  RE,GETEL                                                         
         BE    *+6                 MUST BE THERE                                
         DC    H'0'                                                             
*                                                                               
         LA    R1,PCTWRTAB         R1=A(PCT FOR WRITER'S ROLES TABLE)           
         CLI   TGUSEQU,USWC        IF SWC,SWR,SWN - MUST CHECK IF               
         BE    NEEDEC02            EPISODE HAS A BREAKDOWN WRITER               
         CLI   TGUSEQU,USWR        IF IT DOES NOT, THEN IT'S A 50/50            
         BE    NEEDEC02            SPLIT BETWEEN HEAD AND SCRIPT                
         CLI   TGUSEQU,USWN                                                     
         BNE   NEEDEC10                                                         
*                                                                               
NEEDEC02 LA    R5,EPITAB           EPISODE STATUS TABLE                         
         USING EPITABD,R5                                                       
NEEDEC04 CLI   0(R5),X'FF'                                                      
         BNE   *+6                                                              
         DC    H'0'                                                             
*                                                                               
         SR    R1,R1                                                            
         ICM   R1,3,EPITNUM        EPISODE NUM IN BINARY                        
         CVD   R1,DUB                                                           
         UNPK  WORK(5),DUB+5(3)       CONVERT IT                                
         OI    WORK+4,X'F0'                                                     
         XC    WORK,=5X'FF'        COMPLEMENT EPISODE NUM                       
*                                                                               
         LA    R1,PCTWRTAB         R1=A(PCT FOR WRITER'S ROLES TABLE)           
         L     R4,AIO                                                           
         USING TLECD,R4                                                         
         CLC   TLECEPI,WORK                                                     
         BNE   NEEDEC06                                                         
         CLI   EPITNWB,0           DOES THIS EPI HAVE A BREADKOWN               
         BNE   NEEDEC08            WRITER?  IF SO, USE DIFF TABLE               
         LA    R1,PCTWRTA2         R1=A(PCT FOR WRITER'S ROLES TABLE)           
         B     NEEDEC08                                                         
*                                                                               
NEEDEC06 LA    R5,EPITLNQ(R5)                                                   
         B     NEEDEC04                                                         
*                                                                               
         USING TASOD,R4                                                         
NEEDEC08 L     R4,AIO              R4=A(TASOEL)                                 
         MVI   ELCODE,TASOELQ      GET IT                                       
         BRAS  RE,GETEL                                                         
         BE    *+6                 MUST BE THERE                                
         DC    H'0'                                                             
*                                                                               
NEEDEC10 XR    R0,R0               INIT R0=TOTAL PCT FOR WRITER'S ROLES         
         XR    RE,RE                                                            
NEEDEC12 CLI   0(R1),X'FF'         TEST NOT END OF TABLE                        
         BE    NEEDEC18                                                         
         MVC   BYTE,TASOSTAT                                                    
         NC    BYTE,0(R1)          IF WRITER IS THIS ROLE                       
         BZ    NEEDEC15                                                         
         IC    RE,1(R1)            ACCUMULATE THE PCT                           
         AR    R0,RE                                                            
NEEDEC15 LA    R1,2(R1)            BUMP TO NEXT ROLE ENTRY                      
         B     NEEDEC12                                                         
         SPACE                                                                  
NEEDEC18 STC   R0,BYTE             BYTE=TOTAL PCT FOR WRITER'S ROLES            
         TM    TASOSTAT,TASOSH     ACCUMULATE WRITER ROLES IN TSAR REC          
         BZ    *+8                                                              
         OI    EPISTAT,EPISTHW                                                  
         TM    TASOSTAT,TASOSB                                                  
         BZ    *+8                                                              
         OI    EPISTAT,EPISTBW                                                  
         TM    TASOSTAT,TASOSS                                                  
         BZ    *+8                                                              
         OI    EPISTAT,EPISTSW                                                  
         SPACE                                                                  
         L     R4,AIO                                                           
         MVI   ELCODE,TACAELQ      GET TACA ELEM IN R4                          
         BRAS  RE,GETEL                                                         
         BE    *+6                                                              
         DC    H'0'                MUST BE THERE                                
         USING TACAD,R4                                                         
*                                                                               
         OC    TACAWPCT,TACAWPCT   CHECK IF ANY ROLE PCT                        
         BNZ   NEEDEC24                                                         
*                                                                               
         TM    EPISTAT,EPISTHW     HEAD WRITER?                                 
         BZ    NEEDEC20                                                         
         CLI   EPITNWH,1           MORE THAN 1 HEAD WRITER?                     
         JH    NOPECAST                                                         
         B     NEEDEC24                                                         
*                                                                               
NEEDEC20 TM    EPISTAT,EPISTSW     SCRIPT WRITER?                               
         BZ    NEEDEC22                                                         
         CLI   EPITNWS,1           MORE THAN 1 SCRIPT WRITER?                   
         JH    NOPECAST                                                         
         B     NEEDEC24                                                         
*                                                                               
NEEDEC22 CLI   EPITNWB,1           MORE THAN 1 BREAKDOWN WRITER?                
         JH    NOPECAST                                                         
*                                                                               
NEEDEC24 ICM   R1,15,TACAWPCT      WRITER ROLE PCT                              
         BNZ   *+8                                                              
         L     R1,=F'100000'       IF 0, MEANS 100%                             
         ZIC   R0,BYTE                                                          
         MR    R0,R0                                                            
         D     R0,=F'50'                                                        
         LTR   R1,R1                                                            
         BM    *+8                                                              
         AHI   R1,1                                                             
         SRA   R1,1                                                             
         XR    R0,R0                                                            
         ICM   R0,7,EPIWPCT                                                     
         AR    R0,R1                                                            
         STCM  R0,7,EPIWPCT        SAVE TOTAL WRITER ROLE PCT                   
         J     XIT                 NO CREDITS FOR WRITERS                       
         SPACE                                                                  
NEEDEC30 CLI   TGCAEQU,CTAD        DIRECTORS NEVER GET CREDITS                  
         JE    XIT                                                              
         CLI   TGCAEQU,CTDIR                                                    
         JE    XIT                                                              
         CLI   TGCAEQU,CTDI2                                                    
         JE    XIT                                                              
         CLI   TGUSEQU,USOC        NO CREDITS FOR CABLE                         
         JE    XIT                                                              
         CLI   TGUSEQU,USON        NO CREDITS FOR CABLE                         
         JE    XIT                                                              
         CLI   TGUSEQU,USPP        OR PPV                                       
         JE    XIT                                                              
         TM    TGBYTE,TLECSBAL     IF HAVE CREDIT BALANCE                       
         JZ    XIT                                                              
         OI    EPISTAT,EPISTBAL    SET CREDIT BALANCE BIT                       
         L     R4,AIO                                                           
         MVI   ELCODE,TACRELQ      GET TACR ELEM                                
         BRAS  RE,GETEL                                                         
         BE    *+6                                                              
         DC    H'0'                MUST BE THERE                                
         USING TACRD,R4                                                         
         MVC   EPIBAL,TACRBAL+1    SAVE CREDIT BALANCE IN TSAR REC              
         J     XIT                                                              
         SPACE 1                                                                
NOPECAST MVC   MYMSGNO,=Y(ERMUS503) NO PERCENT ON ECAST RECORD                  
         J     NTHEEND                                                          
*                                                                               
         SPACE 2                                                                
*              TABLE OF PERCENTAGES FOR WRITER'S ROLES                          
         SPACE                                                                  
PCTWRTAB DS    0C                                                               
         DC    AL1(TASOSH,35)      HEAD WRITER GETS 35%                         
         DC    AL1(TASOSS,50)      SCRIPT WRITER GETS 50%                       
         DC    AL1(TASOSB,15)      BREAKDOWN WRITER GETS 15%                    
         DC    X'FF'                                                            
PCTWRTA2 DS    0C                  TABLE FOR TYPES SWC,SWR,SWN                  
         DC    AL1(TASOSH,50)      HEAD WRITER GETS 50%                         
         DC    AL1(TASOSS,50)      SCRIPT WRITER GETS 50%                       
         DC    AL1(TASOSB,0)       BREAKDOWN WRITER GETS 0%                     
         DC    X'FF'                                                            
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE SETS R3=A(CORRECT ENTRY AREA FOR THIS EPISODE)           
*              R4=A(TSAR RECORD), R2=A(CURRENT EPISODE NUM)                     
         SPACE                                                                  
         USING ECASTABD,R4                                                      
GETENTRY NTR1  BASE=*,LABEL=*                                                   
         LA    R3,ECSTEPIS         INIT R3=A(FIRST ENTRY)                       
         CLI   TGCAEQU,CTW         IF WRITER CATEGORY, MERGE ROLES              
         BE    GETENT1                                                          
         CLI   TGCAEQU,CTW2                                                     
         BE    GETENT1                                                          
         CLI   TGCAEQU,CTW3                                                     
         BNE   GETENT8                                                          
GETENT1  ZIC   R0,ECSTNEPI          R0=NUMBER OF EPISODES                       
GETENT2  CLC   0(L'EPINUM,R3),0(R2) FIND MATCHING EPISODE NUMBER                
         BNE   GETENT6                                                          
         IC    R0,ECSTNEPI         DECREMENT N'EPISODES BECAUSE                 
         BCTR  R0,0                MERGING INTO OLD ENTRY AND COUNT             
         STC   R0,ECSTNEPI         GETS INCREMENTED LATER                       
         B     GETENTX                                                          
GETENT6  LA    R3,EPINUMLN(R3)     BUMP TO NEXT ENTRY                           
         BCT   R0,GETENT2          LOOP FOR NUMBER OF ENTRIES                   
         B     GETENTX             RETURN NEXT AVAIL. ENTRY IF NO MATCH         
         SPACE                                                                  
GETENT8  ZIC   RF,ECSTNEPI         NUMBER OF EPISODES                           
         MH    RF,=AL2(EPINUMLN)   * L'EACH ENTRY=DISP. TO NEXT ENTRY           
         AR    R3,RF               ADD DISP. TO FIRST ENTRY                     
         SPACE                                                                  
GETENTX  XIT1  REGS=(R3)           RETURN R3                                    
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO FILTER ECAST RECORDS AT AIO, SETS CC                  
         SPACE                                                                  
         USING TACAD,R4                                                         
FILTER   NTR1  BASE=*,LABEL=*                                                   
         L     R4,AIO                                                           
         MVI   ELCODE,TACAELQ      GET CAST DETAILS ELEMENT                     
         BRAS  RE,GETEL                                                         
         BE    *+6                                                              
         DC    H'0'                                                             
         GOTO1 UNIVAL,DMCB,TACAUN  SET UNION INFO                               
         SPACE                                                                  
         CLI   TGUNEQU,NON         IF UNION NON                                 
         BNE   FILT5                                                            
*        MVC   BYTE,TGCAUNI        AND IF ANY ALLOWABLE UNIONS FOR CAST         
*        XI    BYTE,NON            (NOT INCLUDING NON)                          
*        MVC   TGBYTE2,TGUSXUNI                                                 
*        XI    TGBYTE2,X'FF'                                                    
*        NC    TGBYTE2,BYTE        IS EXCLUDED FROM THE USE                     
*        JZ    NO                  THEN SET CC NOT EQ TO SKIP                   
         MVC   DUB(4),TGCAUNIS                                                  
         XI    DUB,NON                                                          
         MVC   DUB+4(4),TGUSXUNS                                                
         XC    DUB+4(4),=4X'FF'                                                 
         GOTO1 UNITEST,DMCB,(X'80',DUB),DUB+4                                   
         JZ    NO                                                               
         B     FILT8                                                            
         SPACE                                                                  
*ILT5    MVC   BYTE,TGUSXUNI       TEST THIS UNION EXCLUDED FROM USE            
*        NC    BYTE,TGUNEQU                                                     
*        JNZ   NO                  YES - SET CC NOT EQ TO SKIP                  
FILT5    GOTO1 UNITEST,DMCB,(X'80',TGUNEQUS),TGUSXUNS                           
         JNZ   NO                                                               
         SPACE 1                                                                
         USING TACOD,R4                                                         
FILT8    LA    R4,ELTACO           R4=A(COMM'L DETAILS ELEMENT)                 
         TM    TACOSTAT,TACOSCAN   IF CANADIAN DOLLAR PAYMENT                   
         JZ    YES                                                              
*        TM    TGUNEQU,SAG+AFT+DGA+WGA                                          
         GOTO1 UNITEST,DMCB,TGUNEQUS,SAG+AFT+DGA+WGA,0,0,0                      
         JNZ   NO                  EXCLUDE SAG, AFT, DGA, AND WGA               
         J     YES                                                              
         DROP  R4                                                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE SETS TGCAT AND TGCASORT AND MERGES WRITER                
*              CATEGORIES IF NECESSARY.  R3=A(ECAST RECORD)                     
         SPACE                                                                  
         USING TLECD,R3                                                         
MERGECAT NTR1  BASE=*,LABEL=*                                                   
         MVC   TGCAT,=C'W  '       MERGE ALL W CATEGORIES                       
         CLC   TLECCAT,=C'WB '                                                  
         BE    MRGC5                                                            
         CLC   TLECCAT,=C'WS '                                                  
         BE    MRGC5                                                            
         CLC   TLECCAT,=C'WH '                                                  
         BE    MRGC5                                                            
         MVC   TGCAT,=C'W2 '       MERGE ALL W2 CATEGORIES                      
         CLC   TLECCAT,=C'W2B'                                                  
         BE    MRGC5                                                            
         CLC   TLECCAT,=C'W2S'                                                  
         BE    MRGC5                                                            
         CLC   TLECCAT,=C'W2H'                                                  
         BE    MRGC5                                                            
         MVC   TGCAT,=C'W3 '       MERGE ALL W3 CATEGORIES                      
         CLC   TLECCAT,=C'W3B'                                                  
         BE    MRGC5                                                            
         CLC   TLECCAT,=C'W3S'                                                  
         BE    MRGC5                                                            
         CLC   TLECCAT,=C'W3H'                                                  
         BE    MRGC5                                                            
         MVC   TGCAT,TLECCAT       ELSE JUST USE THE ACTUAL CATEGORY            
         SPACE                                                                  
MRGC5    GOTO1 CATVAL,DMCB,TGCAT   GET CAST SORT AND OTHER INFO                 
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE CHECKS IF A FIELD HAS CHANGED                            
*              IF NO, RESETS HEADER SO FIELD WILL BE RECALCULATED               
*              R2=A(HEADER)                                                     
         SPACE                                                                  
CHKCHNG  NTR1  BASE=*,LABEL=*                                                   
         TM    4(R2),X'20'         IF AMOUNT NOT OVERRIDDEN                     
         JZ    XIT                                                              
         TM    1(R2),X'08'                                                      
         BZ    CHKCH5                                                           
         TM    1(R2),X'04'                                                      
         JZ    XIT                                                              
CHKCH5   MVI   5(R2),0             MAKE IT APPEAR TO BE EMPTY                   
         MVI   7(R2),0             SET OUTPUT LENGTH IN CASE PROTECTED          
         NI    4(R2),X'DF'         SET NOT PREV VALIDATED                       
         OI    6(R2),X'80'                                                      
         SPACE                                                                  
         ZIC   R1,0(R2)            LENGTH OF FIELD                              
         AHI   R1,-9               - 9 (8 FOR HEADER, 1 FOR XC)                 
         TM    1(R2),X'02'                                                      
         BZ    *+8                                                              
         AHI   R1,-8               - 8 (IF HAVE EXTENDED HEADER)                
         EX    R1,*+8              = LENGTH OF DATA                             
         B     *+10                                                             
         XC    8(0,R2),8(R2)       CLEAR IN CASE AMOUNT=0                       
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO SET BITS FOR NORTHWEST ADDENDUMS                      
         SPACE 1                                                                
SETNWA   NTR1  BASE=*,LABEL=*                                                   
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         JNE   XIT                                                              
         DROP  R1                                                               
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
         LA    R3,TCTAUHEL                                                      
         TM    TCPAYST,TCUNLMTD    1-YR UNLIMITED RATE?                         
         BZ    *+8                                                              
         OI    TAUHADST,TAUHAUNL   SET BIT FOR 1-YR UNLMTD RATE                 
*                                                                               
         TM    TCPAYST,TCSINGLE    SINGLE MARKET RATE?                          
         JZ    XIT                                                              
         OI    TAUHADST,TAUHASMK   SET BIT FOR SINGLE MARKET RATE               
         J     XIT                                                              
         DROP  R3                                                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*======================================================================         
*        ROUTINE CHECKS IF MUSIC DATE IS IN COMMERCIAL RECORD                   
*        ERRORS OUT IF NOT THERE                                                
*======================================================================         
         USING TACSD,R4                                                         
CKMUSDT  NTR1  BASE=*,LABEL=*                                                   
         L     R4,ACOML            SEE IF MUSIC DATE EXISTS                     
         MVI   ELCODE,TACSELQ                                                   
         BRAS  RE,GETEL                                                         
         B     *+8                                                              
CKMUSDT3 BRAS  RE,NEXTEL                                                        
         BNE   NOMUSD                                                           
*                                                                               
         CLI   TACSTYPE,TACSTYPM   MUSIC TYPE ONLY                              
         BNE   CKMUSDT3                                                         
*                                                                               
         OC    TACSDATE,TACSDATE                                                
         BZ    NOMUSD                                                           
         J     XIT                                                              
*                                                                               
         DROP  R4                                                               
*                                                                               
NOMUSD   MVC   MYMSGNO,=Y(ERCMMUSD) COMMERCIAL MISSING MUSIC DATE               
         J     NTHEEND              NEW THEEND FOR TWO BYTE ERROR MSGS          
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO BUILD MKT/CNET ELEMENTS USING MKT/CNET TBL            
         SPACE 1                                                                
BLDMKTEL NTR1  BASE=*,LABEL=*                                                   
         USING MKTTABLD,R2                                                      
         USING TAMTD,R4                                                         
         L     R2,AMKTTABL         BUILD MKT/CNET ELEMENTS USING                
         LA    R4,ELEMENT          MKT/CNET TABLE                               
         OC    MTCODE,MTCODE                                                    
         JZ    XIT                                                              
BME10    CLI   MTCODE,X'FF'                                                     
         JE    XIT                                                              
         XC    ELEMENT,ELEMENT                                                  
         MVI   TAMTEL,TAMTELQ                                                   
         MVI   TAMTLEN,TAMTLNQ                                                  
         MVC   TAMTCODE,MTCODE                                                  
         MVC   TAMTCYCS,MT1DATE                                                 
         MVC   TAMTCYCE,MTCYCEND                                                
         GOTO1 ADDL                                                             
         LA    R2,MKTLNQ(R2)                                                    
         B     BME10                                                            
         DROP  R2,R4                                                            
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE CALLS TSAR USING TCATSAR FOR A(TSAR RECORD)              
*              MYTSRNUM AND MYTSACTN ARE SET                                    
*              RETURNS CONDITION CODE                                           
         DS    0D                                                               
CALLTSAR NTR1  BASE=*,LABEL=*                                                   
         SPACE                                                                  
         LA    R1,ECSTRLNQ                                                      
         STCM  R1,3,MYTSRECL       REC LENGTH                                   
         MVI   MYTSKEYL,ECSTKLNQ   KEY LENGTH                                   
         MVI   MYTSPAGN,6          SET 6 14K PAGES - MAX 192 TSAR RECS          
         MVI   MYTSINDS,TSIALLOC+TSIRTNAF  SET FOR TEMPEST                      
         GOTO1 TSARCNTL,DMCB,TCATSAR                                            
         JNE   NO                                                               
         J     YES                 SET CC EQUAL                                 
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS FOR CLA                            
         DS    0D                                                               
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
DISCLAUH NTR1  BASE=*,LABEL=*                                                   
         SPACE 1                                                                
         CLI   TAUHLEN,0           DON'T BOTHER IF NO USAGE HISTORY EL.         
         JE    XIT                                                              
         MVC   CLALSTI,LASTINV     INVOICE NUMBER                               
         OI    CLALSTIH+6,X'80'                                                 
         GOTO1 DATCON,DMCB,(X'11',TAUHSTRT),(8,CLALSTC)  CYCLE DATES            
         OI    CLALSTCH+6,X'80'                                                 
         SPACE 1                                                                
         LH    RF,TAUHUSN                                                       
         EDIT  (RF),(3,CLALSTU),ZERO=NOBLANK,ALIGN=LEFT LAST USE TOTAL          
         OI    CLALSTUH+6,X'80'                                                 
         LH    RF,TAUHUSNL                                                      
         EDIT  (RF),(3,CLALSTL),ZERO=BLANK,ALIGN=LEFT LAST USE LFT ONLY         
         OI    CLALSTLH+6,X'80'                                                 
         SPACE 1                                                                
         MVI   CLALSTG,C' '        GUAR 13 USE                                  
         OI    CLALSTGH+6,X'80'                                                 
         CLI   TAUHTYPE,UCLAG13                                                 
         JNE   XIT                                                              
         MVI   CLALSTG,C'Y'                                                     
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              POST-COMMERCIAL VALIDATION ROUTINES                              
         SPACE 1                                                                
         DS    0D                                                               
XVCOM    NTR1  BASE=*,LABEL=*                                                   
         LR    R7,RB               ESTABLISH R7 AS SECOND BASE REG              
         AHI   R7,X'1000'                                                       
         USING XVCOM+X'1000',R7                                                 
         SPACE                                                                  
         TM    PAYMODE,DTLDSPLD    DON'T BOTHER IF DETAIL INFO DISPLAYD         
         JO    XIT                                                              
         LH    R2,DSPCMNT                                                       
         AR    R2,RA                                                            
         CLC   COMCMNT,8(R2)       IF WE DON'T HAVE COMMERCIAL COMMENT          
         BE    *+14                                                             
         MVC   8(L'COMCMNT,R2),COMCMNT  DISPLAY IT                              
         OI    6(R2),X'80'                                                      
         SPACE 1                                                                
         LA    R3,TCTAUHEL         SET R3=A(USAGE HISTORY ELEMENT)              
         SPACE 1                                                                
         LH    RF,DSPXVC           RF=A(DISP. TO INDIVIDUAL ROUTINE)            
         LTR   RF,RF                                                            
         JZ    XIT                                                              
         AR    RF,RB                                                            
         LA    RE,XVCX             SET RE FOR COMMON NTR1                       
         NTR1                                                                   
         BR    RF                  ** DISPLAY USAGE HISTORY DETAILS **          
         SPACE 1                                                                
XVCX     J     XIT                                                              
         SPACE 2                                                                
         GETEL2 R4,DATADISP,ELCODE                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (BE - GENERAL)                     
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCMBE   DS    0H                                                               
         LA    R2,PAYLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (BD - DEALER)                      
         SPACE 1                                                                
XVCMBD   DS    0H                                                               
         LA    R2,DLRLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         LA    R2,DLRLPAY          DISPLAY LAST INVOICE/CYCLE DATES             
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         GOTOR DCHOICE,WORK,('UDLRA',37(R2)),('UDLRANY',43(R2)),       X        
               ('UDLRB',50(R2)),('UDLRBNY',56(R2)),                    X        
               ('UDLRRAD',65(R2)),('UDLRA8',37(R2)),                   X        
               ('UDLRANY8',43(R2)),('UDLRB8',50(R2)),                  X        
               ('UDLRBNY8',56(R2)),('UDLRRAD8',65(R2)),(X'FF',0)                
         CLI   TAUHTYPE,UDLRA8                                                  
         BNL   *+8                                                              
         MVI   25(R2),C'Y'                                                      
         CLI   TAUHTYPE,UDLRA8                                                  
         BL    *+8                                                              
         MVI   30(R2),C'Y'                                                      
                                                                                
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (BC - RADIO NETWORK)               
         SPACE 1                                                                
XVCMBC   DS    0H                                                               
         LA    R2,RNTLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('URNT1W',34(R2)),('URNT4W',40(R2)),       X        
               ('URNT8W',46(R2)),('URNT13W',53(R2)),                   X        
               ('URNT26U',60(R2)),('URNT39U',68(R2)),                  X        
               ('URNTAB',76(R2)),(X'FF',0)                                      
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (BB - WILDSPOT)                    
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCMBB   DS    0H                                                               
         CLI   WSPUPGR,C'F'        DON'T BOTHER IF FORCING UPGRADE              
         JE    XIT                                                              
         SPACE 1                                                                
         LA    R2,WSPLPAYH                                                      
         LA    R4,WSPLUPGH                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         SPACE 1                                                                
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,DMCB,('UWSP8W',35(R2)),('UWSP13W',40(R2)),      X        
               (X'FF',0)           DISPLAY LAST LENGTH                          
         SPACE 1                                                                
         TM    TAUHSTAT,TAUHSFIN   IF FORCED INTIAL                             
         BZ    *+12                                                             
         MVI   WSPLUPG,C'I'        PUT I FOR UPGRADE?                           
         B     XVCMBB5                                                          
         SPACE 1                                                                
         TM    TAUHSTAT,TAUHSFUP   IF FORCED UPGRADE                            
         BZ    *+12                                                             
         MVI   WSPLUPG,C'F'        PUT F FOR UPGRADE?                           
         B     XVCMBB5                                                          
         SPACE 1                                                                
         OC    TAUHIUNT,TAUHIUNT   IF UNFORCED UPGRADE                          
         BNZ   *+12                                                             
         CLI   TAUHIMAJ,0                                                       
         BE    XVCMBB5                                                          
         MVI   WSPLUPG,C'Y'        PUT Y FOR UPGRADE?                           
         SPACE 1                                                                
XVCMBB5  TM    TAUHMAJ,NY          DISPLAY PREVIOUS MAJORS                      
         BZ    *+8                                                              
         MVI   WSPLNY,C'Y'                                                      
         TM    TAUHMAJ,LA                                                       
         BZ    *+8                                                              
         MVI   WSPLLA,C'Y'                                                      
         TM    TAUHMAJ,CHI                                                      
         BZ    *+8                                                              
         MVI   WSPLCHI,C'Y'                                                     
         SPACE 1                                                                
         EDIT  (2,TAUHWAUT),(4,WSPLAUT)                                         
         CLC   TAUHWAUT,TAUHUNT                                                 
         JE    XIT                                                              
         EDIT  (2,TAUHUNT),(4,WSPLUNT)                                          
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (BA - NWK/CLA,LNA,LNB,LNC)         
*              R3=A(USAGE HISTORY ELEMENT)                                      
         SPACE 1                                                                
XVCMBA   DS    0H                                                               
         GOTOR DISCLAUH            DISPLAY UPDATED UH ELEM                      
         CLI   TGUSEQU,UCLA        DONE IF CLA                                  
         JE    XIT                                                              
         CLI   TGUSEQU,UPAX        DONE IF PAX                                  
         JE    XIT                                                              
*                                  MAKE G13 FLDS LOW INT AND PROTECTED          
         GOTO1 FLDVAL,DMCB,(X'08',CLAHG13H),(X'08',CLAG13H)                     
         GOTO1 (RF),(R1),(X'08',CLAHLSGH),(X'08',CLALSTGH)                      
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (B9 - CABLE)                       
         SPACE 1                                                                
XVCMB9   DS    0H                                                               
         LA    R2,CABLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UCAB4W',40(R2)),                         X        
               ('UCAB13W',46(R2)),('UCAB52W',53(R2)),                  X        
               ('UCABU413',60(R2)),('UCABU13',68(R2)),                 X        
               ('UCABU452',77(R2)),(X'FF',0)                                    
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (B8 - MUSIC)                       
         SPACE 1                                                                
XVCMB8   DS    0H                                                               
         LA    R2,MUSLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UMUS8W',35(R2)),('UMUS13W',35(R2)),      X        
               ('UMUSNEW8',40(R2)),('UMUSNEW',40(R2)),                 X        
               ('UMUSDUB8',45(R2)),('UMUSDUB',45(R2)),                 X        
               ('UMUSDUB6',45(R2)),('UMUSDUB1',45(R2)),                X        
               ('UMUSDSH8',50(R2)),('UMUSDSH',50(R2)),                 X        
               ('UMUSDSH6',50(R2)),('UMUSDSH1',50(R2)),                X        
               ('UMUS2DS',56(R2)),(X'FF',0)                                     
         GOTOR DCHOICE,WORK,('UMUSDSH8',45(R2)),('UMUSDSH',45(R2)),    X        
               ('UMUSDSH6',45(R2)),('UMUSDSH1',45(R2)),                X        
               ('UMUS2DS',45(R2)),(X'FF',0)                                     
         GOTOR DCHOICE,WORK,('UMUS8W',63(R2)),('UMUS13W',67(R2)),      X        
               ('UMUSNEW8',63(R2)),('UMUSNEW',67(R2)),                 X        
               ('UMUSDUB8',63(R2)),('UMUSDUB',67(R2)),                 X        
               ('UMUSDUB6',72(R2)),('UMUSDUB1',77(R2)),                X        
               ('UMUSDSH8',63(R2)),('UMUSDSH',67(R2)),                 X        
               ('UMUSDSH6',72(R2)),('UMUSDSH1',77(R2)),                X        
               ('UMUS2DS',67(R2)),,(X'FF',0)                                    
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (76 - MUSIC RATE REUSE)            
         SPACE 1                                                                
XVCM76   DS    0H                                                               
         LA    R2,MRRLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UMRR2YR',36(R2)),('UMRRFON',48(R2)),     X        
               ('UMRRVID',66(R2)),(X'FF',0)                                     
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (A6 - GUARANTEE)                   
         SPACE 1                                                                
XVCMA6   DS    0H                                                               
         LA    R2,GRTLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (59 - RADIO REGNAL NETWRK)         
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM59   DS    0H                                                               
         LA    R2,RRNLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         CLI   TAUHRMAJ,0          IF NO MAJORS                                 
         BNE   *+12                                                             
         MVI   37(R2),C'Y'         PUT Y IN NONE FIELD                          
         J     XIT                                                              
         TM    TAUHRMAJ,NY         ELSE HANDLE MAJORS                           
         BZ    *+8                                                              
         MVI   43(R2),C'Y'                                                      
         TM    TAUHRMAJ,LA                                                      
         BZ    *+8                                                              
         MVI   48(R2),C'Y'                                                      
         TM    TAUHRMAJ,CHI                                                     
         BZ    *+8                                                              
         MVI   54(R2),C'Y'                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (5C - LOCAL REUSE)                 
         SPACE 1                                                                
XVCM5C   DS    0H                                                               
         LA    R2,LOCLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('ULOCB',36(R2)),('ULOCBNY',42(R2)),       X        
               ('ULOCC',49(R2)),(X'FF',0)                                       
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (5E - FOREIGN REUSE)               
         SPACE 1                                                                
XVCM5E   DS    0H                                                               
         OI    FGRCEDLH+1,X'0C'  INITIALIZE CANADIAN EXPIRATION DATE            
         OI    FGRCEDLH+6,X'80'  FIELDS TO LOW INTENSITY AND PROTECTED          
         OI    FGRCEDH+1,X'20'                                                  
         OI    FGRCEDH+6,X'80'                                                  
                                                                                
         USING TACOD,R4                                                         
         LA    R4,ELTACO                                                        
         CLI   TACOCTYP,CCTY04A  IF ACTRA TYPE IS 2404A                         
         JE    XVCM5E2                                                          
         CLI   TACOCTYP,CCTY2404 OR 2404                                        
         JNE   XVCM5E3                                                          
XVCM5E2  LA    R2,FGRCEDH                                                       
         ST    R2,AACTCYCE       SAVE A(ACTRA CYCLE END DATE FIELD)             
         NI    FGRCEDLH+1,X'FB'  AND MAKE CANADIAN EXPIRATION DATE              
         NI    FGRCEDH+1,X'DF'   FIELDS VISIBLE AND UNPROTECTED                 
                                                                                
XVCM5E3  LA    R2,FGRLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
                                                                                
         CLI   TAUHTYPE,UFGREXT    IF NEW TYPE WITH EXTENSION                   
         BNE   *+12                                                             
         MVI   78(R2),C'Y'         MARK EXT OPTION FOR LAST                     
         B     XVCM5E5             BEGIN CHECKING LOCATIONS                     
         CLI   TAUHTYPE,UFGRMAJ    IF NEW TYPE WITH MAJORS                      
         BNE   XVCM5E10                                                         
         SPACE                                                                  
XVCM5E5  CLI   TAUHFMAJ,WWIDE      LOCATIONS                                    
         BNE   *+12                                                             
         MVI   65(R2),C'Y'         CHECK FOR W/WIDE FIRST                       
         J     XIT                                                              
         TM    TAUHFMAJ,UK                                                      
         BZ    *+8                                                              
         MVI   35(R2),C'Y'                                                      
         TM    TAUHFMAJ,EUR                                                     
         BZ    *+8                                                              
         MVI   40(R2),C'Y'                                                      
         TM    TAUHFMAJ,JAP                                                     
         BZ    *+8                                                              
         MVI   46(R2),C'Y'                                                      
         TM    TAUHFMAJ,AP                                                      
         BZ    *+8                                                              
         MVI   51(R2),C'Y'                                                      
         TM    TAUHFMAJ,REST                                                    
         JZ    XIT                                                              
         MVI   56(R2),C'Y'                                                      
         J     XIT                                                              
         SPACE 1                                                                
XVCM5E10 GOTOR DCHOICE,WORK,('UFGRUK',35(R2)),('UFGREUR',40(R2)),      X        
               ('UFGRJAP',46(R2)),('UFGRAP',51(R2)),                   X        
               ('UFGRWOR',56(R2)),('UFGRWIDE',65(R2)),                 X        
               ('UFGRRAD',72(R2)),(X'FF',0)                                     
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (5F - CABLE - BDCAST TV)           
                                                                                
XVCM5F   DS    0H                                                               
         CLI   CBLUPGR,C'F'        DON'T BOTHER IF FORCING UPGRADE              
         JE    XIT                                                              
                                                                                
         LA    R2,CBLLPAYH                                                      
         LA    R4,CBLLUPGH                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
                                                                                
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
                                                                                
         BAS   RE,SETOVSTA         SET OVERRIDE STATUS                          
                                                                                
         CLI   TGUSEQU,ULCB                                                     
         BE    XVCM5F60                                                         
                                                                                
         LA    RE,TAUHCSTA                                                      
         TM    TGUSSTA3,CBLUSE                                                  
         BNZ   XVCM5F10                                                         
         LA    RE,TAUHSTAT                                                      
XVCM5F10 TM    0(RE),TAUHSFIN      IF FORCED INITIAL                            
         BZ    XVCM5F15                                                         
         MVI   CBLLUPG,C'I'        PUT I FOR UPGRADE?                           
         B     XVCM5F40                                                         
XVCM5F15 TM    0(RE),TAUHSFUP      IF FORCED UPGRADE                            
         BZ    XVCM5F20                                                         
         MVI   CBLLUPG,C'F'        PUT F FOR UPGRADE?                           
         B     XVCM5F40                                                         
                                                                                
XVCM5F20 LA    RE,TAUHICBU         INDICATE WHETHER CABLE AND WILDSPOT          
         TM    TGUSSTA3,CBLUSE     PAYMENTS WERE UPGRADES                       
         BNZ   XVCM5F30                                                         
         LA    RE,TAUHIUNT                                                      
XVCM5F30 OC    0(L'TAUHICBU,RE),0(RE)                                           
         BZ    XVCM5F40                                                         
         MVI   CBLLUPG,C'Y'        PUT Y FOR UPGRADE                            
                                                                                
XVCM5F40 TM    TGUSSTA3,CBLUSE     FOR CABLE AND SPANISH CABLE                  
         BZ    XVCM5F50                                                         
         EDIT  TAUHCAUT,(4,CBLLAUT) DISPLAY AUTOMATIC CALCULATION               
         CLI   TGBYTE4,1                                                        
         JE    XIT                                                              
         CLI   TGBYTE4,2                                                        
         BE    XVCM5F41                                                         
         CLC   TAUHCAUT,TAUHCBUN                                                
         JE    XIT                                                              
XVCM5F41 EDIT  TAUHCBUN,(4,CBLLUNT) AND UNITS                                   
         J     XIT                                                              
                                                                                
XVCM5F50 EDIT  (2,TAUHWAUT),(4,CBLLAUT) FOR WILDSPOT                            
         CLI   TGBYTE4,1                                                        
         JE    XIT                                                              
         CLI   TGBYTE4,2                                                        
         BE    XVCM5F51                                                         
         CLC   TAUHWAUT,TAUHUNT         DISPLAY AUTOMATIC CALCULATION           
         JE    XIT                                                              
XVCM5F51 EDIT  (2,TAUHUNT),(4,CBLLUNT)  AND UNITS                               
         J     XIT                                                              
                                                                                
XVCM5F60 CLI   TAUHFRTY,0          FOR LOCAL CABLE                              
         BE    *+8                                                              
         MVI   CBLLUPG,C'Y'        INDICATE IF LAST PAYMENT WAS UPGRADE         
                                                                                
         TM    TAUHLCST,TAUHLSFI                                                
         BZ    *+8                                                              
         MVI   CBLLUPG,C'I'                                                     
                                                                                
         TM    TAUHLCST,TAUHLSFU                                                
         BZ    *+8                                                              
         MVI   CBLLUPG,C'F'                                                     
                                                                                
         MVC   TGUPFRTY,TAUHTYPE   SAVE LAST USE FOR POSSIBLE UPGRADE           
         EDIT  TAUHASUB,CBLLAUT    DISPLAY AUTOMATIC CALUCLATION                
         CLI   TGBYTE4,1                                                        
         JE    XIT                                                              
         CLI   TGBYTE4,2                                                        
         BE    XVCM5F61                                                         
         CLC   TAUHASUB,TAUHSUBS                                                
         JE    XIT                                                              
XVCM5F61 EDIT  TAUHSUBS,CBLLUNT    AND SUBSCRIBERS                              
         J     XIT                                                              
                                                                                
SETOVSTA NTR1                                                                   
         MVI   TGBYTE4,0           INITIALIZE TO NO OVERRIDE                    
                                                                                
         USING TLIND,R4                                                         
         LA    R4,KEY              READ LAST INVOICE KEY/RECORD                 
         XC    KEY,KEY                                                          
         MVI   TLINCD,TLINCDQ                                                   
         MVC   TLINAGY,TGAGY                                                    
         GOTO1 TINVCON,DMCB,LASTINV,TLININV,DATCON                              
         XC    TLININV,=6X'FF'                                                  
         GOTO1 HIGH                                                             
         CLC   TLINKEY,KEYSAVE                                                  
         JNE   XIT                                                              
         DROP  R4                                                               
                                                                                
         MVI   TGBYTE4,1                                                        
         GOTO1 GETREC                                                           
                                                                                
         USING TAPDD,R4                                                         
         L     R4,AIO                                                           
         MVI   ELCODE,TAPDELQ      IF MARKET INPUT WAS OVERRIDDEN               
         BRAS  RE,GETEL            SET STATUS                                   
         JNE   XIT                                                              
         TM    TAPDPST1,TAPDOVER                                                
         JZ    XIT                                                              
         MVI   TGBYTE4,2                                                        
         J     XIT                                                              
         DROP  R4                                                               
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (60 - FIRST MUSIC)                 
         SPACE 1                                                                
XVCM60   DS    0H                                                               
         LA    R2,FMULPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UFMU8W',34(R2)),('UFMU13W',43(R2)),      X        
               ('UFMU6M',51(R2)),(X'FF',0)                                      
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (61 - SPANISH WILDSPOT)            
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM61   DS    0H                                                               
         CLI   SWSUPGR,C'F'        DON'T BOTHER IF FORCING UPGRADE              
         JE    XIT                                                              
         SPACE                                                                  
         LA    R2,SWSLPAYH                                                      
         LA    R4,SWSLUPGH                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         SPACE                                                                  
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE 1                                                                
         TM    TAUHSTAT,TAUHSFUP   IF FORCED UPGRADE                            
         BZ    *+12                                                             
         MVI   SWSLUPG,C'F'        PUT F FOR UPGRADE?                           
         B     XVCM615                                                          
         OC    TAUHIUNT,TAUHIUNT   TEST FOR UPGRADE                             
         BZ    *+8                                                              
         MVI   SWSLUPG,C'Y'        PUT Y FOR UPGRADE?                           
         SPACE 1                                                                
XVCM615  EDIT  (2,TAUHUNT),(4,SWSLUNT),ZERO=NOBLANK  UNITS                      
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (62 - FOREIGN MUSIC)               
         SPACE 1                                                                
XVCM62   DS    0H                                                               
         LA    R2,FGMLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UFGMEU12',35(R2)),('UFGMEU24',43(R2)),   X        
               ('UFGMNE12',52(R2)),('UFGMNE24',60(R2)),                X        
               ('UFGMWO12',69(R2)),('UFGMWO24',77(R2)),(X'FF',0)                
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (63 - SPANISH NWK/WSP)             
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM63   DS    0H                                                               
         CLI   SNWUPGN,C'F'        DON'T BOTHER IF FORCING UPGRADE              
         JE    XIT                                                              
         CLI   SNWUPGW,C'F'                                                     
         JE    XIT                                                              
         CLI   SNWUPGC,C'F'                                                     
         JE    XIT                                                              
         SPACE                                                                  
         LA    R2,SNWLPAYH                                                      
         LA    R4,SNWLUPCH                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         SPACE                                                                  
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE 1                                                                
         MVI   BYTE,C'Y'           PUT Y FOR UPGRADE?                           
         TM    TAUHSTAT,TAUHSFUP   IF FORCED UPGRADE                            
         BZ    *+8                                                              
         MVI   BYTE,C'F'           PUT F FOR UPGRADE?                           
         TM    TAUHSTAT,TAUHSUPN   TEST FOR UPGRADE                             
         BZ    *+10                                                             
         MVC   SNWLUPN,BYTE                                                     
         TM    TAUHSTAT,TAUHSUPW                                                
         BZ    *+10                                                             
         MVC   SNWLUPW,BYTE                                                     
         TM    TAUHSTAT,TAUHSUPC                                                
         BZ    *+10                                                             
         MVC   SNWLUPC,BYTE                                                     
         SPACE 1                                                                
XVCM635  EDIT  (2,TAUHUNT),(4,SNWLUNT),ZERO=NOBLANK  UNITS                      
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (64 - ADDENDUM SESSION-TV)         
         SPACE 1                                                                
XVCM64   DS    0H                                                               
         OC    ADTHTY1,ADTHTY1     IF NO TYPE HEADINGS YET                      
         BZ    XVCM643                                                          
         TM    KFLDCHA,KCO         OR IF COMMERCIAL CHANGED                     
         BZ    XVCM645                                                          
         GOTO1 FLDVAL,DMCB,(X'01',ADTHTY1H),ADTHTY5H  CLEAR TYPE HEADS          
         GOTO1 FLDVAL,DMCB,(X'09',ADTTTY1H),ADTTTY5H  CLEAR AND PROTECT         
*                                                     TYPE INPUT FIELDS         
XVCM643  LA    R3,ADTHTY1H                                                      
         LA    R4,ADTTTY1H                                                      
         BRAS  RE,SETTYPES         SET VALID TYPES FOR THIS STATE               
*                                                                               
         LA    R3,ADTHTY3H                                                      
         LA    R4,ADTTTY3H                                                      
         BRAS  RE,DISNWA           DISPLAY HEADINGS FOR NORTHWEST ADD.          
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM645  LA    R3,TCTAUHEL                                                      
         LA    R2,ADTLPAYH                                                      
         LA    R4,ADTLTY5H                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE                                                                  
         CLI   ADDTYPES+1,X'FF'    DON'T BOTHER IF ONLY 1 TYPE                  
         JE    XIT                                                              
         LA    R4,ADDTYPES                                                      
         GOTOR DCHOICE,WORK,(0(R4),ADTLTY1),(1(R4),ADTLTY2),           X        
               (2(R4),ADTLTY3),(3(R4),ADTLTY4),(4(R4),ADTLTY5),        X        
               (X'FF',0)                                                        
*                                                                               
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         JNE   XIT                                                              
         DROP  R1                                                               
         TM    TAUHADST,TAUHAUNL   SHOW IF RATE IS 1-YR UNLIMITED OR            
         BZ    *+8                 SINGLE MARKET                                
         MVI   ADTLTY3,C'Y'                                                     
         TM    TAUHADST,TAUHASMK                                                
         JZ    XIT                                                              
         MVI   ADTLTY4,C'Y'                                                     
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (65 - ADDENDUM SESS-RADIO)         
         SPACE 1                                                                
XVCM65   DS    0H                                                               
         OC    ADOHTY1,ADOHTY1     IF NO TYPE HEADINGS YET                      
         BZ    XVCM653                                                          
         TM    KFLDCHA,KCO         OR IF COMMERCIAL CHANGED                     
         BZ    XVCM655                                                          
         GOTO1 FLDVAL,DMCB,(X'01',ADOHTY1H),ADOHTY5H  CLEAR TYPE HEADS          
         GOTO1 FLDVAL,DMCB,(X'09',ADOTTY1H),ADOTTY5H  CLEAR AND PROTECT         
*                                                     TYPE INPUT FIELDS         
XVCM653  LA    R3,ADOHTY1H                                                      
         LA    R4,ADOTTY1H                                                      
         BRAS  RE,SETTYPES         SET VALID TYPES FOR THIS STATE               
*                                                                               
         LA    R3,ADOHTY3H                                                      
         LA    R4,ADOTTY3H                                                      
         BRAS  RE,DISNWA           DISPLAY HEADINGS FOR NORTHWEST ADD.          
         SPACE                                                                  
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM655  LA    R3,TCTAUHEL                                                      
         LA    R2,ADOLPAYH                                                      
         LA    R4,ADOLTY5H                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE                                                                  
         CLI   ADDTYPES+1,X'FF'    DON'T BOTHER IF ONLY 1 TYPE                  
         JE    XIT                                                              
         LA    R4,ADDTYPES                                                      
         GOTOR DCHOICE,WORK,(0(R4),ADOLTY1),(1(R4),ADOLTY2),           X        
               (2(R4),ADOLTY3),(3(R4),ADOLTY4),(4(R4),ADOLTY5),        X        
               (X'FF',0)                                                        
*                                                                               
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         JNE   XIT                                                              
         DROP  R1                                                               
         TM    TAUHADST,TAUHAUNL   SHOW IF RATE IS 1-YR UNLIMITED OR            
         BZ    *+8                 SINGLE MARKET                                
         MVI   ADOLTY3,C'Y'                                                     
         TM    TAUHADST,TAUHASMK                                                
         JZ    XIT                                                              
         MVI   ADOLTY4,C'Y'                                                     
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (66 - ADDENDUM WILDSPOT)           
         SPACE 1                                                                
XVCM66   DS    0H                                                               
         OC    ADWHTY1,ADWHTY1     IF NO TYPE HEADINGS YET                      
         BZ    XVCM663                                                          
         TM    KFLDCHA,KCO         OR IF COMMERCIAL CHANGED                     
         BZ    XVCM665                                                          
         GOTO1 FLDVAL,DMCB,(X'01',ADWHTY1H),ADWHTY5H  CLEAR TYPE HEADS          
*        GOTO1 FLDVAL,DMCB,(X'09',ADWTTY1H),ADWTTY5H  CLEAR AND PROTECT         
*                                                     TYPE INPUT FIELDS         
XVCM663  CLI   TGUSEQU,UADW                                                     
         BNE   XVCM665                                                          
*                                                                               
         LA    R3,ADWHTY1H                                                      
         LA    R4,ADWTTY1H                                                      
         BRAS  RE,SETTYPES         SET VALID TYPES FOR THIS STATE               
*                                                                               
         LA    R3,ADWHTY3H                                                      
         LA    R4,ADWTTY3H                                                      
         BRAS  RE,DISNWA           DISPLAY HEADINGS FOR NORTHWEST ADD.          
*                                                                               
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM665  LA    R3,TCTAUHEL                                                      
         CLI   ADWUPGR,C'F'                                                     
         JE    XIT                 DON'T BOTHER IF FORCING UPGRADE              
         SPACE                                                                  
         LA    R2,ADWLPAYH                                                      
         LA    R4,ADWLTY5H                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         SPACE 1                                                                
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE 1                                                                
         MVI   ADWLUPG,0                                                        
         TM    TAUHSTAT,TAUHSFIN   IF FORCED INITIAL                            
         BZ    *+12                                                             
         MVI   ADWLUPG,C'I'        PUT I FOR UPGRADE?                           
         B     XVCM667                                                          
         TM    TAUHSTAT,TAUHSFUP   IF FORCED UPGRADE                            
         BZ    *+12                                                             
         MVI   ADWLUPG,C'F'        PUT F FOR UPGRADE?                           
         B     XVCM667                                                          
         OC    TAUHIUNT,TAUHIUNT   TEST FOR UPGRADE                             
         BZ    *+8                                                              
         MVI   ADWLUPG,C'Y'        PUT Y FOR UPGRADE?                           
         SPACE 1                                                                
XVCM667  EDIT  (2,TAUHWAUT),(4,ADWLAUT)               UNITS                     
         CLC   TAUHWAUT,TAUHUNT                                                 
         BE    XVCM668                                                          
         EDIT  (2,TAUHUNT),(4,ADWLUNT)                                          
         SPACE 1                                                                
XVCM668  CLI   ADDTYPES+1,X'FF'    DON'T BOTHER IF ONLY 1 TYPE                  
         JE    XIT                                                              
         LA    R4,ADDTYPES                                                      
         GOTOR DCHOICE,WORK,(0(R4),ADWLTY1),(1(R4),ADWLTY2),           X        
               (2(R4),ADWLTY3),(3(R4),ADWLTY4),(4(R4),ADWLTY5),        X        
               (X'FF',0)                                                        
*                                                                               
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         JNE   XIT                                                              
         DROP  R1                                                               
         TM    TAUHADST,TAUHAUNL   SHOW IF RATE IS 1-YR UNLIMITED               
         JZ    XIT                                                              
         MVI   ADWLTY3,C'Y'                                                     
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (67 - ADDEN COMB SESS/WSP)         
         SPACE 1                                                                
XVCM67   DS    0H                                                               
         OC    ADCHTY1,ADCHTY1     IF NO TYPE HEADINGS YET                      
         BZ    XVCM673                                                          
         TM    KFLDCHA,KCO         OR IF COMMERCIAL CHANGED                     
         BZ    XVCM675                                                          
         GOTO1 FLDVAL,DMCB,(X'01',ADCHTY1H),ADCHTY5H  CLEAR TYPE HEADS          
*        GOTO1 FLDVAL,DMCB,(X'09',ADCTTY1H),ADCTTY5H  CLEAR AND PROTECT         
*                                                     TYPE INPUT FIELDS         
XVCM673  LA    R3,ADCHTY1H                                                      
         LA    R4,ADCTTY1H                                                      
         BRAS  RE,SETTYPES         SET VALID TYPES FOR THIS STATE               
*                                                                               
         LA    R3,ADCHTY3H                                                      
         LA    R4,ADCTTY3H                                                      
         BRAS  RE,DISNWA           DISPLAY HEADINGS FOR NORTHWEST ADD.          
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM675  LA    R3,TCTAUHEL                                                      
         LA    R2,ADCLPAYH                                                      
         LA    R4,ADCLTY5H                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE 1                                                                
         EDIT  (2,TAUHUNT),(4,ADCLUNT),ZERO=NOBLANK  UNITS                      
         SPACE 1                                                                
         CLI   ADDTYPES+1,X'FF'    DON'T BOTHER IF ONLY 1 TYPE                  
         JE    XIT                                                              
         LA    R4,ADDTYPES                                                      
         GOTOR DCHOICE,WORK,(0(R4),ADCLTY1),(1(R4),ADCLTY2),           X        
               (2(R4),ADCLTY3),(3(R4),ADCLTY4),(4(R4),ADCLTY5),        X        
               (X'FF',0)                                                        
*                                                                               
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE IS NORTHWEST               
         JNE   XIT                                                              
         DROP  R1                                                               
         TM    TAUHADST,TAUHAUNL   SHOW IF RATE IS 1-YR UNLIMITED               
         JZ    XIT                                                              
         MVI   ADCLTY3,C'Y'                                                     
         J     XIT                                                              
         EJECT                                                                  
*&&DO                                                                           
*              DISPLAY USAGE HISTORY DETAILS (68 - INSERTS FOR BOOKEND)         
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM68   DS    0H                                                               
         CLI   IFBUPGR,C'F'        DON'T BOTHER IF FORCING UPGRADE              
         JE    XIT                                                              
         SPACE                                                                  
         LA    R2,IFBLPAYH                                                      
         LA    R4,IFBLUPGH                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         SPACE                                                                  
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE                                                                  
         TM    TAUHSTAT,TAUHSFUP   IF FORCED UPGRADE                            
         BZ    *+12                                                             
         MVI   IFBLUPG,C'F'        PUT F FOR UPGRADE?                           
         B     XVCM685                                                          
         OC    TAUHIINS,TAUHIINS   TEST FOR UPGRADE                             
         BZ    *+8                                                              
         MVI   IFBLUPG,C'Y'        PUT Y FOR UPGRADE?                           
         SPACE 1                                                                
XVCM685  EDIT  (2,TAUHINS),(4,IFBLINS),ZERO=NOBLANK  INSERTS                    
         J     XIT                                                              
         EJECT                                                                  
*&&                                                                             
*              POST-COMMERCIAL VALIDATION (69 - PRINT)                          
         SPACE 1                                                                
         USING TAPRD,R4                                                         
XVCM69   DS    0H                                                               
         LA    R2,PRTPRDH          R2=A(PRODUCT INPUT FLD)                      
         MVI   ELCODE,TAPRELQ                                                   
         L     R4,ACOML            SET R4=A(COMM'L REC IN AIO2)                 
         BAS   RE,GETEL2           GET 1ST PRODUCT ELEMENT                      
         BE    *+6                                                              
         DC    H'0'                                                             
         MVC   TGPRD,TAPRPRD       SAVE IT IF ONLY ONE PRODUCT                  
         BAS   RE,NEXTEL2                                                       
         BNE   *+10                                                             
         XC    TGPRD,TGPRD         ELSE CLEAR IT                                
         SPACE                                                                  
         GOTO1 RECVAL,DMCB,TLPRCDQ,(X'08',(R2)),PRTPRDNH  VALIDATE PRD          
         SPACE                                                                  
         L     R4,ACOML            SET R4=A(COMM'L REC IN AIO2)                 
         MVI   ELCODE,TAPRELQ                                                   
         BAS   RE,GETEL2           TEST PRODUCT VALID FOR COMM'L                
         B     *+8                                                              
XVCM695  BAS   RE,NEXTEL2                                                       
         BNE   PRDINV                                                           
         CLC   TAPRPRD,TGPRD       MATCH ON PRODUCT CODE                        
         BNE   XVCM695                                                          
         SPACE                                                                  
         USING TAISD,R4                                                         
         MVC   PRODPRD,TGPRD       INIT PROD. PRODUCT                           
         MVI   ELCODE,TAISELQ      GET INTERFACE SUBS. EL                       
         GOTO1 GETL,DMCB,(1,=AL1(TAISTYPP))                                     
         BNE   *+14                                                             
         L     R4,TGELEM                                                        
         MVC   PRODPRD,TAISCDE     SAVE PRODUCTION PRODUCT                      
         SPACE                                                                  
         GOTO1 RECVAL,DMCB,TLARCDQ,(X'08',PRTAREAH),PRTARENH   AREA             
         GOTO1 RECVAL,DMCB,TLUSCDQ,(X'08',PRTUSEH),PRTUSENH    USE              
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (6A - TAGS)                        
         SPACE 1                                                                
XVCM6A   DS    0H                                                               
         LA    R2,TAGLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         LA    R4,TAGLSESH                                                      
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         EDIT  (1,TAUHTAGS),(3,TAGLTAG),ZERO=NOBLANK  NUMBER OF TAGS            
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UTAGSESS',TAGLSES),(X'FF',0)                      
         J     XIT                                                              
         EJECT                                                                  
*              POST-COMMERCIAL VALIDATION (6B - SOR,SRH)                        
         SPACE 1                                                                
XVCM6B   DS    0H                                                               
         LA    R2,SORAREAH         R2=A(AREA FLD)                               
         GOTO1 ANY                                                              
         LA    RE,USOR5            RE=TYPE                                      
         ZIC   R1,=C'5'                                                         
XVCM6B2  CLM   R1,1,8(R2)          AREA MUST BE 1-5                             
         BE    XVCM6B3                                                          
         BCTR  R1,0                                                             
         BCT   RE,XVCM6B2                                                       
         J     FLDINV                                                           
         SPACE                                                                  
XVCM6B3  STC   RE,TYPE             SET TYPE                                     
         SPACE                                                                  
         GOTO1 USEVAL,DMCB,TGUSCDE,TYPE  VALIDATE TYPE, IF NOT VALID,           
         JNE   XIT                       DON'T BOTHER, WILL DIE IN 51           
         MVC   BYTE,TGUSTYMD             TEST IT'S VALID FOR THIS MEDIA         
         NC    BYTE,TGMEEQU                                                     
         JZ    MEDERR                                                           
         SPACE                                                                  
         LA    R2,SOREPISH         R2=A(EPIS FLD)                               
         BAS   RE,VALEPIS          VALIDATE INPUT                               
         BNE   MISSEPI                                                          
         OI    4(R2),X'20'         SET FLD VALID                                
         J     XIT                                                              
         EJECT                                                                  
*              POST-COMMERCIAL VALIDATION (6C - SDR,SDH,SWR,SWH)                
         SPACE 1                                                                
XVCM6C   DS    0H                                                               
         LA    R2,SDRTYPEH         R2=A(TYPE FLD)                               
         GOTO1 ANY                                                              
         CLI   TGUSEQU,USDR        TEST USE IS SDR OR SWR                       
         BE    *+12                                                             
         CLI   TGUSEQU,USWR                                                     
         BNE   XVCM6C1                                                          
         LA    RE,USDRINIT         RE=TYPE                                      
         CLC   WORK(3),=C'INI'                                                  
         BE    XVCM6C3                                                          
         LA    RE,USDR13K                                                       
         CLC   WORK(3),=C'13 '                                                  
         BE    XVCM6C3                                                          
         LA    RE,USDR18K                                                       
         CLC   WORK(3),=C'18 '                                                  
         JNE   FLDINV                                                           
         B     XVCM6C3                                                          
XVCM6C1  LA    RE,USDHINIT         RE=TYPE FOR SDH AND SWH                      
         CLC   WORK(3),=C'INI'                                                  
         BE    XVCM6C3                                                          
         LA    RE,USDH7K                                                        
         CLC   WORK(3),=C'7  '                                                  
         BE    XVCM6C3                                                          
         LA    RE,USDH10K                                                       
         CLC   WORK(3),=C'10 '                                                  
         JNE   FLDINV                                                           
         SPACE                                                                  
XVCM6C3  STC   RE,TYPE             SET TYPE                                     
         SPACE                                                                  
         GOTO1 USEVAL,DMCB,TGUSCDE,TYPE  VALIDATE TYPE, IF NOT VALID,           
         JNE   XIT                       DON'T BOTHER, WILL DIE IN 51           
         MVC   BYTE,TGUSTYMD             TEST IT'S VALID FOR THIS MEDIA         
         NC    BYTE,TGMEEQU                                                     
         JZ    MEDERR                                                           
         SPACE                                                                  
         LA    R2,SDREPISH         R2=A(EPIS FLD)                               
         BAS   RE,VALEPIS          VALIDATE INPUT                               
         BNE   MISSEPI                                                          
         SPACE 1                                                                
         OI    4(R2),X'20'         SET FLD VALID                                
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (6D - INDUST. REUSE)               
         SPACE 1                                                                
XVCM6D   DS    0H                                                               
         OI    INRCEDLH+1,X'0C'  INITIALIZE CANADIAN EXPIRATION DATE            
         OI    INRCEDLH+6,X'80'  FIELDS TO LOW INTENSITY AND PROTECTED          
         OI    INRCEDH+1,X'20'                                                  
         OI    INRCEDH+6,X'80'                                                  
         SPACE 1                                                                
         USING TACOD,R4                                                         
         LA    R4,ELTACO                                                        
         CLI   TACOCTYP,CCTY04A  IF ACTRA TYPE IS 2404A                         
         JE    XVCM6D05                                                         
         CLI   TACOCTYP,CCTY2404 OR 2404                                        
         JNE   XVCM6D10                                                         
XVCM6D05 LA    R2,INRCEDH                                                       
         ST    R2,AACTCYCE       SAVE A(ACTRA CYCLE END DATE FIELD)             
         NI    INRCEDLH+1,X'FB'  AND MAKE CANADIAN EXPIRATION DATE              
         NI    INRCEDH+1,X'DF'   FIELDS VISIBLE AND UNPROTECTED                 
         DROP  R4                                                               
         SPACE 1                                                                
XVCM6D10 LA    R2,INRLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UINR30D',36(R2)),('UINRUNL',48(R2)),     X        
               (X'FF',0)                                                        
         J     XIT                                                              
         SPACE 3                                                                
*              POST-COMMERCIAL VALIDATION (6E - SOC)                            
         SPACE 1                                                                
XVCM6E   DS    0H                                                               
         LA    R2,SOCGRSH          R2=A(GRS/EPI FLD)                            
         BAS   RE,VALGRSEP         VALIDATE IT                                  
         SPACE                                                                  
         LA    R2,SOCEPISH         R2=A(EPIS FLD)                               
         BAS   RE,VALEPIS          VALIDATE INPUT                               
         BNE   MISSEPI                                                          
         OI    4(R2),X'20'         SET FLD VALID                                
         SPACE 1                                                                
         LA    R2,SOCCID2H         R2=A(COMM ID2 FIELD)                         
         TM    4(R2),X'20'                                                      
         JO    XIT                                                              
         CLI   5(R2),0             INPUT REQUIRED                               
         JE    FLDMISS                                                          
         MVC   WORK2(L'TGCID),TGCID  SAVE TGCID DURING RECVAL                   
         GOTO1 RECVAL,DMCB,TLCOICDQ,(X'24',(R2))                                
         MVC   CID2,TGCID            SAVE CID2                                  
         MVC   TGCID,WORK2           RESTORE TGCID                              
         JNE   THEEND                                                           
         L     R3,AIO                                                           
         USING TLCOD,R3                                                         
         MVC   COM2,TLCOCOM        SAVE 2ND INT COMM #                          
         CLC   TGCOM,COM2          CAN'T BE SAME AS FIRST COMMERCIAL            
         JE    FLDINV                                                           
         MVI   ELCODE,TACOELQ      GET COMMERCIAL DETAILS EL.                   
         LR    R4,R3                                                            
         BAS   RE,GETEL2                                                        
         BE    *+6                                                              
         DC    H'0'                                                             
         USING TACOD,R4                                                         
         CLI   TACOTYPE,CTYSOAP    COMM'L TYPE MUST BE SOAP                     
         BNE   CTYPERR                                                          
         OI    4(R2),X'20'         SET FLD VALID                                
         J     XIT                                                              
         DROP R4                                                                
         EJECT                                                                  
*              POST-COMMERCIAL VALIDATION (6F - SDC,SWC)                        
         SPACE 1                                                                
XVCM6F   DS    0H                                                               
         LA    R2,SDCGRSH          R2=A(GRS/EPI FLD)                            
         BAS   RE,VALGRSEP         VALIDATE IT                                  
         SPACE                                                                  
         LA    R2,SDCEPISH         R2=A(EPIS FLD)                               
         BAS   RE,VALEPIS          VALIDATE INPUT                               
         BNE   MISSEPI                                                          
         OI    4(R2),X'20'         SET FLD VALID                                
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (70 - DEMOS)                       
         SPACE 1                                                                
         USING TAUHD,R3                                                         
XVCM70   DS    0H                                                               
         LA    R2,DEMLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         EDIT  (1,TAUHDEMS),(3,DEMLDEM),ZERO=NOBLANK  NUMBER OF DEMOS           
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (71 - LOCAL CABLE)                 
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM71   DS    0H                                                               
         CLI   LCBUPGR,C'F'                                                     
         JE    XIT                 DON'T BOTHER - FORCE UH FOR UPGRADE          
         SPACE                                                                  
         LA    R2,LCBLPAYH                                                      
         LA    R4,LCBLUPGH                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         SPACE 1                                                                
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE 1                                                                
         CLI   TGUSEQU,UACB        ADDENDUM CABLE?                              
         BNE   XVCM7120                                                         
         USING TACOD,R1                                                         
         LA    R1,ELTACO                                                        
         CLC   TACOADST,=C'NW'     IF ADDENDUM STATE NOT NORTHWEST              
         BE    XVCM718                                                          
         GOTOR DCHOICEH,PARAS,('UACB50',LCBL50H),('UACB100',LCBL100H), X        
               ('UACB150',LCBL150H),('UACB200',LCBL200H),              X        
               ('UACB250',LCBL250H),('UACB500',LCBL500H),              X        
               ('UACB750',LCBL750H),('UACB1M',LCBL1MIH),               X        
               ('UACBMAX',LCBLMAXH),(X'FF',0)                                   
         B     XVCM7130                                                         
*                                                                               
*        NORTHWEST ADDENDUM                                                     
XVCM718  TM    TAUHLCST,TAUHTMIL   IF RATE FOR 1 MILLION WAS ADDED IN           
         BO    XVCM7110                                                         
*                                                                               
         GOTOR DCHOICEH,PARAS,('UACB50',LCBL50H),('UACB100',LCBL100H), X        
               ('UACB150',LCBL150H),('UACB200',LCBL200H),              X        
               ('UACB250',LCBL250H),('UACB500',LCBL500H),              X        
               ('UACB750',LCBL750H),('UACB1M',LCBL1MIH),(X'FF',0)               
         B     XVCM7130                                                         
XVCM7110 GOTOR DCHOICEH,PARAS,('UACBM50',LCBL50H),                     X        
               ('UACBM100',LCBL100H),('UACBM150',LCBL150H),            X        
               ('UACBM200',LCBL200H),('UACBM250',LCBL250H),            X        
               ('UACBM500',LCBL500H),('UACBM750',LCBL750H),            X        
               ('UACBM1M',LCBL1MIH),(X'FF',0)                                   
         MVI   LCBLMAX,C'Y'         SELECT MILLION ON SCREEN                    
         OI    LCBLMAXH+6,X'80'                                                 
         B     XVCM7130                                                         
*                                                                               
XVCM7120 GOTOR DCHOICEH,PARAS,('ULCB50',LCBL50H),('ULCB100',LCBL100H), X        
               ('ULCB150',LCBL150H),('ULCB200',LCBL200H),              X        
               ('ULCB250',LCBL250H),('ULCB500',LCBL500H),              X        
               ('ULCB750',LCBL750H),('ULCB1M',LCBL1MIH),               X        
               ('ULCBMAX',LCBLMAXH),(X'FF',0)                                   
         SPACE                                                                  
XVCM7130 CLI   TAUHFRTY,0          IF UPGRADE                                   
         BE    *+8                                                              
         MVI   LCBLUPG,C'Y'        PUT Y FOR UPGRADE?                           
         TM    TAUHLCST,TAUHLSFU   IF FORCED UPGRADE                            
         BZ    *+8                                                              
         MVI   LCBLUPG,C'F'        PUT F FOR UPGRADE?                           
         SPACE 1                                                                
*&&UK                                                                           
         TM    TAUHLCBM,NY         MAJORS                                       
         BZ    *+8                                                              
         MVI   LCBLNY,C'Y'                                                      
         TM    TAUHLCBM,LA                                                      
         BZ    *+8                                                              
         MVI   LCBLLA,C'Y'                                                      
         TM    TAUHLCBM,CHI                                                     
         BZ    *+8                                                              
         MVI   LCBLCHI,C'Y'                                                     
*&&                                                                             
         J     XIT                                                              
         EJECT                                                                  
*&&DO                                                                           
*              DISPLAY USAGE HISTORY DETAILS (73 - TAGS)                        
         SPACE 1                                                                
XVCM73   DS    0H                                                               
         LA    R2,VARLPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         EDIT  (1,TAUHINS),(3,VARLVAR),ZERO=NOBLANK  NUMBER OF VAR/INS          
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (74 - VNW)                         
         SPACE 1                                                                
XVCM74   DS    0H                                                               
         LA    R2,VNWLPAYH                                                      
         LA    R4,VNWLVNWH                                                      
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         JNE   XIT                                                              
         SPACE 1                                                                
         EDIT  (1,TAUHINS),(3,VNWLVNW),ZERO=NOBLANK  NUMBER OF VAR/INS          
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UVNWSESS',VNWLSES),(X'FF',0)                      
         J     XIT                                                              
         EJECT                                                                  
*&&                                                                             
*              DISPLAY USAGE HISTORY DETAILS (76 - NBM)                         
         SPACE 1                                                                
XVCM75   DS    0H                                                               
         LA    R2,NBMLPAYH                                                      
         XR    R4,R4                                                            
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UNBM8WK',36(R2)),('UNBM1YR',48(R2)),     X        
               ('UNBM2YR',61(R2)),(X'FF',0)                                     
         J     XIT                                                              
         SPACE 3                                                                
         EJECT                                                                  
XVCM77   DS    0H                                                               
         LA    R2,ITNLPAYH                                                      
         XR    R4,R4                                                            
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         JNE   XIT                                                              
         SPACE 1                                                                
         LH    RF,TAUHINUS         IF NO NUMBER OF USES PRESENT                 
         CHI   RF,0                                                             
         BNE   XVCM77A                                                          
         MVI   ITNLPAY+27,C'X'     PAYMENT MUST HAVE BEEN AUTO                  
         J     XIT                                                              
         SPACE 1                                                                
XVCM77A  LH    RF,TAUHIFUS         DISPLAY LAST USE NUMBER PAID                 
         SHI   RF,1                                                             
         AH    RF,TAUHINUS                                                      
         EDIT  (RF),(3,ITNLPAY+35),ZERO=NOBLANK,ALIGN=LEFT                      
         SPACE                                                                  
         LH    RF,TAUHINUS         DISPLAY NUMBER OF USES PAID                  
         EDIT  (RF),(3,ITNLPAY+44),ZERO=NOBLANK,ALIGN=LEFT                      
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (79 - SPANISH FGN REUSE)           
         SPACE 1                                                                
XVCM79   DS    0H                                                               
         LA    R2,SFRLPAYH                                                      
         XR    R4,R4                                                            
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('USFRA',35(R2)),('USFRB',49(R2)),         X        
               ('USFRC',63(R2)),(X'FF',0)                                       
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (78 - HOLDING FEE)                 
         SPACE 1                                                                
XVCM78   DS    0H                                                               
         LA    R2,HLDLPAYH                                                      
         XR    R4,R4                                                            
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UHLDFCST',38(R2)),                       X        
               ('UHLDSCST',53(R2)),(X'FF',0)                                    
         SPACE 1                                                                
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (81 - INTERNET/NEW MEDIA)          
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM81   DS    0H                                                               
         LA    R2,IRNLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (82 - MOVE TO NEW MEDIA)           
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM82   DS    0H                                                               
         LA    R2,MOVLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UMVII8W',MOVLI8W),('UMVII1Y',MOVLI1Y),   X        
               ('UMVIEXT',MOVLE1Y),('UMVII4W',MOVLI4W),(X'FF',0)                
         GOTO1 FLDVAL,DMCB,(2,MOVLI4WH),MOVLE1YH                                
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (83 - LIFT)                        
         SPACE 1                                                                
XVCM83   DS    0H                                                               
         LA    R2,LFTLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICEH,WORK,('ULFTFFCY',LFTLFFCH),                    X        
               ('ULFTFFCN',LFTLNFFH),(X'FF',0)                                  
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (84 - RADIO GUARANTEE)             
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM84   DS    0H                                                               
         LA    R2,GRRLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
*                                                                               
         CLI   TAUHTYPE,0          EXIT IF TYPE WAS NOT SPECIFIED               
         JE    XIT                                                              
*                                                                               
         USING USETABD,RE                                                       
         L     RE,TGAUSES          RE=A(USE TABLE)                              
VVCM84A  CLI   0(RE),X'FF'                                                      
         JE    XIT                                                              
         CLC   USEEQU,TAUHTYPE     FIND TYPE IN USE TABLE                       
         BE    VVCM84B                                                          
         LH    RF,USELEN                                                        
         AR    RE,RF                                                            
         B     VVCM84A                                                          
*                                                                               
VVCM84B  MVC   GRRLPAY+30(3),USECDE     AND DISPLAY IT                          
         J     XIT                                                              
         DROP  RE                                                               
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (85 - GUARANTEE)                   
         SPACE 1                                                                
XVCM85   DS    0H                                                               
         LA    R2,GT2LPAYH       DISPLAY LAST INVOICE/CYCLE DATES               
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (86 - CANADIAN NEWMEDIA)           
         SPACE 1                                                                
XVCM86   DS    0H                                                               
         LA    R2,CNMLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UCNM4W',38(R2)),('UCNM8W',45(R2)),       X        
               ('UCNM26W',53(R2)),('UCNM1Y',60(R2)),(X'FF',0)                   
         EDIT  (2,TAUHUNT),(3,CNMLCUT)        CUTS                              
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (19 - STORECASTING)                
         SPACE 1                                                                
XVCM19   DS    0H                                                               
         LA    R2,STRLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
*                                                                               
         GOTOR DCHOICE,WORK,('USTRBUY',37(R2)),('USTR3MO',46(R2)),     X        
               ('USTR3ME',46(R2)),('USTR6MO',54(R2)),                  X        
               ('USTR6ME',54(R2)),(X'FF',0)                                     
*                                                                               
         GOTOR DCHOICE,WORK,('USTR3ME',63(R2)),('USTR6ME',63(R2)),     X        
               (X'FF',0)                                                        
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (7A - INDUSTRIAL SUPPL.)           
         SPACE 1                                                                
XVCM7A   DS    0H                                                               
         LA    R2,ISULPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH            DISPLAY LAST INVOICE/CYCLE DATES             
         GOTOR DCHOICE,WORK,('UISUW90',38(R2)),('UISUB90',65(R2)),     +        
               (X'FF',0)                                                        
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (1A - INM AND NIM)                 
         SPACE 1                                                                
XVCM1A   DS    0H                                                               
         LA    R2,MVMLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         CLI   TGUSEQU,UMVM                                                     
         BNE   XVCM1A10                                                         
         GOTOR DCHOICE,WORK,('UMVM8WK',35(R2)),('UMVM1YR',49(R2)),     +        
               (X'FF',0)                                                        
         GOTOR DCHOICE,WORK,('UMVM8WK',35(R2)),('UMVM26W',42(R2)),     +        
               ('UMVM1YR',49(R2)),(X'FF',0)                                     
         J     XIT                                                              
         SPACE 1                                                                
XVCM1A10 CLI   TGUSEQU,UNIM                                                     
         BE    *+6                                                              
         DC    H'00'                                                            
         GOTOR DCHOICE,WORK,('UNIM8WK',35(R2)),('UNIM6MO',42(R2)),     +        
               ('UNIM1YR',49(R2)),(X'FF',0)                                     
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (1B - IN HOME MUSIC)               
         SPACE 1                                                                
XVCM1B   DS    0H                                                               
         LA    R2,IHMLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         GOTOR DCHOICE,WORK,('UIHMTU1',37(R2)),('UIHMTO1',51(R2)),     +        
               ('UIHMONT',71(R2)),(X'FF',0)                                     
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (1D - INTERNET/NEW MEDIA)          
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
XVCM1D   DS    0H                                                               
         LA    R2,INULPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UINUI8W',INULI8W),('UINUR8W',INULI8W),   +        
               ('UINUI1Y',INULI1Y),('UINUR1Y',INULI1Y),                +        
               ('UINUEXT',INULE1Y),('UINUREX',INULE1Y),                +        
               ('UINUI4W',INULI4W),('UINUR4W',INULI4W),(X'FF',0)                
         GOTO1 FLDVAL,DMCB,(2,INULI4WH),INURADH                                 
         MVI   INULRAD,0                                                        
         CLI   TAUHTYPE,UINUI4W                                                 
         JE    XIT                                                              
         CLI   TAUHTYPE,UINUR8W                                                 
         JL    XIT                                                              
         MVI   INULRAD,C'X'                                                     
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (20 - EQUITY)                      
         SPACE 1                                                                
XVCM20   DS    0H                                                               
         LA    R2,EQYLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE 1                                                                
         LA    R2,EQYLPAY          DISPLAY LAST INVOICE/CYCLE DATES             
         GOTOR DCHOICE,WORK,('UEQY6M',25(R2)),('UEQY1Y',30(R2)),       X        
               (X'FF',0)                                                        
         J     XIT                                                              
         EJECT                                                                  
*              DISPLAY USAGE HISTORY DETAILS (21 - MUSIC BUYOUT)                
         SPACE 1                                                                
XVCM21   DS    0H                                                               
         LA    R2,MBOLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         CLI   TAUHLEN,0                                                        
         JE    XIT                                                              
         SPACE 1                                                                
         LA    R2,MBOLPAY          DISPLAY LAST INVOICE/CYCLE DATES             
         GOTOR DCHOICE,WORK,('UMBOI1Y',27(R2)),('UMBOR1Y',39(R2)),     X        
               (X'FF',0)                                                        
         J     XIT                                                              
         SPACE 3                                                                
*              DISPLAY USAGE HISTORY DETAILS (22 - NEWMEDIA CANADA)             
         SPACE 1                                                                
XVCM22   DS    0H                                                               
         LA    R2,NMCLPAYH         DISPLAY LAST INVOICE/CYCLE DATES             
         XR    R4,R4                                                            
         BAS   RE,DISUH                                                         
         JNE   XIT                                                              
         SPACE 1                                                                
         GOTOR DCHOICE,WORK,('UNMC3M',34(R2)),('UNMC6M',46(R2)),       X        
               ('UNMC1Y',58(R2)),(X'FF',0)                                      
         J     XIT                                                              
         SPACE 3                                                                
*              ROUTNE TO DISPLAY LAST INVOICE/CYCLE DATES                       
         SPACE 1                                                                
DISUH    NTR1                                                                   
         LTR   R4,R4             CLEAR UH DETAILS                               
         BNZ   *+6                                                              
         LR    R4,R2                                                            
         GOTO1 FLDVAL,DMCB,(X'01',(R2)),(R4)                                    
         SPACE 1                                                                
         CLI   TAUHLEN,0         RETURN NEGATIVE CONDITION CODE IF              
         BE    DUHNO             IF NO USAGE HISTORY                            
         SPACE 1                                                                
         BRAS  RE,DISLAST          DISPLAY LAST INVOICE/CYCLE DATES             
DUHYES   XR    RC,RC                                                            
DUHNO    LTR   RC,RC                                                            
         J     XIT                                                              
         EJECT                                                                  
*              ROUTINE VALIDATES GRS/EPI INPUT AT R2                            
         SPACE                                                                  
VALGRSEP NTR1                                                                   
         TM    4(R2),X'20'         DON'T BOTHER IF PREV VALIDATED               
         JO    XIT                                                              
         ZIC   R3,5(R2)                                                         
         LTR   R3,R3                                                            
         JZ    FLDMISS             INPUT REQUIRED                               
         GOTO1 CASHVAL,DMCB,8(R2),(R3)                                          
         CLI   0(R1),X'FF'                                                      
         JE    AMTINV                                                           
         TM    4(R1),X'80'         DON'T ALLOW NEGATIVE AMOUNTS                 
         JO    AMTINV                                                           
         OC    4(4,R1),4(R1)       DON'T ALLOW 0                                
         JZ    AMTINV                                                           
         MVC   TCGRSEPI,4(R1)      SAVE AMOUNT                                  
         OI    4(R2),X'20'         SET VALIDATED                                
         J     XIT                                                              
         SPACE 3                                                                
*              ROUTINE VALIDATES EPISODE INPUT AT R2                            
*              SETS CC EQUAL IF VALID INPUT, ELSE CC NOT EQUAL                  
*              AT END OF ROUTINE, EPITAB HAS TABLE OF EPISODES                  
*                                          USING EPITABD DSECT                  
         SPACE                                                                  
VALEPIS  NTR1                                                                   
         TM    4(R2),X'20'         IF FLD NOT VALIDATED                         
         BZ    VALEP4                                                           
         TM    KFLDCHA,KCO         OR COMMERCIAL CHANGED                        
         JZ    YES                                                              
         NI    4(R2),X'DF'         INVALIDATE IT FOR NEXT TIME IN               
         SPACE                                                                  
         USING TMPPAYD,R1                                                       
VALEP4   L     R1,ATMPPAYD         USE TEMPORARY STORAGE                        
         LA    R1,TSARAREA                                                      
         ST    R1,TCATSAR          SET A(TSAR RECORD)                           
         CLI   5(R2),0                                                          
         JE    FLDMISS             EPISODE INPUT REQUIRED                       
         GOTO1 SCANNER,DMCB,(R2),(X'80',BLOCK),C',=,-'                          
         ZIC   R0,4(R1)                                                         
         LTR   R0,R0               R0=N'FIELDS INPUT                            
         JZ    FLDINV                                                           
         SPACE                                                                  
         MVI   MYTSACTN,TSAINI     INITIALIZE TSAR BUFFER                       
         GOTOR CALLTSAR                                                         
         BRAS  RE,CLRTSAR          CLEAR TSAR RECORD AREA                       
         USING ECASTABD,R4         BUILD TSAR REC TO SAVE EPIS INPUT            
         USING SCAND,R3                                                         
         LA    R3,BLOCK            R3=A(SCAN BLOCK)                             
         L     R4,TCATSAR                                                       
         LA    R4,ECSTEPIS         R4=A(CURRENT ENTRY FOR EPISODE NUM)          
         LA    R5,EPITAB           R5=TABLE OF EPISODES                         
         XC    EPITAB,EPITAB                                                    
         MVI   0(R5),X'FF'                                                      
         MVI   PAYBYTE,0           PAYBYTE=COUNT OF NUMBER OF EPISODES          
         XC    TGFULL,TGFULL       TGFULL(2)=LAST EPISODE NUMBER                
         SPACE                                                                  
VALEP5   MVC   ERRDISP,SCDISP1     SET DISP. INTO FLD OF LHS FOR ERRORS         
         TM    SCVAL1,X'80'        INSURE NUMERIC INPUT ON LHS                  
         JZ    FLDINV                                                           
         CLI   SCLEN1,5            LENGTH MUST BE 5                             
         JNE   FLDINV                                                           
         CLC   SCBIN1+2(2),TGFULL  INSURE THIS EPISODE > PREV                   
         BNH   ASCENDER            (CHECK BEFORE RECVAL,IT USES TGFULL)         
         GOTO1 RECVAL,DMCB,TLEPCDQ,(X'80',SCDATA1)                              
         JNE   RECNTFD                                                          
         CLI   SCLEN2,0            IF RHS INPUT                                 
         BE    VALEP7                                                           
         MVC   ERRDISP,SCDISP2     SET DISP. INTO FLD OF RHS FOR ERRORS         
         TM    SCVAL2,X'80'        INSURE NUMERIC INPUT ON RHS                  
         JZ    FLDINV                                                           
         CLI   SCLEN2,5            LENGTH MUST BE 5                             
         JNE   FLDINV                                                           
         GOTO1 RECVAL,DMCB,TLEPCDQ,(X'80',SCDATA2)                              
         JNE   RECNTFD                                                          
         CLC   SCBIN1+2(2),SCBIN2+2 AND INSURE LHS LESS THAN RHS                
         BNL   ASCENDER                                                         
         SPACE 1                                                                
VALEP7   LH    RE,SCBIN1+2         RE=FIRST EPISODE NUMBER IN RANGE             
         LH    RF,SCBIN2+2         RF=LAST                                      
         MVI   ERRDISP,0           CLEAR DISPL. INTO FLD FOR ERROR              
         SPACE 1                                                                
VALEP8   CLI   PAYBYTE,MAXEPIS     TEST NOT MORE THAN MAX NUM OF EPIS           
         BL    VALEP8D                                                          
         B     INMAXEPI            AND GIVR ERROR                               
         SPACE 1                                                                
VALEP8D  STH   RE,0(R4)            SAVE EPISODE NUMBER IN TSAR REC              
         STH   RE,TGFULL           AND TGFULL                                   
         STH   RE,0(R5)            SAVE EPISODE NUMBER IN EPITABLE              
         LA    R4,EPINUMLN(R4)     BUMP TO NEXT EPISODE ENTRY                   
         LA    R5,EPITLNQ(R5)      BUMP TO NEXT EPISODE ENTRY EPITABLE          
         MVI   0(R5),X'FF'                                                      
         LA    RE,1(RE)            BUMP TO NEXT EPISODE NUMBER                  
         ZIC   R1,PAYBYTE          INCREMENT COUNT OF EPISODES                  
         LA    R1,1(R1)                                                         
         STC   R1,PAYBYTE                                                       
         CR    RE,RF               TEST NOT PAST LAST EPISODE NUM               
         BNH   VALEP8                                                           
VALEP9   LA    R3,SCANNEXT         LOOK FOR MORE INPUT                          
         BCT   R0,VALEP5                                                        
         SPACE 1                                                                
         MVI   ERRDISP,0           CLEAR DISPL. INTO FLD FOR ERROR              
         L     R4,TCATSAR                                                       
         MVC   ECSTNEPI,PAYBYTE    SAVE NUMBER OF EPISODES INPUT                
         MVI   MYTSACTN,TSAADD     ADD RECORD TO TSAR                           
         GOTOR CALLTSAR                                                         
         BE    *+6                 MUST BE OK - 1ST RECORD                      
         DC    H'0'                                                             
         SPACE 1                                                                
         DROP  R4                                                               
         USING ECASTABD,R2                                                      
         L     R2,TCATSAR                                                       
         ZIC   R0,ECSTNEPI         R0=N'EPISODES                                
         LA    R2,ECSTEPIS         R2=A(EPISODE NUM FOR CURRENT ENTRY)          
         LA    R3,EPISAIR          R3=A(ENTRY IN EPIS AIR DATE TABLE)           
         MVI   0(R3),X'FF'         INIT END OF TABLE                            
         SPACE 1                                                                
         USING EPISATBD,R3                                                      
VALEP12  LH    R1,0(R2)            EPISODE NUM IN BINARY                        
         CVD   R1,DUB                                                           
         UNPK  TGEPI,DUB+5(3)      CONVERT IT                                   
         OI    TGEPI+4,X'F0'                                                    
         GOTO1 RECVAL,DMCB,TLEPCDQ,(X'20',0)  GET EPISODE RECORD                
         JNE   NO                                                               
         L     R4,AIO                                                           
         MVI   ELCODE,TAEIELQ      GET EPISODE INFO ELEMENT                     
         BAS   RE,GETEL2                                                        
         BE    *+6                                                              
         DC    H'0'                MUST BE THERE                                
         USING TAEID,R4                                                         
         XC    EPATEPI(L'EPISAIR),EPATEPI  PRE-CLEAR ENTRY                      
**NO-OP  MVC   EPATAIR,TAEIADT     SAVE AIR DATE                                
         MVC   EPATAIR,TAEIWDT     SAVE WORK DATE INSTEAD OF AIR DATE           
         MVC   EPATEPI,0(R2)       SAVE BINARY EPISODE NUMBER                   
         LA    R3,EPATNXT          BUMP TO NEXT AIR DATE ENTRY                  
         MVI   0(R3),X'FF'         SET END OF TABLE                             
         LA    R2,EPINUMLN(R2)     BUMP TO NEXT TSAR EPISODE NUM                
         BCT   R0,VALEP12                                                       
*                                                                               
         CLI   TGUSEQU,USWC                                                     
         BE    VALEP15                                                          
         CLI   TGUSEQU,USWR                                                     
         BE    VALEP15                                                          
         CLI   TGUSEQU,USWN                                                     
         JNE   YES                                                              
VALEP15  BRAS  RE,FILLEPIT         FILL EPISODE STATUS TABLE                    
         J     YES                                                              
         EJECT                                                                  
*              ROUTINE SETS UP ERROR MESSAGE FOR MISSING EPISODE RECORD         
*              R2=A(EPISODE FIELD HEADER)                                       
         SPACE                                                                  
MISSEPI  DS    0H                                                               
         MVI   MYMSGNO1,ERRECEPI   EPISODE NUMBER NOT FOUND                     
         MVI   BLOCK,6                                                          
         MVC   BLOCK+1(5),TGEPI                                                 
         MVI   BLOCK+6,0                                                        
         MVI   MYMTYP,GTMERR       SET ERROR MESSAGE TYPE                       
         OI    GENSTAT2,USGETTXT   SET GETTXT BLOCK                             
         J     THEEND                                                           
         EJECT                                                                  
*              ERRORS,ETC.                                                      
         SPACE 1                                                                
PRDINV   MVI   ERROR,ERINVPRD      INVALID PRODUCT FOR PRINT COMMERCIAL         
         J     THEEND                                                           
         SPACE 1                                                                
ASCENDER MVI   ERROR,ERASCEND      MUST BE IN ASCENDING ORDER                   
         J     THEEND                                                           
         SPACE 1                                                                
INMAXEPI MVI   ERROR,ERMAXEPI      MAXIMUM OF 30 EPIS ALLOWED                   
         J     THEEND                                                           
         SPACE 1                                                                
CTYPERR  MVI   ERROR,ERUSECTY      INVALID USE FOR THIS COMM'L TYPE             
         J     THEEND                                                           
         SPACE 1                                                                
         LTORG                                                                  
         EJECT                                                                  
         SPACE                                                                  
         DROP R7                   DROP SECONDARY BASE REGISTER                 
         EJECT                                                                  
*              ROUTINE TO DETERMINE IF ALPHA CODE SHOULD BE USED TO             
*              READ FOR TMKT RECORDS                                            
         SPACE 1                                                                
USEALPH  NTR1  BASE=*,LABEL=*                                                   
         TM    TGMEEQU,LIKETV                                                   
         JZ    NO                                                               
         TM    TGUSSTA3,CBLUSE                                                  
         JNZ   NO                                                               
         CLI   TGUSEQU,ULCB                                                     
         JNE   YES                                                              
         J     NO                                                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*                                                                               
FILLEPIT NTR1  BASE=*,LABEL=*                                                   
         LA    R5,EPITAB           FILL STATUS IN EPISODE TABLE                 
         USING EPITABD,R5                                                       
FEPIT02  CLI   0(R5),X'FF'         END OF TABLE?                                
         JE    XIT                                                              
*                                                                               
         XC    KEY,KEY             GET ECAST RECORD AND SEARCH FOR              
         LA    R4,KEY              ALL SSN'S THAT ARE BREAKDOWN WRITERS         
         USING TLECD,R4                                                         
*                                                                               
         MVI   TLECCD,TLECCDQ                                                   
         MVC   TLECCOM,TGCOM       INTERNAL COMMERCIAL NUMBER                   
         SR    R1,R1                                                            
         ICM   R1,3,EPITNUM        EPISODE NUM IN BINARY                        
         CVD   R1,DUB                                                           
         UNPK  TLECEPI,DUB+5(3)    CONVERT IT                                   
         OI    TLECEPI+4,X'F0'                                                  
         XC    TLECEPI,=5X'FF'     COMPLEMENT EPISODE NUM                       
*                                                                               
         GOTO1 HIGH                                                             
         B     FEPIT06                                                          
*                                                                               
FEPIT04  GOTO1 SEQ                                                              
FEPIT06  CLC   KEY(TLECSORT-TLECCD),KEYSAVE                                     
         BNE   FEPIT20                                                          
*                                                                               
         GOTO1 GETREC                                                           
         L     R4,AIO                                                           
         MVI   ELCODE,TASOELQ                                                   
         BRAS  RE,GETEL                                                         
         BNE   FEPIT04                                                          
         USING TASOD,R4                                                         
*                                                                               
         TM    TASOSTAT,TASOSH     HEAD WRITER?                                 
         BZ    FEPIT08                                                          
         ZIC   RF,EPITNWH          KEEP TOTAL                                   
         AHI   RF,1                                                             
         STC   RF,EPITNWH                                                       
         B     FEPIT04                                                          
*                                                                               
FEPIT08  TM    TASOSTAT,TASOSS     SCRIPT WRITER?                               
         BZ    FEPIT10                                                          
         ZIC   RF,EPITNWS          KEEP TOTAL                                   
         AHI   RF,1                                                             
         STC   RF,EPITNWS                                                       
         B     FEPIT04                                                          
*                                                                               
FEPIT10  TM    TASOSTAT,TASOSB     BREAKDOWN WRITER?                            
         BZ    FEPIT04                                                          
         ZIC   RF,EPITNWB          KEEP TOTAL                                   
         AHI   RF,1                                                             
         STC   RF,EPITNWB                                                       
         B     FEPIT04                                                          
*                                                                               
FEPIT20  LA    R5,EPITLNQ(R5)                                                   
         B     FEPIT02                                                          
         DROP  R4,R5                                                            
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO ENSURE THAT NO CNET/MKT/CSYS CODE IS                  
*              ENTERED ON THE SCREEN MORE THAN ONCE                             
*              ON ENTRY ... R2=A(CNET/MKT/CSYS SCREEN FIELD TO CHECK)           
*                           R3=A(CNET/MKT/CSYS INTERNAL TABLE)                  
         SPACE 1                                                                
         USING MKTTABLD,R3                                                      
DUPCODE  NTR1  BASE=*,LABEL=*                                                   
         LA    RF,WSPFRSTH       RF=A(FIRST CNET/MKT/CSYS ENTRY)                
         CLI   TWASCR,SCR55                                                     
         BE    DC10                                                             
         LA    RF,CBLFRSTH                                                      
         CLI   TWASCR,SCR5F                                                     
         BE    DC10                                                             
         LA    RF,ADWFRSTH                                                      
         SPACE 1                                                                
DC10     ZIC   RE,0(RF)          BUMP RF TO CNET/MKT/CSYS CODE FIELD            
         AR    RF,RE                                                            
         ZIC   RE,0(RF)                                                         
         AR    RF,RE                                                            
         SPACE 1                                                                
         CR    RF,R2             WHEN RF GETS TO CURRENT ENTRY,                 
         JNL   XIT               NO DUPLICATES FOUND SO EXIT                    
         SPACE 1                                                                
         CLC   8(6,RF),8(R2)     ERROR IF THIS CODE ALREADY ENTERED             
         JE    FLDINV            RETURN ERROR                                   
         SPACE 1                                                                
         ZIC   RE,0(RF)                                                         
         AR    RF,RE                                                            
         B     DC10                                                             
         DROP  R3                                                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO SAVE AUTOMATIC UNITS/SUBSCRIBERS FIELD                
*              IN USAGE HISTORY ELEMENT                                         
*              ON ENTRY ... R2=A(AUTOMATIC UNITS SCREEN FIELD)                  
         SPACE 1                                                                
         USING TAUHD,R3                                                         
SVAUTOIN NTR1  BASE=*,LABEL=*                                                   
         LA    RF,TAUHCAUT       RF=A(AUTOMATIC UNITS FIELD)                    
         LHI   R1,L'TAUHCAUT     R1=L'AUTOMATIC UNITS FIELD                     
         TM    TGUSSTA3,CBLUSE   FOR CABLE AND SPANISH CABLE                    
         JNZ   SAI10                                                            
         SPACE 1                                                                
         LA    RF,TAUHASUB       RF=A(AUTOMATIC SUBSCRIBERS FIELD)              
         LHI   R1,L'TAUHASUB     R1=L'AUTOMATIC SUBSCRIBERS FIELD               
         CLI   TGUSEQU,ULCB      FOR LOCAL CABLE                                
         JE    SAI10                                                            
         SPACE 1                                                                
*                                RF=A(AUTOMATIC UNITS FIELD)                    
         LA    RF,TAUHWAUT       R1=L'AUTOMATIC UNITS FIELD                     
         LHI   R1,L'TAUHWAUT     FOR WILDSPOTS                                  
         SPACE 1                                                                
SAI10    BCTR  R1,0                                                             
         EX    R1,*+8                                                           
         J     *+10                                                             
         XC    0(0,RF),0(RF)     CLEAR OUT AUTOMATIC FIELD                      
         SPACE 1                                                                
         CLI   5(R2),0           EXIT IF AUTOMATIC UNITS WERE NOT               
         JE    XIT               CALCULATED                                     
         SPACE 1                                                                
         CLI   VERSION,0         IF NOT A VERSION PAYMENT                       
         JNE   SAI30             THAT WAS NOT OVERRIDDEN                        
         TM    PAYSTAT1,OVERMKTS TCUNITS/TCSUBS HAS CALCULATED AMOUNT           
         JNZ   SAI30             SAVE IT IN ELEMENT                             
         CLI   TGUSEQU,ULCB                                                     
         JE    SAI20                                                            
         MVC   0(L'TAUHCAUT,RF),TCUNITS                                         
         TM    TGUSSTA3,CBLUSE   IF CABLE OR SPANISH CABLE                      
         JZ    XIT               ALSO SAVE AUTOMATIC SUBSCRIBERS                
         MVC   TAUHCSUB,SVINPSUB                                                
         J     XIT                                                              
SAI20    MVC   0(L'TAUHASUB,RF),TCSUBS                                          
         J     XIT               AND EXIT                                       
         SPACE 1                                                                
SAI30    SR    R1,R1             IF A VERSION PAYMENT                           
         CLI   5(R2),0           OR OVERRIDING A NON-VERSION PAYMENT            
         JE    *+8               PUT AUTOMATIC CALCULATION INTO R1              
         BRAS  RE,VALUNITS                                                      
         SPACE 1                                                                
         TM    TGUSSTA3,CBLUSE   IF CABLE OR SPANISH CABLE                      
         JZ    SAI50                                                            
         CLI   VERSION,0                                                        
         JE    *+8                                                              
         AH    R1,TAUHICBU       ADD INITIAL UNITS TO AUTOMATIC                 
         STH   R1,TAUHCAUT       AND SAVE AS CURRENT AUTOMATIC                  
         MVC   TAUHCSUB,SVINPSUB SAVE AUTOMATIC SUBSCRIBERS                     
         J     XIT                                                              
         SPACE 1                                                                
SAI50    CLI   TGUSEQU,ULCB      IF PAYING LOCAL CABLE                          
         JNE   SAI60             ADD AUTOMATIC SUBSCRIBERS                      
         CLI   VERSION,0                                                        
         JE    *+8                                                              
         A     R1,TAUHISUB       TO INITIAL SUBSCRIBERS                         
         ST    R1,TAUHASUB       AND SAVE AS NEW AUTOMATIC                      
         J     XIT                                                              
         SPACE 1                                                                
SAI60    CLI   VERSION,0                                                        
         JE    *+8                                                              
         AH    R1,TAUHIUNT       FOR WILDSPOTS, ADD AUTOMATIC                   
         STH   R1,TAUHWAUT       UNITS TO INTITIAL UNITS                        
         J     XIT               AND SAVE AS AUTOMATIC                          
         SPACE 2                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE SAVES PREVIOUS PAYMENT INFORMATION FOR UPGRADES          
*              AND WHETHER OR NOT IT WAS FORCED IN USAGE HISTORY ELEM           
                                                                                
         USING TAUHD,R3                                                         
SVUPGINF NTR1  BASE=*,LABEL=*                                                   
         TM    TGUSTYST,UPGRADE    TEST FOR UPGRADE                             
         JZ    XIT                                                              
         MVC   TAUHTYPE,TGUPTOTY   SET NEW UPGRADED TYPE                        
                                                                                
         LA    R1,TAUHLCST         R1=A(FORCED UPGRADE STATUS FIELD)            
         CLI   TGUSEQU,ULCB        FOR LOCAL CABLE                              
         JE    BUE20                                                            
                                                                                
         LA    R1,TAUHCSTA         R1=A(FORCED UPGRADE STATUS FIELD)            
         LA    RE,TAUHICBU         RE=A(INITIAL UNITS FIELD)                    
         LA    RF,TAUHCBUN         RF=A(PREVIOUS UNITS FIELD)                   
         TM    TGUSSTA3,CBLUSE                                                  
         JNZ   BUE10                                                            
                                                                                
         LA    R1,TAUHSTAT          R1=A(FORCED UPGRADE STATUS FIELD)           
         LA    RE,TAUHIUNT          RE=A(INITIAL UNITS FIELD)                   
         LA    RF,TAUHUNT           RF=A(PREVIOUS UNITS FIELD)                  
         MVC   TAUHIMAJ,TAUHMAJ     FOR WILDSPOTS                               
                                                                                
BUE10    MVC   0(L'TAUHICBU,RE),0(RF) MOVE PREVIOUS UNITS TO INITIAL            
                                                                                
BUE20    NI    0(R1),X'FF'-TAUHSFUP-TAUHSFIN                                    
                                                                                
         TM    LCLSTAT3,FORCEUPG   IF FORCING UPGRADE                           
         JZ    *+8                                                              
         OI    0(R1),TAUHSFUP      SET FORCED UPGRADE INDICATOR                 
         SPACE 1                                                                
         CLI   TGUSEQU,ULCB        FOR LOCAL CABLE                              
         JNE   XIT                                                              
         MVC   TAUHFRTY,TGUPFRTY   SET UPGRADE "FROM" TYPE                      
         MVC   TAUHISUB,TAUHSUBS   AND INITIAL SUBSCRIBERS                      
         J     XIT                                                              
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              INITIALIZATION ROUTINES                                          
         SPACE 1                                                                
         DS    0D                                                               
INIT     NTR1  BASE=*,LABEL=*                                                   
         SPACE                                                                  
         GOTO1 LOADPAY             LOAD PAY COMMON ROUTINES                     
         GOTO1 APAYINIT,DMCB,0     PAY INITIALIZE                               
         SPACE 1                                                                
         LAY   R3,SCRTBL           LOOK UP SCREEN TABLE ENTRY                   
         USING SCRND,R3                                                         
         XR    R0,R0                                                            
INIT4    CLC   TWASCR,SCRCODE      MATCH ON SCREEN CODE                         
         BE    INIT6                                                            
         IC    R0,SCRLEN           ELSE BUMP TO NEXT                            
         AR    R3,R0                                                            
         CLI   0(R3),0                                                          
         BNE   INIT4                                                            
         DC    H'0'                                                             
         SPACE 1                                                                
INIT6    MVC   DSPFLDS(DSPLNQ),SCRDSPS  SAVE DISPLACEMENTS                      
         SPACE 1                                                                
         LH    R4,DSPOVLY          POINT TO BEGINNING OF DETAIL SCREEN          
         AR    R4,RA                                                            
         USING DTLD,R4                                                          
         LA    RF,DTLFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,DTLLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         LA    RF,DTLCMNTH                                                      
         ST    RF,ADTLCMTH                                                      
         LA    RF,DTLDUEH                                                       
         ST    RF,ADTLDUEH                                                      
         SPACE 1                                                                
         TM    PAYMODE,DTLONSCR    IF DETAIL SCREEN NOT LOADED                  
         JO    XIT                                                              
         TM    PAYCIDH+4,X'20'     AND COMMERCIAL FIELD NOT VALIDATED           
         BO    INIT8                                                            
         LH    R2,DSPCMNT          CLEAR COMMERCIAL COMMENT                     
         AR    R2,RA                                                            
         OC    8(L'COMCMNT,R2),8(R2)  IF NECESSARY                              
         BZ    *+14                                                             
         XC    8(L'COMCMNT,R2),8(R2)                                            
         OI    6(R2),X'80'                                                      
         SPACE 1                                                                
         LH    R2,DSPDUE           MAKE DUE DATE FIELD ZERO INTENSITY           
         AR    R2,RA                                                            
         TM    1(R2),X'0C'         IF NECESSARY                                 
         BO    *+12                                                             
         OI    1(R2),X'0C'                                                      
         OI    6(R2),X'80'                                                      
         SPACE 1                                                                
INIT8    LH    RF,SCRINIT          RF=A(DISP. TO INDIV. INIT. ROUTINE)          
         LTR   RF,RF                                                            
         JZ    XIT                                                              
         AR    RF,RB                                                            
         LA    RE,INITX            SET RE FOR COMMON NTR1                       
         NTR1                                                                   
         BR    RF                  ** INITIALIZE INDIVIDUAL SCREEN **           
         SPACE 1                                                                
INITX    J     XIT                                                              
         EJECT                                                                  
*              INITIALIZE SCREEN  (20 - EQUITY)                                 
         SPACE 1                                                                
INIT20   DS    0H                                                               
         LA    R2,EQYLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,EQYTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (21 - MUSIC BUYOUT)                           
         SPACE 1                                                                
INIT21   DS    0H                                                               
         LA    R2,MBOLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,MBOTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (22 - NEW MEDIA CANADA)                       
         SPACE 1                                                                
INIT22   DS    0H                                                               
         LA    R2,NMCLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,NMCTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (BF - TV SESSION)                             
         SPACE 1                                                                
INITBF   DS    0H                                                               
         LA    RF,BSSFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,BSSLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (BE - GENERAL)                                
         SPACE 1                                                                
INITBE   DS    0H                                                               
         LA    R2,PAYLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,PAYTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (BD - DEALER)                                 
         SPACE 1                                                                
INITBD   DS    0H                                                               
         LA    R2,DLRLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,DLRTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (BC - RADIO NETWORK)                          
         SPACE 1                                                                
INITBC   DS    0H                                                               
         LA    R2,RNTLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,RNTTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (BB - WILDSPOT)                               
         SPACE 1                                                                
INITBB   DS    0H                                                               
         LA    R2,WSPLPAYH                                                      
         LA    R3,WSPLUPGH                                                      
         LA    R4,WSPTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (BA - NETWORK / CLASS A)                      
         SPACE 1                                                                
INITBA   DS    0H                                                               
         TM    PAYCIDH+4,X'20'     IF COMMERCIAL FIELD NOT VALIDATED            
         BO    INBA2                                                            
         OC    CLALSTI,CLALSTI     AND IF NECESSARY                             
         BZ    INBAX                                                            
         XC    CLALSTI,CLALSTI     CLEAR USAGE HISTORY DETAILS                  
         OI    CLALSTIH+6,X'80'                                                 
         XC    CLALSTC,CLALSTC                                                  
         OI    CLALSTCH+6,X'80'                                                 
         XC    CLALSTU,CLALSTU                                                  
         OI    CLALSTUH+6,X'80'                                                 
         XC    CLALSTL,CLALSTL                                                  
         OI    CLALSTLH+6,X'80'                                                 
         XC    CLALSTG,CLALSTG                                                  
         OI    CLALSTGH+6,X'80'                                                 
         SPACE 1                                                                
INBA2    OI    CLATOTSH+1,X'0C'    MAKE TOTALS FIELD ZERO INTENSITY             
         OI    CLATOTSH+6,X'80'                                                 
INBAX    J     XIT                                                              
         EJECT                                                                  
*              INITIALIZE SCREEN  (B9 - CABLE)                                  
         SPACE 1                                                                
INITB9   DS    0H                                                               
         LA    R2,CABLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,CABTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (B8 - MUSIC)                                  
         SPACE 1                                                                
INITB8   DS    0H                                                               
         LA    R2,MUSLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,MUSTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (76 - MUSIC RATE REUSE)                       
         SPACE 1                                                                
INIT76   DS    0H                                                               
         LA    R2,MRRLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,MRRTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (AF - MUSIC SESSION)                          
         SPACE 1                                                                
INITAF   DS    0H                                                               
         LA    RF,BSMFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,BSMLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (58 - RADIO SESSION)                          
         SPACE 1                                                                
INIT58   DS    0H                                                               
         LA    RF,BSRFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,BSRLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         EJECT                                                                  
*              INITIALIZE SCREEN  (A6 - GUARANTEE)                              
         SPACE 1                                                                
INITA6   DS    0H                                                               
         LA    R2,GRTLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,GRTTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (59 - RADIO REGIONAL NETWORK)                 
         SPACE 1                                                                
INIT59   DS    0H                                                               
         LA    R2,RRNLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,RRNTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (5C - LOCAL REUSE)                            
         SPACE 1                                                                
INIT5C   DS    0H                                                               
         LA    R2,LOCLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,LOCTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (5D - SOAPS)                                  
         SPACE 1                                                                
INIT5D   DS    0H                                                               
         LA    RF,SOPDAT1H         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         LA    RF,SOPFRSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,SOPLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (5E - FOREIGN REUSE)                          
         SPACE 1                                                                
INIT5E   DS    0H                                                               
         LA    R2,FGRLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,FGRTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (5F - CABLE - BDCAST TV)                      
         SPACE 1                                                                
INIT5F   DS    0H                                                               
         LA    R2,CBLLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,CBLTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (60 - FIRST MUSIC)                            
         SPACE 1                                                                
INIT60   DS    0H                                                               
         LA    R2,FMULPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,FMUTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (61 - SPANISH WILDSPOT)                       
         SPACE 1                                                                
INIT61   DS    0H                                                               
         LA    R2,SWSLPAYH                                                      
         LA    R3,SWSLUPGH                                                      
         LA    R4,SWSTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (62 - FOREIGN MUSIC)                          
         SPACE 1                                                                
INIT62   DS    0H                                                               
         LA    R2,FGMLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,FGMTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (63 - SPANISH NETWORK/WILDSPOT COMB.)         
         SPACE 1                                                                
INIT63   DS    0H                                                               
         LA    R2,SNWLPAYH                                                      
         LA    R3,SNWLUPCH                                                      
         LA    R4,SNWTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (64 - ADDENDUM SESSION - TV)                  
         SPACE 1                                                                
INIT64   DS    0H                                                               
         LA    RF,ADTFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,ADTLSTH                                                       
         ST    RF,ADTLLSTH                                                      
*                                                                               
         TM    PAYMODE,DTLDSPLD                                                 
         JO    XIT                                                              
         LA    R2,ADTLPAYH                                                      
         LA    R3,ADTLTY5H                                                      
         XR    R4,R4                                                            
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (65 - ADDENDUM SESSION - RADIO)               
         SPACE 1                                                                
INIT65   DS    0H                                                               
         LA    RF,ADOFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,ADOLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         TM    PAYMODE,DTLDSPLD    IF DETAIL INFO NOT ALREADY DISPLAYED         
         JO    XIT                                                              
         LA    R2,ADOLPAYH                                                      
         LA    R3,ADTLTY5H                                                      
         XR    R4,R4                                                            
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (66 - ADDENDUM WILDSPOT)                      
         SPACE 1                                                                
INIT66   DS    0H                                                               
         LA    R2,ADWLPAYH                                                      
         LA    R3,ADWLTY5H                                                      
         LA    R4,ADWTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (67 - ADDENDUM COMBINED SESS/WSP)             
         SPACE 1                                                                
INIT67   DS    0H                                                               
         LA    R2,ADCLPAYH                                                      
         LA    R3,ADCLTY5H                                                      
         LA    R4,ADCTOTSH                                                      
         B     INITSIMP                                                         
*&&DO                                                                           
         SPACE 3                                                                
*              INITIALIZE SCREEN  (68 - INSERTS FOR BOOKENDS)                   
         SPACE 1                                                                
INIT68   DS    0H                                                               
         LA    R2,IFBLPAYH                                                      
         LA    R3,IFBLUPGH                                                      
         LA    R4,IFBTOTSH                                                      
         B     INITSIMP                                                         
*&&                                                                             
         EJECT                                                                  
*              INITIALIZE SCREEN  (69 - PRINT)                                  
         SPACE 1                                                                
INIT69   DS    0H                                                               
         LA    RF,PRTFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,PRTLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (6A - TAGS)                                   
         SPACE 1                                                                
INIT6A   DS    0H                                                               
         LA    R2,TAGLPAYH                                                      
         LA    R3,TAGLSESH                                                      
         LA    R4,TAGTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (6B - SOAP RESIDUALS)                         
         SPACE 1                                                                
INIT6B   DS    0H                                                               
         LA    RF,SORFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,SORLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (6C - SOAP RESIDUALS-DIRCTR & WRITER)         
         SPACE 1                                                                
INIT6C   DS    0H                                                               
         LA    RF,SDRFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,SDRLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         EJECT                                                                  
*              INITIALIZE SCREEN  (6D - INDUST. REUSE)                          
         SPACE 1                                                                
INIT6D   DS    0H                                                               
         LA    R2,INRLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,INRTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (6E - SOAP RESIDUALS)                         
         SPACE 1                                                                
INIT6E   DS    0H                                                               
         LA    RF,SOCFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,SOCLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (6F - SOAP RESIDUALS-DIRCTR & WRITER)         
         SPACE 1                                                                
INIT6F   DS    0H                                                               
         LA    RF,SDCFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,SDCLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         EJECT                                                                  
*              INITIALIZE SCREEN  (70 - DEMOS)                                  
         SPACE 1                                                                
INIT70   DS    0H                                                               
         LA    R2,DEMLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,DEMTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (71 - LOCAL CABLE)                            
         SPACE 1                                                                
INIT71   DS    0H                                                               
         TM    PAYCIDH+4,X'20'     IF COMMERCIAL FIELD NOT VALIDATED            
         BO    IN7120                                                           
         OC    LCBLPAY,LCBLPAY     AND IF NECESSARY                             
         BZ    IN7120                                                           
         XC    LCBL50,LCBL50                                                    
         OI    LCBL50H+6,X'80'                                                  
         XC    LCBL100,LCBL100                                                  
         OI    LCBL100H+6,X'80'                                                 
         XC    LCBL150,LCBL150                                                  
         OI    LCBL150H+6,X'80'                                                 
         XC    LCBL200,LCBL200                                                  
         OI    LCBL200H+6,X'80'                                                 
         XC    LCBL250,LCBL250                                                  
         OI    LCBL250H+6,X'80'                                                 
         XC    LCBL500,LCBL500                                                  
         OI    LCBL500H+6,X'80'                                                 
         XC    LCBL750,LCBL750                                                  
         OI    LCBL750H+6,X'80'                                                 
         XC    LCBL1MI,LCBL1MI                                                  
         OI    LCBL1MIH+6,X'80'                                                 
*                                                                               
         SPACE 1                                                                
IN7120   OI    LCBTOTCH+1,X'0C'                                                 
         OI    LCBTOTCH+6,X'80'                                                 
         SPACE 1                                                                
         LA    R2,LCBLPAYH                                                      
         LA    R3,LCBLUPGH                                                      
         LA    R4,LCBTOTIH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (72 - P&H ONLY)                               
         SPACE 1                                                                
INIT72   DS    0H                                                               
         LA    RF,PNHFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,PNHLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*&&DO                                                                           
*              INITIALIZE SCREEN  (73 - VARIATIONS/INSERTS)                     
         SPACE 1                                                                
INIT73   DS    0H                                                               
         LA    R2,VARLPAYH                                                      
         LA    R3,VARLVARH                                                      
         LA    R4,VARTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (74 - VARIATIONS/INSERTS NON-WORKING)         
         SPACE 1                                                                
INIT74   DS    0H                                                               
         LA    R2,VNWLPAYH                                                      
         LA    R3,VNWLVNWH                                                      
         LA    R4,VNWTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*&&                                                                             
*              INITIALIZE SCREEN  (76 - NON-BROADCAST MUSIC)                    
         SPACE 1                                                                
INIT75   DS    0H                                                               
         LA    R2,NBMLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,NBMTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (77 - ITN)                                    
         SPACE 1                                                                
INIT77   DS    0H                                                               
         LA    R2,ITNLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,ITNTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (79 - SPANISH FOREIGN REUSE)                  
         SPACE 1                                                                
INIT79   DS    0H                                                               
         LA    R2,SFRLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,SFRTOTSH                                                      
         B     INITSIMP                                                         
*                                                                               
*              INITIALIZE SCREEN  (78 - HOLDING FEE)                            
         SPACE 1                                                                
INIT78   DS    0H                                                               
         TM    PAYSTAT1,CASTSELD                                                
         BZ    IN78A                                                            
         USING TACOD,R1                                                         
         L     R1,TCATACO                                                       
         CLI   TACOSPCY,C'Y'                                                    
         BNE   IN78A                                                            
         MVI   HLDSEL,C'X'                                                      
         MVI   HLDSELH+5,1                                                      
         OI    HLDSELH+6,X'80'                                                  
         OC    HSD(HSLNQ),HSD                                                   
         BZ    IN78A                                                            
         MVC   HLDAUTH,HSAUTH                                                   
         MVC   HLDEST,HSEST                                                     
         MVC   HLDPD,HSPD                                                       
         MVC   HLDCYC,HSCYC                                                     
         MVC   HLDDTL,HSDTL                                                     
         MVC   HLDBNP,HSBNP                                                     
         MVC   HLDEINV,HSEINV                                                   
         MVC   HLDHCOM,HSHCOM                                                   
         MVC   HLDOPT,HSOPT                                                     
         MVC   HLDICOM,HSICOM                                                   
         GOTO1 FLDVAL,DMCB,(X'02',HLDAUTHH),(X'80',HLDICOMH)                    
         XC    HSD(HSLNQ),HSD                                                   
*                                                                               
IN78A    LA    R2,HLDLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,HLDTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (81 - INTERNET/NEW MEDIA)                     
         SPACE 1                                                                
INIT81   DS    0H                                                               
         LA    R2,IRNLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,IRNTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*                                                                               
*              INITIALIZE SCREEN  (82 - MOVE TO NEW MEDIA)                      
         SPACE 1                                                                
INIT82   DS    0H                                                               
         LA    R2,MOVLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,MOVTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (83 - LIFTS)                                  
         SPACE 1                                                                
INIT83   DS    0H                                                               
         LA    R2,LFTLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,LFTTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (84 - RADIO GUARANTEE)                        
         SPACE 1                                                                
INIT84   DS    0H                                                               
         LA    R2,GRRLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,GRRTOTSH                                                      
         B     INITSIMP                                                         
         EJECT                                                                  
*              INITIALIZE SCREEN  (85 - GUARANTEE)                              
         SPACE 1                                                                
INIT85   DS    0H                                                               
         LA    R2,GT2LPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,GT2TOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (86 - CANADIAN NEWMEDIA)                      
         SPACE 1                                                                
INIT86   DS    0H                                                               
         LA    R2,CNMLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,CNMTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (16 - INDUSTRIAL RETAKE SESSION)              
         SPACE 1                                                                
INIT16   DS    0H                                                               
         LA    RF,RTKFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,RTKLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (17 - INDUSTRIAL AUDIO SESSION)               
         SPACE 1                                                                
INIT17   DS    0H                                                               
         LA    RF,DIOFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,DIOLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (18 - INTERACTIVE VOICE SESSION)              
         SPACE 1                                                                
INIT18   DS    0H                                                               
         LA    RF,IVRFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,IVRLSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         SPACE 3                                                                
*              INITIALIZE SCREEN  (19 - INDUSTRIAL STORECASTING)                
         SPACE 1                                                                
INIT19   DS    0H                                                               
         LA    R2,STRLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,STRTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (7A - INDUSTRIAL SUPPLEMENTAL)                
         SPACE 1                                                                
INIT7A   DS    0H                                                               
         LA    R2,ISULPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,ISUTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (1A - INM AND NIM)                            
         SPACE 1                                                                
INIT1A   DS    0H                                                               
         LA    R2,MVMLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,MVMTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (1B - IN HOME MUSIC)                          
         SPACE 1                                                                
INIT1B   DS    0H                                                               
         LA    R2,IHMLPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,IHMTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (1D - INTERNET/NEW MEDIA)                     
         SPACE 1                                                                
INIT1D   DS    0H                                                               
         LA    R2,INULPAYH                                                      
         XR    R3,R3                                                            
         LA    R4,INUTOTSH                                                      
         B     INITSIMP                                                         
         SPACE 3                                                                
*              INITIALIZE SCREEN  (1E - EVENT)                                  
         SPACE 1                                                                
INIT1E   DS    0H                                                               
         LA    RF,EVEFRSTH         SAVE SOME DETAIL SCREEN ADDRESSES            
         ST    RF,ADTLFSTH                                                      
         ST    RF,ADTLCURH                                                      
         LA    RF,EVELSTH                                                       
         ST    RF,ADTLLSTH                                                      
         J     XIT                                                              
         EJECT                                                                  
*              INITIALIZE SCREEN  (1F - VRE/VNR)                                
         SPACE 1                                                                
INIT1F   DS    0H                                                               
         J     XIT                                                              
         EJECT                                                                  
*              ROUTINE FOR INITIALIZING SIMPLE SCREENS                          
         SPACE 1                                                                
INITSIMP TM    CONRECH+4,X'20'     IF REC/USE FIELD NOT VALIDATED               
         BZ    INSIMP10                                                         
         TM    PAYCIDH+4,X'20'     OR IF COMMERCIAL FIELD NOT VALIDATED         
         BO    INSIMP20                                                         
INSIMP10 LTR   R3,R3               CLEAR USAGE HISTORY DETAILS                  
         BNZ   *+6                                                              
         LR    R3,R2                                                            
         GOTO1 FLDVAL,DMCB,(X'01',(R2)),(R3)                                    
         SPACE 1                                                                
INSIMP20 LTR   R4,R4                                                            
         JZ    XIT                                                              
         OI    1(R4),X'0C'         MAKE TOTALS FIELD ZERO INTENSITY             
         OI    6(R4),X'80'                                                      
         J     XIT                                                              
         SPACE 3                                                                
XIT2     XIT1                                                                   
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO GO BACK THROUGH PAST CYCLES AND CONFORM               
*              THEM TO NEW EARLIER AIR DATES                                    
                                                                                
         USING MKTTABLD,R3                                                      
UPDHIST  NTR1  BASE=*,LABEL=*                                                   
         USING TLUHPD,RE                                                        
         LA    RE,KEY            SAVE END DATE OF THE CYCLE THAT                
         MVC   TGFULL,TLUHMCYE   IS BEING OVERLAPPED                            
         DROP  RE                                                               
                                                                                
         MVI   TGBYTE,UHCUR      SET TRIED CURRENT AGENCY/COMM'L                
                                                                                
         USING TLUHPD,R4                                                        
         LA    R4,KEY            READ ALL USAGE HISTORY KEYS                    
         XC    TLUHPKEY,TLUHPKEY FOR THIS CNET/MKT/CSYS ON THIS                 
         MVI   TLUHPCD,TLUHMTDQ  COMMERCIAL                                     
         MVC   TLUHMINM,TGMTINTC                                                
         MVC   TLUHMCOM,TGCOM                                                   
                                                                                
         MVC   SVCASTKY,TLUHPKEY                                                
                                                                                
UPHST10  GOTO1 HIGH                                                             
         B     UPHST30                                                          
UPHST20  GOTO1 SEQ                                                              
UPHST30  CLC   KEY(TLUHMUSE-TLUHPCD),KEYSAVE                                    
         BE    UPHST40                                                          
                                                                                
         BRAS  RE,RDPREVUH       IF NONE FOUND, SEARCH PREV AGY/COM             
         BNE   UPHST70                                                          
         BE    UPHST10                                                          
                                                                                
UPHST40  CLC   TLUHMCYE,TGFULL   IGNORE ANY KEYS WITH THE OVERLAP               
         BE    UPHST20           THAT WE ALREADY FOUND                          
                                                                                
         CLC   TLUHMC1D,MT1DATE  IF USE DATE OR LAG END DATE FITS               
         BNH   UPHST50           WITHIN AN EXISTING CYCLE FOR THIS              
         CLC   TLUHMC1D,MTCYCEND CNET/MKT/CSYS ...                              
         BH    UPHST20                                                          
UPHST50  CLC   TLUHMCYE,MT1DATE                                                 
         BNL   UPHST60                                                          
         CLC   TLUHMCYE,MTCYCEND                                                
         BL    UPHST20                                                          
                                                                                
UPHST60  TM    TLUHMSTA,TLUHMCRD AND FOUND ON A NON-CREDIT PAYMENT              
         JZ    CYCINV            GIVE ERROR                                     
         DROP  R4                                                               
                                                                                
UPHST70  MVI   TGBYTE,C'C'                                                      
         BRAS  RE,CHKUHDTS       ENSURE ALL EXISTING DATES FIT                  
         JNE   FLDINV            WITHIN THE NEW CYCLE                           
                                                                                
         TM    CYCSTAT,CYSTUPCY                                                 
         BZ    UPHST80                                                          
         CLI   PFAID,22          ONLY GO CHANGE CYCLE HISTORY                   
         BE    UPHST90           IF PF22 VALIDATION IS GIVEN                    
UPHST80  BRAS  RE,CYUPPFK                                                       
                                                                                
UPHST90  MVI   PFAID,0                                                          
         NI    CYCSTAT,X'FF'-CYSTUPCY                                           
                                                                                
         USING TLUHPD,R4                                                        
         MVC   TLUHPKEY,SVCASTKY SET TO READ THROUGH HISTORY AGAIN              
         MVI   TGBYTE,UHCUR      SET TRIED CURRENT AGENCY/COMM'L                
                                                                                
UPHST100 GOTO1 HIGH                                                             
         B     UPHST120                                                         
UPHST110 GOTO1 SEQ                                                              
UPHST120 CLC   KEY(TLUHMSEQ-TLUHPCD),KEYSAVE                                    
         BE    UPHST130                                                         
                                                                                
         BRAS  RE,RDPREVUH       IF NONE FOUND, SEARCH PREV AGY/COM             
         BNE   UPHST160                                                         
         BE    UPHST100                                                         
                                                                                
UPHST130 CLC   TLUHMCYE,TGFULL   ONLY WANT THE KEYS THAT OVERLAP                
         BNE   UPHST110                                                         
                                                                                
         TM    TLUHMSTA,TLUHMCRD ONCE A CREDIT INVOICE IS FOUND                 
         BZ    UPHST140                                                         
         ZICM  RE,TLUHMSEQ,2     BUMP TO NEXT CAST SEQUENCE NUMBER              
         AHI   RE,1              AND GO READ AGAIN                              
         STCM  RE,3,TLUHMSEQ                                                    
         B     UPHST100                                                         
         DROP  R4                                                               
                                                                                
UPHST140 MVI   RDUPDATE,C'Y'     GET OVERLAPPED USAGE HISTORY RECORD            
         GOTO1 GETREC                                                           
                                                                                
         L     RF,AIO2                                                          
         GOTO1 SAVPTRS,DMCB,(RF)                                                
                                                                                
         USING TAMTD,R4                                                         
         L     R4,AIO            GET CNET/MKT/CSYS ELEMENT                      
         MVI   ELCODE,TAMTELQ                                                   
         BRAS  RE,GETEL                                                         
         B     *+8                                                              
UPHST150 BRAS  RE,NEXTEL                                                        
         BE    *+6                                                              
         DC    H'00'                                                            
         CLC   TAMTINUM,MTINUM                                                  
         BNE   UPHST150                                                         
         MVC   TAMTCYCS,MT1DATE  AND UPDATE IT WITH NEW CYCLE START             
         MVC   TAMTCYCE,MTCYCEND AND END DATES                                  
         DROP  R4                                                               
                                                                                
         GOTO1 PUTREC                                                           
                                                                                
         USING TMPPAYD,R1                                                       
         L     R1,ATMPPAYD                                                      
                                                                                
         L     RF,AIO2                                                          
         GOTO1 ADDPTRS,DMCB,(X'08',(RF)),UHMTPTRS                               
         DROP  R1                                                               
                                                                                
         LA    R4,KEY                                                           
         B     UPHST110                                                         
                                                                                
UPHST160 MVI   TGBYTE,C'U'                                                      
         BRAS  RE,CHKUHDTS                                                      
*                                                                               
         BRAS  RE,CYUPMSG        GO GIVE CYCLE HISTORY UPDATED MSG              
*                                EXITS IN ROUTINE CYUPMSG                       
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 16)             *         
*                                                                     *         
***********************************************************************         
                                                                                
         USING LIN16D,R3           R3=A(LINE)                                   
DIS16R   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVC   L16NAME,CASTNAME    NAME                                         
         MVC   L16CAT,TGCAT        CATEGORY                                     
         MVI   L16CAM,C'Y'         SET Y=ON CAMERA                              
*                                                                               
         CLI   TCCAONOF+1,C'F'                                                  
         JNE   *+8                                                              
         MVI   L16CAM,C'N'         N=OFF                                        
*                                                                               
         MVC   L16YR,TGYRCDE       YEAR                                         
         MVC   L16TAG,=C'^Cmnt'    MOVE IN CHECK COMMENT TAG                    
*                                                                               
         XC    TCTOTS(TCTOTLNQ),TCTOTS  DON'T DISPLAY ANY AMOUNTS               
*                                                                               
DIS16X   DS    0H                                                               
         J     XIT                                                              
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 17)             *         
*                                                                     *         
***********************************************************************         
                                                                                
         USING LIN17D,R3           R3=A(LINE)                                   
DIS17R   NTR1  BASE=*,LABEL=*                                                   
         MVC   L17NAME,CASTNAME    NAME                                         
         MVC   L17CAT,TGCAT        CATEGORY                                     
         MVI   L17CAM,C'Y'         SET Y=ON CAMERA                              
*                                                                               
         CLI   TCCAONOF+1,C'F'                                                  
         JNE   *+8                                                              
         MVI   L17CAM,C'N'         N=OFF                                        
*                                                                               
         MVC   L17YR,TGYRCDE       YEAR                                         
*                                                                               
         XC    TCTOTS(TCTOTLNQ),TCTOTS  DON'T DISPLAY ANY AMOUNTS               
         J     XIT                                                              
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              DISPLAY A DETAIL LINE  (SCREEN OVERLAY 18)             *         
*                                                                     *         
***********************************************************************         
                                                                                
         USING LIN18D,R3           R3=A(LINE)                                   
DIS18R   NTR1  BASE=*,LABEL=*                                                   
         MVC   L18NAME,CASTNAME    NAME                                         
         MVC   L18CAT,TGCAT        CATEGORY                                     
         MVI   L18CAM,C'Y'         SET Y=ON CAMERA                              
*                                                                               
         CLI   TCCAONOF+1,C'F'                                                  
         JNE   *+8                                                              
         MVI   L18CAM,C'N'         N=OFF                                        
*                                                                               
         MVC   L18YR,TGYRCDE       YEAR                                         
*                                                                               
         XC    TCTOTS(TCTOTLNQ),TCTOTS  DON'T DISPLAY ANY AMOUNTS               
*                                                                               
DIS18X   DS    0H                                                               
         J     XIT                                                              
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 16)            *         
*                                                                     *         
***********************************************************************         
         SPACE 2                                                                
         USING LIN16D,R3           R3=A(LINE)                                   
*                                                                               
VAL16R   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVC   TGCAT,L16CAT        SAVE CATEGORY IN WORKING STORAGE\            
*                                                                               
         USING TASDD,R4                                                         
*                                                                               
         LA    R4,ELTASD                                                        
         ST    R4,TCATASD                                                       
         XC    TASDEL(TASDLNQ),TASDEL  INITIALIZE SESSION DETAILS EL.           
*                                                                               
         MVI   TASDEL,TASDELQ                                                   
         MVI   TASDLEN,TASDLNQ                                                  
         MVC   TASDEQU,TGUSEQU     USE EQUATE                                   
*                                                                               
*        VALIDATE HOURS/MINUTES                                                 
*                                                                               
V16HRMN  DS    0H                                                               
*                                                                               
         XC    TASDIHM,TASDIHM     INIT FIELD                                   
*                                                                               
         LA    R2,L16HMH           POINT TO HOURS/MINUTES FIELD                 
*                                                                               
         CLI   5(R2),0             IGNORE CAST MEMBER IF EMPTY                  
         BE    V16HRMNX                                                         
*                                                                               
         MVC   FULL,=X'80000001'   ALL MINUTES VALID LESS THAN 60               
*                                                                               
         BRAS  RE,VALHRMN          VALIDATE ENTRY                               
*                                                                               
         MVC   TASDIHM,HALF        SAVE HOUR/MINUTES                            
*                                                                               
V16HRMNX DS    0H                                                               
*                                                                               
*        IF NO HRS/MIN THEN NO ENTRY ALLOWEED                                   
*                                                                               
         OC    TASDIHM,TASDIHM     IF HRS/MINS NOT ENTERED                      
         BNZ   V16INPUT                                                         
*                                                                               
         LA    R2,L16TRVLH         TRAVEL TIME                                  
         CLI   5(R2),0                                                          
         BNE   V16MIS1E                                                         
*                                                                               
         LA    R2,L16ENTRH         POINT TO ENTIRE SCRIPT FIELD                 
         CLI   5(R2),0                                                          
         BNE   V16MIS1E                                                         
*                                                                               
         LA    R2,L16PARTH         POINT TO PARTIAL SCRIPT FIELD                
         CLI   5(R2),0                                                          
         BNE   V16MIS1E                                                         
*                                                                               
         LA    R2,L16OV60H         POINT TO OVER 60 DAYS FIELD                  
         CLI   5(R2),0                                                          
         BNE   V16MIS1E                                                         
*                                                                               
         LA    R2,L16REIMH         POINT TO REIMBURSED AMOUNT                   
         CLI   5(R2),0                                                          
         BNE   V16MIS1E                                                         
*                                                                               
         LA    R2,L16PAYH          POINT TO PAYMENT AMOUNT                      
         CLI   5(R2),0                                                          
         BNE   V16MIS1E                                                         
*                                                                               
         LA    R2,L16SPNHH         POINT TO SUBJECT TO P & H AMOUNT             
         CLI   5(R2),0                                                          
         BNE   V16MIS1E                                                         
*                                                                               
         LA    R2,L16MDEDH         POINT TO MISC. DEDUCTION AMOUNT              
         CLI   5(R2),0                                                          
         BNE   V16MIS1E                                                         
*                                                                               
         J     XIT                 SKIP ENTRY                                   
*                                                                               
V16INPUT DS    0H                                                               
*                                                                               
*        VALIDATE TRAVEL TIME - HOURS ONLY                                      
*                                                                               
         XC    TASDITR,TASDITR     INIT FIELD                                   
*                                                                               
         LA    R2,L16TRVLH         TRAVEL TIME                                  
         MVC   FULL,=X'80000001'   ALL MINUTES VALID LESS THAN 60               
*                                                                               
         BRAS  RE,VALHRMN          VALIDATE ENTRY                               
*                                                                               
         MVC   TASDITR,HALF        SAVE TRAVEL TIME                             
*                                                                               
*        VALIDATE ENTIRE SCRIPT                                                 
*                                                                               
V16ENTR  DS    0H                                                               
*                                                                               
         LA    R2,L16ENTRH         POINT TO ENTIRE SCRIPT FIELD                 
*                                                                               
         CLI   L16CAM,C'Y'         FIELD FOR OFF-CAMERA ONLY                    
         BNE   V16ENTR1                                                         
*                                                                               
         CLI   5(R2),0             NO ENTRY ALLOWED                             
         JNE   FLDINV                                                           
         B     V16ENTRX                                                         
*                                                                               
V16ENTR1 DS    0H                                                               
*                                                                               
         CLI   L16ENTR,C'Y'        OKAY IF 'Y'                                  
         BE    *+8                                                              
         CLI   L16ENTR,C'N'        OR 'N'                                       
         BE    *+8                                                              
         CLI   L16ENTR,C' '        OR EMPTY                                     
         JH    FLDINV              ELSE INVALID                                 
*                                                                               
         CLI   L16ENTR,C'Y'        IF 'Y'                                       
         BNE   *+8                                                              
         OI    TASDIST,TASDIENQ       INDICATE ENTIRE SCRIPT                    
*                                                                               
V16ENTRX DS    0H                                                               
*                                                                               
*        VALIDATE PARTIAL SCRIPT                                                
*                                                                               
V16PART  DS    0H                                                               
*                                                                               
         LA    R2,L16PARTH         POINT TO PARTIAL SCRIPT FIELD                
*                                                                               
         CLI   L16CAM,C'Y'         FIELD FOR OFF-CAMERA ONLY                    
         BNE   V16PART1                                                         
*                                                                               
         CLI   5(R2),0             NO ENTRY ALLOWED                             
         JNE   FLDINV                                                           
         B     V16PARTX                                                         
*                                                                               
V16PART1 DS    0H                                                               
*                                                                               
         CLI   L16PART,C'Y'        OKAY IF 'Y'                                  
         BE    *+8                                                              
         CLI   L16PART,C'N'        OR 'N'                                       
         BE    *+8                                                              
         CLI   L16PART,C' '        OR EMPTY                                     
         JH    FLDINV              ELSE INVALID                                 
*                                                                               
         CLI   L16PART,C'Y'        IF 'Y'                                       
         BNE   *+8                                                              
         OI    TASDIST,TASDIPTQ       INDICATE PARTIAL SCRIPT                   
*                                                                               
V16PARTX DS    0H                                                               
*                                                                               
         TM    TASDIST,TASDIENQ+TASDIPTQ IF BOTH ENTIRE & PARTIAL               
         JO    FLDINV                 ERROR                                     
*                                                                               
*        VALIDATE OVER 60 DAYS AFTER ORIGINAL SESSION                           
*                                                                               
V16OVER  DS    0H                                                               
*                                                                               
         LA    R2,L16OV60H         POINT TO OVER 60 DAYS FIELD                  
*                                                                               
         CLI   L16CAM,C'Y'         FIELD FOR OFF-CAMERA ONLY                    
         BNE   V16OVER1                                                         
*                                                                               
         CLI   5(R2),0             NO ENTRY ALLOWED                             
         JNE   FLDINV                                                           
         B     V16OVERX                                                         
*                                                                               
V16OVER1 DS    0H                                                               
*                                                                               
         CLI   L16OV60,C'Y'        OKAY IF 'Y'                                  
         BE    *+8                                                              
         CLI   L16OV60,C'N'        OR 'N'                                       
         BE    *+8                                                              
         CLI   L16OV60,C' '        OR EMPTY                                     
         JH    FLDINV              ELSE INVALID                                 
*                                                                               
         CLI   L16OV60,C'Y'        OKAY IF 'Y'                                  
         BNE   *+8                                                              
         OI    TASDIST,TASDI60Q       INDICATE OVER 60 DAYS                     
*                                                                               
V16OVERX DS    0H                                                               
*                                                                               
         CLI   L16CAM,C'Y'         IF ON CAMERA                                 
         BNE   *+12                                                             
         TM    TASDIST,TASDIENQ+TASDIPTQ+TASDI60Q IF AN ENTRY                   
         JNZ   FLDINV                 ERROR                                     
*                                                                               
         TM    TASDIST,TASDIENQ+TASDI60Q IF BOTH ENTIRE & >60                   
         JO    FLDINV                 ERROR                                     
*                                                                               
         TM    TASDIST,TASDI60Q    IF >60                                       
         BNO   *+12                                                             
         TM    TASDIST,TASDIPTQ    NEED PARTIAL SCRIPT                          
         JNO   FLDINV                 ERROR                                     
*                                                                               
*        VALIDATE INCLUDE FIELD                                                 
*                                                                               
         LA    R2,L16REIMH                                                      
         BRAS  RE,CHKCHNG          CHECK IF REIMBURSED AMT CHANGED              
*                                                                               
         LA    R2,L16PAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
*                                                                               
         LA    R2,L16SPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
*                                                                               
         LA    R2,L16MDEDH                                                      
         BRAS  RE,CHKCHNG          CHECK IF MISC DEDUCTION CHANGED              
         J     XIT                                                              
*                                                                               
V16MIS1E DS    0H                  HRS/MINS REQUIRED                            
         LA    R2,L16HMH           POINT TO HOURS/MINUTES FIELD                 
         J     FLDMISS             SET ERROR CODE                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              INDUSTRIALS - RADIO                                    *         
*                                                                     *         
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 17)            *         
*                                                                     *         
***********************************************************************         
         SPACE 2                                                                
         USING LIN17D,R3           R3=A(LINE)                                   
*                                                                               
VAL17R   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVC   TGCAT,L17CAT        SAVE CATEGORY IN WORKING STORAGE\            
*                                                                               
         USING TASDD,R4                                                         
*                                                                               
         LA    R4,ELTASD                                                        
         ST    R4,TCATASD                                                       
         XC    TASDEL(TASDLNQ),TASDEL  INITIALIZE SESSION DETAILS ELM           
*                                                                               
         MVI   TASDEL,TASDELQ                                                   
         MVI   TASDLEN,TASDLNQ                                                  
         MVC   TASDEQU,TGUSEQU     USE EQUATE                                   
*                                                                               
*        VALIDATE NUMBER OF PROGRAMS                                            
*                                                                               
V17NPRG  DS    0H                                                               
*                                                                               
         LA    R2,L17PRGH          POINT TO PROGRAMS FIELD                      
*                                                                               
         SR    RF,RF                                                            
         ICM   RF,1,5(R2)          GET INPUT LENGTH                             
         BZ    V17NPRGX                                                         
*                                                                               
         CHI   RF,2                MAX 2 DIGITS                                 
         JH    FLDINV                                                           
         BE    *+12                                                             
         CLI   0(R2),C'0'          ZERO INVALID ENTRY                           
         JE    FLDINV                                                           
*                                                                               
         BCTR  RF,0                DECREMENT FOR EXECUTE                        
         EX    RF,*+8                                                           
         B     *+10                                                             
         PACK  DUB,8(0,R2)         PACK INPUT                                   
*                                                                               
         TP    DUB                 ERROR IF NOT PACKED NUMBER                   
         JNZ   FLDINV                                                           
*                                                                               
         CVB   RF,DUB              CVB                                          
         STCM  RF,1,TASDIRP        SAVE NUMBER OF PROGRAMS                      
*                                                                               
V17NPRGX DS    0H                                                               
*                                                                               
*        VALIDATE HOURS/MINUTES                                                 
*                                                                               
V17HRMN  DS    0H                                                               
*                                                                               
         LA    R2,L17HMH           POINT TO HOURS/MINUTES FIELD                 
*                                                                               
         CLI   5(R2),0             IGNORE CAST MEMBER IF EMPTY                  
         BE    V17HRMNX                                                         
*                                                                               
         MVC   FULL,=X'80000001'   ALL MINUTES VALID LESS THAN 60               
*                                                                               
         BRAS  RE,VALHRMN          VALIDATE ENTRY                               
*                                                                               
         MVC   TASDIRH,HALF        SAVE HOUR/MINUTES                            
*                                                                               
         OC    TASDIRH,TASDIRH     IF HRS/MINS PRESENT                          
         BZ    V17HRMNX                                                         
*                                                                               
         OC    TASDIRP,TASDIRP     AND PROGRAMS IS ZERO                         
         BNZ   *+8                                                              
         MVI   TASDIRP,1               FORCE 1 PROGRAM                          
*                                                                               
V17HRMNX DS    0H                                                               
*                                                                               
*        IF NO PROGRAMS AND NO HOURS/MINUTES THEN NO ENTRY ALLOWED              
*                                                                               
         OC    TASDIRP,TASDIRP     IF PROGRAMS NOT ENTERED                      
         BNZ   V17INPUT                                                         
*                                                                               
         OC    TASDIRH,TASDIRH     AND HRS/MINS NOT ENTERED                     
         BNZ   V17INPUT                                                         
*                                                                               
         LA    R2,L17RTKHH         POINT TO RETAKES FIELD                       
         CLI   5(R2),0                                                          
         BNE   V17MIS1E                                                         
*                                                                               
         LA    R2,L17REIMH         POINT TO REIMBURSED AMOUNT                   
         CLI   5(R2),0                                                          
         BNE   V17MIS1E                                                         
*                                                                               
         LA    R2,L17PAYH          POINT TO PAYMENT AMOUNT                      
         CLI   5(R2),0                                                          
         BNE   V17MIS1E                                                         
*                                                                               
         LA    R2,L17SPNHH         POINT TO SUBJECT TO P & H AMOUNT             
         CLI   5(R2),0                                                          
         BNE   V17MIS1E                                                         
*                                                                               
         LA    R2,L17MDEDH         POINT TO MISC. DEDUCTION AMOUNT              
         CLI   5(R2),0                                                          
         BNE   V17MIS1E                                                         
*                                                                               
         J     XIT                 SKIP ENTRY                                   
*                                                                               
V17INPUT DS    0H                                                               
*                                                                               
*        VALIDATE RTK/HOURS/MINUTES                                             
*                                                                               
V17RTKH  DS    0H                                                               
*                                                                               
         LA    R2,L17RTKHH         POINT TO RTK/HOURS/MINUTES FIELD             
*                                                                               
         CLI   5(R2),0             IGNORE IF EMPTY                              
         BE    V17RTKHX                                                         
*                                                                               
         CLC   TGCAT,=C'P  '       ONLY ALLOWED FOR PRINCIPAL PERFRMERS         
*        JE    V17RTKH5                                                         
*        CLI   TGCAEQU,CTP                                                      
         JNE   FLDINV                                                           
*                                                                               
V17RTKH5 MVC   FULL,=X'80000001'   ALL MINUTES VALID LESS THAN 60               
*                                                                               
         BRAS  RE,VALHRMN          VALIDATE ENTRY                               
*                                                                               
         MVC   TASDIRR,HALF        SAVE HOUR/MINUTES                            
*                                                                               
V17RTKHX DS    0H                                                               
*                                                                               
*        VALIDATE INCLUDE FIELD                                                 
*                                                                               
         LA    R2,L17REIMH                                                      
         BRAS  RE,CHKCHNG          CHECK IF REIMBURSED AMT CHANGED              
*                                                                               
         LA    R2,L17PAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
*                                                                               
         LA    R2,L17SPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
*                                                                               
         LA    R2,L17MDEDH                                                      
         BRAS  RE,CHKCHNG          CHECK IF MISC DEDUCTION CHANGED              
         J     XIT                                                              
*                                                                               
V17MIS1E DS    0H                  PROGRAMS REQUIRED                            
         LA    R2,L17PRGH          POINT TO PROGRAMS FIELD                      
         J     FLDMISS             SET ERROR CODE                               
*                                                                               
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*                                                                     *         
*              INDUSTRIALS - INTERACTIVE VOICE RECORDING - IVR        *         
*                                                                     *         
*              VALIDATE A DETAIL LINE  (SCREEN OVERLAY 17)            *         
*                                                                     *         
***********************************************************************         
         SPACE 2                                                                
         USING LIN18D,R3           R3=A(LINE)                                   
*                                                                               
VAL18R   NTR1  BASE=*,LABEL=*                                                   
*                                                                               
         MVC   TGCAT,L18CAT        SAVE CATEGORY IN WORKING STORAGE\            
*                                                                               
         USING TASDD,R4                                                         
*                                                                               
         LA    R4,ELTASD                                                        
         ST    R4,TCATASD                                                       
         XC    TASDEL(TASDLNQ),TASDEL  INITIALIZE SESSION DETAILS EL.           
*                                                                               
         MVI   TASDEL,TASDELQ                                                   
         MVI   TASDLEN,TASDLNQ                                                  
         MVC   TASDEQU,TGUSEQU     USE EQUATE                                   
*                                                                               
*        VALIDATE HOURS/MINUTES                                                 
*                                                                               
V18HRMN  DS    0H                                                               
*                                                                               
         LA    R2,L18HMH           POINT TO HOURS/MINUTES FIELD                 
*                                                                               
         CLI   5(R2),0             SKIP IF HR/MIN ENTERED                       
         BE    V18HRMNX                                                         
*                                                                               
         MVC   FULL,=X'80000001'   ALL MINUTES VALID LESS THAN 60               
*                                                                               
         BRAS  RE,VALHRMN          VALIDATE ENTRY                               
*                                                                               
         MVC   TASDIVH,HALF        SAVE HOUR/MINUTES                            
*                                                                               
V18HRMNX DS    0H                                                               
*                                                                               
*        IF NO HRS/MIN THEN NO ENTRY ALLOWEED                                   
*                                                                               
         OC    TASDIVH,TASDIVH     HRS/MIN                                      
         BNZ   V18INPUT                                                         
*                                                                               
         LA    R2,L18TRVLH         TRAVEL TIME                                  
         CLI   5(R2),0                                                          
         BNE   V18MIS1E                                                         
*                                                                               
         LA    R2,L18REIMH         POINT TO REIMBURSED AMOUNT                   
         CLI   5(R2),0                                                          
         BNE   V18MIS1E                                                         
*                                                                               
         LA    R2,L18PAYH          POINT TO PAYMENT AMOUNT                      
         CLI   5(R2),0                                                          
         BNE   V18MIS1E                                                         
*                                                                               
         LA    R2,L18SPNHH         POINT TO SUBJECT TO P & H AMOUNT             
         CLI   5(R2),0                                                          
         BNE   V18MIS1E                                                         
*                                                                               
         LA    R2,L18MDEDH         POINT TO MISC. DEDUCTION AMOUNT              
         CLI   5(R2),0                                                          
         BNE   V18MIS1E                                                         
*                                                                               
         J     XIT                 SKIP ENTRY                                   
*                                                                               
V18INPUT DS    0H                                                               
*                                                                               
*        VALIDATE TRAVEL TIME - HOURS ONLY                                      
*                                                                               
         LA    R2,L18TRVLH         TRAVEL TIME                                  
*                                                                               
         CLI   5(R2),0             SKIP IF EMPTY                                
         BE    V18TRVLX                                                         
*                                                                               
         MVC   FULL,=X'80000001'   ALL MINUTES VALID LESS THAN 60               
*                                                                               
         BRAS  RE,VALHRMN          VALIDATE ENTRY                               
*                                                                               
         MVC   TASDIVT,HALF        SAVE TRAVEL TIME                             
*                                                                               
V18TRVLX DS    0H                                                               
*                                                                               
*        VALIDATE INCLUDE FIELD                                                 
*                                                                               
         LA    R2,L18REIMH                                                      
         BRAS  RE,CHKCHNG          CHECK IF REIMBURSED AMT CHANGED              
*                                                                               
         LA    R2,L18PAYH                                                       
         BRAS  RE,CHKCHNG          CHECK IF PAYMENT AMOUNT CHANGED              
*                                                                               
         LA    R2,L18SPNHH                                                      
         BRAS  RE,CHKCHNG          CHECK IF SUBJECT TO P&H CHANGED              
*                                                                               
         LA    R2,L18MDEDH                                                      
         BRAS  RE,CHKCHNG          CHECK IF MISC DEDUCTION CHANGED              
         J     XIT                                                              
*                                                                               
V18MIS1E DS    0H                  PROGRAMS REQUIRED                            
         LA    R2,L18HMH           POINT TO PROGRAMS FIELD                      
         J     FLDMISS             SET ERROR CODE                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        VALIDATE ISU (INDUSTRIAL SUPPLEMENTAL SCREEN)                *         
***********************************************************************         
                                                                                
VSCR7AR  NTR1 BASE=*,LABEL=*                                                    
         MVI   ISUTYPE1,0             INITIALIZE VARIABLES                      
         MVI   ISUTYPE2,0                                                       
                                                                                
         GOTO1 VISUFLD,DMCB,ISUBCAH,('TAIDTBCA',ISUTYPE1)                       
         GOTO1 (RF),(R1),ISUIN5H,('TAIDTIN5',ISUTYPE1)                          
         GOTO1 (RF),(R1),ISUNNWH,('TAIDTNNW',ISUTYPE1)                          
         GOTO1 (RF),(R1),ISUTEXH,('TAIDTTEX',ISUTYPE1)                          
         GOTO1 (RF),(R1),ISUFGRH,('TAIDTFGR',ISUTYPE1)                          
         GOTO1 (RF),(R1),ISUICUH,('TAIDTICU',ISUTYPE1)                          
         GOTO1 (RF),(R1),ISUSRIH,('TAIDTSRI',ISUTYPE1)                          
         GOTO1 (RF),(R1),ISUPAGH,('TAIDTPAG',ISUTYPE1)                          
         GOTO1 (RF),(R1),ISUCT2H,('TAIDTCT2',ISUTYPE2)                          
         GOTO1 (RF),(R1),ISUNWKH,('TAIDTNWK',ISUTYPE2)                          
         GOTO1 (RF),(R1),ISUCABH,('TAIDTCAB',ISUTYPE2)                          
         GOTO1 (RF),(R1),ISUGPUH,('TAIDTGPU',ISUTYPE2)                          
         GOTO1 (RF),(R1),ISUGOVH,('TAIDTGOV',ISUTYPE2)                          
                                                                                
         CLI   ISUTYPE1,0             ENSURE AT LEAST ONE                       
         JNE   XIT                    TYPE IS CHECKED OFF                       
         CLI   ISUTYPE2,0                                                       
         JNE   XIT                                                              
         LA    R2,ISUBCAH                                                       
         J     FLDMISS                                                          
                                                                                
***********************************************************************         
*        VALIDATE ISU (INDUSTRIAL SUPPLEMENTAL SCREEN) FIELD          *         
*        ON ENTRY ... P1        = A(ISU CHECKOFF FIELD)               *         
*                     P2 BYTE 0 = ISU TYPE EQUATE                     *         
*                     P2        = A(ISU TYPE BYTE)                    *         
***********************************************************************         
                                                                                
VISUFLD  NTR1                                                                   
         L     R2,0(R1)               R2 = A(ISU CHECKOFF FIELD)                
         CLI   5(R2),0                EXIT IF TYPE IS NOT CHECKED               
         JE    XIT                                                              
                                                                                
         TM    ISUTYPE1,TAIDTBCA      ENSURE BASIC CABLE IS                     
         JO    FLDINV                 NOT CHECKED OFF                           
                                                                                
         MVC   TGBYTE,4(R1)           TGBYTE = ISU TYPE EQUATE                  
         ZICM  R3,5(R1),3             R3 = A(ISU TYPE BYTE)                     
                                                                                
         USING TACOD,R4                                                         
         LA    RE,ISUTYPE2                                                      
         CR    RE,R3                                                            
         JNE   VISU20                                                           
         CLI   TGBYTE,TAIDTCT2        IF CHECKING CATEGORY 2 FIELD              
         JNE   VISU20                                                           
VISU10   LA    R4,ELTACO              ENSURE THAT COMMERCIAL TYPE               
         CLI   TACOTYPE,CTYICAT1      IS CATEGORY 1                             
         JNE   FLDINV                                                           
         MVC   TGBYTE2,ISUTYPE1                                                 
         NI    TGBYTE2,X'FF'-TAIDTIN5 AND ENSURE THAT ONLY INTERNET             
         CLI   TGBYTE2,0              5 YEARS                                   
         JNE   FLDINV                                                           
         MVC   TGBYTE2,ISUTYPE2                                                 
         NI    TGBYTE2,X'FF'-TAIDTCT2 AND/OR CATEGORY 2 IS CHECKED              
         CLI   TGBYTE2,0                                                        
         JNE   FLDINV                                                           
         J     VISU40                                                           
         DROP  R4                                                               
                                                                                
VISU20   LA    RE,ISUTYPE1                                                      
         CR    RE,R3                                                            
         JNE   VISU30                                                           
         CLI   TGBYTE,TAIDTPAG        IF CHECKING PACKAGE A THRU G              
         JNE   VISU30                 FIELD                                     
         CLI   TYPE,UISUW90           ENSURE TYPE IS WITHIN 90 DAYS             
         JNE   FLDINV                                                           
                                                                                
VISU30   TM    ISUTYPE1,TAIDTIN5      OTHERWISE, ENSURE THAT                    
         JO    FLDINV                 INTERNET 5-YEARS                          
         TM    ISUTYPE2,TAIDTCT2      AND CATEGORY 2 HAS NOT BEEN               
         JO    FLDINV                 CHECKED                                   
                                                                                
VISU40   OC    0(1,R3),TGBYTE         TURN ON APPROPRIATE STATUS BIT            
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        VALIDATE ISU (INDUSTRIAL SUPPLEMENTAL SCREEN)                *         
*        ON ENTRY ... P1 = DETAIL LINE LENGTH                         *         
*                     P2 = A(FIRST DETAIL LINE)                       *         
***********************************************************************         
                                                                                
BINVISES NTR1 BASE=*,LABEL=*                                                    
         ZICM  R0,2(R1),2          R0 = A(DETAIL LINE LENGTH)                   
         L     R2,4(R1)            R2 = A(FIRST DETAIL LINE)                    
                                                                                
         L     R1,TPAYI            DISPLAY INDIV. GROSS ON 1ST DTL LINE         
         MVC   0(L'BISINDIV,R2),BISINDIV                                        
         LA    R3,L'LTINDIV(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
                                                                                
         L     R1,TPAYC            AND CORPORATE GROSS ON NEXT DTL LINE         
         A     R1,TEXPENSE         INCLUDE REIMBURSED EXPENSES                  
         AR    R2,R0                                                            
         MVC   0(L'BISCORP,R2),BISCORP                                          
         LA    R3,L'BISCORP(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
BISINDIV DC    C'Indiv Gross='                                                  
BISCORP  DC    C'Corp Gross='                                                   
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE INCREMENTS COUNT OF CAST AND SAVES IT                *         
*        ON ENTRY ... R2=A(EPISODE ENTRY),                            *         
***********************************************************************         
                                                                                
INCOUNT  NTR1  BASE=*,LABEL=*                                                   
         CLI   TGCAEQU,CTU5        IF CATEGORY U5                               
         JE    INC10                                                            
         CLI   TGCAEQU,CTU52                                                    
         JNE   INC20                                                            
INC10    ZIC   R1,3(R2)            INCREMENT COUNT OF U5'S                      
         LA    R1,1(R1)                                                         
         STC   R1,3(R2)            AND SAVE                                     
         J     XIT                                                              
INC20    ZIC   R1,2(R2)            ELSE INCREMENT OTHER COUNT                   
         LA    R1,1(R1)                                                         
         STC   R1,2(R2)            AND SAVE                                     
INCX     J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        INVOICE END PROCESSING  (1E - EVENT)                         *         
***********************************************************************         
                                                                                
BINV1EX  NTR1  BASE=*,LABEL=*                                                   
         L     R1,TPAYI            DISPLAY TAXABLE WAGES ON 1ST LINE            
         LA    R2,EVEFRSTH+L1EDATA-LIN1ED                                       
         MVC   0(L'LTTWAG,R2),LTTWAG                                            
         LA    R3,L'LTTWAG(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
                                                                                
         L     R1,TPAYC            DISPLAY NON-TAX WAGES ON 2ND LINE            
         LA    R2,L1ELNQ(R2)                                                    
         MVC   0(L'LTNTWAG,R2),LTNTWAG                                          
         LA    R3,L'LTNTWAG(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
                                                                                
         L     R1,TTXNW            DISPLAY TAXABLE REIMB. ON 3RD LINE           
         LA    R2,L1ELNQ(R2)                                                    
         MVC   0(L'LTTRMB,R2),LTTRMB                                            
         LA    R3,L'LTTRMB(R2)                                                  
         BRAS  RE,EDITTOTS                                                      
                                                                                
         L     R1,TEXPENSE         DISPLAY NON-TAX REIMB. ON 4TH LINE           
         S     R1,TTXNW                                                         
         LA    R2,L1ELNQ(R2)                                                    
         MVC   0(L'LTNTRMB,R2),LTNTRMB                                          
         LA    R3,L'LTNTRMB(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
                                                                                
         OC    PPACTOT,PPACTOT                                                  
         JZ    XIT                                                              
         L     R1,PPACTOT          DISPLAY AGY COM ON 5TH LINE                  
         LA    R2,L1ELNQ(R2)                                                    
         MVC   0(L'LTNTRMB,R2),LTAGYCOM                                         
         LA    R3,L'LTNTRMB(R2)                                                 
         BRAS  RE,EDITTOTS                                                      
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
LTTWAG   DC    C'Taxable Wages='                                                
LTNTWAG  DC    C'Non-Tax Wages='                                                
LTTRMB   DC    C'Taxable Reimb.='                                               
LTNTRMB  DC    C'Non-Tax Reimb.='                                               
LTAGYCOM DC    C'Agency Comm.='                                                 
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              ROUTINE TO SAVE CREDIT INVOICE STATUS IN THE                     
*              USAGE HISTORY ELEMENT                                            
         SPACE 1                                                                
         USING TAUHD,R3            R3=A(NEW USAGE HISTORY ELEMENT)              
SVCREDIT NTR1  BASE=*,LABEL=*                                                   
         LA    R1,TAUHLCST                                                      
         CLI   TGUSEQU,ULCB                                                     
         JE    SC10                                                             
         LA    R1,TAUHCSTA                                                      
         TM    TGUSSTA3,CBLUSE                                                  
         JNZ   SC10                                                             
         LA    R1,TAUHSTAT                                                      
SC10     NI    0(R1),X'FF'-TAUHWCRD                                             
         TM    PAYSTAT1,CREDIT                                                  
         JZ    XIT                                                              
         OI    0(R1),TAUHWCRD                                                   
         J     XIT                                                              
         DROP  R3                                                               
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*******************************************************************             
*              VALIDATE AND SORT ALL VERSION INPUT INTO INPUT TABLE             
*              ON ENTRY ... R2=A(VERSION INPUT FIELD)                           
*              EXIT - PAYVERS TABLE  FILLED IN                                  
********************************************************************            
BLDINTBL NTR1  BASE=*,LABEL=*                                                   
         L     RE,APAYVERS                                                      
         XC    0(L'PAYVERS,RE),0(RE)                                            
         L     RE,ACSTVERS                                                      
         XC    0(L'CSTVERS,RE),0(RE)                                            
         MVI   0(RE),X'FF'                                                      
                                                                                
*****    BAS   RE,ALLVER         IF USER IS INPUTTING ALL VERSIONS              
*****    BE    XIT               BUILD TABLE AND EXIT                           
                                                                                
         USING SCAND,R5                                                         
         LA    R5,BLOCK                                                         
         GOTO1 SCANNER,DMCB,(R2),(R5),0                                         
         CLI   4(R1),0                                                          
         JE    FLDINV                                                           
         ZIC   R0,4(R1)                                                         
                                                                                
BIT10    ST    R5,DUB                                                           
         ST    R0,DUB+4                                                         
         CLC   SCDATA2,SPACES    ENTRY SHOULD NEVER INCLUDE AN                  
         JNE   FLDINV            EQUALS SIGN                                    
                                                                                
         XC    WORK2,WORK2                                                      
                                                                                
         SR    R1,R1             USE R1 TO COUNT NUMBER OF DASHES               
         LA    RE,SCDATA1        IN ENTRY                                       
         LA    RF,L'SCDATA1                                                     
BIT20    CLI   0(RE),C'-'                                                       
         BNE   BIT30                                                            
         MVI   0(RE),C'='        REPLACE DASHES WITH EQUAL SIGNS                
         AHI   R1,1                                                             
BIT30    LA    RE,1(RE)                                                         
         BCT   RF,BIT20                                                         
                                                                                
         CHI   R1,0              NO DASHES MEANS ENTRY IS NOT A RANGE           
         BE    BIT80                                                            
         CHI   R1,1              MAXIMUM OF ONE DASH PERMITTED                  
         JNE   FLDINV                                                           
                                                                                
         XC    WORK2,WORK2                                                      
         MVI   WORK2,L'WORK2              IF ENTRY IS A RANGE                   
         MVC   WORK2+5(1),SCLEN1          BUILD MOCK FIELD TO SCAN              
         MVC   WORK2+8(L'SCDATA1),SCDATA1                                       
***      ST    R5,SVENTRY        AND SAVE A(CURR ENTRY IN SCAN BLOCK)           
***      ST    R0,SVENCNT                                                       
         ST    R5,DUB            AND SAVE A(CURR ENTRY IN SCAN BLOCK)           
         ST    R0,DUB+4                                                         
                                                                                
         LA    R5,WORK                                                          
         GOTO1 SCANNER,DMCB,WORK2,(R5),0                                        
         CLI   4(R1),0                                                          
         JE    FLDINV                                                           
         ZIC   R0,4(R1)                                                         
                                                                                
         TM    SCVAL1,X'80'      FIRST ENTRY IN RANGE MUST BE NUMERIC           
         JZ    FLDINV                                                           
         CLC   SCBIN1,=F'4'      BETWEEN 1                                      
         JL    FLDINV                                                           
         CLC   SCBIN1,=F'249'    AND 249                                        
         JH    FLDINV                                                           
                                                                                
         TM    SCVAL2,X'80'      SECOND ENTRY IN RANGE MUST BE NUMERIC          
         JZ    FLDINV                                                           
         CLC   SCBIN2,=F'5'      BETWEEN 2                                      
         JL    FLDINV                                                           
         CLC   SCBIN2,=F'250'    AND 250                                        
         JH    FLDINV                                                           
                                                                                
BIT40    CLC   SCBIN1,SCBIN2     PROCESS ALL NUMBERS IN RANGE UNTIL             
         BNH   BIT80             FIRST ENTRY EXCEEDS SECOND                     
***      L     R5,DUB                                                           
****     L     R0,DUB+4                                                         
         XC    WORK2,WORK2                                                      
         B     BIT170                                                           
*                                                                               
                                                                                
*IT80    L     R5,DUB                                                           
*        L     R0,DUB+4                                                         
BIT80    CLI   SCLEN1,3          IF FIELD CONTAINS A VERSION CODE               
         JH    FLDINV            IT MUST BE 3 CHARACTERS OR LESS                
         TM    SCVAL1,X'80'      AND VALID NUMERIC                              
         JZ    FLDINV                                                           
         MVC   ACTUAL,SCBIN1+3   SAVE CODE IN ACTUAL                            
         CLI   ACTUAL,4          VERISON 4 OR HIGHER                            
         JL    FLDINV                                                           
*                                                                               
*  READ VERSION RECORD AND SEE IF 26K.                                          
*  IF IT IS A 26K VERSION THEN ADD TO VCSTTBL                                   
*  WHICH IS A TEMP SORT TABLE                                                   
*                                                                               
         USING TLVRD,R4                                                         
BIT90    XC    KEY,KEY                                                          
         LA    R4,KEY                                                           
         MVI   TLVRCD,TLVRCDQ                                                   
         MVC   TLVRVER,ACTUAL                                                   
         MVC   TLVRCOM,TGCOM                                                    
         GOTO1 HIGH                                                             
*        CLI   ACTUAL,X'03'                                                     
*        BNH   *+6                                                              
*        DC    H'0'                                                             
         CLC   KEY(TLVRVER+1-TLVRCD),KEYSAVE                                    
         BNE   BIT100                                                           
         GOTO1 GETREC                                                           
         USING TACOD,R4                                                         
                                                                                
         L     R4,AIO                                                           
         MVI   ELCODE,TACOELQ    ONLY PROCESS 26K VERSIONS                      
         BRAS  RE,GETEL                                                         
         JNE   BIT160                                                           
         TM    TACOSTA3,TACOS26K                                                
****     BNO   BIT160                                                           
         BNO   BIT156                                                           
                                                                                
         B     BIT130                                                           
         DROP  R4                                                               
* VERSION NOT FOUND                                                             
BIT100   OC    WORK2,WORK2       CODE MUST EXIST ON COMMERCIAL                  
         JZ    FLDINV            UNLESS IT IS PART OF A RANGE                   
***      JZ    V26ERR            DUMPS IN GTXT ?                                
         B     BIT160                                                           
                                                                                
                                                                                
BIT130   L     RE,ACSTVERS                                                      
BIT140   CLI   0(RE),X'FF'       SAVE ACTUAL INTO SORT TABLE'S FIRST            
         BE    BIT150            EMPTY SLOT                                     
         CLC   ACTUAL,0(RE)      DO NOT ALLOW VERSION TO BE DUPLICATED          
         JE    FLDINV                                                           
         LA    RE,1(RE)                                                         
         B     BIT140                                                           
                                                                                
BIT150   MVC   0(1,RE),ACTUAL                                                   
         MVI   1(RE),X'FF'                                                      
                                                                                
BIT156   OC    WORK2,WORK2       IF VERSION IS PART OF RANGE                    
         BZ    BIT170                                                           
BIT160   ZIC   RE,SCBIN1+3       BUMP TO NEXT NUMBER IN RANGE                   
         AHI   RE,1              AND GO PROCESS                                 
         STC   RE,SCBIN1+3                                                      
         B     BIT40                                                            
                                                                                
BIT170   L     R5,DUB                                                           
         L     R0,DUB+4                                                         
         LA    R5,SCANNEXT       ELSE, BUMP TO NEXT ENTRY IN SCANNER            
         BCT   R0,BIT10          BLOCK                                          
         DROP  R5                                                               
                                                                                
         L     R1,APAYVERS                                                      
                                                                                
BIT180   L     RE,ACSTVERS                                                      
BIT190   CLI   0(RE),X'FF'       FIND FIRST MEANINGFUL VALUE IN                 
         BE    BIT230            SORT TABLE                                     
         CLI   0(RE),0                                                          
         BNE   BIT200                                                           
         LA    RE,1(RE)                                                         
         B     BIT190                                                           
                                                                                
BIT200   LR    RF,RE                                                            
BIT210   LA    RF,1(RF)          COMPARE IT TO NEXT MEANINGFUL VALUE            
         CLI   0(RF),X'FF'       IN SORT TABLE                                  
         BE    BIT220                                                           
         CLI   0(RF),0                                                          
         BE    BIT210                                                           
         CLC   0(1,RE),0(RF)                                                    
         BL    BIT210                                                           
         LR    RE,RF                                                            
         B     BIT210                                                           
                                                                                
BIT220   AHI   R0,1              ADD VERSIONS TO INPUT TABLE FROM               
         MVC   0(1,R1),0(RE)     SMALLEST TO LARGEST                            
         LA    R1,1(R1)                                                         
         MVI   0(RE),0                                                          
         B     BIT180                                                           
                                                                                
BIT230   MVI   0(R1),X'FF'                                                      
         J     XIT                                                              
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        DISPLAY A DETAIL LINE  (SCREEN OVERLAY BF)                   *         
***********************************************************************         
                                                                                
         USING LINBFD,R3           R3=A(LINE)                                   
DISBFR   NTR1  BASE=*,LABEL=*                                                   
         MVC   LBFNAME,CASTNAME    NAME                                         
         MVC   LBFCAT,TGCAT        CATEGORY                                     
         MVI   LBFCAM,C'Y'         SET Y=ON CAMERA                              
         CLI   TCCAONOF+1,C'F'                                                  
         JNE   *+8                                                              
         MVI   LBFCAM,C'N'         N=OFF                                        
         MVC   LBFYR,TGYRCDE       YEAR                                         
         MVC   LBFTAG,=C'^Cmnt'    MOVE IN CHECK COMMENT TAG                    
                                                                                
         CLI   HASTIME,C'Y'        IF INVOICE HAS TIMESHEETS                    
         JNE   DBF10                                                            
         OC    TMSHTS,TMSHTS       DOES CAST MEMBER HAVE TIMESHEETS?            
         JNZ   DBF05                                                            
         LA    R4,LBFSPOTH         FIRST FIELD                                  
         LA    R1,LBFREIMH         LAST FIELD                                   
DBF02    NI    1(R4),X'DF'         UNPROTECT INPUT FIELD                        
         OI    6(R4),X'80'                                                      
         ZIC   RE,0(R4)                                                         
         AR    R4,RE                                                            
         CR    R4,R1                                                            
         JNH   DBF02                                                            
         J     DBF10                                                            
                                                                                
DBF05    EDIT  TMSPOT,LBFSPOT,ALIGN=LEFT                                        
         STC   R0,LBFSPOTH+5     INPUT DATA LENGTH RETURNED FROM EDIT           
         EDIT  TMDAYS,LBFDAY,ALIGN=LEFT,ZERO=BLANK                              
         STC   R0,LBFDAYH+5                                                     
         EDIT  TMOVTM,LBFOT,ALIGN=LEFT,ZERO=BLANK                               
         STC   R0,LBFOTH+5                                                      
         EDIT  TMDBTM,LBFDT,ALIGN=LEFT,ZERO=BLANK                               
         STC   R0,LBFDTH+5                                                      
         EDIT  TMTRVL,LBFTRAV,2,ALIGN=LEFT,ZERO=BLANK                           
         STC   R0,LBFTRAVH+5                                                    
         EDIT  TMPDWD,LBFPDW,2,ALIGN=LEFT,ZERO=BLANK                            
         STC   R0,LBFPDWH+5                                                     
         EDIT  TMTAGS,LBFTAGS,ALIGN=LEFT,ZERO=BLANK                             
         STC   R0,LBFTAGSH+5                                                    
         EDIT  TMINCL,LBFICDE,ALIGN=LEFT,ZERO=BLANK                             
         STC   R0,LBFICDEH+5                                                    
         EDIT  TMREIM,LBFREIM,2,ALIGN=LEFT,ZERO=BLANK                           
         STC   R0,LBFREIMH+5                                                    
                                                                                
*              MAKE ALL FIELDS INVALID, PROTECTED, AND TRANSMITTED              
         GOTO1 FLDVAL,DMCB,(X'1A',LBFSPOTH),LBFREIMH                            
         DROP  R3                                                               
                                                                                
DBF10    XC    TCTOTS(TCTOTLNQ),TCTOTS  DON'T DISPLAY ANY AMOUNTS               
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        DISPLAY LAST INVOICE NUMBER AND CYCLE DATES                  *         
***********************************************************************         
                                                                                
*                                  R2=A(FIELD)                                  
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
DISLAST  NTR1  BASE=*,LABEL=*                                                   
         MVC   8(6,R2),LASTINV                          INVOICE NUMBER          
         OI    6(R2),X'80'                                                      
         OC    TAUHSTRT(6),TAUHSTRT                                             
         JZ    XIT                                                              
                                                                                
         LA    R0,X'11'            ASSUME START - END COMBINATION               
         OC    TAUHEND,TAUHEND     IF NO END DATE                               
         BNZ   *+8                                                              
         LA    R0,X'01'               DON'T ASSUME 2 DATES                      
                                                                                
         GOTO1 DATCON,DMCB,((R0),TAUHSTRT),(8,15(R2))  CYCLE DATES              
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        DISPLAY MULTIPLE CHOICE FIELDS                               *         
***********************************************************************         
                                                                                
*                                  PLIST OF FORM: (USE TYPE,A(FIELD))           
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
DCHOICE  NTR1  BASE=*,LABEL=*                                                   
DCH2     CLI   0(R1),X'FF'         TEST FOR END OF LIST                         
         JE    XIT                                                              
         CLC   TAUHTYPE,0(R1)      MATCH TYPE                                   
         JE    *+12                                                             
         LA    R1,4(R1)            BUMP TO NEXT PARAMETER                       
         J     DCH2                                                             
         DROP  R3                                                               
                                                                                
         L     R2,0(R1)                                                         
         MVI   0(R2),C'Y'          DISPLAY A 'Y' HERE                           
         J     XIT                                                              
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        DISPLAY MULTIPLE CHOICE FIELDS W/HEADERS                     *         
*        ALSO CLEARS FLD IF NO MATCH AND TRANSMITS                    *         
***********************************************************************         
                                                                                
*                                  PLIST OF FORM: (USE TYPE,A(FLD HDR))         
         USING TAUHD,R3            R3=A(USAGE HISTORY ELEMENT)                  
DCHOICEH NTR1  BASE=*,LABEL=*                                                   
DCHH2    CLI   0(R1),X'FF'         TEST FOR END OF LIST                         
         JE    XIT                                                              
         L     R2,0(R1)            R2=A(FLD HDR)                                
         CLC   TAUHTYPE,0(R1)      MATCH TYPE                                   
         JE    *+12                                                             
         MVI   8(R2),0             CLEAR FLD IF NO MATCH                        
         J     *+8                                                              
         MVI   8(R2),C'Y'          ELSE DISPLAY A 'Y' HERE                      
         DROP  R3                                                               
                                                                                
         OI    6(R2),X'80'         TRANSMIT FLD                                 
         LA    R1,4(R1)            BUMP TO NEXT PARAMETER                       
         J     DCHH2                                                            
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
***********************************************************************         
*        ROUTINE DETERMINES IF ANY ERRORS HAVE BEEN ENCOUNTERED       *         
*        THAT SHOULD ABORT A WEB TRANSACTION IMMEDIATELY              *         
***********************************************************************         
                                                                                
WEBERRS  NTR1  BASE=*,LABEL=*                                                   
         TM    TGFASTAT,TGFROMFA   IF PAYMENT COMING FROM WEB                   
         JZ    NO                                                               
                                                                                
         USING ERRENTD,RE                                                       
         L     RE,TGAERTAB                                                      
         CLI   EECATY,ERRCATY3     AND A CATEGORY 3 WAS FOUND                   
         J     XIT                 TERMINATE THIS TRANSACTION                   
         DROP  RE                                                               
                                                                                
***********************************************************************         
*        CONSTANTS AND LITERALS                                       *         
***********************************************************************         
                                                                                
         LTORG                                                                  
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (TV SESSION)                             
         SPACE 1                                                                
SCRTBL   DS    0C                                                               
SCRT50   DC    AL1(SCR50,SCRT50X-SCRT50)                                        
         DC    AL2(INITBF-INIT)                                                 
*                                                                               
         DC    AL2(BSSAUTHH-T702FFD)                                            
         DC    AL2(BSSESTH-T702FFD)                                             
         DC    AL2(BSSPDH-T702FFD)                                              
         DC    AL2(BSSCYCH-T702FFD)                                             
         DC    AL2(BSSLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(BSSBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(BSSEINVH-T702FFD)                                            
         DC    AL2(BSSOPT2H-T702FFD)                                            
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(BSSICOMH-T702FFD)                                            
         DC    AL2(BSSHCOMH-T702FFD)                                            
         DC    AL2(BSSCMNTH-T702FFD)                                            
         DC    AL2(BSSDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(0)                                                           
         DC    AL2(DISBF-T70252)                                                
         DC    AL2(VALBF-T70252)                                                
         DC    AL2(BINVBF-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LBFLNQ)                                                      
         DC    AL2(LBFOPTS-LINBFD)                                              
         DC    AL2(LBFSPOTH-LINBFD)                                             
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    X'FFFF'                                                          
         DC    AL2(LBFICDEH-LINBFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(LBFREIMH-LINBFD)                                             
         DC    AL2(LBFSPNHH-LINBFD)                                             
         DC    AL2(LBFMDEDH-LINBFD)                                             
         DC    AL2(LBFPAYH-LINBFD)                                              
*                                                                               
         DC    AL2(LBFAGTH-LINBFD)                                              
         DC    AL2(LBFCMNTH-LINBFD)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT50X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (GENERAL)                                
         SPACE 1                                                                
SCRT51   DC    AL1(SCR51,SCRT51X-SCRT51)                                        
         DC    AL2(INITBE-INIT)                                                 
*                                                                               
         DC    AL2(PAYAUTHH-T702FFD)                                            
         DC    AL2(PAYESTH-T702FFD)                                             
         DC    AL2(PAYPDH-T702FFD)                                              
         DC    AL2(PAYCYCH-T702FFD)                                             
         DC    AL2(PAYLCYCH-T702FFD)                                            
         DC    AL2(PAYDTLH-T702FFD)                                             
         DC    AL2(PAYBNPH-T702FFD)                                             
         DC    AL2(PAYUSNMH-T702FFD)                                            
         DC    AL2(PAYEINVH-T702FFD)                                            
         DC    AL2(PAYOPTH-T702FFD)                                             
         DC    AL2(PAYOVLYH-T702FFD)                                            
         DC    AL2(PAYICOMH-T702FFD)                                            
         DC    AL2(PAYHCOMH-T702FFD)                                            
         DC    AL2(PAYCMNTH-T702FFD)                                            
         DC    AL2(PAYDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCMBE-XVCOM)                                                
         DC    AL2(VSCR51-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVBE-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT51X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (DEALER)                                 
         SPACE 1                                                                
SCRT53   DC    AL1(SCR53,SCRT53X-SCRT53)                                        
         DC    AL2(INITBD-INIT)                                                 
*                                                                               
         DC    AL2(DLRAUTHH-T702FFD)                                            
         DC    AL2(DLRESTH-T702FFD)                                             
         DC    AL2(DLRPDH-T702FFD)                                              
         DC    AL2(DLRCYCH-T702FFD)                                             
         DC    AL2(DLRLCYCH-T702FFD)                                            
         DC    AL2(DLRDTLH-T702FFD)                                             
         DC    AL2(DLRBNPH-T702FFD)                                             
         DC    AL2(DLRUSNMH-T702FFD)                                            
         DC    AL2(DLREINVH-T702FFD)                                            
         DC    AL2(DLROPTH-T702FFD)                                             
         DC    AL2(DLROVLYH-T702FFD)                                            
         DC    AL2(DLRICOMH-T702FFD)                                            
         DC    AL2(DLRHCOMH-T702FFD)                                            
         DC    AL2(DLRCMNTH-T702FFD)                                            
         DC    AL2(DLRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCMBD-XVCOM)                                                
         DC    AL2(VSCRBD-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVBD-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT53X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (RADIO NETWORK)                          
         SPACE 1                                                                
SCRT54   DC    AL1(SCR54,SCRT54X-SCRT54)                                        
         DC    AL2(INITBC-INIT)                                                 
*                                                                               
         DC    AL2(RNTAUTHH-T702FFD)                                            
         DC    AL2(RNTESTH-T702FFD)                                             
         DC    AL2(RNTPDH-T702FFD)                                              
         DC    AL2(RNTCYCH-T702FFD)                                             
         DC    AL2(RNTLCYCH-T702FFD)                                            
         DC    AL2(RNTDTLH-T702FFD)                                             
         DC    AL2(RNTBNPH-T702FFD)                                             
         DC    AL2(RNTUSNMH-T702FFD)                                            
         DC    AL2(RNTEINVH-T702FFD)                                            
         DC    AL2(RNTOPTH-T702FFD)                                             
         DC    AL2(RNTOVLYH-T702FFD)                                            
         DC    AL2(RNTICOMH-T702FFD)                                            
         DC    AL2(RNTHCOMH-T702FFD)                                            
         DC    AL2(RNTCMNTH-T702FFD)                                            
         DC    AL2(RNTDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCMBC-XVCOM)                                                
         DC    AL2(VSCRBC-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVBC-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT54X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (WILDSPOT)                               
         SPACE 1                                                                
SCRT55   DC    AL1(SCR55,SCRT55X-SCRT55)                                        
         DC    AL2(INITBB-INIT)                                                 
*                                                                               
         DC    AL2(WSPAUTHH-T702FFD)                                            
         DC    AL2(WSPESTH-T702FFD)                                             
         DC    AL2(WSPPDH-T702FFD)                                              
         DC    AL2(WSPCYCH-T702FFD)                                             
         DC    AL2(WSPLCYCH-T702FFD)                                            
         DC    AL2(WSPDTLH-T702FFD)                                             
         DC    AL2(WSPBNPH-T702FFD)                                             
         DC    AL2(WSPUSNMH-T702FFD)                                            
         DC    AL2(WSPEINVH-T702FFD)                                            
         DC    AL2(WSPOPTH-T702FFD)                                             
*        DC    AL2(WSPWEBSH-T702FFD)                                            
         DC    AL2(WSPOVLYH-T702FFD)                                            
         DC    AL2(WSPICOMH-T702FFD)                                            
         DC    AL2(WSPHCOMH-T702FFD)                                            
         DC    AL2(WSPCMNTH-T702FFD)                                            
         DC    AL2(WSPDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCMBB-XVCOM)                                                
         DC    AL2(VSCRBB-T70252)                                               
         DC    AL2(XVMDCM-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVCOM-T70252)                                              
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT55X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (NETWORK / CLASS A)                      
         SPACE 1                                                                
SCRT5B   DC    AL1(SCR5B,SCRT5BX-SCRT5B)                                        
         DC    AL2(INITBA-INIT)                                                 
*                                                                               
         DC    AL2(CLAAUTHH-T702FFD)                                            
         DC    AL2(CLAESTH-T702FFD)                                             
         DC    AL2(CLAPDH-T702FFD)                                              
         DC    AL2(CLACYCH-T702FFD)                                             
         DC    AL2(CLALCYCH-T702FFD)                                            
         DC    AL2(CLADTLH-T702FFD)                                             
         DC    AL2(CLABNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(CLAEINVH-T702FFD)                                            
         DC    AL2(CLAOPTH-T702FFD)                                             
         DC    AL2(CLAOVLYH-T702FFD)                                            
         DC    AL2(CLAICOMH-T702FFD)                                            
         DC    AL2(CLAHCOMH-T702FFD)                                            
         DC    AL2(CLACMNTH-T702FFD)                                            
         DC    AL2(CLADUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCMBA-XVCOM)                                                
         DC    AL2(VSCRBA-T70252)                                               
         DC    AL2(XVMDBA-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVBA-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT5BX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (CABLE)                                  
         SPACE 1                                                                
SCRT57   DC    AL1(SCR57,SCRT57X-SCRT57)                                        
         DC    AL2(INITB9-INIT)                                                 
*                                                                               
         DC    AL2(CABAUTHH-T702FFD)                                            
         DC    AL2(CABESTH-T702FFD)                                             
         DC    AL2(CABPDH-T702FFD)                                              
         DC    AL2(CABCYCH-T702FFD)                                             
         DC    AL2(CABLCYCH-T702FFD)                                            
         DC    AL2(CABDTLH-T702FFD)                                             
         DC    AL2(CABBNPH-T702FFD)                                             
         DC    AL2(CABUSNMH-T702FFD)                                            
         DC    AL2(CABEINVH-T702FFD)                                            
         DC    AL2(CABOPTH-T702FFD)                                             
         DC    AL2(CABOVLYH-T702FFD)                                            
         DC    AL2(CABICOMH-T702FFD)                                            
         DC    AL2(CABHCOMH-T702FFD)                                            
         DC    AL2(CABCMNTH-T702FFD)                                            
         DC    AL2(CABDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCMB9-XVCOM)                                                
         DC    AL2(VSCRB9-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVB9-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT57X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (MUSIC)                                  
         SPACE 1                                                                
SCRT56   DC    AL1(SCR56,SCRT56X-SCRT56)                                        
         DC    AL2(INITB8-INIT)                                                 
*                                                                               
         DC    AL2(MUSAUTHH-T702FFD)                                            
         DC    AL2(MUSESTH-T702FFD)                                             
         DC    AL2(MUSPDH-T702FFD)                                              
         DC    AL2(MUSCYCH-T702FFD)                                             
         DC    AL2(MUSLCYCH-T702FFD)                                            
         DC    AL2(MUSDTLH-T702FFD)                                             
         DC    AL2(MUSBNPH-T702FFD)                                             
         DC    AL2(MUSUSNMH-T702FFD)                                            
         DC    AL2(MUSEINVH-T702FFD)                                            
         DC    AL2(MUSOPTH-T702FFD)                                             
         DC    AL2(MUSOVLYH-T702FFD)                                            
         DC    AL2(MUSICOMH-T702FFD)                                            
         DC    AL2(MUSHCOMH-T702FFD)                                            
         DC    AL2(MUSCMNTH-T702FFD)                                            
         DC    AL2(MUSDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCMB8-XVCOM)                                                
         DC    AL2(VSCRB8-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVB8-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT56X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (MUSIC SESSION)                          
         SPACE 1                                                                
SCRT5A   DC    AL1(SCR5A,SCRT5AX-SCRT5A)                                        
         DC    AL2(INITAF-INIT)                                                 
*                                                                               
         DC    AL2(BSMAUTHH-T702FFD)                                            
         DC    AL2(BSMESTH-T702FFD)                                             
         DC    AL2(BSMPDH-T702FFD)                                              
         DC    AL2(BSMCYCH-T702FFD)                                             
         DC    AL2(BSMLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(BSMBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(BSMEINVH-T702FFD)                                            
         DC    AL2(BSMOPTH-T702FFD)                                             
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(BSMICOMH-T702FFD)                                            
         DC    AL2(BSMHCOMH-T702FFD)                                            
         DC    AL2(BSMCMNTH-T702FFD)                                            
         DC    AL2(BSMDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCRMSES-T70252)                                             
         DC    AL2(0)                                                           
         DC    AL2(DISAF-T70252)                                                
         DC    AL2(VALAF-T70252)                                                
         DC    AL2(BINVAF-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LAFLNQ)                                                      
         DC    AL2(LAFOPTS-LINAFD)                                              
         DC    AL2(LAFSPOTH-LINAFD)                                             
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    AL2(LAFAINDH-LINAFD)                                             
         DC    AL2(LAFRINDH-LINAFD)                                             
*                                                                               
         DC    AL2(LAFAPPLH-LINAFD)                                             
         DC    AL2(LAFREIMH-LINAFD)                                             
         DC    AL2(LAFSPNHH-LINAFD)                                             
         DC    AL2(LAFMDEDH-LINAFD)                                             
         DC    AL2(LAFPAYH-LINAFD)                                              
*                                                                               
         DC    AL2(LAFAGTH-LINAFD)                                              
         DC    AL2(LAFCMNTH-LINAFD)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT5AX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (GUARANTEE)                              
         SPACE 1                                                                
SCRT52   DC    AL1(SCR52,SCRT52X-SCRT52)                                        
         DC    AL2(INITA6-INIT)                                                 
*                                                                               
         DC    AL2(GRTAUTHH-T702FFD)                                            
         DC    AL2(GRTESTH-T702FFD)                                             
         DC    AL2(GRTPDH-T702FFD)                                              
         DC    AL2(GRTCYCH-T702FFD)                                             
         DC    AL2(GRTLCYCH-T702FFD)                                            
         DC    AL2(GRTDTLH-T702FFD)                                             
         DC    AL2(GRTBNPH-T702FFD)                                             
         DC    AL2(GRTUSNMH-T702FFD)                                            
         DC    AL2(GRTEINVH-T702FFD)                                            
         DC    AL2(GRTOPTH-T702FFD)                                             
         DC    AL2(GRTOVLYH-T702FFD)                                            
         DC    AL2(GRTICOMH-T702FFD)                                            
         DC    AL2(GRTHCOMH-T702FFD)                                            
         DC    AL2(GRTCMNTH-T702FFD)                                            
         DC    AL2(GRTDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCMA6-XVCOM)                                                
         DC    AL2(0)                                                           
         DC    AL2(XVMDA6-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVA6-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT52X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (RADIO SESSION)                          
         SPACE 1                                                                
SCRT58   DC    AL1(SCR58,SCRT58X-SCRT58)                                        
         DC    AL2(INIT58-INIT)                                                 
*                                                                               
         DC    AL2(BSRAUTHH-T702FFD)                                            
         DC    AL2(BSRESTH-T702FFD)                                             
         DC    AL2(BSRPDH-T702FFD)                                              
         DC    AL2(BSRCYCH-T702FFD)                                             
         DC    AL2(BSRLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(BSRBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(BSREINVH-T702FFD)                                            
         DC    AL2(BSROPTH-T702FFD)                                             
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(BSRICOMH-T702FFD)                                            
         DC    AL2(BSRHCOMH-T702FFD)                                            
         DC    AL2(BSRCMNTH-T702FFD)                                            
         DC    AL2(BSRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(0)                                                           
         DC    AL2(DIS58-T70252)                                                
         DC    AL2(VAL58-T70252)                                                
         DC    AL2(BINV58-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L58LNQ)                                                      
         DC    AL2(L58OPTS-LIN58D)                                              
         DC    AL2(L58SPOTH-LIN58D)                                             
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    AL2(L58AINDH-LIN58D)                                             
         DC    AL2(L58RINDH-LIN58D)                                             
*                                                                               
         DC    AL2(L58APPLH-LIN58D)                                             
         DC    AL2(L58REIMH-LIN58D)                                             
         DC    AL2(L58SPNHH-LIN58D)                                             
         DC    AL2(L58MDEDH-LIN58D)                                             
         DC    AL2(L58PAYH-LIN58D)                                              
*                                                                               
         DC    AL2(L58AGTH-LIN58D)                                              
         DC    AL2(L58CMNTH-LIN58D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT58X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (RAIO REGIONAL NETWORK)                  
         SPACE 1                                                                
SCRT59   DC    AL1(SCR59,SCRT59X-SCRT59)                                        
         DC    AL2(INIT59-INIT)                                                 
*                                                                               
         DC    AL2(RRNAUTHH-T702FFD)                                            
         DC    AL2(RRNESTH-T702FFD)                                             
         DC    AL2(RRNPDH-T702FFD)                                              
         DC    AL2(RRNCYCH-T702FFD)                                             
         DC    AL2(RRNLCYCH-T702FFD)                                            
         DC    AL2(RRNDTLH-T702FFD)                                             
         DC    AL2(RRNBNPH-T702FFD)                                             
         DC    AL2(RRNUSNMH-T702FFD)                                            
         DC    AL2(RRNEINVH-T702FFD)                                            
         DC    AL2(RRNOPTH-T702FFD)                                             
         DC    AL2(RRNOVLYH-T702FFD)                                            
         DC    AL2(RRNICOMH-T702FFD)                                            
         DC    AL2(RRNHCOMH-T702FFD)                                            
         DC    AL2(RRNCMNTH-T702FFD)                                            
         DC    AL2(RRNDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM59-XVCOM)                                                
         DC    AL2(VSCR59-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV59-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT59X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (LOCAL REUSE)                            
         SPACE 1                                                                
SCRT5C   DC    AL1(SCR5C,SCRT5CX-SCRT5C)                                        
         DC    AL2(INIT5C-INIT)                                                 
*                                                                               
         DC    AL2(LOCAUTHH-T702FFD)                                            
         DC    AL2(LOCESTH-T702FFD)                                             
         DC    AL2(LOCPDH-T702FFD)                                              
         DC    AL2(LOCCYCH-T702FFD)                                             
         DC    AL2(LOCLCYCH-T702FFD)                                            
         DC    AL2(LOCDTLH-T702FFD)                                             
         DC    AL2(LOCBNPH-T702FFD)                                             
         DC    AL2(LOCUSNMH-T702FFD)                                            
         DC    AL2(LOCEINVH-T702FFD)                                            
         DC    AL2(LOCOPTH-T702FFD)                                             
         DC    AL2(LOCOVLYH-T702FFD)                                            
         DC    AL2(LOCICOMH-T702FFD)                                            
         DC    AL2(LOCHCOMH-T702FFD)                                            
         DC    AL2(LOCCMNTH-T702FFD)                                            
         DC    AL2(LOCDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM5C-XVCOM)                                                
         DC    AL2(VSCR5C-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV5C-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT5CX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (SOAP)                                   
         SPACE 1                                                                
SCRT5D   DC    AL1(SCR5D,SCRT5DX-SCRT5D)                                        
         DC    AL2(INIT5D-INIT)                                                 
*                                                                               
         DC    AL2(SOPAUTHH-T702FFD)                                            
         DC    AL2(SOPESTH-T702FFD)                                             
         DC    AL2(SOPPDH-T702FFD)                                              
         DC    AL2(SOPCYCH-T702FFD)                                             
         DC    AL2(SOPLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(SOPBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SOPEINVH-T702FFD)                                            
         DC    AL2(SOPOPTH-T702FFD)                                             
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(SOPICOMH-T702FFD)                                            
         DC    AL2(SOPHCOMH-T702FFD)                                            
         DC    AL2(SOPCMNTH-T702FFD)                                            
         DC    AL2(SOPDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(0)                                                           
         DC    AL2(DIS5D-T70252)                                                
         DC    AL2(VAL5D-T70252)                                                
         DC    AL2(BINV5D-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L5DLNQ)                                                      
         DC    AL2(0)                OPTIONAL INFO -  NOT ON SCREEN             
         DC    AL2(L5DICDEH-LIN5DD)                                             
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    X'FFFF'                                                          
         DC    AL2(L5DICDEH-LIN5DD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(L5DREIMH-LIN5DD)                                             
         DC    AL2(L5DSPNHH-LIN5DD)                                             
         DC    AL2(L5DMDEDH-LIN5DD)                                             
         DC    AL2(L5DPAYH-LIN5DD)                                              
*                                                                               
         DC    AL2(L5DAGTH-LIN5DD)                                              
         DC    AL2(L5DCMNTH-LIN5DD)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT5DX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (FOREIGN REUSE)                          
         SPACE 1                                                                
SCRT5E   DC    AL1(SCR5E,SCRT5EX-SCRT5E)                                        
         DC    AL2(INIT5E-INIT)                                                 
*                                                                               
         DC    AL2(FGRAUTHH-T702FFD)                                            
         DC    AL2(FGRESTH-T702FFD)                                             
         DC    AL2(FGRPDH-T702FFD)                                              
         DC    AL2(FGRCYCH-T702FFD)                                             
         DC    AL2(FGRLCYCH-T702FFD)                                            
         DC    AL2(FGRDTLH-T702FFD)                                             
         DC    AL2(FGRBNPH-T702FFD)                                             
         DC    AL2(FGRUSNMH-T702FFD)                                            
         DC    AL2(FGREINVH-T702FFD)                                            
         DC    AL2(FGROPTH-T702FFD)                                             
         DC    AL2(FGROVLYH-T702FFD)                                            
         DC    AL2(FGRICOMH-T702FFD)                                            
         DC    AL2(FGRHCOMH-T702FFD)                                            
         DC    AL2(FGRCMNTH-T702FFD)                                            
         DC    AL2(FGRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM5E-XVCOM)                                                
         DC    AL2(VSCR5E-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV5E-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT5EX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (CABLE - 91 CONTRACT)                    
         SPACE 1                                                                
SCRT5F   DC    AL1(SCR5F,SCRT5FX-SCRT5F)                                        
         DC    AL2(INIT5F-INIT)                                                 
*                                                                               
         DC    AL2(CBLAUTHH-T702FFD)                                            
         DC    AL2(CBLESTH-T702FFD)                                             
         DC    AL2(CBLPDH-T702FFD)                                              
         DC    AL2(CBLCYCH-T702FFD)                                             
         DC    AL2(CBLLCYCH-T702FFD)                                            
         DC    AL2(CBLDTLH-T702FFD)                                             
         DC    AL2(CBLBNPH-T702FFD)                                             
         DC    AL2(CBLUSNMH-T702FFD)                                            
         DC    AL2(CBLEINVH-T702FFD)                                            
         DC    AL2(CBLOPTH-T702FFD)                                             
         DC    AL2(CBLOVLYH-T702FFD)                                            
         DC    AL2(CBLICOMH-T702FFD)                                            
         DC    AL2(CBLHCOMH-T702FFD)                                            
         DC    AL2(CBLCMNTH-T702FFD)                                            
         DC    AL2(CBLDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM5F-XVCOM)                                                
         DC    AL2(VSCR5F-T70252)                                               
         DC    AL2(XVMDCM-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVCOM-T70252)                                              
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT5FX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (FIRST MUSIC)                            
         SPACE 1                                                                
SCRT60   DC    AL1(SCR60,SCRT60X-SCRT60)                                        
         DC    AL2(INIT60-INIT)                                                 
*                                                                               
         DC    AL2(FMUAUTHH-T702FFD)                                            
         DC    AL2(FMUESTH-T702FFD)                                             
         DC    AL2(FMUPDH-T702FFD)                                              
         DC    AL2(FMUCYCH-T702FFD)                                             
         DC    AL2(FMULCYCH-T702FFD)                                            
         DC    AL2(FMUDTLH-T702FFD)                                             
         DC    AL2(FMUBNPH-T702FFD)                                             
         DC    AL2(FMUUSNMH-T702FFD)                                            
         DC    AL2(FMUEINVH-T702FFD)                                            
         DC    AL2(FMUOPTH-T702FFD)                                             
         DC    AL2(FMUOVLYH-T702FFD)                                            
         DC    AL2(FMUICOMH-T702FFD)                                            
         DC    AL2(FMUHCOMH-T702FFD)                                            
         DC    AL2(FMUCMNTH-T702FFD)                                            
         DC    AL2(FMUDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM60-XVCOM)                                                
         DC    AL2(VSCR60-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV60-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT60X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (SPANISH WILDSPOT)                       
         SPACE 1                                                                
SCRT61   DC    AL1(SCR61,SCRT61X-SCRT61)                                        
         DC    AL2(INIT61-INIT)                                                 
*                                                                               
         DC    AL2(SWSAUTHH-T702FFD)                                            
         DC    AL2(SWSESTH-T702FFD)                                             
         DC    AL2(SWSPDH-T702FFD)                                              
         DC    AL2(SWSCYCH-T702FFD)                                             
         DC    AL2(SWSLCYCH-T702FFD)                                            
         DC    AL2(SWSDTLH-T702FFD)                                             
         DC    AL2(SWSBNPH-T702FFD)                                             
         DC    AL2(SWSUSNMH-T702FFD)                                            
         DC    AL2(SWSEINVH-T702FFD)                                            
         DC    AL2(SWSOPTH-T702FFD)                                             
         DC    AL2(SWSOVLYH-T702FFD)                                            
         DC    AL2(SWSICOMH-T702FFD)                                            
         DC    AL2(SWSHCOMH-T702FFD)                                            
         DC    AL2(SWSCMNTH-T702FFD)                                            
         DC    AL2(SWSDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM61-XVCOM)                                                
         DC    AL2(VSCR61-T70252)                                               
         DC    AL2(XVMD61-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV61-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT61X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (FOREIGN MUSIC)                          
         SPACE 1                                                                
SCRT62   DC    AL1(SCR62,SCRT62X-SCRT62)                                        
         DC    AL2(INIT62-INIT)                                                 
*                                                                               
         DC    AL2(FGMAUTHH-T702FFD)                                            
         DC    AL2(FGMESTH-T702FFD)                                             
         DC    AL2(FGMPDH-T702FFD)                                              
         DC    AL2(FGMCYCH-T702FFD)                                             
         DC    AL2(FGMLCYCH-T702FFD)                                            
         DC    AL2(FGMDTLH-T702FFD)                                             
         DC    AL2(FGMBNPH-T702FFD)                                             
         DC    AL2(FGMUSNMH-T702FFD)                                            
         DC    AL2(FGMEINVH-T702FFD)                                            
         DC    AL2(FGMOPTH-T702FFD)                                             
         DC    AL2(FGMOVLYH-T702FFD)                                            
         DC    AL2(FGMICOMH-T702FFD)                                            
         DC    AL2(FGMHCOMH-T702FFD)                                            
         DC    AL2(FGMCMNTH-T702FFD)                                            
         DC    AL2(FGMDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM62-XVCOM)                                                
         DC    AL2(VSCR62-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV62-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT62X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (SPANISH NETWORK/WILDSPOT)               
         SPACE 1                                                                
SCRT63   DC    AL1(SCR63,SCRT63X-SCRT63)                                        
         DC    AL2(INIT63-INIT)                                                 
*                                                                               
         DC    AL2(SNWAUTHH-T702FFD)                                            
         DC    AL2(SNWESTH-T702FFD)                                             
         DC    AL2(SNWPDH-T702FFD)                                              
         DC    AL2(SNWCYCH-T702FFD)                                             
         DC    AL2(SNWLCYCH-T702FFD)                                            
         DC    AL2(SNWDTLH-T702FFD)                                             
         DC    AL2(SNWBNPH-T702FFD)                                             
         DC    AL2(SNWUSNMH-T702FFD)                                            
         DC    AL2(SNWEINVH-T702FFD)                                            
         DC    AL2(SNWOPTH-T702FFD)                                             
         DC    AL2(SNWOVLYH-T702FFD)                                            
         DC    AL2(SNWICOMH-T702FFD)                                            
         DC    AL2(SNWHCOMH-T702FFD)                                            
         DC    AL2(SNWCMNTH-T702FFD)                                            
         DC    AL2(SNWDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM63-XVCOM)                                                
         DC    AL2(VSCR63-T70252)                                               
         DC    AL2(XVMD63-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV63-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT63X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (ADDENDUM SESSION - TV)                  
         SPACE 1                                                                
SCRT64   DC    AL1(SCR64,SCRT64X-SCRT64)                                        
         DC    AL2(INIT64-INIT)                                                 
*                                                                               
         DC    AL2(ADTAUTHH-T702FFD)                                            
         DC    AL2(ADTESTH-T702FFD)                                             
         DC    AL2(ADTPDH-T702FFD)                                              
         DC    AL2(ADTCYCH-T702FFD)                                             
         DC    AL2(ADTLCYCH-T702FFD)                                            
         DC    AL2(0)                                                           
         DC    AL2(ADTBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(ADTEINVH-T702FFD)                                            
         DC    AL2(ADTOPTH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(ADTICOMH-T702FFD)                                            
         DC    AL2(ADTHCOMH-T702FFD)                                            
         DC    AL2(ADTCMNTH-T702FFD)                                            
         DC    AL2(ADTDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM64-XVCOM)                                                
         DC    AL2(VSCR64-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISBF-T70252)                                                
         DC    AL2(VALBF-T70252)                                                
         DC    AL2(BINV64-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LBFLNQ)                                                      
         DC    AL2(LBFOPTS-LINBFD)                                              
         DC    AL2(LBFSPOTH-LINBFD)                                             
         DC    X'FFFF'             NOT ON SCREEN                                
         DC    X'FFFF'                                                          
         DC    AL2(LBFICDEH-LINBFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(LBFREIMH-LINBFD)                                             
         DC    AL2(LBFSPNHH-LINBFD)                                             
         DC    AL2(LBFMDEDH-LINBFD)                                             
         DC    AL2(LBFPAYH-LINBFD)                                              
*                                                                               
         DC    AL2(LBFAGTH-LINBFD)                                              
         DC    AL2(LBFCMNTH-LINBFD)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT64X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (ADDENDUM SESSION - RADIO)               
         SPACE 1                                                                
SCRT65   DC    AL1(SCR65,SCRT65X-SCRT65)                                        
         DC    AL2(INIT65-INIT)                                                 
*                                                                               
         DC    AL2(ADOAUTHH-T702FFD)                                            
         DC    AL2(ADOESTH-T702FFD)                                             
         DC    AL2(ADOPDH-T702FFD)                                              
         DC    AL2(ADOCYCH-T702FFD)                                             
         DC    AL2(ADOLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(ADOBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(ADOEINVH-T702FFD)                                            
         DC    AL2(ADOOPTH-T702FFD)                                             
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(ADOICOMH-T702FFD)                                            
         DC    AL2(ADOHCOMH-T702FFD)                                            
         DC    AL2(ADOCMNTH-T702FFD)                                            
         DC    AL2(ADODUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM65-XVCOM)                                                
         DC    AL2(VSCR65-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DIS58-T70252)                                                
         DC    AL2(VAL58-T70252)                                                
         DC    AL2(BINV65-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L58LNQ)                                                      
         DC    AL2(L58OPTS-LIN58D)                                              
         DC    AL2(L58SPOTH-LIN58D)                                             
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    AL2(L58AINDH-LIN58D)                                             
         DC    AL2(L58RINDH-LIN58D)                                             
*                                                                               
         DC    AL2(L58APPLH-LIN58D)                                             
         DC    AL2(L58REIMH-LIN58D)                                             
         DC    AL2(L58SPNHH-LIN58D)                                             
         DC    AL2(L58MDEDH-LIN58D)                                             
         DC    AL2(L58PAYH-LIN58D)                                              
*                                                                               
         DC    AL2(L58AGTH-LIN58D)                                              
         DC    AL2(L58CMNTH-LIN58D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT65X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (ADDENDUM WILDSPOT)                      
         SPACE 1                                                                
SCRT66   DC    AL1(SCR66,SCRT66X-SCRT66)                                        
         DC    AL2(INIT66-INIT)                                                 
*                                                                               
         DC    AL2(ADWAUTHH-T702FFD)                                            
         DC    AL2(ADWESTH-T702FFD)                                             
         DC    AL2(ADWPDH-T702FFD)                                              
         DC    AL2(ADWCYCH-T702FFD)                                             
         DC    AL2(ADWLCYCH-T702FFD)                                            
         DC    AL2(ADWDTLH-T702FFD)                                             
         DC    AL2(ADWBNPH-T702FFD)                                             
         DC    AL2(ADWUSNMH-T702FFD)                                            
         DC    AL2(ADWEINVH-T702FFD)                                            
         DC    AL2(ADWOPTH-T702FFD)                                             
         DC    AL2(ADWOVLYH-T702FFD)                                            
         DC    AL2(ADWICOMH-T702FFD)                                            
         DC    AL2(ADWHCOMH-T702FFD)                                            
         DC    AL2(ADWCMNTH-T702FFD)                                            
         DC    AL2(ADWDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM66-XVCOM)                                                
         DC    AL2(VSCR66-T70252)                                               
         DC    AL2(XVMDCM-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINVCOM-T70252)                                              
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT66X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (ADDENDUM COMBINED SESS/WSP)             
         SPACE 1                                                                
SCRT67   DC    AL1(SCR67,SCRT67X-SCRT67)                                        
         DC    AL2(INIT67-INIT)                                                 
*                                                                               
         DC    AL2(ADCAUTHH-T702FFD)                                            
         DC    AL2(ADCESTH-T702FFD)                                             
         DC    AL2(ADCPDH-T702FFD)                                              
         DC    AL2(ADCCYCH-T702FFD)                                             
         DC    AL2(ADCLCYCH-T702FFD)                                            
         DC    AL2(ADCDTLH-T702FFD)                                             
         DC    AL2(ADCBNPH-T702FFD)                                             
         DC    AL2(ADCUSNMH-T702FFD)                                            
         DC    AL2(ADCEINVH-T702FFD)                                            
         DC    AL2(ADCOPTH-T702FFD)                                             
         DC    AL2(ADCOVLYH-T702FFD)                                            
         DC    AL2(ADCICOMH-T702FFD)                                            
         DC    AL2(ADCHCOMH-T702FFD)                                            
         DC    AL2(ADCCMNTH-T702FFD)                                            
         DC    AL2(ADCDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM67-XVCOM)                                                
         DC    AL2(VSCR67-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV67-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT67X  EQU   *                                                                
         EJECT                                                                  
*&&DO                                                                           
*              TABLE OF DISPLACEMENTS  (INSERTS FOR BOOKENDS)                   
         SPACE 1                                                                
SCRT68   DC    AL1(SCR68,SCRT68X-SCRT68)                                        
         DC    AL2(INIT68-INIT)                                                 
*                                                                               
         DC    AL2(IFBAUTHH-T702FFD)                                            
         DC    AL2(IFBESTH-T702FFD)                                             
         DC    AL2(IFBPDH-T702FFD)                                              
         DC    AL2(IFBCYCH-T702FFD)                                             
         DC    AL2(IFBLCYCH-T702FFD)                                            
         DC    AL2(IFBDTLH-T702FFD)                                             
         DC    AL2(IFBBNPH-T702FFD)                                             
         DC    AL2(IFBUSNMH-T702FFD)                                            
         DC    AL2(IFBEINVH-T702FFD)                                            
         DC    AL2(IFBOPTH-T702FFD)                                             
         DC    AL2(IFBOVLYH-T702FFD)                                            
         DC    AL2(IFBICOMH-T702FFD)                                            
         DC    AL2(IFBHCOMH-T702FFD)                                            
         DC    AL2(IFBCMNTH-T702FFD)                                            
         DC    AL2(IFBDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM68-XVCOM)                                                
         DC    AL2(VSCR68-T70252)                                               
         DC    AL2(XVMD68-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV68-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT68X  EQU   *                                                                
         EJECT                                                                  
*&&                                                                             
*              TABLE OF DISPLACEMENTS  (PRINT)                                  
         SPACE 1                                                                
SCRT69   DC    AL1(SCR69,SCRT69X-SCRT69)                                        
         DC    AL2(INIT69-INIT)                                                 
*                                                                               
         DC    AL2(PRTAUTHH-T702FFD)                                            
         DC    AL2(PRTESTH-T702FFD)                                             
         DC    AL2(PRTPDH-T702FFD)                                              
         DC    AL2(PRTCYCH-T702FFD)                                             
         DC    AL2(PRTLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(PRTBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(PRTEINVH-T702FFD)                                            
         DC    AL2(PRTOPT2H-T702FFD)                                            
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(PRTICOMH-T702FFD)                                            
         DC    AL2(PRTHCOMH-T702FFD)                                            
         DC    AL2(PRTCMNTH-T702FFD)                                            
         DC    AL2(PRTDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM69-XVCOM)                                                
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(0)                                                           
         DC    AL2(DIS69-T70252)                                                
         DC    AL2(VAL69-T70252)                                                
         DC    AL2(BINV69-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L69LNQ)                                                      
         DC    AL2(L69OPTS-LIN69D)                                              
         DC    AL2(L69ICDEH-LIN69D)                                             
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    X'FFFF'                                                          
         DC    AL2(L69ICDEH-LIN69D)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(L69REIMH-LIN69D)                                             
         DC    AL2(0)                SUBJ-P&H                                   
         DC    AL2(L69MDEDH-LIN69D)                                             
         DC    AL2(L69PAYH-LIN69D)                                              
*                                                                               
         DC    AL2(L69AGTH-LIN69D)                                              
         DC    AL2(L69CMNTH-LIN69D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT69X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (TAGS)                                   
         SPACE 1                                                                
SCRT6A   DC    AL1(SCR6A,SCRT6AX-SCRT6A)                                        
         DC    AL2(INIT6A-INIT)                                                 
*                                                                               
         DC    AL2(TAGAUTHH-T702FFD)                                            
         DC    AL2(TAGESTH-T702FFD)                                             
         DC    AL2(TAGPDH-T702FFD)                                              
         DC    AL2(TAGCYCH-T702FFD)                                             
         DC    AL2(TAGLCYCH-T702FFD)                                            
         DC    AL2(TAGDTLH-T702FFD)                                             
         DC    AL2(TAGBNPH-T702FFD)                                             
         DC    AL2(TAGUSNMH-T702FFD)                                            
         DC    AL2(TAGEINVH-T702FFD)                                            
         DC    AL2(TAGOPTH-T702FFD)                                             
         DC    AL2(TAGOVLYH-T702FFD)                                            
         DC    AL2(TAGICOMH-T702FFD)                                            
         DC    AL2(TAGHCOMH-T702FFD)                                            
         DC    AL2(TAGCMNTH-T702FFD)                                            
         DC    AL2(TAGDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM6A-XVCOM)                                                
         DC    AL2(VSCR6A-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV6A-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT6AX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (SOAP RESIDUALS)                         
         SPACE 1                                                                
SCRT6B   DC    AL1(SCR6B,SCRT6BX-SCRT6B)                                        
         DC    AL2(INIT6B-INIT)                                                 
*                                                                               
         DC    AL2(SORAUTHH-T702FFD)                                            
         DC    AL2(SORESTH-T702FFD)                                             
         DC    AL2(SORPDH-T702FFD)                                              
         DC    AL2(SORCYCH-T702FFD)                                             
         DC    AL2(SORLCYCH-T702FFD)                                            
         DC    AL2(0)                                                           
         DC    AL2(SORBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SOREINVH-T702FFD)                                            
         DC    AL2(SOROPTH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SORICOMH-T702FFD)                                            
         DC    AL2(SORHCOMH-T702FFD)                                            
         DC    AL2(SORCMNTH-T702FFD)                                            
         DC    AL2(SORDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM6B-XVCOM)                                                
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(XVMD6B-T70252)                                               
         DC    AL2(DIS6B-T70252)                                                
         DC    AL2(VAL6B-T70252)                                                
         DC    AL2(BINV6B-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L6BLNQ)                                                      
         DC    AL2(L6BOPTS-LIN6BD)                                              
         DC    AL2(L6BNPH-LIN6BD)                                               
         DC    AL2(L6BNPH-LIN6BD)                                               
         DC    AL2(L6BACDEH-LIN6BD)                                             
         DC    AL2(L6BICDEH-LIN6BD)                                             
*                                                                               
         DC    AL2(L6BAPPLH-LIN6BD)                                             
         DC    AL2(L6BREIMH-LIN6BD)                                             
         DC    AL2(L6BSPNHH-LIN6BD)                                             
         DC    AL2(L6BMDEDH-LIN6BD)                                             
         DC    AL2(L6BPAYH-LIN6BD)                                              
*                                                                               
         DC    AL2(L6BAGTH-LIN6BD)                                              
         DC    AL2(L6BCMNTH-LIN6BD)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT6BX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (SOAP RESIDUALS-DIRCTR & WRITER)         
         SPACE 1                                                                
SCRT6C   DC    AL1(SCR6C,SCRT6CX-SCRT6C)                                        
         DC    AL2(INIT6C-INIT)                                                 
*                                                                               
         DC    AL2(SDRAUTHH-T702FFD)                                            
         DC    AL2(SDRESTH-T702FFD)                                             
         DC    AL2(SDRPDH-T702FFD)                                              
         DC    AL2(SDRCYCH-T702FFD)                                             
         DC    AL2(SDRLCYCH-T702FFD)                                            
         DC    AL2(0)                                                           
         DC    AL2(SDRBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SDREINVH-T702FFD)                                            
         DC    AL2(SDROPTH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SDRICOMH-T702FFD)                                            
         DC    AL2(SDRHCOMH-T702FFD)                                            
         DC    AL2(SDRCMNTH-T702FFD)                                            
         DC    AL2(SDRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM6C-XVCOM)                                                
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(XVMD6B-T70252)   USE SAME ROUTINE AS SCR6B                   
         DC    AL2(DIS6B-T70252)     "   "      "    "    "                     
         DC    AL2(VAL6B-T70252)     "   "      "    "    "                     
         DC    AL2(BINV6C-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L6BLNQ)          ASSUME SAME DETAIL LINES AS SCR6B           
         DC    AL2(L6BOPTS-LIN6BD)                                              
         DC    AL2(L6BNPH-LIN6BD)                                               
         DC    AL2(L6BNPH-LIN6BD)                                               
         DC    AL2(L6BACDEH-LIN6BD)                                             
         DC    AL2(L6BICDEH-LIN6BD)                                             
*                                                                               
         DC    AL2(L6BAPPLH-LIN6BD)                                             
         DC    AL2(L6BREIMH-LIN6BD)                                             
         DC    AL2(L6BSPNHH-LIN6BD)                                             
         DC    AL2(L6BMDEDH-LIN6BD)                                             
         DC    AL2(L6BPAYH-LIN6BD)                                              
*                                                                               
         DC    AL2(L6BAGTH-LIN6BD)                                              
         DC    AL2(L6BCMNTH-LIN6BD)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT6CX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INDUSTRIAL REUSE)                       
         SPACE 1                                                                
SCRT6D   DC    AL1(SCR6D,SCRT6DX-SCRT6D)                                        
         DC    AL2(INIT6D-INIT)                                                 
*                                                                               
         DC    AL2(INRAUTHH-T702FFD)                                            
         DC    AL2(INRESTH-T702FFD)                                             
         DC    AL2(INRPDH-T702FFD)                                              
         DC    AL2(INRCYCH-T702FFD)                                             
         DC    AL2(INRLCYCH-T702FFD)                                            
         DC    AL2(INRDTLH-T702FFD)                                             
         DC    AL2(INRBNPH-T702FFD)                                             
         DC    AL2(INRUSNMH-T702FFD)                                            
         DC    AL2(INREINVH-T702FFD)                                            
         DC    AL2(INROPTH-T702FFD)                                             
         DC    AL2(INROVLYH-T702FFD)                                            
         DC    AL2(INRICOMH-T702FFD)                                            
         DC    AL2(INRHCOMH-T702FFD)                                            
         DC    AL2(INRCMNTH-T702FFD)                                            
         DC    AL2(INRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM6D-XVCOM)                                                
         DC    AL2(VSCR6D-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV6D-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT6DX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (SOAP CABLE RESIDUALS)                   
         SPACE 1                                                                
SCRT6E   DC    AL1(SCR6E,SCRT6EX-SCRT6E)                                        
         DC    AL2(INIT6E-INIT)                                                 
*                                                                               
         DC    AL2(SOCAUTHH-T702FFD)                                            
         DC    AL2(SOCESTH-T702FFD)                                             
         DC    AL2(SOCPDH-T702FFD)                                              
         DC    AL2(SOCCYCH-T702FFD)                                             
         DC    AL2(SOCLCYCH-T702FFD)                                            
         DC    AL2(0)                                                           
         DC    AL2(SOCBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SOCEINVH-T702FFD)                                            
         DC    AL2(SOCOPTH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SOCICOMH-T702FFD)                                            
         DC    AL2(SOCHCOMH-T702FFD)                                            
         DC    AL2(SOCCMNTH-T702FFD)                                            
         DC    AL2(SOCDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM6E-XVCOM)                                                
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(XVMD6B-T70252)   USE SAME ROUTINE AS SCR6B                   
         DC    AL2(DIS6B-T70252)     "   "      "    "    "                     
         DC    AL2(VAL6B-T70252)     "   "      "    "    "                     
         DC    AL2(BINV6E-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L6BLNQ)         ASSUME SAME DETAIL LINES AS SCR6B            
         DC    AL2(L6BOPTS-LIN6BD)                                              
         DC    AL2(L6BNPH-LIN6BD)                                               
         DC    AL2(L6BNPH-LIN6BD)                                               
         DC    AL2(L6BACDEH-LIN6BD)                                             
         DC    AL2(L6BICDEH-LIN6BD)                                             
*                                                                               
         DC    AL2(L6BAPPLH-LIN6BD)                                             
         DC    AL2(L6BREIMH-LIN6BD)                                             
         DC    AL2(L6BSPNHH-LIN6BD)                                             
         DC    AL2(L6BMDEDH-LIN6BD)                                             
         DC    AL2(L6BPAYH-LIN6BD)                                              
*                                                                               
         DC    AL2(L6BAGTH-LIN6BD)                                              
         DC    AL2(L6BCMNTH-LIN6BD)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT6EX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (SOAP CABLE RES-DIRCTR & WRITER)         
         SPACE 1                                                                
SCRT6F   DC    AL1(SCR6F,SCRT6FX-SCRT6F)                                        
         DC    AL2(INIT6F-INIT)                                                 
*                                                                               
         DC    AL2(SDCAUTHH-T702FFD)                                            
         DC    AL2(SDCESTH-T702FFD)                                             
         DC    AL2(SDCPDH-T702FFD)                                              
         DC    AL2(SDCCYCH-T702FFD)                                             
         DC    AL2(SDCLCYCH-T702FFD)                                            
         DC    AL2(0)                                                           
         DC    AL2(SDCBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SDCEINVH-T702FFD)                                            
         DC    AL2(SDCOPTH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(SDCICOMH-T702FFD)                                            
         DC    AL2(SDCHCOMH-T702FFD)                                            
         DC    AL2(SDCCMNTH-T702FFD)                                            
         DC    AL2(SDCDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM6F-XVCOM)                                                
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(XVMD6B-T70252)   USE SAME ROUTINE AS SCR6B                   
         DC    AL2(DIS6B-T70252)     "   "      "    "    "                     
         DC    AL2(VAL6B-T70252)     "   "      "    "    "                     
         DC    AL2(BINV6F-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L6BLNQ)          ASSUME SAME DETAIL LINES AS SCR6B           
         DC    AL2(L6BOPTS-LIN6BD)                                              
         DC    AL2(L6BNPH-LIN6BD)                                               
         DC    AL2(L6BNPH-LIN6BD)                                               
         DC    AL2(L6BACDEH-LIN6BD)                                             
         DC    AL2(L6BICDEH-LIN6BD)                                             
*                                                                               
         DC    AL2(L6BAPPLH-LIN6BD)                                             
         DC    AL2(L6BREIMH-LIN6BD)                                             
         DC    AL2(L6BSPNHH-LIN6BD)                                             
         DC    AL2(L6BMDEDH-LIN6BD)                                             
         DC    AL2(L6BPAYH-LIN6BD)                                              
*                                                                               
         DC    AL2(L6BAGTH-LIN6BD)                                              
         DC    AL2(L6BCMNTH-LIN6BD)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT6FX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (DEMOS)                                  
         SPACE 1                                                                
SCRT70   DC    AL1(SCR70,SCRT70X-SCRT70)                                        
         DC    AL2(INIT70-INIT)                                                 
*                                                                               
         DC    AL2(DEMAUTHH-T702FFD)                                            
         DC    AL2(DEMESTH-T702FFD)                                             
         DC    AL2(DEMPDH-T702FFD)                                              
         DC    AL2(DEMCYCH-T702FFD)                                             
         DC    AL2(DEMLCYCH-T702FFD)                                            
         DC    AL2(DEMDTLH-T702FFD)                                             
         DC    AL2(DEMBNPH-T702FFD)                                             
         DC    AL2(DEMUSNMH-T702FFD)                                            
         DC    AL2(DEMEINVH-T702FFD)                                            
         DC    AL2(DEMOPTH-T702FFD)                                             
         DC    AL2(DEMOVLYH-T702FFD)                                            
         DC    AL2(DEMICOMH-T702FFD)                                            
         DC    AL2(DEMHCOMH-T702FFD)                                            
         DC    AL2(DEMCMNTH-T702FFD)                                            
         DC    AL2(DEMDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM70-XVCOM)                                                
         DC    AL2(VSCR70-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV70-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT70X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (LOCAL CABLE)                            
         SPACE 1                                                                
SCRT71   DC    AL1(SCR71,SCRT71X-SCRT71)                                        
         DC    AL2(INIT71-INIT)                                                 
*                                                                               
         DC    AL2(LCBAUTHH-T702FFD)                                            
         DC    AL2(LCBESTH-T702FFD)                                             
         DC    AL2(LCBPDH-T702FFD)                                              
         DC    AL2(LCBCYCH-T702FFD)                                             
         DC    AL2(LCBLCYCH-T702FFD)                                            
         DC    AL2(LCBDTLH-T702FFD)                                             
         DC    AL2(LCBBNPH-T702FFD)                                             
         DC    AL2(LCBUSNMH-T702FFD)                                            
         DC    AL2(LCBEINVH-T702FFD)                                            
         DC    AL2(LCBOPTH-T702FFD)                                             
         DC    AL2(LCBOVLYH-T702FFD)                                            
         DC    AL2(LCBICOMH-T702FFD)                                            
         DC    AL2(LCBHCOMH-T702FFD)                                            
         DC    AL2(LCBCMNTH-T702FFD)                                            
         DC    AL2(LCBDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM71-XVCOM)                                                
         DC    AL2(VSCR71-T70252)                                               
         DC    AL2(XVMD71-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV71-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT71X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (P&H ONLY)                               
         SPACE 1                                                                
SCRT72   DC    AL1(SCR72,SCRT72X-SCRT72)                                        
         DC    AL2(INIT72-INIT)                                                 
*                                                                               
         DC    AL2(PNHAUTHH-T702FFD)                                            
         DC    AL2(PNHESTH-T702FFD)                                             
         DC    AL2(PNHPDH-T702FFD)                                              
         DC    AL2(PNHCYCH-T702FFD)                                             
         DC    AL2(PNHLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(PNHBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(PNHEINVH-T702FFD)                                            
         DC    AL2(PNHOPTH-T702FFD)                                             
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(PNHICOMH-T702FFD)                                            
         DC    AL2(PNHHCOMH-T702FFD)                                            
         DC    AL2(PNHCMNTH-T702FFD)                                            
         DC    AL2(PNHDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCR72-T70252)                                               
         DC    AL2(XVMD72-T70252)                                               
         DC    AL2(DIS72-T70252)                                                
         DC    AL2(VAL72-T70252)                                                
         DC    AL2(BINV72-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L72LNQ)                                                      
         DC    AL2(L72OPTS-LIN72D)                                              
         DC    AL2(L72NPH-LIN72D)                                               
         DC    AL2(L72NPH-LIN72D)                                               
         DC    X'FFFF'             NOT ON SCREEN                                
         DC    X'FFFF'                                                          
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(L72SPNHH-LIN72D)                                             
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L72AGTH-LIN72D)                                              
         DC    AL2(L72CMNTH-LIN72D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT72X  EQU   *                                                                
         EJECT                                                                  
*&&DO                                                                           
*              TABLE OF DISPLACEMENTS  (VARIATIONS/INSERTS)                     
         SPACE 1                                                                
SCRT73   DC    AL1(SCR73,SCRT73X-SCRT73)                                        
         DC    AL2(INIT73-INIT)                                                 
*                                                                               
         DC    AL2(VARAUTHH-T702FFD)                                            
         DC    AL2(VARESTH-T702FFD)                                             
         DC    AL2(VARPDH-T702FFD)                                              
         DC    AL2(VARCYCH-T702FFD)                                             
         DC    AL2(VARLCYCH-T702FFD)                                            
         DC    AL2(VARDTLH-T702FFD)                                             
         DC    AL2(VARBNPH-T702FFD)                                             
         DC    AL2(VARUSNMH-T702FFD)                                            
         DC    AL2(VAREINVH-T702FFD)                                            
         DC    AL2(VAROPTH-T702FFD)                                             
         DC    AL2(VAROVLYH-T702FFD)                                            
         DC    AL2(VARICOMH-T702FFD)                                            
         DC    AL2(VARHCOMH-T702FFD)                                            
         DC    AL2(VARCMNTH-T702FFD)                                            
         DC    AL2(VARDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM73-XVCOM)                                                
         DC    AL2(VSCR73-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV73-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT73X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (VARIATIONS/INSERTS NON-WORKING)         
         SPACE 1                                                                
SCRT74   DC    AL1(SCR74,SCRT74X-SCRT74)                                        
         DC    AL2(INIT74-INIT)                                                 
*                                                                               
         DC    AL2(VNWAUTHH-T702FFD)                                            
         DC    AL2(VNWESTH-T702FFD)                                             
         DC    AL2(VNWPDH-T702FFD)                                              
         DC    AL2(VNWCYCH-T702FFD)                                             
         DC    AL2(VNWLCYCH-T702FFD)                                            
         DC    AL2(VNWDTLH-T702FFD)                                             
         DC    AL2(VNWBNPH-T702FFD)                                             
         DC    AL2(VNWUSNMH-T702FFD)                                            
         DC    AL2(VNWEINVH-T702FFD)                                            
         DC    AL2(VNWOPTH-T702FFD)                                             
         DC    AL2(VNWOVLYH-T702FFD)                                            
         DC    AL2(VNWICOMH-T702FFD)                                            
         DC    AL2(VNWHCOMH-T702FFD)                                            
         DC    AL2(VNWCMNTH-T702FFD)                                            
         DC    AL2(VNWDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM74-XVCOM)                                                
         DC    AL2(VSCR74-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV74-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT74X  EQU   *                                                                
*&&                                                                             
*              TABLE OF DISPLACEMENTS  (MUSIC RATE REUSE)                       
         SPACE 1                                                                
SCRT75   DC    AL1(SCR75,SCRT75X-SCRT75)                                        
         DC    AL2(INIT76-INIT)                                                 
*                                                                               
         DC    AL2(MRRAUTHH-T702FFD)                                            
         DC    AL2(MRRESTH-T702FFD)                                             
         DC    AL2(MRRPDH-T702FFD)                                              
         DC    AL2(MRRCYCH-T702FFD)                                             
         DC    AL2(MRRLCYCH-T702FFD)                                            
         DC    AL2(MRRDTLH-T702FFD)                                             
         DC    AL2(MRRBNPH-T702FFD)                                             
         DC    AL2(MRRUSNMH-T702FFD)                                            
         DC    AL2(MRREINVH-T702FFD)                                            
         DC    AL2(MRROPTH-T702FFD)                                             
         DC    AL2(MRROVLYH-T702FFD)                                            
         DC    AL2(MRRICOMH-T702FFD)                                            
         DC    AL2(MRRHCOMH-T702FFD)                                            
         DC    AL2(MRRCMNTH-T702FFD)                                            
         DC    AL2(MRRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM76-XVCOM)                                                
         DC    AL2(VSCR76-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV76-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT75X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (NON-BROADCAST MUSIC)                    
         SPACE 1                                                                
SCRT76   DC    AL1(SCR76,SCRT76X-SCRT76)                                        
         DC    AL2(INIT75-INIT)                                                 
*                                                                               
         DC    AL2(NBMAUTHH-T702FFD)                                            
         DC    AL2(NBMESTH-T702FFD)                                             
         DC    AL2(NBMPDH-T702FFD)                                              
         DC    AL2(NBMCYCH-T702FFD)                                             
         DC    AL2(NBMLCYCH-T702FFD)                                            
         DC    AL2(NBMDTLH-T702FFD)                                             
         DC    AL2(NBMBNPH-T702FFD)                                             
         DC    AL2(NBMUSNMH-T702FFD)                                            
         DC    AL2(NBMEINVH-T702FFD)                                            
         DC    AL2(NBMOPTH-T702FFD)                                             
         DC    AL2(NBMOVLYH-T702FFD)                                            
         DC    AL2(NBMICOMH-T702FFD)                                            
         DC    AL2(NBMHCOMH-T702FFD)                                            
         DC    AL2(NBMCMNTH-T702FFD)                                            
         DC    AL2(NBMDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM75-XVCOM)                                                
         DC    AL2(VSCR75-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV75-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT76X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INT)                                    
         SPACE 1                                                                
SCRT77   DC    AL1(SCR77,SCRT77X-SCRT77)                                        
         DC    AL2(INIT77-INIT)                                                 
*                                                                               
         DC    AL2(ITNAUTHH-T702FFD)                                            
         DC    AL2(ITNESTH-T702FFD)                                             
         DC    AL2(ITNPDH-T702FFD)                                              
         DC    AL2(ITNCYCH-T702FFD)                                             
         DC    AL2(ITNLCYCH-T702FFD)                                            
         DC    AL2(ITNDTLH-T702FFD)                                             
         DC    AL2(ITNBNPH-T702FFD)                                             
         DC    AL2(ITNUSNMH-T702FFD)                                            
         DC    AL2(ITNEINVH-T702FFD)                                            
         DC    AL2(ITNOPTH-T702FFD)                                             
         DC    AL2(ITNOVLYH-T702FFD)                                            
         DC    AL2(ITNICOMH-T702FFD)                                            
         DC    AL2(ITNHCOMH-T702FFD)                                            
         DC    AL2(ITNCMNTH-T702FFD)                                            
         DC    AL2(ITNDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM77-XVCOM)                                                
         DC    AL2(VSCR77-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV77-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT77X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (Spanish Foreign Reuse)                  
         SPACE 1                                                                
SCRT79   DC    AL1(SCR79,SCRT79X-SCRT79)                                        
         DC    AL2(INIT79-INIT)                                                 
*                                                                               
         DC    AL2(SFRAUTHH-T702FFD)                                            
         DC    AL2(SFRESTH-T702FFD)                                             
         DC    AL2(SFRPDH-T702FFD)                                              
         DC    AL2(SFRCYCH-T702FFD)                                             
         DC    AL2(SFRLCYCH-T702FFD)                                            
         DC    AL2(SFRDTLH-T702FFD)                                             
         DC    AL2(SFRBNPH-T702FFD)                                             
         DC    AL2(SFRUSNMH-T702FFD)                                            
         DC    AL2(SFREINVH-T702FFD)                                            
         DC    AL2(SFROPTH-T702FFD)                                             
         DC    AL2(SFROVLYH-T702FFD)                                            
         DC    AL2(SFRICOMH-T702FFD)                                            
         DC    AL2(SFRHCOMH-T702FFD)                                            
         DC    AL2(SFRCMNTH-T702FFD)                                            
         DC    AL2(SFRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM79-XVCOM)                                                
         DC    AL2(VSCR79-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV79-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT79X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (HOLDING FEE)                            
         SPACE 1                                                                
SCRT78   DC    AL1(SCR78,SCRT78X-SCRT78)                                        
         DC    AL2(INIT78-INIT)                                                 
*                                                                               
         DC    AL2(HLDAUTHH-T702FFD)                                            
         DC    AL2(HLDESTH-T702FFD)                                             
         DC    AL2(HLDPDH-T702FFD)                                              
         DC    AL2(HLDCYCH-T702FFD)                                             
         DC    AL2(HLDLCYCH-T702FFD)                                            
         DC    AL2(HLDDTLH-T702FFD)                                             
         DC    AL2(HLDBNPH-T702FFD)                                             
         DC    AL2(HLDUSNMH-T702FFD)                                            
         DC    AL2(HLDEINVH-T702FFD)                                            
         DC    AL2(HLDOPTH-T702FFD)                                             
         DC    AL2(HLDOVLYH-T702FFD)                                            
         DC    AL2(HLDICOMH-T702FFD)                                            
         DC    AL2(HLDHCOMH-T702FFD)                                            
         DC    AL2(HLDCMNTH-T702FFD)                                            
         DC    AL2(HLDDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM78-XVCOM)                                                
         DC    AL2(VSCR78-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV78-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT78X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INTERNET/NEW MEDIA)                     
         SPACE 1                                                                
SCRT11   DC    AL1(SCR11,SCRT11X-SCRT11)                                        
         DC    AL2(INIT81-INIT)                                                 
*                                                                               
         DC    AL2(IRNAUTHH-T702FFD)                                            
         DC    AL2(IRNESTH-T702FFD)                                             
         DC    AL2(IRNPDH-T702FFD)                                              
         DC    AL2(IRNCYCH-T702FFD)                                             
         DC    AL2(IRNLCYCH-T702FFD)                                            
         DC    AL2(IRNDTLH-T702FFD)                                             
         DC    AL2(IRNBNPH-T702FFD)                                             
         DC    AL2(IRNUSNMH-T702FFD)                                            
         DC    AL2(IRNEINVH-T702FFD)                                            
         DC    AL2(IRNOPTH-T702FFD)                                             
         DC    AL2(IRNOVLYH-T702FFD)                                            
         DC    AL2(IRNICOMH-T702FFD)                                            
         DC    AL2(IRNHCOMH-T702FFD)                                            
         DC    AL2(IRNCMNTH-T702FFD)                                            
         DC    AL2(IRNDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM81-XVCOM)                                                
         DC    AL2(VSCR81-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV81-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT11X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (MOVE TO NEW MEDIA)                      
         SPACE 1                                                                
SCRT12   DC    AL1(SCR12,SCRT12X-SCRT12)                                        
         DC    AL2(INIT82-INIT)                                                 
*                                                                               
         DC    AL2(MOVAUTHH-T702FFD)                                            
         DC    AL2(MOVESTH-T702FFD)                                             
         DC    AL2(MOVPDH-T702FFD)                                              
         DC    AL2(MOVCYCH-T702FFD)                                             
         DC    AL2(MOVLCYCH-T702FFD)                                            
         DC    AL2(MOVDTLH-T702FFD)                                             
         DC    AL2(MOVBNPH-T702FFD)                                             
         DC    AL2(MOVUSNMH-T702FFD)                                            
         DC    AL2(MOVEINVH-T702FFD)                                            
         DC    AL2(MOVOPTH-T702FFD)                                             
         DC    AL2(MOVOVLYH-T702FFD)                                            
         DC    AL2(MOVICOMH-T702FFD)                                            
         DC    AL2(MOVHCOMH-T702FFD)                                            
         DC    AL2(MOVCMNTH-T702FFD)                                            
         DC    AL2(MOVDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM82-XVCOM)                                                
         DC    AL2(VSCR82-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV82-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT12X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (LIFT)                                   
         SPACE 1                                                                
SCRT13   DC    AL1(SCR13,SCRT13X-SCRT13)                                        
         DC    AL2(INIT83-INIT)                                                 
*                                                                               
         DC    AL2(LFTAUTHH-T702FFD)                                            
         DC    AL2(LFTESTH-T702FFD)                                             
         DC    AL2(LFTPDH-T702FFD)                                              
         DC    AL2(LFTCYCH-T702FFD)                                             
         DC    AL2(LFTLCYCH-T702FFD)                                            
         DC    AL2(LFTDTLH-T702FFD)                                             
         DC    AL2(LFTBNPH-T702FFD)                                             
         DC    AL2(LFTUSNMH-T702FFD)                                            
         DC    AL2(LFTEINVH-T702FFD)                                            
         DC    AL2(LFTOPTH-T702FFD)                                             
         DC    AL2(LFTOVLYH-T702FFD)                                            
         DC    AL2(LFTICOMH-T702FFD)                                            
         DC    AL2(LFTHCOMH-T702FFD)                                            
         DC    AL2(LFTCMNTH-T702FFD)                                            
         DC    AL2(LFTDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM83-XVCOM)                                                
         DC    AL2(VSCR83-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV83-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT13X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (RADIO GUARANTEE)                        
         SPACE 1                                                                
SCRT14   DC    AL1(SCR14,SCRT14X-SCRT14)                                        
         DC    AL2(INIT84-INIT)                                                 
*                                                                               
         DC    AL2(GRRAUTHH-T702FFD)                                            
         DC    AL2(GRRESTH-T702FFD)                                             
         DC    AL2(GRRPDH-T702FFD)                                              
         DC    AL2(GRRCYCH-T702FFD)                                             
         DC    AL2(GRRLCYCH-T702FFD)                                            
         DC    AL2(GRRDTLH-T702FFD)                                             
         DC    AL2(GRRBNPH-T702FFD)                                             
         DC    AL2(GRRUSNMH-T702FFD)                                            
         DC    AL2(GRREINVH-T702FFD)                                            
         DC    AL2(GRROPTH-T702FFD)                                             
         DC    AL2(GRROVLYH-T702FFD)                                            
         DC    AL2(GRRICOMH-T702FFD)                                            
         DC    AL2(GRRHCOMH-T702FFD)                                            
         DC    AL2(GRRCMNTH-T702FFD)                                            
         DC    AL2(GRRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM84-XVCOM)                                                
         DC    AL2(VSCR84-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV84-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT14X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (GUARANTEE)                              
         SPACE 1                                                                
SCRT15   DC    AL1(SCR15,SCRT15X-SCRT15)                                        
         DC    AL2(INIT85-INIT)                                                 
*                                                                               
         DC    AL2(GT2AUTHH-T702FFD)                                            
         DC    AL2(GT2ESTH-T702FFD)                                             
         DC    AL2(GT2PDH-T702FFD)                                              
         DC    AL2(GT2CYCH-T702FFD)                                             
         DC    AL2(GT2LCYCH-T702FFD)                                            
         DC    AL2(GT2DTLH-T702FFD)                                             
         DC    AL2(GT2BNPH-T702FFD)                                             
         DC    AL2(GT2USNMH-T702FFD)                                            
         DC    AL2(GT2EINVH-T702FFD)                                            
         DC    AL2(GT2OPTH-T702FFD)                                             
         DC    AL2(GT2OVLYH-T702FFD)                                            
         DC    AL2(GT2ICOMH-T702FFD)                                            
         DC    AL2(GT2HCOMH-T702FFD)                                            
         DC    AL2(GT2CMNTH-T702FFD)                                            
         DC    AL2(GT2DUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM85-XVCOM)                                                
         DC    AL2(0)                                                           
         DC    AL2(XVMD85-T70252)                                               
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV85-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT15X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (CANADIAN NEW MEDIA)                     
         SPACE 1                                                                
SCRT85   DC    AL1(SCR85,SCRT85X-SCRT85)                                        
         DC    AL2(INIT86-INIT)                                                 
*                                                                               
         DC    AL2(CNMAUTHH-T702FFD)                                            
         DC    AL2(CNMESTH-T702FFD)                                             
         DC    AL2(CNMPDH-T702FFD)                                              
         DC    AL2(CNMCYCH-T702FFD)                                             
         DC    AL2(CNMLCYCH-T702FFD)                                            
         DC    AL2(CNMDTLH-T702FFD)                                             
         DC    AL2(CNMBNPH-T702FFD)                                             
         DC    AL2(CNMUSNMH-T702FFD)                                            
         DC    AL2(CNMEINVH-T702FFD)                                            
         DC    AL2(CNMOPTH-T702FFD)                                             
         DC    AL2(CNMOVLYH-T702FFD)                                            
         DC    AL2(CNMICOMH-T702FFD)                                            
         DC    AL2(CNMHCOMH-T702FFD)                                            
         DC    AL2(CNMCMNTH-T702FFD)                                            
         DC    AL2(CNMDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM86-XVCOM)                                                
         DC    AL2(VSCR86-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV86-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT85X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INDUSTRIAL RETAKE SESSION)              
         SPACE 1                                                                
SCRT16   DC    AL1(SCR16,SCRT16X-SCRT16)                                        
         DC    AL2(INIT16-INIT)                                                 
*                                                                               
         DC    AL2(RTKAUTHH-T702FFD)                                            
         DC    AL2(RTKESTH-T702FFD)                                             
         DC    AL2(RTKPDH-T702FFD)                                              
         DC    AL2(RTKCYCH-T702FFD)                                             
         DC    AL2(RTKLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(RTKBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(RTKEINVH-T702FFD)                                            
         DC    AL2(RTKOPTH-T702FFD)                                             
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(RTKICOMH-T702FFD)                                            
         DC    AL2(RTKHCOMH-T702FFD)                                            
         DC    AL2(RTKCMNTH-T702FFD)                                            
         DC    AL2(RTKDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(0)                                                           
         DC    AL2(DIS16-T70252)                                                
         DC    AL2(VAL16-T70252)                                                
         DC    AL2(BINV16-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L16LNQ)                                                      
         DC    AL2(L16OPTS-LIN16D)                                              
         DC    AL2(L16HMH-LIN16D)                                               
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    AL2(L16INCLH-LIN16D)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(L16REIMH-LIN16D)                                             
         DC    AL2(L16SPNHH-LIN16D)                                             
         DC    AL2(L16MDEDH-LIN16D)                                             
         DC    AL2(L16PAYH-LIN16D)                                              
*                                                                               
         DC    AL2(L16AGTH-LIN16D)                                              
         DC    AL2(L16CMNTH-LIN16D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT16X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INDUSTRIAL RECORDING SESSION)           
         SPACE 1                                                                
SCRT17   DC    AL1(SCR17,SCRT17X-SCRT17)                                        
         DC    AL2(INIT17-INIT)                                                 
*                                                                               
         DC    AL2(DIOAUTHH-T702FFD)                                            
         DC    AL2(DIOESTH-T702FFD)                                             
         DC    AL2(DIOPDH-T702FFD)                                              
         DC    AL2(DIOCYCH-T702FFD)                                             
         DC    AL2(DIOLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(DIOBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(DIOEINVH-T702FFD)                                            
         DC    AL2(DIOOPTH-T702FFD)                                             
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(DIOICOMH-T702FFD)                                            
         DC    AL2(DIOHCOMH-T702FFD)                                            
         DC    AL2(DIOCMNTH-T702FFD)                                            
         DC    AL2(DIODUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(0)                                                           
         DC    AL2(DIS17-T70252)                                                
         DC    AL2(VAL17-T70252)                                                
         DC    AL2(BINV17-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L17LNQ)                                                      
         DC    AL2(L17OPTS-LIN17D)                                              
         DC    AL2(L17PRGH-LIN17D)                                              
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    AL2(L17INCLH-LIN17D)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(L17REIMH-LIN17D)                                             
         DC    AL2(L17SPNHH-LIN17D)                                             
         DC    AL2(L17MDEDH-LIN17D)                                             
         DC    AL2(L17PAYH-LIN17D)                                              
*                                                                               
         DC    AL2(L17AGTH-LIN17D)                                              
         DC    AL2(L17CMNTH-LIN17D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT17X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INTERACTIVE VOICE SESSION)              
         SPACE 1                                                                
SCRT18   DC    AL1(SCR18,SCRT18X-SCRT18)                                        
         DC    AL2(INIT18-INIT)                                                 
*                                                                               
         DC    AL2(IVRAUTHH-T702FFD)                                            
         DC    AL2(IVRESTH-T702FFD)                                             
         DC    AL2(IVRPDH-T702FFD)                                              
         DC    AL2(IVRCYCH-T702FFD)                                             
         DC    AL2(IVRLCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(IVRBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(IVREINVH-T702FFD)                                            
         DC    AL2(IVROPTH-T702FFD)                                             
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(IVRICOMH-T702FFD)                                            
         DC    AL2(IVRHCOMH-T702FFD)                                            
         DC    AL2(IVRCMNTH-T702FFD)                                            
         DC    AL2(IVRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCRSESS-T70252)                                             
         DC    AL2(0)                                                           
         DC    AL2(DIS18-T70252)                                                
         DC    AL2(VAL18-T70252)                                                
         DC    AL2(BINV18-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L18LNQ)                                                      
         DC    AL2(L18OPTS-LIN18D)                                              
         DC    AL2(L18HMH-LIN18D)                                               
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    X'FFFF'               NOT ON SCREEN                              
         DC    AL2(L18INCLH-LIN18D)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(L18REIMH-LIN18D)                                             
         DC    AL2(L18SPNHH-LIN18D)                                             
         DC    AL2(L18MDEDH-LIN18D)                                             
         DC    AL2(L18PAYH-LIN18D)                                              
*                                                                               
         DC    AL2(L18AGTH-LIN18D)                                              
         DC    AL2(L18CMNTH-LIN18D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT18X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INDUSTRIAL STORECASTING)                
         SPACE 1                                                                
SCRT19   DC    AL1(SCR19,SCRT19X-SCRT19)                                        
         DC    AL2(INIT19-INIT)                                                 
*                                                                               
         DC    AL2(STRAUTHH-T702FFD)                                            
         DC    AL2(STRESTH-T702FFD)                                             
         DC    AL2(STRPDH-T702FFD)                                              
         DC    AL2(STRCYCH-T702FFD)                                             
         DC    AL2(STRLCYCH-T702FFD)                                            
         DC    AL2(STRDTLH-T702FFD)                                             
         DC    AL2(STRBNPH-T702FFD)                                             
         DC    AL2(STRUSNMH-T702FFD)                                            
         DC    AL2(STREINVH-T702FFD)                                            
         DC    AL2(STROPTH-T702FFD)                                             
         DC    AL2(STROVLYH-T702FFD)                                            
         DC    AL2(STRICOMH-T702FFD)                                            
         DC    AL2(STRHCOMH-T702FFD)                                            
         DC    AL2(STRCMNTH-T702FFD)                                            
         DC    AL2(STRDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM19-XVCOM)                                                
         DC    AL2(VSCR19-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV19-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT19X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INDUSTRIAL SUPPLEMENTAL)                
         SPACE 1                                                                
SCRT7A   DC    AL1(SCR7A,SCRT7AX-SCRT7A)                                        
         DC    AL2(INIT7A-INIT)                                                 
*                                                                               
         DC    AL2(ISUAUTHH-T702FFD)                                            
         DC    AL2(ISUESTH-T702FFD)                                             
         DC    AL2(ISUPDH-T702FFD)                                              
         DC    AL2(ISUCYCH-T702FFD)                                             
         DC    AL2(ISULCYCH-T702FFD)                                            
         DC    AL2(ISUDTLH-T702FFD)                                             
         DC    AL2(ISUBNPH-T702FFD)                                             
         DC    AL2(ISUUSNMH-T702FFD)                                            
         DC    AL2(ISUEINVH-T702FFD)                                            
         DC    AL2(ISUOPTH-T702FFD)                                             
         DC    AL2(ISUOVLYH-T702FFD)                                            
         DC    AL2(ISUICOMH-T702FFD)                                            
         DC    AL2(ISUHCOMH-T702FFD)                                            
         DC    AL2(ISUCMNTH-T702FFD)                                            
         DC    AL2(ISUDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM7A-XVCOM)                                                
         DC    AL2(VSCR7A-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV7A-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT7AX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INM AND NIM)                            
         SPACE 1                                                                
SCRT1A   DC    AL1(SCR1A,SCRT1AX-SCRT1A)                                        
         DC    AL2(INIT1A-INIT)                                                 
*                                                                               
         DC    AL2(MVMAUTHH-T702FFD)                                            
         DC    AL2(MVMESTH-T702FFD)                                             
         DC    AL2(MVMPDH-T702FFD)                                              
         DC    AL2(MVMCYCH-T702FFD)                                             
         DC    AL2(MVMLCYCH-T702FFD)                                            
         DC    AL2(MVMDTLH-T702FFD)                                             
         DC    AL2(MVMBNPH-T702FFD)                                             
         DC    AL2(MVMUSNMH-T702FFD)                                            
         DC    AL2(MVMEINVH-T702FFD)                                            
         DC    AL2(MVMOPTH-T702FFD)                                             
         DC    AL2(MVMOVLYH-T702FFD)                                            
         DC    AL2(MVMICOMH-T702FFD)                                            
         DC    AL2(MVMHCOMH-T702FFD)                                            
         DC    AL2(MVMCMNTH-T702FFD)                                            
         DC    AL2(MVMDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM1A-XVCOM)                                                
         DC    AL2(VSCR1A-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV1A-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT1AX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (IN HOME MUSIC)                          
         SPACE 1                                                                
SCRT1B   DC    AL1(SCR1B,SCRT1BX-SCRT1B)                                        
         DC    AL2(INIT1B-INIT)                                                 
*                                                                               
         DC    AL2(IHMAUTHH-T702FFD)                                            
         DC    AL2(IHMESTH-T702FFD)                                             
         DC    AL2(IHMPDH-T702FFD)                                              
         DC    AL2(IHMCYCH-T702FFD)                                             
         DC    AL2(IHMLCYCH-T702FFD)                                            
         DC    AL2(IHMDTLH-T702FFD)                                             
         DC    AL2(IHMBNPH-T702FFD)                                             
         DC    AL2(IHMUSNMH-T702FFD)                                            
         DC    AL2(IHMEINVH-T702FFD)                                            
         DC    AL2(IHMOPTH-T702FFD)                                             
         DC    AL2(IHMOVLYH-T702FFD)                                            
         DC    AL2(IHMICOMH-T702FFD)                                            
         DC    AL2(IHMHCOMH-T702FFD)                                            
         DC    AL2(IHMCMNTH-T702FFD)                                            
         DC    AL2(IHMDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM1B-XVCOM)                                                
         DC    AL2(VSCR1B-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV1B-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
SCRT1BX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (INTERNET/NEW MEDIA)                     
         SPACE 1                                                                
SCRT1D   DC    AL1(SCR1D,SCRT1DX-SCRT1D)                                        
         DC    AL2(INIT1D-INIT)                                                 
*                                                                               
         DC    AL2(INUAUTHH-T702FFD)                                            
         DC    AL2(INUESTH-T702FFD)                                             
         DC    AL2(INUPDH-T702FFD)                                              
         DC    AL2(INUCYCH-T702FFD)                                             
         DC    AL2(INULCYCH-T702FFD)                                            
         DC    AL2(INUDTLH-T702FFD)                                             
         DC    AL2(INUBNPH-T702FFD)                                             
         DC    AL2(INUUSNMH-T702FFD)                                            
         DC    AL2(INUEINVH-T702FFD)                                            
         DC    AL2(INUOPTH-T702FFD)                                             
         DC    AL2(INUOVLYH-T702FFD)                                            
         DC    AL2(INUICOMH-T702FFD)                                            
         DC    AL2(INUHCOMH-T702FFD)                                            
         DC    AL2(INUCMNTH-T702FFD)                                            
         DC    AL2(INUDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM1D-XVCOM)                                                
         DC    AL2(VSCR1D-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV1D-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT1DX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (EVENT)                                  
         SPACE 1                                                                
SCRT1E   DC    AL1(SCR1E,SCRT1EX-SCRT1E)                                        
         DC    AL2(INIT1E-INIT)                                                 
*                                                                               
         DC    AL2(EVEAUTHH-T702FFD)                                            
         DC    AL2(EVEESTH-T702FFD)                                             
         DC    AL2(EVEPDH-T702FFD)                                              
         DC    AL2(EVECYCH-T702FFD)                                             
         DC    AL2(EVELCYCH-T702FFD)                                            
         DC    AL2(0)                    DETAIL OPTION                          
         DC    AL2(EVEBNPH-T702FFD)                                             
         DC    AL2(0)                                                           
         DC    AL2(EVEEINVH-T702FFD)                                            
         DC    AL2(EVEOPT2H-T702FFD)                                            
         DC    AL2(0)                    DTL SCREEN OVERLAY LOCATION            
         DC    AL2(EVEICOMH-T702FFD)                                            
         DC    AL2(EVEHCOMH-T702FFD)                                            
         DC    AL2(EVECMNTH-T702FFD)                                            
         DC    AL2(EVEDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCR1E-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DIS1E-T70252)                                                
         DC    AL2(VAL1E-T70252)                                                
         DC    AL2(BINV1E-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(L1ELNQ)                                                      
         DC    AL2(L1EOPTS-LIN1ED)                                              
         DC    X'FFFF'                                                          
         DC    X'FFFF'                                                          
         DC    X'FFFF'                                                          
         DC    X'FFFF'                                                          
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(0)                                                           
         DC    AL2(L1EPAYH-LIN1ED)                                              
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(L1ECMNTH-LIN1ED)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT1EX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (VRE/VNR)                                
         SPACE 1                                                                
SCRT1F   DC    AL1(SCR1F,SCRT1FX-SCRT1F)                                        
         DC    AL2(INIT1F-INIT)                                                 
*                                                                               
         DC    AL2(VREAUTHH-T702FFD)                                            
         DC    AL2(VREESTH-T702FFD)                                             
         DC    AL2(VREPDH-T702FFD)                                              
         DC    AL2(VRECYCH-T702FFD)                                             
         DC    AL2(VRELCYCH-T702FFD)                                            
         DC    AL2(VREDTLH-T702FFD)                                             
         DC    AL2(VREBNPH-T702FFD)                                             
         DC    AL2(VREUSNMH-T702FFD)                                            
         DC    AL2(VREEINVH-T702FFD)                                            
         DC    AL2(VREOPTH-T702FFD)                                             
*        DC    AL2(VREWEBSH-T702FFD)                                            
         DC    AL2(VREOVLYH-T702FFD)                                            
         DC    AL2(VREICOMH-T702FFD)                                            
         DC    AL2(VREHCOMH-T702FFD)                                            
         DC    AL2(VRECMNTH-T702FFD)                                            
         DC    AL2(VREDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(0)                                                           
         DC    AL2(VSCR1F-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV1F-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT1FX  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (EQUITY)                                 
         SPACE 1                                                                
SCRT20   DC    AL1(SCR20,SCRT20X-SCRT20)                                        
         DC    AL2(INIT20-INIT)                                                 
*                                                                               
         DC    AL2(EQYAUTHH-T702FFD)                                            
         DC    AL2(EQYESTH-T702FFD)                                             
         DC    AL2(EQYPDH-T702FFD)                                              
         DC    AL2(EQYCYCH-T702FFD)                                             
         DC    AL2(EQYLCYCH-T702FFD)                                            
         DC    AL2(EQYDTLH-T702FFD)                                             
         DC    AL2(EQYBNPH-T702FFD)                                             
         DC    AL2(EQYUSNMH-T702FFD)                                            
         DC    AL2(EQYEINVH-T702FFD)                                            
         DC    AL2(EQYOPTH-T702FFD)                                             
         DC    AL2(EQYOVLYH-T702FFD)                                            
         DC    AL2(EQYICOMH-T702FFD)                                            
         DC    AL2(EQYHCOMH-T702FFD)                                            
         DC    AL2(EQYCMNTH-T702FFD)                                            
         DC    AL2(EQYDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM20-XVCOM)                                                
         DC    AL2(VSCR20-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV20-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT20X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (MUSIC BUYOUT)                           
         SPACE 1                                                                
SCRT21   DC    AL1(SCR21,SCRT21X-SCRT21)                                        
         DC    AL2(INIT21-INIT)                                                 
*                                                                               
         DC    AL2(MBOAUTHH-T702FFD)                                            
         DC    AL2(MBOESTH-T702FFD)                                             
         DC    AL2(MBOPDH-T702FFD)                                              
         DC    AL2(MBOCYCH-T702FFD)                                             
         DC    AL2(MBOLCYCH-T702FFD)                                            
         DC    AL2(MBODTLH-T702FFD)                                             
         DC    AL2(MBOBNPH-T702FFD)                                             
         DC    AL2(MBOUSNMH-T702FFD)                                            
         DC    AL2(MBOEINVH-T702FFD)                                            
         DC    AL2(MBOOPTH-T702FFD)                                             
         DC    AL2(MBOOVLYH-T702FFD)                                            
         DC    AL2(MBOICOMH-T702FFD)                                            
         DC    AL2(MBOHCOMH-T702FFD)                                            
         DC    AL2(MBOCMNTH-T702FFD)                                            
         DC    AL2(MBODUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM21-XVCOM)                                                
         DC    AL2(VSCR21-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV21-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT21X  EQU   *                                                                
         EJECT                                                                  
*              TABLE OF DISPLACEMENTS  (NEW MEDIA CANADA)                       
         SPACE 1                                                                
SCRT22   DC    AL1(SCR22,SCRT22X-SCRT22)                                        
         DC    AL2(INIT22-INIT)                                                 
*                                                                               
         DC    AL2(NMCAUTHH-T702FFD)                                            
         DC    AL2(NMCESTH-T702FFD)                                             
         DC    AL2(NMCPDH-T702FFD)                                              
         DC    AL2(NMCCYCH-T702FFD)                                             
         DC    AL2(NMCLCYCH-T702FFD)                                            
         DC    AL2(NMCDTLH-T702FFD)                                             
         DC    AL2(NMCBNPH-T702FFD)                                             
         DC    AL2(NMCUSNMH-T702FFD)                                            
         DC    AL2(NMCEINVH-T702FFD)                                            
         DC    AL2(NMCOPTH-T702FFD)                                             
         DC    AL2(NMCOVLYH-T702FFD)                                            
         DC    AL2(NMCICOMH-T702FFD)                                            
         DC    AL2(NMCHCOMH-T702FFD)                                            
         DC    AL2(NMCCMNTH-T702FFD)                                            
         DC    AL2(NMCDUEH-T702FFD)                                             
*                                                                               
         DC    AL2(XVCM22-XVCOM)                                                
         DC    AL2(VSCR22-T70252)                                               
         DC    AL2(0)                                                           
         DC    AL2(DISB5-T70252)                                                
         DC    AL2(VALB5-T70252)                                                
         DC    AL2(BINV22-T70252)                                               
         DC    AL2(0)                                                           
*                                                                               
         DC    AL2(LB5LNQ)                                                      
         DC    AL2(LB5OPTS-LINB5D)                                              
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5NPH-LINB5D)                                               
         DC    AL2(LB5ACDEH-LINB5D)                                             
         DC    AL2(LB5ICDEH-LINB5D)                                             
*                                                                               
         DC    AL2(LB5APPLH-LINB5D)                                             
         DC    AL2(LB5REIMH-LINB5D)                                             
         DC    AL2(LB5SPNHH-LINB5D)                                             
         DC    AL2(LB5MDEDH-LINB5D)                                             
         DC    AL2(LB5PAYH-LINB5D)                                              
*                                                                               
         DC    AL2(LB5AGTH-LINB5D)                                              
         DC    AL2(LB5CMNTH-LINB5D)                                             
         DC    3AL2(0)                                                          
*                                                                               
SCRT22X  EQU   *                                                                
         EJECT                                                                  
         DC    X'00'               END OF SCREEN TABLES                         
         EJECT                                                                  
       ++INCLUDE TAGTHFCD                                                       
       ++INCLUDE TAADDEAR                                                       
*              DSECT TO COVER SCREEN TABLE                                      
         SPACE 1                                                                
SCRND    DSECT                                                                  
SCRCODE  DS    XL1                 SCREEN PHASE NUMBER                          
SCRLEN   DS    XL1                 L'THIS SCREEN ENTRY                          
SCRINIT  DS    H                   DISP. TO INTIALIZATION ROUTINE               
SCRDSPS  DS    0H                                                               
         SPACE 3                                                                
*              DSECT TO COVER ADDENDUM TYPE TABLES                              
         SPACE 1                                                                
ADDTYTD  DSECT                                                                  
ADDTYTST DS    CL2                 STATE CODE                                   
ADDTYTLN DS    XL1                 L'THIS STATE'S TYPE TABLE ENTRY              
ADDTYTUS EQU   *                   USE EQUATE AND START OF TYPES                
         SPACE 1                                                                
ADDUSED  DSECT                                                                  
ADDUSUSE DS    XL1                 USE EQUATE                                   
ADDUSLN  DS    XL1                 L'THIS USE'S TYPE TABLE ENTRY                
ADDUSTYP EQU   *                   USE TYPE EQUATE                              
         SPACE 1                                                                
ADDTYPD  DSECT                                                                  
ADDTYTYP DS    XL1                 USE TYPE EQUATE                              
ADDTYHED DS    CL5                 COLUMN HEADING                               
ADDTYNXT EQU   *                   NEXT USE TYPE                                
         EJECT                                                                  
*              DSECT TO COVER TABLE OF EPISODES                                 
         SPACE 1                                                                
EPITABD  DSECT                                                                  
EPITNUM  DS    XL2                 EPISODE NUMBER                               
EPITNWH  DS    XL1                 NUMBER OF HEAD WRITERS                       
EPITNWS  DS    XL1                 NUMBER OF SCRIPT WRITERS                     
EPITNWB  DS    XL1                 NUMBER OF BREAKDOWN WRITERS                  
EPITLNQ  EQU   *-EPITNUM                                                        
EPITMLNQ EQU   (MAXEPIS*EPITLNQ+1) L'ENTIRE EPISODE TABLE                       
         EJECT                                                                  
       ++INCLUDE TAGENPAYD                                                      
*              TEMPORARY WORK AREAS USED FOR SCREEN VALIDATION                  
         ORG   SPAREPAY                                                         
CYCSTART DS    CL6                 EBCDIC CYCLE START                           
CYCEND   DS    CL6                              END                             
LASTDATE DS    PL3                 LAST USE DATE INPUT                          
LASTPROG DS    CL15                LAST PROGRAM NAME INPUT                      
EPITAB   DS    XL(MAXEPIS*EPITLNQ+1)  EPISODE STATUS TABLE                      
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=BF                         
         SPACE 1                                                                
LINBFD   DSECT                                                                  
LBFSPOTH DS    CL8                                                              
LBFSPOT  DS    CL2                 N'SPOTS                                      
LBFDAYH  DS    CL8                                                              
LBFDAY   DS    CL2                 N'DAYS                                       
LBFOTH   DS    CL8                                                              
LBFOT    DS    CL2                 N'OVERTIME HOURS                             
LBFDTH   DS    CL8                                                              
LBFDT    DS    CL2                 N'DOUBLE-TIME HOURS                          
LBFTRAVH DS    CL8                                                              
LBFTRAV  DS    CL5                 N'TRAVEL TIME HOURS                          
LBFPDWH  DS    CL8                                                              
LBFPDW   DS    CL5                 N'PRIOR-DAY WARDROBE HOURS                   
LBFTAGSH DS    CL8                                                              
LBFTAGS  DS    CL2                 N'TAGS                                       
LBFICDEH DS    CL8                                                              
LBFICDE  DS    CL1                 REIMBURSED EXPENSES INDICATOR                
LBFREIMH DS    CL8                                                              
LBFREIM  DS    CL10                REIMBURSED EXPENSES                          
LBFPAYH  DS    CL8                                                              
LBFPAY   DS    CL10                PAYMENT AMOUNT                               
LBFSPNHH DS    CL8                                                              
LBFSPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
LBFMDEDH DS    CL8                                                              
LBFMDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
LBFAGTH  DS    CL8                                                              
LBFAGT   DS    CL4                 AGENT                                        
LBFDATAH DS    CL8                                                              
LBFDATA  DS    0CL47                                                            
LBFNAME  DS    CL16                NAME                                         
         DS    CL1                                                              
LBFCAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
LBFCAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
LBFYR    DS    CL3                 CONTRACT YEAR                                
LBFOPTS  DS    CL16                OPTIONS                                      
LBFTAG   DS    CL5                 '^CMNT' TAG                                  
LBFCMNTH DS    CL8                                                              
LBFCMNT  DS    CL30                CHECK COMMENT                                
LBFLNQ   EQU   *-LINBFD                                                         
         EJECT                                                                  
*              DSECT TO COVER DETAIL SCREEN LINE FOR SCREEN=B5                  
         SPACE 1                                                                
LINB5D   DSECT                                                                  
LB5NPH   DS    CL8                                                              
LB5NP    DS    CL1                 NO PAY OPTION                                
         DS    CL8                                                              
LB5ACDEH DS    CL8                                                              
LB5ACDE  DS    CL1                 APPLIED CODE                                 
         DS    CL8                                                              
LB5APPLH DS    CL8                                                              
LB5APPL  DS    CL10                APPLIED AMOUNT                               
         DS    CL8                                                              
LB5ICDEH DS    CL8                                                              
LB5ICDE  DS    CL1                 REIMBURSED EXPENSES INDICATOR                
         DS    CL8                                                              
LB5REIMH DS    CL8                                                              
LB5REIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
LB5PAYH  DS    CL8                                                              
LB5PAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
LB5SPNHH DS    CL8                                                              
LB5SPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
LB5MDEDH DS    CL8                                                              
LB5MDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
LB5AGTH  DS    CL8                                                              
LB5AGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
         DS    CL8                                                              
LB5DATA  DS    0CL42                                                            
LB5NAME  DS    CL16                NAME                                         
         DS    CL1                                                              
LB5CAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
LB5CAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
LB5YR    DS    CL3                 CONTRACT YEAR                                
LB5OPTS  DS    CL16                OPTIONS                                      
         DS    CL7                                                              
LB5TAG   DS    CL5                 '^CMNT' TAG                                  
LB5CMNTH DS    CL8                                                              
LB5CMNT  DS    CL30                CHECK COMMENT                                
         DS    CL8                                                              
LB5LNQ   EQU   *-LINB5D            DISPLACEMENT TO NEXT LINE                    
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=5D                         
         SPACE 1                                                                
LIN5DD   DSECT                                                                  
L5DDAT1H DS    CL8                                                              
L5DDAT1  DS    0CL26                                                            
L5DNAME  DS    CL16                NAME                                         
         DS    CL1                                                              
L5DCAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
L5DYR    DS    CL3                 CONTRACT YEAR                                
L5DTYP   DS    CL1                 W4 TYPE IF NOT INDIV.                        
         DS    CL1                                                              
L5DICDEH DS    CL8                                                              
L5DICDE  DS    CL1                 REIMBURSED EXPENSES INDICATOR                
         DS    CL8                                                              
L5DREIMH DS    CL8                                                              
L5DREIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
L5DPAYH  DS    CL8                                                              
L5DPAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
L5DSPNHH DS    CL8                                                              
L5DSPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
L5DMDEDH DS    CL8                                                              
L5DMDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
L5DAGTH  DS    CL8                                                              
L5DAGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
L5DEPISH DS    CL8                                                              
L5DEPIS  DS    0CL34                                                            
L5DETAG  DS    CL4                 EPIS TAG                                     
         DS    CL1                                                              
L5DENUM  DS    CL29                EPISODE NUMBERS                              
         DS    CL8                                                              
L5DTAG   DS    CL3                 'CMT' TAG                                    
L5DCMNTH DS    CL8                                                              
L5DCMNT  DS    CL40                CHECK COMMENT                                
         DS    CL8                                                              
L5DLNQ   EQU   *-LIN5DD                                                         
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=AF                         
         SPACE 1                                                                
LINAFD   DSECT                                                                  
LAFSPOTH DS    CL8                                                              
LAFSPOT  DS    CL2                 N'SPOTS                                      
         DS    CL8                                                              
LAFHMH   DS    CL8                                                              
LAFHM    DS    CL5                 HOURS/MINUTES                                
         DS    CL8                                                              
LAFAINDH DS    CL8                                                              
LAFAIND  DS    CL1                 APPLIED AMOUNT INDICATOR                     
         DS    CL8                                                              
LAFAPPLH DS    CL8                                                              
LAFAPPL  DS    CL10                APPLIED AMOUNT                               
         DS    CL8                                                              
LAFRINDH DS    CL8                                                              
LAFRIND  DS    CL1                 REIMBURSED EXPENSES INDICATOR                
         DS    CL8                                                              
LAFREIMH DS    CL8                                                              
LAFREIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
LAFPAYH  DS    CL8                                                              
LAFPAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
LAFSPNHH DS    CL8                                                              
LAFSPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
LAFMDEDH DS    CL8                                                              
LAFMDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
LAFAGTH  DS    CL8                                                              
LAFAGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
LAFDATAH DS    CL8                                                              
LAFDATA  DS    0CL42                                                            
LAFNAME  DS    CL16                NAME                                         
         DS    CL1                                                              
LAFCAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
LAFCAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
LAFYR    DS    CL3                 CONTRACT YEAR                                
LAFOPTS  DS    CL16                OPTIONS                                      
         DS    CL7                                                              
LAFTAG   DS    CL5                 '^CMNT' TAG                                  
LAFCMNTH DS    CL8                                                              
LAFCMNT  DS    CL30                CHECK COMMENT                                
         DS    CL8                                                              
LAFLNQ   EQU   *-LINAFD                                                         
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=16                         
         SPACE 1                                                                
LIN16D   DSECT                                                                  
L16HMH   DS    CL8                                                              
L16HM    DS    CL5                 HOURS/MINUTES                                
         DS    CL8                                                              
L16TRVLH DS    CL8                                                              
L16TRVL  DS    CL5                 TRAVEL TIME                                  
         DS    CL8                                                              
L16ENTRH DS    CL8                                                              
L16ENTR  DS    CL1                 ENTIRE SCRIPT                                
         DS    CL8                                                              
L16PARTH DS    CL8                                                              
L16PART  DS    CL1                 OVER 60 DAYS                                 
         DS    CL8                                                              
L16OV60H DS    CL8                                                              
L16OV60  DS    CL1                 PARTIAL SCRIPT                               
         DS    CL8                                                              
L16INCLH DS    CL8                                                              
L16INCL  DS    CL1                 INCLUDE CODE                                 
         DS    CL8                                                              
L16REIMH DS    CL8                                                              
L16REIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
L16PAYH  DS    CL8                                                              
L16PAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
L16SPNHH DS    CL8                                                              
L16SPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
L16MDEDH DS    CL8                                                              
L16MDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
L16AGTH  DS    CL8                                                              
L16AGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
L16DATAH DS    CL8                                                              
L16DATA  DS    0CL42                                                            
L16NAME  DS    CL16                NAME                                         
         DS    CL1                                                              
L16CAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
L16CAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
L16YR    DS    CL3                 CONTRACT YEAR                                
L16OPTS  DS    CL16                OPTIONS                                      
         DS    CL7                                                              
L16TAG   DS    CL5                 '^CMNT' TAG                                  
L16CMNTH DS    CL8                                                              
L16CMNT  DS    CL30                CHECK COMMENT                                
         DS    CL8                                                              
L16LNQ   EQU   *-LIN16D                                                         
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=17                         
         SPACE 1                                                                
LIN17D   DSECT                                                                  
L17PRGH  DS    CL8                                                              
L17PRG   DS    CL2                 NUMBER OF PROGRAMS                           
         DS    CL8                                                              
L17HMH   DS    CL8                                                              
L17HM    DS    CL5                 HOURS/MINUTES                                
         DS    CL8                                                              
L17RTKHH DS    CL8                                                              
L17RTKH  DS    CL5                 RETAKE/HR./MIN                               
         DS    CL8                                                              
L17INCLH DS    CL8                                                              
L17INCL  DS    CL1                 INCLUDE CODE                                 
         DS    CL8                                                              
L17REIMH DS    CL8                                                              
L17REIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
L17PAYH  DS    CL8                                                              
L17PAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
L17SPNHH DS    CL8                                                              
L17SPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
L17MDEDH DS    CL8                                                              
L17MDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
L17AGTH  DS    CL8                                                              
L17AGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
L17DATAH DS    CL8                                                              
L17DATA  DS    0CL47                                                            
L17NAME  DS    CL17                NAME                                         
         DS    CL1                                                              
L17CAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
L17CAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
L17YR    DS    CL3                 CONTRACT YEAR                                
L17OPTS  DS    CL17                OPTIONS                                      
         DS    CL3                                                              
L17CMNTH DS    CL8                                                              
L17CMNT  DS    CL30                CHECK COMMENT                                
         DS    CL8                                                              
L17LNQ   EQU   *-LIN17D                                                         
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=18                         
         SPACE 1                                                                
LIN18D   DSECT                                                                  
L18HMH   DS    CL8                                                              
L18HM    DS    CL5                 HOURS/MINUTES                                
         DS    CL8                                                              
L18TRVLH DS    CL8                                                              
L18TRVL  DS    CL5                 RETAKE/HR./MIN                               
         DS    CL8                                                              
L18INCLH DS    CL8                                                              
L18INCL  DS    CL1                 INCLUDE CODE                                 
         DS    CL8                                                              
L18REIMH DS    CL8                                                              
L18REIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
L18PAYH  DS    CL8                                                              
L18PAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
L18SPNHH DS    CL8                                                              
L18SPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
L18MDEDH DS    CL8                                                              
L18MDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
L18AGTH  DS    CL8                                                              
L18AGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
L18DATAH DS    CL8                                                              
L18DATA  DS    0CL47                                                            
L18NAME  DS    CL17                NAME                                         
         DS    CL1                                                              
L18CAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
L18CAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
L18YR    DS    CL3                 CONTRACT YEAR                                
L18OPTS  DS    CL17                OPTIONS                                      
         DS    CL3                                                              
L18CMNTH DS    CL8                                                              
L18CMNT  DS    CL30                CHECK COMMENT                                
         DS    CL8                                                              
L18LNQ   EQU   *-LIN18D                                                         
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=58                         
         SPACE 1                                                                
LIN58D   DSECT                                                                  
L58SPOTH DS    CL8                                                              
L58SPOT  DS    CL2                 N'SPOTS                                      
         DS    CL8                                                              
L58HMH   DS    CL8                                                              
L58HM    DS    CL5                 HOURS/MINUTES                                
         DS    CL8                                                              
L58TAGSH DS    CL8                                                              
L58TAGS  DS    CL2                 N'TAGS                                       
         DS    CL8                                                              
L58AINDH DS    CL8                                                              
L58AIND  DS    CL1                 APPLIED AMOUNT INDICATOR                     
         DS    CL8                                                              
L58APPLH DS    CL8                                                              
L58APPL  DS    CL10                APPLIED AMOUNT                               
         DS    CL8                                                              
L58RINDH DS    CL8                                                              
L58RIND  DS    CL1                 REIMBURSED EXPENSES INDICATOR                
         DS    CL8                                                              
L58REIMH DS    CL8                                                              
L58REIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
L58PAYH  DS    CL8                                                              
L58PAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
L58SPNHH DS    CL8                                                              
L58SPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
L58MDEDH DS    CL8                                                              
L58MDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
L58AGTH  DS    CL8                                                              
L58AGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
L58DATAH DS    CL8                                                              
L58DATA  DS    0CL42                                                            
L58NAME  DS    CL16                NAME                                         
         DS    CL1                                                              
L58CAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
L58CAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
L58YR    DS    CL3                 CONTRACT YEAR                                
L58OPTS  DS    CL16                OPTIONS                                      
         DS    CL7                                                              
L58TAG   DS    CL5                 '^CMNT' TAG                                  
L58CMNTH DS    CL8                                                              
L58CMNT  DS    CL30                CHECK COMMENT                                
         DS    CL8                                                              
L58LNQ   EQU   *-LIN58D                                                         
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=69                         
         SPACE 1                                                                
LIN69D   DSECT                                                                  
L69ICDEH DS    CL8                                                              
L69ICDE  DS    CL1                 REIMBURSED EXPENSES INDICATOR                
         DS    CL8                                                              
L69REIMH DS    CL8                                                              
L69REIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
L69PAYH  DS    CL8                                                              
L69PAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
L69MDEDH DS    CL8                                                              
L69MDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
L69EXPDH DS    CL8                                                              
L69EXPD  DS    CL8                 EXPIRATION DATE                              
         DS    CL8                                                              
L69AGTFH DS    CL8                                                              
L69AGTF  DS    CL5                 AGENT FEE %                                  
L69AGTH  DS    CL8                                                              
L69AGT   DS    CL4                 AGENT                                        
L69DATAH DS    CL8                                                              
L69DATA  DS    0CL47                                                            
L69NAME  DS    CL16                NAME                                         
         DS    CL1                                                              
L69CAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
L69CAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
L69YR    DS    CL3                 CONTRACT YEAR                                
L69OPTS  DS    CL16                OPTIONS                                      
L69TAG   DS    CL5                 '^CMNT' TAG                                  
L69CMNTH DS    CL8                                                              
L69CMNT  DS    CL30                CHECK COMMENT                                
         DS    CL8                                                              
L69LNQ   EQU   *-LIN69D                                                         
         EJECT                                                                  
*              DSECT TO COVER DETAIL SCREEN LINE FOR SCREEN=6B                  
         SPACE 1                                                                
LIN6BD   DSECT                                                                  
L6BNPH   DS    CL8                                                              
L6BNP    DS    CL1                 NO PAY OPTION                                
         DS    CL8                                                              
L6BACDEH DS    CL8                                                              
L6BACDE  DS    CL1                 APPLIED CODE                                 
         DS    CL8                                                              
L6BAPPLH DS    CL8                                                              
L6BAPPL  DS    CL10                APPLIED AMOUNT                               
         DS    CL8                                                              
L6BICDEH DS    CL8                                                              
L6BICDE  DS    CL1                 REIMBURSED EXPENSES INDICATOR                
         DS    CL8                                                              
L6BREIMH DS    CL8                                                              
L6BREIM  DS    CL10                REIMBURSED EXPENSES                          
         DS    CL8                                                              
L6BPAYH  DS    CL8                                                              
L6BPAY   DS    CL10                PAYMENT AMOUNT                               
         DS    CL8                                                              
L6BSPNHH DS    CL8                                                              
L6BSPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
L6BMDEDH DS    CL8                                                              
L6BMDED  DS    CL10                MISCELLANEOUS DEDUCTION                      
         DS    CL8                                                              
L6BAGTH  DS    CL8                                                              
L6BAGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
         DS    CL8                                                              
L6BDATA  DS    0CL34                                                            
L6BNAME  DS    CL16                NAME                                         
         DS    CL1                                                              
L6BCAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
L6BCAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
L6BYR    DS    CL3                 CONTRACT YEAR                                
L6BOPTS  DS    CL8                 OPTIONS                                      
         DS    CL8                                                              
L6BTAG   DS    CL3                 'CMT' TAG                                    
L6BCMNTH DS    CL8                                                              
L6BCMNT  DS    CL40                CHECK COMMENT                                
         DS    CL8                                                              
L6BLNQ   EQU   *-LIN6BD            DISPLACEMENT TO NEXT LINE                    
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=72                         
         SPACE 1                                                                
LIN72D   DSECT                                                                  
L72NPH   DS    CL8                                                              
L72NP    DS    CL1                 NO PAY OPTION                                
         DS    CL8                                                              
L72SPNHH DS    CL8                                                              
L72SPNH  DS    CL10                AMOUNT SUBJECT TO P&H                        
         DS    CL8                                                              
L72AGTH  DS    CL8                                                              
L72AGT   DS    CL4                 AGENT                                        
         DS    CL8                                                              
L72DATAH DS    CL8                                                              
L72DATA  DS    0CL47                                                            
L72NAME  DS    CL16                NAME                                         
         DS    CL1                                                              
L72CAT   DS    CL3                 CATEGORY                                     
         DS    CL1                                                              
L72CAM   DS    CL1                 Y=ON, N=OFF CAMERA                           
         DS    CL1                                                              
L72YR    DS    CL3                 CONTRACT YEAR                                
L72OPTS  DS    CL16                OPTIONS                                      
L72TAG   DS    CL5                 '^CMNT' TAG                                  
L72CMNTH DS    CL8                                                              
L72CMNT  DS    CL30                CHECK COMMENT                                
L72LNQ   EQU   *-LIN72D                                                         
         EJECT                                                                  
*              DSECT TO COVER SCREEN LINE FOR SCREEN=1E                         
         SPACE 1                                                                
LIN1ED   DSECT                                                                  
L1EDATAH DS    CL8                                                              
L1EDATA  DS    0CL37               NAME                                         
L1ENAM   DS    CL16                OPTIONS                                      
L1EOPTS  DS    CL16                                                             
L1EPAYH  DS    CL8                                                              
L1EPAY   DS    CL10                PAYMENT AMOUNT                               
L1ECMNTH DS    CL8                                                              
L1ECMNT  DS    CL30                CHECK COMMENT                                
L1ELNQ   EQU   *-LIN1ED                                                         
         EJECT                                                                  
       ++INCLUDE TAGENFFD                                                       
         EJECT                                                                  
* TAPYS11D                                                                      
* TAPYS12D                                                                      
* TAPYS13D                                                                      
* TAPYS14D                                                                      
* TAPYS15D                                                                      
* TAPYS16D                                                                      
* TAPYS17D                                                                      
* TAPYS18D                                                                      
* TAPYS19D                                                                      
* TAPYS1AD                                                                      
* TAPYS1BD                                                                      
* TAPYS1DD                                                                      
* TAPYS50D                                                                      
* TAPYS51D                                                                      
* TAPYS53D                                                                      
* TAPYS54D                                                                      
* TAPYS55D                                                                      
* TAPYS5BD                                                                      
* TAPYS57D                                                                      
* TAPYS56D                                                                      
* TAPYS5AD                                                                      
* TAPYS52D                                                                      
* TAPYS58D                                                                      
* TAPYS59D                                                                      
* TAPYS5CD                                                                      
* TAPYS5DD                                                                      
* TAPYS5ED                                                                      
* TAPYS5FD                                                                      
* TAPYS5FD                                                                      
* TAPYS60D                                                                      
* TAPYS61D                                                                      
* TAPYS62D                                                                      
* TAPYS63D                                                                      
* TAPYS64D                                                                      
* TAPYS65D                                                                      
* TAPYS66D                                                                      
* TAPYS67D                                                                      
* TAPYS68D                                                                      
* TAPYS69D                                                                      
* TAPYS6AD                                                                      
* TAPYS6BD                                                                      
* TAPYS6CD                                                                      
* TAPYS6DD                                                                      
* TAPYS6ED                                                                      
* TAPYS6FD                                                                      
* TAPYS70D                                                                      
* TAPYS71D                                                                      
* TAPYS72D                                                                      
* TAPYS73D                                                                      
* TAPYS74D                                                                      
* TAPYS75D                                                                      
* TAPYS76D                                                                      
* TAPYS77D                                                                      
* TAPYS79D                                                                      
* TAPYS78D                                                                      
* TAPYS7AD                                                                      
* TAPYS85D                                                                      
* DDGENTWA    *** MUST FOLLOW LAST SCREEN ***                                   
         PRINT OFF                                                              
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS11D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS12D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS13D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS14D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS15D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS16D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS17D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS18D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS19D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS1AD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS1BD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS1DD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS1ED                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS1FD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS20D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS21D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS22D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS50D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS51D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS53D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS54D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS55D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS5BD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS57D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS56D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS5AD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS52D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS59D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS5CD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS5DD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS5ED                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS5FD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS60D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS61D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS62D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS63D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS64D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS65D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS66D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS67D                                                       
*        ORG   CONTAGH                                                          
*      ++INCLUDE TAPYS68D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS69D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS6AD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS6BD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS6CD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS6DD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS6ED                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS6FD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS70D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS71D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS72D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS73D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS74D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS75D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS76D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS77D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS79D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS78D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS7AD                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS85D                                                       
         ORG   CONTAGH                                                          
       ++INCLUDE TAPYS58D                                                       
       ++INCLUDE DDGENTWA                                                       
         PRINT ON                                                               
         SPACE 3                                                                
         EJECT                                                                  
*              DSECT TO COVER DETAIL SCREEN                                     
         SPACE 2                                                                
DTLD     DSECT                                                                  
       ++INCLUDE TAPYS95D                                                       
         EJECT                                                                  
         EJECT                                                                  
* TAGENWORKD                                                                    
* TASYSEQUS                                                                     
* TAGENEQUS                                                                     
* TASYSDSECT                                                                    
* TAGENFILE                                                                     
* DDTSARD                                                                       
* FAGETTXTD                                                                     
* DDSPLWORKD                                                                    
* TAWBDSECT                                                                     
* TAWADSECT                                                                     
* TASCRE7D                                                                      
* FAWSSVRD                                                                      
* TAMAPEQUS                                                                     
         PRINT OFF                                                              
       ++INCLUDE TAGENWORKD                                                     
       ++INCLUDE TASYSEQUS                                                      
       ++INCLUDE TAGENEQUS                                                      
       ++INCLUDE TASYSDSECT                                                     
       ++INCLUDE TAGENFILE                                                      
       ++INCLUDE DDTSARD                                                        
       ++INCLUDE FAGETTXTD                                                      
       ++INCLUDE DDSPLWORKD                                                     
       ++INCLUDE DDPERVALD                                                      
       ++INCLUDE TAWBDSECT                                                      
       ++INCLUDE TAWADSECT                                                      
       ++INCLUDE TASCRE7D                                                       
       ++INCLUDE FAWSSVRD                                                       
       ++INCLUDE TAMAPEQUS                                                      
         PRINT ON                                                               
**PAN#1  CSECT                                                                  
**PAN#1  DC    CL21'157TAGEN52   03/15/17'                                      
         END                                                                    
